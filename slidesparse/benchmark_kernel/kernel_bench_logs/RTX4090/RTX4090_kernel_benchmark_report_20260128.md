# RTX 4090 Kernel Benchmark æœ€ç»ˆæŠ¥å‘Š

**æ—¥å¿—æ–‡ä»¶**:
- `kernel_bench_20260127_105608.log` (Task 1)
- `kernel_bench_20260127_185621.log` (Task 2-6)

**æ—¶é—´**: 2026-01-28  
**æ€»è€—æ—¶**: çº¦ 8.57 å°æ—¶ (Task 1: 76.5åˆ†é’Ÿ + Task 2-6: 8.30å°æ—¶)  
**GPU**: NVIDIA GeForce RTX 4090 24GB (CC 8.9, Ada Lovelace)

---

## ğŸ“Š æœ€ç»ˆç»“æœæ±‡æ€»

### æ€»ä½“æƒ…å†µ

| ä»»åŠ¡ | çŠ¶æ€ | è€—æ—¶ | è¯´æ˜ |
|------|------|------|------|
| Task 1: cuBLASLt Model æµ‹è¯• | âœ… æˆåŠŸ | 76.5 åˆ†é’Ÿ | 8/8 æ¨¡å‹å…¨éƒ¨é€šè¿‡ |
| Task 2: cuBLASLt Square æµ‹è¯• | âœ… æˆåŠŸ | 2.7 åˆ†é’Ÿ | æ–¹é˜µæµ‹è¯•å…¨éƒ¨é€šè¿‡ |
| Task 3: cuSPARSELt Model é«˜ç¨€ç– (2_4~2_10) | âœ… æˆåŠŸ | 105.4 åˆ†é’Ÿ | 8/8 æ¨¡å‹å…¨éƒ¨é€šè¿‡ |
| Task 4: cuSPARSELt Square é«˜ç¨€ç– (2_4~2_10) | âœ… æˆåŠŸ | 9.3 åˆ†é’Ÿ | æ–¹é˜µæµ‹è¯•å…¨éƒ¨é€šè¿‡ |
| Task 5: cuSPARSELt Model ä½ç¨€ç– (2_12~2_inf) | âœ… æˆåŠŸ | 333.7 åˆ†é’Ÿ | 8/8 æ¨¡å‹å…¨éƒ¨é€šè¿‡ |
| Task 6: cuSPARSELt Square ä½ç¨€ç– (2_12~2_inf) | âœ… æˆåŠŸ | 46.9 åˆ†é’Ÿ | æ–¹é˜µæµ‹è¯•å…¨éƒ¨é€šè¿‡ |

**ğŸ‰ æ€»è®¡: 6/6 ä»»åŠ¡å…¨éƒ¨æˆåŠŸï¼Œ0 å¤±è´¥ï¼ŒæˆåŠŸç‡ 100%**

---

## 1. æµ‹è¯•é…ç½®

### ç¡¬ä»¶ç¯å¢ƒ

| é¡¹ç›® | å€¼ |
|------|-----|
| GPU | NVIDIA GeForce RTX 4090 |
| æ˜¾å­˜ | 24 GB |
| Compute Capability | cc89 (Ada Lovelace) |
| Python | py312 |
| CUDA | cu129 |
| æ¶æ„ | x86_64 |

### æµ‹è¯•å‚æ•°

| å‚æ•° | å€¼ |
|------|-----|
| M åˆ—è¡¨ | `[64, 128, 256, 512, 1024, 2048, 4096, 8192, 16384]` |
| Warmup | 25 |
| Repeat | 50 |
| ç²¾åº¦ | fp16, bf16, int8, fp8e4m3 |

### æµ‹è¯•æ¨¡å‹ (8ä¸ª)

| æ¨¡å‹ | Hidden Size | Intermediate Size |
|------|-------------|-------------------|
| Llama3.2-1B-INT8 | 2048 | 8192 |
| Llama3.2-1B-FP8 | 2048 | 8192 |
| Llama3.2-3B-INT8 | 3072 | 8192 |
| Llama3.2-3B-FP8 | 3072 | 8192 |
| Qwen2.5-7B-INT8 | 3584 | 18944 |
| Qwen2.5-7B-FP8 | 3584 | 18944 |
| Qwen2.5-14B-INT8 | 5120 | 13824 |
| Qwen2.5-14B-FP8 | 5120 | 13824 |

### ç¨€ç–åº¦é…ç½®

| ç±»åˆ« | ç¨€ç–åº¦ |
|------|--------|
| é«˜ç¨€ç– | 2_4, 2_6, 2_8, 2_10 |
| ä½ç¨€ç– | 2_12, 2_14, 2_16, 2_inf |

---

## 2. cuBLASLt æµ‹è¯•ç»“æœ

### Task 1: Model æµ‹è¯• âœ…

| æ¨¡å‹ | çŠ¶æ€ | è€—æ—¶ |
|------|------|------|
| Llama3.2-1B-INT8 | âœ… æˆåŠŸ | 223.6s |
| Llama3.2-1B-FP8 | âœ… æˆåŠŸ | 212.1s |
| Llama3.2-3B-INT8 | âœ… æˆåŠŸ | 341.8s |
| Llama3.2-3B-FP8 | âœ… æˆåŠŸ | 340.6s |
| Qwen2.5-7B-INT8 | âœ… æˆåŠŸ | 798.1s |
| Qwen2.5-7B-FP8 | âœ… æˆåŠŸ | 798.2s |
| Qwen2.5-14B-INT8 | âœ… æˆåŠŸ | 936.4s |
| Qwen2.5-14B-FP8 | âœ… æˆåŠŸ | 938.9s |

**ç»Ÿè®¡**: æˆåŠŸ 8/8ï¼Œå¤±è´¥ 0

### Task 2: Square æµ‹è¯• âœ…

- æ–¹é˜µæµ‹è¯• (M=N=K): å…¨éƒ¨ 9 ä¸ª M å€¼é€šè¿‡
- 4 ç§ç²¾åº¦å…¨éƒ¨é€šè¿‡
- æ€»è€—æ—¶: 162.5s

---

## 3. cuSPARSELt æµ‹è¯•ç»“æœ

### Task 3: Model é«˜ç¨€ç– (2_4~2_10) âœ…

| æ¨¡å‹ | çŠ¶æ€ | è€—æ—¶ |
|------|------|------|
| Llama3.2-1B-INT8 | âœ… æˆåŠŸ | 435.1s |
| Llama3.2-1B-FP8 | âœ… æˆåŠŸ | 430.6s |
| Llama3.2-3B-INT8 | âœ… æˆåŠŸ | 538.6s |
| Llama3.2-3B-FP8 | âœ… æˆåŠŸ | 564.6s |
| Qwen2.5-7B-INT8 | âœ… æˆåŠŸ | 985.1s |
| Qwen2.5-7B-FP8 | âœ… æˆåŠŸ | 1014.6s |
| Qwen2.5-14B-INT8 | âœ… æˆåŠŸ | 1146.3s |
| Qwen2.5-14B-FP8 | âœ… æˆåŠŸ | 1209.0s |

**ç»Ÿè®¡**: æˆåŠŸ 8/8ï¼Œå¤±è´¥ 0

### Task 4: Square é«˜ç¨€ç– (2_4~2_10) âœ…

- 4 ç§ç¨€ç–åº¦ Ã— 4 ç§ç²¾åº¦ Ã— 9 ä¸ª M å€¼ = 144 ç»„æµ‹è¯•
- å…¨éƒ¨é€šè¿‡
- æ€»è€—æ—¶: 557.7s

### Task 5: Model ä½ç¨€ç– (2_12~2_inf) âœ…

| æ¨¡å‹ | çŠ¶æ€ | è€—æ—¶ |
|------|------|------|
| Llama3.2-1B-INT8 | âœ… æˆåŠŸ | 771.0s |
| Llama3.2-1B-FP8 | âœ… æˆåŠŸ | 878.1s |
| Llama3.2-3B-INT8 | âœ… æˆåŠŸ | 1182.1s |
| Llama3.2-3B-FP8 | âœ… æˆåŠŸ | 1415.8s |
| Qwen2.5-7B-INT8 | âœ… æˆåŠŸ | 2446.9s |
| Qwen2.5-7B-FP8 | âœ… æˆåŠŸ | 3405.2s |
| Qwen2.5-14B-INT8 | âœ… æˆåŠŸ | 4480.9s |
| Qwen2.5-14B-FP8 | âœ… æˆåŠŸ | 5444.2s |

**ç»Ÿè®¡**: æˆåŠŸ 8/8ï¼Œå¤±è´¥ 0

### Task 6: Square ä½ç¨€ç– (2_12~2_inf) âœ…

- 4 ç§ç¨€ç–åº¦ Ã— 4 ç§ç²¾åº¦ Ã— 9 ä¸ª M å€¼ = 144 ç»„æµ‹è¯•
- å…¨éƒ¨é€šè¿‡
- æ€»è€—æ—¶: 2813.7s

---

## 4. é”™è¯¯æƒ…å†µ

### âŒ å¤±è´¥çš„æµ‹è¯•

**æ— ï¼æ‰€æœ‰æµ‹è¯• 100% é€šè¿‡ï¼**

æ‰€æœ‰ 292 ç»„æœç´¢ç»Ÿè®¡å‡æ˜¾ç¤ºï¼š
```
æœç´¢ç»Ÿè®¡: æ€»è®¡=XX, æˆåŠŸ=XX, å¤±è´¥=0, é”™è¯¯=0
æˆåŠŸç‡: 100.0%
```

---

## 5. ç»“æœæ–‡ä»¶æ¸…å•

### cuBLASLt ç»“æœ

```
slidesparse/benchmark_kernel/cuBLASLt/alg_search_results/RTX4090_cc89_py312_cu129_x86_64/
â”œâ”€â”€ FP16/    (18 files: 8 models + 1 square Ã— 2 formats)
â”œâ”€â”€ BF16/    (18 files)
â”œâ”€â”€ INT8/    (18 files)
â””â”€â”€ FP8/     (18 files)
```

**INT8 æ–‡ä»¶åˆ—è¡¨**:
- `alg_search_Llama3.2-1B-INT8.csv/json`
- `alg_search_Llama3.2-1B-FP8.csv/json`
- `alg_search_Llama3.2-3B-INT8.csv/json`
- `alg_search_Llama3.2-3B-FP8.csv/json`
- `alg_search_Qwen2.5-7B-INT8.csv/json`
- `alg_search_Qwen2.5-7B-FP8.csv/json`
- `alg_search_Qwen2.5-14B-INT8.csv/json`
- `alg_search_Qwen2.5-14B-FP8.csv/json`
- `alg_search_SQUARE.csv/json`

### cuSPARSELt ç»“æœ

```
slidesparse/benchmark_kernel/cuSPARSELt/alg_search_results/RTX4090_cc89_py312_cu129_x86_64/
â”œâ”€â”€ FP16/    (144 files: 8 models Ã— 8 sparsities + 8 square Ã— 8 sparsities Ã— 2 formats)
â”œâ”€â”€ BF16/    (144 files)
â”œâ”€â”€ INT8/    (144 files)
â””â”€â”€ FP8/     (144 files)
```

**æ¯ä¸ªç²¾åº¦ç›®å½•åŒ…å«**:
- 8 ä¸ªæ¨¡å‹ Ã— 8 ç§ç¨€ç–åº¦ Ã— 2 æ ¼å¼ = 128 ä¸ªæ¨¡å‹æ–‡ä»¶
- 8 ç§ç¨€ç–åº¦ Ã— 2 æ ¼å¼ = 16 ä¸ª Square æ–‡ä»¶

---

## 6. å…³é”®è¯´æ˜

### RTX 4090 FP8 æ”¯æŒ

- RTX 4090 æ˜¯ Ada Lovelace æ¶æ„ (CC 8.9)ï¼Œ**æ”¯æŒåŸç”Ÿ FP8**
- æ‰€æœ‰ FP8 æµ‹è¯•å‡æ­£å¸¸å®Œæˆ
- æ— éœ€è·³è¿‡ä»»ä½• FP8 ç›¸å…³æµ‹è¯•

### M åˆ—è¡¨è°ƒæ•´

åŸå§‹é…ç½®åŒ…å« M=32768 å’Œ M=65536ï¼Œä½†ç”±äºï¼š
1. æ˜¾å­˜é™åˆ¶ (65536Ã—65536 æ–¹é˜µéœ€è¦ ~24GB)
2. æµ‹è¯•æ—¶é—´è¿‡é•¿ (M=65536 å•æ¬¡æµ‹è¯•éœ€è¦æ•°å°æ—¶)

å·²å°† M åˆ—è¡¨è°ƒæ•´ä¸º `[64, 128, 256, 512, 1024, 2048, 4096, 8192, 16384]`ï¼Œè¦†ç›–å®é™…ç”Ÿäº§ä¸­å¸¸è§çš„ batch size èŒƒå›´ã€‚

---

## 7. æ—¥å¿—æ–‡ä»¶ä½ç½®

```
slidesparse/benchmark_kernel/kernel_bench_logs/
â”œâ”€â”€ kernel_bench_20260127_105608.log         # Task 1 æ—¥å¿—
â”œâ”€â”€ kernel_bench_20260127_105608_status.json # Task 1 çŠ¶æ€ (è¢«ä¸­æ–­)
â”œâ”€â”€ kernel_bench_20260127_185621.log         # Task 2-6 æ—¥å¿—
â””â”€â”€ kernel_bench_20260127_185621_status.json # Task 2-6 çŠ¶æ€ (å®Œæˆ)
```

---

## 8. ç»“è®º

âœ… **RTX 4090 ä¸Šçš„ Kernel Benchmark å…¨éƒ¨æˆåŠŸå®Œæˆï¼**

- cuBLASLt Dense GEMM ç®—æ³•æœç´¢: **å…¨éƒ¨é€šè¿‡**
- cuSPARSELt Sparse GEMM ç®—æ³•æœç´¢: **å…¨éƒ¨é€šè¿‡**
- 8 ç§ç¨€ç–åº¦é…ç½® (2_4 ~ 2_inf): **å…¨éƒ¨è¦†ç›–**
- 4 ç§ç²¾åº¦ (FP16, BF16, INT8, FP8): **å…¨éƒ¨æµ‹è¯•**
- 8 ä¸ªæ¨¡å‹ + Square æµ‹è¯•: **å…¨éƒ¨å®Œæˆ**

**æ— éœ€é‡è·‘ä»»ä½•æµ‹è¯•ã€‚**

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**: 2026-01-28 03:14 PST
