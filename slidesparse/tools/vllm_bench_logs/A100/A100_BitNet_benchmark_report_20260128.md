# A100 BitNet Benchmark æœ€ç»ˆæŠ¥å‘Š

**æ—¥å¿—æ–‡ä»¶**: `bitnet_bench_20260127_234625.log`  
**æ—¶é—´**: 2026-01-28 01:03  
**æ€»è€—æ—¶**: 1.29 å°æ—¶ (4627.8ç§’)  
**GPU**: NVIDIA A100 80GB PCIe (CC 8.0, Ampere)

---

## ğŸ“Š æœ€ç»ˆç»“æœæ±‡æ€»

### ğŸ‰ æ€»ä½“æƒ…å†µ: å…¨éƒ¨æˆåŠŸï¼

| ä»»åŠ¡ | çŠ¶æ€ | è€—æ—¶ | è¯´æ˜ |
|------|------|------|------|
| Task 1: åŸºç¡€æ¨¡å‹å‡†å¤‡ | âœ… æˆåŠŸ | 0.0s | æ¨¡å‹å·²å­˜åœ¨ï¼Œè·³è¿‡ä¸‹è½½/é‡åŒ– |
| Task 2: SlideSparse è½¬æ¢ | âœ… æˆåŠŸ | 0.0s | 8ä¸ªæ¨¡å‹å·²å­˜åœ¨ï¼Œè·³è¿‡è½¬æ¢ |
| Task 3: ç¦»çº¿è°ƒä¼˜ | âœ… æˆåŠŸ | 500.4s | ç²—è°ƒä¼˜ + ç»†è°ƒä¼˜ |
| Task 4: Prefill Benchmark | âœ… æˆåŠŸ | 2584.4s | INT8 å…¨éƒ¨é€šè¿‡ï¼ŒFP8 è·³è¿‡ |
| Task 5: Decode Benchmark | âœ… æˆåŠŸ | 1082.3s | INT8 å…¨éƒ¨é€šè¿‡ï¼ŒFP8 è·³è¿‡ |
| Task 6: Kernel cuBLASLt | âœ… æˆåŠŸ | 52.9s | INT8 å…¨éƒ¨é€šè¿‡ |
| Task 7: Kernel cuSPARSELt é«˜ç¨€ç– | âœ… æˆåŠŸ | 188.9s | 2_4, 2_6, 2_8, 2_10 |
| Task 8: Kernel cuSPARSELt ä½ç¨€ç– | âœ… æˆåŠŸ | 219.0s | 2_12, 2_14, 2_16, 2_inf |

**ç»Ÿè®¡**: `8 æˆåŠŸ, 0 å¤±è´¥, 0 è·³è¿‡`

---

## 1. æ¨¡å‹å‡†å¤‡ç»“æœ (Task 1 & 2)

### åŸºç¡€æ¨¡å‹ âœ…

| æ¨¡å‹ | è·¯å¾„ | çŠ¶æ€ |
|------|------|------|
| BitNet-2B-BF16 | `checkpoints/BitNet-2B-BF16/` | âœ… å·²å­˜åœ¨ |
| BitNet-2B-INT8 | `checkpoints/BitNet-2B-INT8/` | âœ… å·²å­˜åœ¨ |
| BitNet-2B-FP8 | `checkpoints/BitNet-2B-FP8/` | âœ… å·²å­˜åœ¨ |

### SlideSparse æ¨¡å‹ âœ…

| åŸºç¡€æ¨¡å‹ | 2:4 | 2:6 | 2:8 | 2:10 |
|----------|-----|-----|-----|------|
| BitNet-2B-INT8 | âœ… | âœ… | âœ… | âœ… |
| BitNet-2B-FP8 | âœ… | âœ… | âœ… | âœ… |

**è·¯å¾„**: `checkpoints_slidesparse/{æ¨¡å‹å}-SlideSparse-{Z}_{L}/`

---

## 2. ç¦»çº¿è°ƒä¼˜ç»“æœ (Task 3)

### ç²—è°ƒä¼˜ (cuBLASLt + Triton quant_only) âœ…

- M åˆ—è¡¨: `[256, 1024, 4096, 16384, 32768]`
- è€—æ—¶: 215.5s
- ç»“æœ:
  - âœ… cuBLASLt GEMM (int8) å®Œæˆ
  - âœ… Triton Quant Only å®Œæˆ

### ç»†è°ƒä¼˜ (cuSPARSELt + Triton Dequant/QuantSlide) âœ…

- M åˆ—è¡¨: `[64, 128, 256, 512, 1024, 2048, 4096, 8192, 16384, 32768]`
- è€—æ—¶: 284.9s
- ç»“æœ:
  - âœ… cuSPARSELt GEMM (int8) å®Œæˆ
  - âœ… Triton Dequant + Bias å®Œæˆ
  - âœ… Triton Quant + Slide å®Œæˆ

### âš ï¸ FP8 è°ƒä¼˜è¯´æ˜

```
[WARNING] GPU A100 (cc80) ä¸æ”¯æŒåŸç”Ÿ FP8ï¼Œè·³è¿‡ cuBLASLt GEMM FP8 è°ƒä¼˜
[WARNING] GPU A100 (cc80) ä¸æ”¯æŒåŸç”Ÿ FP8ï¼Œè·³è¿‡ cuSPARSELt GEMM FP8 è°ƒä¼˜
```

A100 æ˜¯ Ampere æ¶æ„ (CC 8.0)ï¼Œ**ä¸æ”¯æŒåŸç”Ÿ FP8**ã€‚FP8 éœ€è¦:
- Ada Lovelace (CC 8.9+) å¦‚ RTX 4090
- Hopper (CC 9.0+) å¦‚ H100

---

## 3. Prefill Benchmark ç»“æœ (Task 4)

### é…ç½®

- **æ¨¡å‹**: `bitnet1.58-2b-int8`, `bitnet1.58-2b-fp8`
- **M åˆ—è¡¨**: `[512, 1024, 2048, 4096, 8192, 16384, 32768]` (7ä¸ª)
- **Backend**: `cuBLASLt`, `cuSPARSELt (2:4, 2:6, 2:8, 2:10)` (5ä¸ª)

### ç»“æœç»Ÿè®¡

| æ¨¡å‹ | cuBLASLt | cuSPARSELt 2:4 | cuSPARSELt 2:6 | cuSPARSELt 2:8 | cuSPARSELt 2:10 | Total |
|------|----------|----------------|----------------|----------------|-----------------|-------|
| **BitNet-2B-INT8** | 7/7 âœ… | 7/7 âœ… | 7/7 âœ… | 7/7 âœ… | 7/7 âœ… | **35/35** |
| BitNet-2B-FP8 | â­ï¸ è·³è¿‡ | â­ï¸ è·³è¿‡ | â­ï¸ è·³è¿‡ | â­ï¸ è·³è¿‡ | â­ï¸ è·³è¿‡ | 0 (é¢„æœŸ) |

### æ€§èƒ½æ•°æ® (BitNet-2B-INT8 cuBLASLt)

| M | requests/s | tokens/s | è€—æ—¶ |
|---|------------|----------|------|
| 512 | 18.01 | 9,239 | 7.1s |
| 1024 | 17.88 | 18,325 | 7.2s |
| 2048 | 36.35 | 37,260 | 7.0s |
| 4096 | 49.64 | 50,883 | 10.3s |
| 8192 | 52.00 | 53,295 | 19.7s |
| 16384 | 52.97 | 54,295 | 38.7s |
| 32768 | 53.24 | 54,568 | 76.9s |

### ç»“æœæ–‡ä»¶

```
throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/
â”œâ”€â”€ cublaslt/BitNet-2B-INT8_prefill.csv
â””â”€â”€ cusparselt/
    â”œâ”€â”€ 2_4/BitNet-2B-INT8_prefill.csv
    â”œâ”€â”€ 2_6/BitNet-2B-INT8_prefill.csv
    â”œâ”€â”€ 2_8/BitNet-2B-INT8_prefill.csv
    â””â”€â”€ 2_10/BitNet-2B-INT8_prefill.csv
```

---

## 4. Decode Benchmark ç»“æœ (Task 5)

### é…ç½®

- **æ¨¡å‹**: `bitnet1.58-2b-int8`, `bitnet1.58-2b-fp8`
- **M åˆ—è¡¨**: `[64, 128, 256, 512]` (4ä¸ª)
- **Backend**: `cuBLASLt`, `cuSPARSELt (2:4, 2:6, 2:8, 2:10)` (5ä¸ª)

### ç»“æœç»Ÿè®¡

| æ¨¡å‹ | cuBLASLt | cuSPARSELt 2:4 | cuSPARSELt 2:6 | cuSPARSELt 2:8 | cuSPARSELt 2:10 | Total |
|------|----------|----------------|----------------|----------------|-----------------|-------|
| **BitNet-2B-INT8** | 4/4 âœ… | 4/4 âœ… | 4/4 âœ… | 4/4 âœ… | 4/4 âœ… | **20/20** |
| BitNet-2B-FP8 | â­ï¸ è·³è¿‡ | â­ï¸ è·³è¿‡ | â­ï¸ è·³è¿‡ | â­ï¸ è·³è¿‡ | â­ï¸ è·³è¿‡ | 0 (é¢„æœŸ) |

### æ€§èƒ½æ•°æ® (BitNet-2B-INT8 cuBLASLt)

| M | requests/s | tokens/s | è€—æ—¶ |
|---|------------|----------|------|
| 64 | 26.07 | 7,091 | 2.5s |
| 128 | 40.23 | 10,943 | 3.2s |
| 256 | 58.73 | 15,974 | 4.4s |
| 512 | 58.55 | 15,927 | 8.7s |

### ç»“æœæ–‡ä»¶

```
throughput_benchmark_results/decode/A100_cc80_INT8_py312_cu129_x86_64/
â”œâ”€â”€ cublaslt/BitNet-2B-INT8_decode.csv
â””â”€â”€ cusparselt/
    â”œâ”€â”€ 2_4/BitNet-2B-INT8_decode.csv
    â”œâ”€â”€ 2_6/BitNet-2B-INT8_decode.csv
    â”œâ”€â”€ 2_8/BitNet-2B-INT8_decode.csv
    â””â”€â”€ 2_10/BitNet-2B-INT8_decode.csv
```

---

## 5. Kernel Benchmark ç»“æœ (Task 6/7/8)

### é…ç½®

- **æ¨¡å‹**: `BitNet-2B` (INT8 + FP8)
- **M åˆ—è¡¨**: `[64, 128, 256, 512, 1024, 2048, 4096, 8192, 16384]` (9ä¸ª)

### Task 6: cuBLASLt âœ…

- è€—æ—¶: 52.9s
- INT8: å…¨éƒ¨é€šè¿‡
- FP8: A100 ä¸æ”¯æŒï¼Œå·²è·³è¿‡

### Task 7: cuSPARSELt é«˜ç¨€ç– âœ…

- ç¨€ç–åº¦: `2_4, 2_6, 2_8, 2_10`
- è€—æ—¶: 188.9s
- INT8: å…¨éƒ¨é€šè¿‡
- FP8: A100 ä¸æ”¯æŒï¼Œå·²è·³è¿‡

### Task 8: cuSPARSELt ä½ç¨€ç– âœ…

- ç¨€ç–åº¦: `2_12, 2_14, 2_16, 2_inf`
- è€—æ—¶: 219.0s
- INT8: å…¨éƒ¨é€šè¿‡
- FP8: A100 ä¸æ”¯æŒï¼Œå·²è·³è¿‡

### ç»“æœæ–‡ä»¶

```
benchmark_kernel/
â”œâ”€â”€ cuBLASLt/alg_search_results/
â””â”€â”€ cuSPARSELt/alg_search_results/
```

---

## 6. é”™è¯¯/å¤±è´¥ç»Ÿè®¡

### âŒ å¤±è´¥çš„æµ‹è¯•: æ— 

**æ‰€æœ‰ INT8 æµ‹è¯•å…¨éƒ¨é€šè¿‡ï¼Œæ²¡æœ‰ä»»ä½•å¤±è´¥ï¼**

### âš ï¸ è¢«è·³è¿‡çš„æµ‹è¯• (é¢„æœŸè¡Œä¸º)

| æµ‹è¯•ç±»å‹ | æ¨¡å‹ | åŸå›  |
|----------|------|------|
| Prefill Benchmark | BitNet-2B-FP8 | A100 ä¸æ”¯æŒ FP8 |
| Decode Benchmark | BitNet-2B-FP8 | A100 ä¸æ”¯æŒ FP8 |
| cuBLASLt Kernel | FP8 | A100 ä¸æ”¯æŒ FP8 |
| cuSPARSELt Kernel | FP8 | A100 ä¸æ”¯æŒ FP8 |

è¿™äº›è·³è¿‡æ˜¯**é¢„æœŸè¡Œä¸º**ï¼Œä¸æ˜¯é”™è¯¯ã€‚

---

## 7. å®Œæ•´æµ‹è¯•çŸ©é˜µæ±‡æ€»

### BitNet-2B-INT8 æµ‹è¯•å®Œæˆæƒ…å†µ

| é˜¶æ®µ | Backend | M å€¼ | çŠ¶æ€ |
|------|---------|------|------|
| **Prefill** | cuBLASLt | 512, 1024, 2048, 4096, 8192, 16384, 32768 | âœ… 7/7 |
| **Prefill** | cuSPARSELt 2:4 | 512, 1024, 2048, 4096, 8192, 16384, 32768 | âœ… 7/7 |
| **Prefill** | cuSPARSELt 2:6 | 512, 1024, 2048, 4096, 8192, 16384, 32768 | âœ… 7/7 |
| **Prefill** | cuSPARSELt 2:8 | 512, 1024, 2048, 4096, 8192, 16384, 32768 | âœ… 7/7 |
| **Prefill** | cuSPARSELt 2:10 | 512, 1024, 2048, 4096, 8192, 16384, 32768 | âœ… 7/7 |
| **Decode** | cuBLASLt | 64, 128, 256, 512 | âœ… 4/4 |
| **Decode** | cuSPARSELt 2:4 | 64, 128, 256, 512 | âœ… 4/4 |
| **Decode** | cuSPARSELt 2:6 | 64, 128, 256, 512 | âœ… 4/4 |
| **Decode** | cuSPARSELt 2:8 | 64, 128, 256, 512 | âœ… 4/4 |
| **Decode** | cuSPARSELt 2:10 | 64, 128, 256, 512 | âœ… 4/4 |

**Prefill æ€»è®¡**: 35/35 (100%)  
**Decode æ€»è®¡**: 20/20 (100%)  
**æ•´ä½“é€šè¿‡ç‡**: 55/55 (100%)

---

## 8. ç»“è®ºä¸å»ºè®®

### âœ… æˆåŠŸè¦ç‚¹

1. **BitNet-2B-INT8 æ¨¡å‹åœ¨ A100 ä¸Šå®Œå…¨é€šè¿‡æ‰€æœ‰æµ‹è¯•**
   - Prefill: æ‰€æœ‰ M å€¼ (512~32768) å…¨éƒ¨é€šè¿‡
   - Decode: æ‰€æœ‰ M å€¼ (64~512) å…¨éƒ¨é€šè¿‡
   - Kernel: æ‰€æœ‰ç¨€ç–åº¦ (2:4~2:inf) å…¨éƒ¨é€šè¿‡

2. **FP8 æµ‹è¯•è¢«æ­£ç¡®è·³è¿‡**
   - A100 ä¸æ”¯æŒåŸç”Ÿ FP8ï¼Œç³»ç»Ÿæ­£ç¡®è¯†åˆ«å¹¶è·³è¿‡
   - æ²¡æœ‰å´©æºƒæˆ–é”™è¯¯

3. **æ€§èƒ½è¡¨ç°ç¨³å®š**
   - Prefill ååé‡: ~54,000 tokens/s (M=32768)
   - Decode ååé‡: ~16,000 tokens/s (M=512)

### ğŸ“‹ åç»­å·¥ä½œ

å¦‚æœéœ€è¦æµ‹è¯• FP8ï¼Œå»ºè®®åœ¨ä»¥ä¸‹ç¡¬ä»¶ä¸Šè¿›è¡Œ:
- **RTX 4090** (Ada Lovelace, CC 8.9)
- **H100** (Hopper, CC 9.0)

### ğŸ“ æ—¥å¿—æ–‡ä»¶ä½ç½®

- **ä¸»æ—¥å¿—**: `slidesparse/tools/bitnet_bench_20260127_234625.log`
- **çŠ¶æ€æ–‡ä»¶**: `slidesparse/tools/bitnet_bench_20260127_234625_status.json`

---

*æŠ¥å‘Šç”Ÿæˆæ—¶é—´: 2026-01-28*
