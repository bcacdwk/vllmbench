# H100 BitNet Benchmark æœ€ç»ˆæŠ¥å‘Š

**æ—¥å¿—æ–‡ä»¶**: `bitnet_bench_20260128_075630.log`  
**æ—¶é—´**: 2026-01-28 10:15  
**æ€»è€—æ—¶**: 2.32 å°æ—¶ (8346.5ç§’)  
**GPU**: NVIDIA H100 PCIe (CC 9.0, Hopper)

---

## ğŸ“Š æœ€ç»ˆç»“æœæ±‡æ€»

### ğŸ‰ æ€»ä½“æƒ…å†µ: å…¨éƒ¨æˆåŠŸï¼

| ä»»åŠ¡ | çŠ¶æ€ | è€—æ—¶ | è¯´æ˜ |
|------|------|------|------|
| Task 1: åŸºç¡€æ¨¡å‹å‡†å¤‡ | âœ… æˆåŠŸ | 102.6s | ä¸‹è½½ BF16 + é‡åŒ– INT8/FP8 |
| Task 2: SlideSparse è½¬æ¢ | âœ… æˆåŠŸ | 449.1s | ç”Ÿæˆ 8 ä¸ª SlideSparse æ¨¡å‹ |
| Task 3: ç¦»çº¿è°ƒä¼˜ | âœ… æˆåŠŸ | 1135.0s | ç²—è°ƒä¼˜ + ç»†è°ƒä¼˜ |
| Task 4: Prefill Benchmark | âœ… æˆåŠŸ | 3895.1s | INT8 + FP8 å…¨éƒ¨é€šè¿‡ |
| Task 5: Decode Benchmark | âœ… æˆåŠŸ | 1740.8s | INT8 + FP8 å…¨éƒ¨é€šè¿‡ |
| Task 6: Kernel cuBLASLt | âœ… æˆåŠŸ | 35.3s | INT8 + FP8 å…¨éƒ¨é€šè¿‡ |
| Task 7: Kernel cuSPARSELt é«˜ç¨€ç– | âœ… æˆåŠŸ | 440.5s | 2_4, 2_6, 2_8, 2_10 |
| Task 8: Kernel cuSPARSELt ä½ç¨€ç– | âœ… æˆåŠŸ | 548.1s | 2_12, 2_14, 2_16, 2_inf |

**ç»Ÿè®¡**: `8 æˆåŠŸ, 0 å¤±è´¥, 0 è·³è¿‡`

---

## 1. æ¨¡å‹å‡†å¤‡ç»“æœ (Task 1 & 2)

### åŸºç¡€æ¨¡å‹ âœ…

| æ¨¡å‹ | è·¯å¾„ | çŠ¶æ€ | è€—æ—¶ |
|------|------|------|------|
| BitNet-2B-BF16 | `checkpoints/BitNet-2B-BF16/` | âœ… ä¸‹è½½æˆåŠŸ | 44.1s |
| BitNet-2B-INT8 | `checkpoints/BitNet-2B-INT8/` | âœ… é‡åŒ–æˆåŠŸ | 19.1s |
| BitNet-2B-FP8 | `checkpoints/BitNet-2B-FP8/` | âœ… é‡åŒ–æˆåŠŸ | 19.3s |

### SlideSparse æ¨¡å‹ âœ… (8/8)

| åŸºç¡€æ¨¡å‹ | 2:4 | 2:6 | 2:8 | 2:10 | è€—æ—¶ |
|----------|-----|-----|-----|------|------|
| BitNet-2B-INT8 | âœ… | âœ… | âœ… | âœ… | 44.4s, 53.8s, 63.0s, 63.7s |
| BitNet-2B-FP8 | âœ… | âœ… | âœ… | âœ… | 51.0s, 56.8s, 57.7s, 58.6s |

**è·¯å¾„**: `checkpoints_slidesparse/{æ¨¡å‹å}-SlideSparse-{Z}_{L}/`

---

## 2. ç¦»çº¿è°ƒä¼˜ç»“æœ (Task 3)

### ç²—è°ƒä¼˜ (cuBLASLt + Triton quant_only) âœ…

- **M åˆ—è¡¨**: `[256, 1024, 4096, 16384, 32768]`
- **è€—æ—¶**: 193.2s
- **ç»“æœ**:
  - âœ… cuBLASLt GEMM (int8) å®Œæˆ
  - âœ… cuBLASLt GEMM (fp8) å®Œæˆ
  - âœ… Triton Quant Only å®Œæˆ

### ç»†è°ƒä¼˜ (cuSPARSELt + Triton Dequant/QuantSlide) âœ…

- **M åˆ—è¡¨**: `[64, 128, 256, 512, 1024, 2048, 4096, 8192, 16384, 32768]`
- **ç»“æœ**:
  - âœ… cuSPARSELt GEMM (int8) å®Œæˆ
  - âœ… cuSPARSELt GEMM (fp8) å®Œæˆ
  - âœ… Triton Dequant + Bias å®Œæˆ
  - âœ… Triton Quant + Slide å®Œæˆ

### âœ… H100 FP8 åŸç”Ÿæ”¯æŒ

H100 æ˜¯ Hopper æ¶æ„ (CC 9.0)ï¼Œ**åŸç”Ÿæ”¯æŒ FP8**ï¼Œæ‰€æœ‰ FP8 æµ‹è¯•å‡å·²æ‰§è¡Œå¹¶é€šè¿‡ã€‚

---

## 3. Prefill Benchmark ç»“æœ (Task 4)

### é…ç½®

- **æ¨¡å‹**: `bitnet1.58-2b-int8`, `bitnet1.58-2b-fp8`
- **M åˆ—è¡¨**: `[512, 1024, 2048, 4096, 8192, 16384, 32768]` (7ä¸ª)
- **Backend**: `cuBLASLt`, `cuSPARSELt (2:4, 2:6, 2:8, 2:10)` (5ä¸ª)

### ç»“æœç»Ÿè®¡

| æ¨¡å‹ | cuBLASLt | cuSPARSELt 2:4 | cuSPARSELt 2:6 | cuSPARSELt 2:8 | cuSPARSELt 2:10 | Total |
|------|----------|----------------|----------------|----------------|-----------------|-------|
| **BitNet-2B-INT8** | 7/7 âœ… | 7/7 âœ… | 7/7 âœ… | 7/7 âœ… | 7/7 âœ… | **35/35** |
| **BitNet-2B-FP8** | 7/7 âœ… | 7/7 âœ… | 7/7 âœ… | 7/7 âœ… | 7/7 âœ… | **35/35** |

**Prefill æ€»è®¡**: 70/70 (100%)

### æ€§èƒ½æ•°æ® (BitNet-2B-INT8 cuBLASLt)

| M | requests/s | tokens/s | è€—æ—¶ |
|---|------------|----------|------|
| 512 | 29.13 | 14,945 | 4.4s |
| 1024 | 29.82 | 30,565 | 4.3s |
| 2048 | 55.32 | 56,699 | 4.6s |
| 4096 | 77.36 | 79,292 | 6.6s |
| 8192 | 86.58 | 88,749 | 11.8s |
| 16384 | 89.92 | 92,168 | 22.8s |
| 32768 | 91.82 | 94,114 | 44.6s |

### ç»“æœæ–‡ä»¶

```
throughput_benchmark_results/prefill/
â”œâ”€â”€ H100_cc90_INT8_py312_cu129_x86_64/
â”‚   â”œâ”€â”€ cublaslt/BitNet-2B-INT8_prefill.csv
â”‚   â””â”€â”€ cusparselt/{2_4,2_6,2_8,2_10}/BitNet-2B-INT8_prefill.csv
â””â”€â”€ H100_cc90_FP8E4M3_py312_cu129_x86_64/
    â”œâ”€â”€ cublaslt/BitNet-2B-FP8_prefill.csv
    â””â”€â”€ cusparselt/{2_4,2_6,2_8,2_10}/BitNet-2B-FP8_prefill.csv
```

---

## 4. Decode Benchmark ç»“æœ (Task 5)

### é…ç½®

- **æ¨¡å‹**: `bitnet1.58-2b-int8`, `bitnet1.58-2b-fp8`
- **M åˆ—è¡¨**: `[64, 128, 256, 512]` (4ä¸ª)
- **Backend**: `cuBLASLt`, `cuSPARSELt (2:4, 2:6, 2:8, 2:10)` (5ä¸ª)

### ç»“æœç»Ÿè®¡

| æ¨¡å‹ | cuBLASLt | cuSPARSELt 2:4 | cuSPARSELt 2:6 | cuSPARSELt 2:8 | cuSPARSELt 2:10 | Total |
|------|----------|----------------|----------------|----------------|-----------------|-------|
| **BitNet-2B-INT8** | 4/4 âœ… | 4/4 âœ… | 4/4 âœ… | 4/4 âœ… | 4/4 âœ… | **20/20** |
| **BitNet-2B-FP8** | 4/4 âœ… | 4/4 âœ… | 4/4 âœ… | 4/4 âœ… | 4/4 âœ… | **20/20** |

**Decode æ€»è®¡**: 40/40 (100%)

### æ€§èƒ½æ•°æ® (BitNet-2B-INT8 cuBLASLt)

| M | requests/s | tokens/s | è€—æ—¶ |
|---|------------|----------|------|
| 64 | 29.82 | 8,111 | 2.1s |
| 128 | 48.42 | 13,170 | 2.6s |
| 256 | 74.55 | 20,277 | 3.4s |
| 512 | 76.12 | 20,705 | 6.7s |

### ç»“æœæ–‡ä»¶

```
throughput_benchmark_results/decode/
â”œâ”€â”€ H100_cc90_INT8_py312_cu129_x86_64/
â”‚   â”œâ”€â”€ cublaslt/BitNet-2B-INT8_decode.csv
â”‚   â””â”€â”€ cusparselt/{2_4,2_6,2_8,2_10}/BitNet-2B-INT8_decode.csv
â””â”€â”€ H100_cc90_FP8E4M3_py312_cu129_x86_64/
    â”œâ”€â”€ cublaslt/BitNet-2B-FP8_decode.csv
    â””â”€â”€ cusparselt/{2_4,2_6,2_8,2_10}/BitNet-2B-FP8_decode.csv
```

---

## 5. Kernel Benchmark ç»“æœ (Task 6/7/8)

### é…ç½®

- **æ¨¡å‹**: `BitNet-2B` (INT8 + FP8)
- **M åˆ—è¡¨**: `[64, 128, 256, 512, 1024, 2048, 4096, 8192, 16384]` (9ä¸ª)

### Task 6: cuBLASLt âœ…

- **è€—æ—¶**: 35.3s
- âœ… FP8: å…¨éƒ¨é€šè¿‡ (16.1s)
- âœ… INT8: å…¨éƒ¨é€šè¿‡ (19.2s)

### Task 7: cuSPARSELt é«˜ç¨€ç– âœ…

- **ç¨€ç–åº¦**: `2_4, 2_6, 2_8, 2_10`
- **è€—æ—¶**: 440.5s
- âœ… FP8: å…¨éƒ¨é€šè¿‡ (239.6s)
- âœ… INT8: å…¨éƒ¨é€šè¿‡ (200.9s)

### Task 8: cuSPARSELt ä½ç¨€ç– âœ…

- **ç¨€ç–åº¦**: `2_12, 2_14, 2_16, 2_inf`
- **è€—æ—¶**: 548.1s
- âœ… FP8: å…¨éƒ¨é€šè¿‡ (298.0s)
- âœ… INT8: å…¨éƒ¨é€šè¿‡ (250.1s)

### ç»“æœæ–‡ä»¶

```
benchmark_kernel/
â”œâ”€â”€ cuBLASLt/alg_search_results/H100_cc90_py312_cu129_x86_64/
â””â”€â”€ cuSPARSELt/alg_search_results/H100_cc90_py312_cu129_x86_64/
```

---

## 6. é”™è¯¯/å¤±è´¥ç»Ÿè®¡

### âŒ å¤±è´¥çš„æµ‹è¯•: æ— 

**æ‰€æœ‰ INT8 å’Œ FP8 æµ‹è¯•å…¨éƒ¨é€šè¿‡ï¼Œæ²¡æœ‰ä»»ä½•å¤±è´¥ï¼**

### è¯¦ç»†æµ‹è¯•é€šè¿‡æƒ…å†µ

| æµ‹è¯•ç±»å‹ | INT8 | FP8 | æ€»è®¡ |
|----------|------|-----|------|
| Prefill Benchmark | 35/35 âœ… | 35/35 âœ… | 70/70 |
| Decode Benchmark | 20/20 âœ… | 20/20 âœ… | 40/40 |
| cuBLASLt Kernel | âœ… | âœ… | 2/2 |
| cuSPARSELt é«˜ç¨€ç– Kernel | âœ… | âœ… | 2/2 |
| cuSPARSELt ä½ç¨€ç– Kernel | âœ… | âœ… | 2/2 |

---

## 7. å®Œæ•´æµ‹è¯•çŸ©é˜µæ±‡æ€»

### BitNet-2B-INT8 æµ‹è¯•å®Œæˆæƒ…å†µ

| é˜¶æ®µ | Backend | M å€¼ | çŠ¶æ€ |
|------|---------|------|------|
| **Prefill** | cuBLASLt | 512, 1024, 2048, 4096, 8192, 16384, 32768 | âœ… 7/7 |
| **Prefill** | cuSPARSELt 2:4 | 512, 1024, 2048, 4096, 8192, 16384, 32768 | âœ… 7/7 |
| **Prefill** | cuSPARSELt 2:6 | 512, 1024, 2048, 4096, 8192, 16384, 32768 | âœ… 7/7 |
| **Prefill** | cuSPARSELt 2:8 | 512, 1024, 2048, 4096, 8192, 16384, 32768 | âœ… 7/7 |
| **Prefill** | cuSPARSELt 2:10 | 512, 1024, 2048, 4096, 8192, 16384, 32768 | âœ… 7/7 |
| **Decode** | cuBLASLt | 64, 128, 256, 512 | âœ… 4/4 |
| **Decode** | cuSPARSELt 2:4 | 64, 128, 256, 512 | âœ… 4/4 |
| **Decode** | cuSPARSELt 2:6 | 64, 128, 256, 512 | âœ… 4/4 |
| **Decode** | cuSPARSELt 2:8 | 64, 128, 256, 512 | âœ… 4/4 |
| **Decode** | cuSPARSELt 2:10 | 64, 128, 256, 512 | âœ… 4/4 |

### BitNet-2B-FP8 æµ‹è¯•å®Œæˆæƒ…å†µ

| é˜¶æ®µ | Backend | M å€¼ | çŠ¶æ€ |
|------|---------|------|------|
| **Prefill** | cuBLASLt | 512, 1024, 2048, 4096, 8192, 16384, 32768 | âœ… 7/7 |
| **Prefill** | cuSPARSELt 2:4 | 512, 1024, 2048, 4096, 8192, 16384, 32768 | âœ… 7/7 |
| **Prefill** | cuSPARSELt 2:6 | 512, 1024, 2048, 4096, 8192, 16384, 32768 | âœ… 7/7 |
| **Prefill** | cuSPARSELt 2:8 | 512, 1024, 2048, 4096, 8192, 16384, 32768 | âœ… 7/7 |
| **Prefill** | cuSPARSELt 2:10 | 512, 1024, 2048, 4096, 8192, 16384, 32768 | âœ… 7/7 |
| **Decode** | cuBLASLt | 64, 128, 256, 512 | âœ… 4/4 |
| **Decode** | cuSPARSELt 2:4 | 64, 128, 256, 512 | âœ… 4/4 |
| **Decode** | cuSPARSELt 2:6 | 64, 128, 256, 512 | âœ… 4/4 |
| **Decode** | cuSPARSELt 2:8 | 64, 128, 256, 512 | âœ… 4/4 |
| **Decode** | cuSPARSELt 2:10 | 64, 128, 256, 512 | âœ… 4/4 |

**INT8 æ€»è®¡**: Prefill 35/35 + Decode 20/20 = 55/55 (100%)  
**FP8 æ€»è®¡**: Prefill 35/35 + Decode 20/20 = 55/55 (100%)  
**æ•´ä½“é€šè¿‡ç‡**: 110/110 (100%)

---

## 8. ä¸ A100 å¯¹æ¯”

| å¯¹æ¯”é¡¹ | A100 | H100 |
|--------|------|------|
| æ¶æ„ | Ampere (CC 8.0) | Hopper (CC 9.0) |
| FP8 æ”¯æŒ | âŒ ä¸æ”¯æŒ | âœ… åŸç”Ÿæ”¯æŒ |
| INT8 æµ‹è¯• | 55/55 âœ… | 55/55 âœ… |
| FP8 æµ‹è¯• | è·³è¿‡ | 55/55 âœ… |
| æ€»æµ‹è¯•æ•° | 55 | 110 |
| æ€»è€—æ—¶ | 1.29 å°æ—¶ | 2.32 å°æ—¶ |
| Prefill å³°å€¼åå | ~54,568 tok/s | ~94,114 tok/s |
| Decode å³°å€¼åå | ~15,974 tok/s | ~20,705 tok/s |

H100 ç›¸æ¯” A100:
- **Prefill ååæå‡**: ~72% (54k â†’ 94k tok/s)
- **Decode ååæå‡**: ~30% (16k â†’ 21k tok/s)

---

## 9. ç»“è®ºä¸å»ºè®®

### âœ… æˆåŠŸè¦ç‚¹

1. **BitNet-2B æ¨¡å‹åœ¨ H100 ä¸Šå®Œå…¨é€šè¿‡æ‰€æœ‰æµ‹è¯•**
   - INT8: Prefill + Decode å…¨éƒ¨é€šè¿‡
   - FP8: Prefill + Decode å…¨éƒ¨é€šè¿‡
   - Kernel: æ‰€æœ‰ç¨€ç–åº¦ (2:4~2:inf) å…¨éƒ¨é€šè¿‡

2. **H100 FP8 åŸç”Ÿæ”¯æŒè¡¨ç°ä¼˜å¼‚**
   - æ‰€æœ‰ FP8 æµ‹è¯•å‡æ­£å¸¸æ‰§è¡Œ
   - æ€§èƒ½ä¸ INT8 ç›¸å½“æˆ–æ›´ä¼˜

3. **æ€§èƒ½è¡¨ç°å‡ºè‰²**
   - Prefill ååé‡: ~94,000 tokens/s (M=32768)
   - Decode ååé‡: ~21,000 tokens/s (M=512)

### ğŸ“‹ æ— éœ€é‡è·‘

**æ‰€æœ‰æµ‹è¯•å·² 100% é€šè¿‡ï¼Œæ— éœ€é‡è·‘ä»»ä½•æµ‹è¯•ã€‚**

### ğŸ“ æ—¥å¿—æ–‡ä»¶ä½ç½®

- **ä¸»æ—¥å¿—**: `slidesparse/tools/bitnet_bench_20260128_075630.log`
- **çŠ¶æ€æ–‡ä»¶**: `slidesparse/tools/bitnet_bench_20260128_075630_status.json`

---

*æŠ¥å‘Šç”Ÿæˆæ—¶é—´: 2026-01-28*
