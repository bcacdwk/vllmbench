# RTX 4090 BitNet Benchmark æœ€ç»ˆæŠ¥å‘Š

**æ—¥å¿—æ–‡ä»¶**: `bitnet_bench_20260128_105916.log`  
**æ—¶é—´**: 2026-01-28 13:11  
**æ€»è€—æ—¶**: 2.20 å°æ—¶ (7927.3ç§’)  
**GPU**: NVIDIA GeForce RTX 4090 (CC 8.9, Ada Lovelace)

---

## ğŸ“Š æœ€ç»ˆç»“æœæ±‡æ€»

### ğŸ‰ æ€»ä½“æƒ…å†µ: å…¨éƒ¨æˆåŠŸï¼

| ä»»åŠ¡ | çŠ¶æ€ | è€—æ—¶ | è¯´æ˜ |
|------|------|------|------|
| Task 1: åŸºç¡€æ¨¡å‹å‡†å¤‡ | âœ… æˆåŠŸ | 99.9s | ä¸‹è½½ BF16 + é‡åŒ– INT8/FP8 |
| Task 2: SlideSparse è½¬æ¢ | â­ï¸ è·³è¿‡ | - | 8ä¸ªæ¨¡å‹å·²å­˜åœ¨ |
| Task 3: ç¦»çº¿è°ƒä¼˜ | â­ï¸ è·³è¿‡ | - | è°ƒä¼˜æ•°æ®å·²å­˜åœ¨ |
| Task 4: Prefill Benchmark | âœ… æˆåŠŸ | 5254.9s | INT8 + FP8 å…¨éƒ¨é€šè¿‡ |
| Task 5: Decode Benchmark | âœ… æˆåŠŸ | 2317.4s | INT8 + FP8 å…¨éƒ¨é€šè¿‡ |
| Task 6: Kernel cuBLASLt | âœ… æˆåŠŸ | 38.4s | INT8 + FP8 å…¨éƒ¨é€šè¿‡ |
| Task 7: Kernel cuSPARSELt é«˜ç¨€ç– | âœ… æˆåŠŸ | 104.1s | 2_4, 2_6, 2_8, 2_10 |
| Task 8: Kernel cuSPARSELt ä½ç¨€ç– | âœ… æˆåŠŸ | 112.6s | 2_12, 2_14, 2_16, 2_inf |

**ç»Ÿè®¡**: `6 æˆåŠŸ, 0 å¤±è´¥, 2 è·³è¿‡`

---

## âœ… é”™è¯¯æ£€æŸ¥ï¼šæ— é”™è¯¯

ç»è¿‡å®Œæ•´æ—¥å¿—æ£€æŸ¥ï¼Œ**æ‰€æœ‰æµ‹è¯•å‡é€šè¿‡ï¼Œæ— ä»»ä½•é”™è¯¯**ã€‚

```
Prefill: INT8 35/35 âœ…, FP8 35/35 âœ… â†’ æ€»è®¡ 70/70
Decode:  INT8 20/20 âœ…, FP8 20/20 âœ… â†’ æ€»è®¡ 40/40
Kernel cuBLASLt:     INT8 36/36 âœ…, FP8 36/36 âœ…
Kernel cuSPARSELt:   INT8 å…¨éƒ¨é€šè¿‡ âœ…, FP8 å…¨éƒ¨é€šè¿‡ âœ…
```

---

## 1. æ¨¡å‹å‡†å¤‡ç»“æœ (Task 1)

### åŸºç¡€æ¨¡å‹ âœ…

| æ¨¡å‹ | è·¯å¾„ | çŠ¶æ€ |
|------|------|------|
| BitNet-2B-BF16 | `checkpoints/BitNet-2B-BF16/` | âœ… ä¸‹è½½å®Œæˆ |
| BitNet-2B-INT8 | `checkpoints/BitNet-2B-INT8/` | âœ… é‡åŒ–å®Œæˆ |
| BitNet-2B-FP8 | `checkpoints/BitNet-2B-FP8/` | âœ… é‡åŒ–å®Œæˆ |

### SlideSparse æ¨¡å‹ âœ… (å·²å­˜åœ¨ï¼Œè·³è¿‡è½¬æ¢)

| åŸºç¡€æ¨¡å‹ | 2:4 | 2:6 | 2:8 | 2:10 |
|----------|-----|-----|-----|------|
| BitNet-2B-INT8 | âœ… | âœ… | âœ… | âœ… |
| BitNet-2B-FP8 | âœ… | âœ… | âœ… | âœ… |

**è·¯å¾„**: `checkpoints_slidesparse/{æ¨¡å‹å}-SlideSparse-{Z}_{L}/`

---

## 2. Prefill Benchmark ç»“æœ (Task 4)

### é…ç½®

- **æ¨¡å‹**: `bitnet1.58-2b-int8`, `bitnet1.58-2b-fp8`
- **M åˆ—è¡¨**: `[512, 1024, 2048, 4096, 8192, 16384, 32768]` (7ä¸ª)
- **Backend**: `cuBLASLt`, `cuSPARSELt (2:4, 2:6, 2:8, 2:10)` (5ä¸ª)
- **æ€»æµ‹è¯•æ•°**: 7 Ã— 5 Ã— 2 = 70

### ç»“æœç»Ÿè®¡ï¼šå…¨éƒ¨é€šè¿‡ âœ…

| æ¨¡å‹ | cuBLASLt | cuSPARSELt 2:4 | cuSPARSELt 2:6 | cuSPARSELt 2:8 | cuSPARSELt 2:10 | Total |
|------|----------|----------------|----------------|----------------|-----------------|-------|
| **BitNet-2B-INT8** | 7/7 âœ… | 7/7 âœ… | 7/7 âœ… | 7/7 âœ… | 7/7 âœ… | **35/35** |
| **BitNet-2B-FP8** | 7/7 âœ… | 7/7 âœ… | 7/7 âœ… | 7/7 âœ… | 7/7 âœ… | **35/35** |

### æ€§èƒ½æ•°æ® (BitNet-2B-INT8 cuBLASLt)

| M | requests/s | tokens/s | è€—æ—¶(s) |
|---|------------|----------|---------|
| 512 | 15.19 | 7,790 | 8.43 |
| 1024 | 15.64 | 16,034 | 8.18 |
| 2048 | 30.73 | 31,494 | 8.33 |
| 4096 | 46.00 | 47,154 | 11.13 |
| 8192 | 52.27 | 53,580 | 19.59 |
| 16384 | 51.93 | 53,233 | 39.43 |
| 32768 | 53.20 | 54,528 | 76.99 |

### æ€§èƒ½æ•°æ® (BitNet-2B-FP8 cuBLASLt)

| M | requests/s | tokens/s | è€—æ—¶(s) |
|---|------------|----------|---------|
| 512 | 15.72 | 8,065 | 8.14 |
| 1024 | 15.64 | 16,029 | 8.19 |
| 2048 | 30.42 | 31,179 | 8.42 |
| 4096 | 45.01 | 46,135 | 11.38 |
| 8192 | 47.10 | 48,279 | 21.74 |
| 16384 | 45.32 | 46,452 | 45.19 |
| 32768 | 45.07 | 46,199 | 90.88 |

---

## 3. Decode Benchmark ç»“æœ (Task 5)

### é…ç½®

- **æ¨¡å‹**: `bitnet1.58-2b-int8`, `bitnet1.58-2b-fp8`
- **M åˆ—è¡¨**: `[64, 128, 256, 512]` (4ä¸ª)
- **Backend**: `cuBLASLt`, `cuSPARSELt (2:4, 2:6, 2:8, 2:10)` (5ä¸ª)
- **æ€»æµ‹è¯•æ•°**: 4 Ã— 5 Ã— 2 = 40

### ç»“æœç»Ÿè®¡ï¼šå…¨éƒ¨é€šè¿‡ âœ…

| æ¨¡å‹ | cuBLASLt | cuSPARSELt 2:4 | cuSPARSELt 2:6 | cuSPARSELt 2:8 | cuSPARSELt 2:10 | Total |
|------|----------|----------------|----------------|----------------|-----------------|-------|
| **BitNet-2B-INT8** | 4/4 âœ… | 4/4 âœ… | 4/4 âœ… | 4/4 âœ… | 4/4 âœ… | **20/20** |
| **BitNet-2B-FP8** | 4/4 âœ… | 4/4 âœ… | 4/4 âœ… | 4/4 âœ… | 4/4 âœ… | **20/20** |

### æ€§èƒ½æ•°æ® (BitNet-2B-INT8 cuBLASLt)

| M | requests/s | tokens/s | è€—æ—¶(s) |
|---|------------|----------|---------|
| 64 | 25.69 | 6,989 | 2.49 |
| 128 | 38.79 | 10,551 | 3.30 |
| 256 | 53.86 | 14,649 | 4.75 |
| 512 | 48.58 | 13,214 | 10.54 |

### æ€§èƒ½æ•°æ® (BitNet-2B-FP8 cuBLASLt)

| M | requests/s | tokens/s | è€—æ—¶(s) |
|---|------------|----------|---------|
| 64 | 27.73 | 7,542 | 2.31 |
| 128 | 36.62 | 9,960 | 3.50 |
| 256 | 56.47 | 15,361 | 4.53 |
| 512 | 56.05 | 15,245 | 9.14 |

---

## 4. Kernel Benchmark ç»“æœ (Task 6/7/8)

### é…ç½®

- **æ¨¡å‹**: `BitNet-2B`
- **æ•°æ®ç±»å‹**: `INT8`, `FP8E4M3` (åªæµ‹è¿™ä¸¤ç§ï¼Œä¸æµ‹ FP16/BF16/FP4)
- **M åˆ—è¡¨**: `[64, 128, 256, 512, 1024, 2048, 4096, 8192, 16384]` (9ä¸ª)
- **NK ç»„åˆ**: 4ä¸ª (å¯¹åº” BitNet-2B æ¨¡å‹ç»“æ„)

### Task 6: cuBLASLt âœ…

| æ•°æ®ç±»å‹ | çŠ¶æ€ | æœç´¢ç»Ÿè®¡ | è€—æ—¶ |
|----------|------|----------|------|
| FP8E4M3 | âœ… æˆåŠŸ | 36/36 æˆåŠŸ, 0 å¤±è´¥ | 21.7s |
| INT8 | âœ… æˆåŠŸ | 36/36 æˆåŠŸ, 0 å¤±è´¥ | 16.7s |

**ç»“æœç›®å½•**: `benchmark_kernel/cuBLASLt/alg_search_results/RTX4090_cc89_py312_cu129_x86_64/`

### Task 7: cuSPARSELt é«˜ç¨€ç– (2_4~2_10) âœ…

| æ•°æ®ç±»å‹ | ç¨€ç–åº¦ | çŠ¶æ€ | æœç´¢ç»Ÿè®¡ |
|----------|--------|------|----------|
| FP8E4M3 | 2_4, 2_6, 2_8, 2_10 | âœ… æˆåŠŸ | 36Ã—4 æˆåŠŸ, 0 å¤±è´¥ |
| INT8 | 2_4, 2_6, 2_8, 2_10 | âœ… æˆåŠŸ | 36Ã—4 æˆåŠŸ, 0 å¤±è´¥ |

**è€—æ—¶**: FP8 50.7s + INT8 53.4s = 104.1s

### Task 8: cuSPARSELt ä½ç¨€ç– (2_12~2_inf) âœ…

| æ•°æ®ç±»å‹ | ç¨€ç–åº¦ | çŠ¶æ€ | æœç´¢ç»Ÿè®¡ |
|----------|--------|------|----------|
| FP8E4M3 | 2_12, 2_14, 2_16, 2_inf | âœ… æˆåŠŸ | 36Ã—4 æˆåŠŸ, 0 å¤±è´¥ |
| INT8 | 2_12, 2_14, 2_16, 2_inf | âœ… æˆåŠŸ | 36Ã—4 æˆåŠŸ, 0 å¤±è´¥ |

**è€—æ—¶**: FP8 55.4s + INT8 57.2s = 112.6s

**ç»“æœç›®å½•**: `benchmark_kernel/cuSPARSELt/alg_search_results/RTX4090_cc89_py312_cu129_x86_64/`

---

## 5. ç»“æœæ–‡ä»¶æ±‡æ€»

### Throughput Benchmark ç»“æœ

```
throughput_benchmark_results/
â”œâ”€â”€ prefill/
â”‚   â”œâ”€â”€ RTX4090_cc89_INT8_py312_cu129_x86_64/
â”‚   â”‚   â”œâ”€â”€ cublaslt/BitNet-2B-INT8_prefill.csv
â”‚   â”‚   â””â”€â”€ cusparselt/{2_4,2_6,2_8,2_10}/BitNet-2B-INT8_prefill.csv
â”‚   â””â”€â”€ RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/
â”‚       â”œâ”€â”€ cublaslt/BitNet-2B-FP8_prefill.csv
â”‚       â””â”€â”€ cusparselt/{2_4,2_6,2_8,2_10}/BitNet-2B-FP8_prefill.csv
â””â”€â”€ decode/
    â”œâ”€â”€ RTX4090_cc89_INT8_py312_cu129_x86_64/
    â”‚   â”œâ”€â”€ cublaslt/BitNet-2B-INT8_decode.csv
    â”‚   â””â”€â”€ cusparselt/{2_4,2_6,2_8,2_10}/BitNet-2B-INT8_decode.csv
    â””â”€â”€ RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/
        â”œâ”€â”€ cublaslt/BitNet-2B-FP8_decode.csv
        â””â”€â”€ cusparselt/{2_4,2_6,2_8,2_10}/BitNet-2B-FP8_decode.csv
```

### Kernel Benchmark ç»“æœ

```
benchmark_kernel/
â”œâ”€â”€ cuBLASLt/alg_search_results/RTX4090_cc89_py312_cu129_x86_64/
â”‚   â”œâ”€â”€ INT8/alg_search_BitNet-2B-INT8.{csv,json}
â”‚   â””â”€â”€ FP8/alg_search_BitNet-2B-FP8.{csv,json}
â””â”€â”€ cuSPARSELt/alg_search_results/RTX4090_cc89_py312_cu129_x86_64/
    â”œâ”€â”€ INT8/alg_search_BitNet-2B-INT8_{2_4,2_6,...,2_inf}.{csv,json}
    â””â”€â”€ FP8/alg_search_BitNet-2B-FP8_{2_4,2_6,...,2_inf}.{csv,json}
```

---

## 6. RTX 4090 vs A100 å¯¹æ¯”

| ç‰¹æ€§ | RTX 4090 | A100 |
|------|----------|------|
| æ¶æ„ | Ada Lovelace (CC 8.9) | Ampere (CC 8.0) |
| FP8 æ”¯æŒ | âœ… åŸç”Ÿæ”¯æŒ | âŒ ä¸æ”¯æŒ |
| BitNet INT8 Prefill | âœ… å…¨éƒ¨é€šè¿‡ | âœ… å…¨éƒ¨é€šè¿‡ |
| BitNet FP8 Prefill | âœ… å…¨éƒ¨é€šè¿‡ | â­ï¸ è·³è¿‡ (ä¸æ”¯æŒ) |
| BitNet INT8 Decode | âœ… å…¨éƒ¨é€šè¿‡ | âœ… å…¨éƒ¨é€šè¿‡ |
| BitNet FP8 Decode | âœ… å…¨éƒ¨é€šè¿‡ | â­ï¸ è·³è¿‡ (ä¸æ”¯æŒ) |

**RTX 4090 çš„ä¼˜åŠ¿**: æ”¯æŒåŸç”Ÿ FP8 è®¡ç®—ï¼Œå¯ä»¥å®Œæˆ FP8 ç›¸å…³çš„æ‰€æœ‰æµ‹è¯•ã€‚

---

## 7. æ€»ç»“

âœ… **RTX 4090 BitNet Benchmark å…¨éƒ¨æˆåŠŸå®Œæˆï¼**

- **INT8 æ¨¡å‹**: æ‰€æœ‰ Prefill/Decode/Kernel æµ‹è¯•é€šè¿‡
- **FP8 æ¨¡å‹**: æ‰€æœ‰ Prefill/Decode/Kernel æµ‹è¯•é€šè¿‡ (RTX 4090 æ”¯æŒåŸç”Ÿ FP8)
- **æ— éœ€é‡è·‘ä»»ä½•æµ‹è¯•**

### å…³é”®å‘ç°

1. **FP8 æ”¯æŒ**: RTX 4090 (Ada Lovelace) æ”¯æŒåŸç”Ÿ FP8ï¼Œè€Œ A100 (Ampere) ä¸æ”¯æŒ
2. **æ€§èƒ½å¯¹æ¯”**: INT8 å’Œ FP8 åœ¨ Prefill é˜¶æ®µæ€§èƒ½æ¥è¿‘ï¼ŒFP8 ç•¥æ…¢çº¦ 5-10%
3. **Decode æ€§èƒ½**: FP8 åœ¨ Decode é˜¶æ®µæ€§èƒ½ç•¥ä¼˜äº INT8 (å°¤å…¶æ˜¯å¤§ batch size)

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**: 2026-01-28 13:30  
**æ—¥å¿—ä½ç½®**: `/root/vllmbench/slidesparse/tools/bitnet_bench_20260128_105916.log`  
**çŠ¶æ€æ–‡ä»¶**: `/root/vllmbench/slidesparse/tools/bitnet_bench_20260128_105916_status.json`
