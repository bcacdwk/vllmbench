
========== M=16 ==========
Time: 2026-01-25 00:17:58
Backend: cuBLASLt [INT32 output]
Checkpoint: /root/vllmbench/checkpoints/Llama3.2-1B-INT8
Params: prompt_len=16, output_len=256, num_prompts=16, max_num_seqs=16
Command: vllm bench throughput --model /root/vllmbench/checkpoints/Llama3.2-1B-INT8 --dataset-name random --input-len 16 --output-len 256 --num-prompts 16 --max-num-seqs 16 --max-model-len 400 --max-num-batched-tokens 6400 --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/decode/RTX5080_cc120_INT8_py312_cu129_x86_64/cublaslt/json/Llama3.2-1B-INT8_M16.json

STDOUT:
When dataset path is not set, it will default to random dataset
INFO 01-25 00:18:02 [datasets.py:612] Sampling input_len from [15, 15] and output_len from [256, 256]
INFO 01-25 00:18:02 [utils.py:253] non-default args: {'tokenizer': '/root/vllmbench/checkpoints/Llama3.2-1B-INT8', 'max_model_len': 400, 'gpu_memory_utilization': 0.8, 'max_num_batched_tokens': 6400, 'max_num_seqs': 16, 'disable_log_stats': True, 'enable_lora': None, 'reasoning_parser_plugin': '', 'model': '/root/vllmbench/checkpoints/Llama3.2-1B-INT8'}
INFO 01-25 00:18:02 [model.py:514] Resolved architecture: LlamaForCausalLM
INFO 01-25 00:18:02 [model.py:1661] Using max model len 400
INFO 01-25 00:18:02 [scheduler.py:230] Chunked prefill is enabled with max_num_batched_tokens=6400.
(EngineCore_DP0 pid=859946) INFO 01-25 00:18:06 [core.py:93] Initializing a V1 LLM engine (v0.13.1.dev7+gd5e6597bf) with config: model='/root/vllmbench/checkpoints/Llama3.2-1B-INT8', speculative_config=None, tokenizer='/root/vllmbench/checkpoints/Llama3.2-1B-INT8', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=400, download_dir=None, load_format=auto, tensor_parallel_size=1, pipeline_parallel_size=1, data_parallel_size=1, disable_custom_all_reduce=False, quantization=compressed-tensors, enforce_eager=False, kv_cache_dtype=auto, device_config=cuda, structured_outputs_config=StructuredOutputsConfig(backend='auto', disable_fallback=False, disable_any_whitespace=False, disable_additional_properties=False, reasoning_parser='', reasoning_parser_plugin='', enable_in_reasoning=False), observability_config=ObservabilityConfig(show_hidden_metrics_for_version=None, otlp_traces_endpoint=None, collect_detailed_traces=None, kv_cache_metrics=False, kv_cache_metrics_sample=0.01, cudagraph_metrics=False, enable_layerwise_nvtx_tracing=False), seed=0, served_model_name=/root/vllmbench/checkpoints/Llama3.2-1B-INT8, enable_prefix_caching=True, enable_chunked_prefill=True, pooler_config=None, compilation_config={'level': None, 'mode': <CompilationMode.VLLM_COMPILE: 3>, 'debug_dump_path': None, 'cache_dir': '', 'compile_cache_save_format': 'binary', 'backend': 'inductor', 'custom_ops': ['none'], 'splitting_ops': ['vllm::unified_attention', 'vllm::unified_attention_with_output', 'vllm::unified_mla_attention', 'vllm::unified_mla_attention_with_output', 'vllm::mamba_mixer2', 'vllm::mamba_mixer', 'vllm::short_conv', 'vllm::linear_attention', 'vllm::plamo2_mamba_mixer', 'vllm::gdn_attention_core', 'vllm::kda_attention', 'vllm::sparse_attn_indexer'], 'compile_mm_encoder': False, 'compile_sizes': [], 'compile_ranges_split_points': [6400], 'inductor_compile_config': {'enable_auto_functionalized_v2': False, 'combo_kernels': True, 'benchmark_combo_kernel': True}, 'inductor_passes': {}, 'cudagraph_mode': <CUDAGraphMode.FULL_AND_PIECEWISE: (2, 1)>, 'cudagraph_num_of_warmups': 1, 'cudagraph_capture_sizes': [1, 2, 4, 8, 16, 24, 32], 'cudagraph_copy_inputs': False, 'cudagraph_specialize_lora': True, 'use_inductor_graph_partition': False, 'pass_config': {'fuse_norm_quant': False, 'fuse_act_quant': False, 'fuse_attn_quant': False, 'eliminate_noops': True, 'enable_sp': False, 'fuse_gemm_comms': False, 'fuse_allreduce_rms': False}, 'max_cudagraph_capture_size': 32, 'dynamic_shapes_config': {'type': <DynamicShapesType.BACKED: 'backed'>, 'evaluate_guards': False}, 'local_cache_dir': None}
(EngineCore_DP0 pid=859946) INFO 01-25 00:18:06 [parallel_state.py:1203] world_size=1 rank=0 local_rank=0 distributed_init_method=tcp://10.172.141.44:46277 backend=nccl
(EngineCore_DP0 pid=859946) INFO 01-25 00:18:06 [parallel_state.py:1411] rank 0 in world size 1 is assigned as DP rank 0, PP rank 0, PCP rank 0, TP rank 0, EP rank 0
(EngineCore_DP0 pid=859946) INFO 01-25 00:18:07 [gpu_model_runner.py:3562] Starting to load model /root/vllmbench/checkpoints/Llama3.2-1B-INT8...
(EngineCore_DP0 pid=859946) INFO 01-25 00:18:07 [compressed_tensors_w8a8_int8.py:62] Using CutlassScaledMMLinearKernel for CompressedTensorsW8A8Int8
(EngineCore_DP0 pid=859946) INFO 01-25 00:18:07 [cuda.py:351] Using FLASH_ATTN attention backend out of potential backends: ('FLASH_ATTN', 'FLASHINFER', 'TRITON_ATTN', 'FLEX_ATTENTION')
(EngineCore_DP0 pid=859946) INFO 01-25 00:18:07 [default_loader.py:308] Loading weights took 0.15 seconds
(EngineCore_DP0 pid=859946) INFO 01-25 00:18:07 [gpu_model_runner.py:3659] Model loading took 1.4137 GiB memory and 0.337900 seconds
(EngineCore_DP0 pid=859946) WARNING 01-25 00:18:09 [backends.py:609] Failed to read file <frozen os>
(EngineCore_DP0 pid=859946) INFO 01-25 00:18:09 [backends.py:643] Using cache directory: /root/.cache/vllm/torch_compile_cache/24aa14d19a/rank_0_0/backbone for vLLM's torch.compile
(EngineCore_DP0 pid=859946) INFO 01-25 00:18:09 [backends.py:703] Dynamo bytecode transform time: 2.03 s
(EngineCore_DP0 pid=859946) INFO 01-25 00:18:12 [backends.py:261] Cache the graph of compile range (1, 6400) for later use
(EngineCore_DP0 pid=859946) INFO 01-25 00:18:14 [backends.py:278] Compiling a graph for compile range (1, 6400) takes 2.95 s
(EngineCore_DP0 pid=859946) INFO 01-25 00:18:14 [monitor.py:34] torch.compile takes 4.98 s in total
(EngineCore_DP0 pid=859946) INFO 01-25 00:18:14 [gpu_worker.py:375] Available KV cache memory: 10.18 GiB
(EngineCore_DP0 pid=859946) INFO 01-25 00:18:14 [kv_cache_utils.py:1291] GPU KV cache size: 333,648 tokens
(EngineCore_DP0 pid=859946) INFO 01-25 00:18:14 [kv_cache_utils.py:1296] Maximum concurrency for 400 tokens per request: 834.12x
(EngineCore_DP0 pid=859946) INFO 01-25 00:18:16 [gpu_model_runner.py:4587] Graph capturing finished in 1 secs, took -0.68 GiB
(EngineCore_DP0 pid=859946) INFO 01-25 00:18:16 [core.py:259] init engine (profile, create kv cache, warmup model) took 8.37 seconds
INFO 01-25 00:18:16 [llm.py:360] Supported tasks: ['generate']
Throughput: 16.63 requests/s, 4524.54 total tokens/s, 4258.39 output tokens/s
Total num prompt tokens:  256
Total num output tokens:  4096

STDERR:
[2026-01-25 00:18:02] INFO kernels.py:603: Triton kernel custom ops registered
[2026-01-25 00:18:02] INFO kernels.py:649: Optimization enabled: Only preloading kernels for base model 'Llama3.2-1B-INT8'
[2026-01-25 00:18:02] INFO kernels.py:134: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 00:18:02] INFO kernels.py:180: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 00:18:02] INFO kernels.py:249: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 00:18:02] INFO kernels.py:373: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 00:18:02] INFO kernels.py:309: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 00:18:02] INFO kernels.py:433: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 00:18:02] INFO gemm_wrapper.py:168: Optimization enabled: Only loading GEMM configs for base model 'Llama3.2-1B-INT8'
[2026-01-25 00:18:02] INFO gemm_wrapper.py:183: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 00:18:02] INFO gemm_wrapper.py:946: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 00:18:02] INFO gemm_wrapper.py:1011: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 00:18:02] INFO gemm_wrapper.py:1077: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 00:18:02] INFO gemm_wrapper.py:1143: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 00:18:06] INFO kernels.py:603: Triton kernel custom ops registered
[2026-01-25 00:18:06] INFO kernels.py:649: Optimization enabled: Only preloading kernels for base model 'Llama3.2-1B-INT8'
[2026-01-25 00:18:06] INFO kernels.py:134: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 00:18:06] INFO kernels.py:180: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 00:18:06] INFO kernels.py:249: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 00:18:06] INFO kernels.py:373: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 00:18:06] INFO kernels.py:309: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 00:18:06] INFO kernels.py:433: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 00:18:06] INFO gemm_wrapper.py:168: Optimization enabled: Only loading GEMM configs for base model 'Llama3.2-1B-INT8'
[2026-01-25 00:18:06] INFO gemm_wrapper.py:183: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 00:18:06] INFO gemm_wrapper.py:946: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 00:18:06] INFO gemm_wrapper.py:1011: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 00:18:06] INFO gemm_wrapper.py:1077: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 00:18:06] INFO gemm_wrapper.py:1143: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=859946) [2026-01-25 00:18:07] INFO SlideSparseLinearMethod_INT8.py:801: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=859946) [2026-01-25 00:18:07] INFO gemm_wrapper.py:872: cublaslt GEMM extension loaded: cublaslt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=859946) [2026-01-25 00:18:07] INFO SlideSparseLinearMethod_INT8.py:448: SlideSparseInt8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=859946) [2026-01-25 00:18:07] INFO SlideSparseLinearMethod_INT8.py:617: Preloaded INT8 Triton kernels for model: Llama3.2-1B-INT8
(EngineCore_DP0 pid=859946) [2026-01-25 00:18:07] INFO SlideSparseLinearMethod_INT8.py:621: SlideSparseInt8LinearMethod initialized, kernel=cuBLASLt, symmetric=True
(EngineCore_DP0 pid=859946) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=859946) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  7.48it/s]
(EngineCore_DP0 pid=859946) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  7.48it/s]
(EngineCore_DP0 pid=859946) 
[cuBLASLt] INFO: INT8 GEMM only supports INT32 output. inner_dtype parameter is ignored, always using int32.
(EngineCore_DP0 pid=859946) 2026-01-25 00:18:14,963 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=859946) 2026-01-25 00:18:14,977 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=859946) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  14%|█▍        | 1/7 [00:00<00:00,  8.92it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  29%|██▊       | 2/7 [00:00<00:00,  6.14it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  86%|████████▌ | 6/7 [00:00<00:00, 16.68it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00, 14.83it/s]
(EngineCore_DP0 pid=859946) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  20%|██        | 1/5 [00:00<00:00,  6.98it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00, 22.28it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00, 19.68it/s]

Adding requests:   0%|          | 0/16 [00:00<?, ?it/s]
Adding requests:  88%|████████▊ | 14/16 [00:00<00:00, 93.50it/s]
Adding requests: 100%|██████████| 16/16 [00:00<00:00, 106.38it/s]

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▋         | 1/16 [00:00<00:11,  1.36it/s, est. speed input: 21.76 toks/s, output: 348.22 toks/s]
Processed prompts: 100%|██████████| 16/16 [00:00<00:00,  1.36it/s, est. speed input: 316.47 toks/s, output: 5063.57 toks/s]
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 19.78it/s, est. speed input: 316.47 toks/s, output: 5063.57 toks/s]
[rank0]:[W125 00:18:17.491233165 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=128 ==========
Time: 2026-01-25 00:18:18
Backend: cuBLASLt [INT32 output]
Checkpoint: /root/vllmbench/checkpoints/Llama3.2-1B-INT8
Params: prompt_len=16, output_len=256, num_prompts=128, max_num_seqs=128
Command: vllm bench throughput --model /root/vllmbench/checkpoints/Llama3.2-1B-INT8 --dataset-name random --input-len 16 --output-len 256 --num-prompts 128 --max-num-seqs 128 --max-model-len 400 --max-num-batched-tokens 51200 --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/decode/RTX5080_cc120_INT8_py312_cu129_x86_64/cublaslt/json/Llama3.2-1B-INT8_M128.json


========== M=16 ==========
Time: 2026-01-25 00:23:40
Backend: cuBLASLt [INT32 output]
Checkpoint: /root/vllmbench/checkpoints/Llama3.2-1B-INT8
Params: prompt_len=16, output_len=256, num_prompts=16, max_num_seqs=16
Command: vllm bench throughput --model /root/vllmbench/checkpoints/Llama3.2-1B-INT8 --dataset-name random --input-len 16 --output-len 256 --num-prompts 16 --max-num-seqs 16 --max-model-len 400 --max-num-batched-tokens 6400 --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/decode/RTX5080_cc120_INT8_py312_cu129_x86_64/cublaslt/json/Llama3.2-1B-INT8_M16.json

STDOUT:
When dataset path is not set, it will default to random dataset
INFO 01-25 00:23:43 [datasets.py:612] Sampling input_len from [15, 15] and output_len from [256, 256]
INFO 01-25 00:23:43 [utils.py:253] non-default args: {'tokenizer': '/root/vllmbench/checkpoints/Llama3.2-1B-INT8', 'max_model_len': 400, 'gpu_memory_utilization': 0.8, 'max_num_batched_tokens': 6400, 'max_num_seqs': 16, 'disable_log_stats': True, 'enable_lora': None, 'reasoning_parser_plugin': '', 'model': '/root/vllmbench/checkpoints/Llama3.2-1B-INT8'}
INFO 01-25 00:23:43 [model.py:514] Resolved architecture: LlamaForCausalLM
INFO 01-25 00:23:43 [model.py:1661] Using max model len 400
INFO 01-25 00:23:43 [scheduler.py:230] Chunked prefill is enabled with max_num_batched_tokens=6400.
(EngineCore_DP0 pid=863009) INFO 01-25 00:23:47 [core.py:93] Initializing a V1 LLM engine (v0.13.1.dev7+gd5e6597bf) with config: model='/root/vllmbench/checkpoints/Llama3.2-1B-INT8', speculative_config=None, tokenizer='/root/vllmbench/checkpoints/Llama3.2-1B-INT8', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=400, download_dir=None, load_format=auto, tensor_parallel_size=1, pipeline_parallel_size=1, data_parallel_size=1, disable_custom_all_reduce=False, quantization=compressed-tensors, enforce_eager=False, kv_cache_dtype=auto, device_config=cuda, structured_outputs_config=StructuredOutputsConfig(backend='auto', disable_fallback=False, disable_any_whitespace=False, disable_additional_properties=False, reasoning_parser='', reasoning_parser_plugin='', enable_in_reasoning=False), observability_config=ObservabilityConfig(show_hidden_metrics_for_version=None, otlp_traces_endpoint=None, collect_detailed_traces=None, kv_cache_metrics=False, kv_cache_metrics_sample=0.01, cudagraph_metrics=False, enable_layerwise_nvtx_tracing=False), seed=0, served_model_name=/root/vllmbench/checkpoints/Llama3.2-1B-INT8, enable_prefix_caching=True, enable_chunked_prefill=True, pooler_config=None, compilation_config={'level': None, 'mode': <CompilationMode.VLLM_COMPILE: 3>, 'debug_dump_path': None, 'cache_dir': '', 'compile_cache_save_format': 'binary', 'backend': 'inductor', 'custom_ops': ['none'], 'splitting_ops': ['vllm::unified_attention', 'vllm::unified_attention_with_output', 'vllm::unified_mla_attention', 'vllm::unified_mla_attention_with_output', 'vllm::mamba_mixer2', 'vllm::mamba_mixer', 'vllm::short_conv', 'vllm::linear_attention', 'vllm::plamo2_mamba_mixer', 'vllm::gdn_attention_core', 'vllm::kda_attention', 'vllm::sparse_attn_indexer'], 'compile_mm_encoder': False, 'compile_sizes': [], 'compile_ranges_split_points': [6400], 'inductor_compile_config': {'enable_auto_functionalized_v2': False, 'combo_kernels': True, 'benchmark_combo_kernel': True}, 'inductor_passes': {}, 'cudagraph_mode': <CUDAGraphMode.FULL_AND_PIECEWISE: (2, 1)>, 'cudagraph_num_of_warmups': 1, 'cudagraph_capture_sizes': [1, 2, 4, 8, 16, 24, 32], 'cudagraph_copy_inputs': False, 'cudagraph_specialize_lora': True, 'use_inductor_graph_partition': False, 'pass_config': {'fuse_norm_quant': False, 'fuse_act_quant': False, 'fuse_attn_quant': False, 'eliminate_noops': True, 'enable_sp': False, 'fuse_gemm_comms': False, 'fuse_allreduce_rms': False}, 'max_cudagraph_capture_size': 32, 'dynamic_shapes_config': {'type': <DynamicShapesType.BACKED: 'backed'>, 'evaluate_guards': False}, 'local_cache_dir': None}
(EngineCore_DP0 pid=863009) INFO 01-25 00:23:47 [parallel_state.py:1203] world_size=1 rank=0 local_rank=0 distributed_init_method=tcp://10.172.141.44:54109 backend=nccl
(EngineCore_DP0 pid=863009) INFO 01-25 00:23:47 [parallel_state.py:1411] rank 0 in world size 1 is assigned as DP rank 0, PP rank 0, PCP rank 0, TP rank 0, EP rank 0
(EngineCore_DP0 pid=863009) INFO 01-25 00:23:47 [gpu_model_runner.py:3562] Starting to load model /root/vllmbench/checkpoints/Llama3.2-1B-INT8...
(EngineCore_DP0 pid=863009) INFO 01-25 00:23:48 [compressed_tensors_w8a8_int8.py:62] Using CutlassScaledMMLinearKernel for CompressedTensorsW8A8Int8
(EngineCore_DP0 pid=863009) INFO 01-25 00:23:48 [cuda.py:351] Using FLASH_ATTN attention backend out of potential backends: ('FLASH_ATTN', 'FLASHINFER', 'TRITON_ATTN', 'FLEX_ATTENTION')
(EngineCore_DP0 pid=863009) INFO 01-25 00:23:48 [default_loader.py:308] Loading weights took 0.24 seconds
(EngineCore_DP0 pid=863009) INFO 01-25 00:23:48 [gpu_model_runner.py:3659] Model loading took 1.4137 GiB memory and 0.473077 seconds
(EngineCore_DP0 pid=863009) WARNING 01-25 00:23:50 [backends.py:609] Failed to read file <frozen os>
(EngineCore_DP0 pid=863009) INFO 01-25 00:23:50 [backends.py:643] Using cache directory: /root/.cache/vllm/torch_compile_cache/24aa14d19a/rank_0_0/backbone for vLLM's torch.compile
(EngineCore_DP0 pid=863009) INFO 01-25 00:23:50 [backends.py:703] Dynamo bytecode transform time: 2.04 s
(EngineCore_DP0 pid=863009) INFO 01-25 00:23:52 [backends.py:226] Directly load the compiled graph(s) for compile range (1, 6400) from the cache, took 0.409 s
(EngineCore_DP0 pid=863009) INFO 01-25 00:23:52 [monitor.py:34] torch.compile takes 2.45 s in total
(EngineCore_DP0 pid=863009) INFO 01-25 00:23:53 [gpu_worker.py:375] Available KV cache memory: 10.19 GiB
(EngineCore_DP0 pid=863009) INFO 01-25 00:23:53 [kv_cache_utils.py:1291] GPU KV cache size: 333,824 tokens
(EngineCore_DP0 pid=863009) INFO 01-25 00:23:53 [kv_cache_utils.py:1296] Maximum concurrency for 400 tokens per request: 834.56x
(EngineCore_DP0 pid=863009) INFO 01-25 00:23:54 [gpu_model_runner.py:4587] Graph capturing finished in 1 secs, took -0.70 GiB
(EngineCore_DP0 pid=863009) INFO 01-25 00:23:54 [core.py:259] init engine (profile, create kv cache, warmup model) took 5.43 seconds
INFO 01-25 00:23:54 [llm.py:360] Supported tasks: ['generate']
Throughput: 15.91 requests/s, 4327.19 total tokens/s, 4072.65 output tokens/s
Total num prompt tokens:  256
Total num output tokens:  4096

STDERR:
[2026-01-25 00:23:43] INFO kernels.py:603: Triton kernel custom ops registered
[2026-01-25 00:23:43] INFO kernels.py:649: Optimization enabled: Only preloading kernels for base model 'Llama3.2-1B-INT8'
[2026-01-25 00:23:43] INFO kernels.py:134: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 00:23:43] INFO kernels.py:180: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 00:23:43] INFO kernels.py:249: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 00:23:43] INFO kernels.py:373: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 00:23:43] INFO kernels.py:309: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 00:23:43] INFO kernels.py:433: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 00:23:43] INFO gemm_wrapper.py:168: Optimization enabled: Only loading GEMM configs for base model 'Llama3.2-1B-INT8'
[2026-01-25 00:23:43] INFO gemm_wrapper.py:183: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 00:23:43] INFO gemm_wrapper.py:946: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 00:23:43] INFO gemm_wrapper.py:1011: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 00:23:43] INFO gemm_wrapper.py:1077: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 00:23:43] INFO gemm_wrapper.py:1143: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 00:23:47] INFO kernels.py:603: Triton kernel custom ops registered
[2026-01-25 00:23:47] INFO kernels.py:649: Optimization enabled: Only preloading kernels for base model 'Llama3.2-1B-INT8'
[2026-01-25 00:23:47] INFO kernels.py:134: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 00:23:47] INFO kernels.py:180: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 00:23:47] INFO kernels.py:249: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 00:23:47] INFO kernels.py:373: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 00:23:47] INFO kernels.py:309: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 00:23:47] INFO kernels.py:433: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 00:23:47] INFO gemm_wrapper.py:168: Optimization enabled: Only loading GEMM configs for base model 'Llama3.2-1B-INT8'
[2026-01-25 00:23:47] INFO gemm_wrapper.py:183: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 00:23:47] INFO gemm_wrapper.py:946: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 00:23:47] INFO gemm_wrapper.py:1011: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 00:23:47] INFO gemm_wrapper.py:1077: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 00:23:47] INFO gemm_wrapper.py:1143: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=863009) [2026-01-25 00:23:48] INFO SlideSparseLinearMethod_INT8.py:801: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=863009) [2026-01-25 00:23:48] INFO gemm_wrapper.py:872: cublaslt GEMM extension loaded: cublaslt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=863009) [2026-01-25 00:23:48] INFO SlideSparseLinearMethod_INT8.py:448: SlideSparseInt8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=863009) [2026-01-25 00:23:48] INFO SlideSparseLinearMethod_INT8.py:617: Preloaded INT8 Triton kernels for model: Llama3.2-1B-INT8
(EngineCore_DP0 pid=863009) [2026-01-25 00:23:48] INFO SlideSparseLinearMethod_INT8.py:621: SlideSparseInt8LinearMethod initialized, kernel=cuBLASLt, symmetric=True
(EngineCore_DP0 pid=863009) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=863009) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.28it/s]
(EngineCore_DP0 pid=863009) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.28it/s]
(EngineCore_DP0 pid=863009) 
[cuBLASLt] INFO: INT8 GEMM only supports INT32 output. inner_dtype parameter is ignored, always using int32.
(EngineCore_DP0 pid=863009) 2026-01-25 00:23:53,322 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=863009) 2026-01-25 00:23:53,338 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=863009) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  43%|████▎     | 3/7 [00:00<00:00, 26.82it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00, 27.84it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00, 27.70it/s]
(EngineCore_DP0 pid=863009) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  20%|██        | 1/5 [00:00<00:00,  6.81it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00, 21.41it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00, 18.96it/s]

Adding requests:   0%|          | 0/16 [00:00<?, ?it/s]
Adding requests:  94%|█████████▍| 15/16 [00:00<00:00, 102.46it/s]
Adding requests: 100%|██████████| 16/16 [00:00<00:00, 108.95it/s]

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▋         | 1/16 [00:00<00:11,  1.27it/s, est. speed input: 20.30 toks/s, output: 324.85 toks/s]
Processed prompts: 100%|██████████| 16/16 [00:00<00:00,  1.27it/s, est. speed input: 298.69 toks/s, output: 4779.03 toks/s]
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 18.67it/s, est. speed input: 298.69 toks/s, output: 4779.03 toks/s]
[rank0]:[W125 00:23:55.673719534 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=128 ==========
Time: 2026-01-25 00:23:56
Backend: cuBLASLt [INT32 output]
Checkpoint: /root/vllmbench/checkpoints/Llama3.2-1B-INT8
Params: prompt_len=16, output_len=256, num_prompts=128, max_num_seqs=128
Command: vllm bench throughput --model /root/vllmbench/checkpoints/Llama3.2-1B-INT8 --dataset-name random --input-len 16 --output-len 256 --num-prompts 128 --max-num-seqs 128 --max-model-len 400 --max-num-batched-tokens 51200 --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/decode/RTX5080_cc120_INT8_py312_cu129_x86_64/cublaslt/json/Llama3.2-1B-INT8_M128.json

STDOUT:
When dataset path is not set, it will default to random dataset
INFO 01-25 00:24:00 [datasets.py:612] Sampling input_len from [15, 15] and output_len from [256, 256]
INFO 01-25 00:24:00 [utils.py:253] non-default args: {'tokenizer': '/root/vllmbench/checkpoints/Llama3.2-1B-INT8', 'max_model_len': 400, 'gpu_memory_utilization': 0.8, 'max_num_batched_tokens': 51200, 'max_num_seqs': 128, 'disable_log_stats': True, 'enable_lora': None, 'reasoning_parser_plugin': '', 'model': '/root/vllmbench/checkpoints/Llama3.2-1B-INT8'}
INFO 01-25 00:24:00 [model.py:514] Resolved architecture: LlamaForCausalLM
INFO 01-25 00:24:00 [model.py:1661] Using max model len 400
INFO 01-25 00:24:00 [scheduler.py:230] Chunked prefill is enabled with max_num_batched_tokens=51200.
(EngineCore_DP0 pid=863408) INFO 01-25 00:24:04 [core.py:93] Initializing a V1 LLM engine (v0.13.1.dev7+gd5e6597bf) with config: model='/root/vllmbench/checkpoints/Llama3.2-1B-INT8', speculative_config=None, tokenizer='/root/vllmbench/checkpoints/Llama3.2-1B-INT8', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=400, download_dir=None, load_format=auto, tensor_parallel_size=1, pipeline_parallel_size=1, data_parallel_size=1, disable_custom_all_reduce=False, quantization=compressed-tensors, enforce_eager=False, kv_cache_dtype=auto, device_config=cuda, structured_outputs_config=StructuredOutputsConfig(backend='auto', disable_fallback=False, disable_any_whitespace=False, disable_additional_properties=False, reasoning_parser='', reasoning_parser_plugin='', enable_in_reasoning=False), observability_config=ObservabilityConfig(show_hidden_metrics_for_version=None, otlp_traces_endpoint=None, collect_detailed_traces=None, kv_cache_metrics=False, kv_cache_metrics_sample=0.01, cudagraph_metrics=False, enable_layerwise_nvtx_tracing=False), seed=0, served_model_name=/root/vllmbench/checkpoints/Llama3.2-1B-INT8, enable_prefix_caching=True, enable_chunked_prefill=True, pooler_config=None, compilation_config={'level': None, 'mode': <CompilationMode.VLLM_COMPILE: 3>, 'debug_dump_path': None, 'cache_dir': '', 'compile_cache_save_format': 'binary', 'backend': 'inductor', 'custom_ops': ['none'], 'splitting_ops': ['vllm::unified_attention', 'vllm::unified_attention_with_output', 'vllm::unified_mla_attention', 'vllm::unified_mla_attention_with_output', 'vllm::mamba_mixer2', 'vllm::mamba_mixer', 'vllm::short_conv', 'vllm::linear_attention', 'vllm::plamo2_mamba_mixer', 'vllm::gdn_attention_core', 'vllm::kda_attention', 'vllm::sparse_attn_indexer'], 'compile_mm_encoder': False, 'compile_sizes': [], 'compile_ranges_split_points': [51200], 'inductor_compile_config': {'enable_auto_functionalized_v2': False, 'combo_kernels': True, 'benchmark_combo_kernel': True}, 'inductor_passes': {}, 'cudagraph_mode': <CUDAGraphMode.FULL_AND_PIECEWISE: (2, 1)>, 'cudagraph_num_of_warmups': 1, 'cudagraph_capture_sizes': [1, 2, 4, 8, 16, 24, 32, 40, 48, 56, 64, 72, 80, 88, 96, 104, 112, 120, 128, 136, 144, 152, 160, 168, 176, 184, 192, 200, 208, 216, 224, 232, 240, 248, 256], 'cudagraph_copy_inputs': False, 'cudagraph_specialize_lora': True, 'use_inductor_graph_partition': False, 'pass_config': {'fuse_norm_quant': False, 'fuse_act_quant': False, 'fuse_attn_quant': False, 'eliminate_noops': True, 'enable_sp': False, 'fuse_gemm_comms': False, 'fuse_allreduce_rms': False}, 'max_cudagraph_capture_size': 256, 'dynamic_shapes_config': {'type': <DynamicShapesType.BACKED: 'backed'>, 'evaluate_guards': False}, 'local_cache_dir': None}
(EngineCore_DP0 pid=863408) INFO 01-25 00:24:04 [parallel_state.py:1203] world_size=1 rank=0 local_rank=0 distributed_init_method=tcp://10.172.141.44:47219 backend=nccl
(EngineCore_DP0 pid=863408) INFO 01-25 00:24:04 [parallel_state.py:1411] rank 0 in world size 1 is assigned as DP rank 0, PP rank 0, PCP rank 0, TP rank 0, EP rank 0
(EngineCore_DP0 pid=863408) INFO 01-25 00:24:05 [gpu_model_runner.py:3562] Starting to load model /root/vllmbench/checkpoints/Llama3.2-1B-INT8...
(EngineCore_DP0 pid=863408) INFO 01-25 00:24:05 [compressed_tensors_w8a8_int8.py:62] Using CutlassScaledMMLinearKernel for CompressedTensorsW8A8Int8
(EngineCore_DP0 pid=863408) INFO 01-25 00:24:05 [cuda.py:351] Using FLASH_ATTN attention backend out of potential backends: ('FLASH_ATTN', 'FLASHINFER', 'TRITON_ATTN', 'FLEX_ATTENTION')
(EngineCore_DP0 pid=863408) INFO 01-25 00:24:05 [default_loader.py:308] Loading weights took 0.25 seconds
(EngineCore_DP0 pid=863408) INFO 01-25 00:24:05 [gpu_model_runner.py:3659] Model loading took 1.4137 GiB memory and 0.434030 seconds
(EngineCore_DP0 pid=863408) WARNING 01-25 00:24:08 [backends.py:609] Failed to read file <frozen os>
(EngineCore_DP0 pid=863408) INFO 01-25 00:24:08 [backends.py:643] Using cache directory: /root/.cache/vllm/torch_compile_cache/3ed2235d34/rank_0_0/backbone for vLLM's torch.compile
(EngineCore_DP0 pid=863408) INFO 01-25 00:24:08 [backends.py:703] Dynamo bytecode transform time: 2.04 s
(EngineCore_DP0 pid=863408) INFO 01-25 00:24:10 [backends.py:261] Cache the graph of compile range (1, 51200) for later use
(EngineCore_DP0 pid=863408) INFO 01-25 00:24:12 [backends.py:278] Compiling a graph for compile range (1, 51200) takes 3.34 s
(EngineCore_DP0 pid=863408) INFO 01-25 00:24:12 [monitor.py:34] torch.compile takes 5.38 s in total
(EngineCore_DP0 pid=863408) INFO 01-25 00:24:13 [gpu_worker.py:375] Available KV cache memory: 5.58 GiB
(EngineCore_DP0 pid=863408) INFO 01-25 00:24:13 [kv_cache_utils.py:1291] GPU KV cache size: 182,720 tokens
(EngineCore_DP0 pid=863408) INFO 01-25 00:24:13 [kv_cache_utils.py:1296] Maximum concurrency for 400 tokens per request: 456.80x
(EngineCore_DP0 pid=863408) INFO 01-25 00:24:16 [gpu_model_runner.py:4587] Graph capturing finished in 3 secs, took -5.85 GiB
(EngineCore_DP0 pid=863408) INFO 01-25 00:24:16 [core.py:259] init engine (profile, create kv cache, warmup model) took 10.38 seconds
INFO 01-25 00:24:16 [llm.py:360] Supported tasks: ['generate']
Throughput: 70.80 requests/s, 19258.39 total tokens/s, 18125.54 output tokens/s
Total num prompt tokens:  2048
Total num output tokens:  32768

STDERR:
[2026-01-25 00:24:00] INFO kernels.py:603: Triton kernel custom ops registered
[2026-01-25 00:24:00] INFO kernels.py:649: Optimization enabled: Only preloading kernels for base model 'Llama3.2-1B-INT8'
[2026-01-25 00:24:00] INFO kernels.py:134: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 00:24:00] INFO kernels.py:180: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 00:24:00] INFO kernels.py:249: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 00:24:00] INFO kernels.py:373: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 00:24:00] INFO kernels.py:309: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 00:24:00] INFO kernels.py:433: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 00:24:00] INFO gemm_wrapper.py:168: Optimization enabled: Only loading GEMM configs for base model 'Llama3.2-1B-INT8'
[2026-01-25 00:24:00] INFO gemm_wrapper.py:183: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 00:24:00] INFO gemm_wrapper.py:946: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 00:24:00] INFO gemm_wrapper.py:1011: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 00:24:00] INFO gemm_wrapper.py:1077: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 00:24:00] INFO gemm_wrapper.py:1143: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 00:24:04] INFO kernels.py:603: Triton kernel custom ops registered
[2026-01-25 00:24:04] INFO kernels.py:649: Optimization enabled: Only preloading kernels for base model 'Llama3.2-1B-INT8'
[2026-01-25 00:24:04] INFO kernels.py:134: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 00:24:04] INFO kernels.py:180: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 00:24:04] INFO kernels.py:249: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 00:24:04] INFO kernels.py:373: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 00:24:04] INFO kernels.py:309: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 00:24:04] INFO kernels.py:433: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 00:24:04] INFO gemm_wrapper.py:168: Optimization enabled: Only loading GEMM configs for base model 'Llama3.2-1B-INT8'
[2026-01-25 00:24:04] INFO gemm_wrapper.py:183: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 00:24:04] INFO gemm_wrapper.py:946: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 00:24:04] INFO gemm_wrapper.py:1011: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 00:24:04] INFO gemm_wrapper.py:1077: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 00:24:04] INFO gemm_wrapper.py:1143: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:05] INFO SlideSparseLinearMethod_INT8.py:801: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:05] INFO gemm_wrapper.py:872: cublaslt GEMM extension loaded: cublaslt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:05] INFO SlideSparseLinearMethod_INT8.py:448: SlideSparseInt8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:05] INFO SlideSparseLinearMethod_INT8.py:617: Preloaded INT8 Triton kernels for model: Llama3.2-1B-INT8
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:05] INFO SlideSparseLinearMethod_INT8.py:621: SlideSparseInt8LinearMethod initialized, kernel=cuBLASLt, symmetric=True
(EngineCore_DP0 pid=863408) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=863408) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.27it/s]
(EngineCore_DP0 pid=863408) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.27it/s]
(EngineCore_DP0 pid=863408) 
(EngineCore_DP0 pid=863408) [rank0]:W0125 00:24:10.186000 863408 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=863408) [rank0]:W0125 00:24:10.234000 863408 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:10] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=3072, K=2048), falling back to default heuristic
[cuBLASLt] INFO: INT8 GEMM only supports INT32 output. inner_dtype parameter is ignored, always using int32.
(EngineCore_DP0 pid=863408) [rank0]:W0125 00:24:10.703000 863408 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=863408) [rank0]:W0125 00:24:10.760000 863408 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:11] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:11] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=16384, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:11] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=8192), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:11] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=3072, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:11] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:11] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=16384, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:11] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=8192), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:11] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=3072, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:11] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:11] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=16384, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:11] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=8192), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:11] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=3072, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:11] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:11] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=16384, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:11] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=8192), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:11] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=3072, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:11] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:11] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=16384, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:11] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=8192), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:11] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=3072, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:11] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:11] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=16384, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:11] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=8192), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:11] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=3072, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:12] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:12] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=16384, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:12] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=8192), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:12] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=3072, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:12] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:12] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=16384, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:12] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=8192), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:12] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=3072, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:12] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:12] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=16384, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:12] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=8192), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:12] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=3072, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:12] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:12] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=16384, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:12] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=8192), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:12] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=3072, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:12] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:12] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=16384, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:12] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=8192), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:12] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=3072, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:12] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:12] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=16384, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:12] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=8192), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:12] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=3072, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:12] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:12] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=16384, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:12] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=8192), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:12] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=3072, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:12] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:12] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=16384, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:12] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=8192), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:12] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=3072, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:12] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:12] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=16384, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:12] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=8192), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:12] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=3072, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:12] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:12] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=16384, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:12] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=8192), falling back to default heuristic
(EngineCore_DP0 pid=863408) 2026-01-25 00:24:13,522 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=3072, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=16384, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=8192), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=3072, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=16384, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=8192), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=3072, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=16384, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=8192), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=3072, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=16384, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=8192), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=3072, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=16384, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=8192), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=3072, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=16384, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=8192), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=3072, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=16384, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=8192), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=3072, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=16384, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=8192), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=3072, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=16384, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=8192), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=3072, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=16384, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=8192), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=3072, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=16384, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=8192), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=3072, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=16384, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=8192), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=3072, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=16384, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=8192), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=3072, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=16384, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=8192), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=3072, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=16384, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=8192), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=3072, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=16384, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=863408) [2026-01-25 00:24:13] WARNING gemm_wrapper.py:354: cuBLASLt: M=51200 exceeds max searched M=16384 for (N=2048, K=8192), falling back to default heuristic
(EngineCore_DP0 pid=863408) 2026-01-25 00:24:13,539 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=863408) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/35 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   3%|▎         | 1/35 [00:00<00:12,  2.68it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  14%|█▍        | 5/35 [00:00<00:02, 12.28it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  26%|██▌       | 9/35 [00:00<00:01, 19.11it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  37%|███▋      | 13/35 [00:00<00:00, 23.94it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  49%|████▊     | 17/35 [00:00<00:00, 26.67it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  60%|██████    | 21/35 [00:00<00:00, 28.78it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  71%|███████▏  | 25/35 [00:01<00:00, 30.43it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  83%|████████▎ | 29/35 [00:01<00:00, 32.17it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  94%|█████████▍| 33/35 [00:01<00:00, 28.79it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 35/35 [00:01<00:00, 23.90it/s]
(EngineCore_DP0 pid=863408) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/19 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):   5%|▌         | 1/19 [00:00<00:02,  6.01it/s]
Capturing CUDA graphs (decode, FULL):  21%|██        | 4/19 [00:00<00:00, 16.45it/s]
Capturing CUDA graphs (decode, FULL):  42%|████▏     | 8/19 [00:00<00:00, 24.31it/s]
Capturing CUDA graphs (decode, FULL):  58%|█████▊    | 11/19 [00:00<00:00, 19.03it/s]
Capturing CUDA graphs (decode, FULL):  79%|███████▉  | 15/19 [00:00<00:00, 22.89it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 19/19 [00:00<00:00, 26.46it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 19/19 [00:00<00:00, 22.64it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 8170.68it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:01<03:46,  1.78s/it, est. speed input: 8.97 toks/s, output: 143.54 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:01<00:00,  1.78s/it, est. speed input: 1143.20 toks/s, output: 18291.10 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:01<00:00, 71.45it/s, est. speed input: 1143.20 toks/s, output: 18291.10 toks/s]
[rank0]:[W125 00:24:18.599753237 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=256 ==========
Time: 2026-01-25 00:24:19
Backend: cuBLASLt [INT32 output]
Checkpoint: /root/vllmbench/checkpoints/Llama3.2-1B-INT8
Params: prompt_len=16, output_len=256, num_prompts=256, max_num_seqs=256
Command: vllm bench throughput --model /root/vllmbench/checkpoints/Llama3.2-1B-INT8 --dataset-name random --input-len 16 --output-len 256 --num-prompts 256 --max-num-seqs 256 --max-model-len 400 --max-num-batched-tokens 102400 --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/decode/RTX5080_cc120_INT8_py312_cu129_x86_64/cublaslt/json/Llama3.2-1B-INT8_M256.json

STDOUT:
When dataset path is not set, it will default to random dataset
INFO 01-25 00:24:23 [datasets.py:612] Sampling input_len from [15, 15] and output_len from [256, 256]
INFO 01-25 00:24:23 [utils.py:253] non-default args: {'tokenizer': '/root/vllmbench/checkpoints/Llama3.2-1B-INT8', 'max_model_len': 400, 'gpu_memory_utilization': 0.8, 'max_num_batched_tokens': 102400, 'max_num_seqs': 256, 'disable_log_stats': True, 'enable_lora': None, 'reasoning_parser_plugin': '', 'model': '/root/vllmbench/checkpoints/Llama3.2-1B-INT8'}
INFO 01-25 00:24:23 [model.py:514] Resolved architecture: LlamaForCausalLM
INFO 01-25 00:24:23 [model.py:1661] Using max model len 400
INFO 01-25 00:24:23 [scheduler.py:230] Chunked prefill is enabled with max_num_batched_tokens=102400.
(EngineCore_DP0 pid=864116) INFO 01-25 00:24:27 [core.py:93] Initializing a V1 LLM engine (v0.13.1.dev7+gd5e6597bf) with config: model='/root/vllmbench/checkpoints/Llama3.2-1B-INT8', speculative_config=None, tokenizer='/root/vllmbench/checkpoints/Llama3.2-1B-INT8', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=400, download_dir=None, load_format=auto, tensor_parallel_size=1, pipeline_parallel_size=1, data_parallel_size=1, disable_custom_all_reduce=False, quantization=compressed-tensors, enforce_eager=False, kv_cache_dtype=auto, device_config=cuda, structured_outputs_config=StructuredOutputsConfig(backend='auto', disable_fallback=False, disable_any_whitespace=False, disable_additional_properties=False, reasoning_parser='', reasoning_parser_plugin='', enable_in_reasoning=False), observability_config=ObservabilityConfig(show_hidden_metrics_for_version=None, otlp_traces_endpoint=None, collect_detailed_traces=None, kv_cache_metrics=False, kv_cache_metrics_sample=0.01, cudagraph_metrics=False, enable_layerwise_nvtx_tracing=False), seed=0, served_model_name=/root/vllmbench/checkpoints/Llama3.2-1B-INT8, enable_prefix_caching=True, enable_chunked_prefill=True, pooler_config=None, compilation_config={'level': None, 'mode': <CompilationMode.VLLM_COMPILE: 3>, 'debug_dump_path': None, 'cache_dir': '', 'compile_cache_save_format': 'binary', 'backend': 'inductor', 'custom_ops': ['none'], 'splitting_ops': ['vllm::unified_attention', 'vllm::unified_attention_with_output', 'vllm::unified_mla_attention', 'vllm::unified_mla_attention_with_output', 'vllm::mamba_mixer2', 'vllm::mamba_mixer', 'vllm::short_conv', 'vllm::linear_attention', 'vllm::plamo2_mamba_mixer', 'vllm::gdn_attention_core', 'vllm::kda_attention', 'vllm::sparse_attn_indexer'], 'compile_mm_encoder': False, 'compile_sizes': [], 'compile_ranges_split_points': [102400], 'inductor_compile_config': {'enable_auto_functionalized_v2': False, 'combo_kernels': True, 'benchmark_combo_kernel': True}, 'inductor_passes': {}, 'cudagraph_mode': <CUDAGraphMode.FULL_AND_PIECEWISE: (2, 1)>, 'cudagraph_num_of_warmups': 1, 'cudagraph_capture_sizes': [1, 2, 4, 8, 16, 24, 32, 40, 48, 56, 64, 72, 80, 88, 96, 104, 112, 120, 128, 136, 144, 152, 160, 168, 176, 184, 192, 200, 208, 216, 224, 232, 240, 248, 256, 272, 288, 304, 320, 336, 352, 368, 384, 400, 416, 432, 448, 464, 480, 496, 512], 'cudagraph_copy_inputs': False, 'cudagraph_specialize_lora': True, 'use_inductor_graph_partition': False, 'pass_config': {'fuse_norm_quant': False, 'fuse_act_quant': False, 'fuse_attn_quant': False, 'eliminate_noops': True, 'enable_sp': False, 'fuse_gemm_comms': False, 'fuse_allreduce_rms': False}, 'max_cudagraph_capture_size': 512, 'dynamic_shapes_config': {'type': <DynamicShapesType.BACKED: 'backed'>, 'evaluate_guards': False}, 'local_cache_dir': None}
(EngineCore_DP0 pid=864116) INFO 01-25 00:24:27 [parallel_state.py:1203] world_size=1 rank=0 local_rank=0 distributed_init_method=tcp://10.172.141.44:57543 backend=nccl
(EngineCore_DP0 pid=864116) INFO 01-25 00:24:27 [parallel_state.py:1411] rank 0 in world size 1 is assigned as DP rank 0, PP rank 0, PCP rank 0, TP rank 0, EP rank 0
(EngineCore_DP0 pid=864116) INFO 01-25 00:24:28 [gpu_model_runner.py:3562] Starting to load model /root/vllmbench/checkpoints/Llama3.2-1B-INT8...
(EngineCore_DP0 pid=864116) INFO 01-25 00:24:28 [compressed_tensors_w8a8_int8.py:62] Using CutlassScaledMMLinearKernel for CompressedTensorsW8A8Int8
(EngineCore_DP0 pid=864116) INFO 01-25 00:24:28 [cuda.py:351] Using FLASH_ATTN attention backend out of potential backends: ('FLASH_ATTN', 'FLASHINFER', 'TRITON_ATTN', 'FLEX_ATTENTION')
(EngineCore_DP0 pid=864116) INFO 01-25 00:24:28 [default_loader.py:308] Loading weights took 0.24 seconds
(EngineCore_DP0 pid=864116) INFO 01-25 00:24:28 [gpu_model_runner.py:3659] Model loading took 1.4137 GiB memory and 0.432481 seconds
(EngineCore_DP0 pid=864116) WARNING 01-25 00:24:31 [backends.py:609] Failed to read file <frozen os>
(EngineCore_DP0 pid=864116) INFO 01-25 00:24:31 [backends.py:643] Using cache directory: /root/.cache/vllm/torch_compile_cache/18e67068f8/rank_0_0/backbone for vLLM's torch.compile
(EngineCore_DP0 pid=864116) INFO 01-25 00:24:31 [backends.py:703] Dynamo bytecode transform time: 2.04 s
(EngineCore_DP0 pid=864116) INFO 01-25 00:24:33 [backends.py:261] Cache the graph of compile range (1, 102400) for later use
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 240, in _initialize_kv_caches
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]     available_gpu_memory = self.model_executor.determine_available_memory()
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]     return self.collective_rpc("determine_available_memory")
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]     result = run_method(self.driver_worker, method, args, kwargs)
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]   File "/root/vllmbench/vllm/v1/serial_utils.py", line 461, in run_method
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 340, in determine_available_memory
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]     self.model_runner.profile_run()
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4474, in profile_run
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]     hidden_states, last_hidden_states = self._dummy_run(
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]                                         ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4198, in _dummy_run
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]     outputs = self.model(
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]               ^^^^^^^^^^^
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/llama.py", line 623, in forward
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]     model_output = self.model(
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]                    ^^^^^^^^^^^
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]   File "/root/vllmbench/vllm/compilation/decorators.py", line 526, in __call__
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]   File "/root/vllmbench/vllm/compilation/wrapper.py", line 218, in __call__
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]     return self._call_with_optional_nvtx_range(
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]   File "/root/vllmbench/vllm/compilation/wrapper.py", line 109, in _call_with_optional_nvtx_range
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]     return callable_fn(*args, **kwargs)
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 832, in compile_wrapper
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]     return fn(*args, **kwargs)
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/llama.py", line 412, in forward
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]     def forward(
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]     return fn(*args, **kwargs)
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]   File "/root/vllmbench/vllm/compilation/caching.py", line 54, in __call__
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]     return self.optimized_call(*args, **kwargs)
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 837, in call_wrapped
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]     return self._wrapped_call(self, *args, **kwargs)
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 413, in __call__
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]     raise e
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 400, in __call__
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]     return super(self.cls, obj).__call__(*args, **kwargs)  # type: ignore[misc]
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]   File "<eval_with_key>.34", line 184, in forward
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]     submod_4 = self.submod_4(getitem_8, s72, l_self_modules_layers_modules_1_modules_self_attn_modules_o_proj_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_o_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_post_attention_layernorm_parameters_weight_, getitem_9, l_self_modules_layers_modules_1_modules_mlp_modules_gate_up_proj_parameters_weight_, l_self_modules_layers_modules_1_modules_mlp_modules_gate_up_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_mlp_modules_down_proj_parameters_weight_, l_self_modules_layers_modules_1_modules_mlp_modules_down_proj_parameters_weight_scale_, l_self_modules_layers_modules_2_modules_input_layernorm_parameters_weight_, l_self_modules_layers_modules_2_modules_self_attn_modules_qkv_proj_parameters_weight_, l_self_modules_layers_modules_2_modules_self_attn_modules_qkv_proj_parameters_weight_scale_, l_positions_, l_self_modules_layers_modules_0_modules_self_attn_modules_rotary_emb_buffers_cos_sin_cache_);  getitem_8 = l_self_modules_layers_modules_1_modules_self_attn_modules_o_proj_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_o_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_post_attention_layernorm_parameters_weight_ = getitem_9 = l_self_modules_layers_modules_1_modules_mlp_modules_gate_up_proj_parameters_weight_ = l_self_modules_layers_modules_1_modules_mlp_modules_gate_up_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_mlp_modules_down_proj_parameters_weight_ = l_self_modules_layers_modules_1_modules_mlp_modules_down_proj_parameters_weight_scale_ = l_self_modules_layers_modules_2_modules_input_layernorm_parameters_weight_ = l_self_modules_layers_modules_2_modules_self_attn_modules_qkv_proj_parameters_weight_ = l_self_modules_layers_modules_2_modules_self_attn_modules_qkv_proj_parameters_weight_scale_ = None
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]   File "/root/vllmbench/vllm/compilation/piecewise_backend.py", line 178, in __call__
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]     return range_entry.runnable(*args)
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/standalone_compile.py", line 63, in __call__
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]     return self._compiled_fn(*args)
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]     return fn(*args, **kwargs)
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/aot_autograd.py", line 1130, in forward
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]     return compiled_fn(full_args)
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 353, in runtime_wrapper
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]     all_outs = call_func_at_runtime_with_args(
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/utils.py", line 129, in call_func_at_runtime_with_args
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]     out = normalize_as_list(f(args))
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]                             ^^^^^^^
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 526, in wrapper
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]     return compiled_fn(runtime_args)
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/output_code.py", line 613, in __call__
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]     return self.current_callable(inputs)
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/utils.py", line 2962, in run
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]     out = model(new_inputs)
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]           ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]   File "/tmp/torchinductor_root/3t/c3t2b53nbdwrp3fqoagbc6nm5rp3sgfpa2lgd44orilcjrwkp6e5.py", line 1077, in call
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]     buf14 = torch.ops.slidesparse.dequant_bias.default(reinterpret_tensor(buf13, (s72, 16384), (16384, 1), 0), reinterpret_tensor(buf11, (s72, ), (1, ), 0), arg7_1, None, 'bfloat16', 'Llama3.2-1B-INT8')
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_ops.py", line 841, in __call__
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]     return self._op(*args, **kwargs)
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]   File "/root/vllmbench/slidesparse/core/kernels.py", line 508, in _dequant_bias_impl
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]     return fn(gemm_output, scale_a, scale_b, bias, out_dtype)
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]   File "/root/vllmbench/slidesparse/csrc/fused_dequant_bias_triton/build/RTX5080_cc120_py312_cu129_x86_64/dequant_bias_tuned_Llama3.2-1B-INT8.py", line 102, in dequant_bias_triton
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]     output = torch.empty((M, N), dtype=torch.bfloat16, device=gemm_output.device)
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116) ERROR 01-25 00:24:35 [core.py:866] torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.12 GiB. GPU 0 has a total capacity of 15.47 GiB of which 2.08 GiB is free. Including non-PyTorch memory, this process has 13.37 GiB memory in use. Of the allocated memory 9.26 GiB is allocated by PyTorch, and 3.74 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

STDERR:
[2026-01-25 00:24:23] INFO kernels.py:603: Triton kernel custom ops registered
[2026-01-25 00:24:23] INFO kernels.py:649: Optimization enabled: Only preloading kernels for base model 'Llama3.2-1B-INT8'
[2026-01-25 00:24:23] INFO kernels.py:134: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 00:24:23] INFO kernels.py:180: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 00:24:23] INFO kernels.py:249: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 00:24:23] INFO kernels.py:373: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 00:24:23] INFO kernels.py:309: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 00:24:23] INFO kernels.py:433: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 00:24:23] INFO gemm_wrapper.py:168: Optimization enabled: Only loading GEMM configs for base model 'Llama3.2-1B-INT8'
[2026-01-25 00:24:23] INFO gemm_wrapper.py:183: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 00:24:23] INFO gemm_wrapper.py:946: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 00:24:23] INFO gemm_wrapper.py:1011: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 00:24:23] INFO gemm_wrapper.py:1077: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 00:24:23] INFO gemm_wrapper.py:1143: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 00:24:27] INFO kernels.py:603: Triton kernel custom ops registered
[2026-01-25 00:24:27] INFO kernels.py:649: Optimization enabled: Only preloading kernels for base model 'Llama3.2-1B-INT8'
[2026-01-25 00:24:27] INFO kernels.py:134: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 00:24:27] INFO kernels.py:180: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 00:24:27] INFO kernels.py:249: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 00:24:27] INFO kernels.py:373: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 00:24:27] INFO kernels.py:309: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 00:24:27] INFO kernels.py:433: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 00:24:27] INFO gemm_wrapper.py:168: Optimization enabled: Only loading GEMM configs for base model 'Llama3.2-1B-INT8'
[2026-01-25 00:24:27] INFO gemm_wrapper.py:183: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 00:24:27] INFO gemm_wrapper.py:946: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 00:24:27] INFO gemm_wrapper.py:1011: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 00:24:27] INFO gemm_wrapper.py:1077: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 00:24:27] INFO gemm_wrapper.py:1143: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=864116) [2026-01-25 00:24:28] INFO SlideSparseLinearMethod_INT8.py:801: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=864116) [2026-01-25 00:24:28] INFO gemm_wrapper.py:872: cublaslt GEMM extension loaded: cublaslt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=864116) [2026-01-25 00:24:28] INFO SlideSparseLinearMethod_INT8.py:448: SlideSparseInt8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=864116) [2026-01-25 00:24:28] INFO SlideSparseLinearMethod_INT8.py:617: Preloaded INT8 Triton kernels for model: Llama3.2-1B-INT8
(EngineCore_DP0 pid=864116) [2026-01-25 00:24:28] INFO SlideSparseLinearMethod_INT8.py:621: SlideSparseInt8LinearMethod initialized, kernel=cuBLASLt, symmetric=True
(EngineCore_DP0 pid=864116) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=864116) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.29it/s]
(EngineCore_DP0 pid=864116) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.29it/s]
(EngineCore_DP0 pid=864116) 
(EngineCore_DP0 pid=864116) [rank0]:W0125 00:24:33.379000 864116 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=864116) [rank0]:W0125 00:24:33.707000 864116 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=864116) [2026-01-25 00:24:33] WARNING gemm_wrapper.py:354: cuBLASLt: M=102400 exceeds max searched M=16384 for (N=3072, K=2048), falling back to default heuristic
[cuBLASLt] INFO: INT8 GEMM only supports INT32 output. inner_dtype parameter is ignored, always using int32.
(EngineCore_DP0 pid=864116) [rank0]:W0125 00:24:34.516000 864116 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=864116) [rank0]:W0125 00:24:34.573000 864116 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=864116) [2026-01-25 00:24:34] WARNING gemm_wrapper.py:354: cuBLASLt: M=102400 exceeds max searched M=16384 for (N=2048, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=864116) [2026-01-25 00:24:34] WARNING gemm_wrapper.py:354: cuBLASLt: M=102400 exceeds max searched M=16384 for (N=16384, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=864116) [2026-01-25 00:24:35] WARNING gemm_wrapper.py:354: cuBLASLt: M=102400 exceeds max searched M=16384 for (N=2048, K=8192), falling back to default heuristic
(EngineCore_DP0 pid=864116) [2026-01-25 00:24:35] WARNING gemm_wrapper.py:354: cuBLASLt: M=102400 exceeds max searched M=16384 for (N=3072, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=864116) [2026-01-25 00:24:35] WARNING gemm_wrapper.py:354: cuBLASLt: M=102400 exceeds max searched M=16384 for (N=2048, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=864116) [2026-01-25 00:24:35] WARNING gemm_wrapper.py:354: cuBLASLt: M=102400 exceeds max searched M=16384 for (N=16384, K=2048), falling back to default heuristic
(EngineCore_DP0 pid=864116) Process EngineCore_DP0:
(EngineCore_DP0 pid=864116) Traceback (most recent call last):
(EngineCore_DP0 pid=864116)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=864116)     self.run()
(EngineCore_DP0 pid=864116)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=864116)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=864116)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=864116)     raise e
(EngineCore_DP0 pid=864116)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=864116)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=864116)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=864116)     super().__init__(
(EngineCore_DP0 pid=864116)   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=864116)     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=864116)                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116)   File "/root/vllmbench/vllm/v1/engine/core.py", line 240, in _initialize_kv_caches
(EngineCore_DP0 pid=864116)     available_gpu_memory = self.model_executor.determine_available_memory()
(EngineCore_DP0 pid=864116)                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116)   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
(EngineCore_DP0 pid=864116)     return self.collective_rpc("determine_available_memory")
(EngineCore_DP0 pid=864116)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116)   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
(EngineCore_DP0 pid=864116)     result = run_method(self.driver_worker, method, args, kwargs)
(EngineCore_DP0 pid=864116)              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116)   File "/root/vllmbench/vllm/v1/serial_utils.py", line 461, in run_method
(EngineCore_DP0 pid=864116)     return func(*args, **kwargs)
(EngineCore_DP0 pid=864116)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116)   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=864116)     return func(*args, **kwargs)
(EngineCore_DP0 pid=864116)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116)   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 340, in determine_available_memory
(EngineCore_DP0 pid=864116)     self.model_runner.profile_run()
(EngineCore_DP0 pid=864116)   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4474, in profile_run
(EngineCore_DP0 pid=864116)     hidden_states, last_hidden_states = self._dummy_run(
(EngineCore_DP0 pid=864116)                                         ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116)   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=864116)     return func(*args, **kwargs)
(EngineCore_DP0 pid=864116)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116)   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4198, in _dummy_run
(EngineCore_DP0 pid=864116)     outputs = self.model(
(EngineCore_DP0 pid=864116)               ^^^^^^^^^^^
(EngineCore_DP0 pid=864116)   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=864116)     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=864116)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=864116)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=864116)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=864116)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=864116)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116)   File "/root/vllmbench/vllm/model_executor/models/llama.py", line 623, in forward
(EngineCore_DP0 pid=864116)     model_output = self.model(
(EngineCore_DP0 pid=864116)                    ^^^^^^^^^^^
(EngineCore_DP0 pid=864116)   File "/root/vllmbench/vllm/compilation/decorators.py", line 526, in __call__
(EngineCore_DP0 pid=864116)     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
(EngineCore_DP0 pid=864116)              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116)   File "/root/vllmbench/vllm/compilation/wrapper.py", line 218, in __call__
(EngineCore_DP0 pid=864116)     return self._call_with_optional_nvtx_range(
(EngineCore_DP0 pid=864116)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116)   File "/root/vllmbench/vllm/compilation/wrapper.py", line 109, in _call_with_optional_nvtx_range
(EngineCore_DP0 pid=864116)     return callable_fn(*args, **kwargs)
(EngineCore_DP0 pid=864116)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116)   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 832, in compile_wrapper
(EngineCore_DP0 pid=864116)     return fn(*args, **kwargs)
(EngineCore_DP0 pid=864116)            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116)   File "/root/vllmbench/vllm/model_executor/models/llama.py", line 412, in forward
(EngineCore_DP0 pid=864116)     def forward(
(EngineCore_DP0 pid=864116)   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=864116)     return fn(*args, **kwargs)
(EngineCore_DP0 pid=864116)            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116)   File "/root/vllmbench/vllm/compilation/caching.py", line 54, in __call__
(EngineCore_DP0 pid=864116)     return self.optimized_call(*args, **kwargs)
(EngineCore_DP0 pid=864116)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116)   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 837, in call_wrapped
(EngineCore_DP0 pid=864116)     return self._wrapped_call(self, *args, **kwargs)
(EngineCore_DP0 pid=864116)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116)   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 413, in __call__
(EngineCore_DP0 pid=864116)     raise e
(EngineCore_DP0 pid=864116)   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 400, in __call__
(EngineCore_DP0 pid=864116)     return super(self.cls, obj).__call__(*args, **kwargs)  # type: ignore[misc]
(EngineCore_DP0 pid=864116)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=864116)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=864116)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=864116)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=864116)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116)   File "<eval_with_key>.34", line 184, in forward
(EngineCore_DP0 pid=864116)     submod_4 = self.submod_4(getitem_8, s72, l_self_modules_layers_modules_1_modules_self_attn_modules_o_proj_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_o_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_post_attention_layernorm_parameters_weight_, getitem_9, l_self_modules_layers_modules_1_modules_mlp_modules_gate_up_proj_parameters_weight_, l_self_modules_layers_modules_1_modules_mlp_modules_gate_up_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_mlp_modules_down_proj_parameters_weight_, l_self_modules_layers_modules_1_modules_mlp_modules_down_proj_parameters_weight_scale_, l_self_modules_layers_modules_2_modules_input_layernorm_parameters_weight_, l_self_modules_layers_modules_2_modules_self_attn_modules_qkv_proj_parameters_weight_, l_self_modules_layers_modules_2_modules_self_attn_modules_qkv_proj_parameters_weight_scale_, l_positions_, l_self_modules_layers_modules_0_modules_self_attn_modules_rotary_emb_buffers_cos_sin_cache_);  getitem_8 = l_self_modules_layers_modules_1_modules_self_attn_modules_o_proj_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_o_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_post_attention_layernorm_parameters_weight_ = getitem_9 = l_self_modules_layers_modules_1_modules_mlp_modules_gate_up_proj_parameters_weight_ = l_self_modules_layers_modules_1_modules_mlp_modules_gate_up_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_mlp_modules_down_proj_parameters_weight_ = l_self_modules_layers_modules_1_modules_mlp_modules_down_proj_parameters_weight_scale_ = l_self_modules_layers_modules_2_modules_input_layernorm_parameters_weight_ = l_self_modules_layers_modules_2_modules_self_attn_modules_qkv_proj_parameters_weight_ = l_self_modules_layers_modules_2_modules_self_attn_modules_qkv_proj_parameters_weight_scale_ = None
(EngineCore_DP0 pid=864116)                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116)   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=864116)     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=864116)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116)   File "/root/vllmbench/vllm/compilation/piecewise_backend.py", line 178, in __call__
(EngineCore_DP0 pid=864116)     return range_entry.runnable(*args)
(EngineCore_DP0 pid=864116)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/standalone_compile.py", line 63, in __call__
(EngineCore_DP0 pid=864116)     return self._compiled_fn(*args)
(EngineCore_DP0 pid=864116)            ^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116)   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=864116)     return fn(*args, **kwargs)
(EngineCore_DP0 pid=864116)            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/aot_autograd.py", line 1130, in forward
(EngineCore_DP0 pid=864116)     return compiled_fn(full_args)
(EngineCore_DP0 pid=864116)            ^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 353, in runtime_wrapper
(EngineCore_DP0 pid=864116)     all_outs = call_func_at_runtime_with_args(
(EngineCore_DP0 pid=864116)                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/utils.py", line 129, in call_func_at_runtime_with_args
(EngineCore_DP0 pid=864116)     out = normalize_as_list(f(args))
(EngineCore_DP0 pid=864116)                             ^^^^^^^
(EngineCore_DP0 pid=864116)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 526, in wrapper
(EngineCore_DP0 pid=864116)     return compiled_fn(runtime_args)
(EngineCore_DP0 pid=864116)            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/output_code.py", line 613, in __call__
(EngineCore_DP0 pid=864116)     return self.current_callable(inputs)
(EngineCore_DP0 pid=864116)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/utils.py", line 2962, in run
(EngineCore_DP0 pid=864116)     out = model(new_inputs)
(EngineCore_DP0 pid=864116)           ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116)   File "/tmp/torchinductor_root/3t/c3t2b53nbdwrp3fqoagbc6nm5rp3sgfpa2lgd44orilcjrwkp6e5.py", line 1077, in call
(EngineCore_DP0 pid=864116)     buf14 = torch.ops.slidesparse.dequant_bias.default(reinterpret_tensor(buf13, (s72, 16384), (16384, 1), 0), reinterpret_tensor(buf11, (s72, ), (1, ), 0), arg7_1, None, 'bfloat16', 'Llama3.2-1B-INT8')
(EngineCore_DP0 pid=864116)             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116)   File "/usr/local/lib/python3.12/dist-packages/torch/_ops.py", line 841, in __call__
(EngineCore_DP0 pid=864116)     return self._op(*args, **kwargs)
(EngineCore_DP0 pid=864116)            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116)   File "/root/vllmbench/slidesparse/core/kernels.py", line 508, in _dequant_bias_impl
(EngineCore_DP0 pid=864116)     return fn(gemm_output, scale_a, scale_b, bias, out_dtype)
(EngineCore_DP0 pid=864116)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116)   File "/root/vllmbench/slidesparse/csrc/fused_dequant_bias_triton/build/RTX5080_cc120_py312_cu129_x86_64/dequant_bias_tuned_Llama3.2-1B-INT8.py", line 102, in dequant_bias_triton
(EngineCore_DP0 pid=864116)     output = torch.empty((M, N), dtype=torch.bfloat16, device=gemm_output.device)
(EngineCore_DP0 pid=864116)              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=864116) torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.12 GiB. GPU 0 has a total capacity of 15.47 GiB of which 2.08 GiB is free. Including non-PyTorch memory, this process has 13.37 GiB memory in use. Of the allocated memory 9.26 GiB is allocated by PyTorch, and 3.74 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
[rank0]:[W125 00:24:35.635020241 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

ERROR: Test failed for M=256

========== M=16 ==========
Time: 2026-01-25 05:42:49
Backend: cuBLASLt [INT32 output]
Checkpoint: /root/vllmbench/checkpoints/Llama3.2-1B-INT8
Params: prompt_len=16, output_len=256, num_prompts=16, max_num_seqs=16
Command: vllm bench throughput --model /root/vllmbench/checkpoints/Llama3.2-1B-INT8 --dataset-name random --input-len 16 --output-len 256 --num-prompts 16 --max-num-seqs 16 --max-model-len 400 --max-num-batched-tokens 16 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/decode/RTX5080_cc120_INT8_py312_cu129_x86_64/cublaslt/json/Llama3.2-1B-INT8_M16.json

STDOUT:
When dataset path is not set, it will default to random dataset
INFO 01-25 05:42:53 [datasets.py:612] Sampling input_len from [15, 15] and output_len from [256, 256]
INFO 01-25 05:42:53 [utils.py:253] non-default args: {'tokenizer': '/root/vllmbench/checkpoints/Llama3.2-1B-INT8', 'max_model_len': 400, 'gpu_memory_utilization': 0.8, 'max_num_batched_tokens': 16, 'max_num_seqs': 16, 'disable_log_stats': True, 'enable_lora': None, 'enable_chunked_prefill': False, 'reasoning_parser_plugin': '', 'model': '/root/vllmbench/checkpoints/Llama3.2-1B-INT8'}
INFO 01-25 05:42:53 [model.py:514] Resolved architecture: LlamaForCausalLM
INFO 01-25 05:42:53 [model.py:1661] Using max model len 400
WARNING 01-25 05:42:53 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.

STDERR:
[2026-01-25 05:42:53] INFO kernels.py:603: Triton kernel custom ops registered
[2026-01-25 05:42:53] INFO kernels.py:649: Optimization enabled: Only preloading kernels for base model 'Llama3.2-1B-INT8'
[2026-01-25 05:42:53] INFO kernels.py:134: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 05:42:53] INFO kernels.py:180: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 05:42:53] INFO kernels.py:249: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 05:42:53] INFO kernels.py:373: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 05:42:53] INFO kernels.py:309: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 05:42:53] INFO kernels.py:433: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 05:42:53] INFO gemm_wrapper.py:168: Optimization enabled: Only loading GEMM configs for base model 'Llama3.2-1B-INT8'
[2026-01-25 05:42:53] INFO gemm_wrapper.py:183: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 05:42:53] INFO gemm_wrapper.py:946: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 05:42:53] INFO gemm_wrapper.py:1011: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 05:42:53] INFO gemm_wrapper.py:1077: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 05:42:53] INFO gemm_wrapper.py:1143: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 175, in from_engine_args
    vllm_config = engine_args.create_engine_config(usage_context)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/engine/arg_utils.py", line 1586, in create_engine_config
    scheduler_config = SchedulerConfig(
                       ^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/pydantic/_internal/_dataclasses.py", line 121, in __init__
    s.__pydantic_validator__.validate_python(ArgsKwargs(args, kwargs), self_instance=s)
pydantic_core._pydantic_core.ValidationError: 1 validation error for SchedulerConfig
  Value error, max_num_batched_tokens (16) is smaller than max_model_len (400). This effectively limits the maximum sequence length to max_num_batched_tokens and makes vLLM reject longer sequences. Please increase max_num_batched_tokens or decrease max_model_len. [type=value_error, input_value=ArgsKwargs((), {'runner_t..., 'stream_interval': 1}), input_type=ArgsKwargs]
    For further information visit https://errors.pydantic.dev/2.12/v/value_error

ERROR: Test failed for M=16

========== M=128 ==========
Time: 2026-01-25 05:42:54
Backend: cuBLASLt [INT32 output]
Checkpoint: /root/vllmbench/checkpoints/Llama3.2-1B-INT8
Params: prompt_len=16, output_len=256, num_prompts=128, max_num_seqs=128
Command: vllm bench throughput --model /root/vllmbench/checkpoints/Llama3.2-1B-INT8 --dataset-name random --input-len 16 --output-len 256 --num-prompts 128 --max-num-seqs 128 --max-model-len 400 --max-num-batched-tokens 128 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/decode/RTX5080_cc120_INT8_py312_cu129_x86_64/cublaslt/json/Llama3.2-1B-INT8_M128.json

STDOUT:
When dataset path is not set, it will default to random dataset
INFO 01-25 05:42:57 [datasets.py:612] Sampling input_len from [15, 15] and output_len from [256, 256]
INFO 01-25 05:42:57 [utils.py:253] non-default args: {'tokenizer': '/root/vllmbench/checkpoints/Llama3.2-1B-INT8', 'max_model_len': 400, 'gpu_memory_utilization': 0.8, 'max_num_batched_tokens': 128, 'max_num_seqs': 128, 'disable_log_stats': True, 'enable_lora': None, 'enable_chunked_prefill': False, 'reasoning_parser_plugin': '', 'model': '/root/vllmbench/checkpoints/Llama3.2-1B-INT8'}
INFO 01-25 05:42:57 [model.py:514] Resolved architecture: LlamaForCausalLM
INFO 01-25 05:42:57 [model.py:1661] Using max model len 400
WARNING 01-25 05:42:58 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.

STDERR:
[2026-01-25 05:42:58] INFO kernels.py:603: Triton kernel custom ops registered
[2026-01-25 05:42:58] INFO kernels.py:649: Optimization enabled: Only preloading kernels for base model 'Llama3.2-1B-INT8'
[2026-01-25 05:42:58] INFO kernels.py:134: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 05:42:58] INFO kernels.py:180: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 05:42:58] INFO kernels.py:249: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 05:42:58] INFO kernels.py:373: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 05:42:58] INFO kernels.py:309: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 05:42:58] INFO kernels.py:433: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 05:42:58] INFO gemm_wrapper.py:168: Optimization enabled: Only loading GEMM configs for base model 'Llama3.2-1B-INT8'
[2026-01-25 05:42:58] INFO gemm_wrapper.py:183: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 05:42:58] INFO gemm_wrapper.py:946: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 05:42:58] INFO gemm_wrapper.py:1011: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 05:42:58] INFO gemm_wrapper.py:1077: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 05:42:58] INFO gemm_wrapper.py:1143: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 175, in from_engine_args
    vllm_config = engine_args.create_engine_config(usage_context)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/engine/arg_utils.py", line 1586, in create_engine_config
    scheduler_config = SchedulerConfig(
                       ^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/pydantic/_internal/_dataclasses.py", line 121, in __init__
    s.__pydantic_validator__.validate_python(ArgsKwargs(args, kwargs), self_instance=s)
pydantic_core._pydantic_core.ValidationError: 1 validation error for SchedulerConfig
  Value error, max_num_batched_tokens (128) is smaller than max_model_len (400). This effectively limits the maximum sequence length to max_num_batched_tokens and makes vLLM reject longer sequences. Please increase max_num_batched_tokens or decrease max_model_len. [type=value_error, input_value=ArgsKwargs((), {'runner_t..., 'stream_interval': 1}), input_type=ArgsKwargs]
    For further information visit https://errors.pydantic.dev/2.12/v/value_error

ERROR: Test failed for M=128

========== M=256 ==========
Time: 2026-01-25 05:42:59
Backend: cuBLASLt [INT32 output]
Checkpoint: /root/vllmbench/checkpoints/Llama3.2-1B-INT8
Params: prompt_len=16, output_len=256, num_prompts=256, max_num_seqs=256
Command: vllm bench throughput --model /root/vllmbench/checkpoints/Llama3.2-1B-INT8 --dataset-name random --input-len 16 --output-len 256 --num-prompts 256 --max-num-seqs 256 --max-model-len 400 --max-num-batched-tokens 256 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/decode/RTX5080_cc120_INT8_py312_cu129_x86_64/cublaslt/json/Llama3.2-1B-INT8_M256.json

STDOUT:
When dataset path is not set, it will default to random dataset
INFO 01-25 05:43:02 [datasets.py:612] Sampling input_len from [15, 15] and output_len from [256, 256]
INFO 01-25 05:43:02 [utils.py:253] non-default args: {'tokenizer': '/root/vllmbench/checkpoints/Llama3.2-1B-INT8', 'max_model_len': 400, 'gpu_memory_utilization': 0.8, 'max_num_batched_tokens': 256, 'max_num_seqs': 256, 'disable_log_stats': True, 'enable_lora': None, 'enable_chunked_prefill': False, 'reasoning_parser_plugin': '', 'model': '/root/vllmbench/checkpoints/Llama3.2-1B-INT8'}
INFO 01-25 05:43:02 [model.py:514] Resolved architecture: LlamaForCausalLM
INFO 01-25 05:43:02 [model.py:1661] Using max model len 400
WARNING 01-25 05:43:03 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.

STDERR:
[2026-01-25 05:43:03] INFO kernels.py:603: Triton kernel custom ops registered
[2026-01-25 05:43:03] INFO kernels.py:649: Optimization enabled: Only preloading kernels for base model 'Llama3.2-1B-INT8'
[2026-01-25 05:43:03] INFO kernels.py:134: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 05:43:03] INFO kernels.py:180: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 05:43:03] INFO kernels.py:249: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 05:43:03] INFO kernels.py:373: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 05:43:03] INFO kernels.py:309: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 05:43:03] INFO kernels.py:433: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 05:43:03] INFO gemm_wrapper.py:168: Optimization enabled: Only loading GEMM configs for base model 'Llama3.2-1B-INT8'
[2026-01-25 05:43:03] INFO gemm_wrapper.py:183: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 05:43:03] INFO gemm_wrapper.py:946: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 05:43:03] INFO gemm_wrapper.py:1011: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 05:43:03] INFO gemm_wrapper.py:1077: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 05:43:03] INFO gemm_wrapper.py:1143: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 175, in from_engine_args
    vllm_config = engine_args.create_engine_config(usage_context)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/engine/arg_utils.py", line 1586, in create_engine_config
    scheduler_config = SchedulerConfig(
                       ^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/pydantic/_internal/_dataclasses.py", line 121, in __init__
    s.__pydantic_validator__.validate_python(ArgsKwargs(args, kwargs), self_instance=s)
pydantic_core._pydantic_core.ValidationError: 1 validation error for SchedulerConfig
  Value error, max_num_batched_tokens (256) is smaller than max_model_len (400). This effectively limits the maximum sequence length to max_num_batched_tokens and makes vLLM reject longer sequences. Please increase max_num_batched_tokens or decrease max_model_len. [type=value_error, input_value=ArgsKwargs((), {'runner_t..., 'stream_interval': 1}), input_type=ArgsKwargs]
    For further information visit https://errors.pydantic.dev/2.12/v/value_error

ERROR: Test failed for M=256
