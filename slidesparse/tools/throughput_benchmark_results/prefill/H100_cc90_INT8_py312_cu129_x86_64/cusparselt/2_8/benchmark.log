
========== M=512 ==========
Time: 2026-01-26 08:24:54
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_8
Params: prompt_len=512, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_8 --dataset-name random --input-len 512 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 513 --max-num-batched-tokens 513 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-1B-INT8_M512.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 08:25:02 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1051916) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1051916) WARNING 01-26 08:25:15 [backends.py:609] Failed to read file <frozen os>
Throughput: 30.07 requests/s, 15428.18 total tokens/s, 30.07 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128

STDERR:
[2026-01-26 08:25:01] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 08:25:02] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-26 08:25:02] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-26 08:25:02] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:25:02] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:25:02] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:25:02] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:25:02] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:25:02] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-26 08:25:02] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 08:25:02] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 08:25:02] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 08:25:02] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 08:25:02] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 08:25:08] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 08:25:09] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-26 08:25:09] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-26 08:25:09] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:25:09] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:25:09] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:25:09] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:25:09] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:25:09] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-26 08:25:09] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 08:25:09] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 08:25:09] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 08:25:09] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 08:25:09] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1051916) [2026-01-26 08:25:10] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1051916) [2026-01-26 08:25:10] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1051916) [2026-01-26 08:25:10] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1051916) [2026-01-26 08:25:10] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1051916) [2026-01-26 08:25:10] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-1B-INT8
(EngineCore_DP0 pid=1051916) [2026-01-26 08:25:10] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1051916) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1051916) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.61it/s]
(EngineCore_DP0 pid=1051916) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.60it/s]
(EngineCore_DP0 pid=1051916) 
(EngineCore_DP0 pid=1051916) [2026-01-26 08:25:11] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 3072] -> 1D uint8
(EngineCore_DP0 pid=1051916) [2026-01-26 08:25:11] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 5898240 bytes
(EngineCore_DP0 pid=1051916) [2026-01-26 08:25:11] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 3072] -> 1D uint8
(EngineCore_DP0 pid=1051916) [2026-01-26 08:25:11] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 3932160 bytes
(EngineCore_DP0 pid=1051916) [2026-01-26 08:25:11] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 3072] -> 1D uint8
(EngineCore_DP0 pid=1051916) [2026-01-26 08:25:11] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 31457280 bytes
(EngineCore_DP0 pid=1051916) [2026-01-26 08:25:11] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 12288] -> 1D uint8
(EngineCore_DP0 pid=1051916) [2026-01-26 08:25:11] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 15728640 bytes
(EngineCore_DP0 pid=1051916) 2026-01-26 08:25:23,151 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1051916) 2026-01-26 08:25:23,214 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1051916) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  5.20it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  2.87it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  3.08it/s]
(EngineCore_DP0 pid=1051916) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00, 15.92it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  55%|█████▍    | 70/128 [00:00<00:00, 697.42it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 791.37it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:29,  4.25it/s, est. speed input: 2176.11 toks/s, output: 4.25 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:07, 16.45it/s, est. speed input: 7185.96 toks/s, output: 14.03 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:00<00:05, 22.57it/s, est. speed input: 9615.62 toks/s, output: 18.78 toks/s]
Processed prompts:  10%|█         | 13/128 [00:00<00:04, 26.08it/s, est. speed input: 11052.11 toks/s, output: 21.59 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:00<00:03, 28.30it/s, est. speed input: 12015.76 toks/s, output: 23.47 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:00<00:03, 29.73it/s, est. speed input: 12701.20 toks/s, output: 24.81 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:00<00:03, 30.64it/s, est. speed input: 13206.78 toks/s, output: 25.79 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:01<00:03, 31.28it/s, est. speed input: 13602.23 toks/s, output: 26.57 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:01<00:02, 31.72it/s, est. speed input: 13918.84 toks/s, output: 27.18 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:01<00:02, 32.04it/s, est. speed input: 14180.57 toks/s, output: 27.70 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:01<00:02, 32.26it/s, est. speed input: 14397.23 toks/s, output: 28.12 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:01<00:02, 32.37it/s, est. speed input: 14576.62 toks/s, output: 28.47 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:01<00:02, 32.47it/s, est. speed input: 14732.00 toks/s, output: 28.77 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:01<00:02, 32.51it/s, est. speed input: 14864.15 toks/s, output: 29.03 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:01<00:02, 32.56it/s, est. speed input: 14981.35 toks/s, output: 29.26 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:02<00:02, 32.65it/s, est. speed input: 15090.04 toks/s, output: 29.47 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:02<00:01, 32.69it/s, est. speed input: 15184.12 toks/s, output: 29.66 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:02<00:01, 32.84it/s, est. speed input: 15278.92 toks/s, output: 29.84 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:02<00:01, 33.06it/s, est. speed input: 15372.56 toks/s, output: 30.02 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:02<00:01, 33.16it/s, est. speed input: 15453.81 toks/s, output: 30.18 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:02<00:01, 33.17it/s, est. speed input: 15523.05 toks/s, output: 30.32 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:02<00:01, 32.89it/s, est. speed input: 15566.93 toks/s, output: 30.40 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:02<00:01, 33.07it/s, est. speed input: 15631.58 toks/s, output: 30.53 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:03<00:01, 33.20it/s, est. speed input: 15691.83 toks/s, output: 30.65 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:03<00:00, 33.31it/s, est. speed input: 15748.17 toks/s, output: 30.76 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:03<00:00, 33.41it/s, est. speed input: 15801.97 toks/s, output: 30.86 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:03<00:00, 33.32it/s, est. speed input: 15842.80 toks/s, output: 30.94 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:03<00:00, 33.18it/s, est. speed input: 15876.49 toks/s, output: 31.01 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:03<00:00, 33.11it/s, est. speed input: 15909.91 toks/s, output: 31.07 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:03<00:00, 33.05it/s, est. speed input: 15940.57 toks/s, output: 31.13 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:03<00:00, 33.04it/s, est. speed input: 15970.73 toks/s, output: 31.19 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:04<00:00, 33.03it/s, est. speed input: 15998.82 toks/s, output: 31.25 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:04<00:00, 33.03it/s, est. speed input: 16012.75 toks/s, output: 31.27 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:04<00:00, 31.27it/s, est. speed input: 16012.75 toks/s, output: 31.27 toks/s]
[rank0]:[W126 08:25:30.016801597 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=1024 ==========
Time: 2026-01-26 08:25:32
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 1025 --max-num-batched-tokens 1025 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-1B-INT8_M1024.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 08:25:39 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1052994) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1052994) WARNING 01-26 08:25:53 [backends.py:609] Failed to read file <frozen os>
Throughput: 30.20 requests/s, 30952.17 total tokens/s, 30.20 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128

STDERR:
[2026-01-26 08:25:38] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 08:25:39] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-26 08:25:39] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-26 08:25:39] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:25:39] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:25:39] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:25:39] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:25:39] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:25:39] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-26 08:25:39] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 08:25:39] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 08:25:39] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 08:25:39] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 08:25:39] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 08:25:46] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 08:25:46] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-26 08:25:46] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-26 08:25:46] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:25:46] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:25:46] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:25:46] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:25:46] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:25:46] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-26 08:25:46] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 08:25:46] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 08:25:46] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 08:25:46] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 08:25:46] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1052994) [2026-01-26 08:25:48] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1052994) [2026-01-26 08:25:48] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1052994) [2026-01-26 08:25:48] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1052994) [2026-01-26 08:25:48] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1052994) [2026-01-26 08:25:48] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-1B-INT8
(EngineCore_DP0 pid=1052994) [2026-01-26 08:25:48] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1052994) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1052994) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.93it/s]
(EngineCore_DP0 pid=1052994) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.93it/s]
(EngineCore_DP0 pid=1052994) 
(EngineCore_DP0 pid=1052994) [2026-01-26 08:25:49] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 3072] -> 1D uint8
(EngineCore_DP0 pid=1052994) [2026-01-26 08:25:49] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 5898240 bytes
(EngineCore_DP0 pid=1052994) [2026-01-26 08:25:49] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 3072] -> 1D uint8
(EngineCore_DP0 pid=1052994) [2026-01-26 08:25:49] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 3932160 bytes
(EngineCore_DP0 pid=1052994) [2026-01-26 08:25:49] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 3072] -> 1D uint8
(EngineCore_DP0 pid=1052994) [2026-01-26 08:25:49] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 31457280 bytes
(EngineCore_DP0 pid=1052994) [2026-01-26 08:25:49] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 12288] -> 1D uint8
(EngineCore_DP0 pid=1052994) [2026-01-26 08:25:49] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 15728640 bytes
(EngineCore_DP0 pid=1052994) 2026-01-26 08:26:00,392 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1052994) 2026-01-26 08:26:00,421 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1052994) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  6.33it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  9.09it/s]
(EngineCore_DP0 pid=1052994) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  3.84it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  3.84it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  20%|█▉        | 25/128 [00:00<00:00, 249.17it/s]
Adding requests:  60%|██████    | 77/128 [00:00<00:00, 407.54it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 450.70it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 423.15it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:03, 32.47it/s, est. speed input: 33260.09 toks/s, output: 32.47 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:00<00:03, 32.24it/s, est. speed input: 33054.58 toks/s, output: 32.28 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:00<00:03, 32.16it/s, est. speed input: 32977.88 toks/s, output: 32.20 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:00<00:03, 32.32it/s, est. speed input: 33069.13 toks/s, output: 32.29 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:00<00:03, 32.36it/s, est. speed input: 33100.94 toks/s, output: 32.32 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:00<00:03, 32.40it/s, est. speed input: 33127.10 toks/s, output: 32.35 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:00<00:03, 32.36it/s, est. speed input: 33115.80 toks/s, output: 32.34 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:00<00:02, 32.46it/s, est. speed input: 33158.28 toks/s, output: 32.38 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:01<00:02, 32.40it/s, est. speed input: 33145.64 toks/s, output: 32.37 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:01<00:02, 32.49it/s, est. speed input: 33178.69 toks/s, output: 32.40 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:01<00:02, 32.57it/s, est. speed input: 33211.36 toks/s, output: 32.43 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:01<00:02, 32.57it/s, est. speed input: 33222.61 toks/s, output: 32.44 toks/s]
Processed prompts:  41%|████      | 52/128 [00:01<00:02, 32.59it/s, est. speed input: 33238.46 toks/s, output: 32.46 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:01<00:02, 32.63it/s, est. speed input: 33256.46 toks/s, output: 32.48 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:01<00:02, 32.57it/s, est. speed input: 33252.60 toks/s, output: 32.47 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:01<00:01, 32.55it/s, est. speed input: 33256.01 toks/s, output: 32.48 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:02<00:01, 32.57it/s, est. speed input: 33264.15 toks/s, output: 32.48 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:02<00:01, 32.59it/s, est. speed input: 33272.97 toks/s, output: 32.49 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:02<00:01, 32.55it/s, est. speed input: 33270.21 toks/s, output: 32.49 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:02<00:01, 32.57it/s, est. speed input: 33276.97 toks/s, output: 32.50 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:02<00:01, 32.58it/s, est. speed input: 33282.46 toks/s, output: 32.50 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:02<00:01, 32.57it/s, est. speed input: 33284.66 toks/s, output: 32.50 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:02<00:01, 32.52it/s, est. speed input: 33280.35 toks/s, output: 32.50 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:02<00:00, 32.53it/s, est. speed input: 33282.87 toks/s, output: 32.50 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:03<00:00, 32.55it/s, est. speed input: 33286.82 toks/s, output: 32.51 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:03<00:00, 32.57it/s, est. speed input: 33290.73 toks/s, output: 32.51 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:03<00:00, 32.60it/s, est. speed input: 33296.53 toks/s, output: 32.52 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:03<00:00, 32.65it/s, est. speed input: 33305.82 toks/s, output: 32.52 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:03<00:00, 32.63it/s, est. speed input: 33307.46 toks/s, output: 32.53 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:03<00:00, 32.63it/s, est. speed input: 33310.67 toks/s, output: 32.53 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:03<00:00, 32.60it/s, est. speed input: 33311.24 toks/s, output: 32.53 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:03<00:00, 32.61it/s, est. speed input: 33314.08 toks/s, output: 32.53 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:03<00:00, 32.61it/s, est. speed input: 33314.08 toks/s, output: 32.53 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:03<00:00, 32.53it/s, est. speed input: 33314.08 toks/s, output: 32.53 toks/s]
[rank0]:[W126 08:26:06.940621922 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=2048 ==========
Time: 2026-01-26 08:26:08
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=256, max_num_seqs=2
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 256 --max-num-seqs 2 --max-model-len 1025 --max-num-batched-tokens 2048 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-1B-INT8_M2048.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 08:26:17 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1054015) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1054015) WARNING 01-26 08:26:30 [backends.py:609] Failed to read file <frozen os>
Throughput: 60.25 requests/s, 61759.28 total tokens/s, 60.25 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256

STDERR:
[2026-01-26 08:26:16] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 08:26:16] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-26 08:26:16] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-26 08:26:16] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:26:17] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:26:17] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:26:17] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:26:17] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:26:17] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-26 08:26:17] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 08:26:17] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 08:26:17] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 08:26:17] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 08:26:17] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 08:26:23] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 08:26:24] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-26 08:26:24] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-26 08:26:24] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:26:24] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:26:24] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:26:24] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:26:24] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:26:24] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-26 08:26:24] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 08:26:24] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 08:26:24] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 08:26:24] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 08:26:24] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1054015) [2026-01-26 08:26:25] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1054015) [2026-01-26 08:26:25] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1054015) [2026-01-26 08:26:25] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1054015) [2026-01-26 08:26:25] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1054015) [2026-01-26 08:26:25] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-1B-INT8
(EngineCore_DP0 pid=1054015) [2026-01-26 08:26:25] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1054015) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1054015) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.55it/s]
(EngineCore_DP0 pid=1054015) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.55it/s]
(EngineCore_DP0 pid=1054015) 
(EngineCore_DP0 pid=1054015) [2026-01-26 08:26:26] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 3072] -> 1D uint8
(EngineCore_DP0 pid=1054015) [2026-01-26 08:26:26] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 5898240 bytes
(EngineCore_DP0 pid=1054015) [2026-01-26 08:26:26] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 3072] -> 1D uint8
(EngineCore_DP0 pid=1054015) [2026-01-26 08:26:26] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 3932160 bytes
(EngineCore_DP0 pid=1054015) [2026-01-26 08:26:26] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 3072] -> 1D uint8
(EngineCore_DP0 pid=1054015) [2026-01-26 08:26:26] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 31457280 bytes
(EngineCore_DP0 pid=1054015) [2026-01-26 08:26:26] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 12288] -> 1D uint8
(EngineCore_DP0 pid=1054015) [2026-01-26 08:26:26] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 15728640 bytes
(EngineCore_DP0 pid=1054015) 2026-01-26 08:26:37,488 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1054015) 2026-01-26 08:26:37,534 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1054015) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  33%|███▎      | 1/3 [00:00<00:00,  7.08it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00,  9.25it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00,  8.97it/s]
(EngineCore_DP0 pid=1054015) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 1/2 [00:00<00:00,  7.37it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  9.19it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  10%|█         | 26/256 [00:00<00:00, 257.29it/s]
Adding requests:  31%|███       | 79/256 [00:00<00:00, 414.59it/s]
Adding requests:  51%|█████     | 130/256 [00:00<00:00, 454.69it/s]
Adding requests:  70%|███████   | 180/256 [00:00<00:00, 470.49it/s]
Adding requests:  91%|█████████ | 232/256 [00:00<00:00, 486.86it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 463.37it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   9%|▊         | 22/256 [00:00<00:01, 177.20it/s, est. speed input: 181483.30 toks/s, output: 177.21 toks/s]
Processed prompts:  16%|█▌        | 40/256 [00:00<00:02, 91.84it/s, est. speed input: 102175.55 toks/s, output: 99.77 toks/s]  
Processed prompts:  20%|██        | 52/256 [00:00<00:02, 81.30it/s, est. speed input: 91569.43 toks/s, output: 89.42 toks/s] 
Processed prompts:  24%|██▍       | 62/256 [00:00<00:02, 76.29it/s, est. speed input: 86664.65 toks/s, output: 84.63 toks/s]
Processed prompts:  28%|██▊       | 71/256 [00:00<00:02, 75.55it/s, est. speed input: 85049.31 toks/s, output: 83.05 toks/s]
Processed prompts:  31%|███       | 79/256 [00:00<00:02, 72.69it/s, est. speed input: 82797.60 toks/s, output: 80.86 toks/s]
Processed prompts:  34%|███▍      | 87/256 [00:01<00:02, 70.64it/s, est. speed input: 81057.88 toks/s, output: 79.16 toks/s]
Processed prompts:  37%|███▋      | 95/256 [00:01<00:02, 69.11it/s, est. speed input: 79648.79 toks/s, output: 77.78 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:01<00:02, 65.64it/s, est. speed input: 77743.57 toks/s, output: 75.92 toks/s]
Processed prompts:  43%|████▎     | 110/256 [00:01<00:02, 65.57it/s, est. speed input: 76844.86 toks/s, output: 75.04 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:01<00:02, 65.55it/s, est. speed input: 76092.11 toks/s, output: 74.31 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:01<00:01, 65.62it/s, est. speed input: 75473.07 toks/s, output: 73.70 toks/s]
Processed prompts:  52%|█████▏    | 134/256 [00:01<00:01, 65.54it/s, est. speed input: 74900.99 toks/s, output: 73.14 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:01<00:01, 65.45it/s, est. speed input: 74391.80 toks/s, output: 72.65 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:02<00:01, 65.83it/s, est. speed input: 74041.88 toks/s, output: 72.31 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:02<00:01, 66.08it/s, est. speed input: 73726.02 toks/s, output: 72.00 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:02<00:01, 66.23it/s, est. speed input: 73438.63 toks/s, output: 71.72 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:02<00:01, 65.99it/s, est. speed input: 73116.18 toks/s, output: 71.40 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:02<00:01, 65.83it/s, est. speed input: 72825.26 toks/s, output: 71.12 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:02<00:01, 65.67it/s, est. speed input: 72553.41 toks/s, output: 70.85 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:02<00:00, 65.72it/s, est. speed input: 72331.07 toks/s, output: 70.63 toks/s]
Processed prompts:  80%|████████  | 206/256 [00:02<00:00, 65.60it/s, est. speed input: 72102.33 toks/s, output: 70.41 toks/s]
Processed prompts:  84%|████████▎ | 214/256 [00:03<00:00, 65.46it/s, est. speed input: 71884.40 toks/s, output: 70.20 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:03<00:00, 65.42it/s, est. speed input: 71691.51 toks/s, output: 70.01 toks/s]
Processed prompts:  90%|████████▉ | 230/256 [00:03<00:00, 65.31it/s, est. speed input: 71502.06 toks/s, output: 69.83 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:03<00:00, 65.09it/s, est. speed input: 71307.25 toks/s, output: 69.64 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:03<00:00, 65.06it/s, est. speed input: 71142.37 toks/s, output: 69.47 toks/s]
Processed prompts:  99%|█████████▉| 254/256 [00:03<00:00, 65.07it/s, est. speed input: 70992.14 toks/s, output: 69.33 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:03<00:00, 65.07it/s, est. speed input: 70958.46 toks/s, output: 69.29 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:03<00:00, 69.29it/s, est. speed input: 70958.46 toks/s, output: 69.29 toks/s]
[rank0]:[W126 08:26:44.053951303 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=4096 ==========
Time: 2026-01-26 08:26:45
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=512, max_num_seqs=4
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 512 --max-num-seqs 4 --max-model-len 1025 --max-num-batched-tokens 4096 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-1B-INT8_M4096.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 08:26:55 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1055138) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1055138) WARNING 01-26 08:27:09 [backends.py:609] Failed to read file <frozen os>
Throughput: 110.75 requests/s, 113517.38 total tokens/s, 110.75 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512

STDERR:
[2026-01-26 08:26:53] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 08:26:55] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-26 08:26:55] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-26 08:26:55] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:26:55] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:26:55] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:26:55] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:26:55] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:26:55] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-26 08:26:55] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 08:26:55] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 08:26:55] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 08:26:55] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 08:26:55] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 08:27:01] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 08:27:02] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-26 08:27:02] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-26 08:27:02] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:27:02] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:27:02] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:27:02] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:27:02] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:27:02] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-26 08:27:02] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 08:27:02] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 08:27:02] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 08:27:02] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 08:27:02] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1055138) [2026-01-26 08:27:03] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1055138) [2026-01-26 08:27:03] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1055138) [2026-01-26 08:27:03] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1055138) [2026-01-26 08:27:03] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1055138) [2026-01-26 08:27:03] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-1B-INT8
(EngineCore_DP0 pid=1055138) [2026-01-26 08:27:03] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1055138) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1055138) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.58it/s]
(EngineCore_DP0 pid=1055138) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.58it/s]
(EngineCore_DP0 pid=1055138) 
(EngineCore_DP0 pid=1055138) [2026-01-26 08:27:04] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 3072] -> 1D uint8
(EngineCore_DP0 pid=1055138) [2026-01-26 08:27:04] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 5898240 bytes
(EngineCore_DP0 pid=1055138) [2026-01-26 08:27:04] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 3072] -> 1D uint8
(EngineCore_DP0 pid=1055138) [2026-01-26 08:27:04] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 3932160 bytes
(EngineCore_DP0 pid=1055138) [2026-01-26 08:27:04] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 3072] -> 1D uint8
(EngineCore_DP0 pid=1055138) [2026-01-26 08:27:04] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 31457280 bytes
(EngineCore_DP0 pid=1055138) [2026-01-26 08:27:04] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 12288] -> 1D uint8
(EngineCore_DP0 pid=1055138) [2026-01-26 08:27:04] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 15728640 bytes
(EngineCore_DP0 pid=1055138) 2026-01-26 08:27:16,094 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1055138) 2026-01-26 08:27:16,146 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1055138) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 2/4 [00:00<00:00, 16.77it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00, 17.28it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00, 17.19it/s]
(EngineCore_DP0 pid=1055138) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00, 20.49it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00, 20.48it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   5%|▌         | 27/512 [00:00<00:01, 269.09it/s]
Adding requests:  16%|█▌        | 80/512 [00:00<00:01, 420.77it/s]
Adding requests:  26%|██▌       | 132/512 [00:00<00:00, 464.15it/s]
Adding requests:  36%|███▌      | 182/512 [00:00<00:00, 476.42it/s]
Adding requests:  46%|████▌     | 234/512 [00:00<00:00, 492.04it/s]
Adding requests:  56%|█████▌    | 286/512 [00:00<00:00, 499.24it/s]
Adding requests:  66%|██████▌   | 336/512 [00:00<00:00, 499.21it/s]
Adding requests:  76%|███████▌  | 389/512 [00:00<00:00, 507.32it/s]
Adding requests:  86%|████████▌ | 441/512 [00:00<00:00, 509.41it/s]
Adding requests:  96%|█████████▋| 493/512 [00:01<00:00, 511.54it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 489.82it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  13%|█▎        | 66/512 [00:00<00:00, 623.78it/s, est. speed input: 638861.24 toks/s, output: 623.81 toks/s]
Processed prompts:  25%|██▌       | 129/512 [00:00<00:01, 201.36it/s, est. speed input: 230112.95 toks/s, output: 224.72 toks/s]
Processed prompts:  32%|███▏      | 163/512 [00:00<00:02, 167.54it/s, est. speed input: 195538.89 toks/s, output: 190.95 toks/s]
Processed prompts:  37%|███▋      | 187/512 [00:01<00:02, 156.13it/s, est. speed input: 183934.72 toks/s, output: 179.62 toks/s]
Processed prompts:  40%|████      | 207/512 [00:01<00:02, 148.92it/s, est. speed input: 177035.66 toks/s, output: 172.88 toks/s]
Processed prompts:  44%|████▍     | 225/512 [00:01<00:01, 147.72it/s, est. speed input: 174195.87 toks/s, output: 170.11 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:01<00:01, 136.37it/s, est. speed input: 167493.53 toks/s, output: 163.56 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:01<00:01, 134.26it/s, est. speed input: 164640.36 toks/s, output: 160.78 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:01<00:01, 132.59it/s, est. speed input: 162201.03 toks/s, output: 158.40 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:01<00:01, 131.36it/s, est. speed input: 160109.57 toks/s, output: 156.35 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:01<00:01, 130.15it/s, est. speed input: 158201.59 toks/s, output: 154.49 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:02<00:01, 129.64it/s, est. speed input: 156617.09 toks/s, output: 152.94 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:02<00:01, 129.16it/s, est. speed input: 155186.47 toks/s, output: 151.55 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:02<00:01, 128.44it/s, est. speed input: 153820.66 toks/s, output: 150.21 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [00:02<00:01, 128.84it/s, est. speed input: 152782.76 toks/s, output: 149.20 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [00:02<00:00, 129.25it/s, est. speed input: 151866.57 toks/s, output: 148.31 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [00:02<00:00, 129.41it/s, est. speed input: 151008.19 toks/s, output: 147.47 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [00:02<00:00, 128.91it/s, est. speed input: 150122.07 toks/s, output: 146.60 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [00:02<00:00, 128.27it/s, est. speed input: 149261.06 toks/s, output: 145.76 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [00:03<00:00, 128.50it/s, est. speed input: 148576.17 toks/s, output: 145.09 toks/s]
Processed prompts:  91%|█████████ | 466/512 [00:03<00:00, 129.14it/s, est. speed input: 148015.91 toks/s, output: 144.55 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [00:03<00:00, 129.48it/s, est. speed input: 147479.73 toks/s, output: 144.02 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [00:03<00:00, 129.34it/s, est. speed input: 146930.85 toks/s, output: 143.49 toks/s]
Processed prompts: 100%|█████████▉| 511/512 [00:03<00:00, 127.90it/s, est. speed input: 146342.61 toks/s, output: 142.91 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:03<00:00, 127.90it/s, est. speed input: 146620.39 toks/s, output: 143.18 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:03<00:00, 143.18it/s, est. speed input: 146620.39 toks/s, output: 143.18 toks/s]
[rank0]:[W126 08:27:23.039358336 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=8192 ==========
Time: 2026-01-26 08:27:25
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=1024, max_num_seqs=8
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 1024 --max-num-seqs 8 --max-model-len 1025 --max-num-batched-tokens 8192 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-1B-INT8_M8192.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 08:27:36 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1056245) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1056245) WARNING 01-26 08:27:49 [backends.py:609] Failed to read file <frozen os>
Throughput: 149.36 requests/s, 153090.24 total tokens/s, 149.36 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024

STDERR:
[2026-01-26 08:27:35] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 08:27:36] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-26 08:27:36] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-26 08:27:36] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:27:36] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:27:36] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:27:36] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:27:36] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:27:36] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-26 08:27:36] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 08:27:36] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 08:27:36] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 08:27:36] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 08:27:36] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 08:27:42] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 08:27:43] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-26 08:27:43] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-26 08:27:43] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:27:43] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:27:43] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:27:43] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:27:43] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:27:43] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-26 08:27:43] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 08:27:43] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 08:27:43] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 08:27:43] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 08:27:43] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1056245) [2026-01-26 08:27:44] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1056245) [2026-01-26 08:27:44] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1056245) [2026-01-26 08:27:44] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1056245) [2026-01-26 08:27:44] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1056245) [2026-01-26 08:27:44] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-1B-INT8
(EngineCore_DP0 pid=1056245) [2026-01-26 08:27:44] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1056245) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1056245) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.61it/s]
(EngineCore_DP0 pid=1056245) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.61it/s]
(EngineCore_DP0 pid=1056245) 
(EngineCore_DP0 pid=1056245) [2026-01-26 08:27:45] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 3072] -> 1D uint8
(EngineCore_DP0 pid=1056245) [2026-01-26 08:27:45] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 5898240 bytes
(EngineCore_DP0 pid=1056245) [2026-01-26 08:27:45] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 3072] -> 1D uint8
(EngineCore_DP0 pid=1056245) [2026-01-26 08:27:45] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 3932160 bytes
(EngineCore_DP0 pid=1056245) [2026-01-26 08:27:45] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 3072] -> 1D uint8
(EngineCore_DP0 pid=1056245) [2026-01-26 08:27:45] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 31457280 bytes
(EngineCore_DP0 pid=1056245) [2026-01-26 08:27:45] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 12288] -> 1D uint8
(EngineCore_DP0 pid=1056245) [2026-01-26 08:27:45] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 15728640 bytes
(EngineCore_DP0 pid=1056245) 2026-01-26 08:27:56,973 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1056245) 2026-01-26 08:27:57,004 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1056245) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:00,  5.00it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  60%|██████    | 3/5 [00:00<00:00,  5.13it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  80%|████████  | 4/5 [00:00<00:00,  6.05it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00,  6.30it/s]
(EngineCore_DP0 pid=1056245) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:01,  2.57it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  8.79it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  7.44it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   3%|▎         | 31/1024 [00:00<00:03, 308.10it/s]
Adding requests:   8%|▊         | 84/1024 [00:00<00:02, 435.74it/s]
Adding requests:  13%|█▎        | 135/1024 [00:00<00:01, 469.43it/s]
Adding requests:  18%|█▊        | 185/1024 [00:00<00:01, 478.10it/s]
Adding requests:  23%|██▎       | 237/1024 [00:00<00:01, 491.49it/s]
Adding requests:  28%|██▊       | 288/1024 [00:00<00:01, 495.13it/s]
Adding requests:  33%|███▎      | 338/1024 [00:00<00:01, 495.77it/s]
Adding requests:  38%|███▊      | 390/1024 [00:00<00:01, 501.70it/s]
Adding requests:  43%|████▎     | 441/1024 [00:00<00:01, 502.69it/s]
Adding requests:  48%|████▊     | 493/1024 [00:01<00:01, 505.72it/s]
Adding requests:  53%|█████▎    | 544/1024 [00:01<00:00, 494.29it/s]
Adding requests:  58%|█████▊    | 597/1024 [00:01<00:00, 503.55it/s]
Adding requests:  63%|██████▎   | 650/1024 [00:01<00:00, 508.85it/s]
Adding requests:  69%|██████▉   | 704/1024 [00:01<00:00, 516.80it/s]
Adding requests:  74%|███████▍  | 756/1024 [00:01<00:00, 514.26it/s]
Adding requests:  79%|███████▉  | 808/1024 [00:01<00:00, 509.86it/s]
Adding requests:  84%|████████▍ | 860/1024 [00:01<00:00, 508.09it/s]
Adding requests:  89%|████████▉ | 913/1024 [00:01<00:00, 512.90it/s]
Adding requests:  94%|█████████▍| 966/1024 [00:01<00:00, 516.52it/s]
Adding requests: 100%|█████████▉| 1019/1024 [00:02<00:00, 517.81it/s]
Adding requests: 100%|██████████| 1024/1024 [00:02<00:00, 500.79it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [00:00<00:00, 1543.08it/s, est. speed input: 1580393.26 toks/s, output: 1543.16 toks/s]
Processed prompts:  33%|███▎      | 333/1024 [00:00<00:02, 299.85it/s, est. speed input: 352607.79 toks/s, output: 344.34 toks/s]   
Processed prompts:  40%|███▉      | 408/1024 [00:01<00:02, 256.78it/s, est. speed input: 305264.75 toks/s, output: 298.11 toks/s]
Processed prompts:  45%|████▍     | 457/1024 [00:01<00:02, 237.86it/s, est. speed input: 286514.60 toks/s, output: 279.80 toks/s]
Processed prompts:  48%|████▊     | 494/1024 [00:01<00:02, 220.57it/s, est. speed input: 272538.08 toks/s, output: 266.15 toks/s]
Processed prompts:  51%|█████     | 524/1024 [00:02<00:02, 208.61it/s, est. speed input: 263414.16 toks/s, output: 257.24 toks/s]
Processed prompts:  54%|█████▎    | 550/1024 [00:02<00:02, 205.62it/s, est. speed input: 259313.74 toks/s, output: 253.23 toks/s]
Processed prompts:  56%|█████▌    | 574/1024 [00:02<00:02, 199.87it/s, est. speed input: 254849.51 toks/s, output: 248.88 toks/s]
Processed prompts:  58%|█████▊    | 596/1024 [00:02<00:02, 191.52it/s, est. speed input: 250062.42 toks/s, output: 244.20 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:02<00:02, 184.51it/s, est. speed input: 245743.68 toks/s, output: 239.98 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:02<00:02, 182.96it/s, est. speed input: 242626.42 toks/s, output: 236.94 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:02<00:01, 181.66it/s, est. speed input: 239779.47 toks/s, output: 234.15 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:02<00:01, 179.97it/s, est. speed input: 237032.34 toks/s, output: 231.47 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:03<00:01, 179.37it/s, est. speed input: 234655.48 toks/s, output: 229.15 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:03<00:01, 178.92it/s, est. speed input: 232472.45 toks/s, output: 227.02 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:03<00:01, 178.75it/s, est. speed input: 230488.99 toks/s, output: 225.09 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:03<00:01, 178.54it/s, est. speed input: 228645.25 toks/s, output: 223.28 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:03<00:01, 178.53it/s, est. speed input: 226958.26 toks/s, output: 221.64 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:03<00:01, 178.56it/s, est. speed input: 225396.07 toks/s, output: 220.11 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:03<00:00, 178.36it/s, est. speed input: 223910.53 toks/s, output: 218.66 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [00:04<00:00, 178.20it/s, est. speed input: 222519.81 toks/s, output: 217.30 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [00:04<00:00, 177.97it/s, est. speed input: 221203.19 toks/s, output: 216.02 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [00:04<00:00, 178.03it/s, est. speed input: 219996.97 toks/s, output: 214.84 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [00:04<00:00, 179.97it/s, est. speed input: 219096.34 toks/s, output: 213.96 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [00:04<00:00, 179.17it/s, est. speed input: 217989.95 toks/s, output: 212.88 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [00:04<00:00, 180.76it/s, est. speed input: 217194.10 toks/s, output: 212.10 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:04<00:00, 180.76it/s, est. speed input: 218035.48 toks/s, output: 212.92 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:04<00:00, 212.91it/s, est. speed input: 218035.48 toks/s, output: 212.92 toks/s]
[rank0]:[W126 08:28:06.935704291 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=16384 ==========
Time: 2026-01-26 08:28:09
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=2048, max_num_seqs=16
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 2048 --max-num-seqs 16 --max-model-len 1025 --max-num-batched-tokens 16384 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-1B-INT8_M16384.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 08:28:24 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1057458) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1057458) WARNING 01-26 08:28:38 [backends.py:609] Failed to read file <frozen os>
Throughput: 182.92 requests/s, 187491.13 total tokens/s, 182.92 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048

STDERR:
[2026-01-26 08:28:24] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 08:28:24] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-26 08:28:24] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-26 08:28:24] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:28:24] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:28:24] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:28:24] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:28:24] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:28:24] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-26 08:28:24] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 08:28:24] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 08:28:24] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 08:28:24] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 08:28:24] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 08:28:31] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 08:28:32] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-26 08:28:32] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-26 08:28:32] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:28:32] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:28:32] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:28:32] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:28:32] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:28:32] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-26 08:28:32] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 08:28:32] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 08:28:32] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 08:28:32] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 08:28:32] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1057458) [2026-01-26 08:28:33] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1057458) [2026-01-26 08:28:33] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1057458) [2026-01-26 08:28:33] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1057458) [2026-01-26 08:28:33] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1057458) [2026-01-26 08:28:33] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-1B-INT8
(EngineCore_DP0 pid=1057458) [2026-01-26 08:28:33] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1057458) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1057458) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.58it/s]
(EngineCore_DP0 pid=1057458) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.58it/s]
(EngineCore_DP0 pid=1057458) 
(EngineCore_DP0 pid=1057458) [2026-01-26 08:28:34] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 3072] -> 1D uint8
(EngineCore_DP0 pid=1057458) [2026-01-26 08:28:34] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 5898240 bytes
(EngineCore_DP0 pid=1057458) [2026-01-26 08:28:34] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 3072] -> 1D uint8
(EngineCore_DP0 pid=1057458) [2026-01-26 08:28:34] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 3932160 bytes
(EngineCore_DP0 pid=1057458) [2026-01-26 08:28:34] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 3072] -> 1D uint8
(EngineCore_DP0 pid=1057458) [2026-01-26 08:28:34] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 31457280 bytes
(EngineCore_DP0 pid=1057458) [2026-01-26 08:28:34] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 12288] -> 1D uint8
(EngineCore_DP0 pid=1057458) [2026-01-26 08:28:34] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 15728640 bytes
(EngineCore_DP0 pid=1057458) 2026-01-26 08:28:46,186 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1057458) 2026-01-26 08:28:46,249 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1057458) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  29%|██▊       | 2/7 [00:00<00:00, 15.17it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  57%|█████▋    | 4/7 [00:00<00:00, 10.81it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  86%|████████▌ | 6/7 [00:00<00:00, 13.67it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00, 13.34it/s]
(EngineCore_DP0 pid=1057458) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  20%|██        | 1/5 [00:00<00:00,  6.67it/s]
Capturing CUDA graphs (decode, FULL):  60%|██████    | 3/5 [00:00<00:00,  4.80it/s]
Capturing CUDA graphs (decode, FULL):  80%|████████  | 4/5 [00:00<00:00,  4.64it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00,  5.49it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00,  5.26it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 34/2048 [00:00<00:05, 338.55it/s]
Adding requests:   4%|▍         | 86/2048 [00:00<00:04, 443.17it/s]
Adding requests:   7%|▋         | 137/2048 [00:00<00:04, 469.60it/s]
Adding requests:   9%|▉         | 187/2048 [00:00<00:03, 479.12it/s]
Adding requests:  12%|█▏        | 238/2048 [00:00<00:03, 488.53it/s]
Adding requests:  14%|█▍        | 288/2048 [00:00<00:03, 490.25it/s]
Adding requests:  17%|█▋        | 338/2048 [00:00<00:03, 491.99it/s]
Adding requests:  19%|█▉        | 390/2048 [00:00<00:03, 499.15it/s]
Adding requests:  22%|██▏       | 441/2048 [00:00<00:03, 500.32it/s]
Adding requests:  24%|██▍       | 492/2048 [00:01<00:03, 498.70it/s]
Adding requests:  26%|██▋       | 542/2048 [00:01<00:03, 494.13it/s]
Adding requests:  29%|██▉       | 596/2048 [00:01<00:02, 505.22it/s]
Adding requests:  32%|███▏      | 650/2048 [00:01<00:02, 512.45it/s]
Adding requests:  34%|███▍      | 705/2048 [00:01<00:02, 521.49it/s]
Adding requests:  37%|███▋      | 758/2048 [00:01<00:02, 520.83it/s]
Adding requests:  40%|███▉      | 811/2048 [00:01<00:02, 514.37it/s]
Adding requests:  42%|████▏     | 863/2048 [00:01<00:02, 504.09it/s]
Adding requests:  45%|████▍     | 917/2048 [00:01<00:02, 512.53it/s]
Adding requests:  47%|████▋     | 970/2048 [00:01<00:02, 515.80it/s]
Adding requests:  50%|█████     | 1024/2048 [00:02<00:01, 520.67it/s]
Adding requests:  53%|█████▎    | 1077/2048 [00:02<00:01, 510.43it/s]
Adding requests:  55%|█████▌    | 1129/2048 [00:02<00:01, 510.46it/s]
Adding requests:  58%|█████▊    | 1184/2048 [00:02<00:01, 519.96it/s]
Adding requests:  60%|██████    | 1237/2048 [00:02<00:01, 522.49it/s]
Adding requests:  63%|██████▎   | 1290/2048 [00:02<00:01, 518.03it/s]
Adding requests:  66%|██████▌   | 1344/2048 [00:02<00:01, 523.06it/s]
Adding requests:  68%|██████▊   | 1398/2048 [00:02<00:01, 526.33it/s]
Adding requests:  71%|███████   | 1451/2048 [00:02<00:01, 524.18it/s]
Adding requests:  74%|███████▎  | 1506/2048 [00:02<00:01, 527.45it/s]
Adding requests:  76%|███████▌  | 1559/2048 [00:03<00:00, 527.87it/s]
Adding requests:  79%|███████▉  | 1613/2048 [00:03<00:00, 531.13it/s]
Adding requests:  81%|████████▏ | 1667/2048 [00:03<00:00, 527.81it/s]
Adding requests:  84%|████████▍ | 1721/2048 [00:03<00:00, 529.45it/s]
Adding requests:  87%|████████▋ | 1774/2048 [00:03<00:00, 523.97it/s]
Adding requests:  89%|████████▉ | 1827/2048 [00:03<00:00, 524.29it/s]
Adding requests:  92%|█████████▏| 1880/2048 [00:03<00:00, 523.62it/s]
Adding requests:  94%|█████████▍| 1933/2048 [00:03<00:00, 523.72it/s]
Adding requests:  97%|█████████▋| 1986/2048 [00:03<00:00, 510.59it/s]
Adding requests: 100%|█████████▉| 2039/2048 [00:03<00:00, 515.96it/s]
Adding requests: 100%|██████████| 2048/2048 [00:04<00:00, 511.32it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [00:00<00:00, 4434.89it/s, est. speed input: 4542648.60 toks/s, output: 4435.31 toks/s]
Processed prompts:  57%|█████▋    | 1166/2048 [00:02<00:02, 390.64it/s, est. speed input: 481606.10 toks/s, output: 470.32 toks/s]  
Processed prompts:  66%|██████▋   | 1360/2048 [00:03<00:02, 314.79it/s, est. speed input: 397286.17 toks/s, output: 387.97 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [00:04<00:02, 275.24it/s, est. speed input: 359898.22 toks/s, output: 351.46 toks/s]
Processed prompts:  76%|███████▌  | 1550/2048 [00:04<00:01, 266.22it/s, est. speed input: 349525.37 toks/s, output: 341.33 toks/s]
Processed prompts:  78%|███████▊  | 1607/2048 [00:04<00:01, 248.15it/s, est. speed input: 337130.27 toks/s, output: 329.23 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [00:05<00:01, 235.20it/s, est. speed input: 329010.56 toks/s, output: 321.30 toks/s]
Processed prompts:  82%|████████▏ | 1685/2048 [00:05<00:01, 230.60it/s, est. speed input: 325006.39 toks/s, output: 317.39 toks/s]
Processed prompts:  84%|████████▎ | 1715/2048 [00:05<00:01, 221.10it/s, est. speed input: 320319.26 toks/s, output: 312.81 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [00:05<00:01, 213.10it/s, est. speed input: 316123.37 toks/s, output: 308.71 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [00:05<00:01, 207.32it/s, est. speed input: 312406.88 toks/s, output: 305.08 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [00:06<00:01, 202.01it/s, est. speed input: 308843.05 toks/s, output: 301.60 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [00:06<00:01, 197.97it/s, est. speed input: 305534.24 toks/s, output: 298.37 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [00:06<00:00, 195.86it/s, est. speed input: 302578.39 toks/s, output: 295.49 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [00:06<00:00, 192.94it/s, est. speed input: 299584.68 toks/s, output: 292.56 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [00:06<00:00, 190.64it/s, est. speed input: 296727.42 toks/s, output: 289.77 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [00:06<00:00, 190.27it/s, est. speed input: 294192.03 toks/s, output: 287.30 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [00:07<00:00, 191.36it/s, est. speed input: 291952.83 toks/s, output: 285.11 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [00:07<00:00, 191.87it/s, est. speed input: 289781.81 toks/s, output: 282.99 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:07<00:00, 191.87it/s, est. speed input: 291750.68 toks/s, output: 284.91 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:07<00:00, 284.90it/s, est. speed input: 291750.68 toks/s, output: 284.91 toks/s]
[rank0]:[W126 08:29:00.707417658 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=32768 ==========
Time: 2026-01-26 08:29:02
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=4096, max_num_seqs=32
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 4096 --max-num-seqs 32 --max-model-len 1025 --max-num-batched-tokens 32768 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-1B-INT8_M32768.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 08:29:26 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1058849) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1058849) WARNING 01-26 08:29:40 [backends.py:609] Failed to read file <frozen os>
Throughput: 189.10 requests/s, 193830.32 total tokens/s, 189.10 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096

STDERR:
[2026-01-26 08:29:25] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 08:29:26] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-26 08:29:26] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-26 08:29:26] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:29:26] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:29:26] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:29:26] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:29:26] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:29:26] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-26 08:29:26] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 08:29:26] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 08:29:26] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 08:29:26] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 08:29:26] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 08:29:32] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 08:29:33] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-26 08:29:33] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-26 08:29:33] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:29:33] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:29:33] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:29:33] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:29:33] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:29:33] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-26 08:29:33] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 08:29:33] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 08:29:33] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 08:29:33] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 08:29:33] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1058849) [2026-01-26 08:29:34] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1058849) [2026-01-26 08:29:34] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1058849) [2026-01-26 08:29:34] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1058849) [2026-01-26 08:29:34] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1058849) [2026-01-26 08:29:34] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-1B-INT8
(EngineCore_DP0 pid=1058849) [2026-01-26 08:29:34] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1058849) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1058849) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.34it/s]
(EngineCore_DP0 pid=1058849) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.34it/s]
(EngineCore_DP0 pid=1058849) 
(EngineCore_DP0 pid=1058849) [2026-01-26 08:29:36] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 3072] -> 1D uint8
(EngineCore_DP0 pid=1058849) [2026-01-26 08:29:36] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 5898240 bytes
(EngineCore_DP0 pid=1058849) [2026-01-26 08:29:36] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 3072] -> 1D uint8
(EngineCore_DP0 pid=1058849) [2026-01-26 08:29:36] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 3932160 bytes
(EngineCore_DP0 pid=1058849) [2026-01-26 08:29:36] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 3072] -> 1D uint8
(EngineCore_DP0 pid=1058849) [2026-01-26 08:29:36] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 31457280 bytes
(EngineCore_DP0 pid=1058849) [2026-01-26 08:29:36] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 12288] -> 1D uint8
(EngineCore_DP0 pid=1058849) [2026-01-26 08:29:36] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 15728640 bytes
(EngineCore_DP0 pid=1058849) [rank0]:W0126 08:29:43.931000 1058849 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1058849) [rank0]:W0126 08:29:43.985000 1058849 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1058849) [rank0]:W0126 08:29:44.626000 1058849 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1058849) [rank0]:W0126 08:29:44.702000 1058849 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1058849) 2026-01-26 08:29:47,253 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1058849) 2026-01-26 08:29:47,285 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1058849) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   9%|▉         | 1/11 [00:00<00:01,  8.54it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  18%|█▊        | 2/11 [00:00<00:02,  3.04it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  27%|██▋       | 3/11 [00:00<00:01,  4.30it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  45%|████▌     | 5/11 [00:00<00:00,  7.60it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  64%|██████▎   | 7/11 [00:01<00:00,  8.09it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  82%|████████▏ | 9/11 [00:01<00:00, 10.45it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00, 12.05it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00,  8.64it/s]
(EngineCore_DP0 pid=1058849) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  29%|██▊       | 2/7 [00:00<00:00, 18.13it/s]
Capturing CUDA graphs (decode, FULL):  57%|█████▋    | 4/7 [00:00<00:00, 18.75it/s]
Capturing CUDA graphs (decode, FULL):  86%|████████▌ | 6/7 [00:00<00:00, 19.22it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00, 15.49it/s]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   1%|          | 32/4096 [00:00<00:12, 319.08it/s]
Adding requests:   2%|▏         | 84/4096 [00:00<00:09, 436.02it/s]
Adding requests:   3%|▎         | 136/4096 [00:00<00:08, 469.66it/s]
Adding requests:   5%|▍         | 187/4096 [00:00<00:08, 482.68it/s]
Adding requests:   6%|▌         | 239/4096 [00:00<00:07, 494.52it/s]
Adding requests:   7%|▋         | 290/4096 [00:00<00:07, 499.03it/s]
Adding requests:   8%|▊         | 341/4096 [00:00<00:07, 500.47it/s]
Adding requests:  10%|▉         | 394/4096 [00:00<00:07, 507.96it/s]
Adding requests:  11%|█         | 445/4096 [00:00<00:07, 505.44it/s]
Adding requests:  12%|█▏        | 496/4096 [00:01<00:07, 505.13it/s]
Adding requests:  13%|█▎        | 547/4096 [00:01<00:07, 498.14it/s]
Adding requests:  15%|█▍        | 599/4096 [00:01<00:06, 503.80it/s]
Adding requests:  16%|█▌        | 651/4096 [00:01<00:06, 508.10it/s]
Adding requests:  17%|█▋        | 705/4096 [00:01<00:06, 514.49it/s]
Adding requests:  18%|█▊        | 757/4096 [00:01<00:06, 513.09it/s]
Adding requests:  20%|█▉        | 809/4096 [00:01<00:06, 505.76it/s]
Adding requests:  21%|██        | 860/4096 [00:01<00:06, 504.68it/s]
Adding requests:  22%|██▏       | 913/4096 [00:01<00:06, 510.29it/s]
Adding requests:  24%|██▎       | 965/4096 [00:01<00:06, 512.93it/s]
Adding requests:  25%|██▍       | 1018/4096 [00:02<00:05, 515.03it/s]
Adding requests:  26%|██▌       | 1070/4096 [00:02<00:06, 501.28it/s]
Adding requests:  27%|██▋       | 1121/4096 [00:02<00:05, 501.40it/s]
Adding requests:  29%|██▊       | 1175/4096 [00:02<00:05, 510.63it/s]
Adding requests:  30%|███       | 1229/4096 [00:02<00:05, 518.54it/s]
Adding requests:  31%|███▏      | 1281/4096 [00:02<00:05, 513.15it/s]
Adding requests:  33%|███▎      | 1334/4096 [00:02<00:05, 517.84it/s]
Adding requests:  34%|███▍      | 1386/4096 [00:02<00:05, 518.16it/s]
Adding requests:  35%|███▌      | 1438/4096 [00:02<00:05, 517.84it/s]
Adding requests:  36%|███▋      | 1492/4096 [00:02<00:04, 522.49it/s]
Adding requests:  38%|███▊      | 1545/4096 [00:03<00:04, 523.02it/s]
Adding requests:  39%|███▉      | 1599/4096 [00:03<00:04, 527.72it/s]
Adding requests:  40%|████      | 1652/4096 [00:03<00:04, 526.24it/s]
Adding requests:  42%|████▏     | 1705/4096 [00:03<00:04, 522.92it/s]
Adding requests:  43%|████▎     | 1758/4096 [00:03<00:04, 521.94it/s]
Adding requests:  44%|████▍     | 1811/4096 [00:03<00:04, 522.54it/s]
Adding requests:  46%|████▌     | 1864/4096 [00:03<00:04, 517.91it/s]
Adding requests:  47%|████▋     | 1917/4096 [00:03<00:04, 520.51it/s]
Adding requests:  48%|████▊     | 1970/4096 [00:03<00:04, 518.67it/s]
Adding requests:  49%|████▉     | 2023/4096 [00:03<00:03, 521.87it/s]
Adding requests:  51%|█████     | 2077/4096 [00:04<00:03, 525.13it/s]
Adding requests:  52%|█████▏    | 2130/4096 [00:04<00:03, 519.19it/s]
Adding requests:  53%|█████▎    | 2182/4096 [00:04<00:03, 512.94it/s]
Adding requests:  55%|█████▍    | 2234/4096 [00:04<00:03, 504.73it/s]
Adding requests:  56%|█████▌    | 2286/4096 [00:04<00:03, 506.74it/s]
Adding requests:  57%|█████▋    | 2339/4096 [00:04<00:03, 510.65it/s]
Adding requests:  58%|█████▊    | 2392/4096 [00:04<00:03, 515.04it/s]
Adding requests:  60%|█████▉    | 2445/4096 [00:04<00:03, 516.62it/s]
Adding requests:  61%|██████    | 2498/4096 [00:04<00:03, 518.21it/s]
Adding requests:  62%|██████▏   | 2550/4096 [00:04<00:02, 517.57it/s]
Adding requests:  64%|██████▎   | 2602/4096 [00:05<00:02, 518.15it/s]
Adding requests:  65%|██████▍   | 2656/4096 [00:05<00:02, 522.81it/s]
Adding requests:  66%|██████▌   | 2709/4096 [00:05<00:02, 517.09it/s]
Adding requests:  67%|██████▋   | 2761/4096 [00:05<00:02, 517.87it/s]
Adding requests:  69%|██████▊   | 2813/4096 [00:05<00:02, 515.47it/s]
Adding requests:  70%|██████▉   | 2865/4096 [00:05<00:02, 515.57it/s]
Adding requests:  71%|███████   | 2917/4096 [00:05<00:02, 515.37it/s]
Adding requests:  72%|███████▏  | 2969/4096 [00:05<00:02, 513.83it/s]
Adding requests:  74%|███████▍  | 3021/4096 [00:05<00:02, 509.43it/s]
Adding requests:  75%|███████▌  | 3072/4096 [00:06<00:02, 506.98it/s]
Adding requests:  76%|███████▋  | 3125/4096 [00:06<00:01, 512.50it/s]
Adding requests:  78%|███████▊  | 3177/4096 [00:06<00:01, 513.03it/s]
Adding requests:  79%|███████▉  | 3229/4096 [00:06<00:01, 512.78it/s]
Adding requests:  80%|████████  | 3281/4096 [00:06<00:01, 512.50it/s]
Adding requests:  81%|████████▏ | 3333/4096 [00:06<00:01, 511.03it/s]
Adding requests:  83%|████████▎ | 3386/4096 [00:06<00:01, 514.29it/s]
Adding requests:  84%|████████▍ | 3438/4096 [00:06<00:01, 514.25it/s]
Adding requests:  85%|████████▌ | 3490/4096 [00:06<00:01, 506.56it/s]
Adding requests:  86%|████████▋ | 3541/4096 [00:06<00:01, 494.23it/s]
Adding requests:  88%|████████▊ | 3593/4096 [00:07<00:01, 499.61it/s]
Adding requests:  89%|████████▉ | 3644/4096 [00:07<00:00, 499.70it/s]
Adding requests:  90%|█████████ | 3697/4096 [00:07<00:00, 507.31it/s]
Adding requests:  92%|█████████▏| 3748/4096 [00:07<00:00, 507.57it/s]
Adding requests:  93%|█████████▎| 3803/4096 [00:07<00:00, 517.14it/s]
Adding requests:  94%|█████████▍| 3856/4096 [00:07<00:00, 520.84it/s]
Adding requests:  95%|█████████▌| 3909/4096 [00:07<00:00, 520.12it/s]
Adding requests:  97%|█████████▋| 3962/4096 [00:07<00:00, 521.29it/s]
Adding requests:  98%|█████████▊| 4015/4096 [00:07<00:00, 519.07it/s]
Adding requests:  99%|█████████▉| 4067/4096 [00:07<00:00, 513.40it/s]
Adding requests: 100%|██████████| 4096/4096 [00:08<00:00, 511.26it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  36%|███▋      | 1494/4096 [00:00<00:00, 5648.08it/s, est. speed input: 5784160.10 toks/s, output: 5648.24 toks/s]
Processed prompts:  50%|█████     | 2059/4096 [00:03<00:03, 534.52it/s, est. speed input: 681699.38 toks/s, output: 665.72 toks/s]   
Processed prompts:  56%|█████▋    | 2304/4096 [00:04<00:04, 399.87it/s, est. speed input: 534270.26 toks/s, output: 521.75 toks/s]
Processed prompts:  60%|█████▉    | 2446/4096 [00:05<00:04, 361.68it/s, est. speed input: 494783.05 toks/s, output: 483.19 toks/s]
Processed prompts:  62%|██████▏   | 2541/4096 [00:05<00:04, 329.53it/s, est. speed input: 468084.70 toks/s, output: 457.11 toks/s]
Processed prompts:  64%|██████▎   | 2609/4096 [00:05<00:04, 309.96it/s, est. speed input: 453244.94 toks/s, output: 442.62 toks/s]
Processed prompts:  65%|██████▍   | 2661/4096 [00:06<00:05, 281.73it/s, est. speed input: 437258.34 toks/s, output: 427.01 toks/s]
Processed prompts:  66%|██████▌   | 2701/4096 [00:06<00:05, 277.57it/s, est. speed input: 432473.77 toks/s, output: 422.34 toks/s]
Processed prompts:  67%|██████▋   | 2736/4096 [00:06<00:05, 266.72it/s, est. speed input: 426539.59 toks/s, output: 416.54 toks/s]
Processed prompts:  68%|██████▊   | 2767/4096 [00:06<00:05, 252.57it/s, est. speed input: 420504.47 toks/s, output: 410.65 toks/s]
Processed prompts:  68%|██████▊   | 2794/4096 [00:06<00:05, 234.66it/s, est. speed input: 414219.19 toks/s, output: 404.51 toks/s]
Processed prompts:  69%|██████▉   | 2818/4096 [00:07<00:05, 216.08it/s, est. speed input: 408100.81 toks/s, output: 398.54 toks/s]
Processed prompts:  69%|██████▉   | 2839/4096 [00:07<00:06, 195.59it/s, est. speed input: 401804.77 toks/s, output: 392.39 toks/s]
Processed prompts:  70%|███████   | 2870/4096 [00:07<00:06, 193.85it/s, est. speed input: 397170.32 toks/s, output: 387.86 toks/s]
Processed prompts:  71%|███████   | 2902/4096 [00:07<00:06, 192.67it/s, est. speed input: 392635.04 toks/s, output: 383.43 toks/s]
Processed prompts:  72%|███████▏  | 2934/4096 [00:07<00:06, 192.68it/s, est. speed input: 388442.78 toks/s, output: 379.34 toks/s]
Processed prompts:  72%|███████▏  | 2966/4096 [00:07<00:05, 191.67it/s, est. speed input: 384272.56 toks/s, output: 375.26 toks/s]
Processed prompts:  73%|███████▎  | 2998/4096 [00:08<00:05, 190.83it/s, est. speed input: 380262.47 toks/s, output: 371.35 toks/s]
Processed prompts:  74%|███████▍  | 3030/4096 [00:08<00:05, 190.37it/s, est. speed input: 376437.61 toks/s, output: 367.61 toks/s]
Processed prompts:  75%|███████▍  | 3062/4096 [00:08<00:05, 189.97it/s, est. speed input: 372756.87 toks/s, output: 364.02 toks/s]
Processed prompts:  76%|███████▌  | 3094/4096 [00:08<00:05, 191.71it/s, est. speed input: 369480.68 toks/s, output: 360.82 toks/s]
Processed prompts:  76%|███████▋  | 3126/4096 [00:08<00:04, 194.11it/s, est. speed input: 366465.17 toks/s, output: 357.87 toks/s]
Processed prompts:  77%|███████▋  | 3158/4096 [00:08<00:04, 193.77it/s, est. speed input: 363318.95 toks/s, output: 354.80 toks/s]
Processed prompts:  78%|███████▊  | 3190/4096 [00:09<00:04, 194.10it/s, est. speed input: 360353.04 toks/s, output: 351.91 toks/s]
Processed prompts:  79%|███████▊  | 3222/4096 [00:09<00:04, 194.22it/s, est. speed input: 357479.50 toks/s, output: 349.10 toks/s]
Processed prompts:  79%|███████▉  | 3254/4096 [00:09<00:04, 192.95it/s, est. speed input: 354560.98 toks/s, output: 346.25 toks/s]
Processed prompts:  80%|████████  | 3286/4096 [00:09<00:04, 191.74it/s, est. speed input: 351711.06 toks/s, output: 343.47 toks/s]
Processed prompts:  81%|████████  | 3318/4096 [00:09<00:04, 190.63it/s, est. speed input: 348929.67 toks/s, output: 340.75 toks/s]
Processed prompts:  82%|████████▏ | 3350/4096 [00:09<00:03, 189.75it/s, est. speed input: 346233.98 toks/s, output: 338.12 toks/s]
Processed prompts:  83%|████████▎ | 3382/4096 [00:10<00:03, 189.43it/s, est. speed input: 343658.98 toks/s, output: 335.60 toks/s]
Processed prompts:  83%|████████▎ | 3414/4096 [00:10<00:03, 189.19it/s, est. speed input: 341167.60 toks/s, output: 333.17 toks/s]
Processed prompts:  84%|████████▍ | 3446/4096 [00:10<00:03, 191.25it/s, est. speed input: 338970.44 toks/s, output: 331.02 toks/s]
Processed prompts:  85%|████████▍ | 3478/4096 [00:10<00:03, 194.02it/s, est. speed input: 336960.06 toks/s, output: 329.06 toks/s]
Processed prompts:  86%|████████▌ | 3510/4096 [00:10<00:03, 193.56it/s, est. speed input: 334794.88 toks/s, output: 326.95 toks/s]
Processed prompts:  86%|████████▋ | 3542/4096 [00:10<00:02, 191.77it/s, est. speed input: 332566.65 toks/s, output: 324.77 toks/s]
Processed prompts:  87%|████████▋ | 3574/4096 [00:11<00:02, 191.30it/s, est. speed input: 330473.44 toks/s, output: 322.73 toks/s]
Processed prompts:  88%|████████▊ | 3606/4096 [00:11<00:02, 191.09it/s, est. speed input: 328452.62 toks/s, output: 320.75 toks/s]
Processed prompts:  89%|████████▉ | 3638/4096 [00:11<00:02, 190.87it/s, est. speed input: 326485.35 toks/s, output: 318.83 toks/s]
Processed prompts:  90%|████████▉ | 3670/4096 [00:11<00:02, 190.87it/s, est. speed input: 324588.23 toks/s, output: 316.98 toks/s]
Processed prompts:  90%|█████████ | 3702/4096 [00:11<00:02, 190.19it/s, est. speed input: 322689.88 toks/s, output: 315.13 toks/s]
Processed prompts:  91%|█████████ | 3734/4096 [00:11<00:01, 191.24it/s, est. speed input: 320966.15 toks/s, output: 313.44 toks/s]
Processed prompts:  92%|█████████▏| 3766/4096 [00:12<00:01, 190.58it/s, est. speed input: 319181.73 toks/s, output: 311.70 toks/s]
Processed prompts:  93%|█████████▎| 3798/4096 [00:12<00:01, 190.51it/s, est. speed input: 317476.09 toks/s, output: 310.03 toks/s]
Processed prompts:  94%|█████████▎| 3830/4096 [00:12<00:01, 193.35it/s, est. speed input: 316030.25 toks/s, output: 308.62 toks/s]
Processed prompts:  94%|█████████▍| 3862/4096 [00:12<00:01, 192.42it/s, est. speed input: 314410.21 toks/s, output: 307.04 toks/s]
Processed prompts:  95%|█████████▌| 3894/4096 [00:12<00:01, 191.49it/s, est. speed input: 312812.54 toks/s, output: 305.48 toks/s]
Processed prompts:  96%|█████████▌| 3926/4096 [00:12<00:00, 190.71it/s, est. speed input: 311246.62 toks/s, output: 303.95 toks/s]
Processed prompts:  97%|█████████▋| 3958/4096 [00:13<00:00, 189.92it/s, est. speed input: 309704.93 toks/s, output: 302.45 toks/s]
Processed prompts:  97%|█████████▋| 3990/4096 [00:13<00:00, 189.85it/s, est. speed input: 308235.03 toks/s, output: 301.01 toks/s]
Processed prompts:  98%|█████████▊| 4022/4096 [00:13<00:00, 192.95it/s, est. speed input: 307011.91 toks/s, output: 299.82 toks/s]
Processed prompts:  99%|█████████▉| 4054/4096 [00:13<00:00, 194.44it/s, est. speed input: 305770.86 toks/s, output: 298.60 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [00:13<00:00, 194.44it/s, est. speed input: 307388.84 toks/s, output: 300.18 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [00:13<00:00, 300.18it/s, est. speed input: 307388.84 toks/s, output: 300.18 toks/s]
[rank0]:[W126 08:30:12.599707243 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=65536 ==========
Time: 2026-01-26 08:30:14
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=8192, max_num_seqs=64
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 8192 --max-num-seqs 64 --max-model-len 1025 --max-num-batched-tokens 65536 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-1B-INT8_M65536.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 08:30:54 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1060544) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1060544) WARNING 01-26 08:31:08 [backends.py:609] Failed to read file <frozen os>
Throughput: 191.45 requests/s, 196240.78 total tokens/s, 191.45 output tokens/s
Total num prompt tokens:  8388608
Total num output tokens:  8192

STDERR:
[2026-01-26 08:30:54] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 08:30:54] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-26 08:30:54] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-26 08:30:54] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:30:54] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:30:54] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:30:54] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:30:54] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:30:54] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-26 08:30:54] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 08:30:54] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 08:30:54] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 08:30:54] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 08:30:54] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 08:31:01] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 08:31:02] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-26 08:31:02] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-26 08:31:02] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:31:02] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:31:02] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:31:02] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:31:02] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 08:31:02] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-26 08:31:02] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 08:31:02] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 08:31:02] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 08:31:02] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 08:31:02] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1060544) [2026-01-26 08:31:03] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1060544) [2026-01-26 08:31:03] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1060544) [2026-01-26 08:31:03] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1060544) [2026-01-26 08:31:03] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1060544) [2026-01-26 08:31:03] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-1B-INT8
(EngineCore_DP0 pid=1060544) [2026-01-26 08:31:03] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1060544) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1060544) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.56it/s]
(EngineCore_DP0 pid=1060544) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.56it/s]
(EngineCore_DP0 pid=1060544) 
(EngineCore_DP0 pid=1060544) [2026-01-26 08:31:04] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 3072] -> 1D uint8
(EngineCore_DP0 pid=1060544) [2026-01-26 08:31:04] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 5898240 bytes
(EngineCore_DP0 pid=1060544) [2026-01-26 08:31:04] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 3072] -> 1D uint8
(EngineCore_DP0 pid=1060544) [2026-01-26 08:31:04] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 3932160 bytes
(EngineCore_DP0 pid=1060544) [2026-01-26 08:31:04] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 3072] -> 1D uint8
(EngineCore_DP0 pid=1060544) [2026-01-26 08:31:04] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 31457280 bytes
(EngineCore_DP0 pid=1060544) [2026-01-26 08:31:04] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 12288] -> 1D uint8
(EngineCore_DP0 pid=1060544) [2026-01-26 08:31:04] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 15728640 bytes
(EngineCore_DP0 pid=1060544) [rank0]:W0126 08:31:12.346000 1060544 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1060544) [rank0]:W0126 08:31:12.399000 1060544 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1060544) [rank0]:W0126 08:31:13.178000 1060544 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1060544) [rank0]:W0126 08:31:13.253000 1060544 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1060544) 2026-01-26 08:31:16,076 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1060544) 2026-01-26 08:31:16,108 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1060544) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/19 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   5%|▌         | 1/19 [00:00<00:03,  4.97it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  11%|█         | 2/19 [00:00<00:03,  4.58it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  16%|█▌        | 3/19 [00:00<00:04,  3.66it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  21%|██        | 4/19 [00:01<00:03,  3.77it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  37%|███▋      | 7/19 [00:01<00:01,  7.70it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  42%|████▏     | 8/19 [00:01<00:01,  7.19it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  53%|█████▎    | 10/19 [00:01<00:01,  7.59it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  63%|██████▎   | 12/19 [00:01<00:00,  9.44it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  79%|███████▉  | 15/19 [00:01<00:00, 12.33it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  95%|█████████▍| 18/19 [00:02<00:00, 12.51it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 19/19 [00:02<00:00,  8.80it/s]
(EngineCore_DP0 pid=1060544) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):   9%|▉         | 1/11 [00:00<00:03,  2.58it/s]
Capturing CUDA graphs (decode, FULL):  18%|█▊        | 2/11 [00:00<00:03,  2.99it/s]
Capturing CUDA graphs (decode, FULL):  36%|███▋      | 4/11 [00:00<00:01,  6.13it/s]
Capturing CUDA graphs (decode, FULL):  64%|██████▎   | 7/11 [00:00<00:00, 10.33it/s]
Capturing CUDA graphs (decode, FULL):  91%|█████████ | 10/11 [00:01<00:00, 13.42it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 11/11 [00:01<00:00,  9.66it/s]

Adding requests:   0%|          | 0/8192 [00:00<?, ?it/s]
Adding requests:   0%|          | 40/8192 [00:00<00:20, 398.03it/s]
Adding requests:   1%|          | 92/8192 [00:00<00:17, 467.38it/s]
Adding requests:   2%|▏         | 143/8192 [00:00<00:16, 484.57it/s]
Adding requests:   2%|▏         | 193/8192 [00:00<00:16, 488.31it/s]
Adding requests:   3%|▎         | 245/8192 [00:00<00:15, 499.39it/s]
Adding requests:   4%|▎         | 296/8192 [00:00<00:15, 502.49it/s]
Adding requests:   4%|▍         | 347/8192 [00:00<00:15, 500.42it/s]
Adding requests:   5%|▍         | 400/8192 [00:00<00:15, 506.85it/s]
Adding requests:   6%|▌         | 451/8192 [00:00<00:15, 507.56it/s]
Adding requests:   6%|▌         | 502/8192 [00:01<00:15, 506.19it/s]
Adding requests:   7%|▋         | 553/8192 [00:01<00:15, 501.68it/s]
Adding requests:   7%|▋         | 604/8192 [00:01<00:15, 499.38it/s]
Adding requests:   8%|▊         | 657/8192 [00:01<00:14, 507.58it/s]
Adding requests:   9%|▊         | 710/8192 [00:01<00:14, 513.19it/s]
Adding requests:   9%|▉         | 762/8192 [00:01<00:14, 512.23it/s]
Adding requests:  10%|▉         | 814/8192 [00:01<00:14, 502.81it/s]
Adding requests:  11%|█         | 865/8192 [00:01<00:14, 503.72it/s]
Adding requests:  11%|█         | 918/8192 [00:01<00:14, 510.63it/s]
Adding requests:  12%|█▏        | 970/8192 [00:01<00:14, 511.48it/s]
Adding requests:  12%|█▏        | 1022/8192 [00:02<00:13, 513.69it/s]
Adding requests:  13%|█▎        | 1074/8192 [00:02<00:13, 508.70it/s]
Adding requests:  14%|█▎        | 1125/8192 [00:02<00:13, 508.30it/s]
Adding requests:  14%|█▍        | 1178/8192 [00:02<00:13, 513.33it/s]
Adding requests:  15%|█▌        | 1232/8192 [00:02<00:13, 519.00it/s]
Adding requests:  16%|█▌        | 1284/8192 [00:02<00:13, 512.26it/s]
Adding requests:  16%|█▋        | 1337/8192 [00:02<00:13, 515.47it/s]
Adding requests:  17%|█▋        | 1390/8192 [00:02<00:13, 516.95it/s]
Adding requests:  18%|█▊        | 1442/8192 [00:02<00:13, 515.95it/s]
Adding requests:  18%|█▊        | 1495/8192 [00:02<00:12, 517.69it/s]
Adding requests:  19%|█▉        | 1547/8192 [00:03<00:12, 517.82it/s]
Adding requests:  20%|█▉        | 1602/8192 [00:03<00:12, 524.40it/s]
Adding requests:  20%|██        | 1655/8192 [00:03<00:12, 523.15it/s]
Adding requests:  21%|██        | 1708/8192 [00:03<00:12, 512.77it/s]
Adding requests:  21%|██▏       | 1760/8192 [00:03<00:12, 514.62it/s]
Adding requests:  22%|██▏       | 1813/8192 [00:03<00:12, 518.00it/s]
Adding requests:  23%|██▎       | 1865/8192 [00:03<00:12, 516.32it/s]
Adding requests:  23%|██▎       | 1918/8192 [00:03<00:12, 519.41it/s]
Adding requests:  24%|██▍       | 1970/8192 [00:03<00:11, 518.74it/s]
Adding requests:  25%|██▍       | 2023/8192 [00:03<00:11, 521.78it/s]
Adding requests:  25%|██▌       | 2077/8192 [00:04<00:11, 525.41it/s]
Adding requests:  26%|██▌       | 2130/8192 [00:04<00:11, 520.22it/s]
Adding requests:  27%|██▋       | 2183/8192 [00:04<00:11, 514.70it/s]
Adding requests:  27%|██▋       | 2237/8192 [00:04<00:11, 519.73it/s]
Adding requests:  28%|██▊       | 2289/8192 [00:04<00:11, 516.72it/s]
Adding requests:  29%|██▊       | 2341/8192 [00:04<00:11, 516.52it/s]
Adding requests:  29%|██▉       | 2394/8192 [00:04<00:11, 517.70it/s]
Adding requests:  30%|██▉       | 2446/8192 [00:04<00:11, 515.92it/s]
Adding requests:  31%|███       | 2499/8192 [00:04<00:10, 519.36it/s]
Adding requests:  31%|███       | 2551/8192 [00:04<00:10, 518.00it/s]
Adding requests:  32%|███▏      | 2603/8192 [00:05<00:10, 518.11it/s]
Adding requests:  32%|███▏      | 2657/8192 [00:05<00:10, 522.45it/s]
Adding requests:  33%|███▎      | 2710/8192 [00:05<00:10, 515.77it/s]
Adding requests:  34%|███▎      | 2762/8192 [00:05<00:10, 515.37it/s]
Adding requests:  34%|███▍      | 2814/8192 [00:05<00:10, 513.38it/s]
Adding requests:  35%|███▍      | 2866/8192 [00:05<00:10, 513.19it/s]
Adding requests:  36%|███▌      | 2918/8192 [00:05<00:10, 512.98it/s]
Adding requests:  36%|███▋      | 2970/8192 [00:05<00:10, 500.91it/s]
Adding requests:  37%|███▋      | 3022/8192 [00:05<00:10, 503.73it/s]
Adding requests:  38%|███▊      | 3073/8192 [00:06<00:10, 504.45it/s]
Adding requests:  38%|███▊      | 3127/8192 [00:06<00:09, 511.95it/s]
Adding requests:  39%|███▉      | 3180/8192 [00:06<00:09, 515.00it/s]
Adding requests:  39%|███▉      | 3232/8192 [00:06<00:09, 514.66it/s]
Adding requests:  40%|████      | 3286/8192 [00:06<00:09, 519.05it/s]
Adding requests:  41%|████      | 3338/8192 [00:06<00:09, 518.89it/s]
Adding requests:  41%|████▏     | 3391/8192 [00:06<00:09, 521.65it/s]
Adding requests:  42%|████▏     | 3444/8192 [00:06<00:09, 522.76it/s]
Adding requests:  43%|████▎     | 3497/8192 [00:06<00:09, 516.04it/s]
Adding requests:  43%|████▎     | 3550/8192 [00:06<00:08, 517.86it/s]
Adding requests:  44%|████▍     | 3602/8192 [00:07<00:08, 515.06it/s]
Adding requests:  45%|████▍     | 3654/8192 [00:07<00:08, 513.35it/s]
Adding requests:  45%|████▌     | 3707/8192 [00:07<00:08, 518.12it/s]
Adding requests:  46%|████▌     | 3759/8192 [00:07<00:08, 515.85it/s]
Adding requests:  47%|████▋     | 3813/8192 [00:07<00:08, 521.29it/s]
Adding requests:  47%|████▋     | 3867/8192 [00:07<00:08, 524.93it/s]
Adding requests:  48%|████▊     | 3920/8192 [00:07<00:08, 523.96it/s]
Adding requests:  48%|████▊     | 3973/8192 [00:07<00:08, 523.23it/s]
Adding requests:  49%|████▉     | 4026/8192 [00:07<00:07, 521.97it/s]
Adding requests:  50%|████▉     | 4079/8192 [00:07<00:07, 516.02it/s]
Adding requests:  50%|█████     | 4133/8192 [00:08<00:07, 521.97it/s]
Adding requests:  51%|█████     | 4186/8192 [00:08<00:07, 522.46it/s]
Adding requests:  52%|█████▏    | 4239/8192 [00:08<00:07, 521.99it/s]
Adding requests:  52%|█████▏    | 4292/8192 [00:08<00:07, 508.47it/s]
Adding requests:  53%|█████▎    | 4347/8192 [00:08<00:07, 518.34it/s]
Adding requests:  54%|█████▎    | 4400/8192 [00:08<00:07, 521.68it/s]
Adding requests:  54%|█████▍    | 4454/8192 [00:08<00:07, 525.08it/s]
Adding requests:  55%|█████▌    | 4507/8192 [00:08<00:07, 520.42it/s]
Adding requests:  56%|█████▌    | 4560/8192 [00:08<00:06, 518.97it/s]
Adding requests:  56%|█████▋    | 4614/8192 [00:08<00:06, 523.00it/s]
Adding requests:  57%|█████▋    | 4667/8192 [00:09<00:06, 522.34it/s]
Adding requests:  58%|█████▊    | 4720/8192 [00:09<00:06, 521.40it/s]
Adding requests:  58%|█████▊    | 4773/8192 [00:09<00:06, 521.74it/s]
Adding requests:  59%|█████▉    | 4826/8192 [00:09<00:06, 521.10it/s]
Adding requests:  60%|█████▉    | 4879/8192 [00:09<00:06, 519.48it/s]
Adding requests:  60%|██████    | 4932/8192 [00:09<00:06, 520.60it/s]
Adding requests:  61%|██████    | 4985/8192 [00:09<00:06, 520.19it/s]
Adding requests:  62%|██████▏   | 5039/8192 [00:09<00:06, 524.07it/s]
Adding requests:  62%|██████▏   | 5094/8192 [00:09<00:05, 529.27it/s]
Adding requests:  63%|██████▎   | 5147/8192 [00:09<00:05, 528.01it/s]
Adding requests:  63%|██████▎   | 5200/8192 [00:10<00:05, 528.10it/s]
Adding requests:  64%|██████▍   | 5253/8192 [00:10<00:05, 522.53it/s]
Adding requests:  65%|██████▍   | 5307/8192 [00:10<00:05, 525.68it/s]
Adding requests:  65%|██████▌   | 5360/8192 [00:10<00:05, 526.88it/s]
Adding requests:  66%|██████▌   | 5413/8192 [00:10<00:05, 527.33it/s]
Adding requests:  67%|██████▋   | 5466/8192 [00:10<00:05, 523.19it/s]
Adding requests:  67%|██████▋   | 5519/8192 [00:10<00:05, 518.28it/s]
Adding requests:  68%|██████▊   | 5571/8192 [00:10<00:05, 508.32it/s]
Adding requests:  69%|██████▊   | 5623/8192 [00:10<00:05, 510.83it/s]
Adding requests:  69%|██████▉   | 5675/8192 [00:11<00:04, 512.27it/s]
Adding requests:  70%|██████▉   | 5729/8192 [00:11<00:04, 516.52it/s]
Adding requests:  71%|███████   | 5782/8192 [00:11<00:04, 520.36it/s]
Adding requests:  71%|███████   | 5835/8192 [00:11<00:04, 516.66it/s]
Adding requests:  72%|███████▏  | 5889/8192 [00:11<00:04, 522.66it/s]
Adding requests:  73%|███████▎  | 5942/8192 [00:11<00:04, 524.15it/s]
Adding requests:  73%|███████▎  | 5996/8192 [00:11<00:04, 527.79it/s]
Adding requests:  74%|███████▍  | 6050/8192 [00:11<00:04, 530.60it/s]
Adding requests:  75%|███████▍  | 6104/8192 [00:11<00:03, 528.31it/s]
Adding requests:  75%|███████▌  | 6157/8192 [00:11<00:03, 524.21it/s]
Adding requests:  76%|███████▌  | 6212/8192 [00:12<00:03, 529.74it/s]
Adding requests:  77%|███████▋  | 6267/8192 [00:12<00:03, 534.77it/s]
Adding requests:  77%|███████▋  | 6322/8192 [00:12<00:03, 537.72it/s]
Adding requests:  78%|███████▊  | 6376/8192 [00:12<00:03, 532.37it/s]
Adding requests:  79%|███████▊  | 6432/8192 [00:12<00:03, 539.15it/s]
Adding requests:  79%|███████▉  | 6486/8192 [00:12<00:03, 537.98it/s]
Adding requests:  80%|███████▉  | 6541/8192 [00:12<00:03, 540.78it/s]
Adding requests:  81%|████████  | 6596/8192 [00:12<00:02, 534.61it/s]
Adding requests:  81%|████████  | 6650/8192 [00:12<00:02, 535.42it/s]
Adding requests:  82%|████████▏ | 6704/8192 [00:12<00:02, 532.80it/s]
Adding requests:  82%|████████▏ | 6758/8192 [00:13<00:02, 529.75it/s]
Adding requests:  83%|████████▎ | 6812/8192 [00:13<00:02, 532.10it/s]
Adding requests:  84%|████████▍ | 6867/8192 [00:13<00:02, 536.82it/s]
Adding requests:  84%|████████▍ | 6921/8192 [00:13<00:02, 520.42it/s]
Adding requests:  85%|████████▌ | 6976/8192 [00:13<00:02, 528.91it/s]
Adding requests:  86%|████████▌ | 7029/8192 [00:13<00:02, 522.38it/s]
Adding requests:  86%|████████▋ | 7083/8192 [00:13<00:02, 524.98it/s]
Adding requests:  87%|████████▋ | 7137/8192 [00:13<00:02, 526.37it/s]
Adding requests:  88%|████████▊ | 7190/8192 [00:13<00:01, 524.76it/s]
Adding requests:  88%|████████▊ | 7243/8192 [00:13<00:01, 525.11it/s]
Adding requests:  89%|████████▉ | 7297/8192 [00:14<00:01, 528.88it/s]
Adding requests:  90%|████████▉ | 7350/8192 [00:14<00:01, 525.63it/s]
Adding requests:  90%|█████████ | 7405/8192 [00:14<00:01, 531.40it/s]
Adding requests:  91%|█████████ | 7460/8192 [00:14<00:01, 534.74it/s]
Adding requests:  92%|█████████▏| 7514/8192 [00:14<00:01, 534.64it/s]
Adding requests:  92%|█████████▏| 7568/8192 [00:14<00:01, 532.34it/s]
Adding requests:  93%|█████████▎| 7622/8192 [00:14<00:01, 527.68it/s]
Adding requests:  94%|█████████▎| 7677/8192 [00:14<00:00, 532.92it/s]
Adding requests:  94%|█████████▍| 7731/8192 [00:14<00:00, 531.27it/s]
Adding requests:  95%|█████████▌| 7785/8192 [00:14<00:00, 527.94it/s]
Adding requests:  96%|█████████▌| 7838/8192 [00:15<00:00, 527.18it/s]
Adding requests:  96%|█████████▋| 7891/8192 [00:15<00:00, 526.65it/s]
Adding requests:  97%|█████████▋| 7944/8192 [00:15<00:00, 521.08it/s]
Adding requests:  98%|█████████▊| 7997/8192 [00:15<00:00, 519.45it/s]
Adding requests:  98%|█████████▊| 8049/8192 [00:15<00:00, 517.44it/s]
Adding requests:  99%|█████████▉| 8103/8192 [00:15<00:00, 522.83it/s]
Adding requests: 100%|█████████▉| 8157/8192 [00:15<00:00, 524.49it/s]
Adding requests: 100%|██████████| 8192/8192 [00:15<00:00, 519.29it/s]

Processed prompts:   0%|          | 0/8192 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  36%|███▋      | 2975/8192 [00:00<00:00, 11880.22it/s, est. speed input: 12166953.48 toks/s, output: 11880.65 toks/s]
Processed prompts:  51%|█████     | 4164/8192 [00:06<00:07, 532.40it/s, est. speed input: 685522.54 toks/s, output: 669.45 toks/s]      
Processed prompts:  57%|█████▋    | 4665/8192 [00:08<00:08, 401.22it/s, est. speed input: 538254.84 toks/s, output: 525.64 toks/s]
Processed prompts:  60%|██████    | 4946/8192 [00:10<00:09, 360.52it/s, est. speed input: 496335.14 toks/s, output: 484.70 toks/s]
Processed prompts:  63%|██████▎   | 5125/8192 [00:11<00:09, 326.84it/s, est. speed input: 468617.69 toks/s, output: 457.63 toks/s]
Processed prompts:  64%|██████▍   | 5246/8192 [00:11<00:09, 305.48it/s, est. speed input: 453093.03 toks/s, output: 442.47 toks/s]
Processed prompts:  65%|██████▌   | 5332/8192 [00:12<00:09, 300.79it/s, est. speed input: 447910.12 toks/s, output: 437.41 toks/s]
Processed prompts:  66%|██████▌   | 5399/8192 [00:12<00:09, 288.94it/s, est. speed input: 441591.76 toks/s, output: 431.24 toks/s]
Processed prompts:  67%|██████▋   | 5451/8192 [00:12<00:10, 269.38it/s, est. speed input: 434361.27 toks/s, output: 424.18 toks/s]
Processed prompts:  67%|██████▋   | 5492/8192 [00:13<00:11, 244.39it/s, est. speed input: 426752.58 toks/s, output: 416.75 toks/s]
Processed prompts:  68%|██████▊   | 5535/8192 [00:13<00:11, 221.43it/s, est. speed input: 419545.93 toks/s, output: 409.71 toks/s]
Processed prompts:  68%|██████▊   | 5599/8192 [00:13<00:12, 215.30it/s, est. speed input: 414271.56 toks/s, output: 404.56 toks/s]
Processed prompts:  69%|██████▉   | 5663/8192 [00:14<00:12, 210.36it/s, est. speed input: 409285.49 toks/s, output: 399.69 toks/s]
Processed prompts:  70%|██████▉   | 5727/8192 [00:14<00:11, 205.58it/s, est. speed input: 404388.70 toks/s, output: 394.91 toks/s]
Processed prompts:  71%|███████   | 5791/8192 [00:14<00:11, 200.97it/s, est. speed input: 399561.39 toks/s, output: 390.20 toks/s]
Processed prompts:  71%|███████▏  | 5855/8192 [00:15<00:11, 197.56it/s, est. speed input: 394955.64 toks/s, output: 385.70 toks/s]
Processed prompts:  72%|███████▏  | 5919/8192 [00:15<00:11, 197.05it/s, est. speed input: 390853.77 toks/s, output: 381.69 toks/s]
Processed prompts:  73%|███████▎  | 5983/8192 [00:15<00:11, 195.55it/s, est. speed input: 386760.93 toks/s, output: 377.70 toks/s]
Processed prompts:  74%|███████▍  | 6047/8192 [00:16<00:11, 194.01it/s, est. speed input: 382771.26 toks/s, output: 373.80 toks/s]
Processed prompts:  75%|███████▍  | 6111/8192 [00:16<00:10, 193.61it/s, est. speed input: 379038.54 toks/s, output: 370.15 toks/s]
Processed prompts:  75%|███████▌  | 6175/8192 [00:16<00:10, 193.88it/s, est. speed input: 375524.92 toks/s, output: 366.72 toks/s]
Processed prompts:  76%|███████▌  | 6239/8192 [00:17<00:10, 193.10it/s, est. speed input: 372024.68 toks/s, output: 363.30 toks/s]
Processed prompts:  77%|███████▋  | 6303/8192 [00:17<00:09, 191.93it/s, est. speed input: 368580.46 toks/s, output: 359.94 toks/s]
Processed prompts:  78%|███████▊  | 6367/8192 [00:17<00:09, 192.76it/s, est. speed input: 365464.66 toks/s, output: 356.90 toks/s]
Processed prompts:  79%|███████▊  | 6431/8192 [00:18<00:09, 191.19it/s, est. speed input: 362211.58 toks/s, output: 353.72 toks/s]
Processed prompts:  79%|███████▉  | 6495/8192 [00:18<00:08, 190.29it/s, est. speed input: 359099.74 toks/s, output: 350.68 toks/s]
Processed prompts:  80%|████████  | 6559/8192 [00:18<00:08, 191.93it/s, est. speed input: 356351.45 toks/s, output: 348.00 toks/s]
Processed prompts:  81%|████████  | 6623/8192 [00:19<00:08, 192.27it/s, est. speed input: 353610.07 toks/s, output: 345.32 toks/s]
Processed prompts:  82%|████████▏ | 6687/8192 [00:19<00:07, 191.49it/s, est. speed input: 350854.69 toks/s, output: 342.63 toks/s]
Processed prompts:  82%|████████▏ | 6751/8192 [00:19<00:07, 191.38it/s, est. speed input: 348237.69 toks/s, output: 340.08 toks/s]
Processed prompts:  83%|████████▎ | 6815/8192 [00:20<00:07, 192.21it/s, est. speed input: 345797.74 toks/s, output: 337.69 toks/s]
Processed prompts:  84%|████████▍ | 6879/8192 [00:20<00:06, 192.08it/s, est. speed input: 343367.00 toks/s, output: 335.32 toks/s]
Processed prompts:  85%|████████▍ | 6943/8192 [00:20<00:06, 191.58it/s, est. speed input: 340975.28 toks/s, output: 332.98 toks/s]
Processed prompts:  86%|████████▌ | 7007/8192 [00:21<00:06, 192.52it/s, est. speed input: 338779.09 toks/s, output: 330.84 toks/s]
Processed prompts:  86%|████████▋ | 7071/8192 [00:21<00:05, 193.08it/s, est. speed input: 336640.40 toks/s, output: 328.75 toks/s]
Processed prompts:  87%|████████▋ | 7135/8192 [00:21<00:05, 193.68it/s, est. speed input: 334584.07 toks/s, output: 326.74 toks/s]
Processed prompts:  88%|████████▊ | 7199/8192 [00:22<00:05, 192.65it/s, est. speed input: 332464.49 toks/s, output: 324.67 toks/s]
Processed prompts:  89%|████████▊ | 7263/8192 [00:22<00:04, 194.09it/s, est. speed input: 330589.46 toks/s, output: 322.84 toks/s]
Processed prompts:  89%|████████▉ | 7327/8192 [00:22<00:04, 193.15it/s, est. speed input: 328608.33 toks/s, output: 320.91 toks/s]
Processed prompts:  90%|█████████ | 7391/8192 [00:23<00:04, 194.06it/s, est. speed input: 326809.77 toks/s, output: 319.15 toks/s]
Processed prompts:  91%|█████████ | 7455/8192 [00:23<00:03, 192.78it/s, est. speed input: 324910.22 toks/s, output: 317.29 toks/s]
Processed prompts:  92%|█████████▏| 7519/8192 [00:23<00:03, 193.27it/s, est. speed input: 323171.63 toks/s, output: 315.60 toks/s]
Processed prompts:  93%|█████████▎| 7583/8192 [00:24<00:03, 192.91it/s, est. speed input: 321427.55 toks/s, output: 313.89 toks/s]
Processed prompts:  93%|█████████▎| 7647/8192 [00:24<00:02, 192.28it/s, est. speed input: 319701.87 toks/s, output: 312.21 toks/s]
Processed prompts:  94%|█████████▍| 7711/8192 [00:24<00:02, 192.09it/s, est. speed input: 318040.96 toks/s, output: 310.59 toks/s]
Processed prompts:  95%|█████████▍| 7775/8192 [00:25<00:02, 191.38it/s, est. speed input: 316382.67 toks/s, output: 308.97 toks/s]
Processed prompts:  96%|█████████▌| 7839/8192 [00:25<00:01, 190.86it/s, est. speed input: 314766.11 toks/s, output: 307.39 toks/s]
Processed prompts:  96%|█████████▋| 7903/8192 [00:25<00:01, 190.82it/s, est. speed input: 313214.04 toks/s, output: 305.87 toks/s]
Processed prompts:  97%|█████████▋| 7967/8192 [00:26<00:01, 190.70it/s, est. speed input: 311696.25 toks/s, output: 304.39 toks/s]
Processed prompts:  98%|█████████▊| 8031/8192 [00:26<00:00, 190.81it/s, est. speed input: 310229.63 toks/s, output: 302.96 toks/s]
Processed prompts:  99%|█████████▉| 8095/8192 [00:26<00:00, 192.03it/s, est. speed input: 308876.76 toks/s, output: 301.64 toks/s]
Processed prompts: 100%|█████████▉| 8159/8192 [00:27<00:00, 225.00it/s, est. speed input: 309353.30 toks/s, output: 302.10 toks/s]
Processed prompts: 100%|██████████| 8192/8192 [00:27<00:00, 225.00it/s, est. speed input: 310593.12 toks/s, output: 303.31 toks/s]
Processed prompts: 100%|██████████| 8192/8192 [00:27<00:00, 303.31it/s, est. speed input: 310593.12 toks/s, output: 303.31 toks/s]
[rank0]:[W126 08:32:04.197071219 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=512 ==========
Time: 2026-01-26 09:43:30
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_8
Params: prompt_len=512, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_8 --dataset-name random --input-len 512 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 513 --max-num-batched-tokens 513 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-3B-INT8_M512.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 09:43:38 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1158458) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1158458) WARNING 01-26 09:43:54 [backends.py:609] Failed to read file <frozen os>
Throughput: 34.04 requests/s, 17464.42 total tokens/s, 34.04 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128

STDERR:
[2026-01-26 09:43:37] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 09:43:38] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-26 09:43:38] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-26 09:43:38] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:43:38] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:43:38] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:43:38] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:43:38] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:43:38] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-26 09:43:38] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 09:43:38] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 09:43:38] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 09:43:38] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 09:43:38] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 09:43:44] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 09:43:45] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-26 09:43:45] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-26 09:43:45] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:43:45] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:43:45] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:43:45] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:43:45] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:43:45] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-26 09:43:45] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 09:43:45] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 09:43:45] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 09:43:45] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 09:43:45] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1158458) [2026-01-26 09:43:47] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1158458) [2026-01-26 09:43:47] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1158458) [2026-01-26 09:43:47] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1158458) [2026-01-26 09:43:47] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1158458) [2026-01-26 09:43:47] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-3B-INT8
(EngineCore_DP0 pid=1158458) [2026-01-26 09:43:47] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1158458) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1158458) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.86it/s]
(EngineCore_DP0 pid=1158458) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.86it/s]
(EngineCore_DP0 pid=1158458) 
(EngineCore_DP0 pid=1158458) [2026-01-26 09:43:48] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 4608] -> 1D uint8
(EngineCore_DP0 pid=1158458) [2026-01-26 09:43:48] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 14745600 bytes
(EngineCore_DP0 pid=1158458) [2026-01-26 09:43:48] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 4608] -> 1D uint8
(EngineCore_DP0 pid=1158458) [2026-01-26 09:43:48] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 8847360 bytes
(EngineCore_DP0 pid=1158458) [2026-01-26 09:43:48] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 4608] -> 1D uint8
(EngineCore_DP0 pid=1158458) [2026-01-26 09:43:48] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 47185920 bytes
(EngineCore_DP0 pid=1158458) [2026-01-26 09:43:48] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 12288] -> 1D uint8
(EngineCore_DP0 pid=1158458) [2026-01-26 09:43:48] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 23592960 bytes
(EngineCore_DP0 pid=1158458) 2026-01-26 09:44:05,218 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1158458) 2026-01-26 09:44:05,241 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1158458) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  2.66it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:01<00:00,  1.88it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:01<00:00,  1.97it/s]
(EngineCore_DP0 pid=1158458) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  9.50it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  9.48it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  34%|███▍      | 44/128 [00:00<00:00, 438.78it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 645.91it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:22,  5.56it/s, est. speed input: 2847.82 toks/s, output: 5.56 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:06, 20.14it/s, est. speed input: 8910.56 toks/s, output: 17.40 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:00<00:04, 27.03it/s, est. speed input: 11705.57 toks/s, output: 22.86 toks/s]
Processed prompts:  10%|█         | 13/128 [00:00<00:03, 30.86it/s, est. speed input: 13315.58 toks/s, output: 26.01 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:00<00:03, 33.13it/s, est. speed input: 14352.79 toks/s, output: 28.03 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:00<00:03, 34.50it/s, est. speed input: 15066.69 toks/s, output: 29.43 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:00<00:02, 35.46it/s, est. speed input: 15604.65 toks/s, output: 30.48 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:00<00:02, 36.12it/s, est. speed input: 16022.17 toks/s, output: 31.29 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:01<00:02, 36.59it/s, est. speed input: 16356.93 toks/s, output: 31.95 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:01<00:02, 36.94it/s, est. speed input: 16632.91 toks/s, output: 32.49 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:01<00:02, 37.15it/s, est. speed input: 16857.23 toks/s, output: 32.92 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:01<00:02, 37.33it/s, est. speed input: 17050.85 toks/s, output: 33.30 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:01<00:02, 37.34it/s, est. speed input: 17203.48 toks/s, output: 33.60 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:01<00:02, 37.46it/s, est. speed input: 17346.72 toks/s, output: 33.88 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:01<00:01, 37.47it/s, est. speed input: 17465.49 toks/s, output: 34.11 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:01<00:01, 37.52it/s, est. speed input: 17573.01 toks/s, output: 34.32 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:01<00:01, 37.55it/s, est. speed input: 17668.49 toks/s, output: 34.51 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:01<00:01, 37.58it/s, est. speed input: 17754.59 toks/s, output: 34.68 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:02<00:01, 37.63it/s, est. speed input: 17833.89 toks/s, output: 34.83 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:02<00:01, 37.64it/s, est. speed input: 17903.54 toks/s, output: 34.97 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:02<00:01, 37.62it/s, est. speed input: 17965.18 toks/s, output: 35.09 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:02<00:01, 37.60it/s, est. speed input: 18021.07 toks/s, output: 35.20 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:02<00:01, 37.61it/s, est. speed input: 18073.74 toks/s, output: 35.30 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:02<00:00, 37.58it/s, est. speed input: 18119.64 toks/s, output: 35.39 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:02<00:00, 37.55it/s, est. speed input: 18161.14 toks/s, output: 35.47 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:02<00:00, 37.57it/s, est. speed input: 18202.47 toks/s, output: 35.55 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:02<00:00, 37.58it/s, est. speed input: 18240.09 toks/s, output: 35.62 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:03<00:00, 37.60it/s, est. speed input: 18276.58 toks/s, output: 35.70 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:03<00:00, 37.59it/s, est. speed input: 18308.60 toks/s, output: 35.76 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:03<00:00, 37.57it/s, est. speed input: 18337.83 toks/s, output: 35.82 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:03<00:00, 37.51it/s, est. speed input: 18363.46 toks/s, output: 35.87 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:03<00:00, 37.52it/s, est. speed input: 18389.81 toks/s, output: 35.92 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:03<00:00, 37.52it/s, est. speed input: 18409.73 toks/s, output: 35.96 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:03<00:00, 35.95it/s, est. speed input: 18409.73 toks/s, output: 35.96 toks/s]
[rank0]:[W126 09:44:11.879083306 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=1024 ==========
Time: 2026-01-26 09:44:13
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 1025 --max-num-batched-tokens 1025 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-3B-INT8_M1024.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 09:44:21 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1159612) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1159612) WARNING 01-26 09:44:37 [backends.py:609] Failed to read file <frozen os>
Throughput: 34.98 requests/s, 35855.26 total tokens/s, 34.98 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128

STDERR:
[2026-01-26 09:44:20] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 09:44:21] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-26 09:44:21] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-26 09:44:21] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:44:21] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:44:21] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:44:21] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:44:21] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:44:21] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-26 09:44:21] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 09:44:21] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 09:44:21] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 09:44:21] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 09:44:21] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 09:44:27] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 09:44:28] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-26 09:44:28] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-26 09:44:28] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:44:28] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:44:28] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:44:28] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:44:28] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:44:28] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-26 09:44:28] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 09:44:28] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 09:44:28] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 09:44:28] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 09:44:28] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1159612) [2026-01-26 09:44:30] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1159612) [2026-01-26 09:44:30] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1159612) [2026-01-26 09:44:30] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1159612) [2026-01-26 09:44:30] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1159612) [2026-01-26 09:44:30] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-3B-INT8
(EngineCore_DP0 pid=1159612) [2026-01-26 09:44:30] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1159612) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1159612) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.86it/s]
(EngineCore_DP0 pid=1159612) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.86it/s]
(EngineCore_DP0 pid=1159612) 
(EngineCore_DP0 pid=1159612) [2026-01-26 09:44:31] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 4608] -> 1D uint8
(EngineCore_DP0 pid=1159612) [2026-01-26 09:44:31] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 14745600 bytes
(EngineCore_DP0 pid=1159612) [2026-01-26 09:44:31] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 4608] -> 1D uint8
(EngineCore_DP0 pid=1159612) [2026-01-26 09:44:31] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 8847360 bytes
(EngineCore_DP0 pid=1159612) [2026-01-26 09:44:31] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 4608] -> 1D uint8
(EngineCore_DP0 pid=1159612) [2026-01-26 09:44:31] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 47185920 bytes
(EngineCore_DP0 pid=1159612) [2026-01-26 09:44:31] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 12288] -> 1D uint8
(EngineCore_DP0 pid=1159612) [2026-01-26 09:44:31] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 23592960 bytes
(EngineCore_DP0 pid=1159612) 2026-01-26 09:44:47,938 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1159612) 2026-01-26 09:44:47,975 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1159612) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  5.54it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  8.38it/s]
(EngineCore_DP0 pid=1159612) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00, 17.89it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  20%|██        | 26/128 [00:00<00:00, 256.75it/s]
Adding requests:  62%|██████▏   | 79/128 [00:00<00:00, 412.28it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 425.16it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▍         | 6/128 [00:00<00:02, 49.71it/s, est. speed input: 50912.07 toks/s, output: 49.71 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:00<00:02, 42.45it/s, est. speed input: 44543.65 toks/s, output: 43.49 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:00<00:02, 40.43it/s, est. speed input: 42654.58 toks/s, output: 41.65 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:00<00:02, 39.38it/s, est. speed input: 41644.44 toks/s, output: 40.67 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:00<00:02, 38.95it/s, est. speed input: 41179.97 toks/s, output: 40.21 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:00<00:02, 38.62it/s, est. speed input: 40835.20 toks/s, output: 39.88 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:00<00:02, 38.39it/s, est. speed input: 40573.60 toks/s, output: 39.62 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:00<00:02, 38.21it/s, est. speed input: 40363.46 toks/s, output: 39.42 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:01<00:02, 38.11it/s, est. speed input: 40203.39 toks/s, output: 39.26 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:01<00:02, 38.06it/s, est. speed input: 40079.38 toks/s, output: 39.14 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:01<00:02, 38.03it/s, est. speed input: 39977.82 toks/s, output: 39.04 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:01<00:01, 38.05it/s, est. speed input: 39902.77 toks/s, output: 38.97 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:01<00:01, 38.01it/s, est. speed input: 39826.01 toks/s, output: 38.89 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:01<00:01, 38.02it/s, est. speed input: 39767.28 toks/s, output: 38.83 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:01<00:01, 37.69it/s, est. speed input: 39643.59 toks/s, output: 38.71 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:01<00:01, 37.67it/s, est. speed input: 39576.04 toks/s, output: 38.65 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:01<00:01, 37.66it/s, est. speed input: 39518.44 toks/s, output: 38.59 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:01<00:01, 37.70it/s, est. speed input: 39475.56 toks/s, output: 38.55 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:02<00:01, 37.78it/s, est. speed input: 39445.99 toks/s, output: 38.52 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:02<00:01, 37.85it/s, est. speed input: 39420.64 toks/s, output: 38.50 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:02<00:01, 37.83it/s, est. speed input: 39387.66 toks/s, output: 38.46 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:02<00:00, 37.78it/s, est. speed input: 39351.18 toks/s, output: 38.43 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:02<00:00, 37.78it/s, est. speed input: 39323.97 toks/s, output: 38.40 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:02<00:00, 37.80it/s, est. speed input: 39301.38 toks/s, output: 38.38 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:02<00:00, 37.80it/s, est. speed input: 39278.55 toks/s, output: 38.36 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:02<00:00, 37.66it/s, est. speed input: 39238.60 toks/s, output: 38.32 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:02<00:00, 37.46it/s, est. speed input: 39189.18 toks/s, output: 38.27 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:03<00:00, 37.40it/s, est. speed input: 39153.00 toks/s, output: 38.23 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:03<00:00, 37.28it/s, est. speed input: 39109.73 toks/s, output: 38.19 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:03<00:00, 37.25it/s, est. speed input: 39075.83 toks/s, output: 38.16 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:03<00:00, 37.25it/s, est. speed input: 39054.50 toks/s, output: 38.14 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:03<00:00, 38.14it/s, est. speed input: 39054.50 toks/s, output: 38.14 toks/s]
[rank0]:[W126 09:44:53.677261806 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=2048 ==========
Time: 2026-01-26 09:44:55
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=256, max_num_seqs=2
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 256 --max-num-seqs 2 --max-model-len 1025 --max-num-batched-tokens 2048 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-3B-INT8_M2048.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 09:45:03 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1160702) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1160702) WARNING 01-26 09:45:19 [backends.py:609] Failed to read file <frozen os>
Throughput: 62.31 requests/s, 63868.86 total tokens/s, 62.31 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256

STDERR:
[2026-01-26 09:45:02] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 09:45:03] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-26 09:45:03] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-26 09:45:03] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:45:03] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:45:03] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:45:03] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:45:03] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:45:03] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-26 09:45:03] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 09:45:03] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 09:45:03] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 09:45:03] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 09:45:03] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 09:45:09] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 09:45:10] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-26 09:45:10] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-26 09:45:10] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:45:10] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:45:10] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:45:10] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:45:10] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:45:10] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-26 09:45:10] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 09:45:10] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 09:45:10] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 09:45:10] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 09:45:10] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1160702) [2026-01-26 09:45:12] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1160702) [2026-01-26 09:45:12] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1160702) [2026-01-26 09:45:12] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1160702) [2026-01-26 09:45:12] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1160702) [2026-01-26 09:45:12] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-3B-INT8
(EngineCore_DP0 pid=1160702) [2026-01-26 09:45:12] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1160702) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1160702) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.85it/s]
(EngineCore_DP0 pid=1160702) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.85it/s]
(EngineCore_DP0 pid=1160702) 
(EngineCore_DP0 pid=1160702) [2026-01-26 09:45:13] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 4608] -> 1D uint8
(EngineCore_DP0 pid=1160702) [2026-01-26 09:45:13] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 14745600 bytes
(EngineCore_DP0 pid=1160702) [2026-01-26 09:45:13] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 4608] -> 1D uint8
(EngineCore_DP0 pid=1160702) [2026-01-26 09:45:13] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 8847360 bytes
(EngineCore_DP0 pid=1160702) [2026-01-26 09:45:13] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 4608] -> 1D uint8
(EngineCore_DP0 pid=1160702) [2026-01-26 09:45:13] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 47185920 bytes
(EngineCore_DP0 pid=1160702) [2026-01-26 09:45:13] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 12288] -> 1D uint8
(EngineCore_DP0 pid=1160702) [2026-01-26 09:45:13] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 23592960 bytes
(EngineCore_DP0 pid=1160702) 2026-01-26 09:45:30,027 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1160702) 2026-01-26 09:45:30,051 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1160702) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  67%|██████▋   | 2/3 [00:00<00:00, 14.09it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00, 10.14it/s]
(EngineCore_DP0 pid=1160702) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 1/2 [00:00<00:00,  4.20it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  5.94it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  5.59it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  20%|█▉        | 51/256 [00:00<00:00, 503.45it/s]
Adding requests:  40%|███▉      | 102/256 [00:00<00:00, 503.76it/s]
Adding requests:  60%|█████▉    | 153/256 [00:00<00:00, 503.89it/s]
Adding requests:  80%|███████▉  | 204/256 [00:00<00:00, 502.55it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 507.10it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▋         | 16/256 [00:00<00:01, 125.90it/s, est. speed input: 128940.97 toks/s, output: 125.91 toks/s]
Processed prompts:  11%|█▏        | 29/256 [00:00<00:02, 92.20it/s, est. speed input: 98798.55 toks/s, output: 96.48 toks/s]   
Processed prompts:  15%|█▌        | 39/256 [00:00<00:02, 82.01it/s, est. speed input: 89673.21 toks/s, output: 87.57 toks/s]
Processed prompts:  19%|█▉        | 48/256 [00:00<00:02, 74.39it/s, est. speed input: 83332.77 toks/s, output: 81.37 toks/s]
Processed prompts:  22%|██▏       | 56/256 [00:00<00:02, 72.78it/s, est. speed input: 81270.06 toks/s, output: 79.36 toks/s]
Processed prompts:  25%|██▌       | 64/256 [00:00<00:02, 71.57it/s, est. speed input: 79746.30 toks/s, output: 77.87 toks/s]
Processed prompts:  28%|██▊       | 72/256 [00:00<00:02, 70.80it/s, est. speed input: 78623.19 toks/s, output: 76.78 toks/s]
Processed prompts:  31%|███▏      | 80/256 [00:01<00:02, 70.29it/s, est. speed input: 77757.86 toks/s, output: 75.93 toks/s]
Processed prompts:  34%|███▍      | 88/256 [00:01<00:02, 69.94it/s, est. speed input: 77069.75 toks/s, output: 75.26 toks/s]
Processed prompts:  38%|███▊      | 96/256 [00:01<00:02, 69.69it/s, est. speed input: 76502.34 toks/s, output: 74.71 toks/s]
Processed prompts:  41%|████      | 104/256 [00:01<00:02, 69.44it/s, est. speed input: 76007.74 toks/s, output: 74.22 toks/s]
Processed prompts:  44%|████▍     | 112/256 [00:01<00:02, 69.33it/s, est. speed input: 75604.97 toks/s, output: 73.83 toks/s]
Processed prompts:  47%|████▋     | 120/256 [00:01<00:01, 69.18it/s, est. speed input: 75239.64 toks/s, output: 73.47 toks/s]
Processed prompts:  50%|█████     | 128/256 [00:01<00:01, 69.13it/s, est. speed input: 74938.02 toks/s, output: 73.18 toks/s]
Processed prompts:  53%|█████▎    | 136/256 [00:01<00:01, 69.08it/s, est. speed input: 74668.60 toks/s, output: 72.92 toks/s]
Processed prompts:  56%|█████▋    | 144/256 [00:01<00:01, 69.07it/s, est. speed input: 74434.64 toks/s, output: 72.69 toks/s]
Processed prompts:  59%|█████▉    | 152/256 [00:02<00:01, 69.09it/s, est. speed input: 74234.60 toks/s, output: 72.49 toks/s]
Processed prompts:  62%|██████▎   | 160/256 [00:02<00:01, 69.02it/s, est. speed input: 74038.39 toks/s, output: 72.30 toks/s]
Processed prompts:  66%|██████▌   | 168/256 [00:02<00:01, 69.00it/s, est. speed input: 73867.31 toks/s, output: 72.14 toks/s]
Processed prompts:  69%|██████▉   | 176/256 [00:02<00:01, 69.02it/s, est. speed input: 73717.93 toks/s, output: 71.99 toks/s]
Processed prompts:  72%|███████▏  | 184/256 [00:02<00:01, 69.02it/s, est. speed input: 73580.90 toks/s, output: 71.86 toks/s]
Processed prompts:  75%|███████▌  | 192/256 [00:02<00:00, 68.99it/s, est. speed input: 73451.60 toks/s, output: 71.73 toks/s]
Processed prompts:  78%|███████▊  | 200/256 [00:02<00:00, 68.97it/s, est. speed input: 73331.71 toks/s, output: 71.61 toks/s]
Processed prompts:  81%|████████▏ | 208/256 [00:02<00:00, 68.96it/s, est. speed input: 73222.54 toks/s, output: 71.50 toks/s]
Processed prompts:  84%|████████▍ | 216/256 [00:03<00:00, 69.02it/s, est. speed input: 73130.08 toks/s, output: 71.42 toks/s]
Processed prompts:  88%|████████▊ | 224/256 [00:03<00:00, 69.01it/s, est. speed input: 73037.43 toks/s, output: 71.33 toks/s]
Processed prompts:  91%|█████████ | 232/256 [00:03<00:00, 69.01it/s, est. speed input: 72953.52 toks/s, output: 71.24 toks/s]
Processed prompts:  94%|█████████▍| 240/256 [00:03<00:00, 68.93it/s, est. speed input: 72865.05 toks/s, output: 71.16 toks/s]
Processed prompts:  97%|█████████▋| 248/256 [00:03<00:00, 68.97it/s, est. speed input: 72794.41 toks/s, output: 71.09 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:03<00:00, 69.40it/s, est. speed input: 72772.57 toks/s, output: 71.07 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:03<00:00, 69.40it/s, est. speed input: 72772.57 toks/s, output: 71.07 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:03<00:00, 71.06it/s, est. speed input: 72772.57 toks/s, output: 71.07 toks/s]
[rank0]:[W126 09:45:36.570587115 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=4096 ==========
Time: 2026-01-26 09:45:38
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=512, max_num_seqs=4
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 512 --max-num-seqs 4 --max-model-len 1025 --max-num-batched-tokens 4096 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-3B-INT8_M4096.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 09:45:47 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1161807) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1161807) WARNING 01-26 09:46:04 [backends.py:609] Failed to read file <frozen os>
Throughput: 71.56 requests/s, 73348.79 total tokens/s, 71.56 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512

STDERR:
[2026-01-26 09:45:47] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 09:45:47] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-26 09:45:47] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-26 09:45:47] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:45:47] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:45:47] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:45:47] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:45:47] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:45:47] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-26 09:45:47] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 09:45:47] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 09:45:47] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 09:45:47] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 09:45:47] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 09:45:54] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 09:45:54] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-26 09:45:54] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-26 09:45:54] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:45:54] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:45:54] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:45:54] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:45:54] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:45:54] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-26 09:45:54] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 09:45:54] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 09:45:54] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 09:45:54] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 09:45:54] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1161807) [2026-01-26 09:45:56] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1161807) [2026-01-26 09:45:56] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1161807) [2026-01-26 09:45:56] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1161807) [2026-01-26 09:45:56] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1161807) [2026-01-26 09:45:56] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-3B-INT8
(EngineCore_DP0 pid=1161807) [2026-01-26 09:45:56] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1161807) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1161807) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.86it/s]
(EngineCore_DP0 pid=1161807) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.85it/s]
(EngineCore_DP0 pid=1161807) 
(EngineCore_DP0 pid=1161807) [2026-01-26 09:45:58] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 4608] -> 1D uint8
(EngineCore_DP0 pid=1161807) [2026-01-26 09:45:58] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 14745600 bytes
(EngineCore_DP0 pid=1161807) [2026-01-26 09:45:58] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 4608] -> 1D uint8
(EngineCore_DP0 pid=1161807) [2026-01-26 09:45:58] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 8847360 bytes
(EngineCore_DP0 pid=1161807) [2026-01-26 09:45:58] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 4608] -> 1D uint8
(EngineCore_DP0 pid=1161807) [2026-01-26 09:45:58] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 47185920 bytes
(EngineCore_DP0 pid=1161807) [2026-01-26 09:45:58] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 12288] -> 1D uint8
(EngineCore_DP0 pid=1161807) [2026-01-26 09:45:58] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 23592960 bytes
(EngineCore_DP0 pid=1161807) 2026-01-26 09:46:14,824 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1161807) 2026-01-26 09:46:14,858 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1161807) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 2/4 [00:00<00:00, 13.66it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00, 10.55it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00, 10.91it/s]
(EngineCore_DP0 pid=1161807) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  67%|██████▋   | 2/3 [00:00<00:00, 16.41it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00, 17.52it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   6%|▌         | 31/512 [00:00<00:01, 307.44it/s]
Adding requests:  16%|█▋        | 84/512 [00:00<00:00, 433.97it/s]
Adding requests:  27%|██▋       | 136/512 [00:00<00:00, 468.68it/s]
Adding requests:  36%|███▋      | 186/512 [00:00<00:00, 479.79it/s]
Adding requests:  46%|████▋     | 238/512 [00:00<00:00, 492.72it/s]
Adding requests:  56%|█████▋    | 289/512 [00:00<00:00, 496.20it/s]
Adding requests:  66%|██████▋   | 340/512 [00:00<00:00, 498.44it/s]
Adding requests:  77%|███████▋  | 393/512 [00:00<00:00, 505.39it/s]
Adding requests:  87%|████████▋ | 444/512 [00:00<00:00, 506.56it/s]
Adding requests:  97%|█████████▋| 495/512 [00:01<00:00, 507.31it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 489.90it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  14%|█▎        | 70/512 [00:00<00:00, 469.48it/s, est. speed input: 480879.38 toks/s, output: 469.51 toks/s]
Processed prompts:  23%|██▎       | 117/512 [00:00<00:02, 137.28it/s, est. speed input: 161027.73 toks/s, output: 157.25 toks/s]
Processed prompts:  28%|██▊       | 141/512 [00:01<00:03, 111.51it/s, est. speed input: 134641.44 toks/s, output: 131.48 toks/s]
Processed prompts:  31%|███       | 158/512 [00:01<00:03, 95.97it/s, est. speed input: 120543.72 toks/s, output: 117.72 toks/s] 
Processed prompts:  33%|███▎      | 171/512 [00:01<00:03, 92.76it/s, est. speed input: 116518.56 toks/s, output: 113.79 toks/s]
Processed prompts:  36%|███▌      | 182/512 [00:01<00:03, 86.67it/s, est. speed input: 111830.44 toks/s, output: 109.21 toks/s]
Processed prompts:  38%|███▊      | 192/512 [00:01<00:03, 87.52it/s, est. speed input: 110693.58 toks/s, output: 108.10 toks/s]
Processed prompts:  39%|███▉      | 202/512 [00:01<00:03, 79.85it/s, est. speed input: 106559.35 toks/s, output: 104.06 toks/s]
Processed prompts:  41%|████      | 211/512 [00:02<00:03, 80.43it/s, est. speed input: 105388.77 toks/s, output: 102.92 toks/s]
Processed prompts:  43%|████▎     | 220/512 [00:02<00:03, 80.82it/s, est. speed input: 104307.84 toks/s, output: 101.86 toks/s]
Processed prompts:  45%|████▍     | 229/512 [00:02<00:03, 81.40it/s, est. speed input: 103392.97 toks/s, output: 100.97 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:02<00:03, 72.55it/s, est. speed input: 100321.10 toks/s, output: 97.97 toks/s] 
Processed prompts:  48%|████▊     | 246/512 [00:02<00:03, 72.98it/s, est. speed input: 99289.28 toks/s, output: 96.96 toks/s] 
Processed prompts:  50%|████▉     | 254/512 [00:02<00:03, 73.02it/s, est. speed input: 98283.14 toks/s, output: 95.98 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:02<00:03, 73.07it/s, est. speed input: 97356.88 toks/s, output: 95.07 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:02<00:03, 72.83it/s, est. speed input: 96453.15 toks/s, output: 94.19 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:02<00:03, 72.95it/s, est. speed input: 95664.92 toks/s, output: 93.42 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:03<00:03, 72.84it/s, est. speed input: 94903.78 toks/s, output: 92.68 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:03<00:02, 73.16it/s, est. speed input: 94253.78 toks/s, output: 92.04 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:03<00:02, 73.41it/s, est. speed input: 93649.78 toks/s, output: 91.45 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:03<00:02, 73.60it/s, est. speed input: 93084.47 toks/s, output: 90.90 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:03<00:02, 73.82it/s, est. speed input: 92565.57 toks/s, output: 90.40 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:03<00:02, 73.57it/s, est. speed input: 92028.44 toks/s, output: 89.87 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:03<00:02, 73.50it/s, est. speed input: 91533.20 toks/s, output: 89.39 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:03<00:02, 74.67it/s, est. speed input: 91207.22 toks/s, output: 89.07 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:03<00:02, 74.28it/s, est. speed input: 90764.23 toks/s, output: 88.64 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:04<00:02, 73.95it/s, est. speed input: 90338.07 toks/s, output: 88.22 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:04<00:01, 73.77it/s, est. speed input: 89939.58 toks/s, output: 87.83 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [00:04<00:01, 73.92it/s, est. speed input: 89589.91 toks/s, output: 87.49 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [00:04<00:01, 73.86it/s, est. speed input: 89240.62 toks/s, output: 87.15 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [00:04<00:01, 73.85it/s, est. speed input: 88911.92 toks/s, output: 86.83 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [00:04<00:01, 73.76it/s, est. speed input: 88591.00 toks/s, output: 86.51 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [00:04<00:01, 73.54it/s, est. speed input: 88268.76 toks/s, output: 86.20 toks/s]
Processed prompts:  81%|████████  | 414/512 [00:04<00:01, 73.45it/s, est. speed input: 87968.51 toks/s, output: 85.91 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [00:04<00:01, 73.24it/s, est. speed input: 87668.38 toks/s, output: 85.61 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [00:05<00:01, 73.33it/s, est. speed input: 87401.48 toks/s, output: 85.35 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [00:05<00:01, 73.27it/s, est. speed input: 87135.36 toks/s, output: 85.09 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [00:05<00:00, 73.48it/s, est. speed input: 86900.77 toks/s, output: 84.86 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [00:05<00:00, 75.35it/s, est. speed input: 86715.45 toks/s, output: 84.68 toks/s]
Processed prompts:  91%|█████████ | 466/512 [00:05<00:00, 74.94it/s, est. speed input: 86497.22 toks/s, output: 84.47 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [00:05<00:00, 74.28it/s, est. speed input: 86260.61 toks/s, output: 84.24 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [00:05<00:00, 73.98it/s, est. speed input: 86045.51 toks/s, output: 84.03 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [00:05<00:00, 73.69it/s, est. speed input: 85834.09 toks/s, output: 83.82 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [00:05<00:00, 73.51it/s, est. speed input: 85631.80 toks/s, output: 83.62 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [00:06<00:00, 73.50it/s, est. speed input: 85445.31 toks/s, output: 83.44 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:06<00:00, 73.50it/s, est. speed input: 85840.47 toks/s, output: 83.83 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:06<00:00, 83.82it/s, est. speed input: 85840.47 toks/s, output: 83.83 toks/s]
[rank0]:[W126 09:46:24.354805255 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=8192 ==========
Time: 2026-01-26 09:46:26
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=1024, max_num_seqs=8
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 1024 --max-num-seqs 8 --max-model-len 1025 --max-num-batched-tokens 8192 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-3B-INT8_M8192.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 09:46:37 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1162990) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1162990) WARNING 01-26 09:46:53 [backends.py:609] Failed to read file <frozen os>
Throughput: 75.73 requests/s, 77618.86 total tokens/s, 75.73 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024

STDERR:
[2026-01-26 09:46:36] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 09:46:37] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-26 09:46:37] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-26 09:46:37] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:46:37] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:46:37] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:46:37] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:46:37] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:46:37] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-26 09:46:37] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 09:46:37] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 09:46:37] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 09:46:37] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 09:46:37] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 09:46:43] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 09:46:45] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-26 09:46:45] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-26 09:46:45] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:46:45] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:46:45] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:46:45] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:46:45] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:46:45] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-26 09:46:45] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 09:46:45] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 09:46:45] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 09:46:45] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 09:46:45] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1162990) [2026-01-26 09:46:46] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1162990) [2026-01-26 09:46:46] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1162990) [2026-01-26 09:46:46] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1162990) [2026-01-26 09:46:46] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1162990) [2026-01-26 09:46:46] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-3B-INT8
(EngineCore_DP0 pid=1162990) [2026-01-26 09:46:46] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1162990) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1162990) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.86it/s]
(EngineCore_DP0 pid=1162990) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.86it/s]
(EngineCore_DP0 pid=1162990) 
(EngineCore_DP0 pid=1162990) [2026-01-26 09:46:47] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 4608] -> 1D uint8
(EngineCore_DP0 pid=1162990) [2026-01-26 09:46:47] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 14745600 bytes
(EngineCore_DP0 pid=1162990) [2026-01-26 09:46:47] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 4608] -> 1D uint8
(EngineCore_DP0 pid=1162990) [2026-01-26 09:46:47] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 8847360 bytes
(EngineCore_DP0 pid=1162990) [2026-01-26 09:46:47] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 4608] -> 1D uint8
(EngineCore_DP0 pid=1162990) [2026-01-26 09:46:47] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 47185920 bytes
(EngineCore_DP0 pid=1162990) [2026-01-26 09:46:47] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 12288] -> 1D uint8
(EngineCore_DP0 pid=1162990) [2026-01-26 09:46:47] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 23592960 bytes
(EngineCore_DP0 pid=1162990) 2026-01-26 09:47:04,071 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1162990) 2026-01-26 09:47:04,118 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1162990) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:01,  2.69it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  40%|████      | 2/5 [00:00<00:00,  3.83it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  60%|██████    | 3/5 [00:00<00:00,  5.27it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:01<00:00,  4.05it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:01<00:00,  4.02it/s]
(EngineCore_DP0 pid=1162990) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:00,  8.74it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00, 11.40it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00, 11.14it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   3%|▎         | 29/1024 [00:00<00:03, 285.09it/s]
Adding requests:   8%|▊         | 82/1024 [00:00<00:02, 425.13it/s]
Adding requests:  13%|█▎        | 133/1024 [00:00<00:01, 461.83it/s]
Adding requests:  18%|█▊        | 182/1024 [00:00<00:01, 471.17it/s]
Adding requests:  23%|██▎       | 234/1024 [00:00<00:01, 486.16it/s]
Adding requests:  28%|██▊       | 285/1024 [00:00<00:01, 492.68it/s]
Adding requests:  33%|███▎      | 335/1024 [00:00<00:01, 491.27it/s]
Adding requests:  38%|███▊      | 387/1024 [00:00<00:01, 499.03it/s]
Adding requests:  43%|████▎     | 438/1024 [00:00<00:01, 501.27it/s]
Adding requests:  48%|████▊     | 489/1024 [00:01<00:01, 502.00it/s]
Adding requests:  53%|█████▎    | 540/1024 [00:01<00:00, 489.45it/s]
Adding requests:  58%|█████▊    | 593/1024 [00:01<00:00, 499.95it/s]
Adding requests:  63%|██████▎   | 645/1024 [00:01<00:00, 503.52it/s]
Adding requests:  68%|██████▊   | 698/1024 [00:01<00:00, 510.53it/s]
Adding requests:  73%|███████▎  | 750/1024 [00:01<00:00, 509.12it/s]
Adding requests:  78%|███████▊  | 801/1024 [00:01<00:00, 506.91it/s]
Adding requests:  83%|████████▎ | 852/1024 [00:01<00:00, 500.41it/s]
Adding requests:  88%|████████▊ | 905/1024 [00:01<00:00, 508.77it/s]
Adding requests:  93%|█████████▎| 956/1024 [00:01<00:00, 508.57it/s]
Adding requests:  98%|█████████▊| 1008/1024 [00:02<00:00, 511.20it/s]
Adding requests: 100%|██████████| 1024/1024 [00:02<00:00, 495.69it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  15%|█▌        | 154/1024 [00:00<00:01, 748.50it/s, est. speed input: 766554.01 toks/s, output: 748.53 toks/s]
Processed prompts:  22%|██▏       | 229/1024 [00:01<00:04, 168.95it/s, est. speed input: 205036.06 toks/s, output: 200.23 toks/s]
Processed prompts:  26%|██▌       | 265/1024 [00:01<00:05, 139.54it/s, est. speed input: 173805.52 toks/s, output: 169.73 toks/s]
Processed prompts:  28%|██▊       | 289/1024 [00:01<00:05, 122.64it/s, est. speed input: 158223.31 toks/s, output: 154.51 toks/s]
Processed prompts:  30%|██▉       | 307/1024 [00:02<00:06, 103.94it/s, est. speed input: 143810.21 toks/s, output: 140.44 toks/s]
Processed prompts:  31%|███▏      | 321/1024 [00:02<00:06, 107.40it/s, est. speed input: 143451.14 toks/s, output: 140.09 toks/s]
Processed prompts:  33%|███▎      | 335/1024 [00:02<00:07, 97.06it/s, est. speed input: 137144.26 toks/s, output: 133.93 toks/s] 
Processed prompts:  34%|███▍      | 346/1024 [00:02<00:07, 86.22it/s, est. speed input: 131147.57 toks/s, output: 128.07 toks/s]
Processed prompts:  35%|███▍      | 356/1024 [00:02<00:07, 87.88it/s, est. speed input: 129958.30 toks/s, output: 126.91 toks/s]
Processed prompts:  36%|███▌      | 366/1024 [00:02<00:07, 89.55it/s, est. speed input: 128865.48 toks/s, output: 125.84 toks/s]
Processed prompts:  37%|███▋      | 376/1024 [00:03<00:07, 90.92it/s, est. speed input: 127812.85 toks/s, output: 124.82 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:03<00:08, 74.48it/s, est. speed input: 122638.59 toks/s, output: 119.76 toks/s]
Processed prompts:  39%|███▊      | 395/1024 [00:03<00:08, 76.94it/s, est. speed input: 121554.80 toks/s, output: 118.71 toks/s]
Processed prompts:  39%|███▉      | 404/1024 [00:03<00:07, 79.12it/s, est. speed input: 120548.56 toks/s, output: 117.72 toks/s]
Processed prompts:  40%|████      | 413/1024 [00:03<00:07, 80.84it/s, est. speed input: 119588.07 toks/s, output: 116.78 toks/s]
Processed prompts:  41%|████      | 422/1024 [00:03<00:07, 82.23it/s, est. speed input: 118687.49 toks/s, output: 115.91 toks/s]
Processed prompts:  42%|████▏     | 431/1024 [00:03<00:07, 83.49it/s, est. speed input: 117864.37 toks/s, output: 115.10 toks/s]
Processed prompts:  43%|████▎     | 440/1024 [00:03<00:06, 84.54it/s, est. speed input: 117100.72 toks/s, output: 114.36 toks/s]
Processed prompts:  44%|████▍     | 449/1024 [00:03<00:06, 85.17it/s, est. speed input: 116358.77 toks/s, output: 113.63 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:04<00:08, 67.11it/s, est. speed input: 112903.53 toks/s, output: 110.26 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:04<00:08, 69.33it/s, est. speed input: 112040.75 toks/s, output: 109.41 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:04<00:07, 71.10it/s, est. speed input: 111219.08 toks/s, output: 108.61 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:04<00:07, 72.55it/s, est. speed input: 110447.32 toks/s, output: 107.86 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:04<00:07, 73.73it/s, est. speed input: 109722.75 toks/s, output: 107.15 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:04<00:07, 74.53it/s, est. speed input: 109022.28 toks/s, output: 106.47 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:04<00:06, 75.34it/s, est. speed input: 108377.74 toks/s, output: 105.84 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:04<00:06, 75.77it/s, est. speed input: 107743.90 toks/s, output: 105.22 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:04<00:06, 76.04it/s, est. speed input: 107132.77 toks/s, output: 104.62 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:05<00:06, 76.21it/s, est. speed input: 106544.62 toks/s, output: 104.05 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:05<00:06, 76.18it/s, est. speed input: 105966.74 toks/s, output: 103.48 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:05<00:06, 76.06it/s, est. speed input: 105401.87 toks/s, output: 102.93 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:05<00:06, 76.12it/s, est. speed input: 104872.58 toks/s, output: 102.41 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:05<00:06, 76.30it/s, est. speed input: 104374.64 toks/s, output: 101.93 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:05<00:05, 76.38it/s, est. speed input: 103891.75 toks/s, output: 101.46 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:05<00:05, 76.37it/s, est. speed input: 103421.34 toks/s, output: 101.00 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:05<00:05, 76.50it/s, est. speed input: 102978.25 toks/s, output: 100.56 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:05<00:05, 76.66it/s, est. speed input: 102556.52 toks/s, output: 100.15 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:06<00:05, 76.60it/s, est. speed input: 102136.07 toks/s, output: 99.74 toks/s] 
Processed prompts:  60%|█████▉    | 610/1024 [00:06<00:05, 76.49it/s, est. speed input: 101724.84 toks/s, output: 99.34 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:06<00:05, 76.29it/s, est. speed input: 101317.92 toks/s, output: 98.94 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:06<00:05, 76.29it/s, est. speed input: 100934.86 toks/s, output: 98.57 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:06<00:05, 76.22it/s, est. speed input: 100558.97 toks/s, output: 98.20 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:06<00:05, 76.15it/s, est. speed input: 100194.58 toks/s, output: 97.85 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:06<00:04, 76.25it/s, est. speed input: 99850.84 toks/s, output: 97.51 toks/s] 
Processed prompts:  64%|██████▍   | 658/1024 [00:06<00:04, 76.45it/s, est. speed input: 99527.07 toks/s, output: 97.19 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:06<00:04, 76.73it/s, est. speed input: 99221.79 toks/s, output: 96.90 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:06<00:04, 76.66it/s, est. speed input: 98908.75 toks/s, output: 96.59 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:07<00:04, 76.54it/s, est. speed input: 98600.45 toks/s, output: 96.29 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:07<00:04, 76.47it/s, est. speed input: 98301.91 toks/s, output: 96.00 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:07<00:04, 76.40it/s, est. speed input: 98010.87 toks/s, output: 95.71 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:07<00:04, 76.34it/s, est. speed input: 97726.97 toks/s, output: 95.44 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:07<00:04, 76.29it/s, est. speed input: 97450.99 toks/s, output: 95.17 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:07<00:03, 76.26it/s, est. speed input: 97182.85 toks/s, output: 94.90 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:07<00:03, 76.40it/s, est. speed input: 96931.23 toks/s, output: 94.66 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:07<00:03, 76.62it/s, est. speed input: 96693.11 toks/s, output: 94.43 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:07<00:03, 76.68it/s, est. speed input: 96456.02 toks/s, output: 94.19 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:08<00:03, 76.56it/s, est. speed input: 96216.00 toks/s, output: 93.96 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:08<00:03, 76.48it/s, est. speed input: 95982.61 toks/s, output: 93.73 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:08<00:03, 76.50it/s, est. speed input: 95759.23 toks/s, output: 93.51 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:08<00:03, 76.35it/s, est. speed input: 95533.39 toks/s, output: 93.29 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:08<00:03, 76.24it/s, est. speed input: 95311.92 toks/s, output: 93.08 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:08<00:03, 76.14it/s, est. speed input: 95095.42 toks/s, output: 92.87 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:08<00:02, 76.22it/s, est. speed input: 94891.41 toks/s, output: 92.67 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:08<00:02, 76.26it/s, est. speed input: 94691.59 toks/s, output: 92.47 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:08<00:02, 76.35it/s, est. speed input: 94499.33 toks/s, output: 92.28 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:08<00:02, 76.32it/s, est. speed input: 94307.30 toks/s, output: 92.10 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:09<00:02, 76.40it/s, est. speed input: 94124.96 toks/s, output: 91.92 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [00:09<00:02, 76.34it/s, est. speed input: 93940.90 toks/s, output: 91.74 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [00:09<00:02, 76.33it/s, est. speed input: 93762.14 toks/s, output: 91.56 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:09<00:02, 76.33it/s, est. speed input: 93587.84 toks/s, output: 91.39 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [00:09<00:02, 76.42it/s, est. speed input: 93421.71 toks/s, output: 91.23 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [00:09<00:01, 76.33it/s, est. speed input: 93251.94 toks/s, output: 91.07 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [00:09<00:01, 76.29it/s, est. speed input: 93087.28 toks/s, output: 90.91 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [00:09<00:01, 76.31it/s, est. speed input: 92928.34 toks/s, output: 90.75 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [00:09<00:01, 76.41it/s, est. speed input: 92775.91 toks/s, output: 90.60 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [00:10<00:01, 76.35it/s, est. speed input: 92621.74 toks/s, output: 90.45 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [00:10<00:01, 76.30it/s, est. speed input: 92470.06 toks/s, output: 90.30 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [00:10<00:01, 76.32it/s, est. speed input: 92323.71 toks/s, output: 90.16 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [00:10<00:01, 76.44it/s, est. speed input: 92184.81 toks/s, output: 90.02 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [00:10<00:01, 77.94it/s, est. speed input: 91984.81 toks/s, output: 89.83 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [00:10<00:00, 77.53it/s, est. speed input: 91848.52 toks/s, output: 89.70 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [00:10<00:00, 77.06it/s, est. speed input: 91708.10 toks/s, output: 89.56 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [00:10<00:00, 76.85it/s, est. speed input: 91576.90 toks/s, output: 89.43 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [00:10<00:00, 76.79it/s, est. speed input: 91452.05 toks/s, output: 89.31 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [00:11<00:00, 78.01it/s, est. speed input: 91272.58 toks/s, output: 89.13 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [00:11<00:00, 77.55it/s, est. speed input: 91148.56 toks/s, output: 89.01 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [00:11<00:00, 77.17it/s, est. speed input: 91026.03 toks/s, output: 88.89 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:11<00:00, 77.17it/s, est. speed input: 91543.20 toks/s, output: 89.40 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:11<00:00, 89.40it/s, est. speed input: 91543.20 toks/s, output: 89.40 toks/s]
[rank0]:[W126 09:47:21.035741194 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=16384 ==========
Time: 2026-01-26 09:47:22
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=2048, max_num_seqs=16
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 2048 --max-num-seqs 16 --max-model-len 1025 --max-num-batched-tokens 16384 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-3B-INT8_M16384.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 09:47:37 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1164311) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1164311) WARNING 01-26 09:47:54 [backends.py:609] Failed to read file <frozen os>
Throughput: 77.98 requests/s, 79925.15 total tokens/s, 77.98 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048

STDERR:
[2026-01-26 09:47:37] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 09:47:37] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-26 09:47:37] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-26 09:47:37] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:47:37] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:47:37] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:47:37] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:47:37] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:47:37] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-26 09:47:37] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 09:47:37] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 09:47:37] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 09:47:37] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 09:47:37] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 09:47:44] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 09:47:45] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-26 09:47:45] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-26 09:47:45] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:47:45] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:47:45] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:47:45] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:47:45] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:47:45] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-26 09:47:45] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 09:47:45] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 09:47:45] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 09:47:45] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 09:47:45] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1164311) [2026-01-26 09:47:46] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1164311) [2026-01-26 09:47:46] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1164311) [2026-01-26 09:47:46] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1164311) [2026-01-26 09:47:46] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1164311) [2026-01-26 09:47:46] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-3B-INT8
(EngineCore_DP0 pid=1164311) [2026-01-26 09:47:46] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1164311) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1164311) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.86it/s]
(EngineCore_DP0 pid=1164311) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.85it/s]
(EngineCore_DP0 pid=1164311) 
(EngineCore_DP0 pid=1164311) [2026-01-26 09:47:47] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 4608] -> 1D uint8
(EngineCore_DP0 pid=1164311) [2026-01-26 09:47:48] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 14745600 bytes
(EngineCore_DP0 pid=1164311) [2026-01-26 09:47:48] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 4608] -> 1D uint8
(EngineCore_DP0 pid=1164311) [2026-01-26 09:47:48] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 8847360 bytes
(EngineCore_DP0 pid=1164311) [2026-01-26 09:47:48] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 4608] -> 1D uint8
(EngineCore_DP0 pid=1164311) [2026-01-26 09:47:48] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 47185920 bytes
(EngineCore_DP0 pid=1164311) [2026-01-26 09:47:48] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 12288] -> 1D uint8
(EngineCore_DP0 pid=1164311) [2026-01-26 09:47:48] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 23592960 bytes
(EngineCore_DP0 pid=1164311) 2026-01-26 09:48:04,719 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1164311) 2026-01-26 09:48:04,744 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1164311) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  29%|██▊       | 2/7 [00:00<00:00, 13.17it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  57%|█████▋    | 4/7 [00:00<00:00, 10.29it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  86%|████████▌ | 6/7 [00:00<00:00,  5.14it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:01<00:00,  5.24it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:01<00:00,  5.95it/s]
(EngineCore_DP0 pid=1164311) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  40%|████      | 2/5 [00:00<00:00, 18.27it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00, 19.97it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00, 19.74it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 34/2048 [00:00<00:05, 337.91it/s]
Adding requests:   4%|▍         | 86/2048 [00:00<00:04, 444.70it/s]
Adding requests:   7%|▋         | 137/2048 [00:00<00:04, 472.54it/s]
Adding requests:   9%|▉         | 187/2048 [00:00<00:03, 481.56it/s]
Adding requests:  12%|█▏        | 239/2048 [00:00<00:03, 492.66it/s]
Adding requests:  14%|█▍        | 290/2048 [00:00<00:03, 495.40it/s]
Adding requests:  17%|█▋        | 341/2048 [00:00<00:03, 497.55it/s]
Adding requests:  19%|█▉        | 394/2048 [00:00<00:03, 505.83it/s]
Adding requests:  22%|██▏       | 445/2048 [00:00<00:03, 505.24it/s]
Adding requests:  24%|██▍       | 497/2048 [00:01<00:03, 507.31it/s]
Adding requests:  27%|██▋       | 548/2048 [00:01<00:02, 501.63it/s]
Adding requests:  29%|██▉       | 601/2048 [00:01<00:02, 507.32it/s]
Adding requests:  32%|███▏      | 655/2048 [00:01<00:02, 515.26it/s]
Adding requests:  35%|███▍      | 709/2048 [00:01<00:02, 521.33it/s]
Adding requests:  37%|███▋      | 762/2048 [00:01<00:02, 510.93it/s]
Adding requests:  40%|███▉      | 814/2048 [00:01<00:02, 499.32it/s]
Adding requests:  42%|████▏     | 866/2048 [00:01<00:02, 502.61it/s]
Adding requests:  45%|████▍     | 920/2048 [00:01<00:02, 512.30it/s]
Adding requests:  48%|████▊     | 973/2048 [00:01<00:02, 515.34it/s]
Adding requests:  50%|█████     | 1027/2048 [00:02<00:01, 519.99it/s]
Adding requests:  53%|█████▎    | 1080/2048 [00:02<00:01, 518.02it/s]
Adding requests:  55%|█████▌    | 1132/2048 [00:02<00:01, 515.77it/s]
Adding requests:  58%|█████▊    | 1187/2048 [00:02<00:01, 523.69it/s]
Adding requests:  61%|██████    | 1240/2048 [00:02<00:01, 525.20it/s]
Adding requests:  63%|██████▎   | 1293/2048 [00:02<00:01, 522.38it/s]
Adding requests:  66%|██████▌   | 1347/2048 [00:02<00:01, 524.51it/s]
Adding requests:  68%|██████▊   | 1401/2048 [00:02<00:01, 529.09it/s]
Adding requests:  71%|███████   | 1454/2048 [00:02<00:01, 527.01it/s]
Adding requests:  74%|███████▎  | 1509/2048 [00:02<00:01, 532.28it/s]
Adding requests:  76%|███████▋  | 1563/2048 [00:03<00:00, 531.23it/s]
Adding requests:  79%|███████▉  | 1617/2048 [00:03<00:00, 533.79it/s]
Adding requests:  82%|████████▏ | 1671/2048 [00:03<00:00, 530.07it/s]
Adding requests:  84%|████████▍ | 1725/2048 [00:03<00:00, 532.76it/s]
Adding requests:  87%|████████▋ | 1779/2048 [00:03<00:00, 526.42it/s]
Adding requests:  89%|████████▉ | 1832/2048 [00:03<00:00, 525.84it/s]
Adding requests:  92%|█████████▏| 1885/2048 [00:03<00:00, 526.13it/s]
Adding requests:  95%|█████████▍| 1938/2048 [00:03<00:00, 509.96it/s]
Adding requests:  97%|█████████▋| 1991/2048 [00:03<00:00, 512.82it/s]
Adding requests: 100%|█████████▉| 2044/2048 [00:03<00:00, 516.66it/s]
Adding requests: 100%|██████████| 2048/2048 [00:03<00:00, 513.02it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [00:00<00:01, 1718.68it/s, est. speed input: 1760373.96 toks/s, output: 1718.80 toks/s]
Processed prompts:  23%|██▎       | 478/2048 [00:02<00:08, 179.91it/s, est. speed input: 222481.60 toks/s, output: 217.27 toks/s]   
Processed prompts:  27%|██▋       | 554/2048 [00:03<00:10, 137.03it/s, est. speed input: 175909.43 toks/s, output: 171.79 toks/s]
Processed prompts:  29%|██▉       | 599/2048 [00:03<00:12, 120.52it/s, est. speed input: 159704.26 toks/s, output: 155.96 toks/s]
Processed prompts:  31%|███       | 629/2048 [00:04<00:12, 111.01it/s, est. speed input: 151409.18 toks/s, output: 147.86 toks/s]
Processed prompts:  32%|███▏      | 651/2048 [00:04<00:12, 110.52it/s, est. speed input: 149482.42 toks/s, output: 145.98 toks/s]
Processed prompts:  33%|███▎      | 669/2048 [00:04<00:12, 107.09it/s, est. speed input: 146852.11 toks/s, output: 143.41 toks/s]
Processed prompts:  33%|███▎      | 684/2048 [00:04<00:13, 101.35it/s, est. speed input: 143905.55 toks/s, output: 140.53 toks/s]
Processed prompts:  34%|███▍      | 697/2048 [00:05<00:14, 93.71it/s, est. speed input: 140712.54 toks/s, output: 137.41 toks/s] 
Processed prompts:  35%|███▍      | 708/2048 [00:05<00:15, 84.51it/s, est. speed input: 137310.46 toks/s, output: 134.09 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [00:05<00:16, 80.53it/s, est. speed input: 134775.64 toks/s, output: 131.62 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [00:05<00:16, 79.89it/s, est. speed input: 132800.01 toks/s, output: 129.69 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [00:05<00:16, 79.63it/s, est. speed input: 131009.91 toks/s, output: 127.94 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [00:06<00:16, 79.12it/s, est. speed input: 129278.23 toks/s, output: 126.25 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [00:06<00:16, 78.61it/s, est. speed input: 127634.97 toks/s, output: 124.64 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [00:06<00:15, 78.35it/s, est. speed input: 126115.65 toks/s, output: 123.16 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [00:06<00:15, 78.28it/s, est. speed input: 124709.00 toks/s, output: 121.79 toks/s]
Processed prompts:  41%|████      | 834/2048 [00:06<00:15, 78.40it/s, est. speed input: 123412.72 toks/s, output: 120.52 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [00:07<00:15, 78.05it/s, est. speed input: 122124.17 toks/s, output: 119.26 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [00:07<00:15, 77.79it/s, est. speed input: 120905.39 toks/s, output: 118.07 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [00:07<00:14, 77.95it/s, est. speed input: 119802.57 toks/s, output: 116.99 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [00:07<00:14, 78.04it/s, est. speed input: 118755.65 toks/s, output: 115.97 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [00:07<00:14, 78.11it/s, est. speed input: 117761.99 toks/s, output: 115.00 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [00:08<00:14, 79.27it/s, est. speed input: 116956.34 toks/s, output: 114.21 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [00:08<00:14, 78.47it/s, est. speed input: 115995.76 toks/s, output: 113.28 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [00:08<00:13, 78.48it/s, est. speed input: 115147.41 toks/s, output: 112.45 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [00:08<00:13, 80.01it/s, est. speed input: 114507.92 toks/s, output: 111.82 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [00:08<00:13, 79.43it/s, est. speed input: 113717.39 toks/s, output: 111.05 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [00:09<00:13, 78.87it/s, est. speed input: 112946.80 toks/s, output: 110.30 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [00:09<00:13, 78.43it/s, est. speed input: 112202.74 toks/s, output: 109.57 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [00:09<00:12, 78.22it/s, est. speed input: 111501.55 toks/s, output: 108.89 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [00:09<00:12, 78.34it/s, est. speed input: 110857.02 toks/s, output: 108.26 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [00:09<00:12, 78.29it/s, est. speed input: 110224.54 toks/s, output: 107.64 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [00:10<00:12, 78.02it/s, est. speed input: 109595.37 toks/s, output: 107.03 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [00:10<00:12, 77.78it/s, est. speed input: 108987.53 toks/s, output: 106.43 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [00:10<00:11, 77.82it/s, est. speed input: 108421.48 toks/s, output: 105.88 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [00:10<00:11, 78.02it/s, est. speed input: 107891.86 toks/s, output: 105.36 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [00:10<00:11, 79.38it/s, est. speed input: 107484.41 toks/s, output: 104.96 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [00:11<00:11, 78.83it/s, est. speed input: 106968.42 toks/s, output: 104.46 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [00:11<00:10, 78.39it/s, est. speed input: 106465.40 toks/s, output: 103.97 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [00:11<00:10, 78.08it/s, est. speed input: 105980.12 toks/s, output: 103.50 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [00:11<00:10, 78.29it/s, est. speed input: 105545.66 toks/s, output: 103.07 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [00:12<00:10, 77.97it/s, est. speed input: 105089.70 toks/s, output: 102.63 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [00:12<00:10, 77.89it/s, est. speed input: 104659.61 toks/s, output: 102.21 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [00:12<00:10, 77.83it/s, est. speed input: 104244.36 toks/s, output: 101.80 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [00:12<00:09, 77.86it/s, est. speed input: 103847.41 toks/s, output: 101.41 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [00:12<00:09, 77.90it/s, est. speed input: 103463.97 toks/s, output: 101.04 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [00:13<00:09, 77.66it/s, est. speed input: 103074.73 toks/s, output: 100.66 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [00:13<00:09, 77.70it/s, est. speed input: 102711.59 toks/s, output: 100.30 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [00:13<00:09, 77.52it/s, est. speed input: 102345.19 toks/s, output: 99.95 toks/s] 
Processed prompts:  67%|██████▋   | 1362/2048 [00:13<00:08, 77.80it/s, est. speed input: 102017.32 toks/s, output: 99.63 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [00:13<00:08, 77.80it/s, est. speed input: 101685.80 toks/s, output: 99.30 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [00:14<00:08, 77.60it/s, est. speed input: 101351.76 toks/s, output: 98.98 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [00:14<00:08, 77.52it/s, est. speed input: 101030.88 toks/s, output: 98.66 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [00:14<00:08, 77.45it/s, est. speed input: 100718.45 toks/s, output: 98.36 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [00:14<00:07, 77.69it/s, est. speed input: 100431.83 toks/s, output: 98.08 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [00:14<00:07, 77.48it/s, est. speed input: 100131.25 toks/s, output: 97.78 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [00:15<00:07, 77.51it/s, est. speed input: 99848.91 toks/s, output: 97.51 toks/s] 
Processed prompts:  73%|███████▎  | 1490/2048 [00:15<00:07, 77.32it/s, est. speed input: 99562.18 toks/s, output: 97.23 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [00:15<00:07, 77.37it/s, est. speed input: 99293.40 toks/s, output: 96.97 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [00:15<00:06, 77.66it/s, est. speed input: 99045.94 toks/s, output: 96.72 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [00:15<00:06, 77.80it/s, est. speed input: 98801.13 toks/s, output: 96.49 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [00:16<00:06, 77.75it/s, est. speed input: 98554.94 toks/s, output: 96.24 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [00:16<00:06, 77.73it/s, est. speed input: 98315.59 toks/s, output: 96.01 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [00:16<00:05, 77.88it/s, est. speed input: 98090.54 toks/s, output: 95.79 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [00:16<00:05, 77.98it/s, est. speed input: 97870.88 toks/s, output: 95.58 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [00:16<00:05, 77.96it/s, est. speed input: 97652.13 toks/s, output: 95.36 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [00:17<00:05, 77.84it/s, est. speed input: 97433.26 toks/s, output: 95.15 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [00:17<00:05, 77.84it/s, est. speed input: 97223.43 toks/s, output: 94.94 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [00:17<00:04, 77.84it/s, est. speed input: 97018.87 toks/s, output: 94.74 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [00:17<00:04, 77.92it/s, est. speed input: 96822.73 toks/s, output: 94.55 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [00:17<00:04, 77.92it/s, est. speed input: 96628.37 toks/s, output: 94.36 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [00:18<00:04, 77.93it/s, est. speed input: 96438.80 toks/s, output: 94.18 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [00:18<00:04, 77.84it/s, est. speed input: 96249.14 toks/s, output: 93.99 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [00:18<00:03, 77.89it/s, est. speed input: 96068.72 toks/s, output: 93.82 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [00:18<00:03, 78.09it/s, est. speed input: 95899.40 toks/s, output: 93.65 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [00:19<00:03, 77.98it/s, est. speed input: 95723.07 toks/s, output: 93.48 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [00:19<00:03, 77.92it/s, est. speed input: 95551.27 toks/s, output: 93.31 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [00:19<00:03, 77.91it/s, est. speed input: 95383.99 toks/s, output: 93.15 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [00:19<00:02, 77.91it/s, est. speed input: 95220.86 toks/s, output: 92.99 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [00:19<00:02, 77.99it/s, est. speed input: 95064.44 toks/s, output: 92.84 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [00:20<00:02, 77.82it/s, est. speed input: 94901.71 toks/s, output: 92.68 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [00:20<00:02, 79.28it/s, est. speed input: 94806.17 toks/s, output: 92.58 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [00:20<00:02, 78.76it/s, est. speed input: 94651.34 toks/s, output: 92.43 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [00:20<00:01, 78.42it/s, est. speed input: 94500.06 toks/s, output: 92.29 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [00:20<00:01, 78.47it/s, est. speed input: 94363.13 toks/s, output: 92.15 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [00:21<00:01, 78.25it/s, est. speed input: 94218.86 toks/s, output: 92.01 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [00:21<00:01, 79.55it/s, est. speed input: 94132.73 toks/s, output: 91.93 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [00:21<00:00, 79.06it/s, est. speed input: 93995.85 toks/s, output: 91.79 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [00:21<00:00, 78.48it/s, est. speed input: 93852.46 toks/s, output: 91.65 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [00:21<00:00, 78.39it/s, est. speed input: 93723.17 toks/s, output: 91.53 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [00:22<00:00, 78.30it/s, est. speed input: 93595.58 toks/s, output: 91.40 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [00:22<00:00, 79.88it/s, est. speed input: 93529.05 toks/s, output: 91.34 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:22<00:00, 79.88it/s, est. speed input: 94170.41 toks/s, output: 91.96 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:22<00:00, 91.96it/s, est. speed input: 94170.41 toks/s, output: 91.96 toks/s]
[rank0]:[W126 09:48:34.249820961 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=32768 ==========
Time: 2026-01-26 09:48:36
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=4096, max_num_seqs=32
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 4096 --max-num-seqs 32 --max-model-len 1025 --max-num-batched-tokens 32768 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-3B-INT8_M32768.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 09:48:59 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1165896) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1165896) WARNING 01-26 09:49:16 [backends.py:609] Failed to read file <frozen os>
Throughput: 79.11 requests/s, 81091.65 total tokens/s, 79.11 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096

STDERR:
[2026-01-26 09:48:59] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 09:48:59] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-26 09:48:59] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-26 09:48:59] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:48:59] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:48:59] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:48:59] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:48:59] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:48:59] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-26 09:48:59] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 09:48:59] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 09:48:59] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 09:48:59] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 09:48:59] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 09:49:06] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 09:49:07] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-26 09:49:07] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-26 09:49:07] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:49:07] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:49:07] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:49:07] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:49:07] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:49:07] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-26 09:49:07] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 09:49:07] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 09:49:07] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 09:49:07] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 09:49:07] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1165896) [2026-01-26 09:49:08] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1165896) [2026-01-26 09:49:08] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1165896) [2026-01-26 09:49:08] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1165896) [2026-01-26 09:49:08] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1165896) [2026-01-26 09:49:08] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-3B-INT8
(EngineCore_DP0 pid=1165896) [2026-01-26 09:49:08] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1165896) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1165896) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.87it/s]
(EngineCore_DP0 pid=1165896) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.87it/s]
(EngineCore_DP0 pid=1165896) 
(EngineCore_DP0 pid=1165896) [2026-01-26 09:49:09] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 4608] -> 1D uint8
(EngineCore_DP0 pid=1165896) [2026-01-26 09:49:10] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 14745600 bytes
(EngineCore_DP0 pid=1165896) [2026-01-26 09:49:10] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 4608] -> 1D uint8
(EngineCore_DP0 pid=1165896) [2026-01-26 09:49:10] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 8847360 bytes
(EngineCore_DP0 pid=1165896) [2026-01-26 09:49:10] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 4608] -> 1D uint8
(EngineCore_DP0 pid=1165896) [2026-01-26 09:49:10] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 47185920 bytes
(EngineCore_DP0 pid=1165896) [2026-01-26 09:49:10] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 12288] -> 1D uint8
(EngineCore_DP0 pid=1165896) [2026-01-26 09:49:10] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 23592960 bytes
(EngineCore_DP0 pid=1165896) [rank0]:W0126 09:49:21.495000 1165896 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1165896) [rank0]:W0126 09:49:21.578000 1165896 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1165896) [rank0]:W0126 09:49:22.434000 1165896 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1165896) [rank0]:W0126 09:49:22.557000 1165896 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1165896) 2026-01-26 09:49:26,279 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1165896) 2026-01-26 09:49:26,329 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1165896) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   9%|▉         | 1/11 [00:00<00:01,  9.97it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  27%|██▋       | 3/11 [00:00<00:00, 14.84it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  45%|████▌     | 5/11 [00:00<00:00, 10.78it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  64%|██████▎   | 7/11 [00:00<00:00, 10.37it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  82%|████████▏ | 9/11 [00:01<00:00,  5.46it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  91%|█████████ | 10/11 [00:01<00:00,  5.29it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00,  6.92it/s]
(EngineCore_DP0 pid=1165896) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  29%|██▊       | 2/7 [00:00<00:00, 18.65it/s]
Capturing CUDA graphs (decode, FULL):  57%|█████▋    | 4/7 [00:00<00:00, 19.37it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00, 19.81it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00, 19.63it/s]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   1%|          | 32/4096 [00:00<00:12, 316.24it/s]
Adding requests:   2%|▏         | 83/4096 [00:00<00:09, 426.50it/s]
Adding requests:   3%|▎         | 133/4096 [00:00<00:08, 457.93it/s]
Adding requests:   4%|▍         | 182/4096 [00:00<00:08, 467.55it/s]
Adding requests:   6%|▌         | 233/4096 [00:00<00:08, 480.99it/s]
Adding requests:   7%|▋         | 283/4096 [00:00<00:07, 487.17it/s]
Adding requests:   8%|▊         | 332/4096 [00:00<00:07, 487.37it/s]
Adding requests:   9%|▉         | 383/4096 [00:00<00:07, 492.05it/s]
Adding requests:  11%|█         | 434/4096 [00:00<00:07, 495.50it/s]
Adding requests:  12%|█▏        | 485/4096 [00:01<00:07, 498.77it/s]
Adding requests:  13%|█▎        | 535/4096 [00:01<00:07, 487.10it/s]
Adding requests:  14%|█▍        | 588/4096 [00:01<00:07, 497.17it/s]
Adding requests:  16%|█▌        | 639/4096 [00:01<00:06, 499.80it/s]
Adding requests:  17%|█▋        | 691/4096 [00:01<00:06, 505.64it/s]
Adding requests:  18%|█▊        | 742/4096 [00:01<00:06, 504.24it/s]
Adding requests:  19%|█▉        | 793/4096 [00:01<00:06, 502.88it/s]
Adding requests:  21%|██        | 844/4096 [00:01<00:06, 493.77it/s]
Adding requests:  22%|██▏       | 897/4096 [00:01<00:06, 502.87it/s]
Adding requests:  23%|██▎       | 948/4096 [00:01<00:06, 504.85it/s]
Adding requests:  24%|██▍       | 999/4096 [00:02<00:06, 504.64it/s]
Adding requests:  26%|██▌       | 1052/4096 [00:02<00:05, 509.01it/s]
Adding requests:  27%|██▋       | 1103/4096 [00:02<00:06, 494.39it/s]
Adding requests:  28%|██▊       | 1153/4096 [00:02<00:05, 494.51it/s]
Adding requests:  29%|██▉       | 1207/4096 [00:02<00:05, 507.30it/s]
Adding requests:  31%|███       | 1258/4096 [00:02<00:05, 503.38it/s]
Adding requests:  32%|███▏      | 1309/4096 [00:02<00:05, 504.25it/s]
Adding requests:  33%|███▎      | 1361/4096 [00:02<00:05, 508.20it/s]
Adding requests:  35%|███▍      | 1414/4096 [00:02<00:05, 512.75it/s]
Adding requests:  36%|███▌      | 1466/4096 [00:02<00:05, 512.17it/s]
Adding requests:  37%|███▋      | 1518/4096 [00:03<00:05, 513.99it/s]
Adding requests:  38%|███▊      | 1570/4096 [00:03<00:04, 514.22it/s]
Adding requests:  40%|███▉      | 1623/4096 [00:03<00:04, 517.60it/s]
Adding requests:  41%|████      | 1675/4096 [00:03<00:04, 513.53it/s]
Adding requests:  42%|████▏     | 1728/4096 [00:03<00:04, 515.97it/s]
Adding requests:  43%|████▎     | 1780/4096 [00:03<00:04, 509.24it/s]
Adding requests:  45%|████▍     | 1831/4096 [00:03<00:04, 504.28it/s]
Adding requests:  46%|████▌     | 1882/4096 [00:03<00:04, 502.49it/s]
Adding requests:  47%|████▋     | 1934/4096 [00:03<00:04, 505.21it/s]
Adding requests:  48%|████▊     | 1985/4096 [00:03<00:04, 505.61it/s]
Adding requests:  50%|████▉     | 2038/4096 [00:04<00:04, 509.59it/s]
Adding requests:  51%|█████     | 2090/4096 [00:04<00:03, 512.34it/s]
Adding requests:  52%|█████▏    | 2142/4096 [00:04<00:03, 507.58it/s]
Adding requests:  54%|█████▎    | 2193/4096 [00:04<00:03, 503.73it/s]
Adding requests:  55%|█████▍    | 2245/4096 [00:04<00:03, 508.25it/s]
Adding requests:  56%|█████▌    | 2296/4096 [00:04<00:03, 495.99it/s]
Adding requests:  57%|█████▋    | 2347/4096 [00:04<00:03, 500.04it/s]
Adding requests:  59%|█████▊    | 2398/4096 [00:04<00:03, 502.05it/s]
Adding requests:  60%|█████▉    | 2449/4096 [00:04<00:03, 503.49it/s]
Adding requests:  61%|██████    | 2501/4096 [00:04<00:03, 505.96it/s]
Adding requests:  62%|██████▏   | 2553/4096 [00:05<00:03, 509.32it/s]
Adding requests:  64%|██████▎   | 2604/4096 [00:05<00:02, 509.11it/s]
Adding requests:  65%|██████▍   | 2657/4096 [00:05<00:02, 513.75it/s]
Adding requests:  66%|██████▌   | 2709/4096 [00:05<00:02, 507.12it/s]
Adding requests:  67%|██████▋   | 2760/4096 [00:05<00:02, 507.72it/s]
Adding requests:  69%|██████▊   | 2811/4096 [00:05<00:02, 505.57it/s]
Adding requests:  70%|██████▉   | 2862/4096 [00:05<00:02, 506.29it/s]
Adding requests:  71%|███████   | 2914/4096 [00:05<00:02, 508.59it/s]
Adding requests:  72%|███████▏  | 2965/4096 [00:05<00:02, 504.10it/s]
Adding requests:  74%|███████▎  | 3017/4096 [00:06<00:02, 507.39it/s]
Adding requests:  75%|███████▍  | 3068/4096 [00:06<00:02, 504.60it/s]
Adding requests:  76%|███████▌  | 3120/4096 [00:06<00:01, 508.05it/s]
Adding requests:  77%|███████▋  | 3171/4096 [00:06<00:01, 505.46it/s]
Adding requests:  79%|███████▊  | 3222/4096 [00:06<00:01, 504.92it/s]
Adding requests:  80%|███████▉  | 3274/4096 [00:06<00:01, 509.32it/s]
Adding requests:  81%|████████  | 3325/4096 [00:06<00:01, 507.96it/s]
Adding requests:  82%|████████▏ | 3378/4096 [00:06<00:01, 511.96it/s]
Adding requests:  84%|████████▎ | 3430/4096 [00:06<00:01, 512.85it/s]
Adding requests:  85%|████████▌ | 3482/4096 [00:06<00:01, 502.43it/s]
Adding requests:  86%|████████▋ | 3533/4096 [00:07<00:01, 501.80it/s]
Adding requests:  88%|████████▊ | 3584/4096 [00:07<00:01, 502.40it/s]
Adding requests:  89%|████████▊ | 3635/4096 [00:07<00:00, 488.82it/s]
Adding requests:  90%|████████▉ | 3686/4096 [00:07<00:00, 494.50it/s]
Adding requests:  91%|█████████ | 3737/4096 [00:07<00:00, 496.43it/s]
Adding requests:  93%|█████████▎| 3791/4096 [00:07<00:00, 507.11it/s]
Adding requests:  94%|█████████▍| 3843/4096 [00:07<00:00, 508.49it/s]
Adding requests:  95%|█████████▌| 3895/4096 [00:07<00:00, 510.88it/s]
Adding requests:  96%|█████████▋| 3947/4096 [00:07<00:00, 511.61it/s]
Adding requests:  98%|█████████▊| 3999/4096 [00:07<00:00, 508.04it/s]
Adding requests:  99%|█████████▉| 4050/4096 [00:08<00:00, 507.14it/s]
Adding requests: 100%|██████████| 4096/4096 [00:08<00:00, 502.64it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  15%|█▌        | 627/4096 [00:00<00:01, 2275.11it/s, est. speed input: 2329915.67 toks/s, output: 2275.17 toks/s]
Processed prompts:  21%|██        | 855/4096 [00:03<00:14, 221.26it/s, est. speed input: 282722.90 toks/s, output: 276.10 toks/s]   
Processed prompts:  23%|██▎       | 954/4096 [00:04<00:18, 170.75it/s, est. speed input: 227147.69 toks/s, output: 221.82 toks/s]
Processed prompts:  25%|██▍       | 1012/4096 [00:05<00:21, 145.72it/s, est. speed input: 203309.08 toks/s, output: 198.54 toks/s]
Processed prompts:  26%|██▌       | 1050/4096 [00:05<00:22, 137.64it/s, est. speed input: 195447.96 toks/s, output: 190.87 toks/s]
Processed prompts:  26%|██▋       | 1078/4096 [00:05<00:24, 125.18it/s, est. speed input: 186937.24 toks/s, output: 182.56 toks/s]
Processed prompts:  27%|██▋       | 1107/4096 [00:06<00:26, 114.09it/s, est. speed input: 179648.77 toks/s, output: 175.44 toks/s]
Processed prompts:  28%|██▊       | 1139/4096 [00:06<00:27, 106.74it/s, est. speed input: 173980.17 toks/s, output: 169.90 toks/s]
Processed prompts:  29%|██▊       | 1171/4096 [00:07<00:29, 99.91it/s, est. speed input: 168685.54 toks/s, output: 164.73 toks/s] 
Processed prompts:  29%|██▉       | 1203/4096 [00:07<00:30, 94.55it/s, est. speed input: 163990.19 toks/s, output: 160.15 toks/s]
Processed prompts:  30%|███       | 1235/4096 [00:07<00:31, 90.48it/s, est. speed input: 159790.77 toks/s, output: 156.04 toks/s]
Processed prompts:  31%|███       | 1267/4096 [00:08<00:32, 87.37it/s, est. speed input: 155980.60 toks/s, output: 152.32 toks/s]
Processed prompts:  32%|███▏      | 1299/4096 [00:08<00:32, 84.93it/s, est. speed input: 152480.65 toks/s, output: 148.91 toks/s]
Processed prompts:  32%|███▏      | 1331/4096 [00:09<00:33, 83.18it/s, est. speed input: 149295.00 toks/s, output: 145.80 toks/s]
Processed prompts:  33%|███▎      | 1363/4096 [00:09<00:33, 81.97it/s, est. speed input: 146393.97 toks/s, output: 142.96 toks/s]
Processed prompts:  34%|███▍      | 1395/4096 [00:09<00:33, 81.27it/s, est. speed input: 143766.92 toks/s, output: 140.40 toks/s]
Processed prompts:  35%|███▍      | 1427/4096 [00:10<00:33, 80.71it/s, est. speed input: 141330.84 toks/s, output: 138.02 toks/s]
Processed prompts:  36%|███▌      | 1459/4096 [00:10<00:32, 80.35it/s, est. speed input: 139084.83 toks/s, output: 135.82 toks/s]
Processed prompts:  36%|███▋      | 1491/4096 [00:11<00:32, 79.97it/s, est. speed input: 136975.80 toks/s, output: 133.76 toks/s]
Processed prompts:  37%|███▋      | 1523/4096 [00:11<00:32, 79.90it/s, est. speed input: 135053.14 toks/s, output: 131.89 toks/s]
Processed prompts:  38%|███▊      | 1555/4096 [00:11<00:31, 79.79it/s, est. speed input: 133247.16 toks/s, output: 130.12 toks/s]
Processed prompts:  39%|███▊      | 1587/4096 [00:12<00:31, 79.68it/s, est. speed input: 131553.98 toks/s, output: 128.47 toks/s]
Processed prompts:  40%|███▉      | 1619/4096 [00:12<00:31, 79.69it/s, est. speed input: 129981.98 toks/s, output: 126.94 toks/s]
Processed prompts:  40%|████      | 1651/4096 [00:13<00:30, 79.61it/s, est. speed input: 128492.44 toks/s, output: 125.48 toks/s]
Processed prompts:  41%|████      | 1683/4096 [00:13<00:30, 79.60it/s, est. speed input: 127098.60 toks/s, output: 124.12 toks/s]
Processed prompts:  42%|████▏     | 1715/4096 [00:13<00:29, 79.43it/s, est. speed input: 125760.17 toks/s, output: 122.81 toks/s]
Processed prompts:  43%|████▎     | 1747/4096 [00:14<00:29, 79.38it/s, est. speed input: 124506.77 toks/s, output: 121.59 toks/s]
Processed prompts:  43%|████▎     | 1779/4096 [00:14<00:29, 79.36it/s, est. speed input: 123324.91 toks/s, output: 120.43 toks/s]
Processed prompts:  44%|████▍     | 1811/4096 [00:15<00:28, 79.37it/s, est. speed input: 122207.89 toks/s, output: 119.34 toks/s]
Processed prompts:  45%|████▍     | 1843/4096 [00:15<00:28, 79.41it/s, est. speed input: 121153.68 toks/s, output: 118.31 toks/s]
Processed prompts:  46%|████▌     | 1875/4096 [00:15<00:27, 79.68it/s, est. speed input: 120183.25 toks/s, output: 117.37 toks/s]
Processed prompts:  47%|████▋     | 1907/4096 [00:16<00:27, 79.51it/s, est. speed input: 119216.82 toks/s, output: 116.42 toks/s]
Processed prompts:  47%|████▋     | 1939/4096 [00:16<00:26, 80.04it/s, est. speed input: 118373.04 toks/s, output: 115.60 toks/s]
Processed prompts:  48%|████▊     | 1971/4096 [00:17<00:26, 79.85it/s, est. speed input: 117503.64 toks/s, output: 114.75 toks/s]
Processed prompts:  49%|████▉     | 2003/4096 [00:17<00:26, 79.69it/s, est. speed input: 116670.62 toks/s, output: 113.94 toks/s]
Processed prompts:  50%|████▉     | 2035/4096 [00:17<00:25, 79.46it/s, est. speed input: 115862.72 toks/s, output: 113.15 toks/s]
Processed prompts:  50%|█████     | 2067/4096 [00:18<00:25, 79.39it/s, est. speed input: 115099.47 toks/s, output: 112.40 toks/s]
Processed prompts:  51%|█████     | 2099/4096 [00:18<00:25, 79.29it/s, est. speed input: 114364.28 toks/s, output: 111.68 toks/s]
Processed prompts:  52%|█████▏    | 2131/4096 [00:19<00:24, 79.32it/s, est. speed input: 113670.44 toks/s, output: 111.01 toks/s]
Processed prompts:  53%|█████▎    | 2163/4096 [00:19<00:24, 79.20it/s, est. speed input: 112990.84 toks/s, output: 110.34 toks/s]
Processed prompts:  54%|█████▎    | 2195/4096 [00:20<00:24, 79.15it/s, est. speed input: 112341.47 toks/s, output: 109.71 toks/s]
Processed prompts:  54%|█████▍    | 2227/4096 [00:20<00:23, 80.58it/s, est. speed input: 111853.29 toks/s, output: 109.23 toks/s]
Processed prompts:  55%|█████▌    | 2259/4096 [00:20<00:22, 80.11it/s, est. speed input: 111251.28 toks/s, output: 108.64 toks/s]
Processed prompts:  56%|█████▌    | 2291/4096 [00:21<00:22, 80.41it/s, est. speed input: 110726.55 toks/s, output: 108.13 toks/s]
Processed prompts:  57%|█████▋    | 2323/4096 [00:21<00:22, 80.55it/s, est. speed input: 110214.37 toks/s, output: 107.63 toks/s]
Processed prompts:  57%|█████▋    | 2355/4096 [00:21<00:21, 80.03it/s, est. speed input: 109670.82 toks/s, output: 107.10 toks/s]
Processed prompts:  58%|█████▊    | 2387/4096 [00:22<00:21, 79.79it/s, est. speed input: 109155.80 toks/s, output: 106.60 toks/s]
Processed prompts:  59%|█████▉    | 2419/4096 [00:22<00:21, 79.63it/s, est. speed input: 108660.54 toks/s, output: 106.11 toks/s]
Processed prompts:  60%|█████▉    | 2451/4096 [00:23<00:20, 79.47it/s, est. speed input: 108178.25 toks/s, output: 105.64 toks/s]
Processed prompts:  61%|██████    | 2483/4096 [00:23<00:20, 79.85it/s, est. speed input: 107749.91 toks/s, output: 105.22 toks/s]
Processed prompts:  61%|██████▏   | 2515/4096 [00:24<00:19, 79.61it/s, est. speed input: 107297.52 toks/s, output: 104.78 toks/s]
Processed prompts:  62%|██████▏   | 2547/4096 [00:24<00:19, 79.35it/s, est. speed input: 106853.79 toks/s, output: 104.35 toks/s]
Processed prompts:  63%|██████▎   | 2579/4096 [00:24<00:19, 79.84it/s, est. speed input: 106473.36 toks/s, output: 103.98 toks/s]
Processed prompts:  64%|██████▎   | 2611/4096 [00:25<00:18, 79.54it/s, est. speed input: 106059.27 toks/s, output: 103.57 toks/s]
Processed prompts:  65%|██████▍   | 2643/4096 [00:25<00:18, 79.33it/s, est. speed input: 105657.57 toks/s, output: 103.18 toks/s]
Processed prompts:  65%|██████▌   | 2675/4096 [00:26<00:17, 79.34it/s, est. speed input: 105279.59 toks/s, output: 102.81 toks/s]
Processed prompts:  66%|██████▌   | 2707/4096 [00:26<00:17, 79.23it/s, est. speed input: 104905.09 toks/s, output: 102.45 toks/s]
Processed prompts:  67%|██████▋   | 2739/4096 [00:26<00:17, 79.10it/s, est. speed input: 104538.84 toks/s, output: 102.09 toks/s]
Processed prompts:  68%|██████▊   | 2771/4096 [00:27<00:16, 78.99it/s, est. speed input: 104182.26 toks/s, output: 101.74 toks/s]
Processed prompts:  68%|██████▊   | 2803/4096 [00:27<00:16, 79.07it/s, est. speed input: 103845.71 toks/s, output: 101.41 toks/s]
Processed prompts:  69%|██████▉   | 2835/4096 [00:28<00:15, 78.89it/s, est. speed input: 103503.97 toks/s, output: 101.08 toks/s]
Processed prompts:  70%|██████▉   | 2867/4096 [00:28<00:15, 78.99it/s, est. speed input: 103186.20 toks/s, output: 100.77 toks/s]
Processed prompts:  71%|███████   | 2899/4096 [00:28<00:15, 78.99it/s, est. speed input: 102873.27 toks/s, output: 100.46 toks/s]
Processed prompts:  72%|███████▏  | 2931/4096 [00:29<00:14, 78.95it/s, est. speed input: 102566.21 toks/s, output: 100.16 toks/s]
Processed prompts:  72%|███████▏  | 2963/4096 [00:29<00:14, 78.86it/s, est. speed input: 102264.40 toks/s, output: 99.87 toks/s] 
Processed prompts:  73%|███████▎  | 2995/4096 [00:30<00:13, 78.97it/s, est. speed input: 101980.56 toks/s, output: 99.59 toks/s]
Processed prompts:  74%|███████▍  | 3027/4096 [00:30<00:13, 79.03it/s, est. speed input: 101703.34 toks/s, output: 99.32 toks/s]
Processed prompts:  75%|███████▍  | 3059/4096 [00:30<00:13, 78.95it/s, est. speed input: 101426.37 toks/s, output: 99.05 toks/s]
Processed prompts:  75%|███████▌  | 3091/4096 [00:31<00:12, 78.94it/s, est. speed input: 101159.39 toks/s, output: 98.79 toks/s]
Processed prompts:  76%|███████▌  | 3123/4096 [00:31<00:12, 79.44it/s, est. speed input: 100926.43 toks/s, output: 98.56 toks/s]
Processed prompts:  77%|███████▋  | 3155/4096 [00:32<00:11, 79.34it/s, est. speed input: 100675.08 toks/s, output: 98.32 toks/s]
Processed prompts:  78%|███████▊  | 3187/4096 [00:32<00:11, 79.25it/s, est. speed input: 100429.38 toks/s, output: 98.08 toks/s]
Processed prompts:  79%|███████▊  | 3219/4096 [00:32<00:11, 79.12it/s, est. speed input: 100185.95 toks/s, output: 97.84 toks/s]
Processed prompts:  79%|███████▉  | 3251/4096 [00:33<00:10, 79.04it/s, est. speed input: 99949.37 toks/s, output: 97.61 toks/s] 
Processed prompts:  80%|████████  | 3283/4096 [00:33<00:10, 79.01it/s, est. speed input: 99719.46 toks/s, output: 97.38 toks/s]
Processed prompts:  81%|████████  | 3315/4096 [00:34<00:09, 79.03it/s, est. speed input: 99496.97 toks/s, output: 97.16 toks/s]
Processed prompts:  82%|████████▏ | 3347/4096 [00:34<00:09, 78.93it/s, est. speed input: 99274.07 toks/s, output: 96.95 toks/s]
Processed prompts:  82%|████████▏ | 3379/4096 [00:34<00:09, 78.90it/s, est. speed input: 99058.63 toks/s, output: 96.74 toks/s]
Processed prompts:  83%|████████▎ | 3411/4096 [00:35<00:08, 78.89it/s, est. speed input: 98848.54 toks/s, output: 96.53 toks/s]
Processed prompts:  84%|████████▍ | 3443/4096 [00:35<00:08, 78.87it/s, est. speed input: 98642.49 toks/s, output: 96.33 toks/s]
Processed prompts:  85%|████████▍ | 3475/4096 [00:36<00:07, 78.89it/s, est. speed input: 98442.61 toks/s, output: 96.14 toks/s]
Processed prompts:  86%|████████▌ | 3507/4096 [00:36<00:07, 78.84it/s, est. speed input: 98244.24 toks/s, output: 95.94 toks/s]
Processed prompts:  86%|████████▋ | 3539/4096 [00:36<00:07, 78.91it/s, est. speed input: 98055.24 toks/s, output: 95.76 toks/s]
Processed prompts:  87%|████████▋ | 3571/4096 [00:37<00:06, 78.92it/s, est. speed input: 97868.54 toks/s, output: 95.57 toks/s]
Processed prompts:  88%|████████▊ | 3603/4096 [00:37<00:06, 78.84it/s, est. speed input: 97681.88 toks/s, output: 95.39 toks/s]
Processed prompts:  89%|████████▊ | 3635/4096 [00:38<00:05, 78.89it/s, est. speed input: 97503.80 toks/s, output: 95.22 toks/s]
Processed prompts:  90%|████████▉ | 3667/4096 [00:38<00:05, 78.80it/s, est. speed input: 97324.29 toks/s, output: 95.04 toks/s]
Processed prompts:  90%|█████████ | 3699/4096 [00:38<00:05, 78.73it/s, est. speed input: 97147.79 toks/s, output: 94.87 toks/s]
Processed prompts:  91%|█████████ | 3731/4096 [00:39<00:04, 79.30it/s, est. speed input: 97001.21 toks/s, output: 94.73 toks/s]
Processed prompts:  92%|█████████▏| 3763/4096 [00:39<00:04, 79.09it/s, est. speed input: 96832.48 toks/s, output: 94.56 toks/s]
Processed prompts:  93%|█████████▎| 3795/4096 [00:40<00:03, 79.13it/s, est. speed input: 96674.67 toks/s, output: 94.41 toks/s]
Processed prompts:  93%|█████████▎| 3827/4096 [00:40<00:03, 78.96it/s, est. speed input: 96511.82 toks/s, output: 94.25 toks/s]
Processed prompts:  94%|█████████▍| 3859/4096 [00:41<00:03, 78.91it/s, est. speed input: 96355.07 toks/s, output: 94.10 toks/s]
Processed prompts:  95%|█████████▍| 3891/4096 [00:41<00:02, 78.86it/s, est. speed input: 96201.00 toks/s, output: 93.95 toks/s]
Processed prompts:  96%|█████████▌| 3923/4096 [00:41<00:02, 78.75it/s, est. speed input: 96046.81 toks/s, output: 93.80 toks/s]
Processed prompts:  97%|█████████▋| 3955/4096 [00:42<00:01, 78.73it/s, est. speed input: 95897.75 toks/s, output: 93.65 toks/s]
Processed prompts:  97%|█████████▋| 3987/4096 [00:42<00:01, 78.73it/s, est. speed input: 95751.97 toks/s, output: 93.51 toks/s]
Processed prompts:  98%|█████████▊| 4019/4096 [00:43<00:00, 79.26it/s, est. speed input: 95629.29 toks/s, output: 93.39 toks/s]
Processed prompts:  99%|█████████▉| 4051/4096 [00:43<00:00, 79.22it/s, est. speed input: 95493.23 toks/s, output: 93.26 toks/s]
Processed prompts: 100%|█████████▉| 4083/4096 [00:43<00:00, 94.98it/s, est. speed input: 95849.39 toks/s, output: 93.60 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [00:43<00:00, 94.98it/s, est. speed input: 96153.37 toks/s, output: 93.90 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [00:43<00:00, 93.90it/s, est. speed input: 96153.37 toks/s, output: 93.90 toks/s]
[rank0]:[W126 09:50:21.981400780 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=65536 ==========
Time: 2026-01-26 09:50:24
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=8192, max_num_seqs=64
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 8192 --max-num-seqs 64 --max-model-len 1025 --max-num-batched-tokens 65536 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-3B-INT8_M65536.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 09:51:04 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1168024) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1168024) WARNING 01-26 09:51:21 [backends.py:609] Failed to read file <frozen os>
Throughput: 79.79 requests/s, 81784.86 total tokens/s, 79.79 output tokens/s
Total num prompt tokens:  8388608
Total num output tokens:  8192

STDERR:
[2026-01-26 09:51:03] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 09:51:04] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-26 09:51:04] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-26 09:51:04] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:51:04] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:51:04] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:51:04] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:51:04] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:51:04] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-26 09:51:04] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 09:51:04] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 09:51:04] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 09:51:04] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 09:51:04] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 09:51:10] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 09:51:11] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-26 09:51:11] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-26 09:51:11] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:51:11] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:51:11] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:51:11] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:51:11] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-26 09:51:11] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-26 09:51:11] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 09:51:11] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 09:51:11] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 09:51:11] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 09:51:11] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1168024) [2026-01-26 09:51:13] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1168024) [2026-01-26 09:51:13] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1168024) [2026-01-26 09:51:13] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1168024) [2026-01-26 09:51:13] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1168024) [2026-01-26 09:51:13] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-3B-INT8
(EngineCore_DP0 pid=1168024) [2026-01-26 09:51:13] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1168024) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1168024) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.87it/s]
(EngineCore_DP0 pid=1168024) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.87it/s]
(EngineCore_DP0 pid=1168024) 
(EngineCore_DP0 pid=1168024) [2026-01-26 09:51:15] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 4608] -> 1D uint8
(EngineCore_DP0 pid=1168024) [2026-01-26 09:51:15] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 14745600 bytes
(EngineCore_DP0 pid=1168024) [2026-01-26 09:51:15] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 4608] -> 1D uint8
(EngineCore_DP0 pid=1168024) [2026-01-26 09:51:15] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 8847360 bytes
(EngineCore_DP0 pid=1168024) [2026-01-26 09:51:15] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 4608] -> 1D uint8
(EngineCore_DP0 pid=1168024) [2026-01-26 09:51:15] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 47185920 bytes
(EngineCore_DP0 pid=1168024) [2026-01-26 09:51:15] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 12288] -> 1D uint8
(EngineCore_DP0 pid=1168024) [2026-01-26 09:51:15] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 23592960 bytes
(EngineCore_DP0 pid=1168024) [rank0]:W0126 09:51:27.208000 1168024 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=1168024) [rank0]:W0126 09:51:27.291000 1168024 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=1168024) [rank0]:W0126 09:51:28.144000 1168024 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=1168024) [rank0]:W0126 09:51:28.268000 1168024 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=1168024) 2026-01-26 09:51:31,952 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1168024) 2026-01-26 09:51:31,989 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1168024) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/19 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   5%|▌         | 1/19 [00:00<00:08,  2.14it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  11%|█         | 2/19 [00:00<00:08,  2.11it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  16%|█▌        | 3/19 [00:01<00:05,  3.07it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  21%|██        | 4/19 [00:01<00:05,  2.62it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  32%|███▏      | 6/19 [00:01<00:02,  4.78it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  42%|████▏     | 8/19 [00:01<00:01,  7.06it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  53%|█████▎    | 10/19 [00:02<00:01,  7.39it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  63%|██████▎   | 12/19 [00:02<00:00,  7.96it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  74%|███████▎  | 14/19 [00:02<00:00,  8.85it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  84%|████████▍ | 16/19 [00:02<00:00,  9.07it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  95%|█████████▍| 18/19 [00:03<00:00,  5.99it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 19/19 [00:03<00:00,  6.42it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 19/19 [00:03<00:00,  5.73it/s]
(EngineCore_DP0 pid=1168024) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):   9%|▉         | 1/11 [00:00<00:01,  6.43it/s]
Capturing CUDA graphs (decode, FULL):  18%|█▊        | 2/11 [00:00<00:01,  7.73it/s]
Capturing CUDA graphs (decode, FULL):  36%|███▋      | 4/11 [00:00<00:00, 11.88it/s]
Capturing CUDA graphs (decode, FULL):  55%|█████▍    | 6/11 [00:00<00:00, 11.10it/s]
Capturing CUDA graphs (decode, FULL):  73%|███████▎  | 8/11 [00:00<00:00, 12.84it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 11/11 [00:00<00:00, 15.45it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 11/11 [00:00<00:00, 13.05it/s]

Adding requests:   0%|          | 0/8192 [00:00<?, ?it/s]
Adding requests:   0%|          | 38/8192 [00:00<00:21, 375.72it/s]
Adding requests:   1%|          | 91/8192 [00:00<00:17, 462.88it/s]
Adding requests:   2%|▏         | 141/8192 [00:00<00:16, 478.88it/s]
Adding requests:   2%|▏         | 192/8192 [00:00<00:16, 487.24it/s]
Adding requests:   3%|▎         | 245/8192 [00:00<00:15, 499.62it/s]
Adding requests:   4%|▎         | 297/8192 [00:00<00:15, 503.28it/s]
Adding requests:   4%|▍         | 348/8192 [00:00<00:15, 502.13it/s]
Adding requests:   5%|▍         | 401/8192 [00:00<00:15, 508.09it/s]
Adding requests:   6%|▌         | 453/8192 [00:00<00:15, 508.42it/s]
Adding requests:   6%|▌         | 504/8192 [00:01<00:15, 508.17it/s]
Adding requests:   7%|▋         | 555/8192 [00:01<00:15, 503.53it/s]
Adding requests:   7%|▋         | 606/8192 [00:01<00:15, 499.13it/s]
Adding requests:   8%|▊         | 659/8192 [00:01<00:14, 508.17it/s]
Adding requests:   9%|▊         | 713/8192 [00:01<00:14, 516.34it/s]
Adding requests:   9%|▉         | 765/8192 [00:01<00:14, 515.54it/s]
Adding requests:  10%|▉         | 817/8192 [00:01<00:14, 506.55it/s]
Adding requests:  11%|█         | 869/8192 [00:01<00:14, 509.63it/s]
Adding requests:  11%|█▏        | 923/8192 [00:01<00:14, 516.08it/s]
Adding requests:  12%|█▏        | 976/8192 [00:01<00:13, 519.25it/s]
Adding requests:  13%|█▎        | 1029/8192 [00:02<00:13, 520.72it/s]
Adding requests:  13%|█▎        | 1082/8192 [00:02<00:13, 516.68it/s]
Adding requests:  14%|█▍        | 1134/8192 [00:02<00:13, 513.34it/s]
Adding requests:  15%|█▍        | 1189/8192 [00:02<00:13, 522.72it/s]
Adding requests:  15%|█▌        | 1242/8192 [00:02<00:13, 522.39it/s]
Adding requests:  16%|█▌        | 1295/8192 [00:02<00:13, 519.26it/s]
Adding requests:  16%|█▋        | 1348/8192 [00:02<00:13, 521.72it/s]
Adding requests:  17%|█▋        | 1402/8192 [00:02<00:12, 525.16it/s]
Adding requests:  18%|█▊        | 1455/8192 [00:02<00:12, 524.21it/s]
Adding requests:  18%|█▊        | 1509/8192 [00:02<00:12, 527.20it/s]
Adding requests:  19%|█▉        | 1562/8192 [00:03<00:12, 526.82it/s]
Adding requests:  20%|█▉        | 1617/8192 [00:03<00:12, 530.99it/s]
Adding requests:  20%|██        | 1671/8192 [00:03<00:12, 527.94it/s]
Adding requests:  21%|██        | 1726/8192 [00:03<00:12, 532.63it/s]
Adding requests:  22%|██▏       | 1780/8192 [00:03<00:12, 513.43it/s]
Adding requests:  22%|██▏       | 1834/8192 [00:03<00:12, 518.09it/s]
Adding requests:  23%|██▎       | 1887/8192 [00:03<00:12, 519.88it/s]
Adding requests:  24%|██▎       | 1940/8192 [00:03<00:12, 519.77it/s]
Adding requests:  24%|██▍       | 1993/8192 [00:03<00:11, 519.72it/s]
Adding requests:  25%|██▍       | 2047/8192 [00:03<00:11, 524.54it/s]
Adding requests:  26%|██▌       | 2101/8192 [00:04<00:11, 527.66it/s]
Adding requests:  26%|██▋       | 2154/8192 [00:04<00:11, 521.26it/s]
Adding requests:  27%|██▋       | 2207/8192 [00:04<00:11, 517.21it/s]
Adding requests:  28%|██▊       | 2261/8192 [00:04<00:11, 521.45it/s]
Adding requests:  28%|██▊       | 2315/8192 [00:04<00:11, 524.45it/s]
Adding requests:  29%|██▉       | 2368/8192 [00:04<00:11, 521.97it/s]
Adding requests:  30%|██▉       | 2421/8192 [00:04<00:11, 523.48it/s]
Adding requests:  30%|███       | 2474/8192 [00:04<00:10, 523.19it/s]
Adding requests:  31%|███       | 2527/8192 [00:04<00:10, 521.55it/s]
Adding requests:  32%|███▏      | 2582/8192 [00:05<00:10, 527.85it/s]
Adding requests:  32%|███▏      | 2635/8192 [00:05<00:10, 525.24it/s]
Adding requests:  33%|███▎      | 2688/8192 [00:05<00:10, 526.01it/s]
Adding requests:  33%|███▎      | 2741/8192 [00:05<00:10, 521.80it/s]
Adding requests:  34%|███▍      | 2794/8192 [00:05<00:10, 520.12it/s]
Adding requests:  35%|███▍      | 2847/8192 [00:05<00:10, 521.96it/s]
Adding requests:  35%|███▌      | 2900/8192 [00:05<00:10, 523.70it/s]
Adding requests:  36%|███▌      | 2953/8192 [00:05<00:10, 519.65it/s]
Adding requests:  37%|███▋      | 3006/8192 [00:05<00:09, 520.64it/s]
Adding requests:  37%|███▋      | 3059/8192 [00:05<00:09, 521.03it/s]
Adding requests:  38%|███▊      | 3112/8192 [00:06<00:10, 504.92it/s]
Adding requests:  39%|███▊      | 3165/8192 [00:06<00:09, 510.39it/s]
Adding requests:  39%|███▉      | 3218/8192 [00:06<00:09, 512.82it/s]
Adding requests:  40%|███▉      | 3272/8192 [00:06<00:09, 519.24it/s]
Adding requests:  41%|████      | 3324/8192 [00:06<00:09, 518.93it/s]
Adding requests:  41%|████      | 3379/8192 [00:06<00:09, 526.76it/s]
Adding requests:  42%|████▏     | 3432/8192 [00:06<00:09, 527.44it/s]
Adding requests:  43%|████▎     | 3485/8192 [00:06<00:09, 517.60it/s]
Adding requests:  43%|████▎     | 3537/8192 [00:06<00:08, 517.64it/s]
Adding requests:  44%|████▍     | 3590/8192 [00:06<00:08, 519.67it/s]
Adding requests:  44%|████▍     | 3642/8192 [00:07<00:08, 516.46it/s]
Adding requests:  45%|████▌     | 3696/8192 [00:07<00:08, 521.24it/s]
Adding requests:  46%|████▌     | 3749/8192 [00:07<00:08, 519.08it/s]
Adding requests:  46%|████▋     | 3804/8192 [00:07<00:08, 527.35it/s]
Adding requests:  47%|████▋     | 3859/8192 [00:07<00:08, 531.47it/s]
Adding requests:  48%|████▊     | 3913/8192 [00:07<00:08, 527.55it/s]
Adding requests:  48%|████▊     | 3966/8192 [00:07<00:08, 528.13it/s]
Adding requests:  49%|████▉     | 4020/8192 [00:07<00:07, 528.76it/s]
Adding requests:  50%|████▉     | 4073/8192 [00:07<00:07, 521.18it/s]
Adding requests:  50%|█████     | 4127/8192 [00:07<00:07, 525.74it/s]
Adding requests:  51%|█████     | 4181/8192 [00:08<00:07, 528.30it/s]
Adding requests:  52%|█████▏    | 4234/8192 [00:08<00:07, 526.60it/s]
Adding requests:  52%|█████▏    | 4287/8192 [00:08<00:07, 525.62it/s]
Adding requests:  53%|█████▎    | 4341/8192 [00:08<00:07, 529.61it/s]
Adding requests:  54%|█████▎    | 4396/8192 [00:08<00:07, 532.80it/s]
Adding requests:  54%|█████▍    | 4450/8192 [00:08<00:07, 516.56it/s]
Adding requests:  55%|█████▍    | 4502/8192 [00:08<00:07, 515.80it/s]
Adding requests:  56%|█████▌    | 4554/8192 [00:08<00:07, 515.19it/s]
Adding requests:  56%|█████▋    | 4609/8192 [00:08<00:06, 520.60it/s]
Adding requests:  57%|█████▋    | 4662/8192 [00:08<00:06, 520.70it/s]
Adding requests:  58%|█████▊    | 4715/8192 [00:09<00:06, 520.66it/s]
Adding requests:  58%|█████▊    | 4769/8192 [00:09<00:06, 523.86it/s]
Adding requests:  59%|█████▉    | 4822/8192 [00:09<00:06, 523.16it/s]
Adding requests:  60%|█████▉    | 4875/8192 [00:09<00:06, 521.47it/s]
Adding requests:  60%|██████    | 4929/8192 [00:09<00:06, 524.84it/s]
Adding requests:  61%|██████    | 4982/8192 [00:09<00:06, 523.13it/s]
Adding requests:  61%|██████▏   | 5037/8192 [00:09<00:05, 527.75it/s]
Adding requests:  62%|██████▏   | 5092/8192 [00:09<00:05, 532.64it/s]
Adding requests:  63%|██████▎   | 5146/8192 [00:09<00:05, 528.39it/s]
Adding requests:  63%|██████▎   | 5199/8192 [00:10<00:05, 527.77it/s]
Adding requests:  64%|██████▍   | 5252/8192 [00:10<00:05, 522.16it/s]
Adding requests:  65%|██████▍   | 5306/8192 [00:10<00:05, 526.47it/s]
Adding requests:  65%|██████▌   | 5359/8192 [00:10<00:05, 526.86it/s]
Adding requests:  66%|██████▌   | 5412/8192 [00:10<00:05, 526.88it/s]
Adding requests:  67%|██████▋   | 5465/8192 [00:10<00:05, 523.34it/s]
Adding requests:  67%|██████▋   | 5518/8192 [00:10<00:05, 518.23it/s]
Adding requests:  68%|██████▊   | 5570/8192 [00:10<00:05, 516.80it/s]
Adding requests:  69%|██████▊   | 5622/8192 [00:10<00:04, 516.57it/s]
Adding requests:  69%|██████▉   | 5674/8192 [00:10<00:04, 516.51it/s]
Adding requests:  70%|██████▉   | 5728/8192 [00:11<00:04, 522.04it/s]
Adding requests:  71%|███████   | 5781/8192 [00:11<00:04, 507.43it/s]
Adding requests:  71%|███████   | 5833/8192 [00:11<00:04, 508.21it/s]
Adding requests:  72%|███████▏  | 5888/8192 [00:11<00:04, 517.46it/s]
Adding requests:  73%|███████▎  | 5942/8192 [00:11<00:04, 521.36it/s]
Adding requests:  73%|███████▎  | 5996/8192 [00:11<00:04, 525.01it/s]
Adding requests:  74%|███████▍  | 6050/8192 [00:11<00:04, 527.49it/s]
Adding requests:  74%|███████▍  | 6103/8192 [00:11<00:03, 524.06it/s]
Adding requests:  75%|███████▌  | 6156/8192 [00:11<00:03, 523.48it/s]
Adding requests:  76%|███████▌  | 6210/8192 [00:11<00:03, 528.32it/s]
Adding requests:  76%|███████▋  | 6266/8192 [00:12<00:03, 535.99it/s]
Adding requests:  77%|███████▋  | 6321/8192 [00:12<00:03, 538.89it/s]
Adding requests:  78%|███████▊  | 6375/8192 [00:12<00:03, 536.71it/s]
Adding requests:  79%|███████▊  | 6431/8192 [00:12<00:03, 541.34it/s]
Adding requests:  79%|███████▉  | 6486/8192 [00:12<00:03, 539.74it/s]
Adding requests:  80%|███████▉  | 6541/8192 [00:12<00:03, 541.64it/s]
Adding requests:  81%|████████  | 6596/8192 [00:12<00:02, 535.21it/s]
Adding requests:  81%|████████  | 6650/8192 [00:12<00:02, 535.62it/s]
Adding requests:  82%|████████▏ | 6704/8192 [00:12<00:02, 532.77it/s]
Adding requests:  82%|████████▏ | 6758/8192 [00:12<00:02, 530.64it/s]
Adding requests:  83%|████████▎ | 6812/8192 [00:13<00:02, 532.44it/s]
Adding requests:  84%|████████▍ | 6867/8192 [00:13<00:02, 537.28it/s]
Adding requests:  84%|████████▍ | 6921/8192 [00:13<00:02, 535.71it/s]
Adding requests:  85%|████████▌ | 6976/8192 [00:13<00:02, 539.78it/s]
Adding requests:  86%|████████▌ | 7030/8192 [00:13<00:02, 530.61it/s]
Adding requests:  86%|████████▋ | 7084/8192 [00:13<00:02, 530.70it/s]
Adding requests:  87%|████████▋ | 7138/8192 [00:13<00:02, 512.63it/s]
Adding requests:  88%|████████▊ | 7191/8192 [00:13<00:01, 515.32it/s]
Adding requests:  88%|████████▊ | 7244/8192 [00:13<00:01, 519.17it/s]
Adding requests:  89%|████████▉ | 7298/8192 [00:13<00:01, 524.69it/s]
Adding requests:  90%|████████▉ | 7351/8192 [00:14<00:01, 523.36it/s]
Adding requests:  90%|█████████ | 7406/8192 [00:14<00:01, 528.12it/s]
Adding requests:  91%|█████████ | 7461/8192 [00:14<00:01, 534.22it/s]
Adding requests:  92%|█████████▏| 7515/8192 [00:14<00:01, 534.10it/s]
Adding requests:  92%|█████████▏| 7569/8192 [00:14<00:01, 532.19it/s]
Adding requests:  93%|█████████▎| 7623/8192 [00:14<00:01, 527.06it/s]
Adding requests:  94%|█████████▎| 7678/8192 [00:14<00:00, 532.07it/s]
Adding requests:  94%|█████████▍| 7732/8192 [00:14<00:00, 530.62it/s]
Adding requests:  95%|█████████▌| 7786/8192 [00:14<00:00, 526.96it/s]
Adding requests:  96%|█████████▌| 7840/8192 [00:15<00:00, 529.23it/s]
Adding requests:  96%|█████████▋| 7893/8192 [00:15<00:00, 529.05it/s]
Adding requests:  97%|█████████▋| 7946/8192 [00:15<00:00, 522.95it/s]
Adding requests:  98%|█████████▊| 7999/8192 [00:15<00:00, 522.23it/s]
Adding requests:  98%|█████████▊| 8052/8192 [00:15<00:00, 518.93it/s]
Adding requests:  99%|█████████▉| 8106/8192 [00:15<00:00, 525.12it/s]
Adding requests: 100%|█████████▉| 8159/8192 [00:15<00:00, 525.55it/s]
Adding requests: 100%|██████████| 8192/8192 [00:15<00:00, 522.11it/s]

Processed prompts:   0%|          | 0/8192 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  15%|█▌        | 1244/8192 [00:00<00:03, 1771.23it/s, est. speed input: 1813868.84 toks/s, output: 1771.27 toks/s]
Processed prompts:  17%|█▋        | 1422/8192 [00:02<00:13, 501.73it/s, est. speed input: 632812.22 toks/s, output: 617.98 toks/s]   
Processed prompts:  18%|█▊        | 1502/8192 [00:03<00:25, 266.37it/s, est. speed input: 394953.30 toks/s, output: 385.70 toks/s]
Processed prompts:  19%|█▉        | 1564/8192 [00:04<00:30, 215.28it/s, est. speed input: 341482.08 toks/s, output: 333.48 toks/s]
Processed prompts:  20%|█▉        | 1628/8192 [00:05<00:36, 177.48it/s, est. speed input: 303756.28 toks/s, output: 296.63 toks/s]
Processed prompts:  21%|██        | 1692/8192 [00:06<00:43, 149.81it/s, est. speed input: 275706.81 toks/s, output: 269.24 toks/s]
Processed prompts:  21%|██▏       | 1756/8192 [00:07<00:49, 129.68it/s, est. speed input: 253931.22 toks/s, output: 247.98 toks/s]
Processed prompts:  22%|██▏       | 1820/8192 [00:07<00:55, 115.65it/s, est. speed input: 236855.22 toks/s, output: 231.30 toks/s]
Processed prompts:  23%|██▎       | 1884/8192 [00:08<00:59, 105.15it/s, est. speed input: 222597.39 toks/s, output: 217.38 toks/s]
Processed prompts:  24%|██▍       | 1948/8192 [00:09<01:03, 98.12it/s, est. speed input: 210985.60 toks/s, output: 206.04 toks/s] 
Processed prompts:  25%|██▍       | 2012/8192 [00:10<01:06, 92.79it/s, est. speed input: 200970.41 toks/s, output: 196.26 toks/s]
Processed prompts:  25%|██▌       | 2076/8192 [00:11<01:08, 89.03it/s, est. speed input: 192390.98 toks/s, output: 187.88 toks/s]
Processed prompts:  26%|██▌       | 2140/8192 [00:11<01:10, 86.33it/s, est. speed input: 184934.51 toks/s, output: 180.60 toks/s]
Processed prompts:  27%|██▋       | 2204/8192 [00:12<01:10, 85.21it/s, est. speed input: 178765.24 toks/s, output: 174.57 toks/s]
Processed prompts:  28%|██▊       | 2268/8192 [00:13<01:10, 83.97it/s, est. speed input: 173128.39 toks/s, output: 169.07 toks/s]
Processed prompts:  28%|██▊       | 2332/8192 [00:14<01:10, 83.13it/s, est. speed input: 168132.51 toks/s, output: 164.19 toks/s]
Processed prompts:  29%|██▉       | 2396/8192 [00:15<01:10, 82.17it/s, est. speed input: 163531.61 toks/s, output: 159.70 toks/s]
Processed prompts:  30%|███       | 2460/8192 [00:15<01:10, 81.84it/s, est. speed input: 159505.40 toks/s, output: 155.77 toks/s]
Processed prompts:  31%|███       | 2524/8192 [00:16<01:09, 81.27it/s, est. speed input: 155761.71 toks/s, output: 152.11 toks/s]
Processed prompts:  32%|███▏      | 2588/8192 [00:17<01:08, 81.22it/s, est. speed input: 152460.57 toks/s, output: 148.89 toks/s]
Processed prompts:  32%|███▏      | 2652/8192 [00:18<01:08, 80.85it/s, est. speed input: 149355.29 toks/s, output: 145.85 toks/s]
Processed prompts:  33%|███▎      | 2716/8192 [00:18<01:08, 80.52it/s, est. speed input: 146496.08 toks/s, output: 143.06 toks/s]
Processed prompts:  34%|███▍      | 2780/8192 [00:19<01:07, 80.33it/s, est. speed input: 143876.51 toks/s, output: 140.50 toks/s]
Processed prompts:  35%|███▍      | 2844/8192 [00:20<01:06, 80.25it/s, est. speed input: 141473.43 toks/s, output: 138.16 toks/s]
Processed prompts:  35%|███▌      | 2908/8192 [00:21<01:05, 80.13it/s, est. speed input: 139236.24 toks/s, output: 135.97 toks/s]
Processed prompts:  36%|███▋      | 2972/8192 [00:22<01:05, 80.08it/s, est. speed input: 137166.15 toks/s, output: 133.95 toks/s]
Processed prompts:  37%|███▋      | 3036/8192 [00:22<01:04, 80.00it/s, est. speed input: 135233.08 toks/s, output: 132.06 toks/s]
Processed prompts:  38%|███▊      | 3100/8192 [00:23<01:03, 80.30it/s, est. speed input: 133496.11 toks/s, output: 130.37 toks/s]
Processed prompts:  39%|███▊      | 3164/8192 [00:24<01:02, 80.16it/s, est. speed input: 131808.55 toks/s, output: 128.72 toks/s]
Processed prompts:  39%|███▉      | 3228/8192 [00:25<01:01, 80.07it/s, est. speed input: 130229.17 toks/s, output: 127.18 toks/s]
Processed prompts:  40%|████      | 3292/8192 [00:26<01:01, 80.01it/s, est. speed input: 128747.07 toks/s, output: 125.73 toks/s]
Processed prompts:  41%|████      | 3356/8192 [00:26<01:00, 79.92it/s, est. speed input: 127345.05 toks/s, output: 124.36 toks/s]
Processed prompts:  42%|████▏     | 3420/8192 [00:27<00:59, 79.86it/s, est. speed input: 126023.75 toks/s, output: 123.07 toks/s]
Processed prompts:  43%|████▎     | 3484/8192 [00:28<00:58, 79.80it/s, est. speed input: 124775.20 toks/s, output: 121.85 toks/s]
Processed prompts:  43%|████▎     | 3548/8192 [00:29<00:58, 79.79it/s, est. speed input: 123599.03 toks/s, output: 120.70 toks/s]
Processed prompts:  44%|████▍     | 3612/8192 [00:30<00:57, 79.79it/s, est. speed input: 122485.88 toks/s, output: 119.61 toks/s]
Processed prompts:  45%|████▍     | 3676/8192 [00:30<00:56, 79.79it/s, est. speed input: 121431.01 toks/s, output: 118.58 toks/s]
Processed prompts:  46%|████▌     | 3740/8192 [00:31<00:55, 80.04it/s, est. speed input: 120460.46 toks/s, output: 117.64 toks/s]
Processed prompts:  46%|████▋     | 3804/8192 [00:32<00:54, 79.92it/s, est. speed input: 119501.60 toks/s, output: 116.70 toks/s]
Processed prompts:  47%|████▋     | 3868/8192 [00:33<00:54, 79.81it/s, est. speed input: 118585.07 toks/s, output: 115.81 toks/s]
Processed prompts:  48%|████▊     | 3932/8192 [00:34<00:53, 79.73it/s, est. speed input: 117711.74 toks/s, output: 114.95 toks/s]
Processed prompts:  49%|████▉     | 3996/8192 [00:34<00:52, 80.07it/s, est. speed input: 116922.16 toks/s, output: 114.18 toks/s]
Processed prompts:  50%|████▉     | 4060/8192 [00:35<00:51, 79.92it/s, est. speed input: 116125.94 toks/s, output: 113.40 toks/s]
Processed prompts:  50%|█████     | 4124/8192 [00:36<00:50, 79.81it/s, est. speed input: 115364.12 toks/s, output: 112.66 toks/s]
Processed prompts:  51%|█████     | 4188/8192 [00:37<00:50, 80.04it/s, est. speed input: 114666.64 toks/s, output: 111.98 toks/s]
Processed prompts:  52%|█████▏    | 4252/8192 [00:38<00:49, 80.25it/s, est. speed input: 114002.69 toks/s, output: 111.33 toks/s]
Processed prompts:  53%|█████▎    | 4316/8192 [00:38<00:48, 80.34it/s, est. speed input: 113360.42 toks/s, output: 110.70 toks/s]
Processed prompts:  53%|█████▎    | 4380/8192 [00:39<00:47, 80.09it/s, est. speed input: 112714.41 toks/s, output: 110.07 toks/s]
Processed prompts:  54%|█████▍    | 4444/8192 [00:40<00:46, 79.89it/s, est. speed input: 112091.79 toks/s, output: 109.46 toks/s]
Processed prompts:  55%|█████▌    | 4508/8192 [00:41<00:46, 79.76it/s, est. speed input: 111493.70 toks/s, output: 108.88 toks/s]
Processed prompts:  56%|█████▌    | 4572/8192 [00:42<00:45, 79.64it/s, est. speed input: 110916.67 toks/s, output: 108.32 toks/s]
Processed prompts:  57%|█████▋    | 4636/8192 [00:43<00:44, 79.61it/s, est. speed input: 110365.14 toks/s, output: 107.78 toks/s]
Processed prompts:  57%|█████▋    | 4700/8192 [00:43<00:43, 79.54it/s, est. speed input: 109830.20 toks/s, output: 107.26 toks/s]
Processed prompts:  58%|█████▊    | 4764/8192 [00:44<00:42, 79.85it/s, est. speed input: 109344.18 toks/s, output: 106.78 toks/s]
Processed prompts:  59%|█████▉    | 4828/8192 [00:45<00:41, 80.11it/s, est. speed input: 108878.34 toks/s, output: 106.33 toks/s]
Processed prompts:  60%|█████▉    | 4892/8192 [00:46<00:41, 79.83it/s, est. speed input: 108392.15 toks/s, output: 105.85 toks/s]
Processed prompts:  60%|██████    | 4956/8192 [00:47<00:40, 80.06it/s, est. speed input: 107955.15 toks/s, output: 105.42 toks/s]
Processed prompts:  61%|██████▏   | 5020/8192 [00:47<00:39, 79.90it/s, est. speed input: 107509.05 toks/s, output: 104.99 toks/s]
Processed prompts:  62%|██████▏   | 5084/8192 [00:48<00:38, 79.73it/s, est. speed input: 107073.23 toks/s, output: 104.56 toks/s]
Processed prompts:  63%|██████▎   | 5148/8192 [00:49<00:38, 79.60it/s, est. speed input: 106650.58 toks/s, output: 104.15 toks/s]
Processed prompts:  64%|██████▎   | 5212/8192 [00:50<00:37, 79.56it/s, est. speed input: 106245.43 toks/s, output: 103.76 toks/s]
Processed prompts:  64%|██████▍   | 5276/8192 [00:51<00:36, 79.55it/s, est. speed input: 105854.44 toks/s, output: 103.37 toks/s]
Processed prompts:  65%|██████▌   | 5340/8192 [00:51<00:35, 79.52it/s, est. speed input: 105473.83 toks/s, output: 103.00 toks/s]
Processed prompts:  66%|██████▌   | 5404/8192 [00:52<00:35, 79.50it/s, est. speed input: 105104.64 toks/s, output: 102.64 toks/s]
Processed prompts:  67%|██████▋   | 5468/8192 [00:53<00:34, 79.47it/s, est. speed input: 104745.80 toks/s, output: 102.29 toks/s]
Processed prompts:  68%|██████▊   | 5532/8192 [00:54<00:33, 79.81it/s, est. speed input: 104421.13 toks/s, output: 101.97 toks/s]
Processed prompts:  68%|██████▊   | 5596/8192 [00:55<00:32, 79.74it/s, est. speed input: 104085.73 toks/s, output: 101.65 toks/s]
Processed prompts:  69%|██████▉   | 5660/8192 [00:55<00:31, 79.61it/s, est. speed input: 103755.70 toks/s, output: 101.32 toks/s]
Processed prompts:  70%|██████▉   | 5724/8192 [00:56<00:31, 79.49it/s, est. speed input: 103432.64 toks/s, output: 101.01 toks/s]
Processed prompts:  71%|███████   | 5788/8192 [00:57<00:30, 79.45it/s, est. speed input: 103121.38 toks/s, output: 100.70 toks/s]
Processed prompts:  71%|███████▏  | 5852/8192 [00:58<00:29, 79.43it/s, est. speed input: 102819.36 toks/s, output: 100.41 toks/s]
Processed prompts:  72%|███████▏  | 5916/8192 [00:59<00:28, 79.42it/s, est. speed input: 102525.70 toks/s, output: 100.12 toks/s]
Processed prompts:  73%|███████▎  | 5980/8192 [00:59<00:27, 79.41it/s, est. speed input: 102239.97 toks/s, output: 99.84 toks/s] 
Processed prompts:  74%|███████▍  | 6044/8192 [01:00<00:27, 79.36it/s, est. speed input: 101959.64 toks/s, output: 99.57 toks/s]
Processed prompts:  75%|███████▍  | 6108/8192 [01:01<00:26, 79.33it/s, est. speed input: 101686.57 toks/s, output: 99.30 toks/s]
Processed prompts:  75%|███████▌  | 6172/8192 [01:02<00:25, 79.34it/s, est. speed input: 101422.04 toks/s, output: 99.04 toks/s]
Processed prompts:  76%|███████▌  | 6236/8192 [01:03<00:24, 79.33it/s, est. speed input: 101163.82 toks/s, output: 98.79 toks/s]
Processed prompts:  77%|███████▋  | 6300/8192 [01:03<00:23, 79.30it/s, est. speed input: 100910.57 toks/s, output: 98.55 toks/s]
Processed prompts:  78%|███████▊  | 6364/8192 [01:04<00:23, 79.28it/s, est. speed input: 100663.70 toks/s, output: 98.30 toks/s]
Processed prompts:  78%|███████▊  | 6428/8192 [01:05<00:22, 79.29it/s, est. speed input: 100424.16 toks/s, output: 98.07 toks/s]
Processed prompts:  79%|███████▉  | 6492/8192 [01:06<00:21, 79.24it/s, est. speed input: 100188.01 toks/s, output: 97.84 toks/s]
Processed prompts:  80%|████████  | 6556/8192 [01:07<00:20, 79.56it/s, est. speed input: 99975.17 toks/s, output: 97.63 toks/s] 
Processed prompts:  81%|████████  | 6620/8192 [01:07<00:19, 79.80it/s, est. speed input: 99767.73 toks/s, output: 97.43 toks/s]
Processed prompts:  82%|████████▏ | 6684/8192 [01:08<00:18, 79.65it/s, est. speed input: 99549.76 toks/s, output: 97.22 toks/s]
Processed prompts:  82%|████████▏ | 6748/8192 [01:09<00:18, 79.51it/s, est. speed input: 99335.32 toks/s, output: 97.01 toks/s]
Processed prompts:  83%|████████▎ | 6812/8192 [01:10<00:17, 79.38it/s, est. speed input: 99124.12 toks/s, output: 96.80 toks/s]
Processed prompts:  84%|████████▍ | 6876/8192 [01:11<00:16, 79.28it/s, est. speed input: 98917.30 toks/s, output: 96.60 toks/s]
Processed prompts:  85%|████████▍ | 6940/8192 [01:11<00:15, 79.25it/s, est. speed input: 98716.92 toks/s, output: 96.40 toks/s]
Processed prompts:  85%|████████▌ | 7004/8192 [01:12<00:14, 79.27it/s, est. speed input: 98523.12 toks/s, output: 96.21 toks/s]
Processed prompts:  86%|████████▋ | 7068/8192 [01:13<00:14, 79.22it/s, est. speed input: 98330.55 toks/s, output: 96.03 toks/s]
Processed prompts:  87%|████████▋ | 7132/8192 [01:14<00:13, 79.46it/s, est. speed input: 98154.55 toks/s, output: 95.85 toks/s]
Processed prompts:  88%|████████▊ | 7196/8192 [01:15<00:12, 79.33it/s, est. speed input: 97969.04 toks/s, output: 95.67 toks/s]
Processed prompts:  89%|████████▊ | 7260/8192 [01:16<00:11, 79.69it/s, est. speed input: 97806.96 toks/s, output: 95.51 toks/s]
Processed prompts:  89%|████████▉ | 7324/8192 [01:16<00:10, 79.44it/s, est. speed input: 97626.96 toks/s, output: 95.34 toks/s]
Processed prompts:  90%|█████████ | 7388/8192 [01:17<00:10, 79.65it/s, est. speed input: 97466.94 toks/s, output: 95.18 toks/s]
Processed prompts:  91%|█████████ | 7452/8192 [01:18<00:09, 79.44it/s, est. speed input: 97295.03 toks/s, output: 95.01 toks/s]
Processed prompts:  92%|█████████▏| 7516/8192 [01:19<00:08, 79.38it/s, est. speed input: 97130.25 toks/s, output: 94.85 toks/s]
Processed prompts:  93%|█████████▎| 7580/8192 [01:20<00:07, 79.24it/s, est. speed input: 96964.83 toks/s, output: 94.69 toks/s]
Processed prompts:  93%|█████████▎| 7644/8192 [01:20<00:06, 79.17it/s, est. speed input: 96804.09 toks/s, output: 94.54 toks/s]
Processed prompts:  94%|█████████▍| 7708/8192 [01:21<00:06, 79.10it/s, est. speed input: 96645.55 toks/s, output: 94.38 toks/s]
Processed prompts:  95%|█████████▍| 7772/8192 [01:22<00:05, 79.09it/s, est. speed input: 96491.80 toks/s, output: 94.23 toks/s]
Processed prompts:  96%|█████████▌| 7836/8192 [01:23<00:04, 79.07it/s, est. speed input: 96340.18 toks/s, output: 94.08 toks/s]
Processed prompts:  96%|█████████▋| 7900/8192 [01:24<00:03, 79.06it/s, est. speed input: 96192.02 toks/s, output: 93.94 toks/s]
Processed prompts:  97%|█████████▋| 7964/8192 [01:24<00:02, 79.02it/s, est. speed input: 96045.23 toks/s, output: 93.79 toks/s]
Processed prompts:  98%|█████████▊| 8028/8192 [01:25<00:02, 78.99it/s, est. speed input: 95901.05 toks/s, output: 93.65 toks/s]
Processed prompts:  99%|█████████▉| 8092/8192 [01:26<00:01, 79.34it/s, est. speed input: 95773.56 toks/s, output: 93.53 toks/s]
Processed prompts: 100%|█████████▉| 8156/8192 [01:26<00:00, 91.29it/s, est. speed input: 96026.35 toks/s, output: 93.78 toks/s]
Processed prompts: 100%|██████████| 8192/8192 [01:26<00:00, 91.29it/s, est. speed input: 96449.13 toks/s, output: 94.19 toks/s]
Processed prompts: 100%|██████████| 8192/8192 [01:26<00:00, 94.19it/s, est. speed input: 96449.13 toks/s, output: 94.19 toks/s]
[rank0]:[W126 09:53:21.121312036 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=512 ==========
Time: 2026-01-26 11:23:03
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_8
Params: prompt_len=512, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_8 --dataset-name random --input-len 512 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 513 --max-num-batched-tokens 513 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-7B-INT8_M512.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 11:23:10 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1280115) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1280115) WARNING 01-26 11:23:27 [backends.py:609] Failed to read file <frozen os>
Throughput: 35.23 requests/s, 18075.50 total tokens/s, 35.23 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128

STDERR:
[2026-01-26 11:23:09] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 11:23:10] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 11:23:10] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 11:23:10] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:23:10] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:23:10] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:23:10] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:23:10] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:23:10] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 11:23:10] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 11:23:10] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 11:23:10] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 11:23:10] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 11:23:10] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 11:23:16] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 11:23:17] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 11:23:17] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 11:23:17] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:23:17] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:23:17] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:23:17] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:23:17] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:23:17] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 11:23:17] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 11:23:17] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 11:23:17] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 11:23:17] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 11:23:17] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1280115) [2026-01-26 11:23:18] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1280115) [2026-01-26 11:23:18] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1280115) [2026-01-26 11:23:18] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1280115) [2026-01-26 11:23:18] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1280115) [2026-01-26 11:23:18] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1280115) [2026-01-26 11:23:18] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1280115) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1280115) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.94it/s]
(EngineCore_DP0 pid=1280115) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.39it/s]
(EngineCore_DP0 pid=1280115) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.46it/s]
(EngineCore_DP0 pid=1280115) 
(EngineCore_DP0 pid=1280115) [2026-01-26 11:23:21] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=1280115) [2026-01-26 11:23:21] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 15482880 bytes
(EngineCore_DP0 pid=1280115) [2026-01-26 11:23:21] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=1280115) [2026-01-26 11:23:21] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12042240 bytes
(EngineCore_DP0 pid=1280115) [2026-01-26 11:23:21] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=1280115) [2026-01-26 11:23:21] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 127303680 bytes
(EngineCore_DP0 pid=1280115) [2026-01-26 11:23:21] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=1280115) [2026-01-26 11:23:21] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 63651840 bytes
(EngineCore_DP0 pid=1280115) 2026-01-26 11:23:37,517 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1280115) 2026-01-26 11:23:37,540 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1280115) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  3.16it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:01<00:00,  1.75it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:01<00:00,  1.88it/s]
(EngineCore_DP0 pid=1280115) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  5.20it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  5.19it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  41%|████      | 52/128 [00:00<00:00, 510.62it/s]
Adding requests:  95%|█████████▌| 122/128 [00:00<00:00, 617.11it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 603.07it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:23,  5.30it/s, est. speed input: 2712.76 toks/s, output: 5.30 toks/s]
Processed prompts:   5%|▍         | 6/128 [00:00<00:05, 22.22it/s, est. speed input: 9811.28 toks/s, output: 19.16 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:00<00:03, 29.61it/s, est. speed input: 12883.41 toks/s, output: 25.16 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:00<00:03, 33.57it/s, est. speed input: 14602.55 toks/s, output: 28.52 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:00<00:02, 35.88it/s, est. speed input: 15691.94 toks/s, output: 30.65 toks/s]
Processed prompts:  20%|██        | 26/128 [00:00<00:02, 37.36it/s, est. speed input: 16453.43 toks/s, output: 32.13 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:00<00:02, 38.31it/s, est. speed input: 17010.63 toks/s, output: 33.22 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:01<00:02, 38.81it/s, est. speed input: 17415.67 toks/s, output: 34.01 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:01<00:02, 38.86it/s, est. speed input: 17641.15 toks/s, output: 34.45 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:01<00:02, 38.85it/s, est. speed input: 17822.63 toks/s, output: 34.81 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:01<00:02, 38.87it/s, est. speed input: 17980.94 toks/s, output: 35.12 toks/s]
Processed prompts:  41%|████      | 52/128 [00:01<00:01, 38.84it/s, est. speed input: 18111.61 toks/s, output: 35.37 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:01<00:01, 38.85it/s, est. speed input: 18228.96 toks/s, output: 35.60 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:01<00:01, 38.83it/s, est. speed input: 18329.64 toks/s, output: 35.80 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:01<00:01, 38.82it/s, est. speed input: 18417.86 toks/s, output: 35.97 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:01<00:01, 38.82it/s, est. speed input: 18498.30 toks/s, output: 36.13 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:01<00:01, 38.86it/s, est. speed input: 18572.97 toks/s, output: 36.27 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:02<00:01, 38.92it/s, est. speed input: 18643.06 toks/s, output: 36.41 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:02<00:01, 38.99it/s, est. speed input: 18708.62 toks/s, output: 36.54 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:02<00:01, 38.99it/s, est. speed input: 18764.86 toks/s, output: 36.65 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:02<00:01, 38.98it/s, est. speed input: 18815.82 toks/s, output: 36.75 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:02<00:00, 38.97it/s, est. speed input: 18861.54 toks/s, output: 36.84 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:02<00:00, 38.98it/s, est. speed input: 18905.45 toks/s, output: 36.92 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:02<00:00, 39.03it/s, est. speed input: 18948.43 toks/s, output: 37.01 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:02<00:00, 39.05it/s, est. speed input: 18987.38 toks/s, output: 37.08 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:02<00:00, 39.09it/s, est. speed input: 19024.87 toks/s, output: 37.16 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:03<00:00, 39.08it/s, est. speed input: 19058.02 toks/s, output: 37.22 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:03<00:00, 39.07it/s, est. speed input: 19088.75 toks/s, output: 37.28 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:03<00:00, 39.05it/s, est. speed input: 19116.82 toks/s, output: 37.34 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:03<00:00, 39.01it/s, est. speed input: 19141.91 toks/s, output: 37.39 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:03<00:00, 39.04it/s, est. speed input: 19168.31 toks/s, output: 37.44 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:03<00:00, 39.04it/s, est. speed input: 19168.31 toks/s, output: 37.44 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:03<00:00, 37.43it/s, est. speed input: 19168.31 toks/s, output: 37.44 toks/s]
[rank0]:[W126 11:23:44.235754409 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=1024 ==========
Time: 2026-01-26 11:23:46
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 1025 --max-num-batched-tokens 1025 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-7B-INT8_M1024.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 11:23:53 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1281254) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1281254) WARNING 01-26 11:24:10 [backends.py:609] Failed to read file <frozen os>
Throughput: 32.73 requests/s, 33551.97 total tokens/s, 32.73 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128

STDERR:
[2026-01-26 11:23:52] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 11:23:53] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 11:23:53] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 11:23:53] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:23:53] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:23:53] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:23:53] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:23:53] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:23:53] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 11:23:53] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 11:23:53] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 11:23:53] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 11:23:53] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 11:23:53] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 11:24:00] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 11:24:01] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 11:24:01] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 11:24:01] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:24:01] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:24:01] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:24:01] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:24:01] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:24:01] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 11:24:01] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 11:24:01] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 11:24:01] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 11:24:01] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 11:24:01] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1281254) [2026-01-26 11:24:02] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1281254) [2026-01-26 11:24:02] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1281254) [2026-01-26 11:24:02] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1281254) [2026-01-26 11:24:02] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1281254) [2026-01-26 11:24:02] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1281254) [2026-01-26 11:24:02] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1281254) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1281254) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.94it/s]
(EngineCore_DP0 pid=1281254) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.39it/s]
(EngineCore_DP0 pid=1281254) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.45it/s]
(EngineCore_DP0 pid=1281254) 
(EngineCore_DP0 pid=1281254) [2026-01-26 11:24:04] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=1281254) [2026-01-26 11:24:04] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 15482880 bytes
(EngineCore_DP0 pid=1281254) [2026-01-26 11:24:04] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=1281254) [2026-01-26 11:24:04] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12042240 bytes
(EngineCore_DP0 pid=1281254) [2026-01-26 11:24:04] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=1281254) [2026-01-26 11:24:04] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 127303680 bytes
(EngineCore_DP0 pid=1281254) [2026-01-26 11:24:04] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=1281254) [2026-01-26 11:24:04] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 63651840 bytes
(EngineCore_DP0 pid=1281254) 2026-01-26 11:24:22,310 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1281254) 2026-01-26 11:24:22,355 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1281254) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00, 14.48it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00, 14.46it/s]
(EngineCore_DP0 pid=1281254) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00, 17.85it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  13%|█▎        | 17/128 [00:00<00:00, 167.41it/s]
Adding requests:  41%|████      | 52/128 [00:00<00:00, 271.51it/s]
Adding requests:  71%|███████   | 91/128 [00:00<00:00, 322.53it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 316.31it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:00<00:01, 66.96it/s, est. speed input: 68573.42 toks/s, output: 66.96 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:00<00:02, 45.07it/s, est. speed input: 48706.34 toks/s, output: 47.56 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:00<00:02, 41.21it/s, est. speed input: 45005.69 toks/s, output: 43.95 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:00<00:02, 39.19it/s, est. speed input: 43049.27 toks/s, output: 42.04 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:00<00:02, 37.98it/s, est. speed input: 41810.54 toks/s, output: 40.83 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:00<00:02, 37.32it/s, est. speed input: 41110.74 toks/s, output: 40.15 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:00<00:02, 36.56it/s, est. speed input: 40449.60 toks/s, output: 39.50 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:01<00:02, 36.14it/s, est. speed input: 39976.87 toks/s, output: 39.04 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:01<00:02, 35.95it/s, est. speed input: 39630.12 toks/s, output: 38.70 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:01<00:02, 35.75it/s, est. speed input: 39326.15 toks/s, output: 38.40 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:01<00:02, 35.69it/s, est. speed input: 39093.04 toks/s, output: 38.18 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:01<00:01, 35.69it/s, est. speed input: 38906.89 toks/s, output: 37.99 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:01<00:01, 35.69it/s, est. speed input: 38744.25 toks/s, output: 37.84 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:01<00:01, 35.68it/s, est. speed input: 38600.52 toks/s, output: 37.70 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:01<00:01, 35.68it/s, est. speed input: 38477.51 toks/s, output: 37.57 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:01<00:01, 35.54it/s, est. speed input: 38337.30 toks/s, output: 37.44 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:02<00:01, 35.40it/s, est. speed input: 38205.64 toks/s, output: 37.31 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:02<00:01, 35.38it/s, est. speed input: 38101.30 toks/s, output: 37.21 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:02<00:01, 35.42it/s, est. speed input: 38017.55 toks/s, output: 37.13 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:02<00:01, 35.40it/s, est. speed input: 37932.52 toks/s, output: 37.04 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:02<00:00, 35.39it/s, est. speed input: 37856.95 toks/s, output: 36.97 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:02<00:00, 35.44it/s, est. speed input: 37795.23 toks/s, output: 36.91 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:02<00:00, 35.48it/s, est. speed input: 37739.27 toks/s, output: 36.85 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:02<00:00, 35.48it/s, est. speed input: 37684.26 toks/s, output: 36.80 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:02<00:00, 35.30it/s, est. speed input: 37609.10 toks/s, output: 36.73 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:03<00:00, 35.28it/s, est. speed input: 37553.59 toks/s, output: 36.67 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:03<00:00, 35.29it/s, est. speed input: 37504.60 toks/s, output: 36.63 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:03<00:00, 35.33it/s, est. speed input: 37462.32 toks/s, output: 36.58 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:03<00:00, 35.40it/s, est. speed input: 37428.09 toks/s, output: 36.55 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:03<00:00, 35.40it/s, est. speed input: 37408.69 toks/s, output: 36.53 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:03<00:00, 36.53it/s, est. speed input: 37408.69 toks/s, output: 36.53 toks/s]
[rank0]:[W126 11:24:28.246846207 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=2048 ==========
Time: 2026-01-26 11:24:30
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=256, max_num_seqs=2
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 256 --max-num-seqs 2 --max-model-len 1025 --max-num-batched-tokens 2048 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-7B-INT8_M2048.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 11:24:38 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1282384) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1282384) WARNING 01-26 11:24:55 [backends.py:609] Failed to read file <frozen os>
Throughput: 36.82 requests/s, 37739.68 total tokens/s, 36.82 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256

STDERR:
[2026-01-26 11:24:37] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 11:24:38] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 11:24:38] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 11:24:38] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:24:38] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:24:38] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:24:38] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:24:38] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:24:38] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 11:24:38] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 11:24:38] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 11:24:38] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 11:24:38] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 11:24:38] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 11:24:44] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 11:24:45] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 11:24:45] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 11:24:45] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:24:45] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:24:45] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:24:45] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:24:45] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:24:45] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 11:24:45] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 11:24:45] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 11:24:45] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 11:24:45] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 11:24:45] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1282384) [2026-01-26 11:24:46] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1282384) [2026-01-26 11:24:47] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1282384) [2026-01-26 11:24:47] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1282384) [2026-01-26 11:24:47] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1282384) [2026-01-26 11:24:47] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1282384) [2026-01-26 11:24:47] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1282384) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1282384) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.92it/s]
(EngineCore_DP0 pid=1282384) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.39it/s]
(EngineCore_DP0 pid=1282384) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.45it/s]
(EngineCore_DP0 pid=1282384) 
(EngineCore_DP0 pid=1282384) [2026-01-26 11:24:48] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=1282384) [2026-01-26 11:24:49] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 15482880 bytes
(EngineCore_DP0 pid=1282384) [2026-01-26 11:24:49] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=1282384) [2026-01-26 11:24:49] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12042240 bytes
(EngineCore_DP0 pid=1282384) [2026-01-26 11:24:49] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=1282384) [2026-01-26 11:24:49] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 127303680 bytes
(EngineCore_DP0 pid=1282384) [2026-01-26 11:24:49] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=1282384) [2026-01-26 11:24:49] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 63651840 bytes
(EngineCore_DP0 pid=1282384) 2026-01-26 11:25:06,010 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1282384) 2026-01-26 11:25:06,033 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1282384) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  67%|██████▋   | 2/3 [00:00<00:00, 14.92it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00, 14.72it/s]
(EngineCore_DP0 pid=1282384) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00, 19.03it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00, 19.00it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:   8%|▊         | 21/256 [00:00<00:01, 204.41it/s]
Adding requests:  24%|██▍       | 62/256 [00:00<00:00, 322.39it/s]
Adding requests:  38%|███▊      | 98/256 [00:00<00:00, 337.99it/s]
Adding requests:  53%|█████▎    | 136/256 [00:00<00:00, 353.63it/s]
Adding requests:  69%|██████▉   | 176/256 [00:00<00:00, 367.60it/s]
Adding requests:  84%|████████▍ | 216/256 [00:00<00:00, 376.47it/s]
Adding requests: 100%|█████████▉| 255/256 [00:00<00:00, 379.01it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 358.96it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   8%|▊         | 20/256 [00:00<00:01, 145.12it/s, est. speed input: 148641.79 toks/s, output: 145.13 toks/s]
Processed prompts:  14%|█▎        | 35/256 [00:00<00:03, 63.63it/s, est. speed input: 72098.78 toks/s, output: 70.41 toks/s]   
Processed prompts:  17%|█▋        | 44/256 [00:00<00:04, 50.88it/s, est. speed input: 59769.11 toks/s, output: 58.37 toks/s]
Processed prompts:  20%|█▉        | 51/256 [00:00<00:04, 48.89it/s, est. speed input: 57169.78 toks/s, output: 55.83 toks/s]
Processed prompts:  22%|██▏       | 57/256 [00:01<00:04, 45.73it/s, est. speed input: 54453.52 toks/s, output: 53.18 toks/s]
Processed prompts:  24%|██▍       | 62/256 [00:01<00:04, 41.85it/s, est. speed input: 51732.26 toks/s, output: 50.52 toks/s]
Processed prompts:  26%|██▌       | 67/256 [00:01<00:04, 43.25it/s, est. speed input: 51565.10 toks/s, output: 50.36 toks/s]
Processed prompts:  28%|██▊       | 72/256 [00:01<00:04, 39.87it/s, est. speed input: 49663.02 toks/s, output: 48.50 toks/s]
Processed prompts:  30%|███       | 77/256 [00:01<00:04, 41.82it/s, est. speed input: 49648.20 toks/s, output: 48.48 toks/s]
Processed prompts:  32%|███▏      | 82/256 [00:01<00:04, 38.72it/s, est. speed input: 48191.77 toks/s, output: 47.06 toks/s]
Processed prompts:  34%|███▎      | 86/256 [00:01<00:04, 38.54it/s, est. speed input: 47663.49 toks/s, output: 46.55 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:01<00:04, 38.46it/s, est. speed input: 47206.35 toks/s, output: 46.10 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:02<00:04, 38.37it/s, est. speed input: 46790.19 toks/s, output: 45.69 toks/s]
Processed prompts:  38%|███▊      | 98/256 [00:02<00:04, 38.35it/s, est. speed input: 46423.19 toks/s, output: 45.33 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:02<00:04, 38.39it/s, est. speed input: 46102.84 toks/s, output: 45.02 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:02<00:03, 38.54it/s, est. speed input: 45831.15 toks/s, output: 44.76 toks/s]
Processed prompts:  43%|████▎     | 110/256 [00:02<00:03, 38.57it/s, est. speed input: 45568.41 toks/s, output: 44.50 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:02<00:03, 38.56it/s, est. speed input: 45323.03 toks/s, output: 44.26 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:02<00:03, 38.68it/s, est. speed input: 45114.62 toks/s, output: 44.06 toks/s]
Processed prompts:  48%|████▊     | 122/256 [00:02<00:03, 38.60it/s, est. speed input: 44899.12 toks/s, output: 43.85 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:02<00:03, 38.48it/s, est. speed input: 44688.44 toks/s, output: 43.64 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:02<00:03, 38.27it/s, est. speed input: 44476.91 toks/s, output: 43.43 toks/s]
Processed prompts:  52%|█████▏    | 134/256 [00:03<00:03, 38.19it/s, est. speed input: 44287.79 toks/s, output: 43.25 toks/s]
Processed prompts:  54%|█████▍    | 138/256 [00:03<00:03, 38.20it/s, est. speed input: 44119.68 toks/s, output: 43.09 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:03<00:02, 38.27it/s, est. speed input: 43970.09 toks/s, output: 42.94 toks/s]
Processed prompts:  57%|█████▋    | 146/256 [00:03<00:02, 38.34it/s, est. speed input: 43831.75 toks/s, output: 42.80 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:03<00:02, 38.47it/s, est. speed input: 43710.79 toks/s, output: 42.69 toks/s]
Processed prompts:  60%|██████    | 154/256 [00:03<00:02, 38.44it/s, est. speed input: 43583.73 toks/s, output: 42.56 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:03<00:02, 38.45it/s, est. speed input: 43466.41 toks/s, output: 42.45 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:03<00:02, 38.38it/s, est. speed input: 43347.73 toks/s, output: 42.33 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:03<00:02, 38.33it/s, est. speed input: 43235.55 toks/s, output: 42.22 toks/s]
Processed prompts:  66%|██████▋   | 170/256 [00:04<00:02, 38.22it/s, est. speed input: 43121.94 toks/s, output: 42.11 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:04<00:02, 38.21it/s, est. speed input: 43020.44 toks/s, output: 42.01 toks/s]
Processed prompts:  70%|██████▉   | 178/256 [00:04<00:02, 38.29it/s, est. speed input: 42931.99 toks/s, output: 41.93 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:04<00:01, 38.32it/s, est. speed input: 42844.64 toks/s, output: 41.84 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:04<00:01, 38.39it/s, est. speed input: 42766.75 toks/s, output: 41.76 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:04<00:01, 38.44it/s, est. speed input: 42691.61 toks/s, output: 41.69 toks/s]
Processed prompts:  76%|███████▌  | 194/256 [00:04<00:01, 38.53it/s, est. speed input: 42624.74 toks/s, output: 41.63 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:04<00:01, 38.56it/s, est. speed input: 42558.41 toks/s, output: 41.56 toks/s]
Processed prompts:  80%|███████▉  | 204/256 [00:04<00:01, 40.16it/s, est. speed input: 42597.96 toks/s, output: 41.60 toks/s]
Processed prompts:  81%|████████▏ | 208/256 [00:05<00:01, 39.53it/s, est. speed input: 42519.02 toks/s, output: 41.52 toks/s]
Processed prompts:  83%|████████▎ | 212/256 [00:05<00:01, 39.13it/s, est. speed input: 42447.58 toks/s, output: 41.45 toks/s]
Processed prompts:  84%|████████▍ | 216/256 [00:05<00:01, 38.83it/s, est. speed input: 42379.08 toks/s, output: 41.39 toks/s]
Processed prompts:  86%|████████▌ | 220/256 [00:05<00:00, 38.74it/s, est. speed input: 42321.96 toks/s, output: 41.33 toks/s]
Processed prompts:  88%|████████▊ | 224/256 [00:05<00:00, 38.68it/s, est. speed input: 42266.76 toks/s, output: 41.28 toks/s]
Processed prompts:  89%|████████▉ | 228/256 [00:05<00:00, 38.71it/s, est. speed input: 42219.51 toks/s, output: 41.23 toks/s]
Processed prompts:  91%|█████████ | 232/256 [00:05<00:00, 38.64it/s, est. speed input: 42167.14 toks/s, output: 41.18 toks/s]
Processed prompts:  92%|█████████▏| 236/256 [00:05<00:00, 38.53it/s, est. speed input: 42113.03 toks/s, output: 41.13 toks/s]
Processed prompts:  94%|█████████▍| 240/256 [00:05<00:00, 38.50it/s, est. speed input: 42063.65 toks/s, output: 41.08 toks/s]
Processed prompts:  95%|█████████▌| 244/256 [00:05<00:00, 38.39it/s, est. speed input: 42010.74 toks/s, output: 41.03 toks/s]
Processed prompts:  97%|█████████▋| 248/256 [00:06<00:00, 38.40it/s, est. speed input: 41965.01 toks/s, output: 40.98 toks/s]
Processed prompts:  98%|█████████▊| 252/256 [00:06<00:00, 38.31it/s, est. speed input: 41914.31 toks/s, output: 40.93 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:06<00:00, 38.31it/s, est. speed input: 42024.66 toks/s, output: 41.04 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:06<00:00, 41.04it/s, est. speed input: 42024.66 toks/s, output: 41.04 toks/s]
[rank0]:[W126 11:25:15.074709123 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=4096 ==========
Time: 2026-01-26 11:25:17
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=512, max_num_seqs=4
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 512 --max-num-seqs 4 --max-model-len 1025 --max-num-batched-tokens 4096 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-7B-INT8_M4096.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 11:25:26 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1283541) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1283541) WARNING 01-26 11:25:43 [backends.py:609] Failed to read file <frozen os>
Throughput: 39.13 requests/s, 40110.02 total tokens/s, 39.13 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512

STDERR:
[2026-01-26 11:25:25] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 11:25:26] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 11:25:26] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 11:25:26] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:25:26] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:25:26] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:25:26] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:25:26] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:25:26] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 11:25:26] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 11:25:26] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 11:25:26] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 11:25:26] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 11:25:26] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 11:25:33] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 11:25:33] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 11:25:33] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 11:25:33] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:25:33] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:25:33] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:25:33] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:25:33] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:25:33] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 11:25:33] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 11:25:33] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 11:25:33] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 11:25:33] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 11:25:33] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1283541) [2026-01-26 11:25:34] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1283541) [2026-01-26 11:25:35] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1283541) [2026-01-26 11:25:35] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1283541) [2026-01-26 11:25:35] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1283541) [2026-01-26 11:25:35] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1283541) [2026-01-26 11:25:35] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1283541) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1283541) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.94it/s]
(EngineCore_DP0 pid=1283541) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.39it/s]
(EngineCore_DP0 pid=1283541) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.45it/s]
(EngineCore_DP0 pid=1283541) 
(EngineCore_DP0 pid=1283541) [2026-01-26 11:25:36] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=1283541) [2026-01-26 11:25:36] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 15482880 bytes
(EngineCore_DP0 pid=1283541) [2026-01-26 11:25:36] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=1283541) [2026-01-26 11:25:36] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12042240 bytes
(EngineCore_DP0 pid=1283541) [2026-01-26 11:25:36] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=1283541) [2026-01-26 11:25:36] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 127303680 bytes
(EngineCore_DP0 pid=1283541) [2026-01-26 11:25:36] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=1283541) [2026-01-26 11:25:36] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 63651840 bytes
(EngineCore_DP0 pid=1283541) 2026-01-26 11:25:54,365 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1283541) 2026-01-26 11:25:54,405 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1283541) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  25%|██▌       | 1/4 [00:00<00:00,  8.65it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00, 14.87it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00, 14.10it/s]
(EngineCore_DP0 pid=1283541) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  67%|██████▋   | 2/3 [00:00<00:00, 18.64it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00, 19.25it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   4%|▍         | 21/512 [00:00<00:02, 207.98it/s]
Adding requests:  12%|█▏        | 62/512 [00:00<00:01, 324.56it/s]
Adding requests:  19%|█▉        | 98/512 [00:00<00:01, 339.07it/s]
Adding requests:  27%|██▋       | 136/512 [00:00<00:01, 354.13it/s]
Adding requests:  34%|███▍      | 176/512 [00:00<00:00, 367.35it/s]
Adding requests:  42%|████▏     | 217/512 [00:00<00:00, 380.16it/s]
Adding requests:  50%|█████     | 256/512 [00:00<00:00, 380.05it/s]
Adding requests:  58%|█████▊    | 296/512 [00:00<00:00, 384.35it/s]
Adding requests:  66%|██████▌   | 337/512 [00:00<00:00, 392.20it/s]
Adding requests:  74%|███████▎  | 377/512 [00:01<00:00, 393.54it/s]
Adding requests:  82%|████████▏ | 419/512 [00:01<00:00, 399.97it/s]
Adding requests:  90%|████████▉ | 459/512 [00:01<00:00, 395.67it/s]
Adding requests:  98%|█████████▊| 501/512 [00:01<00:00, 402.06it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 380.54it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  10%|▉         | 50/512 [00:00<00:01, 359.00it/s, est. speed input: 367676.99 toks/s, output: 359.02 toks/s]
Processed prompts:  17%|█▋        | 86/512 [00:01<00:06, 70.37it/s, est. speed input: 83813.71 toks/s, output: 81.85 toks/s]   
Processed prompts:  20%|██        | 104/512 [00:01<00:06, 61.24it/s, est. speed input: 73443.75 toks/s, output: 71.72 toks/s]
Processed prompts:  23%|██▎       | 116/512 [00:01<00:07, 55.15it/s, est. speed input: 67762.24 toks/s, output: 66.17 toks/s]
Processed prompts:  24%|██▍       | 125/512 [00:01<00:07, 52.65it/s, est. speed input: 65312.18 toks/s, output: 63.78 toks/s]
Processed prompts:  26%|██▌       | 132/512 [00:02<00:07, 48.47it/s, est. speed input: 62516.54 toks/s, output: 61.05 toks/s]
Processed prompts:  27%|██▋       | 138/512 [00:02<00:08, 43.88it/s, est. speed input: 59804.38 toks/s, output: 58.40 toks/s]
Processed prompts:  28%|██▊       | 143/512 [00:02<00:08, 44.75it/s, est. speed input: 59438.89 toks/s, output: 58.05 toks/s]
Processed prompts:  29%|██▉       | 148/512 [00:02<00:07, 45.58it/s, est. speed input: 59089.22 toks/s, output: 57.70 toks/s]
Processed prompts:  30%|██▉       | 153/512 [00:02<00:07, 46.30it/s, est. speed input: 58753.85 toks/s, output: 57.38 toks/s]
Processed prompts:  31%|███       | 158/512 [00:02<00:09, 38.22it/s, est. speed input: 56346.05 toks/s, output: 55.02 toks/s]
Processed prompts:  32%|███▏      | 163/512 [00:02<00:08, 40.52it/s, est. speed input: 56145.65 toks/s, output: 54.83 toks/s]
Processed prompts:  33%|███▎      | 168/512 [00:03<00:08, 42.43it/s, est. speed input: 55941.47 toks/s, output: 54.63 toks/s]
Processed prompts:  34%|███▍      | 173/512 [00:03<00:07, 44.08it/s, est. speed input: 55760.55 toks/s, output: 54.45 toks/s]
Processed prompts:  35%|███▍      | 178/512 [00:03<00:09, 36.17it/s, est. speed input: 53949.67 toks/s, output: 52.68 toks/s]
Processed prompts:  36%|███▌      | 182/512 [00:03<00:08, 36.93it/s, est. speed input: 53557.93 toks/s, output: 52.30 toks/s]
Processed prompts:  36%|███▋      | 186/512 [00:03<00:08, 37.52it/s, est. speed input: 53179.81 toks/s, output: 51.93 toks/s]
Processed prompts:  37%|███▋      | 190/512 [00:03<00:08, 37.94it/s, est. speed input: 52816.98 toks/s, output: 51.58 toks/s]
Processed prompts:  38%|███▊      | 194/512 [00:03<00:08, 38.20it/s, est. speed input: 52463.51 toks/s, output: 51.23 toks/s]
Processed prompts:  39%|███▊      | 198/512 [00:03<00:08, 38.48it/s, est. speed input: 52140.93 toks/s, output: 50.92 toks/s]
Processed prompts:  40%|████      | 206/512 [00:04<00:07, 40.21it/s, est. speed input: 51747.50 toks/s, output: 50.53 toks/s]
Processed prompts:  41%|████      | 211/512 [00:04<00:07, 42.47it/s, est. speed input: 51718.22 toks/s, output: 50.51 toks/s]
Processed prompts:  42%|████▏     | 216/512 [00:04<00:06, 44.37it/s, est. speed input: 51701.84 toks/s, output: 50.49 toks/s]
Processed prompts:  43%|████▎     | 221/512 [00:04<00:06, 45.79it/s, est. speed input: 51681.21 toks/s, output: 50.47 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:04<00:07, 36.55it/s, est. speed input: 50512.41 toks/s, output: 49.33 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:04<00:07, 37.22it/s, est. speed input: 50289.95 toks/s, output: 49.11 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:04<00:07, 37.68it/s, est. speed input: 50069.51 toks/s, output: 48.90 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:04<00:07, 38.05it/s, est. speed input: 49858.74 toks/s, output: 48.69 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:04<00:07, 38.46it/s, est. speed input: 49668.22 toks/s, output: 48.50 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:05<00:06, 38.73it/s, est. speed input: 49483.16 toks/s, output: 48.32 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:05<00:06, 39.01it/s, est. speed input: 49312.17 toks/s, output: 48.16 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:05<00:06, 39.20it/s, est. speed input: 49145.93 toks/s, output: 47.99 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:05<00:06, 39.36it/s, est. speed input: 48988.26 toks/s, output: 47.84 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:05<00:06, 39.43it/s, est. speed input: 48833.01 toks/s, output: 47.69 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:05<00:06, 39.42it/s, est. speed input: 48678.73 toks/s, output: 47.54 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:05<00:06, 39.27it/s, est. speed input: 48520.06 toks/s, output: 47.38 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:05<00:06, 39.18it/s, est. speed input: 48367.73 toks/s, output: 47.23 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:05<00:05, 39.21it/s, est. speed input: 48227.38 toks/s, output: 47.10 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:06<00:05, 39.25it/s, est. speed input: 48092.75 toks/s, output: 46.97 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:06<00:05, 39.23it/s, est. speed input: 47959.41 toks/s, output: 46.84 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:06<00:05, 39.29it/s, est. speed input: 47835.19 toks/s, output: 46.71 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:06<00:05, 39.42it/s, est. speed input: 47720.98 toks/s, output: 46.60 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:06<00:05, 39.54it/s, est. speed input: 47612.57 toks/s, output: 46.50 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:06<00:05, 39.56it/s, est. speed input: 47503.03 toks/s, output: 46.39 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:06<00:04, 41.21it/s, est. speed input: 47416.23 toks/s, output: 46.30 toks/s]
Processed prompts:  62%|██████▏   | 315/512 [00:06<00:04, 43.19it/s, est. speed input: 47455.70 toks/s, output: 46.34 toks/s]
Processed prompts:  62%|██████▎   | 320/512 [00:06<00:04, 44.77it/s, est. speed input: 47496.90 toks/s, output: 46.38 toks/s]
Processed prompts:  63%|██████▎   | 325/512 [00:07<00:04, 45.94it/s, est. speed input: 47535.64 toks/s, output: 46.42 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:07<00:04, 36.48it/s, est. speed input: 46902.33 toks/s, output: 45.80 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:07<00:04, 37.22it/s, est. speed input: 46814.10 toks/s, output: 45.72 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:07<00:04, 37.77it/s, est. speed input: 46725.27 toks/s, output: 45.63 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:07<00:04, 38.23it/s, est. speed input: 46640.23 toks/s, output: 45.55 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:07<00:04, 38.61it/s, est. speed input: 46559.70 toks/s, output: 45.47 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:07<00:04, 38.90it/s, est. speed input: 46481.54 toks/s, output: 45.39 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:07<00:04, 39.09it/s, est. speed input: 46404.26 toks/s, output: 45.32 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:07<00:03, 39.20it/s, est. speed input: 46327.48 toks/s, output: 45.24 toks/s]
Processed prompts:  71%|███████   | 362/512 [00:08<00:03, 39.16it/s, est. speed input: 46246.60 toks/s, output: 45.16 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:08<00:03, 39.12it/s, est. speed input: 46167.08 toks/s, output: 45.08 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [00:08<00:03, 39.16it/s, est. speed input: 46093.22 toks/s, output: 45.01 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [00:08<00:03, 39.22it/s, est. speed input: 46022.48 toks/s, output: 44.94 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [00:08<00:03, 39.24it/s, est. speed input: 45952.53 toks/s, output: 44.88 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [00:08<00:03, 39.25it/s, est. speed input: 45883.87 toks/s, output: 44.81 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [00:08<00:03, 39.24it/s, est. speed input: 45816.32 toks/s, output: 44.74 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [00:08<00:03, 39.27it/s, est. speed input: 45751.66 toks/s, output: 44.68 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [00:08<00:02, 39.36it/s, est. speed input: 45691.87 toks/s, output: 44.62 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [00:08<00:02, 39.47it/s, est. speed input: 45635.41 toks/s, output: 44.57 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [00:09<00:02, 39.47it/s, est. speed input: 45576.96 toks/s, output: 44.51 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [00:09<00:02, 39.47it/s, est. speed input: 45519.44 toks/s, output: 44.45 toks/s]
Processed prompts:  80%|████████  | 410/512 [00:09<00:02, 39.37it/s, est. speed input: 45459.28 toks/s, output: 44.39 toks/s]
Processed prompts:  81%|████████  | 414/512 [00:09<00:02, 39.34it/s, est. speed input: 45402.02 toks/s, output: 44.34 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [00:09<00:02, 39.31it/s, est. speed input: 45345.69 toks/s, output: 44.28 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [00:09<00:02, 39.26it/s, est. speed input: 45289.64 toks/s, output: 44.23 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [00:09<00:02, 39.25it/s, est. speed input: 45235.03 toks/s, output: 44.17 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [00:09<00:02, 39.26it/s, est. speed input: 45182.86 toks/s, output: 44.12 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [00:09<00:01, 41.04it/s, est. speed input: 45167.83 toks/s, output: 44.11 toks/s]
Processed prompts:  87%|████████▋ | 443/512 [00:10<00:01, 43.17it/s, est. speed input: 45222.14 toks/s, output: 44.16 toks/s]
Processed prompts:  88%|████████▊ | 448/512 [00:10<00:01, 44.80it/s, est. speed input: 45274.51 toks/s, output: 44.21 toks/s]
Processed prompts:  88%|████████▊ | 453/512 [00:10<00:01, 45.98it/s, est. speed input: 45323.72 toks/s, output: 44.26 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [00:10<00:01, 36.47it/s, est. speed input: 44927.75 toks/s, output: 43.87 toks/s]
Processed prompts:  90%|█████████ | 462/512 [00:10<00:01, 37.15it/s, est. speed input: 44882.68 toks/s, output: 43.83 toks/s]
Processed prompts:  91%|█████████ | 466/512 [00:10<00:01, 37.71it/s, est. speed input: 44838.80 toks/s, output: 43.79 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [00:10<00:01, 38.13it/s, est. speed input: 44794.96 toks/s, output: 43.74 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [00:10<00:00, 38.44it/s, est. speed input: 44752.00 toks/s, output: 43.70 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [00:10<00:00, 38.67it/s, est. speed input: 44709.48 toks/s, output: 43.66 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [00:11<00:00, 38.92it/s, est. speed input: 44670.88 toks/s, output: 43.62 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [00:11<00:00, 39.09it/s, est. speed input: 44632.66 toks/s, output: 43.59 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [00:11<00:00, 39.27it/s, est. speed input: 44597.15 toks/s, output: 43.55 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [00:11<00:00, 39.35it/s, est. speed input: 44560.50 toks/s, output: 43.52 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [00:11<00:00, 39.38it/s, est. speed input: 44523.62 toks/s, output: 43.48 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [00:11<00:00, 39.28it/s, est. speed input: 44483.34 toks/s, output: 43.44 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [00:11<00:00, 39.29it/s, est. speed input: 44446.60 toks/s, output: 43.40 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:11<00:00, 39.29it/s, est. speed input: 44670.45 toks/s, output: 43.62 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:11<00:00, 43.62it/s, est. speed input: 44670.45 toks/s, output: 43.62 toks/s]
[rank0]:[W126 11:26:09.708425838 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=8192 ==========
Time: 2026-01-26 11:26:11
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=1024, max_num_seqs=8
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 1024 --max-num-seqs 8 --max-model-len 1025 --max-num-batched-tokens 8192 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-7B-INT8_M8192.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 11:26:24 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1284829) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1284829) WARNING 01-26 11:26:41 [backends.py:609] Failed to read file <frozen os>
Throughput: 40.27 requests/s, 41280.25 total tokens/s, 40.27 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024

STDERR:
[2026-01-26 11:26:23] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 11:26:24] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 11:26:24] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 11:26:24] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:26:24] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:26:24] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:26:24] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:26:24] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:26:24] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 11:26:24] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 11:26:24] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 11:26:24] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 11:26:24] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 11:26:24] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 11:26:30] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 11:26:31] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 11:26:31] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 11:26:31] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:26:31] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:26:31] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:26:31] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:26:31] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:26:31] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 11:26:31] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 11:26:31] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 11:26:31] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 11:26:31] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 11:26:31] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1284829) [2026-01-26 11:26:33] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1284829) [2026-01-26 11:26:33] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1284829) [2026-01-26 11:26:33] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1284829) [2026-01-26 11:26:33] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1284829) [2026-01-26 11:26:33] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1284829) [2026-01-26 11:26:33] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1284829) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1284829) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.95it/s]
(EngineCore_DP0 pid=1284829) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.40it/s]
(EngineCore_DP0 pid=1284829) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.46it/s]
(EngineCore_DP0 pid=1284829) 
(EngineCore_DP0 pid=1284829) [2026-01-26 11:26:35] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=1284829) [2026-01-26 11:26:35] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 15482880 bytes
(EngineCore_DP0 pid=1284829) [2026-01-26 11:26:35] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=1284829) [2026-01-26 11:26:35] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12042240 bytes
(EngineCore_DP0 pid=1284829) [2026-01-26 11:26:35] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=1284829) [2026-01-26 11:26:35] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 127303680 bytes
(EngineCore_DP0 pid=1284829) [2026-01-26 11:26:35] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=1284829) [2026-01-26 11:26:35] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 63651840 bytes
(EngineCore_DP0 pid=1284829) 2026-01-26 11:26:52,174 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1284829) 2026-01-26 11:26:52,198 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1284829) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:01,  2.54it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  40%|████      | 2/5 [00:00<00:01,  2.14it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  80%|████████  | 4/5 [00:01<00:00,  4.58it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:01<00:00,  4.55it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:01<00:00,  3.92it/s]
(EngineCore_DP0 pid=1284829) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:00,  9.47it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00, 16.79it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00, 15.86it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 23/1024 [00:00<00:04, 227.22it/s]
Adding requests:   6%|▋         | 64/1024 [00:00<00:02, 328.79it/s]
Adding requests:  10%|▉         | 99/1024 [00:00<00:02, 333.48it/s]
Adding requests:  13%|█▎        | 137/1024 [00:00<00:02, 349.71it/s]
Adding requests:  17%|█▋        | 177/1024 [00:00<00:02, 364.22it/s]
Adding requests:  21%|██▏       | 219/1024 [00:00<00:02, 381.21it/s]
Adding requests:  25%|██▌       | 258/1024 [00:00<00:02, 378.37it/s]
Adding requests:  29%|██▉       | 298/1024 [00:00<00:01, 383.41it/s]
Adding requests:  33%|███▎      | 338/1024 [00:00<00:01, 387.30it/s]
Adding requests:  37%|███▋      | 378/1024 [00:01<00:01, 389.09it/s]
Adding requests:  41%|████      | 420/1024 [00:01<00:01, 396.36it/s]
Adding requests:  45%|████▍     | 460/1024 [00:01<00:01, 390.56it/s]
Adding requests:  49%|████▉     | 503/1024 [00:01<00:01, 399.86it/s]
Adding requests:  53%|█████▎    | 544/1024 [00:01<00:01, 401.25it/s]
Adding requests:  57%|█████▋    | 585/1024 [00:01<00:01, 396.64it/s]
Adding requests:  61%|██████    | 625/1024 [00:01<00:01, 392.26it/s]
Adding requests:  65%|██████▍   | 665/1024 [00:01<00:00, 386.48it/s]
Adding requests:  69%|██████▉   | 705/1024 [00:01<00:00, 390.00it/s]
Adding requests:  73%|███████▎  | 745/1024 [00:01<00:00, 385.10it/s]
Adding requests:  77%|███████▋  | 785/1024 [00:02<00:00, 388.11it/s]
Adding requests:  80%|████████  | 824/1024 [00:02<00:00, 387.70it/s]
Adding requests:  84%|████████▍ | 864/1024 [00:02<00:00, 390.27it/s]
Adding requests:  88%|████████▊ | 906/1024 [00:02<00:00, 397.31it/s]
Adding requests:  92%|█████████▏| 946/1024 [00:02<00:00, 386.08it/s]
Adding requests:  96%|█████████▋| 986/1024 [00:02<00:00, 387.76it/s]
Adding requests: 100%|██████████| 1024/1024 [00:02<00:00, 382.66it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  10%|█         | 106/1024 [00:00<00:01, 502.82it/s, est. speed input: 514992.83 toks/s, output: 502.85 toks/s]
Processed prompts:  15%|█▌        | 157/1024 [00:01<00:09, 93.37it/s, est. speed input: 114495.61 toks/s, output: 111.81 toks/s] 
Processed prompts:  18%|█▊        | 181/1024 [00:01<00:11, 72.78it/s, est. speed input: 92701.80 toks/s, output: 90.53 toks/s]  
Processed prompts:  19%|█▉        | 196/1024 [00:02<00:13, 63.43it/s, est. speed input: 83830.05 toks/s, output: 81.86 toks/s]
Processed prompts:  20%|██        | 207/1024 [00:02<00:13, 62.80it/s, est. speed input: 82168.04 toks/s, output: 80.24 toks/s]
Processed prompts:  21%|██        | 216/1024 [00:02<00:13, 59.50it/s, est. speed input: 79620.17 toks/s, output: 77.75 toks/s]
Processed prompts:  22%|██▏       | 224/1024 [00:02<00:14, 55.54it/s, est. speed input: 77118.05 toks/s, output: 75.31 toks/s]
Processed prompts:  23%|██▎       | 231/1024 [00:03<00:15, 50.91it/s, est. speed input: 74596.78 toks/s, output: 72.85 toks/s]
Processed prompts:  23%|██▎       | 237/1024 [00:03<00:17, 45.65it/s, est. speed input: 71997.24 toks/s, output: 70.31 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:03<00:19, 40.11it/s, est. speed input: 69372.35 toks/s, output: 67.75 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:03<00:19, 40.10it/s, est. speed input: 67871.65 toks/s, output: 66.28 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:03<00:19, 40.25it/s, est. speed input: 66568.90 toks/s, output: 65.01 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:04<00:18, 40.33it/s, est. speed input: 65383.14 toks/s, output: 63.85 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:04<00:18, 40.26it/s, est. speed input: 64271.18 toks/s, output: 62.76 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:04<00:18, 40.17it/s, est. speed input: 63245.44 toks/s, output: 61.76 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:04<00:18, 40.15it/s, est. speed input: 62317.20 toks/s, output: 60.86 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:04<00:18, 40.21it/s, est. speed input: 61478.91 toks/s, output: 60.04 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:05<00:17, 41.40it/s, est. speed input: 60923.73 toks/s, output: 59.50 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:05<00:17, 41.13it/s, est. speed input: 60204.08 toks/s, output: 58.79 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:05<00:17, 40.86it/s, est. speed input: 59523.26 toks/s, output: 58.13 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:05<00:17, 40.69it/s, est. speed input: 58891.79 toks/s, output: 57.51 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:05<00:16, 40.54it/s, est. speed input: 58296.72 toks/s, output: 56.93 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:06<00:16, 40.51it/s, est. speed input: 57752.47 toks/s, output: 56.40 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:06<00:16, 40.45it/s, est. speed input: 57236.56 toks/s, output: 55.89 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:06<00:16, 40.36it/s, est. speed input: 56744.33 toks/s, output: 55.41 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:06<00:16, 40.28it/s, est. speed input: 56279.35 toks/s, output: 54.96 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:06<00:16, 40.29it/s, est. speed input: 55850.29 toks/s, output: 54.54 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:07<00:15, 40.32it/s, est. speed input: 55447.03 toks/s, output: 54.15 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [00:07<00:15, 40.22it/s, est. speed input: 55052.07 toks/s, output: 53.76 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:07<00:15, 40.14it/s, est. speed input: 54676.10 toks/s, output: 53.39 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:07<00:15, 40.17it/s, est. speed input: 54329.18 toks/s, output: 53.06 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:07<00:15, 40.15it/s, est. speed input: 53995.45 toks/s, output: 52.73 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:08<00:14, 40.23it/s, est. speed input: 53688.69 toks/s, output: 52.43 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:08<00:14, 41.35it/s, est. speed input: 53505.47 toks/s, output: 52.25 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:08<00:14, 40.91it/s, est. speed input: 53208.11 toks/s, output: 51.96 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:08<00:14, 40.64it/s, est. speed input: 52927.33 toks/s, output: 51.69 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:08<00:13, 40.55it/s, est. speed input: 52668.31 toks/s, output: 51.43 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:09<00:13, 40.43it/s, est. speed input: 52415.72 toks/s, output: 51.19 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:09<00:13, 40.37it/s, est. speed input: 52175.78 toks/s, output: 50.95 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:09<00:13, 40.44it/s, est. speed input: 51955.90 toks/s, output: 50.74 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:09<00:13, 40.38it/s, est. speed input: 51735.45 toks/s, output: 50.52 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:09<00:13, 40.34it/s, est. speed input: 51524.19 toks/s, output: 50.32 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:10<00:12, 40.28it/s, est. speed input: 51318.74 toks/s, output: 50.12 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:10<00:12, 40.36it/s, est. speed input: 51131.06 toks/s, output: 49.93 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:10<00:12, 40.42it/s, est. speed input: 50950.23 toks/s, output: 49.76 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:10<00:12, 40.45it/s, est. speed input: 50775.60 toks/s, output: 49.59 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:10<00:12, 40.45it/s, est. speed input: 50605.54 toks/s, output: 49.42 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:11<00:11, 40.37it/s, est. speed input: 50435.75 toks/s, output: 49.25 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:11<00:11, 40.36it/s, est. speed input: 50275.66 toks/s, output: 49.10 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:11<00:11, 40.44it/s, est. speed input: 50126.31 toks/s, output: 48.95 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:11<00:11, 40.50it/s, est. speed input: 49982.92 toks/s, output: 48.81 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:11<00:11, 40.50it/s, est. speed input: 49841.58 toks/s, output: 48.67 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:12<00:10, 40.45it/s, est. speed input: 49701.12 toks/s, output: 48.54 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:12<00:10, 40.39it/s, est. speed input: 49563.88 toks/s, output: 48.40 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:12<00:10, 40.36it/s, est. speed input: 49431.29 toks/s, output: 48.27 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:12<00:10, 40.40it/s, est. speed input: 49307.38 toks/s, output: 48.15 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:12<00:10, 40.40it/s, est. speed input: 49184.87 toks/s, output: 48.03 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:13<00:09, 40.34it/s, est. speed input: 49062.68 toks/s, output: 47.91 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:13<00:09, 40.28it/s, est. speed input: 48943.27 toks/s, output: 47.80 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:13<00:09, 40.27it/s, est. speed input: 48828.97 toks/s, output: 47.68 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:13<00:09, 40.37it/s, est. speed input: 48724.42 toks/s, output: 47.58 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:13<00:09, 40.45it/s, est. speed input: 48623.44 toks/s, output: 47.48 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:14<00:08, 40.42it/s, est. speed input: 48520.38 toks/s, output: 47.38 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:14<00:08, 40.34it/s, est. speed input: 48416.90 toks/s, output: 47.28 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:14<00:08, 40.34it/s, est. speed input: 48319.27 toks/s, output: 47.19 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:14<00:08, 40.41it/s, est. speed input: 48228.06 toks/s, output: 47.10 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:14<00:08, 40.40it/s, est. speed input: 48136.17 toks/s, output: 47.01 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:15<00:07, 40.39it/s, est. speed input: 48046.83 toks/s, output: 46.92 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:15<00:07, 40.25it/s, est. speed input: 47952.78 toks/s, output: 46.83 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:15<00:07, 40.29it/s, est. speed input: 47868.22 toks/s, output: 46.75 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:15<00:07, 40.35it/s, est. speed input: 47787.24 toks/s, output: 46.67 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:15<00:07, 40.43it/s, est. speed input: 47710.21 toks/s, output: 46.59 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:16<00:06, 40.40it/s, est. speed input: 47631.19 toks/s, output: 46.51 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:16<00:06, 40.36it/s, est. speed input: 47552.52 toks/s, output: 46.44 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:16<00:06, 40.28it/s, est. speed input: 47473.57 toks/s, output: 46.36 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:16<00:06, 40.36it/s, est. speed input: 47402.93 toks/s, output: 46.29 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:16<00:06, 40.39it/s, est. speed input: 47332.74 toks/s, output: 46.22 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:17<00:05, 41.51it/s, est. speed input: 47312.67 toks/s, output: 46.20 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:17<00:05, 41.15it/s, est. speed input: 47243.35 toks/s, output: 46.14 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:17<00:05, 40.85it/s, est. speed input: 47173.67 toks/s, output: 46.07 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:17<00:05, 40.63it/s, est. speed input: 47104.72 toks/s, output: 46.00 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:17<00:05, 40.55it/s, est. speed input: 47040.30 toks/s, output: 45.94 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:18<00:04, 40.48it/s, est. speed input: 46977.13 toks/s, output: 45.88 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:18<00:04, 40.41it/s, est. speed input: 46914.23 toks/s, output: 45.81 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [00:18<00:04, 40.39it/s, est. speed input: 46853.80 toks/s, output: 45.76 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [00:18<00:04, 40.42it/s, est. speed input: 46796.43 toks/s, output: 45.70 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:18<00:04, 40.47it/s, est. speed input: 46741.60 toks/s, output: 45.65 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [00:18<00:03, 40.44it/s, est. speed input: 46685.20 toks/s, output: 45.59 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [00:19<00:03, 40.39it/s, est. speed input: 46628.93 toks/s, output: 45.54 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [00:19<00:03, 40.36it/s, est. speed input: 46573.85 toks/s, output: 45.48 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [00:19<00:03, 40.33it/s, est. speed input: 46519.70 toks/s, output: 45.43 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [00:19<00:03, 40.30it/s, est. speed input: 46466.28 toks/s, output: 45.38 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [00:19<00:02, 40.30it/s, est. speed input: 46414.46 toks/s, output: 45.33 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [00:20<00:02, 40.22it/s, est. speed input: 46361.06 toks/s, output: 45.27 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [00:20<00:02, 40.20it/s, est. speed input: 46309.53 toks/s, output: 45.22 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [00:20<00:02, 40.21it/s, est. speed input: 46260.36 toks/s, output: 45.18 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [00:20<00:02, 40.20it/s, est. speed input: 46211.21 toks/s, output: 45.13 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [00:20<00:01, 40.24it/s, est. speed input: 46164.98 toks/s, output: 45.08 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [00:21<00:01, 40.25it/s, est. speed input: 46118.54 toks/s, output: 45.04 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [00:21<00:01, 40.32it/s, est. speed input: 46075.47 toks/s, output: 45.00 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [00:21<00:01, 40.36it/s, est. speed input: 46032.74 toks/s, output: 44.95 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [00:21<00:01, 40.32it/s, est. speed input: 45988.61 toks/s, output: 44.91 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [00:21<00:00, 40.29it/s, est. speed input: 45944.95 toks/s, output: 44.87 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [00:22<00:00, 40.25it/s, est. speed input: 45901.67 toks/s, output: 44.83 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [00:22<00:00, 40.26it/s, est. speed input: 45860.27 toks/s, output: 44.79 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [00:22<00:00, 40.23it/s, est. speed input: 45818.73 toks/s, output: 44.74 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [00:22<00:00, 41.70it/s, est. speed input: 45825.21 toks/s, output: 44.75 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:22<00:00, 41.70it/s, est. speed input: 46094.75 toks/s, output: 45.01 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:22<00:00, 45.01it/s, est. speed input: 46094.75 toks/s, output: 45.01 toks/s]
[rank0]:[W126 11:27:20.961972683 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=16384 ==========
Time: 2026-01-26 11:27:23
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=2048, max_num_seqs=16
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 2048 --max-num-seqs 16 --max-model-len 1025 --max-num-batched-tokens 16384 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-7B-INT8_M16384.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 11:27:41 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1286359) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1286359) WARNING 01-26 11:27:58 [backends.py:609] Failed to read file <frozen os>
Throughput: 41.12 requests/s, 42152.79 total tokens/s, 41.12 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048

STDERR:
[2026-01-26 11:27:40] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 11:27:41] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 11:27:41] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 11:27:41] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:27:41] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:27:41] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:27:41] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:27:41] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:27:41] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 11:27:41] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 11:27:41] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 11:27:41] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 11:27:41] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 11:27:41] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 11:27:47] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 11:27:48] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 11:27:48] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 11:27:48] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:27:48] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:27:48] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:27:48] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:27:48] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:27:48] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 11:27:48] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 11:27:48] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 11:27:48] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 11:27:48] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 11:27:48] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1286359) [2026-01-26 11:27:50] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1286359) [2026-01-26 11:27:50] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1286359) [2026-01-26 11:27:50] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1286359) [2026-01-26 11:27:50] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1286359) [2026-01-26 11:27:50] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1286359) [2026-01-26 11:27:50] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1286359) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1286359) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.93it/s]
(EngineCore_DP0 pid=1286359) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.39it/s]
(EngineCore_DP0 pid=1286359) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.45it/s]
(EngineCore_DP0 pid=1286359) 
(EngineCore_DP0 pid=1286359) [2026-01-26 11:27:52] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=1286359) [2026-01-26 11:27:52] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 15482880 bytes
(EngineCore_DP0 pid=1286359) [2026-01-26 11:27:52] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=1286359) [2026-01-26 11:27:52] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12042240 bytes
(EngineCore_DP0 pid=1286359) [2026-01-26 11:27:52] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=1286359) [2026-01-26 11:27:52] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 127303680 bytes
(EngineCore_DP0 pid=1286359) [2026-01-26 11:27:52] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=1286359) [2026-01-26 11:27:52] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 63651840 bytes
(EngineCore_DP0 pid=1286359) [rank0]:W0126 11:28:04.331000 1286359 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1286359) [rank0]:W0126 11:28:04.407000 1286359 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1286359) [rank0]:W0126 11:28:05.364000 1286359 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1286359) [rank0]:W0126 11:28:05.486000 1286359 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1286359) 2026-01-26 11:28:09,228 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1286359) 2026-01-26 11:28:09,254 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1286359) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  29%|██▊       | 2/7 [00:00<00:00, 13.82it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  57%|█████▋    | 4/7 [00:00<00:00, 10.67it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  86%|████████▌ | 6/7 [00:01<00:00,  4.70it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:01<00:00,  5.25it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:01<00:00,  5.87it/s]
(EngineCore_DP0 pid=1286359) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  40%|████      | 2/5 [00:00<00:00, 19.37it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00, 20.25it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00, 20.13it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   1%|          | 22/2048 [00:00<00:09, 217.21it/s]
Adding requests:   3%|▎         | 62/2048 [00:00<00:06, 323.91it/s]
Adding requests:   5%|▍         | 98/2048 [00:00<00:05, 339.01it/s]
Adding requests:   7%|▋         | 136/2048 [00:00<00:05, 355.10it/s]
Adding requests:   9%|▊         | 176/2048 [00:00<00:05, 367.23it/s]
Adding requests:  11%|█         | 216/2048 [00:00<00:04, 377.39it/s]
Adding requests:  12%|█▏        | 254/2048 [00:00<00:04, 377.78it/s]
Adding requests:  14%|█▍        | 293/2048 [00:00<00:04, 380.30it/s]
Adding requests:  16%|█▋        | 335/2048 [00:00<00:04, 390.64it/s]
Adding requests:  18%|█▊        | 375/2048 [00:01<00:04, 392.75it/s]
Adding requests:  20%|██        | 417/2048 [00:01<00:04, 399.95it/s]
Adding requests:  22%|██▏       | 457/2048 [00:01<00:04, 395.32it/s]
Adding requests:  24%|██▍       | 500/2048 [00:01<00:03, 403.97it/s]
Adding requests:  27%|██▋       | 543/2048 [00:01<00:03, 408.89it/s]
Adding requests:  29%|██▊       | 584/2048 [00:01<00:03, 403.98it/s]
Adding requests:  31%|███       | 625/2048 [00:01<00:03, 395.94it/s]
Adding requests:  32%|███▏      | 665/2048 [00:01<00:03, 388.54it/s]
Adding requests:  34%|███▍      | 705/2048 [00:01<00:03, 390.81it/s]
Adding requests:  36%|███▋      | 745/2048 [00:01<00:03, 385.55it/s]
Adding requests:  38%|███▊      | 784/2048 [00:02<00:03, 380.60it/s]
Adding requests:  40%|████      | 823/2048 [00:02<00:03, 379.97it/s]
Adding requests:  42%|████▏     | 863/2048 [00:02<00:03, 383.53it/s]
Adding requests:  44%|████▍     | 903/2048 [00:02<00:02, 387.87it/s]
Adding requests:  46%|████▌     | 942/2048 [00:02<00:02, 379.64it/s]
Adding requests:  48%|████▊     | 981/2048 [00:02<00:02, 378.90it/s]
Adding requests:  50%|████▉     | 1019/2048 [00:02<00:02, 374.12it/s]
Adding requests:  52%|█████▏    | 1057/2048 [00:02<00:02, 372.86it/s]
Adding requests:  53%|█████▎    | 1095/2048 [00:02<00:02, 370.76it/s]
Adding requests:  55%|█████▌    | 1135/2048 [00:02<00:02, 378.28it/s]
Adding requests:  57%|█████▋    | 1173/2048 [00:03<00:02, 376.09it/s]
Adding requests:  59%|█████▉    | 1212/2048 [00:03<00:02, 378.42it/s]
Adding requests:  61%|██████    | 1250/2048 [00:03<00:02, 378.64it/s]
Adding requests:  63%|██████▎   | 1288/2048 [00:03<00:02, 374.93it/s]
Adding requests:  65%|██████▍   | 1328/2048 [00:03<00:01, 378.57it/s]
Adding requests:  67%|██████▋   | 1368/2048 [00:03<00:01, 381.79it/s]
Adding requests:  69%|██████▊   | 1407/2048 [00:03<00:01, 382.00it/s]
Adding requests:  71%|███████   | 1446/2048 [00:03<00:01, 381.44it/s]
Adding requests:  73%|███████▎  | 1487/2048 [00:03<00:01, 388.27it/s]
Adding requests:  75%|███████▍  | 1527/2048 [00:04<00:01, 388.97it/s]
Adding requests:  76%|███████▋  | 1566/2048 [00:04<00:01, 381.86it/s]
Adding requests:  78%|███████▊  | 1605/2048 [00:04<00:01, 377.07it/s]
Adding requests:  80%|████████  | 1643/2048 [00:04<00:01, 368.82it/s]
Adding requests:  82%|████████▏ | 1680/2048 [00:04<00:01, 366.30it/s]
Adding requests:  84%|████████▍ | 1719/2048 [00:04<00:00, 371.71it/s]
Adding requests:  86%|████████▌ | 1758/2048 [00:04<00:00, 374.55it/s]
Adding requests:  88%|████████▊ | 1797/2048 [00:04<00:00, 376.47it/s]
Adding requests:  90%|████████▉ | 1835/2048 [00:04<00:00, 377.31it/s]
Adding requests:  92%|█████████▏| 1874/2048 [00:04<00:00, 378.74it/s]
Adding requests:  93%|█████████▎| 1912/2048 [00:05<00:00, 374.40it/s]
Adding requests:  95%|█████████▌| 1952/2048 [00:05<00:00, 380.23it/s]
Adding requests:  97%|█████████▋| 1991/2048 [00:05<00:00, 376.56it/s]
Adding requests:  99%|█████████▉| 2029/2048 [00:05<00:00, 368.64it/s]
Adding requests: 100%|██████████| 2048/2048 [00:05<00:00, 378.88it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  10%|█         | 210/2048 [00:00<00:01, 1793.61it/s, est. speed input: 1837303.13 toks/s, output: 1793.76 toks/s]
Processed prompts:  19%|█▉        | 390/2048 [00:04<00:21, 75.57it/s, est. speed input: 91546.33 toks/s, output: 89.40 toks/s]      
Processed prompts:  23%|██▎       | 467/2048 [00:06<00:25, 61.79it/s, est. speed input: 76098.62 toks/s, output: 74.31 toks/s]
Processed prompts:  25%|██▍       | 511/2048 [00:07<00:25, 60.78it/s, est. speed input: 74061.99 toks/s, output: 72.33 toks/s]
Processed prompts:  26%|██▋       | 540/2048 [00:07<00:26, 55.89it/s, est. speed input: 70491.68 toks/s, output: 68.84 toks/s]
Processed prompts:  27%|██▋       | 560/2048 [00:08<00:26, 55.29it/s, est. speed input: 69636.68 toks/s, output: 68.00 toks/s]
Processed prompts:  28%|██▊       | 575/2048 [00:08<00:27, 52.69it/s, est. speed input: 68277.98 toks/s, output: 66.68 toks/s]
Processed prompts:  29%|██▊       | 587/2048 [00:09<00:30, 48.69it/s, est. speed input: 66683.79 toks/s, output: 65.12 toks/s]
Processed prompts:  29%|██▉       | 596/2048 [00:09<00:33, 43.45it/s, est. speed input: 64915.63 toks/s, output: 63.39 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [00:09<00:34, 41.74it/s, est. speed input: 63796.19 toks/s, output: 62.30 toks/s]
Processed prompts:  31%|███       | 626/2048 [00:10<00:34, 41.53it/s, est. speed input: 62954.58 toks/s, output: 61.48 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [00:10<00:33, 41.45it/s, est. speed input: 62192.39 toks/s, output: 60.73 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [00:10<00:33, 41.29it/s, est. speed input: 61465.35 toks/s, output: 60.02 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [00:11<00:33, 41.30it/s, est. speed input: 60812.72 toks/s, output: 59.39 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [00:11<00:32, 41.23it/s, est. speed input: 60189.16 toks/s, output: 58.78 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [00:12<00:32, 41.16it/s, est. speed input: 59603.08 toks/s, output: 58.21 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [00:12<00:32, 41.20it/s, est. speed input: 59067.33 toks/s, output: 57.68 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [00:12<00:31, 41.10it/s, est. speed input: 58544.71 toks/s, output: 57.17 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [00:13<00:31, 41.11it/s, est. speed input: 58063.65 toks/s, output: 56.70 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [00:13<00:31, 41.14it/s, est. speed input: 57614.36 toks/s, output: 56.26 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [00:14<00:30, 41.73it/s, est. speed input: 57260.97 toks/s, output: 55.92 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [00:14<00:29, 41.60it/s, est. speed input: 56859.19 toks/s, output: 55.53 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [00:14<00:29, 41.37it/s, est. speed input: 56462.01 toks/s, output: 55.14 toks/s]
Processed prompts:  41%|████      | 834/2048 [00:15<00:29, 41.28it/s, est. speed input: 56093.80 toks/s, output: 54.78 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [00:15<00:29, 41.19it/s, est. speed input: 55740.47 toks/s, output: 54.43 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [00:16<00:28, 41.15it/s, est. speed input: 55406.80 toks/s, output: 54.11 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [00:16<00:28, 41.08it/s, est. speed input: 55084.45 toks/s, output: 53.79 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [00:16<00:28, 41.03it/s, est. speed input: 54777.56 toks/s, output: 53.49 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [00:17<00:27, 41.05it/s, est. speed input: 54489.48 toks/s, output: 53.21 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [00:17<00:27, 41.03it/s, est. speed input: 54211.61 toks/s, output: 52.94 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [00:17<00:26, 40.99it/s, est. speed input: 53942.76 toks/s, output: 52.68 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [00:18<00:26, 40.98it/s, est. speed input: 53686.90 toks/s, output: 52.43 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [00:18<00:26, 41.00it/s, est. speed input: 53444.69 toks/s, output: 52.19 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [00:19<00:25, 40.94it/s, est. speed input: 53205.46 toks/s, output: 51.96 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [00:19<00:25, 40.94it/s, est. speed input: 52980.00 toks/s, output: 51.74 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [00:19<00:24, 40.93it/s, est. speed input: 52761.69 toks/s, output: 51.52 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [00:20<00:24, 40.92it/s, est. speed input: 52552.26 toks/s, output: 51.32 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [00:20<00:24, 40.92it/s, est. speed input: 52350.64 toks/s, output: 51.12 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [00:21<00:23, 40.87it/s, est. speed input: 52152.85 toks/s, output: 50.93 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [00:21<00:23, 40.88it/s, est. speed input: 51965.78 toks/s, output: 50.75 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [00:21<00:23, 40.87it/s, est. speed input: 51784.54 toks/s, output: 50.57 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [00:22<00:22, 40.87it/s, est. speed input: 51609.96 toks/s, output: 50.40 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [00:22<00:22, 40.90it/s, est. speed input: 51443.13 toks/s, output: 50.24 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [00:23<00:21, 40.86it/s, est. speed input: 51278.07 toks/s, output: 50.08 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [00:23<00:21, 40.83it/s, est. speed input: 51118.46 toks/s, output: 49.92 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [00:23<00:21, 40.83it/s, est. speed input: 50965.10 toks/s, output: 49.77 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [00:24<00:20, 41.50it/s, est. speed input: 50861.18 toks/s, output: 49.67 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [00:24<00:20, 41.34it/s, est. speed input: 50719.78 toks/s, output: 49.53 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [00:24<00:19, 41.80it/s, est. speed input: 50618.91 toks/s, output: 49.43 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [00:25<00:19, 41.47it/s, est. speed input: 50480.54 toks/s, output: 49.30 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [00:25<00:18, 41.36it/s, est. speed input: 50353.70 toks/s, output: 49.17 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [00:26<00:18, 41.13it/s, est. speed input: 50221.45 toks/s, output: 49.04 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [00:26<00:18, 41.10it/s, est. speed input: 50101.06 toks/s, output: 48.93 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [00:26<00:17, 40.96it/s, est. speed input: 49976.76 toks/s, output: 48.81 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [00:27<00:17, 41.51it/s, est. speed input: 49893.56 toks/s, output: 48.72 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [00:27<00:16, 41.38it/s, est. speed input: 49783.17 toks/s, output: 48.62 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [00:28<00:16, 41.14it/s, est. speed input: 49667.85 toks/s, output: 48.50 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [00:28<00:16, 41.09it/s, est. speed input: 49562.08 toks/s, output: 48.40 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [00:28<00:15, 40.95it/s, est. speed input: 49453.66 toks/s, output: 48.29 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [00:29<00:15, 40.81it/s, est. speed input: 49345.80 toks/s, output: 48.19 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [00:29<00:15, 40.86it/s, est. speed input: 49248.24 toks/s, output: 48.09 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [00:30<00:14, 40.81it/s, est. speed input: 49149.40 toks/s, output: 48.00 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [00:30<00:14, 41.48it/s, est. speed input: 49088.66 toks/s, output: 47.94 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [00:30<00:13, 41.30it/s, est. speed input: 48996.73 toks/s, output: 47.85 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [00:31<00:13, 41.10it/s, est. speed input: 48903.57 toks/s, output: 47.76 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [00:31<00:13, 41.02it/s, est. speed input: 48815.47 toks/s, output: 47.67 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [00:31<00:12, 41.59it/s, est. speed input: 48759.63 toks/s, output: 47.62 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [00:32<00:12, 41.31it/s, est. speed input: 48673.27 toks/s, output: 47.53 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [00:32<00:11, 41.88it/s, est. speed input: 48623.77 toks/s, output: 47.48 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [00:33<00:11, 41.48it/s, est. speed input: 48539.64 toks/s, output: 47.40 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [00:33<00:11, 41.28it/s, est. speed input: 48460.84 toks/s, output: 47.32 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [00:33<00:10, 41.12it/s, est. speed input: 48383.05 toks/s, output: 47.25 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [00:34<00:10, 41.64it/s, est. speed input: 48334.47 toks/s, output: 47.20 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [00:34<00:10, 41.38it/s, est. speed input: 48260.35 toks/s, output: 47.13 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [00:35<00:09, 41.15it/s, est. speed input: 48185.30 toks/s, output: 47.06 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [00:35<00:09, 40.99it/s, est. speed input: 48112.13 toks/s, output: 46.98 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [00:35<00:08, 40.93it/s, est. speed input: 48042.89 toks/s, output: 46.92 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [00:36<00:08, 40.84it/s, est. speed input: 47972.97 toks/s, output: 46.85 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [00:36<00:08, 40.80it/s, est. speed input: 47905.45 toks/s, output: 46.78 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [00:37<00:07, 41.42it/s, est. speed input: 47866.01 toks/s, output: 46.74 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [00:37<00:07, 41.85it/s, est. speed input: 47826.49 toks/s, output: 46.71 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [00:37<00:06, 41.61it/s, est. speed input: 47766.67 toks/s, output: 46.65 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [00:38<00:06, 41.28it/s, est. speed input: 47701.86 toks/s, output: 46.58 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [00:38<00:06, 41.09it/s, est. speed input: 47640.04 toks/s, output: 46.52 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [00:38<00:05, 41.03it/s, est. speed input: 47581.93 toks/s, output: 46.47 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [00:39<00:05, 40.89it/s, est. speed input: 47521.46 toks/s, output: 46.41 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [00:39<00:05, 40.90it/s, est. speed input: 47466.12 toks/s, output: 46.35 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [00:40<00:04, 40.82it/s, est. speed input: 47408.78 toks/s, output: 46.30 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [00:40<00:04, 40.73it/s, est. speed input: 47351.11 toks/s, output: 46.24 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [00:40<00:03, 41.38it/s, est. speed input: 47320.73 toks/s, output: 46.21 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [00:41<00:03, 41.17it/s, est. speed input: 47266.71 toks/s, output: 46.16 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [00:41<00:03, 41.03it/s, est. speed input: 47214.14 toks/s, output: 46.11 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [00:42<00:02, 40.88it/s, est. speed input: 47160.63 toks/s, output: 46.06 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [00:42<00:02, 40.83it/s, est. speed input: 47110.06 toks/s, output: 46.01 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [00:42<00:01, 40.77it/s, est. speed input: 47059.53 toks/s, output: 45.96 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [00:43<00:01, 41.44it/s, est. speed input: 47034.26 toks/s, output: 45.93 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [00:43<00:01, 41.24it/s, est. speed input: 46986.69 toks/s, output: 45.89 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [00:44<00:00, 41.04it/s, est. speed input: 46938.09 toks/s, output: 45.84 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [00:44<00:00, 41.78it/s, est. speed input: 46919.45 toks/s, output: 45.82 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:44<00:00, 41.78it/s, est. speed input: 47241.80 toks/s, output: 46.13 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:44<00:00, 46.13it/s, est. speed input: 47241.80 toks/s, output: 46.13 toks/s]
[rank0]:[W126 11:29:02.456730879 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=32768 ==========
Time: 2026-01-26 11:29:04
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=4096, max_num_seqs=32
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 4096 --max-num-seqs 32 --max-model-len 1025 --max-num-batched-tokens 32768 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-7B-INT8_M32768.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 11:29:32 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1288312) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1288312) WARNING 01-26 11:29:49 [backends.py:609] Failed to read file <frozen os>
Throughput: 41.07 requests/s, 42101.12 total tokens/s, 41.07 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096

STDERR:
[2026-01-26 11:29:32] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 11:29:32] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 11:29:32] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 11:29:32] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:29:32] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:29:32] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:29:32] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:29:32] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:29:32] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 11:29:32] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 11:29:32] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 11:29:32] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 11:29:32] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 11:29:32] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 11:29:39] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 11:29:39] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 11:29:39] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 11:29:39] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:29:40] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:29:40] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:29:40] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:29:40] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:29:40] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 11:29:40] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 11:29:40] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 11:29:40] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 11:29:40] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 11:29:40] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1288312) [2026-01-26 11:29:41] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1288312) [2026-01-26 11:29:41] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1288312) [2026-01-26 11:29:41] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1288312) [2026-01-26 11:29:41] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1288312) [2026-01-26 11:29:41] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1288312) [2026-01-26 11:29:41] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1288312) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1288312) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.94it/s]
(EngineCore_DP0 pid=1288312) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.39it/s]
(EngineCore_DP0 pid=1288312) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.45it/s]
(EngineCore_DP0 pid=1288312) 
(EngineCore_DP0 pid=1288312) [2026-01-26 11:29:43] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=1288312) [2026-01-26 11:29:43] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 15482880 bytes
(EngineCore_DP0 pid=1288312) [2026-01-26 11:29:43] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=1288312) [2026-01-26 11:29:43] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12042240 bytes
(EngineCore_DP0 pid=1288312) [2026-01-26 11:29:43] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=1288312) [2026-01-26 11:29:43] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 127303680 bytes
(EngineCore_DP0 pid=1288312) [2026-01-26 11:29:43] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=1288312) [2026-01-26 11:29:43] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 63651840 bytes
(EngineCore_DP0 pid=1288312) [rank0]:W0126 11:29:54.941000 1288312 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1288312) [rank0]:W0126 11:29:55.020000 1288312 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1288312) [rank0]:W0126 11:29:56.266000 1288312 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1288312) [rank0]:W0126 11:29:56.393000 1288312 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1288312) 2026-01-26 11:30:00,170 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1288312) 2026-01-26 11:30:00,330 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1288312) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   9%|▉         | 1/11 [00:00<00:03,  2.76it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  18%|█▊        | 2/11 [00:00<00:02,  4.39it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  36%|███▋      | 4/11 [00:00<00:01,  6.58it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  55%|█████▍    | 6/11 [00:00<00:00,  9.24it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  73%|███████▎  | 8/11 [00:00<00:00, 11.80it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  91%|█████████ | 10/11 [00:01<00:00, 13.84it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00,  8.43it/s]
(EngineCore_DP0 pid=1288312) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  14%|█▍        | 1/7 [00:00<00:03,  1.95it/s]
Capturing CUDA graphs (decode, FULL):  29%|██▊       | 2/7 [00:00<00:01,  3.49it/s]
Capturing CUDA graphs (decode, FULL):  57%|█████▋    | 4/7 [00:00<00:00,  7.06it/s]
Capturing CUDA graphs (decode, FULL):  86%|████████▌ | 6/7 [00:00<00:00,  8.13it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:01<00:00,  6.96it/s]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   1%|          | 25/4096 [00:00<00:16, 245.65it/s]
Adding requests:   2%|▏         | 65/4096 [00:00<00:12, 334.34it/s]
Adding requests:   2%|▏         | 101/4096 [00:00<00:11, 343.83it/s]
Adding requests:   3%|▎         | 139/4096 [00:00<00:11, 357.26it/s]
Adding requests:   4%|▍         | 178/4096 [00:00<00:10, 368.50it/s]
Adding requests:   5%|▌         | 220/4096 [00:00<00:10, 384.40it/s]
Adding requests:   6%|▋         | 259/4096 [00:00<00:10, 379.41it/s]
Adding requests:   7%|▋         | 299/4096 [00:00<00:09, 384.44it/s]
Adding requests:   8%|▊         | 340/4096 [00:00<00:09, 389.95it/s]
Adding requests:   9%|▉         | 380/4096 [00:01<00:09, 389.74it/s]
Adding requests:  10%|█         | 422/4096 [00:01<00:09, 397.38it/s]
Adding requests:  11%|█▏        | 462/4096 [00:01<00:09, 394.20it/s]
Adding requests:  12%|█▏        | 504/4096 [00:01<00:08, 401.88it/s]
Adding requests:  13%|█▎        | 546/4096 [00:01<00:08, 406.38it/s]
Adding requests:  14%|█▍        | 587/4096 [00:01<00:08, 401.36it/s]
Adding requests:  15%|█▌        | 628/4096 [00:01<00:08, 396.33it/s]
Adding requests:  16%|█▋        | 668/4096 [00:01<00:08, 385.67it/s]
Adding requests:  17%|█▋        | 709/4096 [00:01<00:08, 390.06it/s]
Adding requests:  18%|█▊        | 749/4096 [00:01<00:08, 382.13it/s]
Adding requests:  19%|█▉        | 789/4096 [00:02<00:08, 385.42it/s]
Adding requests:  20%|██        | 828/4096 [00:02<00:08, 383.84it/s]
Adding requests:  21%|██        | 868/4096 [00:02<00:08, 387.16it/s]
Adding requests:  22%|██▏       | 909/4096 [00:02<00:08, 391.46it/s]
Adding requests:  23%|██▎       | 949/4096 [00:02<00:08, 382.68it/s]
Adding requests:  24%|██▍       | 989/4096 [00:02<00:08, 385.51it/s]
Adding requests:  25%|██▌       | 1028/4096 [00:02<00:08, 382.08it/s]
Adding requests:  26%|██▌       | 1067/4096 [00:02<00:07, 380.01it/s]
Adding requests:  27%|██▋       | 1106/4096 [00:02<00:08, 369.95it/s]
Adding requests:  28%|██▊       | 1146/4096 [00:02<00:07, 377.61it/s]
Adding requests:  29%|██▉       | 1184/4096 [00:03<00:07, 377.67it/s]
Adding requests:  30%|██▉       | 1225/4096 [00:03<00:07, 383.88it/s]
Adding requests:  31%|███       | 1264/4096 [00:03<00:07, 379.69it/s]
Adding requests:  32%|███▏      | 1303/4096 [00:03<00:07, 378.68it/s]
Adding requests:  33%|███▎      | 1341/4096 [00:03<00:07, 377.96it/s]
Adding requests:  34%|███▎      | 1382/4096 [00:03<00:07, 384.34it/s]
Adding requests:  35%|███▍      | 1421/4096 [00:03<00:07, 381.10it/s]
Adding requests:  36%|███▌      | 1460/4096 [00:03<00:06, 382.44it/s]
Adding requests:  37%|███▋      | 1501/4096 [00:03<00:06, 388.39it/s]
Adding requests:  38%|███▊      | 1540/4096 [00:04<00:06, 388.31it/s]
Adding requests:  39%|███▊      | 1579/4096 [00:04<00:06, 376.03it/s]
Adding requests:  39%|███▉      | 1617/4096 [00:04<00:06, 375.34it/s]
Adding requests:  40%|████      | 1655/4096 [00:04<00:06, 369.73it/s]
Adding requests:  41%|████▏     | 1693/4096 [00:04<00:06, 371.89it/s]
Adding requests:  42%|████▏     | 1733/4096 [00:04<00:06, 378.21it/s]
Adding requests:  43%|████▎     | 1774/4096 [00:04<00:06, 385.83it/s]
Adding requests:  44%|████▍     | 1813/4096 [00:04<00:05, 383.68it/s]
Adding requests:  45%|████▌     | 1852/4096 [00:04<00:05, 383.91it/s]
Adding requests:  46%|████▌     | 1892/4096 [00:04<00:05, 388.35it/s]
Adding requests:  47%|████▋     | 1933/4096 [00:05<00:05, 392.67it/s]
Adding requests:  48%|████▊     | 1973/4096 [00:05<00:05, 392.95it/s]
Adding requests:  49%|████▉     | 2013/4096 [00:05<00:05, 388.80it/s]
Adding requests:  50%|█████     | 2052/4096 [00:05<00:05, 382.30it/s]
Adding requests:  51%|█████     | 2091/4096 [00:05<00:05, 374.49it/s]
Adding requests:  52%|█████▏    | 2131/4096 [00:05<00:05, 380.44it/s]
Adding requests:  53%|█████▎    | 2170/4096 [00:05<00:05, 376.14it/s]
Adding requests:  54%|█████▍    | 2208/4096 [00:05<00:05, 371.89it/s]
Adding requests:  55%|█████▍    | 2247/4096 [00:05<00:04, 376.46it/s]
Adding requests:  56%|█████▌    | 2288/4096 [00:05<00:04, 385.76it/s]
Adding requests:  57%|█████▋    | 2327/4096 [00:06<00:04, 380.74it/s]
Adding requests:  58%|█████▊    | 2367/4096 [00:06<00:04, 385.14it/s]
Adding requests:  59%|█████▉    | 2408/4096 [00:06<00:04, 390.99it/s]
Adding requests:  60%|█████▉    | 2448/4096 [00:06<00:04, 392.14it/s]
Adding requests:  61%|██████    | 2488/4096 [00:06<00:04, 392.90it/s]
Adding requests:  62%|██████▏   | 2529/4096 [00:06<00:03, 396.33it/s]
Adding requests:  63%|██████▎   | 2572/4096 [00:06<00:03, 405.71it/s]
Adding requests:  64%|██████▍   | 2613/4096 [00:06<00:03, 402.47it/s]
Adding requests:  65%|██████▍   | 2654/4096 [00:06<00:03, 392.95it/s]
Adding requests:  66%|██████▌   | 2694/4096 [00:07<00:03, 389.87it/s]
Adding requests:  67%|██████▋   | 2734/4096 [00:07<00:03, 387.38it/s]
Adding requests:  68%|██████▊   | 2775/4096 [00:07<00:03, 393.40it/s]
Adding requests:  69%|██████▉   | 2818/4096 [00:07<00:03, 401.34it/s]
Adding requests:  70%|██████▉   | 2859/4096 [00:07<00:03, 399.41it/s]
Adding requests:  71%|███████   | 2899/4096 [00:07<00:03, 396.93it/s]
Adding requests:  72%|███████▏  | 2940/4096 [00:07<00:02, 399.39it/s]
Adding requests:  73%|███████▎  | 2980/4096 [00:07<00:02, 398.52it/s]
Adding requests:  74%|███████▍  | 3021/4096 [00:07<00:02, 400.33it/s]
Adding requests:  75%|███████▍  | 3063/4096 [00:07<00:02, 404.32it/s]
Adding requests:  76%|███████▌  | 3104/4096 [00:08<00:02, 403.36it/s]
Adding requests:  77%|███████▋  | 3146/4096 [00:08<00:02, 404.86it/s]
Adding requests:  78%|███████▊  | 3187/4096 [00:08<00:02, 397.49it/s]
Adding requests:  79%|███████▉  | 3227/4096 [00:08<00:02, 396.10it/s]
Adding requests:  80%|███████▉  | 3267/4096 [00:08<00:02, 392.10it/s]
Adding requests:  81%|████████  | 3307/4096 [00:08<00:02, 382.69it/s]
Adding requests:  82%|████████▏ | 3347/4096 [00:08<00:01, 385.43it/s]
Adding requests:  83%|████████▎ | 3388/4096 [00:08<00:01, 390.61it/s]
Adding requests:  84%|████████▎ | 3428/4096 [00:08<00:01, 390.47it/s]
Adding requests:  85%|████████▍ | 3469/4096 [00:08<00:01, 393.99it/s]
Adding requests:  86%|████████▌ | 3509/4096 [00:09<00:01, 395.44it/s]
Adding requests:  87%|████████▋ | 3550/4096 [00:09<00:01, 399.24it/s]
Adding requests:  88%|████████▊ | 3590/4096 [00:09<00:01, 396.34it/s]
Adding requests:  89%|████████▊ | 3632/4096 [00:09<00:01, 401.27it/s]
Adding requests:  90%|████████▉ | 3673/4096 [00:09<00:01, 379.76it/s]
Adding requests:  91%|█████████ | 3712/4096 [00:09<00:01, 381.18it/s]
Adding requests:  92%|█████████▏| 3751/4096 [00:09<00:00, 380.65it/s]
Adding requests:  93%|█████████▎| 3790/4096 [00:09<00:00, 371.44it/s]
Adding requests:  93%|█████████▎| 3828/4096 [00:09<00:00, 370.20it/s]
Adding requests:  94%|█████████▍| 3867/4096 [00:10<00:00, 375.74it/s]
Adding requests:  95%|█████████▌| 3905/4096 [00:10<00:00, 372.99it/s]
Adding requests:  96%|█████████▋| 3943/4096 [00:10<00:00, 372.38it/s]
Adding requests:  97%|█████████▋| 3981/4096 [00:10<00:00, 374.06it/s]
Adding requests:  98%|█████████▊| 4020/4096 [00:10<00:00, 376.14it/s]
Adding requests:  99%|█████████▉| 4058/4096 [00:10<00:00, 375.08it/s]
Adding requests: 100%|██████████| 4096/4096 [00:10<00:00, 375.28it/s]
Adding requests: 100%|██████████| 4096/4096 [00:10<00:00, 385.23it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  10%|█         | 424/4096 [00:00<00:03, 1174.16it/s, est. speed input: 1202481.83 toks/s, output: 1174.20 toks/s]
Processed prompts:  13%|█▎        | 542/4096 [00:02<00:22, 161.02it/s, est. speed input: 206750.81 toks/s, output: 201.90 toks/s]   
Processed prompts:  15%|█▍        | 594/4096 [00:04<00:34, 102.08it/s, est. speed input: 143628.58 toks/s, output: 140.26 toks/s]
Processed prompts:  15%|█▌        | 624/4096 [00:05<00:40, 86.39it/s, est. speed input: 127573.18 toks/s, output: 124.58 toks/s] 
Processed prompts:  16%|█▌        | 648/4096 [00:05<00:47, 71.89it/s, est. speed input: 114736.71 toks/s, output: 112.05 toks/s]
Processed prompts:  17%|█▋        | 680/4096 [00:06<00:53, 63.52it/s, est. speed input: 106146.09 toks/s, output: 103.66 toks/s]
Processed prompts:  17%|█▋        | 712/4096 [00:07<00:59, 57.30it/s, est. speed input: 99402.83 toks/s, output: 97.07 toks/s]  
Processed prompts:  18%|█▊        | 744/4096 [00:08<01:03, 52.71it/s, est. speed input: 93929.88 toks/s, output: 91.73 toks/s]
Processed prompts:  19%|█▉        | 776/4096 [00:08<01:06, 49.75it/s, est. speed input: 89613.36 toks/s, output: 87.51 toks/s]
Processed prompts:  20%|█▉        | 808/4096 [00:09<01:09, 47.25it/s, est. speed input: 85803.15 toks/s, output: 83.79 toks/s]
Processed prompts:  21%|██        | 840/4096 [00:10<01:11, 45.47it/s, est. speed input: 82560.67 toks/s, output: 80.63 toks/s]
Processed prompts:  21%|██▏       | 872/4096 [00:11<01:12, 44.20it/s, est. speed input: 79757.52 toks/s, output: 77.89 toks/s]
Processed prompts:  22%|██▏       | 904/4096 [00:11<01:13, 43.28it/s, est. speed input: 77312.15 toks/s, output: 75.50 toks/s]
Processed prompts:  23%|██▎       | 936/4096 [00:12<01:14, 42.65it/s, est. speed input: 75169.68 toks/s, output: 73.41 toks/s]
Processed prompts:  24%|██▎       | 968/4096 [00:13<01:14, 42.20it/s, est. speed input: 73270.42 toks/s, output: 71.55 toks/s]
Processed prompts:  24%|██▍       | 1000/4096 [00:14<01:13, 41.84it/s, est. speed input: 71563.72 toks/s, output: 69.89 toks/s]
Processed prompts:  25%|██▌       | 1032/4096 [00:15<01:13, 41.61it/s, est. speed input: 70040.26 toks/s, output: 68.40 toks/s]
Processed prompts:  26%|██▌       | 1064/4096 [00:15<01:13, 41.45it/s, est. speed input: 68665.63 toks/s, output: 67.06 toks/s]
Processed prompts:  27%|██▋       | 1096/4096 [00:16<01:12, 41.31it/s, est. speed input: 67414.07 toks/s, output: 65.83 toks/s]
Processed prompts:  28%|██▊       | 1128/4096 [00:17<01:11, 41.24it/s, est. speed input: 66280.60 toks/s, output: 64.73 toks/s]
Processed prompts:  28%|██▊       | 1160/4096 [00:18<01:11, 41.19it/s, est. speed input: 65244.43 toks/s, output: 63.72 toks/s]
Processed prompts:  29%|██▉       | 1192/4096 [00:18<01:10, 41.47it/s, est. speed input: 64359.99 toks/s, output: 62.85 toks/s]
Processed prompts:  30%|██▉       | 1224/4096 [00:19<01:08, 41.69it/s, est. speed input: 63548.11 toks/s, output: 62.06 toks/s]
Processed prompts:  31%|███       | 1256/4096 [00:20<01:08, 41.49it/s, est. speed input: 62728.02 toks/s, output: 61.26 toks/s]
Processed prompts:  31%|███▏      | 1288/4096 [00:21<01:08, 41.29it/s, est. speed input: 61957.52 toks/s, output: 60.51 toks/s]
Processed prompts:  32%|███▏      | 1320/4096 [00:22<01:06, 41.49it/s, est. speed input: 61301.62 toks/s, output: 59.86 toks/s]
Processed prompts:  33%|███▎      | 1352/4096 [00:22<01:06, 41.36it/s, est. speed input: 60644.05 toks/s, output: 59.22 toks/s]
Processed prompts:  34%|███▍      | 1384/4096 [00:23<01:05, 41.24it/s, est. speed input: 60024.70 toks/s, output: 58.62 toks/s]
Processed prompts:  35%|███▍      | 1416/4096 [00:24<01:05, 41.14it/s, est. speed input: 59444.00 toks/s, output: 58.05 toks/s]
Processed prompts:  35%|███▌      | 1448/4096 [00:25<01:03, 41.40it/s, est. speed input: 58946.42 toks/s, output: 57.56 toks/s]
Processed prompts:  36%|███▌      | 1480/4096 [00:25<01:03, 41.26it/s, est. speed input: 58433.53 toks/s, output: 57.06 toks/s]
Processed prompts:  37%|███▋      | 1512/4096 [00:26<01:02, 41.50it/s, est. speed input: 57996.32 toks/s, output: 56.64 toks/s]
Processed prompts:  38%|███▊      | 1544/4096 [00:27<01:01, 41.68it/s, est. speed input: 57584.01 toks/s, output: 56.23 toks/s]
Processed prompts:  38%|███▊      | 1576/4096 [00:28<01:00, 41.45it/s, est. speed input: 57149.48 toks/s, output: 55.81 toks/s]
Processed prompts:  39%|███▉      | 1608/4096 [00:28<00:59, 41.65it/s, est. speed input: 56782.71 toks/s, output: 55.45 toks/s]
Processed prompts:  40%|████      | 1640/4096 [00:29<00:59, 41.44it/s, est. speed input: 56393.77 toks/s, output: 55.07 toks/s]
Processed prompts:  41%|████      | 1672/4096 [00:30<00:58, 41.32it/s, est. speed input: 56026.55 toks/s, output: 54.71 toks/s]
Processed prompts:  42%|████▏     | 1704/4096 [00:31<00:58, 41.17it/s, est. speed input: 55671.13 toks/s, output: 54.37 toks/s]
Processed prompts:  42%|████▏     | 1736/4096 [00:32<00:56, 41.83it/s, est. speed input: 55415.04 toks/s, output: 54.12 toks/s]
Processed prompts:  43%|████▎     | 1768/4096 [00:32<00:56, 41.53it/s, est. speed input: 55091.20 toks/s, output: 53.80 toks/s]
Processed prompts:  44%|████▍     | 1800/4096 [00:33<00:55, 41.34it/s, est. speed input: 54784.26 toks/s, output: 53.50 toks/s]
Processed prompts:  45%|████▍     | 1832/4096 [00:34<00:54, 41.19it/s, est. speed input: 54488.82 toks/s, output: 53.21 toks/s]
Processed prompts:  46%|████▌     | 1864/4096 [00:35<00:53, 41.42it/s, est. speed input: 54239.57 toks/s, output: 52.97 toks/s]
Processed prompts:  46%|████▋     | 1896/4096 [00:35<00:53, 41.23it/s, est. speed input: 53968.00 toks/s, output: 52.70 toks/s]
Processed prompts:  47%|████▋     | 1928/4096 [00:36<00:52, 41.13it/s, est. speed input: 53710.83 toks/s, output: 52.45 toks/s]
Processed prompts:  48%|████▊     | 1960/4096 [00:37<00:51, 41.38it/s, est. speed input: 53492.59 toks/s, output: 52.24 toks/s]
Processed prompts:  49%|████▊     | 1992/4096 [00:38<00:51, 41.19it/s, est. speed input: 53251.43 toks/s, output: 52.00 toks/s]
Processed prompts:  49%|████▉     | 2024/4096 [00:39<00:50, 41.04it/s, est. speed input: 53018.65 toks/s, output: 51.78 toks/s]
Processed prompts:  50%|█████     | 2056/4096 [00:39<00:49, 41.30it/s, est. speed input: 52825.07 toks/s, output: 51.59 toks/s]
Processed prompts:  51%|█████     | 2088/4096 [00:40<00:48, 41.15it/s, est. speed input: 52612.11 toks/s, output: 51.38 toks/s]
Processed prompts:  52%|█████▏    | 2120/4096 [00:41<00:48, 41.06it/s, est. speed input: 52408.18 toks/s, output: 51.18 toks/s]
Processed prompts:  53%|█████▎    | 2152/4096 [00:42<00:47, 40.96it/s, est. speed input: 52208.72 toks/s, output: 50.99 toks/s]
Processed prompts:  53%|█████▎    | 2184/4096 [00:42<00:46, 41.20it/s, est. speed input: 52040.36 toks/s, output: 50.82 toks/s]
Processed prompts:  54%|█████▍    | 2216/4096 [00:43<00:45, 41.05it/s, est. speed input: 51854.26 toks/s, output: 50.64 toks/s]
Processed prompts:  55%|█████▍    | 2248/4096 [00:44<00:45, 40.94it/s, est. speed input: 51674.14 toks/s, output: 50.46 toks/s]
Processed prompts:  56%|█████▌    | 2280/4096 [00:45<00:44, 40.90it/s, est. speed input: 51503.07 toks/s, output: 50.30 toks/s]
Processed prompts:  56%|█████▋    | 2312/4096 [00:46<00:43, 40.83it/s, est. speed input: 51335.31 toks/s, output: 50.13 toks/s]
Processed prompts:  57%|█████▋    | 2344/4096 [00:46<00:42, 40.80it/s, est. speed input: 51174.20 toks/s, output: 49.97 toks/s]
Processed prompts:  58%|█████▊    | 2376/4096 [00:47<00:42, 40.73it/s, est. speed input: 51014.78 toks/s, output: 49.82 toks/s]
Processed prompts:  59%|█████▉    | 2408/4096 [00:48<00:41, 40.72it/s, est. speed input: 50862.92 toks/s, output: 49.67 toks/s]
Processed prompts:  60%|█████▉    | 2440/4096 [00:49<00:40, 40.70it/s, est. speed input: 50715.73 toks/s, output: 49.53 toks/s]
Processed prompts:  60%|██████    | 2472/4096 [00:50<00:39, 40.70it/s, est. speed input: 50573.40 toks/s, output: 49.39 toks/s]
Processed prompts:  61%|██████    | 2504/4096 [00:50<00:39, 40.70it/s, est. speed input: 50435.94 toks/s, output: 49.25 toks/s]
Processed prompts:  62%|██████▏   | 2536/4096 [00:51<00:38, 41.03it/s, est. speed input: 50322.90 toks/s, output: 49.14 toks/s]
Processed prompts:  63%|██████▎   | 2568/4096 [00:52<00:37, 40.90it/s, est. speed input: 50191.18 toks/s, output: 49.01 toks/s]
Processed prompts:  63%|██████▎   | 2600/4096 [00:53<00:36, 41.13it/s, est. speed input: 50082.54 toks/s, output: 48.91 toks/s]
Processed prompts:  64%|██████▍   | 2632/4096 [00:53<00:35, 40.99it/s, est. speed input: 49959.49 toks/s, output: 48.79 toks/s]
Processed prompts:  65%|██████▌   | 2664/4096 [00:54<00:35, 40.89it/s, est. speed input: 49839.85 toks/s, output: 48.67 toks/s]
Processed prompts:  66%|██████▌   | 2696/4096 [00:55<00:34, 40.80it/s, est. speed input: 49722.48 toks/s, output: 48.56 toks/s]
Processed prompts:  67%|██████▋   | 2728/4096 [00:56<00:33, 41.07it/s, est. speed input: 49627.14 toks/s, output: 48.46 toks/s]
Processed prompts:  67%|██████▋   | 2760/4096 [00:57<00:32, 40.92it/s, est. speed input: 49515.32 toks/s, output: 48.35 toks/s]
Processed prompts:  68%|██████▊   | 2792/4096 [00:57<00:31, 40.86it/s, est. speed input: 49408.98 toks/s, output: 48.25 toks/s]
Processed prompts:  69%|██████▉   | 2824/4096 [00:58<00:31, 40.78it/s, est. speed input: 49303.93 toks/s, output: 48.15 toks/s]
Processed prompts:  70%|██████▉   | 2856/4096 [00:59<00:30, 40.73it/s, est. speed input: 49201.65 toks/s, output: 48.05 toks/s]
Processed prompts:  71%|███████   | 2888/4096 [01:00<00:29, 41.42it/s, est. speed input: 49139.36 toks/s, output: 47.99 toks/s]
Processed prompts:  71%|███████▏  | 2920/4096 [01:00<00:28, 41.54it/s, est. speed input: 49060.27 toks/s, output: 47.91 toks/s]
Processed prompts:  72%|███████▏  | 2952/4096 [01:01<00:27, 41.21it/s, est. speed input: 48962.25 toks/s, output: 47.81 toks/s]
Processed prompts:  73%|███████▎  | 2984/4096 [01:02<00:27, 41.03it/s, est. speed input: 48869.54 toks/s, output: 47.72 toks/s]
Processed prompts:  74%|███████▎  | 3016/4096 [01:03<00:26, 40.85it/s, est. speed input: 48776.47 toks/s, output: 47.63 toks/s]
Processed prompts:  74%|███████▍  | 3048/4096 [01:04<00:25, 40.80it/s, est. speed input: 48688.81 toks/s, output: 47.55 toks/s]
Processed prompts:  75%|███████▌  | 3080/4096 [01:04<00:24, 40.73it/s, est. speed input: 48601.98 toks/s, output: 47.46 toks/s]
Processed prompts:  76%|███████▌  | 3112/4096 [01:05<00:24, 40.62it/s, est. speed input: 48514.45 toks/s, output: 47.38 toks/s]
Processed prompts:  77%|███████▋  | 3144/4096 [01:06<00:23, 40.57it/s, est. speed input: 48430.02 toks/s, output: 47.29 toks/s]
Processed prompts:  78%|███████▊  | 3176/4096 [01:07<00:22, 40.55it/s, est. speed input: 48348.38 toks/s, output: 47.22 toks/s]
Processed prompts:  78%|███████▊  | 3208/4096 [01:08<00:21, 40.54it/s, est. speed input: 48268.51 toks/s, output: 47.14 toks/s]
Processed prompts:  79%|███████▉  | 3240/4096 [01:08<00:21, 40.52it/s, est. speed input: 48190.50 toks/s, output: 47.06 toks/s]
Processed prompts:  80%|███████▉  | 3272/4096 [01:09<00:20, 40.51it/s, est. speed input: 48114.18 toks/s, output: 46.99 toks/s]
Processed prompts:  81%|████████  | 3304/4096 [01:10<00:19, 40.51it/s, est. speed input: 48039.61 toks/s, output: 46.91 toks/s]
Processed prompts:  81%|████████▏ | 3336/4096 [01:11<00:18, 40.47it/s, est. speed input: 47965.10 toks/s, output: 46.84 toks/s]
Processed prompts:  82%|████████▏ | 3368/4096 [01:12<00:17, 40.47it/s, est. speed input: 47893.56 toks/s, output: 46.77 toks/s]
Processed prompts:  83%|████████▎ | 3400/4096 [01:12<00:17, 40.47it/s, est. speed input: 47823.41 toks/s, output: 46.70 toks/s]
Processed prompts:  84%|████████▍ | 3432/4096 [01:13<00:16, 40.46it/s, est. speed input: 47754.44 toks/s, output: 46.64 toks/s]
Processed prompts:  85%|████████▍ | 3464/4096 [01:14<00:15, 40.47it/s, est. speed input: 47687.55 toks/s, output: 46.57 toks/s]
Processed prompts:  85%|████████▌ | 3496/4096 [01:15<00:14, 40.50it/s, est. speed input: 47623.00 toks/s, output: 46.51 toks/s]
Processed prompts:  86%|████████▌ | 3528/4096 [01:15<00:14, 40.52it/s, est. speed input: 47559.88 toks/s, output: 46.45 toks/s]
Processed prompts:  87%|████████▋ | 3560/4096 [01:16<00:13, 40.86it/s, est. speed input: 47511.02 toks/s, output: 46.40 toks/s]
Processed prompts:  88%|████████▊ | 3592/4096 [01:17<00:12, 40.75it/s, est. speed input: 47449.41 toks/s, output: 46.34 toks/s]
Processed prompts:  88%|████████▊ | 3624/4096 [01:18<00:11, 40.68it/s, est. speed input: 47389.22 toks/s, output: 46.28 toks/s]
Processed prompts:  89%|████████▉ | 3656/4096 [01:19<00:10, 40.59it/s, est. speed input: 47328.65 toks/s, output: 46.22 toks/s]
Processed prompts:  90%|█████████ | 3688/4096 [01:19<00:09, 40.90it/s, est. speed input: 47283.79 toks/s, output: 46.18 toks/s]
Processed prompts:  91%|█████████ | 3720/4096 [01:20<00:09, 40.77it/s, est. speed input: 47226.58 toks/s, output: 46.12 toks/s]
Processed prompts:  92%|█████████▏| 3752/4096 [01:21<00:08, 40.68it/s, est. speed input: 47170.21 toks/s, output: 46.06 toks/s]
Processed prompts:  92%|█████████▏| 3784/4096 [01:22<00:07, 40.58it/s, est. speed input: 47113.96 toks/s, output: 46.01 toks/s]
Processed prompts:  93%|█████████▎| 3816/4096 [01:23<00:06, 40.56it/s, est. speed input: 47060.26 toks/s, output: 45.96 toks/s]
Processed prompts:  94%|█████████▍| 3848/4096 [01:23<00:06, 40.53it/s, est. speed input: 47007.24 toks/s, output: 45.91 toks/s]
Processed prompts:  95%|█████████▍| 3880/4096 [01:24<00:05, 40.49it/s, est. speed input: 46954.42 toks/s, output: 45.85 toks/s]
Processed prompts:  96%|█████████▌| 3912/4096 [01:25<00:04, 40.83it/s, est. speed input: 46915.63 toks/s, output: 45.82 toks/s]
Processed prompts:  96%|█████████▋| 3944/4096 [01:26<00:03, 41.03it/s, est. speed input: 46876.22 toks/s, output: 45.78 toks/s]
Processed prompts:  97%|█████████▋| 3976/4096 [01:26<00:02, 40.84it/s, est. speed input: 46825.96 toks/s, output: 45.73 toks/s]
Processed prompts:  98%|█████████▊| 4008/4096 [01:27<00:02, 41.06it/s, est. speed input: 46788.82 toks/s, output: 45.69 toks/s]
Processed prompts:  99%|█████████▊| 4040/4096 [01:28<00:01, 41.21it/s, est. speed input: 46752.09 toks/s, output: 45.66 toks/s]
Processed prompts:  99%|█████████▉| 4072/4096 [01:29<00:00, 44.28it/s, est. speed input: 46806.45 toks/s, output: 45.71 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [01:29<00:00, 44.28it/s, est. speed input: 47081.84 toks/s, output: 45.98 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [01:29<00:00, 45.98it/s, est. speed input: 47081.84 toks/s, output: 45.98 toks/s]
[rank0]:[W126 11:31:44.306171132 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=65536 ==========
Time: 2026-01-26 11:31:46
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=8192, max_num_seqs=64
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 8192 --max-num-seqs 64 --max-model-len 1025 --max-num-batched-tokens 65536 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-7B-INT8_M65536.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 11:32:37 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1291221) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1291221) WARNING 01-26 11:32:54 [backends.py:609] Failed to read file <frozen os>
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 240, in _initialize_kv_caches
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     available_gpu_memory = self.model_executor.determine_available_memory()
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     return self.collective_rpc("determine_available_memory")
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     result = run_method(self.driver_worker, method, args, kwargs)
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/root/vllmbench/vllm/v1/serial_utils.py", line 461, in run_method
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 340, in determine_available_memory
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     self.model_runner.profile_run()
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4474, in profile_run
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     hidden_states, last_hidden_states = self._dummy_run(
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]                                         ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4198, in _dummy_run
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     outputs = self.model(
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]               ^^^^^^^^^^^
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 583, in forward
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     hidden_states = self.model(
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]                     ^^^^^^^^^^^
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/root/vllmbench/vllm/compilation/decorators.py", line 526, in __call__
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/root/vllmbench/vllm/compilation/wrapper.py", line 218, in __call__
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     return self._call_with_optional_nvtx_range(
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/root/vllmbench/vllm/compilation/wrapper.py", line 109, in _call_with_optional_nvtx_range
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     return callable_fn(*args, **kwargs)
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 832, in compile_wrapper
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     return fn(*args, **kwargs)
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 418, in forward
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     def forward(
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     return fn(*args, **kwargs)
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/root/vllmbench/vllm/compilation/caching.py", line 54, in __call__
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     return self.optimized_call(*args, **kwargs)
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 837, in call_wrapped
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     return self._wrapped_call(self, *args, **kwargs)
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 413, in __call__
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     raise e
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 400, in __call__
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     return super(self.cls, obj).__call__(*args, **kwargs)  # type: ignore[misc]
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "<eval_with_key>.58", line 325, in forward
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     submod_2 = self.submod_2(getitem_3, s72, l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_scale_, l_self_modules_layers_modules_0_modules_post_attention_layernorm_parameters_weight_, getitem_4, l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_scale_, l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_input_layernorm_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_bias_, l_positions_, l_self_modules_layers_modules_0_modules_self_attn_modules_rotary_emb_buffers_cos_sin_cache_);  getitem_3 = l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_scale_ = l_self_modules_layers_modules_0_modules_post_attention_layernorm_parameters_weight_ = getitem_4 = l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_scale_ = l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_input_layernorm_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_bias_ = None
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/root/vllmbench/vllm/compilation/piecewise_backend.py", line 178, in __call__
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     return range_entry.runnable(*args)
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/standalone_compile.py", line 63, in __call__
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     return self._compiled_fn(*args)
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     return fn(*args, **kwargs)
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/aot_autograd.py", line 1130, in forward
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     return compiled_fn(full_args)
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 353, in runtime_wrapper
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     all_outs = call_func_at_runtime_with_args(
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/utils.py", line 129, in call_func_at_runtime_with_args
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     out = normalize_as_list(f(args))
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]                             ^^^^^^^
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 724, in inner_fn
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     outs = compiled_fn(args)
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]            ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 526, in wrapper
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     return compiled_fn(runtime_args)
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/output_code.py", line 613, in __call__
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     return self.current_callable(inputs)
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/utils.py", line 2962, in run
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     out = model(new_inputs)
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]           ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/tmp/torchinductor_root/bq/cbqmruv4oxk6jb5mn7bgysrw4nuowq772awe77lv4scsgx64bxce.py", line 1093, in call
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     buf17 = torch.ops.slidesparse.quant_slide_int8.default(buf16, 'Qwen2.5-7B-INT8', 8)
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_ops.py", line 841, in __call__
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     return self._op(*args, **kwargs)
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/root/vllmbench/slidesparse/core/kernels.py", line 564, in _quant_slide_int8_impl
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     return fn(input, L)
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]            ^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/root/vllmbench/slidesparse/csrc/fused_quant_slide_triton/build/H100_cc90_py312_cu129_x86_64/quant_slide_tuned_Qwen2.5-7B.py", line 339, in quant_slide_int8_triton
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     _quant_slide_int8_kernel[(M,)](
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/triton/runtime/jit.py", line 419, in <lambda>
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/triton/runtime/jit.py", line 756, in run
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     launch_metadata = kernel.launch_metadata(grid, stream, *bound_args.values())
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 490, in launch_metadata
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     self._init_handles()
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 473, in _init_handles
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]     self.module, self.function, self.n_regs, self.n_spills, self.n_max_threads = driver.active.utils.load_binary(
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866]                                                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221) ERROR 01-26 11:33:02 [core.py:866] RuntimeError: Triton Error [CUDA]: an illegal memory access was encountered

STDERR:
[2026-01-26 11:32:36] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 11:32:36] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 11:32:36] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 11:32:36] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:32:36] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:32:36] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:32:36] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:32:36] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:32:36] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 11:32:36] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 11:32:36] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 11:32:36] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 11:32:36] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 11:32:36] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 11:32:43] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 11:32:44] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 11:32:44] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 11:32:44] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:32:44] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:32:44] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:32:44] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:32:44] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 11:32:44] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 11:32:44] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 11:32:44] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 11:32:44] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 11:32:44] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 11:32:44] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1291221) [2026-01-26 11:32:46] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1291221) [2026-01-26 11:32:46] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1291221) [2026-01-26 11:32:46] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1291221) [2026-01-26 11:32:46] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1291221) [2026-01-26 11:32:46] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1291221) [2026-01-26 11:32:46] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1291221) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1291221) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.95it/s]
(EngineCore_DP0 pid=1291221) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.39it/s]
(EngineCore_DP0 pid=1291221) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.45it/s]
(EngineCore_DP0 pid=1291221) 
(EngineCore_DP0 pid=1291221) [2026-01-26 11:32:48] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=1291221) [2026-01-26 11:32:48] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 15482880 bytes
(EngineCore_DP0 pid=1291221) [2026-01-26 11:32:48] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=1291221) [2026-01-26 11:32:48] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12042240 bytes
(EngineCore_DP0 pid=1291221) [2026-01-26 11:32:48] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=1291221) [2026-01-26 11:32:48] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 127303680 bytes
(EngineCore_DP0 pid=1291221) [2026-01-26 11:32:48] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=1291221) [2026-01-26 11:32:48] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 63651840 bytes
(EngineCore_DP0 pid=1291221) [rank0]:W0126 11:32:59.696000 1291221 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1291221) [rank0]:W0126 11:32:59.774000 1291221 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1291221) [rank0]:W0126 11:33:01.125000 1291221 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1291221) [rank0]:W0126 11:33:01.247000 1291221 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1291221) Process EngineCore_DP0:
(EngineCore_DP0 pid=1291221) Traceback (most recent call last):
(EngineCore_DP0 pid=1291221)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=1291221)     self.run()
(EngineCore_DP0 pid=1291221)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=1291221)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=1291221)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=1291221)     raise e
(EngineCore_DP0 pid=1291221)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=1291221)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=1291221)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=1291221)     super().__init__(
(EngineCore_DP0 pid=1291221)   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=1291221)     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=1291221)                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221)   File "/root/vllmbench/vllm/v1/engine/core.py", line 240, in _initialize_kv_caches
(EngineCore_DP0 pid=1291221)     available_gpu_memory = self.model_executor.determine_available_memory()
(EngineCore_DP0 pid=1291221)                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221)   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
(EngineCore_DP0 pid=1291221)     return self.collective_rpc("determine_available_memory")
(EngineCore_DP0 pid=1291221)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221)   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
(EngineCore_DP0 pid=1291221)     result = run_method(self.driver_worker, method, args, kwargs)
(EngineCore_DP0 pid=1291221)              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221)   File "/root/vllmbench/vllm/v1/serial_utils.py", line 461, in run_method
(EngineCore_DP0 pid=1291221)     return func(*args, **kwargs)
(EngineCore_DP0 pid=1291221)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221)   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1291221)     return func(*args, **kwargs)
(EngineCore_DP0 pid=1291221)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221)   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 340, in determine_available_memory
(EngineCore_DP0 pid=1291221)     self.model_runner.profile_run()
(EngineCore_DP0 pid=1291221)   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4474, in profile_run
(EngineCore_DP0 pid=1291221)     hidden_states, last_hidden_states = self._dummy_run(
(EngineCore_DP0 pid=1291221)                                         ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221)   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1291221)     return func(*args, **kwargs)
(EngineCore_DP0 pid=1291221)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221)   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4198, in _dummy_run
(EngineCore_DP0 pid=1291221)     outputs = self.model(
(EngineCore_DP0 pid=1291221)               ^^^^^^^^^^^
(EngineCore_DP0 pid=1291221)   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=1291221)     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=1291221)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1291221)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1291221)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1291221)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1291221)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 583, in forward
(EngineCore_DP0 pid=1291221)     hidden_states = self.model(
(EngineCore_DP0 pid=1291221)                     ^^^^^^^^^^^
(EngineCore_DP0 pid=1291221)   File "/root/vllmbench/vllm/compilation/decorators.py", line 526, in __call__
(EngineCore_DP0 pid=1291221)     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
(EngineCore_DP0 pid=1291221)              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221)   File "/root/vllmbench/vllm/compilation/wrapper.py", line 218, in __call__
(EngineCore_DP0 pid=1291221)     return self._call_with_optional_nvtx_range(
(EngineCore_DP0 pid=1291221)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221)   File "/root/vllmbench/vllm/compilation/wrapper.py", line 109, in _call_with_optional_nvtx_range
(EngineCore_DP0 pid=1291221)     return callable_fn(*args, **kwargs)
(EngineCore_DP0 pid=1291221)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221)   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 832, in compile_wrapper
(EngineCore_DP0 pid=1291221)     return fn(*args, **kwargs)
(EngineCore_DP0 pid=1291221)            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 418, in forward
(EngineCore_DP0 pid=1291221)     def forward(
(EngineCore_DP0 pid=1291221)   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=1291221)     return fn(*args, **kwargs)
(EngineCore_DP0 pid=1291221)            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221)   File "/root/vllmbench/vllm/compilation/caching.py", line 54, in __call__
(EngineCore_DP0 pid=1291221)     return self.optimized_call(*args, **kwargs)
(EngineCore_DP0 pid=1291221)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221)   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 837, in call_wrapped
(EngineCore_DP0 pid=1291221)     return self._wrapped_call(self, *args, **kwargs)
(EngineCore_DP0 pid=1291221)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221)   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 413, in __call__
(EngineCore_DP0 pid=1291221)     raise e
(EngineCore_DP0 pid=1291221)   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 400, in __call__
(EngineCore_DP0 pid=1291221)     return super(self.cls, obj).__call__(*args, **kwargs)  # type: ignore[misc]
(EngineCore_DP0 pid=1291221)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1291221)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1291221)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1291221)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1291221)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221)   File "<eval_with_key>.58", line 325, in forward
(EngineCore_DP0 pid=1291221)     submod_2 = self.submod_2(getitem_3, s72, l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_scale_, l_self_modules_layers_modules_0_modules_post_attention_layernorm_parameters_weight_, getitem_4, l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_scale_, l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_input_layernorm_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_bias_, l_positions_, l_self_modules_layers_modules_0_modules_self_attn_modules_rotary_emb_buffers_cos_sin_cache_);  getitem_3 = l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_scale_ = l_self_modules_layers_modules_0_modules_post_attention_layernorm_parameters_weight_ = getitem_4 = l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_scale_ = l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_input_layernorm_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_bias_ = None
(EngineCore_DP0 pid=1291221)                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221)   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=1291221)     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=1291221)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221)   File "/root/vllmbench/vllm/compilation/piecewise_backend.py", line 178, in __call__
(EngineCore_DP0 pid=1291221)     return range_entry.runnable(*args)
(EngineCore_DP0 pid=1291221)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/standalone_compile.py", line 63, in __call__
(EngineCore_DP0 pid=1291221)     return self._compiled_fn(*args)
(EngineCore_DP0 pid=1291221)            ^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221)   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=1291221)     return fn(*args, **kwargs)
(EngineCore_DP0 pid=1291221)            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/aot_autograd.py", line 1130, in forward
(EngineCore_DP0 pid=1291221)     return compiled_fn(full_args)
(EngineCore_DP0 pid=1291221)            ^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 353, in runtime_wrapper
(EngineCore_DP0 pid=1291221)     all_outs = call_func_at_runtime_with_args(
(EngineCore_DP0 pid=1291221)                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/utils.py", line 129, in call_func_at_runtime_with_args
(EngineCore_DP0 pid=1291221)     out = normalize_as_list(f(args))
(EngineCore_DP0 pid=1291221)                             ^^^^^^^
(EngineCore_DP0 pid=1291221)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 724, in inner_fn
(EngineCore_DP0 pid=1291221)     outs = compiled_fn(args)
(EngineCore_DP0 pid=1291221)            ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 526, in wrapper
(EngineCore_DP0 pid=1291221)     return compiled_fn(runtime_args)
(EngineCore_DP0 pid=1291221)            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/output_code.py", line 613, in __call__
(EngineCore_DP0 pid=1291221)     return self.current_callable(inputs)
(EngineCore_DP0 pid=1291221)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/utils.py", line 2962, in run
(EngineCore_DP0 pid=1291221)     out = model(new_inputs)
(EngineCore_DP0 pid=1291221)           ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221)   File "/tmp/torchinductor_root/bq/cbqmruv4oxk6jb5mn7bgysrw4nuowq772awe77lv4scsgx64bxce.py", line 1093, in call
(EngineCore_DP0 pid=1291221)     buf17 = torch.ops.slidesparse.quant_slide_int8.default(buf16, 'Qwen2.5-7B-INT8', 8)
(EngineCore_DP0 pid=1291221)             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221)   File "/usr/local/lib/python3.12/dist-packages/torch/_ops.py", line 841, in __call__
(EngineCore_DP0 pid=1291221)     return self._op(*args, **kwargs)
(EngineCore_DP0 pid=1291221)            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221)   File "/root/vllmbench/slidesparse/core/kernels.py", line 564, in _quant_slide_int8_impl
(EngineCore_DP0 pid=1291221)     return fn(input, L)
(EngineCore_DP0 pid=1291221)            ^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221)   File "/root/vllmbench/slidesparse/csrc/fused_quant_slide_triton/build/H100_cc90_py312_cu129_x86_64/quant_slide_tuned_Qwen2.5-7B.py", line 339, in quant_slide_int8_triton
(EngineCore_DP0 pid=1291221)     _quant_slide_int8_kernel[(M,)](
(EngineCore_DP0 pid=1291221)   File "/usr/local/lib/python3.12/dist-packages/triton/runtime/jit.py", line 419, in <lambda>
(EngineCore_DP0 pid=1291221)     return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)
(EngineCore_DP0 pid=1291221)                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221)   File "/usr/local/lib/python3.12/dist-packages/triton/runtime/jit.py", line 756, in run
(EngineCore_DP0 pid=1291221)     launch_metadata = kernel.launch_metadata(grid, stream, *bound_args.values())
(EngineCore_DP0 pid=1291221)                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221)   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 490, in launch_metadata
(EngineCore_DP0 pid=1291221)     self._init_handles()
(EngineCore_DP0 pid=1291221)   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 473, in _init_handles
(EngineCore_DP0 pid=1291221)     self.module, self.function, self.n_regs, self.n_spills, self.n_max_threads = driver.active.utils.load_binary(
(EngineCore_DP0 pid=1291221)                                                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1291221) RuntimeError: Triton Error [CUDA]: an illegal memory access was encountered
[rank0]:[W126 11:33:02.968643628 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

ERROR: Test failed for M=65536

========== M=512 ==========
Time: 2026-01-26 13:33:32
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_8
Params: prompt_len=512, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_8 --dataset-name random --input-len 512 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 513 --max-num-batched-tokens 513 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-14B-INT8_M512.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 13:33:40 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1425078) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1425078) WARNING 01-26 13:34:01 [backends.py:609] Failed to read file <frozen os>
Throughput: 22.71 requests/s, 11648.39 total tokens/s, 22.71 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128

STDERR:
[2026-01-26 13:33:39] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 13:33:40] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 13:33:40] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 13:33:40] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:33:40] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:33:40] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:33:40] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:33:40] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:33:40] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 13:33:40] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 13:33:40] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 13:33:40] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 13:33:40] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 13:33:40] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 13:33:47] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 13:33:47] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 13:33:47] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 13:33:47] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:33:47] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:33:47] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:33:47] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:33:47] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:33:47] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 13:33:47] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 13:33:47] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 13:33:47] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 13:33:47] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 13:33:47] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1425078) [2026-01-26 13:33:49] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1425078) [2026-01-26 13:33:49] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1425078) [2026-01-26 13:33:49] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1425078) [2026-01-26 13:33:49] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1425078) [2026-01-26 13:33:49] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=1425078) [2026-01-26 13:33:49] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1425078) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1425078) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.27it/s]
(EngineCore_DP0 pid=1425078) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.18it/s]
(EngineCore_DP0 pid=1425078) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.61it/s]
(EngineCore_DP0 pid=1425078) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.45it/s]
(EngineCore_DP0 pid=1425078) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.42it/s]
(EngineCore_DP0 pid=1425078) 
(EngineCore_DP0 pid=1425078) [2026-01-26 13:33:52] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 7680] -> 1D uint8
(EngineCore_DP0 pid=1425078) [2026-01-26 13:33:52] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 34406400 bytes
(EngineCore_DP0 pid=1425078) [2026-01-26 13:33:52] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 7680] -> 1D uint8
(EngineCore_DP0 pid=1425078) [2026-01-26 13:33:52] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 24576000 bytes
(EngineCore_DP0 pid=1425078) [2026-01-26 13:33:52] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 7680] -> 1D uint8
(EngineCore_DP0 pid=1425078) [2026-01-26 13:33:52] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 132710400 bytes
(EngineCore_DP0 pid=1425078) [2026-01-26 13:33:52] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 20736] -> 1D uint8
(EngineCore_DP0 pid=1425078) [2026-01-26 13:33:52] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 66355200 bytes
(EngineCore_DP0 pid=1425078) 2026-01-26 13:34:15,918 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1425078) 2026-01-26 13:34:15,969 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1425078) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  3.32it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  3.17it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  3.19it/s]
(EngineCore_DP0 pid=1425078) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  5.28it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  5.27it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  28%|██▊       | 36/128 [00:00<00:00, 352.47it/s]
Adding requests:  80%|████████  | 103/128 [00:00<00:00, 534.60it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 536.86it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:04, 27.14it/s, est. speed input: 13899.90 toks/s, output: 27.14 toks/s]
Processed prompts:   5%|▍         | 6/128 [00:00<00:04, 25.53it/s, est. speed input: 13190.84 toks/s, output: 25.76 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:00<00:04, 24.99it/s, est. speed input: 12947.64 toks/s, output: 25.29 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:00<00:04, 24.74it/s, est. speed input: 12826.92 toks/s, output: 25.05 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:00<00:04, 24.35it/s, est. speed input: 12678.85 toks/s, output: 24.76 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:00<00:04, 24.06it/s, est. speed input: 12567.13 toks/s, output: 24.54 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:00<00:04, 23.94it/s, est. speed input: 12503.34 toks/s, output: 24.42 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:00<00:04, 23.88it/s, est. speed input: 12460.19 toks/s, output: 24.34 toks/s]
Processed prompts:  21%|██        | 27/128 [00:01<00:04, 23.84it/s, est. speed input: 12425.85 toks/s, output: 24.27 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:01<00:04, 23.81it/s, est. speed input: 12398.64 toks/s, output: 24.22 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:01<00:03, 23.79it/s, est. speed input: 12376.18 toks/s, output: 24.17 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:01<00:03, 23.74it/s, est. speed input: 12352.62 toks/s, output: 24.13 toks/s]
Processed prompts:  30%|███       | 39/128 [00:01<00:03, 23.70it/s, est. speed input: 12331.33 toks/s, output: 24.08 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:01<00:03, 23.66it/s, est. speed input: 12311.98 toks/s, output: 24.05 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:01<00:03, 23.59it/s, est. speed input: 12290.71 toks/s, output: 24.00 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:02<00:03, 23.58it/s, est. speed input: 12276.44 toks/s, output: 23.98 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:02<00:03, 23.57it/s, est. speed input: 12263.17 toks/s, output: 23.95 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:02<00:03, 23.62it/s, est. speed input: 12256.65 toks/s, output: 23.94 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:02<00:03, 23.61it/s, est. speed input: 12247.41 toks/s, output: 23.92 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:02<00:02, 23.60it/s, est. speed input: 12237.92 toks/s, output: 23.90 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:02<00:02, 23.58it/s, est. speed input: 12229.27 toks/s, output: 23.88 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:02<00:02, 23.56it/s, est. speed input: 12220.31 toks/s, output: 23.87 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:02<00:02, 23.56it/s, est. speed input: 12213.27 toks/s, output: 23.85 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:03<00:02, 23.55it/s, est. speed input: 12206.13 toks/s, output: 23.84 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:03<00:02, 23.54it/s, est. speed input: 12199.28 toks/s, output: 23.83 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:03<00:02, 23.55it/s, est. speed input: 12194.32 toks/s, output: 23.82 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:03<00:01, 23.58it/s, est. speed input: 12190.87 toks/s, output: 23.81 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:03<00:01, 23.61it/s, est. speed input: 12188.90 toks/s, output: 23.81 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:03<00:01, 23.61it/s, est. speed input: 12184.95 toks/s, output: 23.80 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:03<00:01, 23.58it/s, est. speed input: 12180.31 toks/s, output: 23.79 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:03<00:01, 23.55it/s, est. speed input: 12175.16 toks/s, output: 23.78 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:04<00:01, 23.55it/s, est. speed input: 12171.29 toks/s, output: 23.77 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:04<00:01, 23.53it/s, est. speed input: 12166.88 toks/s, output: 23.76 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:04<00:01, 23.55it/s, est. speed input: 12164.31 toks/s, output: 23.76 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:04<00:00, 23.58it/s, est. speed input: 12162.88 toks/s, output: 23.76 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:04<00:00, 23.59it/s, est. speed input: 12160.52 toks/s, output: 23.75 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:04<00:00, 23.58it/s, est. speed input: 12158.05 toks/s, output: 23.75 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:04<00:00, 23.55it/s, est. speed input: 12154.32 toks/s, output: 23.74 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:04<00:00, 23.53it/s, est. speed input: 12151.11 toks/s, output: 23.73 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:05<00:00, 23.55it/s, est. speed input: 12149.16 toks/s, output: 23.73 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:05<00:00, 23.55it/s, est. speed input: 12146.97 toks/s, output: 23.72 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:05<00:00, 23.55it/s, est. speed input: 12144.81 toks/s, output: 23.72 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:05<00:00, 23.55it/s, est. speed input: 12142.80 toks/s, output: 23.72 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:05<00:00, 23.72it/s, est. speed input: 12142.80 toks/s, output: 23.72 toks/s]
[rank0]:[W126 13:34:24.390915969 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=1024 ==========
Time: 2026-01-26 13:34:26
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 1025 --max-num-batched-tokens 1025 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-14B-INT8_M1024.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 13:34:34 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1426351) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1426351) WARNING 01-26 13:34:56 [backends.py:609] Failed to read file <frozen os>
Throughput: 17.65 requests/s, 18094.31 total tokens/s, 17.65 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128

STDERR:
[2026-01-26 13:34:33] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 13:34:34] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 13:34:34] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 13:34:34] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:34:34] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:34:34] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:34:34] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:34:34] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:34:34] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 13:34:34] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 13:34:34] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 13:34:34] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 13:34:34] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 13:34:34] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 13:34:41] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 13:34:42] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 13:34:42] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 13:34:42] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:34:42] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:34:42] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:34:42] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:34:42] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:34:42] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 13:34:42] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 13:34:42] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 13:34:42] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 13:34:42] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 13:34:42] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1426351) [2026-01-26 13:34:43] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1426351) [2026-01-26 13:34:43] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1426351) [2026-01-26 13:34:43] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1426351) [2026-01-26 13:34:43] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1426351) [2026-01-26 13:34:43] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=1426351) [2026-01-26 13:34:43] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1426351) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1426351) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.29it/s]
(EngineCore_DP0 pid=1426351) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.18it/s]
(EngineCore_DP0 pid=1426351) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.62it/s]
(EngineCore_DP0 pid=1426351) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.45it/s]
(EngineCore_DP0 pid=1426351) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.42it/s]
(EngineCore_DP0 pid=1426351) 
(EngineCore_DP0 pid=1426351) [2026-01-26 13:34:47] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 7680] -> 1D uint8
(EngineCore_DP0 pid=1426351) [2026-01-26 13:34:47] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 34406400 bytes
(EngineCore_DP0 pid=1426351) [2026-01-26 13:34:47] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 7680] -> 1D uint8
(EngineCore_DP0 pid=1426351) [2026-01-26 13:34:47] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 24576000 bytes
(EngineCore_DP0 pid=1426351) [2026-01-26 13:34:47] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 7680] -> 1D uint8
(EngineCore_DP0 pid=1426351) [2026-01-26 13:34:47] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 132710400 bytes
(EngineCore_DP0 pid=1426351) [2026-01-26 13:34:47] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 20736] -> 1D uint8
(EngineCore_DP0 pid=1426351) [2026-01-26 13:34:47] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 66355200 bytes
(EngineCore_DP0 pid=1426351) 2026-01-26 13:35:10,924 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1426351) 2026-01-26 13:35:10,974 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1426351) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  8.42it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  6.41it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  6.65it/s]
(EngineCore_DP0 pid=1426351) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00, 10.05it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  16%|█▌        | 20/128 [00:00<00:00, 198.74it/s]
Adding requests:  48%|████▊     | 61/128 [00:00<00:00, 318.77it/s]
Adding requests:  76%|███████▌  | 97/128 [00:00<00:00, 337.35it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 331.86it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 2/128 [00:00<00:09, 13.85it/s, est. speed input: 14183.38 toks/s, output: 13.85 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:07, 16.60it/s, est. speed input: 16508.50 toks/s, output: 16.12 toks/s]
Processed prompts:   5%|▍         | 6/128 [00:00<00:06, 17.58it/s, est. speed input: 17362.21 toks/s, output: 16.95 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:00<00:06, 18.05it/s, est. speed input: 17805.29 toks/s, output: 17.39 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:00<00:06, 18.37it/s, est. speed input: 18103.70 toks/s, output: 17.68 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:00<00:06, 18.49it/s, est. speed input: 18275.94 toks/s, output: 17.85 toks/s]
Processed prompts:  11%|█         | 14/128 [00:00<00:06, 18.64it/s, est. speed input: 18429.33 toks/s, output: 18.00 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:00<00:05, 18.72it/s, est. speed input: 18538.49 toks/s, output: 18.10 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:00<00:05, 18.63it/s, est. speed input: 18574.90 toks/s, output: 18.14 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:01<00:05, 18.49it/s, est. speed input: 18580.54 toks/s, output: 18.14 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:01<00:05, 18.57it/s, est. speed input: 18637.02 toks/s, output: 18.20 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:01<00:05, 18.66it/s, est. speed input: 18689.66 toks/s, output: 18.25 toks/s]
Processed prompts:  20%|██        | 26/128 [00:01<00:05, 18.68it/s, est. speed input: 18726.13 toks/s, output: 18.29 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:01<00:05, 18.71it/s, est. speed input: 18761.86 toks/s, output: 18.32 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:01<00:05, 18.75it/s, est. speed input: 18796.75 toks/s, output: 18.36 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:01<00:05, 18.75it/s, est. speed input: 18821.63 toks/s, output: 18.38 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:01<00:04, 18.81it/s, est. speed input: 18855.44 toks/s, output: 18.41 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:01<00:04, 18.73it/s, est. speed input: 18862.51 toks/s, output: 18.42 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:02<00:04, 18.60it/s, est. speed input: 18856.51 toks/s, output: 18.41 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:02<00:04, 18.60it/s, est. speed input: 18865.76 toks/s, output: 18.42 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:02<00:04, 18.66it/s, est. speed input: 18883.03 toks/s, output: 18.44 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:02<00:04, 18.68it/s, est. speed input: 18896.70 toks/s, output: 18.45 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:02<00:04, 18.73it/s, est. speed input: 18913.83 toks/s, output: 18.47 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:02<00:04, 18.73it/s, est. speed input: 18925.12 toks/s, output: 18.48 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:02<00:04, 18.76it/s, est. speed input: 18938.73 toks/s, output: 18.49 toks/s]
Processed prompts:  41%|████      | 52/128 [00:02<00:04, 18.82it/s, est. speed input: 18956.62 toks/s, output: 18.51 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:02<00:03, 18.76it/s, est. speed input: 18960.48 toks/s, output: 18.52 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:03<00:03, 18.68it/s, est. speed input: 18959.56 toks/s, output: 18.51 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:03<00:03, 18.65it/s, est. speed input: 18962.64 toks/s, output: 18.52 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:03<00:03, 18.67it/s, est. speed input: 18969.47 toks/s, output: 18.52 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:03<00:03, 18.69it/s, est. speed input: 18976.21 toks/s, output: 18.53 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:03<00:03, 18.72it/s, est. speed input: 18984.30 toks/s, output: 18.54 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:03<00:03, 18.72it/s, est. speed input: 18989.55 toks/s, output: 18.54 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:03<00:03, 18.75it/s, est. speed input: 18997.73 toks/s, output: 18.55 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:03<00:03, 18.72it/s, est. speed input: 19000.65 toks/s, output: 18.56 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:03<00:02, 18.72it/s, est. speed input: 19005.70 toks/s, output: 18.56 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:03<00:02, 18.69it/s, est. speed input: 19007.34 toks/s, output: 18.56 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:04<00:02, 18.64it/s, est. speed input: 19006.46 toks/s, output: 18.56 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:04<00:02, 18.62it/s, est. speed input: 19006.52 toks/s, output: 18.56 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:04<00:02, 18.70it/s, est. speed input: 19014.80 toks/s, output: 18.57 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:04<00:02, 18.72it/s, est. speed input: 19020.04 toks/s, output: 18.57 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:04<00:02, 18.75it/s, est. speed input: 19025.92 toks/s, output: 18.58 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:04<00:02, 18.78it/s, est. speed input: 19032.00 toks/s, output: 18.59 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:04<00:02, 18.80it/s, est. speed input: 19038.00 toks/s, output: 18.59 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:04<00:02, 18.80it/s, est. speed input: 19043.08 toks/s, output: 18.60 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:04<00:01, 18.80it/s, est. speed input: 19047.06 toks/s, output: 18.60 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:05<00:01, 18.76it/s, est. speed input: 19048.84 toks/s, output: 18.60 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:05<00:01, 18.71it/s, est. speed input: 19048.83 toks/s, output: 18.60 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:05<00:01, 18.70it/s, est. speed input: 19050.09 toks/s, output: 18.60 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:05<00:01, 18.71it/s, est. speed input: 19052.79 toks/s, output: 18.61 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:05<00:01, 18.73it/s, est. speed input: 19056.48 toks/s, output: 18.61 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:05<00:01, 18.79it/s, est. speed input: 19062.42 toks/s, output: 18.62 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:05<00:01, 18.81it/s, est. speed input: 19067.03 toks/s, output: 18.62 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:05<00:01, 18.81it/s, est. speed input: 19070.54 toks/s, output: 18.62 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:05<00:00, 18.81it/s, est. speed input: 19073.87 toks/s, output: 18.63 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:06<00:00, 18.80it/s, est. speed input: 19076.92 toks/s, output: 18.63 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:06<00:00, 18.77it/s, est. speed input: 19077.74 toks/s, output: 18.63 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:06<00:00, 18.74it/s, est. speed input: 19078.78 toks/s, output: 18.63 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:06<00:00, 18.75it/s, est. speed input: 19081.15 toks/s, output: 18.63 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:06<00:00, 18.76it/s, est. speed input: 19083.64 toks/s, output: 18.64 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:06<00:00, 18.81it/s, est. speed input: 19088.33 toks/s, output: 18.64 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:06<00:00, 18.86it/s, est. speed input: 19093.84 toks/s, output: 18.65 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:06<00:00, 18.86it/s, est. speed input: 19097.34 toks/s, output: 18.65 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:06<00:00, 18.81it/s, est. speed input: 19097.84 toks/s, output: 18.65 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:06<00:00, 18.81it/s, est. speed input: 19097.84 toks/s, output: 18.65 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:06<00:00, 18.65it/s, est. speed input: 19097.84 toks/s, output: 18.65 toks/s]
[rank0]:[W126 13:35:20.676642763 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=2048 ==========
Time: 2026-01-26 13:35:22
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=256, max_num_seqs=2
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 256 --max-num-seqs 2 --max-model-len 1025 --max-num-batched-tokens 2048 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-14B-INT8_M2048.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 13:35:30 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1427634) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1427634) WARNING 01-26 13:35:51 [backends.py:609] Failed to read file <frozen os>
Throughput: 20.00 requests/s, 20498.12 total tokens/s, 20.00 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256

STDERR:
[2026-01-26 13:35:30] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 13:35:30] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 13:35:30] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 13:35:30] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:35:30] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:35:30] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:35:30] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:35:30] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:35:30] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 13:35:30] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 13:35:30] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 13:35:30] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 13:35:30] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 13:35:30] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 13:35:37] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 13:35:37] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 13:35:37] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 13:35:37] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:35:37] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:35:37] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:35:37] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:35:37] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:35:37] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 13:35:37] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 13:35:37] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 13:35:37] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 13:35:37] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 13:35:37] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1427634) [2026-01-26 13:35:39] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1427634) [2026-01-26 13:35:39] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1427634) [2026-01-26 13:35:39] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1427634) [2026-01-26 13:35:39] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1427634) [2026-01-26 13:35:39] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=1427634) [2026-01-26 13:35:39] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1427634) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1427634) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.29it/s]
(EngineCore_DP0 pid=1427634) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.18it/s]
(EngineCore_DP0 pid=1427634) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.61it/s]
(EngineCore_DP0 pid=1427634) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.45it/s]
(EngineCore_DP0 pid=1427634) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.42it/s]
(EngineCore_DP0 pid=1427634) 
(EngineCore_DP0 pid=1427634) [2026-01-26 13:35:42] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 7680] -> 1D uint8
(EngineCore_DP0 pid=1427634) [2026-01-26 13:35:42] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 34406400 bytes
(EngineCore_DP0 pid=1427634) [2026-01-26 13:35:42] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 7680] -> 1D uint8
(EngineCore_DP0 pid=1427634) [2026-01-26 13:35:42] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 24576000 bytes
(EngineCore_DP0 pid=1427634) [2026-01-26 13:35:42] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 7680] -> 1D uint8
(EngineCore_DP0 pid=1427634) [2026-01-26 13:35:42] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 132710400 bytes
(EngineCore_DP0 pid=1427634) [2026-01-26 13:35:42] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 20736] -> 1D uint8
(EngineCore_DP0 pid=1427634) [2026-01-26 13:35:42] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 66355200 bytes
(EngineCore_DP0 pid=1427634) 2026-01-26 13:36:05,778 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1427634) 2026-01-26 13:36:05,847 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1427634) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  33%|███▎      | 1/3 [00:00<00:00,  8.06it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00,  9.92it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00,  9.70it/s]
(EngineCore_DP0 pid=1427634) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  4.79it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  4.78it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:   8%|▊         | 20/256 [00:00<00:01, 197.22it/s]
Adding requests:  22%|██▏       | 57/256 [00:00<00:00, 297.13it/s]
Adding requests:  37%|███▋      | 94/256 [00:00<00:00, 329.96it/s]
Adding requests:  51%|█████     | 131/256 [00:00<00:00, 345.39it/s]
Adding requests:  66%|██████▌   | 169/256 [00:00<00:00, 355.42it/s]
Adding requests:  81%|████████▏ | 208/256 [00:00<00:00, 365.57it/s]
Adding requests:  96%|█████████▋| 247/256 [00:00<00:00, 373.33it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 349.97it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▍         | 12/256 [00:00<00:02, 87.82it/s, est. speed input: 89960.30 toks/s, output: 87.83 toks/s]
Processed prompts:   8%|▊         | 21/256 [00:00<00:06, 35.92it/s, est. speed input: 40930.25 toks/s, output: 39.97 toks/s]
Processed prompts:  10%|█         | 26/256 [00:00<00:08, 26.95it/s, est. speed input: 32320.50 toks/s, output: 31.56 toks/s]
Processed prompts:  12%|█▏        | 30/256 [00:01<00:09, 24.82it/s, est. speed input: 30025.20 toks/s, output: 29.32 toks/s]
Processed prompts:  13%|█▎        | 34/256 [00:01<00:09, 23.50it/s, est. speed input: 28563.11 toks/s, output: 27.89 toks/s]
Processed prompts:  15%|█▍        | 38/256 [00:01<00:09, 22.64it/s, est. speed input: 27542.89 toks/s, output: 26.90 toks/s]
Processed prompts:  16%|█▋        | 42/256 [00:01<00:09, 21.98it/s, est. speed input: 26738.66 toks/s, output: 26.11 toks/s]
Processed prompts:  18%|█▊        | 46/256 [00:01<00:09, 21.38it/s, est. speed input: 26051.06 toks/s, output: 25.44 toks/s]
Processed prompts:  20%|█▉        | 50/256 [00:02<00:09, 20.99it/s, est. speed input: 25509.16 toks/s, output: 24.91 toks/s]
Processed prompts:  21%|██        | 54/256 [00:02<00:09, 20.78it/s, est. speed input: 25083.20 toks/s, output: 24.49 toks/s]
Processed prompts:  23%|██▎       | 58/256 [00:02<00:09, 20.70it/s, est. speed input: 24754.11 toks/s, output: 24.17 toks/s]
Processed prompts:  24%|██▍       | 62/256 [00:02<00:09, 20.69it/s, est. speed input: 24484.47 toks/s, output: 23.91 toks/s]
Processed prompts:  26%|██▌       | 66/256 [00:02<00:09, 20.52it/s, est. speed input: 24209.44 toks/s, output: 23.64 toks/s]
Processed prompts:  27%|██▋       | 70/256 [00:02<00:09, 20.40it/s, est. speed input: 23970.91 toks/s, output: 23.41 toks/s]
Processed prompts:  29%|██▉       | 74/256 [00:03<00:08, 20.34it/s, est. speed input: 23766.36 toks/s, output: 23.21 toks/s]
Processed prompts:  30%|███       | 78/256 [00:03<00:08, 20.37it/s, est. speed input: 23603.36 toks/s, output: 23.05 toks/s]
Processed prompts:  32%|███▏      | 82/256 [00:03<00:08, 20.40it/s, est. speed input: 23458.62 toks/s, output: 22.91 toks/s]
Processed prompts:  34%|███▎      | 86/256 [00:03<00:08, 20.36it/s, est. speed input: 23317.81 toks/s, output: 22.77 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:03<00:08, 20.31it/s, est. speed input: 23185.48 toks/s, output: 22.64 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:04<00:07, 20.29it/s, est. speed input: 23069.42 toks/s, output: 22.53 toks/s]
Processed prompts:  38%|███▊      | 98/256 [00:04<00:07, 20.34it/s, est. speed input: 22974.94 toks/s, output: 22.44 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:04<00:07, 20.34it/s, est. speed input: 22882.45 toks/s, output: 22.35 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:04<00:07, 20.30it/s, est. speed input: 22790.49 toks/s, output: 22.26 toks/s]
Processed prompts:  43%|████▎     | 110/256 [00:04<00:07, 20.25it/s, est. speed input: 22703.55 toks/s, output: 22.17 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:05<00:07, 20.25it/s, est. speed input: 22629.12 toks/s, output: 22.10 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:05<00:06, 20.33it/s, est. speed input: 22569.31 toks/s, output: 22.04 toks/s]
Processed prompts:  48%|████▊     | 122/256 [00:05<00:06, 20.33it/s, est. speed input: 22507.25 toks/s, output: 21.98 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:05<00:06, 20.30it/s, est. speed input: 22445.37 toks/s, output: 21.92 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:05<00:06, 20.23it/s, est. speed input: 22382.66 toks/s, output: 21.86 toks/s]
Processed prompts:  52%|█████▏    | 134/256 [00:06<00:06, 20.20it/s, est. speed input: 22325.03 toks/s, output: 21.80 toks/s]
Processed prompts:  54%|█████▍    | 138/256 [00:06<00:05, 20.23it/s, est. speed input: 22277.16 toks/s, output: 21.75 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:06<00:05, 20.27it/s, est. speed input: 22234.69 toks/s, output: 21.71 toks/s]
Processed prompts:  57%|█████▋    | 146/256 [00:06<00:05, 20.29it/s, est. speed input: 22193.59 toks/s, output: 21.67 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:06<00:05, 20.26it/s, est. speed input: 22150.41 toks/s, output: 21.63 toks/s]
Processed prompts:  60%|██████    | 154/256 [00:07<00:05, 20.23it/s, est. speed input: 22107.96 toks/s, output: 21.59 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:07<00:04, 20.27it/s, est. speed input: 22074.37 toks/s, output: 21.56 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:07<00:04, 20.28it/s, est. speed input: 22040.95 toks/s, output: 21.52 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:07<00:04, 20.26it/s, est. speed input: 22006.08 toks/s, output: 21.49 toks/s]
Processed prompts:  66%|██████▋   | 170/256 [00:07<00:04, 20.23it/s, est. speed input: 21972.16 toks/s, output: 21.46 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:08<00:04, 20.25it/s, est. speed input: 21943.59 toks/s, output: 21.43 toks/s]
Processed prompts:  70%|██████▉   | 178/256 [00:08<00:03, 20.28it/s, est. speed input: 21917.21 toks/s, output: 21.40 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:08<00:03, 20.30it/s, est. speed input: 21891.95 toks/s, output: 21.38 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:08<00:03, 20.30it/s, est. speed input: 21867.24 toks/s, output: 21.35 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:08<00:03, 20.30it/s, est. speed input: 21843.27 toks/s, output: 21.33 toks/s]
Processed prompts:  76%|███████▌  | 194/256 [00:09<00:03, 20.29it/s, est. speed input: 21819.84 toks/s, output: 21.31 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:09<00:02, 20.31it/s, est. speed input: 21799.31 toks/s, output: 21.29 toks/s]
Processed prompts:  79%|███████▉  | 202/256 [00:09<00:02, 21.55it/s, est. speed input: 21865.44 toks/s, output: 21.35 toks/s]
Processed prompts:  80%|████████  | 206/256 [00:09<00:02, 21.27it/s, est. speed input: 21850.60 toks/s, output: 21.34 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:09<00:02, 21.00it/s, est. speed input: 21831.53 toks/s, output: 21.32 toks/s]
Processed prompts:  84%|████████▎ | 214/256 [00:10<00:02, 20.79it/s, est. speed input: 21811.70 toks/s, output: 21.30 toks/s]
Processed prompts:  85%|████████▌ | 218/256 [00:10<00:01, 20.63it/s, est. speed input: 21791.01 toks/s, output: 21.28 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:10<00:01, 20.50it/s, est. speed input: 21769.91 toks/s, output: 21.26 toks/s]
Processed prompts:  88%|████████▊ | 226/256 [00:10<00:01, 20.49it/s, est. speed input: 21755.14 toks/s, output: 21.25 toks/s]
Processed prompts:  90%|████████▉ | 230/256 [00:10<00:01, 20.49it/s, est. speed input: 21741.01 toks/s, output: 21.23 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:11<00:01, 20.44it/s, est. speed input: 21724.80 toks/s, output: 21.22 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:11<00:00, 20.38it/s, est. speed input: 21707.20 toks/s, output: 21.20 toks/s]
Processed prompts:  95%|█████████▍| 242/256 [00:11<00:00, 20.33it/s, est. speed input: 21689.54 toks/s, output: 21.18 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:11<00:00, 20.32it/s, est. speed input: 21674.51 toks/s, output: 21.17 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:11<00:00, 20.37it/s, est. speed input: 21663.07 toks/s, output: 21.16 toks/s]
Processed prompts:  99%|█████████▉| 254/256 [00:12<00:00, 20.40it/s, est. speed input: 21651.30 toks/s, output: 21.14 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:12<00:00, 20.40it/s, est. speed input: 21722.53 toks/s, output: 21.21 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:12<00:00, 21.21it/s, est. speed input: 21722.53 toks/s, output: 21.21 toks/s]
[rank0]:[W126 13:36:21.367568442 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=4096 ==========
Time: 2026-01-26 13:36:23
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=512, max_num_seqs=4
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 512 --max-num-seqs 4 --max-model-len 1025 --max-num-batched-tokens 4096 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-14B-INT8_M4096.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 13:36:33 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1428972) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1428972) WARNING 01-26 13:36:55 [backends.py:609] Failed to read file <frozen os>
Throughput: 20.83 requests/s, 21351.29 total tokens/s, 20.83 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512

STDERR:
[2026-01-26 13:36:32] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 13:36:33] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 13:36:33] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 13:36:33] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:36:33] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:36:33] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:36:33] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:36:33] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:36:33] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 13:36:33] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 13:36:33] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 13:36:33] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 13:36:33] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 13:36:33] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 13:36:39] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 13:36:40] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 13:36:40] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 13:36:40] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:36:40] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:36:40] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:36:40] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:36:40] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:36:40] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 13:36:40] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 13:36:40] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 13:36:40] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 13:36:40] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 13:36:40] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1428972) [2026-01-26 13:36:42] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1428972) [2026-01-26 13:36:42] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1428972) [2026-01-26 13:36:42] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1428972) [2026-01-26 13:36:42] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1428972) [2026-01-26 13:36:42] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=1428972) [2026-01-26 13:36:42] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1428972) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1428972) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.29it/s]
(EngineCore_DP0 pid=1428972) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.18it/s]
(EngineCore_DP0 pid=1428972) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.62it/s]
(EngineCore_DP0 pid=1428972) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.45it/s]
(EngineCore_DP0 pid=1428972) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.42it/s]
(EngineCore_DP0 pid=1428972) 
(EngineCore_DP0 pid=1428972) [2026-01-26 13:36:46] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 7680] -> 1D uint8
(EngineCore_DP0 pid=1428972) [2026-01-26 13:36:46] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 34406400 bytes
(EngineCore_DP0 pid=1428972) [2026-01-26 13:36:46] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 7680] -> 1D uint8
(EngineCore_DP0 pid=1428972) [2026-01-26 13:36:46] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 24576000 bytes
(EngineCore_DP0 pid=1428972) [2026-01-26 13:36:46] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 7680] -> 1D uint8
(EngineCore_DP0 pid=1428972) [2026-01-26 13:36:46] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 132710400 bytes
(EngineCore_DP0 pid=1428972) [2026-01-26 13:36:46] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 20736] -> 1D uint8
(EngineCore_DP0 pid=1428972) [2026-01-26 13:36:46] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 66355200 bytes
(EngineCore_DP0 pid=1428972) 2026-01-26 13:37:09,125 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1428972) 2026-01-26 13:37:09,307 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1428972) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  25%|██▌       | 1/4 [00:00<00:00,  4.41it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  75%|███████▌  | 3/4 [00:00<00:00,  6.33it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  6.78it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  6.43it/s]
(EngineCore_DP0 pid=1428972) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  67%|██████▋   | 2/3 [00:00<00:00, 11.78it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00, 11.99it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   4%|▍         | 23/512 [00:00<00:02, 229.21it/s]
Adding requests:  12%|█▎        | 64/512 [00:00<00:01, 330.74it/s]
Adding requests:  20%|█▉        | 100/512 [00:00<00:01, 341.93it/s]
Adding requests:  27%|██▋       | 138/512 [00:00<00:01, 355.14it/s]
Adding requests:  35%|███▍      | 178/512 [00:00<00:00, 367.53it/s]
Adding requests:  43%|████▎     | 220/512 [00:00<00:00, 383.63it/s]
Adding requests:  51%|█████     | 259/512 [00:00<00:00, 380.53it/s]
Adding requests:  58%|█████▊    | 299/512 [00:00<00:00, 385.01it/s]
Adding requests:  66%|██████▋   | 340/512 [00:00<00:00, 391.53it/s]
Adding requests:  74%|███████▍  | 380/512 [00:01<00:00, 393.01it/s]
Adding requests:  82%|████████▏ | 422/512 [00:01<00:00, 400.03it/s]
Adding requests:  90%|█████████ | 463/512 [00:01<00:00, 396.25it/s]
Adding requests:  99%|█████████▊| 505/512 [00:01<00:00, 403.25it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 381.99it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▌         | 26/512 [00:00<00:02, 190.42it/s, est. speed input: 195028.37 toks/s, output: 190.43 toks/s]
Processed prompts:   9%|▉         | 46/512 [00:01<00:12, 36.23it/s, est. speed input: 43007.84 toks/s, output: 42.00 toks/s]   
Processed prompts:  11%|█         | 56/512 [00:01<00:13, 32.98it/s, est. speed input: 38978.75 toks/s, output: 38.06 toks/s]
Processed prompts:  12%|█▏        | 63/512 [00:01<00:15, 28.07it/s, est. speed input: 34737.33 toks/s, output: 33.92 toks/s]
Processed prompts:  13%|█▎        | 68/512 [00:02<00:16, 27.60it/s, est. speed input: 33931.23 toks/s, output: 33.14 toks/s]
Processed prompts:  14%|█▍        | 72/512 [00:02<00:16, 26.26it/s, est. speed input: 32904.83 toks/s, output: 32.13 toks/s]
Processed prompts:  15%|█▍        | 76/512 [00:02<00:17, 25.08it/s, est. speed input: 32032.96 toks/s, output: 31.28 toks/s]
Processed prompts:  15%|█▌        | 79/512 [00:02<00:19, 22.74it/s, est. speed input: 30874.63 toks/s, output: 30.15 toks/s]
Processed prompts:  16%|█▌        | 82/512 [00:02<00:20, 20.81it/s, est. speed input: 29840.12 toks/s, output: 29.14 toks/s]
Processed prompts:  17%|█▋        | 86/512 [00:03<00:20, 20.76it/s, est. speed input: 29277.77 toks/s, output: 28.59 toks/s]
Processed prompts:  18%|█▊        | 90/512 [00:03<00:20, 20.83it/s, est. speed input: 28816.17 toks/s, output: 28.14 toks/s]
Processed prompts:  18%|█▊        | 94/512 [00:03<00:19, 20.93it/s, est. speed input: 28419.71 toks/s, output: 27.75 toks/s]
Processed prompts:  19%|█▉        | 98/512 [00:03<00:19, 20.93it/s, est. speed input: 28047.22 toks/s, output: 27.39 toks/s]
Processed prompts:  20%|█▉        | 102/512 [00:03<00:19, 20.88it/s, est. speed input: 27699.82 toks/s, output: 27.05 toks/s]
Processed prompts:  21%|██        | 106/512 [00:03<00:19, 20.80it/s, est. speed input: 27377.34 toks/s, output: 26.74 toks/s]
Processed prompts:  21%|██▏       | 110/512 [00:04<00:19, 20.79it/s, est. speed input: 27093.16 toks/s, output: 26.46 toks/s]
Processed prompts:  22%|██▏       | 114/512 [00:04<00:19, 20.91it/s, est. speed input: 26860.14 toks/s, output: 26.23 toks/s]
Processed prompts:  23%|██▎       | 118/512 [00:04<00:18, 20.90it/s, est. speed input: 26628.36 toks/s, output: 26.00 toks/s]
Processed prompts:  24%|██▍       | 122/512 [00:04<00:18, 20.86it/s, est. speed input: 26409.55 toks/s, output: 25.79 toks/s]
Processed prompts:  25%|██▍       | 126/512 [00:04<00:18, 20.80it/s, est. speed input: 26202.78 toks/s, output: 25.59 toks/s]
Processed prompts:  25%|██▌       | 130/512 [00:05<00:18, 20.76it/s, est. speed input: 26012.79 toks/s, output: 25.40 toks/s]
Processed prompts:  26%|██▌       | 134/512 [00:05<00:18, 20.84it/s, est. speed input: 25852.05 toks/s, output: 25.25 toks/s]
Processed prompts:  27%|██▋       | 138/512 [00:05<00:17, 20.88it/s, est. speed input: 25699.90 toks/s, output: 25.10 toks/s]
Processed prompts:  28%|██▊       | 142/512 [00:05<00:17, 20.84it/s, est. speed input: 25548.78 toks/s, output: 24.95 toks/s]
Processed prompts:  29%|██▊       | 146/512 [00:05<00:17, 20.80it/s, est. speed input: 25406.45 toks/s, output: 24.81 toks/s]
Processed prompts:  29%|██▉       | 150/512 [00:06<00:17, 20.78it/s, est. speed input: 25273.72 toks/s, output: 24.68 toks/s]
Processed prompts:  30%|███       | 154/512 [00:06<00:17, 20.84it/s, est. speed input: 25158.69 toks/s, output: 24.57 toks/s]
Processed prompts:  31%|███       | 158/512 [00:06<00:16, 20.86it/s, est. speed input: 25047.10 toks/s, output: 24.46 toks/s]
Processed prompts:  32%|███▏      | 162/512 [00:06<00:16, 20.84it/s, est. speed input: 24939.13 toks/s, output: 24.35 toks/s]
Processed prompts:  32%|███▏      | 166/512 [00:06<00:16, 20.82it/s, est. speed input: 24835.28 toks/s, output: 24.25 toks/s]
Processed prompts:  33%|███▎      | 170/512 [00:07<00:16, 20.83it/s, est. speed input: 24740.98 toks/s, output: 24.16 toks/s]
Processed prompts:  34%|███▍      | 174/512 [00:07<00:16, 20.84it/s, est. speed input: 24650.79 toks/s, output: 24.07 toks/s]
Processed prompts:  35%|███▍      | 178/512 [00:07<00:16, 20.86it/s, est. speed input: 24567.86 toks/s, output: 23.99 toks/s]
Processed prompts:  36%|███▌      | 182/512 [00:07<00:15, 20.86it/s, est. speed input: 24486.42 toks/s, output: 23.91 toks/s]
Processed prompts:  36%|███▋      | 186/512 [00:07<00:15, 20.82it/s, est. speed input: 24406.33 toks/s, output: 23.83 toks/s]
Processed prompts:  37%|███▋      | 190/512 [00:07<00:15, 20.81it/s, est. speed input: 24330.97 toks/s, output: 23.76 toks/s]
Processed prompts:  38%|███▊      | 194/512 [00:08<00:15, 20.82it/s, est. speed input: 24260.82 toks/s, output: 23.69 toks/s]
Processed prompts:  39%|███▊      | 198/512 [00:08<00:15, 20.81it/s, est. speed input: 24192.79 toks/s, output: 23.63 toks/s]
Processed prompts:  39%|███▉      | 202/512 [00:08<00:14, 22.06it/s, est. speed input: 24230.98 toks/s, output: 23.66 toks/s]
Processed prompts:  40%|████      | 206/512 [00:08<00:14, 21.70it/s, est. speed input: 24168.67 toks/s, output: 23.60 toks/s]
Processed prompts:  41%|████      | 210/512 [00:08<00:14, 21.41it/s, est. speed input: 24106.16 toks/s, output: 23.54 toks/s]
Processed prompts:  42%|████▏     | 214/512 [00:09<00:14, 21.25it/s, est. speed input: 24048.72 toks/s, output: 23.48 toks/s]
Processed prompts:  43%|████▎     | 218/512 [00:09<00:13, 21.13it/s, est. speed input: 23993.46 toks/s, output: 23.43 toks/s]
Processed prompts:  43%|████▎     | 222/512 [00:09<00:13, 21.03it/s, est. speed input: 23938.84 toks/s, output: 23.38 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:09<00:13, 21.04it/s, est. speed input: 23892.15 toks/s, output: 23.33 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:09<00:13, 20.99it/s, est. speed input: 23843.81 toks/s, output: 23.28 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:10<00:13, 20.98it/s, est. speed input: 23798.05 toks/s, output: 23.24 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:10<00:13, 20.97it/s, est. speed input: 23754.73 toks/s, output: 23.20 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:10<00:12, 20.96it/s, est. speed input: 23712.24 toks/s, output: 23.16 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:10<00:12, 20.99it/s, est. speed input: 23673.68 toks/s, output: 23.12 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:10<00:12, 20.98it/s, est. speed input: 23634.88 toks/s, output: 23.08 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:11<00:12, 20.93it/s, est. speed input: 23594.56 toks/s, output: 23.04 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:11<00:12, 20.92it/s, est. speed input: 23556.99 toks/s, output: 23.00 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:11<00:11, 20.96it/s, est. speed input: 23523.73 toks/s, output: 22.97 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:11<00:11, 20.98it/s, est. speed input: 23490.90 toks/s, output: 22.94 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:11<00:11, 20.99it/s, est. speed input: 23458.91 toks/s, output: 22.91 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:11<00:11, 20.96it/s, est. speed input: 23426.09 toks/s, output: 22.88 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:12<00:11, 20.96it/s, est. speed input: 23395.31 toks/s, output: 22.85 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:12<00:10, 20.95it/s, est. speed input: 23364.84 toks/s, output: 22.82 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:12<00:10, 20.92it/s, est. speed input: 23334.13 toks/s, output: 22.79 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:12<00:10, 20.95it/s, est. speed input: 23307.07 toks/s, output: 22.76 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:12<00:10, 20.92it/s, est. speed input: 23278.29 toks/s, output: 22.73 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:13<00:10, 20.91it/s, est. speed input: 23250.61 toks/s, output: 22.71 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:13<00:10, 20.90it/s, est. speed input: 23223.37 toks/s, output: 22.68 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:13<00:09, 20.94it/s, est. speed input: 23199.59 toks/s, output: 22.66 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:13<00:09, 20.96it/s, est. speed input: 23176.43 toks/s, output: 22.63 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:13<00:09, 20.98it/s, est. speed input: 23153.89 toks/s, output: 22.61 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:14<00:09, 20.91it/s, est. speed input: 23127.65 toks/s, output: 22.59 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:14<00:09, 20.86it/s, est. speed input: 23102.00 toks/s, output: 22.56 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:14<00:08, 20.89it/s, est. speed input: 23080.45 toks/s, output: 22.54 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:14<00:08, 20.92it/s, est. speed input: 23059.70 toks/s, output: 22.52 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:14<00:08, 20.96it/s, est. speed input: 23040.37 toks/s, output: 22.50 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:15<00:08, 20.94it/s, est. speed input: 23019.70 toks/s, output: 22.48 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:15<00:08, 20.91it/s, est. speed input: 22998.45 toks/s, output: 22.46 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:15<00:07, 20.90it/s, est. speed input: 22978.22 toks/s, output: 22.44 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:15<00:07, 20.86it/s, est. speed input: 22956.98 toks/s, output: 22.42 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:15<00:07, 20.91it/s, est. speed input: 22939.99 toks/s, output: 22.40 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:15<00:07, 20.95it/s, est. speed input: 22923.37 toks/s, output: 22.39 toks/s]
Processed prompts:  71%|███████   | 362/512 [00:16<00:07, 20.93it/s, est. speed input: 22905.06 toks/s, output: 22.37 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:16<00:06, 20.90it/s, est. speed input: 22886.53 toks/s, output: 22.35 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [00:16<00:06, 20.92it/s, est. speed input: 22870.48 toks/s, output: 22.33 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [00:16<00:06, 20.88it/s, est. speed input: 22852.06 toks/s, output: 22.32 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [00:16<00:06, 20.86it/s, est. speed input: 22834.53 toks/s, output: 22.30 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [00:17<00:06, 20.91it/s, est. speed input: 22820.14 toks/s, output: 22.29 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [00:17<00:06, 20.91it/s, est. speed input: 22804.63 toks/s, output: 22.27 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [00:17<00:05, 20.93it/s, est. speed input: 22790.39 toks/s, output: 22.26 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [00:17<00:05, 20.92it/s, est. speed input: 22775.22 toks/s, output: 22.24 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [00:17<00:05, 20.88it/s, est. speed input: 22759.27 toks/s, output: 22.23 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [00:18<00:05, 20.91it/s, est. speed input: 22745.87 toks/s, output: 22.21 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [00:18<00:05, 20.87it/s, est. speed input: 22730.23 toks/s, output: 22.20 toks/s]
Processed prompts:  80%|████████  | 410/512 [00:18<00:04, 20.86it/s, est. speed input: 22715.91 toks/s, output: 22.18 toks/s]
Processed prompts:  81%|████████  | 414/512 [00:18<00:04, 20.84it/s, est. speed input: 22701.30 toks/s, output: 22.17 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [00:18<00:04, 20.83it/s, est. speed input: 22687.19 toks/s, output: 22.16 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [00:19<00:04, 20.84it/s, est. speed input: 22673.69 toks/s, output: 22.14 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [00:19<00:04, 20.84it/s, est. speed input: 22660.35 toks/s, output: 22.13 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [00:19<00:03, 20.85it/s, est. speed input: 22647.76 toks/s, output: 22.12 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [00:19<00:03, 20.86it/s, est. speed input: 22635.46 toks/s, output: 22.10 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [00:19<00:03, 20.90it/s, est. speed input: 22624.36 toks/s, output: 22.09 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [00:20<00:03, 20.82it/s, est. speed input: 22609.84 toks/s, output: 22.08 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [00:20<00:03, 20.83it/s, est. speed input: 22598.02 toks/s, output: 22.07 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [00:20<00:02, 20.84it/s, est. speed input: 22586.57 toks/s, output: 22.06 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [00:20<00:02, 20.85it/s, est. speed input: 22575.20 toks/s, output: 22.05 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [00:20<00:02, 20.87it/s, est. speed input: 22564.60 toks/s, output: 22.04 toks/s]
Processed prompts:  90%|█████████ | 462/512 [00:20<00:02, 20.85it/s, est. speed input: 22552.98 toks/s, output: 22.02 toks/s]
Processed prompts:  91%|█████████ | 466/512 [00:21<00:02, 20.85it/s, est. speed input: 22542.21 toks/s, output: 22.01 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [00:21<00:02, 20.89it/s, est. speed input: 22532.64 toks/s, output: 22.00 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [00:21<00:01, 20.87it/s, est. speed input: 22521.85 toks/s, output: 21.99 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [00:21<00:01, 20.83it/s, est. speed input: 22510.36 toks/s, output: 21.98 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [00:21<00:01, 20.78it/s, est. speed input: 22498.68 toks/s, output: 21.97 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [00:22<00:01, 20.80it/s, est. speed input: 22488.45 toks/s, output: 21.96 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [00:22<00:01, 20.85it/s, est. speed input: 22479.92 toks/s, output: 21.95 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [00:22<00:00, 20.85it/s, est. speed input: 22470.31 toks/s, output: 21.94 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [00:22<00:00, 20.85it/s, est. speed input: 22460.82 toks/s, output: 21.93 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [00:22<00:00, 20.83it/s, est. speed input: 22451.03 toks/s, output: 21.92 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [00:23<00:00, 20.84it/s, est. speed input: 22441.87 toks/s, output: 21.92 toks/s]
Processed prompts: 100%|█████████▉| 510/512 [00:23<00:00, 22.35it/s, est. speed input: 22474.66 toks/s, output: 21.95 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:23<00:00, 22.35it/s, est. speed input: 22562.54 toks/s, output: 22.03 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:23<00:00, 22.03it/s, est. speed input: 22562.54 toks/s, output: 22.03 toks/s]
[rank0]:[W126 13:37:36.706964604 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=8192 ==========
Time: 2026-01-26 13:37:38
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=1024, max_num_seqs=8
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 1024 --max-num-seqs 8 --max-model-len 1025 --max-num-batched-tokens 8192 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-14B-INT8_M8192.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 13:37:51 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1430516) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1430516) WARNING 01-26 13:38:12 [backends.py:609] Failed to read file <frozen os>
Throughput: 21.17 requests/s, 21699.43 total tokens/s, 21.17 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024

STDERR:
[2026-01-26 13:37:50] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 13:37:51] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 13:37:51] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 13:37:51] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:37:51] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:37:51] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:37:51] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:37:51] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:37:51] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 13:37:51] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 13:37:51] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 13:37:51] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 13:37:51] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 13:37:51] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 13:37:57] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 13:37:58] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 13:37:58] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 13:37:58] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:37:58] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:37:58] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:37:58] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:37:58] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:37:58] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 13:37:58] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 13:37:58] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 13:37:58] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 13:37:58] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 13:37:58] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1430516) [2026-01-26 13:37:59] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1430516) [2026-01-26 13:37:59] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1430516) [2026-01-26 13:37:59] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1430516) [2026-01-26 13:37:59] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1430516) [2026-01-26 13:37:59] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=1430516) [2026-01-26 13:37:59] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1430516) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1430516) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.27it/s]
(EngineCore_DP0 pid=1430516) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.17it/s]
(EngineCore_DP0 pid=1430516) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.61it/s]
(EngineCore_DP0 pid=1430516) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.45it/s]
(EngineCore_DP0 pid=1430516) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.41it/s]
(EngineCore_DP0 pid=1430516) 
(EngineCore_DP0 pid=1430516) [2026-01-26 13:38:03] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 7680] -> 1D uint8
(EngineCore_DP0 pid=1430516) [2026-01-26 13:38:03] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 34406400 bytes
(EngineCore_DP0 pid=1430516) [2026-01-26 13:38:03] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 7680] -> 1D uint8
(EngineCore_DP0 pid=1430516) [2026-01-26 13:38:03] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 24576000 bytes
(EngineCore_DP0 pid=1430516) [2026-01-26 13:38:03] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 7680] -> 1D uint8
(EngineCore_DP0 pid=1430516) [2026-01-26 13:38:03] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 132710400 bytes
(EngineCore_DP0 pid=1430516) [2026-01-26 13:38:03] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 20736] -> 1D uint8
(EngineCore_DP0 pid=1430516) [2026-01-26 13:38:03] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 66355200 bytes
(EngineCore_DP0 pid=1430516) 2026-01-26 13:38:26,444 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1430516) 2026-01-26 13:38:26,571 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1430516) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:00,  7.95it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  60%|██████    | 3/5 [00:00<00:00, 10.50it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00,  5.84it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00,  6.40it/s]
(EngineCore_DP0 pid=1430516) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:01,  2.31it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 2/4 [00:00<00:00,  3.89it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  5.74it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  4.90it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 21/1024 [00:00<00:04, 204.56it/s]
Adding requests:   6%|▌         | 61/1024 [00:00<00:03, 317.60it/s]
Adding requests:   9%|▉         | 97/1024 [00:00<00:02, 335.84it/s]
Adding requests:  13%|█▎        | 135/1024 [00:00<00:02, 350.32it/s]
Adding requests:  17%|█▋        | 174/1024 [00:00<00:02, 364.28it/s]
Adding requests:  21%|██        | 212/1024 [00:00<00:02, 367.49it/s]
Adding requests:  25%|██▍       | 251/1024 [00:00<00:02, 372.83it/s]
Adding requests:  28%|██▊       | 290/1024 [00:00<00:01, 376.42it/s]
Adding requests:  32%|███▏      | 331/1024 [00:00<00:01, 385.26it/s]
Adding requests:  36%|███▋      | 372/1024 [00:01<00:01, 390.84it/s]
Adding requests:  40%|████      | 413/1024 [00:01<00:01, 395.51it/s]
Adding requests:  44%|████▍     | 453/1024 [00:01<00:01, 394.64it/s]
Adding requests:  48%|████▊     | 496/1024 [00:01<00:01, 404.16it/s]
Adding requests:  52%|█████▏    | 537/1024 [00:01<00:01, 403.43it/s]
Adding requests:  56%|█████▋    | 578/1024 [00:01<00:01, 400.65it/s]
Adding requests:  60%|██████    | 619/1024 [00:01<00:01, 391.96it/s]
Adding requests:  64%|██████▍   | 659/1024 [00:01<00:00, 387.36it/s]
Adding requests:  68%|██████▊   | 698/1024 [00:01<00:00, 388.07it/s]
Adding requests:  72%|███████▏  | 737/1024 [00:01<00:00, 382.37it/s]
Adding requests:  76%|███████▌  | 777/1024 [00:02<00:00, 385.39it/s]
Adding requests:  80%|███████▉  | 816/1024 [00:02<00:00, 384.80it/s]
Adding requests:  84%|████████▎ | 857/1024 [00:02<00:00, 391.79it/s]
Adding requests:  88%|████████▊ | 897/1024 [00:02<00:00, 393.88it/s]
Adding requests:  92%|█████████▏| 937/1024 [00:02<00:00, 378.17it/s]
Adding requests:  95%|█████████▌| 976/1024 [00:02<00:00, 381.51it/s]
Adding requests:  99%|█████████▉| 1015/1024 [00:02<00:00, 376.29it/s]
Adding requests: 100%|██████████| 1024/1024 [00:02<00:00, 380.02it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▍         | 50/1024 [00:00<00:02, 332.69it/s, est. speed input: 340782.79 toks/s, output: 332.72 toks/s]
Processed prompts:   8%|▊         | 84/1024 [00:01<00:21, 42.82it/s, est. speed input: 51922.98 toks/s, output: 50.71 toks/s]   
Processed prompts:  10%|▉         | 100/1024 [00:02<00:26, 34.28it/s, est. speed input: 42595.22 toks/s, output: 41.60 toks/s]
Processed prompts:  11%|█         | 110/1024 [00:02<00:28, 32.48it/s, est. speed input: 40448.94 toks/s, output: 39.50 toks/s]
Processed prompts:  11%|█▏        | 117/1024 [00:03<00:31, 29.19it/s, est. speed input: 37933.89 toks/s, output: 37.04 toks/s]
Processed prompts:  12%|█▏        | 122/1024 [00:03<00:35, 25.10it/s, est. speed input: 35336.52 toks/s, output: 34.51 toks/s]
Processed prompts:  13%|█▎        | 130/1024 [00:03<00:37, 24.01it/s, est. speed input: 33998.85 toks/s, output: 33.20 toks/s]
Processed prompts:  13%|█▎        | 138/1024 [00:04<00:38, 23.28it/s, est. speed input: 32939.67 toks/s, output: 32.17 toks/s]
Processed prompts:  14%|█▍        | 146/1024 [00:04<00:38, 22.67it/s, est. speed input: 32025.62 toks/s, output: 31.27 toks/s]
Processed prompts:  15%|█▌        | 154/1024 [00:05<00:39, 22.27it/s, est. speed input: 31261.21 toks/s, output: 30.53 toks/s]
Processed prompts:  16%|█▌        | 162/1024 [00:05<00:39, 22.06it/s, est. speed input: 30630.33 toks/s, output: 29.91 toks/s]
Processed prompts:  17%|█▋        | 170/1024 [00:05<00:39, 21.82it/s, est. speed input: 30054.10 toks/s, output: 29.35 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [00:06<00:38, 21.71it/s, est. speed input: 29564.61 toks/s, output: 28.87 toks/s]
Processed prompts:  18%|█▊        | 186/1024 [00:06<00:38, 21.64it/s, est. speed input: 29133.09 toks/s, output: 28.45 toks/s]
Processed prompts:  19%|█▉        | 194/1024 [00:06<00:38, 21.53it/s, est. speed input: 28732.37 toks/s, output: 28.06 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [00:07<00:37, 22.18it/s, est. speed input: 28535.25 toks/s, output: 27.87 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:07<00:37, 21.95it/s, est. speed input: 28212.43 toks/s, output: 27.55 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [00:07<00:37, 21.73it/s, est. speed input: 27908.05 toks/s, output: 27.25 toks/s]
Processed prompts:  22%|██▏       | 226/1024 [00:08<00:36, 21.65it/s, est. speed input: 27644.54 toks/s, output: 27.00 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:08<00:36, 21.58it/s, est. speed input: 27399.52 toks/s, output: 26.76 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:09<00:36, 21.50it/s, est. speed input: 27170.31 toks/s, output: 26.53 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:09<00:36, 21.48it/s, est. speed input: 26965.38 toks/s, output: 26.33 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:09<00:35, 21.43it/s, est. speed input: 26769.51 toks/s, output: 26.14 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:10<00:35, 21.43it/s, est. speed input: 26593.63 toks/s, output: 25.97 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:10<00:35, 21.40it/s, est. speed input: 26425.32 toks/s, output: 25.81 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:10<00:34, 21.35it/s, est. speed input: 26264.79 toks/s, output: 25.65 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:11<00:34, 21.36it/s, est. speed input: 26121.75 toks/s, output: 25.51 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:11<00:34, 21.35it/s, est. speed input: 25984.05 toks/s, output: 25.37 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:12<00:33, 21.33it/s, est. speed input: 25854.65 toks/s, output: 25.25 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:12<00:33, 21.33it/s, est. speed input: 25733.92 toks/s, output: 25.13 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:12<00:32, 21.31it/s, est. speed input: 25618.18 toks/s, output: 25.02 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:13<00:32, 21.35it/s, est. speed input: 25514.63 toks/s, output: 24.92 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:13<00:32, 21.34it/s, est. speed input: 25413.62 toks/s, output: 24.82 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:13<00:31, 21.31it/s, est. speed input: 25314.57 toks/s, output: 24.72 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:14<00:31, 21.31it/s, est. speed input: 25223.87 toks/s, output: 24.63 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:14<00:31, 21.31it/s, est. speed input: 25136.89 toks/s, output: 24.55 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:15<00:30, 21.32it/s, est. speed input: 25055.24 toks/s, output: 24.47 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:15<00:30, 21.33it/s, est. speed input: 24978.13 toks/s, output: 24.39 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:15<00:29, 21.31it/s, est. speed input: 24902.10 toks/s, output: 24.32 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [00:16<00:29, 21.30it/s, est. speed input: 24829.85 toks/s, output: 24.25 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:16<00:29, 21.32it/s, est. speed input: 24763.54 toks/s, output: 24.18 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:16<00:28, 21.30it/s, est. speed input: 24697.15 toks/s, output: 24.12 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:17<00:28, 21.29it/s, est. speed input: 24633.61 toks/s, output: 24.06 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:17<00:28, 21.28it/s, est. speed input: 24572.79 toks/s, output: 24.00 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:18<00:27, 21.25it/s, est. speed input: 24513.12 toks/s, output: 23.94 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:18<00:27, 21.25it/s, est. speed input: 24457.05 toks/s, output: 23.88 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:18<00:27, 21.25it/s, est. speed input: 24402.96 toks/s, output: 23.83 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:19<00:26, 21.25it/s, est. speed input: 24351.20 toks/s, output: 23.78 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:19<00:26, 21.24it/s, est. speed input: 24300.99 toks/s, output: 23.73 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:20<00:25, 21.24it/s, est. speed input: 24252.97 toks/s, output: 23.68 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:20<00:25, 21.24it/s, est. speed input: 24207.01 toks/s, output: 23.64 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:20<00:25, 21.26it/s, est. speed input: 24163.71 toks/s, output: 23.60 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:21<00:24, 21.23it/s, est. speed input: 24119.17 toks/s, output: 23.55 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:21<00:24, 21.25it/s, est. speed input: 24078.93 toks/s, output: 23.51 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:21<00:24, 21.24it/s, est. speed input: 24038.15 toks/s, output: 23.47 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:22<00:23, 21.22it/s, est. speed input: 23998.51 toks/s, output: 23.44 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:22<00:23, 21.25it/s, est. speed input: 23962.13 toks/s, output: 23.40 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:23<00:22, 21.23it/s, est. speed input: 23925.23 toks/s, output: 23.36 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:23<00:22, 21.23it/s, est. speed input: 23889.67 toks/s, output: 23.33 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:23<00:22, 21.24it/s, est. speed input: 23856.18 toks/s, output: 23.30 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:24<00:21, 21.21it/s, est. speed input: 23821.79 toks/s, output: 23.26 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:24<00:21, 21.21it/s, est. speed input: 23789.21 toks/s, output: 23.23 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:24<00:21, 21.19it/s, est. speed input: 23756.94 toks/s, output: 23.20 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:25<00:20, 21.18it/s, est. speed input: 23725.85 toks/s, output: 23.17 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:25<00:20, 21.24it/s, est. speed input: 23698.89 toks/s, output: 23.14 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:26<00:19, 21.22it/s, est. speed input: 23669.87 toks/s, output: 23.12 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:26<00:19, 21.20it/s, est. speed input: 23640.90 toks/s, output: 23.09 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:26<00:19, 21.22it/s, est. speed input: 23614.55 toks/s, output: 23.06 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:27<00:18, 21.18it/s, est. speed input: 23586.70 toks/s, output: 23.03 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:27<00:18, 21.16it/s, est. speed input: 23559.47 toks/s, output: 23.01 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:27<00:18, 21.16it/s, est. speed input: 23533.85 toks/s, output: 22.98 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:28<00:17, 21.13it/s, est. speed input: 23507.39 toks/s, output: 22.96 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:28<00:17, 21.13it/s, est. speed input: 23482.76 toks/s, output: 22.93 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:29<00:16, 21.16it/s, est. speed input: 23460.16 toks/s, output: 22.91 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:29<00:16, 21.16it/s, est. speed input: 23437.08 toks/s, output: 22.89 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:29<00:16, 21.16it/s, est. speed input: 23414.79 toks/s, output: 22.87 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:30<00:15, 21.18it/s, est. speed input: 23393.87 toks/s, output: 22.85 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:30<00:15, 21.16it/s, est. speed input: 23371.86 toks/s, output: 22.82 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:30<00:15, 21.15it/s, est. speed input: 23350.67 toks/s, output: 22.80 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:31<00:14, 21.13it/s, est. speed input: 23329.44 toks/s, output: 22.78 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:31<00:14, 21.13it/s, est. speed input: 23309.24 toks/s, output: 22.76 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:32<00:13, 21.13it/s, est. speed input: 23289.41 toks/s, output: 22.74 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:32<00:13, 21.12it/s, est. speed input: 23269.74 toks/s, output: 22.72 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:32<00:13, 21.14it/s, est. speed input: 23251.71 toks/s, output: 22.71 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:33<00:12, 21.11it/s, est. speed input: 23232.25 toks/s, output: 22.69 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:33<00:12, 21.10it/s, est. speed input: 23213.53 toks/s, output: 22.67 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:33<00:12, 21.11it/s, est. speed input: 23196.09 toks/s, output: 22.65 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:34<00:11, 21.10it/s, est. speed input: 23178.39 toks/s, output: 22.64 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:34<00:10, 21.80it/s, est. speed input: 23188.30 toks/s, output: 22.64 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:35<00:10, 21.63it/s, est. speed input: 23172.76 toks/s, output: 22.63 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:35<00:10, 21.45it/s, est. speed input: 23155.24 toks/s, output: 22.61 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:35<00:10, 21.33it/s, est. speed input: 23138.57 toks/s, output: 22.60 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:36<00:09, 21.28it/s, est. speed input: 23123.14 toks/s, output: 22.58 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:36<00:09, 21.23it/s, est. speed input: 23107.67 toks/s, output: 22.57 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:36<00:08, 21.20it/s, est. speed input: 23092.75 toks/s, output: 22.55 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [00:37<00:08, 21.17it/s, est. speed input: 23077.41 toks/s, output: 22.54 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [00:37<00:08, 21.14it/s, est. speed input: 23062.35 toks/s, output: 22.52 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:38<00:07, 21.13it/s, est. speed input: 23048.03 toks/s, output: 22.51 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [00:38<00:07, 21.11it/s, est. speed input: 23033.46 toks/s, output: 22.49 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [00:38<00:07, 21.11it/s, est. speed input: 23019.58 toks/s, output: 22.48 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [00:39<00:06, 21.09it/s, est. speed input: 23005.53 toks/s, output: 22.47 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [00:39<00:06, 21.05it/s, est. speed input: 22990.39 toks/s, output: 22.45 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [00:40<00:05, 21.07it/s, est. speed input: 22977.72 toks/s, output: 22.44 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [00:40<00:05, 21.07it/s, est. speed input: 22964.42 toks/s, output: 22.43 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [00:40<00:05, 21.07it/s, est. speed input: 22951.38 toks/s, output: 22.41 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [00:41<00:04, 21.07it/s, est. speed input: 22938.79 toks/s, output: 22.40 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [00:41<00:04, 21.05it/s, est. speed input: 22925.69 toks/s, output: 22.39 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [00:41<00:04, 21.05it/s, est. speed input: 22913.17 toks/s, output: 22.38 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [00:42<00:03, 21.06it/s, est. speed input: 22901.23 toks/s, output: 22.36 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [00:42<00:03, 21.06it/s, est. speed input: 22889.28 toks/s, output: 22.35 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [00:43<00:02, 21.01it/s, est. speed input: 22876.21 toks/s, output: 22.34 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [00:43<00:02, 21.03it/s, est. speed input: 22864.88 toks/s, output: 22.33 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [00:43<00:02, 21.05it/s, est. speed input: 22853.98 toks/s, output: 22.32 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [00:44<00:01, 21.05it/s, est. speed input: 22842.88 toks/s, output: 22.31 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [00:44<00:01, 21.05it/s, est. speed input: 22831.75 toks/s, output: 22.30 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [00:44<00:01, 21.04it/s, est. speed input: 22820.59 toks/s, output: 22.29 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [00:45<00:00, 21.05it/s, est. speed input: 22810.25 toks/s, output: 22.28 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [00:45<00:00, 21.88it/s, est. speed input: 22823.86 toks/s, output: 22.29 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:45<00:00, 21.88it/s, est. speed input: 22958.17 toks/s, output: 22.42 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:45<00:00, 22.42it/s, est. speed input: 22958.17 toks/s, output: 22.42 toks/s]
[rank0]:[W126 13:39:18.520732965 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=16384 ==========
Time: 2026-01-26 13:39:20
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=2048, max_num_seqs=16
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 2048 --max-num-seqs 16 --max-model-len 1025 --max-num-batched-tokens 16384 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-14B-INT8_M16384.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 13:39:37 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1432436) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1432436) WARNING 01-26 13:39:59 [backends.py:609] Failed to read file <frozen os>
Throughput: 21.62 requests/s, 22157.11 total tokens/s, 21.62 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048

STDERR:
[2026-01-26 13:39:37] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 13:39:37] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 13:39:37] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 13:39:37] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:39:37] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:39:37] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:39:37] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:39:37] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:39:37] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 13:39:37] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 13:39:37] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 13:39:37] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 13:39:37] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 13:39:37] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 13:39:44] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 13:39:45] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 13:39:45] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 13:39:45] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:39:45] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:39:45] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:39:45] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:39:45] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:39:45] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 13:39:45] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 13:39:45] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 13:39:45] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 13:39:45] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 13:39:45] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1432436) [2026-01-26 13:39:46] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1432436) [2026-01-26 13:39:46] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1432436) [2026-01-26 13:39:46] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1432436) [2026-01-26 13:39:46] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1432436) [2026-01-26 13:39:46] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=1432436) [2026-01-26 13:39:46] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1432436) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1432436) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.28it/s]
(EngineCore_DP0 pid=1432436) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.19it/s]
(EngineCore_DP0 pid=1432436) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.62it/s]
(EngineCore_DP0 pid=1432436) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.46it/s]
(EngineCore_DP0 pid=1432436) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.42it/s]
(EngineCore_DP0 pid=1432436) 
(EngineCore_DP0 pid=1432436) [2026-01-26 13:39:49] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 7680] -> 1D uint8
(EngineCore_DP0 pid=1432436) [2026-01-26 13:39:50] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 34406400 bytes
(EngineCore_DP0 pid=1432436) [2026-01-26 13:39:50] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 7680] -> 1D uint8
(EngineCore_DP0 pid=1432436) [2026-01-26 13:39:50] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 24576000 bytes
(EngineCore_DP0 pid=1432436) [2026-01-26 13:39:50] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 7680] -> 1D uint8
(EngineCore_DP0 pid=1432436) [2026-01-26 13:39:50] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 132710400 bytes
(EngineCore_DP0 pid=1432436) [2026-01-26 13:39:50] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 20736] -> 1D uint8
(EngineCore_DP0 pid=1432436) [2026-01-26 13:39:50] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 66355200 bytes
(EngineCore_DP0 pid=1432436) [rank0]:W0126 13:40:08.027000 1432436 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1432436) [rank0]:W0126 13:40:08.081000 1432436 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1432436) [rank0]:W0126 13:40:08.700000 1432436 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1432436) [rank0]:W0126 13:40:08.784000 1432436 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1432436) 2026-01-26 13:40:13,337 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1432436) 2026-01-26 13:40:13,566 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1432436) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  14%|█▍        | 1/7 [00:00<00:00,  7.61it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  43%|████▎     | 3/7 [00:00<00:00,  7.25it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  57%|█████▋    | 4/7 [00:00<00:00,  3.73it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  71%|███████▏  | 5/7 [00:01<00:00,  3.48it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:01<00:00,  5.10it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:01<00:00,  4.82it/s]
(EngineCore_DP0 pid=1432436) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  40%|████      | 2/5 [00:00<00:00, 11.65it/s]
Capturing CUDA graphs (decode, FULL):  80%|████████  | 4/5 [00:00<00:00, 12.07it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00, 12.04it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   1%|          | 24/2048 [00:00<00:08, 239.84it/s]
Adding requests:   3%|▎         | 64/2048 [00:00<00:06, 330.27it/s]
Adding requests:   5%|▍         | 99/2048 [00:00<00:05, 338.27it/s]
Adding requests:   7%|▋         | 137/2048 [00:00<00:05, 352.26it/s]
Adding requests:   9%|▊         | 176/2048 [00:00<00:05, 363.25it/s]
Adding requests:  11%|█         | 216/2048 [00:00<00:04, 374.47it/s]
Adding requests:  12%|█▏        | 254/2048 [00:00<00:04, 375.21it/s]
Adding requests:  14%|█▍        | 293/2048 [00:00<00:04, 377.14it/s]
Adding requests:  16%|█▋        | 334/2048 [00:00<00:04, 385.31it/s]
Adding requests:  18%|█▊        | 374/2048 [00:01<00:04, 387.74it/s]
Adding requests:  20%|██        | 415/2048 [00:01<00:04, 392.22it/s]
Adding requests:  22%|██▏       | 455/2048 [00:01<00:04, 390.18it/s]
Adding requests:  24%|██▍       | 497/2048 [00:01<00:03, 397.44it/s]
Adding requests:  26%|██▋       | 539/2048 [00:01<00:03, 401.46it/s]
Adding requests:  28%|██▊       | 580/2048 [00:01<00:03, 398.03it/s]
Adding requests:  30%|███       | 620/2048 [00:01<00:03, 387.39it/s]
Adding requests:  32%|███▏      | 659/2048 [00:01<00:03, 382.18it/s]
Adding requests:  34%|███▍      | 698/2048 [00:01<00:03, 382.15it/s]
Adding requests:  36%|███▌      | 737/2048 [00:01<00:03, 376.83it/s]
Adding requests:  38%|███▊      | 775/2048 [00:02<00:03, 372.93it/s]
Adding requests:  40%|███▉      | 813/2048 [00:02<00:03, 373.96it/s]
Adding requests:  42%|████▏     | 854/2048 [00:02<00:03, 383.26it/s]
Adding requests:  44%|████▎     | 893/2048 [00:02<00:03, 384.28it/s]
Adding requests:  46%|████▌     | 932/2048 [00:02<00:02, 377.72it/s]
Adding requests:  47%|████▋     | 971/2048 [00:02<00:02, 379.45it/s]
Adding requests:  49%|████▉     | 1009/2048 [00:02<00:02, 374.56it/s]
Adding requests:  51%|█████     | 1047/2048 [00:02<00:02, 373.53it/s]
Adding requests:  53%|█████▎    | 1085/2048 [00:02<00:02, 373.37it/s]
Adding requests:  55%|█████▍    | 1123/2048 [00:02<00:02, 374.90it/s]
Adding requests:  57%|█████▋    | 1161/2048 [00:03<00:02, 372.07it/s]
Adding requests:  59%|█████▊    | 1200/2048 [00:03<00:02, 375.21it/s]
Adding requests:  61%|██████    | 1240/2048 [00:03<00:02, 381.61it/s]
Adding requests:  62%|██████▏   | 1279/2048 [00:03<00:02, 376.69it/s]
Adding requests:  64%|██████▍   | 1318/2048 [00:03<00:01, 377.80it/s]
Adding requests:  66%|██████▋   | 1357/2048 [00:03<00:01, 380.07it/s]
Adding requests:  68%|██████▊   | 1396/2048 [00:03<00:01, 379.56it/s]
Adding requests:  70%|███████   | 1434/2048 [00:03<00:01, 377.76it/s]
Adding requests:  72%|███████▏  | 1473/2048 [00:03<00:01, 378.98it/s]
Adding requests:  74%|███████▍  | 1514/2048 [00:04<00:01, 385.62it/s]
Adding requests:  76%|███████▌  | 1553/2048 [00:04<00:01, 380.62it/s]
Adding requests:  78%|███████▊  | 1592/2048 [00:04<00:01, 375.28it/s]
Adding requests:  80%|███████▉  | 1630/2048 [00:04<00:01, 368.85it/s]
Adding requests:  81%|████████▏ | 1667/2048 [00:04<00:01, 361.05it/s]
Adding requests:  83%|████████▎ | 1706/2048 [00:04<00:00, 369.09it/s]
Adding requests:  85%|████████▌ | 1744/2048 [00:04<00:00, 371.48it/s]
Adding requests:  87%|████████▋ | 1784/2048 [00:04<00:00, 378.54it/s]
Adding requests:  89%|████████▉ | 1822/2048 [00:04<00:00, 376.61it/s]
Adding requests:  91%|█████████ | 1861/2048 [00:04<00:00, 378.06it/s]
Adding requests:  93%|█████████▎| 1899/2048 [00:05<00:00, 378.42it/s]
Adding requests:  95%|█████████▍| 1937/2048 [00:05<00:00, 375.09it/s]
Adding requests:  96%|█████████▋| 1976/2048 [00:05<00:00, 377.78it/s]
Adding requests:  98%|█████████▊| 2014/2048 [00:05<00:00, 375.15it/s]
Adding requests: 100%|██████████| 2048/2048 [00:05<00:00, 376.35it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▌         | 114/2048 [00:00<00:09, 210.85it/s, est. speed input: 215915.06 toks/s, output: 210.85 toks/s]
Processed prompts:   7%|▋         | 136/2048 [00:01<00:20, 91.72it/s, est. speed input: 109471.84 toks/s, output: 106.91 toks/s] 
Processed prompts:   7%|▋         | 147/2048 [00:02<00:34, 54.46it/s, est. speed input: 75052.33 toks/s, output: 73.29 toks/s]  
Processed prompts:   8%|▊         | 162/2048 [00:02<00:46, 40.60it/s, est. speed input: 60631.71 toks/s, output: 59.21 toks/s]
Processed prompts:   9%|▊         | 178/2048 [00:03<00:55, 33.73it/s, est. speed input: 52602.95 toks/s, output: 51.37 toks/s]
Processed prompts:   9%|▉         | 194/2048 [00:04<01:01, 30.17it/s, est. speed input: 47766.27 toks/s, output: 46.65 toks/s]
Processed prompts:  10%|█         | 210/2048 [00:04<01:07, 27.39it/s, est. speed input: 43968.40 toks/s, output: 42.94 toks/s]
Processed prompts:  11%|█         | 226/2048 [00:05<01:11, 25.61it/s, est. speed input: 41161.99 toks/s, output: 40.20 toks/s]
Processed prompts:  12%|█▏        | 242/2048 [00:06<01:13, 24.43it/s, est. speed input: 39002.11 toks/s, output: 38.09 toks/s]
Processed prompts:  13%|█▎        | 258/2048 [00:07<01:15, 23.61it/s, est. speed input: 37272.42 toks/s, output: 36.40 toks/s]
Processed prompts:  13%|█▎        | 274/2048 [00:07<01:16, 23.06it/s, est. speed input: 35874.90 toks/s, output: 35.03 toks/s]
Processed prompts:  14%|█▍        | 290/2048 [00:08<01:17, 22.69it/s, est. speed input: 34719.17 toks/s, output: 33.91 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [00:09<01:17, 22.43it/s, est. speed input: 33742.93 toks/s, output: 32.95 toks/s]
Processed prompts:  16%|█▌        | 322/2048 [00:10<01:17, 22.25it/s, est. speed input: 32909.84 toks/s, output: 32.14 toks/s]
Processed prompts:  17%|█▋        | 338/2048 [00:10<01:17, 22.10it/s, est. speed input: 32184.61 toks/s, output: 31.43 toks/s]
Processed prompts:  17%|█▋        | 354/2048 [00:11<01:17, 22.00it/s, est. speed input: 31550.29 toks/s, output: 30.81 toks/s]
Processed prompts:  18%|█▊        | 370/2048 [00:12<01:16, 21.94it/s, est. speed input: 30996.43 toks/s, output: 30.27 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [00:12<01:15, 21.89it/s, est. speed input: 30504.24 toks/s, output: 29.79 toks/s]
Processed prompts:  20%|█▉        | 402/2048 [00:13<01:15, 21.85it/s, est. speed input: 30061.78 toks/s, output: 29.36 toks/s]
Processed prompts:  20%|██        | 418/2048 [00:14<01:14, 21.82it/s, est. speed input: 29665.28 toks/s, output: 28.97 toks/s]
Processed prompts:  21%|██        | 434/2048 [00:15<01:14, 21.80it/s, est. speed input: 29305.46 toks/s, output: 28.62 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [00:15<01:13, 21.80it/s, est. speed input: 28983.33 toks/s, output: 28.30 toks/s]
Processed prompts:  23%|██▎       | 466/2048 [00:16<01:12, 21.79it/s, est. speed input: 28687.12 toks/s, output: 28.01 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [00:17<01:11, 21.77it/s, est. speed input: 28414.43 toks/s, output: 27.75 toks/s]
Processed prompts:  24%|██▍       | 498/2048 [00:18<01:11, 21.76it/s, est. speed input: 28164.24 toks/s, output: 27.50 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [00:18<01:10, 21.78it/s, est. speed input: 27937.94 toks/s, output: 27.28 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [00:19<01:09, 21.76it/s, est. speed input: 27723.10 toks/s, output: 27.07 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [00:20<01:09, 21.74it/s, est. speed input: 27523.45 toks/s, output: 26.88 toks/s]
Processed prompts:  27%|██▋       | 562/2048 [00:21<01:08, 21.74it/s, est. speed input: 27339.32 toks/s, output: 26.70 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [00:21<01:07, 21.73it/s, est. speed input: 27166.44 toks/s, output: 26.53 toks/s]
Processed prompts:  29%|██▉       | 594/2048 [00:22<01:06, 21.72it/s, est. speed input: 27003.97 toks/s, output: 26.37 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [00:23<01:06, 21.72it/s, est. speed input: 26853.55 toks/s, output: 26.22 toks/s]
Processed prompts:  31%|███       | 626/2048 [00:23<01:05, 21.72it/s, est. speed input: 26711.31 toks/s, output: 26.09 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [00:24<01:04, 21.70it/s, est. speed input: 26576.33 toks/s, output: 25.95 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [00:25<01:04, 21.69it/s, est. speed input: 26448.53 toks/s, output: 25.83 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [00:26<01:03, 21.70it/s, est. speed input: 26330.33 toks/s, output: 25.71 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [00:26<01:02, 21.67it/s, est. speed input: 26214.78 toks/s, output: 25.60 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [00:27<01:01, 21.66it/s, est. speed input: 26106.91 toks/s, output: 25.49 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [00:28<01:01, 21.67it/s, est. speed input: 26005.18 toks/s, output: 25.40 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [00:29<01:00, 21.67it/s, est. speed input: 25908.39 toks/s, output: 25.30 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [00:29<00:59, 21.65it/s, est. speed input: 25815.34 toks/s, output: 25.21 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [00:30<00:59, 21.65it/s, est. speed input: 25727.58 toks/s, output: 25.12 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [00:31<00:57, 22.02it/s, est. speed input: 25677.32 toks/s, output: 25.08 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [00:32<00:56, 21.91it/s, est. speed input: 25597.05 toks/s, output: 25.00 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [00:32<00:56, 21.84it/s, est. speed input: 25520.41 toks/s, output: 24.92 toks/s]
Processed prompts:  41%|████      | 834/2048 [00:33<00:55, 21.78it/s, est. speed input: 25446.73 toks/s, output: 24.85 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [00:34<00:55, 21.74it/s, est. speed input: 25376.18 toks/s, output: 24.78 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [00:35<00:54, 21.71it/s, est. speed input: 25307.82 toks/s, output: 24.71 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [00:35<00:53, 21.68it/s, est. speed input: 25242.58 toks/s, output: 24.65 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [00:36<00:53, 21.67it/s, est. speed input: 25180.12 toks/s, output: 24.59 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [00:37<00:52, 21.64it/s, est. speed input: 25118.57 toks/s, output: 24.53 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [00:38<00:51, 21.63it/s, est. speed input: 25060.45 toks/s, output: 24.47 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [00:38<00:50, 21.63it/s, est. speed input: 25004.78 toks/s, output: 24.42 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [00:39<00:50, 21.63it/s, est. speed input: 24951.02 toks/s, output: 24.37 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [00:40<00:49, 21.62it/s, est. speed input: 24898.82 toks/s, output: 24.32 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [00:40<00:48, 21.61it/s, est. speed input: 24848.11 toks/s, output: 24.27 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [00:41<00:48, 21.59it/s, est. speed input: 24798.92 toks/s, output: 24.22 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [00:42<00:47, 21.61it/s, est. speed input: 24752.84 toks/s, output: 24.17 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [00:43<00:46, 21.60it/s, est. speed input: 24707.27 toks/s, output: 24.13 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [00:43<00:45, 21.60it/s, est. speed input: 24663.59 toks/s, output: 24.09 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [00:44<00:45, 21.60it/s, est. speed input: 24621.28 toks/s, output: 24.04 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [00:45<00:44, 21.59it/s, est. speed input: 24579.73 toks/s, output: 24.00 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [00:46<00:43, 21.58it/s, est. speed input: 24539.50 toks/s, output: 23.96 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [00:46<00:42, 21.56it/s, est. speed input: 24499.78 toks/s, output: 23.93 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [00:47<00:42, 21.55it/s, est. speed input: 24461.76 toks/s, output: 23.89 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [00:48<00:41, 21.55it/s, est. speed input: 24424.78 toks/s, output: 23.85 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [00:49<00:40, 21.54it/s, est. speed input: 24388.63 toks/s, output: 23.82 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [00:49<00:39, 21.55it/s, est. speed input: 24354.48 toks/s, output: 23.78 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [00:50<00:39, 21.55it/s, est. speed input: 24321.01 toks/s, output: 23.75 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [00:51<00:38, 21.54it/s, est. speed input: 24287.72 toks/s, output: 23.72 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [00:52<00:37, 21.53it/s, est. speed input: 24255.41 toks/s, output: 23.69 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [00:52<00:37, 21.53it/s, est. speed input: 24224.16 toks/s, output: 23.66 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [00:53<00:36, 21.52it/s, est. speed input: 24193.68 toks/s, output: 23.63 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [00:54<00:35, 21.53it/s, est. speed input: 24164.63 toks/s, output: 23.60 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [00:55<00:34, 21.52it/s, est. speed input: 24135.60 toks/s, output: 23.57 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [00:55<00:34, 21.51it/s, est. speed input: 24107.18 toks/s, output: 23.54 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [00:56<00:33, 21.51it/s, est. speed input: 24079.66 toks/s, output: 23.52 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [00:57<00:32, 21.50it/s, est. speed input: 24052.44 toks/s, output: 23.49 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [00:58<00:31, 21.50it/s, est. speed input: 24026.51 toks/s, output: 23.46 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [00:58<00:31, 21.50it/s, est. speed input: 24001.14 toks/s, output: 23.44 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [00:59<00:30, 21.49it/s, est. speed input: 23975.86 toks/s, output: 23.41 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [01:00<00:29, 21.47it/s, est. speed input: 23950.47 toks/s, output: 23.39 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [01:01<00:28, 21.49it/s, est. speed input: 23927.50 toks/s, output: 23.37 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [01:01<00:28, 21.49it/s, est. speed input: 23904.18 toks/s, output: 23.34 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [01:02<00:27, 21.48it/s, est. speed input: 23881.14 toks/s, output: 23.32 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [01:03<00:26, 21.45it/s, est. speed input: 23857.88 toks/s, output: 23.30 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [01:04<00:25, 21.48it/s, est. speed input: 23837.09 toks/s, output: 23.28 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [01:04<00:25, 21.47it/s, est. speed input: 23815.55 toks/s, output: 23.26 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [01:05<00:24, 21.46it/s, est. speed input: 23794.06 toks/s, output: 23.24 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [01:06<00:23, 21.44it/s, est. speed input: 23772.68 toks/s, output: 23.22 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [01:06<00:22, 21.80it/s, est. speed input: 23766.98 toks/s, output: 23.21 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [01:07<00:22, 21.68it/s, est. speed input: 23746.69 toks/s, output: 23.19 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [01:08<00:21, 21.60it/s, est. speed input: 23726.98 toks/s, output: 23.17 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [01:09<00:20, 21.55it/s, est. speed input: 23707.82 toks/s, output: 23.15 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [01:09<00:19, 21.87it/s, est. speed input: 23702.48 toks/s, output: 23.15 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [01:10<00:19, 21.74it/s, est. speed input: 23684.24 toks/s, output: 23.13 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [01:11<00:18, 21.64it/s, est. speed input: 23665.63 toks/s, output: 23.11 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [01:12<00:17, 21.57it/s, est. speed input: 23647.72 toks/s, output: 23.09 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [01:12<00:16, 21.55it/s, est. speed input: 23630.99 toks/s, output: 23.08 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [01:13<00:16, 21.51it/s, est. speed input: 23613.78 toks/s, output: 23.06 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [01:14<00:15, 21.47it/s, est. speed input: 23596.35 toks/s, output: 23.04 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [01:15<00:14, 21.46it/s, est. speed input: 23579.98 toks/s, output: 23.03 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [01:15<00:14, 21.45it/s, est. speed input: 23563.73 toks/s, output: 23.01 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [01:16<00:13, 21.43it/s, est. speed input: 23547.54 toks/s, output: 23.00 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [01:17<00:12, 21.44it/s, est. speed input: 23532.30 toks/s, output: 22.98 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [01:18<00:11, 21.43it/s, est. speed input: 23516.81 toks/s, output: 22.97 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [01:18<00:11, 21.41it/s, est. speed input: 23501.30 toks/s, output: 22.95 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [01:19<00:10, 21.42it/s, est. speed input: 23486.86 toks/s, output: 22.94 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [01:20<00:09, 21.40it/s, est. speed input: 23471.71 toks/s, output: 22.92 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [01:21<00:08, 21.39it/s, est. speed input: 23457.17 toks/s, output: 22.91 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [01:21<00:08, 21.39it/s, est. speed input: 23442.99 toks/s, output: 22.89 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [01:22<00:07, 21.39it/s, est. speed input: 23428.87 toks/s, output: 22.88 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [01:23<00:06, 21.40it/s, est. speed input: 23415.55 toks/s, output: 22.87 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [01:24<00:05, 21.39it/s, est. speed input: 23401.95 toks/s, output: 22.85 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [01:24<00:05, 21.38it/s, est. speed input: 23388.51 toks/s, output: 22.84 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [01:25<00:04, 21.39it/s, est. speed input: 23375.52 toks/s, output: 22.83 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [01:26<00:03, 21.39it/s, est. speed input: 23362.87 toks/s, output: 22.82 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [01:27<00:02, 21.39it/s, est. speed input: 23350.30 toks/s, output: 22.80 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [01:27<00:02, 21.38it/s, est. speed input: 23337.63 toks/s, output: 22.79 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [01:28<00:01, 21.38it/s, est. speed input: 23325.37 toks/s, output: 22.78 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [01:29<00:00, 21.75it/s, est. speed input: 23324.66 toks/s, output: 22.78 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [01:29<00:00, 21.75it/s, est. speed input: 23485.03 toks/s, output: 22.93 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [01:29<00:00, 22.93it/s, est. speed input: 23485.03 toks/s, output: 22.93 toks/s]
[rank0]:[W126 13:41:52.456028488 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=32768 ==========
Time: 2026-01-26 13:41:55
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=4096, max_num_seqs=32
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 4096 --max-num-seqs 32 --max-model-len 1025 --max-num-batched-tokens 32768 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-14B-INT8_M32768.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 13:42:23 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1435097) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1435097) WARNING 01-26 13:42:45 [backends.py:609] Failed to read file <frozen os>
Throughput: 21.62 requests/s, 22157.68 total tokens/s, 21.62 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096

STDERR:
[2026-01-26 13:42:23] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 13:42:23] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 13:42:23] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 13:42:23] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:42:23] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:42:23] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:42:23] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:42:23] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:42:23] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 13:42:23] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 13:42:23] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 13:42:23] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 13:42:23] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 13:42:23] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 13:42:30] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 13:42:30] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 13:42:30] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 13:42:30] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:42:30] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:42:30] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:42:30] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:42:30] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:42:30] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 13:42:30] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 13:42:30] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 13:42:30] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 13:42:30] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 13:42:30] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1435097) [2026-01-26 13:42:32] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1435097) [2026-01-26 13:42:32] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1435097) [2026-01-26 13:42:32] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1435097) [2026-01-26 13:42:32] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1435097) [2026-01-26 13:42:32] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=1435097) [2026-01-26 13:42:32] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1435097) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1435097) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.27it/s]
(EngineCore_DP0 pid=1435097) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.18it/s]
(EngineCore_DP0 pid=1435097) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.61it/s]
(EngineCore_DP0 pid=1435097) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.45it/s]
(EngineCore_DP0 pid=1435097) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.42it/s]
(EngineCore_DP0 pid=1435097) 
(EngineCore_DP0 pid=1435097) [2026-01-26 13:42:35] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 7680] -> 1D uint8
(EngineCore_DP0 pid=1435097) [2026-01-26 13:42:35] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 34406400 bytes
(EngineCore_DP0 pid=1435097) [2026-01-26 13:42:35] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 7680] -> 1D uint8
(EngineCore_DP0 pid=1435097) [2026-01-26 13:42:35] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 24576000 bytes
(EngineCore_DP0 pid=1435097) [2026-01-26 13:42:35] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 7680] -> 1D uint8
(EngineCore_DP0 pid=1435097) [2026-01-26 13:42:35] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 132710400 bytes
(EngineCore_DP0 pid=1435097) [2026-01-26 13:42:35] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 20736] -> 1D uint8
(EngineCore_DP0 pid=1435097) [2026-01-26 13:42:35] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 66355200 bytes
(EngineCore_DP0 pid=1435097) [rank0]:W0126 13:42:54.175000 1435097 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1435097) [rank0]:W0126 13:42:54.229000 1435097 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1435097) [rank0]:W0126 13:42:54.856000 1435097 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1435097) [rank0]:W0126 13:42:54.940000 1435097 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1435097) 2026-01-26 13:42:59,194 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1435097) 2026-01-26 13:42:59,662 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1435097) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   9%|▉         | 1/11 [00:00<00:06,  1.55it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  27%|██▋       | 3/11 [00:00<00:01,  4.31it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  36%|███▋      | 4/11 [00:01<00:01,  4.62it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  45%|████▌     | 5/11 [00:01<00:01,  5.50it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  55%|█████▍    | 6/11 [00:01<00:00,  5.37it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  64%|██████▎   | 7/11 [00:01<00:00,  5.84it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  82%|████████▏ | 9/11 [00:01<00:00,  6.30it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  91%|█████████ | 10/11 [00:02<00:00,  3.87it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:02<00:00,  4.58it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:02<00:00,  4.57it/s]
(EngineCore_DP0 pid=1435097) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  14%|█▍        | 1/7 [00:00<00:01,  4.02it/s]
Capturing CUDA graphs (decode, FULL):  43%|████▎     | 3/7 [00:00<00:00,  7.95it/s]
Capturing CUDA graphs (decode, FULL):  57%|█████▋    | 4/7 [00:00<00:00,  6.79it/s]
Capturing CUDA graphs (decode, FULL):  71%|███████▏  | 5/7 [00:00<00:00,  7.53it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00,  7.57it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00,  7.23it/s]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   1%|          | 25/4096 [00:00<00:16, 249.84it/s]
Adding requests:   2%|▏         | 65/4096 [00:00<00:11, 337.32it/s]
Adding requests:   2%|▏         | 101/4096 [00:00<00:11, 345.95it/s]
Adding requests:   3%|▎         | 139/4096 [00:00<00:11, 358.20it/s]
Adding requests:   4%|▍         | 178/4096 [00:00<00:10, 368.90it/s]
Adding requests:   5%|▌         | 220/4096 [00:00<00:10, 383.74it/s]
Adding requests:   6%|▋         | 259/4096 [00:00<00:10, 379.83it/s]
Adding requests:   7%|▋         | 299/4096 [00:00<00:09, 384.68it/s]
Adding requests:   8%|▊         | 340/4096 [00:00<00:09, 390.14it/s]
Adding requests:   9%|▉         | 380/4096 [00:01<00:09, 392.36it/s]
Adding requests:  10%|█         | 422/4096 [00:01<00:09, 399.22it/s]
Adding requests:  11%|█▏        | 462/4096 [00:01<00:09, 395.23it/s]
Adding requests:  12%|█▏        | 504/4096 [00:01<00:08, 402.45it/s]
Adding requests:  13%|█▎        | 546/4096 [00:01<00:08, 406.88it/s]
Adding requests:  14%|█▍        | 587/4096 [00:01<00:08, 402.19it/s]
Adding requests:  15%|█▌        | 628/4096 [00:01<00:08, 398.15it/s]
Adding requests:  16%|█▋        | 668/4096 [00:01<00:08, 387.38it/s]
Adding requests:  17%|█▋        | 709/4096 [00:01<00:08, 391.65it/s]
Adding requests:  18%|█▊        | 749/4096 [00:01<00:08, 383.99it/s]
Adding requests:  19%|█▉        | 789/4096 [00:02<00:08, 386.80it/s]
Adding requests:  20%|██        | 829/4096 [00:02<00:08, 389.34it/s]
Adding requests:  21%|██        | 869/4096 [00:02<00:08, 391.74it/s]
Adding requests:  22%|██▏       | 909/4096 [00:02<00:08, 392.94it/s]
Adding requests:  23%|██▎       | 949/4096 [00:02<00:08, 384.49it/s]
Adding requests:  24%|██▍       | 989/4096 [00:02<00:08, 386.63it/s]
Adding requests:  25%|██▌       | 1028/4096 [00:02<00:08, 383.15it/s]
Adding requests:  26%|██▌       | 1067/4096 [00:02<00:07, 380.82it/s]
Adding requests:  27%|██▋       | 1106/4096 [00:02<00:07, 378.04it/s]
Adding requests:  28%|██▊       | 1146/4096 [00:02<00:07, 384.12it/s]
Adding requests:  29%|██▉       | 1185/4096 [00:03<00:07, 382.45it/s]
Adding requests:  30%|██▉       | 1224/4096 [00:03<00:07, 378.97it/s]
Adding requests:  31%|███       | 1262/4096 [00:03<00:07, 378.03it/s]
Adding requests:  32%|███▏      | 1300/4096 [00:03<00:07, 377.34it/s]
Adding requests:  33%|███▎      | 1339/4096 [00:03<00:07, 380.42it/s]
Adding requests:  34%|███▎      | 1379/4096 [00:03<00:07, 385.65it/s]
Adding requests:  35%|███▍      | 1418/4096 [00:03<00:07, 381.12it/s]
Adding requests:  36%|███▌      | 1458/4096 [00:03<00:06, 386.26it/s]
Adding requests:  37%|███▋      | 1499/4096 [00:03<00:06, 389.78it/s]
Adding requests:  38%|███▊      | 1539/4096 [00:04<00:06, 390.70it/s]
Adding requests:  39%|███▊      | 1579/4096 [00:04<00:06, 382.57it/s]
Adding requests:  40%|███▉      | 1618/4096 [00:04<00:06, 378.35it/s]
Adding requests:  40%|████      | 1656/4096 [00:04<00:06, 372.82it/s]
Adding requests:  41%|████▏     | 1694/4096 [00:04<00:06, 373.15it/s]
Adding requests:  42%|████▏     | 1734/4096 [00:04<00:06, 378.58it/s]
Adding requests:  43%|████▎     | 1775/4096 [00:04<00:05, 387.51it/s]
Adding requests:  44%|████▍     | 1814/4096 [00:04<00:05, 382.17it/s]
Adding requests:  45%|████▌     | 1853/4096 [00:04<00:05, 383.52it/s]
Adding requests:  46%|████▌     | 1893/4096 [00:04<00:05, 386.29it/s]
Adding requests:  47%|████▋     | 1934/4096 [00:05<00:05, 390.80it/s]
Adding requests:  48%|████▊     | 1974/4096 [00:05<00:05, 391.72it/s]
Adding requests:  49%|████▉     | 2014/4096 [00:05<00:05, 387.65it/s]
Adding requests:  50%|█████     | 2053/4096 [00:05<00:05, 380.76it/s]
Adding requests:  51%|█████     | 2092/4096 [00:05<00:05, 373.72it/s]
Adding requests:  52%|█████▏    | 2132/4096 [00:05<00:05, 378.84it/s]
Adding requests:  53%|█████▎    | 2170/4096 [00:05<00:05, 375.16it/s]
Adding requests:  54%|█████▍    | 2208/4096 [00:05<00:05, 371.14it/s]
Adding requests:  55%|█████▍    | 2247/4096 [00:05<00:04, 375.65it/s]
Adding requests:  56%|█████▌    | 2288/4096 [00:05<00:04, 384.73it/s]
Adding requests:  57%|█████▋    | 2328/4096 [00:06<00:04, 387.40it/s]
Adding requests:  58%|█████▊    | 2368/4096 [00:06<00:04, 389.52it/s]
Adding requests:  59%|█████▉    | 2410/4096 [00:06<00:04, 396.15it/s]
Adding requests:  60%|█████▉    | 2450/4096 [00:06<00:04, 383.13it/s]
Adding requests:  61%|██████    | 2490/4096 [00:06<00:04, 385.54it/s]
Adding requests:  62%|██████▏   | 2531/4096 [00:06<00:03, 392.32it/s]
Adding requests:  63%|██████▎   | 2574/4096 [00:06<00:03, 400.73it/s]
Adding requests:  64%|██████▍   | 2615/4096 [00:06<00:03, 398.59it/s]
Adding requests:  65%|██████▍   | 2655/4096 [00:06<00:03, 390.97it/s]
Adding requests:  66%|██████▌   | 2695/4096 [00:07<00:03, 385.97it/s]
Adding requests:  67%|██████▋   | 2734/4096 [00:07<00:03, 384.68it/s]
Adding requests:  68%|██████▊   | 2775/4096 [00:07<00:03, 392.05it/s]
Adding requests:  69%|██████▉   | 2817/4096 [00:07<00:03, 399.35it/s]
Adding requests:  70%|██████▉   | 2857/4096 [00:07<00:03, 396.12it/s]
Adding requests:  71%|███████   | 2897/4096 [00:07<00:03, 393.99it/s]
Adding requests:  72%|███████▏  | 2938/4096 [00:07<00:02, 398.22it/s]
Adding requests:  73%|███████▎  | 2978/4096 [00:07<00:02, 395.76it/s]
Adding requests:  74%|███████▎  | 3019/4096 [00:07<00:02, 398.19it/s]
Adding requests:  75%|███████▍  | 3060/4096 [00:07<00:02, 399.26it/s]
Adding requests:  76%|███████▌  | 3101/4096 [00:08<00:02, 402.35it/s]
Adding requests:  77%|███████▋  | 3142/4096 [00:08<00:02, 401.67it/s]
Adding requests:  78%|███████▊  | 3183/4096 [00:08<00:02, 395.14it/s]
Adding requests:  79%|███████▊  | 3223/4096 [00:08<00:02, 393.71it/s]
Adding requests:  80%|███████▉  | 3263/4096 [00:08<00:02, 392.57it/s]
Adding requests:  81%|████████  | 3303/4096 [00:08<00:02, 381.61it/s]
Adding requests:  82%|████████▏ | 3342/4096 [00:08<00:01, 383.44it/s]
Adding requests:  83%|████████▎ | 3382/4096 [00:08<00:01, 386.45it/s]
Adding requests:  84%|████████▎ | 3422/4096 [00:08<00:01, 389.44it/s]
Adding requests:  85%|████████▍ | 3462/4096 [00:08<00:01, 390.79it/s]
Adding requests:  85%|████████▌ | 3502/4096 [00:09<00:01, 388.88it/s]
Adding requests:  87%|████████▋ | 3545/4096 [00:09<00:01, 400.25it/s]
Adding requests:  88%|████████▊ | 3586/4096 [00:09<00:01, 396.25it/s]
Adding requests:  89%|████████▊ | 3627/4096 [00:09<00:01, 397.97it/s]
Adding requests:  90%|████████▉ | 3667/4096 [00:09<00:01, 393.26it/s]
Adding requests:  91%|█████████ | 3707/4096 [00:09<00:00, 389.74it/s]
Adding requests:  91%|█████████▏| 3746/4096 [00:09<00:00, 388.27it/s]
Adding requests:  92%|█████████▏| 3785/4096 [00:09<00:00, 377.81it/s]
Adding requests:  93%|█████████▎| 3823/4096 [00:09<00:00, 358.86it/s]
Adding requests:  94%|█████████▍| 3862/4096 [00:10<00:00, 366.45it/s]
Adding requests:  95%|█████████▌| 3900/4096 [00:10<00:00, 369.23it/s]
Adding requests:  96%|█████████▌| 3938/4096 [00:10<00:00, 367.82it/s]
Adding requests:  97%|█████████▋| 3976/4096 [00:10<00:00, 370.45it/s]
Adding requests:  98%|█████████▊| 4015/4096 [00:10<00:00, 375.15it/s]
Adding requests:  99%|█████████▉| 4053/4096 [00:10<00:00, 371.04it/s]
Adding requests: 100%|█████████▉| 4091/4096 [00:10<00:00, 372.11it/s]
Adding requests: 100%|██████████| 4096/4096 [00:10<00:00, 385.04it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▌         | 226/4096 [00:01<00:21, 182.83it/s, est. speed input: 187218.40 toks/s, output: 182.83 toks/s]
Processed prompts:   6%|▋         | 258/4096 [00:02<00:46, 82.03it/s, est. speed input: 98227.48 toks/s, output: 95.92 toks/s]   
Processed prompts:   7%|▋         | 290/4096 [00:04<01:10, 53.63it/s, est. speed input: 71634.74 toks/s, output: 69.96 toks/s]
Processed prompts:   8%|▊         | 322/4096 [00:05<01:32, 40.88it/s, est. speed input: 58875.27 toks/s, output: 57.50 toks/s]
Processed prompts:   9%|▊         | 354/4096 [00:07<01:50, 33.96it/s, est. speed input: 51360.75 toks/s, output: 50.16 toks/s]
Processed prompts:   9%|▉         | 386/4096 [00:08<02:04, 29.85it/s, est. speed input: 46423.09 toks/s, output: 45.33 toks/s]
Processed prompts:  10%|█         | 418/4096 [00:09<02:14, 27.26it/s, est. speed input: 42930.31 toks/s, output: 41.92 toks/s]
Processed prompts:  11%|█         | 450/4096 [00:11<02:22, 25.55it/s, est. speed input: 40312.99 toks/s, output: 39.37 toks/s]
Processed prompts:  12%|█▏        | 482/4096 [00:12<02:28, 24.42it/s, est. speed input: 38293.65 toks/s, output: 37.40 toks/s]
Processed prompts:  13%|█▎        | 514/4096 [00:14<02:31, 23.63it/s, est. speed input: 36673.65 toks/s, output: 35.81 toks/s]
Processed prompts:  13%|█▎        | 546/4096 [00:15<02:33, 23.11it/s, est. speed input: 35363.12 toks/s, output: 34.53 toks/s]
Processed prompts:  14%|█▍        | 578/4096 [00:17<02:34, 22.73it/s, est. speed input: 34261.57 toks/s, output: 33.46 toks/s]
Processed prompts:  15%|█▍        | 610/4096 [00:18<02:35, 22.46it/s, est. speed input: 33331.42 toks/s, output: 32.55 toks/s]
Processed prompts:  16%|█▌        | 642/4096 [00:20<02:35, 22.26it/s, est. speed input: 32531.33 toks/s, output: 31.77 toks/s]
Processed prompts:  16%|█▋        | 674/4096 [00:21<02:34, 22.14it/s, est. speed input: 31846.94 toks/s, output: 31.10 toks/s]
Processed prompts:  17%|█▋        | 706/4096 [00:23<02:33, 22.04it/s, est. speed input: 31243.33 toks/s, output: 30.51 toks/s]
Processed prompts:  18%|█▊        | 738/4096 [00:24<02:32, 21.96it/s, est. speed input: 30709.45 toks/s, output: 29.99 toks/s]
Processed prompts:  19%|█▉        | 770/4096 [00:26<02:30, 22.07it/s, est. speed input: 30277.37 toks/s, output: 29.57 toks/s]
Processed prompts:  20%|█▉        | 802/4096 [00:27<02:29, 21.99it/s, est. speed input: 29853.26 toks/s, output: 29.15 toks/s]
Processed prompts:  20%|██        | 834/4096 [00:28<02:28, 21.93it/s, est. speed input: 29470.43 toks/s, output: 28.78 toks/s]
Processed prompts:  21%|██        | 866/4096 [00:30<02:27, 21.88it/s, est. speed input: 29123.98 toks/s, output: 28.44 toks/s]
Processed prompts:  22%|██▏       | 898/4096 [00:31<02:26, 21.84it/s, est. speed input: 28808.15 toks/s, output: 28.13 toks/s]
Processed prompts:  23%|██▎       | 930/4096 [00:33<02:25, 21.81it/s, est. speed input: 28519.63 toks/s, output: 27.85 toks/s]
Processed prompts:  23%|██▎       | 962/4096 [00:34<02:23, 21.79it/s, est. speed input: 28255.35 toks/s, output: 27.59 toks/s]
Processed prompts:  24%|██▍       | 994/4096 [00:36<02:22, 21.78it/s, est. speed input: 28013.46 toks/s, output: 27.36 toks/s]
Processed prompts:  25%|██▌       | 1026/4096 [00:37<02:21, 21.76it/s, est. speed input: 27787.67 toks/s, output: 27.14 toks/s]
Processed prompts:  26%|██▌       | 1058/4096 [00:39<02:19, 21.75it/s, est. speed input: 27579.89 toks/s, output: 26.93 toks/s]
Processed prompts:  27%|██▋       | 1090/4096 [00:40<02:18, 21.73it/s, est. speed input: 27385.70 toks/s, output: 26.74 toks/s]
Processed prompts:  27%|██▋       | 1122/4096 [00:42<02:16, 21.72it/s, est. speed input: 27204.91 toks/s, output: 26.57 toks/s]
Processed prompts:  28%|██▊       | 1154/4096 [00:43<02:15, 21.72it/s, est. speed input: 27037.15 toks/s, output: 26.40 toks/s]
Processed prompts:  29%|██▉       | 1186/4096 [00:45<02:14, 21.70it/s, est. speed input: 26879.10 toks/s, output: 26.25 toks/s]
Processed prompts:  30%|██▉       | 1218/4096 [00:46<02:12, 21.69it/s, est. speed input: 26729.52 toks/s, output: 26.10 toks/s]
Processed prompts:  31%|███       | 1250/4096 [00:48<02:11, 21.68it/s, est. speed input: 26589.70 toks/s, output: 25.97 toks/s]
Processed prompts:  31%|███▏      | 1282/4096 [00:49<02:09, 21.68it/s, est. speed input: 26459.47 toks/s, output: 25.84 toks/s]
Processed prompts:  32%|███▏      | 1314/4096 [00:51<02:08, 21.66it/s, est. speed input: 26334.59 toks/s, output: 25.72 toks/s]
Processed prompts:  33%|███▎      | 1346/4096 [00:52<02:06, 21.66it/s, est. speed input: 26217.65 toks/s, output: 25.60 toks/s]
Processed prompts:  34%|███▎      | 1378/4096 [00:54<02:05, 21.65it/s, est. speed input: 26106.44 toks/s, output: 25.49 toks/s]
Processed prompts:  34%|███▍      | 1410/4096 [00:55<02:04, 21.64it/s, est. speed input: 26000.01 toks/s, output: 25.39 toks/s]
Processed prompts:  35%|███▌      | 1442/4096 [00:57<02:02, 21.64it/s, est. speed input: 25900.49 toks/s, output: 25.29 toks/s]
Processed prompts:  36%|███▌      | 1474/4096 [00:58<02:01, 21.63it/s, est. speed input: 25804.67 toks/s, output: 25.20 toks/s]
Processed prompts:  37%|███▋      | 1506/4096 [00:59<01:59, 21.62it/s, est. speed input: 25714.17 toks/s, output: 25.11 toks/s]
Processed prompts:  38%|███▊      | 1538/4096 [01:01<01:57, 21.78it/s, est. speed input: 25642.50 toks/s, output: 25.04 toks/s]
Processed prompts:  38%|███▊      | 1570/4096 [01:02<01:56, 21.72it/s, est. speed input: 25559.31 toks/s, output: 24.96 toks/s]
Processed prompts:  39%|███▉      | 1602/4096 [01:04<01:54, 21.83it/s, est. speed input: 25493.38 toks/s, output: 24.90 toks/s]
Processed prompts:  40%|███▉      | 1634/4096 [01:05<01:53, 21.76it/s, est. speed input: 25416.81 toks/s, output: 24.82 toks/s]
Processed prompts:  41%|████      | 1666/4096 [01:07<01:51, 21.70it/s, est. speed input: 25343.69 toks/s, output: 24.75 toks/s]
Processed prompts:  41%|████▏     | 1698/4096 [01:08<01:50, 21.67it/s, est. speed input: 25273.80 toks/s, output: 24.68 toks/s]
Processed prompts:  42%|████▏     | 1730/4096 [01:10<01:49, 21.63it/s, est. speed input: 25206.32 toks/s, output: 24.62 toks/s]
Processed prompts:  43%|████▎     | 1762/4096 [01:11<01:47, 21.62it/s, est. speed input: 25141.86 toks/s, output: 24.55 toks/s]
Processed prompts:  44%|████▍     | 1794/4096 [01:13<01:46, 21.60it/s, est. speed input: 25079.52 toks/s, output: 24.49 toks/s]
Processed prompts:  45%|████▍     | 1826/4096 [01:14<01:45, 21.59it/s, est. speed input: 25020.52 toks/s, output: 24.43 toks/s]
Processed prompts:  45%|████▌     | 1858/4096 [01:16<01:43, 21.58it/s, est. speed input: 24962.87 toks/s, output: 24.38 toks/s]
Processed prompts:  46%|████▌     | 1890/4096 [01:17<01:42, 21.57it/s, est. speed input: 24907.80 toks/s, output: 24.32 toks/s]
Processed prompts:  47%|████▋     | 1922/4096 [01:19<01:40, 21.56it/s, est. speed input: 24853.85 toks/s, output: 24.27 toks/s]
Processed prompts:  48%|████▊     | 1954/4096 [01:20<01:39, 21.56it/s, est. speed input: 24803.15 toks/s, output: 24.22 toks/s]
Processed prompts:  48%|████▊     | 1986/4096 [01:22<01:37, 21.55it/s, est. speed input: 24753.05 toks/s, output: 24.17 toks/s]
Processed prompts:  49%|████▉     | 2018/4096 [01:23<01:36, 21.54it/s, est. speed input: 24704.57 toks/s, output: 24.13 toks/s]
Processed prompts:  50%|█████     | 2050/4096 [01:25<01:34, 21.55it/s, est. speed input: 24658.83 toks/s, output: 24.08 toks/s]
Processed prompts:  51%|█████     | 2082/4096 [01:26<01:33, 21.54it/s, est. speed input: 24613.65 toks/s, output: 24.04 toks/s]
Processed prompts:  52%|█████▏    | 2114/4096 [01:28<01:32, 21.53it/s, est. speed input: 24569.90 toks/s, output: 23.99 toks/s]
Processed prompts:  52%|█████▏    | 2146/4096 [01:29<01:30, 21.53it/s, est. speed input: 24528.11 toks/s, output: 23.95 toks/s]
Processed prompts:  53%|█████▎    | 2178/4096 [01:31<01:28, 21.70it/s, est. speed input: 24498.17 toks/s, output: 23.92 toks/s]
Processed prompts:  54%|█████▍    | 2210/4096 [01:32<01:27, 21.63it/s, est. speed input: 24457.49 toks/s, output: 23.88 toks/s]
Processed prompts:  55%|█████▍    | 2242/4096 [01:34<01:25, 21.58it/s, est. speed input: 24418.45 toks/s, output: 23.85 toks/s]
Processed prompts:  56%|█████▌    | 2274/4096 [01:35<01:24, 21.54it/s, est. speed input: 24380.19 toks/s, output: 23.81 toks/s]
Processed prompts:  56%|█████▋    | 2306/4096 [01:37<01:23, 21.53it/s, est. speed input: 24343.69 toks/s, output: 23.77 toks/s]
Processed prompts:  57%|█████▋    | 2338/4096 [01:38<01:21, 21.51it/s, est. speed input: 24307.99 toks/s, output: 23.74 toks/s]
Processed prompts:  58%|█████▊    | 2370/4096 [01:39<01:20, 21.50it/s, est. speed input: 24273.53 toks/s, output: 23.70 toks/s]
Processed prompts:  59%|█████▊    | 2402/4096 [01:41<01:18, 21.49it/s, est. speed input: 24239.91 toks/s, output: 23.67 toks/s]
Processed prompts:  59%|█████▉    | 2434/4096 [01:42<01:17, 21.49it/s, est. speed input: 24207.47 toks/s, output: 23.64 toks/s]
Processed prompts:  60%|██████    | 2466/4096 [01:44<01:15, 21.48it/s, est. speed input: 24175.78 toks/s, output: 23.61 toks/s]
Processed prompts:  61%|██████    | 2498/4096 [01:45<01:14, 21.48it/s, est. speed input: 24144.95 toks/s, output: 23.58 toks/s]
Processed prompts:  62%|██████▏   | 2530/4096 [01:47<01:12, 21.48it/s, est. speed input: 24115.18 toks/s, output: 23.55 toks/s]
Processed prompts:  63%|██████▎   | 2562/4096 [01:48<01:11, 21.48it/s, est. speed input: 24086.21 toks/s, output: 23.52 toks/s]
Processed prompts:  63%|██████▎   | 2594/4096 [01:50<01:09, 21.47it/s, est. speed input: 24057.73 toks/s, output: 23.49 toks/s]
Processed prompts:  64%|██████▍   | 2626/4096 [01:51<01:08, 21.47it/s, est. speed input: 24030.19 toks/s, output: 23.47 toks/s]
Processed prompts:  65%|██████▍   | 2658/4096 [01:53<01:06, 21.48it/s, est. speed input: 24003.57 toks/s, output: 23.44 toks/s]
Processed prompts:  66%|██████▌   | 2690/4096 [01:54<01:05, 21.47it/s, est. speed input: 23977.23 toks/s, output: 23.42 toks/s]
Processed prompts:  66%|██████▋   | 2722/4096 [01:56<01:03, 21.47it/s, est. speed input: 23951.65 toks/s, output: 23.39 toks/s]
Processed prompts:  67%|██████▋   | 2754/4096 [01:57<01:02, 21.47it/s, est. speed input: 23926.91 toks/s, output: 23.37 toks/s]
Processed prompts:  68%|██████▊   | 2786/4096 [01:59<01:01, 21.47it/s, est. speed input: 23902.69 toks/s, output: 23.34 toks/s]
Processed prompts:  69%|██████▉   | 2818/4096 [02:00<00:59, 21.47it/s, est. speed input: 23878.81 toks/s, output: 23.32 toks/s]
Processed prompts:  70%|██████▉   | 2850/4096 [02:02<00:58, 21.46it/s, est. speed input: 23855.58 toks/s, output: 23.30 toks/s]
Processed prompts:  70%|███████   | 2882/4096 [02:03<00:56, 21.63it/s, est. speed input: 23840.14 toks/s, output: 23.28 toks/s]
Processed prompts:  71%|███████   | 2914/4096 [02:05<00:54, 21.58it/s, est. speed input: 23817.92 toks/s, output: 23.26 toks/s]
Processed prompts:  72%|███████▏  | 2946/4096 [02:06<00:53, 21.53it/s, est. speed input: 23795.94 toks/s, output: 23.24 toks/s]
Processed prompts:  73%|███████▎  | 2978/4096 [02:08<00:51, 21.51it/s, est. speed input: 23774.82 toks/s, output: 23.22 toks/s]
Processed prompts:  73%|███████▎  | 3010/4096 [02:09<00:50, 21.50it/s, est. speed input: 23754.23 toks/s, output: 23.20 toks/s]
Processed prompts:  74%|███████▍  | 3042/4096 [02:11<00:49, 21.48it/s, est. speed input: 23733.66 toks/s, output: 23.18 toks/s]
Processed prompts:  75%|███████▌  | 3074/4096 [02:12<00:47, 21.47it/s, est. speed input: 23713.92 toks/s, output: 23.16 toks/s]
Processed prompts:  76%|███████▌  | 3106/4096 [02:14<00:46, 21.46it/s, est. speed input: 23694.07 toks/s, output: 23.14 toks/s]
Processed prompts:  77%|███████▋  | 3138/4096 [02:15<00:44, 21.47it/s, est. speed input: 23675.67 toks/s, output: 23.12 toks/s]
Processed prompts:  77%|███████▋  | 3170/4096 [02:17<00:43, 21.46it/s, est. speed input: 23656.88 toks/s, output: 23.10 toks/s]
Processed prompts:  78%|███████▊  | 3202/4096 [02:18<00:41, 21.47it/s, est. speed input: 23639.30 toks/s, output: 23.09 toks/s]
Processed prompts:  79%|███████▉  | 3234/4096 [02:20<00:40, 21.46it/s, est. speed input: 23621.38 toks/s, output: 23.07 toks/s]
Processed prompts:  80%|███████▉  | 3266/4096 [02:21<00:38, 21.46it/s, est. speed input: 23603.85 toks/s, output: 23.05 toks/s]
Processed prompts:  81%|████████  | 3298/4096 [02:23<00:37, 21.45it/s, est. speed input: 23586.71 toks/s, output: 23.03 toks/s]
Processed prompts:  81%|████████▏ | 3330/4096 [02:24<00:35, 21.45it/s, est. speed input: 23569.86 toks/s, output: 23.02 toks/s]
Processed prompts:  82%|████████▏ | 3362/4096 [02:26<00:34, 21.46it/s, est. speed input: 23553.80 toks/s, output: 23.00 toks/s]
Processed prompts:  83%|████████▎ | 3394/4096 [02:27<00:32, 21.46it/s, est. speed input: 23537.73 toks/s, output: 22.99 toks/s]
Processed prompts:  84%|████████▎ | 3426/4096 [02:29<00:31, 21.46it/s, est. speed input: 23522.33 toks/s, output: 22.97 toks/s]
Processed prompts:  84%|████████▍ | 3458/4096 [02:30<00:29, 21.47it/s, est. speed input: 23507.21 toks/s, output: 22.96 toks/s]
Processed prompts:  85%|████████▌ | 3490/4096 [02:32<00:28, 21.47it/s, est. speed input: 23492.42 toks/s, output: 22.94 toks/s]
Processed prompts:  86%|████████▌ | 3522/4096 [02:33<00:26, 21.48it/s, est. speed input: 23478.15 toks/s, output: 22.93 toks/s]
Processed prompts:  87%|████████▋ | 3554/4096 [02:35<00:25, 21.48it/s, est. speed input: 23463.84 toks/s, output: 22.91 toks/s]
Processed prompts:  88%|████████▊ | 3586/4096 [02:36<00:23, 21.48it/s, est. speed input: 23449.92 toks/s, output: 22.90 toks/s]
Processed prompts:  88%|████████▊ | 3618/4096 [02:38<00:22, 21.47it/s, est. speed input: 23435.75 toks/s, output: 22.89 toks/s]
Processed prompts:  89%|████████▉ | 3650/4096 [02:39<00:20, 21.46it/s, est. speed input: 23422.00 toks/s, output: 22.87 toks/s]
Processed prompts:  90%|████████▉ | 3682/4096 [02:41<00:19, 21.62it/s, est. speed input: 23414.04 toks/s, output: 22.87 toks/s]
Processed prompts:  91%|█████████ | 3714/4096 [02:42<00:17, 21.57it/s, est. speed input: 23400.71 toks/s, output: 22.85 toks/s]
Processed prompts:  91%|█████████▏| 3746/4096 [02:44<00:16, 21.53it/s, est. speed input: 23387.55 toks/s, output: 22.84 toks/s]
Processed prompts:  92%|█████████▏| 3778/4096 [02:45<00:14, 21.51it/s, est. speed input: 23374.93 toks/s, output: 22.83 toks/s]
Processed prompts:  93%|█████████▎| 3810/4096 [02:46<00:13, 21.50it/s, est. speed input: 23362.53 toks/s, output: 22.81 toks/s]
Processed prompts:  94%|█████████▍| 3842/4096 [02:48<00:11, 21.48it/s, est. speed input: 23349.92 toks/s, output: 22.80 toks/s]
Processed prompts:  95%|█████████▍| 3874/4096 [02:49<00:10, 21.48it/s, est. speed input: 23337.97 toks/s, output: 22.79 toks/s]
Processed prompts:  95%|█████████▌| 3906/4096 [02:51<00:08, 21.64it/s, est. speed input: 23331.50 toks/s, output: 22.78 toks/s]
Processed prompts:  96%|█████████▌| 3938/4096 [02:52<00:07, 21.59it/s, est. speed input: 23319.79 toks/s, output: 22.77 toks/s]
Processed prompts:  97%|█████████▋| 3970/4096 [02:54<00:05, 21.55it/s, est. speed input: 23308.39 toks/s, output: 22.76 toks/s]
Processed prompts:  98%|█████████▊| 4002/4096 [02:55<00:04, 21.53it/s, est. speed input: 23297.15 toks/s, output: 22.75 toks/s]
Processed prompts:  98%|█████████▊| 4034/4096 [02:57<00:02, 21.51it/s, est. speed input: 23286.02 toks/s, output: 22.74 toks/s]
Processed prompts:  99%|█████████▉| 4066/4096 [02:58<00:01, 21.71it/s, est. speed input: 23281.61 toks/s, output: 22.74 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [02:58<00:00, 21.71it/s, est. speed input: 23453.26 toks/s, output: 22.90 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [02:58<00:00, 22.90it/s, est. speed input: 23453.26 toks/s, output: 22.90 toks/s]
[rank0]:[W126 13:46:14.806734177 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=65536 ==========
Time: 2026-01-26 13:46:16
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=8192, max_num_seqs=64
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 8192 --max-num-seqs 64 --max-model-len 1025 --max-num-batched-tokens 65536 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-14B-INT8_M65536.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 13:47:07 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1439301) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1439301) WARNING 01-26 13:47:28 [backends.py:609] Failed to read file <frozen os>
Throughput: 21.81 requests/s, 22351.19 total tokens/s, 21.81 output tokens/s
Total num prompt tokens:  8388608
Total num output tokens:  8192

STDERR:
[2026-01-26 13:47:06] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 13:47:07] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 13:47:07] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 13:47:07] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:47:07] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:47:07] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:47:07] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:47:07] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:47:07] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 13:47:07] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 13:47:07] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 13:47:07] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 13:47:07] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 13:47:07] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 13:47:13] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 13:47:14] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 13:47:14] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 13:47:14] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:47:14] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:47:14] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:47:14] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:47:14] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 13:47:14] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 13:47:14] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 13:47:14] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 13:47:14] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 13:47:14] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 13:47:14] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1439301) [2026-01-26 13:47:16] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1439301) [2026-01-26 13:47:16] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1439301) [2026-01-26 13:47:16] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1439301) [2026-01-26 13:47:16] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1439301) [2026-01-26 13:47:16] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=1439301) [2026-01-26 13:47:16] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1439301) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1439301) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.28it/s]
(EngineCore_DP0 pid=1439301) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.18it/s]
(EngineCore_DP0 pid=1439301) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.62it/s]
(EngineCore_DP0 pid=1439301) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.45it/s]
(EngineCore_DP0 pid=1439301) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.42it/s]
(EngineCore_DP0 pid=1439301) 
(EngineCore_DP0 pid=1439301) [2026-01-26 13:47:19] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 7680] -> 1D uint8
(EngineCore_DP0 pid=1439301) [2026-01-26 13:47:19] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 34406400 bytes
(EngineCore_DP0 pid=1439301) [2026-01-26 13:47:19] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 7680] -> 1D uint8
(EngineCore_DP0 pid=1439301) [2026-01-26 13:47:19] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 24576000 bytes
(EngineCore_DP0 pid=1439301) [2026-01-26 13:47:19] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 7680] -> 1D uint8
(EngineCore_DP0 pid=1439301) [2026-01-26 13:47:19] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 132710400 bytes
(EngineCore_DP0 pid=1439301) [2026-01-26 13:47:19] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 20736] -> 1D uint8
(EngineCore_DP0 pid=1439301) [2026-01-26 13:47:19] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 66355200 bytes
(EngineCore_DP0 pid=1439301) [rank0]:W0126 13:47:37.796000 1439301 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=1439301) [rank0]:W0126 13:47:37.850000 1439301 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=1439301) [rank0]:W0126 13:47:38.546000 1439301 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=1439301) [rank0]:W0126 13:47:38.629000 1439301 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=1439301) 2026-01-26 13:47:43,669 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1439301) 2026-01-26 13:47:44,710 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1439301) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/19 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   5%|▌         | 1/19 [00:01<00:20,  1.16s/it]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  11%|█         | 2/19 [00:01<00:11,  1.45it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  16%|█▌        | 3/19 [00:01<00:07,  2.11it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  26%|██▋       | 5/19 [00:02<00:04,  3.42it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  37%|███▋      | 7/19 [00:02<00:02,  4.97it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  42%|████▏     | 8/19 [00:02<00:02,  5.09it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  47%|████▋     | 9/19 [00:02<00:01,  5.56it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  58%|█████▊    | 11/19 [00:02<00:01,  6.10it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  63%|██████▎   | 12/19 [00:03<00:01,  3.64it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  68%|██████▊   | 13/19 [00:03<00:01,  3.95it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  74%|███████▎  | 14/19 [00:03<00:01,  4.58it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  84%|████████▍ | 16/19 [00:04<00:00,  5.39it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  95%|█████████▍| 18/19 [00:04<00:00,  6.78it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 19/19 [00:04<00:00,  7.25it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 19/19 [00:04<00:00,  4.39it/s]
(EngineCore_DP0 pid=1439301) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):   9%|▉         | 1/11 [00:00<00:02,  4.98it/s]
Capturing CUDA graphs (decode, FULL):  18%|█▊        | 2/11 [00:00<00:01,  6.58it/s]
Capturing CUDA graphs (decode, FULL):  27%|██▋       | 3/11 [00:00<00:02,  2.78it/s]
Capturing CUDA graphs (decode, FULL):  36%|███▋      | 4/11 [00:01<00:01,  3.68it/s]
Capturing CUDA graphs (decode, FULL):  55%|█████▍    | 6/11 [00:01<00:00,  5.84it/s]
Capturing CUDA graphs (decode, FULL):  73%|███████▎  | 8/11 [00:01<00:00,  7.55it/s]
Capturing CUDA graphs (decode, FULL):  91%|█████████ | 10/11 [00:01<00:00,  8.84it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 11/11 [00:01<00:00,  6.56it/s]

Adding requests:   0%|          | 0/8192 [00:00<?, ?it/s]
Adding requests:   0%|          | 29/8192 [00:00<00:28, 286.66it/s]
Adding requests:   1%|          | 69/8192 [00:00<00:23, 352.00it/s]
Adding requests:   1%|▏         | 106/8192 [00:00<00:22, 355.95it/s]
Adding requests:   2%|▏         | 143/8192 [00:00<00:22, 359.81it/s]
Adding requests:   2%|▏         | 182/8192 [00:00<00:21, 368.66it/s]
Adding requests:   3%|▎         | 223/8192 [00:00<00:20, 380.56it/s]
Adding requests:   3%|▎         | 262/8192 [00:00<00:21, 376.68it/s]
Adding requests:   4%|▎         | 301/8192 [00:00<00:20, 379.65it/s]
Adding requests:   4%|▍         | 341/8192 [00:00<00:20, 384.35it/s]
Adding requests:   5%|▍         | 380/8192 [00:01<00:20, 384.44it/s]
Adding requests:   5%|▌         | 420/8192 [00:01<00:20, 386.82it/s]
Adding requests:   6%|▌         | 459/8192 [00:01<00:20, 383.83it/s]
Adding requests:   6%|▌         | 501/8192 [00:01<00:19, 394.02it/s]
Adding requests:   7%|▋         | 543/8192 [00:01<00:19, 400.39it/s]
Adding requests:   7%|▋         | 584/8192 [00:01<00:19, 397.50it/s]
Adding requests:   8%|▊         | 624/8192 [00:01<00:19, 385.62it/s]
Adding requests:   8%|▊         | 663/8192 [00:01<00:19, 379.26it/s]
Adding requests:   9%|▊         | 703/8192 [00:01<00:19, 384.10it/s]
Adding requests:   9%|▉         | 742/8192 [00:01<00:19, 380.01it/s]
Adding requests:  10%|▉         | 781/8192 [00:02<00:19, 381.66it/s]
Adding requests:  10%|█         | 820/8192 [00:02<00:19, 381.03it/s]
Adding requests:  11%|█         | 862/8192 [00:02<00:18, 389.33it/s]
Adding requests:  11%|█         | 902/8192 [00:02<00:18, 391.94it/s]
Adding requests:  11%|█▏        | 942/8192 [00:02<00:18, 386.39it/s]
Adding requests:  12%|█▏        | 981/8192 [00:02<00:18, 386.12it/s]
Adding requests:  12%|█▏        | 1020/8192 [00:02<00:18, 381.17it/s]
Adding requests:  13%|█▎        | 1059/8192 [00:02<00:18, 379.60it/s]
Adding requests:  13%|█▎        | 1097/8192 [00:02<00:18, 378.37it/s]
Adding requests:  14%|█▍        | 1138/8192 [00:02<00:18, 386.34it/s]
Adding requests:  14%|█▍        | 1177/8192 [00:03<00:18, 382.00it/s]
Adding requests:  15%|█▍        | 1218/8192 [00:03<00:17, 388.30it/s]
Adding requests:  15%|█▌        | 1257/8192 [00:03<00:18, 385.13it/s]
Adding requests:  16%|█▌        | 1296/8192 [00:03<00:18, 380.11it/s]
Adding requests:  16%|█▋        | 1335/8192 [00:03<00:17, 381.95it/s]
Adding requests:  17%|█▋        | 1376/8192 [00:03<00:17, 387.74it/s]
Adding requests:  17%|█▋        | 1415/8192 [00:03<00:17, 383.24it/s]
Adding requests:  18%|█▊        | 1455/8192 [00:03<00:17, 386.91it/s]
Adding requests:  18%|█▊        | 1496/8192 [00:03<00:17, 391.06it/s]
Adding requests:  19%|█▉        | 1536/8192 [00:04<00:17, 387.60it/s]
Adding requests:  19%|█▉        | 1575/8192 [00:04<00:17, 384.04it/s]
Adding requests:  20%|█▉        | 1614/8192 [00:04<00:17, 380.04it/s]
Adding requests:  20%|██        | 1653/8192 [00:04<00:17, 371.14it/s]
Adding requests:  21%|██        | 1691/8192 [00:04<00:17, 371.53it/s]
Adding requests:  21%|██        | 1730/8192 [00:04<00:17, 376.11it/s]
Adding requests:  22%|██▏       | 1771/8192 [00:04<00:16, 385.02it/s]
Adding requests:  22%|██▏       | 1810/8192 [00:04<00:17, 371.35it/s]
Adding requests:  23%|██▎       | 1849/8192 [00:04<00:16, 374.35it/s]
Adding requests:  23%|██▎       | 1889/8192 [00:04<00:16, 380.66it/s]
Adding requests:  24%|██▎       | 1930/8192 [00:05<00:16, 386.09it/s]
Adding requests:  24%|██▍       | 1969/8192 [00:05<00:16, 386.61it/s]
Adding requests:  25%|██▍       | 2008/8192 [00:05<00:16, 383.74it/s]
Adding requests:  25%|██▍       | 2047/8192 [00:05<00:16, 379.42it/s]
Adding requests:  25%|██▌       | 2085/8192 [00:05<00:16, 370.41it/s]
Adding requests:  26%|██▌       | 2126/8192 [00:05<00:16, 379.02it/s]
Adding requests:  26%|██▋       | 2164/8192 [00:05<00:16, 375.20it/s]
Adding requests:  27%|██▋       | 2202/8192 [00:05<00:16, 370.64it/s]
Adding requests:  27%|██▋       | 2241/8192 [00:05<00:15, 376.03it/s]
Adding requests:  28%|██▊       | 2281/8192 [00:05<00:15, 382.65it/s]
Adding requests:  28%|██▊       | 2320/8192 [00:06<00:15, 383.77it/s]
Adding requests:  29%|██▉       | 2361/8192 [00:06<00:14, 390.16it/s]
Adding requests:  29%|██▉       | 2402/8192 [00:06<00:14, 395.03it/s]
Adding requests:  30%|██▉       | 2442/8192 [00:06<00:14, 394.76it/s]
Adding requests:  30%|███       | 2482/8192 [00:06<00:14, 391.65it/s]
Adding requests:  31%|███       | 2523/8192 [00:06<00:14, 395.11it/s]
Adding requests:  31%|███▏      | 2566/8192 [00:06<00:13, 404.26it/s]
Adding requests:  32%|███▏      | 2607/8192 [00:06<00:13, 402.78it/s]
Adding requests:  32%|███▏      | 2648/8192 [00:06<00:14, 393.34it/s]
Adding requests:  33%|███▎      | 2688/8192 [00:07<00:14, 388.49it/s]
Adding requests:  33%|███▎      | 2727/8192 [00:07<00:14, 383.87it/s]
Adding requests:  34%|███▍      | 2768/8192 [00:07<00:13, 390.91it/s]
Adding requests:  34%|███▍      | 2809/8192 [00:07<00:13, 394.78it/s]
Adding requests:  35%|███▍      | 2850/8192 [00:07<00:13, 396.93it/s]
Adding requests:  35%|███▌      | 2890/8192 [00:07<00:13, 393.77it/s]
Adding requests:  36%|███▌      | 2930/8192 [00:07<00:13, 391.15it/s]
Adding requests:  36%|███▋      | 2971/8192 [00:07<00:13, 394.98it/s]
Adding requests:  37%|███▋      | 3012/8192 [00:07<00:12, 398.71it/s]
Adding requests:  37%|███▋      | 3053/8192 [00:07<00:12, 401.06it/s]
Adding requests:  38%|███▊      | 3094/8192 [00:08<00:12, 399.61it/s]
Adding requests:  38%|███▊      | 3134/8192 [00:08<00:12, 395.47it/s]
Adding requests:  39%|███▊      | 3174/8192 [00:08<00:13, 384.94it/s]
Adding requests:  39%|███▉      | 3213/8192 [00:08<00:12, 384.12it/s]
Adding requests:  40%|███▉      | 3255/8192 [00:08<00:12, 392.50it/s]
Adding requests:  40%|████      | 3295/8192 [00:08<00:12, 379.19it/s]
Adding requests:  41%|████      | 3334/8192 [00:08<00:12, 377.88it/s]
Adding requests:  41%|████      | 3375/8192 [00:08<00:12, 385.75it/s]
Adding requests:  42%|████▏     | 3415/8192 [00:08<00:12, 387.20it/s]
Adding requests:  42%|████▏     | 3455/8192 [00:08<00:12, 390.03it/s]
Adding requests:  43%|████▎     | 3495/8192 [00:09<00:12, 387.45it/s]
Adding requests:  43%|████▎     | 3538/8192 [00:09<00:11, 399.11it/s]
Adding requests:  44%|████▎     | 3578/8192 [00:09<00:11, 398.61it/s]
Adding requests:  44%|████▍     | 3618/8192 [00:09<00:11, 398.18it/s]
Adding requests:  45%|████▍     | 3658/8192 [00:09<00:11, 396.04it/s]
Adding requests:  45%|████▌     | 3698/8192 [00:09<00:11, 388.07it/s]
Adding requests:  46%|████▌     | 3738/8192 [00:09<00:11, 389.53it/s]
Adding requests:  46%|████▌     | 3777/8192 [00:09<00:11, 378.60it/s]
Adding requests:  47%|████▋     | 3815/8192 [00:09<00:11, 368.19it/s]
Adding requests:  47%|████▋     | 3854/8192 [00:10<00:11, 372.95it/s]
Adding requests:  48%|████▊     | 3893/8192 [00:10<00:11, 375.51it/s]
Adding requests:  48%|████▊     | 3931/8192 [00:10<00:11, 371.23it/s]
Adding requests:  48%|████▊     | 3969/8192 [00:10<00:11, 373.64it/s]
Adding requests:  49%|████▉     | 4007/8192 [00:10<00:11, 374.91it/s]
Adding requests:  49%|████▉     | 4045/8192 [00:10<00:11, 373.70it/s]
Adding requests:  50%|████▉     | 4083/8192 [00:10<00:10, 374.35it/s]
Adding requests:  50%|█████     | 4123/8192 [00:10<00:10, 379.87it/s]
Adding requests:  51%|█████     | 4161/8192 [00:10<00:10, 376.92it/s]
Adding requests:  51%|█████▏    | 4201/8192 [00:10<00:10, 380.73it/s]
Adding requests:  52%|█████▏    | 4240/8192 [00:11<00:10, 382.18it/s]
Adding requests:  52%|█████▏    | 4279/8192 [00:11<00:10, 378.18it/s]
Adding requests:  53%|█████▎    | 4318/8192 [00:11<00:10, 380.99it/s]
Adding requests:  53%|█████▎    | 4358/8192 [00:11<00:09, 384.35it/s]
Adding requests:  54%|█████▎    | 4397/8192 [00:11<00:09, 382.22it/s]
Adding requests:  54%|█████▍    | 4437/8192 [00:11<00:09, 384.78it/s]
Adding requests:  55%|█████▍    | 4477/8192 [00:11<00:09, 388.78it/s]
Adding requests:  55%|█████▌    | 4516/8192 [00:11<00:09, 374.06it/s]
Adding requests:  56%|█████▌    | 4555/8192 [00:11<00:09, 376.80it/s]
Adding requests:  56%|█████▌    | 4595/8192 [00:11<00:09, 381.46it/s]
Adding requests:  57%|█████▋    | 4634/8192 [00:12<00:09, 378.64it/s]
Adding requests:  57%|█████▋    | 4672/8192 [00:12<00:09, 375.77it/s]
Adding requests:  57%|█████▋    | 4710/8192 [00:12<00:09, 372.49it/s]
Adding requests:  58%|█████▊    | 4750/8192 [00:12<00:09, 380.34it/s]
Adding requests:  58%|█████▊    | 4789/8192 [00:12<00:09, 376.78it/s]
Adding requests:  59%|█████▉    | 4827/8192 [00:12<00:08, 374.84it/s]
Adding requests:  59%|█████▉    | 4865/8192 [00:12<00:08, 373.01it/s]
Adding requests:  60%|█████▉    | 4903/8192 [00:12<00:08, 373.94it/s]
Adding requests:  60%|██████    | 4943/8192 [00:12<00:08, 380.74it/s]
Adding requests:  61%|██████    | 4982/8192 [00:13<00:08, 377.89it/s]
Adding requests:  61%|██████▏   | 5022/8192 [00:13<00:08, 382.69it/s]
Adding requests:  62%|██████▏   | 5061/8192 [00:13<00:08, 380.84it/s]
Adding requests:  62%|██████▏   | 5100/8192 [00:13<00:08, 381.39it/s]
Adding requests:  63%|██████▎   | 5139/8192 [00:13<00:08, 379.77it/s]
Adding requests:  63%|██████▎   | 5178/8192 [00:13<00:07, 380.98it/s]
Adding requests:  64%|██████▎   | 5217/8192 [00:13<00:07, 378.03it/s]
Adding requests:  64%|██████▍   | 5255/8192 [00:13<00:07, 378.39it/s]
Adding requests:  65%|██████▍   | 5294/8192 [00:13<00:07, 380.31it/s]
Adding requests:  65%|██████▌   | 5333/8192 [00:13<00:07, 379.39it/s]
Adding requests:  66%|██████▌   | 5373/8192 [00:14<00:07, 383.51it/s]
Adding requests:  66%|██████▌   | 5412/8192 [00:14<00:07, 375.13it/s]
Adding requests:  67%|██████▋   | 5452/8192 [00:14<00:07, 379.28it/s]
Adding requests:  67%|██████▋   | 5492/8192 [00:14<00:07, 384.66it/s]
Adding requests:  68%|██████▊   | 5531/8192 [00:14<00:06, 383.90it/s]
Adding requests:  68%|██████▊   | 5570/8192 [00:14<00:06, 382.17it/s]
Adding requests:  68%|██████▊   | 5609/8192 [00:14<00:06, 380.10it/s]
Adding requests:  69%|██████▉   | 5649/8192 [00:14<00:06, 383.26it/s]
Adding requests:  69%|██████▉   | 5688/8192 [00:14<00:06, 381.41it/s]
Adding requests:  70%|██████▉   | 5727/8192 [00:14<00:06, 383.12it/s]
Adding requests:  70%|███████   | 5767/8192 [00:15<00:06, 386.50it/s]
Adding requests:  71%|███████   | 5807/8192 [00:15<00:06, 388.43it/s]
Adding requests:  71%|███████▏  | 5846/8192 [00:15<00:06, 386.25it/s]
Adding requests:  72%|███████▏  | 5885/8192 [00:15<00:06, 375.65it/s]
Adding requests:  72%|███████▏  | 5924/8192 [00:15<00:05, 379.65it/s]
Adding requests:  73%|███████▎  | 5965/8192 [00:15<00:05, 387.17it/s]
Adding requests:  73%|███████▎  | 6004/8192 [00:15<00:05, 387.05it/s]
Adding requests:  74%|███████▍  | 6044/8192 [00:15<00:05, 389.81it/s]
Adding requests:  74%|███████▍  | 6084/8192 [00:15<00:05, 386.15it/s]
Adding requests:  75%|███████▍  | 6124/8192 [00:15<00:05, 386.88it/s]
Adding requests:  75%|███████▌  | 6165/8192 [00:16<00:05, 391.54it/s]
Adding requests:  76%|███████▌  | 6205/8192 [00:16<00:05, 381.38it/s]
Adding requests:  76%|███████▌  | 6244/8192 [00:16<00:05, 381.99it/s]
Adding requests:  77%|███████▋  | 6284/8192 [00:16<00:04, 385.06it/s]
Adding requests:  77%|███████▋  | 6325/8192 [00:16<00:04, 391.41it/s]
Adding requests:  78%|███████▊  | 6366/8192 [00:16<00:04, 395.74it/s]
Adding requests:  78%|███████▊  | 6406/8192 [00:16<00:04, 388.30it/s]
Adding requests:  79%|███████▊  | 6445/8192 [00:16<00:04, 380.04it/s]
Adding requests:  79%|███████▉  | 6484/8192 [00:16<00:04, 377.45it/s]
Adding requests:  80%|███████▉  | 6524/8192 [00:17<00:04, 381.00it/s]
Adding requests:  80%|████████  | 6563/8192 [00:17<00:04, 381.89it/s]
Adding requests:  81%|████████  | 6602/8192 [00:17<00:04, 379.74it/s]
Adding requests:  81%|████████  | 6643/8192 [00:17<00:04, 386.37it/s]
Adding requests:  82%|████████▏ | 6682/8192 [00:17<00:03, 382.04it/s]
Adding requests:  82%|████████▏ | 6721/8192 [00:17<00:03, 384.07it/s]
Adding requests:  83%|████████▎ | 6761/8192 [00:17<00:03, 387.66it/s]
Adding requests:  83%|████████▎ | 6800/8192 [00:17<00:03, 383.32it/s]
Adding requests:  83%|████████▎ | 6839/8192 [00:17<00:03, 382.58it/s]
Adding requests:  84%|████████▍ | 6879/8192 [00:17<00:03, 385.68it/s]
Adding requests:  84%|████████▍ | 6918/8192 [00:18<00:03, 384.57it/s]
Adding requests:  85%|████████▍ | 6957/8192 [00:18<00:03, 383.80it/s]
Adding requests:  85%|████████▌ | 6997/8192 [00:18<00:03, 387.72it/s]
Adding requests:  86%|████████▌ | 7036/8192 [00:18<00:02, 387.92it/s]
Adding requests:  86%|████████▋ | 7075/8192 [00:18<00:02, 384.07it/s]
Adding requests:  87%|████████▋ | 7114/8192 [00:18<00:02, 382.89it/s]
Adding requests:  87%|████████▋ | 7153/8192 [00:18<00:02, 383.54it/s]
Adding requests:  88%|████████▊ | 7194/8192 [00:18<00:02, 388.66it/s]
Adding requests:  88%|████████▊ | 7235/8192 [00:18<00:02, 393.44it/s]
Adding requests:  89%|████████▉ | 7275/8192 [00:18<00:02, 382.60it/s]
Adding requests:  89%|████████▉ | 7314/8192 [00:19<00:02, 380.49it/s]
Adding requests:  90%|████████▉ | 7354/8192 [00:19<00:02, 384.65it/s]
Adding requests:  90%|█████████ | 7393/8192 [00:19<00:02, 383.02it/s]
Adding requests:  91%|█████████ | 7432/8192 [00:19<00:01, 384.75it/s]
Adding requests:  91%|█████████ | 7471/8192 [00:19<00:01, 379.88it/s]
Adding requests:  92%|█████████▏| 7511/8192 [00:19<00:01, 385.75it/s]
Adding requests:  92%|█████████▏| 7550/8192 [00:19<00:01, 382.00it/s]
Adding requests:  93%|█████████▎| 7589/8192 [00:19<00:01, 380.66it/s]
Adding requests:  93%|█████████▎| 7628/8192 [00:19<00:01, 382.85it/s]
Adding requests:  94%|█████████▎| 7670/8192 [00:19<00:01, 392.47it/s]
Adding requests:  94%|█████████▍| 7710/8192 [00:20<00:01, 393.46it/s]
Adding requests:  95%|█████████▍| 7750/8192 [00:20<00:01, 390.06it/s]
Adding requests:  95%|█████████▌| 7790/8192 [00:20<00:01, 389.92it/s]
Adding requests:  96%|█████████▌| 7830/8192 [00:20<00:00, 385.17it/s]
Adding requests:  96%|█████████▌| 7869/8192 [00:20<00:00, 380.85it/s]
Adding requests:  97%|█████████▋| 7909/8192 [00:20<00:00, 384.55it/s]
Adding requests:  97%|█████████▋| 7951/8192 [00:20<00:00, 393.24it/s]
Adding requests:  98%|█████████▊| 7993/8192 [00:20<00:00, 398.85it/s]
Adding requests:  98%|█████████▊| 8033/8192 [00:20<00:00, 389.83it/s]
Adding requests:  99%|█████████▊| 8074/8192 [00:21<00:00, 392.64it/s]
Adding requests:  99%|█████████▉| 8114/8192 [00:21<00:00, 391.93it/s]
Adding requests: 100%|█████████▉| 8154/8192 [00:21<00:00, 387.95it/s]
Adding requests: 100%|██████████| 8192/8192 [00:21<00:00, 383.76it/s]

Processed prompts:   0%|          | 0/8192 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▌         | 432/8192 [00:01<00:25, 303.88it/s, est. speed input: 311181.18 toks/s, output: 303.88 toks/s]
Processed prompts:   6%|▌         | 496/8192 [00:04<01:21, 94.44it/s, est. speed input: 117951.53 toks/s, output: 115.19 toks/s] 
Processed prompts:   7%|▋         | 560/8192 [00:07<02:13, 57.21it/s, est. speed input: 79728.22 toks/s, output: 77.86 toks/s]  
Processed prompts:   8%|▊         | 624/8192 [00:10<02:58, 42.31it/s, est. speed input: 63356.49 toks/s, output: 61.87 toks/s]
Processed prompts:   8%|▊         | 688/8192 [00:12<03:36, 34.66it/s, est. speed input: 54255.57 toks/s, output: 52.98 toks/s]
Processed prompts:   9%|▉         | 752/8192 [00:15<04:05, 30.34it/s, est. speed input: 48556.19 toks/s, output: 47.42 toks/s]
Processed prompts:  10%|▉         | 816/8192 [00:18<04:27, 27.62it/s, est. speed input: 44577.98 toks/s, output: 43.53 toks/s]
Processed prompts:  11%|█         | 880/8192 [00:21<04:43, 25.82it/s, est. speed input: 41633.13 toks/s, output: 40.66 toks/s]
Processed prompts:  12%|█▏        | 944/8192 [00:24<04:54, 24.63it/s, est. speed input: 39382.46 toks/s, output: 38.46 toks/s]
Processed prompts:  12%|█▏        | 1008/8192 [00:27<05:01, 23.83it/s, est. speed input: 37608.74 toks/s, output: 36.73 toks/s]
Processed prompts:  13%|█▎        | 1072/8192 [00:30<05:06, 23.25it/s, est. speed input: 36155.39 toks/s, output: 35.31 toks/s]
Processed prompts:  14%|█▍        | 1136/8192 [00:33<05:08, 22.88it/s, est. speed input: 34968.91 toks/s, output: 34.15 toks/s]
Processed prompts:  15%|█▍        | 1200/8192 [00:36<05:09, 22.60it/s, est. speed input: 33963.67 toks/s, output: 33.17 toks/s]
Processed prompts:  15%|█▌        | 1264/8192 [00:39<05:09, 22.42it/s, est. speed input: 33111.91 toks/s, output: 32.34 toks/s]
Processed prompts:  16%|█▌        | 1328/8192 [00:42<05:08, 22.27it/s, est. speed input: 32371.79 toks/s, output: 31.61 toks/s]
Processed prompts:  17%|█▋        | 1392/8192 [00:44<05:06, 22.16it/s, est. speed input: 31726.10 toks/s, output: 30.98 toks/s]
Processed prompts:  18%|█▊        | 1456/8192 [00:47<05:05, 22.08it/s, est. speed input: 31156.31 toks/s, output: 30.43 toks/s]
Processed prompts:  19%|█▊        | 1520/8192 [00:50<05:02, 22.04it/s, est. speed input: 30658.79 toks/s, output: 29.94 toks/s]
Processed prompts:  19%|█▉        | 1584/8192 [00:53<04:59, 22.09it/s, est. speed input: 30233.09 toks/s, output: 29.52 toks/s]
Processed prompts:  20%|██        | 1648/8192 [00:56<04:56, 22.04it/s, est. speed input: 29830.79 toks/s, output: 29.13 toks/s]
Processed prompts:  21%|██        | 1712/8192 [00:59<04:54, 21.98it/s, est. speed input: 29462.93 toks/s, output: 28.77 toks/s]
Processed prompts:  22%|██▏       | 1776/8192 [01:02<04:52, 21.95it/s, est. speed input: 29132.66 toks/s, output: 28.45 toks/s]
Processed prompts:  22%|██▏       | 1840/8192 [01:05<04:49, 21.93it/s, est. speed input: 28831.57 toks/s, output: 28.16 toks/s]
Processed prompts:  23%|██▎       | 1904/8192 [01:08<04:47, 21.89it/s, est. speed input: 28552.61 toks/s, output: 27.88 toks/s]
Processed prompts:  24%|██▍       | 1968/8192 [01:11<04:44, 21.86it/s, est. speed input: 28295.31 toks/s, output: 27.63 toks/s]
Processed prompts:  25%|██▍       | 2032/8192 [01:14<04:41, 21.86it/s, est. speed input: 28061.40 toks/s, output: 27.40 toks/s]
Processed prompts:  26%|██▌       | 2096/8192 [01:17<04:39, 21.84it/s, est. speed input: 27842.34 toks/s, output: 27.19 toks/s]
Processed prompts:  26%|██▋       | 2160/8192 [01:19<04:35, 21.92it/s, est. speed input: 27653.58 toks/s, output: 27.01 toks/s]
Processed prompts:  27%|██▋       | 2224/8192 [01:22<04:32, 21.88it/s, est. speed input: 27465.21 toks/s, output: 26.82 toks/s]
Processed prompts:  28%|██▊       | 2288/8192 [01:25<04:29, 21.87it/s, est. speed input: 27290.70 toks/s, output: 26.65 toks/s]
Processed prompts:  29%|██▊       | 2352/8192 [01:28<04:27, 21.84it/s, est. speed input: 27124.85 toks/s, output: 26.49 toks/s]
Processed prompts:  29%|██▉       | 2416/8192 [01:31<04:24, 21.82it/s, est. speed input: 26971.02 toks/s, output: 26.34 toks/s]
Processed prompts:  30%|███       | 2480/8192 [01:34<04:22, 21.80it/s, est. speed input: 26824.79 toks/s, output: 26.20 toks/s]
Processed prompts:  31%|███       | 2544/8192 [01:37<04:19, 21.80it/s, est. speed input: 26688.93 toks/s, output: 26.06 toks/s]
Processed prompts:  32%|███▏      | 2608/8192 [01:40<04:16, 21.78it/s, est. speed input: 26559.12 toks/s, output: 25.94 toks/s]
Processed prompts:  33%|███▎      | 2672/8192 [01:43<04:13, 21.77it/s, est. speed input: 26437.72 toks/s, output: 25.82 toks/s]
Processed prompts:  33%|███▎      | 2736/8192 [01:46<04:10, 21.78it/s, est. speed input: 26324.42 toks/s, output: 25.71 toks/s]
Processed prompts:  34%|███▍      | 2800/8192 [01:49<04:07, 21.77it/s, est. speed input: 26214.77 toks/s, output: 25.60 toks/s]
Processed prompts:  35%|███▍      | 2864/8192 [01:52<04:03, 21.88it/s, est. speed input: 26123.49 toks/s, output: 25.51 toks/s]
Processed prompts:  36%|███▌      | 2928/8192 [01:55<04:01, 21.84it/s, est. speed input: 26025.37 toks/s, output: 25.42 toks/s]
Processed prompts:  37%|███▋      | 2992/8192 [01:58<03:58, 21.81it/s, est. speed input: 25931.36 toks/s, output: 25.32 toks/s]
Processed prompts:  37%|███▋      | 3056/8192 [02:01<03:55, 21.78it/s, est. speed input: 25841.42 toks/s, output: 25.24 toks/s]
Processed prompts:  38%|███▊      | 3120/8192 [02:04<03:52, 21.78it/s, est. speed input: 25757.22 toks/s, output: 25.15 toks/s]
Processed prompts:  39%|███▉      | 3184/8192 [02:06<03:50, 21.76it/s, est. speed input: 25676.14 toks/s, output: 25.07 toks/s]
Processed prompts:  40%|███▉      | 3248/8192 [02:09<03:47, 21.75it/s, est. speed input: 25598.01 toks/s, output: 25.00 toks/s]
Processed prompts:  40%|████      | 3312/8192 [02:12<03:44, 21.75it/s, est. speed input: 25524.30 toks/s, output: 24.93 toks/s]
Processed prompts:  41%|████      | 3376/8192 [02:15<03:41, 21.75it/s, est. speed input: 25453.85 toks/s, output: 24.86 toks/s]
Processed prompts:  42%|████▏     | 3440/8192 [02:18<03:38, 21.74it/s, est. speed input: 25385.74 toks/s, output: 24.79 toks/s]
Processed prompts:  43%|████▎     | 3504/8192 [02:21<03:35, 21.76it/s, est. speed input: 25322.38 toks/s, output: 24.73 toks/s]
Processed prompts:  44%|████▎     | 3568/8192 [02:24<03:32, 21.78it/s, est. speed input: 25261.99 toks/s, output: 24.67 toks/s]
Processed prompts:  44%|████▍     | 3632/8192 [02:27<03:28, 21.87it/s, est. speed input: 25210.11 toks/s, output: 24.62 toks/s]
Processed prompts:  45%|████▌     | 3696/8192 [02:30<03:25, 21.84it/s, est. speed input: 25152.90 toks/s, output: 24.56 toks/s]
Processed prompts:  46%|████▌     | 3760/8192 [02:33<03:23, 21.80it/s, est. speed input: 25096.78 toks/s, output: 24.51 toks/s]
Processed prompts:  47%|████▋     | 3824/8192 [02:36<03:20, 21.79it/s, est. speed input: 25044.23 toks/s, output: 24.46 toks/s]
Processed prompts:  47%|████▋     | 3888/8192 [02:39<03:16, 21.85it/s, est. speed input: 24998.09 toks/s, output: 24.41 toks/s]
Processed prompts:  48%|████▊     | 3952/8192 [02:42<03:14, 21.82it/s, est. speed input: 24948.19 toks/s, output: 24.36 toks/s]
Processed prompts:  49%|████▉     | 4016/8192 [02:45<03:11, 21.77it/s, est. speed input: 24899.05 toks/s, output: 24.32 toks/s]
Processed prompts:  50%|████▉     | 4080/8192 [02:48<03:08, 21.85it/s, est. speed input: 24858.73 toks/s, output: 24.28 toks/s]
Processed prompts:  51%|█████     | 4144/8192 [02:51<03:05, 21.82it/s, est. speed input: 24813.84 toks/s, output: 24.23 toks/s]
Processed prompts:  51%|█████▏    | 4208/8192 [02:53<03:02, 21.77it/s, est. speed input: 24769.28 toks/s, output: 24.19 toks/s]
Processed prompts:  52%|█████▏    | 4272/8192 [02:56<03:00, 21.76it/s, est. speed input: 24727.45 toks/s, output: 24.15 toks/s]
Processed prompts:  53%|█████▎    | 4336/8192 [02:59<02:57, 21.74it/s, est. speed input: 24686.46 toks/s, output: 24.11 toks/s]
Processed prompts:  54%|█████▎    | 4400/8192 [03:02<02:54, 21.75it/s, est. speed input: 24647.78 toks/s, output: 24.07 toks/s]
Processed prompts:  54%|█████▍    | 4464/8192 [03:05<02:51, 21.75it/s, est. speed input: 24610.13 toks/s, output: 24.03 toks/s]
Processed prompts:  55%|█████▌    | 4528/8192 [03:08<02:48, 21.74it/s, est. speed input: 24572.89 toks/s, output: 24.00 toks/s]
Processed prompts:  56%|█████▌    | 4592/8192 [03:11<02:45, 21.74it/s, est. speed input: 24537.42 toks/s, output: 23.96 toks/s]
Processed prompts:  57%|█████▋    | 4656/8192 [03:14<02:42, 21.73it/s, est. speed input: 24502.75 toks/s, output: 23.93 toks/s]
Processed prompts:  58%|█████▊    | 4720/8192 [03:17<02:39, 21.74it/s, est. speed input: 24469.48 toks/s, output: 23.90 toks/s]
Processed prompts:  58%|█████▊    | 4784/8192 [03:20<02:36, 21.72it/s, est. speed input: 24436.26 toks/s, output: 23.86 toks/s]
Processed prompts:  59%|█████▉    | 4848/8192 [03:23<02:33, 21.72it/s, est. speed input: 24404.36 toks/s, output: 23.83 toks/s]
Processed prompts:  60%|█████▉    | 4912/8192 [03:26<02:31, 21.71it/s, est. speed input: 24373.02 toks/s, output: 23.80 toks/s]
Processed prompts:  61%|██████    | 4976/8192 [03:29<02:27, 21.81it/s, est. speed input: 24348.20 toks/s, output: 23.78 toks/s]
Processed prompts:  62%|██████▏   | 5040/8192 [03:32<02:24, 21.80it/s, est. speed input: 24319.49 toks/s, output: 23.75 toks/s]
Processed prompts:  62%|██████▏   | 5104/8192 [03:35<02:21, 21.80it/s, est. speed input: 24292.15 toks/s, output: 23.72 toks/s]
Processed prompts:  63%|██████▎   | 5168/8192 [03:38<02:18, 21.78it/s, est. speed input: 24264.63 toks/s, output: 23.70 toks/s]
Processed prompts:  64%|██████▍   | 5232/8192 [03:41<02:16, 21.75it/s, est. speed input: 24237.30 toks/s, output: 23.67 toks/s]
Processed prompts:  65%|██████▍   | 5296/8192 [03:43<02:13, 21.74it/s, est. speed input: 24211.10 toks/s, output: 23.64 toks/s]
Processed prompts:  65%|██████▌   | 5360/8192 [03:46<02:10, 21.75it/s, est. speed input: 24186.36 toks/s, output: 23.62 toks/s]
Processed prompts:  66%|██████▌   | 5424/8192 [03:49<02:07, 21.75it/s, est. speed input: 24161.63 toks/s, output: 23.60 toks/s]
Processed prompts:  67%|██████▋   | 5488/8192 [03:52<02:04, 21.75it/s, est. speed input: 24137.87 toks/s, output: 23.57 toks/s]
Processed prompts:  68%|██████▊   | 5552/8192 [03:55<02:01, 21.73it/s, est. speed input: 24113.68 toks/s, output: 23.55 toks/s]
Processed prompts:  69%|██████▊   | 5616/8192 [03:58<01:58, 21.72it/s, est. speed input: 24090.33 toks/s, output: 23.53 toks/s]
Processed prompts:  69%|██████▉   | 5680/8192 [04:01<01:55, 21.73it/s, est. speed input: 24068.07 toks/s, output: 23.50 toks/s]
Processed prompts:  70%|███████   | 5744/8192 [04:04<01:52, 21.72it/s, est. speed input: 24045.73 toks/s, output: 23.48 toks/s]
Processed prompts:  71%|███████   | 5808/8192 [04:07<01:49, 21.71it/s, est. speed input: 24023.65 toks/s, output: 23.46 toks/s]
Processed prompts:  72%|███████▏  | 5872/8192 [04:10<01:46, 21.80it/s, est. speed input: 24006.70 toks/s, output: 23.44 toks/s]
Processed prompts:  72%|███████▏  | 5936/8192 [04:13<01:43, 21.88it/s, est. speed input: 23990.66 toks/s, output: 23.43 toks/s]
Processed prompts:  73%|███████▎  | 6000/8192 [04:16<01:40, 21.83it/s, est. speed input: 23970.55 toks/s, output: 23.41 toks/s]
Processed prompts:  74%|███████▍  | 6064/8192 [04:19<01:37, 21.81it/s, est. speed input: 23951.21 toks/s, output: 23.39 toks/s]
Processed prompts:  75%|███████▍  | 6128/8192 [04:22<01:34, 21.79it/s, est. speed input: 23932.43 toks/s, output: 23.37 toks/s]
Processed prompts:  76%|███████▌  | 6192/8192 [04:25<01:31, 21.76it/s, est. speed input: 23913.17 toks/s, output: 23.35 toks/s]
Processed prompts:  76%|███████▋  | 6256/8192 [04:28<01:29, 21.74it/s, est. speed input: 23894.61 toks/s, output: 23.33 toks/s]
Processed prompts:  77%|███████▋  | 6320/8192 [04:31<01:26, 21.73it/s, est. speed input: 23876.56 toks/s, output: 23.32 toks/s]
Processed prompts:  78%|███████▊  | 6384/8192 [04:33<01:23, 21.73it/s, est. speed input: 23858.80 toks/s, output: 23.30 toks/s]
Processed prompts:  79%|███████▊  | 6448/8192 [04:36<01:20, 21.71it/s, est. speed input: 23841.12 toks/s, output: 23.28 toks/s]
Processed prompts:  79%|███████▉  | 6512/8192 [04:39<01:17, 21.71it/s, est. speed input: 23824.08 toks/s, output: 23.27 toks/s]
Processed prompts:  80%|████████  | 6576/8192 [04:42<01:14, 21.72it/s, est. speed input: 23807.74 toks/s, output: 23.25 toks/s]
Processed prompts:  81%|████████  | 6640/8192 [04:45<01:11, 21.71it/s, est. speed input: 23791.26 toks/s, output: 23.23 toks/s]
Processed prompts:  82%|████████▏ | 6704/8192 [04:48<01:08, 21.70it/s, est. speed input: 23774.86 toks/s, output: 23.22 toks/s]
Processed prompts:  83%|████████▎ | 6768/8192 [04:51<01:05, 21.71it/s, est. speed input: 23759.47 toks/s, output: 23.20 toks/s]
Processed prompts:  83%|████████▎ | 6832/8192 [04:54<01:02, 21.72it/s, est. speed input: 23744.49 toks/s, output: 23.19 toks/s]
Processed prompts:  84%|████████▍ | 6896/8192 [04:57<00:59, 21.72it/s, est. speed input: 23729.71 toks/s, output: 23.17 toks/s]
Processed prompts:  85%|████████▍ | 6960/8192 [05:00<00:56, 21.72it/s, est. speed input: 23715.08 toks/s, output: 23.16 toks/s]
Processed prompts:  86%|████████▌ | 7024/8192 [05:03<00:53, 21.71it/s, est. speed input: 23700.53 toks/s, output: 23.15 toks/s]
Processed prompts:  87%|████████▋ | 7088/8192 [05:06<00:50, 21.74it/s, est. speed input: 23687.37 toks/s, output: 23.13 toks/s]
Processed prompts:  87%|████████▋ | 7152/8192 [05:09<00:47, 21.75it/s, est. speed input: 23674.28 toks/s, output: 23.12 toks/s]
Processed prompts:  88%|████████▊ | 7216/8192 [05:12<00:44, 21.73it/s, est. speed input: 23660.22 toks/s, output: 23.11 toks/s]
Processed prompts:  89%|████████▉ | 7280/8192 [05:15<00:41, 21.73it/s, est. speed input: 23646.97 toks/s, output: 23.09 toks/s]
Processed prompts:  90%|████████▉ | 7344/8192 [05:18<00:39, 21.73it/s, est. speed input: 23634.17 toks/s, output: 23.08 toks/s]
Processed prompts:  90%|█████████ | 7408/8192 [05:21<00:36, 21.74it/s, est. speed input: 23621.67 toks/s, output: 23.07 toks/s]
Processed prompts:  91%|█████████ | 7472/8192 [05:24<00:33, 21.75it/s, est. speed input: 23609.84 toks/s, output: 23.06 toks/s]
Processed prompts:  92%|█████████▏| 7536/8192 [05:27<00:30, 21.75it/s, est. speed input: 23597.84 toks/s, output: 23.04 toks/s]
Processed prompts:  93%|█████████▎| 7600/8192 [05:29<00:27, 21.77it/s, est. speed input: 23586.44 toks/s, output: 23.03 toks/s]
Processed prompts:  94%|█████████▎| 7664/8192 [05:32<00:24, 21.74it/s, est. speed input: 23574.29 toks/s, output: 23.02 toks/s]
Processed prompts:  94%|█████████▍| 7728/8192 [05:35<00:21, 21.73it/s, est. speed input: 23562.27 toks/s, output: 23.01 toks/s]
Processed prompts:  95%|█████████▌| 7792/8192 [05:38<00:18, 21.73it/s, est. speed input: 23550.82 toks/s, output: 23.00 toks/s]
Processed prompts:  96%|█████████▌| 7856/8192 [05:41<00:15, 21.71it/s, est. speed input: 23539.21 toks/s, output: 22.99 toks/s]
Processed prompts:  97%|█████████▋| 7920/8192 [05:44<00:12, 21.72it/s, est. speed input: 23528.27 toks/s, output: 22.98 toks/s]
Processed prompts:  97%|█████████▋| 7984/8192 [05:47<00:09, 21.73it/s, est. speed input: 23517.80 toks/s, output: 22.97 toks/s]
Processed prompts:  98%|█████████▊| 8048/8192 [05:50<00:06, 21.73it/s, est. speed input: 23506.92 toks/s, output: 22.96 toks/s]
Processed prompts:  99%|█████████▉| 8112/8192 [05:53<00:03, 21.74it/s, est. speed input: 23496.71 toks/s, output: 22.95 toks/s]
Processed prompts: 100%|█████████▉| 8176/8192 [05:54<00:00, 27.82it/s, est. speed input: 23628.80 toks/s, output: 23.08 toks/s]
Processed prompts: 100%|██████████| 8192/8192 [05:54<00:00, 27.82it/s, est. speed input: 23674.99 toks/s, output: 23.12 toks/s]
Processed prompts: 100%|██████████| 8192/8192 [05:54<00:00, 23.12it/s, est. speed input: 23674.99 toks/s, output: 23.12 toks/s]
[rank0]:[W126 13:54:08.945170164 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=512 ==========
Time: 2026-01-28 08:44:08
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_8
Params: prompt_len=512, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_8 --dataset-name random --input-len 512 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 513 --max-num-batched-tokens 513 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_INT8_py312_cu129_x86_64/cusparselt/2_8/json/BitNet-2B-INT8_M512.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-28 08:44:15 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3325541) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3325541) WARNING 01-28 08:44:30 [backends.py:609] Failed to read file <frozen os>
Throughput: 33.62 requests/s, 17249.40 total tokens/s, 33.62 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128

STDERR:
[2026-01-28 08:44:14] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 08:44:15] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 08:44:15] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 08:44:15] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:44:15] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:44:15] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:44:15] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:44:15] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:44:15] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 08:44:15] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 08:44:15] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 08:44:15] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 08:44:15] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 08:44:15] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 08:44:21] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 08:44:22] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 08:44:22] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 08:44:22] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:44:22] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:44:22] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:44:22] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:44:22] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:44:22] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 08:44:22] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 08:44:22] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 08:44:22] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 08:44:22] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 08:44:22] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3325541) [2026-01-28 08:44:23] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3325541) [2026-01-28 08:44:23] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3325541) [2026-01-28 08:44:23] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3325541) [2026-01-28 08:44:23] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=3325541) [2026-01-28 08:44:23] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=3325541) [2026-01-28 08:44:23] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=3325541) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3325541) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.30it/s]
(EngineCore_DP0 pid=3325541) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.30it/s]
(EngineCore_DP0 pid=3325541) 
(EngineCore_DP0 pid=3325541) [2026-01-28 08:44:24] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 3840] -> 1D uint8
(EngineCore_DP0 pid=3325541) [2026-01-28 08:44:24] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9216000 bytes
(EngineCore_DP0 pid=3325541) [2026-01-28 08:44:24] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 3840] -> 1D uint8
(EngineCore_DP0 pid=3325541) [2026-01-28 08:44:24] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 6144000 bytes
(EngineCore_DP0 pid=3325541) [2026-01-28 08:44:24] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 3840] -> 1D uint8
(EngineCore_DP0 pid=3325541) [2026-01-28 08:44:24] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 33177600 bytes
(EngineCore_DP0 pid=3325541) [2026-01-28 08:44:24] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 10368] -> 1D uint8
(EngineCore_DP0 pid=3325541) [2026-01-28 08:44:24] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 16588800 bytes
(EngineCore_DP0 pid=3325541) 2026-01-28 08:44:41,505 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3325541) 2026-01-28 08:44:41,531 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3325541) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  4.28it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  3.37it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  3.48it/s]
(EngineCore_DP0 pid=3325541) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00, 16.39it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  41%|████▏     | 53/128 [00:00<00:00, 529.20it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 702.30it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:30,  4.21it/s, est. speed input: 2156.55 toks/s, output: 4.21 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:07, 17.14it/s, est. speed input: 7410.08 toks/s, output: 14.47 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:00<00:04, 24.38it/s, est. speed input: 10184.70 toks/s, output: 19.89 toks/s]
Processed prompts:  10%|█         | 13/128 [00:00<00:03, 28.80it/s, est. speed input: 11901.00 toks/s, output: 23.24 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:00<00:03, 31.59it/s, est. speed input: 13063.26 toks/s, output: 25.51 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:00<00:03, 33.42it/s, est. speed input: 13901.12 toks/s, output: 27.15 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:00<00:02, 34.61it/s, est. speed input: 14531.13 toks/s, output: 28.38 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:00<00:02, 35.48it/s, est. speed input: 15032.49 toks/s, output: 29.36 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:01<00:02, 36.05it/s, est. speed input: 15432.33 toks/s, output: 30.14 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:01<00:02, 36.45it/s, est. speed input: 15762.39 toks/s, output: 30.79 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:01<00:02, 36.75it/s, est. speed input: 16039.65 toks/s, output: 31.33 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:01<00:02, 36.95it/s, est. speed input: 16275.10 toks/s, output: 31.79 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:01<00:02, 37.03it/s, est. speed input: 16471.78 toks/s, output: 32.17 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:01<00:02, 37.13it/s, est. speed input: 16646.09 toks/s, output: 32.51 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:01<00:01, 37.29it/s, est. speed input: 16807.47 toks/s, output: 32.83 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:01<00:01, 37.37it/s, est. speed input: 16947.56 toks/s, output: 33.10 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:01<00:01, 37.44it/s, est. speed input: 17073.42 toks/s, output: 33.35 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:02<00:01, 37.50it/s, est. speed input: 17187.27 toks/s, output: 33.57 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:02<00:01, 37.55it/s, est. speed input: 17290.44 toks/s, output: 33.77 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:02<00:01, 37.53it/s, est. speed input: 17379.72 toks/s, output: 33.94 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:02<00:01, 37.54it/s, est. speed input: 17462.75 toks/s, output: 34.11 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:02<00:01, 37.63it/s, est. speed input: 17544.21 toks/s, output: 34.27 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:02<00:01, 37.71it/s, est. speed input: 17620.17 toks/s, output: 34.41 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:02<00:00, 37.77it/s, est. speed input: 17690.25 toks/s, output: 34.55 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:02<00:00, 37.77it/s, est. speed input: 17752.63 toks/s, output: 34.67 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:02<00:00, 37.72it/s, est. speed input: 17807.41 toks/s, output: 34.78 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:03<00:00, 37.68it/s, est. speed input: 17858.33 toks/s, output: 34.88 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:03<00:00, 37.66it/s, est. speed input: 17906.20 toks/s, output: 34.97 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:03<00:00, 37.61it/s, est. speed input: 17948.84 toks/s, output: 35.06 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:03<00:00, 37.58it/s, est. speed input: 17988.84 toks/s, output: 35.13 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:03<00:00, 37.59it/s, est. speed input: 18028.10 toks/s, output: 35.21 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:03<00:00, 37.57it/s, est. speed input: 18063.85 toks/s, output: 35.28 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:03<00:00, 37.57it/s, est. speed input: 18090.35 toks/s, output: 35.33 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:03<00:00, 35.33it/s, est. speed input: 18090.35 toks/s, output: 35.33 toks/s]
[rank0]:[W128 08:44:47.792064083 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=1024 ==========
Time: 2026-01-28 08:44:49
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 1025 --max-num-batched-tokens 1025 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_INT8_py312_cu129_x86_64/cusparselt/2_8/json/BitNet-2B-INT8_M1024.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-28 08:44:56 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3326680) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3326680) WARNING 01-28 08:45:11 [backends.py:609] Failed to read file <frozen os>
Throughput: 32.25 requests/s, 33056.66 total tokens/s, 32.25 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128

STDERR:
[2026-01-28 08:44:56] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 08:44:56] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 08:44:56] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 08:44:56] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:44:56] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:44:56] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:44:56] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:44:56] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:44:56] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 08:44:56] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 08:44:56] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 08:44:56] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 08:44:56] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 08:44:56] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 08:45:03] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 08:45:03] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 08:45:03] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 08:45:03] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:45:03] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:45:03] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:45:03] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:45:03] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:45:03] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 08:45:03] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 08:45:03] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 08:45:03] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 08:45:03] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 08:45:03] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3326680) [2026-01-28 08:45:04] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3326680) [2026-01-28 08:45:04] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3326680) [2026-01-28 08:45:04] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3326680) [2026-01-28 08:45:04] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=3326680) [2026-01-28 08:45:04] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=3326680) [2026-01-28 08:45:04] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=3326680) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3326680) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.26it/s]
(EngineCore_DP0 pid=3326680) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.26it/s]
(EngineCore_DP0 pid=3326680) 
(EngineCore_DP0 pid=3326680) [2026-01-28 08:45:05] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 3840] -> 1D uint8
(EngineCore_DP0 pid=3326680) [2026-01-28 08:45:05] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9216000 bytes
(EngineCore_DP0 pid=3326680) [2026-01-28 08:45:05] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 3840] -> 1D uint8
(EngineCore_DP0 pid=3326680) [2026-01-28 08:45:05] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 6144000 bytes
(EngineCore_DP0 pid=3326680) [2026-01-28 08:45:05] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 3840] -> 1D uint8
(EngineCore_DP0 pid=3326680) [2026-01-28 08:45:05] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 33177600 bytes
(EngineCore_DP0 pid=3326680) [2026-01-28 08:45:05] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 10368] -> 1D uint8
(EngineCore_DP0 pid=3326680) [2026-01-28 08:45:05] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 16588800 bytes
(EngineCore_DP0 pid=3326680) 2026-01-28 08:45:22,646 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3326680) 2026-01-28 08:45:22,672 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3326680) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  9.42it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00, 11.77it/s]
(EngineCore_DP0 pid=3326680) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00, 15.93it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  29%|██▉       | 37/128 [00:00<00:00, 367.18it/s]
Adding requests:  69%|██████▉   | 88/128 [00:00<00:00, 448.48it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 450.84it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:03, 35.09it/s, est. speed input: 35943.63 toks/s, output: 35.09 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:00<00:03, 34.95it/s, est. speed input: 35819.34 toks/s, output: 34.98 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:00<00:03, 34.85it/s, est. speed input: 35733.45 toks/s, output: 34.89 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:00<00:03, 34.84it/s, est. speed input: 35715.42 toks/s, output: 34.88 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:00<00:03, 34.95it/s, est. speed input: 35771.14 toks/s, output: 34.93 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:00<00:02, 34.96it/s, est. speed input: 35779.72 toks/s, output: 34.94 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:00<00:02, 35.01it/s, est. speed input: 35802.19 toks/s, output: 34.96 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:00<00:02, 35.00it/s, est. speed input: 35803.95 toks/s, output: 34.96 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:01<00:02, 35.05it/s, est. speed input: 35827.36 toks/s, output: 34.99 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:01<00:02, 34.89it/s, est. speed input: 35779.37 toks/s, output: 34.94 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:01<00:02, 34.99it/s, est. speed input: 35804.41 toks/s, output: 34.96 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:01<00:02, 35.00it/s, est. speed input: 35810.63 toks/s, output: 34.97 toks/s]
Processed prompts:  41%|████      | 52/128 [00:01<00:02, 34.95it/s, est. speed input: 35800.00 toks/s, output: 34.96 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:01<00:02, 34.82it/s, est. speed input: 35768.36 toks/s, output: 34.93 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:01<00:01, 34.91it/s, est. speed input: 35781.04 toks/s, output: 34.94 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:01<00:01, 35.01it/s, est. speed input: 35799.94 toks/s, output: 34.96 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:01<00:01, 33.13it/s, est. speed input: 35409.99 toks/s, output: 34.58 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:02<00:01, 33.33it/s, est. speed input: 35365.07 toks/s, output: 34.54 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:02<00:01, 33.96it/s, est. speed input: 35416.91 toks/s, output: 34.59 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:02<00:01, 34.30it/s, est. speed input: 35443.69 toks/s, output: 34.61 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:02<00:01, 34.52it/s, est. speed input: 35464.70 toks/s, output: 34.63 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:02<00:01, 34.68it/s, est. speed input: 35485.00 toks/s, output: 34.65 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:02<00:01, 34.83it/s, est. speed input: 35507.01 toks/s, output: 34.67 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:02<00:00, 34.84it/s, est. speed input: 35515.65 toks/s, output: 34.68 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:02<00:00, 34.91it/s, est. speed input: 35531.05 toks/s, output: 34.70 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:02<00:00, 34.95it/s, est. speed input: 35544.48 toks/s, output: 34.71 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:03<00:00, 34.96it/s, est. speed input: 35555.46 toks/s, output: 34.72 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:03<00:00, 34.92it/s, est. speed input: 35558.70 toks/s, output: 34.72 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:03<00:00, 34.91it/s, est. speed input: 35564.48 toks/s, output: 34.73 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:03<00:00, 34.93it/s, est. speed input: 35572.57 toks/s, output: 34.74 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:03<00:00, 34.95it/s, est. speed input: 35581.03 toks/s, output: 34.75 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:03<00:00, 34.94it/s, est. speed input: 35586.17 toks/s, output: 34.75 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:03<00:00, 34.94it/s, est. speed input: 35586.17 toks/s, output: 34.75 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:03<00:00, 34.75it/s, est. speed input: 35586.17 toks/s, output: 34.75 toks/s]
[rank0]:[W128 08:45:28.672038362 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=2048 ==========
Time: 2026-01-28 08:45:30
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=256, max_num_seqs=2
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 256 --max-num-seqs 2 --max-model-len 1025 --max-num-batched-tokens 2048 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_INT8_py312_cu129_x86_64/cusparselt/2_8/json/BitNet-2B-INT8_M2048.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-28 08:45:38 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3327766) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3327766) WARNING 01-28 08:45:54 [backends.py:609] Failed to read file <frozen os>
Throughput: 63.05 requests/s, 64626.50 total tokens/s, 63.05 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256

STDERR:
[2026-01-28 08:45:37] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 08:45:38] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 08:45:38] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 08:45:38] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:45:38] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:45:38] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:45:38] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:45:38] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:45:38] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 08:45:38] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 08:45:38] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 08:45:38] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 08:45:38] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 08:45:38] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 08:45:45] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 08:45:45] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 08:45:45] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 08:45:45] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:45:45] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:45:45] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:45:45] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:45:45] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:45:45] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 08:45:45] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 08:45:45] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 08:45:45] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 08:45:45] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 08:45:45] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3327766) [2026-01-28 08:45:46] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3327766) [2026-01-28 08:45:46] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3327766) [2026-01-28 08:45:46] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3327766) [2026-01-28 08:45:46] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=3327766) [2026-01-28 08:45:46] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=3327766) [2026-01-28 08:45:46] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=3327766) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3327766) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.20it/s]
(EngineCore_DP0 pid=3327766) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.20it/s]
(EngineCore_DP0 pid=3327766) 
(EngineCore_DP0 pid=3327766) [2026-01-28 08:45:47] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 3840] -> 1D uint8
(EngineCore_DP0 pid=3327766) [2026-01-28 08:45:47] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9216000 bytes
(EngineCore_DP0 pid=3327766) [2026-01-28 08:45:47] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 3840] -> 1D uint8
(EngineCore_DP0 pid=3327766) [2026-01-28 08:45:47] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 6144000 bytes
(EngineCore_DP0 pid=3327766) [2026-01-28 08:45:47] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 3840] -> 1D uint8
(EngineCore_DP0 pid=3327766) [2026-01-28 08:45:47] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 33177600 bytes
(EngineCore_DP0 pid=3327766) [2026-01-28 08:45:47] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 10368] -> 1D uint8
(EngineCore_DP0 pid=3327766) [2026-01-28 08:45:47] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 16588800 bytes
(EngineCore_DP0 pid=3327766) 2026-01-28 08:46:04,766 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3327766) 2026-01-28 08:46:04,793 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3327766) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  67%|██████▋   | 2/3 [00:00<00:00, 13.17it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00, 12.96it/s]
(EngineCore_DP0 pid=3327766) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00, 16.63it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00, 16.61it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  11%|█▏        | 29/256 [00:00<00:00, 287.46it/s]
Adding requests:  32%|███▏      | 82/256 [00:00<00:00, 424.34it/s]
Adding requests:  52%|█████▏    | 132/256 [00:00<00:00, 457.98it/s]
Adding requests:  71%|███████   | 181/256 [00:00<00:00, 470.51it/s]
Adding requests:  91%|█████████ | 233/256 [00:00<00:00, 484.44it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 464.79it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▋         | 16/256 [00:00<00:01, 132.53it/s, est. speed input: 135733.06 toks/s, output: 132.54 toks/s]
Processed prompts:  12%|█▏        | 30/256 [00:00<00:02, 89.30it/s, est. speed input: 96490.46 toks/s, output: 94.22 toks/s]   
Processed prompts:  16%|█▌        | 40/256 [00:00<00:02, 81.67it/s, est. speed input: 89182.23 toks/s, output: 87.09 toks/s]
Processed prompts:  19%|█▉        | 49/256 [00:00<00:02, 81.11it/s, est. speed input: 87738.09 toks/s, output: 85.68 toks/s]
Processed prompts:  23%|██▎       | 58/256 [00:00<00:02, 74.87it/s, est. speed input: 83363.74 toks/s, output: 81.41 toks/s]
Processed prompts:  26%|██▌       | 66/256 [00:00<00:02, 73.78it/s, est. speed input: 81930.44 toks/s, output: 80.01 toks/s]
Processed prompts:  29%|██▉       | 74/256 [00:00<00:02, 72.94it/s, est. speed input: 80814.87 toks/s, output: 78.92 toks/s]
Processed prompts:  32%|███▏      | 82/256 [00:01<00:02, 72.44it/s, est. speed input: 79977.10 toks/s, output: 78.10 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:01<00:02, 71.90it/s, est. speed input: 79230.21 toks/s, output: 77.37 toks/s]
Processed prompts:  38%|███▊      | 98/256 [00:01<00:02, 71.62it/s, est. speed input: 78649.84 toks/s, output: 76.80 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:01<00:02, 71.43it/s, est. speed input: 78167.28 toks/s, output: 76.33 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:01<00:01, 71.14it/s, est. speed input: 77712.05 toks/s, output: 75.89 toks/s]
Processed prompts:  48%|████▊     | 122/256 [00:01<00:01, 70.96it/s, est. speed input: 77327.16 toks/s, output: 75.51 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:01<00:01, 70.88it/s, est. speed input: 77005.22 toks/s, output: 75.20 toks/s]
Processed prompts:  54%|█████▍    | 138/256 [00:01<00:01, 70.79it/s, est. speed input: 76712.88 toks/s, output: 74.91 toks/s]
Processed prompts:  57%|█████▋    | 146/256 [00:01<00:01, 70.65it/s, est. speed input: 76440.94 toks/s, output: 74.65 toks/s]
Processed prompts:  60%|██████    | 154/256 [00:02<00:01, 70.62it/s, est. speed input: 76209.73 toks/s, output: 74.42 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:02<00:01, 70.59it/s, est. speed input: 76001.34 toks/s, output: 74.22 toks/s]
Processed prompts:  66%|██████▋   | 170/256 [00:02<00:01, 70.57it/s, est. speed input: 75815.14 toks/s, output: 74.04 toks/s]
Processed prompts:  70%|██████▉   | 178/256 [00:02<00:01, 70.65it/s, est. speed input: 75661.56 toks/s, output: 73.89 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:02<00:00, 70.73it/s, est. speed input: 75525.11 toks/s, output: 73.75 toks/s]
Processed prompts:  76%|███████▌  | 194/256 [00:02<00:00, 70.87it/s, est. speed input: 75413.69 toks/s, output: 73.65 toks/s]
Processed prompts:  79%|███████▉  | 202/256 [00:02<00:00, 70.92it/s, est. speed input: 75303.82 toks/s, output: 73.54 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:02<00:00, 70.96it/s, est. speed input: 75202.71 toks/s, output: 73.44 toks/s]
Processed prompts:  85%|████████▌ | 218/256 [00:02<00:00, 70.93it/s, est. speed input: 75102.61 toks/s, output: 73.34 toks/s]
Processed prompts:  88%|████████▊ | 226/256 [00:03<00:00, 70.97it/s, est. speed input: 75017.91 toks/s, output: 73.26 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:03<00:00, 70.99it/s, est. speed input: 74937.97 toks/s, output: 73.18 toks/s]
Processed prompts:  95%|█████████▍| 242/256 [00:03<00:00, 70.92it/s, est. speed input: 74853.12 toks/s, output: 73.10 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:03<00:00, 70.83it/s, est. speed input: 74769.15 toks/s, output: 73.02 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:03<00:00, 70.83it/s, est. speed input: 74735.50 toks/s, output: 72.98 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:03<00:00, 72.98it/s, est. speed input: 74735.50 toks/s, output: 72.98 toks/s]
[rank0]:[W128 08:46:11.009727938 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=4096 ==========
Time: 2026-01-28 08:46:13
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=512, max_num_seqs=4
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 512 --max-num-seqs 4 --max-model-len 1025 --max-num-batched-tokens 4096 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_INT8_py312_cu129_x86_64/cusparselt/2_8/json/BitNet-2B-INT8_M4096.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-28 08:46:21 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3328998) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3328998) WARNING 01-28 08:46:36 [backends.py:609] Failed to read file <frozen os>
Throughput: 84.56 requests/s, 86675.44 total tokens/s, 84.56 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512

STDERR:
[2026-01-28 08:46:21] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 08:46:21] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 08:46:21] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 08:46:21] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:46:21] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:46:21] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:46:21] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:46:21] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:46:21] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 08:46:21] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 08:46:21] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 08:46:21] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 08:46:21] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 08:46:21] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 08:46:28] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 08:46:28] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 08:46:28] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 08:46:28] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:46:28] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:46:28] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:46:28] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:46:28] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:46:28] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 08:46:28] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 08:46:28] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 08:46:28] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 08:46:28] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 08:46:28] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3328998) [2026-01-28 08:46:29] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3328998) [2026-01-28 08:46:29] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3328998) [2026-01-28 08:46:29] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3328998) [2026-01-28 08:46:29] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=3328998) [2026-01-28 08:46:29] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=3328998) [2026-01-28 08:46:29] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=3328998) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3328998) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.27it/s]
(EngineCore_DP0 pid=3328998) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.27it/s]
(EngineCore_DP0 pid=3328998) 
(EngineCore_DP0 pid=3328998) [2026-01-28 08:46:30] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 3840] -> 1D uint8
(EngineCore_DP0 pid=3328998) [2026-01-28 08:46:30] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9216000 bytes
(EngineCore_DP0 pid=3328998) [2026-01-28 08:46:30] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 3840] -> 1D uint8
(EngineCore_DP0 pid=3328998) [2026-01-28 08:46:30] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 6144000 bytes
(EngineCore_DP0 pid=3328998) [2026-01-28 08:46:30] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 3840] -> 1D uint8
(EngineCore_DP0 pid=3328998) [2026-01-28 08:46:30] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 33177600 bytes
(EngineCore_DP0 pid=3328998) [2026-01-28 08:46:30] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 10368] -> 1D uint8
(EngineCore_DP0 pid=3328998) [2026-01-28 08:46:30] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 16588800 bytes
(EngineCore_DP0 pid=3328998) 2026-01-28 08:46:47,678 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3328998) 2026-01-28 08:46:47,705 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3328998) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  25%|██▌       | 1/4 [00:00<00:00,  6.11it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 2/4 [00:00<00:00,  6.78it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  9.16it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  8.46it/s]
(EngineCore_DP0 pid=3328998) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  67%|██████▋   | 2/3 [00:00<00:00, 16.44it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00, 16.87it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   6%|▌         | 30/512 [00:00<00:01, 298.09it/s]
Adding requests:  16%|█▌        | 80/512 [00:00<00:01, 413.60it/s]
Adding requests:  25%|██▌       | 129/512 [00:00<00:00, 447.77it/s]
Adding requests:  35%|███▍      | 177/512 [00:00<00:00, 459.70it/s]
Adding requests:  44%|████▍     | 227/512 [00:00<00:00, 472.80it/s]
Adding requests:  54%|█████▍    | 277/512 [00:00<00:00, 481.75it/s]
Adding requests:  64%|██████▍   | 327/512 [00:00<00:00, 486.43it/s]
Adding requests:  74%|███████▍  | 379/512 [00:00<00:00, 495.70it/s]
Adding requests:  84%|████████▍ | 431/512 [00:00<00:00, 500.36it/s]
Adding requests:  94%|█████████▍| 482/512 [00:01<00:00, 500.98it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 478.55it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  15%|█▌        | 78/512 [00:00<00:00, 687.20it/s, est. speed input: 703810.47 toks/s, output: 687.23 toks/s]
Processed prompts:  29%|██▊       | 147/512 [00:00<00:02, 145.43it/s, est. speed input: 170299.91 toks/s, output: 166.31 toks/s]
Processed prompts:  35%|███▌      | 181/512 [00:01<00:02, 126.14it/s, est. speed input: 148936.55 toks/s, output: 145.44 toks/s]
Processed prompts:  40%|███▉      | 204/512 [00:01<00:02, 114.01it/s, est. speed input: 137674.15 toks/s, output: 134.45 toks/s]
Processed prompts:  43%|████▎     | 221/512 [00:01<00:02, 109.56it/s, est. speed input: 133178.76 toks/s, output: 130.06 toks/s]
Processed prompts:  46%|████▌     | 236/512 [00:01<00:02, 103.28it/s, est. speed input: 128521.46 toks/s, output: 125.51 toks/s]
Processed prompts:  49%|████▊     | 249/512 [00:02<00:02, 101.92it/s, est. speed input: 126535.73 toks/s, output: 123.57 toks/s]
Processed prompts:  51%|█████     | 261/512 [00:02<00:02, 98.97it/s, est. speed input: 124289.43 toks/s, output: 121.38 toks/s] 
Processed prompts:  53%|█████▎    | 272/512 [00:02<00:02, 94.66it/s, est. speed input: 121844.71 toks/s, output: 118.99 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:02<00:02, 89.25it/s, est. speed input: 119242.95 toks/s, output: 116.45 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:02<00:02, 89.01it/s, est. speed input: 117714.74 toks/s, output: 114.95 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:02<00:02, 88.70it/s, est. speed input: 116308.96 toks/s, output: 113.58 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:02<00:02, 88.61it/s, est. speed input: 115071.76 toks/s, output: 112.37 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:02<00:02, 88.61it/s, est. speed input: 113961.34 toks/s, output: 111.29 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:03<00:01, 89.63it/s, est. speed input: 113139.31 toks/s, output: 110.49 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:03<00:01, 89.58it/s, est. speed input: 112246.12 toks/s, output: 109.61 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:03<00:01, 89.21it/s, est. speed input: 111365.41 toks/s, output: 108.75 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [00:03<00:01, 88.86it/s, est. speed input: 110539.37 toks/s, output: 107.95 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [00:03<00:01, 88.56it/s, est. speed input: 109767.39 toks/s, output: 107.19 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [00:03<00:01, 88.48it/s, est. speed input: 109070.78 toks/s, output: 106.51 toks/s]
Processed prompts:  81%|████████  | 414/512 [00:03<00:01, 88.54it/s, est. speed input: 108437.80 toks/s, output: 105.90 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [00:04<00:00, 88.45it/s, est. speed input: 107829.83 toks/s, output: 105.30 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [00:04<00:00, 88.47it/s, est. speed input: 107272.80 toks/s, output: 104.76 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [00:04<00:00, 89.83it/s, est. speed input: 106918.86 toks/s, output: 104.41 toks/s]
Processed prompts:  90%|█████████ | 462/512 [00:04<00:00, 89.53it/s, est. speed input: 106433.35 toks/s, output: 103.94 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [00:04<00:00, 89.08it/s, est. speed input: 105948.90 toks/s, output: 103.47 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [00:04<00:00, 88.74it/s, est. speed input: 105490.22 toks/s, output: 103.02 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [00:04<00:00, 88.60it/s, est. speed input: 105067.79 toks/s, output: 102.60 toks/s]
Processed prompts: 100%|█████████▉| 510/512 [00:04<00:00, 89.86it/s, est. speed input: 104811.23 toks/s, output: 102.35 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:04<00:00, 89.86it/s, est. speed input: 105216.53 toks/s, output: 102.75 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:04<00:00, 102.75it/s, est. speed input: 105216.53 toks/s, output: 102.75 toks/s]
[rank0]:[W128 08:46:56.235676084 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=8192 ==========
Time: 2026-01-28 08:46:58
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=1024, max_num_seqs=8
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 1024 --max-num-seqs 8 --max-model-len 1025 --max-num-batched-tokens 8192 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_INT8_py312_cu129_x86_64/cusparselt/2_8/json/BitNet-2B-INT8_M8192.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-28 08:47:08 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3330187) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3330187) WARNING 01-28 08:47:24 [backends.py:609] Failed to read file <frozen os>
Throughput: 91.05 requests/s, 93326.39 total tokens/s, 91.05 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024

STDERR:
[2026-01-28 08:47:08] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 08:47:08] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 08:47:08] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 08:47:08] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:47:08] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:47:08] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:47:08] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:47:08] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:47:08] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 08:47:08] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 08:47:08] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 08:47:08] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 08:47:08] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 08:47:08] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 08:47:15] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 08:47:15] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 08:47:15] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 08:47:15] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:47:15] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:47:15] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:47:15] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:47:15] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:47:15] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 08:47:15] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 08:47:15] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 08:47:15] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 08:47:15] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 08:47:15] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3330187) [2026-01-28 08:47:16] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3330187) [2026-01-28 08:47:16] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3330187) [2026-01-28 08:47:16] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3330187) [2026-01-28 08:47:16] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=3330187) [2026-01-28 08:47:16] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=3330187) [2026-01-28 08:47:16] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=3330187) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3330187) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.26it/s]
(EngineCore_DP0 pid=3330187) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.26it/s]
(EngineCore_DP0 pid=3330187) 
(EngineCore_DP0 pid=3330187) [2026-01-28 08:47:17] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 3840] -> 1D uint8
(EngineCore_DP0 pid=3330187) [2026-01-28 08:47:17] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9216000 bytes
(EngineCore_DP0 pid=3330187) [2026-01-28 08:47:17] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 3840] -> 1D uint8
(EngineCore_DP0 pid=3330187) [2026-01-28 08:47:17] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 6144000 bytes
(EngineCore_DP0 pid=3330187) [2026-01-28 08:47:17] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 3840] -> 1D uint8
(EngineCore_DP0 pid=3330187) [2026-01-28 08:47:17] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 33177600 bytes
(EngineCore_DP0 pid=3330187) [2026-01-28 08:47:17] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 10368] -> 1D uint8
(EngineCore_DP0 pid=3330187) [2026-01-28 08:47:17] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 16588800 bytes
(EngineCore_DP0 pid=3330187) 2026-01-28 08:47:35,020 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3330187) 2026-01-28 08:47:35,050 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3330187) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:00,  4.13it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  60%|██████    | 3/5 [00:00<00:00,  9.33it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00, 11.54it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00, 10.07it/s]
(EngineCore_DP0 pid=3330187) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 2/4 [00:00<00:00, 16.84it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00, 17.55it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00, 17.42it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   3%|▎         | 29/1024 [00:00<00:03, 289.69it/s]
Adding requests:   8%|▊         | 81/1024 [00:00<00:02, 423.19it/s]
Adding requests:  13%|█▎        | 132/1024 [00:00<00:01, 459.40it/s]
Adding requests:  18%|█▊        | 180/1024 [00:00<00:01, 467.43it/s]
Adding requests:  23%|██▎       | 232/1024 [00:00<00:01, 483.49it/s]
Adding requests:  28%|██▊       | 282/1024 [00:00<00:01, 488.51it/s]
Adding requests:  32%|███▏      | 331/1024 [00:00<00:01, 488.57it/s]
Adding requests:  37%|███▋      | 383/1024 [00:00<00:01, 493.90it/s]
Adding requests:  42%|████▏     | 434/1024 [00:00<00:01, 498.81it/s]
Adding requests:  47%|████▋     | 484/1024 [00:01<00:01, 496.11it/s]
Adding requests:  52%|█████▏    | 534/1024 [00:01<00:01, 482.28it/s]
Adding requests:  57%|█████▋    | 587/1024 [00:01<00:00, 495.30it/s]
Adding requests:  62%|██████▏   | 638/1024 [00:01<00:00, 498.25it/s]
Adding requests:  67%|██████▋   | 691/1024 [00:01<00:00, 507.05it/s]
Adding requests:  72%|███████▏  | 742/1024 [00:01<00:00, 507.33it/s]
Adding requests:  77%|███████▋  | 793/1024 [00:01<00:00, 507.30it/s]
Adding requests:  82%|████████▏ | 844/1024 [00:01<00:00, 498.58it/s]
Adding requests:  88%|████████▊ | 898/1024 [00:01<00:00, 508.58it/s]
Adding requests:  93%|█████████▎| 949/1024 [00:01<00:00, 508.66it/s]
Adding requests:  98%|█████████▊| 1002/1024 [00:02<00:00, 512.91it/s]
Adding requests: 100%|██████████| 1024/1024 [00:02<00:00, 493.81it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  18%|█▊        | 186/1024 [00:00<00:00, 1555.94it/s, est. speed input: 1593711.68 toks/s, output: 1556.05 toks/s]
Processed prompts:  33%|███▎      | 342/1024 [00:01<00:04, 165.10it/s, est. speed input: 197929.48 toks/s, output: 193.29 toks/s]   
Processed prompts:  40%|████      | 412/1024 [00:02<00:04, 135.19it/s, est. speed input: 165080.45 toks/s, output: 161.21 toks/s]
Processed prompts:  44%|████▍     | 454/1024 [00:02<00:04, 126.42it/s, est. speed input: 155750.50 toks/s, output: 152.10 toks/s]
Processed prompts:  47%|████▋     | 484/1024 [00:03<00:04, 117.71it/s, est. speed input: 148630.32 toks/s, output: 145.15 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:03<00:04, 111.48it/s, est. speed input: 144105.05 toks/s, output: 140.73 toks/s]
Processed prompts:  51%|█████     | 524/1024 [00:03<00:04, 110.20it/s, est. speed input: 142312.93 toks/s, output: 138.98 toks/s]
Processed prompts:  53%|█████▎    | 539/1024 [00:03<00:04, 105.90it/s, est. speed input: 139910.37 toks/s, output: 136.63 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:04<00:04, 101.78it/s, est. speed input: 137687.79 toks/s, output: 134.46 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:04<00:04, 99.43it/s, est. speed input: 135885.75 toks/s, output: 132.70 toks/s] 
Processed prompts:  57%|█████▋    | 586/1024 [00:04<00:04, 97.60it/s, est. speed input: 134256.67 toks/s, output: 131.11 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:04<00:04, 96.08it/s, est. speed input: 132738.85 toks/s, output: 129.63 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:04<00:04, 94.90it/s, est. speed input: 131332.52 toks/s, output: 128.25 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:04<00:04, 93.81it/s, est. speed input: 129988.30 toks/s, output: 126.94 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:05<00:04, 93.06it/s, est. speed input: 128745.96 toks/s, output: 125.73 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:05<00:03, 92.52it/s, est. speed input: 127584.92 toks/s, output: 124.59 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:05<00:03, 92.24it/s, est. speed input: 126513.46 toks/s, output: 123.55 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:05<00:03, 91.96it/s, est. speed input: 125497.83 toks/s, output: 122.56 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:05<00:03, 91.89it/s, est. speed input: 124558.67 toks/s, output: 121.64 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:06<00:03, 91.70it/s, est. speed input: 123656.25 toks/s, output: 120.76 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:06<00:03, 91.61it/s, est. speed input: 122809.92 toks/s, output: 119.93 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:06<00:02, 91.40it/s, est. speed input: 121992.27 toks/s, output: 119.13 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:06<00:02, 91.53it/s, est. speed input: 121251.34 toks/s, output: 118.41 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:06<00:02, 91.46it/s, est. speed input: 120530.02 toks/s, output: 117.70 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:06<00:02, 91.56it/s, est. speed input: 119862.08 toks/s, output: 117.05 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:07<00:02, 91.28it/s, est. speed input: 119188.44 toks/s, output: 116.39 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [00:07<00:01, 91.22it/s, est. speed input: 118562.87 toks/s, output: 115.78 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:07<00:01, 91.24it/s, est. speed input: 117972.18 toks/s, output: 115.21 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [00:07<00:01, 91.40it/s, est. speed input: 117424.54 toks/s, output: 114.67 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [00:07<00:01, 91.36it/s, est. speed input: 116884.71 toks/s, output: 114.14 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [00:07<00:01, 91.24it/s, est. speed input: 116360.77 toks/s, output: 113.63 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [00:08<00:01, 91.22it/s, est. speed input: 115865.38 toks/s, output: 113.15 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [00:08<00:00, 92.60it/s, est. speed input: 115513.53 toks/s, output: 112.81 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [00:08<00:00, 92.27it/s, est. speed input: 115063.86 toks/s, output: 112.37 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [00:08<00:00, 92.08it/s, est. speed input: 114636.56 toks/s, output: 111.95 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [00:08<00:00, 93.35it/s, est. speed input: 114338.46 toks/s, output: 111.66 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [00:09<00:00, 92.64it/s, est. speed input: 113925.72 toks/s, output: 111.26 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [00:09<00:00, 94.06it/s, est. speed input: 113675.08 toks/s, output: 111.01 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:09<00:00, 94.06it/s, est. speed input: 114340.47 toks/s, output: 111.66 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:09<00:00, 111.66it/s, est. speed input: 114340.47 toks/s, output: 111.66 toks/s]
[rank0]:[W128 08:47:48.881189283 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=16384 ==========
Time: 2026-01-28 08:47:50
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=2048, max_num_seqs=16
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 2048 --max-num-seqs 16 --max-model-len 1025 --max-num-batched-tokens 16384 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_INT8_py312_cu129_x86_64/cusparselt/2_8/json/BitNet-2B-INT8_M16384.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-28 08:48:05 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3331603) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3331603) WARNING 01-28 08:48:21 [backends.py:609] Failed to read file <frozen os>
Throughput: 94.77 requests/s, 97143.72 total tokens/s, 94.77 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048

STDERR:
[2026-01-28 08:48:05] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 08:48:05] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 08:48:05] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 08:48:05] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:48:05] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:48:05] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:48:05] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:48:05] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:48:05] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 08:48:05] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 08:48:05] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 08:48:05] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 08:48:05] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 08:48:05] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 08:48:12] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 08:48:12] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 08:48:12] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 08:48:12] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:48:12] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:48:12] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:48:12] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:48:12] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:48:12] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 08:48:12] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 08:48:12] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 08:48:12] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 08:48:12] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 08:48:12] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3331603) [2026-01-28 08:48:13] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3331603) [2026-01-28 08:48:13] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3331603) [2026-01-28 08:48:13] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3331603) [2026-01-28 08:48:13] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=3331603) [2026-01-28 08:48:13] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=3331603) [2026-01-28 08:48:13] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=3331603) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3331603) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.27it/s]
(EngineCore_DP0 pid=3331603) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.27it/s]
(EngineCore_DP0 pid=3331603) 
(EngineCore_DP0 pid=3331603) [2026-01-28 08:48:14] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 3840] -> 1D uint8
(EngineCore_DP0 pid=3331603) [2026-01-28 08:48:14] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9216000 bytes
(EngineCore_DP0 pid=3331603) [2026-01-28 08:48:14] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 3840] -> 1D uint8
(EngineCore_DP0 pid=3331603) [2026-01-28 08:48:14] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 6144000 bytes
(EngineCore_DP0 pid=3331603) [2026-01-28 08:48:14] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 3840] -> 1D uint8
(EngineCore_DP0 pid=3331603) [2026-01-28 08:48:14] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 33177600 bytes
(EngineCore_DP0 pid=3331603) [2026-01-28 08:48:14] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 10368] -> 1D uint8
(EngineCore_DP0 pid=3331603) [2026-01-28 08:48:14] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 16588800 bytes
(EngineCore_DP0 pid=3331603) 2026-01-28 08:48:31,917 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3331603) 2026-01-28 08:48:31,946 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3331603) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  29%|██▊       | 2/7 [00:00<00:00, 12.54it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  57%|█████▋    | 4/7 [00:00<00:00, 14.91it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  86%|████████▌ | 6/7 [00:00<00:00, 11.37it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00, 10.87it/s]
(EngineCore_DP0 pid=3331603) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  40%|████      | 2/5 [00:00<00:00, 13.22it/s]
Capturing CUDA graphs (decode, FULL):  80%|████████  | 4/5 [00:00<00:00, 15.45it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00, 15.48it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 33/2048 [00:00<00:06, 328.19it/s]
Adding requests:   4%|▍         | 84/2048 [00:00<00:04, 432.70it/s]
Adding requests:   7%|▋         | 134/2048 [00:00<00:04, 460.57it/s]
Adding requests:   9%|▉         | 183/2048 [00:00<00:03, 471.79it/s]
Adding requests:  11%|█▏        | 235/2048 [00:00<00:03, 487.21it/s]
Adding requests:  14%|█▍        | 286/2048 [00:00<00:03, 494.23it/s]
Adding requests:  16%|█▋        | 336/2048 [00:00<00:03, 493.89it/s]
Adding requests:  19%|█▉        | 388/2048 [00:00<00:03, 500.63it/s]
Adding requests:  21%|██▏       | 439/2048 [00:00<00:03, 503.11it/s]
Adding requests:  24%|██▍       | 490/2048 [00:01<00:03, 503.50it/s]
Adding requests:  26%|██▋       | 541/2048 [00:01<00:03, 495.59it/s]
Adding requests:  29%|██▉       | 594/2048 [00:01<00:02, 504.73it/s]
Adding requests:  32%|███▏      | 646/2048 [00:01<00:02, 506.80it/s]
Adding requests:  34%|███▍      | 700/2048 [00:01<00:02, 514.97it/s]
Adding requests:  37%|███▋      | 752/2048 [00:01<00:02, 506.19it/s]
Adding requests:  39%|███▉      | 803/2048 [00:01<00:02, 502.86it/s]
Adding requests:  42%|████▏     | 854/2048 [00:01<00:02, 470.35it/s]
Adding requests:  44%|████▍     | 904/2048 [00:01<00:02, 476.78it/s]
Adding requests:  47%|████▋     | 953/2048 [00:01<00:02, 473.60it/s]
Adding requests:  49%|████▉     | 1002/2048 [00:02<00:02, 476.76it/s]
Adding requests:  51%|█████▏    | 1052/2048 [00:02<00:02, 481.37it/s]
Adding requests:  54%|█████▍    | 1101/2048 [00:02<00:01, 482.06it/s]
Adding requests:  56%|█████▌    | 1151/2048 [00:02<00:01, 487.31it/s]
Adding requests:  59%|█████▉    | 1206/2048 [00:02<00:01, 503.97it/s]
Adding requests:  61%|██████▏   | 1257/2048 [00:02<00:01, 476.53it/s]
Adding requests:  64%|██████▍   | 1308/2048 [00:02<00:01, 485.07it/s]
Adding requests:  66%|██████▋   | 1360/2048 [00:02<00:01, 494.28it/s]
Adding requests:  69%|██████▉   | 1414/2048 [00:02<00:01, 505.08it/s]
Adding requests:  72%|███████▏  | 1466/2048 [00:02<00:01, 509.29it/s]
Adding requests:  74%|███████▍  | 1519/2048 [00:03<00:01, 513.58it/s]
Adding requests:  77%|███████▋  | 1572/2048 [00:03<00:00, 517.14it/s]
Adding requests:  79%|███████▉  | 1626/2048 [00:03<00:00, 522.44it/s]
Adding requests:  82%|████████▏ | 1679/2048 [00:03<00:00, 518.77it/s]
Adding requests:  85%|████████▍ | 1731/2048 [00:03<00:00, 518.39it/s]
Adding requests:  87%|████████▋ | 1783/2048 [00:03<00:00, 512.84it/s]
Adding requests:  90%|████████▉ | 1836/2048 [00:03<00:00, 516.50it/s]
Adding requests:  92%|█████████▏| 1888/2048 [00:03<00:00, 509.18it/s]
Adding requests:  95%|█████████▍| 1940/2048 [00:03<00:00, 509.41it/s]
Adding requests:  97%|█████████▋| 1992/2048 [00:04<00:00, 511.22it/s]
Adding requests: 100%|█████████▉| 2046/2048 [00:04<00:00, 517.52it/s]
Adding requests: 100%|██████████| 2048/2048 [00:04<00:00, 497.74it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [00:00<00:00, 2154.40it/s, est. speed input: 2206410.82 toks/s, output: 2154.49 toks/s]
Processed prompts:  29%|██▉       | 602/2048 [00:02<00:06, 210.87it/s, est. speed input: 261272.83 toks/s, output: 255.15 toks/s]   
Processed prompts:  34%|███▍      | 697/2048 [00:03<00:08, 165.94it/s, est. speed input: 211861.19 toks/s, output: 206.89 toks/s]
Processed prompts:  37%|███▋      | 753/2048 [00:03<00:08, 154.15it/s, est. speed input: 199108.34 toks/s, output: 194.44 toks/s]
Processed prompts:  39%|███▊      | 792/2048 [00:04<00:09, 136.00it/s, est. speed input: 185244.38 toks/s, output: 180.90 toks/s]
Processed prompts:  40%|████      | 820/2048 [00:04<00:09, 126.39it/s, est. speed input: 178138.30 toks/s, output: 173.96 toks/s]
Processed prompts:  41%|████      | 841/2048 [00:04<00:09, 126.20it/s, est. speed input: 176399.41 toks/s, output: 172.26 toks/s]
Processed prompts:  42%|████▏     | 860/2048 [00:05<00:09, 124.25it/s, est. speed input: 174354.48 toks/s, output: 170.27 toks/s]
Processed prompts:  43%|████▎     | 876/2048 [00:05<00:09, 119.26it/s, est. speed input: 171851.27 toks/s, output: 167.82 toks/s]
Processed prompts:  43%|████▎     | 890/2048 [00:05<00:10, 112.19it/s, est. speed input: 169126.07 toks/s, output: 165.16 toks/s]
Processed prompts:  44%|████▍     | 903/2048 [00:05<00:10, 104.70it/s, est. speed input: 166418.28 toks/s, output: 162.52 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [00:05<00:11, 95.24it/s, est. speed input: 163463.29 toks/s, output: 159.63 toks/s] 
Processed prompts:  45%|████▌     | 930/2048 [00:05<00:11, 96.37it/s, est. speed input: 161798.74 toks/s, output: 158.00 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [00:06<00:11, 95.90it/s, est. speed input: 159984.52 toks/s, output: 156.23 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [00:06<00:11, 95.60it/s, est. speed input: 158280.25 toks/s, output: 154.57 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [00:06<00:11, 96.80it/s, est. speed input: 156879.65 toks/s, output: 153.20 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [00:06<00:10, 96.43it/s, est. speed input: 155369.60 toks/s, output: 151.73 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [00:06<00:10, 95.90it/s, est. speed input: 153898.33 toks/s, output: 150.29 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [00:06<00:10, 95.57it/s, est. speed input: 152505.08 toks/s, output: 148.93 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [00:07<00:10, 95.33it/s, est. speed input: 151179.09 toks/s, output: 147.64 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [00:07<00:10, 95.03it/s, est. speed input: 149897.25 toks/s, output: 146.38 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [00:07<00:10, 95.02it/s, est. speed input: 148699.02 toks/s, output: 145.21 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [00:07<00:10, 94.90it/s, est. speed input: 147541.32 toks/s, output: 144.08 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [00:07<00:09, 94.81it/s, est. speed input: 146432.50 toks/s, output: 143.00 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [00:07<00:09, 94.88it/s, est. speed input: 145386.88 toks/s, output: 141.98 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [00:08<00:09, 94.75it/s, est. speed input: 144365.11 toks/s, output: 140.98 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [00:08<00:09, 96.45it/s, est. speed input: 143567.60 toks/s, output: 140.20 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [00:08<00:09, 96.09it/s, est. speed input: 142647.16 toks/s, output: 139.30 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [00:08<00:09, 95.65it/s, est. speed input: 141745.48 toks/s, output: 138.42 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [00:08<00:08, 95.41it/s, est. speed input: 140883.39 toks/s, output: 137.58 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [00:08<00:08, 94.99it/s, est. speed input: 140031.81 toks/s, output: 136.75 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [00:09<00:08, 94.87it/s, est. speed input: 139226.66 toks/s, output: 135.96 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [00:09<00:08, 94.80it/s, est. speed input: 138452.47 toks/s, output: 135.21 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [00:09<00:08, 96.49it/s, est. speed input: 137854.96 toks/s, output: 134.62 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [00:09<00:07, 95.82it/s, est. speed input: 137123.56 toks/s, output: 133.91 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [00:09<00:07, 95.58it/s, est. speed input: 136435.29 toks/s, output: 133.24 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [00:09<00:07, 95.17it/s, est. speed input: 135750.89 toks/s, output: 132.57 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [00:10<00:07, 95.12it/s, est. speed input: 135108.03 toks/s, output: 131.94 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [00:10<00:07, 94.91it/s, est. speed input: 134472.87 toks/s, output: 131.32 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [00:10<00:07, 95.02it/s, est. speed input: 133877.83 toks/s, output: 130.74 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [00:10<00:07, 94.80it/s, est. speed input: 133279.94 toks/s, output: 130.16 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [00:10<00:06, 94.85it/s, est. speed input: 132715.56 toks/s, output: 129.60 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [00:10<00:06, 94.61it/s, est. speed input: 132148.87 toks/s, output: 129.05 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [00:11<00:06, 94.56it/s, est. speed input: 131607.16 toks/s, output: 128.52 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [00:11<00:06, 94.54it/s, est. speed input: 131083.26 toks/s, output: 128.01 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [00:11<00:06, 94.57it/s, est. speed input: 130578.19 toks/s, output: 127.52 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [00:11<00:06, 94.47it/s, est. speed input: 130079.38 toks/s, output: 127.03 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [00:11<00:05, 94.49it/s, est. speed input: 129600.86 toks/s, output: 126.56 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [00:11<00:05, 94.49it/s, est. speed input: 129135.19 toks/s, output: 126.11 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [00:12<00:05, 94.50it/s, est. speed input: 128682.98 toks/s, output: 125.67 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [00:12<00:05, 94.64it/s, est. speed input: 128251.86 toks/s, output: 125.25 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [00:12<00:05, 94.59it/s, est. speed input: 127823.13 toks/s, output: 124.83 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [00:12<00:05, 94.76it/s, est. speed input: 127418.05 toks/s, output: 124.43 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [00:12<00:04, 96.12it/s, est. speed input: 127096.08 toks/s, output: 124.12 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [00:12<00:04, 95.50it/s, est. speed input: 126692.37 toks/s, output: 123.72 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [00:13<00:04, 95.15it/s, est. speed input: 126303.11 toks/s, output: 123.34 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [00:13<00:04, 95.08it/s, est. speed input: 125933.70 toks/s, output: 122.98 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [00:13<00:04, 94.89it/s, est. speed input: 125566.47 toks/s, output: 122.62 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [00:13<00:04, 94.70it/s, est. speed input: 125204.08 toks/s, output: 122.27 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [00:13<00:03, 94.68it/s, est. speed input: 124857.08 toks/s, output: 121.93 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [00:13<00:03, 94.58it/s, est. speed input: 124514.29 toks/s, output: 121.60 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [00:14<00:03, 94.43it/s, est. speed input: 124175.17 toks/s, output: 121.26 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [00:14<00:03, 94.50it/s, est. speed input: 123853.46 toks/s, output: 120.95 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [00:14<00:03, 94.50it/s, est. speed input: 123536.69 toks/s, output: 120.64 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [00:14<00:03, 94.47it/s, est. speed input: 123225.68 toks/s, output: 120.34 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [00:14<00:02, 94.49it/s, est. speed input: 122923.67 toks/s, output: 120.04 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [00:14<00:02, 94.65it/s, est. speed input: 122635.70 toks/s, output: 119.76 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [00:15<00:02, 94.47it/s, est. speed input: 122340.39 toks/s, output: 119.47 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [00:15<00:02, 94.65it/s, est. speed input: 122065.51 toks/s, output: 119.20 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [00:15<00:02, 94.37it/s, est. speed input: 121777.92 toks/s, output: 118.92 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [00:15<00:02, 94.45it/s, est. speed input: 121509.25 toks/s, output: 118.66 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [00:15<00:01, 95.94it/s, est. speed input: 121311.34 toks/s, output: 118.47 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [00:15<00:01, 95.34it/s, est. speed input: 121044.33 toks/s, output: 118.21 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [00:16<00:01, 95.08it/s, est. speed input: 120789.28 toks/s, output: 117.96 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [00:16<00:01, 94.87it/s, est. speed input: 120538.93 toks/s, output: 117.71 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [00:16<00:01, 94.66it/s, est. speed input: 120290.67 toks/s, output: 117.47 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [00:16<00:00, 96.09it/s, est. speed input: 120114.32 toks/s, output: 117.30 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [00:16<00:00, 95.60it/s, est. speed input: 119878.89 toks/s, output: 117.07 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [00:16<00:00, 95.21it/s, est. speed input: 119646.45 toks/s, output: 116.84 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [00:17<00:00, 95.07it/s, est. speed input: 119423.80 toks/s, output: 116.62 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [00:17<00:00, 95.13it/s, est. speed input: 119211.66 toks/s, output: 116.42 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [00:17<00:00, 96.90it/s, est. speed input: 119072.14 toks/s, output: 116.28 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:17<00:00, 96.90it/s, est. speed input: 119889.03 toks/s, output: 117.08 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:17<00:00, 117.08it/s, est. speed input: 119889.03 toks/s, output: 117.08 toks/s]
[rank0]:[W128 08:48:56.414928538 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=32768 ==========
Time: 2026-01-28 08:48:58
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=4096, max_num_seqs=32
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 4096 --max-num-seqs 32 --max-model-len 1025 --max-num-batched-tokens 32768 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_INT8_py312_cu129_x86_64/cusparselt/2_8/json/BitNet-2B-INT8_M32768.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-28 08:49:22 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3333125) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3333125) WARNING 01-28 08:49:37 [backends.py:609] Failed to read file <frozen os>
Throughput: 96.82 requests/s, 99237.19 total tokens/s, 96.82 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096

STDERR:
[2026-01-28 08:49:21] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 08:49:22] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 08:49:22] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 08:49:22] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:49:22] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:49:22] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:49:22] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:49:22] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:49:22] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 08:49:22] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 08:49:22] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 08:49:22] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 08:49:22] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 08:49:22] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 08:49:28] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 08:49:29] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 08:49:29] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 08:49:29] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:49:29] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:49:29] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:49:29] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:49:29] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 08:49:29] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 08:49:29] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 08:49:29] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 08:49:29] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 08:49:29] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 08:49:29] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3333125) [2026-01-28 08:49:30] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3333125) [2026-01-28 08:49:30] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3333125) [2026-01-28 08:49:30] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3333125) [2026-01-28 08:49:30] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=3333125) [2026-01-28 08:49:30] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=3333125) [2026-01-28 08:49:30] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=3333125) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3333125) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.27it/s]
(EngineCore_DP0 pid=3333125) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.27it/s]
(EngineCore_DP0 pid=3333125) 
(EngineCore_DP0 pid=3333125) [2026-01-28 08:49:31] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 3840] -> 1D uint8
(EngineCore_DP0 pid=3333125) [2026-01-28 08:49:31] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9216000 bytes
(EngineCore_DP0 pid=3333125) [2026-01-28 08:49:31] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 3840] -> 1D uint8
(EngineCore_DP0 pid=3333125) [2026-01-28 08:49:31] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 6144000 bytes
(EngineCore_DP0 pid=3333125) [2026-01-28 08:49:31] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 3840] -> 1D uint8
(EngineCore_DP0 pid=3333125) [2026-01-28 08:49:31] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 33177600 bytes
(EngineCore_DP0 pid=3333125) [2026-01-28 08:49:31] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 10368] -> 1D uint8
(EngineCore_DP0 pid=3333125) [2026-01-28 08:49:31] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 16588800 bytes
(EngineCore_DP0 pid=3333125) [rank0]:W0128 08:49:43.897000 3333125 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=3333125) [rank0]:W0128 08:49:43.979000 3333125 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=3333125) [rank0]:W0128 08:49:45.156000 3333125 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=3333125) [rank0]:W0128 08:49:45.319000 3333125 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=3333125) 2026-01-28 08:49:49,206 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3333125) 2026-01-28 08:49:49,241 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3333125) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   9%|▉         | 1/11 [00:00<00:02,  4.68it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  27%|██▋       | 3/11 [00:00<00:00,  9.35it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  45%|████▌     | 5/11 [00:00<00:00, 12.08it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  64%|██████▎   | 7/11 [00:00<00:00, 13.90it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  82%|████████▏ | 9/11 [00:00<00:00, 15.09it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:00<00:00, 14.99it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:00<00:00, 13.16it/s]
(EngineCore_DP0 pid=3333125) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  29%|██▊       | 2/7 [00:00<00:00, 16.69it/s]
Capturing CUDA graphs (decode, FULL):  57%|█████▋    | 4/7 [00:00<00:00, 17.49it/s]
Capturing CUDA graphs (decode, FULL):  86%|████████▌ | 6/7 [00:00<00:00, 17.73it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00, 17.65it/s]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   1%|          | 49/4096 [00:00<00:08, 488.92it/s]
Adding requests:   2%|▏         | 99/4096 [00:00<00:08, 492.00it/s]
Adding requests:   4%|▎         | 149/4096 [00:00<00:07, 493.50it/s]
Adding requests:   5%|▍         | 199/4096 [00:00<00:07, 495.36it/s]
Adding requests:   6%|▌         | 251/4096 [00:00<00:07, 504.10it/s]
Adding requests:   7%|▋         | 302/4096 [00:00<00:07, 499.73it/s]
Adding requests:   9%|▊         | 354/4096 [00:00<00:07, 505.54it/s]
Adding requests:  10%|▉         | 405/4096 [00:00<00:07, 506.40it/s]
Adding requests:  11%|█         | 456/4096 [00:00<00:07, 507.10it/s]
Adding requests:  12%|█▏        | 507/4096 [00:01<00:07, 504.48it/s]
Adding requests:  14%|█▎        | 558/4096 [00:01<00:07, 500.89it/s]
Adding requests:  15%|█▍        | 609/4096 [00:01<00:06, 502.48it/s]
Adding requests:  16%|█▌        | 662/4096 [00:01<00:06, 509.28it/s]
Adding requests:  17%|█▋        | 716/4096 [00:01<00:06, 515.34it/s]
Adding requests:  19%|█▉        | 768/4096 [00:01<00:06, 513.35it/s]
Adding requests:  20%|██        | 820/4096 [00:01<00:06, 502.59it/s]
Adding requests:  21%|██▏       | 871/4096 [00:01<00:06, 502.74it/s]
Adding requests:  23%|██▎       | 924/4096 [00:01<00:06, 508.16it/s]
Adding requests:  24%|██▍       | 976/4096 [00:01<00:06, 510.13it/s]
Adding requests:  25%|██▌       | 1028/4096 [00:02<00:06, 507.63it/s]
Adding requests:  26%|██▋       | 1079/4096 [00:02<00:06, 498.28it/s]
Adding requests:  28%|██▊       | 1129/4096 [00:02<00:05, 498.20it/s]
Adding requests:  29%|██▉       | 1182/4096 [00:02<00:05, 506.64it/s]
Adding requests:  30%|███       | 1234/4096 [00:02<00:05, 508.91it/s]
Adding requests:  31%|███▏      | 1285/4096 [00:02<00:05, 498.47it/s]
Adding requests:  33%|███▎      | 1337/4096 [00:02<00:05, 501.64it/s]
Adding requests:  34%|███▍      | 1389/4096 [00:02<00:05, 505.76it/s]
Adding requests:  35%|███▌      | 1441/4096 [00:02<00:05, 507.30it/s]
Adding requests:  36%|███▋      | 1494/4096 [00:02<00:05, 511.67it/s]
Adding requests:  38%|███▊      | 1546/4096 [00:03<00:04, 512.60it/s]
Adding requests:  39%|███▉      | 1599/4096 [00:03<00:04, 516.59it/s]
Adding requests:  40%|████      | 1652/4096 [00:03<00:04, 518.36it/s]
Adding requests:  42%|████▏     | 1704/4096 [00:03<00:04, 508.32it/s]
Adding requests:  43%|████▎     | 1755/4096 [00:03<00:04, 508.76it/s]
Adding requests:  44%|████▍     | 1807/4096 [00:03<00:04, 510.48it/s]
Adding requests:  45%|████▌     | 1859/4096 [00:03<00:04, 511.84it/s]
Adding requests:  47%|████▋     | 1911/4096 [00:03<00:04, 508.63it/s]
Adding requests:  48%|████▊     | 1962/4096 [00:03<00:04, 508.55it/s]
Adding requests:  49%|████▉     | 2014/4096 [00:03<00:04, 510.16it/s]
Adding requests:  50%|█████     | 2066/4096 [00:04<00:03, 512.26it/s]
Adding requests:  52%|█████▏    | 2118/4096 [00:04<00:03, 512.90it/s]
Adding requests:  53%|█████▎    | 2170/4096 [00:04<00:03, 504.75it/s]
Adding requests:  54%|█████▍    | 2221/4096 [00:04<00:03, 505.07it/s]
Adding requests:  55%|█████▌    | 2272/4096 [00:04<00:03, 496.28it/s]
Adding requests:  57%|█████▋    | 2323/4096 [00:04<00:03, 499.96it/s]
Adding requests:  58%|█████▊    | 2374/4096 [00:04<00:03, 500.96it/s]
Adding requests:  59%|█████▉    | 2425/4096 [00:04<00:03, 503.04it/s]
Adding requests:  60%|██████    | 2476/4096 [00:04<00:03, 503.33it/s]
Adding requests:  62%|██████▏   | 2527/4096 [00:04<00:03, 502.38it/s]
Adding requests:  63%|██████▎   | 2580/4096 [00:05<00:02, 509.90it/s]
Adding requests:  64%|██████▍   | 2632/4096 [00:05<00:02, 506.37it/s]
Adding requests:  66%|██████▌   | 2684/4096 [00:05<00:02, 508.08it/s]
Adding requests:  67%|██████▋   | 2735/4096 [00:05<00:02, 503.51it/s]
Adding requests:  68%|██████▊   | 2786/4096 [00:05<00:02, 504.75it/s]
Adding requests:  69%|██████▉   | 2837/4096 [00:05<00:02, 501.31it/s]
Adding requests:  71%|███████   | 2890/4096 [00:05<00:02, 508.31it/s]
Adding requests:  72%|███████▏  | 2941/4096 [00:05<00:02, 500.90it/s]
Adding requests:  73%|███████▎  | 2993/4096 [00:05<00:02, 504.26it/s]
Adding requests:  74%|███████▍  | 3044/4096 [00:06<00:02, 501.38it/s]
Adding requests:  76%|███████▌  | 3095/4096 [00:06<00:01, 500.80it/s]
Adding requests:  77%|███████▋  | 3146/4096 [00:06<00:01, 500.62it/s]
Adding requests:  78%|███████▊  | 3197/4096 [00:06<00:01, 502.38it/s]
Adding requests:  79%|███████▉  | 3250/4096 [00:06<00:01, 509.37it/s]
Adding requests:  81%|████████  | 3301/4096 [00:06<00:01, 508.59it/s]
Adding requests:  82%|████████▏ | 3352/4096 [00:06<00:01, 506.34it/s]
Adding requests:  83%|████████▎ | 3403/4096 [00:06<00:01, 505.98it/s]
Adding requests:  84%|████████▍ | 3454/4096 [00:06<00:01, 506.06it/s]
Adding requests:  86%|████████▌ | 3505/4096 [00:06<00:01, 501.83it/s]
Adding requests:  87%|████████▋ | 3556/4096 [00:07<00:01, 503.94it/s]
Adding requests:  88%|████████▊ | 3607/4096 [00:07<00:00, 492.10it/s]
Adding requests:  89%|████████▉ | 3657/4096 [00:07<00:00, 493.24it/s]
Adding requests:  91%|█████████ | 3709/4096 [00:07<00:00, 500.48it/s]
Adding requests:  92%|█████████▏| 3760/4096 [00:07<00:00, 502.14it/s]
Adding requests:  93%|█████████▎| 3813/4096 [00:07<00:00, 508.17it/s]
Adding requests:  94%|█████████▍| 3866/4096 [00:07<00:00, 512.81it/s]
Adding requests:  96%|█████████▌| 3918/4096 [00:07<00:00, 512.49it/s]
Adding requests:  97%|█████████▋| 3970/4096 [00:07<00:00, 507.60it/s]
Adding requests:  98%|█████████▊| 4022/4096 [00:07<00:00, 509.99it/s]
Adding requests:  99%|█████████▉| 4074/4096 [00:08<00:00, 503.38it/s]
Adding requests: 100%|██████████| 4096/4096 [00:08<00:00, 505.42it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  19%|█▉        | 770/4096 [00:00<00:01, 2660.44it/s, est. speed input: 2724512.37 toks/s, output: 2660.50 toks/s]
Processed prompts:  25%|██▌       | 1037/4096 [00:02<00:10, 285.35it/s, est. speed input: 364728.66 toks/s, output: 356.18 toks/s]  
Processed prompts:  28%|██▊       | 1153/4096 [00:03<00:12, 229.05it/s, est. speed input: 302436.99 toks/s, output: 295.35 toks/s]
Processed prompts:  30%|██▉       | 1222/4096 [00:04<00:16, 178.04it/s, est. speed input: 256050.68 toks/s, output: 250.05 toks/s]
Processed prompts:  31%|███       | 1266/4096 [00:05<00:16, 172.62it/s, est. speed input: 248866.98 toks/s, output: 243.03 toks/s]
Processed prompts:  32%|███▏      | 1300/4096 [00:05<00:17, 161.21it/s, est. speed input: 240193.01 toks/s, output: 234.56 toks/s]
Processed prompts:  32%|███▏      | 1326/4096 [00:05<00:18, 145.86it/s, est. speed input: 231229.22 toks/s, output: 225.81 toks/s]
Processed prompts:  33%|███▎      | 1346/4096 [00:06<00:21, 127.90it/s, est. speed input: 222212.65 toks/s, output: 217.00 toks/s]
Processed prompts:  34%|███▎      | 1378/4096 [00:06<00:22, 120.62it/s, est. speed input: 215950.94 toks/s, output: 210.89 toks/s]
Processed prompts:  34%|███▍      | 1410/4096 [00:06<00:23, 114.76it/s, est. speed input: 210342.94 toks/s, output: 205.41 toks/s]
Processed prompts:  35%|███▌      | 1442/4096 [00:07<00:24, 110.00it/s, est. speed input: 205212.97 toks/s, output: 200.40 toks/s]
Processed prompts:  36%|███▌      | 1474/4096 [00:07<00:24, 106.37it/s, est. speed input: 200540.49 toks/s, output: 195.84 toks/s]
Processed prompts:  37%|███▋      | 1506/4096 [00:07<00:24, 103.78it/s, est. speed input: 196299.87 toks/s, output: 191.70 toks/s]
Processed prompts:  38%|███▊      | 1538/4096 [00:08<00:25, 101.68it/s, est. speed input: 192346.72 toks/s, output: 187.84 toks/s]
Processed prompts:  38%|███▊      | 1570/4096 [00:08<00:24, 101.05it/s, est. speed input: 188925.60 toks/s, output: 184.50 toks/s]
Processed prompts:  39%|███▉      | 1602/4096 [00:08<00:24, 99.84it/s, est. speed input: 185577.93 toks/s, output: 181.23 toks/s] 
Processed prompts:  40%|███▉      | 1634/4096 [00:09<00:24, 98.85it/s, est. speed input: 182439.63 toks/s, output: 178.16 toks/s]
Processed prompts:  41%|████      | 1666/4096 [00:09<00:24, 98.08it/s, est. speed input: 179506.58 toks/s, output: 175.30 toks/s]
Processed prompts:  41%|████▏     | 1698/4096 [00:09<00:24, 97.58it/s, est. speed input: 176781.16 toks/s, output: 172.64 toks/s]
Processed prompts:  42%|████▏     | 1730/4096 [00:10<00:24, 97.36it/s, est. speed input: 174257.66 toks/s, output: 170.17 toks/s]
Processed prompts:  43%|████▎     | 1762/4096 [00:10<00:24, 97.01it/s, est. speed input: 171857.34 toks/s, output: 167.83 toks/s]
Processed prompts:  44%|████▍     | 1794/4096 [00:10<00:23, 96.88it/s, est. speed input: 169624.32 toks/s, output: 165.65 toks/s]
Processed prompts:  45%|████▍     | 1826/4096 [00:11<00:23, 96.80it/s, est. speed input: 167526.74 toks/s, output: 163.60 toks/s]
Processed prompts:  45%|████▌     | 1858/4096 [00:11<00:22, 97.58it/s, est. speed input: 165686.53 toks/s, output: 161.80 toks/s]
Processed prompts:  46%|████▌     | 1890/4096 [00:11<00:22, 97.35it/s, est. speed input: 163824.32 toks/s, output: 159.98 toks/s]
Processed prompts:  47%|████▋     | 1922/4096 [00:12<00:22, 97.26it/s, est. speed input: 162075.15 toks/s, output: 158.28 toks/s]
Processed prompts:  48%|████▊     | 1954/4096 [00:12<00:21, 98.06it/s, est. speed input: 160542.20 toks/s, output: 156.78 toks/s]
Processed prompts:  48%|████▊     | 1986/4096 [00:12<00:21, 97.66it/s, est. speed input: 158952.28 toks/s, output: 155.23 toks/s]
Processed prompts:  49%|████▉     | 2018/4096 [00:13<00:21, 97.47it/s, est. speed input: 157455.03 toks/s, output: 153.76 toks/s]
Processed prompts:  50%|█████     | 2050/4096 [00:13<00:21, 96.78it/s, est. speed input: 155956.77 toks/s, output: 152.30 toks/s]
Processed prompts:  51%|█████     | 2082/4096 [00:13<00:20, 97.11it/s, est. speed input: 154635.88 toks/s, output: 151.01 toks/s]
Processed prompts:  52%|█████▏    | 2114/4096 [00:14<00:20, 97.04it/s, est. speed input: 153339.86 toks/s, output: 149.75 toks/s]
Processed prompts:  52%|█████▏    | 2146/4096 [00:14<00:20, 96.94it/s, est. speed input: 152095.71 toks/s, output: 148.53 toks/s]
Processed prompts:  53%|█████▎    | 2178/4096 [00:14<00:19, 96.90it/s, est. speed input: 150910.30 toks/s, output: 147.37 toks/s]
Processed prompts:  54%|█████▍    | 2210/4096 [00:15<00:19, 98.54it/s, est. speed input: 149962.46 toks/s, output: 146.45 toks/s]
Processed prompts:  55%|█████▍    | 2242/4096 [00:15<00:18, 97.88it/s, est. speed input: 148858.64 toks/s, output: 145.37 toks/s]
Processed prompts:  56%|█████▌    | 2274/4096 [00:15<00:18, 98.59it/s, est. speed input: 147922.79 toks/s, output: 144.46 toks/s]
Processed prompts:  56%|█████▋    | 2306/4096 [00:16<00:18, 98.03it/s, est. speed input: 146917.27 toks/s, output: 143.47 toks/s]
Processed prompts:  57%|█████▋    | 2338/4096 [00:16<00:17, 98.47it/s, est. speed input: 146034.31 toks/s, output: 142.61 toks/s]
Processed prompts:  58%|█████▊    | 2370/4096 [00:16<00:17, 99.98it/s, est. speed input: 145298.41 toks/s, output: 141.89 toks/s]
Processed prompts:  59%|█████▊    | 2402/4096 [00:17<00:17, 98.87it/s, est. speed input: 144389.42 toks/s, output: 141.01 toks/s]
Processed prompts:  59%|█████▉    | 2434/4096 [00:17<00:16, 98.18it/s, est. speed input: 143522.13 toks/s, output: 140.16 toks/s]
Processed prompts:  60%|██████    | 2466/4096 [00:17<00:16, 97.82it/s, est. speed input: 142698.14 toks/s, output: 139.35 toks/s]
Processed prompts:  61%|██████    | 2498/4096 [00:18<00:16, 98.34it/s, est. speed input: 141971.69 toks/s, output: 138.64 toks/s]
Processed prompts:  62%|██████▏   | 2530/4096 [00:18<00:16, 97.84it/s, est. speed input: 141196.81 toks/s, output: 137.89 toks/s]
Processed prompts:  63%|██████▎   | 2562/4096 [00:18<00:15, 98.22it/s, est. speed input: 140509.95 toks/s, output: 137.22 toks/s]
Processed prompts:  63%|██████▎   | 2594/4096 [00:19<00:15, 97.76it/s, est. speed input: 139787.68 toks/s, output: 136.51 toks/s]
Processed prompts:  64%|██████▍   | 2626/4096 [00:19<00:15, 97.46it/s, est. speed input: 139091.71 toks/s, output: 135.83 toks/s]
Processed prompts:  65%|██████▍   | 2658/4096 [00:19<00:14, 97.12it/s, est. speed input: 138408.47 toks/s, output: 135.16 toks/s]
Processed prompts:  66%|██████▌   | 2690/4096 [00:19<00:14, 97.04it/s, est. speed input: 137759.96 toks/s, output: 134.53 toks/s]
Processed prompts:  66%|██████▋   | 2722/4096 [00:20<00:14, 97.02it/s, est. speed input: 137136.36 toks/s, output: 133.92 toks/s]
Processed prompts:  67%|██████▋   | 2754/4096 [00:20<00:13, 96.92it/s, est. speed input: 136525.16 toks/s, output: 133.32 toks/s]
Processed prompts:  68%|██████▊   | 2786/4096 [00:20<00:13, 96.82it/s, est. speed input: 135930.83 toks/s, output: 132.74 toks/s]
Processed prompts:  69%|██████▉   | 2818/4096 [00:21<00:13, 96.71it/s, est. speed input: 135352.27 toks/s, output: 132.18 toks/s]
Processed prompts:  70%|██████▉   | 2850/4096 [00:21<00:12, 96.66it/s, est. speed input: 134793.72 toks/s, output: 131.63 toks/s]
Processed prompts:  70%|███████   | 2882/4096 [00:21<00:12, 96.60it/s, est. speed input: 134250.15 toks/s, output: 131.10 toks/s]
Processed prompts:  71%|███████   | 2914/4096 [00:22<00:12, 96.59it/s, est. speed input: 133724.83 toks/s, output: 130.59 toks/s]
Processed prompts:  72%|███████▏  | 2946/4096 [00:22<00:11, 96.57it/s, est. speed input: 133214.59 toks/s, output: 130.09 toks/s]
Processed prompts:  73%|███████▎  | 2978/4096 [00:22<00:11, 96.55it/s, est. speed input: 132717.96 toks/s, output: 129.61 toks/s]
Processed prompts:  73%|███████▎  | 3010/4096 [00:23<00:11, 96.65it/s, est. speed input: 132242.85 toks/s, output: 129.14 toks/s]
Processed prompts:  74%|███████▍  | 3042/4096 [00:23<00:10, 96.53it/s, est. speed input: 131769.41 toks/s, output: 128.68 toks/s]
Processed prompts:  75%|███████▌  | 3074/4096 [00:23<00:10, 96.44it/s, est. speed input: 131308.34 toks/s, output: 128.23 toks/s]
Processed prompts:  76%|███████▌  | 3106/4096 [00:24<00:10, 96.49it/s, est. speed input: 130866.87 toks/s, output: 127.80 toks/s]
Processed prompts:  77%|███████▋  | 3138/4096 [00:24<00:09, 97.29it/s, est. speed input: 130483.71 toks/s, output: 127.43 toks/s]
Processed prompts:  77%|███████▋  | 3170/4096 [00:24<00:09, 96.93it/s, est. speed input: 130055.76 toks/s, output: 127.01 toks/s]
Processed prompts:  78%|███████▊  | 3202/4096 [00:25<00:09, 96.84it/s, est. speed input: 129648.44 toks/s, output: 126.61 toks/s]
Processed prompts:  79%|███████▉  | 3234/4096 [00:25<00:08, 96.58it/s, est. speed input: 129240.19 toks/s, output: 126.21 toks/s]
Processed prompts:  80%|███████▉  | 3266/4096 [00:25<00:08, 96.38it/s, est. speed input: 128841.45 toks/s, output: 125.82 toks/s]
Processed prompts:  81%|████████  | 3298/4096 [00:26<00:08, 96.51it/s, est. speed input: 128468.27 toks/s, output: 125.46 toks/s]
Processed prompts:  81%|████████▏ | 3330/4096 [00:26<00:07, 96.45it/s, est. speed input: 128095.74 toks/s, output: 125.09 toks/s]
Processed prompts:  82%|████████▏ | 3362/4096 [00:26<00:07, 96.50it/s, est. speed input: 127737.57 toks/s, output: 124.74 toks/s]
Processed prompts:  83%|████████▎ | 3394/4096 [00:27<00:07, 96.57it/s, est. speed input: 127389.26 toks/s, output: 124.40 toks/s]
Processed prompts:  84%|████████▎ | 3426/4096 [00:27<00:06, 96.54it/s, est. speed input: 127045.97 toks/s, output: 124.07 toks/s]
Processed prompts:  84%|████████▍ | 3458/4096 [00:27<00:06, 96.63it/s, est. speed input: 126715.95 toks/s, output: 123.75 toks/s]
Processed prompts:  85%|████████▌ | 3490/4096 [00:28<00:06, 98.23it/s, est. speed input: 126471.26 toks/s, output: 123.51 toks/s]
Processed prompts:  86%|████████▌ | 3522/4096 [00:28<00:05, 97.76it/s, est. speed input: 126153.49 toks/s, output: 123.20 toks/s]
Processed prompts:  87%|████████▋ | 3554/4096 [00:28<00:05, 97.22it/s, est. speed input: 125832.00 toks/s, output: 122.88 toks/s]
Processed prompts:  88%|████████▊ | 3586/4096 [00:29<00:05, 97.01it/s, est. speed input: 125526.18 toks/s, output: 122.58 toks/s]
Processed prompts:  88%|████████▊ | 3618/4096 [00:29<00:04, 96.83it/s, est. speed input: 125225.66 toks/s, output: 122.29 toks/s]
Processed prompts:  89%|████████▉ | 3650/4096 [00:29<00:04, 96.28it/s, est. speed input: 124911.15 toks/s, output: 121.98 toks/s]
Processed prompts:  90%|████████▉ | 3682/4096 [00:30<00:04, 96.37it/s, est. speed input: 124626.32 toks/s, output: 121.71 toks/s]
Processed prompts:  91%|█████████ | 3714/4096 [00:30<00:03, 97.39it/s, est. speed input: 124391.55 toks/s, output: 121.48 toks/s]
Processed prompts:  91%|█████████▏| 3746/4096 [00:30<00:03, 97.00it/s, est. speed input: 124111.77 toks/s, output: 121.20 toks/s]
Processed prompts:  92%|█████████▏| 3778/4096 [00:31<00:03, 96.73it/s, est. speed input: 123837.70 toks/s, output: 120.94 toks/s]
Processed prompts:  93%|█████████▎| 3810/4096 [00:31<00:02, 96.70it/s, est. speed input: 123576.54 toks/s, output: 120.68 toks/s]
Processed prompts:  94%|█████████▍| 3842/4096 [00:31<00:02, 97.32it/s, est. speed input: 123349.23 toks/s, output: 120.46 toks/s]
Processed prompts:  95%|█████████▍| 3874/4096 [00:32<00:02, 97.13it/s, est. speed input: 123099.06 toks/s, output: 120.21 toks/s]
Processed prompts:  95%|█████████▌| 3906/4096 [00:32<00:01, 96.98it/s, est. speed input: 122853.54 toks/s, output: 119.97 toks/s]
Processed prompts:  96%|█████████▌| 3938/4096 [00:32<00:01, 96.59it/s, est. speed input: 122600.91 toks/s, output: 119.73 toks/s]
Processed prompts:  97%|█████████▋| 3970/4096 [00:33<00:01, 96.50it/s, est. speed input: 122360.81 toks/s, output: 119.49 toks/s]
Processed prompts:  98%|█████████▊| 4002/4096 [00:33<00:00, 96.44it/s, est. speed input: 122125.40 toks/s, output: 119.26 toks/s]
Processed prompts:  98%|█████████▊| 4034/4096 [00:33<00:00, 97.08it/s, est. speed input: 121922.94 toks/s, output: 119.07 toks/s]
Processed prompts:  99%|█████████▉| 4066/4096 [00:34<00:00, 98.05it/s, est. speed input: 121744.57 toks/s, output: 118.89 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [00:34<00:00, 98.05it/s, est. speed input: 122639.58 toks/s, output: 119.77 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [00:34<00:00, 119.76it/s, est. speed input: 122639.58 toks/s, output: 119.77 toks/s]
[rank0]:[W128 08:50:34.713495388 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

