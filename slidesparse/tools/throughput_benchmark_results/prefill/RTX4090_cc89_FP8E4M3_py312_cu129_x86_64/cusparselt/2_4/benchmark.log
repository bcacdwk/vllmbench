
========== M=16 ==========
Time: 2026-01-25 17:25:09
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-FP8-SlideSparse-2_4
Params: prompt_len=16, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-FP8-SlideSparse-2_4 --dataset-name random --input-len 16 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 17 --max-num-batched-tokens 17 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_4/json/Llama3.2-1B-FP8_M16.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 17:25:16 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 17:25:17 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=187225) WARNING 01-25 17:25:35 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=187225) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=187225) WARNING 01-25 17:25:44 [backends.py:609] Failed to read file <frozen os>
Throughput: 13.77 requests/s, 234.17 total tokens/s, 13.77 output tokens/s
Total num prompt tokens:  2048
Total num output tokens:  128

STDERR:
[2026-01-25 17:25:16] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:25:16] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-FP8'
[2026-01-25 17:25:16] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-FP8
[2026-01-25 17:25:16] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 17:25:16] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 17:25:16] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 17:25:16] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 17:25:16] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 17:25:16] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-FP8'
[2026-01-25 17:25:16] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:25:16] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:25:16] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:25:16] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:25:16] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 17:25:25] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:25:25] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-FP8'
[2026-01-25 17:25:25] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-FP8
[2026-01-25 17:25:25] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 17:25:25] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 17:25:25] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 17:25:25] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 17:25:25] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 17:25:25] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-FP8'
[2026-01-25 17:25:25] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:25:25] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:25:25] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:25:25] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:25:25] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[W125 17:25:35.480718087 socket.cpp:209] [c10d] The hostname of the client socket cannot be retrieved. err=-3
(EngineCore_DP0 pid=187225) [2026-01-25 17:25:36] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=187225) [2026-01-25 17:25:36] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=187225) [2026-01-25 17:25:36] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=187225) [2026-01-25 17:25:36] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=187225) [2026-01-25 17:25:36] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Llama3.2-1B-FP8
(EngineCore_DP0 pid=187225) [2026-01-25 17:25:36] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=187225) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=187225) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:01<00:00,  1.59s/it]
(EngineCore_DP0 pid=187225) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:01<00:00,  1.59s/it]
(EngineCore_DP0 pid=187225) 
(EngineCore_DP0 pid=187225) [2026-01-25 17:25:38] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 2048] -> 1D uint8
(EngineCore_DP0 pid=187225) [2026-01-25 17:25:38] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 4718592 bytes
(EngineCore_DP0 pid=187225) [2026-01-25 17:25:38] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2048, 2048] -> 1D uint8
(EngineCore_DP0 pid=187225) [2026-01-25 17:25:38] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 3145728 bytes
(EngineCore_DP0 pid=187225) [2026-01-25 17:25:38] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [16384, 2048] -> 1D uint8
(EngineCore_DP0 pid=187225) [2026-01-25 17:25:38] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 25165824 bytes
(EngineCore_DP0 pid=187225) [2026-01-25 17:25:38] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2048, 8192] -> 1D uint8
(EngineCore_DP0 pid=187225) [2026-01-25 17:25:38] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12582912 bytes
(EngineCore_DP0 pid=187225) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  9.19it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  3.72it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  4.08it/s]
(EngineCore_DP0 pid=187225) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.74it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.73it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 2224.95it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:41,  3.07it/s, est. speed input: 49.11 toks/s, output: 3.07 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:17,  7.18it/s, est. speed input: 101.29 toks/s, output: 6.33 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:12,  9.46it/s, est. speed input: 128.71 toks/s, output: 8.04 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:11, 10.93it/s, est. speed input: 146.23 toks/s, output: 9.14 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:00<00:09, 11.95it/s, est. speed input: 158.68 toks/s, output: 9.92 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:01<00:09, 12.27it/s, est. speed input: 165.65 toks/s, output: 10.35 toks/s]
Processed prompts:  10%|█         | 13/128 [00:01<00:08, 12.78it/s, est. speed input: 172.50 toks/s, output: 10.78 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:01<00:08, 13.03it/s, est. speed input: 177.39 toks/s, output: 11.09 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:01<00:08, 13.01it/s, est. speed input: 180.46 toks/s, output: 11.28 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:01<00:08, 13.20it/s, est. speed input: 183.82 toks/s, output: 11.49 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:01<00:08, 13.36it/s, est. speed input: 186.74 toks/s, output: 11.67 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:01<00:07, 13.53it/s, est. speed input: 189.39 toks/s, output: 11.84 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:02<00:07, 13.69it/s, est. speed input: 191.82 toks/s, output: 11.99 toks/s]
Processed prompts:  21%|██        | 27/128 [00:02<00:07, 13.97it/s, est. speed input: 194.46 toks/s, output: 12.15 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:02<00:06, 14.15it/s, est. speed input: 196.71 toks/s, output: 12.29 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:02<00:06, 14.24it/s, est. speed input: 198.64 toks/s, output: 12.42 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:02<00:06, 14.13it/s, est. speed input: 199.91 toks/s, output: 12.49 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:02<00:06, 14.14it/s, est. speed input: 201.27 toks/s, output: 12.58 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:02<00:06, 14.44it/s, est. speed input: 203.15 toks/s, output: 12.70 toks/s]
Processed prompts:  30%|███       | 39/128 [00:03<00:06, 14.68it/s, est. speed input: 204.92 toks/s, output: 12.81 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:03<00:05, 14.86it/s, est. speed input: 206.55 toks/s, output: 12.91 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:03<00:05, 15.00it/s, est. speed input: 208.08 toks/s, output: 13.01 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:03<00:05, 15.16it/s, est. speed input: 209.62 toks/s, output: 13.10 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:03<00:05, 15.01it/s, est. speed input: 210.57 toks/s, output: 13.16 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:03<00:05, 14.99it/s, est. speed input: 211.61 toks/s, output: 13.23 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:03<00:05, 15.05it/s, est. speed input: 212.68 toks/s, output: 13.29 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:03<00:04, 15.11it/s, est. speed input: 213.72 toks/s, output: 13.36 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:04<00:04, 15.16it/s, est. speed input: 214.71 toks/s, output: 13.42 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:04<00:04, 15.18it/s, est. speed input: 215.60 toks/s, output: 13.47 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:04<00:04, 15.28it/s, est. speed input: 216.57 toks/s, output: 13.54 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:04<00:04, 15.30it/s, est. speed input: 217.40 toks/s, output: 13.59 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:04<00:04, 15.28it/s, est. speed input: 218.15 toks/s, output: 13.63 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:04<00:04, 15.14it/s, est. speed input: 218.69 toks/s, output: 13.67 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:04<00:04, 15.12it/s, est. speed input: 219.30 toks/s, output: 13.71 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:05<00:03, 15.15it/s, est. speed input: 219.94 toks/s, output: 13.75 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:05<00:03, 15.20it/s, est. speed input: 220.58 toks/s, output: 13.79 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:05<00:03, 14.52it/s, est. speed input: 220.29 toks/s, output: 13.77 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:05<00:03, 14.06it/s, est. speed input: 219.99 toks/s, output: 13.75 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:05<00:03, 13.81it/s, est. speed input: 219.77 toks/s, output: 13.74 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:05<00:03, 13.88it/s, est. speed input: 219.90 toks/s, output: 13.74 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:05<00:03, 13.95it/s, est. speed input: 220.04 toks/s, output: 13.75 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:06<00:03, 13.90it/s, est. speed input: 220.05 toks/s, output: 13.75 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:06<00:03, 14.08it/s, est. speed input: 220.32 toks/s, output: 13.77 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:06<00:02, 14.17it/s, est. speed input: 220.54 toks/s, output: 13.78 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:06<00:02, 14.27it/s, est. speed input: 220.78 toks/s, output: 13.80 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:06<00:02, 14.19it/s, est. speed input: 220.86 toks/s, output: 13.80 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:06<00:02, 14.05it/s, est. speed input: 220.83 toks/s, output: 13.80 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:06<00:02, 13.92it/s, est. speed input: 220.78 toks/s, output: 13.80 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:07<00:02, 13.84it/s, est. speed input: 220.73 toks/s, output: 13.80 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:07<00:02, 13.94it/s, est. speed input: 220.85 toks/s, output: 13.80 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:07<00:01, 13.88it/s, est. speed input: 220.83 toks/s, output: 13.80 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:07<00:01, 13.96it/s, est. speed input: 220.94 toks/s, output: 13.81 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:07<00:01, 14.00it/s, est. speed input: 221.02 toks/s, output: 13.81 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:07<00:01, 14.19it/s, est. speed input: 221.26 toks/s, output: 13.83 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:07<00:01, 14.11it/s, est. speed input: 221.28 toks/s, output: 13.83 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:08<00:01, 14.13it/s, est. speed input: 221.39 toks/s, output: 13.84 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:08<00:01, 14.15it/s, est. speed input: 221.48 toks/s, output: 13.84 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:08<00:00, 14.06it/s, est. speed input: 221.49 toks/s, output: 13.84 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:08<00:00, 14.09it/s, est. speed input: 221.57 toks/s, output: 13.85 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:08<00:00, 14.14it/s, est. speed input: 221.68 toks/s, output: 13.85 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:08<00:00, 14.17it/s, est. speed input: 221.78 toks/s, output: 13.86 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:08<00:00, 14.11it/s, est. speed input: 221.81 toks/s, output: 13.86 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:09<00:00, 14.00it/s, est. speed input: 221.77 toks/s, output: 13.86 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:09<00:00, 13.98it/s, est. speed input: 221.79 toks/s, output: 13.86 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:09<00:00, 13.98it/s, est. speed input: 221.81 toks/s, output: 13.86 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:09<00:00, 13.86it/s, est. speed input: 221.81 toks/s, output: 13.86 toks/s]
[rank0]:[W125 17:26:09.940108816 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=128 ==========
Time: 2026-01-25 17:26:12
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-FP8-SlideSparse-2_4
Params: prompt_len=128, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-FP8-SlideSparse-2_4 --dataset-name random --input-len 128 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 129 --max-num-batched-tokens 129 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_4/json/Llama3.2-1B-FP8_M128.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 17:26:19 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 17:26:21 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=188410) WARNING 01-25 17:26:29 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=188410) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=188410) WARNING 01-25 17:26:36 [backends.py:609] Failed to read file <frozen os>
Throughput: 14.90 requests/s, 1922.16 total tokens/s, 14.90 output tokens/s
Total num prompt tokens:  16384
Total num output tokens:  128

STDERR:
[2026-01-25 17:26:19] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:26:19] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-FP8'
[2026-01-25 17:26:19] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-FP8
[2026-01-25 17:26:19] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 17:26:19] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 17:26:19] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 17:26:19] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 17:26:19] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 17:26:19] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-FP8'
[2026-01-25 17:26:19] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:26:19] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:26:19] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:26:19] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:26:19] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 17:26:28] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:26:28] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-FP8'
[2026-01-25 17:26:28] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-FP8
[2026-01-25 17:26:28] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 17:26:28] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 17:26:28] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 17:26:28] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 17:26:28] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 17:26:28] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-FP8'
[2026-01-25 17:26:28] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:26:28] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:26:28] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:26:28] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:26:28] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=188410) [2026-01-25 17:26:29] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=188410) [2026-01-25 17:26:29] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=188410) [2026-01-25 17:26:29] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=188410) [2026-01-25 17:26:29] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=188410) [2026-01-25 17:26:29] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Llama3.2-1B-FP8
(EngineCore_DP0 pid=188410) [2026-01-25 17:26:29] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=188410) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=188410) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.86it/s]
(EngineCore_DP0 pid=188410) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.86it/s]
(EngineCore_DP0 pid=188410) 
(EngineCore_DP0 pid=188410) [2026-01-25 17:26:30] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 2048] -> 1D uint8
(EngineCore_DP0 pid=188410) [2026-01-25 17:26:30] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 4718592 bytes
(EngineCore_DP0 pid=188410) [2026-01-25 17:26:30] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2048, 2048] -> 1D uint8
(EngineCore_DP0 pid=188410) [2026-01-25 17:26:30] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 3145728 bytes
(EngineCore_DP0 pid=188410) [2026-01-25 17:26:30] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [16384, 2048] -> 1D uint8
(EngineCore_DP0 pid=188410) [2026-01-25 17:26:30] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 25165824 bytes
(EngineCore_DP0 pid=188410) [2026-01-25 17:26:30] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2048, 8192] -> 1D uint8
(EngineCore_DP0 pid=188410) [2026-01-25 17:26:30] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12582912 bytes
(EngineCore_DP0 pid=188410) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  9.21it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  9.25it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  9.24it/s]
(EngineCore_DP0 pid=188410) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.79it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.77it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 1271.93it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 1269.21it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:28,  4.43it/s, est. speed input: 567.26 toks/s, output: 4.43 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:12,  9.62it/s, est. speed input: 1102.35 toks/s, output: 8.61 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:10, 12.18it/s, est. speed input: 1358.44 toks/s, output: 10.61 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:08, 13.57it/s, est. speed input: 1504.05 toks/s, output: 11.75 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:00<00:08, 14.59it/s, est. speed input: 1609.22 toks/s, output: 12.57 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:00<00:07, 15.24it/s, est. speed input: 1683.78 toks/s, output: 13.15 toks/s]
Processed prompts:  10%|█         | 13/128 [00:00<00:07, 15.69it/s, est. speed input: 1740.26 toks/s, output: 13.60 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:01<00:07, 16.03it/s, est. speed input: 1785.73 toks/s, output: 13.95 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:01<00:06, 16.21it/s, est. speed input: 1820.09 toks/s, output: 14.22 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:01<00:06, 16.42it/s, est. speed input: 1850.95 toks/s, output: 14.46 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:01<00:06, 16.53it/s, est. speed input: 1875.58 toks/s, output: 14.65 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:01<00:06, 16.04it/s, est. speed input: 1879.85 toks/s, output: 14.69 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:01<00:06, 15.64it/s, est. speed input: 1880.81 toks/s, output: 14.69 toks/s]
Processed prompts:  21%|██        | 27/128 [00:01<00:06, 15.37it/s, est. speed input: 1881.62 toks/s, output: 14.70 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:01<00:06, 15.26it/s, est. speed input: 1884.46 toks/s, output: 14.72 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:02<00:06, 15.13it/s, est. speed input: 1885.36 toks/s, output: 14.73 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:02<00:06, 15.00it/s, est. speed input: 1885.30 toks/s, output: 14.73 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:02<00:06, 14.84it/s, est. speed input: 1883.40 toks/s, output: 14.71 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:02<00:06, 14.86it/s, est. speed input: 1884.61 toks/s, output: 14.72 toks/s]
Processed prompts:  30%|███       | 39/128 [00:02<00:06, 14.70it/s, est. speed input: 1882.13 toks/s, output: 14.70 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:02<00:05, 14.80it/s, est. speed input: 1884.16 toks/s, output: 14.72 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:02<00:05, 15.09it/s, est. speed input: 1890.18 toks/s, output: 14.77 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:03<00:05, 15.45it/s, est. speed input: 1898.36 toks/s, output: 14.83 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:03<00:05, 15.54it/s, est. speed input: 1903.16 toks/s, output: 14.87 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:03<00:05, 15.69it/s, est. speed input: 1908.84 toks/s, output: 14.91 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:03<00:04, 15.80it/s, est. speed input: 1914.21 toks/s, output: 14.95 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:03<00:04, 15.84it/s, est. speed input: 1918.72 toks/s, output: 14.99 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:03<00:04, 15.80it/s, est. speed input: 1921.90 toks/s, output: 15.01 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:03<00:04, 15.85it/s, est. speed input: 1925.92 toks/s, output: 15.05 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:03<00:04, 15.98it/s, est. speed input: 1930.87 toks/s, output: 15.08 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:04<00:04, 16.02it/s, est. speed input: 1934.92 toks/s, output: 15.12 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:04<00:04, 16.03it/s, est. speed input: 1938.55 toks/s, output: 15.14 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:04<00:03, 15.97it/s, est. speed input: 1941.12 toks/s, output: 15.16 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:04<00:03, 16.02it/s, est. speed input: 1944.68 toks/s, output: 15.19 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:04<00:03, 15.92it/s, est. speed input: 1946.46 toks/s, output: 15.21 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:04<00:03, 15.89it/s, est. speed input: 1948.61 toks/s, output: 15.22 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:04<00:03, 15.82it/s, est. speed input: 1950.09 toks/s, output: 15.24 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:04<00:03, 15.67it/s, est. speed input: 1950.41 toks/s, output: 15.24 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:05<00:03, 15.70it/s, est. speed input: 1952.16 toks/s, output: 15.25 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:05<00:03, 15.69it/s, est. speed input: 1953.42 toks/s, output: 15.26 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:05<00:03, 15.62it/s, est. speed input: 1954.09 toks/s, output: 15.27 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:05<00:02, 15.73it/s, est. speed input: 1956.19 toks/s, output: 15.28 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:05<00:02, 15.80it/s, est. speed input: 1958.15 toks/s, output: 15.30 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:05<00:02, 15.66it/s, est. speed input: 1958.32 toks/s, output: 15.30 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:05<00:02, 15.23it/s, est. speed input: 1955.30 toks/s, output: 15.28 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:05<00:02, 15.03it/s, est. speed input: 1953.24 toks/s, output: 15.26 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:06<00:02, 14.95it/s, est. speed input: 1951.82 toks/s, output: 15.25 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:06<00:02, 14.92it/s, est. speed input: 1950.75 toks/s, output: 15.24 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:06<00:02, 14.84it/s, est. speed input: 1949.09 toks/s, output: 15.23 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:06<00:01, 14.79it/s, est. speed input: 1947.65 toks/s, output: 15.22 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:06<00:01, 14.79it/s, est. speed input: 1946.54 toks/s, output: 15.21 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:06<00:01, 14.81it/s, est. speed input: 1945.61 toks/s, output: 15.20 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:06<00:01, 14.80it/s, est. speed input: 1944.58 toks/s, output: 15.19 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:07<00:01, 14.70it/s, est. speed input: 1942.75 toks/s, output: 15.18 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:07<00:01, 14.70it/s, est. speed input: 1941.62 toks/s, output: 15.17 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:07<00:01, 14.74it/s, est. speed input: 1940.78 toks/s, output: 15.16 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:07<00:01, 14.75it/s, est. speed input: 1939.86 toks/s, output: 15.16 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:07<00:00, 14.71it/s, est. speed input: 1938.63 toks/s, output: 15.15 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:07<00:00, 14.67it/s, est. speed input: 1937.33 toks/s, output: 15.14 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:07<00:00, 14.52it/s, est. speed input: 1935.18 toks/s, output: 15.12 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:08<00:00, 14.60it/s, est. speed input: 1934.43 toks/s, output: 15.11 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:08<00:00, 14.56it/s, est. speed input: 1933.02 toks/s, output: 15.10 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:08<00:00, 14.59it/s, est. speed input: 1932.13 toks/s, output: 15.09 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:08<00:00, 14.59it/s, est. speed input: 1931.07 toks/s, output: 15.09 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:08<00:00, 14.59it/s, est. speed input: 1930.31 toks/s, output: 15.08 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:08<00:00, 15.08it/s, est. speed input: 1930.31 toks/s, output: 15.08 toks/s]
[rank0]:[W125 17:26:57.962616666 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=256 ==========
Time: 2026-01-25 17:27:00
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-FP8-SlideSparse-2_4
Params: prompt_len=256, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-FP8-SlideSparse-2_4 --dataset-name random --input-len 256 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 257 --max-num-batched-tokens 257 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_4/json/Llama3.2-1B-FP8_M256.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 17:27:08 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 17:27:09 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=189330) WARNING 01-25 17:27:17 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=189330) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=189330) WARNING 01-25 17:27:23 [backends.py:609] Failed to read file <frozen os>
Throughput: 14.55 requests/s, 3740.38 total tokens/s, 14.55 output tokens/s
Total num prompt tokens:  32768
Total num output tokens:  128

STDERR:
[2026-01-25 17:27:08] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:27:08] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-FP8'
[2026-01-25 17:27:08] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-FP8
[2026-01-25 17:27:08] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 17:27:08] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 17:27:08] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 17:27:08] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 17:27:08] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 17:27:08] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-FP8'
[2026-01-25 17:27:08] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:27:08] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:27:08] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:27:08] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:27:08] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 17:27:16] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:27:16] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-FP8'
[2026-01-25 17:27:16] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-FP8
[2026-01-25 17:27:16] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 17:27:16] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 17:27:16] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 17:27:16] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 17:27:16] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 17:27:16] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-FP8'
[2026-01-25 17:27:16] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:27:16] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:27:16] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:27:16] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:27:16] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=189330) [2026-01-25 17:27:17] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=189330) [2026-01-25 17:27:17] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=189330) [2026-01-25 17:27:17] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=189330) [2026-01-25 17:27:17] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=189330) [2026-01-25 17:27:17] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Llama3.2-1B-FP8
(EngineCore_DP0 pid=189330) [2026-01-25 17:27:17] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=189330) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=189330) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.00it/s]
(EngineCore_DP0 pid=189330) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.99it/s]
(EngineCore_DP0 pid=189330) 
(EngineCore_DP0 pid=189330) [2026-01-25 17:27:16] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 2048] -> 1D uint8
(EngineCore_DP0 pid=189330) [2026-01-25 17:27:16] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 4718592 bytes
(EngineCore_DP0 pid=189330) [2026-01-25 17:27:16] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2048, 2048] -> 1D uint8
(EngineCore_DP0 pid=189330) [2026-01-25 17:27:16] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 3145728 bytes
(EngineCore_DP0 pid=189330) [2026-01-25 17:27:16] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [16384, 2048] -> 1D uint8
(EngineCore_DP0 pid=189330) [2026-01-25 17:27:16] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 25165824 bytes
(EngineCore_DP0 pid=189330) [2026-01-25 17:27:16] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2048, 8192] -> 1D uint8
(EngineCore_DP0 pid=189330) [2026-01-25 17:27:16] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12582912 bytes
(EngineCore_DP0 pid=189330) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  9.80it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  9.82it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  9.80it/s]
(EngineCore_DP0 pid=189330) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  9.01it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  9.00it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  65%|██████▍   | 83/128 [00:00<00:00, 821.80it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 834.13it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:28,  4.54it/s, est. speed input: 1161.25 toks/s, output: 4.54 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:13,  9.59it/s, est. speed input: 2209.54 toks/s, output: 8.63 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:10, 12.08it/s, est. speed input: 2707.87 toks/s, output: 10.58 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:08, 13.69it/s, est. speed input: 3025.95 toks/s, output: 11.82 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:00<00:08, 14.34it/s, est. speed input: 3197.19 toks/s, output: 12.49 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:00<00:08, 14.33it/s, est. speed input: 3272.33 toks/s, output: 12.78 toks/s]
Processed prompts:  10%|█         | 13/128 [00:00<00:07, 14.52it/s, est. speed input: 3346.32 toks/s, output: 13.07 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:01<00:07, 14.68it/s, est. speed input: 3405.73 toks/s, output: 13.30 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:01<00:07, 14.82it/s, est. speed input: 3454.98 toks/s, output: 13.50 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:01<00:07, 14.80it/s, est. speed input: 3486.41 toks/s, output: 13.62 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:01<00:07, 14.76it/s, est. speed input: 3509.85 toks/s, output: 13.71 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:01<00:07, 14.81it/s, est. speed input: 3534.94 toks/s, output: 13.81 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:01<00:06, 14.89it/s, est. speed input: 3558.73 toks/s, output: 13.90 toks/s]
Processed prompts:  21%|██        | 27/128 [00:01<00:06, 14.95it/s, est. speed input: 3580.03 toks/s, output: 13.98 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:02<00:06, 14.97it/s, est. speed input: 3597.09 toks/s, output: 14.05 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:02<00:06, 14.71it/s, est. speed input: 3598.53 toks/s, output: 14.06 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:02<00:06, 14.69it/s, est. speed input: 3607.23 toks/s, output: 14.09 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:02<00:06, 14.46it/s, est. speed input: 3605.07 toks/s, output: 14.08 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:02<00:06, 14.50it/s, est. speed input: 3612.19 toks/s, output: 14.11 toks/s]
Processed prompts:  30%|███       | 39/128 [00:02<00:06, 14.41it/s, est. speed input: 3613.33 toks/s, output: 14.11 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:02<00:06, 14.48it/s, est. speed input: 3619.63 toks/s, output: 14.14 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:03<00:05, 14.51it/s, est. speed input: 3624.63 toks/s, output: 14.16 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:03<00:05, 14.47it/s, est. speed input: 3627.07 toks/s, output: 14.17 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:03<00:05, 14.43it/s, est. speed input: 3628.86 toks/s, output: 14.18 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:03<00:05, 14.52it/s, est. speed input: 3634.60 toks/s, output: 14.20 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:03<00:05, 14.50it/s, est. speed input: 3637.05 toks/s, output: 14.21 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:03<00:05, 14.95it/s, est. speed input: 3653.46 toks/s, output: 14.27 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:03<00:04, 15.20it/s, est. speed input: 3666.50 toks/s, output: 14.32 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:03<00:04, 15.42it/s, est. speed input: 3679.76 toks/s, output: 14.37 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:04<00:04, 15.62it/s, est. speed input: 3693.25 toks/s, output: 14.43 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:04<00:04, 15.52it/s, est. speed input: 3700.18 toks/s, output: 14.45 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:04<00:04, 15.61it/s, est. speed input: 3710.28 toks/s, output: 14.49 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:04<00:04, 15.71it/s, est. speed input: 3720.81 toks/s, output: 14.53 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:04<00:03, 15.65it/s, est. speed input: 3727.71 toks/s, output: 14.56 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:04<00:03, 15.67it/s, est. speed input: 3735.74 toks/s, output: 14.59 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:04<00:03, 15.91it/s, est. speed input: 3747.85 toks/s, output: 14.64 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:04<00:03, 16.04it/s, est. speed input: 3758.62 toks/s, output: 14.68 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:05<00:03, 15.97it/s, est. speed input: 3765.78 toks/s, output: 14.71 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:05<00:03, 15.96it/s, est. speed input: 3773.40 toks/s, output: 14.74 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:05<00:03, 15.97it/s, est. speed input: 3780.95 toks/s, output: 14.77 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:05<00:02, 15.89it/s, est. speed input: 3786.41 toks/s, output: 14.79 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:05<00:02, 15.83it/s, est. speed input: 3791.70 toks/s, output: 14.81 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:05<00:02, 15.81it/s, est. speed input: 3797.05 toks/s, output: 14.83 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:05<00:02, 15.89it/s, est. speed input: 3803.90 toks/s, output: 14.86 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:05<00:02, 15.97it/s, est. speed input: 3810.70 toks/s, output: 14.89 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:06<00:02, 15.86it/s, est. speed input: 3814.57 toks/s, output: 14.90 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:06<00:02, 15.75it/s, est. speed input: 3817.83 toks/s, output: 14.91 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:06<00:02, 15.71it/s, est. speed input: 3821.44 toks/s, output: 14.93 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:06<00:02, 15.47it/s, est. speed input: 3821.49 toks/s, output: 14.93 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:06<00:01, 15.15it/s, est. speed input: 3818.94 toks/s, output: 14.92 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:06<00:01, 14.95it/s, est. speed input: 3816.84 toks/s, output: 14.91 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:06<00:01, 14.88it/s, est. speed input: 3815.81 toks/s, output: 14.91 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:07<00:01, 14.81it/s, est. speed input: 3814.48 toks/s, output: 14.90 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:07<00:01, 14.83it/s, est. speed input: 3814.36 toks/s, output: 14.90 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:07<00:01, 14.86it/s, est. speed input: 3814.57 toks/s, output: 14.90 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:07<00:01, 14.72it/s, est. speed input: 3812.23 toks/s, output: 14.89 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:07<00:01, 14.64it/s, est. speed input: 3810.15 toks/s, output: 14.88 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:07<00:00, 14.63it/s, est. speed input: 3808.98 toks/s, output: 14.88 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:07<00:00, 14.54it/s, est. speed input: 3806.44 toks/s, output: 14.87 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:08<00:00, 14.26it/s, est. speed input: 3800.67 toks/s, output: 14.85 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:08<00:00, 14.31it/s, est. speed input: 3798.86 toks/s, output: 14.84 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:08<00:00, 14.38it/s, est. speed input: 3797.67 toks/s, output: 14.83 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:08<00:00, 14.38it/s, est. speed input: 3795.73 toks/s, output: 14.83 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:08<00:00, 14.41it/s, est. speed input: 3794.28 toks/s, output: 14.82 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:08<00:00, 14.41it/s, est. speed input: 3792.74 toks/s, output: 14.82 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:08<00:00, 14.82it/s, est. speed input: 3792.74 toks/s, output: 14.82 toks/s]
[rank0]:[W125 17:27:45.457706802 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=512 ==========
Time: 2026-01-25 18:49:25
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-FP8-SlideSparse-2_4
Params: prompt_len=512, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-FP8-SlideSparse-2_4 --dataset-name random --input-len 512 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 513 --max-num-batched-tokens 513 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_4/json/Llama3.2-1B-FP8_M512.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 18:49:34 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 18:49:35 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=274157) WARNING 01-25 18:49:41 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=274157) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=274157) WARNING 01-25 18:49:49 [backends.py:609] Failed to read file <frozen os>
Throughput: 17.00 requests/s, 8722.82 total tokens/s, 17.00 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128

STDERR:
[2026-01-25 18:49:34] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:49:34] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-FP8'
[2026-01-25 18:49:34] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-FP8
[2026-01-25 18:49:34] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:49:34] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:49:34] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:49:34] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:49:34] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:49:34] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-FP8'
[2026-01-25 18:49:34] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:49:34] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:49:34] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:49:34] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:49:34] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 18:49:40] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:49:41] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-FP8'
[2026-01-25 18:49:41] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-FP8
[2026-01-25 18:49:41] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:49:41] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:49:41] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:49:41] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:49:41] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:49:41] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-FP8'
[2026-01-25 18:49:41] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:49:41] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:49:41] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:49:41] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:49:41] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=274157) [2026-01-25 18:49:42] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=274157) [2026-01-25 18:49:42] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=274157) [2026-01-25 18:49:42] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=274157) [2026-01-25 18:49:42] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=274157) [2026-01-25 18:49:42] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Llama3.2-1B-FP8
(EngineCore_DP0 pid=274157) [2026-01-25 18:49:42] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=274157) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=274157) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.51it/s]
(EngineCore_DP0 pid=274157) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.51it/s]
(EngineCore_DP0 pid=274157) 
(EngineCore_DP0 pid=274157) [2026-01-25 18:49:42] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 2048] -> 1D uint8
(EngineCore_DP0 pid=274157) [2026-01-25 18:49:43] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 4718592 bytes
(EngineCore_DP0 pid=274157) [2026-01-25 18:49:43] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2048, 2048] -> 1D uint8
(EngineCore_DP0 pid=274157) [2026-01-25 18:49:43] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 3145728 bytes
(EngineCore_DP0 pid=274157) [2026-01-25 18:49:43] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [16384, 2048] -> 1D uint8
(EngineCore_DP0 pid=274157) [2026-01-25 18:49:43] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 25165824 bytes
(EngineCore_DP0 pid=274157) [2026-01-25 18:49:43] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2048, 8192] -> 1D uint8
(EngineCore_DP0 pid=274157) [2026-01-25 18:49:43] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12582912 bytes
(EngineCore_DP0 pid=274157) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  4.01it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  5.07it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  4.88it/s]
(EngineCore_DP0 pid=274157) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  4.82it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  4.82it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  40%|███▉      | 51/128 [00:00<00:00, 504.51it/s]
Adding requests:  82%|████████▏ | 105/128 [00:00<00:00, 522.51it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 520.38it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:03, 35.57it/s, est. speed input: 18213.52 toks/s, output: 35.57 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:00<00:05, 22.03it/s, est. speed input: 12043.94 toks/s, output: 23.52 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:00<00:05, 19.48it/s, est. speed input: 10819.49 toks/s, output: 21.13 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:00<00:06, 18.26it/s, est. speed input: 10214.95 toks/s, output: 19.95 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:00<00:06, 17.76it/s, est. speed input: 9958.87 toks/s, output: 19.45 toks/s] 
Processed prompts:  15%|█▍        | 19/128 [00:00<00:06, 17.35it/s, est. speed input: 9759.18 toks/s, output: 19.06 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:01<00:06, 17.06it/s, est. speed input: 9604.98 toks/s, output: 18.76 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:01<00:06, 16.80it/s, est. speed input: 9472.91 toks/s, output: 18.50 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:01<00:06, 16.69it/s, est. speed input: 9377.58 toks/s, output: 18.32 toks/s]
Processed prompts:  21%|██        | 27/128 [00:01<00:06, 16.66it/s, est. speed input: 9305.24 toks/s, output: 18.17 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:01<00:05, 16.53it/s, est. speed input: 9229.47 toks/s, output: 18.03 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:01<00:05, 16.52it/s, est. speed input: 9174.61 toks/s, output: 17.92 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:01<00:05, 16.53it/s, est. speed input: 9128.46 toks/s, output: 17.83 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:01<00:05, 16.56it/s, est. speed input: 9091.63 toks/s, output: 17.76 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:02<00:05, 16.61it/s, est. speed input: 9061.57 toks/s, output: 17.70 toks/s]
Processed prompts:  30%|███       | 39/128 [00:02<00:05, 16.63it/s, est. speed input: 9033.45 toks/s, output: 17.64 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:02<00:05, 16.55it/s, est. speed input: 8998.59 toks/s, output: 17.58 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:02<00:05, 16.39it/s, est. speed input: 8958.56 toks/s, output: 17.50 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:02<00:04, 16.70it/s, est. speed input: 8958.07 toks/s, output: 17.50 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:02<00:04, 17.03it/s, est. speed input: 8965.54 toks/s, output: 17.51 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:02<00:04, 17.28it/s, est. speed input: 8973.16 toks/s, output: 17.53 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:02<00:04, 17.37it/s, est. speed input: 8974.49 toks/s, output: 17.53 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:03<00:04, 17.51it/s, est. speed input: 8980.38 toks/s, output: 17.54 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:03<00:04, 17.36it/s, est. speed input: 8970.40 toks/s, output: 17.52 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:03<00:04, 17.48it/s, est. speed input: 8974.80 toks/s, output: 17.53 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:03<00:03, 17.47it/s, est. speed input: 8973.40 toks/s, output: 17.53 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:03<00:03, 17.18it/s, est. speed input: 8956.07 toks/s, output: 17.49 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:03<00:03, 17.06it/s, est. speed input: 8944.00 toks/s, output: 17.47 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:03<00:03, 17.17it/s, est. speed input: 8943.18 toks/s, output: 17.47 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:03<00:03, 17.35it/s, est. speed input: 8948.12 toks/s, output: 17.48 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:03<00:03, 17.51it/s, est. speed input: 8954.06 toks/s, output: 17.49 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:04<00:03, 17.55it/s, est. speed input: 8956.53 toks/s, output: 17.49 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:04<00:03, 17.56it/s, est. speed input: 8957.63 toks/s, output: 17.50 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:04<00:03, 17.54it/s, est. speed input: 8957.68 toks/s, output: 17.50 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:04<00:02, 17.33it/s, est. speed input: 8948.68 toks/s, output: 17.48 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:04<00:02, 17.33it/s, est. speed input: 8946.80 toks/s, output: 17.47 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:04<00:02, 17.49it/s, est. speed input: 8951.81 toks/s, output: 17.48 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:04<00:00, 92.14it/s, est. speed input: 12224.35 toks/s, output: 23.88 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:05<00:00, 44.13it/s, est. speed input: 11904.73 toks/s, output: 23.25 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:05<00:00, 44.13it/s, est. speed input: 11758.74 toks/s, output: 22.97 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:05<00:00, 22.97it/s, est. speed input: 11758.74 toks/s, output: 22.97 toks/s]
[rank0]:[W125 18:50:08.824484936 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=1024 ==========
Time: 2026-01-25 18:50:11
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-FP8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-FP8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 1025 --max-num-batched-tokens 1025 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_4/json/Llama3.2-1B-FP8_M1024.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 18:50:20 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 18:50:21 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=275036) WARNING 01-25 18:50:29 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=275036) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=275036) WARNING 01-25 18:50:37 [backends.py:609] Failed to read file <frozen os>
Throughput: 16.26 requests/s, 16665.21 total tokens/s, 16.26 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128

STDERR:
[2026-01-25 18:50:20] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:50:20] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-FP8'
[2026-01-25 18:50:20] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-FP8
[2026-01-25 18:50:20] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:50:20] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:50:20] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:50:20] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:50:20] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:50:20] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-FP8'
[2026-01-25 18:50:20] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:50:20] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:50:20] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:50:20] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:50:20] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 18:50:28] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:50:29] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-FP8'
[2026-01-25 18:50:29] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-FP8
[2026-01-25 18:50:29] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:50:29] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:50:29] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:50:29] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:50:29] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:50:29] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-FP8'
[2026-01-25 18:50:29] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:50:29] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:50:29] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:50:29] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:50:29] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=275036) [2026-01-25 18:50:30] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=275036) [2026-01-25 18:50:30] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=275036) [2026-01-25 18:50:30] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=275036) [2026-01-25 18:50:30] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=275036) [2026-01-25 18:50:30] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Llama3.2-1B-FP8
(EngineCore_DP0 pid=275036) [2026-01-25 18:50:30] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=275036) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=275036) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.94it/s]
(EngineCore_DP0 pid=275036) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.94it/s]
(EngineCore_DP0 pid=275036) 
(EngineCore_DP0 pid=275036) [2026-01-25 18:50:31] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 2048] -> 1D uint8
(EngineCore_DP0 pid=275036) [2026-01-25 18:50:31] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 4718592 bytes
(EngineCore_DP0 pid=275036) [2026-01-25 18:50:31] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2048, 2048] -> 1D uint8
(EngineCore_DP0 pid=275036) [2026-01-25 18:50:31] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 3145728 bytes
(EngineCore_DP0 pid=275036) [2026-01-25 18:50:31] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [16384, 2048] -> 1D uint8
(EngineCore_DP0 pid=275036) [2026-01-25 18:50:31] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 25165824 bytes
(EngineCore_DP0 pid=275036) [2026-01-25 18:50:31] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2048, 8192] -> 1D uint8
(EngineCore_DP0 pid=275036) [2026-01-25 18:50:31] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12582912 bytes
(EngineCore_DP0 pid=275036) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  7.88it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  4.22it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  4.53it/s]
(EngineCore_DP0 pid=275036) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.54it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.52it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  21%|██        | 27/128 [00:00<00:00, 264.47it/s]
Adding requests:  45%|████▍     | 57/128 [00:00<00:00, 282.84it/s]
Adding requests:  69%|██████▉   | 88/128 [00:00<00:00, 293.20it/s]
Adding requests:  92%|█████████▏| 118/128 [00:00<00:00, 290.26it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 288.81it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▍         | 6/128 [00:00<00:02, 45.60it/s, est. speed input: 46704.39 toks/s, output: 45.60 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:00<00:05, 22.77it/s, est. speed input: 25396.41 toks/s, output: 24.80 toks/s]
Processed prompts:  11%|█         | 14/128 [00:00<00:05, 20.10it/s, est. speed input: 22744.23 toks/s, output: 22.21 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:00<00:05, 18.68it/s, est. speed input: 21337.60 toks/s, output: 20.84 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:00<00:06, 17.95it/s, est. speed input: 20528.62 toks/s, output: 20.05 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:01<00:06, 17.62it/s, est. speed input: 20144.61 toks/s, output: 19.67 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:01<00:05, 17.36it/s, est. speed input: 19841.46 toks/s, output: 19.38 toks/s]
Processed prompts:  20%|██        | 26/128 [00:01<00:05, 17.14it/s, est. speed input: 19581.36 toks/s, output: 19.12 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:01<00:05, 16.89it/s, est. speed input: 19337.06 toks/s, output: 18.88 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:01<00:05, 16.62it/s, est. speed input: 19103.29 toks/s, output: 18.66 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:01<00:05, 16.61it/s, est. speed input: 18957.03 toks/s, output: 18.51 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:01<00:05, 16.64it/s, est. speed input: 18838.15 toks/s, output: 18.40 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:01<00:05, 16.56it/s, est. speed input: 18707.93 toks/s, output: 18.27 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:02<00:05, 16.60it/s, est. speed input: 18617.15 toks/s, output: 18.18 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:02<00:05, 16.67it/s, est. speed input: 18543.45 toks/s, output: 18.11 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:02<00:05, 16.70it/s, est. speed input: 18472.52 toks/s, output: 18.04 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:02<00:05, 16.64it/s, est. speed input: 18394.97 toks/s, output: 17.96 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:02<00:04, 16.47it/s, est. speed input: 18301.48 toks/s, output: 17.87 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:02<00:04, 16.55it/s, est. speed input: 18250.74 toks/s, output: 17.82 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:02<00:04, 16.52it/s, est. speed input: 18190.41 toks/s, output: 17.76 toks/s]
Processed prompts:  41%|████      | 52/128 [00:02<00:04, 16.48it/s, est. speed input: 18131.22 toks/s, output: 17.71 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:03<00:04, 16.47it/s, est. speed input: 18080.49 toks/s, output: 17.66 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:03<00:04, 16.30it/s, est. speed input: 18009.93 toks/s, output: 17.59 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:03<00:04, 16.18it/s, est. speed input: 17944.01 toks/s, output: 17.52 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:03<00:04, 16.04it/s, est. speed input: 17875.91 toks/s, output: 17.46 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:03<00:04, 15.86it/s, est. speed input: 17802.04 toks/s, output: 17.38 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:03<00:04, 15.99it/s, est. speed input: 17764.57 toks/s, output: 17.35 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:03<00:03, 16.07it/s, est. speed input: 17728.42 toks/s, output: 17.31 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:03<00:03, 16.16it/s, est. speed input: 17698.74 toks/s, output: 17.28 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:04<00:03, 16.08it/s, est. speed input: 17654.23 toks/s, output: 17.24 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:04<00:03, 16.09it/s, est. speed input: 17620.07 toks/s, output: 17.21 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:04<00:03, 16.17it/s, est. speed input: 17595.69 toks/s, output: 17.18 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:04<00:03, 16.12it/s, est. speed input: 17561.74 toks/s, output: 17.15 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:04<00:03, 16.20it/s, est. speed input: 17540.41 toks/s, output: 17.13 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:04<00:02, 16.51it/s, est. speed input: 17544.67 toks/s, output: 17.13 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:04<00:02, 16.74it/s, est. speed input: 17549.17 toks/s, output: 17.14 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:04<00:02, 16.99it/s, est. speed input: 17560.26 toks/s, output: 17.15 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:05<00:02, 17.25it/s, est. speed input: 17576.63 toks/s, output: 17.16 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:05<00:02, 17.45it/s, est. speed input: 17594.28 toks/s, output: 17.18 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:05<00:02, 17.54it/s, est. speed input: 17606.93 toks/s, output: 17.19 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:05<00:02, 17.60it/s, est. speed input: 17618.74 toks/s, output: 17.21 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:05<00:01, 17.70it/s, est. speed input: 17633.93 toks/s, output: 17.22 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:05<00:01, 17.74it/s, est. speed input: 17646.75 toks/s, output: 17.23 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:05<00:01, 17.44it/s, est. speed input: 17636.61 toks/s, output: 17.22 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:05<00:01, 17.26it/s, est. speed input: 17629.24 toks/s, output: 17.22 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:05<00:01, 17.20it/s, est. speed input: 17625.78 toks/s, output: 17.21 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:06<00:01, 17.10it/s, est. speed input: 17619.17 toks/s, output: 17.21 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:06<00:01, 17.29it/s, est. speed input: 17629.15 toks/s, output: 17.22 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:06<00:01, 17.28it/s, est. speed input: 17629.93 toks/s, output: 17.22 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:06<00:01, 17.32it/s, est. speed input: 17633.61 toks/s, output: 17.22 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:06<00:00, 17.46it/s, est. speed input: 17643.86 toks/s, output: 17.23 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:06<00:00, 17.48it/s, est. speed input: 17649.04 toks/s, output: 17.24 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:06<00:00, 17.29it/s, est. speed input: 17642.42 toks/s, output: 17.23 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:06<00:00, 17.43it/s, est. speed input: 17651.51 toks/s, output: 17.24 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:06<00:00, 17.41it/s, est. speed input: 17653.63 toks/s, output: 17.24 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:07<00:00, 17.49it/s, est. speed input: 17660.51 toks/s, output: 17.25 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:07<00:00, 17.58it/s, est. speed input: 17669.39 toks/s, output: 17.26 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:07<00:00, 17.28it/s, est. speed input: 17658.56 toks/s, output: 17.24 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 17.04it/s, est. speed input: 17646.54 toks/s, output: 17.23 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 17.04it/s, est. speed input: 17646.54 toks/s, output: 17.23 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 17.23it/s, est. speed input: 17646.54 toks/s, output: 17.23 toks/s]
[rank0]:[W125 18:50:57.200415616 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=2048 ==========
Time: 2026-01-25 18:51:00
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-FP8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=256, max_num_seqs=2
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-FP8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 256 --max-num-seqs 2 --max-model-len 1025 --max-num-batched-tokens 2048 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_4/json/Llama3.2-1B-FP8_M2048.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 18:51:09 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 18:51:10 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=275954) WARNING 01-25 18:51:18 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=275954) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=275954) WARNING 01-25 18:51:26 [backends.py:609] Failed to read file <frozen os>
Throughput: 32.82 requests/s, 33643.01 total tokens/s, 32.82 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256

STDERR:
[2026-01-25 18:51:09] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:51:09] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-FP8'
[2026-01-25 18:51:09] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-FP8
[2026-01-25 18:51:09] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:51:09] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:51:09] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:51:09] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:51:09] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:51:09] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-FP8'
[2026-01-25 18:51:09] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:51:09] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:51:09] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:51:09] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:51:09] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 18:51:17] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:51:17] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-FP8'
[2026-01-25 18:51:17] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-FP8
[2026-01-25 18:51:17] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:51:17] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:51:17] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:51:17] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:51:17] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:51:17] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-FP8'
[2026-01-25 18:51:17] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:51:17] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:51:17] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:51:17] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:51:17] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=275954) [2026-01-25 18:51:19] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=275954) [2026-01-25 18:51:19] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=275954) [2026-01-25 18:51:19] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=275954) [2026-01-25 18:51:19] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=275954) [2026-01-25 18:51:19] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Llama3.2-1B-FP8
(EngineCore_DP0 pid=275954) [2026-01-25 18:51:19] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=275954) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=275954) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.10it/s]
(EngineCore_DP0 pid=275954) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.10it/s]
(EngineCore_DP0 pid=275954) 
(EngineCore_DP0 pid=275954) [2026-01-25 18:51:19] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 2048] -> 1D uint8
(EngineCore_DP0 pid=275954) [2026-01-25 18:51:19] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 4718592 bytes
(EngineCore_DP0 pid=275954) [2026-01-25 18:51:19] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2048, 2048] -> 1D uint8
(EngineCore_DP0 pid=275954) [2026-01-25 18:51:19] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 3145728 bytes
(EngineCore_DP0 pid=275954) [2026-01-25 18:51:19] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [16384, 2048] -> 1D uint8
(EngineCore_DP0 pid=275954) [2026-01-25 18:51:19] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 25165824 bytes
(EngineCore_DP0 pid=275954) [2026-01-25 18:51:19] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2048, 8192] -> 1D uint8
(EngineCore_DP0 pid=275954) [2026-01-25 18:51:19] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12582912 bytes
(EngineCore_DP0 pid=275954) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  33%|███▎      | 1/3 [00:00<00:00,  8.87it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00,  9.33it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00,  9.28it/s]
(EngineCore_DP0 pid=275954) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 1/2 [00:00<00:00,  7.58it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  8.65it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  11%|█         | 27/256 [00:00<00:00, 264.61it/s]
Adding requests:  23%|██▎       | 58/256 [00:00<00:00, 284.96it/s]
Adding requests:  34%|███▍      | 88/256 [00:00<00:00, 288.33it/s]
Adding requests:  46%|████▌     | 117/256 [00:00<00:00, 283.45it/s]
Adding requests:  57%|█████▋    | 147/256 [00:00<00:00, 286.11it/s]
Adding requests:  69%|██████▉   | 176/256 [00:00<00:00, 283.52it/s]
Adding requests:  80%|████████  | 205/256 [00:00<00:00, 279.56it/s]
Adding requests:  91%|█████████▏| 234/256 [00:00<00:00, 281.37it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, -346.60it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  10%|█         | 26/256 [00:00<00:01, 190.21it/s, est. speed input: 194795.67 toks/s, output: 190.21 toks/s]
Processed prompts:  18%|█▊        | 46/256 [00:00<00:03, 54.54it/s, est. speed input: 63532.00 toks/s, output: 62.04 toks/s]   
Processed prompts:  22%|██▏       | 56/256 [00:01<00:04, 46.15it/s, est. speed input: 54760.81 toks/s, output: 53.48 toks/s]
Processed prompts:  25%|██▍       | 63/256 [00:01<00:04, 44.49it/s, est. speed input: 52649.14 toks/s, output: 51.41 toks/s]
Processed prompts:  27%|██▋       | 69/256 [00:01<00:04, 41.70it/s, est. speed input: 50334.05 toks/s, output: 49.15 toks/s]
Processed prompts:  29%|██▉       | 74/256 [00:01<00:04, 37.89it/s, est. speed input: 47827.54 toks/s, output: 46.71 toks/s]
Processed prompts:  31%|███       | 79/256 [00:01<00:04, 38.81it/s, est. speed input: 47525.59 toks/s, output: 46.41 toks/s]
Processed prompts:  33%|███▎      | 84/256 [00:01<00:04, 35.58it/s, est. speed input: 45759.35 toks/s, output: 44.69 toks/s]
Processed prompts:  34%|███▍      | 88/256 [00:01<00:04, 35.16it/s, est. speed input: 45090.05 toks/s, output: 44.03 toks/s]
Processed prompts:  36%|███▌      | 92/256 [00:02<00:04, 34.60it/s, est. speed input: 44436.96 toks/s, output: 43.39 toks/s]
Processed prompts:  38%|███▊      | 96/256 [00:02<00:04, 34.11it/s, est. speed input: 43841.60 toks/s, output: 42.81 toks/s]
Processed prompts:  39%|███▉      | 100/256 [00:02<00:04, 33.54it/s, est. speed input: 43259.07 toks/s, output: 42.24 toks/s]
Processed prompts:  41%|████      | 104/256 [00:02<00:04, 33.46it/s, est. speed input: 42814.56 toks/s, output: 41.81 toks/s]
Processed prompts:  42%|████▏     | 108/256 [00:02<00:04, 33.44it/s, est. speed input: 42417.40 toks/s, output: 41.42 toks/s]
Processed prompts:  44%|████▍     | 112/256 [00:02<00:04, 33.57it/s, est. speed input: 42083.25 toks/s, output: 41.10 toks/s]
Processed prompts:  45%|████▌     | 116/256 [00:02<00:04, 33.47it/s, est. speed input: 41742.16 toks/s, output: 40.76 toks/s]
Processed prompts:  47%|████▋     | 120/256 [00:02<00:04, 33.21it/s, est. speed input: 41397.57 toks/s, output: 40.43 toks/s]
Processed prompts:  48%|████▊     | 124/256 [00:03<00:03, 33.06it/s, est. speed input: 41084.70 toks/s, output: 40.12 toks/s]
Processed prompts:  50%|█████     | 128/256 [00:03<00:03, 33.00it/s, est. speed input: 40803.18 toks/s, output: 39.85 toks/s]
Processed prompts:  52%|█████▏    | 132/256 [00:03<00:03, 33.13it/s, est. speed input: 40566.78 toks/s, output: 39.62 toks/s]
Processed prompts:  53%|█████▎    | 136/256 [00:03<00:03, 33.24it/s, est. speed input: 40350.70 toks/s, output: 39.40 toks/s]
Processed prompts:  55%|█████▍    | 140/256 [00:03<00:03, 33.15it/s, est. speed input: 40126.02 toks/s, output: 39.19 toks/s]
Processed prompts:  56%|█████▋    | 144/256 [00:03<00:03, 33.06it/s, est. speed input: 39911.68 toks/s, output: 38.98 toks/s]
Processed prompts:  58%|█████▊    | 148/256 [00:03<00:03, 33.02it/s, est. speed input: 39714.04 toks/s, output: 38.78 toks/s]
Processed prompts:  59%|█████▉    | 152/256 [00:03<00:03, 32.99it/s, est. speed input: 39529.68 toks/s, output: 38.60 toks/s]
Processed prompts:  61%|██████    | 156/256 [00:04<00:03, 33.05it/s, est. speed input: 39364.51 toks/s, output: 38.44 toks/s]
Processed prompts:  62%|██████▎   | 160/256 [00:04<00:02, 33.08it/s, est. speed input: 39208.69 toks/s, output: 38.29 toks/s]
Processed prompts:  64%|██████▍   | 164/256 [00:04<00:02, 33.66it/s, est. speed input: 39121.98 toks/s, output: 38.20 toks/s]
Processed prompts:  66%|██████▌   | 168/256 [00:04<00:02, 34.36it/s, est. speed input: 39068.02 toks/s, output: 38.15 toks/s]
Processed prompts:  67%|██████▋   | 172/256 [00:04<00:02, 34.68it/s, est. speed input: 38998.51 toks/s, output: 38.08 toks/s]
Processed prompts:  69%|██████▉   | 176/256 [00:04<00:02, 35.12it/s, est. speed input: 38952.43 toks/s, output: 38.04 toks/s]
Processed prompts:  70%|███████   | 180/256 [00:04<00:02, 35.44it/s, est. speed input: 38908.37 toks/s, output: 38.00 toks/s]
Processed prompts:  72%|███████▏  | 184/256 [00:04<00:02, 35.62it/s, est. speed input: 38862.93 toks/s, output: 37.95 toks/s]
Processed prompts:  73%|███████▎  | 188/256 [00:04<00:01, 35.83it/s, est. speed input: 38826.36 toks/s, output: 37.92 toks/s]
Processed prompts:  75%|███████▌  | 192/256 [00:05<00:01, 36.03it/s, est. speed input: 38795.14 toks/s, output: 37.89 toks/s]
Processed prompts:  77%|███████▋  | 196/256 [00:05<00:01, 36.15it/s, est. speed input: 38763.36 toks/s, output: 37.85 toks/s]
Processed prompts:  78%|███████▊  | 200/256 [00:05<00:01, 35.67it/s, est. speed input: 38690.19 toks/s, output: 37.78 toks/s]
Processed prompts:  80%|███████▉  | 204/256 [00:05<00:01, 35.48it/s, est. speed input: 38631.77 toks/s, output: 37.73 toks/s]
Processed prompts:  81%|████████▏ | 208/256 [00:05<00:01, 35.42it/s, est. speed input: 38579.96 toks/s, output: 37.68 toks/s]
Processed prompts:  83%|████████▎ | 212/256 [00:05<00:01, 35.42it/s, est. speed input: 38533.41 toks/s, output: 37.63 toks/s]
Processed prompts:  84%|████████▍ | 216/256 [00:05<00:01, 35.38it/s, est. speed input: 38486.28 toks/s, output: 37.58 toks/s]
Processed prompts:  86%|████████▌ | 220/256 [00:05<00:01, 35.42it/s, est. speed input: 38445.57 toks/s, output: 37.54 toks/s]
Processed prompts:  88%|████████▊ | 224/256 [00:05<00:00, 35.53it/s, est. speed input: 38411.68 toks/s, output: 37.51 toks/s]
Processed prompts:  89%|████████▉ | 228/256 [00:06<00:00, 35.75it/s, est. speed input: 38389.13 toks/s, output: 37.49 toks/s]
Processed prompts:  91%|█████████ | 232/256 [00:06<00:00, 35.74it/s, est. speed input: 38356.16 toks/s, output: 37.46 toks/s]
Processed prompts:  92%|█████████▏| 236/256 [00:06<00:00, 35.60it/s, est. speed input: 38315.77 toks/s, output: 37.42 toks/s]
Processed prompts:  94%|█████████▍| 240/256 [00:06<00:00, 35.57it/s, est. speed input: 38281.87 toks/s, output: 37.38 toks/s]
Processed prompts:  95%|█████████▌| 244/256 [00:06<00:00, 35.60it/s, est. speed input: 38251.42 toks/s, output: 37.35 toks/s]
Processed prompts:  97%|█████████▋| 248/256 [00:06<00:00, 35.48it/s, est. speed input: 38213.91 toks/s, output: 37.32 toks/s]
Processed prompts:  98%|█████████▊| 252/256 [00:06<00:00, 34.71it/s, est. speed input: 38135.65 toks/s, output: 37.24 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:06<00:00, 34.23it/s, est. speed input: 38062.09 toks/s, output: 37.17 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:06<00:00, 34.23it/s, est. speed input: 38062.09 toks/s, output: 37.17 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:06<00:00, 37.17it/s, est. speed input: 38062.09 toks/s, output: 37.17 toks/s]
[rank0]:[W125 18:51:45.650837882 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=4096 ==========
Time: 2026-01-25 18:51:48
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-FP8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=512, max_num_seqs=4
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-FP8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 512 --max-num-seqs 4 --max-model-len 1025 --max-num-batched-tokens 4096 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_4/json/Llama3.2-1B-FP8_M4096.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 18:51:59 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 18:52:01 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=276892) WARNING 01-25 18:52:08 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=276892) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=276892) WARNING 01-25 18:52:14 [backends.py:609] Failed to read file <frozen os>
Throughput: 63.58 requests/s, 65169.92 total tokens/s, 63.58 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512

STDERR:
[2026-01-25 18:51:59] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:51:59] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-FP8'
[2026-01-25 18:51:59] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-FP8
[2026-01-25 18:51:59] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:51:59] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:51:59] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:51:59] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:51:59] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:51:59] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-FP8'
[2026-01-25 18:51:59] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:51:59] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:51:59] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:51:59] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:51:59] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 18:52:08] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:52:08] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-FP8'
[2026-01-25 18:52:08] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-FP8
[2026-01-25 18:52:08] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:52:08] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:52:08] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:52:08] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:52:08] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:52:08] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-FP8'
[2026-01-25 18:52:08] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:52:08] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:52:08] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:52:08] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:52:08] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=276892) [2026-01-25 18:52:09] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=276892) [2026-01-25 18:52:09] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=276892) [2026-01-25 18:52:09] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=276892) [2026-01-25 18:52:09] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=276892) [2026-01-25 18:52:09] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Llama3.2-1B-FP8
(EngineCore_DP0 pid=276892) [2026-01-25 18:52:09] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=276892) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=276892) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.69it/s]
(EngineCore_DP0 pid=276892) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.69it/s]
(EngineCore_DP0 pid=276892) 
(EngineCore_DP0 pid=276892) [2026-01-25 18:52:10] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 2048] -> 1D uint8
(EngineCore_DP0 pid=276892) [2026-01-25 18:52:10] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 4718592 bytes
(EngineCore_DP0 pid=276892) [2026-01-25 18:52:10] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2048, 2048] -> 1D uint8
(EngineCore_DP0 pid=276892) [2026-01-25 18:52:10] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 3145728 bytes
(EngineCore_DP0 pid=276892) [2026-01-25 18:52:10] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [16384, 2048] -> 1D uint8
(EngineCore_DP0 pid=276892) [2026-01-25 18:52:10] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 25165824 bytes
(EngineCore_DP0 pid=276892) [2026-01-25 18:52:10] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2048, 8192] -> 1D uint8
(EngineCore_DP0 pid=276892) [2026-01-25 18:52:10] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12582912 bytes
(EngineCore_DP0 pid=276892) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  25%|██▌       | 1/4 [00:00<00:00,  8.66it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  75%|███████▌  | 3/4 [00:00<00:00,  9.67it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  8.65it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  8.84it/s]
(EngineCore_DP0 pid=276892) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  33%|███▎      | 1/3 [00:00<00:00,  7.09it/s]
Capturing CUDA graphs (decode, FULL):  67%|██████▋   | 2/3 [00:00<00:00,  8.37it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  5.84it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  6.27it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   5%|▌         | 28/512 [00:00<00:01, 272.51it/s]
Adding requests:  12%|█▏        | 59/512 [00:00<00:01, 291.00it/s]
Adding requests:  18%|█▊        | 91/512 [00:00<00:01, 301.69it/s]
Adding requests:  24%|██▍       | 122/512 [00:00<00:01, 295.42it/s]
Adding requests:  30%|██▉       | 152/512 [00:00<00:01, 294.30it/s]
Adding requests:  36%|███▌      | 182/512 [00:00<00:01, 294.27it/s]
Adding requests:  41%|████▏     | 212/512 [00:00<00:01, 295.47it/s]
Adding requests:  47%|████▋     | 242/512 [00:00<00:00, 282.64it/s]
Adding requests:  53%|█████▎    | 271/512 [00:00<00:00, 282.36it/s]
Adding requests:  59%|█████▊    | 300/512 [00:01<00:00, 281.72it/s]
Adding requests:  64%|██████▍   | 330/512 [00:01<00:00, 285.28it/s]
Adding requests:  70%|███████   | 360/512 [00:01<00:00, 288.57it/s]
Adding requests:  76%|███████▌  | 389/512 [00:01<00:00, 287.06it/s]
Adding requests:  82%|████████▏ | 418/512 [00:01<00:00, 285.27it/s]
Adding requests:  87%|████████▋ | 447/512 [00:01<00:00, 282.22it/s]
Adding requests:  93%|█████████▎| 476/512 [00:01<00:00, 281.98it/s]
Adding requests:  99%|█████████▊| 505/512 [00:01<00:00, 277.66it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 285.29it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  18%|█▊        | 94/512 [00:00<00:00, 783.52it/s, est. speed input: 802494.44 toks/s, output: 783.58 toks/s]
Processed prompts:  34%|███▍      | 173/512 [00:01<00:02, 127.49it/s, est. speed input: 151181.15 toks/s, output: 147.64 toks/s]
Processed prompts:  41%|████      | 210/512 [00:01<00:02, 102.10it/s, est. speed input: 124165.84 toks/s, output: 121.25 toks/s]
Processed prompts:  46%|████▌     | 233/512 [00:02<00:02, 97.60it/s, est. speed input: 118630.29 toks/s, output: 115.85 toks/s] 
Processed prompts:  49%|████▉     | 251/512 [00:02<00:02, 89.41it/s, est. speed input: 112173.84 toks/s, output: 109.54 toks/s]
Processed prompts:  52%|█████▏    | 265/512 [00:02<00:02, 88.31it/s, est. speed input: 110320.10 toks/s, output: 107.73 toks/s]
Processed prompts:  54%|█████▍    | 277/512 [00:02<00:02, 84.32it/s, est. speed input: 107685.32 toks/s, output: 105.16 toks/s]
Processed prompts:  56%|█████▋    | 288/512 [00:02<00:02, 79.35it/s, est. speed input: 104949.27 toks/s, output: 102.49 toks/s]
Processed prompts:  58%|█████▊    | 297/512 [00:02<00:02, 78.51it/s, est. speed input: 103781.34 toks/s, output: 101.35 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:03<00:02, 70.27it/s, est. speed input: 100664.86 toks/s, output: 98.30 toks/s] 
Processed prompts:  61%|██████▏   | 314/512 [00:03<00:02, 69.02it/s, est. speed input: 99337.44 toks/s, output: 97.01 toks/s] 
Processed prompts:  63%|██████▎   | 322/512 [00:03<00:02, 67.92it/s, est. speed input: 98101.47 toks/s, output: 95.80 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:03<00:02, 67.31it/s, est. speed input: 97010.80 toks/s, output: 94.74 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:03<00:02, 66.80it/s, est. speed input: 95991.04 toks/s, output: 93.74 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:03<00:02, 65.30it/s, est. speed input: 94843.06 toks/s, output: 92.62 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:03<00:02, 65.34it/s, est. speed input: 93961.35 toks/s, output: 91.76 toks/s]
Processed prompts:  71%|███████   | 362/512 [00:03<00:02, 65.81it/s, est. speed input: 93201.41 toks/s, output: 91.02 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [00:04<00:02, 66.16it/s, est. speed input: 92485.73 toks/s, output: 90.32 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [00:04<00:02, 66.30it/s, est. speed input: 91796.15 toks/s, output: 89.64 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [00:04<00:01, 65.68it/s, est. speed input: 91049.91 toks/s, output: 88.92 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [00:04<00:01, 65.50it/s, est. speed input: 90377.47 toks/s, output: 88.26 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [00:04<00:01, 65.17it/s, est. speed input: 89715.79 toks/s, output: 87.61 toks/s]
Processed prompts:  80%|████████  | 410/512 [00:04<00:01, 65.05it/s, est. speed input: 89102.09 toks/s, output: 87.01 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [00:04<00:01, 64.98it/s, est. speed input: 88521.72 toks/s, output: 86.45 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [00:04<00:01, 65.20it/s, est. speed input: 88003.19 toks/s, output: 85.94 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [00:05<00:01, 65.32it/s, est. speed input: 87502.13 toks/s, output: 85.45 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [00:05<00:01, 65.25it/s, est. speed input: 87008.70 toks/s, output: 84.97 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [00:05<00:00, 64.55it/s, est. speed input: 86471.09 toks/s, output: 84.44 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [00:05<00:00, 64.87it/s, est. speed input: 86040.25 toks/s, output: 84.02 toks/s]
Processed prompts:  91%|█████████ | 466/512 [00:05<00:00, 64.78it/s, est. speed input: 85598.18 toks/s, output: 83.59 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [00:05<00:00, 64.89it/s, est. speed input: 85190.66 toks/s, output: 83.19 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [00:05<00:00, 64.98it/s, est. speed input: 84801.92 toks/s, output: 82.81 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [00:05<00:00, 64.17it/s, est. speed input: 84350.20 toks/s, output: 82.37 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [00:06<00:00, 64.89it/s, est. speed input: 84031.85 toks/s, output: 82.06 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [00:06<00:00, 64.77it/s, est. speed input: 83671.35 toks/s, output: 81.71 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:06<00:00, 64.77it/s, est. speed input: 83801.16 toks/s, output: 81.84 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:06<00:00, 81.83it/s, est. speed input: 83801.16 toks/s, output: 81.84 toks/s]
[rank0]:[W125 18:52:37.797873907 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=8192 ==========
Time: 2026-01-25 18:52:40
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-FP8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=1024, max_num_seqs=8
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-FP8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 1024 --max-num-seqs 8 --max-model-len 1025 --max-num-batched-tokens 8192 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_4/json/Llama3.2-1B-FP8_M8192.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 18:52:52 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 18:52:54 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=277874) WARNING 01-25 18:53:01 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=277874) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=277874) WARNING 01-25 18:53:09 [backends.py:609] Failed to read file <frozen os>
Throughput: 101.89 requests/s, 104436.93 total tokens/s, 101.89 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024

STDERR:
[2026-01-25 18:52:52] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:52:52] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-FP8'
[2026-01-25 18:52:52] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-FP8
[2026-01-25 18:52:52] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:52:52] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:52:52] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:52:52] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:52:52] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:52:52] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-FP8'
[2026-01-25 18:52:52] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:52:52] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:52:52] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:52:52] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:52:52] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 18:53:01] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:53:01] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-FP8'
[2026-01-25 18:53:01] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-FP8
[2026-01-25 18:53:01] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:53:01] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:53:01] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:53:01] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:53:01] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:53:01] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-FP8'
[2026-01-25 18:53:01] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:53:01] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:53:01] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:53:01] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:53:01] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=277874) [2026-01-25 18:53:02] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=277874) [2026-01-25 18:53:02] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=277874) [2026-01-25 18:53:02] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=277874) [2026-01-25 18:53:02] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=277874) [2026-01-25 18:53:02] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Llama3.2-1B-FP8
(EngineCore_DP0 pid=277874) [2026-01-25 18:53:02] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=277874) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=277874) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.75it/s]
(EngineCore_DP0 pid=277874) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.75it/s]
(EngineCore_DP0 pid=277874) 
(EngineCore_DP0 pid=277874) [2026-01-25 18:53:03] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 2048] -> 1D uint8
(EngineCore_DP0 pid=277874) [2026-01-25 18:53:03] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 4718592 bytes
(EngineCore_DP0 pid=277874) [2026-01-25 18:53:03] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2048, 2048] -> 1D uint8
(EngineCore_DP0 pid=277874) [2026-01-25 18:53:03] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 3145728 bytes
(EngineCore_DP0 pid=277874) [2026-01-25 18:53:03] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [16384, 2048] -> 1D uint8
(EngineCore_DP0 pid=277874) [2026-01-25 18:53:03] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 25165824 bytes
(EngineCore_DP0 pid=277874) [2026-01-25 18:53:03] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2048, 8192] -> 1D uint8
(EngineCore_DP0 pid=277874) [2026-01-25 18:53:03] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12582912 bytes
(EngineCore_DP0 pid=277874) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:00,  9.04it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  40%|████      | 2/5 [00:00<00:00,  9.50it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  80%|████████  | 4/5 [00:00<00:00, 10.27it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00,  9.55it/s]
(EngineCore_DP0 pid=277874) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:00,  8.18it/s]
Capturing CUDA graphs (decode, FULL):  75%|███████▌  | 3/4 [00:00<00:00,  9.81it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  9.85it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   3%|▎         | 28/1024 [00:00<00:03, 276.83it/s]
Adding requests:   6%|▌         | 59/1024 [00:00<00:03, 291.97it/s]
Adding requests:   9%|▉         | 91/1024 [00:00<00:03, 301.24it/s]
Adding requests:  12%|█▏        | 122/1024 [00:00<00:02, 303.23it/s]
Adding requests:  15%|█▍        | 153/1024 [00:00<00:02, 299.32it/s]
Adding requests:  18%|█▊        | 183/1024 [00:00<00:02, 299.47it/s]
Adding requests:  21%|██        | 214/1024 [00:00<00:02, 301.11it/s]
Adding requests:  24%|██▍       | 245/1024 [00:00<00:02, 296.12it/s]
Adding requests:  27%|██▋       | 276/1024 [00:00<00:02, 300.33it/s]
Adding requests:  30%|██▉       | 307/1024 [00:01<00:02, 298.06it/s]
Adding requests:  33%|███▎      | 337/1024 [00:01<00:02, 293.83it/s]
Adding requests:  36%|███▌      | 367/1024 [00:01<00:02, 293.95it/s]
Adding requests:  39%|███▉      | 397/1024 [00:01<00:02, 288.65it/s]
Adding requests:  42%|████▏     | 426/1024 [00:01<00:02, 279.07it/s]
Adding requests:  44%|████▍     | 454/1024 [00:01<00:02, 277.42it/s]
Adding requests:  47%|████▋     | 484/1024 [00:01<00:01, 281.05it/s]
Adding requests:  50%|█████     | 513/1024 [00:01<00:01, 274.36it/s]
Adding requests:  53%|█████▎    | 541/1024 [00:01<00:01, 271.89it/s]
Adding requests:  56%|█████▌    | 571/1024 [00:01<00:01, 279.80it/s]
Adding requests:  59%|█████▊    | 600/1024 [00:02<00:01, 280.42it/s]
Adding requests:  62%|██████▏   | 630/1024 [00:02<00:01, 283.12it/s]
Adding requests:  64%|██████▍   | 659/1024 [00:02<00:01, 283.79it/s]
Adding requests:  67%|██████▋   | 688/1024 [00:02<00:01, 281.65it/s]
Adding requests:  70%|███████   | 717/1024 [00:02<00:01, 271.49it/s]
Adding requests:  73%|███████▎  | 746/1024 [00:02<00:01, 276.36it/s]
Adding requests:  76%|███████▌  | 776/1024 [00:02<00:00, 281.18it/s]
Adding requests:  79%|███████▊  | 805/1024 [00:02<00:00, 280.39it/s]
Adding requests:  81%|████████▏ | 834/1024 [00:02<00:00, 282.30it/s]
Adding requests:  84%|████████▍ | 864/1024 [00:03<00:00, 284.76it/s]
Adding requests:  87%|████████▋ | 894/1024 [00:03<00:00, 287.23it/s]
Adding requests:  90%|█████████ | 924/1024 [00:03<00:00, 290.52it/s]
Adding requests:  93%|█████████▎| 954/1024 [00:03<00:00, 291.89it/s]
Adding requests:  96%|█████████▌| 984/1024 [00:03<00:00, 293.95it/s]
Adding requests:  99%|█████████▉| 1014/1024 [00:03<00:00, 290.12it/s]
Adding requests: 100%|██████████| 1024/1024 [00:03<00:00, 286.90it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:00<00:00, 2237.45it/s, est. speed input: 2291556.59 toks/s, output: 2237.57 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:02<00:02, 206.70it/s, est. speed input: 252639.26 toks/s, output: 246.72 toks/s]   
Processed prompts:  64%|██████▍   | 653/1024 [00:03<00:02, 174.91it/s, est. speed input: 216285.15 toks/s, output: 211.22 toks/s]
Processed prompts:  70%|██████▉   | 712/1024 [00:03<00:01, 162.23it/s, est. speed input: 203325.08 toks/s, output: 198.56 toks/s]
Processed prompts:  74%|███████▎  | 753/1024 [00:03<00:01, 153.59it/s, est. speed input: 195803.09 toks/s, output: 191.21 toks/s]
Processed prompts:  76%|███████▋  | 783/1024 [00:04<00:01, 145.01it/s, est. speed input: 189895.22 toks/s, output: 185.44 toks/s]
Processed prompts:  79%|███████▉  | 807/1024 [00:04<00:01, 139.87it/s, est. speed input: 186335.49 toks/s, output: 181.97 toks/s]
Processed prompts:  81%|████████  | 827/1024 [00:04<00:01, 129.60it/s, est. speed input: 181620.26 toks/s, output: 177.36 toks/s]
Processed prompts:  82%|████████▏ | 844/1024 [00:04<00:01, 126.67it/s, est. speed input: 179468.08 toks/s, output: 175.26 toks/s]
Processed prompts:  84%|████████▍ | 859/1024 [00:04<00:01, 121.26it/s, est. speed input: 177004.44 toks/s, output: 172.86 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [00:05<00:01, 116.32it/s, est. speed input: 174699.41 toks/s, output: 170.60 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [00:05<00:01, 113.56it/s, est. speed input: 172726.26 toks/s, output: 168.68 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [00:05<00:01, 111.33it/s, est. speed input: 170874.18 toks/s, output: 166.87 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [00:05<00:00, 109.50it/s, est. speed input: 169115.18 toks/s, output: 165.15 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [00:05<00:00, 109.80it/s, est. speed input: 167705.73 toks/s, output: 163.77 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [00:05<00:00, 108.43it/s, est. speed input: 166143.82 toks/s, output: 162.25 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [00:06<00:00, 107.44it/s, est. speed input: 164661.87 toks/s, output: 160.80 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [00:06<00:00, 108.17it/s, est. speed input: 163437.72 toks/s, output: 159.61 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [00:06<00:00, 107.07it/s, est. speed input: 162072.05 toks/s, output: 158.27 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [00:06<00:00, 107.39it/s, est. speed input: 160900.13 toks/s, output: 157.13 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:06<00:00, 107.39it/s, est. speed input: 161841.94 toks/s, output: 158.05 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:06<00:00, 158.05it/s, est. speed input: 161841.94 toks/s, output: 158.05 toks/s]
[rank0]:[W125 18:53:32.971232530 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=16384 ==========
Time: 2026-01-25 18:53:34
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-FP8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=2048, max_num_seqs=16
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-FP8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 2048 --max-num-seqs 16 --max-model-len 1025 --max-num-batched-tokens 16384 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_4/json/Llama3.2-1B-FP8_M16384.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 18:53:54 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 18:53:55 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=278950) WARNING 01-25 18:54:07 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=278950) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=278950) WARNING 01-25 18:54:14 [backends.py:609] Failed to read file <frozen os>
Throughput: 104.31 requests/s, 106914.10 total tokens/s, 104.31 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048

STDERR:
[2026-01-25 18:53:53] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:53:54] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-FP8'
[2026-01-25 18:53:54] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-FP8
[2026-01-25 18:53:54] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:53:54] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:53:54] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:53:54] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:53:54] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:53:54] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-FP8'
[2026-01-25 18:53:54] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:53:54] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:53:54] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:53:54] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:53:54] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 18:54:02] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:54:02] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-FP8'
[2026-01-25 18:54:02] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-FP8
[2026-01-25 18:54:02] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:54:02] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:54:02] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:54:02] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:54:02] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:54:02] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-FP8'
[2026-01-25 18:54:02] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:54:02] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:54:02] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:54:02] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:54:02] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=278950) [2026-01-25 18:54:07] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=278950) [2026-01-25 18:54:07] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=278950) [2026-01-25 18:54:07] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=278950) [2026-01-25 18:54:07] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=278950) [2026-01-25 18:54:07] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Llama3.2-1B-FP8
(EngineCore_DP0 pid=278950) [2026-01-25 18:54:07] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=278950) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=278950) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.06it/s]
(EngineCore_DP0 pid=278950) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.06it/s]
(EngineCore_DP0 pid=278950) 
(EngineCore_DP0 pid=278950) [2026-01-25 18:54:08] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 2048] -> 1D uint8
(EngineCore_DP0 pid=278950) [2026-01-25 18:54:08] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 4718592 bytes
(EngineCore_DP0 pid=278950) [2026-01-25 18:54:08] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2048, 2048] -> 1D uint8
(EngineCore_DP0 pid=278950) [2026-01-25 18:54:08] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 3145728 bytes
(EngineCore_DP0 pid=278950) [2026-01-25 18:54:08] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [16384, 2048] -> 1D uint8
(EngineCore_DP0 pid=278950) [2026-01-25 18:54:08] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 25165824 bytes
(EngineCore_DP0 pid=278950) [2026-01-25 18:54:08] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2048, 8192] -> 1D uint8
(EngineCore_DP0 pid=278950) [2026-01-25 18:54:08] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12582912 bytes
(EngineCore_DP0 pid=278950) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  14%|█▍        | 1/7 [00:00<00:00,  9.03it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  29%|██▊       | 2/7 [00:00<00:00,  9.54it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  57%|█████▋    | 4/7 [00:00<00:00, 10.29it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  86%|████████▌ | 6/7 [00:00<00:00, 10.54it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00,  9.97it/s]
(EngineCore_DP0 pid=278950) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  20%|██        | 1/5 [00:00<00:00,  8.09it/s]
Capturing CUDA graphs (decode, FULL):  60%|██████    | 3/5 [00:00<00:00, 10.02it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00, 10.56it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00, 10.28it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   1%|▏         | 28/2048 [00:00<00:07, 272.01it/s]
Adding requests:   3%|▎         | 58/2048 [00:00<00:07, 282.30it/s]
Adding requests:   4%|▍         | 89/2048 [00:00<00:06, 293.08it/s]
Adding requests:   6%|▌         | 120/2048 [00:00<00:06, 299.41it/s]
Adding requests:   7%|▋         | 151/2048 [00:00<00:06, 299.42it/s]
Adding requests:   9%|▉         | 181/2048 [00:00<00:06, 298.96it/s]
Adding requests:  10%|█         | 212/2048 [00:00<00:06, 299.99it/s]
Adding requests:  12%|█▏        | 243/2048 [00:00<00:05, 301.83it/s]
Adding requests:  13%|█▎        | 274/2048 [00:00<00:05, 296.49it/s]
Adding requests:  15%|█▍        | 304/2048 [00:01<00:05, 293.92it/s]
Adding requests:  16%|█▋        | 335/2048 [00:01<00:05, 296.25it/s]
Adding requests:  18%|█▊        | 365/2048 [00:01<00:05, 296.49it/s]
Adding requests:  19%|█▉        | 395/2048 [00:01<00:05, 293.46it/s]
Adding requests:  21%|██        | 425/2048 [00:01<00:05, 294.87it/s]
Adding requests:  22%|██▏       | 455/2048 [00:01<00:05, 290.44it/s]
Adding requests:  24%|██▎       | 485/2048 [00:01<00:05, 293.14it/s]
Adding requests:  25%|██▌       | 515/2048 [00:01<00:05, 290.02it/s]
Adding requests:  27%|██▋       | 545/2048 [00:01<00:05, 281.95it/s]
Adding requests:  28%|██▊       | 576/2048 [00:01<00:05, 287.03it/s]
Adding requests:  30%|██▉       | 605/2048 [00:02<00:05, 285.12it/s]
Adding requests:  31%|███       | 635/2048 [00:02<00:04, 288.79it/s]
Adding requests:  32%|███▏      | 664/2048 [00:02<00:04, 288.06it/s]
Adding requests:  34%|███▍      | 694/2048 [00:02<00:04, 289.93it/s]
Adding requests:  35%|███▌      | 724/2048 [00:02<00:04, 281.83it/s]
Adding requests:  37%|███▋      | 753/2048 [00:02<00:04, 281.33it/s]
Adding requests:  38%|███▊      | 782/2048 [00:02<00:04, 280.58it/s]
Adding requests:  40%|███▉      | 811/2048 [00:02<00:04, 275.93it/s]
Adding requests:  41%|████      | 839/2048 [00:02<00:04, 269.36it/s]
Adding requests:  42%|████▏     | 869/2048 [00:03<00:04, 277.18it/s]
Adding requests:  44%|████▍     | 900/2048 [00:03<00:04, 285.41it/s]
Adding requests:  45%|████▌     | 930/2048 [00:03<00:03, 286.82it/s]
Adding requests:  47%|████▋     | 960/2048 [00:03<00:03, 290.28it/s]
Adding requests:  48%|████▊     | 990/2048 [00:03<00:03, 290.19it/s]
Adding requests:  50%|████▉     | 1020/2048 [00:03<00:03, 286.83it/s]
Adding requests:  51%|█████▏    | 1050/2048 [00:03<00:03, 289.42it/s]
Adding requests:  53%|█████▎    | 1081/2048 [00:03<00:03, 293.95it/s]
Adding requests:  54%|█████▍    | 1112/2048 [00:03<00:03, 297.27it/s]
Adding requests:  56%|█████▌    | 1144/2048 [00:03<00:02, 302.99it/s]
Adding requests:  58%|█████▊    | 1178/2048 [00:04<00:02, 313.84it/s]
Adding requests:  59%|█████▉    | 1211/2048 [00:04<00:02, 318.63it/s]
Adding requests:  61%|██████    | 1243/2048 [00:04<00:02, 316.60it/s]
Adding requests:  62%|██████▏   | 1275/2048 [00:04<00:02, 316.80it/s]
Adding requests:  64%|██████▍   | 1307/2048 [00:04<00:02, 316.56it/s]
Adding requests:  65%|██████▌   | 1339/2048 [00:04<00:02, 314.79it/s]
Adding requests:  67%|██████▋   | 1372/2048 [00:04<00:02, 318.24it/s]
Adding requests:  69%|██████▊   | 1406/2048 [00:04<00:01, 322.39it/s]
Adding requests:  70%|███████   | 1439/2048 [00:04<00:01, 318.19it/s]
Adding requests:  72%|███████▏  | 1471/2048 [00:04<00:01, 312.52it/s]
Adding requests:  73%|███████▎  | 1503/2048 [00:05<00:01, 313.88it/s]
Adding requests:  75%|███████▍  | 1535/2048 [00:05<00:01, 310.95it/s]
Adding requests:  77%|███████▋  | 1567/2048 [00:05<00:01, 308.93it/s]
Adding requests:  78%|███████▊  | 1600/2048 [00:05<00:01, 313.45it/s]
Adding requests:  80%|███████▉  | 1632/2048 [00:05<00:01, 312.51it/s]
Adding requests:  81%|████████▏ | 1664/2048 [00:05<00:01, 303.82it/s]
Adding requests:  83%|████████▎ | 1695/2048 [00:05<00:01, 302.08it/s]
Adding requests:  84%|████████▍ | 1728/2048 [00:05<00:01, 307.85it/s]
Adding requests:  86%|████████▌ | 1759/2048 [00:05<00:00, 304.61it/s]
Adding requests:  87%|████████▋ | 1790/2048 [00:06<00:00, 302.21it/s]
Adding requests:  89%|████████▉ | 1823/2048 [00:06<00:00, 309.39it/s]
Adding requests:  91%|█████████ | 1854/2048 [00:06<00:00, 303.84it/s]
Adding requests:  92%|█████████▏| 1888/2048 [00:06<00:00, 312.32it/s]
Adding requests:  94%|█████████▍| 1920/2048 [00:06<00:00, 314.48it/s]
Adding requests:  95%|█████████▌| 1952/2048 [00:06<00:00, 310.81it/s]
Adding requests:  97%|█████████▋| 1984/2048 [00:06<00:00, 304.81it/s]
Adding requests:  98%|█████████▊| 2015/2048 [00:06<00:00, 304.47it/s]
Adding requests: 100%|█████████▉| 2046/2048 [00:06<00:00, 302.97it/s]
Adding requests: 100%|██████████| 2048/2048 [00:06<00:00, 299.20it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [00:00<00:00, 5338.32it/s, est. speed input: 5467722.44 toks/s, output: 5338.73 toks/s]
Processed prompts:  60%|█████▉    | 1224/2048 [00:05<00:04, 199.29it/s, est. speed input: 243763.39 toks/s, output: 238.05 toks/s]  
Processed prompts:  71%|███████   | 1451/2048 [00:07<00:03, 168.77it/s, est. speed input: 208302.75 toks/s, output: 203.42 toks/s]
Processed prompts:  77%|███████▋  | 1580/2048 [00:08<00:03, 154.35it/s, est. speed input: 194170.17 toks/s, output: 189.62 toks/s]
Processed prompts:  81%|████████  | 1662/2048 [00:09<00:02, 145.81it/s, est. speed input: 186942.55 toks/s, output: 182.56 toks/s]
Processed prompts:  84%|████████▍ | 1719/2048 [00:09<00:02, 136.83it/s, est. speed input: 181106.63 toks/s, output: 176.86 toks/s]
Processed prompts:  86%|████████▌ | 1760/2048 [00:10<00:02, 136.38it/s, est. speed input: 179712.04 toks/s, output: 175.50 toks/s]
Processed prompts:  88%|████████▊ | 1792/2048 [00:10<00:01, 132.06it/s, est. speed input: 177528.74 toks/s, output: 173.37 toks/s]
Processed prompts:  89%|████████▊ | 1817/2048 [00:10<00:01, 123.88it/s, est. speed input: 174784.80 toks/s, output: 170.69 toks/s]
Processed prompts:  90%|████████▉ | 1837/2048 [00:10<00:01, 124.46it/s, est. speed input: 174181.71 toks/s, output: 170.10 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [00:10<00:00, 255.48it/s, est. speed input: 188405.11 toks/s, output: 183.99 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:11<00:00, 255.48it/s, est. speed input: 188691.72 toks/s, output: 184.27 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:11<00:00, 184.27it/s, est. speed input: 188691.72 toks/s, output: 184.27 toks/s]
[rank0]:[W125 18:54:45.766750420 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=32768 ==========
Time: 2026-01-25 18:54:48
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-FP8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=4096, max_num_seqs=32
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-FP8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 4096 --max-num-seqs 32 --max-model-len 1025 --max-num-batched-tokens 32768 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_4/json/Llama3.2-1B-FP8_M32768.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 18:55:21 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 18:55:22 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=280411) WARNING 01-25 18:55:30 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=280411) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=280411) WARNING 01-25 18:55:38 [backends.py:609] Failed to read file <frozen os>
Throughput: 106.39 requests/s, 109051.26 total tokens/s, 106.39 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096

STDERR:
[2026-01-25 18:55:21] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:55:21] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-FP8'
[2026-01-25 18:55:21] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-FP8
[2026-01-25 18:55:21] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:55:21] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:55:21] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:55:21] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:55:21] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:55:21] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-FP8'
[2026-01-25 18:55:21] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:55:21] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:55:21] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:55:21] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:55:21] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 18:55:29] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:55:29] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-FP8'
[2026-01-25 18:55:29] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-FP8
[2026-01-25 18:55:29] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:55:29] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:55:29] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:55:29] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:55:29] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:55:29] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-FP8'
[2026-01-25 18:55:29] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:55:29] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:55:29] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:55:29] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:55:29] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=280411) [2026-01-25 18:55:31] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=280411) [2026-01-25 18:55:31] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=280411) [2026-01-25 18:55:31] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=280411) [2026-01-25 18:55:31] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=280411) [2026-01-25 18:55:31] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Llama3.2-1B-FP8
(EngineCore_DP0 pid=280411) [2026-01-25 18:55:31] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=280411) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=280411) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.71it/s]
(EngineCore_DP0 pid=280411) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.71it/s]
(EngineCore_DP0 pid=280411) 
(EngineCore_DP0 pid=280411) [2026-01-25 18:55:31] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 2048] -> 1D uint8
(EngineCore_DP0 pid=280411) [2026-01-25 18:55:31] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 4718592 bytes
(EngineCore_DP0 pid=280411) [2026-01-25 18:55:31] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2048, 2048] -> 1D uint8
(EngineCore_DP0 pid=280411) [2026-01-25 18:55:31] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 3145728 bytes
(EngineCore_DP0 pid=280411) [2026-01-25 18:55:31] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [16384, 2048] -> 1D uint8
(EngineCore_DP0 pid=280411) [2026-01-25 18:55:31] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 25165824 bytes
(EngineCore_DP0 pid=280411) [2026-01-25 18:55:31] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2048, 8192] -> 1D uint8
(EngineCore_DP0 pid=280411) [2026-01-25 18:55:31] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12582912 bytes
(EngineCore_DP0 pid=280411) [rank0]:W0125 18:55:43.595000 280411 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=280411) [rank0]:W0125 18:55:43.668000 280411 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=280411) [rank0]:W0125 18:55:44.695000 280411 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=280411) [rank0]:W0125 18:55:44.797000 280411 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=280411) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   9%|▉         | 1/11 [00:00<00:01,  8.28it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  18%|█▊        | 2/11 [00:00<00:01,  8.62it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  27%|██▋       | 3/11 [00:00<00:00,  9.04it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  36%|███▋      | 4/11 [00:00<00:00,  9.22it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  55%|█████▍    | 6/11 [00:00<00:00,  9.59it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  64%|██████▎   | 7/11 [00:00<00:00,  9.61it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  73%|███████▎  | 8/11 [00:00<00:00,  9.63it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  82%|████████▏ | 9/11 [00:00<00:00,  9.72it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  91%|█████████ | 10/11 [00:01<00:00,  9.80it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00,  9.07it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00,  9.31it/s]
(EngineCore_DP0 pid=280411) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  14%|█▍        | 1/7 [00:00<00:00,  7.50it/s]
Capturing CUDA graphs (decode, FULL):  29%|██▊       | 2/7 [00:00<00:00,  8.71it/s]
Capturing CUDA graphs (decode, FULL):  43%|████▎     | 3/7 [00:00<00:00,  9.12it/s]
Capturing CUDA graphs (decode, FULL):  57%|█████▋    | 4/7 [00:00<00:00,  9.44it/s]
Capturing CUDA graphs (decode, FULL):  71%|███████▏  | 5/7 [00:00<00:00,  9.55it/s]
Capturing CUDA graphs (decode, FULL):  86%|████████▌ | 6/7 [00:00<00:00,  9.65it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00,  8.49it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00,  8.86it/s]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   1%|          | 30/4096 [00:00<00:13, 295.70it/s]
Adding requests:   2%|▏         | 62/4096 [00:00<00:13, 307.92it/s]
Adding requests:   2%|▏         | 96/4096 [00:00<00:12, 318.05it/s]
Adding requests:   3%|▎         | 131/4096 [00:00<00:12, 326.92it/s]
Adding requests:   4%|▍         | 164/4096 [00:00<00:12, 323.52it/s]
Adding requests:   5%|▍         | 197/4096 [00:00<00:12, 315.59it/s]
Adding requests:   6%|▌         | 230/4096 [00:00<00:12, 319.24it/s]
Adding requests:   6%|▋         | 264/4096 [00:00<00:11, 323.78it/s]
Adding requests:   7%|▋         | 297/4096 [00:00<00:11, 321.34it/s]
Adding requests:   8%|▊         | 330/4096 [00:01<00:11, 314.23it/s]
Adding requests:   9%|▉         | 362/4096 [00:01<00:11, 315.06it/s]
Adding requests:  10%|▉         | 394/4096 [00:01<00:11, 313.15it/s]
Adding requests:  10%|█         | 426/4096 [00:01<00:11, 313.15it/s]
Adding requests:  11%|█         | 458/4096 [00:01<00:11, 312.30it/s]
Adding requests:  12%|█▏        | 490/4096 [00:01<00:11, 313.02it/s]
Adding requests:  13%|█▎        | 522/4096 [00:01<00:11, 303.77it/s]
Adding requests:  14%|█▎        | 553/4096 [00:01<00:11, 304.39it/s]
Adding requests:  14%|█▍        | 584/4096 [00:01<00:11, 305.22it/s]
Adding requests:  15%|█▌        | 615/4096 [00:01<00:11, 300.67it/s]
Adding requests:  16%|█▌        | 648/4096 [00:02<00:11, 307.30it/s]
Adding requests:  17%|█▋        | 682/4096 [00:02<00:10, 314.72it/s]
Adding requests:  17%|█▋        | 714/4096 [00:02<00:10, 316.24it/s]
Adding requests:  18%|█▊        | 746/4096 [00:02<00:10, 316.32it/s]
Adding requests:  19%|█▉        | 778/4096 [00:02<00:10, 317.27it/s]
Adding requests:  20%|█▉        | 810/4096 [00:02<00:10, 307.46it/s]
Adding requests:  21%|██        | 841/4096 [00:02<00:10, 301.02it/s]
Adding requests:  21%|██▏       | 872/4096 [00:02<00:10, 299.71it/s]
Adding requests:  22%|██▏       | 903/4096 [00:02<00:10, 299.91it/s]
Adding requests:  23%|██▎       | 934/4096 [00:03<00:10, 296.77it/s]
Adding requests:  24%|██▎       | 964/4096 [00:03<00:10, 297.26it/s]
Adding requests:  24%|██▍       | 994/4096 [00:03<00:10, 294.89it/s]
Adding requests:  25%|██▌       | 1025/4096 [00:03<00:10, 297.81it/s]
Adding requests:  26%|██▌       | 1055/4096 [00:03<00:10, 297.60it/s]
Adding requests:  26%|██▋       | 1085/4096 [00:03<00:10, 285.12it/s]
Adding requests:  27%|██▋       | 1115/4096 [00:03<00:10, 287.87it/s]
Adding requests:  28%|██▊       | 1147/4096 [00:03<00:09, 296.99it/s]
Adding requests:  29%|██▉       | 1178/4096 [00:03<00:09, 298.72it/s]
Adding requests:  30%|██▉       | 1209/4096 [00:03<00:09, 299.53it/s]
Adding requests:  30%|███       | 1239/4096 [00:04<00:09, 296.02it/s]
Adding requests:  31%|███       | 1269/4096 [00:04<00:09, 286.41it/s]
Adding requests:  32%|███▏      | 1299/4096 [00:04<00:09, 289.87it/s]
Adding requests:  32%|███▏      | 1330/4096 [00:04<00:09, 292.77it/s]
Adding requests:  33%|███▎      | 1360/4096 [00:04<00:09, 291.10it/s]
Adding requests:  34%|███▍      | 1392/4096 [00:04<00:09, 297.29it/s]
Adding requests:  35%|███▍      | 1423/4096 [00:04<00:08, 298.05it/s]
Adding requests:  35%|███▌      | 1453/4096 [00:04<00:08, 294.40it/s]
Adding requests:  36%|███▌      | 1483/4096 [00:04<00:08, 295.66it/s]
Adding requests:  37%|███▋      | 1514/4096 [00:04<00:08, 297.07it/s]
Adding requests:  38%|███▊      | 1544/4096 [00:05<00:08, 292.78it/s]
Adding requests:  38%|███▊      | 1574/4096 [00:05<00:08, 288.03it/s]
Adding requests:  39%|███▉      | 1606/4096 [00:05<00:08, 294.77it/s]
Adding requests:  40%|███▉      | 1637/4096 [00:05<00:08, 297.03it/s]
Adding requests:  41%|████      | 1668/4096 [00:05<00:08, 298.89it/s]
Adding requests:  42%|████▏     | 1700/4096 [00:05<00:07, 304.75it/s]
Adding requests:  42%|████▏     | 1732/4096 [00:05<00:07, 306.36it/s]
Adding requests:  43%|████▎     | 1764/4096 [00:05<00:07, 309.63it/s]
Adding requests:  44%|████▍     | 1796/4096 [00:05<00:07, 310.75it/s]
Adding requests:  45%|████▍     | 1828/4096 [00:06<00:07, 300.23it/s]
Adding requests:  45%|████▌     | 1860/4096 [00:06<00:07, 303.44it/s]
Adding requests:  46%|████▌     | 1891/4096 [00:06<00:07, 300.33it/s]
Adding requests:  47%|████▋     | 1922/4096 [00:06<00:07, 296.54it/s]
Adding requests:  48%|████▊     | 1954/4096 [00:06<00:07, 302.49it/s]
Adding requests:  48%|████▊     | 1986/4096 [00:06<00:06, 305.00it/s]
Adding requests:  49%|████▉     | 2017/4096 [00:06<00:06, 305.09it/s]
Adding requests:  50%|█████     | 2050/4096 [00:06<00:06, 309.92it/s]
Adding requests:  51%|█████     | 2082/4096 [00:06<00:06, 305.11it/s]
Adding requests:  52%|█████▏    | 2113/4096 [00:06<00:06, 304.34it/s]
Adding requests:  52%|█████▏    | 2144/4096 [00:07<00:06, 301.71it/s]
Adding requests:  53%|█████▎    | 2175/4096 [00:07<00:06, 301.30it/s]
Adding requests:  54%|█████▍    | 2206/4096 [00:07<00:06, 296.67it/s]
Adding requests:  55%|█████▍    | 2236/4096 [00:07<00:06, 282.26it/s]
Adding requests:  55%|█████▌    | 2266/4096 [00:07<00:06, 285.44it/s]
Adding requests:  56%|█████▌    | 2297/4096 [00:07<00:06, 290.82it/s]
Adding requests:  57%|█████▋    | 2327/4096 [00:07<00:06, 290.49it/s]
Adding requests:  58%|█████▊    | 2357/4096 [00:07<00:06, 289.59it/s]
Adding requests:  58%|█████▊    | 2387/4096 [00:07<00:05, 292.19it/s]
Adding requests:  59%|█████▉    | 2417/4096 [00:08<00:05, 292.05it/s]
Adding requests:  60%|█████▉    | 2447/4096 [00:08<00:05, 285.85it/s]
Adding requests:  60%|██████    | 2476/4096 [00:08<00:05, 286.82it/s]
Adding requests:  61%|██████    | 2505/4096 [00:08<00:05, 282.34it/s]
Adding requests:  62%|██████▏   | 2534/4096 [00:08<00:05, 280.42it/s]
Adding requests:  63%|██████▎   | 2564/4096 [00:08<00:05, 284.43it/s]
Adding requests:  63%|██████▎   | 2596/4096 [00:08<00:05, 292.89it/s]
Adding requests:  64%|██████▍   | 2627/4096 [00:08<00:04, 297.32it/s]
Adding requests:  65%|██████▍   | 2658/4096 [00:08<00:04, 300.49it/s]
Adding requests:  66%|██████▌   | 2689/4096 [00:08<00:04, 299.23it/s]
Adding requests:  66%|██████▋   | 2722/4096 [00:09<00:04, 305.73it/s]
Adding requests:  67%|██████▋   | 2755/4096 [00:09<00:04, 310.83it/s]
Adding requests:  68%|██████▊   | 2788/4096 [00:09<00:04, 316.32it/s]
Adding requests:  69%|██████▉   | 2820/4096 [00:09<00:04, 314.71it/s]
Adding requests:  70%|██████▉   | 2853/4096 [00:09<00:03, 319.19it/s]
Adding requests:  70%|███████   | 2885/4096 [00:09<00:03, 315.71it/s]
Adding requests:  71%|███████   | 2917/4096 [00:09<00:03, 316.85it/s]
Adding requests:  72%|███████▏  | 2950/4096 [00:09<00:03, 320.60it/s]
Adding requests:  73%|███████▎  | 2983/4096 [00:09<00:03, 322.66it/s]
Adding requests:  74%|███████▎  | 3016/4096 [00:09<00:03, 323.14it/s]
Adding requests:  74%|███████▍  | 3049/4096 [00:10<00:03, 325.14it/s]
Adding requests:  75%|███████▌  | 3082/4096 [00:10<00:03, 317.63it/s]
Adding requests:  76%|███████▌  | 3115/4096 [00:10<00:03, 319.82it/s]
Adding requests:  77%|███████▋  | 3148/4096 [00:10<00:02, 321.06it/s]
Adding requests:  78%|███████▊  | 3181/4096 [00:10<00:02, 319.05it/s]
Adding requests:  78%|███████▊  | 3213/4096 [00:10<00:02, 305.04it/s]
Adding requests:  79%|███████▉  | 3244/4096 [00:10<00:02, 301.95it/s]
Adding requests:  80%|███████▉  | 3275/4096 [00:10<00:02, 296.69it/s]
Adding requests:  81%|████████  | 3305/4096 [00:10<00:02, 295.83it/s]
Adding requests:  81%|████████▏ | 3335/4096 [00:11<00:02, 290.64it/s]
Adding requests:  82%|████████▏ | 3365/4096 [00:11<00:02, 290.55it/s]
Adding requests:  83%|████████▎ | 3395/4096 [00:11<00:02, 285.04it/s]
Adding requests:  84%|████████▎ | 3425/4096 [00:11<00:02, 289.26it/s]
Adding requests:  84%|████████▍ | 3454/4096 [00:11<00:02, 284.98it/s]
Adding requests:  85%|████████▌ | 3483/4096 [00:11<00:02, 283.02it/s]
Adding requests:  86%|████████▌ | 3512/4096 [00:11<00:02, 273.36it/s]
Adding requests:  86%|████████▋ | 3542/4096 [00:11<00:01, 278.98it/s]
Adding requests:  87%|████████▋ | 3573/4096 [00:11<00:01, 286.10it/s]
Adding requests:  88%|████████▊ | 3604/4096 [00:11<00:01, 290.83it/s]
Adding requests:  89%|████████▊ | 3634/4096 [00:12<00:01, 289.47it/s]
Adding requests:  89%|████████▉ | 3663/4096 [00:12<00:01, 289.00it/s]
Adding requests:  90%|█████████ | 3693/4096 [00:12<00:01, 289.02it/s]
Adding requests:  91%|█████████ | 3722/4096 [00:12<00:01, 286.96it/s]
Adding requests:  92%|█████████▏| 3753/4096 [00:12<00:01, 292.95it/s]
Adding requests:  92%|█████████▏| 3786/4096 [00:12<00:01, 300.61it/s]
Adding requests:  93%|█████████▎| 3817/4096 [00:12<00:00, 297.82it/s]
Adding requests:  94%|█████████▍| 3847/4096 [00:12<00:00, 297.44it/s]
Adding requests:  95%|█████████▍| 3879/4096 [00:12<00:00, 302.41it/s]
Adding requests:  95%|█████████▌| 3910/4096 [00:12<00:00, 299.13it/s]
Adding requests:  96%|█████████▌| 3940/4096 [00:13<00:00, 296.91it/s]
Adding requests:  97%|█████████▋| 3971/4096 [00:13<00:00, 297.93it/s]
Adding requests:  98%|█████████▊| 4001/4096 [00:13<00:00, 293.84it/s]
Adding requests:  98%|█████████▊| 4032/4096 [00:13<00:00, 297.12it/s]
Adding requests:  99%|█████████▉| 4062/4096 [00:13<00:00, 294.66it/s]
Adding requests: 100%|█████████▉| 4093/4096 [00:13<00:00, 299.05it/s]
Adding requests: 100%|██████████| 4096/4096 [00:13<00:00, 300.71it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  34%|███▍      | 1406/4096 [00:00<00:00, 8629.89it/s, est. speed input: 8838907.63 toks/s, output: 8630.41 toks/s]
Processed prompts:  55%|█████▌    | 2269/4096 [00:07<00:07, 235.44it/s, est. speed input: 294310.48 toks/s, output: 287.41 toks/s]   
Processed prompts:  64%|██████▍   | 2631/4096 [00:11<00:07, 183.58it/s, est. speed input: 235960.73 toks/s, output: 230.43 toks/s]
Processed prompts:  69%|██████▉   | 2846/4096 [00:11<00:06, 207.74it/s, est. speed input: 248684.89 toks/s, output: 242.86 toks/s]
Processed prompts:  73%|███████▎  | 2997/4096 [00:12<00:05, 192.89it/s, est. speed input: 238678.77 toks/s, output: 233.08 toks/s]
Processed prompts:  76%|███████▌  | 3098/4096 [00:13<00:05, 177.41it/s, est. speed input: 230223.24 toks/s, output: 224.83 toks/s]
Processed prompts:  77%|███████▋  | 3169/4096 [00:14<00:05, 156.41it/s, est. speed input: 220758.86 toks/s, output: 215.58 toks/s]
Processed prompts:  79%|███████▊  | 3219/4096 [00:15<00:05, 156.90it/s, est. speed input: 219623.59 toks/s, output: 214.48 toks/s]
Processed prompts:  80%|███████▉  | 3259/4096 [00:15<00:05, 153.74it/s, est. speed input: 217869.16 toks/s, output: 212.76 toks/s]
Processed prompts:  80%|████████  | 3290/4096 [00:15<00:05, 146.15it/s, est. speed input: 215587.07 toks/s, output: 210.53 toks/s]
Processed prompts:  81%|████████  | 3315/4096 [00:15<00:05, 135.39it/s, est. speed input: 213050.90 toks/s, output: 208.06 toks/s]
Processed prompts:  81%|████████▏ | 3335/4096 [00:16<00:06, 121.54it/s, est. speed input: 210234.34 toks/s, output: 205.31 toks/s]
Processed prompts:  82%|████████▏ | 3358/4096 [00:16<00:06, 111.38it/s, est. speed input: 207741.52 toks/s, output: 202.87 toks/s]
Processed prompts:  83%|████████▎ | 3390/4096 [00:16<00:06, 109.57it/s, est. speed input: 205884.00 toks/s, output: 201.06 toks/s]
Processed prompts:  84%|████████▎ | 3422/4096 [00:17<00:06, 108.07it/s, est. speed input: 204088.84 toks/s, output: 199.31 toks/s]
Processed prompts:  84%|████████▍ | 3454/4096 [00:17<00:06, 106.88it/s, est. speed input: 202356.13 toks/s, output: 197.61 toks/s]
Processed prompts:  85%|████████▌ | 3486/4096 [00:17<00:05, 105.97it/s, est. speed input: 200683.78 toks/s, output: 195.98 toks/s]
Processed prompts:  86%|████████▌ | 3518/4096 [00:18<00:05, 105.27it/s, est. speed input: 199065.71 toks/s, output: 194.40 toks/s]
Processed prompts:  87%|████████▋ | 3550/4096 [00:18<00:05, 105.90it/s, est. speed input: 197625.86 toks/s, output: 192.99 toks/s]
Processed prompts:  87%|████████▋ | 3582/4096 [00:18<00:04, 107.64it/s, est. speed input: 196362.76 toks/s, output: 191.76 toks/s]
Processed prompts:  88%|████████▊ | 3614/4096 [00:18<00:04, 108.94it/s, est. speed input: 195138.37 toks/s, output: 190.56 toks/s]
Processed prompts:  89%|████████▉ | 3646/4096 [00:19<00:04, 109.87it/s, est. speed input: 193948.59 toks/s, output: 189.40 toks/s]
Processed prompts:  90%|████████▉ | 3678/4096 [00:19<00:03, 110.59it/s, est. speed input: 192797.58 toks/s, output: 188.28 toks/s]
Processed prompts:  91%|█████████ | 3710/4096 [00:19<00:03, 111.11it/s, est. speed input: 191680.36 toks/s, output: 187.19 toks/s]
Processed prompts:  91%|█████████▏| 3742/4096 [00:20<00:03, 112.23it/s, est. speed input: 190656.18 toks/s, output: 186.19 toks/s]
Processed prompts:  92%|█████████▏| 3774/4096 [00:20<00:02, 112.20it/s, est. speed input: 189594.18 toks/s, output: 185.15 toks/s]
Processed prompts:  93%|█████████▎| 3806/4096 [00:20<00:02, 112.18it/s, est. speed input: 188562.51 toks/s, output: 184.14 toks/s]
Processed prompts:  94%|█████████▎| 3838/4096 [00:20<00:02, 111.93it/s, est. speed input: 187540.02 toks/s, output: 183.14 toks/s]
Processed prompts:  94%|█████████▍| 3870/4096 [00:21<00:02, 109.23it/s, est. speed input: 186351.25 toks/s, output: 181.98 toks/s]
Processed prompts:  95%|█████████▌| 3902/4096 [00:21<00:01, 107.23it/s, est. speed input: 185182.03 toks/s, output: 180.84 toks/s]
Processed prompts:  96%|█████████▌| 3934/4096 [00:21<00:01, 106.07it/s, est. speed input: 184062.88 toks/s, output: 179.75 toks/s]
Processed prompts:  97%|█████████▋| 3966/4096 [00:22<00:01, 105.31it/s, est. speed input: 182976.34 toks/s, output: 178.69 toks/s]
Processed prompts:  98%|█████████▊| 3998/4096 [00:22<00:00, 104.73it/s, est. speed input: 181916.05 toks/s, output: 177.65 toks/s]
Processed prompts:  98%|█████████▊| 4030/4096 [00:22<00:00, 105.19it/s, est. speed input: 180951.27 toks/s, output: 176.71 toks/s]
Processed prompts:  99%|█████████▉| 4062/4096 [00:23<00:00, 105.14it/s, est. speed input: 179983.61 toks/s, output: 175.77 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [00:23<00:00, 105.14it/s, est. speed input: 180922.31 toks/s, output: 176.68 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [00:23<00:00, 176.68it/s, est. speed input: 180922.31 toks/s, output: 176.68 toks/s]
[rank0]:[W125 18:56:29.029552836 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=65536 ==========
Time: 2026-01-25 18:56:32
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-FP8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=8192, max_num_seqs=64
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-FP8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 8192 --max-num-seqs 64 --max-model-len 1025 --max-num-batched-tokens 65536 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_4/json/Llama3.2-1B-FP8_M65536.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 18:57:30 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 18:57:31 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=282483) WARNING 01-25 18:57:39 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=282483) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=282483) WARNING 01-25 18:57:46 [backends.py:609] Failed to read file <frozen os>
Throughput: 106.85 requests/s, 109516.39 total tokens/s, 106.85 output tokens/s
Total num prompt tokens:  8388608
Total num output tokens:  8192

STDERR:
[2026-01-25 18:57:30] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:57:30] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-FP8'
[2026-01-25 18:57:30] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-FP8
[2026-01-25 18:57:30] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:57:30] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:57:30] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:57:30] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:57:30] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:57:30] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-FP8'
[2026-01-25 18:57:30] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:57:30] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:57:30] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:57:30] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:57:30] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 18:57:38] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:57:38] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-FP8'
[2026-01-25 18:57:38] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-FP8
[2026-01-25 18:57:38] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:57:38] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:57:38] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:57:38] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:57:38] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-25 18:57:38] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-FP8'
[2026-01-25 18:57:38] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:57:38] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:57:38] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:57:38] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:57:38] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=282483) [2026-01-25 18:57:40] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=282483) [2026-01-25 18:57:40] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=282483) [2026-01-25 18:57:40] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=282483) [2026-01-25 18:57:40] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=282483) [2026-01-25 18:57:40] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Llama3.2-1B-FP8
(EngineCore_DP0 pid=282483) [2026-01-25 18:57:40] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=282483) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=282483) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.85it/s]
(EngineCore_DP0 pid=282483) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.85it/s]
(EngineCore_DP0 pid=282483) 
(EngineCore_DP0 pid=282483) [2026-01-25 18:57:40] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 2048] -> 1D uint8
(EngineCore_DP0 pid=282483) [2026-01-25 18:57:40] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 4718592 bytes
(EngineCore_DP0 pid=282483) [2026-01-25 18:57:40] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2048, 2048] -> 1D uint8
(EngineCore_DP0 pid=282483) [2026-01-25 18:57:40] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 3145728 bytes
(EngineCore_DP0 pid=282483) [2026-01-25 18:57:40] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [16384, 2048] -> 1D uint8
(EngineCore_DP0 pid=282483) [2026-01-25 18:57:40] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 25165824 bytes
(EngineCore_DP0 pid=282483) [2026-01-25 18:57:40] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2048, 8192] -> 1D uint8
(EngineCore_DP0 pid=282483) [2026-01-25 18:57:40] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12582912 bytes
(EngineCore_DP0 pid=282483) [rank0]:W0125 18:57:50.689000 282483 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=282483) [rank0]:W0125 18:57:50.771000 282483 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=282483) [rank0]:W0125 18:57:51.879000 282483 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=282483) [rank0]:W0125 18:57:51.989000 282483 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=282483) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/19 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   5%|▌         | 1/19 [00:00<00:04,  3.93it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  11%|█         | 2/19 [00:00<00:05,  3.38it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  16%|█▌        | 3/19 [00:00<00:03,  4.52it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  21%|██        | 4/19 [00:00<00:02,  5.70it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  26%|██▋       | 5/19 [00:00<00:02,  6.63it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  32%|███▏      | 6/19 [00:01<00:01,  7.44it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  37%|███▋      | 7/19 [00:01<00:01,  8.04it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  42%|████▏     | 8/19 [00:01<00:01,  8.55it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  47%|████▋     | 9/19 [00:01<00:01,  8.79it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  53%|█████▎    | 10/19 [00:01<00:01,  8.87it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  58%|█████▊    | 11/19 [00:01<00:00,  9.06it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  63%|██████▎   | 12/19 [00:01<00:00,  9.21it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  68%|██████▊   | 13/19 [00:01<00:00,  9.24it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  74%|███████▎  | 14/19 [00:01<00:00,  9.35it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  79%|███████▉  | 15/19 [00:01<00:00,  9.36it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  84%|████████▍ | 16/19 [00:02<00:00,  9.50it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  89%|████████▉ | 17/19 [00:02<00:00,  9.44it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 19/19 [00:02<00:00,  9.02it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 19/19 [00:02<00:00,  7.86it/s]
(EngineCore_DP0 pid=282483) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):   9%|▉         | 1/11 [00:00<00:01,  7.41it/s]
Capturing CUDA graphs (decode, FULL):  18%|█▊        | 2/11 [00:00<00:01,  8.38it/s]
Capturing CUDA graphs (decode, FULL):  27%|██▋       | 3/11 [00:00<00:00,  8.93it/s]
Capturing CUDA graphs (decode, FULL):  36%|███▋      | 4/11 [00:00<00:00,  8.84it/s]
Capturing CUDA graphs (decode, FULL):  45%|████▌     | 5/11 [00:00<00:00,  7.95it/s]
Capturing CUDA graphs (decode, FULL):  55%|█████▍    | 6/11 [00:00<00:00,  5.42it/s]
Capturing CUDA graphs (decode, FULL):  64%|██████▎   | 7/11 [00:01<00:00,  6.34it/s]
Capturing CUDA graphs (decode, FULL):  73%|███████▎  | 8/11 [00:01<00:00,  6.49it/s]
Capturing CUDA graphs (decode, FULL):  82%|████████▏ | 9/11 [00:01<00:00,  5.63it/s]
Capturing CUDA graphs (decode, FULL):  91%|█████████ | 10/11 [00:01<00:00,  6.46it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 11/11 [00:01<00:00,  7.23it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 11/11 [00:01<00:00,  6.91it/s]

Adding requests:   0%|          | 0/8192 [00:00<?, ?it/s]
Adding requests:   0%|          | 26/8192 [00:00<00:32, 255.07it/s]
Adding requests:   1%|          | 57/8192 [00:00<00:28, 285.17it/s]
Adding requests:   1%|          | 88/8192 [00:00<00:27, 292.20it/s]
Adding requests:   1%|▏         | 118/8192 [00:00<00:27, 293.71it/s]
Adding requests:   2%|▏         | 148/8192 [00:00<00:27, 293.05it/s]
Adding requests:   2%|▏         | 178/8192 [00:00<00:27, 292.19it/s]
Adding requests:   3%|▎         | 208/8192 [00:00<00:27, 287.59it/s]
Adding requests:   3%|▎         | 240/8192 [00:00<00:26, 295.69it/s]
Adding requests:   3%|▎         | 270/8192 [00:00<00:26, 295.21it/s]
Adding requests:   4%|▎         | 300/8192 [00:01<00:27, 284.96it/s]
Adding requests:   4%|▍         | 329/8192 [00:01<00:28, 280.08it/s]
Adding requests:   4%|▍         | 359/8192 [00:01<00:27, 283.08it/s]
Adding requests:   5%|▍         | 388/8192 [00:01<00:27, 283.82it/s]
Adding requests:   5%|▌         | 418/8192 [00:01<00:27, 286.58it/s]
Adding requests:   5%|▌         | 447/8192 [00:01<00:27, 285.94it/s]
Adding requests:   6%|▌         | 477/8192 [00:01<00:26, 288.79it/s]
Adding requests:   6%|▌         | 506/8192 [00:01<00:27, 283.85it/s]
Adding requests:   7%|▋         | 535/8192 [00:01<00:27, 278.16it/s]
Adding requests:   7%|▋         | 565/8192 [00:01<00:26, 284.05it/s]
Adding requests:   7%|▋         | 594/8192 [00:02<00:26, 282.82it/s]
Adding requests:   8%|▊         | 623/8192 [00:02<00:26, 282.23it/s]
Adding requests:   8%|▊         | 653/8192 [00:02<00:26, 287.40it/s]
Adding requests:   8%|▊         | 683/8192 [00:02<00:25, 289.66it/s]
Adding requests:   9%|▊         | 713/8192 [00:02<00:25, 290.44it/s]
Adding requests:   9%|▉         | 743/8192 [00:02<00:25, 286.74it/s]
Adding requests:   9%|▉         | 773/8192 [00:02<00:25, 288.80it/s]
Adding requests:  10%|▉         | 802/8192 [00:02<00:26, 283.90it/s]
Adding requests:  10%|█         | 831/8192 [00:02<00:26, 280.63it/s]
Adding requests:  11%|█         | 861/8192 [00:03<00:25, 286.04it/s]
Adding requests:  11%|█         | 891/8192 [00:03<00:25, 290.07it/s]
Adding requests:  11%|█         | 921/8192 [00:03<00:24, 292.54it/s]
Adding requests:  12%|█▏        | 951/8192 [00:03<00:25, 288.74it/s]
Adding requests:  12%|█▏        | 981/8192 [00:03<00:24, 290.11it/s]
Adding requests:  12%|█▏        | 1011/8192 [00:03<00:24, 291.38it/s]
Adding requests:  13%|█▎        | 1041/8192 [00:03<00:24, 289.84it/s]
Adding requests:  13%|█▎        | 1070/8192 [00:03<00:24, 286.80it/s]
Adding requests:  13%|█▎        | 1099/8192 [00:03<00:24, 286.23it/s]
Adding requests:  14%|█▍        | 1128/8192 [00:03<00:25, 281.88it/s]
Adding requests:  14%|█▍        | 1158/8192 [00:04<00:24, 286.00it/s]
Adding requests:  15%|█▍        | 1189/8192 [00:04<00:24, 291.41it/s]
Adding requests:  15%|█▍        | 1219/8192 [00:04<00:23, 293.83it/s]
Adding requests:  15%|█▌        | 1249/8192 [00:04<00:24, 285.31it/s]
Adding requests:  16%|█▌        | 1278/8192 [00:04<00:24, 277.24it/s]
Adding requests:  16%|█▌        | 1310/8192 [00:04<00:23, 287.50it/s]
Adding requests:  16%|█▋        | 1343/8192 [00:04<00:23, 296.99it/s]
Adding requests:  17%|█▋        | 1375/8192 [00:04<00:22, 302.15it/s]
Adding requests:  17%|█▋        | 1407/8192 [00:04<00:22, 306.29it/s]
Adding requests:  18%|█▊        | 1438/8192 [00:04<00:22, 295.51it/s]
Adding requests:  18%|█▊        | 1469/8192 [00:05<00:22, 298.35it/s]
Adding requests:  18%|█▊        | 1502/8192 [00:05<00:21, 305.44it/s]
Adding requests:  19%|█▊        | 1533/8192 [00:05<00:22, 298.97it/s]
Adding requests:  19%|█▉        | 1563/8192 [00:05<00:22, 292.90it/s]
Adding requests:  19%|█▉        | 1593/8192 [00:05<00:23, 284.88it/s]
Adding requests:  20%|█▉        | 1622/8192 [00:05<00:23, 283.58it/s]
Adding requests:  20%|██        | 1652/8192 [00:05<00:22, 287.42it/s]
Adding requests:  21%|██        | 1682/8192 [00:05<00:22, 290.91it/s]
Adding requests:  21%|██        | 1712/8192 [00:05<00:22, 291.21it/s]
Adding requests:  21%|██▏       | 1742/8192 [00:06<00:23, 278.56it/s]
Adding requests:  22%|██▏       | 1772/8192 [00:06<00:22, 282.28it/s]
Adding requests:  22%|██▏       | 1804/8192 [00:06<00:21, 291.28it/s]
Adding requests:  22%|██▏       | 1834/8192 [00:06<00:21, 293.30it/s]
Adding requests:  23%|██▎       | 1867/8192 [00:06<00:20, 302.77it/s]
Adding requests:  23%|██▎       | 1898/8192 [00:06<00:20, 301.59it/s]
Adding requests:  24%|██▎       | 1930/8192 [00:06<00:20, 306.94it/s]
Adding requests:  24%|██▍       | 1962/8192 [00:06<00:20, 307.41it/s]
Adding requests:  24%|██▍       | 1994/8192 [00:06<00:20, 309.89it/s]
Adding requests:  25%|██▍       | 2027/8192 [00:06<00:19, 315.25it/s]
Adding requests:  25%|██▌       | 2060/8192 [00:07<00:19, 318.64it/s]
Adding requests:  26%|██▌       | 2093/8192 [00:07<00:19, 319.11it/s]
Adding requests:  26%|██▌       | 2125/8192 [00:07<00:19, 312.79it/s]
Adding requests:  26%|██▋       | 2157/8192 [00:07<00:19, 308.60it/s]
Adding requests:  27%|██▋       | 2188/8192 [00:07<00:19, 306.51it/s]
Adding requests:  27%|██▋       | 2221/8192 [00:07<00:19, 311.43it/s]
Adding requests:  28%|██▊       | 2256/8192 [00:07<00:18, 320.78it/s]
Adding requests:  28%|██▊       | 2289/8192 [00:07<00:18, 319.89it/s]
Adding requests:  28%|██▊       | 2322/8192 [00:07<00:18, 321.30it/s]
Adding requests:  29%|██▊       | 2355/8192 [00:07<00:18, 319.93it/s]
Adding requests:  29%|██▉       | 2390/8192 [00:08<00:17, 326.01it/s]
Adding requests:  30%|██▉       | 2425/8192 [00:08<00:17, 332.20it/s]
Adding requests:  30%|███       | 2459/8192 [00:08<00:17, 330.87it/s]
Adding requests:  30%|███       | 2493/8192 [00:08<00:17, 324.76it/s]
Adding requests:  31%|███       | 2526/8192 [00:08<00:17, 318.42it/s]
Adding requests:  31%|███       | 2558/8192 [00:08<00:19, 290.43it/s]
Adding requests:  32%|███▏      | 2588/8192 [00:08<00:20, 268.99it/s]
Adding requests:  32%|███▏      | 2616/8192 [00:08<00:21, 254.65it/s]
Adding requests:  32%|███▏      | 2642/8192 [00:09<00:21, 255.16it/s]
Adding requests:  33%|███▎      | 2673/8192 [00:09<00:20, 267.05it/s]
Adding requests:  33%|███▎      | 2704/8192 [00:09<00:19, 277.03it/s]
Adding requests:  33%|███▎      | 2735/8192 [00:09<00:19, 285.40it/s]
Adding requests:  34%|███▍      | 2767/8192 [00:09<00:18, 294.41it/s]
Adding requests:  34%|███▍      | 2797/8192 [00:09<00:18, 290.94it/s]
Adding requests:  35%|███▍      | 2827/8192 [00:09<00:19, 281.92it/s]
Adding requests:  35%|███▍      | 2857/8192 [00:09<00:18, 285.92it/s]
Adding requests:  35%|███▌      | 2887/8192 [00:09<00:18, 288.30it/s]
Adding requests:  36%|███▌      | 2917/8192 [00:09<00:18, 289.16it/s]
Adding requests:  36%|███▌      | 2947/8192 [00:10<00:18, 289.50it/s]
Adding requests:  36%|███▋      | 2976/8192 [00:10<00:18, 281.83it/s]
Adding requests:  37%|███▋      | 3005/8192 [00:10<00:18, 281.50it/s]
Adding requests:  37%|███▋      | 3034/8192 [00:10<00:18, 283.46it/s]
Adding requests:  37%|███▋      | 3063/8192 [00:10<00:18, 281.36it/s]
Adding requests:  38%|███▊      | 3092/8192 [00:10<00:18, 279.42it/s]
Adding requests:  38%|███▊      | 3120/8192 [00:10<00:18, 277.10it/s]
Adding requests:  38%|███▊      | 3149/8192 [00:10<00:17, 280.75it/s]
Adding requests:  39%|███▉      | 3180/8192 [00:10<00:17, 287.84it/s]
Adding requests:  39%|███▉      | 3210/8192 [00:10<00:17, 289.63it/s]
Adding requests:  40%|███▉      | 3242/8192 [00:11<00:16, 297.99it/s]
Adding requests:  40%|███▉      | 3273/8192 [00:11<00:16, 300.93it/s]
Adding requests:  40%|████      | 3304/8192 [00:11<00:16, 302.80it/s]
Adding requests:  41%|████      | 3336/8192 [00:11<00:15, 306.36it/s]
Adding requests:  41%|████      | 3367/8192 [00:11<00:15, 306.34it/s]
Adding requests:  41%|████▏     | 3398/8192 [00:11<00:15, 301.67it/s]
Adding requests:  42%|████▏     | 3431/8192 [00:11<00:15, 307.27it/s]
Adding requests:  42%|████▏     | 3462/8192 [00:11<00:16, 294.57it/s]
Adding requests:  43%|████▎     | 3493/8192 [00:11<00:15, 298.70it/s]
Adding requests:  43%|████▎     | 3525/8192 [00:12<00:15, 302.39it/s]
Adding requests:  43%|████▎     | 3556/8192 [00:12<00:15, 300.61it/s]
Adding requests:  44%|████▍     | 3588/8192 [00:12<00:15, 303.38it/s]
Adding requests:  44%|████▍     | 3619/8192 [00:12<00:15, 304.43it/s]
Adding requests:  45%|████▍     | 3650/8192 [00:12<00:14, 305.86it/s]
Adding requests:  45%|████▍     | 3681/8192 [00:12<00:15, 299.20it/s]
Adding requests:  45%|████▌     | 3711/8192 [00:12<00:15, 297.60it/s]
Adding requests:  46%|████▌     | 3741/8192 [00:12<00:15, 283.17it/s]
Adding requests:  46%|████▌     | 3770/8192 [00:12<00:15, 282.62it/s]
Adding requests:  46%|████▋     | 3801/8192 [00:12<00:15, 289.49it/s]
Adding requests:  47%|████▋     | 3831/8192 [00:13<00:15, 288.21it/s]
Adding requests:  47%|████▋     | 3862/8192 [00:13<00:14, 292.14it/s]
Adding requests:  48%|████▊     | 3892/8192 [00:13<00:14, 289.47it/s]
Adding requests:  48%|████▊     | 3924/8192 [00:13<00:14, 295.67it/s]
Adding requests:  48%|████▊     | 3957/8192 [00:13<00:13, 303.91it/s]
Adding requests:  49%|████▊     | 3988/8192 [00:13<00:13, 304.44it/s]
Adding requests:  49%|████▉     | 4021/8192 [00:13<00:13, 311.46it/s]
Adding requests:  49%|████▉     | 4053/8192 [00:13<00:13, 307.91it/s]
Adding requests:  50%|████▉     | 4084/8192 [00:13<00:13, 299.65it/s]
Adding requests:  50%|█████     | 4116/8192 [00:14<00:13, 303.24it/s]
Adding requests:  51%|█████     | 4149/8192 [00:14<00:13, 309.99it/s]
Adding requests:  51%|█████     | 4183/8192 [00:14<00:12, 318.10it/s]
Adding requests:  51%|█████▏    | 4217/8192 [00:14<00:12, 323.01it/s]
Adding requests:  52%|█████▏    | 4251/8192 [00:14<00:12, 327.21it/s]
Adding requests:  52%|█████▏    | 4284/8192 [00:14<00:12, 311.81it/s]
Adding requests:  53%|█████▎    | 4316/8192 [00:14<00:12, 314.13it/s]
Adding requests:  53%|█████▎    | 4351/8192 [00:14<00:11, 322.23it/s]
Adding requests:  54%|█████▎    | 4385/8192 [00:14<00:11, 326.35it/s]
Adding requests:  54%|█████▍    | 4418/8192 [00:14<00:11, 325.28it/s]
Adding requests:  54%|█████▍    | 4451/8192 [00:15<00:11, 321.89it/s]
Adding requests:  55%|█████▍    | 4484/8192 [00:15<00:11, 323.96it/s]
Adding requests:  55%|█████▌    | 4517/8192 [00:15<00:11, 325.12it/s]
Adding requests:  56%|█████▌    | 4552/8192 [00:15<00:10, 330.92it/s]
Adding requests:  56%|█████▌    | 4587/8192 [00:15<00:10, 334.99it/s]
Adding requests:  56%|█████▋    | 4621/8192 [00:15<00:10, 331.75it/s]
Adding requests:  57%|█████▋    | 4655/8192 [00:15<00:10, 332.37it/s]
Adding requests:  57%|█████▋    | 4689/8192 [00:15<00:10, 331.60it/s]
Adding requests:  58%|█████▊    | 4723/8192 [00:15<00:10, 329.00it/s]
Adding requests:  58%|█████▊    | 4756/8192 [00:15<00:10, 327.26it/s]
Adding requests:  58%|█████▊    | 4789/8192 [00:16<00:10, 321.06it/s]
Adding requests:  59%|█████▉    | 4822/8192 [00:16<00:10, 314.80it/s]
Adding requests:  59%|█████▉    | 4854/8192 [00:16<00:10, 315.91it/s]
Adding requests:  60%|█████▉    | 4886/8192 [00:16<00:10, 315.51it/s]
Adding requests:  60%|██████    | 4918/8192 [00:16<00:10, 313.57it/s]
Adding requests:  60%|██████    | 4950/8192 [00:16<00:10, 315.02it/s]
Adding requests:  61%|██████    | 4982/8192 [00:16<00:10, 306.85it/s]
Adding requests:  61%|██████    | 5013/8192 [00:16<00:10, 305.63it/s]
Adding requests:  62%|██████▏   | 5044/8192 [00:16<00:10, 305.24it/s]
Adding requests:  62%|██████▏   | 5076/8192 [00:16<00:10, 307.66it/s]
Adding requests:  62%|██████▏   | 5107/8192 [00:17<00:10, 307.04it/s]
Adding requests:  63%|██████▎   | 5138/8192 [00:17<00:09, 307.65it/s]
Adding requests:  63%|██████▎   | 5169/8192 [00:17<00:10, 301.61it/s]
Adding requests:  63%|██████▎   | 5200/8192 [00:17<00:10, 296.01it/s]
Adding requests:  64%|██████▍   | 5230/8192 [00:17<00:10, 293.91it/s]
Adding requests:  64%|██████▍   | 5260/8192 [00:17<00:09, 295.57it/s]
Adding requests:  65%|██████▍   | 5293/8192 [00:17<00:09, 302.96it/s]
Adding requests:  65%|██████▍   | 5324/8192 [00:17<00:09, 302.04it/s]
Adding requests:  65%|██████▌   | 5355/8192 [00:17<00:09, 301.62it/s]
Adding requests:  66%|██████▌   | 5386/8192 [00:18<00:09, 299.58it/s]
Adding requests:  66%|██████▌   | 5418/8192 [00:18<00:09, 303.84it/s]
Adding requests:  67%|██████▋   | 5449/8192 [00:18<00:09, 302.35it/s]
Adding requests:  67%|██████▋   | 5480/8192 [00:18<00:09, 300.46it/s]
Adding requests:  67%|██████▋   | 5511/8192 [00:18<00:08, 298.77it/s]
Adding requests:  68%|██████▊   | 5541/8192 [00:18<00:09, 294.00it/s]
Adding requests:  68%|██████▊   | 5571/8192 [00:18<00:08, 295.42it/s]
Adding requests:  68%|██████▊   | 5601/8192 [00:18<00:09, 280.72it/s]
Adding requests:  69%|██████▊   | 5630/8192 [00:18<00:09, 278.28it/s]
Adding requests:  69%|██████▉   | 5659/8192 [00:18<00:09, 278.93it/s]
Adding requests:  75%|███████▌  | 6176/8192 [00:19<00:01, 1674.15it/s]
Adding requests:  77%|███████▋  | 6348/8192 [00:19<00:02, 725.90it/s] 
Adding requests:  79%|███████▉  | 6478/8192 [00:20<00:03, 549.84it/s]
Adding requests:  80%|████████  | 6579/8192 [00:20<00:03, 467.06it/s]
Adding requests:  81%|████████▏ | 6658/8192 [00:20<00:03, 420.17it/s]
Adding requests:  82%|████████▏ | 6723/8192 [00:20<00:03, 390.11it/s]
Adding requests:  83%|████████▎ | 6777/8192 [00:21<00:03, 370.26it/s]
Adding requests:  83%|████████▎ | 6824/8192 [00:21<00:03, 347.48it/s]
Adding requests:  84%|████████▍ | 6865/8192 [00:21<00:03, 335.44it/s]
Adding requests:  84%|████████▍ | 6903/8192 [00:21<00:04, 319.78it/s]
Adding requests:  85%|████████▍ | 6938/8192 [00:21<00:03, 315.12it/s]
Adding requests:  85%|████████▌ | 6971/8192 [00:21<00:03, 308.84it/s]
Adding requests:  85%|████████▌ | 7003/8192 [00:21<00:03, 307.15it/s]
Adding requests:  86%|████████▌ | 7035/8192 [00:21<00:03, 306.60it/s]
Adding requests:  86%|████████▋ | 7067/8192 [00:22<00:03, 308.45it/s]
Adding requests:  87%|████████▋ | 7099/8192 [00:22<00:03, 308.68it/s]
Adding requests:  87%|████████▋ | 7131/8192 [00:22<00:03, 304.30it/s]
Adding requests:  87%|████████▋ | 7162/8192 [00:22<00:03, 300.66it/s]
Adding requests:  88%|████████▊ | 7193/8192 [00:22<00:03, 303.12it/s]
Adding requests:  88%|████████▊ | 7226/8192 [00:22<00:03, 309.43it/s]
Adding requests:  89%|████████▊ | 7262/8192 [00:22<00:02, 321.68it/s]
Adding requests:  89%|████████▉ | 7295/8192 [00:22<00:02, 323.78it/s]
Adding requests:  89%|████████▉ | 7329/8192 [00:22<00:02, 327.42it/s]
Adding requests:  90%|████████▉ | 7362/8192 [00:22<00:02, 324.27it/s]
Adding requests:  90%|█████████ | 7397/8192 [00:23<00:02, 330.39it/s]
Adding requests:  91%|█████████ | 7433/8192 [00:23<00:02, 337.48it/s]
Adding requests:  91%|█████████ | 7467/8192 [00:23<00:02, 326.82it/s]
Adding requests:  92%|█████████▏| 7500/8192 [00:23<00:02, 320.87it/s]
Adding requests:  92%|█████████▏| 7533/8192 [00:23<00:02, 320.65it/s]
Adding requests:  92%|█████████▏| 7566/8192 [00:23<00:01, 322.05it/s]
Adding requests:  93%|█████████▎| 7599/8192 [00:23<00:01, 319.61it/s]
Adding requests:  93%|█████████▎| 7631/8192 [00:23<00:01, 315.98it/s]
Adding requests:  94%|█████████▎| 7664/8192 [00:23<00:01, 318.13it/s]
Adding requests:  94%|█████████▍| 7697/8192 [00:24<00:01, 319.99it/s]
Adding requests:  94%|█████████▍| 7730/8192 [00:24<00:01, 315.00it/s]
Adding requests:  95%|█████████▍| 7762/8192 [00:24<00:01, 316.15it/s]
Adding requests:  95%|█████████▌| 7795/8192 [00:24<00:01, 315.99it/s]
Adding requests:  96%|█████████▌| 7828/8192 [00:24<00:01, 318.06it/s]
Adding requests:  96%|█████████▌| 7860/8192 [00:24<00:01, 317.57it/s]
Adding requests:  96%|█████████▋| 7892/8192 [00:24<00:00, 313.70it/s]
Adding requests:  97%|█████████▋| 7924/8192 [00:24<00:00, 309.63it/s]
Adding requests:  97%|█████████▋| 7956/8192 [00:24<00:00, 312.20it/s]
Adding requests:  98%|█████████▊| 7990/8192 [00:24<00:00, 319.34it/s]
Adding requests:  98%|█████████▊| 8022/8192 [00:25<00:00, 315.29it/s]
Adding requests:  98%|█████████▊| 8055/8192 [00:25<00:00, 317.30it/s]
Adding requests:  99%|█████████▊| 8087/8192 [00:25<00:00, 312.22it/s]
Adding requests:  99%|█████████▉| 8119/8192 [00:25<00:00, 306.27it/s]
Adding requests:  99%|█████████▉| 8150/8192 [00:25<00:00, 303.94it/s]
Adding requests: 100%|█████████▉| 8184/8192 [00:25<00:00, 311.61it/s]
Adding requests: 100%|██████████| 8192/8192 [00:25<00:00, 319.79it/s]

Processed prompts:   0%|          | 0/8192 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  35%|███▍      | 2847/8192 [00:00<00:00, 16106.68it/s, est. speed input: 16499979.61 toks/s, output: 16111.39 toks/s]
Processed prompts:  51%|█████     | 4190/8192 [00:12<00:00, 16106.68it/s, est. speed input: 350166.15 toks/s, output: 341.96 toks/s]    
Processed prompts:  51%|█████     | 4191/8192 [00:12<00:15, 261.53it/s, est. speed input: 334959.38 toks/s, output: 327.11 toks/s]  
Processed prompts:  52%|█████▏    | 4255/8192 [00:13<00:15, 252.84it/s, est. speed input: 325834.50 toks/s, output: 318.20 toks/s]
Processed prompts:  60%|██████    | 4925/8192 [00:19<00:17, 186.43it/s, est. speed input: 260865.78 toks/s, output: 254.75 toks/s]
Processed prompts:  65%|██████▍   | 5295/8192 [00:22<00:17, 163.81it/s, est. speed input: 237710.94 toks/s, output: 232.14 toks/s]
Processed prompts:  67%|██████▋   | 5523/8192 [00:22<00:14, 187.37it/s, est. speed input: 246496.47 toks/s, output: 240.72 toks/s]
Processed prompts:  70%|██████▉   | 5730/8192 [00:25<00:15, 157.93it/s, est. speed input: 231044.82 toks/s, output: 225.63 toks/s]
Processed prompts:  72%|███████▏  | 5870/8192 [00:26<00:15, 150.44it/s, est. speed input: 225760.26 toks/s, output: 220.47 toks/s]
Processed prompts:  73%|███████▎  | 5968/8192 [00:27<00:14, 151.38it/s, est. speed input: 224339.58 toks/s, output: 219.08 toks/s]
Processed prompts:  74%|███████▎  | 6040/8192 [00:27<00:14, 147.17it/s, est. speed input: 222130.80 toks/s, output: 216.92 toks/s]
Processed prompts:  74%|███████▍  | 6093/8192 [00:28<00:15, 139.09it/s, est. speed input: 219606.34 toks/s, output: 214.46 toks/s]
Processed prompts:  75%|███████▍  | 6133/8192 [00:28<00:16, 126.96it/s, est. speed input: 216719.85 toks/s, output: 211.64 toks/s]
Processed prompts:  75%|███████▌  | 6175/8192 [00:29<00:17, 116.24it/s, est. speed input: 214008.28 toks/s, output: 208.99 toks/s]
Processed prompts:  76%|███████▌  | 6239/8192 [00:30<00:16, 115.48it/s, est. speed input: 212153.57 toks/s, output: 207.18 toks/s]
Processed prompts:  77%|███████▋  | 6303/8192 [00:30<00:16, 114.83it/s, est. speed input: 210365.94 toks/s, output: 205.44 toks/s]
Processed prompts:  78%|███████▊  | 6367/8192 [00:31<00:15, 114.33it/s, est. speed input: 208646.32 toks/s, output: 203.76 toks/s]
Processed prompts:  79%|███████▊  | 6431/8192 [00:31<00:15, 112.13it/s, est. speed input: 206766.64 toks/s, output: 201.92 toks/s]
Processed prompts:  79%|███████▉  | 6495/8192 [00:32<00:15, 109.80it/s, est. speed input: 204870.06 toks/s, output: 200.07 toks/s]
Processed prompts:  80%|████████  | 6559/8192 [00:33<00:15, 108.63it/s, est. speed input: 203103.28 toks/s, output: 198.34 toks/s]
Processed prompts:  81%|████████  | 6623/8192 [00:33<00:14, 107.72it/s, est. speed input: 201391.59 toks/s, output: 196.67 toks/s]
Processed prompts:  82%|████████▏ | 6687/8192 [00:34<00:14, 106.63it/s, est. speed input: 199690.85 toks/s, output: 195.01 toks/s]
Processed prompts:  82%|████████▏ | 6751/8192 [00:34<00:13, 105.87it/s, est. speed input: 198050.64 toks/s, output: 193.41 toks/s]
Processed prompts:  83%|████████▎ | 6815/8192 [00:35<00:13, 105.32it/s, est. speed input: 196465.59 toks/s, output: 191.86 toks/s]
Processed prompts:  84%|████████▍ | 6879/8192 [00:36<00:12, 104.97it/s, est. speed input: 194938.49 toks/s, output: 190.37 toks/s]
Processed prompts:  85%|████████▍ | 6943/8192 [00:36<00:11, 104.74it/s, est. speed input: 193463.11 toks/s, output: 188.93 toks/s]
Processed prompts:  86%|████████▌ | 7007/8192 [00:37<00:11, 104.56it/s, est. speed input: 192035.70 toks/s, output: 187.53 toks/s]
Processed prompts:  86%|████████▋ | 7071/8192 [00:37<00:10, 104.91it/s, est. speed input: 190700.29 toks/s, output: 186.23 toks/s]
Processed prompts:  87%|████████▋ | 7135/8192 [00:38<00:09, 107.54it/s, est. speed input: 189628.95 toks/s, output: 185.18 toks/s]
Processed prompts:  88%|████████▊ | 7199/8192 [00:39<00:09, 109.04it/s, est. speed input: 188551.14 toks/s, output: 184.13 toks/s]
Processed prompts:  89%|████████▊ | 7263/8192 [00:39<00:08, 109.70it/s, est. speed input: 187469.70 toks/s, output: 183.08 toks/s]
Processed prompts:  89%|████████▉ | 7327/8192 [00:40<00:08, 107.98it/s, est. speed input: 186237.34 toks/s, output: 181.87 toks/s]
Processed prompts:  90%|█████████ | 7391/8192 [00:40<00:07, 107.21it/s, est. speed input: 185076.01 toks/s, output: 180.74 toks/s]
Processed prompts:  91%|█████████ | 7455/8192 [00:41<00:06, 106.29it/s, est. speed input: 183916.06 toks/s, output: 179.61 toks/s]
Processed prompts:  92%|█████████▏| 7519/8192 [00:42<00:06, 105.59it/s, est. speed input: 182784.79 toks/s, output: 178.50 toks/s]
Processed prompts:  93%|█████████▎| 7583/8192 [00:42<00:05, 105.18it/s, est. speed input: 181692.63 toks/s, output: 177.43 toks/s]
Processed prompts:  93%|█████████▎| 7647/8192 [00:43<00:05, 104.92it/s, est. speed input: 180632.67 toks/s, output: 176.40 toks/s]
Processed prompts:  94%|█████████▍| 7711/8192 [00:43<00:04, 104.67it/s, est. speed input: 179596.87 toks/s, output: 175.39 toks/s]
Processed prompts:  95%|█████████▍| 7775/8192 [00:44<00:03, 104.56it/s, est. speed input: 178595.53 toks/s, output: 174.41 toks/s]
Processed prompts:  96%|█████████▌| 7839/8192 [00:45<00:03, 106.19it/s, est. speed input: 177749.92 toks/s, output: 173.58 toks/s]
Processed prompts:  96%|█████████▋| 7903/8192 [00:45<00:02, 108.12it/s, est. speed input: 176979.61 toks/s, output: 172.83 toks/s]
Processed prompts:  97%|█████████▋| 7967/8192 [00:46<00:02, 109.49it/s, est. speed input: 176226.39 toks/s, output: 172.10 toks/s]
Processed prompts:  98%|█████████▊| 8031/8192 [00:46<00:01, 110.50it/s, est. speed input: 175494.19 toks/s, output: 171.38 toks/s]
Processed prompts:  99%|█████████▉| 8095/8192 [00:47<00:00, 111.58it/s, est. speed input: 174801.45 toks/s, output: 170.70 toks/s]
Processed prompts: 100%|█████████▉| 8159/8192 [00:47<00:00, 129.53it/s, est. speed input: 175044.57 toks/s, output: 170.94 toks/s]
Processed prompts: 100%|██████████| 8192/8192 [00:47<00:00, 129.53it/s, est. speed input: 175750.18 toks/s, output: 171.63 toks/s]
Processed prompts: 100%|██████████| 8192/8192 [00:47<00:00, 171.63it/s, est. speed input: 175750.18 toks/s, output: 171.63 toks/s]
[rank0]:[W125 18:59:16.240641841 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=512 ==========
Time: 2026-01-25 21:54:25
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-FP8-SlideSparse-2_4
Params: prompt_len=512, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-FP8-SlideSparse-2_4 --dataset-name random --input-len 512 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 513 --max-num-batched-tokens 513 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_4/json/Llama3.2-3B-FP8_M512.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 21:54:34 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 21:54:35 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=449304) WARNING 01-25 21:54:42 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=449304) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=449304) WARNING 01-25 21:54:57 [backends.py:609] Failed to read file <frozen os>
Throughput: 14.36 requests/s, 7367.01 total tokens/s, 14.36 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128

STDERR:
[2026-01-25 21:54:33] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 21:54:34] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-FP8'
[2026-01-25 21:54:34] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-FP8
[2026-01-25 21:54:34] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:54:34] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:54:34] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:54:34] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:54:34] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:54:34] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-FP8'
[2026-01-25 21:54:34] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 21:54:34] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 21:54:34] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 21:54:34] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 21:54:34] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 21:54:41] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 21:54:41] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-FP8'
[2026-01-25 21:54:41] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-FP8
[2026-01-25 21:54:41] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:54:41] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:54:41] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:54:41] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:54:41] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:54:41] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-FP8'
[2026-01-25 21:54:41] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 21:54:41] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 21:54:41] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 21:54:41] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 21:54:41] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=449304) [2026-01-25 21:54:43] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=449304) [2026-01-25 21:54:43] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=449304) [2026-01-25 21:54:43] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=449304) [2026-01-25 21:54:43] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=449304) [2026-01-25 21:54:43] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Llama3.2-3B-FP8
(EngineCore_DP0 pid=449304) [2026-01-25 21:54:43] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=449304) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=449304) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:03<00:00,  3.19s/it]
(EngineCore_DP0 pid=449304) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:03<00:00,  3.19s/it]
(EngineCore_DP0 pid=449304) 
(EngineCore_DP0 pid=449304) [2026-01-25 21:54:47] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 3072] -> 1D uint8
(EngineCore_DP0 pid=449304) [2026-01-25 21:54:47] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 11796480 bytes
(EngineCore_DP0 pid=449304) [2026-01-25 21:54:47] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 3072] -> 1D uint8
(EngineCore_DP0 pid=449304) [2026-01-25 21:54:47] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 7077888 bytes
(EngineCore_DP0 pid=449304) [2026-01-25 21:54:47] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [16384, 3072] -> 1D uint8
(EngineCore_DP0 pid=449304) [2026-01-25 21:54:47] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 37748736 bytes
(EngineCore_DP0 pid=449304) [2026-01-25 21:54:47] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 8192] -> 1D uint8
(EngineCore_DP0 pid=449304) [2026-01-25 21:54:47] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 18874368 bytes
(EngineCore_DP0 pid=449304) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  2.47it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  2.46it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  2.46it/s]
(EngineCore_DP0 pid=449304) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.46it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.45it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  39%|███▉      | 50/128 [00:00<00:00, 499.84it/s]
Adding requests:  80%|████████  | 103/128 [00:00<00:00, 515.41it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 510.40it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:18,  6.90it/s, est. speed input: 3534.18 toks/s, output: 6.90 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:13,  9.13it/s, est. speed input: 4526.97 toks/s, output: 8.84 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:10, 11.44it/s, est. speed input: 5421.43 toks/s, output: 10.59 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:09, 12.79it/s, est. speed input: 5938.45 toks/s, output: 11.60 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:00<00:08, 13.53it/s, est. speed input: 6250.96 toks/s, output: 12.21 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:00<00:08, 13.86it/s, est. speed input: 6436.59 toks/s, output: 12.57 toks/s]
Processed prompts:  10%|█         | 13/128 [00:01<00:08, 14.07it/s, est. speed input: 6571.42 toks/s, output: 12.83 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:01<00:07, 14.21it/s, est. speed input: 6674.80 toks/s, output: 13.04 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:01<00:07, 14.32it/s, est. speed input: 6757.54 toks/s, output: 13.20 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:01<00:07, 14.41it/s, est. speed input: 6828.11 toks/s, output: 13.34 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:01<00:07, 14.46it/s, est. speed input: 6883.03 toks/s, output: 13.44 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:01<00:07, 14.47it/s, est. speed input: 6926.68 toks/s, output: 13.53 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:01<00:07, 14.49it/s, est. speed input: 6964.87 toks/s, output: 13.60 toks/s]
Processed prompts:  21%|██        | 27/128 [00:01<00:06, 14.51it/s, est. speed input: 6999.65 toks/s, output: 13.67 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:02<00:06, 14.52it/s, est. speed input: 7028.47 toks/s, output: 13.73 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:02<00:06, 14.51it/s, est. speed input: 7052.40 toks/s, output: 13.77 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:02<00:06, 14.49it/s, est. speed input: 7072.38 toks/s, output: 13.81 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:02<00:06, 14.55it/s, est. speed input: 7096.90 toks/s, output: 13.86 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:02<00:06, 14.50it/s, est. speed input: 7110.99 toks/s, output: 13.89 toks/s]
Processed prompts:  30%|███       | 39/128 [00:02<00:06, 14.55it/s, est. speed input: 7130.53 toks/s, output: 13.93 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:02<00:05, 14.54it/s, est. speed input: 7144.47 toks/s, output: 13.95 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:03<00:05, 14.50it/s, est. speed input: 7155.18 toks/s, output: 13.97 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:03<00:05, 14.51it/s, est. speed input: 7167.03 toks/s, output: 14.00 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:03<00:05, 14.56it/s, est. speed input: 7181.09 toks/s, output: 14.03 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:03<00:05, 14.64it/s, est. speed input: 7197.43 toks/s, output: 14.06 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:03<00:05, 14.67it/s, est. speed input: 7210.48 toks/s, output: 14.08 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:03<00:05, 14.56it/s, est. speed input: 7214.46 toks/s, output: 14.09 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:03<00:05, 14.57it/s, est. speed input: 7223.60 toks/s, output: 14.11 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:04<00:04, 14.50it/s, est. speed input: 7227.73 toks/s, output: 14.12 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:04<00:04, 14.49it/s, est. speed input: 7233.43 toks/s, output: 14.13 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:04<00:04, 14.46it/s, est. speed input: 7237.95 toks/s, output: 14.14 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:04<00:04, 14.47it/s, est. speed input: 7243.84 toks/s, output: 14.15 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:04<00:04, 14.67it/s, est. speed input: 7258.55 toks/s, output: 14.18 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:04<00:04, 14.96it/s, est. speed input: 7279.22 toks/s, output: 14.22 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:04<00:03, 15.13it/s, est. speed input: 7297.59 toks/s, output: 14.25 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:04<00:03, 15.25it/s, est. speed input: 7314.40 toks/s, output: 14.29 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:05<00:03, 15.32it/s, est. speed input: 7329.92 toks/s, output: 14.32 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:05<00:03, 15.41it/s, est. speed input: 7346.48 toks/s, output: 14.35 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:05<00:03, 15.49it/s, est. speed input: 7362.81 toks/s, output: 14.38 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:05<00:03, 15.63it/s, est. speed input: 7381.39 toks/s, output: 14.42 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:05<00:02, 15.83it/s, est. speed input: 7402.61 toks/s, output: 14.46 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:05<00:02, 15.95it/s, est. speed input: 7422.18 toks/s, output: 14.50 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:05<00:02, 15.93it/s, est. speed input: 7437.52 toks/s, output: 14.53 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:05<00:02, 15.96it/s, est. speed input: 7453.47 toks/s, output: 14.56 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:06<00:02, 16.02it/s, est. speed input: 7470.11 toks/s, output: 14.59 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:06<00:02, 16.13it/s, est. speed input: 7488.28 toks/s, output: 14.63 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:06<00:02, 16.19it/s, est. speed input: 7504.99 toks/s, output: 14.66 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:06<00:02, 16.26it/s, est. speed input: 7522.12 toks/s, output: 14.69 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:06<00:01, 16.23it/s, est. speed input: 7536.24 toks/s, output: 14.72 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:06<00:01, 16.26it/s, est. speed input: 7551.44 toks/s, output: 14.75 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:06<00:01, 16.29it/s, est. speed input: 7566.00 toks/s, output: 14.78 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:06<00:01, 16.01it/s, est. speed input: 7571.87 toks/s, output: 14.79 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:07<00:01, 15.41it/s, est. speed input: 7565.54 toks/s, output: 14.78 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:07<00:01, 15.17it/s, est. speed input: 7564.30 toks/s, output: 14.77 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:07<00:01, 15.07it/s, est. speed input: 7564.81 toks/s, output: 14.77 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:07<00:01, 15.04it/s, est. speed input: 7566.71 toks/s, output: 14.78 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:07<00:01, 14.98it/s, est. speed input: 7567.21 toks/s, output: 14.78 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:07<00:00, 14.96it/s, est. speed input: 7568.31 toks/s, output: 14.78 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:07<00:00, 14.87it/s, est. speed input: 7567.40 toks/s, output: 14.78 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:08<00:00, 14.83it/s, est. speed input: 7567.04 toks/s, output: 14.78 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:08<00:00, 14.79it/s, est. speed input: 7566.25 toks/s, output: 14.78 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:08<00:00, 14.80it/s, est. speed input: 7566.69 toks/s, output: 14.78 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:08<00:00, 14.80it/s, est. speed input: 7566.76 toks/s, output: 14.78 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:08<00:00, 14.77it/s, est. speed input: 7566.20 toks/s, output: 14.78 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:08<00:00, 14.77it/s, est. speed input: 7566.94 toks/s, output: 14.78 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:08<00:00, 14.78it/s, est. speed input: 7566.94 toks/s, output: 14.78 toks/s]
[rank0]:[W125 21:55:24.622367344 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=1024 ==========
Time: 2026-01-25 21:55:27
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-FP8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-FP8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 1025 --max-num-batched-tokens 1025 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_4/json/Llama3.2-3B-FP8_M1024.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 21:55:37 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 21:55:38 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=450509) WARNING 01-25 21:55:45 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=450509) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=450509) WARNING 01-25 21:55:57 [backends.py:609] Failed to read file <frozen os>
Throughput: 14.64 requests/s, 15005.55 total tokens/s, 14.64 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128

STDERR:
[2026-01-25 21:55:37] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 21:55:37] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-FP8'
[2026-01-25 21:55:37] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-FP8
[2026-01-25 21:55:37] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:55:37] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:55:37] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:55:37] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:55:37] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:55:37] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-FP8'
[2026-01-25 21:55:37] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 21:55:37] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 21:55:37] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 21:55:37] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 21:55:37] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 21:55:44] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 21:55:44] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-FP8'
[2026-01-25 21:55:44] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-FP8
[2026-01-25 21:55:44] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:55:44] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:55:44] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:55:44] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:55:44] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:55:44] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-FP8'
[2026-01-25 21:55:44] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 21:55:44] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 21:55:44] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 21:55:44] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 21:55:44] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=450509) [2026-01-25 21:55:46] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=450509) [2026-01-25 21:55:46] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=450509) [2026-01-25 21:55:46] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=450509) [2026-01-25 21:55:46] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=450509) [2026-01-25 21:55:46] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Llama3.2-3B-FP8
(EngineCore_DP0 pid=450509) [2026-01-25 21:55:46] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=450509) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=450509) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.21it/s]
(EngineCore_DP0 pid=450509) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.21it/s]
(EngineCore_DP0 pid=450509) 
(EngineCore_DP0 pid=450509) [2026-01-25 21:55:47] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 3072] -> 1D uint8
(EngineCore_DP0 pid=450509) [2026-01-25 21:55:47] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 11796480 bytes
(EngineCore_DP0 pid=450509) [2026-01-25 21:55:47] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 3072] -> 1D uint8
(EngineCore_DP0 pid=450509) [2026-01-25 21:55:47] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 7077888 bytes
(EngineCore_DP0 pid=450509) [2026-01-25 21:55:48] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [16384, 3072] -> 1D uint8
(EngineCore_DP0 pid=450509) [2026-01-25 21:55:48] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 37748736 bytes
(EngineCore_DP0 pid=450509) [2026-01-25 21:55:48] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 8192] -> 1D uint8
(EngineCore_DP0 pid=450509) [2026-01-25 21:55:48] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 18874368 bytes
(EngineCore_DP0 pid=450509) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  7.44it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  7.59it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  7.56it/s]
(EngineCore_DP0 pid=450509) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  6.95it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  6.94it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  20%|██        | 26/128 [00:00<00:00, 252.09it/s]
Adding requests:  42%|████▏     | 54/128 [00:00<00:00, 268.28it/s]
Adding requests:  63%|██████▎   | 81/128 [00:00<00:00, 268.24it/s]
Adding requests:  85%|████████▌ | 109/128 [00:00<00:00, 272.46it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 272.74it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:05, 24.26it/s, est. speed input: 24849.19 toks/s, output: 24.26 toks/s]
Processed prompts:   5%|▍         | 6/128 [00:00<00:06, 17.86it/s, est. speed input: 19041.53 toks/s, output: 18.59 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:00<00:07, 16.62it/s, est. speed input: 17894.57 toks/s, output: 17.47 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:00<00:07, 15.99it/s, est. speed input: 17293.33 toks/s, output: 16.89 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:00<00:07, 15.69it/s, est. speed input: 16958.49 toks/s, output: 16.56 toks/s]
Processed prompts:  11%|█         | 14/128 [00:00<00:07, 15.47it/s, est. speed input: 16714.92 toks/s, output: 16.32 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:00<00:07, 15.27it/s, est. speed input: 16508.71 toks/s, output: 16.12 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:01<00:07, 15.60it/s, est. speed input: 16539.70 toks/s, output: 16.15 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:01<00:06, 15.72it/s, est. speed input: 16523.64 toks/s, output: 16.14 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:01<00:06, 15.84it/s, est. speed input: 16521.44 toks/s, output: 16.13 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:01<00:06, 15.89it/s, est. speed input: 16511.51 toks/s, output: 16.12 toks/s]
Processed prompts:  20%|██        | 26/128 [00:01<00:06, 15.99it/s, est. speed input: 16518.34 toks/s, output: 16.13 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:01<00:06, 16.07it/s, est. speed input: 16527.70 toks/s, output: 16.14 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:01<00:06, 16.12it/s, est. speed input: 16533.39 toks/s, output: 16.15 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:01<00:05, 16.16it/s, est. speed input: 16540.22 toks/s, output: 16.15 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:02<00:05, 16.20it/s, est. speed input: 16548.91 toks/s, output: 16.16 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:02<00:05, 16.20it/s, est. speed input: 16550.91 toks/s, output: 16.16 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:02<00:05, 16.20it/s, est. speed input: 16552.91 toks/s, output: 16.16 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:02<00:05, 16.17it/s, est. speed input: 16550.27 toks/s, output: 16.16 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:02<00:05, 16.11it/s, est. speed input: 16541.15 toks/s, output: 16.15 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:02<00:05, 16.05it/s, est. speed input: 16529.46 toks/s, output: 16.14 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:02<00:05, 16.01it/s, est. speed input: 16519.85 toks/s, output: 16.13 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:02<00:04, 16.06it/s, est. speed input: 16521.94 toks/s, output: 16.13 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:03<00:04, 16.15it/s, est. speed input: 16530.85 toks/s, output: 16.14 toks/s]
Processed prompts:  41%|████      | 52/128 [00:03<00:04, 16.26it/s, est. speed input: 16545.89 toks/s, output: 16.16 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:03<00:04, 16.11it/s, est. speed input: 16530.33 toks/s, output: 16.14 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:03<00:04, 16.06it/s, est. speed input: 16523.65 toks/s, output: 16.14 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:03<00:04, 16.01it/s, est. speed input: 16515.14 toks/s, output: 16.13 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:03<00:04, 16.14it/s, est. speed input: 16526.08 toks/s, output: 16.14 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:03<00:04, 16.05it/s, est. speed input: 16515.76 toks/s, output: 16.13 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:03<00:04, 15.61it/s, est. speed input: 16464.66 toks/s, output: 16.08 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:04<00:04, 15.38it/s, est. speed input: 16424.20 toks/s, output: 16.04 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:04<00:03, 15.33it/s, est. speed input: 16398.35 toks/s, output: 16.01 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:04<00:03, 15.13it/s, est. speed input: 16355.51 toks/s, output: 15.97 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:04<00:03, 14.95it/s, est. speed input: 16310.87 toks/s, output: 15.93 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:04<00:03, 14.86it/s, est. speed input: 16272.45 toks/s, output: 15.89 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:04<00:03, 14.75it/s, est. speed input: 16231.64 toks/s, output: 15.85 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:04<00:03, 14.74it/s, est. speed input: 16199.25 toks/s, output: 15.82 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:05<00:03, 14.71it/s, est. speed input: 16166.57 toks/s, output: 15.79 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:05<00:03, 14.75it/s, est. speed input: 16141.81 toks/s, output: 15.76 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:05<00:02, 14.78it/s, est. speed input: 16118.38 toks/s, output: 15.74 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:05<00:02, 14.79it/s, est. speed input: 16094.65 toks/s, output: 15.72 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:05<00:02, 14.84it/s, est. speed input: 16076.00 toks/s, output: 15.70 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:05<00:02, 14.84it/s, est. speed input: 16055.41 toks/s, output: 15.68 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:05<00:02, 14.88it/s, est. speed input: 16038.85 toks/s, output: 15.66 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:06<00:02, 14.91it/s, est. speed input: 16023.39 toks/s, output: 15.65 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:06<00:02, 14.90it/s, est. speed input: 16006.04 toks/s, output: 15.63 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:06<00:02, 14.98it/s, est. speed input: 15995.94 toks/s, output: 15.62 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:06<00:01, 14.93it/s, est. speed input: 15978.71 toks/s, output: 15.60 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:06<00:01, 15.00it/s, est. speed input: 15969.33 toks/s, output: 15.59 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:06<00:01, 15.02it/s, est. speed input: 15959.10 toks/s, output: 15.59 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:06<00:01, 15.03it/s, est. speed input: 15948.36 toks/s, output: 15.57 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:06<00:01, 15.07it/s, est. speed input: 15940.46 toks/s, output: 15.57 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:07<00:01, 15.10it/s, est. speed input: 15932.57 toks/s, output: 15.56 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:07<00:01, 14.99it/s, est. speed input: 15917.18 toks/s, output: 15.54 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:07<00:00, 14.94it/s, est. speed input: 15903.25 toks/s, output: 15.53 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:07<00:00, 14.89it/s, est. speed input: 15889.24 toks/s, output: 15.52 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:07<00:00, 14.96it/s, est. speed input: 15882.43 toks/s, output: 15.51 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:07<00:00, 14.97it/s, est. speed input: 15872.96 toks/s, output: 15.50 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:07<00:00, 14.99it/s, est. speed input: 15865.36 toks/s, output: 15.49 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:08<00:00, 15.00it/s, est. speed input: 15857.28 toks/s, output: 15.49 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:08<00:00, 15.03it/s, est. speed input: 15851.01 toks/s, output: 15.48 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:08<00:00, 15.06it/s, est. speed input: 15845.00 toks/s, output: 15.47 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:08<00:00, 15.06it/s, est. speed input: 15845.00 toks/s, output: 15.47 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:08<00:00, 15.47it/s, est. speed input: 15845.00 toks/s, output: 15.47 toks/s]
[rank0]:[W125 21:56:24.979139832 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=2048 ==========
Time: 2026-01-25 21:56:27
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-FP8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=256, max_num_seqs=2
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-FP8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 256 --max-num-seqs 2 --max-model-len 1025 --max-num-batched-tokens 2048 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_4/json/Llama3.2-3B-FP8_M2048.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 21:56:37 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 21:56:38 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=451586) WARNING 01-25 21:56:45 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=451586) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=451586) WARNING 01-25 21:56:57 [backends.py:609] Failed to read file <frozen os>
Throughput: 29.32 requests/s, 30051.89 total tokens/s, 29.32 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256

STDERR:
[2026-01-25 21:56:36] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 21:56:37] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-FP8'
[2026-01-25 21:56:37] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-FP8
[2026-01-25 21:56:37] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:56:37] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:56:37] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:56:37] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:56:37] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:56:37] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-FP8'
[2026-01-25 21:56:37] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 21:56:37] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 21:56:37] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 21:56:37] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 21:56:37] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 21:56:44] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 21:56:44] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-FP8'
[2026-01-25 21:56:44] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-FP8
[2026-01-25 21:56:44] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:56:44] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:56:44] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:56:44] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:56:44] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:56:44] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-FP8'
[2026-01-25 21:56:44] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 21:56:44] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 21:56:44] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 21:56:44] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 21:56:44] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=451586) [2026-01-25 21:56:46] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=451586) [2026-01-25 21:56:46] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=451586) [2026-01-25 21:56:46] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=451586) [2026-01-25 21:56:46] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=451586) [2026-01-25 21:56:46] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Llama3.2-3B-FP8
(EngineCore_DP0 pid=451586) [2026-01-25 21:56:46] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=451586) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=451586) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.20it/s]
(EngineCore_DP0 pid=451586) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.20it/s]
(EngineCore_DP0 pid=451586) 
(EngineCore_DP0 pid=451586) [2026-01-25 21:56:47] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 3072] -> 1D uint8
(EngineCore_DP0 pid=451586) [2026-01-25 21:56:47] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 11796480 bytes
(EngineCore_DP0 pid=451586) [2026-01-25 21:56:47] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 3072] -> 1D uint8
(EngineCore_DP0 pid=451586) [2026-01-25 21:56:47] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 7077888 bytes
(EngineCore_DP0 pid=451586) [2026-01-25 21:56:47] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [16384, 3072] -> 1D uint8
(EngineCore_DP0 pid=451586) [2026-01-25 21:56:47] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 37748736 bytes
(EngineCore_DP0 pid=451586) [2026-01-25 21:56:47] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 8192] -> 1D uint8
(EngineCore_DP0 pid=451586) [2026-01-25 21:56:47] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 18874368 bytes
(EngineCore_DP0 pid=451586) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  33%|███▎      | 1/3 [00:00<00:00,  8.11it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  67%|██████▋   | 2/3 [00:00<00:00,  8.76it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00,  7.99it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00,  8.12it/s]
(EngineCore_DP0 pid=451586) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 1/2 [00:00<00:00,  7.44it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  8.52it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  8.33it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  10%|█         | 26/256 [00:00<00:00, 255.81it/s]
Adding requests:  22%|██▏       | 56/256 [00:00<00:00, 280.33it/s]
Adding requests:  34%|███▍      | 87/256 [00:00<00:00, 291.23it/s]
Adding requests:  46%|████▌     | 117/256 [00:00<00:00, 291.25it/s]
Adding requests:  57%|█████▋    | 147/256 [00:00<00:00, 282.33it/s]
Adding requests:  69%|██████▉   | 176/256 [00:00<00:00, 280.04it/s]
Adding requests:  80%|████████  | 205/256 [00:00<00:00, 279.14it/s]
Adding requests:  92%|█████████▏| 236/256 [00:00<00:00, 286.93it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 284.21it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   8%|▊         | 20/256 [00:00<00:01, 182.14it/s, est. speed input: 186557.23 toks/s, output: 182.15 toks/s]
Processed prompts:  15%|█▌        | 39/256 [00:00<00:04, 48.27it/s, est. speed input: 55732.83 toks/s, output: 54.43 toks/s]   
Processed prompts:  19%|█▉        | 49/256 [00:01<00:05, 40.29it/s, est. speed input: 47352.56 toks/s, output: 46.24 toks/s]
Processed prompts:  22%|██▏       | 56/256 [00:01<00:05, 35.42it/s, est. speed input: 42912.30 toks/s, output: 41.91 toks/s]
Processed prompts:  24%|██▍       | 61/256 [00:01<00:05, 35.61it/s, est. speed input: 42392.33 toks/s, output: 41.40 toks/s]
Processed prompts:  26%|██▌       | 66/256 [00:01<00:05, 32.31it/s, est. speed input: 40213.95 toks/s, output: 39.27 toks/s]
Processed prompts:  27%|██▋       | 70/256 [00:01<00:05, 31.67it/s, est. speed input: 39446.07 toks/s, output: 38.52 toks/s]
Processed prompts:  29%|██▉       | 74/256 [00:01<00:05, 31.28it/s, est. speed input: 38846.43 toks/s, output: 37.94 toks/s]
Processed prompts:  30%|███       | 78/256 [00:02<00:05, 30.89it/s, est. speed input: 38302.60 toks/s, output: 37.40 toks/s]
Processed prompts:  32%|███▏      | 82/256 [00:02<00:05, 30.61it/s, est. speed input: 37833.59 toks/s, output: 36.95 toks/s]
Processed prompts:  34%|███▎      | 86/256 [00:02<00:05, 30.28it/s, est. speed input: 37386.30 toks/s, output: 36.51 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:02<00:05, 30.08it/s, est. speed input: 37001.16 toks/s, output: 36.13 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:02<00:05, 29.78it/s, est. speed input: 36621.44 toks/s, output: 35.76 toks/s]
Processed prompts:  38%|███▊      | 98/256 [00:02<00:05, 29.54it/s, est. speed input: 36273.00 toks/s, output: 35.42 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:02<00:05, 29.75it/s, est. speed input: 36032.95 toks/s, output: 35.19 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:03<00:05, 29.97it/s, est. speed input: 35824.94 toks/s, output: 34.99 toks/s]
Processed prompts:  43%|████▎     | 110/256 [00:03<00:04, 30.13it/s, est. speed input: 35635.83 toks/s, output: 34.80 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:03<00:04, 30.16it/s, est. speed input: 35448.71 toks/s, output: 34.62 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:03<00:04, 30.13it/s, est. speed input: 35266.20 toks/s, output: 34.44 toks/s]
Processed prompts:  48%|████▊     | 122/256 [00:03<00:04, 30.17it/s, est. speed input: 35107.36 toks/s, output: 34.28 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:03<00:04, 29.70it/s, est. speed input: 34889.73 toks/s, output: 34.07 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:03<00:04, 29.45it/s, est. speed input: 34697.68 toks/s, output: 33.88 toks/s]
Processed prompts:  52%|█████▏    | 134/256 [00:03<00:04, 29.32it/s, est. speed input: 34524.44 toks/s, output: 33.72 toks/s]
Processed prompts:  54%|█████▍    | 138/256 [00:04<00:04, 29.29it/s, est. speed input: 34371.81 toks/s, output: 33.57 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:04<00:03, 29.27it/s, est. speed input: 34228.40 toks/s, output: 33.43 toks/s]
Processed prompts:  57%|█████▋    | 146/256 [00:04<00:03, 29.25it/s, est. speed input: 34093.18 toks/s, output: 33.29 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:04<00:03, 29.28it/s, est. speed input: 33971.75 toks/s, output: 33.18 toks/s]
Processed prompts:  60%|██████    | 154/256 [00:04<00:03, 29.70it/s, est. speed input: 33901.70 toks/s, output: 33.11 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:04<00:03, 30.12it/s, est. speed input: 33847.44 toks/s, output: 33.05 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:04<00:03, 30.50it/s, est. speed input: 33804.69 toks/s, output: 33.01 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:05<00:02, 30.80it/s, est. speed input: 33766.20 toks/s, output: 32.97 toks/s]
Processed prompts:  66%|██████▋   | 170/256 [00:05<00:02, 30.93it/s, est. speed input: 33721.89 toks/s, output: 32.93 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:05<00:02, 31.02it/s, est. speed input: 33679.67 toks/s, output: 32.89 toks/s]
Processed prompts:  70%|██████▉   | 178/256 [00:05<00:02, 31.14it/s, est. speed input: 33644.70 toks/s, output: 32.86 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:05<00:02, 31.33it/s, est. speed input: 33619.64 toks/s, output: 32.83 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:05<00:02, 31.34it/s, est. speed input: 33585.55 toks/s, output: 32.80 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:05<00:02, 31.33it/s, est. speed input: 33552.09 toks/s, output: 32.77 toks/s]
Processed prompts:  76%|███████▌  | 194/256 [00:05<00:01, 31.27it/s, est. speed input: 33515.94 toks/s, output: 32.73 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:06<00:01, 31.49it/s, est. speed input: 33500.86 toks/s, output: 32.72 toks/s]
Processed prompts:  79%|███████▉  | 202/256 [00:06<00:01, 31.93it/s, est. speed input: 33506.40 toks/s, output: 32.72 toks/s]
Processed prompts:  80%|████████  | 206/256 [00:06<00:01, 32.20it/s, est. speed input: 33509.27 toks/s, output: 32.72 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:06<00:01, 32.54it/s, est. speed input: 33520.98 toks/s, output: 32.74 toks/s]
Processed prompts:  84%|████████▎ | 214/256 [00:06<00:01, 32.70it/s, est. speed input: 33527.61 toks/s, output: 32.74 toks/s]
Processed prompts:  85%|████████▌ | 218/256 [00:06<00:01, 32.64it/s, est. speed input: 33523.07 toks/s, output: 32.74 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:06<00:01, 32.68it/s, est. speed input: 33523.48 toks/s, output: 32.74 toks/s]
Processed prompts:  88%|████████▊ | 226/256 [00:06<00:00, 32.49it/s, est. speed input: 33511.11 toks/s, output: 32.73 toks/s]
Processed prompts:  90%|████████▉ | 230/256 [00:07<00:00, 32.38it/s, est. speed input: 33500.41 toks/s, output: 32.72 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:07<00:00, 32.40it/s, est. speed input: 33495.31 toks/s, output: 32.71 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:07<00:00, 32.38it/s, est. speed input: 33489.00 toks/s, output: 32.70 toks/s]
Processed prompts:  95%|█████████▍| 242/256 [00:07<00:00, 32.44it/s, est. speed input: 33487.05 toks/s, output: 32.70 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:07<00:00, 32.52it/s, est. speed input: 33486.82 toks/s, output: 32.70 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:07<00:00, 32.57it/s, est. speed input: 33486.80 toks/s, output: 32.70 toks/s]
Processed prompts:  99%|█████████▉| 254/256 [00:07<00:00, 32.59it/s, est. speed input: 33485.87 toks/s, output: 32.70 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:07<00:00, 32.59it/s, est. speed input: 33483.40 toks/s, output: 32.70 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:07<00:00, 32.70it/s, est. speed input: 33483.40 toks/s, output: 32.70 toks/s]
[rank0]:[W125 21:57:24.432492893 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=4096 ==========
Time: 2026-01-25 21:57:27
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-FP8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=512, max_num_seqs=4
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-FP8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 512 --max-num-seqs 4 --max-model-len 1025 --max-num-batched-tokens 4096 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_4/json/Llama3.2-3B-FP8_M4096.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 21:57:38 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 21:57:40 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=452656) WARNING 01-25 21:57:46 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=452656) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=452656) WARNING 01-25 21:57:58 [backends.py:609] Failed to read file <frozen os>
Throughput: 46.57 requests/s, 47736.56 total tokens/s, 46.57 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512

STDERR:
[2026-01-25 21:57:38] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 21:57:38] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-FP8'
[2026-01-25 21:57:38] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-FP8
[2026-01-25 21:57:38] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:57:38] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:57:38] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:57:38] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:57:38] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:57:38] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-FP8'
[2026-01-25 21:57:38] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 21:57:38] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 21:57:38] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 21:57:38] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 21:57:38] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 21:57:45] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 21:57:45] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-FP8'
[2026-01-25 21:57:45] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-FP8
[2026-01-25 21:57:45] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:57:45] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:57:45] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:57:45] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:57:45] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:57:45] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-FP8'
[2026-01-25 21:57:45] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 21:57:45] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 21:57:45] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 21:57:45] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 21:57:45] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=452656) [2026-01-25 21:57:47] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=452656) [2026-01-25 21:57:47] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=452656) [2026-01-25 21:57:47] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=452656) [2026-01-25 21:57:47] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=452656) [2026-01-25 21:57:47] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Llama3.2-3B-FP8
(EngineCore_DP0 pid=452656) [2026-01-25 21:57:47] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=452656) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=452656) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.23it/s]
(EngineCore_DP0 pid=452656) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.23it/s]
(EngineCore_DP0 pid=452656) 
(EngineCore_DP0 pid=452656) [2026-01-25 21:57:49] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 3072] -> 1D uint8
(EngineCore_DP0 pid=452656) [2026-01-25 21:57:49] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 11796480 bytes
(EngineCore_DP0 pid=452656) [2026-01-25 21:57:49] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 3072] -> 1D uint8
(EngineCore_DP0 pid=452656) [2026-01-25 21:57:49] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 7077888 bytes
(EngineCore_DP0 pid=452656) [2026-01-25 21:57:49] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [16384, 3072] -> 1D uint8
(EngineCore_DP0 pid=452656) [2026-01-25 21:57:49] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 37748736 bytes
(EngineCore_DP0 pid=452656) [2026-01-25 21:57:49] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 8192] -> 1D uint8
(EngineCore_DP0 pid=452656) [2026-01-25 21:57:49] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 18874368 bytes
(EngineCore_DP0 pid=452656) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  25%|██▌       | 1/4 [00:00<00:00,  4.75it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 2/4 [00:00<00:00,  2.54it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  75%|███████▌  | 3/4 [00:00<00:00,  3.72it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:01<00:00,  4.02it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:01<00:00,  3.73it/s]
(EngineCore_DP0 pid=452656) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  33%|███▎      | 1/3 [00:00<00:00,  2.68it/s]
Capturing CUDA graphs (decode, FULL):  67%|██████▋   | 2/3 [00:00<00:00,  4.44it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  5.63it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  4.87it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   5%|▌         | 26/512 [00:00<00:01, 257.46it/s]
Adding requests:  11%|█         | 56/512 [00:00<00:01, 276.52it/s]
Adding requests:  16%|█▋        | 84/512 [00:00<00:01, 276.79it/s]
Adding requests:  22%|██▏       | 113/512 [00:00<00:01, 281.82it/s]
Adding requests:  28%|██▊       | 142/512 [00:00<00:01, 279.03it/s]
Adding requests:  33%|███▎      | 170/512 [00:00<00:01, 277.62it/s]
Adding requests:  39%|███▊      | 198/512 [00:00<00:01, 274.26it/s]
Adding requests:  45%|████▍     | 228/512 [00:00<00:01, 280.65it/s]
Adding requests:  50%|█████     | 257/512 [00:00<00:00, 279.63it/s]
Adding requests:  56%|█████▌    | 287/512 [00:01<00:00, 282.74it/s]
Adding requests:  62%|██████▏   | 317/512 [00:01<00:00, 285.65it/s]
Adding requests:  68%|██████▊   | 349/512 [00:01<00:00, 293.64it/s]
Adding requests:  74%|███████▍  | 381/512 [00:01<00:00, 301.29it/s]
Adding requests:  80%|████████  | 412/512 [00:01<00:00, 301.64it/s]
Adding requests:  87%|████████▋ | 443/512 [00:01<00:00, 303.81it/s]
Adding requests:  93%|█████████▎| 474/512 [00:01<00:00, 301.02it/s]
Adding requests:  99%|█████████▉| 506/512 [00:01<00:00, 304.37it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 290.30it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  14%|█▍        | 74/512 [00:00<00:01, 431.18it/s, est. speed input: 441590.95 toks/s, output: 431.20 toks/s]
Processed prompts:  23%|██▎       | 118/512 [00:01<00:04, 96.68it/s, est. speed input: 115923.97 toks/s, output: 113.20 toks/s]
Processed prompts:  27%|██▋       | 139/512 [00:01<00:04, 80.79it/s, est. speed input: 98932.96 toks/s, output: 96.61 toks/s]  
Processed prompts:  30%|██▉       | 153/512 [00:01<00:04, 75.61it/s, est. speed input: 93467.28 toks/s, output: 91.28 toks/s]
Processed prompts:  32%|███▏      | 164/512 [00:01<00:05, 67.83it/s, est. speed input: 87525.18 toks/s, output: 85.47 toks/s]
Processed prompts:  34%|███▍      | 173/512 [00:02<00:05, 64.64it/s, est. speed input: 84743.60 toks/s, output: 82.76 toks/s]
Processed prompts:  35%|███▌      | 181/512 [00:02<00:05, 60.47it/s, est. speed input: 81905.44 toks/s, output: 79.99 toks/s]
Processed prompts:  37%|███▋      | 188/512 [00:02<00:05, 55.54it/s, est. speed input: 79032.34 toks/s, output: 77.18 toks/s]
Processed prompts:  38%|███▊      | 194/512 [00:02<00:06, 50.25it/s, est. speed input: 76204.67 toks/s, output: 74.42 toks/s]
Processed prompts:  39%|███▉      | 202/512 [00:02<00:06, 49.28it/s, est. speed input: 74451.05 toks/s, output: 72.71 toks/s]
Processed prompts:  41%|████      | 210/512 [00:02<00:06, 48.58it/s, est. speed input: 72910.25 toks/s, output: 71.20 toks/s]
Processed prompts:  43%|████▎     | 218/512 [00:03<00:06, 48.07it/s, est. speed input: 71539.35 toks/s, output: 69.86 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:03<00:05, 47.68it/s, est. speed input: 70307.76 toks/s, output: 68.66 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:03<00:05, 47.34it/s, est. speed input: 69181.33 toks/s, output: 67.56 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:03<00:05, 47.10it/s, est. speed input: 68163.67 toks/s, output: 66.56 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:03<00:05, 46.92it/s, est. speed input: 67234.20 toks/s, output: 65.66 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:03<00:05, 46.84it/s, est. speed input: 66394.50 toks/s, output: 64.84 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:04<00:05, 46.71it/s, est. speed input: 65611.10 toks/s, output: 64.07 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:04<00:05, 46.66it/s, est. speed input: 64897.20 toks/s, output: 63.38 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:04<00:04, 46.48it/s, est. speed input: 64213.12 toks/s, output: 62.71 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:04<00:04, 46.51it/s, est. speed input: 63606.95 toks/s, output: 62.11 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:04<00:04, 46.44it/s, est. speed input: 63027.75 toks/s, output: 61.55 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:05<00:04, 46.47it/s, est. speed input: 62500.13 toks/s, output: 61.03 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:05<00:04, 46.49it/s, est. speed input: 62007.06 toks/s, output: 60.55 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:05<00:04, 46.48it/s, est. speed input: 61543.49 toks/s, output: 60.10 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:05<00:03, 46.46it/s, est. speed input: 61106.83 toks/s, output: 59.67 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:05<00:03, 46.52it/s, est. speed input: 60705.13 toks/s, output: 59.28 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:05<00:03, 46.57it/s, est. speed input: 60329.15 toks/s, output: 58.91 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:06<00:03, 46.56it/s, est. speed input: 59968.26 toks/s, output: 58.56 toks/s]
Processed prompts:  71%|███████   | 362/512 [00:06<00:03, 46.61it/s, est. speed input: 59634.50 toks/s, output: 58.24 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [00:06<00:03, 46.64it/s, est. speed input: 59318.11 toks/s, output: 57.93 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [00:06<00:02, 46.56it/s, est. speed input: 59006.62 toks/s, output: 57.62 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [00:06<00:02, 46.59it/s, est. speed input: 58721.33 toks/s, output: 57.34 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [00:06<00:02, 46.64it/s, est. speed input: 58452.66 toks/s, output: 57.08 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [00:07<00:02, 46.63it/s, est. speed input: 58192.16 toks/s, output: 56.83 toks/s]
Processed prompts:  80%|████████  | 410/512 [00:07<00:02, 46.64it/s, est. speed input: 57945.76 toks/s, output: 56.59 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [00:07<00:02, 46.58it/s, est. speed input: 57704.47 toks/s, output: 56.35 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [00:07<00:01, 47.65it/s, est. speed input: 57575.34 toks/s, output: 56.23 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [00:07<00:01, 48.47it/s, est. speed input: 57455.78 toks/s, output: 56.11 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [00:07<00:01, 49.03it/s, est. speed input: 57337.66 toks/s, output: 55.99 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [00:08<00:01, 49.49it/s, est. speed input: 57228.87 toks/s, output: 55.89 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [00:08<00:01, 49.73it/s, est. speed input: 57117.84 toks/s, output: 55.78 toks/s]
Processed prompts:  91%|█████████ | 466/512 [00:08<00:00, 49.94it/s, est. speed input: 57014.24 toks/s, output: 55.68 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [00:08<00:00, 50.07it/s, est. speed input: 56913.23 toks/s, output: 55.58 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [00:08<00:00, 50.10it/s, est. speed input: 56811.38 toks/s, output: 55.48 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [00:08<00:00, 50.22it/s, est. speed input: 56720.94 toks/s, output: 55.39 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [00:09<00:00, 50.33it/s, est. speed input: 56633.88 toks/s, output: 55.31 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [00:09<00:00, 50.39it/s, est. speed input: 56549.55 toks/s, output: 55.22 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:09<00:00, 50.39it/s, est. speed input: 56813.29 toks/s, output: 55.48 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:09<00:00, 55.48it/s, est. speed input: 56813.29 toks/s, output: 55.48 toks/s]
[rank0]:[W125 21:58:28.967742677 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=8192 ==========
Time: 2026-01-25 21:58:31
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-FP8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=1024, max_num_seqs=8
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-FP8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 1024 --max-num-seqs 8 --max-model-len 1025 --max-num-batched-tokens 8192 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_4/json/Llama3.2-3B-FP8_M8192.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 21:58:46 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 21:58:48 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=453809) WARNING 01-25 21:58:55 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=453809) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=453809) WARNING 01-25 21:59:07 [backends.py:609] Failed to read file <frozen os>
Throughput: 45.64 requests/s, 46778.86 total tokens/s, 45.64 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024

STDERR:
[2026-01-25 21:58:46] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 21:58:46] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-FP8'
[2026-01-25 21:58:46] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-FP8
[2026-01-25 21:58:46] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:58:46] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:58:46] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:58:46] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:58:46] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:58:46] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-FP8'
[2026-01-25 21:58:46] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 21:58:46] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 21:58:46] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 21:58:46] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 21:58:46] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 21:58:53] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 21:58:53] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-FP8'
[2026-01-25 21:58:53] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-FP8
[2026-01-25 21:58:53] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:58:53] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:58:53] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:58:53] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:58:53] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 21:58:53] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-FP8'
[2026-01-25 21:58:53] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 21:58:53] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 21:58:53] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 21:58:53] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 21:58:53] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=453809) [2026-01-25 21:58:55] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=453809) [2026-01-25 21:58:55] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=453809) [2026-01-25 21:58:55] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=453809) [2026-01-25 21:58:55] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=453809) [2026-01-25 21:58:55] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Llama3.2-3B-FP8
(EngineCore_DP0 pid=453809) [2026-01-25 21:58:55] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=453809) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=453809) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.16it/s]
(EngineCore_DP0 pid=453809) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.16it/s]
(EngineCore_DP0 pid=453809) 
(EngineCore_DP0 pid=453809) [2026-01-25 21:58:57] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 3072] -> 1D uint8
(EngineCore_DP0 pid=453809) [2026-01-25 21:58:57] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 11796480 bytes
(EngineCore_DP0 pid=453809) [2026-01-25 21:58:57] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 3072] -> 1D uint8
(EngineCore_DP0 pid=453809) [2026-01-25 21:58:57] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 7077888 bytes
(EngineCore_DP0 pid=453809) [2026-01-25 21:58:57] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [16384, 3072] -> 1D uint8
(EngineCore_DP0 pid=453809) [2026-01-25 21:58:57] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 37748736 bytes
(EngineCore_DP0 pid=453809) [2026-01-25 21:58:57] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 8192] -> 1D uint8
(EngineCore_DP0 pid=453809) [2026-01-25 21:58:57] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 18874368 bytes
(EngineCore_DP0 pid=453809) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:01,  2.29it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  40%|████      | 2/5 [00:00<00:00,  4.03it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  60%|██████    | 3/5 [00:00<00:00,  5.46it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  80%|████████  | 4/5 [00:00<00:00,  6.53it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00,  6.81it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00,  5.55it/s]
(EngineCore_DP0 pid=453809) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:00,  7.37it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 2/4 [00:00<00:00,  6.23it/s]
Capturing CUDA graphs (decode, FULL):  75%|███████▌  | 3/4 [00:00<00:00,  7.11it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  4.43it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  5.08it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   3%|▎         | 27/1024 [00:00<00:03, 263.39it/s]
Adding requests:   6%|▌         | 57/1024 [00:00<00:03, 281.42it/s]
Adding requests:   8%|▊         | 86/1024 [00:00<00:03, 281.66it/s]
Adding requests:  11%|█         | 115/1024 [00:00<00:03, 281.10it/s]
Adding requests:  14%|█▍        | 144/1024 [00:00<00:03, 279.34it/s]
Adding requests:  17%|█▋        | 172/1024 [00:00<00:03, 275.24it/s]
Adding requests:  20%|█▉        | 201/1024 [00:00<00:02, 276.94it/s]
Adding requests:  23%|██▎       | 232/1024 [00:00<00:02, 284.67it/s]
Adding requests:  25%|██▌       | 261/1024 [00:00<00:02, 281.33it/s]
Adding requests:  28%|██▊       | 290/1024 [00:01<00:02, 281.63it/s]
Adding requests:  31%|███       | 319/1024 [00:01<00:02, 280.69it/s]
Adding requests:  34%|███▍      | 348/1024 [00:01<00:02, 280.89it/s]
Adding requests:  37%|███▋      | 377/1024 [00:01<00:02, 279.91it/s]
Adding requests:  40%|███▉      | 405/1024 [00:01<00:02, 272.86it/s]
Adding requests:  42%|████▏     | 433/1024 [00:01<00:02, 273.02it/s]
Adding requests:  45%|████▌     | 461/1024 [00:01<00:02, 270.60it/s]
Adding requests:  48%|████▊     | 490/1024 [00:01<00:01, 274.73it/s]
Adding requests:  51%|█████     | 518/1024 [00:01<00:01, 273.33it/s]
Adding requests:  53%|█████▎    | 546/1024 [00:01<00:01, 270.16it/s]
Adding requests:  56%|█████▌    | 575/1024 [00:02<00:01, 274.75it/s]
Adding requests:  59%|█████▉    | 603/1024 [00:02<00:01, 275.36it/s]
Adding requests:  62%|██████▏   | 632/1024 [00:02<00:01, 276.95it/s]
Adding requests:  64%|██████▍   | 660/1024 [00:02<00:01, 272.90it/s]
Adding requests:  67%|██████▋   | 690/1024 [00:02<00:01, 280.20it/s]
Adding requests:  70%|███████   | 719/1024 [00:02<00:01, 281.66it/s]
Adding requests:  73%|███████▎  | 748/1024 [00:02<00:00, 283.87it/s]
Adding requests:  76%|███████▌  | 778/1024 [00:02<00:00, 287.55it/s]
Adding requests:  79%|███████▉  | 807/1024 [00:02<00:00, 286.27it/s]
Adding requests:  82%|████████▏ | 836/1024 [00:02<00:00, 284.02it/s]
Adding requests:  85%|████████▍ | 866/1024 [00:03<00:00, 286.54it/s]
Adding requests:  88%|████████▊ | 897/1024 [00:03<00:00, 293.10it/s]
Adding requests:  91%|█████████ | 927/1024 [00:03<00:00, 288.81it/s]
Adding requests:  93%|█████████▎| 956/1024 [00:03<00:00, 284.39it/s]
Adding requests:  96%|█████████▌| 985/1024 [00:03<00:00, 281.62it/s]
Adding requests:  99%|█████████▉| 1014/1024 [00:03<00:00, 278.11it/s]
Adding requests: 100%|██████████| 1024/1024 [00:03<00:00, 279.67it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  15%|█▌        | 154/1024 [00:00<00:01, 682.26it/s, est. speed input: 698736.07 toks/s, output: 682.29 toks/s]
Processed prompts:  22%|██▏       | 223/1024 [00:01<00:07, 112.32it/s, est. speed input: 139086.88 toks/s, output: 135.83 toks/s]
Processed prompts:  25%|██▍       | 254/1024 [00:02<00:08, 88.17it/s, est. speed input: 113321.78 toks/s, output: 110.67 toks/s] 
Processed prompts:  27%|██▋       | 273/1024 [00:02<00:09, 81.85it/s, est. speed input: 106611.39 toks/s, output: 104.11 toks/s]
Processed prompts:  28%|██▊       | 287/1024 [00:02<00:10, 72.80it/s, est. speed input: 99630.92 toks/s, output: 97.30 toks/s]  
Processed prompts:  29%|██▉       | 298/1024 [00:03<00:11, 63.05it/s, est. speed input: 93103.48 toks/s, output: 90.92 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:03<00:11, 60.91it/s, est. speed input: 91052.25 toks/s, output: 88.92 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:03<00:12, 58.75it/s, est. speed input: 89179.40 toks/s, output: 87.09 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:03<00:12, 56.76it/s, est. speed input: 87479.57 toks/s, output: 85.43 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:03<00:12, 54.34it/s, est. speed input: 85729.35 toks/s, output: 83.72 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:04<00:13, 51.96it/s, est. speed input: 84020.71 toks/s, output: 82.05 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:04<00:13, 50.10it/s, est. speed input: 82451.63 toks/s, output: 80.52 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:04<00:13, 48.70it/s, est. speed input: 81008.19 toks/s, output: 79.11 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:04<00:13, 47.67it/s, est. speed input: 79677.10 toks/s, output: 77.81 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:04<00:13, 46.91it/s, est. speed input: 78443.46 toks/s, output: 76.60 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:05<00:13, 46.36it/s, est. speed input: 77295.37 toks/s, output: 75.48 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:05<00:13, 45.99it/s, est. speed input: 76232.08 toks/s, output: 74.44 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [00:05<00:13, 45.76it/s, est. speed input: 75243.91 toks/s, output: 73.48 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:05<00:13, 45.58it/s, est. speed input: 74316.17 toks/s, output: 72.57 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:05<00:13, 45.45it/s, est. speed input: 73445.13 toks/s, output: 71.72 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:05<00:13, 45.35it/s, est. speed input: 72624.89 toks/s, output: 70.92 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:06<00:13, 45.26it/s, est. speed input: 71850.94 toks/s, output: 70.17 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:06<00:13, 45.22it/s, est. speed input: 71122.83 toks/s, output: 69.46 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:06<00:12, 45.16it/s, est. speed input: 70431.18 toks/s, output: 68.78 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:06<00:12, 45.13it/s, est. speed input: 69778.51 toks/s, output: 68.14 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:06<00:12, 45.09it/s, est. speed input: 69157.29 toks/s, output: 67.54 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:06<00:12, 45.08it/s, est. speed input: 68569.33 toks/s, output: 66.96 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:07<00:12, 45.07it/s, est. speed input: 68011.54 toks/s, output: 66.42 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:07<00:12, 45.06it/s, est. speed input: 67479.42 toks/s, output: 65.90 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:07<00:11, 45.05it/s, est. speed input: 66973.06 toks/s, output: 65.40 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:07<00:11, 45.04it/s, est. speed input: 66488.89 toks/s, output: 64.93 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:07<00:11, 45.03it/s, est. speed input: 66026.53 toks/s, output: 64.48 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:08<00:11, 45.03it/s, est. speed input: 65586.15 toks/s, output: 64.05 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:08<00:11, 45.04it/s, est. speed input: 65164.93 toks/s, output: 63.64 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:08<00:10, 45.05it/s, est. speed input: 64762.11 toks/s, output: 63.24 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:08<00:10, 45.09it/s, est. speed input: 64379.33 toks/s, output: 62.87 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:08<00:10, 45.08it/s, est. speed input: 64008.43 toks/s, output: 62.51 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:08<00:10, 45.08it/s, est. speed input: 63653.16 toks/s, output: 62.16 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:09<00:10, 45.08it/s, est. speed input: 63311.58 toks/s, output: 61.83 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:09<00:09, 46.12it/s, est. speed input: 63073.64 toks/s, output: 61.60 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:09<00:09, 46.89it/s, est. speed input: 62845.40 toks/s, output: 61.37 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:09<00:09, 47.45it/s, est. speed input: 62625.57 toks/s, output: 61.16 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:09<00:08, 47.83it/s, est. speed input: 62411.27 toks/s, output: 60.95 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:09<00:08, 48.12it/s, est. speed input: 62205.77 toks/s, output: 60.75 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:10<00:08, 48.31it/s, est. speed input: 62005.67 toks/s, output: 60.55 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:10<00:08, 48.43it/s, est. speed input: 61811.43 toks/s, output: 60.36 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:10<00:08, 48.52it/s, est. speed input: 61623.48 toks/s, output: 60.18 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:10<00:08, 48.59it/s, est. speed input: 61441.87 toks/s, output: 60.00 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:10<00:07, 48.65it/s, est. speed input: 61266.53 toks/s, output: 59.83 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:10<00:07, 48.66it/s, est. speed input: 61093.96 toks/s, output: 59.66 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:11<00:07, 48.69it/s, est. speed input: 60928.70 toks/s, output: 59.50 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:11<00:07, 48.72it/s, est. speed input: 60768.15 toks/s, output: 59.34 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:11<00:07, 48.74it/s, est. speed input: 60612.86 toks/s, output: 59.19 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:11<00:07, 48.78it/s, est. speed input: 60462.74 toks/s, output: 59.05 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:11<00:06, 48.77it/s, est. speed input: 60315.39 toks/s, output: 58.90 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:11<00:06, 48.62it/s, est. speed input: 60163.33 toks/s, output: 58.75 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:12<00:06, 47.51it/s, est. speed input: 59958.07 toks/s, output: 58.55 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:12<00:06, 46.74it/s, est. speed input: 59756.82 toks/s, output: 58.36 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:12<00:06, 46.24it/s, est. speed input: 59563.42 toks/s, output: 58.17 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:12<00:06, 45.90it/s, est. speed input: 59375.10 toks/s, output: 57.98 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:12<00:06, 45.59it/s, est. speed input: 59188.03 toks/s, output: 57.80 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:12<00:06, 45.40it/s, est. speed input: 59007.03 toks/s, output: 57.62 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:13<00:05, 45.25it/s, est. speed input: 58830.35 toks/s, output: 57.45 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:13<00:05, 45.17it/s, est. speed input: 58659.63 toks/s, output: 57.28 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:13<00:05, 45.12it/s, est. speed input: 58493.62 toks/s, output: 57.12 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:13<00:05, 45.07it/s, est. speed input: 58331.50 toks/s, output: 56.96 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:13<00:05, 45.03it/s, est. speed input: 58173.04 toks/s, output: 56.81 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:14<00:05, 45.00it/s, est. speed input: 58018.15 toks/s, output: 56.66 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:14<00:04, 44.99it/s, est. speed input: 57867.97 toks/s, output: 56.51 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:14<00:04, 44.96it/s, est. speed input: 57720.36 toks/s, output: 56.37 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:14<00:04, 44.98it/s, est. speed input: 57578.83 toks/s, output: 56.23 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:14<00:04, 44.96it/s, est. speed input: 57438.83 toks/s, output: 56.09 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:14<00:04, 44.97it/s, est. speed input: 57302.74 toks/s, output: 55.96 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [00:15<00:04, 45.00it/s, est. speed input: 57171.89 toks/s, output: 55.83 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [00:15<00:03, 44.97it/s, est. speed input: 57040.93 toks/s, output: 55.70 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:15<00:03, 44.95it/s, est. speed input: 56913.26 toks/s, output: 55.58 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [00:15<00:03, 44.97it/s, est. speed input: 56790.44 toks/s, output: 55.46 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [00:15<00:03, 44.98it/s, est. speed input: 56669.73 toks/s, output: 55.34 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [00:15<00:03, 44.95it/s, est. speed input: 56550.38 toks/s, output: 55.22 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [00:16<00:02, 44.95it/s, est. speed input: 56434.69 toks/s, output: 55.11 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [00:16<00:02, 45.08it/s, est. speed input: 56326.81 toks/s, output: 55.01 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [00:16<00:02, 46.09it/s, est. speed input: 56261.87 toks/s, output: 54.94 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [00:16<00:02, 46.84it/s, est. speed input: 56198.78 toks/s, output: 54.88 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [00:16<00:02, 47.36it/s, est. speed input: 56135.63 toks/s, output: 54.82 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [00:16<00:01, 47.72it/s, est. speed input: 56073.82 toks/s, output: 54.76 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [00:17<00:01, 47.98it/s, est. speed input: 56013.17 toks/s, output: 54.70 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [00:17<00:01, 48.16it/s, est. speed input: 55953.72 toks/s, output: 54.64 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [00:17<00:01, 48.25it/s, est. speed input: 55893.79 toks/s, output: 54.58 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [00:17<00:01, 48.38it/s, est. speed input: 55837.75 toks/s, output: 54.53 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [00:17<00:01, 48.46it/s, est. speed input: 55782.69 toks/s, output: 54.47 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [00:17<00:00, 48.59it/s, est. speed input: 55729.99 toks/s, output: 54.42 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [00:18<00:00, 48.62it/s, est. speed input: 55676.94 toks/s, output: 54.37 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [00:18<00:00, 48.68it/s, est. speed input: 55625.95 toks/s, output: 54.32 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [00:18<00:00, 48.66it/s, est. speed input: 55573.76 toks/s, output: 54.27 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [00:18<00:00, 48.72it/s, est. speed input: 55524.94 toks/s, output: 54.22 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [00:18<00:00, 50.27it/s, est. speed input: 55525.53 toks/s, output: 54.22 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:18<00:00, 50.27it/s, est. speed input: 55852.01 toks/s, output: 54.54 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:18<00:00, 54.54it/s, est. speed input: 55852.01 toks/s, output: 54.54 toks/s]
[rank0]:[W125 21:59:48.256601195 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=16384 ==========
Time: 2026-01-25 21:59:49
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-FP8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=2048, max_num_seqs=16
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-FP8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 2048 --max-num-seqs 16 --max-model-len 1025 --max-num-batched-tokens 16384 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_4/json/Llama3.2-3B-FP8_M16384.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 22:00:11 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 22:00:13 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=455220) WARNING 01-25 22:00:21 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=455220) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=455220) WARNING 01-25 22:00:31 [backends.py:609] Failed to read file <frozen os>
Throughput: 45.72 requests/s, 46860.15 total tokens/s, 45.72 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048

STDERR:
[2026-01-25 22:00:11] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 22:00:11] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-FP8'
[2026-01-25 22:00:11] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-FP8
[2026-01-25 22:00:11] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 22:00:11] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 22:00:11] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 22:00:11] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 22:00:11] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 22:00:11] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-FP8'
[2026-01-25 22:00:11] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 22:00:11] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 22:00:11] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 22:00:11] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 22:00:11] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 22:00:20] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 22:00:20] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-FP8'
[2026-01-25 22:00:20] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-FP8
[2026-01-25 22:00:20] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 22:00:20] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 22:00:20] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 22:00:20] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 22:00:20] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 22:00:20] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-FP8'
[2026-01-25 22:00:20] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 22:00:20] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 22:00:20] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 22:00:20] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 22:00:20] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=455220) [2026-01-25 22:00:20] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=455220) [2026-01-25 22:00:20] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=455220) [2026-01-25 22:00:20] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=455220) [2026-01-25 22:00:20] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=455220) [2026-01-25 22:00:20] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Llama3.2-3B-FP8
(EngineCore_DP0 pid=455220) [2026-01-25 22:00:20] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=455220) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=455220) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.16it/s]
(EngineCore_DP0 pid=455220) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.16it/s]
(EngineCore_DP0 pid=455220) 
(EngineCore_DP0 pid=455220) [2026-01-25 22:00:22] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 3072] -> 1D uint8
(EngineCore_DP0 pid=455220) [2026-01-25 22:00:22] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 11796480 bytes
(EngineCore_DP0 pid=455220) [2026-01-25 22:00:22] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 3072] -> 1D uint8
(EngineCore_DP0 pid=455220) [2026-01-25 22:00:22] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 7077888 bytes
(EngineCore_DP0 pid=455220) [2026-01-25 22:00:22] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [16384, 3072] -> 1D uint8
(EngineCore_DP0 pid=455220) [2026-01-25 22:00:22] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 37748736 bytes
(EngineCore_DP0 pid=455220) [2026-01-25 22:00:22] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 8192] -> 1D uint8
(EngineCore_DP0 pid=455220) [2026-01-25 22:00:22] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 18874368 bytes
(EngineCore_DP0 pid=455220) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  14%|█▍        | 1/7 [00:00<00:01,  3.80it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  29%|██▊       | 2/7 [00:00<00:01,  2.64it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  43%|████▎     | 3/7 [00:00<00:01,  3.30it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  57%|█████▋    | 4/7 [00:01<00:01,  2.82it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  71%|███████▏  | 5/7 [00:01<00:00,  3.61it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  86%|████████▌ | 6/7 [00:01<00:00,  4.48it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:01<00:00,  4.99it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:01<00:00,  3.93it/s]
(EngineCore_DP0 pid=455220) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  20%|██        | 1/5 [00:00<00:00,  6.83it/s]
Capturing CUDA graphs (decode, FULL):  40%|████      | 2/5 [00:00<00:00,  8.17it/s]
Capturing CUDA graphs (decode, FULL):  60%|██████    | 3/5 [00:00<00:00,  8.47it/s]
Capturing CUDA graphs (decode, FULL):  80%|████████  | 4/5 [00:00<00:00,  8.62it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00,  8.89it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00,  8.56it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   1%|▏         | 26/2048 [00:00<00:07, 257.32it/s]
Adding requests:   3%|▎         | 57/2048 [00:00<00:06, 285.37it/s]
Adding requests:   4%|▍         | 86/2048 [00:00<00:07, 278.64it/s]
Adding requests:   6%|▌         | 117/2048 [00:00<00:06, 289.10it/s]
Adding requests:   7%|▋         | 148/2048 [00:00<00:06, 294.34it/s]
Adding requests:   9%|▊         | 179/2048 [00:00<00:06, 299.06it/s]
Adding requests:  10%|█         | 211/2048 [00:00<00:06, 305.63it/s]
Adding requests:  12%|█▏        | 242/2048 [00:00<00:05, 305.29it/s]
Adding requests:  13%|█▎        | 273/2048 [00:00<00:05, 304.47it/s]
Adding requests:  15%|█▍        | 304/2048 [00:01<00:05, 296.94it/s]
Adding requests:  16%|█▋        | 335/2048 [00:01<00:05, 300.56it/s]
Adding requests:  18%|█▊        | 367/2048 [00:01<00:05, 303.91it/s]
Adding requests:  19%|█▉        | 399/2048 [00:01<00:05, 305.98it/s]
Adding requests:  21%|██        | 430/2048 [00:01<00:05, 306.35it/s]
Adding requests:  23%|██▎       | 462/2048 [00:01<00:05, 310.13it/s]
Adding requests:  24%|██▍       | 495/2048 [00:01<00:04, 315.18it/s]
Adding requests:  26%|██▌       | 527/2048 [00:01<00:05, 302.00it/s]
Adding requests:  27%|██▋       | 559/2048 [00:01<00:04, 304.92it/s]
Adding requests:  29%|██▉       | 591/2048 [00:01<00:04, 308.55it/s]
Adding requests:  30%|███       | 622/2048 [00:02<00:04, 307.19it/s]
Adding requests:  32%|███▏      | 653/2048 [00:02<00:04, 302.77it/s]
Adding requests:  33%|███▎      | 685/2048 [00:02<00:04, 307.14it/s]
Adding requests:  35%|███▌      | 717/2048 [00:02<00:04, 308.52it/s]
Adding requests:  37%|███▋      | 748/2048 [00:02<00:04, 303.06it/s]
Adding requests:  38%|███▊      | 779/2048 [00:02<00:04, 301.45it/s]
Adding requests:  40%|███▉      | 810/2048 [00:02<00:04, 294.24it/s]
Adding requests:  41%|████      | 840/2048 [00:02<00:04, 275.87it/s]
Adding requests:  42%|████▏     | 868/2048 [00:02<00:04, 275.53it/s]
Adding requests:  44%|████▍     | 896/2048 [00:03<00:04, 273.56it/s]
Adding requests:  45%|████▌     | 924/2048 [00:03<00:04, 269.93it/s]
Adding requests:  46%|████▋     | 952/2048 [00:03<00:04, 264.94it/s]
Adding requests:  48%|████▊     | 980/2048 [00:03<00:03, 267.35it/s]
Adding requests:  49%|████▉     | 1007/2048 [00:03<00:03, 263.86it/s]
Adding requests:  51%|█████     | 1036/2048 [00:03<00:03, 269.48it/s]
Adding requests:  52%|█████▏    | 1065/2048 [00:03<00:03, 273.97it/s]
Adding requests:  53%|█████▎    | 1093/2048 [00:03<00:03, 275.13it/s]
Adding requests:  55%|█████▍    | 1121/2048 [00:03<00:03, 275.70it/s]
Adding requests:  56%|█████▋    | 1152/2048 [00:03<00:03, 283.58it/s]
Adding requests:  58%|█████▊    | 1184/2048 [00:04<00:02, 293.55it/s]
Adding requests:  59%|█████▉    | 1215/2048 [00:04<00:02, 296.20it/s]
Adding requests:  61%|██████    | 1245/2048 [00:04<00:02, 286.27it/s]
Adding requests:  62%|██████▏   | 1274/2048 [00:04<00:02, 283.89it/s]
Adding requests:  64%|██████▎   | 1303/2048 [00:04<00:02, 284.13it/s]
Adding requests:  65%|██████▌   | 1333/2048 [00:04<00:02, 288.31it/s]
Adding requests:  67%|██████▋   | 1364/2048 [00:04<00:02, 292.37it/s]
Adding requests:  68%|██████▊   | 1394/2048 [00:04<00:02, 293.05it/s]
Adding requests:  70%|██████▉   | 1424/2048 [00:04<00:02, 289.29it/s]
Adding requests:  71%|███████   | 1453/2048 [00:04<00:02, 283.54it/s]
Adding requests:  72%|███████▏  | 1482/2048 [00:05<00:01, 283.78it/s]
Adding requests:  74%|███████▍  | 1511/2048 [00:05<00:01, 280.98it/s]
Adding requests:  75%|███████▌  | 1540/2048 [00:05<00:01, 272.82it/s]
Adding requests:  77%|███████▋  | 1569/2048 [00:05<00:01, 274.93it/s]
Adding requests:  78%|███████▊  | 1599/2048 [00:05<00:01, 279.82it/s]
Adding requests:  79%|███████▉  | 1628/2048 [00:05<00:01, 278.77it/s]
Adding requests:  81%|████████  | 1657/2048 [00:05<00:01, 279.12it/s]
Adding requests:  82%|████████▏ | 1685/2048 [00:05<00:01, 276.34it/s]
Adding requests:  84%|████████▎ | 1713/2048 [00:05<00:01, 274.74it/s]
Adding requests:  85%|████████▌ | 1742/2048 [00:06<00:01, 277.58it/s]
Adding requests:  86%|████████▋ | 1770/2048 [00:06<00:01, 276.42it/s]
Adding requests:  88%|████████▊ | 1798/2048 [00:06<00:00, 275.51it/s]
Adding requests:  89%|████████▉ | 1826/2048 [00:06<00:00, 271.57it/s]
Adding requests:  91%|█████████ | 1854/2048 [00:06<00:00, 272.62it/s]
Adding requests:  92%|█████████▏| 1882/2048 [00:06<00:00, 273.21it/s]
Adding requests:  93%|█████████▎| 1910/2048 [00:06<00:00, 272.43it/s]
Adding requests:  95%|█████████▍| 1939/2048 [00:06<00:00, 275.27it/s]
Adding requests:  96%|█████████▌| 1967/2048 [00:06<00:00, 274.24it/s]
Adding requests:  97%|█████████▋| 1995/2048 [00:06<00:00, 265.58it/s]
Adding requests:  99%|█████████▉| 2025/2048 [00:07<00:00, 274.08it/s]
Adding requests: 100%|██████████| 2048/2048 [00:07<00:00, 285.89it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [00:00<00:00, 2297.25it/s, est. speed input: 2352951.69 toks/s, output: 2297.45 toks/s]
Processed prompts:  26%|██▌       | 536/2048 [00:04<00:16, 91.02it/s, est. speed input: 111555.79 toks/s, output: 108.94 toks/s]    
Processed prompts:  31%|███       | 634/2048 [00:07<00:19, 73.52it/s, est. speed input: 91877.25 toks/s, output: 89.72 toks/s]  
Processed prompts:  34%|███▎      | 690/2048 [00:08<00:21, 64.27it/s, est. speed input: 83144.15 toks/s, output: 81.20 toks/s]
Processed prompts:  35%|███▌      | 725/2048 [00:09<00:21, 62.14it/s, est. speed input: 80793.21 toks/s, output: 78.90 toks/s]
Processed prompts:  37%|███▋      | 750/2048 [00:09<00:20, 63.44it/s, est. speed input: 80674.51 toks/s, output: 78.78 toks/s]
Processed prompts:  38%|███▊      | 769/2048 [00:09<00:20, 62.70it/s, est. speed input: 79935.32 toks/s, output: 78.06 toks/s]
Processed prompts:  38%|███▊      | 784/2048 [00:10<00:21, 60.14it/s, est. speed input: 78849.40 toks/s, output: 77.00 toks/s]
Processed prompts:  39%|███▉      | 796/2048 [00:10<00:22, 55.99it/s, est. speed input: 77537.70 toks/s, output: 75.72 toks/s]
Processed prompts:  39%|███▉      | 805/2048 [00:10<00:24, 50.25it/s, est. speed input: 76021.19 toks/s, output: 74.24 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [00:11<00:25, 47.82it/s, est. speed input: 74960.72 toks/s, output: 73.20 toks/s]
Processed prompts:  41%|████      | 834/2048 [00:11<00:25, 47.93it/s, est. speed input: 74226.99 toks/s, output: 72.49 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [00:11<00:25, 47.12it/s, est. speed input: 73378.64 toks/s, output: 71.66 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [00:12<00:25, 46.41it/s, est. speed input: 72564.90 toks/s, output: 70.86 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [00:12<00:25, 45.90it/s, est. speed input: 71798.85 toks/s, output: 70.12 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [00:12<00:25, 45.53it/s, est. speed input: 71074.81 toks/s, output: 69.41 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [00:13<00:25, 45.25it/s, est. speed input: 70389.08 toks/s, output: 68.74 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [00:13<00:24, 45.05it/s, est. speed input: 69737.91 toks/s, output: 68.10 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [00:14<00:24, 44.91it/s, est. speed input: 69120.51 toks/s, output: 67.50 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [00:14<00:24, 44.80it/s, est. speed input: 68533.03 toks/s, output: 66.93 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [00:14<00:23, 44.74it/s, est. speed input: 67976.58 toks/s, output: 66.38 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [00:15<00:23, 44.70it/s, est. speed input: 67446.26 toks/s, output: 65.87 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [00:15<00:23, 44.66it/s, est. speed input: 66939.33 toks/s, output: 65.37 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [00:15<00:22, 44.63it/s, est. speed input: 66455.15 toks/s, output: 64.90 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [00:16<00:22, 44.59it/s, est. speed input: 65990.97 toks/s, output: 64.44 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [00:16<00:22, 44.53it/s, est. speed input: 65542.73 toks/s, output: 64.01 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [00:16<00:21, 44.89it/s, est. speed input: 65156.20 toks/s, output: 63.63 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [00:17<00:20, 45.84it/s, est. speed input: 64851.98 toks/s, output: 63.33 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [00:17<00:20, 46.54it/s, est. speed input: 64560.10 toks/s, output: 63.05 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [00:17<00:19, 47.04it/s, est. speed input: 64278.65 toks/s, output: 62.77 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [00:18<00:19, 47.37it/s, est. speed input: 64006.22 toks/s, output: 62.51 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [00:18<00:18, 48.32it/s, est. speed input: 63799.67 toks/s, output: 62.30 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [00:18<00:18, 48.29it/s, est. speed input: 63546.27 toks/s, output: 62.06 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [00:19<00:17, 48.28it/s, est. speed input: 63301.53 toks/s, output: 61.82 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [00:19<00:17, 48.27it/s, est. speed input: 63065.74 toks/s, output: 61.59 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [00:19<00:17, 47.21it/s, est. speed input: 62759.47 toks/s, output: 61.29 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [00:20<00:17, 46.37it/s, est. speed input: 62454.54 toks/s, output: 60.99 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [00:20<00:17, 45.79it/s, est. speed input: 62159.51 toks/s, output: 60.70 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [00:20<00:17, 45.39it/s, est. speed input: 61874.54 toks/s, output: 60.42 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [00:21<00:16, 45.11it/s, est. speed input: 61598.64 toks/s, output: 60.15 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [00:21<00:16, 44.92it/s, est. speed input: 61332.58 toks/s, output: 59.90 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [00:22<00:16, 44.80it/s, est. speed input: 61075.19 toks/s, output: 59.64 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [00:22<00:16, 44.71it/s, est. speed input: 60826.31 toks/s, output: 59.40 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [00:22<00:15, 44.64it/s, est. speed input: 60585.13 toks/s, output: 59.17 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [00:23<00:15, 44.57it/s, est. speed input: 60349.19 toks/s, output: 58.93 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [00:23<00:15, 44.54it/s, est. speed input: 60122.41 toks/s, output: 58.71 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [00:23<00:14, 44.53it/s, est. speed input: 59902.66 toks/s, output: 58.50 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [00:24<00:14, 44.51it/s, est. speed input: 59688.80 toks/s, output: 58.29 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [00:24<00:13, 44.50it/s, est. speed input: 59481.85 toks/s, output: 58.09 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [00:24<00:13, 44.56it/s, est. speed input: 59284.81 toks/s, output: 57.90 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [00:25<00:04, 111.03it/s, est. speed input: 62323.06 toks/s, output: 60.86 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [00:25<00:05, 93.19it/s, est. speed input: 62153.25 toks/s, output: 60.70 toks/s] 
Processed prompts:  77%|███████▋  | 1570/2048 [00:25<00:05, 80.20it/s, est. speed input: 61988.03 toks/s, output: 60.54 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [00:26<00:06, 70.84it/s, est. speed input: 61827.14 toks/s, output: 60.38 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [00:26<00:06, 64.17it/s, est. speed input: 61670.69 toks/s, output: 60.23 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [00:26<00:07, 59.43it/s, est. speed input: 61518.04 toks/s, output: 60.08 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [00:27<00:07, 56.08it/s, est. speed input: 61369.30 toks/s, output: 59.93 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [00:27<00:07, 53.65it/s, est. speed input: 61220.65 toks/s, output: 59.79 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [00:27<00:07, 50.74it/s, est. speed input: 61017.94 toks/s, output: 59.59 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [00:28<00:07, 48.77it/s, est. speed input: 60819.94 toks/s, output: 59.39 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [00:28<00:07, 47.43it/s, est. speed input: 60627.43 toks/s, output: 59.21 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [00:29<00:07, 46.51it/s, est. speed input: 60439.67 toks/s, output: 59.02 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [00:29<00:06, 45.89it/s, est. speed input: 60256.92 toks/s, output: 58.84 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [00:29<00:06, 45.45it/s, est. speed input: 60078.48 toks/s, output: 58.67 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [00:30<00:06, 45.15it/s, est. speed input: 59904.31 toks/s, output: 58.50 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [00:30<00:06, 44.93it/s, est. speed input: 59734.13 toks/s, output: 58.33 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [00:30<00:05, 44.78it/s, est. speed input: 59568.00 toks/s, output: 58.17 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [00:31<00:05, 44.67it/s, est. speed input: 59405.29 toks/s, output: 58.01 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [00:31<00:04, 44.54it/s, est. speed input: 59243.49 toks/s, output: 57.85 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [00:31<00:04, 44.43it/s, est. speed input: 59084.56 toks/s, output: 57.70 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [00:32<00:04, 44.37it/s, est. speed input: 58929.96 toks/s, output: 57.55 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [00:32<00:03, 45.09it/s, est. speed input: 58815.42 toks/s, output: 57.44 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [00:32<00:03, 44.89it/s, est. speed input: 58670.24 toks/s, output: 57.30 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [00:33<00:03, 45.41it/s, est. speed input: 58558.37 toks/s, output: 57.19 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [00:33<00:02, 46.20it/s, est. speed input: 58467.03 toks/s, output: 57.10 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [00:33<00:02, 46.75it/s, est. speed input: 58376.65 toks/s, output: 57.01 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [00:34<00:01, 47.15it/s, est. speed input: 58288.42 toks/s, output: 56.92 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [00:34<00:01, 47.44it/s, est. speed input: 58202.26 toks/s, output: 56.84 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [00:34<00:01, 47.64it/s, est. speed input: 58117.09 toks/s, output: 56.75 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [00:35<00:00, 47.79it/s, est. speed input: 58034.41 toks/s, output: 56.67 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [00:35<00:00, 47.71it/s, est. speed input: 57945.94 toks/s, output: 56.59 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [00:36<00:00, 47.55it/s, est. speed input: 57855.26 toks/s, output: 56.50 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:36<00:00, 47.55it/s, est. speed input: 58252.79 toks/s, output: 56.89 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:36<00:00, 56.89it/s, est. speed input: 58252.79 toks/s, output: 56.89 toks/s]
[rank0]:[W125 22:01:34.859006946 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=32768 ==========
Time: 2026-01-25 22:01:37
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-FP8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=4096, max_num_seqs=32
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-FP8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 4096 --max-num-seqs 32 --max-model-len 1025 --max-num-batched-tokens 32768 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_4/json/Llama3.2-3B-FP8_M32768.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 22:02:12 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 22:02:13 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=457457) WARNING 01-25 22:02:23 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=457457) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=457457) WARNING 01-25 22:02:33 [backends.py:609] Failed to read file <frozen os>
Throughput: 45.72 requests/s, 46866.45 total tokens/s, 45.72 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096

STDERR:
[2026-01-25 22:02:12] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 22:02:12] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-FP8'
[2026-01-25 22:02:12] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-FP8
[2026-01-25 22:02:12] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 22:02:12] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 22:02:12] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 22:02:12] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 22:02:12] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 22:02:12] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-FP8'
[2026-01-25 22:02:12] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 22:02:12] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 22:02:12] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 22:02:12] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 22:02:12] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 22:02:21] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 22:02:21] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-FP8'
[2026-01-25 22:02:21] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-FP8
[2026-01-25 22:02:21] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 22:02:21] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 22:02:21] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 22:02:21] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 22:02:21] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 22:02:21] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-FP8'
[2026-01-25 22:02:21] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 22:02:21] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 22:02:21] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 22:02:21] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 22:02:21] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=457457) [2026-01-25 22:02:23] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=457457) [2026-01-25 22:02:23] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=457457) [2026-01-25 22:02:23] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=457457) [2026-01-25 22:02:23] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=457457) [2026-01-25 22:02:23] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Llama3.2-3B-FP8
(EngineCore_DP0 pid=457457) [2026-01-25 22:02:23] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=457457) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=457457) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.15it/s]
(EngineCore_DP0 pid=457457) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.15it/s]
(EngineCore_DP0 pid=457457) 
(EngineCore_DP0 pid=457457) [2026-01-25 22:02:23] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 3072] -> 1D uint8
(EngineCore_DP0 pid=457457) [2026-01-25 22:02:23] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 11796480 bytes
(EngineCore_DP0 pid=457457) [2026-01-25 22:02:23] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 3072] -> 1D uint8
(EngineCore_DP0 pid=457457) [2026-01-25 22:02:23] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 7077888 bytes
(EngineCore_DP0 pid=457457) [2026-01-25 22:02:23] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [16384, 3072] -> 1D uint8
(EngineCore_DP0 pid=457457) [2026-01-25 22:02:23] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 37748736 bytes
(EngineCore_DP0 pid=457457) [2026-01-25 22:02:23] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 8192] -> 1D uint8
(EngineCore_DP0 pid=457457) [2026-01-25 22:02:23] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 18874368 bytes
(EngineCore_DP0 pid=457457) [rank0]:W0125 22:02:42.121000 457457 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=457457) [rank0]:W0125 22:02:42.256000 457457 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=457457) [rank0]:W0125 22:02:44.031000 457457 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=457457) [rank0]:W0125 22:02:44.200000 457457 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=457457) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   9%|▉         | 1/11 [00:00<00:01,  7.22it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  18%|█▊        | 2/11 [00:00<00:01,  7.58it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  27%|██▋       | 3/11 [00:00<00:00,  8.09it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  36%|███▋      | 4/11 [00:00<00:00,  8.34it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  45%|████▌     | 5/11 [00:00<00:00,  8.50it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  55%|█████▍    | 6/11 [00:00<00:00,  8.68it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  64%|██████▎   | 7/11 [00:00<00:00,  8.78it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  73%|███████▎  | 8/11 [00:00<00:00,  8.15it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  82%|████████▏ | 9/11 [00:01<00:00,  6.44it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  91%|█████████ | 10/11 [00:01<00:00,  4.06it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00,  3.98it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00,  5.76it/s]
(EngineCore_DP0 pid=457457) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  14%|█▍        | 1/7 [00:00<00:02,  2.66it/s]
Capturing CUDA graphs (decode, FULL):  29%|██▊       | 2/7 [00:00<00:01,  4.16it/s]
Capturing CUDA graphs (decode, FULL):  43%|████▎     | 3/7 [00:00<00:00,  5.54it/s]
Capturing CUDA graphs (decode, FULL):  57%|█████▋    | 4/7 [00:00<00:00,  6.57it/s]
Capturing CUDA graphs (decode, FULL):  71%|███████▏  | 5/7 [00:00<00:00,  7.32it/s]
Capturing CUDA graphs (decode, FULL):  86%|████████▌ | 6/7 [00:00<00:00,  7.88it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:01<00:00,  8.25it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:01<00:00,  6.56it/s]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   1%|          | 22/4096 [00:00<00:19, 212.72it/s]
Adding requests:   1%|          | 49/4096 [00:00<00:16, 242.46it/s]
Adding requests:   2%|▏         | 75/4096 [00:00<00:16, 247.91it/s]
Adding requests:   3%|▎         | 104/4096 [00:00<00:15, 261.14it/s]
Adding requests:  14%|█▍        | 590/4096 [00:00<00:01, 1880.41it/s]
Adding requests:  19%|█▉        | 780/4096 [00:01<00:05, 615.84it/s] 
Adding requests:  22%|██▏       | 914/4096 [00:01<00:06, 466.55it/s]
Adding requests:  25%|██▍       | 1014/4096 [00:02<00:07, 396.39it/s]
Adding requests:  27%|██▋       | 1090/4096 [00:02<00:08, 363.35it/s]
Adding requests:  28%|██▊       | 1151/4096 [00:02<00:08, 343.34it/s]
Adding requests:  29%|██▉       | 1202/4096 [00:02<00:08, 332.02it/s]
Adding requests:  30%|███       | 1246/4096 [00:02<00:08, 324.72it/s]
Adding requests:  31%|███▏      | 1286/4096 [00:03<00:08, 312.30it/s]
Adding requests:  32%|███▏      | 1322/4096 [00:03<00:09, 301.44it/s]
Adding requests:  33%|███▎      | 1355/4096 [00:03<00:09, 287.64it/s]
Adding requests:  34%|███▍      | 1386/4096 [00:03<00:09, 278.03it/s]
Adding requests:  35%|███▍      | 1415/4096 [00:03<00:09, 278.66it/s]
Adding requests:  35%|███▌      | 1444/4096 [00:03<00:09, 279.93it/s]
Adding requests:  36%|███▌      | 1473/4096 [00:03<00:09, 277.70it/s]
Adding requests:  37%|███▋      | 1503/4096 [00:03<00:09, 282.93it/s]
Adding requests:  37%|███▋      | 1532/4096 [00:04<00:09, 283.87it/s]
Adding requests:  38%|███▊      | 1562/4096 [00:04<00:08, 287.09it/s]
Adding requests:  39%|███▉      | 1593/4096 [00:04<00:08, 291.11it/s]
Adding requests:  40%|███▉      | 1623/4096 [00:04<00:08, 287.20it/s]
Adding requests:  40%|████      | 1652/4096 [00:04<00:08, 279.94it/s]
Adding requests:  41%|████      | 1681/4096 [00:04<00:08, 276.51it/s]
Adding requests:  42%|████▏     | 1709/4096 [00:04<00:08, 275.72it/s]
Adding requests:  42%|████▏     | 1739/4096 [00:04<00:08, 278.75it/s]
Adding requests:  43%|████▎     | 1767/4096 [00:04<00:09, 252.00it/s]
Adding requests:  44%|████▍     | 1793/4096 [00:05<00:09, 243.47it/s]
Adding requests:  44%|████▍     | 1818/4096 [00:05<00:09, 234.73it/s]
Adding requests:  45%|████▍     | 1842/4096 [00:05<00:10, 224.41it/s]
Adding requests:  46%|████▌     | 1865/4096 [00:05<00:09, 225.42it/s]
Adding requests:  46%|████▌     | 1891/4096 [00:05<00:09, 234.96it/s]
Adding requests:  47%|████▋     | 1919/4096 [00:05<00:08, 245.25it/s]
Adding requests:  48%|████▊     | 1947/4096 [00:05<00:08, 255.18it/s]
Adding requests:  48%|████▊     | 1978/4096 [00:05<00:07, 269.13it/s]
Adding requests:  49%|████▉     | 2012/4096 [00:05<00:07, 287.59it/s]
Adding requests:  50%|████▉     | 2044/4096 [00:05<00:06, 297.03it/s]
Adding requests:  51%|█████     | 2076/4096 [00:06<00:06, 303.28it/s]
Adding requests:  51%|█████▏    | 2108/4096 [00:06<00:06, 307.37it/s]
Adding requests:  52%|█████▏    | 2139/4096 [00:06<00:06, 307.49it/s]
Adding requests:  53%|█████▎    | 2170/4096 [00:06<00:06, 297.55it/s]
Adding requests:  54%|█████▎    | 2200/4096 [00:06<00:06, 287.71it/s]
Adding requests:  54%|█████▍    | 2229/4096 [00:06<00:06, 286.82it/s]
Adding requests:  55%|█████▌    | 2258/4096 [00:06<00:06, 287.01it/s]
Adding requests:  56%|█████▌    | 2287/4096 [00:06<00:06, 283.61it/s]
Adding requests:  57%|█████▋    | 2317/4096 [00:06<00:06, 286.68it/s]
Adding requests:  57%|█████▋    | 2346/4096 [00:06<00:06, 285.89it/s]
Adding requests:  58%|█████▊    | 2375/4096 [00:07<00:06, 284.59it/s]
Adding requests:  59%|█████▊    | 2404/4096 [00:07<00:06, 272.32it/s]
Adding requests:  59%|█████▉    | 2433/4096 [00:07<00:06, 276.18it/s]
Adding requests:  60%|██████    | 2461/4096 [00:07<00:05, 273.21it/s]
Adding requests:  61%|██████    | 2489/4096 [00:07<00:05, 272.49it/s]
Adding requests:  61%|██████▏   | 2517/4096 [00:07<00:06, 241.40it/s]
Adding requests:  62%|██████▏   | 2542/4096 [00:07<00:06, 228.70it/s]
Adding requests:  63%|██████▎   | 2566/4096 [00:07<00:07, 218.17it/s]
Adding requests:  63%|██████▎   | 2589/4096 [00:08<00:07, 214.81it/s]
Adding requests:  64%|██████▍   | 2615/4096 [00:08<00:06, 225.64it/s]
Adding requests:  65%|██████▍   | 2644/4096 [00:08<00:06, 241.90it/s]
Adding requests:  65%|██████▌   | 2673/4096 [00:08<00:05, 252.90it/s]
Adding requests:  66%|██████▌   | 2699/4096 [00:08<00:05, 254.29it/s]
Adding requests:  67%|██████▋   | 2728/4096 [00:08<00:05, 263.92it/s]
Adding requests:  67%|██████▋   | 2757/4096 [00:08<00:04, 271.33it/s]
Adding requests:  68%|██████▊   | 2787/4096 [00:08<00:04, 277.86it/s]
Adding requests:  69%|██████▊   | 2815/4096 [00:08<00:04, 269.83it/s]
Adding requests:  69%|██████▉   | 2843/4096 [00:08<00:04, 265.70it/s]
Adding requests:  70%|███████   | 2870/4096 [00:09<00:04, 261.03it/s]
Adding requests:  71%|███████   | 2898/4096 [00:09<00:04, 265.23it/s]
Adding requests:  71%|███████▏  | 2925/4096 [00:09<00:04, 263.02it/s]
Adding requests:  72%|███████▏  | 2954/4096 [00:09<00:04, 269.95it/s]
Adding requests:  73%|███████▎  | 2982/4096 [00:09<00:04, 270.10it/s]
Adding requests:  73%|███████▎  | 3010/4096 [00:09<00:04, 265.54it/s]
Adding requests:  74%|███████▍  | 3037/4096 [00:09<00:04, 241.57it/s]
Adding requests:  75%|███████▍  | 3062/4096 [00:09<00:04, 230.89it/s]
Adding requests:  75%|███████▌  | 3086/4096 [00:09<00:04, 218.93it/s]
Adding requests:  76%|███████▌  | 3109/4096 [00:10<00:04, 206.67it/s]
Adding requests:  76%|███████▋  | 3131/4096 [00:10<00:04, 209.24it/s]
Adding requests:  77%|███████▋  | 3156/4096 [00:10<00:04, 219.64it/s]
Adding requests:  78%|███████▊  | 3182/4096 [00:10<00:03, 230.37it/s]
Adding requests:  78%|███████▊  | 3206/4096 [00:10<00:03, 224.09it/s]
Adding requests:  79%|███████▉  | 3229/4096 [00:10<00:03, 217.32it/s]
Adding requests:  79%|███████▉  | 3251/4096 [00:10<00:03, 214.76it/s]
Adding requests:  80%|████████  | 3277/4096 [00:10<00:03, 227.11it/s]
Adding requests:  81%|████████  | 3305/4096 [00:10<00:03, 240.43it/s]
Adding requests:  81%|████████▏ | 3333/4096 [00:11<00:03, 251.59it/s]
Adding requests:  82%|████████▏ | 3362/4096 [00:11<00:02, 262.71it/s]
Adding requests:  83%|████████▎ | 3389/4096 [00:11<00:02, 258.01it/s]
Adding requests:  83%|████████▎ | 3415/4096 [00:11<00:02, 257.30it/s]
Adding requests:  84%|████████▍ | 3441/4096 [00:11<00:02, 253.15it/s]
Adding requests:  85%|████████▍ | 3467/4096 [00:11<00:02, 250.96it/s]
Adding requests:  85%|████████▌ | 3493/4096 [00:11<00:02, 243.62it/s]
Adding requests:  86%|████████▌ | 3519/4096 [00:11<00:02, 247.04it/s]
Adding requests:  87%|████████▋ | 3549/4096 [00:11<00:02, 260.57it/s]
Adding requests:  87%|████████▋ | 3577/4096 [00:11<00:01, 265.27it/s]
Adding requests:  88%|████████▊ | 3607/4096 [00:12<00:01, 274.71it/s]
Adding requests:  89%|████████▉ | 3636/4096 [00:12<00:01, 278.51it/s]
Adding requests:  89%|████████▉ | 3665/4096 [00:12<00:01, 280.43it/s]
Adding requests:  90%|█████████ | 3694/4096 [00:12<00:01, 270.74it/s]
Adding requests:  91%|█████████ | 3722/4096 [00:12<00:01, 263.24it/s]
Adding requests:  92%|█████████▏| 3749/4096 [00:12<00:01, 249.79it/s]
Adding requests:  92%|█████████▏| 3778/4096 [00:12<00:01, 260.61it/s]
Adding requests:  93%|█████████▎| 3806/4096 [00:12<00:01, 264.92it/s]
Adding requests:  94%|█████████▎| 3839/4096 [00:12<00:00, 282.89it/s]
Adding requests:  94%|█████████▍| 3870/4096 [00:13<00:00, 290.25it/s]
Adding requests:  95%|█████████▌| 3902/4096 [00:13<00:00, 297.02it/s]
Adding requests:  96%|█████████▌| 3933/4096 [00:13<00:00, 298.52it/s]
Adding requests:  97%|█████████▋| 3963/4096 [00:13<00:00, 298.19it/s]
Adding requests:  97%|█████████▋| 3993/4096 [00:13<00:00, 292.11it/s]
Adding requests:  98%|█████████▊| 4023/4096 [00:13<00:00, 291.52it/s]
Adding requests:  99%|█████████▉| 4053/4096 [00:13<00:00, 275.59it/s]
Adding requests: 100%|█████████▉| 4081/4096 [00:13<00:00, 266.83it/s]
Adding requests: 100%|██████████| 4096/4096 [00:13<00:00, 295.98it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  16%|█▋        | 674/4096 [00:00<00:02, 1439.13it/s, est. speed input: 1473774.22 toks/s, output: 1439.15 toks/s]
Processed prompts:  20%|█▉        | 818/4096 [00:03<00:16, 196.24it/s, est. speed input: 255499.32 toks/s, output: 249.51 toks/s]   
Processed prompts:  22%|██▏       | 881/4096 [00:04<00:23, 136.31it/s, est. speed input: 191681.65 toks/s, output: 187.19 toks/s]
Processed prompts:  22%|██▏       | 917/4096 [00:05<00:27, 117.44it/s, est. speed input: 173227.34 toks/s, output: 169.17 toks/s]
Processed prompts:  23%|██▎       | 941/4096 [00:06<00:32, 98.10it/s, est. speed input: 157599.98 toks/s, output: 153.91 toks/s] 
Processed prompts:  23%|██▎       | 962/4096 [00:06<00:38, 82.14it/s, est. speed input: 145435.63 toks/s, output: 142.03 toks/s]
Processed prompts:  24%|██▍       | 994/4096 [00:07<00:42, 73.53it/s, est. speed input: 136933.23 toks/s, output: 133.72 toks/s]
Processed prompts:  25%|██▌       | 1026/4096 [00:08<00:45, 66.82it/s, est. speed input: 129814.88 toks/s, output: 126.77 toks/s]
Processed prompts:  26%|██▌       | 1058/4096 [00:08<00:49, 61.74it/s, est. speed input: 123766.11 toks/s, output: 120.87 toks/s]
Processed prompts:  27%|██▋       | 1090/4096 [00:09<00:52, 57.16it/s, est. speed input: 118149.92 toks/s, output: 115.38 toks/s]
Processed prompts:  27%|██▋       | 1122/4096 [00:10<00:55, 53.40it/s, est. speed input: 113055.10 toks/s, output: 110.41 toks/s]
Processed prompts:  28%|██▊       | 1154/4096 [00:10<00:57, 51.17it/s, est. speed input: 108809.33 toks/s, output: 106.26 toks/s]
Processed prompts:  29%|██▉       | 1186/4096 [00:11<00:59, 49.23it/s, est. speed input: 104916.58 toks/s, output: 102.46 toks/s]
Processed prompts:  30%|██▉       | 1218/4096 [00:12<01:00, 47.86it/s, est. speed input: 101474.08 toks/s, output: 99.10 toks/s] 
Processed prompts:  31%|███       | 1250/4096 [00:13<01:00, 46.91it/s, est. speed input: 98407.11 toks/s, output: 96.10 toks/s] 
Processed prompts:  31%|███▏      | 1282/4096 [00:13<01:00, 46.25it/s, est. speed input: 95663.03 toks/s, output: 93.42 toks/s]
Processed prompts:  32%|███▏      | 1314/4096 [00:14<00:59, 46.58it/s, est. speed input: 93451.69 toks/s, output: 91.26 toks/s]
Processed prompts:  33%|███▎      | 1346/4096 [00:15<00:58, 47.10it/s, est. speed input: 91523.73 toks/s, output: 89.38 toks/s]
Processed prompts:  34%|███▎      | 1378/4096 [00:15<00:57, 47.48it/s, est. speed input: 89759.84 toks/s, output: 87.66 toks/s]
Processed prompts:  34%|███▍      | 1410/4096 [00:16<00:56, 47.75it/s, est. speed input: 88136.38 toks/s, output: 86.07 toks/s]
Processed prompts:  35%|███▌      | 1442/4096 [00:17<00:55, 47.93it/s, est. speed input: 86637.24 toks/s, output: 84.61 toks/s]
Processed prompts:  38%|███▊      | 1538/4096 [00:17<00:30, 82.53it/s, est. speed input: 89737.91 toks/s, output: 87.63 toks/s]
Processed prompts:  38%|███▊      | 1570/4096 [00:18<00:36, 70.01it/s, est. speed input: 88011.61 toks/s, output: 85.95 toks/s]
Processed prompts:  39%|███▉      | 1602/4096 [00:18<00:40, 61.88it/s, est. speed input: 86416.16 toks/s, output: 84.39 toks/s]
Processed prompts:  40%|███▉      | 1634/4096 [00:19<00:43, 56.47it/s, est. speed input: 84936.06 toks/s, output: 82.95 toks/s]
Processed prompts:  41%|████      | 1666/4096 [00:20<00:46, 52.81it/s, est. speed input: 83561.18 toks/s, output: 81.60 toks/s]
Processed prompts:  41%|████▏     | 1698/4096 [00:21<00:47, 50.32it/s, est. speed input: 82279.35 toks/s, output: 80.35 toks/s]
Processed prompts:  42%|████▏     | 1730/4096 [00:21<00:47, 49.35it/s, est. speed input: 81214.79 toks/s, output: 79.31 toks/s]
Processed prompts:  43%|████▎     | 1762/4096 [00:22<00:47, 49.07it/s, est. speed input: 80282.95 toks/s, output: 78.40 toks/s]
Processed prompts:  44%|████▍     | 1794/4096 [00:23<00:47, 48.81it/s, est. speed input: 79395.35 toks/s, output: 77.53 toks/s]
Processed prompts:  45%|████▍     | 1826/4096 [00:23<00:46, 48.63it/s, est. speed input: 78556.56 toks/s, output: 76.72 toks/s]
Processed prompts:  45%|████▌     | 1858/4096 [00:24<00:45, 48.93it/s, est. speed input: 77826.09 toks/s, output: 76.00 toks/s]
Processed prompts:  46%|████▌     | 1890/4096 [00:25<00:45, 48.69it/s, est. speed input: 77070.89 toks/s, output: 75.26 toks/s]
Processed prompts:  47%|████▋     | 1922/4096 [00:25<00:45, 47.43it/s, est. speed input: 76203.73 toks/s, output: 74.42 toks/s]
Processed prompts:  48%|████▊     | 1954/4096 [00:26<00:45, 46.57it/s, est. speed input: 75380.68 toks/s, output: 73.61 toks/s]
Processed prompts:  48%|████▊     | 1986/4096 [00:27<00:45, 45.98it/s, est. speed input: 74601.31 toks/s, output: 72.85 toks/s]
Processed prompts:  49%|████▉     | 2018/4096 [00:27<00:45, 45.58it/s, est. speed input: 73862.68 toks/s, output: 72.13 toks/s]
Processed prompts:  50%|█████     | 2050/4096 [00:28<00:45, 45.31it/s, est. speed input: 73160.97 toks/s, output: 71.45 toks/s]
Processed prompts:  51%|█████     | 2082/4096 [00:29<00:44, 45.12it/s, est. speed input: 72493.66 toks/s, output: 70.79 toks/s]
Processed prompts:  52%|█████▏    | 2114/4096 [00:30<00:44, 44.99it/s, est. speed input: 71858.40 toks/s, output: 70.17 toks/s]
Processed prompts:  52%|█████▏    | 2146/4096 [00:30<00:43, 44.90it/s, est. speed input: 71252.45 toks/s, output: 69.58 toks/s]
Processed prompts:  53%|█████▎    | 2178/4096 [00:31<00:42, 45.11it/s, est. speed input: 70706.63 toks/s, output: 69.05 toks/s]
Processed prompts:  54%|█████▍    | 2210/4096 [00:32<00:40, 46.05it/s, est. speed input: 70272.16 toks/s, output: 68.63 toks/s]
Processed prompts:  55%|█████▍    | 2242/4096 [00:32<00:39, 46.73it/s, est. speed input: 69855.77 toks/s, output: 68.22 toks/s]
Processed prompts:  56%|█████▌    | 2274/4096 [00:33<00:39, 46.50it/s, est. speed input: 69383.73 toks/s, output: 67.76 toks/s]
Processed prompts:  56%|█████▋    | 2306/4096 [00:34<00:38, 45.95it/s, est. speed input: 68890.83 toks/s, output: 67.28 toks/s]
Processed prompts:  57%|█████▋    | 2338/4096 [00:34<00:38, 45.56it/s, est. speed input: 68416.83 toks/s, output: 66.81 toks/s]
Processed prompts:  58%|█████▊    | 2370/4096 [00:35<00:38, 45.29it/s, est. speed input: 67961.79 toks/s, output: 66.37 toks/s]
Processed prompts:  59%|█████▊    | 2402/4096 [00:36<00:37, 45.10it/s, est. speed input: 67525.20 toks/s, output: 65.94 toks/s]
Processed prompts:  59%|█████▉    | 2434/4096 [00:37<00:36, 44.97it/s, est. speed input: 67105.20 toks/s, output: 65.53 toks/s]
Processed prompts:  60%|██████    | 2466/4096 [00:37<00:36, 44.88it/s, est. speed input: 66701.13 toks/s, output: 65.14 toks/s]
Processed prompts:  61%|██████    | 2498/4096 [00:38<00:35, 45.50it/s, est. speed input: 66373.37 toks/s, output: 64.82 toks/s]
Processed prompts:  62%|██████▏   | 2530/4096 [00:39<00:33, 46.33it/s, est. speed input: 66089.49 toks/s, output: 64.54 toks/s]
Processed prompts:  63%|██████▎   | 2562/4096 [00:39<00:32, 46.93it/s, est. speed input: 65814.92 toks/s, output: 64.27 toks/s]
Processed prompts:  63%|██████▎   | 2594/4096 [00:40<00:31, 47.36it/s, est. speed input: 65549.56 toks/s, output: 64.01 toks/s]
Processed prompts:  64%|██████▍   | 2626/4096 [00:41<00:30, 47.58it/s, est. speed input: 65286.22 toks/s, output: 63.76 toks/s]
Processed prompts:  65%|██████▍   | 2658/4096 [00:41<00:30, 46.67it/s, est. speed input: 64952.30 toks/s, output: 63.43 toks/s]
Processed prompts:  66%|██████▌   | 2690/4096 [00:42<00:30, 46.05it/s, est. speed input: 64629.38 toks/s, output: 63.11 toks/s]
Processed prompts:  66%|██████▋   | 2722/4096 [00:43<00:30, 45.62it/s, est. speed input: 64316.77 toks/s, output: 62.81 toks/s]
Processed prompts:  67%|██████▋   | 2754/4096 [00:44<00:29, 45.34it/s, est. speed input: 64015.06 toks/s, output: 62.51 toks/s]
Processed prompts:  68%|██████▊   | 2786/4096 [00:44<00:29, 45.14it/s, est. speed input: 63723.00 toks/s, output: 62.23 toks/s]
Processed prompts:  69%|██████▉   | 2818/4096 [00:45<00:28, 45.04it/s, est. speed input: 63442.85 toks/s, output: 61.96 toks/s]
Processed prompts:  70%|██████▉   | 2850/4096 [00:46<00:27, 45.25it/s, est. speed input: 63191.73 toks/s, output: 61.71 toks/s]
Processed prompts:  70%|███████   | 2882/4096 [00:46<00:26, 46.16it/s, est. speed input: 62999.93 toks/s, output: 61.52 toks/s]
Processed prompts:  71%|███████   | 2914/4096 [00:47<00:25, 46.83it/s, est. speed input: 62813.83 toks/s, output: 61.34 toks/s]
Processed prompts:  72%|███████▏  | 2946/4096 [00:48<00:24, 47.32it/s, est. speed input: 62634.22 toks/s, output: 61.17 toks/s]
Processed prompts:  74%|███████▍  | 3042/4096 [00:48<00:11, 91.31it/s, est. speed input: 64286.43 toks/s, output: 62.78 toks/s]
Processed prompts:  75%|███████▌  | 3074/4096 [00:49<00:13, 76.95it/s, est. speed input: 64089.61 toks/s, output: 62.59 toks/s]
Processed prompts:  76%|███████▌  | 3106/4096 [00:49<00:14, 66.47it/s, est. speed input: 63848.52 toks/s, output: 62.35 toks/s]
Processed prompts:  77%|███████▋  | 3138/4096 [00:50<00:16, 59.29it/s, est. speed input: 63592.71 toks/s, output: 62.10 toks/s]
Processed prompts:  77%|███████▋  | 3170/4096 [00:51<00:16, 54.64it/s, est. speed input: 63344.93 toks/s, output: 61.86 toks/s]
Processed prompts:  78%|███████▊  | 3202/4096 [00:51<00:17, 51.54it/s, est. speed input: 63103.92 toks/s, output: 61.62 toks/s]
Processed prompts:  79%|███████▉  | 3234/4096 [00:52<00:17, 49.43it/s, est. speed input: 62869.24 toks/s, output: 61.40 toks/s]
Processed prompts:  80%|███████▉  | 3266/4096 [00:53<00:17, 48.00it/s, est. speed input: 62640.88 toks/s, output: 61.17 toks/s]
Processed prompts:  81%|████████  | 3298/4096 [00:54<00:16, 47.04it/s, est. speed input: 62420.57 toks/s, output: 60.96 toks/s]
Processed prompts:  81%|████████▏ | 3330/4096 [00:54<00:16, 46.42it/s, est. speed input: 62208.26 toks/s, output: 60.75 toks/s]
Processed prompts:  82%|████████▏ | 3362/4096 [00:55<00:15, 47.01it/s, est. speed input: 62058.67 toks/s, output: 60.60 toks/s]
Processed prompts:  83%|████████▎ | 3394/4096 [00:56<00:14, 47.44it/s, est. speed input: 61912.87 toks/s, output: 60.46 toks/s]
Processed prompts:  84%|████████▎ | 3426/4096 [00:56<00:14, 47.74it/s, est. speed input: 61770.24 toks/s, output: 60.32 toks/s]
Processed prompts:  84%|████████▍ | 3458/4096 [00:57<00:13, 47.76it/s, est. speed input: 61620.67 toks/s, output: 60.18 toks/s]
Processed prompts:  85%|████████▌ | 3490/4096 [00:58<00:12, 46.82it/s, est. speed input: 61426.57 toks/s, output: 59.99 toks/s]
Processed prompts:  86%|████████▌ | 3522/4096 [00:58<00:12, 46.18it/s, est. speed input: 61237.36 toks/s, output: 59.80 toks/s]
Processed prompts:  87%|████████▋ | 3554/4096 [00:59<00:11, 45.74it/s, est. speed input: 61052.32 toks/s, output: 59.62 toks/s]
Processed prompts:  88%|████████▊ | 3586/4096 [01:00<00:11, 45.44it/s, est. speed input: 60871.70 toks/s, output: 59.44 toks/s]
Processed prompts:  88%|████████▊ | 3618/4096 [01:01<00:10, 45.23it/s, est. speed input: 60695.55 toks/s, output: 59.27 toks/s]
Processed prompts:  89%|████████▉ | 3650/4096 [01:01<00:09, 45.09it/s, est. speed input: 60523.34 toks/s, output: 59.10 toks/s]
Processed prompts:  90%|████████▉ | 3682/4096 [01:02<00:09, 44.99it/s, est. speed input: 60355.14 toks/s, output: 58.94 toks/s]
Processed prompts:  91%|█████████ | 3714/4096 [01:03<00:08, 45.64it/s, est. speed input: 60226.74 toks/s, output: 58.82 toks/s]
Processed prompts:  91%|█████████▏| 3746/4096 [01:03<00:07, 46.45it/s, est. speed input: 60117.07 toks/s, output: 58.71 toks/s]
Processed prompts:  92%|█████████▏| 3778/4096 [01:04<00:06, 47.04it/s, est. speed input: 60009.77 toks/s, output: 58.60 toks/s]
Processed prompts:  93%|█████████▎| 3810/4096 [01:05<00:06, 47.46it/s, est. speed input: 59904.71 toks/s, output: 58.50 toks/s]
Processed prompts:  94%|█████████▍| 3842/4096 [01:05<00:05, 47.01it/s, est. speed input: 59769.38 toks/s, output: 58.37 toks/s]
Processed prompts:  95%|█████████▍| 3874/4096 [01:06<00:04, 46.31it/s, est. speed input: 59619.50 toks/s, output: 58.22 toks/s]
Processed prompts:  95%|█████████▌| 3906/4096 [01:07<00:04, 45.83it/s, est. speed input: 59472.71 toks/s, output: 58.08 toks/s]
Processed prompts:  96%|█████████▌| 3938/4096 [01:07<00:03, 45.50it/s, est. speed input: 59328.94 toks/s, output: 57.94 toks/s]
Processed prompts:  97%|█████████▋| 3970/4096 [01:08<00:02, 45.26it/s, est. speed input: 59187.77 toks/s, output: 57.80 toks/s]
Processed prompts:  98%|█████████▊| 4002/4096 [01:09<00:02, 45.11it/s, est. speed input: 59050.44 toks/s, output: 57.67 toks/s]
Processed prompts:  98%|█████████▊| 4034/4096 [01:10<00:01, 45.35it/s, est. speed input: 58930.66 toks/s, output: 57.55 toks/s]
Processed prompts:  99%|█████████▉| 4066/4096 [01:10<00:00, 45.94it/s, est. speed input: 58831.26 toks/s, output: 57.45 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [01:10<00:00, 45.94it/s, est. speed input: 59264.87 toks/s, output: 57.88 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [01:10<00:00, 57.88it/s, est. speed input: 59264.87 toks/s, output: 57.88 toks/s]
[rank0]:[W125 22:04:20.956531363 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=65536 ==========
Time: 2026-01-25 22:04:23
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-FP8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=8192, max_num_seqs=64
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-FP8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 8192 --max-num-seqs 64 --max-model-len 1025 --max-num-batched-tokens 65536 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_4/json/Llama3.2-3B-FP8_M65536.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 22:05:23 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 22:05:24 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=460469) WARNING 01-25 22:05:31 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=460469) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=460469) WARNING 01-25 22:05:42 [backends.py:609] Failed to read file <frozen os>
Throughput: 20.97 requests/s, 21494.75 total tokens/s, 20.97 output tokens/s
Total num prompt tokens:  8388608
Total num output tokens:  8192

STDERR:
[2026-01-25 22:05:23] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 22:05:23] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-FP8'
[2026-01-25 22:05:23] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-FP8
[2026-01-25 22:05:23] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 22:05:23] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 22:05:23] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 22:05:23] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 22:05:23] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 22:05:23] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-FP8'
[2026-01-25 22:05:23] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 22:05:23] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 22:05:23] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 22:05:23] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 22:05:23] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 22:05:30] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 22:05:30] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-FP8'
[2026-01-25 22:05:30] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-FP8
[2026-01-25 22:05:30] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 22:05:30] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 22:05:30] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 22:05:30] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 22:05:30] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-25 22:05:30] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-FP8'
[2026-01-25 22:05:30] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 22:05:30] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 22:05:30] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 22:05:30] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 22:05:30] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=460469) [2026-01-25 22:05:31] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=460469) [2026-01-25 22:05:31] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=460469) [2026-01-25 22:05:31] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=460469) [2026-01-25 22:05:31] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=460469) [2026-01-25 22:05:31] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Llama3.2-3B-FP8
(EngineCore_DP0 pid=460469) [2026-01-25 22:05:31] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=460469) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=460469) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.22it/s]
(EngineCore_DP0 pid=460469) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.22it/s]
(EngineCore_DP0 pid=460469) 
(EngineCore_DP0 pid=460469) [2026-01-25 22:05:32] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 3072] -> 1D uint8
(EngineCore_DP0 pid=460469) [2026-01-25 22:05:33] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 11796480 bytes
(EngineCore_DP0 pid=460469) [2026-01-25 22:05:33] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 3072] -> 1D uint8
(EngineCore_DP0 pid=460469) [2026-01-25 22:05:33] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 7077888 bytes
(EngineCore_DP0 pid=460469) [2026-01-25 22:05:33] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [16384, 3072] -> 1D uint8
(EngineCore_DP0 pid=460469) [2026-01-25 22:05:33] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 37748736 bytes
(EngineCore_DP0 pid=460469) [2026-01-25 22:05:33] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 8192] -> 1D uint8
(EngineCore_DP0 pid=460469) [2026-01-25 22:05:33] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 18874368 bytes
(EngineCore_DP0 pid=460469) [rank0]:W0125 22:05:51.404000 460469 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=460469) [rank0]:W0125 22:05:51.530000 460469 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=460469) [rank0]:W0125 22:05:53.149000 460469 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=460469) [rank0]:W0125 22:05:53.340000 460469 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=460469) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/19 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   5%|▌         | 1/19 [00:00<00:05,  3.43it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  11%|█         | 2/19 [00:00<00:04,  3.42it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  16%|█▌        | 3/19 [00:00<00:03,  4.59it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  21%|██        | 4/19 [00:00<00:02,  5.56it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  26%|██▋       | 5/19 [00:00<00:02,  6.19it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  32%|███▏      | 6/19 [00:01<00:02,  6.07it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  37%|███▋      | 7/19 [00:01<00:02,  4.96it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  79%|███████▉  | 15/19 [00:01<00:00, 16.24it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  89%|████████▉ | 17/19 [00:01<00:00, 13.52it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 19/19 [00:02<00:00, 11.26it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 19/19 [00:02<00:00,  8.99it/s]
(EngineCore_DP0 pid=460469) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):   9%|▉         | 1/11 [00:00<00:01,  7.12it/s]
Capturing CUDA graphs (decode, FULL):  18%|█▊        | 2/11 [00:00<00:01,  7.85it/s]
Capturing CUDA graphs (decode, FULL):  27%|██▋       | 3/11 [00:00<00:00,  8.02it/s]
Capturing CUDA graphs (decode, FULL):  36%|███▋      | 4/11 [00:00<00:00,  8.18it/s]
Capturing CUDA graphs (decode, FULL):  45%|████▌     | 5/11 [00:00<00:00,  7.39it/s]
Capturing CUDA graphs (decode, FULL):  55%|█████▍    | 6/11 [00:00<00:00,  6.57it/s]
Capturing CUDA graphs (decode, FULL):  64%|██████▎   | 7/11 [00:01<00:01,  3.89it/s]
Capturing CUDA graphs (decode, FULL):  73%|███████▎  | 8/11 [00:01<00:00,  4.40it/s]
Capturing CUDA graphs (decode, FULL):  82%|████████▏ | 9/11 [00:01<00:00,  4.81it/s]
Capturing CUDA graphs (decode, FULL):  91%|█████████ | 10/11 [00:01<00:00,  4.49it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 11/11 [00:02<00:00,  4.85it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 11/11 [00:02<00:00,  5.32it/s]

Adding requests:   0%|          | 0/8192 [00:00<?, ?it/s]
Adding requests:   0%|          | 27/8192 [00:00<00:30, 269.65it/s]
Adding requests:   1%|          | 58/8192 [00:00<00:28, 290.20it/s]
Adding requests:   1%|          | 90/8192 [00:00<00:26, 300.12it/s]
Adding requests:   1%|▏         | 120/8192 [00:00<00:27, 298.59it/s]
Adding requests:   2%|▏         | 150/8192 [00:00<00:27, 296.71it/s]
Adding requests:   2%|▏         | 180/8192 [00:00<00:27, 291.15it/s]
Adding requests:   3%|▎         | 210/8192 [00:00<00:27, 289.93it/s]
Adding requests:   3%|▎         | 240/8192 [00:00<00:27, 291.30it/s]
Adding requests:   3%|▎         | 270/8192 [00:00<00:26, 293.92it/s]
Adding requests:   4%|▎         | 300/8192 [00:01<00:27, 291.95it/s]
Adding requests:   4%|▍         | 331/8192 [00:01<00:26, 296.25it/s]
Adding requests:   4%|▍         | 361/8192 [00:01<00:26, 295.34it/s]
Adding requests:   5%|▍         | 391/8192 [00:01<00:26, 294.89it/s]
Adding requests:   5%|▌         | 423/8192 [00:01<00:25, 300.45it/s]
Adding requests:   6%|▌         | 454/8192 [00:01<00:25, 303.04it/s]
Adding requests:   6%|▌         | 487/8192 [00:01<00:24, 308.94it/s]
Adding requests:   6%|▋         | 518/8192 [00:01<00:25, 305.39it/s]
Adding requests:   7%|▋         | 549/8192 [00:01<00:25, 305.67it/s]
Adding requests:   7%|▋         | 580/8192 [00:01<00:25, 298.48it/s]
Adding requests:   7%|▋         | 610/8192 [00:02<00:26, 291.09it/s]
Adding requests:   8%|▊         | 640/8192 [00:02<00:26, 288.55it/s]
Adding requests:   8%|▊         | 669/8192 [00:02<00:26, 286.57it/s]
Adding requests:   9%|▊         | 699/8192 [00:02<00:25, 289.77it/s]
Adding requests:   9%|▉         | 729/8192 [00:02<00:26, 282.84it/s]
Adding requests:   9%|▉         | 758/8192 [00:02<00:26, 283.93it/s]
Adding requests:  10%|▉         | 787/8192 [00:02<00:26, 274.70it/s]
Adding requests:  10%|▉         | 815/8192 [00:02<00:29, 254.37it/s]
Adding requests:  10%|█         | 842/8192 [00:02<00:28, 256.29it/s]
Adding requests:  11%|█         | 871/8192 [00:03<00:27, 263.37it/s]
Adding requests:  11%|█         | 898/8192 [00:03<00:27, 264.18it/s]
Adding requests:  11%|█▏        | 926/8192 [00:03<00:27, 266.71it/s]
Adding requests:  12%|█▏        | 953/8192 [00:03<00:27, 267.18it/s]
Adding requests:  12%|█▏        | 981/8192 [00:03<00:26, 270.38it/s]
Adding requests:  12%|█▏        | 1009/8192 [00:03<00:26, 268.37it/s]
Adding requests:  13%|█▎        | 1037/8192 [00:03<00:26, 271.62it/s]
Adding requests:  13%|█▎        | 1065/8192 [00:03<00:26, 271.99it/s]
Adding requests:  13%|█▎        | 1093/8192 [00:03<00:26, 271.81it/s]
Adding requests:  14%|█▎        | 1121/8192 [00:03<00:27, 261.37it/s]
Adding requests:  14%|█▍        | 1148/8192 [00:04<00:27, 257.58it/s]
Adding requests:  14%|█▍        | 1176/8192 [00:04<00:26, 261.57it/s]
Adding requests:  15%|█▍        | 1205/8192 [00:04<00:26, 267.44it/s]
Adding requests:  15%|█▌        | 1232/8192 [00:04<00:26, 265.12it/s]
Adding requests:  15%|█▌        | 1259/8192 [00:04<00:26, 261.07it/s]
Adding requests:  16%|█▌        | 1286/8192 [00:04<00:26, 262.99it/s]
Adding requests:  16%|█▌        | 1314/8192 [00:04<00:25, 267.68it/s]
Adding requests:  16%|█▋        | 1343/8192 [00:04<00:25, 272.74it/s]
Adding requests:  17%|█▋        | 1371/8192 [00:04<00:25, 265.24it/s]
Adding requests:  17%|█▋        | 1399/8192 [00:05<00:25, 268.49it/s]
Adding requests:  17%|█▋        | 1428/8192 [00:05<00:24, 273.36it/s]
Adding requests:  18%|█▊        | 1456/8192 [00:05<00:24, 273.74it/s]
Adding requests:  18%|█▊        | 1484/8192 [00:05<00:24, 274.32it/s]
Adding requests:  18%|█▊        | 1514/8192 [00:05<00:23, 280.99it/s]
Adding requests:  19%|█▉        | 1543/8192 [00:05<00:23, 281.37it/s]
Adding requests:  19%|█▉        | 1572/8192 [00:05<00:23, 283.32it/s]
Adding requests:  20%|█▉        | 1603/8192 [00:05<00:22, 288.55it/s]
Adding requests:  20%|█▉        | 1632/8192 [00:05<00:22, 288.97it/s]
Adding requests:  20%|██        | 1661/8192 [00:05<00:23, 279.71it/s]
Adding requests:  21%|██        | 1690/8192 [00:06<00:24, 265.74it/s]
Adding requests:  21%|██        | 1720/8192 [00:06<00:23, 273.27it/s]
Adding requests:  21%|██▏       | 1748/8192 [00:06<00:23, 274.62it/s]
Adding requests:  22%|██▏       | 1777/8192 [00:06<00:23, 276.86it/s]
Adding requests:  22%|██▏       | 1805/8192 [00:06<00:23, 270.44it/s]
Adding requests:  22%|██▏       | 1834/8192 [00:06<00:23, 273.46it/s]
Adding requests:  23%|██▎       | 1862/8192 [00:06<00:23, 271.71it/s]
Adding requests:  23%|██▎       | 1890/8192 [00:06<00:23, 264.50it/s]
Adding requests:  23%|██▎       | 1917/8192 [00:06<00:23, 261.96it/s]
Adding requests:  24%|██▎       | 1944/8192 [00:06<00:23, 263.76it/s]
Adding requests:  24%|██▍       | 1972/8192 [00:07<00:23, 266.47it/s]
Adding requests:  24%|██▍       | 1999/8192 [00:07<00:23, 266.61it/s]
Adding requests:  25%|██▍       | 2027/8192 [00:07<00:22, 268.39it/s]
Adding requests:  25%|██▌       | 2055/8192 [00:07<00:22, 270.15it/s]
Adding requests:  25%|██▌       | 2083/8192 [00:07<00:22, 271.20it/s]
Adding requests:  26%|██▌       | 2111/8192 [00:07<00:22, 268.86it/s]
Adding requests:  26%|██▌       | 2139/8192 [00:07<00:22, 269.43it/s]
Adding requests:  26%|██▋       | 2166/8192 [00:07<00:22, 268.32it/s]
Adding requests:  27%|██▋       | 2195/8192 [00:07<00:21, 274.44it/s]
Adding requests:  27%|██▋       | 2225/8192 [00:08<00:21, 279.21it/s]
Adding requests:  28%|██▊       | 2255/8192 [00:08<00:20, 282.93it/s]
Adding requests:  28%|██▊       | 2286/8192 [00:08<00:20, 288.41it/s]
Adding requests:  28%|██▊       | 2318/8192 [00:08<00:19, 296.40it/s]
Adding requests:  29%|██▊       | 2348/8192 [00:08<00:19, 295.79it/s]
Adding requests:  29%|██▉       | 2380/8192 [00:08<00:19, 300.65it/s]
Adding requests:  29%|██▉       | 2412/8192 [00:08<00:18, 304.82it/s]
Adding requests:  30%|██▉       | 2445/8192 [00:08<00:18, 311.20it/s]
Adding requests:  30%|███       | 2477/8192 [00:08<00:18, 310.08it/s]
Adding requests:  31%|███       | 2509/8192 [00:08<00:18, 307.57it/s]
Adding requests:  31%|███       | 2540/8192 [00:09<00:18, 306.30it/s]
Adding requests:  31%|███▏      | 2572/8192 [00:09<00:18, 308.22it/s]
Adding requests:  32%|███▏      | 2603/8192 [00:09<00:18, 302.16it/s]
Adding requests:  32%|███▏      | 2635/8192 [00:09<00:18, 304.65it/s]
Adding requests:  33%|███▎      | 2666/8192 [00:09<00:18, 301.81it/s]
Adding requests:  33%|███▎      | 2697/8192 [00:09<00:18, 299.61it/s]
Adding requests:  33%|███▎      | 2727/8192 [00:09<00:18, 299.22it/s]
Adding requests:  34%|███▎      | 2757/8192 [00:09<00:18, 299.09it/s]
Adding requests:  34%|███▍      | 2787/8192 [00:09<00:18, 297.38it/s]
Adding requests:  34%|███▍      | 2817/8192 [00:09<00:18, 295.19it/s]
Adding requests:  35%|███▍      | 2847/8192 [00:10<00:18, 287.85it/s]
Adding requests:  35%|███▌      | 2876/8192 [00:10<00:19, 279.15it/s]
Adding requests:  35%|███▌      | 2904/8192 [00:10<00:19, 277.37it/s]
Adding requests:  36%|███▌      | 2932/8192 [00:10<00:19, 271.72it/s]
Adding requests:  36%|███▌      | 2960/8192 [00:10<00:19, 270.62it/s]
Adding requests:  36%|███▋      | 2988/8192 [00:10<00:19, 271.65it/s]
Adding requests:  37%|███▋      | 3016/8192 [00:10<00:19, 271.01it/s]
Adding requests:  37%|███▋      | 3044/8192 [00:10<00:19, 270.69it/s]
Adding requests:  38%|███▊      | 3072/8192 [00:10<00:19, 265.36it/s]
Adding requests:  38%|███▊      | 3099/8192 [00:11<00:19, 263.93it/s]
Adding requests:  38%|███▊      | 3128/8192 [00:11<00:18, 270.15it/s]
Adding requests:  39%|███▊      | 3156/8192 [00:11<00:18, 269.88it/s]
Adding requests:  39%|███▉      | 3186/8192 [00:11<00:18, 277.62it/s]
Adding requests:  39%|███▉      | 3216/8192 [00:11<00:17, 283.38it/s]
Adding requests:  40%|███▉      | 3245/8192 [00:11<00:18, 272.79it/s]
Adding requests:  40%|███▉      | 3274/8192 [00:11<00:17, 275.94it/s]
Adding requests:  40%|████      | 3305/8192 [00:11<00:17, 284.45it/s]
Adding requests:  41%|████      | 3334/8192 [00:11<00:17, 284.20it/s]
Adding requests:  41%|████      | 3364/8192 [00:11<00:16, 286.03it/s]
Adding requests:  41%|████▏     | 3393/8192 [00:12<00:16, 286.67it/s]
Adding requests:  42%|████▏     | 3425/8192 [00:12<00:16, 294.26it/s]
Adding requests:  42%|████▏     | 3455/8192 [00:12<00:17, 277.29it/s]
Adding requests:  43%|████▎     | 3483/8192 [00:12<00:17, 273.43it/s]
Adding requests:  43%|████▎     | 3512/8192 [00:12<00:16, 276.20it/s]
Adding requests:  43%|████▎     | 3540/8192 [00:12<00:16, 275.82it/s]
Adding requests:  44%|████▎     | 3568/8192 [00:12<00:17, 270.23it/s]
Adding requests:  44%|████▍     | 3596/8192 [00:12<00:16, 272.22it/s]
Adding requests:  44%|████▍     | 3624/8192 [00:12<00:16, 274.00it/s]
Adding requests:  45%|████▍     | 3652/8192 [00:13<00:16, 273.78it/s]
Adding requests:  45%|████▍     | 3680/8192 [00:13<00:16, 270.32it/s]
Adding requests:  45%|████▌     | 3708/8192 [00:13<00:16, 270.91it/s]
Adding requests:  46%|████▌     | 3736/8192 [00:13<00:16, 267.46it/s]
Adding requests:  46%|████▌     | 3764/8192 [00:13<00:16, 268.15it/s]
Adding requests:  46%|████▋     | 3792/8192 [00:13<00:16, 271.48it/s]
Adding requests:  47%|████▋     | 3820/8192 [00:13<00:16, 270.17it/s]
Adding requests:  47%|████▋     | 3848/8192 [00:13<00:15, 271.99it/s]
Adding requests:  47%|████▋     | 3877/8192 [00:13<00:15, 276.70it/s]
Adding requests:  48%|████▊     | 3905/8192 [00:13<00:15, 270.31it/s]
Adding requests:  48%|████▊     | 3933/8192 [00:14<00:15, 271.04it/s]
Adding requests:  48%|████▊     | 3961/8192 [00:14<00:15, 271.77it/s]
Adding requests:  49%|████▊     | 3989/8192 [00:14<00:15, 266.24it/s]
Adding requests:  49%|████▉     | 4018/8192 [00:14<00:15, 271.80it/s]
Adding requests:  49%|████▉     | 4046/8192 [00:14<00:15, 267.65it/s]
Adding requests:  50%|████▉     | 4073/8192 [00:14<00:15, 266.92it/s]
Adding requests:  50%|█████     | 4104/8192 [00:14<00:14, 277.33it/s]
Adding requests:  50%|█████     | 4135/8192 [00:14<00:14, 285.31it/s]
Adding requests:  51%|█████     | 4168/8192 [00:14<00:13, 296.70it/s]
Adding requests:  51%|█████▏    | 4200/8192 [00:14<00:13, 301.74it/s]
Adding requests:  52%|█████▏    | 4232/8192 [00:15<00:12, 306.53it/s]
Adding requests:  52%|█████▏    | 4263/8192 [00:15<00:12, 302.60it/s]
Adding requests:  52%|█████▏    | 4294/8192 [00:15<00:12, 304.54it/s]
Adding requests:  53%|█████▎    | 4327/8192 [00:15<00:12, 310.86it/s]
Adding requests:  53%|█████▎    | 4359/8192 [00:15<00:12, 309.72it/s]
Adding requests:  54%|█████▎    | 4390/8192 [00:15<00:12, 305.79it/s]
Adding requests:  54%|█████▍    | 4421/8192 [00:15<00:12, 302.33it/s]
Adding requests:  54%|█████▍    | 4452/8192 [00:15<00:12, 303.84it/s]
Adding requests:  55%|█████▍    | 4483/8192 [00:15<00:12, 296.11it/s]
Adding requests:  55%|█████▌    | 4513/8192 [00:16<00:12, 297.08it/s]
Adding requests:  55%|█████▌    | 4544/8192 [00:16<00:12, 299.28it/s]
Adding requests:  56%|█████▌    | 4575/8192 [00:16<00:12, 299.49it/s]
Adding requests:  56%|█████▌    | 4605/8192 [00:16<00:12, 288.90it/s]
Adding requests:  57%|█████▋    | 4634/8192 [00:16<00:12, 288.73it/s]
Adding requests:  57%|█████▋    | 4665/8192 [00:16<00:12, 292.93it/s]
Adding requests:  57%|█████▋    | 4695/8192 [00:16<00:12, 283.87it/s]
Adding requests:  58%|█████▊    | 4728/8192 [00:16<00:11, 296.29it/s]
Adding requests:  58%|█████▊    | 4759/8192 [00:16<00:11, 297.67it/s]
Adding requests:  58%|█████▊    | 4790/8192 [00:16<00:11, 299.88it/s]
Adding requests:  59%|█████▉    | 4821/8192 [00:17<00:11, 295.58it/s]
Adding requests:  59%|█████▉    | 4851/8192 [00:17<00:11, 293.65it/s]
Adding requests:  60%|█████▉    | 4881/8192 [00:17<00:11, 286.71it/s]
Adding requests:  60%|█████▉    | 4913/8192 [00:17<00:11, 294.86it/s]
Adding requests:  60%|██████    | 4943/8192 [00:17<00:11, 294.66it/s]
Adding requests:  61%|██████    | 4976/8192 [00:17<00:10, 304.27it/s]
Adding requests:  61%|██████    | 5008/8192 [00:17<00:10, 308.55it/s]
Adding requests:  62%|██████▏   | 5042/8192 [00:17<00:09, 316.56it/s]
Adding requests:  62%|██████▏   | 5075/8192 [00:17<00:09, 320.36it/s]
Adding requests:  62%|██████▏   | 5108/8192 [00:18<00:09, 317.55it/s]
Adding requests:  63%|██████▎   | 5140/8192 [00:18<00:09, 308.29it/s]
Adding requests:  63%|██████▎   | 5171/8192 [00:18<00:09, 305.65it/s]
Adding requests:  64%|██████▎   | 5202/8192 [00:18<00:09, 303.80it/s]
Adding requests:  64%|██████▍   | 5233/8192 [00:18<00:10, 294.82it/s]
Adding requests:  64%|██████▍   | 5263/8192 [00:18<00:10, 282.63it/s]
Adding requests:  65%|██████▍   | 5292/8192 [00:18<00:10, 282.16it/s]
Adding requests:  65%|██████▍   | 5322/8192 [00:18<00:10, 285.61it/s]
Adding requests:  65%|██████▌   | 5351/8192 [00:18<00:09, 285.32it/s]
Adding requests:  66%|██████▌   | 5380/8192 [00:18<00:09, 283.94it/s]
Adding requests:  66%|██████▌   | 5409/8192 [00:19<00:09, 280.39it/s]
Adding requests:  66%|██████▋   | 5438/8192 [00:19<00:09, 282.66it/s]
Adding requests:  67%|██████▋   | 5467/8192 [00:19<00:09, 276.63it/s]
Adding requests:  67%|██████▋   | 5495/8192 [00:19<00:09, 274.41it/s]
Adding requests:  67%|██████▋   | 5523/8192 [00:19<00:09, 271.00it/s]
Adding requests:  68%|██████▊   | 5551/8192 [00:19<00:10, 263.01it/s]
Adding requests:  68%|██████▊   | 5579/8192 [00:19<00:09, 263.74it/s]
Adding requests:  68%|██████▊   | 5607/8192 [00:19<00:09, 265.67it/s]
Adding requests:  69%|██████▉   | 5635/8192 [00:19<00:09, 269.34it/s]
Adding requests:  69%|██████▉   | 5662/8192 [00:20<00:09, 269.01it/s]
Adding requests:  69%|██████▉   | 5691/8192 [00:20<00:09, 272.70it/s]
Adding requests:  70%|██████▉   | 5720/8192 [00:20<00:08, 274.88it/s]
Adding requests:  70%|███████   | 5748/8192 [00:20<00:08, 273.77it/s]
Adding requests:  71%|███████   | 5777/8192 [00:20<00:08, 276.77it/s]
Adding requests:  71%|███████   | 5805/8192 [00:20<00:08, 269.38it/s]
Adding requests:  71%|███████   | 5834/8192 [00:20<00:08, 273.48it/s]
Adding requests:  72%|███████▏  | 5865/8192 [00:20<00:08, 282.95it/s]
Adding requests:  72%|███████▏  | 5894/8192 [00:20<00:08, 280.93it/s]
Adding requests:  72%|███████▏  | 5924/8192 [00:20<00:07, 284.13it/s]
Adding requests:  73%|███████▎  | 5953/8192 [00:21<00:08, 271.75it/s]
Adding requests:  73%|███████▎  | 5984/8192 [00:21<00:07, 281.37it/s]
Adding requests:  73%|███████▎  | 6014/8192 [00:21<00:07, 284.10it/s]
Adding requests:  74%|███████▍  | 6044/8192 [00:21<00:07, 286.95it/s]
Adding requests:  74%|███████▍  | 6073/8192 [00:21<00:07, 282.47it/s]
Adding requests:  75%|███████▍  | 6104/8192 [00:21<00:07, 290.00it/s]
Adding requests:  75%|███████▍  | 6135/8192 [00:21<00:06, 294.38it/s]
Adding requests:  75%|███████▌  | 6166/8192 [00:21<00:06, 295.51it/s]
Adding requests:  76%|███████▌  | 6196/8192 [00:21<00:06, 287.93it/s]
Adding requests:  76%|███████▌  | 6227/8192 [00:21<00:06, 293.34it/s]
Adding requests:  76%|███████▋  | 6257/8192 [00:22<00:06, 290.24it/s]
Adding requests:  77%|███████▋  | 6287/8192 [00:22<00:06, 291.13it/s]
Adding requests:  77%|███████▋  | 6317/8192 [00:22<00:06, 291.00it/s]
Adding requests:  77%|███████▋  | 6347/8192 [00:22<00:06, 286.00it/s]
Adding requests:  78%|███████▊  | 6376/8192 [00:22<00:06, 285.33it/s]
Adding requests:  78%|███████▊  | 6405/8192 [00:22<00:06, 282.56it/s]
Adding requests:  79%|███████▊  | 6434/8192 [00:22<00:06, 282.42it/s]
Adding requests:  79%|███████▉  | 6463/8192 [00:22<00:06, 281.92it/s]
Adding requests:  79%|███████▉  | 6495/8192 [00:22<00:05, 292.70it/s]
Adding requests:  80%|███████▉  | 6525/8192 [00:23<00:05, 294.45it/s]
Adding requests:  80%|████████  | 6555/8192 [00:23<00:05, 290.62it/s]
Adding requests:  80%|████████  | 6585/8192 [00:23<00:05, 291.77it/s]
Adding requests:  81%|████████  | 6617/8192 [00:23<00:05, 299.37it/s]
Adding requests:  81%|████████  | 6647/8192 [00:23<00:05, 291.15it/s]
Adding requests:  82%|████████▏ | 6677/8192 [00:23<00:05, 291.62it/s]
Adding requests:  82%|████████▏ | 6708/8192 [00:23<00:05, 295.98it/s]
Adding requests:  82%|████████▏ | 6740/8192 [00:23<00:04, 298.84it/s]
Adding requests:  83%|████████▎ | 6770/8192 [00:23<00:04, 295.07it/s]
Adding requests:  83%|████████▎ | 6804/8192 [00:23<00:04, 306.76it/s]
Adding requests:  83%|████████▎ | 6836/8192 [00:24<00:04, 309.00it/s]
Adding requests:  84%|████████▍ | 6870/8192 [00:24<00:04, 316.38it/s]
Adding requests:  84%|████████▍ | 6902/8192 [00:24<00:04, 316.85it/s]
Adding requests:  85%|████████▍ | 6937/8192 [00:24<00:03, 323.78it/s]
Adding requests:  85%|████████▌ | 6970/8192 [00:24<00:03, 322.38it/s]
Adding requests:  85%|████████▌ | 7003/8192 [00:24<00:03, 319.31it/s]
Adding requests:  86%|████████▌ | 7035/8192 [00:24<00:03, 314.85it/s]
Adding requests:  86%|████████▋ | 7068/8192 [00:24<00:03, 316.83it/s]
Adding requests:  87%|████████▋ | 7100/8192 [00:24<00:03, 307.69it/s]
Adding requests:  87%|████████▋ | 7132/8192 [00:25<00:03, 310.65it/s]
Adding requests:  87%|████████▋ | 7164/8192 [00:25<00:03, 303.50it/s]
Adding requests:  88%|████████▊ | 7196/8192 [00:25<00:03, 307.16it/s]
Adding requests:  88%|████████▊ | 7227/8192 [00:25<00:03, 303.86it/s]
Adding requests:  89%|████████▊ | 7259/8192 [00:25<00:03, 306.35it/s]
Adding requests:  89%|████████▉ | 7290/8192 [00:25<00:02, 303.48it/s]
Adding requests:  89%|████████▉ | 7321/8192 [00:25<00:03, 287.79it/s]
Adding requests:  90%|████████▉ | 7350/8192 [00:25<00:02, 286.83it/s]
Adding requests:  90%|█████████ | 7382/8192 [00:25<00:02, 293.44it/s]
Adding requests:  90%|█████████ | 7412/8192 [00:25<00:02, 295.29it/s]
Adding requests:  91%|█████████ | 7442/8192 [00:26<00:02, 292.34it/s]
Adding requests:  91%|█████████ | 7472/8192 [00:26<00:02, 284.67it/s]
Adding requests:  92%|█████████▏| 7501/8192 [00:26<00:02, 281.29it/s]
Adding requests:  92%|█████████▏| 7530/8192 [00:26<00:02, 280.17it/s]
Adding requests:  98%|█████████▊| 8022/8192 [00:26<00:00, 1602.51it/s]
Adding requests: 100%|█████████▉| 8185/8192 [00:27<00:00, 672.56it/s] 
Adding requests: 100%|██████████| 8192/8192 [00:27<00:00, 302.35it/s]

Processed prompts:   0%|          | 0/8192 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   7%|▋         | 578/8192 [00:03<00:40, 188.08it/s, est. speed input: 192596.01 toks/s, output: 188.08 toks/s]
Processed prompts:   8%|▊         | 642/8192 [00:05<01:21, 92.64it/s, est. speed input: 109934.01 toks/s, output: 107.36 toks/s] 
Processed prompts:   9%|▊         | 706/8192 [00:09<02:05, 59.42it/s, est. speed input: 79999.77 toks/s, output: 78.12 toks/s]  
Processed prompts:   9%|▉         | 770/8192 [00:12<02:49, 43.66it/s, est. speed input: 64790.28 toks/s, output: 63.27 toks/s]
Processed prompts:  10%|█         | 834/8192 [00:15<03:25, 35.77it/s, est. speed input: 56346.29 toks/s, output: 55.03 toks/s]
Processed prompts:  11%|█         | 898/8192 [00:18<03:59, 30.44it/s, est. speed input: 50279.27 toks/s, output: 49.10 toks/s]
Processed prompts:  12%|█▏        | 962/8192 [00:21<04:23, 27.40it/s, est. speed input: 46190.60 toks/s, output: 45.11 toks/s]
Processed prompts:  13%|█▎        | 1026/8192 [00:24<04:41, 25.48it/s, est. speed input: 43179.77 toks/s, output: 42.17 toks/s]
Processed prompts:  13%|█▎        | 1090/8192 [00:27<04:57, 23.87it/s, est. speed input: 40638.87 toks/s, output: 39.69 toks/s]
Processed prompts:  14%|█▍        | 1154/8192 [00:28<04:07, 28.46it/s, est. speed input: 41312.19 toks/s, output: 40.34 toks/s]
Processed prompts:  15%|█▍        | 1218/8192 [00:31<04:26, 26.19it/s, est. speed input: 39550.23 toks/s, output: 38.62 toks/s]
Processed prompts:  16%|█▌        | 1282/8192 [00:34<04:45, 24.23it/s, est. speed input: 37874.71 toks/s, output: 36.99 toks/s]
Processed prompts:  16%|█▋        | 1346/8192 [00:37<04:54, 23.24it/s, est. speed input: 36575.67 toks/s, output: 35.72 toks/s]
Processed prompts:  17%|█▋        | 1410/8192 [00:40<05:00, 22.57it/s, est. speed input: 35461.55 toks/s, output: 34.63 toks/s]
Processed prompts:  18%|█▊        | 1474/8192 [00:43<05:06, 21.90it/s, est. speed input: 34425.04 toks/s, output: 33.62 toks/s]
Processed prompts:  19%|█▉        | 1538/8192 [00:46<05:04, 21.87it/s, est. speed input: 33665.88 toks/s, output: 32.88 toks/s]
Processed prompts:  20%|█▉        | 1602/8192 [00:49<05:07, 21.45it/s, est. speed input: 32874.42 toks/s, output: 32.10 toks/s]
Processed prompts:  20%|██        | 1666/8192 [00:52<05:06, 21.26it/s, est. speed input: 32206.38 toks/s, output: 31.45 toks/s]
Processed prompts:  21%|██        | 1730/8192 [00:55<05:02, 21.37it/s, est. speed input: 31672.74 toks/s, output: 30.93 toks/s]
Processed prompts:  22%|██▏       | 1794/8192 [00:59<05:03, 21.06it/s, est. speed input: 31097.51 toks/s, output: 30.37 toks/s]
Processed prompts:  23%|██▎       | 1858/8192 [01:00<04:08, 25.51it/s, est. speed input: 31530.08 toks/s, output: 30.79 toks/s]
Processed prompts:  23%|██▎       | 1922/8192 [01:03<04:17, 24.35it/s, est. speed input: 31117.40 toks/s, output: 30.39 toks/s]
Processed prompts:  24%|██▍       | 1986/8192 [01:06<04:29, 23.02it/s, est. speed input: 30634.45 toks/s, output: 29.92 toks/s]
Processed prompts:  25%|██▌       | 2050/8192 [01:09<04:35, 22.33it/s, est. speed input: 30224.81 toks/s, output: 29.52 toks/s]
Processed prompts:  26%|██▌       | 2114/8192 [01:12<04:36, 22.01it/s, est. speed input: 29875.37 toks/s, output: 29.18 toks/s]
Processed prompts:  27%|██▋       | 2178/8192 [01:15<04:39, 21.51it/s, est. speed input: 29505.40 toks/s, output: 28.81 toks/s]
Processed prompts:  27%|██▋       | 2242/8192 [01:18<04:36, 21.50it/s, est. speed input: 29220.31 toks/s, output: 28.54 toks/s]
Processed prompts:  28%|██▊       | 2306/8192 [01:21<04:37, 21.24it/s, est. speed input: 28914.34 toks/s, output: 28.24 toks/s]
Processed prompts:  29%|██▉       | 2370/8192 [01:24<04:36, 21.05it/s, est. speed input: 28628.97 toks/s, output: 27.96 toks/s]
Processed prompts:  30%|██▉       | 2434/8192 [01:27<04:30, 21.28it/s, est. speed input: 28418.66 toks/s, output: 27.75 toks/s]
Processed prompts:  30%|███       | 2498/8192 [01:30<04:28, 21.23it/s, est. speed input: 28192.26 toks/s, output: 27.53 toks/s]
Processed prompts:  31%|███▏      | 2562/8192 [01:32<03:46, 24.85it/s, est. speed input: 28428.57 toks/s, output: 27.76 toks/s]
Processed prompts:  32%|███▏      | 2626/8192 [01:35<03:53, 23.88it/s, est. speed input: 28243.90 toks/s, output: 27.58 toks/s]
Processed prompts:  33%|███▎      | 2690/8192 [01:38<04:01, 22.75it/s, est. speed input: 28012.45 toks/s, output: 27.36 toks/s]
Processed prompts:  34%|███▎      | 2754/8192 [01:41<04:06, 22.09it/s, est. speed input: 27804.27 toks/s, output: 27.15 toks/s]
Processed prompts:  34%|███▍      | 2818/8192 [01:44<04:05, 21.89it/s, est. speed input: 27637.03 toks/s, output: 26.99 toks/s]
Processed prompts:  35%|███▌      | 2882/8192 [01:47<04:08, 21.41it/s, est. speed input: 27438.95 toks/s, output: 26.80 toks/s]
Processed prompts:  36%|███▌      | 2946/8192 [01:50<04:04, 21.43it/s, est. speed input: 27291.61 toks/s, output: 26.65 toks/s]
Processed prompts:  37%|███▋      | 3010/8192 [01:53<04:04, 21.23it/s, est. speed input: 27129.44 toks/s, output: 26.49 toks/s]
Processed prompts:  38%|███▊      | 3074/8192 [01:56<04:03, 21.06it/s, est. speed input: 26970.52 toks/s, output: 26.34 toks/s]
Processed prompts:  38%|███▊      | 3138/8192 [01:59<03:57, 21.30it/s, est. speed input: 26859.49 toks/s, output: 26.23 toks/s]
Processed prompts:  39%|███▉      | 3202/8192 [02:01<03:17, 25.22it/s, est. speed input: 27079.30 toks/s, output: 26.44 toks/s]
Processed prompts:  40%|███▉      | 3266/8192 [02:04<03:29, 23.53it/s, est. speed input: 26921.51 toks/s, output: 26.29 toks/s]
Processed prompts:  41%|████      | 3330/8192 [02:07<03:31, 22.99it/s, est. speed input: 26815.99 toks/s, output: 26.19 toks/s]
Processed prompts:  41%|████▏     | 3394/8192 [02:10<03:36, 22.20it/s, est. speed input: 26678.37 toks/s, output: 26.05 toks/s]
Processed prompts:  42%|████▏     | 3458/8192 [02:13<03:38, 21.64it/s, est. speed input: 26542.87 toks/s, output: 25.92 toks/s]
Processed prompts:  43%|████▎     | 3522/8192 [02:16<03:36, 21.62it/s, est. speed input: 26446.01 toks/s, output: 25.83 toks/s]
Processed prompts:  44%|████▍     | 3586/8192 [02:19<03:36, 21.23it/s, est. speed input: 26320.15 toks/s, output: 25.70 toks/s]
Processed prompts:  45%|████▍     | 3650/8192 [02:22<03:33, 21.27it/s, est. speed input: 26226.50 toks/s, output: 25.61 toks/s]
Processed prompts:  45%|████▌     | 3714/8192 [02:25<03:31, 21.14it/s, est. speed input: 26123.96 toks/s, output: 25.51 toks/s]
Processed prompts:  46%|████▌     | 3778/8192 [02:28<03:29, 21.03it/s, est. speed input: 26023.19 toks/s, output: 25.41 toks/s]
Processed prompts:  47%|████▋     | 3842/8192 [02:31<03:24, 21.31it/s, est. speed input: 25956.07 toks/s, output: 25.35 toks/s]
Processed prompts:  48%|████▊     | 3906/8192 [02:33<02:50, 25.10it/s, est. speed input: 26131.33 toks/s, output: 25.52 toks/s]
Processed prompts:  48%|████▊     | 3970/8192 [02:36<02:59, 23.47it/s, est. speed input: 26025.30 toks/s, output: 25.42 toks/s]
Processed prompts:  49%|████▉     | 4034/8192 [02:39<02:59, 23.15it/s, est. speed input: 25970.54 toks/s, output: 25.36 toks/s]
Processed prompts:  50%|█████     | 4098/8192 [02:42<03:03, 22.32it/s, est. speed input: 25877.20 toks/s, output: 25.27 toks/s]
Processed prompts:  51%|█████     | 4162/8192 [02:45<03:05, 21.71it/s, est. speed input: 25782.63 toks/s, output: 25.18 toks/s]
Processed prompts:  52%|█████▏    | 4226/8192 [02:48<03:00, 21.91it/s, est. speed input: 25734.43 toks/s, output: 25.13 toks/s]
Processed prompts:  52%|█████▏    | 4290/8192 [02:51<03:01, 21.45it/s, est. speed input: 25646.93 toks/s, output: 25.05 toks/s]
Processed prompts:  53%|█████▎    | 4354/8192 [02:54<02:58, 21.45it/s, est. speed input: 25583.73 toks/s, output: 24.98 toks/s]
Processed prompts:  54%|█████▍    | 4418/8192 [02:57<02:56, 21.35it/s, est. speed input: 25516.25 toks/s, output: 24.92 toks/s]
Processed prompts:  55%|█████▍    | 4482/8192 [03:00<02:56, 21.05it/s, est. speed input: 25435.63 toks/s, output: 24.84 toks/s]
Processed prompts:  55%|█████▌    | 4546/8192 [03:03<02:50, 21.37it/s, est. speed input: 25392.05 toks/s, output: 24.80 toks/s]
Processed prompts:  56%|█████▋    | 4610/8192 [03:04<02:21, 25.24it/s, est. speed input: 25545.47 toks/s, output: 24.95 toks/s]
Processed prompts:  57%|█████▋    | 4674/8192 [03:07<02:29, 23.57it/s, est. speed input: 25468.00 toks/s, output: 24.87 toks/s]
Processed prompts:  58%|█████▊    | 4738/8192 [03:10<02:29, 23.10it/s, est. speed input: 25424.78 toks/s, output: 24.83 toks/s]
Processed prompts:  59%|█████▊    | 4802/8192 [03:13<02:31, 22.39it/s, est. speed input: 25360.90 toks/s, output: 24.77 toks/s]
Processed prompts:  59%|█████▉    | 4866/8192 [03:17<02:32, 21.74it/s, est. speed input: 25289.19 toks/s, output: 24.70 toks/s]
Processed prompts:  60%|██████    | 4930/8192 [03:20<02:30, 21.64it/s, est. speed input: 25238.73 toks/s, output: 24.65 toks/s]
Processed prompts:  61%|██████    | 4994/8192 [03:23<02:28, 21.47it/s, est. speed input: 25184.13 toks/s, output: 24.59 toks/s]
Processed prompts:  62%|██████▏   | 5058/8192 [03:26<02:26, 21.35it/s, est. speed input: 25130.82 toks/s, output: 24.54 toks/s]
Processed prompts:  63%|██████▎   | 5122/8192 [03:29<02:24, 21.31it/s, est. speed input: 25081.61 toks/s, output: 24.49 toks/s]
Processed prompts:  63%|██████▎   | 5186/8192 [03:32<02:22, 21.03it/s, est. speed input: 25020.08 toks/s, output: 24.43 toks/s]
Processed prompts:  64%|██████▍   | 5250/8192 [03:35<02:18, 21.28it/s, est. speed input: 24984.52 toks/s, output: 24.40 toks/s]
Processed prompts:  65%|██████▍   | 5314/8192 [03:36<01:51, 25.78it/s, est. speed input: 25142.21 toks/s, output: 24.55 toks/s]
Processed prompts:  66%|██████▌   | 5378/8192 [03:39<01:56, 24.07it/s, est. speed input: 25089.15 toks/s, output: 24.50 toks/s]
Processed prompts:  66%|██████▋   | 5442/8192 [03:42<01:58, 23.19it/s, est. speed input: 25045.93 toks/s, output: 24.46 toks/s]
Processed prompts:  67%|██████▋   | 5506/8192 [03:45<01:59, 22.52it/s, est. speed input: 24999.41 toks/s, output: 24.41 toks/s]
Processed prompts:  68%|██████▊   | 5570/8192 [03:48<02:00, 21.83it/s, est. speed input: 24942.56 toks/s, output: 24.36 toks/s]
Processed prompts:  69%|██████▉   | 5634/8192 [03:51<01:58, 21.67it/s, est. speed input: 24902.29 toks/s, output: 24.32 toks/s]
Processed prompts:  70%|██████▉   | 5698/8192 [03:54<01:57, 21.30it/s, est. speed input: 24849.96 toks/s, output: 24.27 toks/s]
Processed prompts:  70%|███████   | 5762/8192 [03:57<01:54, 21.14it/s, est. speed input: 24803.60 toks/s, output: 24.22 toks/s]
Processed prompts:  71%|███████   | 5826/8192 [04:00<01:51, 21.24it/s, est. speed input: 24768.86 toks/s, output: 24.19 toks/s]
Processed prompts:  72%|███████▏  | 5890/8192 [04:04<01:49, 20.96it/s, est. speed input: 24718.10 toks/s, output: 24.14 toks/s]
Processed prompts:  73%|███████▎  | 5954/8192 [04:05<01:29, 25.14it/s, est. speed input: 24847.97 toks/s, output: 24.27 toks/s]
Processed prompts:  73%|███████▎  | 6018/8192 [04:08<01:30, 24.06it/s, est. speed input: 24819.06 toks/s, output: 24.24 toks/s]
Processed prompts:  74%|███████▍  | 6082/8192 [04:11<01:32, 22.83it/s, est. speed input: 24770.12 toks/s, output: 24.19 toks/s]
Processed prompts:  75%|███████▌  | 6146/8192 [04:14<01:31, 22.27it/s, est. speed input: 24731.74 toks/s, output: 24.15 toks/s]
Processed prompts:  76%|███████▌  | 6210/8192 [04:17<01:30, 21.94it/s, est. speed input: 24696.25 toks/s, output: 24.12 toks/s]
Processed prompts:  77%|███████▋  | 6274/8192 [04:20<01:29, 21.44it/s, est. speed input: 24649.78 toks/s, output: 24.07 toks/s]
Processed prompts:  77%|███████▋  | 6338/8192 [04:23<01:26, 21.52it/s, est. speed input: 24622.68 toks/s, output: 24.05 toks/s]
Processed prompts:  78%|███████▊  | 6402/8192 [04:26<01:24, 21.23it/s, est. speed input: 24581.25 toks/s, output: 24.01 toks/s]
Processed prompts:  79%|███████▉  | 6466/8192 [04:29<01:21, 21.10it/s, est. speed input: 24543.96 toks/s, output: 23.97 toks/s]
Processed prompts:  80%|███████▉  | 6530/8192 [04:32<01:18, 21.25it/s, est. speed input: 24517.64 toks/s, output: 23.94 toks/s]
Processed prompts:  80%|████████  | 6594/8192 [04:35<01:15, 21.21it/s, est. speed input: 24485.99 toks/s, output: 23.91 toks/s]
Processed prompts:  81%|████████▏ | 6658/8192 [04:37<01:00, 25.16it/s, est. speed input: 24595.36 toks/s, output: 24.02 toks/s]
Processed prompts:  82%|████████▏ | 6722/8192 [04:40<01:00, 24.10it/s, est. speed input: 24573.22 toks/s, output: 24.00 toks/s]
Processed prompts:  83%|████████▎ | 6786/8192 [04:43<01:01, 22.87it/s, est. speed input: 24532.94 toks/s, output: 23.96 toks/s]
Processed prompts:  84%|████████▎ | 6850/8192 [04:46<01:00, 22.22it/s, est. speed input: 24498.80 toks/s, output: 23.92 toks/s]
Processed prompts:  84%|████████▍ | 6914/8192 [04:49<00:58, 21.96it/s, est. speed input: 24471.57 toks/s, output: 23.90 toks/s]
Processed prompts:  85%|████████▌ | 6978/8192 [04:52<00:56, 21.47it/s, est. speed input: 24433.37 toks/s, output: 23.86 toks/s]
Processed prompts:  86%|████████▌ | 7042/8192 [04:55<00:53, 21.50it/s, est. speed input: 24409.90 toks/s, output: 23.84 toks/s]
Processed prompts:  87%|████████▋ | 7106/8192 [04:58<00:51, 21.25it/s, est. speed input: 24376.24 toks/s, output: 23.80 toks/s]
Processed prompts:  88%|████████▊ | 7170/8192 [05:01<00:48, 21.07it/s, est. speed input: 24343.15 toks/s, output: 23.77 toks/s]
Processed prompts:  88%|████████▊ | 7234/8192 [05:04<00:44, 21.29it/s, est. speed input: 24323.98 toks/s, output: 23.75 toks/s]
Processed prompts:  89%|████████▉ | 7298/8192 [05:07<00:42, 20.99it/s, est. speed input: 24288.11 toks/s, output: 23.72 toks/s]
Processed prompts:  90%|████████▉ | 7362/8192 [05:09<00:33, 24.85it/s, est. speed input: 24384.43 toks/s, output: 23.81 toks/s]
Processed prompts:  91%|█████████ | 7426/8192 [05:12<00:32, 23.92it/s, est. speed input: 24367.08 toks/s, output: 23.80 toks/s]
Processed prompts:  91%|█████████▏| 7490/8192 [05:15<00:30, 22.76it/s, est. speed input: 24332.98 toks/s, output: 23.76 toks/s]
Processed prompts:  92%|█████████▏| 7554/8192 [05:18<00:28, 22.09it/s, est. speed input: 24302.29 toks/s, output: 23.73 toks/s]
Processed prompts:  93%|█████████▎| 7618/8192 [05:21<00:26, 21.87it/s, est. speed input: 24279.84 toks/s, output: 23.71 toks/s]
Processed prompts:  94%|█████████▍| 7682/8192 [05:24<00:23, 21.42it/s, est. speed input: 24247.43 toks/s, output: 23.68 toks/s]
Processed prompts:  95%|█████████▍| 7746/8192 [05:27<00:20, 21.46it/s, est. speed input: 24227.78 toks/s, output: 23.66 toks/s]
Processed prompts:  95%|█████████▌| 7810/8192 [05:30<00:17, 21.29it/s, est. speed input: 24201.71 toks/s, output: 23.63 toks/s]
Processed prompts:  96%|█████████▌| 7874/8192 [05:33<00:15, 21.13it/s, est. speed input: 24174.47 toks/s, output: 23.61 toks/s]
Processed prompts:  97%|█████████▋| 7938/8192 [05:36<00:11, 21.36it/s, est. speed input: 24159.36 toks/s, output: 23.59 toks/s]
Processed prompts:  98%|█████████▊| 8002/8192 [05:37<00:07, 25.14it/s, est. speed input: 24246.54 toks/s, output: 23.68 toks/s]
Processed prompts:  98%|█████████▊| 8066/8192 [05:40<00:05, 23.79it/s, est. speed input: 24223.50 toks/s, output: 23.66 toks/s]
Processed prompts:  99%|█████████▉| 8130/8192 [05:43<00:02, 23.40it/s, est. speed input: 24213.87 toks/s, output: 23.65 toks/s]
Processed prompts: 100%|██████████| 8192/8192 [05:43<00:00, 23.40it/s, est. speed input: 24398.46 toks/s, output: 23.83 toks/s]
Processed prompts: 100%|██████████| 8192/8192 [05:43<00:00, 23.83it/s, est. speed input: 24398.46 toks/s, output: 23.83 toks/s]
[rank0]:[W125 22:12:16.763627203 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=512 ==========
Time: 2026-01-26 03:38:39
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-FP8-SlideSparse-2_4
Params: prompt_len=512, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-FP8-SlideSparse-2_4 --dataset-name random --input-len 512 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 513 --max-num-batched-tokens 513 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_4/json/Qwen2.5-7B-FP8_M512.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 03:38:47 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 03:38:48 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=128142) WARNING 01-26 03:38:56 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=128142) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=128142) WARNING 01-26 03:39:12 [backends.py:609] Failed to read file <frozen os>
Throughput: 16.42 requests/s, 8425.66 total tokens/s, 16.42 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128

STDERR:
[2026-01-26 03:38:47] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:38:47] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:38:47] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:38:47] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:38:47] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:38:47] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:38:47] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:38:47] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:38:47] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:38:47] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:38:47] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:38:47] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:38:47] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:38:47] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 03:38:55] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:38:55] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:38:55] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:38:55] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:38:55] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:38:55] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:38:55] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:38:55] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:38:55] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:38:55] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:38:55] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:38:55] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:38:55] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:38:55] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=128142) [2026-01-26 03:38:56] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=128142) [2026-01-26 03:38:56] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=128142) [2026-01-26 03:38:56] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=128142) [2026-01-26 03:38:56] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=128142) [2026-01-26 03:38:56] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=128142) [2026-01-26 03:38:56] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=128142) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=128142) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:02<00:02,  2.97s/it]
(EngineCore_DP0 pid=128142) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:05<00:00,  2.65s/it]
(EngineCore_DP0 pid=128142) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:05<00:00,  2.70s/it]
(EngineCore_DP0 pid=128142) 
(EngineCore_DP0 pid=128142) [2026-01-26 03:39:02] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 3584] -> 1D uint8
(EngineCore_DP0 pid=128142) [2026-01-26 03:39:02] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12386304 bytes
(EngineCore_DP0 pid=128142) [2026-01-26 03:39:02] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 3584] -> 1D uint8
(EngineCore_DP0 pid=128142) [2026-01-26 03:39:02] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 9633792 bytes
(EngineCore_DP0 pid=128142) [2026-01-26 03:39:02] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 3584] -> 1D uint8
(EngineCore_DP0 pid=128142) [2026-01-26 03:39:02] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 101842944 bytes
(EngineCore_DP0 pid=128142) [2026-01-26 03:39:02] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 18944] -> 1D uint8
(EngineCore_DP0 pid=128142) [2026-01-26 03:39:02] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 50921472 bytes
(EngineCore_DP0 pid=128142) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  2.60it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  2.60it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  2.60it/s]
(EngineCore_DP0 pid=128142) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.39it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.38it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  35%|███▌      | 45/128 [00:00<00:00, 448.78it/s]
Adding requests:  72%|███████▏  | 92/128 [00:00<00:00, 461.13it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 460.20it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:26,  4.81it/s, est. speed input: 2460.94 toks/s, output: 4.81 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:12, 10.20it/s, est. speed input: 4697.10 toks/s, output: 9.17 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:09, 12.84it/s, est. speed input: 5754.97 toks/s, output: 11.24 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:08, 14.26it/s, est. speed input: 6356.44 toks/s, output: 12.41 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:00<00:07, 15.20it/s, est. speed input: 6764.72 toks/s, output: 13.21 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:00<00:07, 15.83it/s, est. speed input: 7059.40 toks/s, output: 13.79 toks/s]
Processed prompts:  10%|█         | 13/128 [00:00<00:07, 16.19it/s, est. speed input: 7269.28 toks/s, output: 14.20 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:01<00:06, 16.46it/s, est. speed input: 7435.74 toks/s, output: 14.52 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:01<00:06, 16.75it/s, est. speed input: 7583.07 toks/s, output: 14.81 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:01<00:06, 17.03it/s, est. speed input: 7714.84 toks/s, output: 15.07 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:01<00:06, 17.18it/s, est. speed input: 7819.95 toks/s, output: 15.27 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:01<00:06, 17.32it/s, est. speed input: 7912.39 toks/s, output: 15.45 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:01<00:05, 17.38it/s, est. speed input: 7987.58 toks/s, output: 15.60 toks/s]
Processed prompts:  21%|██        | 27/128 [00:01<00:05, 17.35it/s, est. speed input: 8045.27 toks/s, output: 15.71 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:01<00:05, 17.34it/s, est. speed input: 8097.10 toks/s, output: 15.81 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:01<00:00, 74.25it/s, est. speed input: 14230.68 toks/s, output: 27.79 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:02<00:01, 41.56it/s, est. speed input: 13369.24 toks/s, output: 26.11 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:02<00:01, 31.29it/s, est. speed input: 12783.40 toks/s, output: 24.97 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:03<00:02, 26.82it/s, est. speed input: 12430.99 toks/s, output: 24.28 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:03<00:02, 24.35it/s, est. speed input: 12197.50 toks/s, output: 23.82 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:03<00:02, 22.87it/s, est. speed input: 12043.55 toks/s, output: 23.52 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:03<00:02, 21.62it/s, est. speed input: 11903.38 toks/s, output: 23.25 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:03<00:02, 20.43it/s, est. speed input: 11757.35 toks/s, output: 22.96 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:03<00:01, 19.53it/s, est. speed input: 11624.81 toks/s, output: 22.70 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:04<00:01, 18.88it/s, est. speed input: 11505.01 toks/s, output: 22.47 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:04<00:01, 18.57it/s, est. speed input: 11434.15 toks/s, output: 22.33 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:04<00:01, 18.29it/s, est. speed input: 11366.40 toks/s, output: 22.20 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:04<00:01, 18.07it/s, est. speed input: 11303.01 toks/s, output: 22.08 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:04<00:01, 17.88it/s, est. speed input: 11241.44 toks/s, output: 21.96 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:04<00:01, 17.63it/s, est. speed input: 11176.81 toks/s, output: 21.83 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:04<00:01, 17.45it/s, est. speed input: 11116.34 toks/s, output: 21.71 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:04<00:01, 17.50it/s, est. speed input: 11067.60 toks/s, output: 21.62 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:05<00:01, 17.57it/s, est. speed input: 11023.05 toks/s, output: 21.53 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:05<00:01, 17.61it/s, est. speed input: 10979.90 toks/s, output: 21.45 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:05<00:00, 17.66it/s, est. speed input: 10939.98 toks/s, output: 21.37 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:05<00:00, 17.62it/s, est. speed input: 10898.12 toks/s, output: 21.29 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:05<00:00, 17.60it/s, est. speed input: 10858.04 toks/s, output: 21.21 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:05<00:00, 17.60it/s, est. speed input: 10820.65 toks/s, output: 21.13 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:05<00:00, 17.59it/s, est. speed input: 10783.93 toks/s, output: 21.06 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:05<00:00, 17.47it/s, est. speed input: 10744.51 toks/s, output: 20.99 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:05<00:00, 17.34it/s, est. speed input: 10704.52 toks/s, output: 20.91 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:06<00:00, 17.42it/s, est. speed input: 10672.73 toks/s, output: 20.85 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:06<00:00, 17.49it/s, est. speed input: 10642.61 toks/s, output: 20.79 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:06<00:00, 17.49it/s, est. speed input: 10642.61 toks/s, output: 20.79 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:06<00:00, 20.79it/s, est. speed input: 10642.61 toks/s, output: 20.79 toks/s]
[rank0]:[W126 03:39:37.771842194 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=1024 ==========
Time: 2026-01-26 03:39:40
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-FP8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-FP8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 1025 --max-num-batched-tokens 1025 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_4/json/Qwen2.5-7B-FP8_M1024.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 03:39:48 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 03:39:49 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=129304) WARNING 01-26 03:39:57 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=129304) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=129304) WARNING 01-26 03:40:08 [backends.py:609] Failed to read file <frozen os>
Throughput: 16.27 requests/s, 16673.82 total tokens/s, 16.27 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128

STDERR:
[2026-01-26 03:39:48] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:39:48] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:39:48] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:39:48] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:39:48] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:39:48] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:39:48] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:39:48] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:39:48] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:39:48] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:39:48] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:39:48] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:39:48] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:39:48] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 03:39:56] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:39:56] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:39:56] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:39:56] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:39:56] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:39:56] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:39:56] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:39:56] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:39:56] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:39:56] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:39:56] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:39:56] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:39:56] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:39:56] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=129304) [2026-01-26 03:39:57] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=129304) [2026-01-26 03:39:57] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=129304) [2026-01-26 03:39:57] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=129304) [2026-01-26 03:39:57] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=129304) [2026-01-26 03:39:57] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=129304) [2026-01-26 03:39:57] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=129304) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=129304) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.42it/s]
(EngineCore_DP0 pid=129304) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.06it/s]
(EngineCore_DP0 pid=129304) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.10it/s]
(EngineCore_DP0 pid=129304) 
(EngineCore_DP0 pid=129304) [2026-01-26 03:40:00] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 3584] -> 1D uint8
(EngineCore_DP0 pid=129304) [2026-01-26 03:40:00] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12386304 bytes
(EngineCore_DP0 pid=129304) [2026-01-26 03:40:00] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 3584] -> 1D uint8
(EngineCore_DP0 pid=129304) [2026-01-26 03:40:00] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 9633792 bytes
(EngineCore_DP0 pid=129304) [2026-01-26 03:40:00] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 3584] -> 1D uint8
(EngineCore_DP0 pid=129304) [2026-01-26 03:40:00] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 101842944 bytes
(EngineCore_DP0 pid=129304) [2026-01-26 03:40:00] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 18944] -> 1D uint8
(EngineCore_DP0 pid=129304) [2026-01-26 03:40:00] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 50921472 bytes
(EngineCore_DP0 pid=129304) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  4.65it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  6.21it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  5.91it/s]
(EngineCore_DP0 pid=129304) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.41it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.40it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  19%|█▉        | 24/128 [00:00<00:00, 239.82it/s]
Adding requests:  38%|███▊      | 49/128 [00:00<00:00, 244.01it/s]
Adding requests:  59%|█████▉    | 76/128 [00:00<00:00, 255.11it/s]
Adding requests:  80%|████████  | 103/128 [00:00<00:00, 256.88it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 251.03it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:03, 39.21it/s, est. speed input: 40163.98 toks/s, output: 39.22 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:00<00:05, 23.42it/s, est. speed input: 25707.28 toks/s, output: 25.10 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:00<00:05, 20.70it/s, est. speed input: 23061.23 toks/s, output: 22.52 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:00<00:05, 19.28it/s, est. speed input: 21663.03 toks/s, output: 21.15 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:00<00:05, 18.46it/s, est. speed input: 20814.07 toks/s, output: 20.33 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:01<00:05, 18.13it/s, est. speed input: 20432.67 toks/s, output: 19.95 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:01<00:05, 17.77it/s, est. speed input: 20088.80 toks/s, output: 19.62 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:01<00:05, 17.51it/s, est. speed input: 19817.28 toks/s, output: 19.35 toks/s]
Processed prompts:  20%|██        | 26/128 [00:01<00:05, 17.43it/s, est. speed input: 19628.38 toks/s, output: 19.17 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:01<00:05, 17.33it/s, est. speed input: 19460.47 toks/s, output: 19.00 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:01<00:05, 17.21it/s, est. speed input: 19301.77 toks/s, output: 18.85 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:01<00:05, 17.13it/s, est. speed input: 19166.20 toks/s, output: 18.72 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:01<00:05, 17.11it/s, est. speed input: 19057.71 toks/s, output: 18.61 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:01<00:05, 17.10it/s, est. speed input: 18963.74 toks/s, output: 18.52 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:02<00:05, 17.12it/s, est. speed input: 18885.18 toks/s, output: 18.44 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:02<00:05, 17.05it/s, est. speed input: 18798.88 toks/s, output: 18.36 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:02<00:05, 17.02it/s, est. speed input: 18725.00 toks/s, output: 18.29 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:02<00:04, 17.06it/s, est. speed input: 18668.71 toks/s, output: 18.23 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:02<00:04, 17.12it/s, est. speed input: 18623.65 toks/s, output: 18.19 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:02<00:04, 17.10it/s, est. speed input: 18571.94 toks/s, output: 18.14 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:02<00:04, 17.02it/s, est. speed input: 18514.90 toks/s, output: 18.08 toks/s]
Processed prompts:  41%|████      | 52/128 [00:02<00:04, 16.95it/s, est. speed input: 18460.10 toks/s, output: 18.03 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:03<00:04, 17.03it/s, est. speed input: 18428.39 toks/s, output: 18.00 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:03<00:04, 17.02it/s, est. speed input: 18389.31 toks/s, output: 17.96 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:03<00:04, 16.94it/s, est. speed input: 18344.39 toks/s, output: 17.91 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:03<00:04, 16.93it/s, est. speed input: 18308.27 toks/s, output: 17.88 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:03<00:03, 16.94it/s, est. speed input: 18276.02 toks/s, output: 17.85 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:03<00:03, 16.97it/s, est. speed input: 18248.98 toks/s, output: 17.82 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:03<00:03, 16.97it/s, est. speed input: 18220.85 toks/s, output: 17.79 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:03<00:03, 16.94it/s, est. speed input: 18192.27 toks/s, output: 17.77 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:03<00:03, 16.98it/s, est. speed input: 18170.95 toks/s, output: 17.74 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:04<00:03, 17.06it/s, est. speed input: 18156.70 toks/s, output: 17.73 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:04<00:03, 17.10it/s, est. speed input: 18141.09 toks/s, output: 17.72 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:04<00:03, 17.08it/s, est. speed input: 18122.00 toks/s, output: 17.70 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:04<00:02, 17.04it/s, est. speed input: 18101.36 toks/s, output: 17.68 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:04<00:02, 17.08it/s, est. speed input: 18088.60 toks/s, output: 17.66 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:04<00:02, 17.11it/s, est. speed input: 18075.69 toks/s, output: 17.65 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:04<00:02, 17.02it/s, est. speed input: 18054.30 toks/s, output: 17.63 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:04<00:02, 17.00it/s, est. speed input: 18037.35 toks/s, output: 17.61 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:05<00:02, 16.95it/s, est. speed input: 18018.68 toks/s, output: 17.60 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:05<00:02, 16.96it/s, est. speed input: 18004.09 toks/s, output: 17.58 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:05<00:02, 17.03it/s, est. speed input: 17995.35 toks/s, output: 17.57 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:05<00:01, 17.06it/s, est. speed input: 17985.13 toks/s, output: 17.56 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:05<00:01, 16.98it/s, est. speed input: 17967.96 toks/s, output: 17.55 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:05<00:01, 16.95it/s, est. speed input: 17953.64 toks/s, output: 17.53 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:05<00:01, 16.90it/s, est. speed input: 17937.89 toks/s, output: 17.52 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:05<00:01, 16.92it/s, est. speed input: 17926.09 toks/s, output: 17.51 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:05<00:01, 17.01it/s, est. speed input: 17920.40 toks/s, output: 17.50 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:06<00:01, 17.08it/s, est. speed input: 17915.58 toks/s, output: 17.50 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:06<00:01, 17.14it/s, est. speed input: 17911.66 toks/s, output: 17.49 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:06<00:01, 17.20it/s, est. speed input: 17908.91 toks/s, output: 17.49 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:06<00:00, 17.10it/s, est. speed input: 17896.90 toks/s, output: 17.48 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:06<00:00, 16.97it/s, est. speed input: 17881.74 toks/s, output: 17.46 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:06<00:00, 16.92it/s, est. speed input: 17870.06 toks/s, output: 17.45 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:06<00:00, 16.87it/s, est. speed input: 17857.38 toks/s, output: 17.44 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:06<00:00, 16.83it/s, est. speed input: 17845.05 toks/s, output: 17.43 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:07<00:00, 16.78it/s, est. speed input: 17831.53 toks/s, output: 17.41 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:07<00:00, 16.84it/s, est. speed input: 17823.94 toks/s, output: 17.41 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:07<00:00, 16.93it/s, est. speed input: 17819.74 toks/s, output: 17.40 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 17.00it/s, est. speed input: 17815.82 toks/s, output: 17.40 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 17.00it/s, est. speed input: 17815.82 toks/s, output: 17.40 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 17.40it/s, est. speed input: 17815.82 toks/s, output: 17.40 toks/s]
[rank0]:[W126 03:40:34.171431548 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=2048 ==========
Time: 2026-01-26 03:40:35
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-FP8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=256, max_num_seqs=2
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-FP8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 256 --max-num-seqs 2 --max-model-len 1025 --max-num-batched-tokens 2048 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_4/json/Qwen2.5-7B-FP8_M2048.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 03:40:45 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 03:40:46 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=130325) WARNING 01-26 03:40:53 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=130325) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=130325) WARNING 01-26 03:41:06 [backends.py:609] Failed to read file <frozen os>
Throughput: 23.03 requests/s, 23607.83 total tokens/s, 23.03 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256

STDERR:
[2026-01-26 03:40:45] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:40:45] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:40:45] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:40:45] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:40:45] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:40:45] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:40:45] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:40:45] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:40:45] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:40:45] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:40:45] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:40:45] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:40:45] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:40:45] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 03:40:53] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:40:53] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:40:53] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:40:53] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:40:53] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:40:53] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:40:53] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:40:53] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:40:53] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:40:53] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:40:53] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:40:53] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:40:53] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:40:53] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=130325) [2026-01-26 03:40:54] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=130325) [2026-01-26 03:40:54] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=130325) [2026-01-26 03:40:54] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=130325) [2026-01-26 03:40:54] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=130325) [2026-01-26 03:40:54] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=130325) [2026-01-26 03:40:54] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=130325) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=130325) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.41it/s]
(EngineCore_DP0 pid=130325) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.13it/s]
(EngineCore_DP0 pid=130325) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.17it/s]
(EngineCore_DP0 pid=130325) 
(EngineCore_DP0 pid=130325) [2026-01-26 03:40:56] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 3584] -> 1D uint8
(EngineCore_DP0 pid=130325) [2026-01-26 03:40:56] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12386304 bytes
(EngineCore_DP0 pid=130325) [2026-01-26 03:40:56] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 3584] -> 1D uint8
(EngineCore_DP0 pid=130325) [2026-01-26 03:40:56] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 9633792 bytes
(EngineCore_DP0 pid=130325) [2026-01-26 03:40:56] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 3584] -> 1D uint8
(EngineCore_DP0 pid=130325) [2026-01-26 03:40:56] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 101842944 bytes
(EngineCore_DP0 pid=130325) [2026-01-26 03:40:56] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 18944] -> 1D uint8
(EngineCore_DP0 pid=130325) [2026-01-26 03:40:56] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 50921472 bytes
(EngineCore_DP0 pid=130325) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  33%|███▎      | 1/3 [00:00<00:00,  7.36it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  67%|██████▋   | 2/3 [00:00<00:00,  5.72it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00,  5.86it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00,  5.96it/s]
(EngineCore_DP0 pid=130325) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 1/2 [00:00<00:00,  7.19it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  8.48it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  8.25it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:   9%|▉         | 23/256 [00:00<00:01, 228.53it/s]
Adding requests:  19%|█▉        | 49/256 [00:00<00:00, 245.48it/s]
Adding requests:  30%|███       | 77/256 [00:00<00:00, 259.42it/s]
Adding requests:  40%|████      | 103/256 [00:00<00:00, 258.14it/s]
Adding requests:  50%|█████     | 129/256 [00:00<00:00, 258.67it/s]
Adding requests:  61%|██████    | 156/256 [00:00<00:00, 261.20it/s]
Adding requests:  71%|███████▏  | 183/256 [00:00<00:00, 262.24it/s]
Adding requests:  82%|████████▏ | 210/256 [00:00<00:00, 260.53it/s]
Adding requests:  93%|█████████▎| 237/256 [00:00<00:00, 259.26it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 257.34it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   8%|▊         | 20/256 [00:00<00:01, 170.54it/s, est. speed input: 174673.11 toks/s, output: 170.55 toks/s]
Processed prompts:  15%|█▍        | 38/256 [00:00<00:05, 37.73it/s, est. speed input: 44057.52 toks/s, output: 43.02 toks/s]   
Processed prompts:  18%|█▊        | 47/256 [00:01<00:06, 33.63it/s, est. speed input: 39342.82 toks/s, output: 38.42 toks/s]
Processed prompts:  21%|██        | 53/256 [00:01<00:06, 30.80it/s, est. speed input: 36718.47 toks/s, output: 35.86 toks/s]
Processed prompts:  23%|██▎       | 58/256 [00:01<00:07, 27.63it/s, est. speed input: 34287.53 toks/s, output: 33.48 toks/s]
Processed prompts:  24%|██▍       | 62/256 [00:01<00:07, 26.75it/s, est. speed input: 33380.57 toks/s, output: 32.60 toks/s]
Processed prompts:  26%|██▌       | 66/256 [00:02<00:07, 26.01it/s, est. speed input: 32622.49 toks/s, output: 31.86 toks/s]
Processed prompts:  27%|██▋       | 70/256 [00:02<00:07, 25.39it/s, est. speed input: 31978.87 toks/s, output: 31.23 toks/s]
Processed prompts:  29%|██▉       | 74/256 [00:02<00:07, 24.90it/s, est. speed input: 31420.85 toks/s, output: 30.68 toks/s]
Processed prompts:  30%|███       | 78/256 [00:02<00:07, 24.50it/s, est. speed input: 30932.71 toks/s, output: 30.21 toks/s]
Processed prompts:  32%|███▏      | 82/256 [00:02<00:07, 24.24it/s, est. speed input: 30513.98 toks/s, output: 29.80 toks/s]
Processed prompts:  34%|███▎      | 86/256 [00:02<00:07, 24.02it/s, est. speed input: 30135.84 toks/s, output: 29.43 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:03<00:06, 23.84it/s, est. speed input: 29795.45 toks/s, output: 29.10 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:03<00:06, 23.70it/s, est. speed input: 29487.99 toks/s, output: 28.80 toks/s]
Processed prompts:  38%|███▊      | 98/256 [00:03<00:06, 23.62it/s, est. speed input: 29214.24 toks/s, output: 28.53 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:03<00:06, 23.59it/s, est. speed input: 28972.67 toks/s, output: 28.29 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:03<00:06, 23.58it/s, est. speed input: 28753.19 toks/s, output: 28.08 toks/s]
Processed prompts:  43%|████▎     | 110/256 [00:03<00:06, 23.57it/s, est. speed input: 28554.27 toks/s, output: 27.88 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:04<00:06, 23.57it/s, est. speed input: 28371.15 toks/s, output: 27.71 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:04<00:05, 23.57it/s, est. speed input: 28203.17 toks/s, output: 27.54 toks/s]
Processed prompts:  48%|████▊     | 122/256 [00:04<00:05, 23.58it/s, est. speed input: 28049.37 toks/s, output: 27.39 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:04<00:05, 23.54it/s, est. speed input: 27900.90 toks/s, output: 27.25 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:04<00:05, 23.54it/s, est. speed input: 27766.67 toks/s, output: 27.12 toks/s]
Processed prompts:  52%|█████▏    | 134/256 [00:04<00:05, 23.53it/s, est. speed input: 27639.34 toks/s, output: 26.99 toks/s]
Processed prompts:  54%|█████▍    | 138/256 [00:05<00:05, 23.51it/s, est. speed input: 27519.12 toks/s, output: 26.87 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:05<00:04, 23.49it/s, est. speed input: 27406.62 toks/s, output: 26.76 toks/s]
Processed prompts:  57%|█████▋    | 146/256 [00:05<00:04, 23.51it/s, est. speed input: 27305.07 toks/s, output: 26.67 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:05<00:04, 23.50it/s, est. speed input: 27206.84 toks/s, output: 26.57 toks/s]
Processed prompts:  60%|██████    | 154/256 [00:05<00:04, 23.49it/s, est. speed input: 27112.90 toks/s, output: 26.48 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:05<00:04, 23.46it/s, est. speed input: 27022.57 toks/s, output: 26.39 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:06<00:04, 23.44it/s, est. speed input: 26937.43 toks/s, output: 26.31 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:06<00:03, 23.44it/s, est. speed input: 26858.03 toks/s, output: 26.23 toks/s]
Processed prompts:  66%|██████▋   | 170/256 [00:06<00:03, 23.41it/s, est. speed input: 26780.71 toks/s, output: 26.15 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:06<00:03, 23.41it/s, est. speed input: 26708.20 toks/s, output: 26.08 toks/s]
Processed prompts:  70%|██████▉   | 178/256 [00:06<00:03, 23.41it/s, est. speed input: 26639.60 toks/s, output: 26.02 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:07<00:03, 23.43it/s, est. speed input: 26576.52 toks/s, output: 25.95 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:07<00:02, 23.42it/s, est. speed input: 26514.30 toks/s, output: 25.89 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:07<00:02, 23.42it/s, est. speed input: 26455.18 toks/s, output: 25.84 toks/s]
Processed prompts:  76%|███████▌  | 194/256 [00:07<00:02, 23.47it/s, est. speed input: 26403.16 toks/s, output: 25.78 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:07<00:02, 23.49it/s, est. speed input: 26352.68 toks/s, output: 25.73 toks/s]
Processed prompts:  79%|███████▉  | 202/256 [00:07<00:02, 24.45it/s, est. speed input: 26377.27 toks/s, output: 25.76 toks/s]
Processed prompts:  80%|████████  | 206/256 [00:08<00:02, 24.16it/s, est. speed input: 26328.93 toks/s, output: 25.71 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:08<00:01, 23.93it/s, est. speed input: 26279.41 toks/s, output: 25.66 toks/s]
Processed prompts:  84%|████████▎ | 214/256 [00:08<00:01, 23.81it/s, est. speed input: 26234.94 toks/s, output: 25.62 toks/s]
Processed prompts:  85%|████████▌ | 218/256 [00:08<00:01, 23.70it/s, est. speed input: 26190.62 toks/s, output: 25.58 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:08<00:01, 23.66it/s, est. speed input: 26150.40 toks/s, output: 25.54 toks/s]
Processed prompts:  88%|████████▊ | 226/256 [00:08<00:01, 23.58it/s, est. speed input: 26107.93 toks/s, output: 25.50 toks/s]
Processed prompts:  90%|████████▉ | 230/256 [00:09<00:01, 23.54it/s, est. speed input: 26068.64 toks/s, output: 25.46 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:09<00:00, 23.48it/s, est. speed input: 26028.34 toks/s, output: 25.42 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:09<00:00, 23.46it/s, est. speed input: 25990.98 toks/s, output: 25.38 toks/s]
Processed prompts:  95%|█████████▍| 242/256 [00:09<00:00, 23.46it/s, est. speed input: 25955.64 toks/s, output: 25.35 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:09<00:00, 23.42it/s, est. speed input: 25919.45 toks/s, output: 25.31 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:09<00:00, 23.44it/s, est. speed input: 25886.88 toks/s, output: 25.28 toks/s]
Processed prompts:  99%|█████████▉| 254/256 [00:10<00:00, 23.45it/s, est. speed input: 25855.75 toks/s, output: 25.25 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:10<00:00, 23.45it/s, est. speed input: 25907.76 toks/s, output: 25.30 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:10<00:00, 25.30it/s, est. speed input: 25907.76 toks/s, output: 25.30 toks/s]
[rank0]:[W126 03:41:34.862489102 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=4096 ==========
Time: 2026-01-26 03:41:37
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-FP8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=512, max_num_seqs=4
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-FP8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 512 --max-num-seqs 4 --max-model-len 1025 --max-num-batched-tokens 4096 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_4/json/Qwen2.5-7B-FP8_M4096.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 03:41:47 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 03:41:48 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=131435) WARNING 01-26 03:41:55 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=131435) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=131435) WARNING 01-26 03:42:07 [backends.py:609] Failed to read file <frozen os>
Throughput: 24.15 requests/s, 24754.02 total tokens/s, 24.15 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512

STDERR:
[2026-01-26 03:41:46] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:41:47] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:41:47] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:41:47] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:41:47] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:41:47] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:41:47] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:41:47] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:41:47] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:41:47] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:41:47] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:41:47] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:41:47] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:41:47] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 03:41:54] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:41:54] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:41:54] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:41:54] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:41:54] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:41:54] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:41:54] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:41:54] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:41:54] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:41:54] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:41:54] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:41:54] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:41:54] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:41:54] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=131435) [2026-01-26 03:41:55] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=131435) [2026-01-26 03:41:55] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=131435) [2026-01-26 03:41:55] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=131435) [2026-01-26 03:41:55] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=131435) [2026-01-26 03:41:55] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=131435) [2026-01-26 03:41:55] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=131435) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=131435) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.42it/s]
(EngineCore_DP0 pid=131435) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.14it/s]
(EngineCore_DP0 pid=131435) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.17it/s]
(EngineCore_DP0 pid=131435) 
(EngineCore_DP0 pid=131435) [2026-01-26 03:41:58] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 3584] -> 1D uint8
(EngineCore_DP0 pid=131435) [2026-01-26 03:41:58] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12386304 bytes
(EngineCore_DP0 pid=131435) [2026-01-26 03:41:58] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 3584] -> 1D uint8
(EngineCore_DP0 pid=131435) [2026-01-26 03:41:58] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 9633792 bytes
(EngineCore_DP0 pid=131435) [2026-01-26 03:41:58] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 3584] -> 1D uint8
(EngineCore_DP0 pid=131435) [2026-01-26 03:41:58] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 101842944 bytes
(EngineCore_DP0 pid=131435) [2026-01-26 03:41:58] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 18944] -> 1D uint8
(EngineCore_DP0 pid=131435) [2026-01-26 03:41:58] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 50921472 bytes
(EngineCore_DP0 pid=131435) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  25%|██▌       | 1/4 [00:00<00:00,  8.50it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 2/4 [00:00<00:00,  9.02it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  75%|███████▌  | 3/4 [00:00<00:00,  9.19it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  8.33it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  8.55it/s]
(EngineCore_DP0 pid=131435) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  33%|███▎      | 1/3 [00:00<00:00,  7.32it/s]
Capturing CUDA graphs (decode, FULL):  67%|██████▋   | 2/3 [00:00<00:00,  8.40it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  8.71it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  8.49it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   5%|▍         | 24/512 [00:00<00:02, 233.31it/s]
Adding requests:  10%|▉         | 50/512 [00:00<00:01, 243.94it/s]
Adding requests:  15%|█▍        | 76/512 [00:00<00:01, 250.73it/s]
Adding requests:  20%|█▉        | 102/512 [00:00<00:01, 252.79it/s]
Adding requests:  25%|██▌       | 128/512 [00:00<00:01, 252.19it/s]
Adding requests:  30%|███       | 155/512 [00:00<00:01, 256.34it/s]
Adding requests:  36%|███▌      | 185/512 [00:00<00:01, 267.18it/s]
Adding requests:  42%|████▏     | 214/512 [00:00<00:01, 271.53it/s]
Adding requests:  47%|████▋     | 242/512 [00:00<00:00, 272.51it/s]
Adding requests:  53%|█████▎    | 270/512 [00:01<00:00, 270.35it/s]
Adding requests:  58%|█████▊    | 298/512 [00:01<00:00, 271.61it/s]
Adding requests:  64%|██████▎   | 326/512 [00:01<00:00, 272.54it/s]
Adding requests:  70%|██████▉   | 356/512 [00:01<00:00, 279.35it/s]
Adding requests:  75%|███████▌  | 384/512 [00:01<00:00, 277.65it/s]
Adding requests:  81%|████████  | 413/512 [00:01<00:00, 279.34it/s]
Adding requests:  86%|████████▌ | 441/512 [00:01<00:00, 279.30it/s]
Adding requests:  92%|█████████▏| 470/512 [00:01<00:00, 281.11it/s]
Adding requests:  98%|█████████▊| 500/512 [00:01<00:00, 286.03it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 271.86it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   8%|▊         | 42/512 [00:00<00:02, 206.42it/s, est. speed input: 211404.40 toks/s, output: 206.43 toks/s]
Processed prompts:  12%|█▏        | 63/512 [00:01<00:08, 52.54it/s, est. speed input: 63227.42 toks/s, output: 61.75 toks/s]   
Processed prompts:  14%|█▍        | 74/512 [00:01<00:11, 39.81it/s, est. speed input: 50141.90 toks/s, output: 48.97 toks/s]
Processed prompts:  16%|█▌        | 81/512 [00:01<00:10, 40.33it/s, est. speed input: 49534.97 toks/s, output: 48.37 toks/s]
Processed prompts:  17%|█▋        | 87/512 [00:02<00:12, 33.22it/s, est. speed input: 44512.92 toks/s, output: 43.47 toks/s]
Processed prompts:  18%|█▊        | 92/512 [00:02<00:12, 32.75it/s, est. speed input: 43530.36 toks/s, output: 42.51 toks/s]
Processed prompts:  19%|█▉        | 96/512 [00:02<00:13, 31.01it/s, est. speed input: 42240.07 toks/s, output: 41.25 toks/s]
Processed prompts:  20%|█▉        | 100/512 [00:02<00:13, 29.52it/s, est. speed input: 41122.58 toks/s, output: 40.16 toks/s]
Processed prompts:  20%|██        | 104/512 [00:02<00:14, 28.25it/s, est. speed input: 40130.07 toks/s, output: 39.19 toks/s]
Processed prompts:  21%|██        | 107/512 [00:02<00:15, 25.65it/s, est. speed input: 38891.49 toks/s, output: 37.98 toks/s]
Processed prompts:  21%|██▏       | 110/512 [00:02<00:16, 23.67it/s, est. speed input: 37792.01 toks/s, output: 36.91 toks/s]
Processed prompts:  22%|██▏       | 114/512 [00:03<00:16, 23.92it/s, est. speed input: 37138.48 toks/s, output: 36.27 toks/s]
Processed prompts:  23%|██▎       | 118/512 [00:03<00:16, 24.10it/s, est. speed input: 36545.13 toks/s, output: 35.69 toks/s]
Processed prompts:  24%|██▍       | 122/512 [00:03<00:16, 24.20it/s, est. speed input: 36002.85 toks/s, output: 35.16 toks/s]
Processed prompts:  25%|██▍       | 126/512 [00:03<00:15, 24.28it/s, est. speed input: 35511.41 toks/s, output: 34.68 toks/s]
Processed prompts:  25%|██▌       | 130/512 [00:03<00:15, 24.35it/s, est. speed input: 35062.74 toks/s, output: 34.24 toks/s]
Processed prompts:  26%|██▌       | 134/512 [00:03<00:15, 24.37it/s, est. speed input: 34647.72 toks/s, output: 33.84 toks/s]
Processed prompts:  27%|██▋       | 138/512 [00:04<00:15, 24.39it/s, est. speed input: 34265.43 toks/s, output: 33.46 toks/s]
Processed prompts:  28%|██▊       | 142/512 [00:04<00:15, 24.41it/s, est. speed input: 33913.76 toks/s, output: 33.12 toks/s]
Processed prompts:  29%|██▊       | 146/512 [00:04<00:14, 24.42it/s, est. speed input: 33586.31 toks/s, output: 32.80 toks/s]
Processed prompts:  29%|██▉       | 150/512 [00:04<00:14, 24.42it/s, est. speed input: 33281.89 toks/s, output: 32.50 toks/s]
Processed prompts:  30%|███       | 154/512 [00:04<00:14, 24.43it/s, est. speed input: 32999.59 toks/s, output: 32.23 toks/s]
Processed prompts:  31%|███       | 158/512 [00:04<00:14, 24.42it/s, est. speed input: 32733.98 toks/s, output: 31.97 toks/s]
Processed prompts:  32%|███▏      | 162/512 [00:05<00:14, 24.44it/s, est. speed input: 32488.36 toks/s, output: 31.73 toks/s]
Processed prompts:  32%|███▏      | 166/512 [00:05<00:14, 24.45it/s, est. speed input: 32258.58 toks/s, output: 31.50 toks/s]
Processed prompts:  33%|███▎      | 170/512 [00:05<00:13, 24.47it/s, est. speed input: 32043.24 toks/s, output: 31.29 toks/s]
Processed prompts:  34%|███▍      | 174/512 [00:05<00:13, 24.48it/s, est. speed input: 31841.09 toks/s, output: 31.09 toks/s]
Processed prompts:  35%|███▍      | 178/512 [00:05<00:13, 24.50it/s, est. speed input: 31650.73 toks/s, output: 30.91 toks/s]
Processed prompts:  36%|███▌      | 182/512 [00:05<00:13, 24.50it/s, est. speed input: 31469.48 toks/s, output: 30.73 toks/s]
Processed prompts:  36%|███▋      | 186/512 [00:06<00:13, 24.47it/s, est. speed input: 31294.86 toks/s, output: 30.56 toks/s]
Processed prompts:  37%|███▋      | 190/512 [00:06<00:13, 24.48it/s, est. speed input: 31133.29 toks/s, output: 30.40 toks/s]
Processed prompts:  38%|███▊      | 194/512 [00:06<00:12, 24.46it/s, est. speed input: 30976.91 toks/s, output: 30.25 toks/s]
Processed prompts:  39%|███▊      | 198/512 [00:06<00:12, 24.45it/s, est. speed input: 30827.94 toks/s, output: 30.11 toks/s]
Processed prompts:  39%|███▉      | 202/512 [00:06<00:12, 25.75it/s, est. speed input: 30813.59 toks/s, output: 30.09 toks/s]
Processed prompts:  40%|████      | 206/512 [00:06<00:12, 25.35it/s, est. speed input: 30676.38 toks/s, output: 29.96 toks/s]
Processed prompts:  41%|████      | 210/512 [00:07<00:12, 25.04it/s, est. speed input: 30542.42 toks/s, output: 29.83 toks/s]
Processed prompts:  42%|████▏     | 214/512 [00:07<00:12, 24.83it/s, est. speed input: 30414.83 toks/s, output: 29.70 toks/s]
Processed prompts:  43%|████▎     | 218/512 [00:07<00:11, 24.70it/s, est. speed input: 30293.59 toks/s, output: 29.58 toks/s]
Processed prompts:  43%|████▎     | 222/512 [00:07<00:11, 24.60it/s, est. speed input: 30177.82 toks/s, output: 29.47 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:07<00:11, 24.54it/s, est. speed input: 30066.77 toks/s, output: 29.36 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:07<00:11, 24.49it/s, est. speed input: 29960.31 toks/s, output: 29.26 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:08<00:11, 24.49it/s, est. speed input: 29860.76 toks/s, output: 29.16 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:08<00:11, 24.47it/s, est. speed input: 29763.93 toks/s, output: 29.07 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:08<00:11, 24.46it/s, est. speed input: 29671.04 toks/s, output: 28.98 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:08<00:10, 24.47it/s, est. speed input: 29582.60 toks/s, output: 28.89 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:08<00:10, 24.47it/s, est. speed input: 29497.71 toks/s, output: 28.81 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:08<00:10, 24.45it/s, est. speed input: 29414.42 toks/s, output: 28.72 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:09<00:10, 24.46it/s, est. speed input: 29335.34 toks/s, output: 28.65 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:09<00:10, 24.44it/s, est. speed input: 29257.62 toks/s, output: 28.57 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:09<00:10, 24.43it/s, est. speed input: 29182.40 toks/s, output: 28.50 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:09<00:09, 24.45it/s, est. speed input: 29112.19 toks/s, output: 28.43 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:09<00:09, 24.46it/s, est. speed input: 29044.00 toks/s, output: 28.36 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:09<00:09, 24.47it/s, est. speed input: 28977.83 toks/s, output: 28.30 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:09<00:09, 24.47it/s, est. speed input: 28914.05 toks/s, output: 28.24 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:10<00:09, 24.48it/s, est. speed input: 28852.38 toks/s, output: 28.18 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:10<00:09, 24.44it/s, est. speed input: 28790.12 toks/s, output: 28.12 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:10<00:08, 24.42it/s, est. speed input: 28729.83 toks/s, output: 28.06 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:10<00:08, 24.40it/s, est. speed input: 28671.19 toks/s, output: 28.00 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:10<00:08, 24.38it/s, est. speed input: 28614.45 toks/s, output: 27.94 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:10<00:08, 24.38it/s, est. speed input: 28560.00 toks/s, output: 27.89 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:11<00:08, 24.39it/s, est. speed input: 28507.16 toks/s, output: 27.84 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:11<00:08, 24.40it/s, est. speed input: 28456.43 toks/s, output: 27.79 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:11<00:07, 24.40it/s, est. speed input: 28407.15 toks/s, output: 27.74 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:11<00:07, 24.41it/s, est. speed input: 28359.56 toks/s, output: 27.69 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:11<00:07, 24.41it/s, est. speed input: 28312.63 toks/s, output: 27.65 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:11<00:07, 24.42it/s, est. speed input: 28267.79 toks/s, output: 27.61 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:12<00:07, 24.43it/s, est. speed input: 28224.28 toks/s, output: 27.56 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:12<00:07, 24.42it/s, est. speed input: 28181.08 toks/s, output: 27.52 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:12<00:06, 24.40it/s, est. speed input: 28138.06 toks/s, output: 27.48 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:12<00:06, 24.39it/s, est. speed input: 28096.47 toks/s, output: 27.44 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:12<00:06, 24.39it/s, est. speed input: 28056.59 toks/s, output: 27.40 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:12<00:06, 24.38it/s, est. speed input: 28016.95 toks/s, output: 27.36 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:13<00:06, 24.37it/s, est. speed input: 27978.06 toks/s, output: 27.32 toks/s]
Processed prompts:  71%|███████   | 362/512 [00:13<00:06, 24.36it/s, est. speed input: 27940.15 toks/s, output: 27.29 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:13<00:05, 24.35it/s, est. speed input: 27903.07 toks/s, output: 27.25 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [00:13<00:05, 24.33it/s, est. speed input: 27866.59 toks/s, output: 27.21 toks/s]
Processed prompts:  80%|████████  | 410/512 [00:13<00:01, 79.56it/s, est. speed input: 30351.08 toks/s, output: 29.64 toks/s]
Processed prompts:  81%|████████▏ | 417/512 [00:13<00:01, 69.45it/s, est. speed input: 30507.60 toks/s, output: 29.79 toks/s]
Processed prompts:  83%|████████▎ | 424/512 [00:14<00:01, 48.29it/s, est. speed input: 30308.52 toks/s, output: 29.60 toks/s]
Processed prompts:  84%|████████▍ | 429/512 [00:14<00:01, 44.04it/s, est. speed input: 30318.79 toks/s, output: 29.61 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [00:14<00:02, 32.32it/s, est. speed input: 29990.99 toks/s, output: 29.29 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [00:14<00:02, 30.51it/s, est. speed input: 29934.96 toks/s, output: 29.23 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [00:15<00:02, 29.00it/s, est. speed input: 29879.80 toks/s, output: 29.18 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [00:15<00:02, 27.77it/s, est. speed input: 29825.42 toks/s, output: 29.13 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [00:15<00:02, 26.84it/s, est. speed input: 29772.85 toks/s, output: 29.08 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [00:15<00:02, 26.12it/s, est. speed input: 29720.78 toks/s, output: 29.02 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [00:15<00:02, 25.59it/s, est. speed input: 29669.97 toks/s, output: 28.97 toks/s]
Processed prompts:  90%|█████████ | 462/512 [00:15<00:01, 25.22it/s, est. speed input: 29620.62 toks/s, output: 28.93 toks/s]
Processed prompts:  91%|█████████ | 466/512 [00:16<00:01, 24.95it/s, est. speed input: 29572.44 toks/s, output: 28.88 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [00:16<00:01, 24.76it/s, est. speed input: 29525.02 toks/s, output: 28.83 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [00:16<00:01, 24.62it/s, est. speed input: 29478.56 toks/s, output: 28.79 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [00:16<00:01, 24.53it/s, est. speed input: 29433.15 toks/s, output: 28.74 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [00:16<00:01, 24.48it/s, est. speed input: 29389.40 toks/s, output: 28.70 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [00:16<00:01, 24.44it/s, est. speed input: 29346.32 toks/s, output: 28.66 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [00:17<00:00, 24.42it/s, est. speed input: 29304.10 toks/s, output: 28.62 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [00:17<00:00, 24.40it/s, est. speed input: 29262.65 toks/s, output: 28.58 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [00:17<00:00, 24.38it/s, est. speed input: 29221.61 toks/s, output: 28.54 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [00:17<00:00, 24.35it/s, est. speed input: 29180.95 toks/s, output: 28.50 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [00:17<00:00, 24.34it/s, est. speed input: 29141.29 toks/s, output: 28.46 toks/s]
Processed prompts: 100%|█████████▉| 510/512 [00:17<00:00, 25.99it/s, est. speed input: 29159.23 toks/s, output: 28.48 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:17<00:00, 25.99it/s, est. speed input: 29273.22 toks/s, output: 28.59 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:17<00:00, 28.59it/s, est. speed input: 29273.22 toks/s, output: 28.59 toks/s]
[rank0]:[W126 03:42:44.833617375 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=8192 ==========
Time: 2026-01-26 03:42:47
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-FP8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=1024, max_num_seqs=8
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-FP8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 1024 --max-num-seqs 8 --max-model-len 1025 --max-num-batched-tokens 8192 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_4/json/Qwen2.5-7B-FP8_M8192.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 03:43:01 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 03:43:02 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=132715) WARNING 01-26 03:43:10 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=132715) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=132715) WARNING 01-26 03:43:21 [backends.py:609] Failed to read file <frozen os>
Throughput: 24.24 requests/s, 24848.55 total tokens/s, 24.24 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024

STDERR:
[2026-01-26 03:43:01] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:43:01] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:43:01] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:43:01] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:43:01] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:43:01] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:43:01] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:43:01] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:43:01] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:43:01] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:43:01] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:43:01] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:43:01] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:43:01] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 03:43:09] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:43:09] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:43:09] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:43:09] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:43:09] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:43:09] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:43:09] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:43:09] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:43:09] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:43:09] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:43:09] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:43:09] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:43:09] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:43:09] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=132715) [2026-01-26 03:43:11] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=132715) [2026-01-26 03:43:11] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=132715) [2026-01-26 03:43:11] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=132715) [2026-01-26 03:43:11] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=132715) [2026-01-26 03:43:11] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=132715) [2026-01-26 03:43:11] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=132715) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=132715) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.41it/s]
(EngineCore_DP0 pid=132715) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.16it/s]
(EngineCore_DP0 pid=132715) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.19it/s]
(EngineCore_DP0 pid=132715) 
(EngineCore_DP0 pid=132715) [2026-01-26 03:43:12] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 3584] -> 1D uint8
(EngineCore_DP0 pid=132715) [2026-01-26 03:43:12] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12386304 bytes
(EngineCore_DP0 pid=132715) [2026-01-26 03:43:12] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 3584] -> 1D uint8
(EngineCore_DP0 pid=132715) [2026-01-26 03:43:12] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 9633792 bytes
(EngineCore_DP0 pid=132715) [2026-01-26 03:43:12] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 3584] -> 1D uint8
(EngineCore_DP0 pid=132715) [2026-01-26 03:43:12] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 101842944 bytes
(EngineCore_DP0 pid=132715) [2026-01-26 03:43:12] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 18944] -> 1D uint8
(EngineCore_DP0 pid=132715) [2026-01-26 03:43:12] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 50921472 bytes
(EngineCore_DP0 pid=132715) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:01,  2.61it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  40%|████      | 2/5 [00:00<00:00,  4.45it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  60%|██████    | 3/5 [00:00<00:00,  5.86it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  80%|████████  | 4/5 [00:00<00:00,  6.82it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00,  6.94it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00,  5.86it/s]
(EngineCore_DP0 pid=132715) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:00,  7.19it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 2/4 [00:00<00:00,  8.53it/s]
Capturing CUDA graphs (decode, FULL):  75%|███████▌  | 3/4 [00:00<00:00,  9.11it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  9.29it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  8.96it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 25/1024 [00:00<00:04, 240.42it/s]
Adding requests:   5%|▍         | 51/1024 [00:00<00:03, 251.02it/s]
Adding requests:   8%|▊         | 78/1024 [00:00<00:03, 256.38it/s]
Adding requests:  10%|█         | 104/1024 [00:00<00:03, 257.73it/s]
Adding requests:  13%|█▎        | 131/1024 [00:00<00:03, 258.27it/s]
Adding requests:  16%|█▌        | 159/1024 [00:00<00:03, 263.80it/s]
Adding requests:  18%|█▊        | 187/1024 [00:00<00:03, 267.73it/s]
Adding requests:  21%|██        | 215/1024 [00:00<00:02, 270.70it/s]
Adding requests:  24%|██▎       | 243/1024 [00:00<00:02, 266.70it/s]
Adding requests:  26%|██▋       | 270/1024 [00:01<00:02, 266.23it/s]
Adding requests:  29%|██▉       | 298/1024 [00:01<00:02, 268.57it/s]
Adding requests:  32%|███▏      | 326/1024 [00:01<00:02, 271.07it/s]
Adding requests:  35%|███▍      | 355/1024 [00:01<00:02, 274.84it/s]
Adding requests:  38%|███▊      | 384/1024 [00:01<00:02, 278.16it/s]
Adding requests:  40%|████      | 414/1024 [00:01<00:02, 283.43it/s]
Adding requests:  43%|████▎     | 443/1024 [00:01<00:02, 277.28it/s]
Adding requests:  46%|████▌     | 472/1024 [00:01<00:01, 278.93it/s]
Adding requests:  49%|████▉     | 502/1024 [00:01<00:01, 285.02it/s]
Adding requests:  52%|█████▏    | 533/1024 [00:01<00:01, 290.76it/s]
Adding requests:  90%|█████████ | 923/1024 [00:02<00:00, 1349.44it/s]
Adding requests: 100%|██████████| 1024/1024 [00:02<00:00, 421.76it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   9%|▉         | 90/1024 [00:00<00:03, 258.70it/s, est. speed input: 264959.52 toks/s, output: 258.71 toks/s]
Processed prompts:  11%|█▏        | 116/1024 [00:01<00:12, 72.84it/s, est. speed input: 89567.60 toks/s, output: 87.47 toks/s]  
Processed prompts:  13%|█▎        | 129/1024 [00:01<00:14, 63.72it/s, est. speed input: 79928.92 toks/s, output: 78.06 toks/s]
Processed prompts:  13%|█▎        | 138/1024 [00:02<00:21, 41.69it/s, est. speed input: 61289.87 toks/s, output: 59.85 toks/s]
Processed prompts:  14%|█▍        | 146/1024 [00:02<00:23, 37.57it/s, est. speed input: 56800.49 toks/s, output: 55.47 toks/s]
Processed prompts:  15%|█▌        | 154/1024 [00:02<00:25, 34.24it/s, est. speed input: 53300.04 toks/s, output: 52.05 toks/s]
Processed prompts:  16%|█▌        | 162/1024 [00:03<00:27, 31.63it/s, est. speed input: 50492.82 toks/s, output: 49.31 toks/s]
Processed prompts:  17%|█▋        | 170/1024 [00:03<00:28, 29.66it/s, est. speed input: 48195.53 toks/s, output: 47.07 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [00:03<00:30, 28.20it/s, est. speed input: 46278.53 toks/s, output: 45.19 toks/s]
Processed prompts:  18%|█▊        | 186/1024 [00:04<00:30, 27.12it/s, est. speed input: 44648.52 toks/s, output: 43.60 toks/s]
Processed prompts:  19%|█▉        | 194/1024 [00:04<00:31, 26.34it/s, est. speed input: 43251.56 toks/s, output: 42.24 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [00:04<00:31, 26.47it/s, est. speed input: 42286.83 toks/s, output: 41.30 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:05<00:31, 25.84it/s, est. speed input: 41200.64 toks/s, output: 40.23 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [00:05<00:31, 25.43it/s, est. speed input: 40247.41 toks/s, output: 39.30 toks/s]
Processed prompts:  22%|██▏       | 226/1024 [00:05<00:31, 25.13it/s, est. speed input: 39398.41 toks/s, output: 38.47 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:06<00:31, 24.92it/s, est. speed input: 38640.14 toks/s, output: 37.73 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:06<00:31, 24.78it/s, est. speed input: 37957.11 toks/s, output: 37.07 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:06<00:31, 24.67it/s, est. speed input: 37337.94 toks/s, output: 36.46 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:07<00:31, 24.60it/s, est. speed input: 36776.29 toks/s, output: 35.91 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:07<00:30, 24.54it/s, est. speed input: 36262.20 toks/s, output: 35.41 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:07<00:30, 24.50it/s, est. speed input: 35791.16 toks/s, output: 34.95 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:08<00:30, 24.46it/s, est. speed input: 35356.04 toks/s, output: 34.53 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:08<00:30, 24.44it/s, est. speed input: 34954.34 toks/s, output: 34.13 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:08<00:29, 24.42it/s, est. speed input: 34583.02 toks/s, output: 33.77 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:09<00:29, 24.40it/s, est. speed input: 34237.61 toks/s, output: 33.44 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:09<00:29, 24.39it/s, est. speed input: 33916.17 toks/s, output: 33.12 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:09<00:28, 24.38it/s, est. speed input: 33615.89 toks/s, output: 32.83 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:10<00:28, 24.37it/s, est. speed input: 33333.66 toks/s, output: 32.55 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:10<00:28, 24.36it/s, est. speed input: 33070.22 toks/s, output: 32.30 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:10<00:27, 24.37it/s, est. speed input: 32823.37 toks/s, output: 32.05 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:11<00:27, 24.36it/s, est. speed input: 32590.28 toks/s, output: 31.83 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:11<00:27, 24.35it/s, est. speed input: 32369.89 toks/s, output: 31.61 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:11<00:26, 24.34it/s, est. speed input: 32161.11 toks/s, output: 31.41 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:12<00:26, 24.34it/s, est. speed input: 31964.89 toks/s, output: 31.22 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:12<00:26, 24.34it/s, est. speed input: 31778.39 toks/s, output: 31.03 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [00:12<00:25, 24.34it/s, est. speed input: 31601.96 toks/s, output: 30.86 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:13<00:25, 24.33it/s, est. speed input: 31433.52 toks/s, output: 30.70 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:13<00:25, 24.32it/s, est. speed input: 31272.98 toks/s, output: 30.54 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:13<00:24, 24.32it/s, est. speed input: 31120.58 toks/s, output: 30.39 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:14<00:24, 24.32it/s, est. speed input: 30975.25 toks/s, output: 30.25 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:14<00:24, 24.31it/s, est. speed input: 30835.83 toks/s, output: 30.11 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:14<00:23, 24.30it/s, est. speed input: 30702.50 toks/s, output: 29.98 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:15<00:23, 24.29it/s, est. speed input: 30574.44 toks/s, output: 29.86 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:15<00:23, 24.29it/s, est. speed input: 30452.55 toks/s, output: 29.74 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:15<00:22, 24.29it/s, est. speed input: 30335.83 toks/s, output: 29.62 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:16<00:22, 24.29it/s, est. speed input: 30223.80 toks/s, output: 29.52 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:16<00:22, 24.29it/s, est. speed input: 30115.93 toks/s, output: 29.41 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:16<00:21, 24.29it/s, est. speed input: 30012.48 toks/s, output: 29.31 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:17<00:21, 24.28it/s, est. speed input: 29912.40 toks/s, output: 29.21 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:17<00:21, 24.27it/s, est. speed input: 29816.04 toks/s, output: 29.12 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:17<00:21, 24.26it/s, est. speed input: 29723.04 toks/s, output: 29.03 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:18<00:20, 24.26it/s, est. speed input: 29633.86 toks/s, output: 28.94 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:18<00:20, 24.26it/s, est. speed input: 29547.38 toks/s, output: 28.85 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:18<00:20, 24.25it/s, est. speed input: 29464.24 toks/s, output: 28.77 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:19<00:19, 24.25it/s, est. speed input: 29383.95 toks/s, output: 28.70 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:19<00:19, 24.25it/s, est. speed input: 29306.50 toks/s, output: 28.62 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:19<00:19, 24.25it/s, est. speed input: 29231.65 toks/s, output: 28.55 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:20<00:18, 24.25it/s, est. speed input: 29158.78 toks/s, output: 28.48 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:20<00:18, 24.24it/s, est. speed input: 29088.28 toks/s, output: 28.41 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:20<00:18, 24.25it/s, est. speed input: 29020.44 toks/s, output: 28.34 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:21<00:17, 24.24it/s, est. speed input: 28953.98 toks/s, output: 28.28 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:21<00:17, 24.24it/s, est. speed input: 28890.20 toks/s, output: 28.21 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:21<00:17, 24.24it/s, est. speed input: 28828.00 toks/s, output: 28.15 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:21<00:16, 24.23it/s, est. speed input: 28767.67 toks/s, output: 28.09 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:22<00:16, 24.23it/s, est. speed input: 28709.03 toks/s, output: 28.04 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:22<00:16, 24.23it/s, est. speed input: 28652.44 toks/s, output: 27.98 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:22<00:15, 24.23it/s, est. speed input: 28597.12 toks/s, output: 27.93 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:23<00:15, 24.23it/s, est. speed input: 28543.54 toks/s, output: 27.87 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:23<00:15, 24.22it/s, est. speed input: 28491.09 toks/s, output: 27.82 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:23<00:14, 24.22it/s, est. speed input: 28440.34 toks/s, output: 27.77 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:24<00:14, 24.22it/s, est. speed input: 28390.83 toks/s, output: 27.73 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:24<00:14, 24.23it/s, est. speed input: 28343.15 toks/s, output: 27.68 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:24<00:13, 24.23it/s, est. speed input: 28296.34 toks/s, output: 27.63 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:25<00:13, 24.23it/s, est. speed input: 28250.79 toks/s, output: 27.59 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:25<00:13, 24.22it/s, est. speed input: 28206.20 toks/s, output: 27.55 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:25<00:12, 24.22it/s, est. speed input: 28163.04 toks/s, output: 27.50 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:26<00:12, 24.23it/s, est. speed input: 28121.04 toks/s, output: 27.46 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:26<00:12, 24.23it/s, est. speed input: 28080.26 toks/s, output: 27.42 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:26<00:11, 24.23it/s, est. speed input: 28040.24 toks/s, output: 27.38 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:27<00:11, 24.24it/s, est. speed input: 28001.42 toks/s, output: 27.35 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:27<00:11, 24.23it/s, est. speed input: 27963.24 toks/s, output: 27.31 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:27<00:10, 24.23it/s, est. speed input: 27926.02 toks/s, output: 27.27 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:28<00:10, 24.24it/s, est. speed input: 27889.88 toks/s, output: 27.24 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:28<00:10, 24.24it/s, est. speed input: 27854.46 toks/s, output: 27.20 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:28<00:09, 24.95it/s, est. speed input: 27850.04 toks/s, output: 27.20 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:29<00:09, 24.74it/s, est. speed input: 27816.35 toks/s, output: 27.16 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:29<00:09, 24.60it/s, est. speed input: 27783.16 toks/s, output: 27.13 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:29<00:08, 24.48it/s, est. speed input: 27750.19 toks/s, output: 27.10 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:30<00:08, 24.42it/s, est. speed input: 27718.51 toks/s, output: 27.07 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:30<00:08, 24.37it/s, est. speed input: 27687.57 toks/s, output: 27.04 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [00:30<00:02, 57.30it/s, est. speed input: 28785.36 toks/s, output: 28.11 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [00:31<00:03, 46.92it/s, est. speed input: 28744.20 toks/s, output: 28.07 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [00:31<00:03, 39.92it/s, est. speed input: 28704.22 toks/s, output: 28.03 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [00:31<00:03, 35.11it/s, est. speed input: 28664.40 toks/s, output: 27.99 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [00:32<00:03, 31.83it/s, est. speed input: 28625.94 toks/s, output: 27.95 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [00:32<00:03, 29.55it/s, est. speed input: 28588.11 toks/s, output: 27.92 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [00:32<00:03, 27.97it/s, est. speed input: 28551.23 toks/s, output: 27.88 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [00:33<00:03, 26.87it/s, est. speed input: 28514.93 toks/s, output: 27.85 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [00:33<00:03, 26.10it/s, est. speed input: 28479.36 toks/s, output: 27.81 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [00:33<00:03, 25.56it/s, est. speed input: 28444.58 toks/s, output: 27.78 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [00:34<00:03, 25.19it/s, est. speed input: 28410.32 toks/s, output: 27.74 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [00:34<00:02, 24.92it/s, est. speed input: 28376.64 toks/s, output: 27.71 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [00:34<00:02, 24.73it/s, est. speed input: 28343.52 toks/s, output: 27.68 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [00:35<00:02, 24.60it/s, est. speed input: 28310.84 toks/s, output: 27.65 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [00:35<00:01, 24.51it/s, est. speed input: 28279.01 toks/s, output: 27.62 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [00:35<00:01, 24.45it/s, est. speed input: 28247.89 toks/s, output: 27.59 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [00:36<00:01, 24.41it/s, est. speed input: 28217.21 toks/s, output: 27.56 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [00:36<00:00, 24.37it/s, est. speed input: 28186.93 toks/s, output: 27.53 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [00:36<00:00, 24.35it/s, est. speed input: 28157.29 toks/s, output: 27.50 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [00:37<00:00, 25.11it/s, est. speed input: 28154.03 toks/s, output: 27.49 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:37<00:00, 25.11it/s, est. speed input: 28319.75 toks/s, output: 27.66 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:37<00:00, 27.66it/s, est. speed input: 28319.75 toks/s, output: 27.66 toks/s]
[rank0]:[W126 03:44:19.491801562 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=16384 ==========
Time: 2026-01-26 03:44:22
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-FP8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=2048, max_num_seqs=16
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-FP8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 2048 --max-num-seqs 16 --max-model-len 1025 --max-num-batched-tokens 16384 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_4/json/Qwen2.5-7B-FP8_M16384.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 03:44:43 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 03:44:44 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=134394) WARNING 01-26 03:44:51 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=134394) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=134394) WARNING 01-26 03:45:03 [backends.py:609] Failed to read file <frozen os>
Throughput: 24.30 requests/s, 24902.74 total tokens/s, 24.30 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048

STDERR:
[2026-01-26 03:44:43] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:44:43] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:44:43] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:44:43] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:44:43] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:44:43] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:44:43] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:44:43] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:44:43] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:44:43] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:44:43] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:44:43] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:44:43] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:44:43] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 03:44:50] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:44:50] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:44:50] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:44:50] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:44:50] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:44:50] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:44:50] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:44:50] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:44:50] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:44:50] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:44:50] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:44:50] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:44:50] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:44:50] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=134394) [2026-01-26 03:44:52] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=134394) [2026-01-26 03:44:52] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=134394) [2026-01-26 03:44:52] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=134394) [2026-01-26 03:44:52] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=134394) [2026-01-26 03:44:52] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=134394) [2026-01-26 03:44:52] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=134394) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=134394) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.41it/s]
(EngineCore_DP0 pid=134394) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.13it/s]
(EngineCore_DP0 pid=134394) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.16it/s]
(EngineCore_DP0 pid=134394) 
(EngineCore_DP0 pid=134394) [2026-01-26 03:44:54] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 3584] -> 1D uint8
(EngineCore_DP0 pid=134394) [2026-01-26 03:44:54] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12386304 bytes
(EngineCore_DP0 pid=134394) [2026-01-26 03:44:54] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 3584] -> 1D uint8
(EngineCore_DP0 pid=134394) [2026-01-26 03:44:54] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 9633792 bytes
(EngineCore_DP0 pid=134394) [2026-01-26 03:44:54] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 3584] -> 1D uint8
(EngineCore_DP0 pid=134394) [2026-01-26 03:44:54] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 101842944 bytes
(EngineCore_DP0 pid=134394) [2026-01-26 03:44:54] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 18944] -> 1D uint8
(EngineCore_DP0 pid=134394) [2026-01-26 03:44:54] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 50921472 bytes
(EngineCore_DP0 pid=134394) [rank0]:W0126 03:45:11.769000 134394 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=134394) [rank0]:W0126 03:45:11.874000 134394 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=134394) [rank0]:W0126 03:45:13.383000 134394 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=134394) [rank0]:W0126 03:45:13.556000 134394 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=134394) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  14%|█▍        | 1/7 [00:00<00:00,  8.10it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  29%|██▊       | 2/7 [00:00<00:00,  8.37it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  43%|████▎     | 3/7 [00:00<00:00,  8.73it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  57%|█████▋    | 4/7 [00:00<00:00,  8.85it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  71%|███████▏  | 5/7 [00:00<00:00,  8.91it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  86%|████████▌ | 6/7 [00:00<00:00,  8.95it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00,  8.10it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00,  8.45it/s]
(EngineCore_DP0 pid=134394) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  20%|██        | 1/5 [00:00<00:00,  6.99it/s]
Capturing CUDA graphs (decode, FULL):  40%|████      | 2/5 [00:00<00:00,  8.02it/s]
Capturing CUDA graphs (decode, FULL):  60%|██████    | 3/5 [00:00<00:00,  8.50it/s]
Capturing CUDA graphs (decode, FULL):  80%|████████  | 4/5 [00:00<00:00,  8.83it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00,  8.98it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00,  8.64it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   1%|          | 24/2048 [00:00<00:08, 236.73it/s]
Adding requests:   2%|▏         | 50/2048 [00:00<00:08, 245.48it/s]
Adding requests:   4%|▍         | 77/2048 [00:00<00:07, 254.49it/s]
Adding requests:   5%|▌         | 104/2048 [00:00<00:07, 257.20it/s]
Adding requests:   6%|▋         | 131/2048 [00:00<00:07, 259.06it/s]
Adding requests:   8%|▊         | 157/2048 [00:00<00:07, 258.56it/s]
Adding requests:   9%|▉         | 187/2048 [00:00<00:06, 268.78it/s]
Adding requests:  10%|█         | 215/2048 [00:00<00:06, 269.60it/s]
Adding requests:  12%|█▏        | 242/2048 [00:00<00:06, 267.93it/s]
Adding requests:  13%|█▎        | 269/2048 [00:01<00:06, 265.29it/s]
Adding requests:  15%|█▍        | 297/2048 [00:01<00:06, 269.12it/s]
Adding requests:  16%|█▌        | 325/2048 [00:01<00:06, 269.12it/s]
Adding requests:  17%|█▋        | 354/2048 [00:01<00:06, 274.67it/s]
Adding requests:  19%|█▊        | 382/2048 [00:01<00:06, 275.82it/s]
Adding requests:  20%|██        | 411/2048 [00:01<00:05, 279.13it/s]
Adding requests:  21%|██▏       | 439/2048 [00:01<00:05, 276.16it/s]
Adding requests:  23%|██▎       | 468/2048 [00:01<00:05, 279.08it/s]
Adding requests:  24%|██▍       | 498/2048 [00:01<00:05, 285.06it/s]
Adding requests:  26%|██▌       | 529/2048 [00:01<00:05, 290.15it/s]
Adding requests:  27%|██▋       | 559/2048 [00:02<00:05, 284.58it/s]
Adding requests:  29%|██▊       | 588/2048 [00:02<00:05, 273.78it/s]
Adding requests:  30%|███       | 616/2048 [00:02<00:05, 268.90it/s]
Adding requests:  31%|███▏      | 643/2048 [00:02<00:05, 266.04it/s]
Adding requests:  33%|███▎      | 670/2048 [00:02<00:05, 261.00it/s]
Adding requests:  34%|███▍      | 698/2048 [00:02<00:05, 264.73it/s]
Adding requests:  35%|███▌      | 725/2048 [00:02<00:04, 265.06it/s]
Adding requests:  37%|███▋      | 752/2048 [00:02<00:04, 265.77it/s]
Adding requests:  38%|███▊      | 779/2048 [00:02<00:04, 264.91it/s]
Adding requests:  39%|███▉      | 806/2048 [00:02<00:04, 265.57it/s]
Adding requests:  41%|████      | 835/2048 [00:03<00:04, 272.46it/s]
Adding requests:  42%|████▏     | 863/2048 [00:03<00:04, 264.46it/s]
Adding requests:  44%|████▎     | 893/2048 [00:03<00:04, 271.52it/s]
Adding requests:  45%|████▍     | 921/2048 [00:03<00:04, 266.58it/s]
Adding requests:  46%|████▋     | 948/2048 [00:03<00:04, 267.30it/s]
Adding requests:  48%|████▊     | 976/2048 [00:03<00:03, 268.73it/s]
Adding requests:  49%|████▉     | 1003/2048 [00:03<00:03, 263.66it/s]
Adding requests:  50%|█████     | 1031/2048 [00:03<00:03, 267.00it/s]
Adding requests:  52%|█████▏    | 1058/2048 [00:03<00:03, 266.44it/s]
Adding requests:  53%|█████▎    | 1086/2048 [00:04<00:03, 268.80it/s]
Adding requests:  54%|█████▍    | 1114/2048 [00:04<00:03, 271.03it/s]
Adding requests:  56%|█████▌    | 1143/2048 [00:04<00:03, 273.39it/s]
Adding requests:  57%|█████▋    | 1171/2048 [00:04<00:03, 270.33it/s]
Adding requests:  59%|█████▊    | 1199/2048 [00:04<00:03, 269.34it/s]
Adding requests:  60%|██████    | 1229/2048 [00:04<00:02, 276.30it/s]
Adding requests:  61%|██████▏   | 1257/2048 [00:04<00:02, 276.76it/s]
Adding requests:  63%|██████▎   | 1285/2048 [00:04<00:02, 270.22it/s]
Adding requests:  64%|██████▍   | 1313/2048 [00:04<00:02, 273.01it/s]
Adding requests:  65%|██████▌   | 1341/2048 [00:04<00:02, 267.65it/s]
Adding requests:  67%|██████▋   | 1369/2048 [00:05<00:02, 271.11it/s]
Adding requests:  68%|██████▊   | 1397/2048 [00:05<00:02, 269.36it/s]
Adding requests:  70%|██████▉   | 1424/2048 [00:05<00:02, 265.00it/s]
Adding requests:  71%|███████   | 1451/2048 [00:05<00:02, 264.98it/s]
Adding requests:  72%|███████▏  | 1478/2048 [00:05<00:02, 264.77it/s]
Adding requests:  74%|███████▎  | 1506/2048 [00:05<00:02, 267.25it/s]
Adding requests:  75%|███████▍  | 1533/2048 [00:05<00:01, 262.57it/s]
Adding requests:  76%|███████▌  | 1560/2048 [00:05<00:01, 261.35it/s]
Adding requests:  77%|███████▋  | 1587/2048 [00:05<00:01, 261.20it/s]
Adding requests:  79%|███████▉  | 1615/2048 [00:06<00:01, 262.88it/s]
Adding requests:  80%|████████  | 1642/2048 [00:06<00:01, 258.98it/s]
Adding requests:  81%|████████▏ | 1668/2048 [00:06<00:01, 256.15it/s]
Adding requests:  83%|████████▎ | 1695/2048 [00:06<00:01, 259.87it/s]
Adding requests:  84%|████████▍ | 1723/2048 [00:06<00:01, 264.32it/s]
Adding requests:  86%|████████▌ | 1752/2048 [00:06<00:01, 269.62it/s]
Adding requests:  87%|████████▋ | 1780/2048 [00:06<00:00, 272.38it/s]
Adding requests:  88%|████████▊ | 1808/2048 [00:06<00:00, 268.82it/s]
Adding requests:  90%|████████▉ | 1836/2048 [00:06<00:00, 267.98it/s]
Adding requests:  91%|█████████ | 1865/2048 [00:06<00:00, 272.03it/s]
Adding requests:  92%|█████████▏| 1893/2048 [00:07<00:00, 271.54it/s]
Adding requests:  94%|█████████▍| 1921/2048 [00:07<00:00, 273.09it/s]
Adding requests:  95%|█████████▌| 1950/2048 [00:07<00:00, 276.61it/s]
Adding requests:  97%|█████████▋| 1978/2048 [00:07<00:00, 276.18it/s]
Adding requests:  98%|█████████▊| 2006/2048 [00:07<00:00, 272.74it/s]
Adding requests:  99%|█████████▉| 2034/2048 [00:07<00:00, 257.96it/s]
Adding requests: 100%|██████████| 2048/2048 [00:07<00:00, 268.23it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   9%|▊         | 178/2048 [00:00<00:04, 390.91it/s, est. speed input: 400318.88 toks/s, output: 390.92 toks/s]
Processed prompts:  11%|█         | 218/2048 [00:01<00:17, 103.11it/s, est. speed input: 128818.73 toks/s, output: 125.80 toks/s]
Processed prompts:  12%|█▏        | 236/2048 [00:02<00:24, 75.21it/s, est. speed input: 101245.93 toks/s, output: 98.87 toks/s]  
Processed prompts:  12%|█▏        | 248/2048 [00:03<00:32, 55.56it/s, est. speed input: 83497.49 toks/s, output: 81.54 toks/s] 
Processed prompts:  13%|█▎        | 258/2048 [00:03<00:42, 42.25it/s, est. speed input: 71483.98 toks/s, output: 69.81 toks/s]
Processed prompts:  13%|█▎        | 274/2048 [00:04<00:48, 36.55it/s, est. speed input: 64506.00 toks/s, output: 62.99 toks/s]
Processed prompts:  14%|█▍        | 290/2048 [00:05<00:53, 32.72it/s, est. speed input: 59320.09 toks/s, output: 57.93 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [00:05<00:57, 30.15it/s, est. speed input: 55348.37 toks/s, output: 54.05 toks/s]
Processed prompts:  16%|█▌        | 322/2048 [00:06<01:00, 28.38it/s, est. speed input: 52194.40 toks/s, output: 50.97 toks/s]
Processed prompts:  17%|█▋        | 338/2048 [00:06<01:02, 27.16it/s, est. speed input: 49632.30 toks/s, output: 48.47 toks/s]
Processed prompts:  17%|█▋        | 354/2048 [00:07<01:04, 26.31it/s, est. speed input: 47509.61 toks/s, output: 46.40 toks/s]
Processed prompts:  18%|█▊        | 370/2048 [00:08<01:05, 25.72it/s, est. speed input: 45721.75 toks/s, output: 44.65 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [00:08<01:05, 25.31it/s, est. speed input: 44193.92 toks/s, output: 43.16 toks/s]
Processed prompts:  20%|█▉        | 402/2048 [00:09<01:05, 25.02it/s, est. speed input: 42875.02 toks/s, output: 41.87 toks/s]
Processed prompts:  20%|██        | 418/2048 [00:10<01:05, 24.81it/s, est. speed input: 41723.47 toks/s, output: 40.75 toks/s]
Processed prompts:  21%|██        | 434/2048 [00:10<01:05, 24.67it/s, est. speed input: 40710.92 toks/s, output: 39.76 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [00:11<01:05, 24.49it/s, est. speed input: 39789.31 toks/s, output: 38.86 toks/s]
Processed prompts:  23%|██▎       | 466/2048 [00:12<01:04, 24.43it/s, est. speed input: 38988.06 toks/s, output: 38.07 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [00:12<01:04, 24.39it/s, est. speed input: 38268.22 toks/s, output: 37.37 toks/s]
Processed prompts:  24%|██▍       | 498/2048 [00:13<01:03, 24.36it/s, est. speed input: 37617.04 toks/s, output: 36.74 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [00:14<01:03, 24.34it/s, est. speed input: 37026.73 toks/s, output: 36.16 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [00:14<01:02, 24.31it/s, est. speed input: 36486.80 toks/s, output: 35.63 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [00:15<01:01, 24.31it/s, est. speed input: 35994.24 toks/s, output: 35.15 toks/s]
Processed prompts:  27%|██▋       | 562/2048 [00:16<01:01, 24.29it/s, est. speed input: 35539.92 toks/s, output: 34.71 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [00:16<01:00, 24.28it/s, est. speed input: 35120.74 toks/s, output: 34.30 toks/s]
Processed prompts:  31%|███       | 626/2048 [00:17<00:35, 40.12it/s, est. speed input: 36752.82 toks/s, output: 35.89 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [00:18<00:39, 35.26it/s, est. speed input: 36319.34 toks/s, output: 35.47 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [00:18<00:43, 31.91it/s, est. speed input: 35916.70 toks/s, output: 35.07 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [00:19<00:46, 29.60it/s, est. speed input: 35541.87 toks/s, output: 34.71 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [00:20<00:48, 27.99it/s, est. speed input: 35191.73 toks/s, output: 34.37 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [00:20<00:49, 26.88it/s, est. speed input: 34864.37 toks/s, output: 34.05 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [00:21<00:50, 26.10it/s, est. speed input: 34557.35 toks/s, output: 33.75 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [00:22<00:51, 25.57it/s, est. speed input: 34268.94 toks/s, output: 33.47 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [00:22<00:51, 25.20it/s, est. speed input: 33998.36 toks/s, output: 33.20 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [00:23<00:51, 24.92it/s, est. speed input: 33741.15 toks/s, output: 32.95 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [00:23<00:50, 25.10it/s, est. speed input: 33542.79 toks/s, output: 32.76 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [00:24<00:50, 24.87it/s, est. speed input: 33312.91 toks/s, output: 32.53 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [00:25<00:49, 24.71it/s, est. speed input: 33094.84 toks/s, output: 32.32 toks/s]
Processed prompts:  41%|████      | 834/2048 [00:25<00:49, 24.60it/s, est. speed input: 32888.28 toks/s, output: 32.12 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [00:26<00:48, 24.52it/s, est. speed input: 32691.66 toks/s, output: 31.93 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [00:27<00:48, 24.47it/s, est. speed input: 32504.63 toks/s, output: 31.74 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [00:27<00:47, 24.43it/s, est. speed input: 32326.51 toks/s, output: 31.57 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [00:28<00:47, 24.41it/s, est. speed input: 32156.61 toks/s, output: 31.40 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [00:29<00:46, 24.39it/s, est. speed input: 31994.05 toks/s, output: 31.24 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [00:29<00:45, 24.37it/s, est. speed input: 31838.24 toks/s, output: 31.09 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [00:30<00:45, 24.36it/s, est. speed input: 31689.57 toks/s, output: 30.95 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [00:31<00:44, 24.35it/s, est. speed input: 31546.68 toks/s, output: 30.81 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [00:31<00:43, 24.34it/s, est. speed input: 31409.68 toks/s, output: 30.67 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [00:32<00:43, 24.34it/s, est. speed input: 31278.30 toks/s, output: 30.55 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [00:33<00:42, 24.33it/s, est. speed input: 31151.91 toks/s, output: 30.42 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [00:33<00:42, 24.33it/s, est. speed input: 31030.49 toks/s, output: 30.30 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [00:34<00:41, 24.32it/s, est. speed input: 30913.30 toks/s, output: 30.19 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [00:35<00:40, 24.32it/s, est. speed input: 30800.64 toks/s, output: 30.08 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [00:35<00:40, 24.31it/s, est. speed input: 30691.98 toks/s, output: 29.97 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [00:36<00:39, 24.31it/s, est. speed input: 30587.41 toks/s, output: 29.87 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [00:37<00:38, 24.31it/s, est. speed input: 30486.57 toks/s, output: 29.77 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [00:37<00:38, 24.31it/s, est. speed input: 30389.28 toks/s, output: 29.68 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [00:38<00:37, 24.31it/s, est. speed input: 30295.19 toks/s, output: 29.59 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [00:39<00:36, 24.31it/s, est. speed input: 30204.42 toks/s, output: 29.50 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [00:39<00:36, 24.32it/s, est. speed input: 30116.84 toks/s, output: 29.41 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [00:40<00:35, 24.31it/s, est. speed input: 30031.68 toks/s, output: 29.33 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [00:41<00:34, 24.32it/s, est. speed input: 29950.16 toks/s, output: 29.25 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [00:41<00:34, 24.31it/s, est. speed input: 29869.99 toks/s, output: 29.17 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [00:42<00:33, 24.32it/s, est. speed input: 29793.23 toks/s, output: 29.09 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [00:43<00:32, 24.32it/s, est. speed input: 29718.59 toks/s, output: 29.02 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [00:43<00:32, 24.32it/s, est. speed input: 29646.19 toks/s, output: 28.95 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [00:44<00:31, 24.32it/s, est. speed input: 29576.07 toks/s, output: 28.88 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [00:45<00:30, 24.32it/s, est. speed input: 29507.91 toks/s, output: 28.82 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [00:45<00:30, 24.32it/s, est. speed input: 29441.62 toks/s, output: 28.75 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [00:46<00:29, 24.32it/s, est. speed input: 29377.05 toks/s, output: 28.69 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [00:47<00:28, 24.32it/s, est. speed input: 29314.61 toks/s, output: 28.63 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [00:47<00:28, 24.32it/s, est. speed input: 29253.84 toks/s, output: 28.57 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [00:48<00:27, 24.33it/s, est. speed input: 29194.84 toks/s, output: 28.51 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [00:48<00:15, 40.46it/s, est. speed input: 29856.85 toks/s, output: 29.16 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [00:49<00:17, 35.50it/s, est. speed input: 29791.74 toks/s, output: 29.09 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [00:50<00:18, 32.11it/s, est. speed input: 29728.76 toks/s, output: 29.03 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [00:50<00:19, 29.76it/s, est. speed input: 29667.37 toks/s, output: 28.97 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [00:51<00:19, 28.13it/s, est. speed input: 29607.48 toks/s, output: 28.91 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [00:52<00:20, 27.00it/s, est. speed input: 29548.96 toks/s, output: 28.86 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [00:52<00:20, 26.21it/s, est. speed input: 29491.89 toks/s, output: 28.80 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [00:53<00:19, 25.66it/s, est. speed input: 29436.34 toks/s, output: 28.75 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [00:54<00:19, 25.27it/s, est. speed input: 29382.15 toks/s, output: 28.69 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [00:54<00:19, 25.00it/s, est. speed input: 29329.13 toks/s, output: 28.64 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [00:55<00:18, 24.81it/s, est. speed input: 29277.27 toks/s, output: 28.59 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [00:56<00:18, 24.68it/s, est. speed input: 29226.80 toks/s, output: 28.54 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [00:56<00:17, 24.94it/s, est. speed input: 29193.27 toks/s, output: 28.51 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [00:57<00:16, 24.75it/s, est. speed input: 29144.30 toks/s, output: 28.46 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [00:58<00:16, 24.60it/s, est. speed input: 29095.17 toks/s, output: 28.41 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [00:58<00:15, 24.50it/s, est. speed input: 29047.60 toks/s, output: 28.37 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [00:59<00:14, 24.41it/s, est. speed input: 29000.17 toks/s, output: 28.32 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [01:00<00:14, 24.37it/s, est. speed input: 28954.79 toks/s, output: 28.28 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [01:00<00:13, 24.32it/s, est. speed input: 28909.36 toks/s, output: 28.23 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [01:01<00:13, 24.30it/s, est. speed input: 28865.40 toks/s, output: 28.19 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [01:02<00:12, 24.28it/s, est. speed input: 28822.41 toks/s, output: 28.15 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [01:02<00:11, 24.27it/s, est. speed input: 28780.27 toks/s, output: 28.11 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [01:03<00:11, 24.26it/s, est. speed input: 28739.00 toks/s, output: 28.07 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [01:04<00:10, 24.25it/s, est. speed input: 28698.43 toks/s, output: 28.03 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [01:04<00:09, 24.25it/s, est. speed input: 28658.84 toks/s, output: 27.99 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [01:05<00:09, 24.24it/s, est. speed input: 28619.92 toks/s, output: 27.95 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [01:05<00:08, 24.25it/s, est. speed input: 28582.13 toks/s, output: 27.91 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [01:06<00:07, 24.25it/s, est. speed input: 28545.22 toks/s, output: 27.88 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [01:07<00:07, 24.27it/s, est. speed input: 28509.37 toks/s, output: 27.84 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [01:07<00:06, 24.25it/s, est. speed input: 28473.29 toks/s, output: 27.81 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [01:08<00:05, 24.25it/s, est. speed input: 28438.36 toks/s, output: 27.77 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [01:09<00:05, 24.26it/s, est. speed input: 28404.17 toks/s, output: 27.74 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [01:09<00:04, 24.26it/s, est. speed input: 28370.54 toks/s, output: 27.71 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [01:10<00:03, 24.25it/s, est. speed input: 28337.50 toks/s, output: 27.67 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [01:11<00:03, 24.25it/s, est. speed input: 28305.09 toks/s, output: 27.64 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [01:11<00:02, 24.25it/s, est. speed input: 28273.25 toks/s, output: 27.61 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [01:12<00:01, 24.25it/s, est. speed input: 28241.98 toks/s, output: 27.58 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [01:13<00:01, 24.25it/s, est. speed input: 28211.28 toks/s, output: 27.55 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [01:13<00:00, 24.68it/s, est. speed input: 28195.56 toks/s, output: 27.53 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [01:13<00:00, 24.68it/s, est. speed input: 28389.46 toks/s, output: 27.72 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [01:13<00:00, 27.72it/s, est. speed input: 28389.46 toks/s, output: 27.72 toks/s]
[rank0]:[W126 03:46:43.568760788 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=32768 ==========
Time: 2026-01-26 03:46:46
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-FP8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=4096, max_num_seqs=32
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-FP8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 4096 --max-num-seqs 32 --max-model-len 1025 --max-num-batched-tokens 32768 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_4/json/Qwen2.5-7B-FP8_M32768.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 03:47:20 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 03:47:21 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=136857) WARNING 01-26 03:47:29 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=136857) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=136857) WARNING 01-26 03:47:41 [backends.py:609] Failed to read file <frozen os>
Throughput: 8.07 requests/s, 8276.57 total tokens/s, 8.07 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096

STDERR:
[2026-01-26 03:47:20] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:47:20] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:47:20] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:47:20] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:47:20] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:47:20] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:47:20] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:47:20] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:47:20] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:47:20] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:47:20] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:47:20] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:47:20] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:47:20] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 03:47:28] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:47:28] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:47:28] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:47:28] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:47:28] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:47:28] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:47:28] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:47:28] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:47:28] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:47:28] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:47:28] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:47:28] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:47:28] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:47:28] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=136857) [2026-01-26 03:47:29] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=136857) [2026-01-26 03:47:29] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=136857) [2026-01-26 03:47:29] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=136857) [2026-01-26 03:47:29] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=136857) [2026-01-26 03:47:29] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=136857) [2026-01-26 03:47:29] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=136857) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=136857) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.40it/s]
(EngineCore_DP0 pid=136857) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.13it/s]
(EngineCore_DP0 pid=136857) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.17it/s]
(EngineCore_DP0 pid=136857) 
(EngineCore_DP0 pid=136857) [2026-01-26 03:47:32] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 3584] -> 1D uint8
(EngineCore_DP0 pid=136857) [2026-01-26 03:47:32] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12386304 bytes
(EngineCore_DP0 pid=136857) [2026-01-26 03:47:32] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 3584] -> 1D uint8
(EngineCore_DP0 pid=136857) [2026-01-26 03:47:32] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 9633792 bytes
(EngineCore_DP0 pid=136857) [2026-01-26 03:47:32] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 3584] -> 1D uint8
(EngineCore_DP0 pid=136857) [2026-01-26 03:47:32] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 101842944 bytes
(EngineCore_DP0 pid=136857) [2026-01-26 03:47:32] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 18944] -> 1D uint8
(EngineCore_DP0 pid=136857) [2026-01-26 03:47:32] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 50921472 bytes
(EngineCore_DP0 pid=136857) [rank0]:W0126 03:47:49.712000 136857 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=136857) [rank0]:W0126 03:47:49.821000 136857 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=136857) [rank0]:W0126 03:47:49.895000 136857 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=136857) [rank0]:W0126 03:47:50.076000 136857 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=136857) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   9%|▉         | 1/11 [00:00<00:01,  8.09it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  18%|█▊        | 2/11 [00:00<00:01,  8.36it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  27%|██▋       | 3/11 [00:00<00:00,  8.70it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  36%|███▋      | 4/11 [00:00<00:00,  8.88it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  45%|████▌     | 5/11 [00:00<00:00,  8.66it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  55%|█████▍    | 6/11 [00:00<00:00,  6.99it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  64%|██████▎   | 7/11 [00:00<00:00,  7.04it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  73%|███████▎  | 8/11 [00:01<00:00,  6.76it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  82%|████████▏ | 9/11 [00:01<00:00,  7.29it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  91%|█████████ | 10/11 [00:01<00:00,  7.72it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00,  7.60it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00,  7.64it/s]
(EngineCore_DP0 pid=136857) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  14%|█▍        | 1/7 [00:00<00:00,  7.00it/s]
Capturing CUDA graphs (decode, FULL):  29%|██▊       | 2/7 [00:00<00:00,  8.16it/s]
Capturing CUDA graphs (decode, FULL):  43%|████▎     | 3/7 [00:00<00:00,  8.72it/s]
Capturing CUDA graphs (decode, FULL):  57%|█████▋    | 4/7 [00:00<00:00,  8.96it/s]
Capturing CUDA graphs (decode, FULL):  71%|███████▏  | 5/7 [00:00<00:00,  9.19it/s]
Capturing CUDA graphs (decode, FULL):  86%|████████▌ | 6/7 [00:00<00:00,  9.29it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00,  9.38it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00,  9.01it/s]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   1%|          | 23/4096 [00:00<00:17, 229.93it/s]
Adding requests:   1%|          | 49/4096 [00:00<00:16, 243.04it/s]
Adding requests:   2%|▏         | 76/4096 [00:00<00:16, 250.58it/s]
Adding requests:   2%|▏         | 102/4096 [00:00<00:15, 253.17it/s]
Adding requests:   3%|▎         | 128/4096 [00:00<00:16, 244.23it/s]
Adding requests:   4%|▎         | 153/4096 [00:00<00:16, 238.15it/s]
Adding requests:   4%|▍         | 178/4096 [00:00<00:16, 240.67it/s]
Adding requests:   5%|▌         | 207/4096 [00:00<00:15, 254.06it/s]
Adding requests:   6%|▌         | 233/4096 [00:00<00:15, 245.22it/s]
Adding requests:   6%|▋         | 259/4096 [00:01<00:15, 248.51it/s]
Adding requests:   7%|▋         | 286/4096 [00:01<00:14, 254.74it/s]
Adding requests:   8%|▊         | 312/4096 [00:01<00:15, 248.74it/s]
Adding requests:   8%|▊         | 339/4096 [00:01<00:14, 254.10it/s]
Adding requests:   9%|▉         | 365/4096 [00:01<00:14, 250.60it/s]
Adding requests:  10%|▉         | 391/4096 [00:01<00:14, 249.48it/s]
Adding requests:  10%|█         | 420/4096 [00:01<00:14, 260.06it/s]
Adding requests:  11%|█         | 447/4096 [00:01<00:14, 246.57it/s]
Adding requests:  12%|█▏        | 476/4096 [00:01<00:14, 257.71it/s]
Adding requests:  12%|█▏        | 505/4096 [00:02<00:13, 265.57it/s]
Adding requests:  13%|█▎        | 532/4096 [00:02<00:13, 263.12it/s]
Adding requests:  14%|█▎        | 561/4096 [00:02<00:13, 269.41it/s]
Adding requests:  14%|█▍        | 589/4096 [00:02<00:13, 259.28it/s]
Adding requests:  15%|█▌        | 616/4096 [00:02<00:13, 256.06it/s]
Adding requests:  16%|█▌        | 643/4096 [00:02<00:13, 257.07it/s]
Adding requests:  16%|█▋        | 669/4096 [00:02<00:14, 241.59it/s]
Adding requests:  17%|█▋        | 697/4096 [00:02<00:13, 249.64it/s]
Adding requests:  18%|█▊        | 723/4096 [00:02<00:13, 245.94it/s]
Adding requests:  18%|█▊        | 748/4096 [00:02<00:13, 239.88it/s]
Adding requests:  19%|█▉        | 775/4096 [00:03<00:13, 248.03it/s]
Adding requests:  20%|█▉        | 800/4096 [00:03<00:13, 241.68it/s]
Adding requests:  20%|██        | 827/4096 [00:03<00:13, 247.36it/s]
Adding requests:  21%|██        | 855/4096 [00:03<00:12, 253.01it/s]
Adding requests:  22%|██▏       | 881/4096 [00:03<00:13, 242.85it/s]
Adding requests:  22%|██▏       | 909/4096 [00:03<00:12, 251.36it/s]
Adding requests:  23%|██▎       | 935/4096 [00:03<00:12, 244.61it/s]
Adding requests:  23%|██▎       | 960/4096 [00:03<00:12, 245.77it/s]
Adding requests:  24%|██▍       | 987/4096 [00:03<00:12, 252.37it/s]
Adding requests:  25%|██▍       | 1013/4096 [00:04<00:14, 212.99it/s]
Adding requests:  25%|██▌       | 1036/4096 [00:04<00:14, 206.37it/s]
Adding requests:  26%|██▌       | 1058/4096 [00:04<00:15, 191.53it/s]
Adding requests:  26%|██▋       | 1078/4096 [00:04<00:15, 190.92it/s]
Adding requests:  27%|██▋       | 1103/4096 [00:04<00:14, 204.91it/s]
Adding requests:  28%|██▊       | 1127/4096 [00:04<00:13, 214.04it/s]
Adding requests:  28%|██▊       | 1154/4096 [00:04<00:12, 228.23it/s]
Adding requests:  29%|██▉       | 1180/4096 [00:04<00:12, 235.92it/s]
Adding requests:  29%|██▉       | 1204/4096 [00:04<00:12, 228.31it/s]
Adding requests:  30%|███       | 1234/4096 [00:05<00:11, 246.85it/s]
Adding requests:  31%|███       | 1259/4096 [00:05<00:11, 240.69it/s]
Adding requests:  31%|███▏      | 1286/4096 [00:05<00:11, 247.62it/s]
Adding requests:  32%|███▏      | 1314/4096 [00:05<00:10, 254.10it/s]
Adding requests:  33%|███▎      | 1340/4096 [00:05<00:11, 245.97it/s]
Adding requests:  33%|███▎      | 1369/4096 [00:05<00:10, 257.67it/s]
Adding requests:  34%|███▍      | 1395/4096 [00:05<00:10, 256.46it/s]
Adding requests:  35%|███▍      | 1421/4096 [00:05<00:10, 250.07it/s]
Adding requests:  35%|███▌      | 1448/4096 [00:05<00:10, 253.16it/s]
Adding requests:  36%|███▌      | 1474/4096 [00:06<00:10, 246.38it/s]
Adding requests:  37%|███▋      | 1502/4096 [00:06<00:10, 255.90it/s]
Adding requests:  37%|███▋      | 1529/4096 [00:06<00:09, 259.92it/s]
Adding requests:  38%|███▊      | 1556/4096 [00:06<00:10, 245.75it/s]
Adding requests:  39%|███▊      | 1581/4096 [00:06<00:10, 245.49it/s]
Adding requests:  39%|███▉      | 1606/4096 [00:06<00:10, 238.75it/s]
Adding requests:  40%|███▉      | 1631/4096 [00:06<00:10, 234.87it/s]
Adding requests:  40%|████      | 1656/4096 [00:06<00:10, 236.05it/s]
Adding requests:  41%|████      | 1680/4096 [00:06<00:10, 228.85it/s]
Adding requests:  42%|████▏     | 1708/4096 [00:07<00:09, 242.16it/s]
Adding requests:  42%|████▏     | 1734/4096 [00:07<00:09, 244.74it/s]
Adding requests:  43%|████▎     | 1759/4096 [00:07<00:09, 245.65it/s]
Adding requests:  44%|████▎     | 1788/4096 [00:07<00:08, 256.92it/s]
Adding requests:  44%|████▍     | 1814/4096 [00:07<00:09, 248.71it/s]
Adding requests:  45%|████▍     | 1839/4096 [00:07<00:09, 248.37it/s]
Adding requests:  46%|████▌     | 1867/4096 [00:07<00:08, 255.48it/s]
Adding requests:  46%|████▌     | 1893/4096 [00:07<00:08, 248.53it/s]
Adding requests:  47%|████▋     | 1922/4096 [00:07<00:08, 259.53it/s]
Adding requests:  48%|████▊     | 1950/4096 [00:07<00:08, 264.91it/s]
Adding requests:  48%|████▊     | 1977/4096 [00:08<00:08, 255.12it/s]
Adding requests:  49%|████▉     | 2003/4096 [00:08<00:08, 256.02it/s]
Adding requests:  50%|████▉     | 2029/4096 [00:08<00:08, 246.90it/s]
Adding requests:  50%|█████     | 2055/4096 [00:08<00:08, 250.13it/s]
Adding requests:  51%|█████     | 2081/4096 [00:08<00:08, 249.18it/s]
Adding requests:  51%|█████▏    | 2106/4096 [00:08<00:08, 243.62it/s]
Adding requests:  52%|█████▏    | 2132/4096 [00:08<00:07, 248.14it/s]
Adding requests:  53%|█████▎    | 2158/4096 [00:08<00:07, 250.93it/s]
Adding requests:  53%|█████▎    | 2184/4096 [00:08<00:07, 241.96it/s]
Adding requests:  54%|█████▍    | 2209/4096 [00:09<00:07, 242.70it/s]
Adding requests:  55%|█████▍    | 2234/4096 [00:09<00:07, 241.34it/s]
Adding requests:  55%|█████▌    | 2260/4096 [00:09<00:07, 244.42it/s]
Adding requests:  56%|█████▌    | 2288/4096 [00:09<00:07, 253.25it/s]
Adding requests:  56%|█████▋    | 2314/4096 [00:09<00:07, 245.54it/s]
Adding requests:  57%|█████▋    | 2342/4096 [00:09<00:06, 253.02it/s]
Adding requests:  58%|█████▊    | 2368/4096 [00:09<00:06, 254.36it/s]
Adding requests:  58%|█████▊    | 2394/4096 [00:09<00:06, 248.30it/s]
Adding requests:  59%|█████▉    | 2423/4096 [00:09<00:06, 257.53it/s]
Adding requests:  60%|█████▉    | 2449/4096 [00:09<00:06, 245.27it/s]
Adding requests:  60%|██████    | 2476/4096 [00:10<00:06, 250.09it/s]
Adding requests:  61%|██████    | 2505/4096 [00:10<00:06, 258.93it/s]
Adding requests:  62%|██████▏   | 2531/4096 [00:10<00:06, 256.83it/s]
Adding requests:  62%|██████▎   | 2560/4096 [00:10<00:05, 266.18it/s]
Adding requests:  63%|██████▎   | 2590/4096 [00:10<00:05, 272.41it/s]
Adding requests:  64%|██████▍   | 2618/4096 [00:10<00:05, 257.54it/s]
Adding requests:  65%|██████▍   | 2645/4096 [00:10<00:05, 259.93it/s]
Adding requests:  65%|██████▌   | 2672/4096 [00:10<00:05, 251.36it/s]
Adding requests:  66%|██████▌   | 2698/4096 [00:10<00:05, 251.02it/s]
Adding requests:  67%|██████▋   | 2726/4096 [00:11<00:05, 257.03it/s]
Adding requests:  67%|██████▋   | 2752/4096 [00:11<00:05, 251.46it/s]
Adding requests:  68%|██████▊   | 2782/4096 [00:11<00:04, 264.24it/s]
Adding requests:  69%|██████▊   | 2811/4096 [00:11<00:04, 269.24it/s]
Adding requests:  69%|██████▉   | 2839/4096 [00:11<00:04, 262.91it/s]
Adding requests:  70%|██████▉   | 2867/4096 [00:11<00:04, 266.17it/s]
Adding requests:  71%|███████   | 2894/4096 [00:11<00:04, 258.24it/s]
Adding requests:  71%|███████▏  | 2920/4096 [00:11<00:04, 258.22it/s]
Adding requests:  72%|███████▏  | 2949/4096 [00:11<00:04, 266.85it/s]
Adding requests:  73%|███████▎  | 2976/4096 [00:12<00:04, 255.55it/s]
Adding requests:  73%|███████▎  | 3005/4096 [00:12<00:04, 263.07it/s]
Adding requests:  74%|███████▍  | 3032/4096 [00:12<00:04, 263.17it/s]
Adding requests:  75%|███████▍  | 3059/4096 [00:12<00:04, 255.74it/s]
Adding requests:  75%|███████▌  | 3087/4096 [00:12<00:03, 261.46it/s]
Adding requests:  76%|███████▌  | 3114/4096 [00:12<00:03, 255.95it/s]
Adding requests:  77%|███████▋  | 3140/4096 [00:12<00:03, 256.11it/s]
Adding requests:  77%|███████▋  | 3167/4096 [00:12<00:03, 259.11it/s]
Adding requests:  78%|███████▊  | 3193/4096 [00:12<00:03, 245.14it/s]
Adding requests:  79%|███████▊  | 3221/4096 [00:12<00:03, 252.94it/s]
Adding requests:  79%|███████▉  | 3250/4096 [00:13<00:03, 262.78it/s]
Adding requests:  80%|████████  | 3277/4096 [00:13<00:03, 247.85it/s]
Adding requests:  81%|████████  | 3303/4096 [00:13<00:03, 250.52it/s]
Adding requests:  81%|████████▏ | 3329/4096 [00:13<00:03, 244.90it/s]
Adding requests:  82%|████████▏ | 3356/4096 [00:13<00:02, 250.32it/s]
Adding requests:  83%|████████▎ | 3385/4096 [00:13<00:02, 261.32it/s]
Adding requests:  83%|████████▎ | 3412/4096 [00:13<00:02, 251.77it/s]
Adding requests:  84%|████████▍ | 3441/4096 [00:13<00:02, 260.20it/s]
Adding requests:  85%|████████▍ | 3469/4096 [00:13<00:02, 263.44it/s]
Adding requests:  85%|████████▌ | 3496/4096 [00:14<00:02, 252.17it/s]
Adding requests:  86%|████████▌ | 3527/4096 [00:14<00:02, 266.25it/s]
Adding requests:  87%|████████▋ | 3554/4096 [00:14<00:02, 261.23it/s]
Adding requests:  87%|████████▋ | 3581/4096 [00:14<00:01, 259.13it/s]
Adding requests:  88%|████████▊ | 3608/4096 [00:14<00:01, 262.05it/s]
Adding requests:  89%|████████▊ | 3635/4096 [00:14<00:01, 256.61it/s]
Adding requests:  89%|████████▉ | 3662/4096 [00:14<00:01, 260.13it/s]
Adding requests:  90%|█████████ | 3689/4096 [00:14<00:01, 257.16it/s]
Adding requests:  91%|█████████ | 3715/4096 [00:14<00:01, 254.54it/s]
Adding requests:  91%|█████████▏| 3742/4096 [00:14<00:01, 257.68it/s]
Adding requests:  92%|█████████▏| 3768/4096 [00:15<00:01, 245.93it/s]
Adding requests:  93%|█████████▎| 3793/4096 [00:15<00:01, 241.30it/s]
Adding requests:  93%|█████████▎| 3818/4096 [00:15<00:01, 229.16it/s]
Adding requests:  94%|█████████▍| 3842/4096 [00:15<00:01, 230.18it/s]
Adding requests:  94%|█████████▍| 3869/4096 [00:15<00:00, 241.10it/s]
Adding requests:  95%|█████████▌| 3894/4096 [00:15<00:00, 234.90it/s]
Adding requests:  96%|█████████▌| 3918/4096 [00:15<00:00, 233.09it/s]
Adding requests:  96%|█████████▋| 3945/4096 [00:15<00:00, 242.12it/s]
Adding requests:  97%|█████████▋| 3970/4096 [00:15<00:00, 232.41it/s]
Adding requests:  98%|█████████▊| 3996/4096 [00:16<00:00, 240.06it/s]
Adding requests:  98%|█████████▊| 4022/4096 [00:16<00:00, 242.29it/s]
Adding requests:  99%|█████████▉| 4047/4096 [00:16<00:00, 237.66it/s]
Adding requests:  99%|█████████▉| 4075/4096 [00:16<00:00, 248.78it/s]
Adding requests: 100%|██████████| 4096/4096 [00:16<00:00, 248.58it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   3%|▎         | 130/4096 [00:03<01:57, 33.71it/s, est. speed input: 34518.53 toks/s, output: 33.71 toks/s]
Processed prompts:   4%|▍         | 162/4096 [00:06<02:48, 23.33it/s, est. speed input: 25806.25 toks/s, output: 25.20 toks/s]
Processed prompts:   5%|▍         | 194/4096 [00:10<04:12, 15.43it/s, est. speed input: 19117.91 toks/s, output: 18.67 toks/s]
Processed prompts:   6%|▌         | 226/4096 [00:14<05:14, 12.30it/s, est. speed input: 16121.84 toks/s, output: 15.74 toks/s]
Processed prompts:   6%|▋         | 258/4096 [00:18<05:58, 10.70it/s, est. speed input: 14422.61 toks/s, output: 14.08 toks/s]
Processed prompts:   7%|▋         | 290/4096 [00:22<06:29,  9.78it/s, est. speed input: 13327.63 toks/s, output: 13.02 toks/s]
Processed prompts:   8%|▊         | 322/4096 [00:26<06:49,  9.21it/s, est. speed input: 12564.10 toks/s, output: 12.27 toks/s]
Processed prompts:   9%|▊         | 354/4096 [00:30<07:03,  8.84it/s, est. speed input: 11999.09 toks/s, output: 11.72 toks/s]
Processed prompts:   9%|▉         | 386/4096 [00:34<07:11,  8.60it/s, est. speed input: 11566.02 toks/s, output: 11.29 toks/s]
Processed prompts:  10%|█         | 418/4096 [00:36<06:28,  9.47it/s, est. speed input: 11647.42 toks/s, output: 11.37 toks/s]
Processed prompts:  11%|█         | 450/4096 [00:40<06:44,  9.00it/s, est. speed input: 11318.06 toks/s, output: 11.05 toks/s]
Processed prompts:  12%|█▏        | 482/4096 [00:44<06:55,  8.70it/s, est. speed input: 11046.83 toks/s, output: 10.79 toks/s]
Processed prompts:  13%|█▎        | 514/4096 [00:48<07:01,  8.50it/s, est. speed input: 10819.81 toks/s, output: 10.57 toks/s]
Processed prompts:  13%|█▎        | 546/4096 [00:52<07:04,  8.37it/s, est. speed input: 10626.88 toks/s, output: 10.38 toks/s]
Processed prompts:  14%|█▍        | 578/4096 [00:56<07:05,  8.28it/s, est. speed input: 10461.08 toks/s, output: 10.22 toks/s]
Processed prompts:  15%|█▍        | 610/4096 [01:00<07:04,  8.21it/s, est. speed input: 10317.02 toks/s, output: 10.08 toks/s]
Processed prompts:  16%|█▌        | 642/4096 [01:04<07:02,  8.17it/s, est. speed input: 10190.60 toks/s, output: 9.95 toks/s] 
Processed prompts:  16%|█▋        | 674/4096 [01:07<06:16,  9.10it/s, est. speed input: 10287.09 toks/s, output: 10.05 toks/s]
Processed prompts:  17%|█▋        | 706/4096 [01:11<06:26,  8.76it/s, est. speed input: 10174.13 toks/s, output: 9.94 toks/s] 
Processed prompts:  18%|█▊        | 738/4096 [01:15<06:33,  8.54it/s, est. speed input: 10073.11 toks/s, output: 9.84 toks/s]
Processed prompts:  19%|█▉        | 770/4096 [01:18<06:29,  8.53it/s, est. speed input: 10007.53 toks/s, output: 9.77 toks/s]
Processed prompts:  20%|█▉        | 802/4096 [01:22<06:32,  8.38it/s, est. speed input: 9923.68 toks/s, output: 9.69 toks/s] 
Processed prompts:  20%|██        | 834/4096 [01:26<06:33,  8.29it/s, est. speed input: 9847.53 toks/s, output: 9.62 toks/s]
Processed prompts:  21%|██        | 866/4096 [01:30<06:33,  8.22it/s, est. speed input: 9777.81 toks/s, output: 9.55 toks/s]
Processed prompts:  22%|██▏       | 898/4096 [01:34<06:31,  8.17it/s, est. speed input: 9714.04 toks/s, output: 9.49 toks/s]
Processed prompts:  23%|██▎       | 930/4096 [01:38<06:29,  8.14it/s, est. speed input: 9655.35 toks/s, output: 9.43 toks/s]
Processed prompts:  23%|██▎       | 962/4096 [01:41<05:45,  9.08it/s, est. speed input: 9734.10 toks/s, output: 9.51 toks/s]
Processed prompts:  24%|██▍       | 994/4096 [01:45<05:54,  8.75it/s, est. speed input: 9678.65 toks/s, output: 9.45 toks/s]
Processed prompts:  25%|██▌       | 1026/4096 [01:49<05:59,  8.54it/s, est. speed input: 9627.09 toks/s, output: 9.40 toks/s]
Processed prompts:  26%|██▌       | 1058/4096 [01:53<06:02,  8.39it/s, est. speed input: 9578.86 toks/s, output: 9.35 toks/s]
Processed prompts:  27%|██▋       | 1090/4096 [01:57<06:02,  8.28it/s, est. speed input: 9533.75 toks/s, output: 9.31 toks/s]
Processed prompts:  27%|██▋       | 1122/4096 [02:01<06:02,  8.21it/s, est. speed input: 9491.55 toks/s, output: 9.27 toks/s]
Processed prompts:  28%|██▊       | 1154/4096 [02:05<06:00,  8.17it/s, est. speed input: 9452.16 toks/s, output: 9.23 toks/s]
Processed prompts:  29%|██▉       | 1186/4096 [02:08<05:57,  8.14it/s, est. speed input: 9415.36 toks/s, output: 9.19 toks/s]
Processed prompts:  30%|██▉       | 1218/4096 [02:11<05:16,  9.08it/s, est. speed input: 9480.60 toks/s, output: 9.26 toks/s]
Processed prompts:  31%|███       | 1250/4096 [02:15<05:24,  8.76it/s, est. speed input: 9445.68 toks/s, output: 9.22 toks/s]
Processed prompts:  31%|███▏      | 1282/4096 [02:19<05:29,  8.54it/s, est. speed input: 9412.43 toks/s, output: 9.19 toks/s]
Processed prompts:  32%|███▏      | 1314/4096 [02:23<05:32,  8.38it/s, est. speed input: 9379.04 toks/s, output: 9.16 toks/s]
Processed prompts:  33%|███▎      | 1346/4096 [02:27<05:32,  8.27it/s, est. speed input: 9347.60 toks/s, output: 9.13 toks/s]
Processed prompts:  34%|███▎      | 1378/4096 [02:31<05:31,  8.20it/s, est. speed input: 9318.70 toks/s, output: 9.10 toks/s]
Processed prompts:  34%|███▍      | 1410/4096 [02:35<05:29,  8.16it/s, est. speed input: 9291.30 toks/s, output: 9.07 toks/s]
Processed prompts:  35%|███▌      | 1442/4096 [02:39<05:26,  8.13it/s, est. speed input: 9265.57 toks/s, output: 9.05 toks/s]
Processed prompts:  36%|███▌      | 1474/4096 [02:41<04:48,  9.09it/s, est. speed input: 9322.19 toks/s, output: 9.10 toks/s]
Processed prompts:  37%|███▋      | 1506/4096 [02:45<04:55,  8.76it/s, est. speed input: 9296.62 toks/s, output: 9.08 toks/s]
Processed prompts:  38%|███▊      | 1538/4096 [02:49<04:59,  8.53it/s, est. speed input: 9272.23 toks/s, output: 9.05 toks/s]
Processed prompts:  38%|███▊      | 1570/4096 [02:53<05:01,  8.39it/s, est. speed input: 9249.02 toks/s, output: 9.03 toks/s]
Processed prompts:  39%|███▉      | 1602/4096 [02:57<04:56,  8.42it/s, est. speed input: 9237.39 toks/s, output: 9.02 toks/s]
Processed prompts:  40%|███▉      | 1634/4096 [03:01<04:56,  8.31it/s, est. speed input: 9215.95 toks/s, output: 9.00 toks/s]
Processed prompts:  41%|████      | 1666/4096 [03:05<04:55,  8.23it/s, est. speed input: 9195.42 toks/s, output: 8.98 toks/s]
Processed prompts:  41%|████▏     | 1698/4096 [03:09<04:53,  8.18it/s, est. speed input: 9175.76 toks/s, output: 8.96 toks/s]
Processed prompts:  42%|████▏     | 1730/4096 [03:12<04:18,  9.15it/s, est. speed input: 9225.56 toks/s, output: 9.01 toks/s]
Processed prompts:  43%|████▎     | 1762/4096 [03:15<04:25,  8.80it/s, est. speed input: 9205.94 toks/s, output: 8.99 toks/s]
Processed prompts:  44%|████▍     | 1794/4096 [03:19<04:28,  8.56it/s, est. speed input: 9187.08 toks/s, output: 8.97 toks/s]
Processed prompts:  45%|████▍     | 1826/4096 [03:23<04:30,  8.41it/s, est. speed input: 9168.93 toks/s, output: 8.95 toks/s]
Processed prompts:  45%|████▌     | 1858/4096 [03:27<04:29,  8.30it/s, est. speed input: 9151.51 toks/s, output: 8.94 toks/s]
Processed prompts:  46%|████▌     | 1890/4096 [03:31<04:28,  8.23it/s, est. speed input: 9134.79 toks/s, output: 8.92 toks/s]
Processed prompts:  47%|████▋     | 1922/4096 [03:35<04:25,  8.18it/s, est. speed input: 9118.56 toks/s, output: 8.90 toks/s]
Processed prompts:  48%|████▊     | 1954/4096 [03:39<04:23,  8.14it/s, est. speed input: 9102.98 toks/s, output: 8.89 toks/s]
Processed prompts:  48%|████▊     | 1986/4096 [03:42<03:53,  9.05it/s, est. speed input: 9143.23 toks/s, output: 8.93 toks/s]
Processed prompts:  49%|████▉     | 2018/4096 [03:46<03:58,  8.73it/s, est. speed input: 9127.68 toks/s, output: 8.91 toks/s]
Processed prompts:  50%|█████     | 2050/4096 [03:50<04:00,  8.52it/s, est. speed input: 9112.65 toks/s, output: 8.90 toks/s]
Processed prompts:  51%|█████     | 2082/4096 [03:54<04:00,  8.38it/s, est. speed input: 9098.13 toks/s, output: 8.88 toks/s]
Processed prompts:  52%|█████▏    | 2114/4096 [03:58<03:59,  8.28it/s, est. speed input: 9084.11 toks/s, output: 8.87 toks/s]
Processed prompts:  52%|█████▏    | 2146/4096 [04:02<03:57,  8.21it/s, est. speed input: 9070.55 toks/s, output: 8.86 toks/s]
Processed prompts:  53%|█████▎    | 2178/4096 [04:06<03:51,  8.30it/s, est. speed input: 9064.86 toks/s, output: 8.85 toks/s]
Processed prompts:  54%|█████▍    | 2210/4096 [04:10<03:49,  8.22it/s, est. speed input: 9052.03 toks/s, output: 8.84 toks/s]
Processed prompts:  55%|█████▍    | 2242/4096 [04:13<03:46,  8.18it/s, est. speed input: 9039.59 toks/s, output: 8.83 toks/s]
Processed prompts:  56%|█████▌    | 2274/4096 [04:16<03:19,  9.11it/s, est. speed input: 9076.69 toks/s, output: 8.86 toks/s]
Processed prompts:  56%|█████▋    | 2306/4096 [04:20<03:24,  8.77it/s, est. speed input: 9064.20 toks/s, output: 8.85 toks/s]
Processed prompts:  57%|█████▋    | 2338/4096 [04:24<03:25,  8.55it/s, est. speed input: 9052.08 toks/s, output: 8.84 toks/s]
Processed prompts:  58%|█████▊    | 2370/4096 [04:28<03:25,  8.39it/s, est. speed input: 9040.31 toks/s, output: 8.83 toks/s]
Processed prompts:  59%|█████▊    | 2402/4096 [04:32<03:24,  8.29it/s, est. speed input: 9028.87 toks/s, output: 8.82 toks/s]
Processed prompts:  59%|█████▉    | 2434/4096 [04:36<03:22,  8.22it/s, est. speed input: 9017.78 toks/s, output: 8.81 toks/s]
Processed prompts:  60%|██████    | 2466/4096 [04:40<03:19,  8.17it/s, est. speed input: 9006.99 toks/s, output: 8.80 toks/s]
Processed prompts:  61%|██████    | 2498/4096 [04:44<03:16,  8.14it/s, est. speed input: 8996.52 toks/s, output: 8.79 toks/s]
Processed prompts:  62%|██████▏   | 2530/4096 [04:46<02:52,  9.08it/s, est. speed input: 9030.05 toks/s, output: 8.82 toks/s]
Processed prompts:  63%|██████▎   | 2562/4096 [04:50<02:55,  8.75it/s, est. speed input: 9019.51 toks/s, output: 8.81 toks/s]
Processed prompts:  63%|██████▎   | 2594/4096 [04:54<02:56,  8.53it/s, est. speed input: 9009.23 toks/s, output: 8.80 toks/s]
Processed prompts:  64%|██████▍   | 2626/4096 [04:58<02:55,  8.39it/s, est. speed input: 8999.22 toks/s, output: 8.79 toks/s]
Processed prompts:  65%|██████▍   | 2658/4096 [05:02<02:53,  8.29it/s, est. speed input: 8989.49 toks/s, output: 8.78 toks/s]
Processed prompts:  66%|██████▌   | 2690/4096 [05:06<02:51,  8.22it/s, est. speed input: 8980.03 toks/s, output: 8.77 toks/s]
Processed prompts:  66%|██████▋   | 2722/4096 [05:10<02:48,  8.17it/s, est. speed input: 8970.86 toks/s, output: 8.76 toks/s]
Processed prompts:  67%|██████▋   | 2754/4096 [05:14<02:44,  8.14it/s, est. speed input: 8961.82 toks/s, output: 8.75 toks/s]
Processed prompts:  68%|██████▊   | 2786/4096 [05:17<02:24,  9.08it/s, est. speed input: 8992.34 toks/s, output: 8.78 toks/s]
Processed prompts:  69%|██████▉   | 2818/4096 [05:21<02:26,  8.75it/s, est. speed input: 8983.29 toks/s, output: 8.77 toks/s]
Processed prompts:  70%|██████▉   | 2850/4096 [05:25<02:26,  8.53it/s, est. speed input: 8974.42 toks/s, output: 8.76 toks/s]
Processed prompts:  70%|███████   | 2882/4096 [05:29<02:24,  8.38it/s, est. speed input: 8965.74 toks/s, output: 8.76 toks/s]
Processed prompts:  71%|███████   | 2914/4096 [05:33<02:22,  8.29it/s, est. speed input: 8957.28 toks/s, output: 8.75 toks/s]
Processed prompts:  72%|███████▏  | 2946/4096 [05:37<02:19,  8.22it/s, est. speed input: 8949.02 toks/s, output: 8.74 toks/s]
Processed prompts:  73%|███████▎  | 2978/4096 [05:41<02:16,  8.17it/s, est. speed input: 8940.95 toks/s, output: 8.73 toks/s]
Processed prompts:  73%|███████▎  | 3010/4096 [05:45<02:13,  8.14it/s, est. speed input: 8933.06 toks/s, output: 8.72 toks/s]
Processed prompts:  74%|███████▍  | 3042/4096 [05:47<01:56,  9.08it/s, est. speed input: 8961.24 toks/s, output: 8.75 toks/s]
Processed prompts:  75%|███████▌  | 3074/4096 [05:51<01:56,  8.75it/s, est. speed input: 8953.38 toks/s, output: 8.74 toks/s]
Processed prompts:  76%|███████▌  | 3106/4096 [05:55<01:55,  8.54it/s, est. speed input: 8945.68 toks/s, output: 8.74 toks/s]
Processed prompts:  77%|███████▋  | 3138/4096 [05:59<01:54,  8.39it/s, est. speed input: 8938.00 toks/s, output: 8.73 toks/s]
Processed prompts:  77%|███████▋  | 3170/4096 [06:03<01:51,  8.28it/s, est. speed input: 8930.50 toks/s, output: 8.72 toks/s]
Processed prompts:  78%|███████▊  | 3202/4096 [06:07<01:48,  8.21it/s, est. speed input: 8923.10 toks/s, output: 8.71 toks/s]
Processed prompts:  79%|███████▉  | 3234/4096 [06:11<01:45,  8.16it/s, est. speed input: 8915.84 toks/s, output: 8.71 toks/s]
Processed prompts:  80%|███████▉  | 3266/4096 [06:15<01:42,  8.13it/s, est. speed input: 8908.82 toks/s, output: 8.70 toks/s]
Processed prompts:  81%|████████  | 3298/4096 [06:17<01:27,  9.08it/s, est. speed input: 8935.05 toks/s, output: 8.73 toks/s]
Processed prompts:  81%|████████▏ | 3330/4096 [06:21<01:27,  8.75it/s, est. speed input: 8928.17 toks/s, output: 8.72 toks/s]
Processed prompts:  82%|████████▏ | 3362/4096 [06:25<01:25,  8.54it/s, est. speed input: 8921.59 toks/s, output: 8.71 toks/s]
Processed prompts:  83%|████████▎ | 3394/4096 [06:29<01:23,  8.39it/s, est. speed input: 8914.73 toks/s, output: 8.71 toks/s]
Processed prompts:  84%|████████▎ | 3426/4096 [06:33<01:20,  8.28it/s, est. speed input: 8907.62 toks/s, output: 8.70 toks/s]
Processed prompts:  84%|████████▍ | 3458/4096 [06:37<01:17,  8.20it/s, est. speed input: 8900.83 toks/s, output: 8.69 toks/s]
Processed prompts:  85%|████████▌ | 3490/4096 [06:41<01:14,  8.16it/s, est. speed input: 8894.35 toks/s, output: 8.69 toks/s]
Processed prompts:  86%|████████▌ | 3522/4096 [06:45<01:10,  8.13it/s, est. speed input: 8888.06 toks/s, output: 8.68 toks/s]
Processed prompts:  87%|████████▋ | 3554/4096 [06:49<01:06,  8.11it/s, est. speed input: 8881.95 toks/s, output: 8.67 toks/s]
Processed prompts:  88%|████████▊ | 3586/4096 [06:52<00:56,  9.07it/s, est. speed input: 8906.53 toks/s, output: 8.70 toks/s]
Processed prompts:  88%|████████▊ | 3618/4096 [06:56<00:54,  8.74it/s, est. speed input: 8900.31 toks/s, output: 8.69 toks/s]
Processed prompts:  89%|████████▉ | 3650/4096 [07:00<00:52,  8.53it/s, est. speed input: 8894.20 toks/s, output: 8.69 toks/s]
Processed prompts:  90%|████████▉ | 3682/4096 [07:03<00:48,  8.52it/s, est. speed input: 8892.50 toks/s, output: 8.68 toks/s]
Processed prompts:  91%|█████████ | 3714/4096 [07:07<00:45,  8.38it/s, est. speed input: 8886.61 toks/s, output: 8.68 toks/s]
Processed prompts:  91%|█████████▏| 3746/4096 [07:11<00:42,  8.28it/s, est. speed input: 8880.82 toks/s, output: 8.67 toks/s]
Processed prompts:  92%|█████████▏| 3778/4096 [07:15<00:38,  8.21it/s, est. speed input: 8875.13 toks/s, output: 8.67 toks/s]
Processed prompts:  93%|█████████▎| 3810/4096 [07:19<00:35,  8.17it/s, est. speed input: 8869.56 toks/s, output: 8.66 toks/s]
Processed prompts:  94%|█████████▍| 3842/4096 [07:22<00:27,  9.11it/s, est. speed input: 8892.06 toks/s, output: 8.68 toks/s]
Processed prompts:  95%|█████████▍| 3874/4096 [07:26<00:25,  8.77it/s, est. speed input: 8886.41 toks/s, output: 8.68 toks/s]
Processed prompts:  95%|█████████▌| 3906/4096 [07:30<00:21,  8.68it/s, est. speed input: 8884.86 toks/s, output: 8.68 toks/s]
Processed prompts:  96%|█████████▌| 3938/4096 [07:34<00:18,  8.49it/s, est. speed input: 8879.35 toks/s, output: 8.67 toks/s]
Processed prompts:  97%|█████████▋| 3970/4096 [07:38<00:15,  8.35it/s, est. speed input: 8873.93 toks/s, output: 8.67 toks/s]
Processed prompts:  98%|█████████▊| 4002/4096 [07:42<00:11,  8.26it/s, est. speed input: 8868.62 toks/s, output: 8.66 toks/s]
Processed prompts:  98%|█████████▊| 4034/4096 [07:46<00:07,  8.20it/s, est. speed input: 8863.39 toks/s, output: 8.66 toks/s]
Processed prompts:  99%|█████████▉| 4066/4096 [07:49<00:03,  8.30it/s, est. speed input: 8862.29 toks/s, output: 8.65 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [07:49<00:00,  8.30it/s, est. speed input: 8927.67 toks/s, output: 8.72 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [07:49<00:00,  8.72it/s, est. speed input: 8927.67 toks/s, output: 8.72 toks/s]
[rank0]:[W126 03:56:06.963135057 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=65536 ==========
Time: 2026-01-26 03:56:08
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-FP8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=8192, max_num_seqs=64
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-FP8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 8192 --max-num-seqs 64 --max-model-len 1025 --max-num-batched-tokens 65536 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_4/json/Qwen2.5-7B-FP8_M65536.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 03:57:12 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 03:57:13 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=145404) WARNING 01-26 03:57:28 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=145404) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=145404) WARNING 01-26 03:57:40 [backends.py:609] Failed to read file <frozen os>
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 240, in _initialize_kv_caches
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     available_gpu_memory = self.model_executor.determine_available_memory()
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return self.collective_rpc("determine_available_memory")
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     result = run_method(self.driver_worker, method, args, kwargs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/root/vllmbench/vllm/v1/serial_utils.py", line 461, in run_method
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 340, in determine_available_memory
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     self.model_runner.profile_run()
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4474, in profile_run
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     hidden_states, last_hidden_states = self._dummy_run(
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]                                         ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4198, in _dummy_run
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     outputs = self.model(
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]               ^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 583, in forward
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     hidden_states = self.model(
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]                     ^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/root/vllmbench/vllm/compilation/decorators.py", line 526, in __call__
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/root/vllmbench/vllm/compilation/wrapper.py", line 218, in __call__
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return self._call_with_optional_nvtx_range(
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/root/vllmbench/vllm/compilation/wrapper.py", line 109, in _call_with_optional_nvtx_range
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return callable_fn(*args, **kwargs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 832, in compile_wrapper
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return fn(*args, **kwargs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 418, in forward
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     def forward(
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return fn(*args, **kwargs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/root/vllmbench/vllm/compilation/caching.py", line 54, in __call__
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return self.optimized_call(*args, **kwargs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 837, in call_wrapped
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return self._wrapped_call(self, *args, **kwargs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 413, in __call__
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     raise e
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 400, in __call__
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return super(self.cls, obj).__call__(*args, **kwargs)  # type: ignore[misc]
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "<eval_with_key>.58", line 325, in forward
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     submod_2 = self.submod_2(getitem_3, s72, l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_scale_, l_self_modules_layers_modules_0_modules_post_attention_layernorm_parameters_weight_, getitem_4, l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_scale_, l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_input_layernorm_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_bias_, l_positions_, l_self_modules_layers_modules_0_modules_self_attn_modules_rotary_emb_buffers_cos_sin_cache_);  getitem_3 = l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_scale_ = l_self_modules_layers_modules_0_modules_post_attention_layernorm_parameters_weight_ = getitem_4 = l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_scale_ = l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_input_layernorm_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_bias_ = None
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/root/vllmbench/vllm/compilation/piecewise_backend.py", line 178, in __call__
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return range_entry.runnable(*args)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/standalone_compile.py", line 63, in __call__
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return self._compiled_fn(*args)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return fn(*args, **kwargs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/aot_autograd.py", line 1130, in forward
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return compiled_fn(full_args)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 353, in runtime_wrapper
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     all_outs = call_func_at_runtime_with_args(
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/utils.py", line 129, in call_func_at_runtime_with_args
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     out = normalize_as_list(f(args))
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]                             ^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 724, in inner_fn
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     outs = compiled_fn(args)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 526, in wrapper
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return compiled_fn(runtime_args)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/output_code.py", line 613, in __call__
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return self.current_callable(inputs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/utils.py", line 2962, in run
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     out = model(new_inputs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]           ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/tmp/torchinductor_root/er/cerxfft23ekfx6urztnyltnj2ahvt5cw3kazwxmy6hk2wvowuoet.py", line 1090, in call
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     triton_poi_fused_mul_quant_slide_fp8_silu_slice_1.run(buf15, buf16, triton_poi_fused_mul_quant_slide_fp8_silu_slice_1_xnumel, stream=stream0)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 1272, in run
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     self.autotune_to_one_config(*args, **kwargs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 1048, in autotune_to_one_config
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     timings = self.benchmark_all_configs(*args, **kwargs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 1023, in benchmark_all_configs
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     launcher: self.bench(launcher, *args, **kwargs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 891, in bench
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return benchmarker.benchmark_gpu(kernel_call, rep=40)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/benchmarking.py", line 39, in wrapper
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return fn(self, *args, **kwargs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/benchmarking.py", line 247, in benchmark_gpu
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     torch.cuda.synchronize()
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py", line 1083, in synchronize
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return torch._C._cuda_synchronize()
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866] torch.AcceleratorError: CUDA error: an illegal memory access was encountered
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866] Search for `cudaErrorIllegalAddress' in https://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__TYPES.html for more information.
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866] CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866] For debugging consider passing CUDA_LAUNCH_BLOCKING=1
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866] Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866] 

STDERR:
[2026-01-26 03:57:12] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:57:12] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:57:12] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:57:12] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:57:12] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:57:12] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:57:12] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:57:12] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:57:12] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:57:12] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:57:12] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:57:12] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:57:12] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:57:12] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 03:57:20] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:57:20] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:57:20] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:57:20] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:57:20] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:57:20] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:57:20] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:57:20] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:57:20] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:57:20] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:57:20] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:57:20] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:57:20] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:57:20] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[W126 03:57:28.013024573 socket.cpp:209] [c10d] The hostname of the client socket cannot be retrieved. err=-3
(EngineCore_DP0 pid=145404) [2026-01-26 03:57:29] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=145404) [2026-01-26 03:57:29] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=145404) [2026-01-26 03:57:29] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=145404) [2026-01-26 03:57:29] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=145404) [2026-01-26 03:57:29] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=145404) [2026-01-26 03:57:29] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=145404) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=145404) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.40it/s]
(EngineCore_DP0 pid=145404) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.16it/s]
(EngineCore_DP0 pid=145404) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.19it/s]
(EngineCore_DP0 pid=145404) 
(EngineCore_DP0 pid=145404) [2026-01-26 03:57:31] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 3584] -> 1D uint8
(EngineCore_DP0 pid=145404) [2026-01-26 03:57:31] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12386304 bytes
(EngineCore_DP0 pid=145404) [2026-01-26 03:57:31] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 3584] -> 1D uint8
(EngineCore_DP0 pid=145404) [2026-01-26 03:57:31] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 9633792 bytes
(EngineCore_DP0 pid=145404) [2026-01-26 03:57:31] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 3584] -> 1D uint8
(EngineCore_DP0 pid=145404) [2026-01-26 03:57:31] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 101842944 bytes
(EngineCore_DP0 pid=145404) [2026-01-26 03:57:31] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 18944] -> 1D uint8
(EngineCore_DP0 pid=145404) [2026-01-26 03:57:31] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 50921472 bytes
(EngineCore_DP0 pid=145404) [rank0]:W0126 03:57:47.642000 145404 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=145404) [rank0]:W0126 03:57:47.754000 145404 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=145404) [rank0]:W0126 03:57:49.400000 145404 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=145404) [rank0]:W0126 03:57:49.571000 145404 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=145404) Process EngineCore_DP0:
(EngineCore_DP0 pid=145404) Traceback (most recent call last):
(EngineCore_DP0 pid=145404)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=145404)     self.run()
(EngineCore_DP0 pid=145404)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=145404)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=145404)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=145404)     raise e
(EngineCore_DP0 pid=145404)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=145404)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=145404)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=145404)     super().__init__(
(EngineCore_DP0 pid=145404)   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=145404)     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=145404)                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/root/vllmbench/vllm/v1/engine/core.py", line 240, in _initialize_kv_caches
(EngineCore_DP0 pid=145404)     available_gpu_memory = self.model_executor.determine_available_memory()
(EngineCore_DP0 pid=145404)                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
(EngineCore_DP0 pid=145404)     return self.collective_rpc("determine_available_memory")
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
(EngineCore_DP0 pid=145404)     result = run_method(self.driver_worker, method, args, kwargs)
(EngineCore_DP0 pid=145404)              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/root/vllmbench/vllm/v1/serial_utils.py", line 461, in run_method
(EngineCore_DP0 pid=145404)     return func(*args, **kwargs)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=145404)     return func(*args, **kwargs)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 340, in determine_available_memory
(EngineCore_DP0 pid=145404)     self.model_runner.profile_run()
(EngineCore_DP0 pid=145404)   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4474, in profile_run
(EngineCore_DP0 pid=145404)     hidden_states, last_hidden_states = self._dummy_run(
(EngineCore_DP0 pid=145404)                                         ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=145404)     return func(*args, **kwargs)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4198, in _dummy_run
(EngineCore_DP0 pid=145404)     outputs = self.model(
(EngineCore_DP0 pid=145404)               ^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=145404)     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=145404)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=145404)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 583, in forward
(EngineCore_DP0 pid=145404)     hidden_states = self.model(
(EngineCore_DP0 pid=145404)                     ^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/root/vllmbench/vllm/compilation/decorators.py", line 526, in __call__
(EngineCore_DP0 pid=145404)     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
(EngineCore_DP0 pid=145404)              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/root/vllmbench/vllm/compilation/wrapper.py", line 218, in __call__
(EngineCore_DP0 pid=145404)     return self._call_with_optional_nvtx_range(
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/root/vllmbench/vllm/compilation/wrapper.py", line 109, in _call_with_optional_nvtx_range
(EngineCore_DP0 pid=145404)     return callable_fn(*args, **kwargs)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 832, in compile_wrapper
(EngineCore_DP0 pid=145404)     return fn(*args, **kwargs)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 418, in forward
(EngineCore_DP0 pid=145404)     def forward(
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=145404)     return fn(*args, **kwargs)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/root/vllmbench/vllm/compilation/caching.py", line 54, in __call__
(EngineCore_DP0 pid=145404)     return self.optimized_call(*args, **kwargs)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 837, in call_wrapped
(EngineCore_DP0 pid=145404)     return self._wrapped_call(self, *args, **kwargs)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 413, in __call__
(EngineCore_DP0 pid=145404)     raise e
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 400, in __call__
(EngineCore_DP0 pid=145404)     return super(self.cls, obj).__call__(*args, **kwargs)  # type: ignore[misc]
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=145404)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=145404)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "<eval_with_key>.58", line 325, in forward
(EngineCore_DP0 pid=145404)     submod_2 = self.submod_2(getitem_3, s72, l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_scale_, l_self_modules_layers_modules_0_modules_post_attention_layernorm_parameters_weight_, getitem_4, l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_scale_, l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_input_layernorm_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_bias_, l_positions_, l_self_modules_layers_modules_0_modules_self_attn_modules_rotary_emb_buffers_cos_sin_cache_);  getitem_3 = l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_scale_ = l_self_modules_layers_modules_0_modules_post_attention_layernorm_parameters_weight_ = getitem_4 = l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_scale_ = l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_input_layernorm_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_bias_ = None
(EngineCore_DP0 pid=145404)                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=145404)     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/root/vllmbench/vllm/compilation/piecewise_backend.py", line 178, in __call__
(EngineCore_DP0 pid=145404)     return range_entry.runnable(*args)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/standalone_compile.py", line 63, in __call__
(EngineCore_DP0 pid=145404)     return self._compiled_fn(*args)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=145404)     return fn(*args, **kwargs)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/aot_autograd.py", line 1130, in forward
(EngineCore_DP0 pid=145404)     return compiled_fn(full_args)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 353, in runtime_wrapper
(EngineCore_DP0 pid=145404)     all_outs = call_func_at_runtime_with_args(
(EngineCore_DP0 pid=145404)                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/utils.py", line 129, in call_func_at_runtime_with_args
(EngineCore_DP0 pid=145404)     out = normalize_as_list(f(args))
(EngineCore_DP0 pid=145404)                             ^^^^^^^
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 724, in inner_fn
(EngineCore_DP0 pid=145404)     outs = compiled_fn(args)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 526, in wrapper
(EngineCore_DP0 pid=145404)     return compiled_fn(runtime_args)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/output_code.py", line 613, in __call__
(EngineCore_DP0 pid=145404)     return self.current_callable(inputs)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/utils.py", line 2962, in run
(EngineCore_DP0 pid=145404)     out = model(new_inputs)
(EngineCore_DP0 pid=145404)           ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/tmp/torchinductor_root/er/cerxfft23ekfx6urztnyltnj2ahvt5cw3kazwxmy6hk2wvowuoet.py", line 1090, in call
(EngineCore_DP0 pid=145404)     triton_poi_fused_mul_quant_slide_fp8_silu_slice_1.run(buf15, buf16, triton_poi_fused_mul_quant_slide_fp8_silu_slice_1_xnumel, stream=stream0)
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 1272, in run
(EngineCore_DP0 pid=145404)     self.autotune_to_one_config(*args, **kwargs)
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 1048, in autotune_to_one_config
(EngineCore_DP0 pid=145404)     timings = self.benchmark_all_configs(*args, **kwargs)
(EngineCore_DP0 pid=145404)               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 1023, in benchmark_all_configs
(EngineCore_DP0 pid=145404)     launcher: self.bench(launcher, *args, **kwargs)
(EngineCore_DP0 pid=145404)               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 891, in bench
(EngineCore_DP0 pid=145404)     return benchmarker.benchmark_gpu(kernel_call, rep=40)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/benchmarking.py", line 39, in wrapper
(EngineCore_DP0 pid=145404)     return fn(self, *args, **kwargs)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/benchmarking.py", line 247, in benchmark_gpu
(EngineCore_DP0 pid=145404)     torch.cuda.synchronize()
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py", line 1083, in synchronize
(EngineCore_DP0 pid=145404)     return torch._C._cuda_synchronize()
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) torch.AcceleratorError: CUDA error: an illegal memory access was encountered
(EngineCore_DP0 pid=145404) Search for `cudaErrorIllegalAddress' in https://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__TYPES.html for more information.
(EngineCore_DP0 pid=145404) CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
(EngineCore_DP0 pid=145404) For debugging consider passing CUDA_LAUNCH_BLOCKING=1
(EngineCore_DP0 pid=145404) Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
(EngineCore_DP0 pid=145404) 
[rank0]:[W126 03:57:51.404367742 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

ERROR: Test failed for M=65536

========== M=512 ==========
Time: 2026-01-26 07:18:48
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-FP8-SlideSparse-2_4
Params: prompt_len=512, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-FP8-SlideSparse-2_4 --dataset-name random --input-len 512 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 513 --max-num-batched-tokens 513 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_4/json/Qwen2.5-14B-FP8_M512.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 07:18:56 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 07:18:57 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=337113) WARNING 01-26 07:19:05 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=337113) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=337113) WARNING 01-26 07:19:33 [backends.py:609] Failed to read file <frozen os>
Throughput: 9.20 requests/s, 4717.39 total tokens/s, 9.20 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128

STDERR:
[2026-01-26 07:18:56] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 07:18:56] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-FP8'
[2026-01-26 07:18:56] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-FP8
[2026-01-26 07:18:56] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:18:56] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:18:56] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:18:56] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:18:56] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:18:56] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-FP8'
[2026-01-26 07:18:56] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 07:18:56] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 07:18:56] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 07:18:56] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 07:18:56] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 07:19:04] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 07:19:04] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-FP8'
[2026-01-26 07:19:04] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-FP8
[2026-01-26 07:19:04] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:19:04] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:19:04] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:19:04] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:19:04] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:19:04] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-FP8'
[2026-01-26 07:19:04] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 07:19:04] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 07:19:04] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 07:19:04] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 07:19:04] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=337113) [2026-01-26 07:19:06] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=337113) [2026-01-26 07:19:06] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=337113) [2026-01-26 07:19:06] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=337113) [2026-01-26 07:19:06] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=337113) [2026-01-26 07:19:06] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-14B-FP8
(EngineCore_DP0 pid=337113) [2026-01-26 07:19:06] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=337113) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=337113) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:03<00:11,  3.80s/it]
(EngineCore_DP0 pid=337113) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:06<00:06,  3.01s/it]
(EngineCore_DP0 pid=337113) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:07<00:02,  2.19s/it]
(EngineCore_DP0 pid=337113) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:11<00:00,  2.75s/it]
(EngineCore_DP0 pid=337113) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:11<00:00,  2.77s/it]
(EngineCore_DP0 pid=337113) 
(EngineCore_DP0 pid=337113) [2026-01-26 07:19:18] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [7168, 5120] -> 1D uint8
(EngineCore_DP0 pid=337113) [2026-01-26 07:19:19] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 27525120 bytes
(EngineCore_DP0 pid=337113) [2026-01-26 07:19:19] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 5120] -> 1D uint8
(EngineCore_DP0 pid=337113) [2026-01-26 07:19:19] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 19660800 bytes
(EngineCore_DP0 pid=337113) [2026-01-26 07:19:19] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [27648, 5120] -> 1D uint8
(EngineCore_DP0 pid=337113) [2026-01-26 07:19:19] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 106168320 bytes
(EngineCore_DP0 pid=337113) [2026-01-26 07:19:19] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 13824] -> 1D uint8
(EngineCore_DP0 pid=337113) [2026-01-26 07:19:19] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 53084160 bytes
(EngineCore_DP0 pid=337113) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  1.89it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:01<00:00,  1.74it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:01<00:00,  1.76it/s]
(EngineCore_DP0 pid=337113) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  4.87it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  4.86it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  33%|███▎      | 42/128 [00:00<00:00, 411.90it/s]
Adding requests:  69%|██████▉   | 88/128 [00:00<00:00, 439.76it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 445.23it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<01:01,  2.05it/s, est. speed input: 1050.77 toks/s, output: 2.05 toks/s]
Processed prompts:   2%|▏         | 2/128 [00:00<00:33,  3.79it/s, est. speed input: 1723.35 toks/s, output: 3.37 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:23,  5.22it/s, est. speed input: 2193.89 toks/s, output: 4.28 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:19,  6.36it/s, est. speed input: 2544.15 toks/s, output: 4.97 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:16,  7.28it/s, est. speed input: 2823.25 toks/s, output: 5.51 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:01<00:14,  8.44it/s, est. speed input: 3236.91 toks/s, output: 6.32 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:01<00:13,  9.01it/s, est. speed input: 3521.04 toks/s, output: 6.88 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:01<00:12,  9.19it/s, est. speed input: 3631.44 toks/s, output: 7.09 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:01<00:12,  9.35it/s, est. speed input: 3726.39 toks/s, output: 7.28 toks/s]
Processed prompts:  10%|█         | 13/128 [00:01<00:11,  9.59it/s, est. speed input: 3887.32 toks/s, output: 7.59 toks/s]
Processed prompts:  11%|█         | 14/128 [00:01<00:11,  9.65it/s, est. speed input: 3952.14 toks/s, output: 7.72 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:01<00:11,  9.72it/s, est. speed input: 4012.08 toks/s, output: 7.84 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:02<00:11,  9.79it/s, est. speed input: 4112.12 toks/s, output: 8.03 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:02<00:11,  9.77it/s, est. speed input: 4152.42 toks/s, output: 8.11 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:02<00:11,  9.68it/s, est. speed input: 4182.30 toks/s, output: 8.17 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:02<00:11,  9.63it/s, est. speed input: 4212.16 toks/s, output: 8.23 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:02<00:11,  9.65it/s, est. speed input: 4242.87 toks/s, output: 8.29 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:02<00:11,  9.63it/s, est. speed input: 4269.25 toks/s, output: 8.34 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:02<00:10,  9.60it/s, est. speed input: 4292.06 toks/s, output: 8.38 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:02<00:10,  9.53it/s, est. speed input: 4311.09 toks/s, output: 8.42 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:02<00:10,  9.52it/s, est. speed input: 4330.74 toks/s, output: 8.46 toks/s]
Processed prompts:  20%|██        | 26/128 [00:03<00:10,  9.54it/s, est. speed input: 4350.29 toks/s, output: 8.50 toks/s]
Processed prompts:  21%|██        | 27/128 [00:03<00:10,  9.54it/s, est. speed input: 4367.98 toks/s, output: 8.53 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:03<00:10,  9.47it/s, est. speed input: 4381.05 toks/s, output: 8.56 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:03<00:10,  9.47it/s, est. speed input: 4395.91 toks/s, output: 8.59 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:03<00:10,  9.48it/s, est. speed input: 4410.19 toks/s, output: 8.61 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:03<00:10,  9.52it/s, est. speed input: 4424.69 toks/s, output: 8.64 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:03<00:10,  9.48it/s, est. speed input: 4435.86 toks/s, output: 8.66 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:03<00:09,  9.53it/s, est. speed input: 4449.53 toks/s, output: 8.69 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:03<00:09,  9.58it/s, est. speed input: 4463.43 toks/s, output: 8.72 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:04<00:09,  9.54it/s, est. speed input: 4473.31 toks/s, output: 8.74 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:04<00:09,  9.57it/s, est. speed input: 4484.96 toks/s, output: 8.76 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:04<00:09,  9.59it/s, est. speed input: 4495.93 toks/s, output: 8.78 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:04<00:09,  9.60it/s, est. speed input: 4506.22 toks/s, output: 8.80 toks/s]
Processed prompts:  30%|███       | 39/128 [00:04<00:09,  9.59it/s, est. speed input: 4515.53 toks/s, output: 8.82 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:04<00:09,  9.62it/s, est. speed input: 4525.61 toks/s, output: 8.84 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:04<00:09,  9.63it/s, est. speed input: 4535.02 toks/s, output: 8.86 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:04<00:08,  9.63it/s, est. speed input: 4543.69 toks/s, output: 8.87 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:04<00:08,  9.62it/s, est. speed input: 4551.72 toks/s, output: 8.89 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:04<00:08,  9.62it/s, est. speed input: 4559.49 toks/s, output: 8.91 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:05<00:08,  9.61it/s, est. speed input: 4566.61 toks/s, output: 8.92 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:05<00:08,  9.64it/s, est. speed input: 4574.90 toks/s, output: 8.94 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:05<00:08,  9.67it/s, est. speed input: 4582.79 toks/s, output: 8.95 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:05<00:08,  9.66it/s, est. speed input: 4589.66 toks/s, output: 8.96 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:05<00:08,  9.63it/s, est. speed input: 4595.39 toks/s, output: 8.98 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:05<00:08,  9.62it/s, est. speed input: 4601.57 toks/s, output: 8.99 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:05<00:07,  9.66it/s, est. speed input: 4608.63 toks/s, output: 9.00 toks/s]
Processed prompts:  41%|████      | 52/128 [00:05<00:07,  9.67it/s, est. speed input: 4614.86 toks/s, output: 9.01 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:05<00:07,  9.59it/s, est. speed input: 4618.47 toks/s, output: 9.02 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:05<00:07,  9.57it/s, est. speed input: 4623.00 toks/s, output: 9.03 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:06<00:07,  9.58it/s, est. speed input: 4627.99 toks/s, output: 9.04 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:06<00:07,  9.60it/s, est. speed input: 4633.14 toks/s, output: 9.05 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:06<00:07,  9.60it/s, est. speed input: 4638.02 toks/s, output: 9.06 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:06<00:07,  9.60it/s, est. speed input: 4642.35 toks/s, output: 9.07 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:06<00:07,  9.58it/s, est. speed input: 4646.25 toks/s, output: 9.07 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:06<00:07,  9.58it/s, est. speed input: 4650.27 toks/s, output: 9.08 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:06<00:06,  9.59it/s, est. speed input: 4654.55 toks/s, output: 9.09 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:06<00:06,  9.59it/s, est. speed input: 4658.49 toks/s, output: 9.10 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:06<00:06,  9.59it/s, est. speed input: 4662.33 toks/s, output: 9.11 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:07<00:06,  9.60it/s, est. speed input: 4666.29 toks/s, output: 9.11 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:07<00:06,  9.69it/s, est. speed input: 4672.02 toks/s, output: 9.12 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:07<00:06,  9.70it/s, est. speed input: 4676.43 toks/s, output: 9.13 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:07<00:06,  9.73it/s, est. speed input: 4681.10 toks/s, output: 9.14 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:07<00:06,  9.73it/s, est. speed input: 4685.29 toks/s, output: 9.15 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:07<00:06,  9.69it/s, est. speed input: 4688.36 toks/s, output: 9.16 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:07<00:05,  9.67it/s, est. speed input: 4691.67 toks/s, output: 9.16 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:07<00:05,  9.68it/s, est. speed input: 4695.44 toks/s, output: 9.17 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:07<00:05,  9.69it/s, est. speed input: 4698.92 toks/s, output: 9.18 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:07<00:05,  9.67it/s, est. speed input: 4701.89 toks/s, output: 9.18 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:08<00:05,  9.66it/s, est. speed input: 4704.97 toks/s, output: 9.19 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:08<00:05,  9.68it/s, est. speed input: 4708.42 toks/s, output: 9.20 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:08<00:05,  9.70it/s, est. speed input: 4711.93 toks/s, output: 9.20 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:08<00:05,  9.71it/s, est. speed input: 4715.25 toks/s, output: 9.21 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:08<00:05,  9.66it/s, est. speed input: 4717.42 toks/s, output: 9.21 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:08<00:05,  9.63it/s, est. speed input: 4719.53 toks/s, output: 9.22 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:08<00:04,  9.61it/s, est. speed input: 4721.67 toks/s, output: 9.22 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:08<00:04,  9.60it/s, est. speed input: 4723.82 toks/s, output: 9.23 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:08<00:04,  9.68it/s, est. speed input: 4727.53 toks/s, output: 9.23 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:08<00:04,  9.73it/s, est. speed input: 4731.19 toks/s, output: 9.24 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:09<00:04,  9.75it/s, est. speed input: 4734.31 toks/s, output: 9.25 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:09<00:04,  9.80it/s, est. speed input: 4738.13 toks/s, output: 9.25 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:09<00:04,  9.81it/s, est. speed input: 4741.37 toks/s, output: 9.26 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:09<00:04,  9.85it/s, est. speed input: 4745.04 toks/s, output: 9.27 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:09<00:04,  9.89it/s, est. speed input: 4748.98 toks/s, output: 9.28 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:09<00:03,  9.90it/s, est. speed input: 4752.41 toks/s, output: 9.28 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:09<00:03,  9.87it/s, est. speed input: 4755.27 toks/s, output: 9.29 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:09<00:03,  9.86it/s, est. speed input: 4758.09 toks/s, output: 9.29 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:09<00:03,  9.77it/s, est. speed input: 4759.68 toks/s, output: 9.30 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:10<00:03,  9.69it/s, est. speed input: 4760.78 toks/s, output: 9.30 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:10<00:03,  9.64it/s, est. speed input: 4762.04 toks/s, output: 9.30 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:10<00:03,  9.59it/s, est. speed input: 4762.96 toks/s, output: 9.30 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:10<00:03,  9.60it/s, est. speed input: 4764.56 toks/s, output: 9.31 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:10<00:03,  9.57it/s, est. speed input: 4765.53 toks/s, output: 9.31 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:10<00:03,  9.56it/s, est. speed input: 4766.79 toks/s, output: 9.31 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:10<00:03,  9.59it/s, est. speed input: 4768.50 toks/s, output: 9.31 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:10<00:02,  9.59it/s, est. speed input: 4769.90 toks/s, output: 9.32 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:10<00:02,  9.58it/s, est. speed input: 4771.11 toks/s, output: 9.32 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:10<00:02,  9.64it/s, est. speed input: 4773.34 toks/s, output: 9.32 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:11<00:02,  9.67it/s, est. speed input: 4775.34 toks/s, output: 9.33 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:11<00:02,  9.69it/s, est. speed input: 4777.18 toks/s, output: 9.33 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:11<00:02,  9.68it/s, est. speed input: 4778.72 toks/s, output: 9.33 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:11<00:02,  9.68it/s, est. speed input: 4780.37 toks/s, output: 9.34 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:11<00:02,  9.57it/s, est. speed input: 4780.28 toks/s, output: 9.34 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:11<00:02,  9.60it/s, est. speed input: 4781.89 toks/s, output: 9.34 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:11<00:01,  9.64it/s, est. speed input: 4783.59 toks/s, output: 9.34 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:11<00:01,  9.61it/s, est. speed input: 4784.54 toks/s, output: 9.34 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:11<00:01,  9.62it/s, est. speed input: 4785.84 toks/s, output: 9.35 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:11<00:01,  9.65it/s, est. speed input: 4787.51 toks/s, output: 9.35 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:12<00:01,  9.59it/s, est. speed input: 4787.97 toks/s, output: 9.35 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:12<00:01,  9.60it/s, est. speed input: 4789.19 toks/s, output: 9.35 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:12<00:01,  9.63it/s, est. speed input: 4790.61 toks/s, output: 9.36 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:12<00:01,  9.63it/s, est. speed input: 4791.75 toks/s, output: 9.36 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:12<00:01,  9.63it/s, est. speed input: 4793.01 toks/s, output: 9.36 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:12<00:01,  9.62it/s, est. speed input: 4794.00 toks/s, output: 9.36 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:12<00:00,  9.61it/s, est. speed input: 4794.92 toks/s, output: 9.37 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:12<00:00,  9.61it/s, est. speed input: 4795.92 toks/s, output: 9.37 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:12<00:00,  9.60it/s, est. speed input: 4796.84 toks/s, output: 9.37 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:13<00:00,  9.69it/s, est. speed input: 4798.89 toks/s, output: 9.37 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:13<00:00,  9.75it/s, est. speed input: 4800.97 toks/s, output: 9.38 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:13<00:00,  9.77it/s, est. speed input: 4802.76 toks/s, output: 9.38 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:13<00:00,  9.78it/s, est. speed input: 4804.41 toks/s, output: 9.38 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:13<00:00,  9.73it/s, est. speed input: 4805.28 toks/s, output: 9.39 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:13<00:00,  9.74it/s, est. speed input: 4806.74 toks/s, output: 9.39 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:13<00:00,  9.74it/s, est. speed input: 4808.11 toks/s, output: 9.39 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:13<00:00,  9.74it/s, est. speed input: 4808.11 toks/s, output: 9.39 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:13<00:00,  9.39it/s, est. speed input: 4808.11 toks/s, output: 9.39 toks/s]
[rank0]:[W126 07:20:11.996603128 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=1024 ==========
Time: 2026-01-26 07:20:13
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-FP8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-FP8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 1025 --max-num-batched-tokens 1025 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_4/json/Qwen2.5-14B-FP8_M1024.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 07:20:21 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 07:20:22 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=338656) WARNING 01-26 07:20:30 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=338656) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=338656) WARNING 01-26 07:20:50 [backends.py:609] Failed to read file <frozen os>
Throughput: 9.66 requests/s, 9899.32 total tokens/s, 9.66 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128

STDERR:
[2026-01-26 07:20:21] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 07:20:21] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-FP8'
[2026-01-26 07:20:21] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-FP8
[2026-01-26 07:20:21] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:20:21] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:20:21] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:20:21] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:20:21] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:20:21] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-FP8'
[2026-01-26 07:20:21] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 07:20:21] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 07:20:21] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 07:20:21] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 07:20:21] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 07:20:29] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 07:20:29] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-FP8'
[2026-01-26 07:20:29] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-FP8
[2026-01-26 07:20:29] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:20:29] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:20:29] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:20:29] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:20:29] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:20:29] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-FP8'
[2026-01-26 07:20:29] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 07:20:29] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 07:20:29] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 07:20:29] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 07:20:29] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=338656) [2026-01-26 07:20:31] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=338656) [2026-01-26 07:20:31] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=338656) [2026-01-26 07:20:31] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=338656) [2026-01-26 07:20:31] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=338656) [2026-01-26 07:20:31] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-14B-FP8
(EngineCore_DP0 pid=338656) [2026-01-26 07:20:31] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=338656) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=338656) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:01<00:05,  1.98s/it]
(EngineCore_DP0 pid=338656) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:03<00:03,  1.53s/it]
(EngineCore_DP0 pid=338656) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:03<00:01,  1.10s/it]
(EngineCore_DP0 pid=338656) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.09s/it]
(EngineCore_DP0 pid=338656) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.21s/it]
(EngineCore_DP0 pid=338656) 
(EngineCore_DP0 pid=338656) [2026-01-26 07:20:37] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [7168, 5120] -> 1D uint8
(EngineCore_DP0 pid=338656) [2026-01-26 07:20:37] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 27525120 bytes
(EngineCore_DP0 pid=338656) [2026-01-26 07:20:37] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 5120] -> 1D uint8
(EngineCore_DP0 pid=338656) [2026-01-26 07:20:37] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 19660800 bytes
(EngineCore_DP0 pid=338656) [2026-01-26 07:20:37] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [27648, 5120] -> 1D uint8
(EngineCore_DP0 pid=338656) [2026-01-26 07:20:37] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 106168320 bytes
(EngineCore_DP0 pid=338656) [2026-01-26 07:20:37] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 13824] -> 1D uint8
(EngineCore_DP0 pid=338656) [2026-01-26 07:20:37] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 53084160 bytes
(EngineCore_DP0 pid=338656) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  3.74it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  3.91it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  3.88it/s]
(EngineCore_DP0 pid=338656) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  4.02it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  4.01it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  18%|█▊        | 23/128 [00:00<00:00, 229.21it/s]
Adding requests:  38%|███▊      | 48/128 [00:00<00:00, 235.25it/s]
Adding requests:  58%|█████▊    | 74/128 [00:00<00:00, 246.26it/s]
Adding requests:  78%|███████▊  | 100/128 [00:00<00:00, 249.01it/s]
Adding requests:  98%|█████████▊| 125/128 [00:00<00:00, 241.60it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 239.83it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:05, 20.67it/s, est. speed input: 21169.02 toks/s, output: 20.67 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:09, 13.08it/s, est. speed input: 14298.56 toks/s, output: 13.96 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:00<00:10, 11.80it/s, est. speed input: 13083.19 toks/s, output: 12.78 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:00<00:10, 11.10it/s, est. speed input: 12417.14 toks/s, output: 12.13 toks/s]
Processed prompts:  10%|█         | 13/128 [00:01<00:10, 10.67it/s, est. speed input: 11984.67 toks/s, output: 11.70 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:01<00:10, 10.39it/s, est. speed input: 11687.19 toks/s, output: 11.41 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:01<00:10, 10.23it/s, est. speed input: 11478.77 toks/s, output: 11.21 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:01<00:10, 10.10it/s, est. speed input: 11308.44 toks/s, output: 11.04 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:01<00:10, 10.04it/s, est. speed input: 11184.80 toks/s, output: 10.92 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:02<00:10,  9.96it/s, est. speed input: 11073.28 toks/s, output: 10.81 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:02<00:10,  9.95it/s, est. speed input: 11031.21 toks/s, output: 10.77 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:02<00:10,  9.95it/s, est. speed input: 10994.70 toks/s, output: 10.74 toks/s]
Processed prompts:  20%|██        | 26/128 [00:02<00:10,  9.96it/s, est. speed input: 10963.00 toks/s, output: 10.71 toks/s]
Processed prompts:  21%|██        | 27/128 [00:02<00:10,  9.91it/s, est. speed input: 10924.24 toks/s, output: 10.67 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:02<00:02, 40.47it/s, est. speed input: 16269.47 toks/s, output: 15.89 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:03<00:03, 23.52it/s, est. speed input: 15465.09 toks/s, output: 15.10 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:03<00:04, 18.40it/s, est. speed input: 14981.15 toks/s, output: 14.63 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:03<00:04, 15.51it/s, est. speed input: 14597.70 toks/s, output: 14.26 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:03<00:05, 14.12it/s, est. speed input: 14368.73 toks/s, output: 14.03 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:04<00:05, 13.03it/s, est. speed input: 14164.77 toks/s, output: 13.83 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:04<00:05, 12.19it/s, est. speed input: 13979.91 toks/s, output: 13.65 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:04<00:05, 11.61it/s, est. speed input: 13819.82 toks/s, output: 13.50 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:04<00:05, 11.15it/s, est. speed input: 13668.54 toks/s, output: 13.35 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:04<00:05, 10.78it/s, est. speed input: 13522.16 toks/s, output: 13.21 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:05<00:05, 10.56it/s, est. speed input: 13395.88 toks/s, output: 13.08 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:05<00:05, 10.34it/s, est. speed input: 13267.56 toks/s, output: 12.96 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:05<00:05, 10.21it/s, est. speed input: 13153.82 toks/s, output: 12.85 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:05<00:05, 10.13it/s, est. speed input: 13049.03 toks/s, output: 12.74 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:05<00:05, 10.06it/s, est. speed input: 12949.48 toks/s, output: 12.65 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:06<00:05, 10.02it/s, est. speed input: 12857.93 toks/s, output: 12.56 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:06<00:04,  9.97it/s, est. speed input: 12770.02 toks/s, output: 12.47 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:06<00:04,  9.96it/s, est. speed input: 12728.66 toks/s, output: 12.43 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:06<00:04,  9.96it/s, est. speed input: 12689.27 toks/s, output: 12.39 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:06<00:04,  9.95it/s, est. speed input: 12651.23 toks/s, output: 12.35 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:06<00:04,  9.94it/s, est. speed input: 12613.53 toks/s, output: 12.32 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:06<00:04,  9.80it/s, est. speed input: 12567.65 toks/s, output: 12.27 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:06<00:04,  9.82it/s, est. speed input: 12532.03 toks/s, output: 12.24 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:07<00:04,  9.83it/s, est. speed input: 12496.97 toks/s, output: 12.20 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:07<00:04,  9.91it/s, est. speed input: 12434.83 toks/s, output: 12.14 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:07<00:03,  9.92it/s, est. speed input: 12404.20 toks/s, output: 12.11 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:07<00:03,  9.95it/s, est. speed input: 12346.76 toks/s, output: 12.06 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:07<00:03,  9.99it/s, est. speed input: 12294.36 toks/s, output: 12.01 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:07<00:03,  9.97it/s, est. speed input: 12266.65 toks/s, output: 11.98 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:07<00:03,  9.94it/s, est. speed input: 12238.37 toks/s, output: 11.95 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:08<00:03,  9.91it/s, est. speed input: 12210.57 toks/s, output: 11.92 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:08<00:03,  9.93it/s, est. speed input: 12186.30 toks/s, output: 11.90 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:08<00:03,  9.89it/s, est. speed input: 12159.67 toks/s, output: 11.87 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:08<00:02,  9.89it/s, est. speed input: 12134.83 toks/s, output: 11.85 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:08<00:02,  9.90it/s, est. speed input: 12111.24 toks/s, output: 11.83 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:08<00:02,  9.90it/s, est. speed input: 12087.97 toks/s, output: 11.80 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:08<00:02,  9.91it/s, est. speed input: 12065.95 toks/s, output: 11.78 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:08<00:02,  9.92it/s, est. speed input: 12044.16 toks/s, output: 11.76 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:08<00:02,  9.90it/s, est. speed input: 12021.70 toks/s, output: 11.74 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:08<00:02,  9.87it/s, est. speed input: 11999.34 toks/s, output: 11.72 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:09<00:02,  9.87it/s, est. speed input: 11977.98 toks/s, output: 11.70 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:09<00:02,  9.85it/s, est. speed input: 11956.59 toks/s, output: 11.68 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:09<00:02,  9.83it/s, est. speed input: 11935.13 toks/s, output: 11.66 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:09<00:01,  9.81it/s, est. speed input: 11913.73 toks/s, output: 11.63 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:09<00:01,  9.83it/s, est. speed input: 11894.41 toks/s, output: 11.62 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:09<00:01,  9.83it/s, est. speed input: 11874.93 toks/s, output: 11.60 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:09<00:01,  9.85it/s, est. speed input: 11857.06 toks/s, output: 11.58 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:09<00:01,  9.87it/s, est. speed input: 11839.47 toks/s, output: 11.56 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:09<00:01,  9.89it/s, est. speed input: 11822.39 toks/s, output: 11.55 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:09<00:01,  9.92it/s, est. speed input: 11806.26 toks/s, output: 11.53 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:10<00:01,  9.98it/s, est. speed input: 11777.02 toks/s, output: 11.50 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:10<00:00,  9.98it/s, est. speed input: 11747.05 toks/s, output: 11.47 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:10<00:00,  9.97it/s, est. speed input: 11731.93 toks/s, output: 11.46 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:10<00:00,  9.96it/s, est. speed input: 11716.78 toks/s, output: 11.44 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:10<00:00,  9.92it/s, est. speed input: 11700.67 toks/s, output: 11.43 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:10<00:00,  9.93it/s, est. speed input: 11686.90 toks/s, output: 11.41 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:10<00:00,  9.91it/s, est. speed input: 11657.73 toks/s, output: 11.38 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:11<00:00,  9.90it/s, est. speed input: 11643.86 toks/s, output: 11.37 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:11<00:00,  9.90it/s, est. speed input: 11630.32 toks/s, output: 11.36 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:11<00:00,  9.90it/s, est. speed input: 11618.75 toks/s, output: 11.35 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:11<00:00, 11.35it/s, est. speed input: 11618.75 toks/s, output: 11.35 toks/s]
[rank0]:[W126 07:21:26.852486689 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=2048 ==========
Time: 2026-01-26 07:21:29
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-FP8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=256, max_num_seqs=2
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-FP8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 256 --max-num-seqs 2 --max-model-len 1025 --max-num-batched-tokens 2048 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_4/json/Qwen2.5-14B-FP8_M2048.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 07:21:39 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 07:21:40 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=339992) WARNING 01-26 07:21:48 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=339992) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=339992) WARNING 01-26 07:22:06 [backends.py:609] Failed to read file <frozen os>
Throughput: 12.99 requests/s, 13309.89 total tokens/s, 12.99 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256

STDERR:
[2026-01-26 07:21:39] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 07:21:39] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-FP8'
[2026-01-26 07:21:39] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-FP8
[2026-01-26 07:21:39] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:21:39] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:21:39] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:21:39] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:21:39] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:21:39] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-FP8'
[2026-01-26 07:21:39] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 07:21:39] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 07:21:39] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 07:21:39] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 07:21:39] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 07:21:47] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 07:21:47] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-FP8'
[2026-01-26 07:21:47] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-FP8
[2026-01-26 07:21:47] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:21:47] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:21:47] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:21:47] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:21:47] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:21:47] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-FP8'
[2026-01-26 07:21:47] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 07:21:47] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 07:21:47] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 07:21:47] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 07:21:47] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=339992) [2026-01-26 07:21:48] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=339992) [2026-01-26 07:21:48] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=339992) [2026-01-26 07:21:48] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=339992) [2026-01-26 07:21:48] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=339992) [2026-01-26 07:21:48] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-14B-FP8
(EngineCore_DP0 pid=339992) [2026-01-26 07:21:48] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=339992) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=339992) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:01<00:03,  1.00s/it]
(EngineCore_DP0 pid=339992) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:02<00:02,  1.03s/it]
(EngineCore_DP0 pid=339992) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.35it/s]
(EngineCore_DP0 pid=339992) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.21it/s]
(EngineCore_DP0 pid=339992) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.17it/s]
(EngineCore_DP0 pid=339992) 
(EngineCore_DP0 pid=339992) [2026-01-26 07:21:52] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [7168, 5120] -> 1D uint8
(EngineCore_DP0 pid=339992) [2026-01-26 07:21:52] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 27525120 bytes
(EngineCore_DP0 pid=339992) [2026-01-26 07:21:52] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 5120] -> 1D uint8
(EngineCore_DP0 pid=339992) [2026-01-26 07:21:52] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 19660800 bytes
(EngineCore_DP0 pid=339992) [2026-01-26 07:21:52] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [27648, 5120] -> 1D uint8
(EngineCore_DP0 pid=339992) [2026-01-26 07:21:52] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 106168320 bytes
(EngineCore_DP0 pid=339992) [2026-01-26 07:21:52] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 13824] -> 1D uint8
(EngineCore_DP0 pid=339992) [2026-01-26 07:21:52] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 53084160 bytes
(EngineCore_DP0 pid=339992) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  33%|███▎      | 1/3 [00:00<00:00,  5.01it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  67%|██████▋   | 2/3 [00:00<00:00,  5.19it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00,  4.50it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00,  4.65it/s]
(EngineCore_DP0 pid=339992) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 1/2 [00:00<00:00,  2.23it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  3.22it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  3.02it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:   9%|▉         | 23/256 [00:00<00:01, 227.25it/s]
Adding requests:  19%|█▉        | 49/256 [00:00<00:00, 243.26it/s]
Adding requests:  30%|██▉       | 76/256 [00:00<00:00, 254.35it/s]
Adding requests:  40%|███▉      | 102/256 [00:00<00:00, 239.73it/s]
Adding requests:  50%|████▉     | 127/256 [00:00<00:00, 241.95it/s]
Adding requests:  59%|█████▉    | 152/256 [00:00<00:00, 243.53it/s]
Adding requests:  70%|██████▉   | 178/256 [00:00<00:00, 248.19it/s]
Adding requests:  80%|███████▉  | 204/256 [00:00<00:00, 250.28it/s]
Adding requests:  90%|████████▉ | 230/256 [00:00<00:00, 252.37it/s]
Adding requests: 100%|██████████| 256/256 [00:01<00:00, 247.54it/s]
Adding requests: 100%|██████████| 256/256 [00:01<00:00, 246.45it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▍         | 12/256 [00:00<00:04, 60.34it/s, est. speed input: 61800.76 toks/s, output: 60.35 toks/s]
Processed prompts:   7%|▋         | 19/256 [00:00<00:09, 25.94it/s, est. speed input: 29778.57 toks/s, output: 29.08 toks/s]
Processed prompts:   9%|▉         | 23/256 [00:00<00:11, 20.59it/s, est. speed input: 24643.04 toks/s, output: 24.07 toks/s]
Processed prompts:  10%|█         | 26/256 [00:01<00:13, 16.59it/s, est. speed input: 21173.89 toks/s, output: 20.68 toks/s]
Processed prompts:  11%|█         | 28/256 [00:01<00:14, 15.88it/s, est. speed input: 20356.18 toks/s, output: 19.88 toks/s]
Processed prompts:  12%|█▏        | 30/256 [00:01<00:14, 15.26it/s, est. speed input: 19693.45 toks/s, output: 19.23 toks/s]
Processed prompts:  12%|█▎        | 32/256 [00:01<00:15, 14.76it/s, est. speed input: 19154.36 toks/s, output: 18.71 toks/s]
Processed prompts:  13%|█▎        | 34/256 [00:01<00:15, 14.37it/s, est. speed input: 18701.91 toks/s, output: 18.26 toks/s]
Processed prompts:  14%|█▍        | 36/256 [00:02<00:15, 14.07it/s, est. speed input: 18317.73 toks/s, output: 17.89 toks/s]
Processed prompts:  15%|█▍        | 38/256 [00:02<00:15, 13.83it/s, est. speed input: 17984.57 toks/s, output: 17.56 toks/s]
Processed prompts:  16%|█▌        | 40/256 [00:02<00:15, 13.67it/s, est. speed input: 17696.74 toks/s, output: 17.28 toks/s]
Processed prompts:  16%|█▋        | 42/256 [00:02<00:15, 13.55it/s, est. speed input: 17443.82 toks/s, output: 17.03 toks/s]
Processed prompts:  17%|█▋        | 44/256 [00:02<00:15, 13.44it/s, est. speed input: 17215.67 toks/s, output: 16.81 toks/s]
Processed prompts:  18%|█▊        | 46/256 [00:02<00:15, 13.37it/s, est. speed input: 17014.08 toks/s, output: 16.62 toks/s]
Processed prompts:  19%|█▉        | 48/256 [00:02<00:15, 13.33it/s, est. speed input: 16834.29 toks/s, output: 16.44 toks/s]
Processed prompts:  20%|█▉        | 50/256 [00:03<00:15, 13.30it/s, est. speed input: 16672.21 toks/s, output: 16.28 toks/s]
Processed prompts:  20%|██        | 52/256 [00:03<00:15, 13.28it/s, est. speed input: 16525.61 toks/s, output: 16.14 toks/s]
Processed prompts:  21%|██        | 54/256 [00:03<00:15, 13.26it/s, est. speed input: 16391.68 toks/s, output: 16.01 toks/s]
Processed prompts:  22%|██▏       | 56/256 [00:03<00:15, 13.24it/s, est. speed input: 16266.77 toks/s, output: 15.89 toks/s]
Processed prompts:  23%|██▎       | 58/256 [00:03<00:14, 13.22it/s, est. speed input: 16153.14 toks/s, output: 15.77 toks/s]
Processed prompts:  23%|██▎       | 60/256 [00:03<00:14, 13.23it/s, est. speed input: 16050.39 toks/s, output: 15.67 toks/s]
Processed prompts:  24%|██▍       | 62/256 [00:03<00:14, 13.23it/s, est. speed input: 15955.54 toks/s, output: 15.58 toks/s]
Processed prompts:  25%|██▌       | 64/256 [00:04<00:14, 13.22it/s, est. speed input: 15866.41 toks/s, output: 15.49 toks/s]
Processed prompts:  26%|██▌       | 66/256 [00:04<00:14, 13.23it/s, est. speed input: 15785.23 toks/s, output: 15.42 toks/s]
Processed prompts:  27%|██▋       | 68/256 [00:04<00:14, 13.23it/s, est. speed input: 15709.42 toks/s, output: 15.34 toks/s]
Processed prompts:  27%|██▋       | 70/256 [00:04<00:14, 13.24it/s, est. speed input: 15638.61 toks/s, output: 15.27 toks/s]
Processed prompts:  28%|██▊       | 72/256 [00:04<00:13, 13.22it/s, est. speed input: 15569.63 toks/s, output: 15.20 toks/s]
Processed prompts:  29%|██▉       | 74/256 [00:04<00:13, 13.21it/s, est. speed input: 15505.16 toks/s, output: 15.14 toks/s]
Processed prompts:  30%|██▉       | 76/256 [00:05<00:13, 13.21it/s, est. speed input: 15446.68 toks/s, output: 15.08 toks/s]
Processed prompts:  30%|███       | 78/256 [00:05<00:13, 13.21it/s, est. speed input: 15390.70 toks/s, output: 15.03 toks/s]
Processed prompts:  31%|███▏      | 80/256 [00:05<00:13, 13.20it/s, est. speed input: 15336.79 toks/s, output: 14.98 toks/s]
Processed prompts:  32%|███▏      | 82/256 [00:05<00:13, 13.21it/s, est. speed input: 15287.86 toks/s, output: 14.93 toks/s]
Processed prompts:  33%|███▎      | 84/256 [00:05<00:13, 13.21it/s, est. speed input: 15240.30 toks/s, output: 14.88 toks/s]
Processed prompts:  34%|███▎      | 86/256 [00:05<00:12, 13.19it/s, est. speed input: 15193.59 toks/s, output: 14.84 toks/s]
Processed prompts:  34%|███▍      | 88/256 [00:05<00:12, 13.17it/s, est. speed input: 15148.75 toks/s, output: 14.79 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:06<00:12, 13.18it/s, est. speed input: 15107.96 toks/s, output: 14.75 toks/s]
Processed prompts:  36%|███▌      | 92/256 [00:06<00:12, 13.17it/s, est. speed input: 15068.22 toks/s, output: 14.71 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:06<00:12, 13.18it/s, est. speed input: 15031.11 toks/s, output: 14.68 toks/s]
Processed prompts:  38%|███▊      | 96/256 [00:06<00:12, 13.18it/s, est. speed input: 14995.44 toks/s, output: 14.64 toks/s]
Processed prompts:  38%|███▊      | 98/256 [00:06<00:11, 13.17it/s, est. speed input: 14961.16 toks/s, output: 14.61 toks/s]
Processed prompts:  39%|███▉      | 100/256 [00:06<00:11, 13.16it/s, est. speed input: 14927.75 toks/s, output: 14.58 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:07<00:11, 13.17it/s, est. speed input: 14896.70 toks/s, output: 14.55 toks/s]
Processed prompts:  41%|████      | 104/256 [00:07<00:11, 13.18it/s, est. speed input: 14867.86 toks/s, output: 14.52 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:07<00:11, 13.19it/s, est. speed input: 14840.22 toks/s, output: 14.49 toks/s]
Processed prompts:  42%|████▏     | 108/256 [00:07<00:11, 13.18it/s, est. speed input: 14812.37 toks/s, output: 14.47 toks/s]
Processed prompts:  43%|████▎     | 110/256 [00:07<00:11, 13.19it/s, est. speed input: 14786.62 toks/s, output: 14.44 toks/s]
Processed prompts:  44%|████▍     | 112/256 [00:07<00:10, 13.18it/s, est. speed input: 14761.01 toks/s, output: 14.42 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:07<00:10, 13.19it/s, est. speed input: 14737.38 toks/s, output: 14.39 toks/s]
Processed prompts:  45%|████▌     | 116/256 [00:08<00:10, 13.19it/s, est. speed input: 14714.51 toks/s, output: 14.37 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:08<00:10, 13.20it/s, est. speed input: 14692.92 toks/s, output: 14.35 toks/s]
Processed prompts:  47%|████▋     | 120/256 [00:08<00:10, 13.20it/s, est. speed input: 14671.45 toks/s, output: 14.33 toks/s]
Processed prompts:  48%|████▊     | 122/256 [00:08<00:10, 13.19it/s, est. speed input: 14650.18 toks/s, output: 14.31 toks/s]
Processed prompts:  48%|████▊     | 124/256 [00:08<00:10, 13.19it/s, est. speed input: 14630.25 toks/s, output: 14.29 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:08<00:09, 13.18it/s, est. speed input: 14610.08 toks/s, output: 14.27 toks/s]
Processed prompts:  50%|█████     | 128/256 [00:08<00:09, 13.16it/s, est. speed input: 14590.45 toks/s, output: 14.25 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:09<00:09, 13.17it/s, est. speed input: 14572.26 toks/s, output: 14.23 toks/s]
Processed prompts:  52%|█████▏    | 132/256 [00:09<00:09, 13.18it/s, est. speed input: 14555.02 toks/s, output: 14.21 toks/s]
Processed prompts:  52%|█████▏    | 134/256 [00:09<00:09, 13.18it/s, est. speed input: 14537.95 toks/s, output: 14.20 toks/s]
Processed prompts:  53%|█████▎    | 136/256 [00:09<00:09, 13.17it/s, est. speed input: 14520.72 toks/s, output: 14.18 toks/s]
Processed prompts:  54%|█████▍    | 138/256 [00:09<00:08, 13.17it/s, est. speed input: 14504.84 toks/s, output: 14.16 toks/s]
Processed prompts:  55%|█████▍    | 140/256 [00:09<00:08, 13.16it/s, est. speed input: 14488.63 toks/s, output: 14.15 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:10<00:08, 13.16it/s, est. speed input: 14473.06 toks/s, output: 14.13 toks/s]
Processed prompts:  56%|█████▋    | 144/256 [00:10<00:08, 13.15it/s, est. speed input: 14457.77 toks/s, output: 14.12 toks/s]
Processed prompts:  57%|█████▋    | 146/256 [00:10<00:08, 13.14it/s, est. speed input: 14442.91 toks/s, output: 14.10 toks/s]
Processed prompts:  58%|█████▊    | 148/256 [00:10<00:08, 13.16it/s, est. speed input: 14429.28 toks/s, output: 14.09 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:10<00:08, 13.15it/s, est. speed input: 14415.32 toks/s, output: 14.08 toks/s]
Processed prompts:  59%|█████▉    | 152/256 [00:10<00:07, 13.16it/s, est. speed input: 14402.69 toks/s, output: 14.07 toks/s]
Processed prompts:  60%|██████    | 154/256 [00:10<00:07, 13.17it/s, est. speed input: 14389.93 toks/s, output: 14.05 toks/s]
Processed prompts:  61%|██████    | 156/256 [00:11<00:07, 13.16it/s, est. speed input: 14377.24 toks/s, output: 14.04 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:11<00:07, 13.17it/s, est. speed input: 14365.72 toks/s, output: 14.03 toks/s]
Processed prompts:  62%|██████▎   | 160/256 [00:11<00:07, 13.18it/s, est. speed input: 14354.41 toks/s, output: 14.02 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:11<00:07, 13.17it/s, est. speed input: 14342.76 toks/s, output: 14.01 toks/s]
Processed prompts:  64%|██████▍   | 164/256 [00:11<00:06, 13.16it/s, est. speed input: 14330.96 toks/s, output: 14.00 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:11<00:06, 13.15it/s, est. speed input: 14319.76 toks/s, output: 13.98 toks/s]
Processed prompts:  66%|██████▌   | 168/256 [00:12<00:06, 13.15it/s, est. speed input: 14309.03 toks/s, output: 13.97 toks/s]
Processed prompts:  66%|██████▋   | 170/256 [00:12<00:06, 13.14it/s, est. speed input: 14297.83 toks/s, output: 13.96 toks/s]
Processed prompts:  67%|██████▋   | 172/256 [00:12<00:06, 13.14it/s, est. speed input: 14287.43 toks/s, output: 13.95 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:12<00:06, 13.12it/s, est. speed input: 14276.32 toks/s, output: 13.94 toks/s]
Processed prompts:  69%|██████▉   | 176/256 [00:12<00:06, 13.13it/s, est. speed input: 14266.72 toks/s, output: 13.93 toks/s]
Processed prompts:  70%|██████▉   | 178/256 [00:12<00:05, 13.13it/s, est. speed input: 14256.89 toks/s, output: 13.92 toks/s]
Processed prompts:  70%|███████   | 180/256 [00:12<00:05, 13.14it/s, est. speed input: 14247.67 toks/s, output: 13.91 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:13<00:05, 13.13it/s, est. speed input: 14238.23 toks/s, output: 13.90 toks/s]
Processed prompts:  72%|███████▏  | 184/256 [00:13<00:05, 13.14it/s, est. speed input: 14229.57 toks/s, output: 13.90 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:13<00:05, 13.14it/s, est. speed input: 14220.71 toks/s, output: 13.89 toks/s]
Processed prompts:  73%|███████▎  | 188/256 [00:13<00:05, 13.16it/s, est. speed input: 14212.74 toks/s, output: 13.88 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:13<00:05, 13.16it/s, est. speed input: 14204.81 toks/s, output: 13.87 toks/s]
Processed prompts:  75%|███████▌  | 192/256 [00:13<00:04, 13.16it/s, est. speed input: 14196.66 toks/s, output: 13.86 toks/s]
Processed prompts:  76%|███████▌  | 194/256 [00:14<00:04, 13.15it/s, est. speed input: 14188.57 toks/s, output: 13.86 toks/s]
Processed prompts:  77%|███████▋  | 196/256 [00:14<00:04, 13.15it/s, est. speed input: 14180.70 toks/s, output: 13.85 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:14<00:04, 13.16it/s, est. speed input: 14173.48 toks/s, output: 13.84 toks/s]
Processed prompts:  78%|███████▊  | 200/256 [00:14<00:04, 13.15it/s, est. speed input: 14165.88 toks/s, output: 13.83 toks/s]
Processed prompts:  79%|███████▉  | 202/256 [00:14<00:04, 13.16it/s, est. speed input: 14158.99 toks/s, output: 13.83 toks/s]
Processed prompts:  80%|███████▉  | 204/256 [00:14<00:03, 13.18it/s, est. speed input: 14152.47 toks/s, output: 13.82 toks/s]
Processed prompts:  80%|████████  | 206/256 [00:14<00:03, 13.17it/s, est. speed input: 14145.48 toks/s, output: 13.81 toks/s]
Processed prompts:  81%|████████▏ | 208/256 [00:15<00:03, 13.16it/s, est. speed input: 14138.55 toks/s, output: 13.81 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:15<00:03, 13.15it/s, est. speed input: 14131.40 toks/s, output: 13.80 toks/s]
Processed prompts:  83%|████████▎ | 212/256 [00:15<00:03, 13.13it/s, est. speed input: 14124.29 toks/s, output: 13.79 toks/s]
Processed prompts:  84%|████████▎ | 214/256 [00:15<00:03, 13.14it/s, est. speed input: 14117.91 toks/s, output: 13.79 toks/s]
Processed prompts:  84%|████████▍ | 216/256 [00:15<00:03, 13.14it/s, est. speed input: 14111.62 toks/s, output: 13.78 toks/s]
Processed prompts:  85%|████████▌ | 218/256 [00:15<00:02, 13.15it/s, est. speed input: 14105.51 toks/s, output: 13.77 toks/s]
Processed prompts:  86%|████████▌ | 220/256 [00:15<00:02, 13.14it/s, est. speed input: 14099.00 toks/s, output: 13.77 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:16<00:02, 13.12it/s, est. speed input: 14092.40 toks/s, output: 13.76 toks/s]
Processed prompts:  88%|████████▊ | 224/256 [00:16<00:02, 13.13it/s, est. speed input: 14086.47 toks/s, output: 13.76 toks/s]
Processed prompts:  88%|████████▊ | 226/256 [00:16<00:02, 13.12it/s, est. speed input: 14080.23 toks/s, output: 13.75 toks/s]
Processed prompts:  89%|████████▉ | 228/256 [00:16<00:02, 13.12it/s, est. speed input: 14074.42 toks/s, output: 13.74 toks/s]
Processed prompts:  90%|████████▉ | 230/256 [00:16<00:01, 13.13it/s, est. speed input: 14068.90 toks/s, output: 13.74 toks/s]
Processed prompts:  91%|█████████ | 232/256 [00:16<00:01, 13.14it/s, est. speed input: 14063.52 toks/s, output: 13.73 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:17<00:01, 13.14it/s, est. speed input: 14058.27 toks/s, output: 13.73 toks/s]
Processed prompts:  92%|█████████▏| 236/256 [00:17<00:01, 13.14it/s, est. speed input: 14052.92 toks/s, output: 13.72 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:17<00:01, 13.14it/s, est. speed input: 14047.66 toks/s, output: 13.72 toks/s]
Processed prompts:  94%|█████████▍| 240/256 [00:17<00:01, 13.12it/s, est. speed input: 14041.75 toks/s, output: 13.71 toks/s]
Processed prompts:  95%|█████████▍| 242/256 [00:17<00:01, 13.12it/s, est. speed input: 14036.73 toks/s, output: 13.71 toks/s]
Processed prompts:  95%|█████████▌| 244/256 [00:17<00:00, 13.12it/s, est. speed input: 14031.62 toks/s, output: 13.70 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:17<00:00, 13.13it/s, est. speed input: 14026.74 toks/s, output: 13.70 toks/s]
Processed prompts:  97%|█████████▋| 248/256 [00:18<00:00, 13.11it/s, est. speed input: 14021.19 toks/s, output: 13.69 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:18<00:00, 13.12it/s, est. speed input: 14016.56 toks/s, output: 13.69 toks/s]
Processed prompts:  98%|█████████▊| 252/256 [00:18<00:00, 13.11it/s, est. speed input: 14011.37 toks/s, output: 13.68 toks/s]
Processed prompts:  99%|█████████▉| 254/256 [00:18<00:00, 13.10it/s, est. speed input: 14006.41 toks/s, output: 13.68 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:18<00:00, 14.48it/s, est. speed input: 14037.87 toks/s, output: 13.71 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:18<00:00, 14.48it/s, est. speed input: 14037.87 toks/s, output: 13.71 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:18<00:00, 13.71it/s, est. speed input: 14037.87 toks/s, output: 13.71 toks/s]
[rank0]:[W126 07:22:49.261803591 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=4096 ==========
Time: 2026-01-26 07:22:50
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-FP8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=512, max_num_seqs=4
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-FP8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 512 --max-num-seqs 4 --max-model-len 1025 --max-num-batched-tokens 4096 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_4/json/Qwen2.5-14B-FP8_M4096.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 07:23:02 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 07:23:03 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=341408) WARNING 01-26 07:23:11 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=341408) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=341408) WARNING 01-26 07:23:29 [backends.py:609] Failed to read file <frozen os>
Throughput: 13.10 requests/s, 13429.14 total tokens/s, 13.10 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512

STDERR:
[2026-01-26 07:23:02] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 07:23:02] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-FP8'
[2026-01-26 07:23:02] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-FP8
[2026-01-26 07:23:02] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:23:02] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:23:02] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:23:02] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:23:02] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:23:02] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-FP8'
[2026-01-26 07:23:02] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 07:23:02] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 07:23:02] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 07:23:02] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 07:23:02] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 07:23:10] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 07:23:10] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-FP8'
[2026-01-26 07:23:10] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-FP8
[2026-01-26 07:23:10] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:23:10] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:23:10] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:23:10] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:23:10] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:23:10] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-FP8'
[2026-01-26 07:23:10] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 07:23:10] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 07:23:10] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 07:23:10] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 07:23:10] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=341408) [2026-01-26 07:23:11] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=341408) [2026-01-26 07:23:11] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=341408) [2026-01-26 07:23:11] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=341408) [2026-01-26 07:23:11] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=341408) [2026-01-26 07:23:11] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-14B-FP8
(EngineCore_DP0 pid=341408) [2026-01-26 07:23:11] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=341408) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=341408) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.03it/s]
(EngineCore_DP0 pid=341408) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:02,  1.00s/it]
(EngineCore_DP0 pid=341408) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.39it/s]
(EngineCore_DP0 pid=341408) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.23it/s]
(EngineCore_DP0 pid=341408) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.20it/s]
(EngineCore_DP0 pid=341408) 
(EngineCore_DP0 pid=341408) [2026-01-26 07:23:15] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [7168, 5120] -> 1D uint8
(EngineCore_DP0 pid=341408) [2026-01-26 07:23:15] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 27525120 bytes
(EngineCore_DP0 pid=341408) [2026-01-26 07:23:15] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 5120] -> 1D uint8
(EngineCore_DP0 pid=341408) [2026-01-26 07:23:15] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 19660800 bytes
(EngineCore_DP0 pid=341408) [2026-01-26 07:23:15] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [27648, 5120] -> 1D uint8
(EngineCore_DP0 pid=341408) [2026-01-26 07:23:16] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 106168320 bytes
(EngineCore_DP0 pid=341408) [2026-01-26 07:23:16] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 13824] -> 1D uint8
(EngineCore_DP0 pid=341408) [2026-01-26 07:23:16] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 53084160 bytes
(EngineCore_DP0 pid=341408) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  25%|██▌       | 1/4 [00:00<00:00,  4.96it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 2/4 [00:00<00:00,  5.15it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  75%|███████▌  | 3/4 [00:00<00:00,  5.23it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  4.95it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  5.02it/s]
(EngineCore_DP0 pid=341408) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  33%|███▎      | 1/3 [00:00<00:00,  3.70it/s]
Capturing CUDA graphs (decode, FULL):  67%|██████▋   | 2/3 [00:00<00:00,  3.33it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  3.74it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  3.66it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   4%|▍         | 23/512 [00:00<00:02, 227.72it/s]
Adding requests:   9%|▉         | 48/512 [00:00<00:01, 239.00it/s]
Adding requests:  14%|█▍        | 74/512 [00:00<00:01, 246.11it/s]
Adding requests:  19%|█▉        | 99/512 [00:00<00:01, 235.68it/s]
Adding requests:  24%|██▍       | 124/512 [00:00<00:01, 239.58it/s]
Adding requests:  29%|██▉       | 149/512 [00:00<00:01, 242.95it/s]
Adding requests:  34%|███▍      | 175/512 [00:00<00:01, 245.63it/s]
Adding requests:  39%|███▉      | 202/512 [00:00<00:01, 251.31it/s]
Adding requests:  45%|████▍     | 229/512 [00:00<00:01, 254.44it/s]
Adding requests:  50%|████▉     | 255/512 [00:01<00:01, 249.87it/s]
Adding requests:  55%|█████▍    | 281/512 [00:01<00:00, 252.83it/s]
Adding requests:  60%|█████▉    | 307/512 [00:01<00:00, 254.13it/s]
Adding requests:  65%|██████▌   | 335/512 [00:01<00:00, 259.50it/s]
Adding requests:  71%|███████   | 362/512 [00:01<00:00, 259.72it/s]
Adding requests:  76%|███████▌  | 388/512 [00:01<00:00, 258.44it/s]
Adding requests:  81%|████████  | 415/512 [00:01<00:00, 260.76it/s]
Adding requests:  86%|████████▋ | 442/512 [00:01<00:00, 253.04it/s]
Adding requests:  92%|█████████▏| 470/512 [00:01<00:00, 257.32it/s]
Adding requests:  97%|█████████▋| 499/512 [00:01<00:00, 263.69it/s]
Adding requests: 100%|██████████| 512/512 [00:02<00:00, 253.70it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   4%|▍         | 22/512 [00:00<00:02, 203.01it/s, est. speed input: 207927.40 toks/s, output: 203.02 toks/s]
Processed prompts:   8%|▊         | 43/512 [00:01<00:20, 23.01it/s, est. speed input: 27269.61 toks/s, output: 26.63 toks/s]   
Processed prompts:  10%|█         | 53/512 [00:02<00:22, 20.74it/s, est. speed input: 24472.23 toks/s, output: 23.90 toks/s]
Processed prompts:  12%|█▏        | 59/512 [00:02<00:26, 17.13it/s, est. speed input: 21418.31 toks/s, output: 20.92 toks/s]
Processed prompts:  12%|█▏        | 63/512 [00:03<00:27, 16.38it/s, est. speed input: 20660.87 toks/s, output: 20.18 toks/s]
Processed prompts:  13%|█▎        | 66/512 [00:03<00:29, 14.99it/s, est. speed input: 19737.95 toks/s, output: 19.28 toks/s]
Processed prompts:  14%|█▎        | 70/512 [00:03<00:30, 14.58it/s, est. speed input: 19240.74 toks/s, output: 18.79 toks/s]
Processed prompts:  14%|█▍        | 74/512 [00:04<00:30, 14.25it/s, est. speed input: 18816.02 toks/s, output: 18.37 toks/s]
Processed prompts:  15%|█▌        | 78/512 [00:04<00:31, 13.98it/s, est. speed input: 18449.83 toks/s, output: 18.02 toks/s]
Processed prompts:  16%|█▌        | 82/512 [00:04<00:31, 13.78it/s, est. speed input: 18130.69 toks/s, output: 17.71 toks/s]
Processed prompts:  17%|█▋        | 86/512 [00:04<00:31, 13.63it/s, est. speed input: 17851.05 toks/s, output: 17.43 toks/s]
Processed prompts:  18%|█▊        | 90/512 [00:05<00:31, 13.52it/s, est. speed input: 17603.06 toks/s, output: 17.19 toks/s]
Processed prompts:  18%|█▊        | 94/512 [00:05<00:31, 13.44it/s, est. speed input: 17382.23 toks/s, output: 16.97 toks/s]
Processed prompts:  19%|█▉        | 98/512 [00:05<00:30, 13.38it/s, est. speed input: 17183.85 toks/s, output: 16.78 toks/s]
Processed prompts:  20%|█▉        | 102/512 [00:06<00:30, 13.34it/s, est. speed input: 17005.55 toks/s, output: 16.61 toks/s]
Processed prompts:  21%|██        | 106/512 [00:06<00:30, 13.31it/s, est. speed input: 16844.53 toks/s, output: 16.45 toks/s]
Processed prompts:  21%|██▏       | 110/512 [00:06<00:30, 13.29it/s, est. speed input: 16696.61 toks/s, output: 16.31 toks/s]
Processed prompts:  22%|██▏       | 114/512 [00:07<00:29, 13.27it/s, est. speed input: 16561.22 toks/s, output: 16.17 toks/s]
Processed prompts:  23%|██▎       | 118/512 [00:07<00:29, 13.25it/s, est. speed input: 16437.05 toks/s, output: 16.05 toks/s]
Processed prompts:  24%|██▍       | 122/512 [00:07<00:29, 13.25it/s, est. speed input: 16322.80 toks/s, output: 15.94 toks/s]
Processed prompts:  25%|██▍       | 126/512 [00:07<00:29, 13.24it/s, est. speed input: 16216.99 toks/s, output: 15.84 toks/s]
Processed prompts:  25%|██▌       | 130/512 [00:08<00:28, 13.23it/s, est. speed input: 16118.98 toks/s, output: 15.74 toks/s]
Processed prompts:  26%|██▌       | 134/512 [00:08<00:28, 13.23it/s, est. speed input: 16027.59 toks/s, output: 15.65 toks/s]
Processed prompts:  27%|██▋       | 138/512 [00:08<00:28, 13.23it/s, est. speed input: 15942.40 toks/s, output: 15.57 toks/s]
Processed prompts:  28%|██▊       | 142/512 [00:09<00:27, 13.23it/s, est. speed input: 15863.28 toks/s, output: 15.49 toks/s]
Processed prompts:  29%|██▊       | 146/512 [00:09<00:27, 13.22it/s, est. speed input: 15788.92 toks/s, output: 15.42 toks/s]
Processed prompts:  29%|██▉       | 150/512 [00:09<00:27, 13.23it/s, est. speed input: 15719.68 toks/s, output: 15.35 toks/s]
Processed prompts:  30%|███       | 154/512 [00:10<00:27, 13.23it/s, est. speed input: 15654.71 toks/s, output: 15.29 toks/s]
Processed prompts:  31%|███       | 158/512 [00:10<00:26, 13.23it/s, est. speed input: 15593.32 toks/s, output: 15.23 toks/s]
Processed prompts:  32%|███▏      | 162/512 [00:10<00:26, 13.23it/s, est. speed input: 15535.04 toks/s, output: 15.17 toks/s]
Processed prompts:  32%|███▏      | 166/512 [00:10<00:26, 13.22it/s, est. speed input: 15479.95 toks/s, output: 15.12 toks/s]
Processed prompts:  33%|███▎      | 170/512 [00:11<00:25, 13.22it/s, est. speed input: 15427.74 toks/s, output: 15.07 toks/s]
Processed prompts:  34%|███▍      | 174/512 [00:11<00:25, 13.22it/s, est. speed input: 15377.91 toks/s, output: 15.02 toks/s]
Processed prompts:  35%|███▍      | 178/512 [00:11<00:25, 13.21it/s, est. speed input: 15330.76 toks/s, output: 14.97 toks/s]
Processed prompts:  36%|███▌      | 182/512 [00:12<00:24, 13.21it/s, est. speed input: 15286.03 toks/s, output: 14.93 toks/s]
Processed prompts:  36%|███▋      | 186/512 [00:12<00:24, 13.21it/s, est. speed input: 15242.93 toks/s, output: 14.89 toks/s]
Processed prompts:  37%|███▋      | 190/512 [00:12<00:24, 13.21it/s, est. speed input: 15202.47 toks/s, output: 14.85 toks/s]
Processed prompts:  38%|███▊      | 194/512 [00:13<00:24, 13.21it/s, est. speed input: 15163.79 toks/s, output: 14.81 toks/s]
Processed prompts:  39%|███▊      | 198/512 [00:13<00:23, 13.21it/s, est. speed input: 15127.04 toks/s, output: 14.77 toks/s]
Processed prompts:  39%|███▉      | 202/512 [00:13<00:23, 13.21it/s, est. speed input: 15091.64 toks/s, output: 14.74 toks/s]
Processed prompts:  40%|████      | 206/512 [00:14<00:23, 13.21it/s, est. speed input: 15057.51 toks/s, output: 14.70 toks/s]
Processed prompts:  41%|████      | 210/512 [00:14<00:22, 13.20it/s, est. speed input: 15024.41 toks/s, output: 14.67 toks/s]
Processed prompts:  42%|████▏     | 214/512 [00:14<00:22, 13.19it/s, est. speed input: 14992.69 toks/s, output: 14.64 toks/s]
Processed prompts:  43%|████▎     | 218/512 [00:14<00:22, 13.19it/s, est. speed input: 14962.52 toks/s, output: 14.61 toks/s]
Processed prompts:  43%|████▎     | 222/512 [00:15<00:21, 13.19it/s, est. speed input: 14933.28 toks/s, output: 14.58 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:15<00:21, 13.19it/s, est. speed input: 14905.30 toks/s, output: 14.56 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:15<00:21, 13.19it/s, est. speed input: 14878.33 toks/s, output: 14.53 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:16<00:21, 13.19it/s, est. speed input: 14852.61 toks/s, output: 14.50 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:16<00:20, 13.18it/s, est. speed input: 14827.36 toks/s, output: 14.48 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:16<00:20, 13.18it/s, est. speed input: 14802.97 toks/s, output: 14.46 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:17<00:20, 13.18it/s, est. speed input: 14779.55 toks/s, output: 14.43 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:17<00:19, 13.18it/s, est. speed input: 14757.24 toks/s, output: 14.41 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:17<00:19, 13.18it/s, est. speed input: 14735.28 toks/s, output: 14.39 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:17<00:19, 13.17it/s, est. speed input: 14714.03 toks/s, output: 14.37 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:18<00:18, 13.17it/s, est. speed input: 14693.42 toks/s, output: 14.35 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:18<00:18, 13.17it/s, est. speed input: 14673.56 toks/s, output: 14.33 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:18<00:18, 13.16it/s, est. speed input: 14654.15 toks/s, output: 14.31 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:19<00:18, 13.17it/s, est. speed input: 14635.77 toks/s, output: 14.29 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:19<00:17, 13.17it/s, est. speed input: 14618.05 toks/s, output: 14.28 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:19<00:17, 13.17it/s, est. speed input: 14600.45 toks/s, output: 14.26 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:20<00:17, 13.17it/s, est. speed input: 14583.43 toks/s, output: 14.24 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:20<00:16, 13.17it/s, est. speed input: 14567.04 toks/s, output: 14.23 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:20<00:16, 13.16it/s, est. speed input: 14550.92 toks/s, output: 14.21 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:20<00:16, 13.16it/s, est. speed input: 14535.02 toks/s, output: 14.19 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:21<00:15, 13.15it/s, est. speed input: 14519.49 toks/s, output: 14.18 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:21<00:15, 13.15it/s, est. speed input: 14504.61 toks/s, output: 14.16 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:21<00:15, 13.15it/s, est. speed input: 14490.15 toks/s, output: 14.15 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:22<00:15, 13.15it/s, est. speed input: 14476.14 toks/s, output: 14.14 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:22<00:14, 13.15it/s, est. speed input: 14462.30 toks/s, output: 14.12 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:22<00:14, 13.15it/s, est. speed input: 14448.99 toks/s, output: 14.11 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:23<00:14, 13.15it/s, est. speed input: 14436.15 toks/s, output: 14.10 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:23<00:13, 13.15it/s, est. speed input: 14423.52 toks/s, output: 14.09 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:23<00:13, 13.15it/s, est. speed input: 14411.11 toks/s, output: 14.07 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:24<00:13, 13.14it/s, est. speed input: 14398.95 toks/s, output: 14.06 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:24<00:12, 13.14it/s, est. speed input: 14387.06 toks/s, output: 14.05 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:24<00:12, 13.14it/s, est. speed input: 14375.50 toks/s, output: 14.04 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:24<00:12, 13.14it/s, est. speed input: 14364.27 toks/s, output: 14.03 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:25<00:12, 13.14it/s, est. speed input: 14353.28 toks/s, output: 14.02 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:25<00:11, 13.14it/s, est. speed input: 14342.68 toks/s, output: 14.01 toks/s]
Processed prompts:  71%|███████   | 362/512 [00:25<00:11, 13.14it/s, est. speed input: 14332.34 toks/s, output: 14.00 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:26<00:11, 13.14it/s, est. speed input: 14322.15 toks/s, output: 13.99 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [00:26<00:10, 13.14it/s, est. speed input: 14312.08 toks/s, output: 13.98 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [00:26<00:10, 13.14it/s, est. speed input: 14302.22 toks/s, output: 13.97 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [00:27<00:10, 13.13it/s, est. speed input: 14292.40 toks/s, output: 13.96 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [00:27<00:09, 13.13it/s, est. speed input: 14283.06 toks/s, output: 13.95 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [00:27<00:09, 13.13it/s, est. speed input: 14273.80 toks/s, output: 13.94 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [00:27<00:09, 13.13it/s, est. speed input: 14264.77 toks/s, output: 13.93 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [00:28<00:08, 13.13it/s, est. speed input: 14255.83 toks/s, output: 13.92 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [00:28<00:08, 13.13it/s, est. speed input: 14247.32 toks/s, output: 13.91 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [00:28<00:08, 13.13it/s, est. speed input: 14238.86 toks/s, output: 13.91 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [00:29<00:08, 13.13it/s, est. speed input: 14230.42 toks/s, output: 13.90 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [00:29<00:02, 30.65it/s, est. speed input: 14879.95 toks/s, output: 14.53 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [00:29<00:03, 25.67it/s, est. speed input: 14865.84 toks/s, output: 14.52 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [00:30<00:03, 22.03it/s, est. speed input: 14851.57 toks/s, output: 14.50 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [00:30<00:03, 19.43it/s, est. speed input: 14837.65 toks/s, output: 14.49 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [00:30<00:03, 17.58it/s, est. speed input: 14824.26 toks/s, output: 14.48 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [00:31<00:03, 16.27it/s, est. speed input: 14811.10 toks/s, output: 14.46 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [00:31<00:03, 15.34it/s, est. speed input: 14797.99 toks/s, output: 14.45 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [00:31<00:03, 14.69it/s, est. speed input: 14785.30 toks/s, output: 14.44 toks/s]
Processed prompts:  90%|█████████ | 462/512 [00:32<00:03, 14.23it/s, est. speed input: 14772.62 toks/s, output: 14.43 toks/s]
Processed prompts:  91%|█████████ | 466/512 [00:32<00:03, 13.91it/s, est. speed input: 14760.39 toks/s, output: 14.41 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [00:32<00:03, 13.68it/s, est. speed input: 14748.19 toks/s, output: 14.40 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [00:32<00:02, 13.52it/s, est. speed input: 14736.26 toks/s, output: 14.39 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [00:33<00:02, 13.41it/s, est. speed input: 14724.69 toks/s, output: 14.38 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [00:33<00:02, 13.33it/s, est. speed input: 14713.28 toks/s, output: 14.37 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [00:33<00:01, 13.27it/s, est. speed input: 14701.95 toks/s, output: 14.36 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [00:34<00:01, 13.24it/s, est. speed input: 14690.99 toks/s, output: 14.35 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [00:34<00:01, 13.21it/s, est. speed input: 14680.06 toks/s, output: 14.34 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [00:34<00:01, 13.19it/s, est. speed input: 14669.35 toks/s, output: 14.33 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [00:35<00:00, 13.17it/s, est. speed input: 14658.73 toks/s, output: 14.32 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [00:35<00:00, 13.17it/s, est. speed input: 14648.56 toks/s, output: 14.31 toks/s]
Processed prompts: 100%|█████████▉| 510/512 [00:35<00:00, 14.13it/s, est. speed input: 14666.97 toks/s, output: 14.32 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:35<00:00, 14.13it/s, est. speed input: 14724.39 toks/s, output: 14.38 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:35<00:00, 14.38it/s, est. speed input: 14724.39 toks/s, output: 14.38 toks/s]
[rank0]:[W126 07:24:30.548619022 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=8192 ==========
Time: 2026-01-26 07:24:33
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-FP8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=1024, max_num_seqs=8
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-FP8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 1024 --max-num-seqs 8 --max-model-len 1025 --max-num-batched-tokens 8192 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_4/json/Qwen2.5-14B-FP8_M8192.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 07:24:49 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 07:24:50 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=343189) WARNING 01-26 07:24:56 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=343189) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=343189) WARNING 01-26 07:25:15 [backends.py:609] Failed to read file <frozen os>
Throughput: 12.98 requests/s, 13305.06 total tokens/s, 12.98 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024

STDERR:
[2026-01-26 07:24:48] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 07:24:49] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-FP8'
[2026-01-26 07:24:49] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-FP8
[2026-01-26 07:24:49] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:24:49] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:24:49] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:24:49] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:24:49] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:24:49] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-FP8'
[2026-01-26 07:24:49] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 07:24:49] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 07:24:49] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 07:24:49] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 07:24:49] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 07:24:55] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 07:24:55] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-FP8'
[2026-01-26 07:24:55] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-FP8
[2026-01-26 07:24:55] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:24:55] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:24:55] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:24:55] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:24:55] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:24:55] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-FP8'
[2026-01-26 07:24:55] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 07:24:55] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 07:24:55] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 07:24:55] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 07:24:55] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=343189) [2026-01-26 07:24:57] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=343189) [2026-01-26 07:24:57] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=343189) [2026-01-26 07:24:57] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=343189) [2026-01-26 07:24:57] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=343189) [2026-01-26 07:24:57] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-14B-FP8
(EngineCore_DP0 pid=343189) [2026-01-26 07:24:57] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=343189) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=343189) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:01<00:03,  1.00s/it]
(EngineCore_DP0 pid=343189) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:02<00:02,  1.03s/it]
(EngineCore_DP0 pid=343189) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.36it/s]
(EngineCore_DP0 pid=343189) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.22it/s]
(EngineCore_DP0 pid=343189) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.18it/s]
(EngineCore_DP0 pid=343189) 
(EngineCore_DP0 pid=343189) [2026-01-26 07:25:01] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [7168, 5120] -> 1D uint8
(EngineCore_DP0 pid=343189) [2026-01-26 07:25:01] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 27525120 bytes
(EngineCore_DP0 pid=343189) [2026-01-26 07:25:01] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 5120] -> 1D uint8
(EngineCore_DP0 pid=343189) [2026-01-26 07:25:01] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 19660800 bytes
(EngineCore_DP0 pid=343189) [2026-01-26 07:25:01] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [27648, 5120] -> 1D uint8
(EngineCore_DP0 pid=343189) [2026-01-26 07:25:01] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 106168320 bytes
(EngineCore_DP0 pid=343189) [2026-01-26 07:25:01] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 13824] -> 1D uint8
(EngineCore_DP0 pid=343189) [2026-01-26 07:25:01] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 53084160 bytes
(EngineCore_DP0 pid=343189) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:02,  1.96it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  40%|████      | 2/5 [00:00<00:01,  2.33it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  60%|██████    | 3/5 [00:01<00:00,  2.81it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  80%|████████  | 4/5 [00:01<00:00,  3.43it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:01<00:00,  3.79it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:01<00:00,  3.20it/s]
(EngineCore_DP0 pid=343189) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:00,  4.64it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 2/4 [00:00<00:00,  5.11it/s]
Capturing CUDA graphs (decode, FULL):  75%|███████▌  | 3/4 [00:00<00:00,  5.24it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  5.34it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  5.23it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 23/1024 [00:00<00:04, 227.26it/s]
Adding requests:   5%|▍         | 48/1024 [00:00<00:04, 239.38it/s]
Adding requests:   7%|▋         | 74/1024 [00:00<00:03, 246.85it/s]
Adding requests:  10%|▉         | 99/1024 [00:00<00:03, 241.73it/s]
Adding requests:  12%|█▏        | 125/1024 [00:00<00:03, 246.20it/s]
Adding requests:  15%|█▍        | 150/1024 [00:00<00:03, 247.43it/s]
Adding requests:  17%|█▋        | 177/1024 [00:00<00:03, 253.31it/s]
Adding requests:  20%|██        | 205/1024 [00:00<00:03, 258.84it/s]
Adding requests:  23%|██▎       | 232/1024 [00:00<00:03, 260.18it/s]
Adding requests:  25%|██▌       | 259/1024 [00:01<00:03, 252.86it/s]
Adding requests:  28%|██▊       | 286/1024 [00:01<00:02, 255.97it/s]
Adding requests:  31%|███       | 314/1024 [00:01<00:02, 261.26it/s]
Adding requests:  33%|███▎      | 342/1024 [00:01<00:02, 263.41it/s]
Adding requests:  36%|███▌      | 370/1024 [00:01<00:02, 267.34it/s]
Adding requests:  39%|███▉      | 398/1024 [00:01<00:02, 269.90it/s]
Adding requests:  42%|████▏     | 426/1024 [00:01<00:02, 269.13it/s]
Adding requests:  44%|████▍     | 453/1024 [00:01<00:02, 266.16it/s]
Adding requests:  47%|████▋     | 480/1024 [00:01<00:02, 265.40it/s]
Adding requests:  50%|████▉     | 507/1024 [00:01<00:01, 264.33it/s]
Adding requests:  52%|█████▏    | 534/1024 [00:02<00:01, 265.21it/s]
Adding requests:  55%|█████▍    | 561/1024 [00:02<00:01, 263.45it/s]
Adding requests:  57%|█████▋    | 588/1024 [00:02<00:01, 254.28it/s]
Adding requests:  60%|█████▉    | 614/1024 [00:02<00:01, 254.63it/s]
Adding requests:  62%|██████▎   | 640/1024 [00:02<00:01, 252.36it/s]
Adding requests:  65%|██████▌   | 666/1024 [00:02<00:01, 250.08it/s]
Adding requests:  68%|██████▊   | 694/1024 [00:02<00:01, 256.35it/s]
Adding requests:  70%|███████   | 720/1024 [00:02<00:01, 252.02it/s]
Adding requests:  73%|███████▎  | 746/1024 [00:02<00:01, 247.59it/s]
Adding requests:  75%|███████▌  | 772/1024 [00:03<00:01, 248.97it/s]
Adding requests:  78%|███████▊  | 798/1024 [00:03<00:00, 249.99it/s]
Adding requests:  80%|████████  | 824/1024 [00:03<00:00, 252.74it/s]
Adding requests:  83%|████████▎ | 851/1024 [00:03<00:00, 257.61it/s]
Adding requests:  86%|████████▌ | 877/1024 [00:03<00:00, 257.52it/s]
Adding requests:  88%|████████▊ | 905/1024 [00:03<00:00, 263.92it/s]
Adding requests:  91%|█████████ | 932/1024 [00:03<00:00, 256.28it/s]
Adding requests:  94%|█████████▍| 960/1024 [00:03<00:00, 261.68it/s]
Adding requests:  96%|█████████▋| 987/1024 [00:03<00:00, 259.14it/s]
Adding requests:  99%|█████████▉| 1013/1024 [00:03<00:00, 255.44it/s]
Adding requests: 100%|██████████| 1024/1024 [00:03<00:00, 256.45it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▍         | 50/1024 [00:00<00:11, 88.15it/s, est. speed input: 90265.79 toks/s, output: 88.15 toks/s]
Processed prompts:   6%|▌         | 59/1024 [00:01<00:22, 43.73it/s, est. speed input: 51362.07 toks/s, output: 50.16 toks/s]
Processed prompts:   6%|▋         | 66/1024 [00:01<00:33, 28.77it/s, est. speed input: 37847.14 toks/s, output: 36.96 toks/s]
Processed prompts:   7%|▋         | 74/1024 [00:02<00:42, 22.53it/s, est. speed input: 31632.25 toks/s, output: 30.89 toks/s]
Processed prompts:   8%|▊         | 82/1024 [00:03<00:49, 19.12it/s, est. speed input: 27940.26 toks/s, output: 27.29 toks/s]
Processed prompts:   9%|▉         | 90/1024 [00:03<00:54, 17.07it/s, est. speed input: 25492.64 toks/s, output: 24.89 toks/s]
Processed prompts:  10%|▉         | 98/1024 [00:04<00:58, 15.77it/s, est. speed input: 23751.61 toks/s, output: 23.19 toks/s]
Processed prompts:  10%|█         | 106/1024 [00:04<01:01, 14.92it/s, est. speed input: 22448.51 toks/s, output: 21.92 toks/s]
Processed prompts:  11%|█         | 114/1024 [00:05<01:03, 14.35it/s, est. speed input: 21435.48 toks/s, output: 20.93 toks/s]
Processed prompts:  12%|█▏        | 122/1024 [00:06<01:04, 13.96it/s, est. speed input: 20626.37 toks/s, output: 20.14 toks/s]
Processed prompts:  13%|█▎        | 130/1024 [00:06<01:05, 13.70it/s, est. speed input: 19964.99 toks/s, output: 19.50 toks/s]
Processed prompts:  13%|█▎        | 138/1024 [00:07<01:05, 13.51it/s, est. speed input: 19412.84 toks/s, output: 18.96 toks/s]
Processed prompts:  14%|█▍        | 146/1024 [00:07<01:05, 13.38it/s, est. speed input: 18945.74 toks/s, output: 18.50 toks/s]
Processed prompts:  15%|█▌        | 154/1024 [00:08<01:05, 13.29it/s, est. speed input: 18546.12 toks/s, output: 18.11 toks/s]
Processed prompts:  16%|█▌        | 162/1024 [00:09<01:05, 13.22it/s, est. speed input: 18198.75 toks/s, output: 17.77 toks/s]
Processed prompts:  17%|█▋        | 170/1024 [00:09<01:04, 13.17it/s, est. speed input: 17894.82 toks/s, output: 17.48 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [00:10<01:04, 13.14it/s, est. speed input: 17626.76 toks/s, output: 17.21 toks/s]
Processed prompts:  18%|█▊        | 186/1024 [00:10<01:03, 13.11it/s, est. speed input: 17388.59 toks/s, output: 16.98 toks/s]
Processed prompts:  19%|█▉        | 194/1024 [00:11<01:03, 13.09it/s, est. speed input: 17174.62 toks/s, output: 16.77 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [00:12<01:02, 13.07it/s, est. speed input: 16981.49 toks/s, output: 16.58 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:12<01:02, 13.06it/s, est. speed input: 16807.10 toks/s, output: 16.41 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:13<00:34, 23.23it/s, est. speed input: 18150.33 toks/s, output: 17.72 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:13<00:39, 19.93it/s, est. speed input: 17935.85 toks/s, output: 17.52 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:14<00:43, 17.74it/s, est. speed input: 17739.35 toks/s, output: 17.32 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:15<00:47, 16.27it/s, est. speed input: 17559.06 toks/s, output: 17.15 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:15<00:49, 15.27it/s, est. speed input: 17392.49 toks/s, output: 16.98 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:16<00:51, 14.57it/s, est. speed input: 17238.34 toks/s, output: 16.83 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:16<00:52, 14.10it/s, est. speed input: 17095.65 toks/s, output: 16.69 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:17<00:53, 13.76it/s, est. speed input: 16962.41 toks/s, output: 16.56 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:18<00:53, 13.53it/s, est. speed input: 16838.22 toks/s, output: 16.44 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:18<00:53, 13.37it/s, est. speed input: 16722.03 toks/s, output: 16.33 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:19<00:53, 13.26it/s, est. speed input: 16613.22 toks/s, output: 16.22 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:19<00:53, 13.17it/s, est. speed input: 16510.79 toks/s, output: 16.12 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:20<00:52, 13.11it/s, est. speed input: 16414.39 toks/s, output: 16.03 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:21<00:52, 13.07it/s, est. speed input: 16323.47 toks/s, output: 15.94 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:21<00:51, 13.04it/s, est. speed input: 16237.52 toks/s, output: 15.86 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:22<00:51, 13.03it/s, est. speed input: 16156.82 toks/s, output: 15.78 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:23<00:50, 13.01it/s, est. speed input: 16080.20 toks/s, output: 15.70 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:23<00:50, 13.00it/s, est. speed input: 16007.70 toks/s, output: 15.63 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:24<00:49, 13.00it/s, est. speed input: 15938.78 toks/s, output: 15.57 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:24<00:49, 12.99it/s, est. speed input: 15873.26 toks/s, output: 15.50 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [00:25<00:48, 12.99it/s, est. speed input: 15811.07 toks/s, output: 15.44 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:26<00:47, 12.99it/s, est. speed input: 15751.81 toks/s, output: 15.38 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:26<00:47, 12.99it/s, est. speed input: 15695.39 toks/s, output: 15.33 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:27<00:46, 12.99it/s, est. speed input: 15641.64 toks/s, output: 15.28 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:27<00:46, 12.99it/s, est. speed input: 15590.39 toks/s, output: 15.22 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:28<00:45, 13.00it/s, est. speed input: 15541.37 toks/s, output: 15.18 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:29<00:44, 13.00it/s, est. speed input: 15494.31 toks/s, output: 15.13 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:29<00:44, 13.00it/s, est. speed input: 15449.52 toks/s, output: 15.09 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:30<00:43, 13.00it/s, est. speed input: 15406.44 toks/s, output: 15.05 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:31<00:42, 13.00it/s, est. speed input: 15365.00 toks/s, output: 15.00 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:31<00:42, 13.00it/s, est. speed input: 15325.32 toks/s, output: 14.97 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:32<00:41, 13.00it/s, est. speed input: 15287.00 toks/s, output: 14.93 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:32<00:41, 13.00it/s, est. speed input: 15250.11 toks/s, output: 14.89 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:33<00:40, 13.00it/s, est. speed input: 15214.68 toks/s, output: 14.86 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:34<00:39, 13.00it/s, est. speed input: 15180.42 toks/s, output: 14.82 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:34<00:39, 13.01it/s, est. speed input: 15147.51 toks/s, output: 14.79 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:35<00:38, 13.00it/s, est. speed input: 15115.60 toks/s, output: 14.76 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:35<00:37, 13.00it/s, est. speed input: 15084.69 toks/s, output: 14.73 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:36<00:37, 13.00it/s, est. speed input: 15054.84 toks/s, output: 14.70 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:37<00:36, 13.00it/s, est. speed input: 15026.11 toks/s, output: 14.67 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:37<00:36, 13.00it/s, est. speed input: 14998.20 toks/s, output: 14.65 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:38<00:35, 13.00it/s, est. speed input: 14971.13 toks/s, output: 14.62 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:39<00:34, 13.00it/s, est. speed input: 14944.86 toks/s, output: 14.59 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:39<00:34, 13.00it/s, est. speed input: 14919.39 toks/s, output: 14.57 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:40<00:33, 13.00it/s, est. speed input: 14894.90 toks/s, output: 14.55 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:40<00:33, 13.00it/s, est. speed input: 14870.99 toks/s, output: 14.52 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:41<00:32, 13.00it/s, est. speed input: 14847.77 toks/s, output: 14.50 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:42<00:31, 13.00it/s, est. speed input: 14825.38 toks/s, output: 14.48 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:42<00:31, 13.00it/s, est. speed input: 14803.51 toks/s, output: 14.46 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:43<00:30, 13.00it/s, est. speed input: 14782.29 toks/s, output: 14.44 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:43<00:30, 13.00it/s, est. speed input: 14761.73 toks/s, output: 14.42 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:44<00:15, 23.21it/s, est. speed input: 15181.60 toks/s, output: 14.83 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:44<00:17, 19.92it/s, est. speed input: 15156.39 toks/s, output: 14.80 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:45<00:19, 17.74it/s, est. speed input: 15131.87 toks/s, output: 14.78 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:46<00:21, 16.27it/s, est. speed input: 15107.95 toks/s, output: 14.75 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:46<00:21, 15.27it/s, est. speed input: 15084.63 toks/s, output: 14.73 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:47<00:22, 14.58it/s, est. speed input: 15061.99 toks/s, output: 14.71 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:48<00:22, 14.11it/s, est. speed input: 15039.90 toks/s, output: 14.69 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:48<00:22, 13.78it/s, est. speed input: 15018.32 toks/s, output: 14.67 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:49<00:22, 13.55it/s, est. speed input: 14997.27 toks/s, output: 14.65 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:49<00:21, 13.39it/s, est. speed input: 14976.87 toks/s, output: 14.63 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:50<00:21, 13.28it/s, est. speed input: 14957.01 toks/s, output: 14.61 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:51<00:21, 13.20it/s, est. speed input: 14937.46 toks/s, output: 14.59 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:51<00:20, 13.15it/s, est. speed input: 14918.30 toks/s, output: 14.57 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:52<00:19, 13.11it/s, est. speed input: 14899.62 toks/s, output: 14.55 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:52<00:19, 13.07it/s, est. speed input: 14881.00 toks/s, output: 14.53 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:53<00:18, 13.05it/s, est. speed input: 14862.87 toks/s, output: 14.51 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:54<00:18, 13.03it/s, est. speed input: 14845.04 toks/s, output: 14.50 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:54<00:17, 13.02it/s, est. speed input: 14827.73 toks/s, output: 14.48 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:55<00:17, 13.01it/s, est. speed input: 14810.79 toks/s, output: 14.46 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:56<00:16, 13.00it/s, est. speed input: 14794.24 toks/s, output: 14.45 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:56<00:15, 13.00it/s, est. speed input: 14778.01 toks/s, output: 14.43 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:57<00:15, 13.00it/s, est. speed input: 14762.15 toks/s, output: 14.42 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:57<00:14, 12.99it/s, est. speed input: 14746.59 toks/s, output: 14.40 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [00:58<00:14, 12.99it/s, est. speed input: 14731.44 toks/s, output: 14.39 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [00:59<00:13, 12.99it/s, est. speed input: 14716.52 toks/s, output: 14.37 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:59<00:12, 12.99it/s, est. speed input: 14701.94 toks/s, output: 14.36 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [01:00<00:12, 12.99it/s, est. speed input: 14687.64 toks/s, output: 14.34 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [01:00<00:11, 12.99it/s, est. speed input: 14673.54 toks/s, output: 14.33 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [01:01<00:10, 12.98it/s, est. speed input: 14659.66 toks/s, output: 14.32 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [01:02<00:10, 12.98it/s, est. speed input: 14646.03 toks/s, output: 14.30 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [01:02<00:09, 12.98it/s, est. speed input: 14632.72 toks/s, output: 14.29 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [01:03<00:09, 12.98it/s, est. speed input: 14619.65 toks/s, output: 14.28 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [01:04<00:08, 12.98it/s, est. speed input: 14606.84 toks/s, output: 14.26 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [01:04<00:07, 12.98it/s, est. speed input: 14594.25 toks/s, output: 14.25 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [01:05<00:07, 12.98it/s, est. speed input: 14581.88 toks/s, output: 14.24 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [01:05<00:06, 12.97it/s, est. speed input: 14569.70 toks/s, output: 14.23 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [01:06<00:06, 12.97it/s, est. speed input: 14557.78 toks/s, output: 14.22 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [01:07<00:05, 12.97it/s, est. speed input: 14546.07 toks/s, output: 14.21 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [01:07<00:04, 12.97it/s, est. speed input: 14534.52 toks/s, output: 14.19 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [01:08<00:04, 12.97it/s, est. speed input: 14523.25 toks/s, output: 14.18 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [01:09<00:03, 12.98it/s, est. speed input: 14512.39 toks/s, output: 14.17 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [01:09<00:02, 12.98it/s, est. speed input: 14501.72 toks/s, output: 14.16 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [01:10<00:02, 12.98it/s, est. speed input: 14491.18 toks/s, output: 14.15 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [01:10<00:01, 12.99it/s, est. speed input: 14480.84 toks/s, output: 14.14 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [01:11<00:01, 12.99it/s, est. speed input: 14470.76 toks/s, output: 14.13 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [01:12<00:00, 13.46it/s, est. speed input: 14475.26 toks/s, output: 14.14 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [01:12<00:00, 13.46it/s, est. speed input: 14560.51 toks/s, output: 14.22 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [01:12<00:00, 14.22it/s, est. speed input: 14560.51 toks/s, output: 14.22 toks/s]
[rank0]:[W126 07:26:56.926455146 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=16384 ==========
Time: 2026-01-26 07:26:59
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-FP8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=2048, max_num_seqs=16
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-FP8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 2048 --max-num-seqs 16 --max-model-len 1025 --max-num-batched-tokens 16384 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_4/json/Qwen2.5-14B-FP8_M16384.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 07:27:21 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 07:27:22 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=345595) WARNING 01-26 07:27:29 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=345595) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=345595) WARNING 01-26 07:27:48 [backends.py:609] Failed to read file <frozen os>
Throughput: 12.89 requests/s, 13209.26 total tokens/s, 12.89 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048

STDERR:
[2026-01-26 07:27:21] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 07:27:21] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-FP8'
[2026-01-26 07:27:21] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-FP8
[2026-01-26 07:27:21] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:27:21] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:27:21] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:27:21] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:27:21] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:27:21] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-FP8'
[2026-01-26 07:27:21] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 07:27:21] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 07:27:21] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 07:27:21] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 07:27:21] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 07:27:29] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 07:27:29] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-FP8'
[2026-01-26 07:27:29] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-FP8
[2026-01-26 07:27:29] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:27:29] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:27:29] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:27:29] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:27:29] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:27:29] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-FP8'
[2026-01-26 07:27:29] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 07:27:29] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 07:27:29] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 07:27:29] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 07:27:29] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=345595) [2026-01-26 07:27:30] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=345595) [2026-01-26 07:27:30] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=345595) [2026-01-26 07:27:30] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=345595) [2026-01-26 07:27:30] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=345595) [2026-01-26 07:27:30] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-14B-FP8
(EngineCore_DP0 pid=345595) [2026-01-26 07:27:30] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=345595) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=345595) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.02it/s]
(EngineCore_DP0 pid=345595) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:02<00:02,  1.00s/it]
(EngineCore_DP0 pid=345595) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.39it/s]
(EngineCore_DP0 pid=345595) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.23it/s]
(EngineCore_DP0 pid=345595) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.20it/s]
(EngineCore_DP0 pid=345595) 
(EngineCore_DP0 pid=345595) [2026-01-26 07:27:33] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [7168, 5120] -> 1D uint8
(EngineCore_DP0 pid=345595) [2026-01-26 07:27:34] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 27525120 bytes
(EngineCore_DP0 pid=345595) [2026-01-26 07:27:34] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 5120] -> 1D uint8
(EngineCore_DP0 pid=345595) [2026-01-26 07:27:34] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 19660800 bytes
(EngineCore_DP0 pid=345595) [2026-01-26 07:27:34] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [27648, 5120] -> 1D uint8
(EngineCore_DP0 pid=345595) [2026-01-26 07:27:34] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 106168320 bytes
(EngineCore_DP0 pid=345595) [2026-01-26 07:27:34] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 13824] -> 1D uint8
(EngineCore_DP0 pid=345595) [2026-01-26 07:27:34] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 53084160 bytes
(EngineCore_DP0 pid=345595) [rank0]:W0126 07:28:01.496000 345595 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=345595) [rank0]:W0126 07:28:01.575000 345595 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=345595) [rank0]:W0126 07:28:01.454000 345595 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=345595) [rank0]:W0126 07:28:01.572000 345595 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=345595) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  14%|█▍        | 1/7 [00:00<00:01,  4.83it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  29%|██▊       | 2/7 [00:00<00:01,  4.96it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  43%|████▎     | 3/7 [00:00<00:00,  4.46it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  57%|█████▋    | 4/7 [00:01<00:00,  3.18it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  71%|███████▏  | 5/7 [00:01<00:00,  2.77it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  86%|████████▌ | 6/7 [00:01<00:00,  3.29it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:01<00:00,  3.62it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:01<00:00,  3.56it/s]
(EngineCore_DP0 pid=345595) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  20%|██        | 1/5 [00:00<00:00,  4.59it/s]
Capturing CUDA graphs (decode, FULL):  40%|████      | 2/5 [00:00<00:00,  5.02it/s]
Capturing CUDA graphs (decode, FULL):  60%|██████    | 3/5 [00:00<00:00,  5.21it/s]
Capturing CUDA graphs (decode, FULL):  80%|████████  | 4/5 [00:00<00:00,  5.24it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00,  5.29it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00,  5.19it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   1%|          | 24/2048 [00:00<00:08, 234.83it/s]
Adding requests:   2%|▏         | 49/2048 [00:00<00:08, 242.62it/s]
Adding requests:   4%|▎         | 75/2048 [00:00<00:07, 250.28it/s]
Adding requests:   5%|▍         | 101/2048 [00:00<00:08, 241.43it/s]
Adding requests:   6%|▌         | 126/2048 [00:00<00:08, 227.50it/s]
Adding requests:   7%|▋         | 150/2048 [00:00<00:08, 229.20it/s]
Adding requests:   9%|▊         | 176/2048 [00:00<00:07, 236.56it/s]
Adding requests:  10%|▉         | 204/2048 [00:00<00:07, 246.86it/s]
Adding requests:  11%|█▏        | 232/2048 [00:00<00:07, 253.13it/s]
Adding requests:  13%|█▎        | 258/2048 [00:01<00:07, 246.05it/s]
Adding requests:  14%|█▍        | 284/2048 [00:01<00:07, 247.88it/s]
Adding requests:  15%|█▌        | 311/2048 [00:01<00:06, 254.10it/s]
Adding requests:  17%|█▋        | 339/2048 [00:01<00:06, 260.04it/s]
Adding requests:  18%|█▊        | 366/2048 [00:01<00:06, 258.51it/s]
Adding requests:  19%|█▉        | 393/2048 [00:01<00:06, 261.56it/s]
Adding requests:  21%|██        | 421/2048 [00:01<00:06, 266.87it/s]
Adding requests:  22%|██▏       | 448/2048 [00:01<00:06, 259.49it/s]
Adding requests:  23%|██▎       | 476/2048 [00:01<00:05, 264.12it/s]
Adding requests:  25%|██▍       | 504/2048 [00:01<00:05, 266.45it/s]
Adding requests:  26%|██▌       | 534/2048 [00:02<00:05, 273.75it/s]
Adding requests:  27%|██▋       | 562/2048 [00:02<00:05, 268.44it/s]
Adding requests:  29%|██▉       | 589/2048 [00:02<00:05, 260.40it/s]
Adding requests:  30%|███       | 616/2048 [00:02<00:05, 255.91it/s]
Adding requests:  31%|███▏      | 642/2048 [00:02<00:05, 253.00it/s]
Adding requests:  33%|███▎      | 668/2048 [00:02<00:05, 248.95it/s]
Adding requests:  34%|███▍      | 695/2048 [00:02<00:05, 254.00it/s]
Adding requests:  35%|███▌      | 721/2048 [00:02<00:05, 251.71it/s]
Adding requests:  36%|███▋      | 747/2048 [00:02<00:05, 250.51it/s]
Adding requests:  38%|███▊      | 773/2048 [00:03<00:05, 246.41it/s]
Adding requests:  39%|███▉      | 799/2048 [00:03<00:05, 249.67it/s]
Adding requests:  40%|████      | 825/2048 [00:03<00:04, 251.72it/s]
Adding requests:  42%|████▏     | 853/2048 [00:03<00:04, 258.64it/s]
Adding requests:  43%|████▎     | 880/2048 [00:03<00:04, 259.77it/s]
Adding requests:  44%|████▍     | 907/2048 [00:03<00:04, 260.60it/s]
Adding requests:  46%|████▌     | 934/2048 [00:03<00:04, 255.53it/s]
Adding requests:  47%|████▋     | 961/2048 [00:03<00:04, 258.80it/s]
Adding requests:  48%|████▊     | 987/2048 [00:03<00:04, 258.55it/s]
Adding requests:  49%|████▉     | 1013/2048 [00:03<00:04, 254.33it/s]
Adding requests:  51%|█████     | 1040/2048 [00:04<00:03, 258.51it/s]
Adding requests:  52%|█████▏    | 1066/2048 [00:04<00:03, 255.62it/s]
Adding requests:  53%|█████▎    | 1092/2048 [00:04<00:03, 252.63it/s]
Adding requests:  55%|█████▍    | 1119/2048 [00:04<00:03, 256.39it/s]
Adding requests:  56%|█████▌    | 1147/2048 [00:04<00:03, 260.16it/s]
Adding requests:  57%|█████▋    | 1174/2048 [00:04<00:03, 258.53it/s]
Adding requests:  59%|█████▊    | 1200/2048 [00:04<00:03, 258.26it/s]
Adding requests:  60%|█████▉    | 1228/2048 [00:04<00:03, 264.10it/s]
Adding requests:  61%|██████▏   | 1255/2048 [00:04<00:03, 259.23it/s]
Adding requests:  63%|██████▎   | 1281/2048 [00:05<00:03, 254.92it/s]
Adding requests:  64%|██████▍   | 1307/2048 [00:05<00:02, 252.55it/s]
Adding requests:  65%|██████▌   | 1333/2048 [00:05<00:02, 251.20it/s]
Adding requests:  66%|██████▋   | 1361/2048 [00:05<00:02, 257.86it/s]
Adding requests:  68%|██████▊   | 1387/2048 [00:05<00:02, 255.81it/s]
Adding requests:  69%|██████▉   | 1413/2048 [00:05<00:02, 254.56it/s]
Adding requests:  70%|███████   | 1440/2048 [00:05<00:02, 256.42it/s]
Adding requests:  72%|███████▏  | 1466/2048 [00:05<00:02, 254.69it/s]
Adding requests:  73%|███████▎  | 1493/2048 [00:05<00:02, 258.63it/s]
Adding requests:  74%|███████▍  | 1519/2048 [00:05<00:02, 258.00it/s]
Adding requests:  75%|███████▌  | 1545/2048 [00:06<00:01, 255.87it/s]
Adding requests:  77%|███████▋  | 1571/2048 [00:06<00:01, 244.41it/s]
Adding requests:  78%|███████▊  | 1597/2048 [00:06<00:01, 247.35it/s]
Adding requests:  79%|███████▉  | 1622/2048 [00:06<00:01, 246.74it/s]
Adding requests:  80%|████████  | 1647/2048 [00:06<00:01, 245.71it/s]
Adding requests:  82%|████████▏ | 1673/2048 [00:06<00:01, 247.29it/s]
Adding requests:  83%|████████▎ | 1699/2048 [00:06<00:01, 250.82it/s]
Adding requests:  84%|████████▍ | 1727/2048 [00:06<00:01, 257.56it/s]
Adding requests:  86%|████████▌ | 1754/2048 [00:06<00:01, 259.88it/s]
Adding requests:  87%|████████▋ | 1782/2048 [00:06<00:01, 264.20it/s]
Adding requests:  88%|████████▊ | 1809/2048 [00:07<00:00, 262.62it/s]
Adding requests:  90%|████████▉ | 1836/2048 [00:07<00:00, 257.99it/s]
Adding requests:  91%|█████████ | 1863/2048 [00:07<00:00, 259.56it/s]
Adding requests:  92%|█████████▏| 1890/2048 [00:07<00:00, 261.70it/s]
Adding requests:  94%|█████████▎| 1918/2048 [00:07<00:00, 266.22it/s]
Adding requests:  95%|█████████▍| 1945/2048 [00:07<00:00, 257.05it/s]
Adding requests:  96%|█████████▌| 1971/2048 [00:07<00:00, 256.88it/s]
Adding requests:  98%|█████████▊| 1997/2048 [00:07<00:00, 256.19it/s]
Adding requests:  99%|█████████▉| 2023/2048 [00:07<00:00, 254.14it/s]
Adding requests: 100%|██████████| 2048/2048 [00:08<00:00, 254.94it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   4%|▍         | 82/2048 [00:00<00:11, 178.63it/s, est. speed input: 182925.18 toks/s, output: 178.63 toks/s]
Processed prompts:   5%|▍         | 100/2048 [00:01<00:39, 48.90it/s, est. speed input: 60965.63 toks/s, output: 59.54 toks/s]  
Processed prompts:   6%|▌         | 114/2048 [00:02<01:06, 29.01it/s, est. speed input: 40221.91 toks/s, output: 39.28 toks/s]
Processed prompts:   6%|▋         | 130/2048 [00:04<01:27, 21.80it/s, est. speed input: 31929.52 toks/s, output: 31.18 toks/s]
Processed prompts:   7%|▋         | 146/2048 [00:05<01:42, 18.50it/s, est. speed input: 27723.86 toks/s, output: 27.07 toks/s]
Processed prompts:   8%|▊         | 162/2048 [00:06<01:53, 16.59it/s, est. speed input: 25067.30 toks/s, output: 24.48 toks/s]
Processed prompts:   9%|▊         | 178/2048 [00:07<02:01, 15.41it/s, est. speed input: 23239.89 toks/s, output: 22.70 toks/s]
Processed prompts:   9%|▉         | 194/2048 [00:09<02:06, 14.65it/s, est. speed input: 21904.20 toks/s, output: 21.39 toks/s]
Processed prompts:  10%|█         | 210/2048 [00:10<02:09, 14.14it/s, est. speed input: 20885.60 toks/s, output: 20.40 toks/s]
Processed prompts:  12%|█▏        | 242/2048 [00:11<01:35, 18.87it/s, est. speed input: 21907.80 toks/s, output: 21.39 toks/s]
Processed prompts:  13%|█▎        | 258/2048 [00:12<01:45, 17.00it/s, est. speed input: 21067.25 toks/s, output: 20.57 toks/s]
Processed prompts:  13%|█▎        | 274/2048 [00:13<01:52, 15.75it/s, est. speed input: 20376.19 toks/s, output: 19.90 toks/s]
Processed prompts:  14%|█▍        | 290/2048 [00:14<01:57, 14.90it/s, est. speed input: 19798.08 toks/s, output: 19.33 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [00:16<02:01, 14.32it/s, est. speed input: 19307.10 toks/s, output: 18.85 toks/s]
Processed prompts:  16%|█▌        | 322/2048 [00:17<02:04, 13.92it/s, est. speed input: 18883.89 toks/s, output: 18.44 toks/s]
Processed prompts:  17%|█▋        | 338/2048 [00:18<02:05, 13.64it/s, est. speed input: 18516.25 toks/s, output: 18.08 toks/s]
Processed prompts:  17%|█▋        | 354/2048 [00:19<02:06, 13.44it/s, est. speed input: 18193.52 toks/s, output: 17.77 toks/s]
Processed prompts:  18%|█▊        | 370/2048 [00:21<02:06, 13.30it/s, est. speed input: 17907.37 toks/s, output: 17.49 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [00:22<02:05, 13.20it/s, est. speed input: 17652.62 toks/s, output: 17.24 toks/s]
Processed prompts:  20%|█▉        | 402/2048 [00:23<02:05, 13.13it/s, est. speed input: 17425.04 toks/s, output: 17.02 toks/s]
Processed prompts:  20%|██        | 418/2048 [00:24<02:04, 13.08it/s, est. speed input: 17219.51 toks/s, output: 16.82 toks/s]
Processed prompts:  21%|██        | 434/2048 [00:26<02:03, 13.05it/s, est. speed input: 17033.34 toks/s, output: 16.63 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [00:27<02:02, 13.03it/s, est. speed input: 16864.42 toks/s, output: 16.47 toks/s]
Processed prompts:  23%|██▎       | 466/2048 [00:28<02:01, 13.01it/s, est. speed input: 16710.02 toks/s, output: 16.32 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [00:29<02:00, 13.00it/s, est. speed input: 16568.76 toks/s, output: 16.18 toks/s]
Processed prompts:  24%|██▍       | 498/2048 [00:31<01:59, 13.00it/s, est. speed input: 16438.45 toks/s, output: 16.05 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [00:32<01:58, 12.99it/s, est. speed input: 16318.59 toks/s, output: 15.94 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [00:33<01:56, 12.99it/s, est. speed input: 16207.41 toks/s, output: 15.83 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [00:34<01:55, 12.99it/s, est. speed input: 16104.42 toks/s, output: 15.73 toks/s]
Processed prompts:  27%|██▋       | 562/2048 [00:35<01:54, 12.99it/s, est. speed input: 16008.23 toks/s, output: 15.63 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [00:37<01:53, 12.99it/s, est. speed input: 15918.60 toks/s, output: 15.55 toks/s]
Processed prompts:  29%|██▉       | 594/2048 [00:38<01:51, 12.99it/s, est. speed input: 15834.75 toks/s, output: 15.46 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [00:39<01:50, 12.99it/s, est. speed input: 15756.06 toks/s, output: 15.39 toks/s]
Processed prompts:  31%|███       | 626/2048 [00:40<01:49, 12.98it/s, est. speed input: 15681.40 toks/s, output: 15.31 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [00:42<01:48, 12.98it/s, est. speed input: 15611.24 toks/s, output: 15.25 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [00:43<01:17, 17.76it/s, est. speed input: 15998.89 toks/s, output: 15.62 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [00:44<01:23, 16.27it/s, est. speed input: 15923.21 toks/s, output: 15.55 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [00:45<01:27, 15.25it/s, est. speed input: 15851.53 toks/s, output: 15.48 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [00:46<01:31, 14.55it/s, est. speed input: 15783.74 toks/s, output: 15.41 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [00:48<01:33, 14.07it/s, est. speed input: 15719.36 toks/s, output: 15.35 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [00:49<01:34, 13.74it/s, est. speed input: 15658.13 toks/s, output: 15.29 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [00:50<01:34, 13.50it/s, est. speed input: 15599.94 toks/s, output: 15.23 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [00:51<01:34, 13.34it/s, est. speed input: 15544.42 toks/s, output: 15.18 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [00:53<01:34, 13.23it/s, est. speed input: 15491.60 toks/s, output: 15.13 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [00:54<01:33, 13.15it/s, est. speed input: 15441.29 toks/s, output: 15.08 toks/s]
Processed prompts:  41%|████      | 834/2048 [00:55<01:32, 13.09it/s, est. speed input: 15393.12 toks/s, output: 15.03 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [00:56<01:31, 13.05it/s, est. speed input: 15346.98 toks/s, output: 14.99 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [00:57<01:30, 13.03it/s, est. speed input: 15302.74 toks/s, output: 14.94 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [00:59<01:29, 13.01it/s, est. speed input: 15260.39 toks/s, output: 14.90 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [01:00<01:28, 12.99it/s, est. speed input: 15219.66 toks/s, output: 14.86 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [01:01<01:27, 12.98it/s, est. speed input: 15180.60 toks/s, output: 14.82 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [01:02<01:26, 12.98it/s, est. speed input: 15143.23 toks/s, output: 14.79 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [01:04<01:24, 12.97it/s, est. speed input: 15107.23 toks/s, output: 14.75 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [01:05<01:23, 12.97it/s, est. speed input: 15072.64 toks/s, output: 14.72 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [01:06<01:22, 12.97it/s, est. speed input: 15039.26 toks/s, output: 14.69 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [01:07<01:21, 12.97it/s, est. speed input: 15007.11 toks/s, output: 14.66 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [01:09<01:20, 12.97it/s, est. speed input: 14976.17 toks/s, output: 14.63 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [01:10<01:18, 12.96it/s, est. speed input: 14946.17 toks/s, output: 14.60 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [01:11<01:17, 12.96it/s, est. speed input: 14917.30 toks/s, output: 14.57 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [01:12<01:16, 12.96it/s, est. speed input: 14889.41 toks/s, output: 14.54 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [01:13<00:54, 17.73it/s, est. speed input: 15125.54 toks/s, output: 14.77 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [01:15<00:57, 16.25it/s, est. speed input: 15095.10 toks/s, output: 14.74 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [01:16<01:00, 15.24it/s, est. speed input: 15065.69 toks/s, output: 14.71 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [01:17<01:02, 14.54it/s, est. speed input: 15037.13 toks/s, output: 14.68 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [01:18<01:03, 14.07it/s, est. speed input: 15009.55 toks/s, output: 14.66 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [01:19<01:03, 13.73it/s, est. speed input: 14982.75 toks/s, output: 14.63 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [01:21<01:03, 13.50it/s, est. speed input: 14956.64 toks/s, output: 14.61 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [01:22<01:03, 13.34it/s, est. speed input: 14931.39 toks/s, output: 14.58 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [01:23<01:02, 13.22it/s, est. speed input: 14906.82 toks/s, output: 14.56 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [01:24<01:01, 13.14it/s, est. speed input: 14882.93 toks/s, output: 14.53 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [01:26<01:00, 13.08it/s, est. speed input: 14859.75 toks/s, output: 14.51 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [01:27<00:59, 13.05it/s, est. speed input: 14837.26 toks/s, output: 14.49 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [01:28<00:58, 13.02it/s, est. speed input: 14815.35 toks/s, output: 14.47 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [01:29<00:57, 13.00it/s, est. speed input: 14794.16 toks/s, output: 14.45 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [01:31<00:56, 12.99it/s, est. speed input: 14773.43 toks/s, output: 14.43 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [01:32<00:55, 12.98it/s, est. speed input: 14753.23 toks/s, output: 14.41 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [01:33<00:54, 12.97it/s, est. speed input: 14733.58 toks/s, output: 14.39 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [01:34<00:52, 12.96it/s, est. speed input: 14714.40 toks/s, output: 14.37 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [01:36<00:51, 12.96it/s, est. speed input: 14695.77 toks/s, output: 14.35 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [01:37<00:50, 12.96it/s, est. speed input: 14677.59 toks/s, output: 14.33 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [01:38<00:49, 12.96it/s, est. speed input: 14659.91 toks/s, output: 14.32 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [01:39<00:47, 12.96it/s, est. speed input: 14642.80 toks/s, output: 14.30 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [01:40<00:46, 12.96it/s, est. speed input: 14625.80 toks/s, output: 14.28 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [01:42<00:45, 12.96it/s, est. speed input: 14609.36 toks/s, output: 14.27 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [01:43<00:44, 12.96it/s, est. speed input: 14593.33 toks/s, output: 14.25 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [01:44<00:30, 17.74it/s, est. speed input: 14763.56 toks/s, output: 14.42 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [01:45<00:32, 16.26it/s, est. speed input: 14746.28 toks/s, output: 14.40 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [01:46<00:33, 15.25it/s, est. speed input: 14729.40 toks/s, output: 14.38 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [01:48<00:33, 14.55it/s, est. speed input: 14712.95 toks/s, output: 14.37 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [01:49<00:33, 14.07it/s, est. speed input: 14696.81 toks/s, output: 14.35 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [01:50<00:33, 13.74it/s, est. speed input: 14681.05 toks/s, output: 14.34 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [01:51<00:33, 13.51it/s, est. speed input: 14665.64 toks/s, output: 14.32 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [01:53<00:32, 13.34it/s, est. speed input: 14650.33 toks/s, output: 14.31 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [01:54<00:31, 13.22it/s, est. speed input: 14635.25 toks/s, output: 14.29 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [01:55<00:30, 13.14it/s, est. speed input: 14620.44 toks/s, output: 14.28 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [01:56<00:29, 13.08it/s, est. speed input: 14606.05 toks/s, output: 14.26 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [01:58<00:28, 13.04it/s, est. speed input: 14591.90 toks/s, output: 14.25 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [01:59<00:26, 13.01it/s, est. speed input: 14578.09 toks/s, output: 14.24 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [02:00<00:25, 12.99it/s, est. speed input: 14564.47 toks/s, output: 14.22 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [02:01<00:24, 12.97it/s, est. speed input: 14551.06 toks/s, output: 14.21 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [02:02<00:23, 12.96it/s, est. speed input: 14537.89 toks/s, output: 14.20 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [02:04<00:22, 12.95it/s, est. speed input: 14525.00 toks/s, output: 14.18 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [02:05<00:20, 12.95it/s, est. speed input: 14512.30 toks/s, output: 14.17 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [02:06<00:19, 12.94it/s, est. speed input: 14499.95 toks/s, output: 14.16 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [02:07<00:18, 12.94it/s, est. speed input: 14487.82 toks/s, output: 14.15 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [02:09<00:17, 12.94it/s, est. speed input: 14476.04 toks/s, output: 14.14 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [02:10<00:15, 12.94it/s, est. speed input: 14464.53 toks/s, output: 14.13 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [02:11<00:14, 12.95it/s, est. speed input: 14453.23 toks/s, output: 14.11 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [02:12<00:13, 12.95it/s, est. speed input: 14442.18 toks/s, output: 14.10 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [02:14<00:12, 12.95it/s, est. speed input: 14431.44 toks/s, output: 14.09 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [02:15<00:10, 12.95it/s, est. speed input: 14420.68 toks/s, output: 14.08 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [02:16<00:06, 17.76it/s, est. speed input: 14552.94 toks/s, output: 14.21 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [02:17<00:05, 16.28it/s, est. speed input: 14541.96 toks/s, output: 14.20 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [02:18<00:05, 15.28it/s, est. speed input: 14531.22 toks/s, output: 14.19 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [02:20<00:04, 14.59it/s, est. speed input: 14520.62 toks/s, output: 14.18 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [02:21<00:03, 14.11it/s, est. speed input: 14510.22 toks/s, output: 14.17 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [02:22<00:02, 13.78it/s, est. speed input: 14500.04 toks/s, output: 14.16 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [02:23<00:01, 13.80it/s, est. speed input: 14497.41 toks/s, output: 14.16 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [02:23<00:00, 13.80it/s, est. speed input: 14597.16 toks/s, output: 14.26 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [02:23<00:00, 14.26it/s, est. speed input: 14597.16 toks/s, output: 14.26 toks/s]
[rank0]:[W126 07:30:45.227723397 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=32768 ==========
Time: 2026-01-26 07:30:48
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-FP8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=4096, max_num_seqs=32
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-FP8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 4096 --max-num-seqs 32 --max-model-len 1025 --max-num-batched-tokens 32768 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_4/json/Qwen2.5-14B-FP8_M32768.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 07:31:26 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 07:31:27 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=349381) WARNING 01-26 07:31:35 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=349381) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=349381) WARNING 01-26 07:31:54 [backends.py:609] Failed to read file <frozen os>
Throughput: 12.86 requests/s, 13180.18 total tokens/s, 12.86 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096

STDERR:
[2026-01-26 07:31:26] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 07:31:26] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-FP8'
[2026-01-26 07:31:26] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-FP8
[2026-01-26 07:31:26] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:31:26] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:31:26] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:31:26] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:31:26] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:31:26] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-FP8'
[2026-01-26 07:31:26] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 07:31:26] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 07:31:26] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 07:31:26] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 07:31:26] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 07:31:34] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 07:31:34] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-FP8'
[2026-01-26 07:31:34] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-FP8
[2026-01-26 07:31:34] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:31:34] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:31:34] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:31:34] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:31:34] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:31:34] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-FP8'
[2026-01-26 07:31:34] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 07:31:34] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 07:31:34] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 07:31:34] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 07:31:34] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=349381) [2026-01-26 07:31:35] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=349381) [2026-01-26 07:31:35] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=349381) [2026-01-26 07:31:35] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=349381) [2026-01-26 07:31:35] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=349381) [2026-01-26 07:31:35] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-14B-FP8
(EngineCore_DP0 pid=349381) [2026-01-26 07:31:35] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=349381) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=349381) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:01<00:04,  1.39s/it]
(EngineCore_DP0 pid=349381) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:01<00:00,  1.81it/s]
(EngineCore_DP0 pid=349381) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.20it/s]
(EngineCore_DP0 pid=349381) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.22it/s]
(EngineCore_DP0 pid=349381) 
(EngineCore_DP0 pid=349381) [2026-01-26 07:31:39] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [7168, 5120] -> 1D uint8
(EngineCore_DP0 pid=349381) [2026-01-26 07:31:39] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 27525120 bytes
(EngineCore_DP0 pid=349381) [2026-01-26 07:31:39] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 5120] -> 1D uint8
(EngineCore_DP0 pid=349381) [2026-01-26 07:31:39] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 19660800 bytes
(EngineCore_DP0 pid=349381) [2026-01-26 07:31:39] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [27648, 5120] -> 1D uint8
(EngineCore_DP0 pid=349381) [2026-01-26 07:31:39] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 106168320 bytes
(EngineCore_DP0 pid=349381) [2026-01-26 07:31:39] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 13824] -> 1D uint8
(EngineCore_DP0 pid=349381) [2026-01-26 07:31:39] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 53084160 bytes
(EngineCore_DP0 pid=349381) [rank0]:W0126 07:32:07.854000 349381 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=349381) [rank0]:W0126 07:32:07.936000 349381 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=349381) [rank0]:W0126 07:32:09.137000 349381 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=349381) [rank0]:W0126 07:32:09.258000 349381 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=349381) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   9%|▉         | 1/11 [00:00<00:05,  1.80it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  18%|█▊        | 2/11 [00:00<00:03,  2.89it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  27%|██▋       | 3/11 [00:00<00:02,  3.64it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  36%|███▋      | 4/11 [00:01<00:01,  4.17it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  45%|████▌     | 5/11 [00:01<00:01,  4.51it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  55%|█████▍    | 6/11 [00:01<00:01,  4.70it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  64%|██████▎   | 7/11 [00:01<00:00,  4.84it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  73%|███████▎  | 8/11 [00:01<00:00,  4.96it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  82%|████████▏ | 9/11 [00:02<00:00,  5.06it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  91%|█████████ | 10/11 [00:02<00:00,  5.16it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:02<00:00,  4.78it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:02<00:00,  4.36it/s]
(EngineCore_DP0 pid=349381) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  14%|█▍        | 1/7 [00:00<00:01,  4.42it/s]
Capturing CUDA graphs (decode, FULL):  29%|██▊       | 2/7 [00:00<00:01,  3.77it/s]
Capturing CUDA graphs (decode, FULL):  43%|████▎     | 3/7 [00:00<00:01,  3.96it/s]
Capturing CUDA graphs (decode, FULL):  57%|█████▋    | 4/7 [00:01<00:00,  3.62it/s]
Capturing CUDA graphs (decode, FULL):  71%|███████▏  | 5/7 [00:01<00:00,  4.11it/s]
Capturing CUDA graphs (decode, FULL):  86%|████████▌ | 6/7 [00:01<00:00,  4.48it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:01<00:00,  4.76it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:01<00:00,  4.32it/s]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   1%|          | 22/4096 [00:00<00:18, 217.63it/s]
Adding requests:   1%|          | 47/4096 [00:00<00:17, 236.31it/s]
Adding requests:   2%|▏         | 73/4096 [00:00<00:16, 243.35it/s]
Adding requests:   2%|▏         | 98/4096 [00:00<00:16, 242.73it/s]
Adding requests:   3%|▎         | 123/4096 [00:00<00:16, 243.67it/s]
Adding requests:   4%|▎         | 148/4096 [00:00<00:16, 242.16it/s]
Adding requests:   4%|▍         | 174/4096 [00:00<00:15, 246.78it/s]
Adding requests:   5%|▍         | 200/4096 [00:00<00:15, 250.67it/s]
Adding requests:   6%|▌         | 227/4096 [00:00<00:15, 254.13it/s]
Adding requests:   6%|▌         | 253/4096 [00:01<00:15, 253.80it/s]
Adding requests:   7%|▋         | 280/4096 [00:01<00:14, 257.59it/s]
Adding requests:   7%|▋         | 306/4096 [00:01<00:14, 257.03it/s]
Adding requests:   8%|▊         | 333/4096 [00:01<00:14, 260.39it/s]
Adding requests:   9%|▉         | 361/4096 [00:01<00:14, 263.62it/s]
Adding requests:   9%|▉         | 388/4096 [00:01<00:14, 263.64it/s]
Adding requests:  10%|█         | 416/4096 [00:01<00:13, 266.88it/s]
Adding requests:  11%|█         | 443/4096 [00:01<00:13, 261.70it/s]
Adding requests:  11%|█▏        | 471/4096 [00:01<00:13, 265.41it/s]
Adding requests:  12%|█▏        | 499/4096 [00:01<00:13, 268.50it/s]
Adding requests:  13%|█▎        | 529/4096 [00:02<00:12, 274.48it/s]
Adding requests:  14%|█▎        | 557/4096 [00:02<00:13, 270.98it/s]
Adding requests:  14%|█▍        | 585/4096 [00:02<00:13, 265.25it/s]
Adding requests:  15%|█▍        | 612/4096 [00:02<00:13, 261.63it/s]
Adding requests:  16%|█▌        | 640/4096 [00:02<00:13, 264.50it/s]
Adding requests:  16%|█▋        | 667/4096 [00:02<00:13, 257.23it/s]
Adding requests:  17%|█▋        | 695/4096 [00:02<00:13, 261.48it/s]
Adding requests:  18%|█▊        | 722/4096 [00:02<00:13, 258.48it/s]
Adding requests:  18%|█▊        | 748/4096 [00:02<00:13, 255.27it/s]
Adding requests:  19%|█▉        | 774/4096 [00:03<00:13, 255.08it/s]
Adding requests:  20%|█▉        | 800/4096 [00:03<00:12, 256.21it/s]
Adding requests:  20%|██        | 827/4096 [00:03<00:12, 258.80it/s]
Adding requests:  21%|██        | 854/4096 [00:03<00:12, 261.41it/s]
Adding requests:  22%|██▏       | 881/4096 [00:03<00:12, 261.26it/s]
Adding requests:  22%|██▏       | 908/4096 [00:03<00:12, 260.37it/s]
Adding requests:  23%|██▎       | 935/4096 [00:03<00:12, 251.20it/s]
Adding requests:  23%|██▎       | 962/4096 [00:03<00:12, 253.62it/s]
Adding requests:  24%|██▍       | 988/4096 [00:03<00:12, 250.61it/s]
Adding requests:  25%|██▍       | 1014/4096 [00:03<00:12, 246.93it/s]
Adding requests:  25%|██▌       | 1041/4096 [00:04<00:12, 252.18it/s]
Adding requests:  26%|██▌       | 1067/4096 [00:04<00:12, 251.75it/s]
Adding requests:  27%|██▋       | 1093/4096 [00:04<00:11, 253.12it/s]
Adding requests:  27%|██▋       | 1120/4096 [00:04<00:11, 254.86it/s]
Adding requests:  28%|██▊       | 1148/4096 [00:04<00:11, 259.42it/s]
Adding requests:  29%|██▊       | 1175/4096 [00:04<00:11, 260.91it/s]
Adding requests:  29%|██▉       | 1202/4096 [00:04<00:11, 250.69it/s]
Adding requests:  30%|███       | 1230/4096 [00:04<00:11, 257.47it/s]
Adding requests:  31%|███       | 1257/4096 [00:04<00:10, 258.66it/s]
Adding requests:  31%|███▏      | 1283/4096 [00:04<00:11, 254.17it/s]
Adding requests:  32%|███▏      | 1309/4096 [00:05<00:10, 253.67it/s]
Adding requests:  33%|███▎      | 1336/4096 [00:05<00:10, 256.12it/s]
Adding requests:  33%|███▎      | 1362/4096 [00:05<00:10, 251.75it/s]
Adding requests:  34%|███▍      | 1388/4096 [00:05<00:10, 251.61it/s]
Adding requests:  35%|███▍      | 1414/4096 [00:05<00:10, 252.47it/s]
Adding requests:  35%|███▌      | 1442/4096 [00:05<00:10, 257.57it/s]
Adding requests:  36%|███▌      | 1468/4096 [00:05<00:10, 253.71it/s]
Adding requests:  36%|███▋      | 1494/4096 [00:05<00:10, 252.18it/s]
Adding requests:  37%|███▋      | 1520/4096 [00:05<00:10, 253.30it/s]
Adding requests:  38%|███▊      | 1546/4096 [00:06<00:10, 254.67it/s]
Adding requests:  38%|███▊      | 1572/4096 [00:06<00:10, 250.26it/s]
Adding requests:  39%|███▉      | 1598/4096 [00:06<00:10, 249.42it/s]
Adding requests:  40%|███▉      | 1623/4096 [00:06<00:09, 247.39it/s]
Adding requests:  40%|████      | 1648/4096 [00:06<00:09, 246.71it/s]
Adding requests:  41%|████      | 1673/4096 [00:06<00:09, 245.37it/s]
Adding requests:  41%|████▏     | 1698/4096 [00:06<00:09, 246.07it/s]
Adding requests:  42%|████▏     | 1725/4096 [00:06<00:09, 252.67it/s]
Adding requests:  43%|████▎     | 1751/4096 [00:06<00:09, 253.10it/s]
Adding requests:  43%|████▎     | 1777/4096 [00:06<00:09, 253.97it/s]
Adding requests:  44%|████▍     | 1803/4096 [00:07<00:09, 251.53it/s]
Adding requests:  45%|████▍     | 1830/4096 [00:07<00:08, 255.34it/s]
Adding requests:  45%|████▌     | 1857/4096 [00:07<00:08, 259.09it/s]
Adding requests:  46%|████▌     | 1883/4096 [00:07<00:08, 259.22it/s]
Adding requests:  47%|████▋     | 1910/4096 [00:07<00:08, 260.46it/s]
Adding requests:  47%|████▋     | 1938/4096 [00:07<00:08, 265.89it/s]
Adding requests:  48%|████▊     | 1965/4096 [00:07<00:08, 265.36it/s]
Adding requests:  49%|████▊     | 1992/4096 [00:07<00:08, 261.61it/s]
Adding requests:  49%|████▉     | 2019/4096 [00:07<00:08, 253.22it/s]
Adding requests:  50%|████▉     | 2046/4096 [00:08<00:08, 255.04it/s]
Adding requests:  51%|█████     | 2072/4096 [00:08<00:08, 249.23it/s]
Adding requests:  51%|█████     | 2099/4096 [00:08<00:07, 254.21it/s]
Adding requests:  52%|█████▏    | 2126/4096 [00:08<00:07, 257.83it/s]
Adding requests:  53%|█████▎    | 2152/4096 [00:08<00:07, 257.44it/s]
Adding requests:  53%|█████▎    | 2178/4096 [00:08<00:07, 252.49it/s]
Adding requests:  54%|█████▍    | 2204/4096 [00:08<00:07, 251.79it/s]
Adding requests:  54%|█████▍    | 2231/4096 [00:08<00:07, 256.06it/s]
Adding requests:  55%|█████▌    | 2258/4096 [00:08<00:07, 259.88it/s]
Adding requests:  56%|█████▌    | 2285/4096 [00:08<00:07, 255.70it/s]
Adding requests:  56%|█████▋    | 2312/4096 [00:09<00:06, 257.83it/s]
Adding requests:  57%|█████▋    | 2338/4096 [00:09<00:06, 258.11it/s]
Adding requests:  58%|█████▊    | 2365/4096 [00:09<00:06, 258.51it/s]
Adding requests:  58%|█████▊    | 2393/4096 [00:09<00:06, 263.54it/s]
Adding requests:  59%|█████▉    | 2420/4096 [00:09<00:06, 264.05it/s]
Adding requests:  60%|█████▉    | 2447/4096 [00:09<00:06, 250.56it/s]
Adding requests:  60%|██████    | 2474/4096 [00:09<00:06, 254.54it/s]
Adding requests:  61%|██████    | 2501/4096 [00:09<00:06, 257.98it/s]
Adding requests:  62%|██████▏   | 2527/4096 [00:09<00:06, 247.43it/s]
Adding requests:  62%|██████▏   | 2555/4096 [00:09<00:06, 254.09it/s]
Adding requests:  63%|██████▎   | 2581/4096 [00:10<00:05, 255.67it/s]
Adding requests:  64%|██████▎   | 2607/4096 [00:10<00:05, 254.44it/s]
Adding requests:  64%|██████▍   | 2633/4096 [00:10<00:05, 250.04it/s]
Adding requests:  65%|██████▍   | 2659/4096 [00:10<00:05, 250.99it/s]
Adding requests:  66%|██████▌   | 2685/4096 [00:10<00:05, 251.10it/s]
Adding requests:  66%|██████▌   | 2711/4096 [00:10<00:05, 248.10it/s]
Adding requests:  67%|██████▋   | 2738/4096 [00:10<00:05, 252.02it/s]
Adding requests:  68%|██████▊   | 2767/4096 [00:10<00:05, 261.00it/s]
Adding requests:  68%|██████▊   | 2795/4096 [00:10<00:04, 265.78it/s]
Adding requests:  69%|██████▉   | 2822/4096 [00:11<00:04, 265.11it/s]
Adding requests:  70%|██████▉   | 2850/4096 [00:11<00:04, 267.08it/s]
Adding requests:  70%|███████   | 2877/4096 [00:11<00:04, 266.28it/s]
Adding requests:  71%|███████   | 2904/4096 [00:11<00:04, 267.02it/s]
Adding requests:  72%|███████▏  | 2931/4096 [00:11<00:04, 265.14it/s]
Adding requests:  72%|███████▏  | 2960/4096 [00:11<00:04, 272.19it/s]
Adding requests:  73%|███████▎  | 2988/4096 [00:11<00:04, 265.94it/s]
Adding requests:  74%|███████▎  | 3015/4096 [00:11<00:04, 265.77it/s]
Adding requests:  74%|███████▍  | 3043/4096 [00:11<00:03, 267.04it/s]
Adding requests:  75%|███████▍  | 3070/4096 [00:11<00:03, 264.79it/s]
Adding requests:  76%|███████▌  | 3097/4096 [00:12<00:03, 261.67it/s]
Adding requests:  76%|███████▋  | 3124/4096 [00:12<00:03, 262.66it/s]
Adding requests:  77%|███████▋  | 3151/4096 [00:12<00:03, 261.71it/s]
Adding requests:  78%|███████▊  | 3178/4096 [00:12<00:03, 256.81it/s]
Adding requests:  78%|███████▊  | 3204/4096 [00:12<00:03, 254.62it/s]
Adding requests:  79%|███████▉  | 3232/4096 [00:12<00:03, 260.16it/s]
Adding requests:  80%|███████▉  | 3259/4096 [00:12<00:03, 256.59it/s]
Adding requests:  80%|████████  | 3285/4096 [00:12<00:03, 248.83it/s]
Adding requests:  81%|████████  | 3310/4096 [00:12<00:03, 241.68it/s]
Adding requests:  81%|████████▏ | 3336/4096 [00:13<00:03, 246.16it/s]
Adding requests:  82%|████████▏ | 3362/4096 [00:13<00:02, 249.91it/s]
Adding requests:  83%|████████▎ | 3389/4096 [00:13<00:02, 254.87it/s]
Adding requests:  83%|████████▎ | 3415/4096 [00:13<00:02, 254.89it/s]
Adding requests:  84%|████████▍ | 3443/4096 [00:13<00:02, 259.34it/s]
Adding requests:  85%|████████▍ | 3470/4096 [00:13<00:02, 260.93it/s]
Adding requests:  85%|████████▌ | 3497/4096 [00:13<00:02, 259.26it/s]
Adding requests:  86%|████████▌ | 3526/4096 [00:13<00:02, 267.85it/s]
Adding requests:  87%|████████▋ | 3554/4096 [00:13<00:01, 271.10it/s]
Adding requests:  87%|████████▋ | 3582/4096 [00:13<00:01, 262.65it/s]
Adding requests:  88%|████████▊ | 3609/4096 [00:14<00:01, 261.18it/s]
Adding requests:  89%|████████▉ | 3637/4096 [00:14<00:01, 263.81it/s]
Adding requests:  89%|████████▉ | 3664/4096 [00:14<00:01, 259.06it/s]
Adding requests:  90%|█████████ | 3690/4096 [00:14<00:01, 256.65it/s]
Adding requests:  91%|█████████ | 3719/4096 [00:14<00:01, 264.85it/s]
Adding requests:  91%|█████████▏| 3746/4096 [00:14<00:01, 262.03it/s]
Adding requests:  92%|█████████▏| 3773/4096 [00:14<00:01, 258.07it/s]
Adding requests:  93%|█████████▎| 3799/4096 [00:14<00:01, 240.94it/s]
Adding requests:  93%|█████████▎| 3824/4096 [00:14<00:01, 241.87it/s]
Adding requests:  94%|█████████▍| 3849/4096 [00:15<00:01, 243.01it/s]
Adding requests:  95%|█████████▍| 3875/4096 [00:15<00:00, 246.84it/s]
Adding requests:  95%|█████████▌| 3900/4096 [00:15<00:00, 246.23it/s]
Adding requests:  96%|█████████▌| 3925/4096 [00:15<00:00, 244.30it/s]
Adding requests:  96%|█████████▋| 3951/4096 [00:15<00:00, 247.38it/s]
Adding requests:  97%|█████████▋| 3976/4096 [00:15<00:00, 247.26it/s]
Adding requests:  98%|█████████▊| 4001/4096 [00:15<00:00, 247.94it/s]
Adding requests:  98%|█████████▊| 4027/4096 [00:15<00:00, 249.98it/s]
Adding requests:  99%|█████████▉| 4053/4096 [00:15<00:00, 250.76it/s]
Adding requests: 100%|█████████▉| 4079/4096 [00:15<00:00, 241.77it/s]
Adding requests: 100%|██████████| 4096/4096 [00:16<00:00, 255.57it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▍         | 198/4096 [00:00<00:17, 222.43it/s, est. speed input: 227776.25 toks/s, output: 222.43 toks/s]
Processed prompts:   5%|▌         | 221/4096 [00:01<00:40, 94.80it/s, est. speed input: 114781.62 toks/s, output: 112.09 toks/s] 
Processed prompts:   6%|▌         | 232/4096 [00:03<01:10, 54.55it/s, est. speed input: 77799.78 toks/s, output: 75.98 toks/s]  
Processed prompts:   6%|▌         | 254/4096 [00:03<01:21, 47.13it/s, est. speed input: 68972.03 toks/s, output: 67.36 toks/s]
Processed prompts:   7%|▋         | 268/4096 [00:04<01:54, 33.43it/s, est. speed input: 56548.61 toks/s, output: 55.22 toks/s]
Processed prompts:   7%|▋         | 282/4096 [00:05<02:26, 25.95it/s, est. speed input: 48644.48 toks/s, output: 47.50 toks/s]
Processed prompts:   7%|▋         | 296/4096 [00:07<02:56, 21.49it/s, est. speed input: 43176.88 toks/s, output: 42.16 toks/s]
Processed prompts:   8%|▊         | 310/4096 [00:08<03:22, 18.67it/s, est. speed input: 39170.60 toks/s, output: 38.25 toks/s]
Processed prompts:   8%|▊         | 324/4096 [00:09<03:44, 16.83it/s, est. speed input: 36108.55 toks/s, output: 35.26 toks/s]
Processed prompts:   8%|▊         | 338/4096 [00:10<04:00, 15.60it/s, est. speed input: 33689.86 toks/s, output: 32.90 toks/s]
Processed prompts:   9%|▊         | 352/4096 [00:11<04:13, 14.76it/s, est. speed input: 31732.42 toks/s, output: 30.99 toks/s]
Processed prompts:   9%|▉         | 366/4096 [00:12<04:22, 14.19it/s, est. speed input: 30115.80 toks/s, output: 29.41 toks/s]
Processed prompts:   9%|▉         | 380/4096 [00:13<04:29, 13.80it/s, est. speed input: 28758.51 toks/s, output: 28.08 toks/s]
Processed prompts:  10%|▉         | 394/4096 [00:14<04:33, 13.52it/s, est. speed input: 27601.05 toks/s, output: 26.95 toks/s]
Processed prompts:  10%|▉         | 408/4096 [00:15<04:36, 13.33it/s, est. speed input: 26604.20 toks/s, output: 25.98 toks/s]
Processed prompts:  10%|█         | 422/4096 [00:16<04:38, 13.19it/s, est. speed input: 25736.27 toks/s, output: 25.13 toks/s]
Processed prompts:  11%|█         | 436/4096 [00:17<04:39, 13.10it/s, est. speed input: 24973.71 toks/s, output: 24.39 toks/s]
Processed prompts:  11%|█         | 450/4096 [00:18<04:39, 13.04it/s, est. speed input: 24298.87 toks/s, output: 23.73 toks/s]
Processed prompts:  11%|█▏        | 464/4096 [00:20<04:39, 12.99it/s, est. speed input: 23696.76 toks/s, output: 23.14 toks/s]
Processed prompts:  12%|█▏        | 478/4096 [00:21<04:39, 12.96it/s, est. speed input: 23157.26 toks/s, output: 22.61 toks/s]
Processed prompts:  12%|█▏        | 492/4096 [00:22<04:38, 12.94it/s, est. speed input: 22670.61 toks/s, output: 22.14 toks/s]
Processed prompts:  12%|█▏        | 506/4096 [00:23<04:37, 12.92it/s, est. speed input: 22229.27 toks/s, output: 21.71 toks/s]
Processed prompts:  13%|█▎        | 520/4096 [00:24<04:36, 12.92it/s, est. speed input: 21827.61 toks/s, output: 21.32 toks/s]
Processed prompts:  13%|█▎        | 534/4096 [00:25<04:35, 12.91it/s, est. speed input: 21460.12 toks/s, output: 20.96 toks/s]
Processed prompts:  13%|█▎        | 548/4096 [00:26<04:34, 12.91it/s, est. speed input: 21123.04 toks/s, output: 20.63 toks/s]
Processed prompts:  14%|█▎        | 562/4096 [00:27<04:33, 12.90it/s, est. speed input: 20812.39 toks/s, output: 20.32 toks/s]
Processed prompts:  14%|█▍        | 576/4096 [00:28<04:32, 12.90it/s, est. speed input: 20525.12 toks/s, output: 20.04 toks/s]
Processed prompts:  14%|█▍        | 590/4096 [00:29<04:31, 12.90it/s, est. speed input: 20258.12 toks/s, output: 19.78 toks/s]
Processed prompts:  15%|█▍        | 604/4096 [00:30<04:30, 12.89it/s, est. speed input: 20009.96 toks/s, output: 19.54 toks/s]
Processed prompts:  15%|█▌        | 618/4096 [00:31<04:29, 12.90it/s, est. speed input: 19779.36 toks/s, output: 19.32 toks/s]
Processed prompts:  15%|█▌        | 632/4096 [00:33<04:28, 12.90it/s, est. speed input: 19563.82 toks/s, output: 19.11 toks/s]
Processed prompts:  16%|█▌        | 646/4096 [00:34<04:27, 12.90it/s, est. speed input: 19361.84 toks/s, output: 18.91 toks/s]
Processed prompts:  16%|█▋        | 674/4096 [00:34<03:03, 18.60it/s, est. speed input: 19779.53 toks/s, output: 19.32 toks/s]
Processed prompts:  17%|█▋        | 688/4096 [00:35<03:23, 16.76it/s, est. speed input: 19581.10 toks/s, output: 19.12 toks/s]
Processed prompts:  17%|█▋        | 702/4096 [00:37<03:38, 15.54it/s, est. speed input: 19394.30 toks/s, output: 18.94 toks/s]
Processed prompts:  17%|█▋        | 716/4096 [00:38<03:49, 14.72it/s, est. speed input: 19218.18 toks/s, output: 18.77 toks/s]
Processed prompts:  18%|█▊        | 730/4096 [00:39<03:57, 14.16it/s, est. speed input: 19051.81 toks/s, output: 18.61 toks/s]
Processed prompts:  18%|█▊        | 744/4096 [00:40<04:03, 13.78it/s, est. speed input: 18894.48 toks/s, output: 18.45 toks/s]
Processed prompts:  19%|█▊        | 758/4096 [00:41<04:07, 13.51it/s, est. speed input: 18745.12 toks/s, output: 18.31 toks/s]
Processed prompts:  19%|█▉        | 772/4096 [00:42<04:09, 13.32it/s, est. speed input: 18603.38 toks/s, output: 18.17 toks/s]
Processed prompts:  19%|█▉        | 786/4096 [00:43<04:10, 13.19it/s, est. speed input: 18468.61 toks/s, output: 18.04 toks/s]
Processed prompts:  20%|█▉        | 800/4096 [00:44<04:11, 13.10it/s, est. speed input: 18340.58 toks/s, output: 17.91 toks/s]
Processed prompts:  20%|█▉        | 814/4096 [00:45<04:11, 13.03it/s, est. speed input: 18218.31 toks/s, output: 17.79 toks/s]
Processed prompts:  20%|██        | 828/4096 [00:46<04:11, 12.99it/s, est. speed input: 18101.85 toks/s, output: 17.68 toks/s]
Processed prompts:  21%|██        | 842/4096 [00:47<04:11, 12.96it/s, est. speed input: 17990.75 toks/s, output: 17.57 toks/s]
Processed prompts:  21%|██        | 856/4096 [00:49<04:10, 12.94it/s, est. speed input: 17884.55 toks/s, output: 17.47 toks/s]
Processed prompts:  21%|██        | 870/4096 [00:50<04:09, 12.92it/s, est. speed input: 17782.84 toks/s, output: 17.37 toks/s]
Processed prompts:  22%|██▏       | 884/4096 [00:51<04:08, 12.91it/s, est. speed input: 17685.62 toks/s, output: 17.27 toks/s]
Processed prompts:  22%|██▏       | 898/4096 [00:52<04:07, 12.90it/s, est. speed input: 17592.18 toks/s, output: 17.18 toks/s]
Processed prompts:  22%|██▏       | 912/4096 [00:53<04:06, 12.90it/s, est. speed input: 17503.03 toks/s, output: 17.09 toks/s]
Processed prompts:  23%|██▎       | 926/4096 [00:54<04:05, 12.89it/s, est. speed input: 17416.71 toks/s, output: 17.01 toks/s]
Processed prompts:  23%|██▎       | 940/4096 [00:55<04:04, 12.89it/s, est. speed input: 17334.04 toks/s, output: 16.93 toks/s]
Processed prompts:  23%|██▎       | 954/4096 [00:56<04:03, 12.89it/s, est. speed input: 17254.54 toks/s, output: 16.85 toks/s]
Processed prompts:  24%|██▎       | 968/4096 [00:57<04:02, 12.89it/s, est. speed input: 17178.04 toks/s, output: 16.78 toks/s]
Processed prompts:  24%|██▍       | 982/4096 [00:58<04:01, 12.89it/s, est. speed input: 17104.43 toks/s, output: 16.70 toks/s]
Processed prompts:  24%|██▍       | 996/4096 [00:59<04:00, 12.89it/s, est. speed input: 17033.68 toks/s, output: 16.63 toks/s]
Processed prompts:  25%|██▍       | 1010/4096 [01:00<03:59, 12.88it/s, est. speed input: 16964.89 toks/s, output: 16.57 toks/s]
Processed prompts:  25%|██▌       | 1024/4096 [01:02<03:58, 12.88it/s, est. speed input: 16898.73 toks/s, output: 16.50 toks/s]
Processed prompts:  25%|██▌       | 1038/4096 [01:03<03:57, 12.88it/s, est. speed input: 16834.94 toks/s, output: 16.44 toks/s]
Processed prompts:  26%|██▌       | 1052/4096 [01:04<03:56, 12.88it/s, est. speed input: 16773.25 toks/s, output: 16.38 toks/s]
Processed prompts:  26%|██▌       | 1066/4096 [01:05<03:55, 12.88it/s, est. speed input: 16713.69 toks/s, output: 16.32 toks/s]
Processed prompts:  27%|██▋       | 1094/4096 [01:06<02:41, 18.62it/s, est. speed input: 16964.99 toks/s, output: 16.57 toks/s]
Processed prompts:  27%|██▋       | 1108/4096 [01:07<02:58, 16.77it/s, est. speed input: 16904.14 toks/s, output: 16.51 toks/s]
Processed prompts:  27%|██▋       | 1122/4096 [01:08<03:11, 15.55it/s, est. speed input: 16845.49 toks/s, output: 16.45 toks/s]
Processed prompts:  28%|██▊       | 1136/4096 [01:09<03:20, 14.73it/s, est. speed input: 16788.59 toks/s, output: 16.40 toks/s]
Processed prompts:  28%|██▊       | 1150/4096 [01:10<03:27, 14.17it/s, est. speed input: 16733.44 toks/s, output: 16.34 toks/s]
Processed prompts:  28%|██▊       | 1164/4096 [01:11<03:32, 13.78it/s, est. speed input: 16680.02 toks/s, output: 16.29 toks/s]
Processed prompts:  29%|██▉       | 1178/4096 [01:12<03:35, 13.52it/s, est. speed input: 16628.13 toks/s, output: 16.24 toks/s]
Processed prompts:  29%|██▉       | 1192/4096 [01:13<03:37, 13.33it/s, est. speed input: 16577.80 toks/s, output: 16.19 toks/s]
Processed prompts:  29%|██▉       | 1206/4096 [01:14<03:39, 13.19it/s, est. speed input: 16528.42 toks/s, output: 16.14 toks/s]
Processed prompts:  30%|██▉       | 1220/4096 [01:15<03:39, 13.10it/s, est. speed input: 16480.46 toks/s, output: 16.09 toks/s]
Processed prompts:  30%|███       | 1234/4096 [01:16<03:39, 13.03it/s, est. speed input: 16433.77 toks/s, output: 16.05 toks/s]
Processed prompts:  30%|███       | 1248/4096 [01:17<03:39, 12.98it/s, est. speed input: 16388.43 toks/s, output: 16.00 toks/s]
Processed prompts:  31%|███       | 1262/4096 [01:19<03:38, 12.95it/s, est. speed input: 16344.34 toks/s, output: 15.96 toks/s]
Processed prompts:  31%|███       | 1276/4096 [01:20<03:38, 12.93it/s, est. speed input: 16301.36 toks/s, output: 15.92 toks/s]
Processed prompts:  31%|███▏      | 1290/4096 [01:21<03:37, 12.91it/s, est. speed input: 16259.69 toks/s, output: 15.88 toks/s]
Processed prompts:  32%|███▏      | 1304/4096 [01:22<03:36, 12.90it/s, est. speed input: 16218.79 toks/s, output: 15.84 toks/s]
Processed prompts:  32%|███▏      | 1318/4096 [01:23<03:35, 12.88it/s, est. speed input: 16178.82 toks/s, output: 15.80 toks/s]
Processed prompts:  33%|███▎      | 1332/4096 [01:24<03:34, 12.88it/s, est. speed input: 16140.03 toks/s, output: 15.76 toks/s]
Processed prompts:  33%|███▎      | 1346/4096 [01:25<03:33, 12.87it/s, est. speed input: 16102.23 toks/s, output: 15.72 toks/s]
Processed prompts:  33%|███▎      | 1360/4096 [01:26<03:32, 12.87it/s, est. speed input: 16065.35 toks/s, output: 15.69 toks/s]
Processed prompts:  34%|███▎      | 1374/4096 [01:27<03:31, 12.86it/s, est. speed input: 16029.43 toks/s, output: 15.65 toks/s]
Processed prompts:  34%|███▍      | 1388/4096 [01:28<03:30, 12.86it/s, est. speed input: 15994.36 toks/s, output: 15.62 toks/s]
Processed prompts:  34%|███▍      | 1402/4096 [01:29<03:29, 12.86it/s, est. speed input: 15960.29 toks/s, output: 15.59 toks/s]
Processed prompts:  35%|███▍      | 1416/4096 [01:31<03:28, 12.87it/s, est. speed input: 15927.18 toks/s, output: 15.55 toks/s]
Processed prompts:  35%|███▍      | 1430/4096 [01:32<03:27, 12.88it/s, est. speed input: 15895.05 toks/s, output: 15.52 toks/s]
Processed prompts:  35%|███▌      | 1444/4096 [01:33<03:26, 12.87it/s, est. speed input: 15863.32 toks/s, output: 15.49 toks/s]
Processed prompts:  36%|███▌      | 1458/4096 [01:34<03:24, 12.87it/s, est. speed input: 15832.45 toks/s, output: 15.46 toks/s]
Processed prompts:  36%|███▌      | 1472/4096 [01:35<03:23, 12.88it/s, est. speed input: 15802.37 toks/s, output: 15.43 toks/s]
Processed prompts:  36%|███▋      | 1486/4096 [01:36<03:22, 12.88it/s, est. speed input: 15772.97 toks/s, output: 15.40 toks/s]
Processed prompts:  37%|███▋      | 1514/4096 [01:37<02:18, 18.63it/s, est. speed input: 15951.15 toks/s, output: 15.58 toks/s]
Processed prompts:  37%|███▋      | 1528/4096 [01:38<02:32, 16.79it/s, est. speed input: 15921.25 toks/s, output: 15.55 toks/s]
Processed prompts:  38%|███▊      | 1542/4096 [01:39<02:43, 15.59it/s, est. speed input: 15892.62 toks/s, output: 15.52 toks/s]
Processed prompts:  38%|███▊      | 1556/4096 [01:40<02:51, 14.78it/s, est. speed input: 15864.56 toks/s, output: 15.49 toks/s]
Processed prompts:  38%|███▊      | 1570/4096 [01:41<02:57, 14.23it/s, est. speed input: 15837.37 toks/s, output: 15.47 toks/s]
Processed prompts:  39%|███▊      | 1584/4096 [01:42<03:01, 13.84it/s, est. speed input: 15810.35 toks/s, output: 15.44 toks/s]
Processed prompts:  39%|███▉      | 1598/4096 [01:43<03:03, 13.58it/s, est. speed input: 15784.08 toks/s, output: 15.41 toks/s]
Processed prompts:  39%|███▉      | 1612/4096 [01:44<03:05, 13.40it/s, est. speed input: 15758.32 toks/s, output: 15.39 toks/s]
Processed prompts:  40%|███▉      | 1626/4096 [01:45<03:06, 13.26it/s, est. speed input: 15732.90 toks/s, output: 15.36 toks/s]
Processed prompts:  40%|████      | 1640/4096 [01:46<03:07, 13.12it/s, est. speed input: 15705.94 toks/s, output: 15.34 toks/s]
Processed prompts:  40%|████      | 1654/4096 [01:48<03:07, 13.01it/s, est. speed input: 15679.27 toks/s, output: 15.31 toks/s]
Processed prompts:  41%|████      | 1668/4096 [01:49<03:07, 12.95it/s, est. speed input: 15653.31 toks/s, output: 15.29 toks/s]
Processed prompts:  41%|████      | 1682/4096 [01:50<03:07, 12.90it/s, est. speed input: 15627.81 toks/s, output: 15.26 toks/s]
Processed prompts:  41%|████▏     | 1696/4096 [01:51<03:06, 12.86it/s, est. speed input: 15602.83 toks/s, output: 15.24 toks/s]
Processed prompts:  42%|████▏     | 1710/4096 [01:52<03:05, 12.84it/s, est. speed input: 15578.33 toks/s, output: 15.21 toks/s]
Processed prompts:  42%|████▏     | 1724/4096 [01:53<03:05, 12.82it/s, est. speed input: 15554.31 toks/s, output: 15.19 toks/s]
Processed prompts:  42%|████▏     | 1738/4096 [01:54<03:03, 12.82it/s, est. speed input: 15531.23 toks/s, output: 15.17 toks/s]
Processed prompts:  43%|████▎     | 1752/4096 [01:55<03:02, 12.83it/s, est. speed input: 15508.79 toks/s, output: 15.15 toks/s]
Processed prompts:  43%|████▎     | 1766/4096 [01:56<03:01, 12.83it/s, est. speed input: 15486.76 toks/s, output: 15.12 toks/s]
Processed prompts:  43%|████▎     | 1780/4096 [01:57<03:00, 12.83it/s, est. speed input: 15465.08 toks/s, output: 15.10 toks/s]
Processed prompts:  44%|████▍     | 1794/4096 [01:58<02:59, 12.83it/s, est. speed input: 15443.83 toks/s, output: 15.08 toks/s]
Processed prompts:  44%|████▍     | 1808/4096 [02:00<02:58, 12.84it/s, est. speed input: 15422.96 toks/s, output: 15.06 toks/s]
Processed prompts:  44%|████▍     | 1822/4096 [02:01<02:57, 12.84it/s, est. speed input: 15402.44 toks/s, output: 15.04 toks/s]
Processed prompts:  45%|████▍     | 1836/4096 [02:02<02:55, 12.84it/s, est. speed input: 15382.59 toks/s, output: 15.02 toks/s]
Processed prompts:  45%|████▌     | 1850/4096 [02:03<02:54, 12.86it/s, est. speed input: 15363.57 toks/s, output: 15.00 toks/s]
Processed prompts:  46%|████▌     | 1864/4096 [02:04<02:53, 12.87it/s, est. speed input: 15344.68 toks/s, output: 14.99 toks/s]
Processed prompts:  46%|████▌     | 1878/4096 [02:05<02:52, 12.88it/s, est. speed input: 15326.27 toks/s, output: 14.97 toks/s]
Processed prompts:  46%|████▌     | 1892/4096 [02:06<02:51, 12.89it/s, est. speed input: 15308.16 toks/s, output: 14.95 toks/s]
Processed prompts:  47%|████▋     | 1906/4096 [02:07<02:49, 12.89it/s, est. speed input: 15290.39 toks/s, output: 14.93 toks/s]
Processed prompts:  47%|████▋     | 1934/4096 [02:08<01:55, 18.72it/s, est. speed input: 15429.49 toks/s, output: 15.07 toks/s]
Processed prompts:  48%|████▊     | 1948/4096 [02:09<02:07, 16.84it/s, est. speed input: 15410.87 toks/s, output: 15.05 toks/s]
Processed prompts:  48%|████▊     | 1962/4096 [02:10<02:16, 15.59it/s, est. speed input: 15392.49 toks/s, output: 15.03 toks/s]
Processed prompts:  48%|████▊     | 1976/4096 [02:11<02:23, 14.75it/s, est. speed input: 15374.35 toks/s, output: 15.01 toks/s]
Processed prompts:  49%|████▊     | 1990/4096 [02:12<02:28, 14.17it/s, est. speed input: 15356.50 toks/s, output: 15.00 toks/s]
Processed prompts:  49%|████▉     | 2004/4096 [02:13<02:31, 13.78it/s, est. speed input: 15338.95 toks/s, output: 14.98 toks/s]
Processed prompts:  49%|████▉     | 2018/4096 [02:14<02:33, 13.51it/s, est. speed input: 15321.70 toks/s, output: 14.96 toks/s]
Processed prompts:  50%|████▉     | 2032/4096 [02:15<02:34, 13.32it/s, est. speed input: 15304.74 toks/s, output: 14.95 toks/s]
Processed prompts:  50%|████▉     | 2046/4096 [02:17<02:35, 13.19it/s, est. speed input: 15288.04 toks/s, output: 14.93 toks/s]
Processed prompts:  50%|█████     | 2060/4096 [02:18<02:35, 13.10it/s, est. speed input: 15271.53 toks/s, output: 14.91 toks/s]
Processed prompts:  51%|█████     | 2074/4096 [02:19<02:35, 13.03it/s, est. speed input: 15255.31 toks/s, output: 14.90 toks/s]
Processed prompts:  51%|█████     | 2088/4096 [02:20<02:34, 12.99it/s, est. speed input: 15239.31 toks/s, output: 14.88 toks/s]
Processed prompts:  51%|█████▏    | 2102/4096 [02:21<02:33, 12.96it/s, est. speed input: 15223.56 toks/s, output: 14.87 toks/s]
Processed prompts:  52%|█████▏    | 2116/4096 [02:22<02:33, 12.93it/s, est. speed input: 15208.06 toks/s, output: 14.85 toks/s]
Processed prompts:  52%|█████▏    | 2130/4096 [02:23<02:32, 12.92it/s, est. speed input: 15192.79 toks/s, output: 14.84 toks/s]
Processed prompts:  52%|█████▏    | 2144/4096 [02:24<02:31, 12.91it/s, est. speed input: 15177.76 toks/s, output: 14.82 toks/s]
Processed prompts:  53%|█████▎    | 2158/4096 [02:25<02:30, 12.90it/s, est. speed input: 15162.93 toks/s, output: 14.81 toks/s]
Processed prompts:  53%|█████▎    | 2172/4096 [02:26<02:29, 12.89it/s, est. speed input: 15148.33 toks/s, output: 14.79 toks/s]
Processed prompts:  53%|█████▎    | 2186/4096 [02:27<02:28, 12.89it/s, est. speed input: 15133.93 toks/s, output: 14.78 toks/s]
Processed prompts:  54%|█████▎    | 2200/4096 [02:28<02:27, 12.89it/s, est. speed input: 15119.75 toks/s, output: 14.77 toks/s]
Processed prompts:  54%|█████▍    | 2214/4096 [02:30<02:26, 12.88it/s, est. speed input: 15105.76 toks/s, output: 14.75 toks/s]
Processed prompts:  54%|█████▍    | 2228/4096 [02:31<02:24, 12.88it/s, est. speed input: 15092.01 toks/s, output: 14.74 toks/s]
Processed prompts:  55%|█████▍    | 2242/4096 [02:32<02:23, 12.88it/s, est. speed input: 15078.42 toks/s, output: 14.73 toks/s]
Processed prompts:  55%|█████▌    | 2256/4096 [02:33<02:22, 12.88it/s, est. speed input: 15065.06 toks/s, output: 14.71 toks/s]
Processed prompts:  55%|█████▌    | 2270/4096 [02:34<02:21, 12.88it/s, est. speed input: 15051.88 toks/s, output: 14.70 toks/s]
Processed prompts:  56%|█████▌    | 2284/4096 [02:35<02:20, 12.88it/s, est. speed input: 15038.85 toks/s, output: 14.69 toks/s]
Processed prompts:  56%|█████▌    | 2298/4096 [02:36<02:19, 12.88it/s, est. speed input: 15025.98 toks/s, output: 14.67 toks/s]
Processed prompts:  56%|█████▋    | 2312/4096 [02:37<02:18, 12.88it/s, est. speed input: 15013.33 toks/s, output: 14.66 toks/s]
Processed prompts:  57%|█████▋    | 2326/4096 [02:38<02:17, 12.88it/s, est. speed input: 15000.84 toks/s, output: 14.65 toks/s]
Processed prompts:  57%|█████▋    | 2354/4096 [02:39<01:34, 18.48it/s, est. speed input: 15110.42 toks/s, output: 14.76 toks/s]
Processed prompts:  58%|█████▊    | 2368/4096 [02:40<01:43, 16.68it/s, est. speed input: 15097.39 toks/s, output: 14.74 toks/s]
Processed prompts:  58%|█████▊    | 2382/4096 [02:41<01:50, 15.48it/s, est. speed input: 15084.51 toks/s, output: 14.73 toks/s]
Processed prompts:  58%|█████▊    | 2396/4096 [02:42<01:55, 14.68it/s, est. speed input: 15071.82 toks/s, output: 14.72 toks/s]
Processed prompts:  59%|█████▉    | 2410/4096 [02:43<01:59, 14.12it/s, est. speed input: 15059.29 toks/s, output: 14.71 toks/s]
Processed prompts:  59%|█████▉    | 2424/4096 [02:44<02:01, 13.74it/s, est. speed input: 15046.94 toks/s, output: 14.69 toks/s]
Processed prompts:  60%|█████▉    | 2438/4096 [02:46<02:03, 13.48it/s, est. speed input: 15034.72 toks/s, output: 14.68 toks/s]
Processed prompts:  60%|█████▉    | 2452/4096 [02:47<02:03, 13.30it/s, est. speed input: 15022.68 toks/s, output: 14.67 toks/s]
Processed prompts:  60%|██████    | 2466/4096 [02:48<02:03, 13.17it/s, est. speed input: 15010.85 toks/s, output: 14.66 toks/s]
Processed prompts:  61%|██████    | 2480/4096 [02:49<02:03, 13.08it/s, est. speed input: 14999.03 toks/s, output: 14.65 toks/s]
Processed prompts:  61%|██████    | 2494/4096 [02:50<02:03, 13.02it/s, est. speed input: 14987.45 toks/s, output: 14.64 toks/s]
Processed prompts:  61%|██████    | 2508/4096 [02:51<02:02, 12.97it/s, est. speed input: 14976.02 toks/s, output: 14.63 toks/s]
Processed prompts:  62%|██████▏   | 2522/4096 [02:52<02:01, 12.94it/s, est. speed input: 14964.71 toks/s, output: 14.61 toks/s]
Processed prompts:  62%|██████▏   | 2536/4096 [02:53<02:00, 12.92it/s, est. speed input: 14953.58 toks/s, output: 14.60 toks/s]
Processed prompts:  62%|██████▏   | 2550/4096 [02:54<01:59, 12.91it/s, est. speed input: 14942.57 toks/s, output: 14.59 toks/s]
Processed prompts:  63%|██████▎   | 2564/4096 [02:55<01:58, 12.90it/s, est. speed input: 14931.75 toks/s, output: 14.58 toks/s]
Processed prompts:  63%|██████▎   | 2578/4096 [02:56<01:57, 12.89it/s, est. speed input: 14921.00 toks/s, output: 14.57 toks/s]
Processed prompts:  63%|██████▎   | 2592/4096 [02:58<01:56, 12.89it/s, est. speed input: 14910.39 toks/s, output: 14.56 toks/s]
Processed prompts:  64%|██████▎   | 2606/4096 [02:59<01:55, 12.89it/s, est. speed input: 14900.02 toks/s, output: 14.55 toks/s]
Processed prompts:  64%|██████▍   | 2620/4096 [03:00<01:54, 12.89it/s, est. speed input: 14889.75 toks/s, output: 14.54 toks/s]
Processed prompts:  64%|██████▍   | 2634/4096 [03:01<01:53, 12.89it/s, est. speed input: 14879.59 toks/s, output: 14.53 toks/s]
Processed prompts:  65%|██████▍   | 2648/4096 [03:02<01:52, 12.89it/s, est. speed input: 14869.59 toks/s, output: 14.52 toks/s]
Processed prompts:  65%|██████▍   | 2662/4096 [03:03<01:51, 12.89it/s, est. speed input: 14859.69 toks/s, output: 14.51 toks/s]
Processed prompts:  65%|██████▌   | 2676/4096 [03:04<01:50, 12.89it/s, est. speed input: 14849.91 toks/s, output: 14.50 toks/s]
Processed prompts:  66%|██████▌   | 2690/4096 [03:05<01:49, 12.89it/s, est. speed input: 14840.22 toks/s, output: 14.49 toks/s]
Processed prompts:  66%|██████▌   | 2704/4096 [03:06<01:48, 12.88it/s, est. speed input: 14830.60 toks/s, output: 14.48 toks/s]
Processed prompts:  66%|██████▋   | 2718/4096 [03:07<01:46, 12.88it/s, est. speed input: 14821.05 toks/s, output: 14.47 toks/s]
Processed prompts:  67%|██████▋   | 2732/4096 [03:08<01:45, 12.88it/s, est. speed input: 14811.61 toks/s, output: 14.46 toks/s]
Processed prompts:  67%|██████▋   | 2746/4096 [03:09<01:44, 12.88it/s, est. speed input: 14802.27 toks/s, output: 14.46 toks/s]
Processed prompts:  68%|██████▊   | 2774/4096 [03:10<01:11, 18.54it/s, est. speed input: 14895.50 toks/s, output: 14.55 toks/s]
Processed prompts:  68%|██████▊   | 2788/4096 [03:11<01:18, 16.72it/s, est. speed input: 14885.81 toks/s, output: 14.54 toks/s]
Processed prompts:  68%|██████▊   | 2802/4096 [03:12<01:23, 15.51it/s, est. speed input: 14876.21 toks/s, output: 14.53 toks/s]
Processed prompts:  69%|██████▉   | 2816/4096 [03:13<01:27, 14.69it/s, est. speed input: 14866.72 toks/s, output: 14.52 toks/s]
Processed prompts:  69%|██████▉   | 2830/4096 [03:15<01:29, 14.13it/s, est. speed input: 14857.23 toks/s, output: 14.51 toks/s]
Processed prompts:  69%|██████▉   | 2844/4096 [03:16<01:31, 13.74it/s, est. speed input: 14847.86 toks/s, output: 14.50 toks/s]
Processed prompts:  70%|██████▉   | 2858/4096 [03:17<01:31, 13.47it/s, est. speed input: 14838.56 toks/s, output: 14.49 toks/s]
Processed prompts:  70%|███████   | 2872/4096 [03:18<01:32, 13.29it/s, est. speed input: 14829.37 toks/s, output: 14.48 toks/s]
Processed prompts:  70%|███████   | 2886/4096 [03:19<01:31, 13.16it/s, est. speed input: 14820.29 toks/s, output: 14.47 toks/s]
Processed prompts:  71%|███████   | 2900/4096 [03:20<01:31, 13.07it/s, est. speed input: 14811.28 toks/s, output: 14.46 toks/s]
Processed prompts:  71%|███████   | 2914/4096 [03:21<01:30, 13.00it/s, est. speed input: 14802.38 toks/s, output: 14.46 toks/s]
Processed prompts:  71%|███████▏  | 2928/4096 [03:22<01:30, 12.96it/s, est. speed input: 14793.64 toks/s, output: 14.45 toks/s]
Processed prompts:  72%|███████▏  | 2942/4096 [03:23<01:29, 12.93it/s, est. speed input: 14785.03 toks/s, output: 14.44 toks/s]
Processed prompts:  72%|███████▏  | 2956/4096 [03:24<01:28, 12.92it/s, est. speed input: 14776.53 toks/s, output: 14.43 toks/s]
Processed prompts:  73%|███████▎  | 2970/4096 [03:25<01:27, 12.90it/s, est. speed input: 14768.12 toks/s, output: 14.42 toks/s]
Processed prompts:  73%|███████▎  | 2984/4096 [03:27<01:26, 12.90it/s, est. speed input: 14759.81 toks/s, output: 14.41 toks/s]
Processed prompts:  73%|███████▎  | 2998/4096 [03:28<01:25, 12.89it/s, est. speed input: 14751.58 toks/s, output: 14.41 toks/s]
Processed prompts:  74%|███████▎  | 3012/4096 [03:29<01:24, 12.88it/s, est. speed input: 14743.40 toks/s, output: 14.40 toks/s]
Processed prompts:  74%|███████▍  | 3026/4096 [03:30<01:23, 12.88it/s, est. speed input: 14735.30 toks/s, output: 14.39 toks/s]
Processed prompts:  74%|███████▍  | 3040/4096 [03:31<01:21, 12.88it/s, est. speed input: 14727.33 toks/s, output: 14.38 toks/s]
Processed prompts:  75%|███████▍  | 3054/4096 [03:32<01:20, 12.88it/s, est. speed input: 14719.41 toks/s, output: 14.37 toks/s]
Processed prompts:  75%|███████▍  | 3068/4096 [03:33<01:19, 12.88it/s, est. speed input: 14711.58 toks/s, output: 14.37 toks/s]
Processed prompts:  75%|███████▌  | 3082/4096 [03:34<01:18, 12.87it/s, est. speed input: 14703.83 toks/s, output: 14.36 toks/s]
Processed prompts:  76%|███████▌  | 3096/4096 [03:35<01:17, 12.87it/s, est. speed input: 14696.16 toks/s, output: 14.35 toks/s]
Processed prompts:  76%|███████▌  | 3110/4096 [03:36<01:16, 12.87it/s, est. speed input: 14688.58 toks/s, output: 14.34 toks/s]
Processed prompts:  76%|███████▋  | 3124/4096 [03:37<01:15, 12.87it/s, est. speed input: 14681.07 toks/s, output: 14.34 toks/s]
Processed prompts:  77%|███████▋  | 3138/4096 [03:38<01:14, 12.88it/s, est. speed input: 14673.65 toks/s, output: 14.33 toks/s]
Processed prompts:  77%|███████▋  | 3152/4096 [03:40<01:13, 12.87it/s, est. speed input: 14666.28 toks/s, output: 14.32 toks/s]
Processed prompts:  78%|███████▊  | 3180/4096 [03:40<00:49, 18.65it/s, est. speed input: 14748.57 toks/s, output: 14.40 toks/s]
Processed prompts:  78%|███████▊  | 3194/4096 [03:41<00:53, 16.78it/s, est. speed input: 14740.88 toks/s, output: 14.40 toks/s]
Processed prompts:  78%|███████▊  | 3208/4096 [03:42<00:57, 15.55it/s, est. speed input: 14733.36 toks/s, output: 14.39 toks/s]
Processed prompts:  79%|███████▊  | 3222/4096 [03:44<00:59, 14.72it/s, est. speed input: 14725.79 toks/s, output: 14.38 toks/s]
Processed prompts:  79%|███████▉  | 3236/4096 [03:45<01:00, 14.15it/s, est. speed input: 14718.36 toks/s, output: 14.37 toks/s]
Processed prompts:  79%|███████▉  | 3250/4096 [03:46<01:01, 13.76it/s, est. speed input: 14711.02 toks/s, output: 14.37 toks/s]
Processed prompts:  80%|███████▉  | 3264/4096 [03:47<01:01, 13.49it/s, est. speed input: 14703.64 toks/s, output: 14.36 toks/s]
Processed prompts:  80%|████████  | 3278/4096 [03:48<01:01, 13.30it/s, est. speed input: 14696.39 toks/s, output: 14.35 toks/s]
Processed prompts:  80%|████████  | 3292/4096 [03:49<01:01, 13.17it/s, est. speed input: 14689.22 toks/s, output: 14.34 toks/s]
Processed prompts:  81%|████████  | 3306/4096 [03:50<01:00, 13.08it/s, est. speed input: 14682.10 toks/s, output: 14.34 toks/s]
Processed prompts:  81%|████████  | 3320/4096 [03:51<00:59, 13.02it/s, est. speed input: 14675.05 toks/s, output: 14.33 toks/s]
Processed prompts:  81%|████████▏ | 3334/4096 [03:52<00:58, 12.98it/s, est. speed input: 14668.09 toks/s, output: 14.32 toks/s]
Processed prompts:  82%|████████▏ | 3348/4096 [03:53<00:57, 12.95it/s, est. speed input: 14661.19 toks/s, output: 14.32 toks/s]
Processed prompts:  82%|████████▏ | 3362/4096 [03:54<00:56, 12.92it/s, est. speed input: 14654.32 toks/s, output: 14.31 toks/s]
Processed prompts:  82%|████████▏ | 3376/4096 [03:56<00:55, 12.91it/s, est. speed input: 14647.54 toks/s, output: 14.30 toks/s]
Processed prompts:  83%|████████▎ | 3390/4096 [03:57<00:54, 12.90it/s, est. speed input: 14640.82 toks/s, output: 14.30 toks/s]
Processed prompts:  83%|████████▎ | 3404/4096 [03:58<00:53, 12.89it/s, est. speed input: 14634.14 toks/s, output: 14.29 toks/s]
Processed prompts:  83%|████████▎ | 3418/4096 [03:59<00:52, 12.88it/s, est. speed input: 14627.54 toks/s, output: 14.28 toks/s]
Processed prompts:  84%|████████▍ | 3432/4096 [04:00<00:51, 12.88it/s, est. speed input: 14621.00 toks/s, output: 14.28 toks/s]
Processed prompts:  84%|████████▍ | 3446/4096 [04:01<00:50, 12.88it/s, est. speed input: 14614.51 toks/s, output: 14.27 toks/s]
Processed prompts:  84%|████████▍ | 3460/4096 [04:02<00:49, 12.88it/s, est. speed input: 14608.09 toks/s, output: 14.27 toks/s]
Processed prompts:  85%|████████▍ | 3474/4096 [04:03<00:48, 12.88it/s, est. speed input: 14601.74 toks/s, output: 14.26 toks/s]
Processed prompts:  85%|████████▌ | 3488/4096 [04:04<00:47, 12.88it/s, est. speed input: 14595.43 toks/s, output: 14.25 toks/s]
Processed prompts:  85%|████████▌ | 3502/4096 [04:05<00:46, 12.88it/s, est. speed input: 14589.19 toks/s, output: 14.25 toks/s]
Processed prompts:  86%|████████▌ | 3516/4096 [04:06<00:45, 12.88it/s, est. speed input: 14583.00 toks/s, output: 14.24 toks/s]
Processed prompts:  86%|████████▌ | 3530/4096 [04:07<00:43, 12.88it/s, est. speed input: 14576.87 toks/s, output: 14.24 toks/s]
Processed prompts:  87%|████████▋ | 3544/4096 [04:09<00:42, 12.87it/s, est. speed input: 14570.77 toks/s, output: 14.23 toks/s]
Processed prompts:  87%|████████▋ | 3558/4096 [04:10<00:41, 12.87it/s, est. speed input: 14564.74 toks/s, output: 14.22 toks/s]
Processed prompts:  87%|████████▋ | 3572/4096 [04:11<00:40, 12.87it/s, est. speed input: 14558.75 toks/s, output: 14.22 toks/s]
Processed prompts:  88%|████████▊ | 3600/4096 [04:11<00:26, 18.56it/s, est. speed input: 14630.34 toks/s, output: 14.29 toks/s]
Processed prompts:  88%|████████▊ | 3614/4096 [04:13<00:28, 16.73it/s, est. speed input: 14624.13 toks/s, output: 14.28 toks/s]
Processed prompts:  89%|████████▊ | 3628/4096 [04:14<00:30, 15.51it/s, est. speed input: 14617.95 toks/s, output: 14.28 toks/s]
Processed prompts:  89%|████████▉ | 3642/4096 [04:15<00:30, 14.69it/s, est. speed input: 14611.83 toks/s, output: 14.27 toks/s]
Processed prompts:  89%|████████▉ | 3656/4096 [04:16<00:31, 14.14it/s, est. speed input: 14605.78 toks/s, output: 14.26 toks/s]
Processed prompts:  90%|████████▉ | 3670/4096 [04:17<00:30, 13.75it/s, est. speed input: 14599.78 toks/s, output: 14.26 toks/s]
Processed prompts:  90%|████████▉ | 3684/4096 [04:18<00:30, 13.49it/s, est. speed input: 14593.83 toks/s, output: 14.25 toks/s]
Processed prompts:  90%|█████████ | 3698/4096 [04:19<00:29, 13.30it/s, est. speed input: 14587.92 toks/s, output: 14.25 toks/s]
Processed prompts:  91%|█████████ | 3712/4096 [04:20<00:29, 13.17it/s, est. speed input: 14582.05 toks/s, output: 14.24 toks/s]
Processed prompts:  91%|█████████ | 3726/4096 [04:21<00:28, 13.08it/s, est. speed input: 14576.25 toks/s, output: 14.23 toks/s]
Processed prompts:  91%|█████████▏| 3740/4096 [04:22<00:27, 13.02it/s, est. speed input: 14570.47 toks/s, output: 14.23 toks/s]
Processed prompts:  92%|█████████▏| 3754/4096 [04:23<00:26, 12.98it/s, est. speed input: 14564.76 toks/s, output: 14.22 toks/s]
Processed prompts:  92%|█████████▏| 3768/4096 [04:25<00:25, 12.94it/s, est. speed input: 14559.08 toks/s, output: 14.22 toks/s]
Processed prompts:  92%|█████████▏| 3782/4096 [04:26<00:24, 12.92it/s, est. speed input: 14553.45 toks/s, output: 14.21 toks/s]
Processed prompts:  93%|█████████▎| 3796/4096 [04:27<00:23, 12.91it/s, est. speed input: 14547.86 toks/s, output: 14.21 toks/s]
Processed prompts:  93%|█████████▎| 3810/4096 [04:28<00:22, 12.90it/s, est. speed input: 14542.33 toks/s, output: 14.20 toks/s]
Processed prompts:  93%|█████████▎| 3824/4096 [04:29<00:21, 12.89it/s, est. speed input: 14536.85 toks/s, output: 14.20 toks/s]
Processed prompts:  94%|█████████▎| 3838/4096 [04:30<00:20, 12.89it/s, est. speed input: 14531.40 toks/s, output: 14.19 toks/s]
Processed prompts:  94%|█████████▍| 3852/4096 [04:31<00:18, 12.88it/s, est. speed input: 14526.01 toks/s, output: 14.19 toks/s]
Processed prompts:  94%|█████████▍| 3866/4096 [04:32<00:17, 12.88it/s, est. speed input: 14520.67 toks/s, output: 14.18 toks/s]
Processed prompts:  95%|█████████▍| 3880/4096 [04:33<00:16, 12.88it/s, est. speed input: 14515.37 toks/s, output: 14.18 toks/s]
Processed prompts:  95%|█████████▌| 3894/4096 [04:34<00:15, 12.88it/s, est. speed input: 14510.10 toks/s, output: 14.17 toks/s]
Processed prompts:  95%|█████████▌| 3908/4096 [04:35<00:14, 12.88it/s, est. speed input: 14504.89 toks/s, output: 14.16 toks/s]
Processed prompts:  96%|█████████▌| 3922/4096 [04:36<00:13, 12.88it/s, est. speed input: 14499.69 toks/s, output: 14.16 toks/s]
Processed prompts:  96%|█████████▌| 3936/4096 [04:38<00:12, 12.88it/s, est. speed input: 14494.55 toks/s, output: 14.15 toks/s]
Processed prompts:  96%|█████████▋| 3950/4096 [04:39<00:11, 12.87it/s, est. speed input: 14489.43 toks/s, output: 14.15 toks/s]
Processed prompts:  97%|█████████▋| 3964/4096 [04:40<00:10, 12.88it/s, est. speed input: 14484.37 toks/s, output: 14.14 toks/s]
Processed prompts:  97%|█████████▋| 3978/4096 [04:41<00:09, 12.88it/s, est. speed input: 14479.35 toks/s, output: 14.14 toks/s]
Processed prompts:  97%|█████████▋| 3992/4096 [04:42<00:08, 12.87it/s, est. speed input: 14474.34 toks/s, output: 14.14 toks/s]
Processed prompts:  98%|█████████▊| 4020/4096 [04:43<00:04, 18.56it/s, est. speed input: 14538.18 toks/s, output: 14.20 toks/s]
Processed prompts:  98%|█████████▊| 4034/4096 [04:44<00:03, 16.72it/s, est. speed input: 14532.95 toks/s, output: 14.19 toks/s]
Processed prompts:  99%|█████████▉| 4048/4096 [04:45<00:03, 15.51it/s, est. speed input: 14527.82 toks/s, output: 14.19 toks/s]
Processed prompts:  99%|█████████▉| 4062/4096 [04:46<00:02, 14.69it/s, est. speed input: 14522.73 toks/s, output: 14.18 toks/s]
Processed prompts: 100%|█████████▉| 4076/4096 [04:47<00:01, 14.14it/s, est. speed input: 14517.71 toks/s, output: 14.18 toks/s]
Processed prompts: 100%|█████████▉| 4090/4096 [04:48<00:00, 16.22it/s, est. speed input: 14540.04 toks/s, output: 14.20 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [04:48<00:00, 16.22it/s, est. speed input: 14561.36 toks/s, output: 14.22 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [04:48<00:00, 14.22it/s, est. speed input: 14561.36 toks/s, output: 14.22 toks/s]
[rank0]:[W126 07:37:25.665891820 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=65536 ==========
Time: 2026-01-26 07:37:28
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-FP8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=8192, max_num_seqs=64
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-FP8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 8192 --max-num-seqs 64 --max-model-len 1025 --max-num-batched-tokens 65536 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_4/json/Qwen2.5-14B-FP8_M65536.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 07:38:36 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 07:38:37 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=355821) WARNING 01-26 07:38:45 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=355821) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=355821) WARNING 01-26 07:39:03 [backends.py:609] Failed to read file <frozen os>
(EngineCore_DP0 pid=355821) ERROR 01-26 07:40:06 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=355821) ERROR 01-26 07:40:06 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=355821) ERROR 01-26 07:40:06 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=355821) ERROR 01-26 07:40:06 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=355821) ERROR 01-26 07:40:06 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=355821) ERROR 01-26 07:40:06 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=355821) ERROR 01-26 07:40:06 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=355821) ERROR 01-26 07:40:06 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=355821) ERROR 01-26 07:40:06 [core.py:866]     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=355821) ERROR 01-26 07:40:06 [core.py:866]                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=355821) ERROR 01-26 07:40:06 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 248, in _initialize_kv_caches
(EngineCore_DP0 pid=355821) ERROR 01-26 07:40:06 [core.py:866]     kv_cache_configs = get_kv_cache_configs(
(EngineCore_DP0 pid=355821) ERROR 01-26 07:40:06 [core.py:866]                        ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=355821) ERROR 01-26 07:40:06 [core.py:866]   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 1340, in get_kv_cache_configs
(EngineCore_DP0 pid=355821) ERROR 01-26 07:40:06 [core.py:866]     check_enough_kv_cache_memory(
(EngineCore_DP0 pid=355821) ERROR 01-26 07:40:06 [core.py:866]   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 687, in check_enough_kv_cache_memory
(EngineCore_DP0 pid=355821) ERROR 01-26 07:40:06 [core.py:866]     raise ValueError(
(EngineCore_DP0 pid=355821) ERROR 01-26 07:40:06 [core.py:866] ValueError: No available memory for the cache blocks. Try increasing `gpu_memory_utilization` when initializing the engine. See https://docs.vllm.ai/en/latest/configuration/conserving_memory/ for more details.

STDERR:
[2026-01-26 07:38:36] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 07:38:36] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-FP8'
[2026-01-26 07:38:36] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-FP8
[2026-01-26 07:38:36] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:38:36] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:38:36] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:38:36] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:38:36] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:38:36] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-FP8'
[2026-01-26 07:38:36] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 07:38:36] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 07:38:36] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 07:38:36] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 07:38:36] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 07:38:44] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 07:38:44] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-FP8'
[2026-01-26 07:38:44] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-FP8
[2026-01-26 07:38:44] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:38:44] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:38:44] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:38:44] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:38:44] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 07:38:44] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-FP8'
[2026-01-26 07:38:44] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 07:38:44] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 07:38:44] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 07:38:44] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 07:38:44] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=355821) [2026-01-26 07:38:46] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=355821) [2026-01-26 07:38:46] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=355821) [2026-01-26 07:38:46] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=355821) [2026-01-26 07:38:46] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=355821) [2026-01-26 07:38:46] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-14B-FP8
(EngineCore_DP0 pid=355821) [2026-01-26 07:38:46] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=355821) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=355821) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.01it/s]
(EngineCore_DP0 pid=355821) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:02<00:02,  1.01s/it]
(EngineCore_DP0 pid=355821) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.38it/s]
(EngineCore_DP0 pid=355821) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.23it/s]
(EngineCore_DP0 pid=355821) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.19it/s]
(EngineCore_DP0 pid=355821) 
(EngineCore_DP0 pid=355821) [2026-01-26 07:38:50] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [7168, 5120] -> 1D uint8
(EngineCore_DP0 pid=355821) [2026-01-26 07:38:50] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 27525120 bytes
(EngineCore_DP0 pid=355821) [2026-01-26 07:38:50] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 5120] -> 1D uint8
(EngineCore_DP0 pid=355821) [2026-01-26 07:38:50] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 19660800 bytes
(EngineCore_DP0 pid=355821) [2026-01-26 07:38:50] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [27648, 5120] -> 1D uint8
(EngineCore_DP0 pid=355821) [2026-01-26 07:38:50] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 106168320 bytes
(EngineCore_DP0 pid=355821) [2026-01-26 07:38:50] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 13824] -> 1D uint8
(EngineCore_DP0 pid=355821) [2026-01-26 07:38:50] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 53084160 bytes
(EngineCore_DP0 pid=355821) [rank0]:W0126 07:39:16.771000 355821 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=355821) [rank0]:W0126 07:39:16.847000 355821 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=355821) [rank0]:W0126 07:39:17.968000 355821 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=355821) [rank0]:W0126 07:39:18.087000 355821 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=355821) Process EngineCore_DP0:
(EngineCore_DP0 pid=355821) Traceback (most recent call last):
(EngineCore_DP0 pid=355821)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=355821)     self.run()
(EngineCore_DP0 pid=355821)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=355821)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=355821)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=355821)     raise e
(EngineCore_DP0 pid=355821)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=355821)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=355821)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=355821)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=355821)     super().__init__(
(EngineCore_DP0 pid=355821)   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=355821)     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=355821)                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=355821)   File "/root/vllmbench/vllm/v1/engine/core.py", line 248, in _initialize_kv_caches
(EngineCore_DP0 pid=355821)     kv_cache_configs = get_kv_cache_configs(
(EngineCore_DP0 pid=355821)                        ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=355821)   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 1340, in get_kv_cache_configs
(EngineCore_DP0 pid=355821)     check_enough_kv_cache_memory(
(EngineCore_DP0 pid=355821)   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 687, in check_enough_kv_cache_memory
(EngineCore_DP0 pid=355821)     raise ValueError(
(EngineCore_DP0 pid=355821) ValueError: No available memory for the cache blocks. Try increasing `gpu_memory_utilization` when initializing the engine. See https://docs.vllm.ai/en/latest/configuration/conserving_memory/ for more details.
[rank0]:[W126 07:40:08.397541340 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

ERROR: Test failed for M=65536

========== M=65536 ==========
Time: 2026-01-26 21:12:43
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-FP8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=8192, max_num_seqs=64
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-FP8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 8192 --max-num-seqs 64 --max-model-len 1025 --max-num-batched-tokens 65536 --no-enable-chunked-prefill --gpu-memory-utilization 0.95 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_4/json/Qwen2.5-14B-FP8_M65536.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 21:13:49 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 21:13:50 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=1079465) ERROR 01-26 21:13:59 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=1079465) ERROR 01-26 21:13:59 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=1079465) ERROR 01-26 21:13:59 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=1079465) ERROR 01-26 21:13:59 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=1079465) ERROR 01-26 21:13:59 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1079465) ERROR 01-26 21:13:59 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=1079465) ERROR 01-26 21:13:59 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=1079465) ERROR 01-26 21:13:59 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 102, in __init__
(EngineCore_DP0 pid=1079465) ERROR 01-26 21:13:59 [core.py:866]     self.model_executor = executor_class(vllm_config)
(EngineCore_DP0 pid=1079465) ERROR 01-26 21:13:59 [core.py:866]                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1079465) ERROR 01-26 21:13:59 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 101, in __init__
(EngineCore_DP0 pid=1079465) ERROR 01-26 21:13:59 [core.py:866]     self._init_executor()
(EngineCore_DP0 pid=1079465) ERROR 01-26 21:13:59 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 47, in _init_executor
(EngineCore_DP0 pid=1079465) ERROR 01-26 21:13:59 [core.py:866]     self.driver_worker.init_device()
(EngineCore_DP0 pid=1079465) ERROR 01-26 21:13:59 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/worker_base.py", line 326, in init_device
(EngineCore_DP0 pid=1079465) ERROR 01-26 21:13:59 [core.py:866]     self.worker.init_device()  # type: ignore
(EngineCore_DP0 pid=1079465) ERROR 01-26 21:13:59 [core.py:866]     ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1079465) ERROR 01-26 21:13:59 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 247, in init_device
(EngineCore_DP0 pid=1079465) ERROR 01-26 21:13:59 [core.py:866]     raise ValueError(
(EngineCore_DP0 pid=1079465) ERROR 01-26 21:13:59 [core.py:866] ValueError: Free memory on device (22.39/23.99 GiB) on startup is less than desired GPU memory utilization (0.95, 22.79 GiB). Decrease GPU memory utilization or reduce GPU memory used by other processes.

STDERR:
[2026-01-26 21:13:48] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 21:13:49] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-FP8'
[2026-01-26 21:13:49] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-FP8
[2026-01-26 21:13:49] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 21:13:49] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 21:13:49] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 21:13:49] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 21:13:49] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 21:13:49] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-FP8'
[2026-01-26 21:13:49] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 21:13:49] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 21:13:49] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 21:13:49] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 21:13:49] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 21:13:57] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 21:13:58] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-FP8'
[2026-01-26 21:13:58] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-FP8
[2026-01-26 21:13:58] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 21:13:58] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 21:13:58] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 21:13:58] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 21:13:58] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 21:13:58] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-FP8'
[2026-01-26 21:13:58] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 21:13:58] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 21:13:58] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 21:13:58] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 21:13:58] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1079465) Process EngineCore_DP0:
(EngineCore_DP0 pid=1079465) Traceback (most recent call last):
(EngineCore_DP0 pid=1079465)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=1079465)     self.run()
(EngineCore_DP0 pid=1079465)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=1079465)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=1079465)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=1079465)     raise e
(EngineCore_DP0 pid=1079465)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=1079465)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=1079465)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1079465)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=1079465)     super().__init__(
(EngineCore_DP0 pid=1079465)   File "/root/vllmbench/vllm/v1/engine/core.py", line 102, in __init__
(EngineCore_DP0 pid=1079465)     self.model_executor = executor_class(vllm_config)
(EngineCore_DP0 pid=1079465)                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1079465)   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 101, in __init__
(EngineCore_DP0 pid=1079465)     self._init_executor()
(EngineCore_DP0 pid=1079465)   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 47, in _init_executor
(EngineCore_DP0 pid=1079465)     self.driver_worker.init_device()
(EngineCore_DP0 pid=1079465)   File "/root/vllmbench/vllm/v1/worker/worker_base.py", line 326, in init_device
(EngineCore_DP0 pid=1079465)     self.worker.init_device()  # type: ignore
(EngineCore_DP0 pid=1079465)     ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1079465)   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 247, in init_device
(EngineCore_DP0 pid=1079465)     raise ValueError(
(EngineCore_DP0 pid=1079465) ValueError: Free memory on device (22.39/23.99 GiB) on startup is less than desired GPU memory utilization (0.95, 22.79 GiB). Decrease GPU memory utilization or reduce GPU memory used by other processes.
[rank0]:[W126 21:14:00.326190963 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

ERROR: Test failed for M=65536

========== M=65536 ==========
Time: 2026-01-26 21:14:25
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-FP8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=8192, max_num_seqs=64
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-FP8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 8192 --max-num-seqs 64 --max-model-len 1025 --max-num-batched-tokens 65536 --no-enable-chunked-prefill --gpu-memory-utilization 0.98 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_4/json/Qwen2.5-14B-FP8_M65536.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 21:15:32 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 21:15:33 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=1081070) ERROR 01-26 21:15:42 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=1081070) ERROR 01-26 21:15:42 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=1081070) ERROR 01-26 21:15:42 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=1081070) ERROR 01-26 21:15:42 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=1081070) ERROR 01-26 21:15:42 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1081070) ERROR 01-26 21:15:42 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=1081070) ERROR 01-26 21:15:42 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=1081070) ERROR 01-26 21:15:42 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 102, in __init__
(EngineCore_DP0 pid=1081070) ERROR 01-26 21:15:42 [core.py:866]     self.model_executor = executor_class(vllm_config)
(EngineCore_DP0 pid=1081070) ERROR 01-26 21:15:42 [core.py:866]                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1081070) ERROR 01-26 21:15:42 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 101, in __init__
(EngineCore_DP0 pid=1081070) ERROR 01-26 21:15:42 [core.py:866]     self._init_executor()
(EngineCore_DP0 pid=1081070) ERROR 01-26 21:15:42 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 47, in _init_executor
(EngineCore_DP0 pid=1081070) ERROR 01-26 21:15:42 [core.py:866]     self.driver_worker.init_device()
(EngineCore_DP0 pid=1081070) ERROR 01-26 21:15:42 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/worker_base.py", line 326, in init_device
(EngineCore_DP0 pid=1081070) ERROR 01-26 21:15:42 [core.py:866]     self.worker.init_device()  # type: ignore
(EngineCore_DP0 pid=1081070) ERROR 01-26 21:15:42 [core.py:866]     ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1081070) ERROR 01-26 21:15:42 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 247, in init_device
(EngineCore_DP0 pid=1081070) ERROR 01-26 21:15:42 [core.py:866]     raise ValueError(
(EngineCore_DP0 pid=1081070) ERROR 01-26 21:15:42 [core.py:866] ValueError: Free memory on device (22.39/23.99 GiB) on startup is less than desired GPU memory utilization (0.98, 23.51 GiB). Decrease GPU memory utilization or reduce GPU memory used by other processes.

STDERR:
[2026-01-26 21:15:31] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 21:15:32] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-FP8'
[2026-01-26 21:15:32] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-FP8
[2026-01-26 21:15:32] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 21:15:32] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 21:15:32] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 21:15:32] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 21:15:32] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 21:15:32] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-FP8'
[2026-01-26 21:15:32] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 21:15:32] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 21:15:32] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 21:15:32] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 21:15:32] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 21:15:39] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 21:15:40] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-FP8'
[2026-01-26 21:15:40] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-FP8
[2026-01-26 21:15:40] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 21:15:40] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 21:15:40] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 21:15:40] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 21:15:40] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 21:15:40] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-FP8'
[2026-01-26 21:15:40] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 21:15:40] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 21:15:40] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 21:15:40] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 21:15:40] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1081070) Process EngineCore_DP0:
(EngineCore_DP0 pid=1081070) Traceback (most recent call last):
(EngineCore_DP0 pid=1081070)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=1081070)     self.run()
(EngineCore_DP0 pid=1081070)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=1081070)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=1081070)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=1081070)     raise e
(EngineCore_DP0 pid=1081070)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=1081070)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=1081070)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1081070)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=1081070)     super().__init__(
(EngineCore_DP0 pid=1081070)   File "/root/vllmbench/vllm/v1/engine/core.py", line 102, in __init__
(EngineCore_DP0 pid=1081070)     self.model_executor = executor_class(vllm_config)
(EngineCore_DP0 pid=1081070)                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1081070)   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 101, in __init__
(EngineCore_DP0 pid=1081070)     self._init_executor()
(EngineCore_DP0 pid=1081070)   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 47, in _init_executor
(EngineCore_DP0 pid=1081070)     self.driver_worker.init_device()
(EngineCore_DP0 pid=1081070)   File "/root/vllmbench/vllm/v1/worker/worker_base.py", line 326, in init_device
(EngineCore_DP0 pid=1081070)     self.worker.init_device()  # type: ignore
(EngineCore_DP0 pid=1081070)     ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1081070)   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 247, in init_device
(EngineCore_DP0 pid=1081070)     raise ValueError(
(EngineCore_DP0 pid=1081070) ValueError: Free memory on device (22.39/23.99 GiB) on startup is less than desired GPU memory utilization (0.98, 23.51 GiB). Decrease GPU memory utilization or reduce GPU memory used by other processes.
[rank0]:[W126 21:15:43.861747400 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

ERROR: Test failed for M=65536
