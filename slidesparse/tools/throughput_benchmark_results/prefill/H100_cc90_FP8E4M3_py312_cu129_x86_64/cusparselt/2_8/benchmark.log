
========== M=512 ==========
Time: 2026-01-26 09:00:45
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-FP8-SlideSparse-2_8
Params: prompt_len=512, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-FP8-SlideSparse-2_8 --dataset-name random --input-len 512 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 513 --max-num-batched-tokens 513 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_FP8E4M3_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-1B-FP8_M512.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 09:00:53 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1103267) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1103267) WARNING 01-26 09:01:06 [backends.py:609] Failed to read file <frozen os>
Throughput: 30.13 requests/s, 15456.94 total tokens/s, 30.13 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128

STDERR:
[2026-01-26 09:00:52] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 09:00:53] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-FP8'
[2026-01-26 09:00:53] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-FP8
[2026-01-26 09:00:53] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:00:53] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:00:53] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:00:53] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:00:53] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:00:53] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-FP8'
[2026-01-26 09:00:53] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 09:00:53] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 09:00:53] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 09:00:53] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 09:00:53] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 09:00:59] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 09:01:00] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-FP8'
[2026-01-26 09:01:00] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-FP8
[2026-01-26 09:01:00] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:01:00] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:01:00] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:01:00] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:01:00] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:01:00] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-FP8'
[2026-01-26 09:01:00] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 09:01:00] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 09:01:00] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 09:01:00] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 09:01:00] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1103267) [2026-01-26 09:01:01] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1103267) [2026-01-26 09:01:01] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1103267) [2026-01-26 09:01:01] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1103267) [2026-01-26 09:01:01] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1103267) [2026-01-26 09:01:01] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Llama3.2-1B-FP8
(EngineCore_DP0 pid=1103267) [2026-01-26 09:01:01] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1103267) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1103267) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.58it/s]
(EngineCore_DP0 pid=1103267) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.58it/s]
(EngineCore_DP0 pid=1103267) 
(EngineCore_DP0 pid=1103267) [2026-01-26 09:01:02] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 3072] -> 1D uint8
(EngineCore_DP0 pid=1103267) [2026-01-26 09:01:02] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 5898240 bytes
(EngineCore_DP0 pid=1103267) [2026-01-26 09:01:02] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2048, 3072] -> 1D uint8
(EngineCore_DP0 pid=1103267) [2026-01-26 09:01:02] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 3932160 bytes
(EngineCore_DP0 pid=1103267) [2026-01-26 09:01:02] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [16384, 3072] -> 1D uint8
(EngineCore_DP0 pid=1103267) [2026-01-26 09:01:02] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 31457280 bytes
(EngineCore_DP0 pid=1103267) [2026-01-26 09:01:02] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2048, 12288] -> 1D uint8
(EngineCore_DP0 pid=1103267) [2026-01-26 09:01:02] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 15728640 bytes
(EngineCore_DP0 pid=1103267) 2026-01-26 09:01:14,149 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1103267) 2026-01-26 09:01:14,216 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1103267) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  5.49it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  4.22it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  4.37it/s]
(EngineCore_DP0 pid=1103267) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00, 18.46it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  40%|███▉      | 51/128 [00:00<00:00, 509.65it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 687.88it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:17,  7.26it/s, est. speed input: 3715.62 toks/s, output: 7.26 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:05, 21.59it/s, est. speed input: 9885.20 toks/s, output: 19.31 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:00<00:04, 26.50it/s, est. speed input: 12072.36 toks/s, output: 23.58 toks/s]
Processed prompts:  10%|█         | 13/128 [00:00<00:03, 28.83it/s, est. speed input: 13183.09 toks/s, output: 25.75 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:00<00:03, 30.10it/s, est. speed input: 13850.48 toks/s, output: 27.05 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:00<00:03, 30.88it/s, est. speed input: 14300.27 toks/s, output: 27.93 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:00<00:03, 31.28it/s, est. speed input: 14604.50 toks/s, output: 28.52 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:01<00:03, 31.63it/s, est. speed input: 14848.75 toks/s, output: 29.00 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:01<00:02, 32.17it/s, est. speed input: 15088.63 toks/s, output: 29.47 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:01<00:02, 32.35it/s, est. speed input: 15253.60 toks/s, output: 29.79 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:01<00:02, 32.25it/s, est. speed input: 15358.15 toks/s, output: 30.00 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:01<00:02, 32.25it/s, est. speed input: 15454.90 toks/s, output: 30.18 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:01<00:02, 32.14it/s, est. speed input: 15522.83 toks/s, output: 30.32 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:01<00:02, 32.14it/s, est. speed input: 15589.33 toks/s, output: 30.45 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:01<00:02, 32.11it/s, est. speed input: 15643.46 toks/s, output: 30.55 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:01<00:02, 32.16it/s, est. speed input: 15699.09 toks/s, output: 30.66 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:02<00:01, 32.41it/s, est. speed input: 15768.25 toks/s, output: 30.80 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:02<00:01, 32.53it/s, est. speed input: 15823.83 toks/s, output: 30.91 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:02<00:01, 32.43it/s, est. speed input: 15858.92 toks/s, output: 30.97 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:02<00:01, 32.35it/s, est. speed input: 15889.45 toks/s, output: 31.03 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:02<00:01, 32.27it/s, est. speed input: 15915.17 toks/s, output: 31.08 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:02<00:01, 32.30it/s, est. speed input: 15945.27 toks/s, output: 31.14 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:02<00:01, 32.26it/s, est. speed input: 15967.70 toks/s, output: 31.19 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:02<00:01, 32.24it/s, est. speed input: 15989.66 toks/s, output: 31.23 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:03<00:00, 32.21it/s, est. speed input: 16007.83 toks/s, output: 31.26 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:03<00:00, 32.23it/s, est. speed input: 16027.75 toks/s, output: 31.30 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:03<00:00, 32.21it/s, est. speed input: 16044.41 toks/s, output: 31.34 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:03<00:00, 32.18it/s, est. speed input: 16058.58 toks/s, output: 31.36 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:03<00:00, 32.19it/s, est. speed input: 16073.56 toks/s, output: 31.39 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:03<00:00, 32.21it/s, est. speed input: 16088.27 toks/s, output: 31.42 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:03<00:00, 32.14it/s, est. speed input: 16097.42 toks/s, output: 31.44 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:03<00:00, 32.41it/s, est. speed input: 16122.65 toks/s, output: 31.49 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:04<00:00, 32.41it/s, est. speed input: 16140.95 toks/s, output: 31.53 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:04<00:00, 31.52it/s, est. speed input: 16140.95 toks/s, output: 31.53 toks/s]
[rank0]:[W126 09:01:20.913535944 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=1024 ==========
Time: 2026-01-26 09:01:23
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-FP8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-FP8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 1025 --max-num-batched-tokens 1025 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_FP8E4M3_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-1B-FP8_M1024.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 09:01:31 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1104347) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1104347) WARNING 01-26 09:01:45 [backends.py:609] Failed to read file <frozen os>
Throughput: 30.47 requests/s, 31230.56 total tokens/s, 30.47 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128

STDERR:
[2026-01-26 09:01:30] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 09:01:31] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-FP8'
[2026-01-26 09:01:31] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-FP8
[2026-01-26 09:01:31] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:01:31] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:01:31] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:01:31] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:01:31] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:01:31] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-FP8'
[2026-01-26 09:01:31] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 09:01:31] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 09:01:31] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 09:01:31] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 09:01:31] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 09:01:38] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 09:01:38] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-FP8'
[2026-01-26 09:01:38] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-FP8
[2026-01-26 09:01:38] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:01:38] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:01:38] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:01:38] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:01:38] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:01:38] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-FP8'
[2026-01-26 09:01:38] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 09:01:38] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 09:01:38] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 09:01:38] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 09:01:38] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1104347) [2026-01-26 09:01:40] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1104347) [2026-01-26 09:01:40] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1104347) [2026-01-26 09:01:40] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1104347) [2026-01-26 09:01:40] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1104347) [2026-01-26 09:01:40] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Llama3.2-1B-FP8
(EngineCore_DP0 pid=1104347) [2026-01-26 09:01:40] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1104347) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1104347) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.58it/s]
(EngineCore_DP0 pid=1104347) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.58it/s]
(EngineCore_DP0 pid=1104347) 
(EngineCore_DP0 pid=1104347) [2026-01-26 09:01:40] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 3072] -> 1D uint8
(EngineCore_DP0 pid=1104347) [2026-01-26 09:01:41] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 5898240 bytes
(EngineCore_DP0 pid=1104347) [2026-01-26 09:01:41] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2048, 3072] -> 1D uint8
(EngineCore_DP0 pid=1104347) [2026-01-26 09:01:41] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 3932160 bytes
(EngineCore_DP0 pid=1104347) [2026-01-26 09:01:41] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [16384, 3072] -> 1D uint8
(EngineCore_DP0 pid=1104347) [2026-01-26 09:01:41] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 31457280 bytes
(EngineCore_DP0 pid=1104347) [2026-01-26 09:01:41] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2048, 12288] -> 1D uint8
(EngineCore_DP0 pid=1104347) [2026-01-26 09:01:41] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 15728640 bytes
(EngineCore_DP0 pid=1104347) 2026-01-26 09:01:53,083 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1104347) 2026-01-26 09:01:53,125 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1104347) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00, 14.48it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00, 14.46it/s]
(EngineCore_DP0 pid=1104347) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  6.91it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  6.90it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  22%|██▏       | 28/128 [00:00<00:00, 279.79it/s]
Adding requests:  62%|██████▎   | 80/128 [00:00<00:00, 417.27it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 429.24it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:03, 32.28it/s, est. speed input: 33062.37 toks/s, output: 32.28 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:00<00:03, 32.57it/s, est. speed input: 33318.82 toks/s, output: 32.53 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:00<00:03, 32.55it/s, est. speed input: 33309.32 toks/s, output: 32.53 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:00<00:03, 32.55it/s, est. speed input: 33318.44 toks/s, output: 32.54 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:00<00:03, 32.49it/s, est. speed input: 33283.84 toks/s, output: 32.50 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:00<00:03, 32.48it/s, est. speed input: 33278.79 toks/s, output: 32.50 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:00<00:03, 32.71it/s, est. speed input: 33375.62 toks/s, output: 32.59 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:00<00:02, 32.81it/s, est. speed input: 33432.22 toks/s, output: 32.65 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:01<00:02, 32.90it/s, est. speed input: 33482.76 toks/s, output: 32.70 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:01<00:02, 32.97it/s, est. speed input: 33524.97 toks/s, output: 32.74 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:01<00:02, 33.01it/s, est. speed input: 33559.44 toks/s, output: 32.77 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:01<00:02, 33.06it/s, est. speed input: 33591.80 toks/s, output: 32.80 toks/s]
Processed prompts:  41%|████      | 52/128 [00:01<00:02, 33.08it/s, est. speed input: 33617.34 toks/s, output: 32.83 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:01<00:02, 33.06it/s, est. speed input: 33631.41 toks/s, output: 32.84 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:01<00:02, 33.16it/s, est. speed input: 33667.06 toks/s, output: 32.88 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:01<00:01, 33.17it/s, est. speed input: 33688.39 toks/s, output: 32.90 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:02<00:01, 33.15it/s, est. speed input: 33700.62 toks/s, output: 32.91 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:02<00:01, 33.00it/s, est. speed input: 33685.16 toks/s, output: 32.90 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:02<00:01, 33.05it/s, est. speed input: 33699.65 toks/s, output: 32.91 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:02<00:01, 33.09it/s, est. speed input: 33714.57 toks/s, output: 32.92 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:02<00:01, 33.17it/s, est. speed input: 33734.61 toks/s, output: 32.94 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:02<00:01, 32.99it/s, est. speed input: 33716.68 toks/s, output: 32.93 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:02<00:01, 32.80it/s, est. speed input: 33691.99 toks/s, output: 32.90 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:02<00:00, 32.74it/s, est. speed input: 33678.40 toks/s, output: 32.89 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:03<00:00, 32.73it/s, est. speed input: 33671.14 toks/s, output: 32.88 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:03<00:00, 32.74it/s, est. speed input: 33666.10 toks/s, output: 32.88 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:03<00:00, 32.68it/s, est. speed input: 33653.32 toks/s, output: 32.86 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:03<00:00, 32.66it/s, est. speed input: 33644.09 toks/s, output: 32.86 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:03<00:00, 32.63it/s, est. speed input: 33634.12 toks/s, output: 32.85 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:03<00:00, 32.66it/s, est. speed input: 33629.53 toks/s, output: 32.84 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:03<00:00, 32.65it/s, est. speed input: 33622.65 toks/s, output: 32.83 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:03<00:00, 32.51it/s, est. speed input: 33601.32 toks/s, output: 32.81 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:03<00:00, 32.51it/s, est. speed input: 33601.32 toks/s, output: 32.81 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:03<00:00, 32.81it/s, est. speed input: 33601.32 toks/s, output: 32.81 toks/s]
[rank0]:[W126 09:01:59.778902768 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=2048 ==========
Time: 2026-01-26 09:02:01
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-FP8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=256, max_num_seqs=2
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-FP8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 256 --max-num-seqs 2 --max-model-len 1025 --max-num-batched-tokens 2048 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_FP8E4M3_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-1B-FP8_M2048.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 09:02:09 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1105381) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1105381) WARNING 01-26 09:02:24 [backends.py:609] Failed to read file <frozen os>
Throughput: 60.09 requests/s, 61595.42 total tokens/s, 60.09 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256

STDERR:
[2026-01-26 09:02:09] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 09:02:09] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-FP8'
[2026-01-26 09:02:09] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-FP8
[2026-01-26 09:02:09] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:02:09] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:02:09] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:02:09] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:02:09] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:02:09] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-FP8'
[2026-01-26 09:02:09] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 09:02:09] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 09:02:09] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 09:02:09] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 09:02:09] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 09:02:16] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 09:02:17] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-FP8'
[2026-01-26 09:02:17] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-FP8
[2026-01-26 09:02:17] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:02:17] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:02:17] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:02:17] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:02:17] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:02:17] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-FP8'
[2026-01-26 09:02:17] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 09:02:17] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 09:02:17] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 09:02:17] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 09:02:17] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1105381) [2026-01-26 09:02:18] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1105381) [2026-01-26 09:02:18] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1105381) [2026-01-26 09:02:18] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1105381) [2026-01-26 09:02:18] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1105381) [2026-01-26 09:02:18] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Llama3.2-1B-FP8
(EngineCore_DP0 pid=1105381) [2026-01-26 09:02:18] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1105381) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1105381) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.11it/s]
(EngineCore_DP0 pid=1105381) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.11it/s]
(EngineCore_DP0 pid=1105381) 
(EngineCore_DP0 pid=1105381) [2026-01-26 09:02:20] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 3072] -> 1D uint8
(EngineCore_DP0 pid=1105381) [2026-01-26 09:02:20] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 5898240 bytes
(EngineCore_DP0 pid=1105381) [2026-01-26 09:02:20] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2048, 3072] -> 1D uint8
(EngineCore_DP0 pid=1105381) [2026-01-26 09:02:20] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 3932160 bytes
(EngineCore_DP0 pid=1105381) [2026-01-26 09:02:20] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [16384, 3072] -> 1D uint8
(EngineCore_DP0 pid=1105381) [2026-01-26 09:02:20] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 31457280 bytes
(EngineCore_DP0 pid=1105381) [2026-01-26 09:02:20] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2048, 12288] -> 1D uint8
(EngineCore_DP0 pid=1105381) [2026-01-26 09:02:20] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 15728640 bytes
(EngineCore_DP0 pid=1105381) 2026-01-26 09:02:31,064 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1105381) 2026-01-26 09:02:31,094 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1105381) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  67%|██████▋   | 2/3 [00:00<00:00,  6.56it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00,  7.54it/s]
(EngineCore_DP0 pid=1105381) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 1/2 [00:00<00:00,  3.54it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  3.79it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  3.75it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  11%|█         | 28/256 [00:00<00:00, 278.94it/s]
Adding requests:  31%|███▏      | 80/256 [00:00<00:00, 415.85it/s]
Adding requests:  51%|█████     | 130/256 [00:00<00:00, 451.79it/s]
Adding requests:  70%|██████▉   | 179/256 [00:00<00:00, 464.87it/s]
Adding requests:  90%|████████▉ | 230/256 [00:00<00:00, 480.31it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 459.64it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   9%|▊         | 22/256 [00:00<00:01, 173.99it/s, est. speed input: 178220.46 toks/s, output: 174.01 toks/s]
Processed prompts:  16%|█▌        | 40/256 [00:00<00:02, 91.26it/s, est. speed input: 101422.58 toks/s, output: 99.04 toks/s]  
Processed prompts:  20%|█▉        | 51/256 [00:00<00:02, 83.78it/s, est. speed input: 93576.83 toks/s, output: 91.38 toks/s] 
Processed prompts:  24%|██▍       | 61/256 [00:00<00:02, 77.18it/s, est. speed input: 87703.98 toks/s, output: 85.65 toks/s]
Processed prompts:  27%|██▋       | 70/256 [00:00<00:02, 71.00it/s, est. speed input: 82787.89 toks/s, output: 80.84 toks/s]
Processed prompts:  30%|███       | 78/256 [00:00<00:02, 69.40it/s, est. speed input: 80792.71 toks/s, output: 78.90 toks/s]
Processed prompts:  34%|███▎      | 86/256 [00:01<00:02, 68.15it/s, est. speed input: 79212.89 toks/s, output: 77.35 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:01<00:02, 67.20it/s, est. speed input: 77937.67 toks/s, output: 76.11 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:01<00:02, 66.34it/s, est. speed input: 76824.49 toks/s, output: 75.02 toks/s]
Processed prompts:  43%|████▎     | 110/256 [00:01<00:02, 66.25it/s, est. speed input: 76072.29 toks/s, output: 74.29 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:01<00:02, 66.36it/s, est. speed input: 75484.61 toks/s, output: 73.71 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:01<00:01, 66.29it/s, est. speed input: 74936.09 toks/s, output: 73.18 toks/s]
Processed prompts:  52%|█████▏    | 134/256 [00:01<00:01, 66.31it/s, est. speed input: 74479.45 toks/s, output: 72.73 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:01<00:01, 66.31it/s, est. speed input: 74075.43 toks/s, output: 72.34 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:02<00:01, 66.26it/s, est. speed input: 73706.18 toks/s, output: 71.98 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:02<00:01, 66.23it/s, est. speed input: 73379.08 toks/s, output: 71.66 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:02<00:01, 66.05it/s, est. speed input: 73055.67 toks/s, output: 71.34 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:02<00:01, 66.09it/s, est. speed input: 72794.77 toks/s, output: 71.09 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:02<00:01, 66.09it/s, est. speed input: 72553.41 toks/s, output: 70.85 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:02<00:01, 65.78it/s, est. speed input: 72282.94 toks/s, output: 70.59 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:02<00:00, 65.51it/s, est. speed input: 72027.07 toks/s, output: 70.34 toks/s]
Processed prompts:  80%|████████  | 206/256 [00:02<00:00, 65.35it/s, est. speed input: 71797.31 toks/s, output: 70.11 toks/s]
Processed prompts:  84%|████████▎ | 214/256 [00:03<00:00, 65.55it/s, est. speed input: 71630.55 toks/s, output: 69.95 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:03<00:00, 65.86it/s, est. speed input: 71501.36 toks/s, output: 69.82 toks/s]
Processed prompts:  90%|████████▉ | 230/256 [00:03<00:00, 65.96it/s, est. speed input: 71365.46 toks/s, output: 69.69 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:03<00:00, 65.70it/s, est. speed input: 71196.41 toks/s, output: 69.53 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:03<00:00, 65.38it/s, est. speed input: 71022.11 toks/s, output: 69.36 toks/s]
Processed prompts:  99%|█████████▉| 254/256 [00:03<00:00, 65.13it/s, est. speed input: 70855.95 toks/s, output: 69.19 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:03<00:00, 65.13it/s, est. speed input: 70829.11 toks/s, output: 69.17 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:03<00:00, 69.16it/s, est. speed input: 70829.11 toks/s, output: 69.17 toks/s]
[rank0]:[W126 09:02:38.167785268 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=4096 ==========
Time: 2026-01-26 09:02:40
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-FP8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=512, max_num_seqs=4
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-FP8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 512 --max-num-seqs 4 --max-model-len 1025 --max-num-batched-tokens 4096 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_FP8E4M3_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-1B-FP8_M4096.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 09:02:49 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1106431) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1106431) WARNING 01-26 09:03:02 [backends.py:609] Failed to read file <frozen os>
Throughput: 118.20 requests/s, 121153.47 total tokens/s, 118.20 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512

STDERR:
[2026-01-26 09:02:48] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 09:02:49] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-FP8'
[2026-01-26 09:02:49] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-FP8
[2026-01-26 09:02:49] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:02:49] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:02:49] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:02:49] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:02:49] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:02:49] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-FP8'
[2026-01-26 09:02:49] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 09:02:49] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 09:02:49] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 09:02:49] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 09:02:49] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 09:02:55] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 09:02:56] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-FP8'
[2026-01-26 09:02:56] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-FP8
[2026-01-26 09:02:56] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:02:56] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:02:56] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:02:56] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:02:56] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:02:56] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-FP8'
[2026-01-26 09:02:56] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 09:02:56] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 09:02:56] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 09:02:56] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 09:02:56] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1106431) [2026-01-26 09:02:58] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1106431) [2026-01-26 09:02:58] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1106431) [2026-01-26 09:02:58] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1106431) [2026-01-26 09:02:58] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1106431) [2026-01-26 09:02:58] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Llama3.2-1B-FP8
(EngineCore_DP0 pid=1106431) [2026-01-26 09:02:58] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1106431) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1106431) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.58it/s]
(EngineCore_DP0 pid=1106431) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.58it/s]
(EngineCore_DP0 pid=1106431) 
(EngineCore_DP0 pid=1106431) [2026-01-26 09:02:58] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 3072] -> 1D uint8
(EngineCore_DP0 pid=1106431) [2026-01-26 09:02:58] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 5898240 bytes
(EngineCore_DP0 pid=1106431) [2026-01-26 09:02:58] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2048, 3072] -> 1D uint8
(EngineCore_DP0 pid=1106431) [2026-01-26 09:02:58] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 3932160 bytes
(EngineCore_DP0 pid=1106431) [2026-01-26 09:02:58] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [16384, 3072] -> 1D uint8
(EngineCore_DP0 pid=1106431) [2026-01-26 09:02:58] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 31457280 bytes
(EngineCore_DP0 pid=1106431) [2026-01-26 09:02:58] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2048, 12288] -> 1D uint8
(EngineCore_DP0 pid=1106431) [2026-01-26 09:02:58] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 15728640 bytes
(EngineCore_DP0 pid=1106431) 2026-01-26 09:03:10,143 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1106431) 2026-01-26 09:03:10,197 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1106431) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 2/4 [00:00<00:00, 15.45it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00, 16.38it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00, 16.22it/s]
(EngineCore_DP0 pid=1106431) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  67%|██████▋   | 2/3 [00:00<00:00, 19.55it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00, 19.85it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   5%|▍         | 24/512 [00:00<00:02, 238.55it/s]
Adding requests:  14%|█▍        | 74/512 [00:00<00:01, 390.08it/s]
Adding requests:  24%|██▍       | 125/512 [00:00<00:00, 440.39it/s]
Adding requests:  34%|███▍      | 174/512 [00:00<00:00, 456.63it/s]
Adding requests:  44%|████▍     | 225/512 [00:00<00:00, 473.89it/s]
Adding requests:  54%|█████▍    | 277/512 [00:00<00:00, 484.40it/s]
Adding requests:  64%|██████▍   | 327/512 [00:00<00:00, 486.43it/s]
Adding requests:  74%|███████▍  | 379/512 [00:00<00:00, 494.56it/s]
Adding requests:  84%|████████▍ | 430/512 [00:00<00:00, 497.90it/s]
Adding requests:  94%|█████████▍| 480/512 [00:01<00:00, 496.68it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 473.53it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  22%|██▏       | 114/512 [00:00<00:00, 913.94it/s, est. speed input: 936016.09 toks/s, output: 913.98 toks/s]
Processed prompts:  40%|████      | 206/512 [00:00<00:01, 213.21it/s, est. speed input: 250190.17 toks/s, output: 244.31 toks/s]
Processed prompts:  49%|████▉     | 252/512 [00:01<00:01, 182.33it/s, est. speed input: 216666.81 toks/s, output: 211.59 toks/s]
Processed prompts:  55%|█████▌    | 283/512 [00:01<00:01, 165.56it/s, est. speed input: 200841.11 toks/s, output: 196.13 toks/s]
Processed prompts:  60%|█████▉    | 307/512 [00:01<00:01, 156.61it/s, est. speed input: 192659.29 toks/s, output: 188.14 toks/s]
Processed prompts:  64%|██████▍   | 327/512 [00:01<00:01, 150.00it/s, est. speed input: 187052.97 toks/s, output: 182.67 toks/s]
Processed prompts:  67%|██████▋   | 345/512 [00:01<00:01, 147.66it/s, est. speed input: 183991.31 toks/s, output: 179.68 toks/s]
Processed prompts:  71%|███████   | 362/512 [00:02<00:01, 137.21it/s, est. speed input: 178384.33 toks/s, output: 174.20 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [00:02<00:00, 134.90it/s, est. speed input: 175630.52 toks/s, output: 171.51 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [00:02<00:00, 132.80it/s, est. speed input: 173125.24 toks/s, output: 169.07 toks/s]
Processed prompts:  80%|████████  | 410/512 [00:02<00:00, 131.21it/s, est. speed input: 170894.00 toks/s, output: 166.89 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [00:02<00:00, 130.03it/s, est. speed input: 168893.36 toks/s, output: 164.93 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [00:02<00:00, 129.27it/s, est. speed input: 167103.70 toks/s, output: 163.19 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [00:02<00:00, 128.00it/s, est. speed input: 165330.75 toks/s, output: 161.45 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [00:02<00:00, 127.66it/s, est. speed input: 163821.71 toks/s, output: 159.98 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [00:03<00:00, 127.47it/s, est. speed input: 162445.05 toks/s, output: 158.64 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [00:03<00:00, 127.34it/s, est. speed input: 161175.80 toks/s, output: 157.40 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:03<00:00, 127.34it/s, est. speed input: 161400.00 toks/s, output: 157.62 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:03<00:00, 157.61it/s, est. speed input: 161400.00 toks/s, output: 157.62 toks/s]
[rank0]:[W126 09:03:16.830162482 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=8192 ==========
Time: 2026-01-26 09:03:19
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-FP8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=1024, max_num_seqs=8
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-FP8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 1024 --max-num-seqs 8 --max-model-len 1025 --max-num-batched-tokens 8192 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_FP8E4M3_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-1B-FP8_M8192.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 09:03:30 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1107507) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1107507) WARNING 01-26 09:03:43 [backends.py:609] Failed to read file <frozen os>
Throughput: 148.95 requests/s, 152678.70 total tokens/s, 148.95 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024

STDERR:
[2026-01-26 09:03:29] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 09:03:30] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-FP8'
[2026-01-26 09:03:30] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-FP8
[2026-01-26 09:03:30] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:03:30] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:03:30] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:03:30] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:03:30] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:03:30] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-FP8'
[2026-01-26 09:03:30] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 09:03:30] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 09:03:30] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 09:03:30] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 09:03:30] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 09:03:36] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 09:03:37] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-FP8'
[2026-01-26 09:03:37] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-FP8
[2026-01-26 09:03:37] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:03:37] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:03:37] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:03:37] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:03:37] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:03:37] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-FP8'
[2026-01-26 09:03:37] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 09:03:37] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 09:03:37] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 09:03:37] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 09:03:37] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1107507) [2026-01-26 09:03:38] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1107507) [2026-01-26 09:03:38] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1107507) [2026-01-26 09:03:38] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1107507) [2026-01-26 09:03:38] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1107507) [2026-01-26 09:03:38] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Llama3.2-1B-FP8
(EngineCore_DP0 pid=1107507) [2026-01-26 09:03:38] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1107507) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1107507) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.60it/s]
(EngineCore_DP0 pid=1107507) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.59it/s]
(EngineCore_DP0 pid=1107507) 
(EngineCore_DP0 pid=1107507) [2026-01-26 09:03:39] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 3072] -> 1D uint8
(EngineCore_DP0 pid=1107507) [2026-01-26 09:03:39] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 5898240 bytes
(EngineCore_DP0 pid=1107507) [2026-01-26 09:03:39] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2048, 3072] -> 1D uint8
(EngineCore_DP0 pid=1107507) [2026-01-26 09:03:39] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 3932160 bytes
(EngineCore_DP0 pid=1107507) [2026-01-26 09:03:39] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [16384, 3072] -> 1D uint8
(EngineCore_DP0 pid=1107507) [2026-01-26 09:03:39] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 31457280 bytes
(EngineCore_DP0 pid=1107507) [2026-01-26 09:03:39] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2048, 12288] -> 1D uint8
(EngineCore_DP0 pid=1107507) [2026-01-26 09:03:39] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 15728640 bytes
(EngineCore_DP0 pid=1107507) 2026-01-26 09:03:51,156 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1107507) 2026-01-26 09:03:51,187 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1107507) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:01,  3.07it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  40%|████      | 2/5 [00:00<00:00,  4.14it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  60%|██████    | 3/5 [00:00<00:00,  3.27it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:01<00:00,  5.63it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:01<00:00,  4.76it/s]
(EngineCore_DP0 pid=1107507) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 2/4 [00:00<00:00, 19.78it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00, 20.29it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   3%|▎         | 28/1024 [00:00<00:03, 275.27it/s]
Adding requests:   8%|▊         | 80/1024 [00:00<00:02, 413.47it/s]
Adding requests:  13%|█▎        | 131/1024 [00:00<00:01, 453.87it/s]
Adding requests:  18%|█▊        | 180/1024 [00:00<00:01, 465.13it/s]
Adding requests:  23%|██▎       | 231/1024 [00:00<00:01, 479.06it/s]
Adding requests:  27%|██▋       | 281/1024 [00:00<00:01, 485.26it/s]
Adding requests:  32%|███▏      | 331/1024 [00:00<00:01, 487.25it/s]
Adding requests:  37%|███▋      | 382/1024 [00:00<00:01, 492.61it/s]
Adding requests:  42%|████▏     | 433/1024 [00:00<00:01, 496.64it/s]
Adding requests:  47%|████▋     | 483/1024 [00:01<00:01, 496.79it/s]
Adding requests:  52%|█████▏    | 533/1024 [00:01<00:01, 479.18it/s]
Adding requests:  57%|█████▋    | 584/1024 [00:01<00:00, 488.25it/s]
Adding requests:  62%|██████▏   | 635/1024 [00:01<00:00, 493.44it/s]
Adding requests:  67%|██████▋   | 687/1024 [00:01<00:00, 500.20it/s]
Adding requests:  72%|███████▏  | 739/1024 [00:01<00:00, 503.77it/s]
Adding requests:  77%|███████▋  | 790/1024 [00:01<00:00, 498.98it/s]
Adding requests:  82%|████████▏ | 840/1024 [00:01<00:00, 489.92it/s]
Adding requests:  87%|████████▋ | 892/1024 [00:01<00:00, 497.66it/s]
Adding requests:  92%|█████████▏| 942/1024 [00:01<00:00, 497.46it/s]
Adding requests:  97%|█████████▋| 994/1024 [00:02<00:00, 501.61it/s]
Adding requests: 100%|██████████| 1024/1024 [00:02<00:00, 487.39it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:00<00:00, 1754.07it/s, est. speed input: 1796466.86 toks/s, output: 1754.15 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:01<00:02, 291.51it/s, est. speed input: 345551.23 toks/s, output: 337.44 toks/s]   
Processed prompts:  46%|████▌     | 469/1024 [00:01<00:02, 251.13it/s, est. speed input: 300317.14 toks/s, output: 293.28 toks/s]
Processed prompts:  51%|█████     | 523/1024 [00:01<00:02, 228.10it/s, est. speed input: 278517.57 toks/s, output: 271.99 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:02<00:02, 214.96it/s, est. speed input: 267048.48 toks/s, output: 260.79 toks/s]
Processed prompts:  58%|█████▊    | 593/1024 [00:02<00:01, 216.38it/s, est. speed input: 264770.66 toks/s, output: 258.56 toks/s]
Processed prompts:  61%|██████    | 621/1024 [00:02<00:01, 201.85it/s, est. speed input: 256768.16 toks/s, output: 250.75 toks/s]
Processed prompts:  63%|██████▎   | 645/1024 [00:02<00:01, 196.25it/s, est. speed input: 252588.17 toks/s, output: 246.67 toks/s]
Processed prompts:  65%|██████▌   | 667/1024 [00:02<00:01, 188.08it/s, est. speed input: 248091.88 toks/s, output: 242.28 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:02<00:01, 182.64it/s, est. speed input: 244313.16 toks/s, output: 238.58 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:03<00:01, 180.08it/s, est. speed input: 241213.64 toks/s, output: 235.56 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:03<00:01, 178.24it/s, est. speed input: 238421.25 toks/s, output: 232.83 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:03<00:01, 176.88it/s, est. speed input: 235869.66 toks/s, output: 230.34 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:03<00:01, 176.09it/s, est. speed input: 233564.29 toks/s, output: 228.09 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:03<00:01, 175.44it/s, est. speed input: 231423.18 toks/s, output: 226.00 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:03<00:01, 174.88it/s, est. speed input: 229427.15 toks/s, output: 224.05 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:03<00:00, 174.41it/s, est. speed input: 227562.85 toks/s, output: 222.23 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [00:03<00:00, 173.94it/s, est. speed input: 225805.66 toks/s, output: 220.51 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [00:04<00:00, 173.61it/s, est. speed input: 224167.29 toks/s, output: 218.91 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [00:04<00:00, 173.39it/s, est. speed input: 222636.41 toks/s, output: 217.42 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [00:04<00:00, 174.96it/s, est. speed input: 221432.12 toks/s, output: 216.24 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [00:04<00:00, 174.71it/s, est. speed input: 220126.17 toks/s, output: 214.97 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [00:04<00:00, 176.27it/s, est. speed input: 219107.37 toks/s, output: 213.97 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:04<00:00, 176.27it/s, est. speed input: 219774.88 toks/s, output: 214.62 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:04<00:00, 214.61it/s, est. speed input: 219774.88 toks/s, output: 214.62 toks/s]
[rank0]:[W126 09:04:01.249623872 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=16384 ==========
Time: 2026-01-26 09:04:03
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-FP8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=2048, max_num_seqs=16
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-FP8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 2048 --max-num-seqs 16 --max-model-len 1025 --max-num-batched-tokens 16384 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_FP8E4M3_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-1B-FP8_M16384.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 09:04:18 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1108678) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1108678) WARNING 01-26 09:04:32 [backends.py:609] Failed to read file <frozen os>
Throughput: 175.65 requests/s, 180043.54 total tokens/s, 175.65 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048

STDERR:
[2026-01-26 09:04:18] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 09:04:18] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-FP8'
[2026-01-26 09:04:18] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-FP8
[2026-01-26 09:04:18] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:04:18] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:04:18] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:04:18] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:04:18] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:04:18] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-FP8'
[2026-01-26 09:04:18] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 09:04:18] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 09:04:18] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 09:04:18] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 09:04:18] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 09:04:25] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 09:04:26] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-FP8'
[2026-01-26 09:04:26] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-FP8
[2026-01-26 09:04:26] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:04:26] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:04:26] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:04:26] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:04:26] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:04:26] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-FP8'
[2026-01-26 09:04:26] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 09:04:26] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 09:04:26] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 09:04:26] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 09:04:26] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1108678) [2026-01-26 09:04:27] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1108678) [2026-01-26 09:04:27] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1108678) [2026-01-26 09:04:27] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1108678) [2026-01-26 09:04:27] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1108678) [2026-01-26 09:04:27] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Llama3.2-1B-FP8
(EngineCore_DP0 pid=1108678) [2026-01-26 09:04:27] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1108678) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1108678) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.56it/s]
(EngineCore_DP0 pid=1108678) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.56it/s]
(EngineCore_DP0 pid=1108678) 
(EngineCore_DP0 pid=1108678) [2026-01-26 09:04:28] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 3072] -> 1D uint8
(EngineCore_DP0 pid=1108678) [2026-01-26 09:04:28] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 5898240 bytes
(EngineCore_DP0 pid=1108678) [2026-01-26 09:04:28] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2048, 3072] -> 1D uint8
(EngineCore_DP0 pid=1108678) [2026-01-26 09:04:28] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 3932160 bytes
(EngineCore_DP0 pid=1108678) [2026-01-26 09:04:28] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [16384, 3072] -> 1D uint8
(EngineCore_DP0 pid=1108678) [2026-01-26 09:04:28] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 31457280 bytes
(EngineCore_DP0 pid=1108678) [2026-01-26 09:04:28] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2048, 12288] -> 1D uint8
(EngineCore_DP0 pid=1108678) [2026-01-26 09:04:28] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 15728640 bytes
(EngineCore_DP0 pid=1108678) 2026-01-26 09:04:39,932 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1108678) 2026-01-26 09:04:39,964 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1108678) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  29%|██▊       | 2/7 [00:00<00:00, 14.38it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  71%|███████▏  | 5/7 [00:00<00:00, 18.05it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00, 12.58it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00, 13.50it/s]
(EngineCore_DP0 pid=1108678) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  20%|██        | 1/5 [00:00<00:00,  4.16it/s]
Capturing CUDA graphs (decode, FULL):  60%|██████    | 3/5 [00:00<00:00,  4.73it/s]
Capturing CUDA graphs (decode, FULL):  80%|████████  | 4/5 [00:00<00:00,  5.66it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00,  6.23it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 31/2048 [00:00<00:06, 305.07it/s]
Adding requests:   4%|▍         | 82/2048 [00:00<00:04, 424.39it/s]
Adding requests:   6%|▋         | 131/2048 [00:00<00:04, 450.88it/s]
Adding requests:   9%|▊         | 177/2048 [00:00<00:04, 452.92it/s]
Adding requests:  11%|█         | 226/2048 [00:00<00:03, 465.22it/s]
Adding requests:  13%|█▎        | 276/2048 [00:00<00:03, 476.95it/s]
Adding requests:  16%|█▌        | 324/2048 [00:00<00:03, 476.93it/s]
Adding requests:  18%|█▊        | 374/2048 [00:00<00:03, 483.73it/s]
Adding requests:  21%|██        | 424/2048 [00:00<00:03, 488.51it/s]
Adding requests:  23%|██▎       | 473/2048 [00:01<00:03, 488.21it/s]
Adding requests:  25%|██▌       | 522/2048 [00:01<00:03, 479.32it/s]
Adding requests:  28%|██▊       | 572/2048 [00:01<00:03, 484.37it/s]
Adding requests:  30%|███       | 622/2048 [00:01<00:02, 488.54it/s]
Adding requests:  33%|███▎      | 672/2048 [00:01<00:02, 491.58it/s]
Adding requests:  35%|███▌      | 724/2048 [00:01<00:02, 498.06it/s]
Adding requests:  38%|███▊      | 774/2048 [00:01<00:02, 482.91it/s]
Adding requests:  40%|████      | 823/2048 [00:01<00:02, 478.18it/s]
Adding requests:  43%|████▎     | 873/2048 [00:01<00:02, 484.20it/s]
Adding requests:  45%|████▌     | 924/2048 [00:01<00:02, 491.66it/s]
Adding requests:  48%|████▊     | 975/2048 [00:02<00:02, 494.52it/s]
Adding requests:  50%|█████     | 1026/2048 [00:02<00:02, 496.58it/s]
Adding requests:  53%|█████▎    | 1076/2048 [00:02<00:01, 492.86it/s]
Adding requests:  55%|█████▍    | 1126/2048 [00:02<00:01, 492.11it/s]
Adding requests:  58%|█████▊    | 1178/2048 [00:02<00:01, 499.25it/s]
Adding requests:  60%|██████    | 1230/2048 [00:02<00:01, 503.12it/s]
Adding requests:  63%|██████▎   | 1281/2048 [00:02<00:01, 497.46it/s]
Adding requests:  65%|██████▌   | 1332/2048 [00:02<00:01, 500.62it/s]
Adding requests:  68%|██████▊   | 1383/2048 [00:02<00:01, 502.02it/s]
Adding requests:  70%|███████   | 1434/2048 [00:02<00:01, 503.46it/s]
Adding requests:  73%|███████▎  | 1485/2048 [00:03<00:01, 505.26it/s]
Adding requests:  75%|███████▌  | 1537/2048 [00:03<00:01, 507.74it/s]
Adding requests:  78%|███████▊  | 1589/2048 [00:03<00:00, 509.38it/s]
Adding requests:  80%|████████  | 1641/2048 [00:03<00:00, 512.20it/s]
Adding requests:  83%|████████▎ | 1693/2048 [00:03<00:00, 507.75it/s]
Adding requests:  85%|████████▌ | 1745/2048 [00:03<00:00, 507.86it/s]
Adding requests:  88%|████████▊ | 1796/2048 [00:03<00:00, 508.20it/s]
Adding requests:  90%|█████████ | 1847/2048 [00:03<00:00, 501.54it/s]
Adding requests:  93%|█████████▎| 1898/2048 [00:03<00:00, 499.09it/s]
Adding requests:  95%|█████████▌| 1949/2048 [00:03<00:00, 500.90it/s]
Adding requests:  98%|█████████▊| 2001/2048 [00:04<00:00, 504.83it/s]
Adding requests: 100%|██████████| 2048/2048 [00:04<00:00, 492.07it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [00:00<00:00, 6359.35it/s, est. speed input: 6513418.89 toks/s, output: 6359.78 toks/s]
Processed prompts:  65%|██████▍   | 1326/2048 [00:03<00:02, 318.95it/s, est. speed input: 383472.10 toks/s, output: 374.48 toks/s]  
Processed prompts:  78%|███████▊  | 1599/2048 [00:05<00:01, 267.03it/s, est. speed input: 324824.00 toks/s, output: 317.21 toks/s]
Processed prompts:  86%|████████▌ | 1756/2048 [00:05<00:01, 245.45it/s, est. speed input: 303544.84 toks/s, output: 296.43 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [00:06<00:00, 229.68it/s, est. speed input: 290762.00 toks/s, output: 283.95 toks/s]
Processed prompts:  94%|█████████▍| 1929/2048 [00:06<00:00, 225.97it/s, est. speed input: 286515.75 toks/s, output: 279.80 toks/s]
Processed prompts:  97%|█████████▋| 1983/2048 [00:07<00:00, 223.66it/s, est. speed input: 283829.11 toks/s, output: 277.18 toks/s]
Processed prompts:  99%|█████████▉| 2026/2048 [00:07<00:00, 215.08it/s, est. speed input: 279908.53 toks/s, output: 273.35 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:07<00:00, 215.08it/s, est. speed input: 279816.37 toks/s, output: 273.26 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:07<00:00, 273.25it/s, est. speed input: 279816.37 toks/s, output: 273.26 toks/s]
[rank0]:[W126 09:04:54.808717975 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=32768 ==========
Time: 2026-01-26 09:04:56
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-FP8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=4096, max_num_seqs=32
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-FP8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 4096 --max-num-seqs 32 --max-model-len 1025 --max-num-batched-tokens 32768 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_FP8E4M3_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-1B-FP8_M32768.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 09:05:20 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1110012) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1110012) WARNING 01-26 09:05:34 [backends.py:609] Failed to read file <frozen os>
Throughput: 185.38 requests/s, 190017.67 total tokens/s, 185.38 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096

STDERR:
[2026-01-26 09:05:20] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 09:05:20] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-FP8'
[2026-01-26 09:05:20] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-FP8
[2026-01-26 09:05:20] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:05:20] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:05:20] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:05:20] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:05:20] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:05:20] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-FP8'
[2026-01-26 09:05:20] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 09:05:20] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 09:05:20] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 09:05:20] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 09:05:20] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 09:05:27] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 09:05:28] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-FP8'
[2026-01-26 09:05:28] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-FP8
[2026-01-26 09:05:28] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:05:28] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:05:28] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:05:28] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:05:28] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:05:28] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-FP8'
[2026-01-26 09:05:28] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 09:05:28] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 09:05:28] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 09:05:28] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 09:05:28] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1110012) [2026-01-26 09:05:29] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1110012) [2026-01-26 09:05:29] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1110012) [2026-01-26 09:05:29] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1110012) [2026-01-26 09:05:29] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1110012) [2026-01-26 09:05:29] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Llama3.2-1B-FP8
(EngineCore_DP0 pid=1110012) [2026-01-26 09:05:29] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1110012) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1110012) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.61it/s]
(EngineCore_DP0 pid=1110012) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.61it/s]
(EngineCore_DP0 pid=1110012) 
(EngineCore_DP0 pid=1110012) [2026-01-26 09:05:30] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 3072] -> 1D uint8
(EngineCore_DP0 pid=1110012) [2026-01-26 09:05:30] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 5898240 bytes
(EngineCore_DP0 pid=1110012) [2026-01-26 09:05:30] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2048, 3072] -> 1D uint8
(EngineCore_DP0 pid=1110012) [2026-01-26 09:05:30] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 3932160 bytes
(EngineCore_DP0 pid=1110012) [2026-01-26 09:05:30] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [16384, 3072] -> 1D uint8
(EngineCore_DP0 pid=1110012) [2026-01-26 09:05:30] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 31457280 bytes
(EngineCore_DP0 pid=1110012) [2026-01-26 09:05:30] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2048, 12288] -> 1D uint8
(EngineCore_DP0 pid=1110012) [2026-01-26 09:05:30] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 15728640 bytes
(EngineCore_DP0 pid=1110012) [rank0]:W0126 09:05:38.301000 1110012 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1110012) [rank0]:W0126 09:05:38.355000 1110012 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1110012) [rank0]:W0126 09:05:38.990000 1110012 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1110012) [rank0]:W0126 09:05:39.065000 1110012 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1110012) 2026-01-26 09:05:41,938 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1110012) 2026-01-26 09:05:42,002 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1110012) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  18%|█▊        | 2/11 [00:00<00:00, 14.07it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  36%|███▋      | 4/11 [00:00<00:00, 13.86it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  55%|█████▍    | 6/11 [00:00<00:00, 10.44it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  73%|███████▎  | 8/11 [00:00<00:00, 11.31it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  91%|█████████ | 10/11 [00:01<00:00,  6.14it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00,  8.10it/s]
(EngineCore_DP0 pid=1110012) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  14%|█▍        | 1/7 [00:00<00:00,  6.68it/s]
Capturing CUDA graphs (decode, FULL):  43%|████▎     | 3/7 [00:00<00:00, 12.03it/s]
Capturing CUDA graphs (decode, FULL):  71%|███████▏  | 5/7 [00:00<00:00, 15.12it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00, 14.99it/s]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   1%|          | 34/4096 [00:00<00:11, 339.48it/s]
Adding requests:   2%|▏         | 85/4096 [00:00<00:09, 435.48it/s]
Adding requests:   3%|▎         | 135/4096 [00:00<00:08, 464.20it/s]
Adding requests:   4%|▍         | 184/4096 [00:00<00:08, 472.81it/s]
Adding requests:   6%|▌         | 235/4096 [00:00<00:07, 484.74it/s]
Adding requests:   7%|▋         | 286/4096 [00:00<00:07, 491.35it/s]
Adding requests:   8%|▊         | 336/4096 [00:00<00:07, 488.47it/s]
Adding requests:   9%|▉         | 387/4096 [00:00<00:07, 494.86it/s]
Adding requests:  11%|█         | 437/4096 [00:00<00:07, 496.23it/s]
Adding requests:  12%|█▏        | 488/4096 [00:01<00:07, 498.75it/s]
Adding requests:  13%|█▎        | 538/4096 [00:01<00:07, 486.35it/s]
Adding requests:  14%|█▍        | 591/4096 [00:01<00:07, 496.97it/s]
Adding requests:  16%|█▌        | 642/4096 [00:01<00:06, 497.90it/s]
Adding requests:  17%|█▋        | 694/4096 [00:01<00:06, 503.55it/s]
Adding requests:  18%|█▊        | 745/4096 [00:01<00:06, 501.97it/s]
Adding requests:  19%|█▉        | 796/4096 [00:01<00:06, 498.03it/s]
Adding requests:  21%|██        | 846/4096 [00:01<00:06, 489.13it/s]
Adding requests:  22%|██▏       | 898/4096 [00:01<00:06, 497.01it/s]
Adding requests:  23%|██▎       | 949/4096 [00:01<00:06, 498.09it/s]
Adding requests:  24%|██▍       | 1000/4096 [00:02<00:06, 500.89it/s]
Adding requests:  26%|██▌       | 1052/4096 [00:02<00:06, 505.33it/s]
Adding requests:  27%|██▋       | 1103/4096 [00:02<00:06, 491.30it/s]
Adding requests:  28%|██▊       | 1153/4096 [00:02<00:06, 479.66it/s]
Adding requests:  29%|██▉       | 1206/4096 [00:02<00:05, 492.08it/s]
Adding requests:  31%|███       | 1256/4096 [00:02<00:05, 492.28it/s]
Adding requests:  32%|███▏      | 1307/4096 [00:02<00:05, 496.32it/s]
Adding requests:  33%|███▎      | 1359/4096 [00:02<00:05, 499.95it/s]
Adding requests:  34%|███▍      | 1413/4096 [00:02<00:05, 509.24it/s]
Adding requests:  36%|███▌      | 1464/4096 [00:02<00:05, 509.07it/s]
Adding requests:  37%|███▋      | 1517/4096 [00:03<00:05, 512.36it/s]
Adding requests:  38%|███▊      | 1569/4096 [00:03<00:04, 512.63it/s]
Adding requests:  40%|███▉      | 1622/4096 [00:03<00:04, 515.76it/s]
Adding requests:  41%|████      | 1674/4096 [00:03<00:04, 513.20it/s]
Adding requests:  42%|████▏     | 1727/4096 [00:03<00:04, 515.12it/s]
Adding requests:  43%|████▎     | 1779/4096 [00:03<00:04, 511.37it/s]
Adding requests:  45%|████▍     | 1831/4096 [00:03<00:04, 510.97it/s]
Adding requests:  46%|████▌     | 1883/4096 [00:03<00:04, 511.24it/s]
Adding requests:  47%|████▋     | 1935/4096 [00:03<00:04, 510.19it/s]
Adding requests:  49%|████▊     | 1987/4096 [00:03<00:04, 509.16it/s]
Adding requests:  50%|████▉     | 2039/4096 [00:04<00:04, 510.86it/s]
Adding requests:  51%|█████     | 2092/4096 [00:04<00:03, 513.93it/s]
Adding requests:  52%|█████▏    | 2144/4096 [00:04<00:03, 506.43it/s]
Adding requests:  54%|█████▎    | 2195/4096 [00:04<00:03, 503.33it/s]
Adding requests:  55%|█████▍    | 2247/4096 [00:04<00:03, 507.47it/s]
Adding requests:  56%|█████▌    | 2299/4096 [00:04<00:03, 508.09it/s]
Adding requests:  57%|█████▋    | 2350/4096 [00:04<00:03, 495.26it/s]
Adding requests:  59%|█████▊    | 2401/4096 [00:04<00:03, 496.99it/s]
Adding requests:  60%|█████▉    | 2452/4096 [00:04<00:03, 499.58it/s]
Adding requests:  61%|██████    | 2503/4096 [00:05<00:03, 502.42it/s]
Adding requests:  62%|██████▏   | 2555/4096 [00:05<00:03, 507.20it/s]
Adding requests:  64%|██████▎   | 2606/4096 [00:05<00:02, 507.82it/s]
Adding requests:  65%|██████▍   | 2658/4096 [00:05<00:02, 510.92it/s]
Adding requests:  66%|██████▌   | 2710/4096 [00:05<00:02, 505.16it/s]
Adding requests:  67%|██████▋   | 2761/4096 [00:05<00:02, 505.27it/s]
Adding requests:  69%|██████▊   | 2812/4096 [00:05<00:02, 502.58it/s]
Adding requests:  70%|██████▉   | 2863/4096 [00:05<00:02, 503.37it/s]
Adding requests:  71%|███████   | 2915/4096 [00:05<00:02, 506.10it/s]
Adding requests:  72%|███████▏  | 2966/4096 [00:05<00:02, 501.43it/s]
Adding requests:  74%|███████▎  | 3017/4096 [00:06<00:02, 503.67it/s]
Adding requests:  75%|███████▍  | 3068/4096 [00:06<00:02, 502.02it/s]
Adding requests:  76%|███████▌  | 3120/4096 [00:06<00:01, 504.30it/s]
Adding requests:  77%|███████▋  | 3171/4096 [00:06<00:01, 502.06it/s]
Adding requests:  79%|███████▊  | 3222/4096 [00:06<00:01, 502.28it/s]
Adding requests:  80%|███████▉  | 3274/4096 [00:06<00:01, 505.98it/s]
Adding requests:  81%|████████  | 3325/4096 [00:06<00:01, 504.92it/s]
Adding requests:  82%|████████▏ | 3378/4096 [00:06<00:01, 509.66it/s]
Adding requests:  84%|████████▎ | 3430/4096 [00:06<00:01, 510.52it/s]
Adding requests:  85%|████████▌ | 3482/4096 [00:06<00:01, 500.79it/s]
Adding requests:  86%|████████▋ | 3533/4096 [00:07<00:01, 500.86it/s]
Adding requests:  88%|████████▊ | 3584/4096 [00:07<00:01, 501.00it/s]
Adding requests:  89%|████████▊ | 3635/4096 [00:07<00:00, 488.82it/s]
Adding requests:  90%|████████▉ | 3686/4096 [00:07<00:00, 494.20it/s]
Adding requests:  91%|█████████ | 3736/4096 [00:07<00:00, 495.75it/s]
Adding requests:  93%|█████████▎| 3789/4096 [00:07<00:00, 505.65it/s]
Adding requests:  94%|█████████▍| 3841/4096 [00:07<00:00, 507.17it/s]
Adding requests:  95%|█████████▌| 3893/4096 [00:07<00:00, 510.15it/s]
Adding requests:  96%|█████████▋| 3945/4096 [00:07<00:00, 509.49it/s]
Adding requests:  98%|█████████▊| 3996/4096 [00:07<00:00, 506.05it/s]
Adding requests:  99%|█████████▉| 4047/4096 [00:08<00:00, 504.24it/s]
Adding requests: 100%|██████████| 4096/4096 [00:08<00:00, 501.09it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  37%|███▋      | 1499/4096 [00:00<00:00, 6723.96it/s, est. speed input: 6886089.19 toks/s, output: 6724.17 toks/s]
Processed prompts:  53%|█████▎    | 2172/4096 [00:03<00:04, 459.75it/s, est. speed input: 583299.05 toks/s, output: 569.63 toks/s]   
Processed prompts:  60%|██████    | 2460/4096 [00:05<00:04, 361.45it/s, est. speed input: 473235.08 toks/s, output: 462.14 toks/s]
Processed prompts:  64%|██████▍   | 2626/4096 [00:06<00:04, 322.84it/s, est. speed input: 434896.99 toks/s, output: 424.70 toks/s]
Processed prompts:  67%|██████▋   | 2734/4096 [00:06<00:04, 304.28it/s, est. speed input: 417961.47 toks/s, output: 408.16 toks/s]
Processed prompts:  69%|██████▊   | 2811/4096 [00:07<00:04, 275.14it/s, est. speed input: 399174.08 toks/s, output: 389.82 toks/s]
Processed prompts:  70%|██████▉   | 2867/4096 [00:07<00:04, 278.91it/s, est. speed input: 397473.25 toks/s, output: 388.16 toks/s]
Processed prompts:  71%|███████   | 2915/4096 [00:07<00:04, 252.58it/s, est. speed input: 386276.33 toks/s, output: 377.22 toks/s]
Processed prompts:  72%|███████▏  | 2953/4096 [00:07<00:04, 249.28it/s, est. speed input: 382933.58 toks/s, output: 373.96 toks/s]
Processed prompts:  73%|███████▎  | 2986/4096 [00:08<00:04, 240.65it/s, est. speed input: 378918.24 toks/s, output: 370.04 toks/s]
Processed prompts:  74%|███████▎  | 3015/4096 [00:08<00:04, 227.42it/s, est. speed input: 374469.31 toks/s, output: 365.69 toks/s]
Processed prompts:  74%|███████▍  | 3040/4096 [00:08<00:05, 211.00it/s, est. speed input: 369830.58 toks/s, output: 361.16 toks/s]
Processed prompts:  75%|███████▍  | 3067/4096 [00:08<00:05, 198.82it/s, est. speed input: 365600.42 toks/s, output: 357.03 toks/s]
Processed prompts:  76%|███████▌  | 3099/4096 [00:08<00:05, 196.56it/s, est. speed input: 362284.73 toks/s, output: 353.79 toks/s]
Processed prompts:  76%|███████▋  | 3131/4096 [00:08<00:04, 198.06it/s, est. speed input: 359548.61 toks/s, output: 351.12 toks/s]
Processed prompts:  77%|███████▋  | 3163/4096 [00:09<00:04, 194.48it/s, est. speed input: 356309.67 toks/s, output: 347.96 toks/s]
Processed prompts:  78%|███████▊  | 3195/4096 [00:09<00:04, 192.99it/s, est. speed input: 353337.07 toks/s, output: 345.05 toks/s]
Processed prompts:  79%|███████▉  | 3227/4096 [00:09<00:04, 191.89it/s, est. speed input: 350469.53 toks/s, output: 342.25 toks/s]
Processed prompts:  80%|███████▉  | 3259/4096 [00:09<00:04, 189.45it/s, est. speed input: 347520.39 toks/s, output: 339.37 toks/s]
Processed prompts:  80%|████████  | 3291/4096 [00:09<00:04, 187.66it/s, est. speed input: 344671.82 toks/s, output: 336.59 toks/s]
Processed prompts:  81%|████████  | 3323/4096 [00:09<00:04, 186.79it/s, est. speed input: 341962.45 toks/s, output: 333.95 toks/s]
Processed prompts:  82%|████████▏ | 3355/4096 [00:10<00:03, 186.05it/s, est. speed input: 339334.44 toks/s, output: 331.38 toks/s]
Processed prompts:  83%|████████▎ | 3387/4096 [00:10<00:03, 185.80it/s, est. speed input: 336822.53 toks/s, output: 328.93 toks/s]
Processed prompts:  83%|████████▎ | 3419/4096 [00:10<00:03, 185.80it/s, est. speed input: 334412.06 toks/s, output: 326.57 toks/s]
Processed prompts:  84%|████████▍ | 3451/4096 [00:10<00:03, 188.41it/s, est. speed input: 332328.92 toks/s, output: 324.54 toks/s]
Processed prompts:  85%|████████▌ | 3483/4096 [00:10<00:03, 190.70it/s, est. speed input: 330344.83 toks/s, output: 322.60 toks/s]
Processed prompts:  86%|████████▌ | 3515/4096 [00:10<00:03, 189.05it/s, est. speed input: 328131.99 toks/s, output: 320.44 toks/s]
Processed prompts:  87%|████████▋ | 3547/4096 [00:11<00:02, 187.65it/s, est. speed input: 325964.50 toks/s, output: 318.32 toks/s]
Processed prompts:  87%|████████▋ | 3579/4096 [00:11<00:02, 186.79it/s, est. speed input: 323872.13 toks/s, output: 316.28 toks/s]
Processed prompts:  88%|████████▊ | 3611/4096 [00:11<00:02, 186.66it/s, est. speed input: 321883.13 toks/s, output: 314.34 toks/s]
Processed prompts:  89%|████████▉ | 3643/4096 [00:11<00:02, 185.78it/s, est. speed input: 319885.84 toks/s, output: 312.39 toks/s]
Processed prompts:  90%|████████▉ | 3675/4096 [00:11<00:02, 185.46it/s, est. speed input: 317972.10 toks/s, output: 310.52 toks/s]
Processed prompts:  91%|█████████ | 3707/4096 [00:12<00:02, 185.82it/s, est. speed input: 316161.18 toks/s, output: 308.75 toks/s]
Processed prompts:  91%|█████████▏| 3739/4096 [00:12<00:01, 187.03it/s, est. speed input: 314477.51 toks/s, output: 307.11 toks/s]
Processed prompts:  92%|█████████▏| 3771/4096 [00:12<00:01, 186.62it/s, est. speed input: 312741.93 toks/s, output: 305.41 toks/s]
Processed prompts:  93%|█████████▎| 3803/4096 [00:12<00:01, 185.87it/s, est. speed input: 311018.52 toks/s, output: 303.73 toks/s]
Processed prompts:  94%|█████████▎| 3835/4096 [00:12<00:01, 188.31it/s, est. speed input: 309562.94 toks/s, output: 302.31 toks/s]
Processed prompts:  94%|█████████▍| 3867/4096 [00:12<00:01, 187.57it/s, est. speed input: 307966.48 toks/s, output: 300.75 toks/s]
Processed prompts:  95%|█████████▌| 3899/4096 [00:13<00:01, 187.02it/s, est. speed input: 306409.62 toks/s, output: 299.23 toks/s]
Processed prompts:  96%|█████████▌| 3931/4096 [00:13<00:00, 186.08it/s, est. speed input: 304853.51 toks/s, output: 297.71 toks/s]
Processed prompts:  97%|█████████▋| 3963/4096 [00:13<00:00, 185.89it/s, est. speed input: 303371.03 toks/s, output: 296.26 toks/s]
Processed prompts:  98%|█████████▊| 3995/4096 [00:13<00:00, 185.44it/s, est. speed input: 301903.46 toks/s, output: 294.83 toks/s]
Processed prompts:  98%|█████████▊| 4027/4096 [00:13<00:00, 188.03it/s, est. speed input: 300668.57 toks/s, output: 293.62 toks/s]
Processed prompts:  99%|█████████▉| 4059/4096 [00:13<00:00, 189.73it/s, est. speed input: 299452.81 toks/s, output: 292.43 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [00:13<00:00, 189.73it/s, est. speed input: 301374.55 toks/s, output: 294.31 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [00:13<00:00, 294.31it/s, est. speed input: 301374.55 toks/s, output: 294.31 toks/s]
[rank0]:[W126 09:06:08.012030472 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=65536 ==========
Time: 2026-01-26 09:06:10
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-FP8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=8192, max_num_seqs=64
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-FP8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 8192 --max-num-seqs 64 --max-model-len 1025 --max-num-batched-tokens 65536 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_FP8E4M3_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-1B-FP8_M65536.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 09:06:51 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1111698) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1111698) WARNING 01-26 09:07:05 [backends.py:609] Failed to read file <frozen os>
Throughput: 185.13 requests/s, 189760.71 total tokens/s, 185.13 output tokens/s
Total num prompt tokens:  8388608
Total num output tokens:  8192

STDERR:
[2026-01-26 09:06:50] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 09:06:51] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-FP8'
[2026-01-26 09:06:51] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-FP8
[2026-01-26 09:06:51] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:06:51] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:06:51] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:06:51] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:06:51] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:06:51] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-FP8'
[2026-01-26 09:06:51] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 09:06:51] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 09:06:51] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 09:06:51] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 09:06:51] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 09:06:57] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 09:06:58] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-FP8'
[2026-01-26 09:06:58] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-FP8
[2026-01-26 09:06:58] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:06:58] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:06:58] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:06:58] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:06:58] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-FP8
[2026-01-26 09:06:58] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-FP8'
[2026-01-26 09:06:58] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 09:06:58] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 09:06:58] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 09:06:58] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 09:06:58] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1111698) [2026-01-26 09:06:59] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1111698) [2026-01-26 09:06:59] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1111698) [2026-01-26 09:06:59] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1111698) [2026-01-26 09:06:59] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1111698) [2026-01-26 09:06:59] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Llama3.2-1B-FP8
(EngineCore_DP0 pid=1111698) [2026-01-26 09:06:59] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1111698) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1111698) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.26it/s]
(EngineCore_DP0 pid=1111698) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.26it/s]
(EngineCore_DP0 pid=1111698) 
(EngineCore_DP0 pid=1111698) [2026-01-26 09:07:01] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 3072] -> 1D uint8
(EngineCore_DP0 pid=1111698) [2026-01-26 09:07:01] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 5898240 bytes
(EngineCore_DP0 pid=1111698) [2026-01-26 09:07:01] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2048, 3072] -> 1D uint8
(EngineCore_DP0 pid=1111698) [2026-01-26 09:07:01] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 3932160 bytes
(EngineCore_DP0 pid=1111698) [2026-01-26 09:07:01] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [16384, 3072] -> 1D uint8
(EngineCore_DP0 pid=1111698) [2026-01-26 09:07:01] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 31457280 bytes
(EngineCore_DP0 pid=1111698) [2026-01-26 09:07:01] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2048, 12288] -> 1D uint8
(EngineCore_DP0 pid=1111698) [2026-01-26 09:07:01] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 15728640 bytes
(EngineCore_DP0 pid=1111698) [rank0]:W0126 09:07:08.728000 1111698 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1111698) [rank0]:W0126 09:07:08.782000 1111698 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1111698) [rank0]:W0126 09:07:09.631000 1111698 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1111698) [rank0]:W0126 09:07:09.707000 1111698 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1111698) 2026-01-26 09:07:12,402 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1111698) 2026-01-26 09:07:12,435 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1111698) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/19 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   5%|▌         | 1/19 [00:00<00:13,  1.35it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  11%|█         | 2/19 [00:00<00:07,  2.25it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  16%|█▌        | 3/19 [00:01<00:05,  3.10it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  26%|██▋       | 5/19 [00:01<00:02,  5.93it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  37%|███▋      | 7/19 [00:01<00:01,  8.58it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  47%|████▋     | 9/19 [00:01<00:01,  7.32it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  58%|█████▊    | 11/19 [00:01<00:01,  7.85it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  68%|██████▊   | 13/19 [00:02<00:01,  5.33it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  79%|███████▉  | 15/19 [00:02<00:00,  6.93it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  89%|████████▉ | 17/19 [00:02<00:00,  7.81it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 19/19 [00:02<00:00,  9.16it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 19/19 [00:02<00:00,  6.42it/s]
(EngineCore_DP0 pid=1111698) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):   9%|▉         | 1/11 [00:00<00:01,  5.76it/s]
Capturing CUDA graphs (decode, FULL):  27%|██▋       | 3/11 [00:00<00:00, 12.09it/s]
Capturing CUDA graphs (decode, FULL):  45%|████▌     | 5/11 [00:00<00:00, 15.09it/s]
Capturing CUDA graphs (decode, FULL):  64%|██████▎   | 7/11 [00:00<00:00, 16.79it/s]
Capturing CUDA graphs (decode, FULL):  82%|████████▏ | 9/11 [00:00<00:00, 12.60it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 11/11 [00:01<00:00,  8.30it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 11/11 [00:01<00:00, 10.04it/s]

Adding requests:   0%|          | 0/8192 [00:00<?, ?it/s]
Adding requests:   1%|          | 48/8192 [00:00<00:17, 478.87it/s]
Adding requests:   1%|          | 98/8192 [00:00<00:16, 488.40it/s]
Adding requests:   2%|▏         | 147/8192 [00:00<00:16, 488.52it/s]
Adding requests:   2%|▏         | 196/8192 [00:00<00:16, 487.40it/s]
Adding requests:   3%|▎         | 247/8192 [00:00<00:16, 494.57it/s]
Adding requests:   4%|▎         | 297/8192 [00:00<00:15, 496.27it/s]
Adding requests:   4%|▍         | 347/8192 [00:00<00:15, 493.46it/s]
Adding requests:   5%|▍         | 398/8192 [00:00<00:15, 496.92it/s]
Adding requests:   5%|▌         | 448/8192 [00:00<00:15, 497.11it/s]
Adding requests:   6%|▌         | 498/8192 [00:01<00:15, 496.90it/s]
Adding requests:   7%|▋         | 548/8192 [00:01<00:15, 489.35it/s]
Adding requests:   7%|▋         | 597/8192 [00:01<00:15, 489.30it/s]
Adding requests:   8%|▊         | 647/8192 [00:01<00:15, 492.21it/s]
Adding requests:   9%|▊         | 699/8192 [00:01<00:14, 499.99it/s]
Adding requests:   9%|▉         | 750/8192 [00:01<00:14, 499.08it/s]
Adding requests:  10%|▉         | 800/8192 [00:01<00:14, 496.54it/s]
Adding requests:  10%|█         | 850/8192 [00:01<00:15, 488.90it/s]
Adding requests:  11%|█         | 902/8192 [00:01<00:14, 496.54it/s]
Adding requests:  12%|█▏        | 953/8192 [00:01<00:14, 497.85it/s]
Adding requests:  12%|█▏        | 1004/8192 [00:02<00:14, 500.90it/s]
Adding requests:  13%|█▎        | 1055/8192 [00:02<00:14, 502.41it/s]
Adding requests:  14%|█▎        | 1106/8192 [00:02<00:14, 500.05it/s]
Adding requests:  14%|█▍        | 1157/8192 [00:02<00:14, 501.17it/s]
Adding requests:  15%|█▍        | 1208/8192 [00:02<00:13, 503.72it/s]
Adding requests:  15%|█▌        | 1259/8192 [00:02<00:13, 495.90it/s]
Adding requests:  16%|█▌        | 1310/8192 [00:02<00:13, 499.15it/s]
Adding requests:  17%|█▋        | 1361/8192 [00:02<00:13, 501.72it/s]
Adding requests:  17%|█▋        | 1414/8192 [00:02<00:13, 507.39it/s]
Adding requests:  18%|█▊        | 1465/8192 [00:02<00:13, 504.28it/s]
Adding requests:  19%|█▊        | 1517/8192 [00:03<00:13, 506.35it/s]
Adding requests:  19%|█▉        | 1568/8192 [00:03<00:13, 507.36it/s]
Adding requests:  20%|█▉        | 1620/8192 [00:03<00:12, 510.12it/s]
Adding requests:  20%|██        | 1672/8192 [00:03<00:12, 505.62it/s]
Adding requests:  21%|██        | 1723/8192 [00:03<00:12, 499.63it/s]
Adding requests:  22%|██▏       | 1773/8192 [00:03<00:12, 498.19it/s]
Adding requests:  22%|██▏       | 1824/8192 [00:03<00:12, 499.87it/s]
Adding requests:  23%|██▎       | 1875/8192 [00:03<00:12, 500.00it/s]
Adding requests:  24%|██▎       | 1926/8192 [00:03<00:12, 502.31it/s]
Adding requests:  24%|██▍       | 1977/8192 [00:03<00:12, 503.75it/s]
Adding requests:  25%|██▍       | 2028/8192 [00:04<00:12, 501.83it/s]
Adding requests:  25%|██▌       | 2081/8192 [00:04<00:12, 507.39it/s]
Adding requests:  26%|██▌       | 2132/8192 [00:04<00:12, 503.17it/s]
Adding requests:  27%|██▋       | 2183/8192 [00:04<00:12, 498.32it/s]
Adding requests:  27%|██▋       | 2235/8192 [00:04<00:11, 503.07it/s]
Adding requests:  28%|██▊       | 2286/8192 [00:04<00:11, 502.04it/s]
Adding requests:  29%|██▊       | 2337/8192 [00:04<00:11, 504.03it/s]
Adding requests:  29%|██▉       | 2388/8192 [00:04<00:11, 505.56it/s]
Adding requests:  30%|██▉       | 2439/8192 [00:04<00:11, 497.79it/s]
Adding requests:  30%|███       | 2491/8192 [00:04<00:11, 501.98it/s]
Adding requests:  31%|███       | 2542/8192 [00:05<00:11, 503.24it/s]
Adding requests:  32%|███▏      | 2593/8192 [00:05<00:11, 505.10it/s]
Adding requests:  32%|███▏      | 2645/8192 [00:05<00:10, 508.21it/s]
Adding requests:  33%|███▎      | 2696/8192 [00:05<00:10, 506.48it/s]
Adding requests:  34%|███▎      | 2747/8192 [00:05<00:10, 506.13it/s]
Adding requests:  34%|███▍      | 2798/8192 [00:05<00:10, 502.61it/s]
Adding requests:  35%|███▍      | 2850/8192 [00:05<00:10, 505.87it/s]
Adding requests:  35%|███▌      | 2901/8192 [00:05<00:10, 506.56it/s]
Adding requests:  36%|███▌      | 2952/8192 [00:05<00:10, 503.63it/s]
Adding requests:  37%|███▋      | 3003/8192 [00:06<00:10, 491.82it/s]
Adding requests:  37%|███▋      | 3054/8192 [00:06<00:10, 496.37it/s]
Adding requests:  38%|███▊      | 3104/8192 [00:06<00:10, 495.09it/s]
Adding requests:  39%|███▊      | 3155/8192 [00:06<00:10, 497.92it/s]
Adding requests:  39%|███▉      | 3206/8192 [00:06<00:09, 499.75it/s]
Adding requests:  40%|███▉      | 3257/8192 [00:06<00:09, 502.74it/s]
Adding requests:  40%|████      | 3308/8192 [00:06<00:09, 500.96it/s]
Adding requests:  41%|████      | 3361/8192 [00:06<00:09, 506.68it/s]
Adding requests:  42%|████▏     | 3412/8192 [00:06<00:09, 506.05it/s]
Adding requests:  42%|████▏     | 3463/8192 [00:06<00:09, 502.09it/s]
Adding requests:  43%|████▎     | 3514/8192 [00:07<00:09, 503.57it/s]
Adding requests:  44%|████▎     | 3565/8192 [00:07<00:09, 497.50it/s]
Adding requests:  44%|████▍     | 3616/8192 [00:07<00:09, 498.84it/s]
Adding requests:  45%|████▍     | 3666/8192 [00:07<00:09, 496.74it/s]
Adding requests:  45%|████▌     | 3716/8192 [00:07<00:09, 495.95it/s]
Adding requests:  46%|████▌     | 3767/8192 [00:07<00:08, 498.91it/s]
Adding requests:  47%|████▋     | 3819/8192 [00:07<00:08, 505.04it/s]
Adding requests:  47%|████▋     | 3870/8192 [00:07<00:08, 505.24it/s]
Adding requests:  48%|████▊     | 3921/8192 [00:07<00:08, 502.59it/s]
Adding requests:  48%|████▊     | 3972/8192 [00:07<00:08, 502.03it/s]
Adding requests:  49%|████▉     | 4023/8192 [00:08<00:08, 502.86it/s]
Adding requests:  50%|████▉     | 4074/8192 [00:08<00:08, 493.50it/s]
Adding requests:  50%|█████     | 4125/8192 [00:08<00:08, 496.47it/s]
Adding requests:  51%|█████     | 4176/8192 [00:08<00:08, 498.74it/s]
Adding requests:  52%|█████▏    | 4227/8192 [00:08<00:07, 500.01it/s]
Adding requests:  52%|█████▏    | 4278/8192 [00:08<00:07, 490.96it/s]
Adding requests:  53%|█████▎    | 4329/8192 [00:08<00:07, 495.32it/s]
Adding requests:  53%|█████▎    | 4381/8192 [00:08<00:07, 502.36it/s]
Adding requests:  54%|█████▍    | 4432/8192 [00:08<00:07, 502.45it/s]
Adding requests:  55%|█████▍    | 4483/8192 [00:08<00:07, 501.25it/s]
Adding requests:  55%|█████▌    | 4534/8192 [00:09<00:07, 493.75it/s]
Adding requests:  56%|█████▌    | 4585/8192 [00:09<00:07, 497.72it/s]
Adding requests:  57%|█████▋    | 4636/8192 [00:09<00:07, 501.33it/s]
Adding requests:  57%|█████▋    | 4687/8192 [00:09<00:07, 498.75it/s]
Adding requests:  58%|█████▊    | 4739/8192 [00:09<00:06, 503.96it/s]
Adding requests:  58%|█████▊    | 4790/8192 [00:09<00:06, 503.68it/s]
Adding requests:  59%|█████▉    | 4841/8192 [00:09<00:06, 502.51it/s]
Adding requests:  60%|█████▉    | 4892/8192 [00:09<00:06, 497.89it/s]
Adding requests:  60%|██████    | 4942/8192 [00:09<00:06, 496.00it/s]
Adding requests:  61%|██████    | 4993/8192 [00:09<00:06, 497.99it/s]
Adding requests:  62%|██████▏   | 5045/8192 [00:10<00:06, 502.12it/s]
Adding requests:  62%|██████▏   | 5098/8192 [00:10<00:06, 507.67it/s]
Adding requests:  63%|██████▎   | 5149/8192 [00:10<00:06, 506.88it/s]
Adding requests:  63%|██████▎   | 5200/8192 [00:10<00:05, 507.29it/s]
Adding requests:  64%|██████▍   | 5251/8192 [00:10<00:05, 501.71it/s]
Adding requests:  65%|██████▍   | 5303/8192 [00:10<00:05, 504.79it/s]
Adding requests:  65%|██████▌   | 5354/8192 [00:10<00:05, 502.42it/s]
Adding requests:  66%|██████▌   | 5405/8192 [00:10<00:05, 502.54it/s]
Adding requests:  67%|██████▋   | 5456/8192 [00:10<00:05, 501.84it/s]
Adding requests:  67%|██████▋   | 5507/8192 [00:11<00:05, 497.20it/s]
Adding requests:  68%|██████▊   | 5557/8192 [00:11<00:05, 497.36it/s]
Adding requests:  68%|██████▊   | 5607/8192 [00:11<00:05, 485.15it/s]
Adding requests:  69%|██████▉   | 5657/8192 [00:11<00:05, 488.25it/s]
Adding requests:  70%|██████▉   | 5708/8192 [00:11<00:05, 492.99it/s]
Adding requests:  70%|███████   | 5759/8192 [00:11<00:04, 496.72it/s]
Adding requests:  71%|███████   | 5809/8192 [00:11<00:04, 494.15it/s]
Adding requests:  72%|███████▏  | 5860/8192 [00:11<00:04, 496.46it/s]
Adding requests:  72%|███████▏  | 5913/8192 [00:11<00:04, 504.36it/s]
Adding requests:  73%|███████▎  | 5964/8192 [00:11<00:04, 502.18it/s]
Adding requests:  73%|███████▎  | 6017/8192 [00:12<00:04, 506.83it/s]
Adding requests:  74%|███████▍  | 6070/8192 [00:12<00:04, 511.49it/s]
Adding requests:  75%|███████▍  | 6122/8192 [00:12<00:04, 509.05it/s]
Adding requests:  75%|███████▌  | 6173/8192 [00:12<00:04, 503.35it/s]
Adding requests:  76%|███████▌  | 6227/8192 [00:12<00:03, 511.09it/s]
Adding requests:  77%|███████▋  | 6279/8192 [00:12<00:03, 513.17it/s]
Adding requests:  77%|███████▋  | 6332/8192 [00:12<00:03, 516.78it/s]
Adding requests:  78%|███████▊  | 6384/8192 [00:12<00:03, 505.27it/s]
Adding requests:  79%|███████▊  | 6438/8192 [00:12<00:03, 513.89it/s]
Adding requests:  79%|███████▉  | 6490/8192 [00:12<00:03, 513.70it/s]
Adding requests:  80%|███████▉  | 6543/8192 [00:13<00:03, 518.43it/s]
Adding requests:  81%|████████  | 6595/8192 [00:13<00:03, 513.24it/s]
Adding requests:  81%|████████  | 6647/8192 [00:13<00:03, 514.24it/s]
Adding requests:  82%|████████▏ | 6699/8192 [00:13<00:02, 512.54it/s]
Adding requests:  82%|████████▏ | 6751/8192 [00:13<00:02, 503.73it/s]
Adding requests:  83%|████████▎ | 6803/8192 [00:13<00:02, 507.94it/s]
Adding requests:  84%|████████▎ | 6856/8192 [00:13<00:02, 512.08it/s]
Adding requests:  84%|████████▍ | 6908/8192 [00:13<00:02, 500.38it/s]
Adding requests:  85%|████████▍ | 6961/8192 [00:13<00:02, 506.92it/s]
Adding requests:  86%|████████▌ | 7012/8192 [00:13<00:02, 505.33it/s]
Adding requests:  86%|████████▌ | 7063/8192 [00:14<00:02, 504.41it/s]
Adding requests:  87%|████████▋ | 7115/8192 [00:14<00:02, 507.81it/s]
Adding requests:  87%|████████▋ | 7166/8192 [00:14<00:02, 502.87it/s]
Adding requests:  88%|████████▊ | 7217/8192 [00:14<00:01, 503.88it/s]
Adding requests:  89%|████████▊ | 7269/8192 [00:14<00:01, 508.25it/s]
Adding requests:  89%|████████▉ | 7321/8192 [00:14<00:01, 509.52it/s]
Adding requests:  90%|████████▉ | 7372/8192 [00:14<00:01, 507.66it/s]
Adding requests:  91%|█████████ | 7425/8192 [00:14<00:01, 514.02it/s]
Adding requests:  91%|█████████▏| 7477/8192 [00:14<00:01, 515.37it/s]
Adding requests:  92%|█████████▏| 7529/8192 [00:14<00:01, 514.10it/s]
Adding requests:  93%|█████████▎| 7581/8192 [00:15<00:01, 511.96it/s]
Adding requests:  93%|█████████▎| 7633/8192 [00:15<00:01, 509.23it/s]
Adding requests:  94%|█████████▍| 7686/8192 [00:15<00:00, 513.95it/s]
Adding requests:  94%|█████████▍| 7738/8192 [00:15<00:00, 512.75it/s]
Adding requests:  95%|█████████▌| 7790/8192 [00:15<00:00, 503.92it/s]
Adding requests:  96%|█████████▌| 7842/8192 [00:15<00:00, 508.46it/s]
Adding requests:  96%|█████████▋| 7893/8192 [00:15<00:00, 507.49it/s]
Adding requests:  97%|█████████▋| 7944/8192 [00:15<00:00, 503.25it/s]
Adding requests:  98%|█████████▊| 7995/8192 [00:15<00:00, 500.71it/s]
Adding requests:  98%|█████████▊| 8046/8192 [00:16<00:00, 500.31it/s]
Adding requests:  99%|█████████▉| 8098/8192 [00:16<00:00, 504.94it/s]
Adding requests:  99%|█████████▉| 8150/8192 [00:16<00:00, 507.55it/s]
Adding requests: 100%|██████████| 8192/8192 [00:16<00:00, 502.25it/s]

Processed prompts:   0%|          | 0/8192 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  36%|███▌      | 2925/8192 [00:00<00:00, 11559.51it/s, est. speed input: 11838477.60 toks/s, output: 11559.85 toks/s]
Processed prompts:  50%|████▉     | 4081/8192 [00:06<00:08, 507.47it/s, est. speed input: 654128.74 toks/s, output: 638.80 toks/s]      
Processed prompts:  56%|█████▌    | 4569/8192 [00:08<00:09, 401.75it/s, est. speed input: 533717.39 toks/s, output: 521.21 toks/s]
Processed prompts:  59%|█████▉    | 4844/8192 [00:10<00:09, 356.54it/s, est. speed input: 489146.84 toks/s, output: 477.68 toks/s]
Processed prompts:  61%|██████▏   | 5018/8192 [00:11<00:09, 320.95it/s, est. speed input: 460484.47 toks/s, output: 449.69 toks/s]
Processed prompts:  63%|██████▎   | 5136/8192 [00:11<00:10, 298.40it/s, est. speed input: 444379.66 toks/s, output: 433.96 toks/s]
Processed prompts:  64%|██████▎   | 5220/8192 [00:12<00:10, 293.57it/s, est. speed input: 439151.15 toks/s, output: 428.86 toks/s]
Processed prompts:  65%|██████▍   | 5285/8192 [00:12<00:10, 281.42it/s, est. speed input: 432740.68 toks/s, output: 422.60 toks/s]
Processed prompts:  65%|██████▌   | 5335/8192 [00:12<00:10, 261.88it/s, est. speed input: 425500.81 toks/s, output: 415.53 toks/s]
Processed prompts:  66%|██████▌   | 5375/8192 [00:13<00:11, 235.47it/s, est. speed input: 417451.65 toks/s, output: 407.67 toks/s]
Processed prompts:  66%|██████▌   | 5421/8192 [00:13<00:12, 215.77it/s, est. speed input: 410580.59 toks/s, output: 400.96 toks/s]
Processed prompts:  67%|██████▋   | 5485/8192 [00:13<00:12, 209.64it/s, est. speed input: 405248.33 toks/s, output: 395.75 toks/s]
Processed prompts:  68%|██████▊   | 5549/8192 [00:14<00:12, 204.46it/s, est. speed input: 400165.10 toks/s, output: 390.79 toks/s]
Processed prompts:  69%|██████▊   | 5613/8192 [00:14<00:12, 199.89it/s, est. speed input: 395245.38 toks/s, output: 385.98 toks/s]
Processed prompts:  69%|██████▉   | 5677/8192 [00:14<00:12, 197.62it/s, est. speed input: 390764.62 toks/s, output: 381.61 toks/s]
Processed prompts:  70%|███████   | 5741/8192 [00:15<00:12, 194.25it/s, est. speed input: 386218.54 toks/s, output: 377.17 toks/s]
Processed prompts:  71%|███████   | 5805/8192 [00:15<00:12, 191.34it/s, est. speed input: 381807.66 toks/s, output: 372.86 toks/s]
Processed prompts:  72%|███████▏  | 5869/8192 [00:15<00:12, 189.56it/s, est. speed input: 377634.76 toks/s, output: 368.78 toks/s]
Processed prompts:  72%|███████▏  | 5933/8192 [00:16<00:11, 190.29it/s, est. speed input: 373926.63 toks/s, output: 365.16 toks/s]
Processed prompts:  73%|███████▎  | 5997/8192 [00:16<00:11, 189.35it/s, est. speed input: 370166.86 toks/s, output: 361.49 toks/s]
Processed prompts:  74%|███████▍  | 6061/8192 [00:16<00:11, 188.01it/s, est. speed input: 366469.66 toks/s, output: 357.88 toks/s]
Processed prompts:  75%|███████▍  | 6125/8192 [00:17<00:10, 188.82it/s, est. speed input: 363145.79 toks/s, output: 354.63 toks/s]
Processed prompts:  76%|███████▌  | 6189/8192 [00:17<00:10, 189.48it/s, est. speed input: 359959.73 toks/s, output: 351.52 toks/s]
Processed prompts:  76%|███████▋  | 6253/8192 [00:17<00:10, 188.33it/s, est. speed input: 356698.70 toks/s, output: 348.34 toks/s]
Processed prompts:  77%|███████▋  | 6317/8192 [00:18<00:09, 188.86it/s, est. speed input: 353715.77 toks/s, output: 345.42 toks/s]
Processed prompts:  78%|███████▊  | 6381/8192 [00:18<00:09, 188.48it/s, est. speed input: 350755.94 toks/s, output: 342.53 toks/s]
Processed prompts:  79%|███████▊  | 6445/8192 [00:18<00:09, 187.51it/s, est. speed input: 347823.73 toks/s, output: 339.67 toks/s]
Processed prompts:  79%|███████▉  | 6509/8192 [00:19<00:08, 187.23it/s, est. speed input: 345040.72 toks/s, output: 336.95 toks/s]
Processed prompts:  80%|████████  | 6573/8192 [00:19<00:08, 188.85it/s, est. speed input: 342545.29 toks/s, output: 334.52 toks/s]
Processed prompts:  81%|████████  | 6637/8192 [00:19<00:08, 188.65it/s, est. speed input: 339996.05 toks/s, output: 332.03 toks/s]
Processed prompts:  82%|████████▏ | 6701/8192 [00:20<00:07, 187.88it/s, est. speed input: 337468.86 toks/s, output: 329.56 toks/s]
Processed prompts:  83%|████████▎ | 6765/8192 [00:20<00:07, 188.64it/s, est. speed input: 335152.02 toks/s, output: 327.30 toks/s]
Processed prompts:  83%|████████▎ | 6829/8192 [00:21<00:07, 187.28it/s, est. speed input: 332729.20 toks/s, output: 324.93 toks/s]
Processed prompts:  84%|████████▍ | 6893/8192 [00:21<00:06, 187.95it/s, est. speed input: 330537.22 toks/s, output: 322.79 toks/s]
Processed prompts:  85%|████████▍ | 6957/8192 [00:21<00:06, 188.51it/s, est. speed input: 328420.64 toks/s, output: 320.72 toks/s]
Processed prompts:  86%|████████▌ | 7021/8192 [00:22<00:06, 187.50it/s, est. speed input: 326243.86 toks/s, output: 318.60 toks/s]
Processed prompts:  86%|████████▋ | 7085/8192 [00:22<00:05, 189.26it/s, est. speed input: 324349.73 toks/s, output: 316.75 toks/s]
Processed prompts:  87%|████████▋ | 7149/8192 [00:22<00:05, 189.22it/s, est. speed input: 322402.13 toks/s, output: 314.85 toks/s]
Processed prompts:  88%|████████▊ | 7213/8192 [00:23<00:05, 188.48it/s, est. speed input: 320452.79 toks/s, output: 312.94 toks/s]
Processed prompts:  89%|████████▉ | 7277/8192 [00:23<00:04, 188.84it/s, est. speed input: 318631.45 toks/s, output: 311.16 toks/s]
Processed prompts:  90%|████████▉ | 7341/8192 [00:23<00:04, 188.27it/s, est. speed input: 316796.86 toks/s, output: 309.37 toks/s]
Processed prompts:  90%|█████████ | 7405/8192 [00:24<00:04, 188.26it/s, est. speed input: 315044.80 toks/s, output: 307.66 toks/s]
Processed prompts:  91%|█████████ | 7469/8192 [00:24<00:03, 187.18it/s, est. speed input: 313258.08 toks/s, output: 305.92 toks/s]
Processed prompts:  92%|█████████▏| 7533/8192 [00:24<00:03, 189.21it/s, est. speed input: 311732.25 toks/s, output: 304.43 toks/s]
Processed prompts:  93%|█████████▎| 7597/8192 [00:25<00:03, 188.61it/s, est. speed input: 310096.95 toks/s, output: 302.83 toks/s]
Processed prompts:  94%|█████████▎| 7661/8192 [00:25<00:02, 187.83it/s, est. speed input: 308479.02 toks/s, output: 301.25 toks/s]
Processed prompts:  94%|█████████▍| 7725/8192 [00:25<00:02, 187.83it/s, est. speed input: 306943.54 toks/s, output: 299.75 toks/s]
Processed prompts:  95%|█████████▌| 7789/8192 [00:26<00:02, 186.81it/s, est. speed input: 305375.14 toks/s, output: 298.22 toks/s]
Processed prompts:  96%|█████████▌| 7853/8192 [00:26<00:01, 186.28it/s, est. speed input: 303860.77 toks/s, output: 296.74 toks/s]
Processed prompts:  97%|█████████▋| 7917/8192 [00:26<00:01, 186.46it/s, est. speed input: 302423.54 toks/s, output: 295.34 toks/s]
Processed prompts:  97%|█████████▋| 7981/8192 [00:27<00:01, 185.86it/s, est. speed input: 300973.51 toks/s, output: 293.92 toks/s]
Processed prompts:  98%|█████████▊| 8045/8192 [00:27<00:00, 186.94it/s, est. speed input: 299660.22 toks/s, output: 292.64 toks/s]
Processed prompts:  99%|█████████▉| 8109/8192 [00:27<00:00, 188.30it/s, est. speed input: 298417.46 toks/s, output: 291.42 toks/s]
Processed prompts: 100%|█████████▉| 8173/8192 [00:27<00:00, 236.89it/s, est. speed input: 299615.17 toks/s, output: 292.59 toks/s]
Processed prompts: 100%|██████████| 8192/8192 [00:27<00:00, 236.89it/s, est. speed input: 300304.52 toks/s, output: 293.27 toks/s]
Processed prompts: 100%|██████████| 8192/8192 [00:27<00:00, 293.26it/s, est. speed input: 300304.52 toks/s, output: 293.27 toks/s]
[rank0]:[W126 09:08:02.955087785 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=512 ==========
Time: 2026-01-26 10:32:35
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-FP8-SlideSparse-2_8
Params: prompt_len=512, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-FP8-SlideSparse-2_8 --dataset-name random --input-len 512 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 513 --max-num-batched-tokens 513 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_FP8E4M3_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-3B-FP8_M512.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 10:32:42 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1218361) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1218361) WARNING 01-26 10:32:58 [backends.py:609] Failed to read file <frozen os>
Throughput: 32.46 requests/s, 16653.69 total tokens/s, 32.46 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128

STDERR:
[2026-01-26 10:32:42] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 10:32:42] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-FP8'
[2026-01-26 10:32:42] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-FP8
[2026-01-26 10:32:42] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:32:42] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:32:42] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:32:42] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:32:42] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:32:42] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-FP8'
[2026-01-26 10:32:42] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 10:32:42] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 10:32:42] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 10:32:42] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 10:32:42] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 10:32:49] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 10:32:49] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-FP8'
[2026-01-26 10:32:49] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-FP8
[2026-01-26 10:32:49] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:32:49] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:32:49] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:32:49] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:32:49] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:32:49] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-FP8'
[2026-01-26 10:32:49] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 10:32:49] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 10:32:49] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 10:32:49] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 10:32:49] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1218361) [2026-01-26 10:32:51] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1218361) [2026-01-26 10:32:51] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1218361) [2026-01-26 10:32:51] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1218361) [2026-01-26 10:32:51] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1218361) [2026-01-26 10:32:51] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Llama3.2-3B-FP8
(EngineCore_DP0 pid=1218361) [2026-01-26 10:32:51] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1218361) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1218361) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.92it/s]
(EngineCore_DP0 pid=1218361) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.92it/s]
(EngineCore_DP0 pid=1218361) 
(EngineCore_DP0 pid=1218361) [2026-01-26 10:32:52] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 4608] -> 1D uint8
(EngineCore_DP0 pid=1218361) [2026-01-26 10:32:53] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 14745600 bytes
(EngineCore_DP0 pid=1218361) [2026-01-26 10:32:53] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 4608] -> 1D uint8
(EngineCore_DP0 pid=1218361) [2026-01-26 10:32:53] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 8847360 bytes
(EngineCore_DP0 pid=1218361) [2026-01-26 10:32:53] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [16384, 4608] -> 1D uint8
(EngineCore_DP0 pid=1218361) [2026-01-26 10:32:53] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 47185920 bytes
(EngineCore_DP0 pid=1218361) [2026-01-26 10:32:53] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 12288] -> 1D uint8
(EngineCore_DP0 pid=1218361) [2026-01-26 10:32:53] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 23592960 bytes
(EngineCore_DP0 pid=1218361) 2026-01-26 10:33:09,498 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1218361) 2026-01-26 10:33:09,521 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1218361) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  2.75it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  2.05it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  2.13it/s]
(EngineCore_DP0 pid=1218361) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  5.38it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  5.37it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  35%|███▌      | 45/128 [00:00<00:00, 447.91it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 659.26it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:51,  2.47it/s, est. speed input: 1267.05 toks/s, output: 2.47 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:10, 12.07it/s, est. speed input: 5013.58 toks/s, output: 9.79 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:00<00:06, 19.30it/s, est. speed input: 7483.56 toks/s, output: 14.62 toks/s]
Processed prompts:  10%|█         | 13/128 [00:00<00:04, 24.63it/s, est. speed input: 9232.52 toks/s, output: 18.03 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:00<00:03, 28.51it/s, est. speed input: 10536.60 toks/s, output: 20.58 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:00<00:03, 31.25it/s, est. speed input: 11539.21 toks/s, output: 22.54 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:01<00:03, 33.25it/s, est. speed input: 12345.02 toks/s, output: 24.11 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:01<00:02, 34.64it/s, est. speed input: 12998.10 toks/s, output: 25.39 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:01<00:02, 35.63it/s, est. speed input: 13542.57 toks/s, output: 26.45 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:01<00:02, 36.30it/s, est. speed input: 13998.86 toks/s, output: 27.34 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:01<00:02, 36.83it/s, est. speed input: 14395.01 toks/s, output: 28.11 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:01<00:02, 37.19it/s, est. speed input: 14736.77 toks/s, output: 28.78 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:01<00:02, 37.44it/s, est. speed input: 15034.71 toks/s, output: 29.36 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:01<00:01, 37.65it/s, est. speed input: 15300.42 toks/s, output: 29.88 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:01<00:01, 37.78it/s, est. speed input: 15535.49 toks/s, output: 30.34 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:01<00:01, 37.89it/s, est. speed input: 15746.53 toks/s, output: 30.75 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:02<00:01, 37.87it/s, est. speed input: 15930.01 toks/s, output: 31.11 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:02<00:01, 37.92it/s, est. speed input: 16099.67 toks/s, output: 31.44 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:02<00:01, 37.89it/s, est. speed input: 16249.88 toks/s, output: 31.74 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:02<00:01, 37.91it/s, est. speed input: 16389.17 toks/s, output: 32.01 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:02<00:01, 37.92it/s, est. speed input: 16516.71 toks/s, output: 32.26 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:02<00:01, 37.92it/s, est. speed input: 16633.38 toks/s, output: 32.49 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:02<00:01, 37.96it/s, est. speed input: 16743.57 toks/s, output: 32.70 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:02<00:00, 37.99it/s, est. speed input: 16845.47 toks/s, output: 32.90 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:02<00:00, 37.98it/s, est. speed input: 16938.69 toks/s, output: 33.08 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:03<00:00, 37.98it/s, est. speed input: 17025.66 toks/s, output: 33.25 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:03<00:00, 37.96it/s, est. speed input: 17105.49 toks/s, output: 33.41 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:03<00:00, 37.97it/s, est. speed input: 17181.48 toks/s, output: 33.56 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:03<00:00, 38.06it/s, est. speed input: 17256.97 toks/s, output: 33.70 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:03<00:00, 38.00it/s, est. speed input: 17322.01 toks/s, output: 33.83 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:03<00:00, 38.01it/s, est. speed input: 17385.57 toks/s, output: 33.96 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:03<00:00, 38.04it/s, est. speed input: 17446.49 toks/s, output: 34.07 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:03<00:00, 38.04it/s, est. speed input: 17491.31 toks/s, output: 34.16 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:03<00:00, 34.16it/s, est. speed input: 17491.31 toks/s, output: 34.16 toks/s]
[rank0]:[W126 10:33:16.472520473 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=1024 ==========
Time: 2026-01-26 10:33:18
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-FP8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-FP8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 1025 --max-num-batched-tokens 1025 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_FP8E4M3_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-3B-FP8_M1024.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 10:33:26 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1219538) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1219538) WARNING 01-26 10:33:42 [backends.py:609] Failed to read file <frozen os>
Throughput: 33.92 requests/s, 34766.81 total tokens/s, 33.92 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128

STDERR:
[2026-01-26 10:33:25] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 10:33:26] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-FP8'
[2026-01-26 10:33:26] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-FP8
[2026-01-26 10:33:26] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:33:26] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:33:26] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:33:26] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:33:26] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:33:26] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-FP8'
[2026-01-26 10:33:26] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 10:33:26] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 10:33:26] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 10:33:26] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 10:33:26] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 10:33:32] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 10:33:33] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-FP8'
[2026-01-26 10:33:33] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-FP8
[2026-01-26 10:33:33] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:33:33] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:33:33] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:33:33] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:33:33] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:33:33] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-FP8'
[2026-01-26 10:33:33] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 10:33:33] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 10:33:33] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 10:33:33] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 10:33:33] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1219538) [2026-01-26 10:33:34] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1219538) [2026-01-26 10:33:34] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1219538) [2026-01-26 10:33:34] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1219538) [2026-01-26 10:33:34] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1219538) [2026-01-26 10:33:34] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Llama3.2-3B-FP8
(EngineCore_DP0 pid=1219538) [2026-01-26 10:33:34] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1219538) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1219538) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.89it/s]
(EngineCore_DP0 pid=1219538) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.88it/s]
(EngineCore_DP0 pid=1219538) 
(EngineCore_DP0 pid=1219538) [2026-01-26 10:33:36] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 4608] -> 1D uint8
(EngineCore_DP0 pid=1219538) [2026-01-26 10:33:36] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 14745600 bytes
(EngineCore_DP0 pid=1219538) [2026-01-26 10:33:36] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 4608] -> 1D uint8
(EngineCore_DP0 pid=1219538) [2026-01-26 10:33:36] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 8847360 bytes
(EngineCore_DP0 pid=1219538) [2026-01-26 10:33:36] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [16384, 4608] -> 1D uint8
(EngineCore_DP0 pid=1219538) [2026-01-26 10:33:36] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 47185920 bytes
(EngineCore_DP0 pid=1219538) [2026-01-26 10:33:36] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 12288] -> 1D uint8
(EngineCore_DP0 pid=1219538) [2026-01-26 10:33:36] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 23592960 bytes
(EngineCore_DP0 pid=1219538) 2026-01-26 10:33:53,479 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1219538) 2026-01-26 10:33:53,510 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1219538) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00, 14.17it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00, 14.16it/s]
(EngineCore_DP0 pid=1219538) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00, 17.68it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  20%|█▉        | 25/128 [00:00<00:00, 248.78it/s]
Adding requests:  59%|█████▉    | 76/128 [00:00<00:00, 401.02it/s]
Adding requests:  99%|█████████▉| 127/128 [00:00<00:00, 447.07it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 419.64it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:03, 39.82it/s, est. speed input: 40786.75 toks/s, output: 39.83 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:00<00:03, 38.22it/s, est. speed input: 39384.13 toks/s, output: 38.45 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:00<00:03, 37.73it/s, est. speed input: 38930.81 toks/s, output: 38.01 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:00<00:02, 37.50it/s, est. speed input: 38708.09 toks/s, output: 37.80 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:00<00:02, 37.41it/s, est. speed input: 38589.78 toks/s, output: 37.68 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:00<00:02, 37.36it/s, est. speed input: 38516.81 toks/s, output: 37.61 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:00<00:02, 37.31it/s, est. speed input: 38456.83 toks/s, output: 37.55 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:00<00:02, 37.29it/s, est. speed input: 38420.58 toks/s, output: 37.52 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:00<00:02, 37.06it/s, est. speed input: 38306.17 toks/s, output: 37.41 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:01<00:02, 36.80it/s, est. speed input: 38181.45 toks/s, output: 37.29 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:01<00:02, 36.41it/s, est. speed input: 38014.01 toks/s, output: 37.12 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:01<00:02, 36.26it/s, est. speed input: 37908.48 toks/s, output: 37.02 toks/s]
Processed prompts:  41%|████      | 52/128 [00:01<00:02, 36.15it/s, est. speed input: 37818.76 toks/s, output: 36.93 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:01<00:01, 36.15it/s, est. speed input: 37759.69 toks/s, output: 36.87 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:01<00:01, 36.17it/s, est. speed input: 37713.79 toks/s, output: 36.83 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:01<00:01, 36.18it/s, est. speed input: 37673.76 toks/s, output: 36.79 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:01<00:01, 36.17it/s, est. speed input: 37634.94 toks/s, output: 36.75 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:01<00:01, 36.34it/s, est. speed input: 37633.12 toks/s, output: 36.75 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:02<00:01, 36.54it/s, est. speed input: 37648.30 toks/s, output: 36.77 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:02<00:01, 36.70it/s, est. speed input: 37663.61 toks/s, output: 36.78 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:02<00:01, 36.87it/s, est. speed input: 37686.60 toks/s, output: 36.80 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:02<00:01, 37.02it/s, est. speed input: 37713.67 toks/s, output: 36.83 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:02<00:00, 37.10it/s, est. speed input: 37732.91 toks/s, output: 36.85 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:02<00:00, 37.09it/s, est. speed input: 37742.59 toks/s, output: 36.86 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:02<00:00, 37.12it/s, est. speed input: 37755.92 toks/s, output: 36.87 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:02<00:00, 37.12it/s, est. speed input: 37765.11 toks/s, output: 36.88 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:02<00:00, 37.12it/s, est. speed input: 37774.70 toks/s, output: 36.89 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:03<00:00, 37.08it/s, est. speed input: 37777.88 toks/s, output: 36.89 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:03<00:00, 37.12it/s, est. speed input: 37789.90 toks/s, output: 36.90 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:03<00:00, 37.10it/s, est. speed input: 37794.79 toks/s, output: 36.91 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:03<00:00, 37.10it/s, est. speed input: 37800.50 toks/s, output: 36.91 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:03<00:00, 37.12it/s, est. speed input: 37809.05 toks/s, output: 36.92 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:03<00:00, 37.12it/s, est. speed input: 37809.05 toks/s, output: 36.92 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:03<00:00, 36.92it/s, est. speed input: 37809.05 toks/s, output: 36.92 toks/s]
[rank0]:[W126 10:33:59.505230844 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=2048 ==========
Time: 2026-01-26 10:34:01
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-FP8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=256, max_num_seqs=2
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-FP8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 256 --max-num-seqs 2 --max-model-len 1025 --max-num-batched-tokens 2048 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_FP8E4M3_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-3B-FP8_M2048.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 10:34:09 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1220631) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1220631) WARNING 01-26 10:34:27 [backends.py:609] Failed to read file <frozen os>
Throughput: 61.42 requests/s, 62953.64 total tokens/s, 61.42 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256

STDERR:
[2026-01-26 10:34:08] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 10:34:09] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-FP8'
[2026-01-26 10:34:09] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-FP8
[2026-01-26 10:34:09] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:34:09] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:34:09] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:34:09] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:34:09] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:34:09] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-FP8'
[2026-01-26 10:34:09] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 10:34:09] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 10:34:09] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 10:34:09] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 10:34:09] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 10:34:16] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 10:34:16] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-FP8'
[2026-01-26 10:34:16] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-FP8
[2026-01-26 10:34:16] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:34:16] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:34:16] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:34:16] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:34:16] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:34:16] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-FP8'
[2026-01-26 10:34:16] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 10:34:16] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 10:34:16] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 10:34:16] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 10:34:16] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1220631) [2026-01-26 10:34:18] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1220631) [2026-01-26 10:34:18] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1220631) [2026-01-26 10:34:18] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1220631) [2026-01-26 10:34:18] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1220631) [2026-01-26 10:34:18] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Llama3.2-3B-FP8
(EngineCore_DP0 pid=1220631) [2026-01-26 10:34:18] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1220631) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1220631) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.88it/s]
(EngineCore_DP0 pid=1220631) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.88it/s]
(EngineCore_DP0 pid=1220631) 
(EngineCore_DP0 pid=1220631) [2026-01-26 10:34:20] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 4608] -> 1D uint8
(EngineCore_DP0 pid=1220631) [2026-01-26 10:34:20] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 14745600 bytes
(EngineCore_DP0 pid=1220631) [2026-01-26 10:34:20] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 4608] -> 1D uint8
(EngineCore_DP0 pid=1220631) [2026-01-26 10:34:20] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 8847360 bytes
(EngineCore_DP0 pid=1220631) [2026-01-26 10:34:20] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [16384, 4608] -> 1D uint8
(EngineCore_DP0 pid=1220631) [2026-01-26 10:34:20] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 47185920 bytes
(EngineCore_DP0 pid=1220631) [2026-01-26 10:34:20] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 12288] -> 1D uint8
(EngineCore_DP0 pid=1220631) [2026-01-26 10:34:20] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 23592960 bytes
(EngineCore_DP0 pid=1220631) 2026-01-26 10:34:37,184 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1220631) 2026-01-26 10:34:37,218 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1220631) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  33%|███▎      | 1/3 [00:00<00:00,  6.09it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00, 11.46it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00, 10.53it/s]
(EngineCore_DP0 pid=1220631) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00, 18.95it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00, 18.92it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  10%|█         | 26/256 [00:00<00:00, 259.18it/s]
Adding requests:  30%|███       | 77/256 [00:00<00:00, 404.64it/s]
Adding requests:  49%|████▉     | 126/256 [00:00<00:00, 442.89it/s]
Adding requests:  68%|██████▊   | 173/256 [00:00<00:00, 450.40it/s]
Adding requests:  87%|████████▋ | 222/256 [00:00<00:00, 464.31it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 449.37it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   9%|▉         | 24/256 [00:00<00:01, 198.80it/s, est. speed input: 203607.23 toks/s, output: 198.81 toks/s]
Processed prompts:  17%|█▋        | 44/256 [00:00<00:02, 95.71it/s, est. speed input: 107107.93 toks/s, output: 104.59 toks/s] 
Processed prompts:  22%|██▏       | 57/256 [00:00<00:02, 86.38it/s, est. speed input: 97233.81 toks/s, output: 94.95 toks/s]  
Processed prompts:  26%|██▌       | 67/256 [00:00<00:02, 79.97it/s, est. speed input: 91415.90 toks/s, output: 89.27 toks/s]
Processed prompts:  30%|██▉       | 76/256 [00:00<00:02, 73.72it/s, est. speed input: 86460.75 toks/s, output: 84.43 toks/s]
Processed prompts:  33%|███▎      | 84/256 [00:01<00:02, 71.86it/s, est. speed input: 84327.72 toks/s, output: 82.35 toks/s]
Processed prompts:  36%|███▌      | 92/256 [00:01<00:02, 70.53it/s, est. speed input: 82680.80 toks/s, output: 80.74 toks/s]
Processed prompts:  39%|███▉      | 100/256 [00:01<00:02, 69.36it/s, est. speed input: 81274.62 toks/s, output: 79.37 toks/s]
Processed prompts:  42%|████▏     | 108/256 [00:01<00:02, 68.66it/s, est. speed input: 80170.91 toks/s, output: 78.29 toks/s]
Processed prompts:  45%|████▌     | 116/256 [00:01<00:02, 67.99it/s, est. speed input: 79189.72 toks/s, output: 77.33 toks/s]
Processed prompts:  48%|████▊     | 124/256 [00:01<00:01, 67.66it/s, est. speed input: 78397.85 toks/s, output: 76.56 toks/s]
Processed prompts:  52%|█████▏    | 132/256 [00:01<00:01, 67.43it/s, est. speed input: 77716.40 toks/s, output: 75.89 toks/s]
Processed prompts:  55%|█████▍    | 140/256 [00:01<00:01, 67.30it/s, est. speed input: 77130.68 toks/s, output: 75.32 toks/s]
Processed prompts:  58%|█████▊    | 148/256 [00:01<00:01, 67.12it/s, est. speed input: 76594.13 toks/s, output: 74.80 toks/s]
Processed prompts:  61%|██████    | 156/256 [00:02<00:01, 66.92it/s, est. speed input: 76103.50 toks/s, output: 74.32 toks/s]
Processed prompts:  64%|██████▍   | 164/256 [00:02<00:01, 66.85it/s, est. speed input: 75681.44 toks/s, output: 73.91 toks/s]
Processed prompts:  67%|██████▋   | 172/256 [00:02<00:01, 66.88it/s, est. speed input: 75317.95 toks/s, output: 73.55 toks/s]
Processed prompts:  70%|███████   | 180/256 [00:02<00:01, 66.81it/s, est. speed input: 74971.39 toks/s, output: 73.21 toks/s]
Processed prompts:  73%|███████▎  | 188/256 [00:02<00:01, 66.72it/s, est. speed input: 74651.96 toks/s, output: 72.90 toks/s]
Processed prompts:  77%|███████▋  | 196/256 [00:02<00:00, 66.66it/s, est. speed input: 74360.91 toks/s, output: 72.62 toks/s]
Processed prompts:  80%|███████▉  | 204/256 [00:02<00:00, 66.59it/s, est. speed input: 74089.53 toks/s, output: 72.35 toks/s]
Processed prompts:  83%|████████▎ | 212/256 [00:02<00:00, 66.52it/s, est. speed input: 73838.60 toks/s, output: 72.11 toks/s]
Processed prompts:  86%|████████▌ | 220/256 [00:03<00:00, 66.53it/s, est. speed input: 73614.23 toks/s, output: 71.89 toks/s]
Processed prompts:  89%|████████▉ | 228/256 [00:03<00:00, 66.57it/s, est. speed input: 73412.04 toks/s, output: 71.69 toks/s]
Processed prompts:  92%|█████████▏| 236/256 [00:03<00:00, 66.70it/s, est. speed input: 73238.35 toks/s, output: 71.52 toks/s]
Processed prompts:  95%|█████████▌| 244/256 [00:03<00:00, 66.72it/s, est. speed input: 73068.34 toks/s, output: 71.36 toks/s]
Processed prompts:  98%|█████████▊| 252/256 [00:03<00:00, 66.62it/s, est. speed input: 72895.09 toks/s, output: 71.19 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:03<00:00, 66.62it/s, est. speed input: 72882.94 toks/s, output: 71.17 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:03<00:00, 71.17it/s, est. speed input: 72882.94 toks/s, output: 71.17 toks/s]
[rank0]:[W126 10:34:43.639837643 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=4096 ==========
Time: 2026-01-26 10:34:46
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-FP8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=512, max_num_seqs=4
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-FP8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 512 --max-num-seqs 4 --max-model-len 1025 --max-num-batched-tokens 4096 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_FP8E4M3_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-3B-FP8_M4096.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 10:34:56 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1221778) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1221778) WARNING 01-26 10:35:12 [backends.py:609] Failed to read file <frozen os>
Throughput: 69.60 requests/s, 71338.76 total tokens/s, 69.60 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512

STDERR:
[2026-01-26 10:34:54] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 10:34:56] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-FP8'
[2026-01-26 10:34:56] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-FP8
[2026-01-26 10:34:56] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:34:56] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:34:56] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:34:56] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:34:56] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:34:56] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-FP8'
[2026-01-26 10:34:56] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 10:34:56] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 10:34:56] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 10:34:56] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 10:34:56] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 10:35:02] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 10:35:03] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-FP8'
[2026-01-26 10:35:03] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-FP8
[2026-01-26 10:35:03] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:35:03] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:35:03] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:35:03] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:35:03] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:35:03] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-FP8'
[2026-01-26 10:35:03] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 10:35:03] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 10:35:03] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 10:35:03] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 10:35:03] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1221778) [2026-01-26 10:35:04] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1221778) [2026-01-26 10:35:04] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1221778) [2026-01-26 10:35:04] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1221778) [2026-01-26 10:35:04] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1221778) [2026-01-26 10:35:04] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Llama3.2-3B-FP8
(EngineCore_DP0 pid=1221778) [2026-01-26 10:35:04] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1221778) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1221778) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.90it/s]
(EngineCore_DP0 pid=1221778) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.90it/s]
(EngineCore_DP0 pid=1221778) 
(EngineCore_DP0 pid=1221778) [2026-01-26 10:35:06] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 4608] -> 1D uint8
(EngineCore_DP0 pid=1221778) [2026-01-26 10:35:06] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 14745600 bytes
(EngineCore_DP0 pid=1221778) [2026-01-26 10:35:06] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 4608] -> 1D uint8
(EngineCore_DP0 pid=1221778) [2026-01-26 10:35:06] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 8847360 bytes
(EngineCore_DP0 pid=1221778) [2026-01-26 10:35:06] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [16384, 4608] -> 1D uint8
(EngineCore_DP0 pid=1221778) [2026-01-26 10:35:06] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 47185920 bytes
(EngineCore_DP0 pid=1221778) [2026-01-26 10:35:06] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 12288] -> 1D uint8
(EngineCore_DP0 pid=1221778) [2026-01-26 10:35:06] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 23592960 bytes
(EngineCore_DP0 pid=1221778) 2026-01-26 10:35:23,515 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1221778) 2026-01-26 10:35:23,563 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1221778) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  25%|██▌       | 1/4 [00:00<00:00,  5.75it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  75%|███████▌  | 3/4 [00:00<00:00, 12.12it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00, 11.62it/s]
(EngineCore_DP0 pid=1221778) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  67%|██████▋   | 2/3 [00:00<00:00, 18.94it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00, 19.42it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   5%|▌         | 27/512 [00:00<00:01, 265.57it/s]
Adding requests:  15%|█▌        | 79/512 [00:00<00:01, 409.57it/s]
Adding requests:  25%|██▌       | 129/512 [00:00<00:00, 450.30it/s]
Adding requests:  35%|███▍      | 178/512 [00:00<00:00, 463.11it/s]
Adding requests:  45%|████▍     | 229/512 [00:00<00:00, 479.81it/s]
Adding requests:  54%|█████▍    | 279/512 [00:00<00:00, 485.26it/s]
Adding requests:  64%|██████▍   | 328/512 [00:00<00:00, 486.48it/s]
Adding requests:  74%|███████▍  | 379/512 [00:00<00:00, 493.00it/s]
Adding requests:  84%|████████▍ | 430/512 [00:00<00:00, 496.38it/s]
Adding requests:  94%|█████████▍| 480/512 [00:01<00:00, 495.49it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 475.98it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  14%|█▍        | 74/512 [00:00<00:00, 512.98it/s, est. speed input: 525369.58 toks/s, output: 513.00 toks/s]
Processed prompts:  25%|██▍       | 126/512 [00:00<00:03, 124.26it/s, est. speed input: 146851.43 toks/s, output: 143.40 toks/s]
Processed prompts:  30%|██▉       | 152/512 [00:01<00:03, 106.87it/s, est. speed input: 127888.46 toks/s, output: 124.89 toks/s]
Processed prompts:  33%|███▎      | 170/512 [00:01<00:03, 93.73it/s, est. speed input: 116081.88 toks/s, output: 113.36 toks/s] 
Processed prompts:  36%|███▌      | 183/512 [00:01<00:03, 90.27it/s, est. speed input: 112302.03 toks/s, output: 109.67 toks/s]
Processed prompts:  38%|███▊      | 195/512 [00:01<00:03, 85.76it/s, est. speed input: 108596.01 toks/s, output: 106.05 toks/s]
Processed prompts:  40%|████      | 205/512 [00:01<00:03, 86.14it/s, est. speed input: 107513.71 toks/s, output: 104.99 toks/s]
Processed prompts:  42%|████▏     | 215/512 [00:02<00:03, 78.66it/s, est. speed input: 103760.04 toks/s, output: 101.33 toks/s]
Processed prompts:  44%|████▍     | 224/512 [00:02<00:03, 78.83it/s, est. speed input: 102626.10 toks/s, output: 100.22 toks/s]
Processed prompts:  46%|████▌     | 233/512 [00:02<00:03, 79.11it/s, est. speed input: 101637.04 toks/s, output: 99.25 toks/s] 
Processed prompts:  47%|████▋     | 242/512 [00:02<00:03, 70.49it/s, est. speed input: 98442.56 toks/s, output: 96.13 toks/s] 
Processed prompts:  49%|████▉     | 250/512 [00:02<00:03, 70.53it/s, est. speed input: 97318.67 toks/s, output: 95.04 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:02<00:03, 70.61it/s, est. speed input: 96298.68 toks/s, output: 94.04 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:02<00:03, 70.55it/s, est. speed input: 95335.28 toks/s, output: 93.10 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:02<00:03, 70.67it/s, est. speed input: 94476.21 toks/s, output: 92.26 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:03<00:03, 70.67it/s, est. speed input: 93665.15 toks/s, output: 91.47 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:03<00:03, 70.52it/s, est. speed input: 92886.64 toks/s, output: 90.71 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:03<00:03, 70.72it/s, est. speed input: 92207.87 toks/s, output: 90.05 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:03<00:02, 70.78it/s, est. speed input: 91563.06 toks/s, output: 89.42 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:03<00:02, 70.80it/s, est. speed input: 90955.76 toks/s, output: 88.82 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:03<00:02, 70.86it/s, est. speed input: 90392.32 toks/s, output: 88.27 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:03<00:02, 70.82it/s, est. speed input: 89851.73 toks/s, output: 87.74 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:03<00:02, 70.71it/s, est. speed input: 89331.92 toks/s, output: 87.24 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:03<00:02, 72.36it/s, est. speed input: 89046.18 toks/s, output: 86.96 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:04<00:02, 72.02it/s, est. speed input: 88603.61 toks/s, output: 86.53 toks/s]
Processed prompts:  71%|███████   | 362/512 [00:04<00:02, 71.54it/s, est. speed input: 88157.91 toks/s, output: 86.09 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [00:04<00:01, 71.26it/s, est. speed input: 87742.47 toks/s, output: 85.69 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [00:04<00:01, 71.26it/s, est. speed input: 87368.06 toks/s, output: 85.32 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [00:04<00:01, 71.12it/s, est. speed input: 86998.27 toks/s, output: 84.96 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [00:04<00:01, 70.87it/s, est. speed input: 86631.76 toks/s, output: 84.60 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [00:04<00:01, 70.82it/s, est. speed input: 86294.03 toks/s, output: 84.27 toks/s]
Processed prompts:  80%|████████  | 410/512 [00:04<00:01, 70.71it/s, est. speed input: 85964.79 toks/s, output: 83.95 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [00:04<00:01, 70.73it/s, est. speed input: 85659.99 toks/s, output: 83.65 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [00:05<00:01, 70.81it/s, est. speed input: 85374.36 toks/s, output: 83.37 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [00:05<00:01, 70.74it/s, est. speed input: 85089.88 toks/s, output: 83.09 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [00:05<00:00, 70.66it/s, est. speed input: 84814.36 toks/s, output: 82.83 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [00:05<00:00, 72.48it/s, est. speed input: 84703.05 toks/s, output: 82.72 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [00:05<00:00, 72.09it/s, est. speed input: 84464.10 toks/s, output: 82.48 toks/s]
Processed prompts:  91%|█████████ | 466/512 [00:05<00:00, 71.68it/s, est. speed input: 84224.13 toks/s, output: 82.25 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [00:05<00:00, 71.25it/s, est. speed input: 83982.46 toks/s, output: 82.01 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [00:05<00:00, 71.03it/s, est. speed input: 83756.49 toks/s, output: 81.79 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [00:06<00:00, 70.84it/s, est. speed input: 83535.56 toks/s, output: 81.58 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [00:06<00:00, 70.75it/s, est. speed input: 83325.54 toks/s, output: 81.37 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [00:06<00:00, 70.81it/s, est. speed input: 83132.36 toks/s, output: 81.18 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:06<00:00, 70.81it/s, est. speed input: 83504.09 toks/s, output: 81.55 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:06<00:00, 81.54it/s, est. speed input: 83504.09 toks/s, output: 81.55 toks/s]
[rank0]:[W126 10:35:33.558973032 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=8192 ==========
Time: 2026-01-26 10:35:35
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-FP8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=1024, max_num_seqs=8
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-FP8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 1024 --max-num-seqs 8 --max-model-len 1025 --max-num-batched-tokens 8192 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_FP8E4M3_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-3B-FP8_M8192.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 10:35:46 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1222961) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1222961) WARNING 01-26 10:36:03 [backends.py:609] Failed to read file <frozen os>
Throughput: 73.52 requests/s, 75355.04 total tokens/s, 73.52 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024

STDERR:
[2026-01-26 10:35:46] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 10:35:46] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-FP8'
[2026-01-26 10:35:46] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-FP8
[2026-01-26 10:35:46] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:35:46] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:35:46] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:35:46] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:35:46] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:35:46] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-FP8'
[2026-01-26 10:35:46] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 10:35:46] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 10:35:46] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 10:35:46] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 10:35:46] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 10:35:53] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 10:35:53] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-FP8'
[2026-01-26 10:35:53] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-FP8
[2026-01-26 10:35:53] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:35:53] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:35:53] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:35:53] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:35:53] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:35:53] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-FP8'
[2026-01-26 10:35:53] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 10:35:53] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 10:35:53] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 10:35:53] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 10:35:53] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1222961) [2026-01-26 10:35:55] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1222961) [2026-01-26 10:35:55] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1222961) [2026-01-26 10:35:55] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1222961) [2026-01-26 10:35:55] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1222961) [2026-01-26 10:35:55] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Llama3.2-3B-FP8
(EngineCore_DP0 pid=1222961) [2026-01-26 10:35:55] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1222961) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1222961) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.89it/s]
(EngineCore_DP0 pid=1222961) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.89it/s]
(EngineCore_DP0 pid=1222961) 
(EngineCore_DP0 pid=1222961) [2026-01-26 10:35:57] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 4608] -> 1D uint8
(EngineCore_DP0 pid=1222961) [2026-01-26 10:35:57] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 14745600 bytes
(EngineCore_DP0 pid=1222961) [2026-01-26 10:35:57] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 4608] -> 1D uint8
(EngineCore_DP0 pid=1222961) [2026-01-26 10:35:57] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 8847360 bytes
(EngineCore_DP0 pid=1222961) [2026-01-26 10:35:57] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [16384, 4608] -> 1D uint8
(EngineCore_DP0 pid=1222961) [2026-01-26 10:35:57] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 47185920 bytes
(EngineCore_DP0 pid=1222961) [2026-01-26 10:35:57] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 12288] -> 1D uint8
(EngineCore_DP0 pid=1222961) [2026-01-26 10:35:57] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 23592960 bytes
(EngineCore_DP0 pid=1222961) 2026-01-26 10:36:14,442 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1222961) 2026-01-26 10:36:14,493 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1222961) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:01,  2.83it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  60%|██████    | 3/5 [00:00<00:00,  7.18it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00,  7.07it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00,  6.50it/s]
(EngineCore_DP0 pid=1222961) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:01,  1.69it/s]
Capturing CUDA graphs (decode, FULL):  75%|███████▌  | 3/4 [00:00<00:00,  4.44it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  4.61it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   3%|▎         | 29/1024 [00:00<00:03, 289.27it/s]
Adding requests:   8%|▊         | 80/1024 [00:00<00:02, 416.37it/s]
Adding requests:  13%|█▎        | 131/1024 [00:00<00:01, 454.80it/s]
Adding requests:  18%|█▊        | 180/1024 [00:00<00:01, 466.10it/s]
Adding requests:  23%|██▎       | 231/1024 [00:00<00:01, 481.67it/s]
Adding requests:  27%|██▋       | 281/1024 [00:00<00:01, 487.42it/s]
Adding requests:  32%|███▏      | 331/1024 [00:00<00:01, 488.84it/s]
Adding requests:  37%|███▋      | 382/1024 [00:00<00:01, 495.24it/s]
Adding requests:  42%|████▏     | 433/1024 [00:00<00:01, 499.04it/s]
Adding requests:  47%|████▋     | 483/1024 [00:01<00:01, 498.67it/s]
Adding requests:  52%|█████▏    | 533/1024 [00:01<00:01, 479.37it/s]
Adding requests:  57%|█████▋    | 585/1024 [00:01<00:00, 489.16it/s]
Adding requests:  62%|██████▏   | 636/1024 [00:01<00:00, 493.87it/s]
Adding requests:  67%|██████▋   | 688/1024 [00:01<00:00, 501.01it/s]
Adding requests:  72%|███████▏  | 739/1024 [00:01<00:00, 502.61it/s]
Adding requests:  77%|███████▋  | 790/1024 [00:01<00:00, 498.42it/s]
Adding requests:  82%|████████▏ | 840/1024 [00:01<00:00, 489.88it/s]
Adding requests:  87%|████████▋ | 893/1024 [00:01<00:00, 498.56it/s]
Adding requests:  92%|█████████▏| 944/1024 [00:01<00:00, 499.99it/s]
Adding requests:  97%|█████████▋| 995/1024 [00:02<00:00, 501.82it/s]
Adding requests: 100%|██████████| 1024/1024 [00:02<00:00, 488.65it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  15%|█▌        | 154/1024 [00:00<00:00, 954.06it/s, est. speed input: 977103.73 toks/s, output: 954.10 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:01<00:05, 144.51it/s, est. speed input: 175505.82 toks/s, output: 171.39 toks/s]
Processed prompts:  29%|██▊       | 294/1024 [00:01<00:05, 122.20it/s, est. speed input: 150605.06 toks/s, output: 147.07 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:02<00:06, 105.64it/s, est. speed input: 135597.39 toks/s, output: 132.42 toks/s]
Processed prompts:  33%|███▎      | 342/1024 [00:02<00:06, 104.08it/s, est. speed input: 132677.76 toks/s, output: 129.57 toks/s]
Processed prompts:  35%|███▍      | 358/1024 [00:02<00:06, 98.20it/s, est. speed input: 128392.92 toks/s, output: 125.38 toks/s] 
Processed prompts:  36%|███▌      | 371/1024 [00:03<00:07, 89.77it/s, est. speed input: 123659.82 toks/s, output: 120.76 toks/s]
Processed prompts:  37%|███▋      | 382/1024 [00:03<00:07, 91.25it/s, est. speed input: 122949.21 toks/s, output: 120.07 toks/s]
Processed prompts:  38%|███▊      | 393/1024 [00:03<00:06, 92.86it/s, est. speed input: 122307.86 toks/s, output: 119.44 toks/s]
Processed prompts:  39%|███▉      | 404/1024 [00:03<00:07, 79.57it/s, est. speed input: 117975.44 toks/s, output: 115.21 toks/s]
Processed prompts:  40%|████      | 413/1024 [00:03<00:07, 80.28it/s, est. speed input: 117004.30 toks/s, output: 114.26 toks/s]
Processed prompts:  41%|████      | 422/1024 [00:03<00:07, 80.77it/s, est. speed input: 116055.65 toks/s, output: 113.34 toks/s]
Processed prompts:  42%|████▏     | 431/1024 [00:03<00:07, 81.39it/s, est. speed input: 115195.24 toks/s, output: 112.50 toks/s]
Processed prompts:  43%|████▎     | 440/1024 [00:03<00:07, 81.78it/s, est. speed input: 114362.71 toks/s, output: 111.68 toks/s]
Processed prompts:  44%|████▍     | 449/1024 [00:04<00:07, 82.10it/s, est. speed input: 113575.75 toks/s, output: 110.91 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:04<00:08, 66.10it/s, est. speed input: 110228.88 toks/s, output: 107.64 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:04<00:08, 67.90it/s, est. speed input: 109363.36 toks/s, output: 106.80 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:04<00:07, 69.48it/s, est. speed input: 108557.45 toks/s, output: 106.01 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:04<00:07, 70.72it/s, est. speed input: 107789.21 toks/s, output: 105.26 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:04<00:07, 71.49it/s, est. speed input: 107033.70 toks/s, output: 104.52 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:04<00:07, 72.27it/s, est. speed input: 106337.82 toks/s, output: 103.85 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:04<00:07, 72.81it/s, est. speed input: 105668.87 toks/s, output: 103.19 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:05<00:06, 73.14it/s, est. speed input: 105022.64 toks/s, output: 102.56 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:05<00:06, 73.19it/s, est. speed input: 104384.41 toks/s, output: 101.94 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:05<00:06, 73.37it/s, est. speed input: 103786.89 toks/s, output: 101.35 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:05<00:06, 73.46it/s, est. speed input: 103210.65 toks/s, output: 100.79 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:05<00:06, 73.51it/s, est. speed input: 102655.73 toks/s, output: 100.25 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:05<00:06, 73.69it/s, est. speed input: 102135.92 toks/s, output: 99.74 toks/s] 
Processed prompts:  55%|█████▍    | 562/1024 [00:05<00:06, 73.59it/s, est. speed input: 101615.06 toks/s, output: 99.23 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:05<00:06, 73.73it/s, est. speed input: 101132.78 toks/s, output: 98.76 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:05<00:06, 73.55it/s, est. speed input: 100644.61 toks/s, output: 98.29 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:05<00:05, 73.60it/s, est. speed input: 100188.92 toks/s, output: 97.84 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:06<00:05, 73.69it/s, est. speed input: 99753.50 toks/s, output: 97.41 toks/s] 
Processed prompts:  59%|█████▉    | 602/1024 [00:06<00:05, 73.59it/s, est. speed input: 99320.96 toks/s, output: 96.99 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:06<00:05, 73.71it/s, est. speed input: 98917.20 toks/s, output: 96.60 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:06<00:05, 73.51it/s, est. speed input: 98506.14 toks/s, output: 96.20 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:06<00:05, 73.59it/s, est. speed input: 98125.00 toks/s, output: 95.82 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:06<00:05, 73.42it/s, est. speed input: 97740.35 toks/s, output: 95.45 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:06<00:05, 73.58it/s, est. speed input: 97388.05 toks/s, output: 95.10 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:06<00:05, 73.63it/s, est. speed input: 97041.74 toks/s, output: 94.77 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:06<00:04, 73.60it/s, est. speed input: 96701.67 toks/s, output: 94.43 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:07<00:04, 73.64it/s, est. speed input: 96376.53 toks/s, output: 94.12 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:07<00:04, 73.47it/s, est. speed input: 96048.36 toks/s, output: 93.80 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:07<00:04, 73.58it/s, est. speed input: 95744.94 toks/s, output: 93.50 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:07<00:04, 73.52it/s, est. speed input: 95441.54 toks/s, output: 93.20 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:07<00:04, 73.59it/s, est. speed input: 95153.88 toks/s, output: 92.92 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:07<00:04, 73.56it/s, est. speed input: 94869.64 toks/s, output: 92.65 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:07<00:04, 73.55it/s, est. speed input: 94594.20 toks/s, output: 92.38 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:07<00:04, 73.65it/s, est. speed input: 94332.45 toks/s, output: 92.12 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:07<00:03, 73.71it/s, est. speed input: 94077.37 toks/s, output: 91.87 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:08<00:03, 73.65it/s, est. speed input: 93823.31 toks/s, output: 91.62 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:08<00:03, 73.48it/s, est. speed input: 93568.52 toks/s, output: 91.38 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:08<00:03, 73.53it/s, est. speed input: 93330.19 toks/s, output: 91.14 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:08<00:03, 73.32it/s, est. speed input: 93084.89 toks/s, output: 90.90 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:08<00:03, 73.52it/s, est. speed input: 92864.05 toks/s, output: 90.69 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:08<00:03, 73.47it/s, est. speed input: 92639.12 toks/s, output: 90.47 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:08<00:03, 73.41it/s, est. speed input: 92418.60 toks/s, output: 90.25 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:08<00:03, 73.54it/s, est. speed input: 92211.69 toks/s, output: 90.05 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:08<00:03, 73.49it/s, est. speed input: 92002.82 toks/s, output: 89.85 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:09<00:02, 73.67it/s, est. speed input: 91810.12 toks/s, output: 89.66 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:09<00:02, 73.49it/s, est. speed input: 91606.68 toks/s, output: 89.46 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:09<00:02, 73.48it/s, est. speed input: 91414.06 toks/s, output: 89.27 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:09<00:02, 73.35it/s, est. speed input: 91219.65 toks/s, output: 89.08 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [00:09<00:02, 73.51it/s, est. speed input: 91041.69 toks/s, output: 88.91 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [00:09<00:02, 73.44it/s, est. speed input: 90859.39 toks/s, output: 88.73 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:09<00:02, 73.42it/s, est. speed input: 90682.30 toks/s, output: 88.56 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [00:09<00:02, 73.53it/s, est. speed input: 90514.71 toks/s, output: 88.39 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [00:09<00:02, 73.49it/s, est. speed input: 90345.98 toks/s, output: 88.23 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [00:10<00:01, 73.63it/s, est. speed input: 90188.28 toks/s, output: 88.07 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [00:10<00:01, 73.50it/s, est. speed input: 90023.74 toks/s, output: 87.91 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [00:10<00:01, 73.52it/s, est. speed input: 89867.45 toks/s, output: 87.76 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [00:10<00:01, 73.45it/s, est. speed input: 89711.04 toks/s, output: 87.61 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [00:10<00:01, 73.51it/s, est. speed input: 89562.48 toks/s, output: 87.46 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [00:10<00:01, 73.44it/s, est. speed input: 89412.30 toks/s, output: 87.32 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [00:10<00:01, 73.39it/s, est. speed input: 89264.95 toks/s, output: 87.17 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [00:10<00:01, 75.31it/s, est. speed input: 89080.78 toks/s, output: 86.99 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [00:10<00:00, 74.85it/s, est. speed input: 88943.67 toks/s, output: 86.86 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [00:11<00:00, 74.46it/s, est. speed input: 88808.34 toks/s, output: 86.73 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [00:11<00:00, 74.13it/s, est. speed input: 88673.67 toks/s, output: 86.60 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [00:11<00:00, 73.93it/s, est. speed input: 88543.96 toks/s, output: 86.47 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [00:11<00:00, 75.51it/s, est. speed input: 88381.12 toks/s, output: 86.31 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [00:11<00:00, 74.97it/s, est. speed input: 88256.13 toks/s, output: 86.19 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [00:11<00:00, 74.64it/s, est. speed input: 88137.92 toks/s, output: 86.07 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:11<00:00, 74.64it/s, est. speed input: 88630.80 toks/s, output: 86.55 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:11<00:00, 86.55it/s, est. speed input: 88630.80 toks/s, output: 86.55 toks/s]
[rank0]:[W126 10:36:31.954205818 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=16384 ==========
Time: 2026-01-26 10:36:34
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-FP8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=2048, max_num_seqs=16
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-FP8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 2048 --max-num-seqs 16 --max-model-len 1025 --max-num-batched-tokens 16384 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_FP8E4M3_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-3B-FP8_M16384.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 10:36:49 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1224324) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1224324) WARNING 01-26 10:37:06 [backends.py:609] Failed to read file <frozen os>
Throughput: 75.91 requests/s, 77805.35 total tokens/s, 75.91 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048

STDERR:
[2026-01-26 10:36:49] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 10:36:49] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-FP8'
[2026-01-26 10:36:49] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-FP8
[2026-01-26 10:36:49] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:36:49] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:36:49] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:36:49] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:36:49] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:36:49] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-FP8'
[2026-01-26 10:36:49] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 10:36:49] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 10:36:49] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 10:36:49] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 10:36:49] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 10:36:56] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 10:36:57] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-FP8'
[2026-01-26 10:36:57] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-FP8
[2026-01-26 10:36:57] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:36:57] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:36:57] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:36:57] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:36:57] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:36:57] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-FP8'
[2026-01-26 10:36:57] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 10:36:57] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 10:36:57] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 10:36:57] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 10:36:57] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1224324) [2026-01-26 10:36:59] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1224324) [2026-01-26 10:36:59] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1224324) [2026-01-26 10:36:59] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1224324) [2026-01-26 10:36:59] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1224324) [2026-01-26 10:36:59] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Llama3.2-3B-FP8
(EngineCore_DP0 pid=1224324) [2026-01-26 10:36:59] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1224324) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1224324) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.92it/s]
(EngineCore_DP0 pid=1224324) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.91it/s]
(EngineCore_DP0 pid=1224324) 
(EngineCore_DP0 pid=1224324) [2026-01-26 10:36:59] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 4608] -> 1D uint8
(EngineCore_DP0 pid=1224324) [2026-01-26 10:37:00] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 14745600 bytes
(EngineCore_DP0 pid=1224324) [2026-01-26 10:37:00] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 4608] -> 1D uint8
(EngineCore_DP0 pid=1224324) [2026-01-26 10:37:00] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 8847360 bytes
(EngineCore_DP0 pid=1224324) [2026-01-26 10:37:00] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [16384, 4608] -> 1D uint8
(EngineCore_DP0 pid=1224324) [2026-01-26 10:37:00] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 47185920 bytes
(EngineCore_DP0 pid=1224324) [2026-01-26 10:37:00] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 12288] -> 1D uint8
(EngineCore_DP0 pid=1224324) [2026-01-26 10:37:00] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 23592960 bytes
(EngineCore_DP0 pid=1224324) 2026-01-26 10:37:16,828 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1224324) 2026-01-26 10:37:16,853 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1224324) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  29%|██▊       | 2/7 [00:00<00:00,  7.18it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  43%|████▎     | 3/7 [00:00<00:01,  3.38it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  57%|█████▋    | 4/7 [00:00<00:00,  4.42it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  71%|███████▏  | 5/7 [00:01<00:00,  4.90it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:01<00:00,  7.51it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:01<00:00,  5.89it/s]
(EngineCore_DP0 pid=1224324) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  40%|████      | 2/5 [00:00<00:00, 19.09it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00, 20.14it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00, 20.00it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 33/2048 [00:00<00:06, 326.57it/s]
Adding requests:   4%|▍         | 84/2048 [00:00<00:04, 433.03it/s]
Adding requests:   7%|▋         | 134/2048 [00:00<00:04, 461.13it/s]
Adding requests:   9%|▉         | 183/2048 [00:00<00:03, 469.86it/s]
Adding requests:  11%|█▏        | 234/2048 [00:00<00:03, 482.77it/s]
Adding requests:  14%|█▍        | 284/2048 [00:00<00:03, 487.30it/s]
Adding requests:  16%|█▋        | 333/2048 [00:00<00:03, 487.67it/s]
Adding requests:  19%|█▉        | 384/2048 [00:00<00:03, 492.01it/s]
Adding requests:  21%|██        | 435/2048 [00:00<00:03, 496.68it/s]
Adding requests:  24%|██▎       | 486/2048 [00:01<00:03, 499.66it/s]
Adding requests:  26%|██▌       | 536/2048 [00:01<00:03, 486.32it/s]
Adding requests:  29%|██▊       | 588/2048 [00:01<00:02, 494.48it/s]
Adding requests:  31%|███       | 639/2048 [00:01<00:02, 497.62it/s]
Adding requests:  34%|███▎      | 691/2048 [00:01<00:02, 501.95it/s]
Adding requests:  36%|███▌      | 742/2048 [00:01<00:02, 494.87it/s]
Adding requests:  39%|███▊      | 792/2048 [00:01<00:02, 492.03it/s]
Adding requests:  41%|████      | 842/2048 [00:01<00:02, 486.32it/s]
Adding requests:  44%|████▎     | 895/2048 [00:01<00:02, 496.45it/s]
Adding requests:  46%|████▌     | 946/2048 [00:01<00:02, 499.60it/s]
Adding requests:  49%|████▊     | 997/2048 [00:02<00:02, 501.53it/s]
Adding requests:  51%|█████     | 1048/2048 [00:02<00:01, 503.65it/s]
Adding requests:  54%|█████▎    | 1099/2048 [00:02<00:01, 501.15it/s]
Adding requests:  56%|█████▌    | 1150/2048 [00:02<00:01, 496.47it/s]
Adding requests:  59%|█████▉    | 1204/2048 [00:02<00:01, 507.98it/s]
Adding requests:  61%|██████▏   | 1255/2048 [00:02<00:01, 502.78it/s]
Adding requests:  64%|██████▍   | 1306/2048 [00:02<00:01, 500.00it/s]
Adding requests:  66%|██████▋   | 1357/2048 [00:02<00:01, 501.05it/s]
Adding requests:  69%|██████▉   | 1409/2048 [00:02<00:01, 505.06it/s]
Adding requests:  71%|███████▏  | 1460/2048 [00:02<00:01, 504.71it/s]
Adding requests:  74%|███████▍  | 1512/2048 [00:03<00:01, 508.77it/s]
Adding requests:  76%|███████▋  | 1563/2048 [00:03<00:00, 508.71it/s]
Adding requests:  79%|███████▉  | 1616/2048 [00:03<00:00, 511.90it/s]
Adding requests:  81%|████████▏ | 1668/2048 [00:03<00:00, 509.29it/s]
Adding requests:  84%|████████▍ | 1720/2048 [00:03<00:00, 510.82it/s]
Adding requests:  87%|████████▋ | 1772/2048 [00:03<00:00, 508.26it/s]
Adding requests:  89%|████████▉ | 1823/2048 [00:03<00:00, 506.15it/s]
Adding requests:  92%|█████████▏| 1874/2048 [00:03<00:00, 504.71it/s]
Adding requests:  94%|█████████▍| 1925/2048 [00:03<00:00, 489.68it/s]
Adding requests:  96%|█████████▋| 1976/2048 [00:03<00:00, 494.44it/s]
Adding requests:  99%|█████████▉| 2028/2048 [00:04<00:00, 501.02it/s]
Adding requests: 100%|██████████| 2048/2048 [00:04<00:00, 496.34it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [00:00<00:00, 1890.40it/s, est. speed input: 1936055.05 toks/s, output: 1890.48 toks/s]
Processed prompts:  24%|██▍       | 496/2048 [00:02<00:09, 168.06it/s, est. speed input: 207003.69 toks/s, output: 202.15 toks/s]   
Processed prompts:  28%|██▊       | 579/2048 [00:03<00:11, 124.31it/s, est. speed input: 159649.90 toks/s, output: 155.91 toks/s]
Processed prompts:  31%|███       | 627/2048 [00:04<00:12, 112.73it/s, est. speed input: 147554.35 toks/s, output: 144.10 toks/s]
Processed prompts:  32%|███▏      | 659/2048 [00:04<00:13, 106.07it/s, est. speed input: 141426.30 toks/s, output: 138.11 toks/s]
Processed prompts:  33%|███▎      | 683/2048 [00:04<00:12, 106.94it/s, est. speed input: 140363.31 toks/s, output: 137.07 toks/s]
Processed prompts:  34%|███▍      | 703/2048 [00:05<00:12, 105.26it/s, est. speed input: 138616.54 toks/s, output: 135.37 toks/s]
Processed prompts:  35%|███▌      | 720/2048 [00:05<00:13, 101.01it/s, est. speed input: 136396.63 toks/s, output: 133.20 toks/s]
Processed prompts:  36%|███▌      | 734/2048 [00:05<00:13, 94.35it/s, est. speed input: 133838.75 toks/s, output: 130.70 toks/s] 
Processed prompts:  36%|███▋      | 746/2048 [00:05<00:15, 86.28it/s, est. speed input: 131115.75 toks/s, output: 128.04 toks/s]
Processed prompts:  37%|███▋      | 756/2048 [00:06<00:16, 77.05it/s, est. speed input: 128222.24 toks/s, output: 125.22 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [00:06<00:17, 74.36it/s, est. speed input: 126189.51 toks/s, output: 123.23 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [00:06<00:16, 74.67it/s, est. speed input: 124587.48 toks/s, output: 121.67 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [00:06<00:16, 75.01it/s, est. speed input: 123107.15 toks/s, output: 120.22 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [00:06<00:16, 75.27it/s, est. speed input: 121718.99 toks/s, output: 118.87 toks/s]
Processed prompts:  41%|████      | 834/2048 [00:07<00:16, 75.30it/s, est. speed input: 120386.56 toks/s, output: 117.56 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [00:07<00:15, 75.49it/s, est. speed input: 119157.61 toks/s, output: 116.36 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [00:07<00:15, 75.63it/s, est. speed input: 117998.42 toks/s, output: 115.23 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [00:07<00:15, 75.78it/s, est. speed input: 116909.71 toks/s, output: 114.17 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [00:07<00:15, 75.74it/s, est. speed input: 115857.92 toks/s, output: 113.14 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [00:08<00:14, 75.77it/s, est. speed input: 114869.60 toks/s, output: 112.18 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [00:08<00:14, 77.20it/s, est. speed input: 114106.76 toks/s, output: 111.43 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [00:08<00:14, 76.57it/s, est. speed input: 113181.73 toks/s, output: 110.53 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [00:08<00:14, 76.25it/s, est. speed input: 112315.83 toks/s, output: 109.68 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [00:08<00:13, 77.63it/s, est. speed input: 111670.06 toks/s, output: 109.05 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [00:09<00:13, 76.88it/s, est. speed input: 110866.63 toks/s, output: 108.27 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [00:09<00:13, 76.50it/s, est. speed input: 110113.54 toks/s, output: 107.53 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [00:09<00:13, 76.34it/s, est. speed input: 109404.76 toks/s, output: 106.84 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [00:09<00:13, 76.08it/s, est. speed input: 108711.25 toks/s, output: 106.16 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [00:10<00:13, 75.93it/s, est. speed input: 108049.76 toks/s, output: 105.52 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [00:10<00:12, 75.87it/s, est. speed input: 107420.90 toks/s, output: 104.90 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [00:10<00:12, 75.79it/s, est. speed input: 106813.07 toks/s, output: 104.31 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [00:10<00:12, 75.68it/s, est. speed input: 106224.84 toks/s, output: 103.73 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [00:10<00:12, 75.59it/s, est. speed input: 105657.46 toks/s, output: 103.18 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [00:11<00:12, 75.69it/s, est. speed input: 105126.72 toks/s, output: 102.66 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [00:11<00:11, 77.04it/s, est. speed input: 104724.45 toks/s, output: 102.27 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [00:11<00:11, 76.60it/s, est. speed input: 104221.44 toks/s, output: 101.78 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [00:11<00:11, 76.44it/s, est. speed input: 103748.69 toks/s, output: 101.32 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [00:11<00:11, 76.06it/s, est. speed input: 103271.00 toks/s, output: 100.85 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [00:12<00:10, 75.77it/s, est. speed input: 102808.29 toks/s, output: 100.40 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [00:12<00:10, 75.82it/s, est. speed input: 102380.15 toks/s, output: 99.98 toks/s] 
Processed prompts:  61%|██████    | 1250/2048 [00:12<00:10, 75.66it/s, est. speed input: 101952.52 toks/s, output: 99.56 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [00:12<00:10, 75.68it/s, est. speed input: 101548.62 toks/s, output: 99.17 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [00:12<00:10, 75.65it/s, est. speed input: 101154.31 toks/s, output: 98.78 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [00:13<00:09, 75.55it/s, est. speed input: 100767.41 toks/s, output: 98.41 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [00:13<00:09, 75.70it/s, est. speed input: 100408.34 toks/s, output: 98.05 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [00:13<00:09, 75.62it/s, est. speed input: 100047.33 toks/s, output: 97.70 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [00:13<00:09, 75.90it/s, est. speed input: 99720.13 toks/s, output: 97.38 toks/s] 
Processed prompts:  67%|██████▋   | 1362/2048 [00:14<00:09, 75.65it/s, est. speed input: 99372.88 toks/s, output: 97.04 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [00:14<00:08, 75.99it/s, est. speed input: 99069.66 toks/s, output: 96.75 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [00:14<00:08, 76.07it/s, est. speed input: 98764.89 toks/s, output: 96.45 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [00:14<00:08, 75.96it/s, est. speed input: 98458.61 toks/s, output: 96.15 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [00:14<00:08, 76.09it/s, est. speed input: 98173.87 toks/s, output: 95.87 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [00:15<00:07, 76.09it/s, est. speed input: 97891.70 toks/s, output: 95.60 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [00:15<00:07, 76.21it/s, est. speed input: 97623.97 toks/s, output: 95.34 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [00:15<00:07, 76.12it/s, est. speed input: 97353.51 toks/s, output: 95.07 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [00:15<00:07, 75.87it/s, est. speed input: 97079.67 toks/s, output: 94.80 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [00:15<00:07, 75.77it/s, est. speed input: 96817.41 toks/s, output: 94.55 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [00:16<00:06, 75.87it/s, est. speed input: 96571.29 toks/s, output: 94.31 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [00:16<00:06, 75.91it/s, est. speed input: 96329.91 toks/s, output: 94.07 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [00:16<00:06, 75.94it/s, est. speed input: 96095.04 toks/s, output: 93.84 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [00:16<00:06, 75.74it/s, est. speed input: 95853.99 toks/s, output: 93.61 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [00:16<00:06, 75.73it/s, est. speed input: 95626.06 toks/s, output: 93.38 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [00:17<00:05, 75.78it/s, est. speed input: 95406.50 toks/s, output: 93.17 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [00:17<00:05, 75.86it/s, est. speed input: 95194.23 toks/s, output: 92.96 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [00:17<00:05, 75.80it/s, est. speed input: 94981.81 toks/s, output: 92.76 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [00:17<00:05, 75.83it/s, est. speed input: 94777.88 toks/s, output: 92.56 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [00:18<00:05, 75.77it/s, est. speed input: 94574.17 toks/s, output: 92.36 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [00:18<00:04, 75.82it/s, est. speed input: 94379.94 toks/s, output: 92.17 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [00:18<00:04, 75.78it/s, est. speed input: 94186.67 toks/s, output: 91.98 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [00:18<00:04, 75.83it/s, est. speed input: 94001.60 toks/s, output: 91.80 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [00:18<00:04, 75.71it/s, est. speed input: 93813.48 toks/s, output: 91.61 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [00:19<00:03, 75.76it/s, est. speed input: 93635.36 toks/s, output: 91.44 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [00:19<00:03, 75.95it/s, est. speed input: 93468.36 toks/s, output: 91.28 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [00:19<00:03, 76.06it/s, est. speed input: 93303.51 toks/s, output: 91.12 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [00:19<00:03, 76.08it/s, est. speed input: 93140.14 toks/s, output: 90.96 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [00:19<00:03, 75.90it/s, est. speed input: 92971.71 toks/s, output: 90.79 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [00:20<00:02, 75.89it/s, est. speed input: 92811.66 toks/s, output: 90.64 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [00:20<00:02, 76.04it/s, est. speed input: 92661.42 toks/s, output: 90.49 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [00:20<00:02, 75.82it/s, est. speed input: 92500.90 toks/s, output: 90.33 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [00:20<00:02, 77.14it/s, est. speed input: 92403.40 toks/s, output: 90.24 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [00:20<00:02, 76.54it/s, est. speed input: 92247.12 toks/s, output: 90.08 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [00:21<00:01, 76.27it/s, est. speed input: 92099.60 toks/s, output: 89.94 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [00:21<00:01, 76.34it/s, est. speed input: 91965.16 toks/s, output: 89.81 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [00:21<00:01, 76.07it/s, est. speed input: 91820.90 toks/s, output: 89.67 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [00:21<00:01, 77.39it/s, est. speed input: 91736.70 toks/s, output: 89.59 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [00:22<00:01, 76.93it/s, est. speed input: 91602.54 toks/s, output: 89.46 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [00:22<00:00, 76.44it/s, est. speed input: 91464.09 toks/s, output: 89.32 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [00:22<00:00, 76.33it/s, est. speed input: 91337.11 toks/s, output: 89.20 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [00:22<00:00, 76.20it/s, est. speed input: 91210.45 toks/s, output: 89.07 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [00:22<00:00, 77.85it/s, est. speed input: 91148.40 toks/s, output: 89.01 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:22<00:00, 77.85it/s, est. speed input: 91773.30 toks/s, output: 89.62 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:22<00:00, 89.62it/s, est. speed input: 91773.30 toks/s, output: 89.62 toks/s]
[rank0]:[W126 10:37:47.315152442 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=32768 ==========
Time: 2026-01-26 10:37:49
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-FP8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=4096, max_num_seqs=32
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-FP8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 4096 --max-num-seqs 32 --max-model-len 1025 --max-num-batched-tokens 32768 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_FP8E4M3_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-3B-FP8_M32768.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 10:38:14 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1225930) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1225930) WARNING 01-26 10:38:30 [backends.py:609] Failed to read file <frozen os>
Throughput: 76.81 requests/s, 78725.94 total tokens/s, 76.81 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096

STDERR:
[2026-01-26 10:38:13] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 10:38:14] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-FP8'
[2026-01-26 10:38:14] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-FP8
[2026-01-26 10:38:14] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:38:14] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:38:14] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:38:14] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:38:14] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:38:14] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-FP8'
[2026-01-26 10:38:14] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 10:38:14] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 10:38:14] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 10:38:14] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 10:38:14] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 10:38:20] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 10:38:21] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-FP8'
[2026-01-26 10:38:21] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-FP8
[2026-01-26 10:38:21] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:38:21] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:38:21] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:38:21] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:38:21] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:38:21] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-FP8'
[2026-01-26 10:38:21] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 10:38:21] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 10:38:21] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 10:38:21] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 10:38:21] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1225930) [2026-01-26 10:38:23] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1225930) [2026-01-26 10:38:23] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1225930) [2026-01-26 10:38:23] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1225930) [2026-01-26 10:38:23] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1225930) [2026-01-26 10:38:23] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Llama3.2-3B-FP8
(EngineCore_DP0 pid=1225930) [2026-01-26 10:38:23] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1225930) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1225930) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.92it/s]
(EngineCore_DP0 pid=1225930) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.92it/s]
(EngineCore_DP0 pid=1225930) 
(EngineCore_DP0 pid=1225930) [2026-01-26 10:38:24] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 4608] -> 1D uint8
(EngineCore_DP0 pid=1225930) [2026-01-26 10:38:24] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 14745600 bytes
(EngineCore_DP0 pid=1225930) [2026-01-26 10:38:24] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 4608] -> 1D uint8
(EngineCore_DP0 pid=1225930) [2026-01-26 10:38:24] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 8847360 bytes
(EngineCore_DP0 pid=1225930) [2026-01-26 10:38:24] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [16384, 4608] -> 1D uint8
(EngineCore_DP0 pid=1225930) [2026-01-26 10:38:24] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 47185920 bytes
(EngineCore_DP0 pid=1225930) [2026-01-26 10:38:24] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 12288] -> 1D uint8
(EngineCore_DP0 pid=1225930) [2026-01-26 10:38:24] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 23592960 bytes
(EngineCore_DP0 pid=1225930) [rank0]:W0126 10:38:35.969000 1225930 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1225930) [rank0]:W0126 10:38:36.052000 1225930 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1225930) [rank0]:W0126 10:38:36.900000 1225930 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1225930) [rank0]:W0126 10:38:37.023000 1225930 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1225930) 2026-01-26 10:38:40,933 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1225930) 2026-01-26 10:38:40,960 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1225930) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  18%|█▊        | 2/11 [00:00<00:01,  4.83it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  27%|██▋       | 3/11 [00:00<00:02,  2.98it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  36%|███▋      | 4/11 [00:01<00:01,  3.99it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  45%|████▌     | 5/11 [00:01<00:01,  4.65it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  55%|█████▍    | 6/11 [00:01<00:00,  5.56it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  73%|███████▎  | 8/11 [00:01<00:00,  8.55it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  91%|█████████ | 10/11 [00:01<00:00, 11.10it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00,  7.01it/s]
(EngineCore_DP0 pid=1225930) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  29%|██▊       | 2/7 [00:00<00:00, 18.70it/s]
Capturing CUDA graphs (decode, FULL):  71%|███████▏  | 5/7 [00:00<00:00, 19.66it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00, 19.67it/s]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   1%|          | 32/4096 [00:00<00:12, 319.72it/s]
Adding requests:   2%|▏         | 82/4096 [00:00<00:09, 424.32it/s]
Adding requests:   3%|▎         | 132/4096 [00:00<00:08, 458.70it/s]
Adding requests:   4%|▍         | 180/4096 [00:00<00:08, 464.72it/s]
Adding requests:   6%|▌         | 229/4096 [00:00<00:08, 471.18it/s]
Adding requests:   7%|▋         | 280/4096 [00:00<00:07, 481.94it/s]
Adding requests:   8%|▊         | 330/4096 [00:00<00:07, 485.12it/s]
Adding requests:   9%|▉         | 382/4096 [00:00<00:07, 494.20it/s]
Adding requests:  11%|█         | 433/4096 [00:00<00:07, 498.31it/s]
Adding requests:  12%|█▏        | 484/4096 [00:01<00:07, 498.85it/s]
Adding requests:  13%|█▎        | 534/4096 [00:01<00:07, 487.25it/s]
Adding requests:  14%|█▍        | 586/4096 [00:01<00:07, 496.36it/s]
Adding requests:  16%|█▌        | 637/4096 [00:01<00:06, 497.60it/s]
Adding requests:  17%|█▋        | 689/4096 [00:01<00:06, 502.94it/s]
Adding requests:  18%|█▊        | 740/4096 [00:01<00:06, 504.08it/s]
Adding requests:  19%|█▉        | 791/4096 [00:01<00:06, 500.04it/s]
Adding requests:  21%|██        | 842/4096 [00:01<00:06, 486.59it/s]
Adding requests:  22%|██▏       | 894/4096 [00:01<00:06, 495.61it/s]
Adding requests:  23%|██▎       | 945/4096 [00:01<00:06, 498.40it/s]
Adding requests:  24%|██▍       | 996/4096 [00:02<00:06, 500.23it/s]
Adding requests:  26%|██▌       | 1048/4096 [00:02<00:06, 505.23it/s]
Adding requests:  27%|██▋       | 1099/4096 [00:02<00:06, 487.94it/s]
Adding requests:  28%|██▊       | 1148/4096 [00:02<00:06, 487.93it/s]
Adding requests:  29%|██▉       | 1202/4096 [00:02<00:05, 502.42it/s]
Adding requests:  31%|███       | 1253/4096 [00:02<00:05, 499.03it/s]
Adding requests:  32%|███▏      | 1304/4096 [00:02<00:05, 500.23it/s]
Adding requests:  33%|███▎      | 1356/4096 [00:02<00:05, 505.29it/s]
Adding requests:  34%|███▍      | 1409/4096 [00:02<00:05, 510.68it/s]
Adding requests:  36%|███▌      | 1461/4096 [00:02<00:05, 511.73it/s]
Adding requests:  37%|███▋      | 1513/4096 [00:03<00:05, 513.92it/s]
Adding requests:  38%|███▊      | 1565/4096 [00:03<00:04, 513.30it/s]
Adding requests:  40%|███▉      | 1618/4096 [00:03<00:04, 515.59it/s]
Adding requests:  41%|████      | 1670/4096 [00:03<00:04, 512.39it/s]
Adding requests:  42%|████▏     | 1722/4096 [00:03<00:04, 505.94it/s]
Adding requests:  43%|████▎     | 1773/4096 [00:03<00:04, 505.72it/s]
Adding requests:  45%|████▍     | 1825/4096 [00:03<00:04, 509.47it/s]
Adding requests:  46%|████▌     | 1876/4096 [00:03<00:04, 508.38it/s]
Adding requests:  47%|████▋     | 1928/4096 [00:03<00:04, 509.42it/s]
Adding requests:  48%|████▊     | 1980/4096 [00:03<00:04, 510.57it/s]
Adding requests:  50%|████▉     | 2033/4096 [00:04<00:04, 514.05it/s]
Adding requests:  51%|█████     | 2085/4096 [00:04<00:03, 514.37it/s]
Adding requests:  52%|█████▏    | 2137/4096 [00:04<00:03, 510.49it/s]
Adding requests:  53%|█████▎    | 2189/4096 [00:04<00:03, 504.35it/s]
Adding requests:  55%|█████▍    | 2242/4096 [00:04<00:03, 510.37it/s]
Adding requests:  56%|█████▌    | 2294/4096 [00:04<00:03, 493.12it/s]
Adding requests:  57%|█████▋    | 2345/4096 [00:04<00:03, 497.29it/s]
Adding requests:  58%|█████▊    | 2396/4096 [00:04<00:03, 499.51it/s]
Adding requests:  60%|█████▉    | 2447/4096 [00:04<00:03, 501.51it/s]
Adding requests:  61%|██████    | 2499/4096 [00:05<00:03, 506.52it/s]
Adding requests:  62%|██████▏   | 2550/4096 [00:05<00:03, 506.68it/s]
Adding requests:  64%|██████▎   | 2601/4096 [00:05<00:02, 507.55it/s]
Adding requests:  65%|██████▍   | 2653/4096 [00:05<00:02, 510.69it/s]
Adding requests:  66%|██████▌   | 2705/4096 [00:05<00:02, 507.38it/s]
Adding requests:  67%|██████▋   | 2756/4096 [00:05<00:02, 506.89it/s]
Adding requests:  69%|██████▊   | 2807/4096 [00:05<00:02, 506.73it/s]
Adding requests:  70%|██████▉   | 2858/4096 [00:05<00:02, 506.36it/s]
Adding requests:  71%|███████   | 2910/4096 [00:05<00:02, 510.24it/s]
Adding requests:  72%|███████▏  | 2962/4096 [00:05<00:02, 503.15it/s]
Adding requests:  74%|███████▎  | 3014/4096 [00:06<00:02, 505.75it/s]
Adding requests:  75%|███████▍  | 3065/4096 [00:06<00:02, 504.12it/s]
Adding requests:  76%|███████▌  | 3117/4096 [00:06<00:01, 508.19it/s]
Adding requests:  77%|███████▋  | 3168/4096 [00:06<00:01, 506.64it/s]
Adding requests:  79%|███████▊  | 3219/4096 [00:06<00:01, 505.82it/s]
Adding requests:  80%|███████▉  | 3271/4096 [00:06<00:01, 509.08it/s]
Adding requests:  81%|████████  | 3322/4096 [00:06<00:01, 507.64it/s]
Adding requests:  82%|████████▏ | 3374/4096 [00:06<00:01, 510.77it/s]
Adding requests:  84%|████████▎ | 3426/4096 [00:06<00:01, 512.52it/s]
Adding requests:  85%|████████▍ | 3478/4096 [00:06<00:01, 499.63it/s]
Adding requests:  86%|████████▌ | 3529/4096 [00:07<00:01, 499.50it/s]
Adding requests:  87%|████████▋ | 3580/4096 [00:07<00:01, 501.58it/s]
Adding requests:  89%|████████▊ | 3631/4096 [00:07<00:00, 485.51it/s]
Adding requests:  90%|████████▉ | 3682/4096 [00:07<00:00, 489.98it/s]
Adding requests:  91%|█████████ | 3733/4096 [00:07<00:00, 494.53it/s]
Adding requests:  92%|█████████▏| 3786/4096 [00:07<00:00, 504.33it/s]
Adding requests:  94%|█████████▎| 3838/4096 [00:07<00:00, 507.34it/s]
Adding requests:  95%|█████████▍| 3889/4096 [00:07<00:00, 505.36it/s]
Adding requests:  96%|█████████▌| 3940/4096 [00:07<00:00, 499.29it/s]
Adding requests:  97%|█████████▋| 3990/4096 [00:07<00:00, 499.49it/s]
Adding requests:  99%|█████████▊| 4042/4096 [00:08<00:00, 502.42it/s]
Adding requests: 100%|█████████▉| 4094/4096 [00:08<00:00, 505.76it/s]
Adding requests: 100%|██████████| 4096/4096 [00:08<00:00, 500.90it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  15%|█▌        | 629/4096 [00:00<00:02, 1365.80it/s, est. speed input: 1398648.55 toks/s, output: 1365.82 toks/s]
Processed prompts:  19%|█▊        | 766/4096 [00:02<00:11, 289.85it/s, est. speed input: 368281.72 toks/s, output: 359.65 toks/s]   
Processed prompts:  20%|██        | 828/4096 [00:02<00:15, 209.38it/s, est. speed input: 286273.14 toks/s, output: 279.56 toks/s]
Processed prompts:  21%|██        | 865/4096 [00:03<00:17, 183.89it/s, est. speed input: 262137.12 toks/s, output: 255.99 toks/s]
Processed prompts:  22%|██▏       | 891/4096 [00:03<00:20, 155.90it/s, est. speed input: 240474.01 toks/s, output: 234.84 toks/s]
Processed prompts:  22%|██▏       | 917/4096 [00:04<00:23, 133.26it/s, est. speed input: 223417.61 toks/s, output: 218.18 toks/s]
Processed prompts:  23%|██▎       | 949/4096 [00:04<00:26, 118.59it/s, est. speed input: 210467.38 toks/s, output: 205.53 toks/s]
Processed prompts:  24%|██▍       | 981/4096 [00:05<00:28, 107.80it/s, est. speed input: 199918.10 toks/s, output: 195.23 toks/s]
Processed prompts:  25%|██▍       | 1013/4096 [00:05<00:31, 99.27it/s, est. speed input: 190740.13 toks/s, output: 186.27 toks/s]
Processed prompts:  26%|██▌       | 1045/4096 [00:05<00:32, 93.02it/s, est. speed input: 182870.78 toks/s, output: 178.58 toks/s]
Processed prompts:  26%|██▋       | 1077/4096 [00:06<00:34, 88.29it/s, est. speed input: 175940.55 toks/s, output: 171.82 toks/s]
Processed prompts:  27%|██▋       | 1109/4096 [00:06<00:35, 85.13it/s, est. speed input: 169967.84 toks/s, output: 165.98 toks/s]
Processed prompts:  28%|██▊       | 1141/4096 [00:07<00:35, 83.22it/s, est. speed input: 164827.90 toks/s, output: 160.96 toks/s]
Processed prompts:  29%|██▊       | 1173/4096 [00:07<00:35, 81.39it/s, est. speed input: 160074.68 toks/s, output: 156.32 toks/s]
Processed prompts:  29%|██▉       | 1205/4096 [00:07<00:36, 80.16it/s, est. speed input: 155839.61 toks/s, output: 152.19 toks/s]
Processed prompts:  30%|███       | 1237/4096 [00:08<00:36, 79.24it/s, est. speed input: 152009.17 toks/s, output: 148.45 toks/s]
Processed prompts:  31%|███       | 1269/4096 [00:08<00:35, 78.57it/s, est. speed input: 148535.15 toks/s, output: 145.05 toks/s]
Processed prompts:  32%|███▏      | 1301/4096 [00:09<00:35, 78.04it/s, est. speed input: 145357.37 toks/s, output: 141.95 toks/s]
Processed prompts:  33%|███▎      | 1333/4096 [00:09<00:35, 77.80it/s, est. speed input: 142490.06 toks/s, output: 139.15 toks/s]
Processed prompts:  33%|███▎      | 1365/4096 [00:09<00:35, 77.60it/s, est. speed input: 139853.95 toks/s, output: 136.58 toks/s]
Processed prompts:  34%|███▍      | 1397/4096 [00:10<00:34, 77.37it/s, est. speed input: 137407.03 toks/s, output: 134.19 toks/s]
Processed prompts:  35%|███▍      | 1429/4096 [00:10<00:34, 77.24it/s, est. speed input: 135155.46 toks/s, output: 131.99 toks/s]
Processed prompts:  36%|███▌      | 1461/4096 [00:11<00:34, 77.13it/s, est. speed input: 133066.26 toks/s, output: 129.95 toks/s]
Processed prompts:  36%|███▋      | 1493/4096 [00:11<00:33, 77.23it/s, est. speed input: 131161.82 toks/s, output: 128.09 toks/s]
Processed prompts:  37%|███▋      | 1525/4096 [00:12<00:33, 77.08it/s, est. speed input: 129344.47 toks/s, output: 126.31 toks/s]
Processed prompts:  38%|███▊      | 1557/4096 [00:12<00:32, 76.99it/s, est. speed input: 127652.58 toks/s, output: 124.66 toks/s]
Processed prompts:  39%|███▉      | 1589/4096 [00:12<00:32, 76.97it/s, est. speed input: 126076.10 toks/s, output: 123.12 toks/s]
Processed prompts:  40%|███▉      | 1621/4096 [00:13<00:32, 76.92it/s, est. speed input: 124593.93 toks/s, output: 121.67 toks/s]
Processed prompts:  40%|████      | 1653/4096 [00:13<00:31, 77.04it/s, est. speed input: 123224.97 toks/s, output: 120.34 toks/s]
Processed prompts:  41%|████      | 1685/4096 [00:14<00:31, 76.95it/s, est. speed input: 121909.60 toks/s, output: 119.05 toks/s]
Processed prompts:  42%|████▏     | 1717/4096 [00:14<00:30, 76.95it/s, est. speed input: 120679.04 toks/s, output: 117.85 toks/s]
Processed prompts:  43%|████▎     | 1749/4096 [00:14<00:30, 76.88it/s, est. speed input: 119507.11 toks/s, output: 116.71 toks/s]
Processed prompts:  43%|████▎     | 1781/4096 [00:15<00:30, 76.85it/s, est. speed input: 118400.64 toks/s, output: 115.63 toks/s]
Processed prompts:  44%|████▍     | 1813/4096 [00:15<00:29, 76.93it/s, est. speed input: 117365.66 toks/s, output: 114.61 toks/s]
Processed prompts:  45%|████▌     | 1845/4096 [00:16<00:29, 76.85it/s, est. speed input: 116367.50 toks/s, output: 113.64 toks/s]
Processed prompts:  46%|████▌     | 1877/4096 [00:16<00:28, 77.53it/s, est. speed input: 115510.01 toks/s, output: 112.80 toks/s]
Processed prompts:  47%|████▋     | 1909/4096 [00:17<00:28, 77.23it/s, est. speed input: 114599.37 toks/s, output: 111.91 toks/s]
Processed prompts:  47%|████▋     | 1941/4096 [00:17<00:27, 77.61it/s, est. speed input: 113801.70 toks/s, output: 111.13 toks/s]
Processed prompts:  48%|████▊     | 1973/4096 [00:17<00:27, 77.43it/s, est. speed input: 112989.19 toks/s, output: 110.34 toks/s]
Processed prompts:  49%|████▉     | 2005/4096 [00:18<00:27, 77.14it/s, est. speed input: 112196.44 toks/s, output: 109.57 toks/s]
Processed prompts:  50%|████▉     | 2037/4096 [00:18<00:26, 77.04it/s, est. speed input: 111449.23 toks/s, output: 108.84 toks/s]
Processed prompts:  51%|█████     | 2069/4096 [00:19<00:26, 76.89it/s, est. speed input: 110726.95 toks/s, output: 108.13 toks/s]
Processed prompts:  51%|█████▏    | 2101/4096 [00:19<00:25, 76.81it/s, est. speed input: 110037.79 toks/s, output: 107.46 toks/s]
Processed prompts:  52%|█████▏    | 2133/4096 [00:19<00:25, 76.68it/s, est. speed input: 109370.20 toks/s, output: 106.81 toks/s]
Processed prompts:  53%|█████▎    | 2165/4096 [00:20<00:25, 76.67it/s, est. speed input: 108737.91 toks/s, output: 106.19 toks/s]
Processed prompts:  54%|█████▎    | 2197/4096 [00:20<00:24, 76.69it/s, est. speed input: 108133.50 toks/s, output: 105.60 toks/s]
Processed prompts:  54%|█████▍    | 2229/4096 [00:21<00:23, 78.02it/s, est. speed input: 107672.07 toks/s, output: 105.15 toks/s]
Processed prompts:  55%|█████▌    | 2261/4096 [00:21<00:23, 77.60it/s, est. speed input: 107107.69 toks/s, output: 104.60 toks/s]
Processed prompts:  56%|█████▌    | 2293/4096 [00:22<00:23, 77.81it/s, est. speed input: 106608.18 toks/s, output: 104.11 toks/s]
Processed prompts:  57%|█████▋    | 2325/4096 [00:22<00:22, 78.15it/s, est. speed input: 106142.57 toks/s, output: 103.65 toks/s]
Processed prompts:  58%|█████▊    | 2357/4096 [00:22<00:22, 77.72it/s, est. speed input: 105639.82 toks/s, output: 103.16 toks/s]
Processed prompts:  58%|█████▊    | 2389/4096 [00:23<00:22, 77.44it/s, est. speed input: 105156.14 toks/s, output: 102.69 toks/s]
Processed prompts:  59%|█████▉    | 2421/4096 [00:23<00:21, 77.32it/s, est. speed input: 104695.51 toks/s, output: 102.24 toks/s]
Processed prompts:  60%|█████▉    | 2453/4096 [00:24<00:21, 77.10it/s, est. speed input: 104239.90 toks/s, output: 101.80 toks/s]
Processed prompts:  61%|██████    | 2485/4096 [00:24<00:20, 77.54it/s, est. speed input: 103845.22 toks/s, output: 101.41 toks/s]
Processed prompts:  61%|██████▏   | 2517/4096 [00:24<00:20, 77.33it/s, est. speed input: 103425.03 toks/s, output: 101.00 toks/s]
Processed prompts:  62%|██████▏   | 2549/4096 [00:25<00:20, 77.14it/s, est. speed input: 103015.35 toks/s, output: 100.60 toks/s]
Processed prompts:  63%|██████▎   | 2581/4096 [00:25<00:19, 77.55it/s, est. speed input: 102657.62 toks/s, output: 100.25 toks/s]
Processed prompts:  64%|██████▍   | 2613/4096 [00:26<00:19, 77.31it/s, est. speed input: 102273.72 toks/s, output: 99.88 toks/s] 
Processed prompts:  65%|██████▍   | 2645/4096 [00:26<00:18, 77.25it/s, est. speed input: 101909.66 toks/s, output: 99.52 toks/s]
Processed prompts:  65%|██████▌   | 2677/4096 [00:26<00:18, 77.00it/s, est. speed input: 101542.99 toks/s, output: 99.16 toks/s]
Processed prompts:  66%|██████▌   | 2709/4096 [00:27<00:18, 76.91it/s, est. speed input: 101192.79 toks/s, output: 98.82 toks/s]
Processed prompts:  67%|██████▋   | 2741/4096 [00:27<00:17, 76.75it/s, est. speed input: 100846.80 toks/s, output: 98.48 toks/s]
Processed prompts:  68%|██████▊   | 2773/4096 [00:28<00:17, 76.61it/s, est. speed input: 100509.72 toks/s, output: 98.15 toks/s]
Processed prompts:  68%|██████▊   | 2805/4096 [00:28<00:16, 76.58it/s, est. speed input: 100186.15 toks/s, output: 97.84 toks/s]
Processed prompts:  69%|██████▉   | 2837/4096 [00:29<00:16, 76.55it/s, est. speed input: 99871.46 toks/s, output: 97.53 toks/s] 
Processed prompts:  70%|███████   | 2869/4096 [00:29<00:16, 76.47it/s, est. speed input: 99562.03 toks/s, output: 97.23 toks/s]
Processed prompts:  71%|███████   | 2901/4096 [00:29<00:15, 76.50it/s, est. speed input: 99266.86 toks/s, output: 96.94 toks/s]
Processed prompts:  72%|███████▏  | 2933/4096 [00:30<00:15, 76.58it/s, est. speed input: 98983.13 toks/s, output: 96.66 toks/s]
Processed prompts:  72%|███████▏  | 2965/4096 [00:30<00:14, 76.50it/s, est. speed input: 98698.71 toks/s, output: 96.39 toks/s]
Processed prompts:  73%|███████▎  | 2997/4096 [00:31<00:14, 76.54it/s, est. speed input: 98427.76 toks/s, output: 96.12 toks/s]
Processed prompts:  74%|███████▍  | 3029/4096 [00:31<00:13, 76.49it/s, est. speed input: 98159.54 toks/s, output: 95.86 toks/s]
Processed prompts:  75%|███████▍  | 3061/4096 [00:32<00:13, 76.51it/s, est. speed input: 97901.48 toks/s, output: 95.61 toks/s]
Processed prompts:  76%|███████▌  | 3093/4096 [00:32<00:13, 76.42it/s, est. speed input: 97644.52 toks/s, output: 95.36 toks/s]
Processed prompts:  76%|███████▋  | 3125/4096 [00:32<00:12, 76.95it/s, est. speed input: 97425.82 toks/s, output: 95.14 toks/s]
Processed prompts:  77%|███████▋  | 3157/4096 [00:33<00:12, 76.89it/s, est. speed input: 97190.05 toks/s, output: 94.91 toks/s]
Processed prompts:  78%|███████▊  | 3189/4096 [00:33<00:11, 76.82it/s, est. speed input: 96958.12 toks/s, output: 94.69 toks/s]
Processed prompts:  79%|███████▊  | 3221/4096 [00:34<00:11, 76.74it/s, est. speed input: 96730.72 toks/s, output: 94.46 toks/s]
Processed prompts:  79%|███████▉  | 3253/4096 [00:34<00:11, 76.62it/s, est. speed input: 96505.48 toks/s, output: 94.24 toks/s]
Processed prompts:  80%|████████  | 3285/4096 [00:34<00:10, 76.53it/s, est. speed input: 96284.83 toks/s, output: 94.03 toks/s]
Processed prompts:  81%|████████  | 3317/4096 [00:35<00:10, 76.55it/s, est. speed input: 96074.16 toks/s, output: 93.82 toks/s]
Processed prompts:  82%|████████▏ | 3349/4096 [00:35<00:09, 76.42it/s, est. speed input: 95861.17 toks/s, output: 93.61 toks/s]
Processed prompts:  83%|████████▎ | 3381/4096 [00:36<00:09, 76.43it/s, est. speed input: 95657.91 toks/s, output: 93.42 toks/s]
Processed prompts:  83%|████████▎ | 3413/4096 [00:36<00:08, 76.35it/s, est. speed input: 95455.33 toks/s, output: 93.22 toks/s]
Processed prompts:  84%|████████▍ | 3445/4096 [00:37<00:08, 76.25it/s, est. speed input: 95255.14 toks/s, output: 93.02 toks/s]
Processed prompts:  85%|████████▍ | 3477/4096 [00:37<00:08, 76.28it/s, est. speed input: 95063.86 toks/s, output: 92.84 toks/s]
Processed prompts:  86%|████████▌ | 3509/4096 [00:37<00:07, 76.26it/s, est. speed input: 94875.08 toks/s, output: 92.65 toks/s]
Processed prompts:  86%|████████▋ | 3541/4096 [00:38<00:07, 76.26it/s, est. speed input: 94691.15 toks/s, output: 92.47 toks/s]
Processed prompts:  87%|████████▋ | 3573/4096 [00:38<00:06, 76.19it/s, est. speed input: 94508.24 toks/s, output: 92.29 toks/s]
Processed prompts:  88%|████████▊ | 3605/4096 [00:39<00:06, 76.21it/s, est. speed input: 94332.10 toks/s, output: 92.12 toks/s]
Processed prompts:  89%|████████▉ | 3637/4096 [00:39<00:06, 76.22it/s, est. speed input: 94159.65 toks/s, output: 91.95 toks/s]
Processed prompts:  90%|████████▉ | 3669/4096 [00:39<00:05, 76.20it/s, est. speed input: 93989.65 toks/s, output: 91.79 toks/s]
Processed prompts:  90%|█████████ | 3701/4096 [00:40<00:05, 76.18it/s, est. speed input: 93822.73 toks/s, output: 91.62 toks/s]
Processed prompts:  91%|█████████ | 3733/4096 [00:40<00:04, 76.74it/s, est. speed input: 93683.51 toks/s, output: 91.49 toks/s]
Processed prompts:  92%|█████████▏| 3765/4096 [00:41<00:04, 76.64it/s, est. speed input: 93526.37 toks/s, output: 91.33 toks/s]
Processed prompts:  93%|█████████▎| 3797/4096 [00:41<00:03, 76.57it/s, est. speed input: 93372.71 toks/s, output: 91.18 toks/s]
Processed prompts:  93%|█████████▎| 3829/4096 [00:42<00:03, 76.50it/s, est. speed input: 93221.18 toks/s, output: 91.04 toks/s]
Processed prompts:  94%|█████████▍| 3861/4096 [00:42<00:03, 76.48it/s, est. speed input: 93073.91 toks/s, output: 90.89 toks/s]
Processed prompts:  95%|█████████▌| 3893/4096 [00:42<00:02, 76.34it/s, est. speed input: 92924.40 toks/s, output: 90.75 toks/s]
Processed prompts:  96%|█████████▌| 3925/4096 [00:43<00:02, 76.31it/s, est. speed input: 92780.57 toks/s, output: 90.61 toks/s]
Processed prompts:  97%|█████████▋| 3957/4096 [00:43<00:01, 76.30it/s, est. speed input: 92639.67 toks/s, output: 90.47 toks/s]
Processed prompts:  97%|█████████▋| 3989/4096 [00:44<00:01, 76.27it/s, est. speed input: 92500.73 toks/s, output: 90.33 toks/s]
Processed prompts:  98%|█████████▊| 4021/4096 [00:44<00:00, 76.84it/s, est. speed input: 92386.56 toks/s, output: 90.22 toks/s]
Processed prompts:  99%|█████████▉| 4053/4096 [00:44<00:00, 76.73it/s, est. speed input: 92255.57 toks/s, output: 90.09 toks/s]
Processed prompts: 100%|█████████▉| 4085/4096 [00:45<00:00, 94.04it/s, est. speed input: 92652.09 toks/s, output: 90.48 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [00:45<00:00, 94.04it/s, est. speed input: 92900.45 toks/s, output: 90.72 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [00:45<00:00, 90.72it/s, est. speed input: 92900.45 toks/s, output: 90.72 toks/s]
[rank0]:[W126 10:39:38.258823646 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=65536 ==========
Time: 2026-01-26 10:39:40
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-FP8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=8192, max_num_seqs=64
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-FP8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 8192 --max-num-seqs 64 --max-model-len 1025 --max-num-batched-tokens 65536 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_FP8E4M3_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-3B-FP8_M65536.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 10:40:22 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1228115) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1228115) WARNING 01-26 10:40:39 [backends.py:609] Failed to read file <frozen os>
Throughput: 77.06 requests/s, 78990.53 total tokens/s, 77.06 output tokens/s
Total num prompt tokens:  8388608
Total num output tokens:  8192

STDERR:
[2026-01-26 10:40:21] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 10:40:22] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-FP8'
[2026-01-26 10:40:22] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-FP8
[2026-01-26 10:40:22] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:40:22] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:40:22] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:40:22] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:40:22] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:40:22] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-FP8'
[2026-01-26 10:40:22] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 10:40:22] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 10:40:22] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 10:40:22] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 10:40:22] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 10:40:28] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 10:40:30] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-FP8'
[2026-01-26 10:40:30] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-FP8
[2026-01-26 10:40:30] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:40:30] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:40:30] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:40:30] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:40:30] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-FP8
[2026-01-26 10:40:30] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-FP8'
[2026-01-26 10:40:30] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 10:40:30] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 10:40:30] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 10:40:30] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 10:40:30] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1228115) [2026-01-26 10:40:31] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1228115) [2026-01-26 10:40:31] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1228115) [2026-01-26 10:40:31] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1228115) [2026-01-26 10:40:31] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1228115) [2026-01-26 10:40:31] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Llama3.2-3B-FP8
(EngineCore_DP0 pid=1228115) [2026-01-26 10:40:31] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1228115) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1228115) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.92it/s]
(EngineCore_DP0 pid=1228115) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.92it/s]
(EngineCore_DP0 pid=1228115) 
(EngineCore_DP0 pid=1228115) [2026-01-26 10:40:33] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 4608] -> 1D uint8
(EngineCore_DP0 pid=1228115) [2026-01-26 10:40:33] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 14745600 bytes
(EngineCore_DP0 pid=1228115) [2026-01-26 10:40:33] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 4608] -> 1D uint8
(EngineCore_DP0 pid=1228115) [2026-01-26 10:40:33] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 8847360 bytes
(EngineCore_DP0 pid=1228115) [2026-01-26 10:40:33] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [16384, 4608] -> 1D uint8
(EngineCore_DP0 pid=1228115) [2026-01-26 10:40:33] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 47185920 bytes
(EngineCore_DP0 pid=1228115) [2026-01-26 10:40:33] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3072, 12288] -> 1D uint8
(EngineCore_DP0 pid=1228115) [2026-01-26 10:40:33] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 23592960 bytes
(EngineCore_DP0 pid=1228115) [rank0]:W0126 10:40:45.145000 1228115 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=1228115) [rank0]:W0126 10:40:45.229000 1228115 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=1228115) [rank0]:W0126 10:40:46.076000 1228115 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=1228115) [rank0]:W0126 10:40:46.200000 1228115 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=1228115) 2026-01-26 10:40:50,224 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1228115) 2026-01-26 10:40:50,251 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1228115) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/19 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   5%|▌         | 1/19 [00:00<00:17,  1.06it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  11%|█         | 2/19 [00:01<00:10,  1.66it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  21%|██        | 4/19 [00:01<00:03,  3.89it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  32%|███▏      | 6/19 [00:01<00:02,  6.23it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  42%|████▏     | 8/19 [00:01<00:01,  8.54it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  53%|█████▎    | 10/19 [00:01<00:00, 10.23it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  63%|██████▎   | 12/19 [00:01<00:00, 12.21it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  74%|███████▎  | 14/19 [00:02<00:00,  7.57it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  84%|████████▍ | 16/19 [00:02<00:00,  5.84it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  95%|█████████▍| 18/19 [00:02<00:00,  7.48it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 19/19 [00:03<00:00,  6.33it/s]
(EngineCore_DP0 pid=1228115) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  18%|█▊        | 2/11 [00:00<00:00,  9.36it/s]
Capturing CUDA graphs (decode, FULL):  36%|███▋      | 4/11 [00:00<00:00, 12.41it/s]
Capturing CUDA graphs (decode, FULL):  64%|██████▎   | 7/11 [00:00<00:00, 11.95it/s]
Capturing CUDA graphs (decode, FULL):  82%|████████▏ | 9/11 [00:00<00:00,  9.85it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 11/11 [00:01<00:00,  5.88it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 11/11 [00:01<00:00,  7.41it/s]

Adding requests:   0%|          | 0/8192 [00:00<?, ?it/s]
Adding requests:   0%|          | 40/8192 [00:00<00:20, 392.59it/s]
Adding requests:   1%|          | 90/8192 [00:00<00:17, 454.88it/s]
Adding requests:   2%|▏         | 139/8192 [00:00<00:17, 467.60it/s]
Adding requests:   2%|▏         | 186/8192 [00:00<00:17, 468.43it/s]
Adding requests:   3%|▎         | 236/8192 [00:00<00:16, 477.31it/s]
Adding requests:   3%|▎         | 286/8192 [00:00<00:16, 482.56it/s]
Adding requests:   4%|▍         | 335/8192 [00:00<00:16, 478.80it/s]
Adding requests:   5%|▍         | 385/8192 [00:00<00:16, 485.24it/s]
Adding requests:   5%|▌         | 435/8192 [00:00<00:15, 488.76it/s]
Adding requests:   6%|▌         | 486/8192 [00:01<00:15, 494.10it/s]
Adding requests:   7%|▋         | 536/8192 [00:01<00:15, 482.15it/s]
Adding requests:   7%|▋         | 588/8192 [00:01<00:15, 492.43it/s]
Adding requests:   8%|▊         | 638/8192 [00:01<00:15, 486.09it/s]
Adding requests:   8%|▊         | 690/8192 [00:01<00:15, 494.51it/s]
Adding requests:   9%|▉         | 741/8192 [00:01<00:15, 495.23it/s]
Adding requests:  10%|▉         | 791/8192 [00:01<00:14, 494.52it/s]
Adding requests:  10%|█         | 841/8192 [00:01<00:15, 485.60it/s]
Adding requests:  11%|█         | 893/8192 [00:01<00:14, 492.67it/s]
Adding requests:  12%|█▏        | 943/8192 [00:01<00:14, 493.82it/s]
Adding requests:  12%|█▏        | 994/8192 [00:02<00:14, 496.14it/s]
Adding requests:  13%|█▎        | 1045/8192 [00:02<00:14, 498.41it/s]
Adding requests:  13%|█▎        | 1095/8192 [00:02<00:14, 494.98it/s]
Adding requests:  14%|█▍        | 1145/8192 [00:02<00:14, 489.69it/s]
Adding requests:  15%|█▍        | 1197/8192 [00:02<00:14, 496.98it/s]
Adding requests:  15%|█▌        | 1247/8192 [00:02<00:14, 495.88it/s]
Adding requests:  16%|█▌        | 1297/8192 [00:02<00:13, 494.58it/s]
Adding requests:  16%|█▋        | 1349/8192 [00:02<00:13, 499.95it/s]
Adding requests:  17%|█▋        | 1401/8192 [00:02<00:13, 502.76it/s]
Adding requests:  18%|█▊        | 1452/8192 [00:02<00:13, 503.13it/s]
Adding requests:  18%|█▊        | 1504/8192 [00:03<00:13, 506.16it/s]
Adding requests:  19%|█▉        | 1555/8192 [00:03<00:13, 504.45it/s]
Adding requests:  20%|█▉        | 1608/8192 [00:03<00:12, 510.15it/s]
Adding requests:  20%|██        | 1660/8192 [00:03<00:12, 507.05it/s]
Adding requests:  21%|██        | 1711/8192 [00:03<00:12, 505.41it/s]
Adding requests:  22%|██▏       | 1762/8192 [00:03<00:13, 492.67it/s]
Adding requests:  22%|██▏       | 1812/8192 [00:03<00:12, 490.99it/s]
Adding requests:  23%|██▎       | 1862/8192 [00:03<00:12, 491.90it/s]
Adding requests:  23%|██▎       | 1913/8192 [00:03<00:12, 494.97it/s]
Adding requests:  24%|██▍       | 1964/8192 [00:03<00:12, 497.30it/s]
Adding requests:  25%|██▍       | 2016/8192 [00:04<00:12, 501.20it/s]
Adding requests:  25%|██▌       | 2068/8192 [00:04<00:12, 503.96it/s]
Adding requests:  26%|██▌       | 2119/8192 [00:04<00:12, 503.74it/s]
Adding requests:  26%|██▋       | 2170/8192 [00:04<00:12, 497.26it/s]
Adding requests:  27%|██▋       | 2220/8192 [00:04<00:12, 497.40it/s]
Adding requests:  28%|██▊       | 2271/8192 [00:04<00:11, 499.61it/s]
Adding requests:  28%|██▊       | 2323/8192 [00:04<00:11, 502.85it/s]
Adding requests:  29%|██▉       | 2374/8192 [00:04<00:11, 502.78it/s]
Adding requests:  30%|██▉       | 2425/8192 [00:04<00:11, 503.89it/s]
Adding requests:  30%|███       | 2476/8192 [00:05<00:11, 503.39it/s]
Adding requests:  31%|███       | 2527/8192 [00:05<00:11, 500.77it/s]
Adding requests:  31%|███▏      | 2580/8192 [00:05<00:11, 507.33it/s]
Adding requests:  32%|███▏      | 2631/8192 [00:05<00:11, 504.41it/s]
Adding requests:  33%|███▎      | 2682/8192 [00:05<00:10, 504.46it/s]
Adding requests:  33%|███▎      | 2733/8192 [00:05<00:10, 502.15it/s]
Adding requests:  34%|███▍      | 2784/8192 [00:05<00:10, 502.39it/s]
Adding requests:  35%|███▍      | 2835/8192 [00:05<00:10, 499.13it/s]
Adding requests:  35%|███▌      | 2887/8192 [00:05<00:10, 503.94it/s]
Adding requests:  36%|███▌      | 2938/8192 [00:05<00:10, 499.69it/s]
Adding requests:  36%|███▋      | 2990/8192 [00:06<00:10, 503.09it/s]
Adding requests:  37%|███▋      | 3041/8192 [00:06<00:10, 502.05it/s]
Adding requests:  38%|███▊      | 3092/8192 [00:06<00:10, 482.49it/s]
Adding requests:  38%|███▊      | 3143/8192 [00:06<00:10, 486.19it/s]
Adding requests:  39%|███▉      | 3194/8192 [00:06<00:10, 491.63it/s]
Adding requests:  40%|███▉      | 3246/8192 [00:06<00:09, 497.40it/s]
Adding requests:  40%|████      | 3297/8192 [00:06<00:09, 499.71it/s]
Adding requests:  41%|████      | 3349/8192 [00:06<00:09, 504.39it/s]
Adding requests:  42%|████▏     | 3400/8192 [00:06<00:09, 504.05it/s]
Adding requests:  42%|████▏     | 3451/8192 [00:06<00:09, 503.67it/s]
Adding requests:  43%|████▎     | 3502/8192 [00:07<00:09, 500.41it/s]
Adding requests:  43%|████▎     | 3553/8192 [00:07<00:09, 501.94it/s]
Adding requests:  44%|████▍     | 3604/8192 [00:07<00:09, 500.33it/s]
Adding requests:  45%|████▍     | 3655/8192 [00:07<00:09, 497.75it/s]
Adding requests:  45%|████▌     | 3707/8192 [00:07<00:08, 503.06it/s]
Adding requests:  46%|████▌     | 3758/8192 [00:07<00:08, 500.76it/s]
Adding requests:  47%|████▋     | 3810/8192 [00:07<00:08, 506.32it/s]
Adding requests:  47%|████▋     | 3862/8192 [00:07<00:08, 509.86it/s]
Adding requests:  48%|████▊     | 3914/8192 [00:07<00:08, 506.39it/s]
Adding requests:  48%|████▊     | 3966/8192 [00:07<00:08, 507.81it/s]
Adding requests:  49%|████▉     | 4017/8192 [00:08<00:08, 506.24it/s]
Adding requests:  50%|████▉     | 4068/8192 [00:08<00:08, 501.39it/s]
Adding requests:  50%|█████     | 4119/8192 [00:08<00:08, 503.04it/s]
Adding requests:  51%|█████     | 4170/8192 [00:08<00:07, 504.61it/s]
Adding requests:  52%|█████▏    | 4222/8192 [00:08<00:07, 506.19it/s]
Adding requests:  52%|█████▏    | 4273/8192 [00:08<00:07, 506.01it/s]
Adding requests:  53%|█████▎    | 4325/8192 [00:08<00:07, 508.22it/s]
Adding requests:  53%|█████▎    | 4378/8192 [00:08<00:07, 512.63it/s]
Adding requests:  54%|█████▍    | 4430/8192 [00:08<00:07, 492.10it/s]
Adding requests:  55%|█████▍    | 4481/8192 [00:09<00:07, 494.86it/s]
Adding requests:  55%|█████▌    | 4531/8192 [00:09<00:07, 494.23it/s]
Adding requests:  56%|█████▌    | 4582/8192 [00:09<00:07, 497.54it/s]
Adding requests:  57%|█████▋    | 4634/8192 [00:09<00:07, 503.05it/s]
Adding requests:  57%|█████▋    | 4685/8192 [00:09<00:07, 500.80it/s]
Adding requests:  58%|█████▊    | 4737/8192 [00:09<00:06, 504.68it/s]
Adding requests:  58%|█████▊    | 4788/8192 [00:09<00:06, 503.66it/s]
Adding requests:  59%|█████▉    | 4839/8192 [00:09<00:06, 504.64it/s]
Adding requests:  60%|█████▉    | 4890/8192 [00:09<00:06, 501.12it/s]
Adding requests:  60%|██████    | 4941/8192 [00:09<00:06, 502.99it/s]
Adding requests:  61%|██████    | 4992/8192 [00:10<00:06, 503.03it/s]
Adding requests:  62%|██████▏   | 5044/8192 [00:10<00:06, 507.84it/s]
Adding requests:  62%|██████▏   | 5096/8192 [00:10<00:06, 511.22it/s]
Adding requests:  63%|██████▎   | 5148/8192 [00:10<00:05, 509.85it/s]
Adding requests:  63%|██████▎   | 5200/8192 [00:10<00:05, 510.61it/s]
Adding requests:  64%|██████▍   | 5252/8192 [00:10<00:05, 503.96it/s]
Adding requests:  65%|██████▍   | 5304/8192 [00:10<00:05, 507.24it/s]
Adding requests:  65%|██████▌   | 5356/8192 [00:10<00:05, 508.23it/s]
Adding requests:  66%|██████▌   | 5407/8192 [00:10<00:05, 507.69it/s]
Adding requests:  67%|██████▋   | 5458/8192 [00:10<00:05, 504.96it/s]
Adding requests:  67%|██████▋   | 5509/8192 [00:11<00:05, 499.34it/s]
Adding requests:  68%|██████▊   | 5559/8192 [00:11<00:05, 499.14it/s]
Adding requests:  68%|██████▊   | 5610/8192 [00:11<00:05, 500.82it/s]
Adding requests:  69%|██████▉   | 5661/8192 [00:11<00:05, 495.90it/s]
Adding requests:  70%|██████▉   | 5713/8192 [00:11<00:04, 500.77it/s]
Adding requests:  70%|███████   | 5764/8192 [00:11<00:04, 490.07it/s]
Adding requests:  71%|███████   | 5814/8192 [00:11<00:04, 485.25it/s]
Adding requests:  72%|███████▏  | 5865/8192 [00:11<00:04, 492.14it/s]
Adding requests:  72%|███████▏  | 5917/8192 [00:11<00:04, 498.18it/s]
Adding requests:  73%|███████▎  | 5968/8192 [00:11<00:04, 499.11it/s]
Adding requests:  73%|███████▎  | 6020/8192 [00:12<00:04, 503.66it/s]
Adding requests:  74%|███████▍  | 6072/8192 [00:12<00:04, 506.38it/s]
Adding requests:  75%|███████▍  | 6123/8192 [00:12<00:04, 505.64it/s]
Adding requests:  75%|███████▌  | 6174/8192 [00:12<00:03, 505.11it/s]
Adding requests:  76%|███████▌  | 6227/8192 [00:12<00:03, 512.08it/s]
Adding requests:  77%|███████▋  | 6280/8192 [00:12<00:03, 514.41it/s]
Adding requests:  77%|███████▋  | 6332/8192 [00:12<00:03, 515.86it/s]
Adding requests:  78%|███████▊  | 6384/8192 [00:12<00:03, 513.66it/s]
Adding requests:  79%|███████▊  | 6438/8192 [00:12<00:03, 518.40it/s]
Adding requests:  79%|███████▉  | 6490/8192 [00:12<00:03, 517.49it/s]
Adding requests:  80%|███████▉  | 6542/8192 [00:13<00:03, 518.06it/s]
Adding requests:  80%|████████  | 6594/8192 [00:13<00:03, 513.11it/s]
Adding requests:  81%|████████  | 6646/8192 [00:13<00:03, 513.56it/s]
Adding requests:  82%|████████▏ | 6698/8192 [00:13<00:02, 511.64it/s]
Adding requests:  82%|████████▏ | 6750/8192 [00:13<00:02, 509.35it/s]
Adding requests:  83%|████████▎ | 6802/8192 [00:13<00:02, 510.93it/s]
Adding requests:  84%|████████▎ | 6854/8192 [00:13<00:02, 511.95it/s]
Adding requests:  84%|████████▍ | 6907/8192 [00:13<00:02, 515.06it/s]
Adding requests:  85%|████████▍ | 6959/8192 [00:13<00:02, 515.89it/s]
Adding requests:  86%|████████▌ | 7011/8192 [00:14<00:02, 512.26it/s]
Adding requests:  86%|████████▌ | 7063/8192 [00:14<00:02, 509.30it/s]
Adding requests:  87%|████████▋ | 7114/8192 [00:14<00:02, 495.59it/s]
Adding requests:  87%|████████▋ | 7164/8192 [00:14<00:02, 491.49it/s]
Adding requests:  88%|████████▊ | 7215/8192 [00:14<00:01, 496.02it/s]
Adding requests:  89%|████████▊ | 7267/8192 [00:14<00:01, 499.89it/s]
Adding requests:  89%|████████▉ | 7319/8192 [00:14<00:01, 503.32it/s]
Adding requests:  90%|████████▉ | 7370/8192 [00:14<00:01, 501.96it/s]
Adding requests:  91%|█████████ | 7423/8192 [00:14<00:01, 510.15it/s]
Adding requests:  91%|█████████▏| 7476/8192 [00:14<00:01, 512.14it/s]
Adding requests:  92%|█████████▏| 7528/8192 [00:15<00:01, 511.66it/s]
Adding requests:  93%|█████████▎| 7580/8192 [00:15<00:01, 508.38it/s]
Adding requests:  93%|█████████▎| 7631/8192 [00:15<00:01, 506.46it/s]
Adding requests:  94%|█████████▍| 7684/8192 [00:15<00:00, 512.20it/s]
Adding requests:  94%|█████████▍| 7736/8192 [00:15<00:00, 510.27it/s]
Adding requests:  95%|█████████▌| 7788/8192 [00:15<00:00, 504.75it/s]
Adding requests:  96%|█████████▌| 7840/8192 [00:15<00:00, 508.36it/s]
Adding requests:  96%|█████████▋| 7891/8192 [00:15<00:00, 508.54it/s]
Adding requests:  97%|█████████▋| 7942/8192 [00:15<00:00, 503.09it/s]
Adding requests:  98%|█████████▊| 7993/8192 [00:15<00:00, 503.12it/s]
Adding requests:  98%|█████████▊| 8044/8192 [00:16<00:00, 499.91it/s]
Adding requests:  99%|█████████▉| 8096/8192 [00:16<00:00, 505.66it/s]
Adding requests:  99%|█████████▉| 8147/8192 [00:16<00:00, 505.88it/s]
Adding requests: 100%|██████████| 8192/8192 [00:16<00:00, 501.37it/s]

Processed prompts:   0%|          | 0/8192 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  15%|█▌        | 1243/8192 [00:00<00:03, 1814.89it/s, est. speed input: 1858511.95 toks/s, output: 1814.91 toks/s]
Processed prompts:  17%|█▋        | 1425/8192 [00:02<00:13, 495.34it/s, est. speed input: 626417.00 toks/s, output: 611.73 toks/s]   
Processed prompts:  18%|█▊        | 1507/8192 [00:03<00:25, 261.69it/s, est. speed input: 388680.18 toks/s, output: 379.57 toks/s]
Processed prompts:  19%|█▉        | 1563/8192 [00:04<00:31, 208.83it/s, est. speed input: 333960.82 toks/s, output: 326.13 toks/s]
Processed prompts:  20%|█▉        | 1627/8192 [00:05<00:38, 172.00it/s, est. speed input: 296653.59 toks/s, output: 289.70 toks/s]
Processed prompts:  21%|██        | 1691/8192 [00:06<00:44, 145.07it/s, est. speed input: 268957.04 toks/s, output: 262.65 toks/s]
Processed prompts:  21%|██▏       | 1755/8192 [00:07<00:51, 125.56it/s, est. speed input: 247517.80 toks/s, output: 241.72 toks/s]
Processed prompts:  22%|██▏       | 1819/8192 [00:08<00:56, 111.88it/s, est. speed input: 230664.70 toks/s, output: 225.26 toks/s]
Processed prompts:  23%|██▎       | 1883/8192 [00:08<01:02, 101.73it/s, est. speed input: 216654.67 toks/s, output: 211.58 toks/s]
Processed prompts:  24%|██▍       | 1947/8192 [00:09<01:05, 94.89it/s, est. speed input: 205227.97 toks/s, output: 200.42 toks/s] 
Processed prompts:  25%|██▍       | 2011/8192 [00:10<01:08, 89.76it/s, est. speed input: 195405.45 toks/s, output: 190.82 toks/s]
Processed prompts:  25%|██▌       | 2075/8192 [00:11<01:11, 86.08it/s, est. speed input: 186968.75 toks/s, output: 182.59 toks/s]
Processed prompts:  26%|██▌       | 2139/8192 [00:12<01:12, 83.63it/s, est. speed input: 179737.95 toks/s, output: 175.52 toks/s]
Processed prompts:  27%|██▋       | 2203/8192 [00:12<01:12, 82.43it/s, est. speed input: 173653.49 toks/s, output: 169.58 toks/s]
Processed prompts:  28%|██▊       | 2267/8192 [00:13<01:12, 81.25it/s, est. speed input: 168144.34 toks/s, output: 164.20 toks/s]
Processed prompts:  28%|██▊       | 2331/8192 [00:14<01:12, 80.44it/s, est. speed input: 163254.37 toks/s, output: 159.43 toks/s]
Processed prompts:  29%|██▉       | 2395/8192 [00:15<01:12, 79.56it/s, est. speed input: 158771.65 toks/s, output: 155.05 toks/s]
Processed prompts:  30%|███       | 2459/8192 [00:16<01:12, 79.18it/s, est. speed input: 154820.75 toks/s, output: 151.19 toks/s]
Processed prompts:  31%|███       | 2523/8192 [00:17<01:12, 78.70it/s, est. speed input: 151182.69 toks/s, output: 147.64 toks/s]
Processed prompts:  32%|███▏      | 2587/8192 [00:17<01:11, 78.58it/s, est. speed input: 147941.12 toks/s, output: 144.47 toks/s]
Processed prompts:  32%|███▏      | 2651/8192 [00:18<01:10, 78.27it/s, est. speed input: 144923.67 toks/s, output: 141.53 toks/s]
Processed prompts:  33%|███▎      | 2715/8192 [00:19<01:10, 78.03it/s, est. speed input: 142151.25 toks/s, output: 138.82 toks/s]
Processed prompts:  34%|███▍      | 2779/8192 [00:20<01:09, 77.80it/s, est. speed input: 139591.63 toks/s, output: 136.32 toks/s]
Processed prompts:  35%|███▍      | 2843/8192 [00:21<01:08, 77.66it/s, est. speed input: 137235.68 toks/s, output: 134.02 toks/s]
Processed prompts:  35%|███▌      | 2907/8192 [00:22<01:08, 77.59it/s, est. speed input: 135061.26 toks/s, output: 131.90 toks/s]
Processed prompts:  36%|███▋      | 2971/8192 [00:22<01:07, 77.49it/s, est. speed input: 133035.76 toks/s, output: 129.92 toks/s]
Processed prompts:  37%|███▋      | 3035/8192 [00:23<01:06, 77.47it/s, est. speed input: 131159.95 toks/s, output: 128.09 toks/s]
Processed prompts:  38%|███▊      | 3099/8192 [00:24<01:05, 77.65it/s, est. speed input: 129447.46 toks/s, output: 126.41 toks/s]
Processed prompts:  39%|███▊      | 3163/8192 [00:25<01:04, 77.53it/s, est. speed input: 127800.84 toks/s, output: 124.81 toks/s]
Processed prompts:  39%|███▉      | 3227/8192 [00:26<01:04, 77.44it/s, est. speed input: 126258.40 toks/s, output: 123.30 toks/s]
Processed prompts:  40%|████      | 3291/8192 [00:27<01:03, 77.35it/s, est. speed input: 124806.37 toks/s, output: 121.88 toks/s]
Processed prompts:  41%|████      | 3355/8192 [00:27<01:02, 77.31it/s, est. speed input: 123445.01 toks/s, output: 120.55 toks/s]
Processed prompts:  42%|████▏     | 3419/8192 [00:28<01:01, 77.32it/s, est. speed input: 122167.71 toks/s, output: 119.30 toks/s]
Processed prompts:  43%|████▎     | 3483/8192 [00:29<01:00, 77.30it/s, est. speed input: 120957.66 toks/s, output: 118.12 toks/s]
Processed prompts:  43%|████▎     | 3547/8192 [00:30<01:00, 77.25it/s, est. speed input: 119808.16 toks/s, output: 117.00 toks/s]
Processed prompts:  44%|████▍     | 3611/8192 [00:31<00:59, 77.17it/s, est. speed input: 118714.79 toks/s, output: 115.93 toks/s]
Processed prompts:  45%|████▍     | 3675/8192 [00:31<00:58, 77.16it/s, est. speed input: 117683.89 toks/s, output: 114.93 toks/s]
Processed prompts:  46%|████▌     | 3739/8192 [00:32<00:57, 77.37it/s, est. speed input: 116732.68 toks/s, output: 114.00 toks/s]
Processed prompts:  46%|████▋     | 3803/8192 [00:33<00:56, 77.27it/s, est. speed input: 115798.05 toks/s, output: 113.08 toks/s]
Processed prompts:  47%|████▋     | 3867/8192 [00:34<00:56, 77.22it/s, est. speed input: 114910.92 toks/s, output: 112.22 toks/s]
Processed prompts:  48%|████▊     | 3931/8192 [00:35<00:55, 77.10it/s, est. speed input: 114055.10 toks/s, output: 111.38 toks/s]
Processed prompts:  49%|████▉     | 3995/8192 [00:36<00:54, 77.32it/s, est. speed input: 113272.83 toks/s, output: 110.62 toks/s]
Processed prompts:  50%|████▉     | 4059/8192 [00:36<00:53, 77.22it/s, est. speed input: 112498.30 toks/s, output: 109.86 toks/s]
Processed prompts:  50%|█████     | 4123/8192 [00:37<00:52, 77.21it/s, est. speed input: 111763.68 toks/s, output: 109.14 toks/s]
Processed prompts:  51%|█████     | 4187/8192 [00:38<00:51, 77.39it/s, est. speed input: 111079.71 toks/s, output: 108.48 toks/s]
Processed prompts:  52%|█████▏    | 4251/8192 [00:39<00:50, 77.45it/s, est. speed input: 110418.42 toks/s, output: 107.83 toks/s]
Processed prompts:  53%|█████▎    | 4315/8192 [00:40<00:50, 77.54it/s, est. speed input: 109788.23 toks/s, output: 107.21 toks/s]
Processed prompts:  53%|█████▎    | 4379/8192 [00:41<00:49, 77.40it/s, est. speed input: 109164.36 toks/s, output: 106.61 toks/s]
Processed prompts:  54%|█████▍    | 4443/8192 [00:41<00:48, 77.24it/s, est. speed input: 108559.40 toks/s, output: 106.01 toks/s]
Processed prompts:  55%|█████▌    | 4507/8192 [00:42<00:47, 77.26it/s, est. speed input: 107989.68 toks/s, output: 105.46 toks/s]
Processed prompts:  56%|█████▌    | 4571/8192 [00:43<00:46, 77.06it/s, est. speed input: 107423.21 toks/s, output: 104.91 toks/s]
Processed prompts:  57%|█████▋    | 4635/8192 [00:44<00:46, 76.98it/s, est. speed input: 106883.33 toks/s, output: 104.38 toks/s]
Processed prompts:  57%|█████▋    | 4699/8192 [00:45<00:45, 76.97it/s, est. speed input: 106366.84 toks/s, output: 103.87 toks/s]
Processed prompts:  58%|█████▊    | 4763/8192 [00:46<00:44, 77.17it/s, est. speed input: 105885.75 toks/s, output: 103.40 toks/s]
Processed prompts:  59%|█████▉    | 4827/8192 [00:46<00:43, 77.22it/s, est. speed input: 105414.73 toks/s, output: 102.94 toks/s]
Processed prompts:  60%|█████▉    | 4891/8192 [00:47<00:42, 77.10it/s, est. speed input: 104947.55 toks/s, output: 102.49 toks/s]
Processed prompts:  60%|██████    | 4955/8192 [00:48<00:41, 77.27it/s, est. speed input: 104516.19 toks/s, output: 102.07 toks/s]
Processed prompts:  61%|██████▏   | 5019/8192 [00:49<00:41, 77.17it/s, est. speed input: 104083.02 toks/s, output: 101.64 toks/s]
Processed prompts:  62%|██████▏   | 5083/8192 [00:50<00:40, 77.09it/s, est. speed input: 103662.85 toks/s, output: 101.23 toks/s]
Processed prompts:  63%|██████▎   | 5147/8192 [00:51<00:39, 77.05it/s, est. speed input: 103257.86 toks/s, output: 100.84 toks/s]
Processed prompts:  64%|██████▎   | 5211/8192 [00:51<00:38, 76.92it/s, est. speed input: 102858.57 toks/s, output: 100.45 toks/s]
Processed prompts:  64%|██████▍   | 5275/8192 [00:52<00:37, 76.85it/s, est. speed input: 102473.23 toks/s, output: 100.07 toks/s]
Processed prompts:  65%|██████▌   | 5339/8192 [00:53<00:37, 76.83it/s, est. speed input: 102101.82 toks/s, output: 99.71 toks/s] 
Processed prompts:  66%|██████▌   | 5403/8192 [00:54<00:36, 76.83it/s, est. speed input: 101742.79 toks/s, output: 99.36 toks/s]
Processed prompts:  67%|██████▋   | 5467/8192 [00:55<00:35, 76.72it/s, est. speed input: 101387.53 toks/s, output: 99.01 toks/s]
Processed prompts:  68%|██████▊   | 5531/8192 [00:56<00:34, 76.92it/s, est. speed input: 101061.15 toks/s, output: 98.69 toks/s]
Processed prompts:  68%|██████▊   | 5595/8192 [00:56<00:33, 76.84it/s, est. speed input: 100729.81 toks/s, output: 98.37 toks/s]
Processed prompts:  69%|██████▉   | 5659/8192 [00:57<00:32, 76.79it/s, est. speed input: 100408.66 toks/s, output: 98.06 toks/s]
Processed prompts:  70%|██████▉   | 5723/8192 [00:58<00:32, 76.72it/s, est. speed input: 100094.39 toks/s, output: 97.75 toks/s]
Processed prompts:  71%|███████   | 5787/8192 [00:59<00:31, 76.77it/s, est. speed input: 99794.92 toks/s, output: 97.46 toks/s] 
Processed prompts:  71%|███████▏  | 5851/8192 [01:00<00:30, 76.71it/s, est. speed input: 99498.18 toks/s, output: 97.17 toks/s]
Processed prompts:  72%|███████▏  | 5915/8192 [01:01<00:29, 76.73it/s, est. speed input: 99212.85 toks/s, output: 96.89 toks/s]
Processed prompts:  73%|███████▎  | 5979/8192 [01:01<00:28, 76.72it/s, est. speed input: 98934.18 toks/s, output: 96.62 toks/s]
Processed prompts:  74%|███████▍  | 6043/8192 [01:02<00:28, 76.70it/s, est. speed input: 98661.89 toks/s, output: 96.35 toks/s]
Processed prompts:  75%|███████▍  | 6107/8192 [01:03<00:27, 76.60it/s, est. speed input: 98392.43 toks/s, output: 96.09 toks/s]
Processed prompts:  75%|███████▌  | 6171/8192 [01:04<00:26, 76.59it/s, est. speed input: 98133.03 toks/s, output: 95.83 toks/s]
Processed prompts:  76%|███████▌  | 6235/8192 [01:05<00:25, 76.56it/s, est. speed input: 97878.85 toks/s, output: 95.58 toks/s]
Processed prompts:  77%|███████▋  | 6299/8192 [01:06<00:24, 76.58it/s, est. speed input: 97633.24 toks/s, output: 95.34 toks/s]
Processed prompts:  78%|███████▊  | 6363/8192 [01:06<00:23, 76.63it/s, est. speed input: 97396.10 toks/s, output: 95.11 toks/s]
Processed prompts:  78%|███████▊  | 6427/8192 [01:07<00:23, 76.55it/s, est. speed input: 97158.24 toks/s, output: 94.88 toks/s]
Processed prompts:  79%|███████▉  | 6491/8192 [01:08<00:22, 76.55it/s, est. speed input: 96929.48 toks/s, output: 94.66 toks/s]
Processed prompts:  80%|████████  | 6555/8192 [01:09<00:21, 76.67it/s, est. speed input: 96712.17 toks/s, output: 94.45 toks/s]
Processed prompts:  81%|████████  | 6619/8192 [01:10<00:20, 76.83it/s, est. speed input: 96503.88 toks/s, output: 94.24 toks/s]
Processed prompts:  82%|████████▏ | 6683/8192 [01:11<00:19, 76.77it/s, est. speed input: 96291.88 toks/s, output: 94.03 toks/s]
Processed prompts:  82%|████████▏ | 6747/8192 [01:11<00:18, 76.70it/s, est. speed input: 96083.61 toks/s, output: 93.83 toks/s]
Processed prompts:  83%|████████▎ | 6811/8192 [01:12<00:18, 76.69it/s, est. speed input: 95882.00 toks/s, output: 93.63 toks/s]
Processed prompts:  84%|████████▍ | 6875/8192 [01:13<00:17, 76.58it/s, est. speed input: 95680.03 toks/s, output: 93.44 toks/s]
Processed prompts:  85%|████████▍ | 6939/8192 [01:14<00:16, 76.54it/s, est. speed input: 95484.11 toks/s, output: 93.25 toks/s]
Processed prompts:  85%|████████▌ | 7003/8192 [01:15<00:15, 76.52it/s, est. speed input: 95293.11 toks/s, output: 93.06 toks/s]
Processed prompts:  86%|████████▋ | 7067/8192 [01:16<00:14, 76.55it/s, est. speed input: 95108.54 toks/s, output: 92.88 toks/s]
Processed prompts:  87%|████████▋ | 7131/8192 [01:16<00:13, 76.69it/s, est. speed input: 94932.93 toks/s, output: 92.71 toks/s]
Processed prompts:  88%|████████▊ | 7195/8192 [01:17<00:13, 76.56it/s, est. speed input: 94750.98 toks/s, output: 92.53 toks/s]
Processed prompts:  89%|████████▊ | 7259/8192 [01:18<00:12, 76.72it/s, est. speed input: 94584.14 toks/s, output: 92.37 toks/s]
Processed prompts:  89%|████████▉ | 7323/8192 [01:19<00:11, 76.70it/s, est. speed input: 94415.11 toks/s, output: 92.20 toks/s]
Processed prompts:  90%|█████████ | 7387/8192 [01:20<00:10, 76.79it/s, est. speed input: 94253.92 toks/s, output: 92.04 toks/s]
Processed prompts:  91%|█████████ | 7451/8192 [01:21<00:09, 76.66it/s, est. speed input: 94087.62 toks/s, output: 91.88 toks/s]
Processed prompts:  92%|█████████▏| 7515/8192 [01:21<00:08, 76.60it/s, est. speed input: 93926.29 toks/s, output: 91.72 toks/s]
Processed prompts:  93%|█████████▎| 7579/8192 [01:22<00:08, 76.47it/s, est. speed input: 93764.50 toks/s, output: 91.57 toks/s]
Processed prompts:  93%|█████████▎| 7643/8192 [01:23<00:07, 76.50it/s, est. speed input: 93610.91 toks/s, output: 91.42 toks/s]
Processed prompts:  94%|█████████▍| 7707/8192 [01:24<00:06, 76.36it/s, est. speed input: 93453.90 toks/s, output: 91.26 toks/s]
Processed prompts:  95%|█████████▍| 7771/8192 [01:25<00:05, 76.39it/s, est. speed input: 93305.32 toks/s, output: 91.12 toks/s]
Processed prompts:  96%|█████████▌| 7835/8192 [01:26<00:04, 76.40it/s, est. speed input: 93159.00 toks/s, output: 90.98 toks/s]
Processed prompts:  96%|█████████▋| 7899/8192 [01:26<00:03, 76.33it/s, est. speed input: 93012.30 toks/s, output: 90.83 toks/s]
Processed prompts:  97%|█████████▋| 7963/8192 [01:27<00:02, 76.35it/s, est. speed input: 92871.36 toks/s, output: 90.69 toks/s]
Processed prompts:  98%|█████████▊| 8027/8192 [01:28<00:02, 76.32it/s, est. speed input: 92731.15 toks/s, output: 90.56 toks/s]
Processed prompts:  99%|█████████▉| 8091/8192 [01:29<00:01, 76.60it/s, est. speed input: 92605.30 toks/s, output: 90.43 toks/s]
Processed prompts: 100%|█████████▉| 8155/8192 [01:29<00:00, 87.52it/s, est. speed input: 92831.34 toks/s, output: 90.66 toks/s]
Processed prompts: 100%|██████████| 8192/8192 [01:29<00:00, 87.52it/s, est. speed input: 93251.40 toks/s, output: 91.07 toks/s]
Processed prompts: 100%|██████████| 8192/8192 [01:29<00:00, 91.07it/s, est. speed input: 93251.40 toks/s, output: 91.07 toks/s]
[rank0]:[W126 10:42:43.206865700 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=512 ==========
Time: 2026-01-26 12:12:54
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-FP8-SlideSparse-2_8
Params: prompt_len=512, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-FP8-SlideSparse-2_8 --dataset-name random --input-len 512 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 513 --max-num-batched-tokens 513 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_FP8E4M3_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-7B-FP8_M512.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 12:13:01 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1340646) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1340646) WARNING 01-26 12:13:18 [backends.py:609] Failed to read file <frozen os>
Throughput: 36.24 requests/s, 18590.28 total tokens/s, 36.24 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128

STDERR:
[2026-01-26 12:13:01] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 12:13:01] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 12:13:01] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 12:13:01] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:13:01] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:13:01] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:13:01] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:13:01] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:13:01] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 12:13:01] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 12:13:01] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 12:13:01] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 12:13:01] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 12:13:01] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 12:13:08] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 12:13:08] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 12:13:08] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 12:13:08] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:13:08] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:13:08] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:13:08] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:13:08] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:13:08] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 12:13:08] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 12:13:08] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 12:13:08] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 12:13:08] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 12:13:08] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1340646) [2026-01-26 12:13:10] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1340646) [2026-01-26 12:13:10] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1340646) [2026-01-26 12:13:10] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1340646) [2026-01-26 12:13:10] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1340646) [2026-01-26 12:13:10] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1340646) [2026-01-26 12:13:10] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1340646) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1340646) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.95it/s]
(EngineCore_DP0 pid=1340646) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.41it/s]
(EngineCore_DP0 pid=1340646) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.47it/s]
(EngineCore_DP0 pid=1340646) 
(EngineCore_DP0 pid=1340646) [2026-01-26 12:13:12] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=1340646) [2026-01-26 12:13:12] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 15482880 bytes
(EngineCore_DP0 pid=1340646) [2026-01-26 12:13:12] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=1340646) [2026-01-26 12:13:12] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12042240 bytes
(EngineCore_DP0 pid=1340646) [2026-01-26 12:13:12] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=1340646) [2026-01-26 12:13:12] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 127303680 bytes
(EngineCore_DP0 pid=1340646) [2026-01-26 12:13:12] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=1340646) [2026-01-26 12:13:12] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 63651840 bytes
(EngineCore_DP0 pid=1340646) 2026-01-26 12:13:28,686 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1340646) 2026-01-26 12:13:28,709 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1340646) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  1.38it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:01<00:00,  1.99it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:01<00:00,  1.86it/s]
(EngineCore_DP0 pid=1340646) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00, 18.00it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  28%|██▊       | 36/128 [00:00<00:00, 355.76it/s]
Adding requests:  83%|████████▎ | 106/128 [00:00<00:00, 551.68it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 545.02it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:22,  5.75it/s, est. speed input: 2944.11 toks/s, output: 5.75 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:06, 19.10it/s, est. speed input: 8585.04 toks/s, output: 16.77 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:00<00:04, 28.19it/s, est. speed input: 12190.49 toks/s, output: 23.81 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:00<00:03, 33.01it/s, est. speed input: 14183.64 toks/s, output: 27.70 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:00<00:03, 35.79it/s, est. speed input: 15437.64 toks/s, output: 30.15 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:00<00:02, 37.49it/s, est. speed input: 16293.30 toks/s, output: 31.82 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:00<00:02, 38.62it/s, est. speed input: 16925.41 toks/s, output: 33.06 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:01<00:02, 39.38it/s, est. speed input: 17409.45 toks/s, output: 34.00 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:01<00:02, 39.86it/s, est. speed input: 17784.54 toks/s, output: 34.73 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:01<00:02, 40.23it/s, est. speed input: 18094.33 toks/s, output: 35.34 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:01<00:01, 40.48it/s, est. speed input: 18349.45 toks/s, output: 35.84 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:01<00:01, 40.64it/s, est. speed input: 18563.03 toks/s, output: 36.26 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:01<00:01, 40.80it/s, est. speed input: 18748.76 toks/s, output: 36.62 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:01<00:01, 40.85it/s, est. speed input: 18903.08 toks/s, output: 36.92 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:01<00:01, 40.90it/s, est. speed input: 19039.43 toks/s, output: 37.19 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:02<00:01, 40.91it/s, est. speed input: 19155.98 toks/s, output: 37.41 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:02<00:01, 40.92it/s, est. speed input: 19260.06 toks/s, output: 37.62 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:02<00:01, 40.91it/s, est. speed input: 19351.07 toks/s, output: 37.79 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:02<00:00, 40.95it/s, est. speed input: 19436.43 toks/s, output: 37.96 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:02<00:00, 41.02it/s, est. speed input: 19516.43 toks/s, output: 38.12 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:02<00:00, 41.05it/s, est. speed input: 19587.99 toks/s, output: 38.26 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:02<00:00, 41.03it/s, est. speed input: 19650.63 toks/s, output: 38.38 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:02<00:00, 41.05it/s, est. speed input: 19709.55 toks/s, output: 38.49 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:02<00:00, 41.02it/s, est. speed input: 19761.37 toks/s, output: 38.60 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:03<00:00, 41.03it/s, est. speed input: 19810.89 toks/s, output: 38.69 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:03<00:00, 41.08it/s, est. speed input: 19858.99 toks/s, output: 38.79 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:03<00:00, 41.08it/s, est. speed input: 19886.02 toks/s, output: 38.84 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:03<00:00, 38.84it/s, est. speed input: 19886.02 toks/s, output: 38.84 toks/s]
[rank0]:[W126 12:13:35.171942320 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=1024 ==========
Time: 2026-01-26 12:13:37
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-FP8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-FP8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 1025 --max-num-batched-tokens 1025 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_FP8E4M3_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-7B-FP8_M1024.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 12:13:44 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1341789) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1341789) WARNING 01-26 12:14:01 [backends.py:609] Failed to read file <frozen os>
Throughput: 31.12 requests/s, 31897.87 total tokens/s, 31.12 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128

STDERR:
[2026-01-26 12:13:43] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 12:13:44] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 12:13:44] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 12:13:44] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:13:44] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:13:44] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:13:44] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:13:44] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:13:44] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 12:13:44] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 12:13:44] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 12:13:44] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 12:13:44] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 12:13:44] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 12:13:51] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 12:13:52] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 12:13:52] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 12:13:52] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:13:52] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:13:52] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:13:52] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:13:52] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:13:52] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 12:13:52] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 12:13:52] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 12:13:52] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 12:13:52] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 12:13:52] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1341789) [2026-01-26 12:13:53] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1341789) [2026-01-26 12:13:53] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1341789) [2026-01-26 12:13:53] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1341789) [2026-01-26 12:13:53] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1341789) [2026-01-26 12:13:53] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1341789) [2026-01-26 12:13:53] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1341789) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1341789) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
(EngineCore_DP0 pid=1341789) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.42it/s]
(EngineCore_DP0 pid=1341789) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.48it/s]
(EngineCore_DP0 pid=1341789) 
(EngineCore_DP0 pid=1341789) [2026-01-26 12:13:55] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=1341789) [2026-01-26 12:13:55] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 15482880 bytes
(EngineCore_DP0 pid=1341789) [2026-01-26 12:13:55] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=1341789) [2026-01-26 12:13:55] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12042240 bytes
(EngineCore_DP0 pid=1341789) [2026-01-26 12:13:55] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=1341789) [2026-01-26 12:13:55] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 127303680 bytes
(EngineCore_DP0 pid=1341789) [2026-01-26 12:13:55] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=1341789) [2026-01-26 12:13:55] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 63651840 bytes
(EngineCore_DP0 pid=1341789) 2026-01-26 12:14:11,763 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1341789) 2026-01-26 12:14:11,787 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1341789) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  2.70it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  2.22it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  2.28it/s]
(EngineCore_DP0 pid=1341789) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  9.94it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  9.93it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  16%|█▌        | 20/128 [00:00<00:00, 197.88it/s]
Adding requests:  48%|████▊     | 61/128 [00:00<00:00, 317.39it/s]
Adding requests:  77%|███████▋  | 98/128 [00:00<00:00, 337.02it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 331.38it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:02, 42.70it/s, est. speed input: 43729.99 toks/s, output: 42.70 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:00<00:03, 37.22it/s, est. speed input: 38869.68 toks/s, output: 37.95 toks/s]
Processed prompts:  11%|█         | 14/128 [00:00<00:03, 35.97it/s, est. speed input: 37704.68 toks/s, output: 36.82 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:00<00:03, 35.42it/s, est. speed input: 37151.46 toks/s, output: 36.28 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:00<00:03, 34.96it/s, est. speed input: 36726.46 toks/s, output: 35.86 toks/s]
Processed prompts:  20%|██        | 26/128 [00:00<00:02, 34.70it/s, est. speed input: 36447.66 toks/s, output: 35.59 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:00<00:02, 34.53it/s, est. speed input: 36245.81 toks/s, output: 35.39 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:00<00:02, 34.30it/s, est. speed input: 36047.94 toks/s, output: 35.20 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:01<00:02, 34.10it/s, est. speed input: 35874.65 toks/s, output: 35.03 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:01<00:02, 34.05it/s, est. speed input: 35763.26 toks/s, output: 34.92 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:01<00:02, 34.11it/s, est. speed input: 35701.84 toks/s, output: 34.86 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:01<00:02, 34.15it/s, est. speed input: 35649.41 toks/s, output: 34.81 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:01<00:02, 34.12it/s, est. speed input: 35590.62 toks/s, output: 34.76 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:01<00:02, 34.13it/s, est. speed input: 35548.70 toks/s, output: 34.71 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:01<00:01, 34.18it/s, est. speed input: 35519.28 toks/s, output: 34.69 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:01<00:01, 34.14it/s, est. speed input: 35479.18 toks/s, output: 34.65 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:02<00:01, 34.04it/s, est. speed input: 35429.71 toks/s, output: 34.60 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:02<00:01, 34.04it/s, est. speed input: 35397.67 toks/s, output: 34.57 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:02<00:01, 34.06it/s, est. speed input: 35372.57 toks/s, output: 34.54 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:02<00:01, 34.08it/s, est. speed input: 35352.32 toks/s, output: 34.52 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:02<00:01, 34.07it/s, est. speed input: 35328.69 toks/s, output: 34.50 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:02<00:01, 34.12it/s, est. speed input: 35317.22 toks/s, output: 34.49 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:02<00:00, 34.14it/s, est. speed input: 35304.30 toks/s, output: 34.48 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:02<00:00, 34.12it/s, est. speed input: 35286.94 toks/s, output: 34.46 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:02<00:00, 34.10it/s, est. speed input: 35270.80 toks/s, output: 34.44 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:03<00:00, 34.12it/s, est. speed input: 35259.37 toks/s, output: 34.43 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:03<00:00, 34.09it/s, est. speed input: 35243.52 toks/s, output: 34.42 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:03<00:00, 34.02it/s, est. speed input: 35222.87 toks/s, output: 34.40 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:03<00:00, 33.99it/s, est. speed input: 35206.48 toks/s, output: 34.38 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:03<00:00, 34.03it/s, est. speed input: 35197.54 toks/s, output: 34.37 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:03<00:00, 34.06it/s, est. speed input: 35190.12 toks/s, output: 34.37 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:03<00:00, 34.06it/s, est. speed input: 35186.78 toks/s, output: 34.36 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:03<00:00, 34.36it/s, est. speed input: 35186.78 toks/s, output: 34.36 toks/s]
[rank0]:[W126 12:14:18.689437153 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=2048 ==========
Time: 2026-01-26 12:14:20
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-FP8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=256, max_num_seqs=2
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-FP8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 256 --max-num-seqs 2 --max-model-len 1025 --max-num-batched-tokens 2048 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_FP8E4M3_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-7B-FP8_M2048.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 12:14:28 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1342899) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1342899) WARNING 01-26 12:14:45 [backends.py:609] Failed to read file <frozen os>
Throughput: 36.52 requests/s, 37436.97 total tokens/s, 36.52 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256

STDERR:
[2026-01-26 12:14:28] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 12:14:28] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 12:14:28] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 12:14:28] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:14:28] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:14:28] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:14:28] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:14:28] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:14:28] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 12:14:28] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 12:14:28] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 12:14:28] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 12:14:28] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 12:14:28] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 12:14:35] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 12:14:35] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 12:14:35] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 12:14:35] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:14:35] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:14:35] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:14:35] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:14:35] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:14:35] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 12:14:35] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 12:14:35] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 12:14:35] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 12:14:35] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 12:14:35] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1342899) [2026-01-26 12:14:37] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1342899) [2026-01-26 12:14:37] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1342899) [2026-01-26 12:14:37] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1342899) [2026-01-26 12:14:37] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1342899) [2026-01-26 12:14:37] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1342899) [2026-01-26 12:14:37] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1342899) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1342899) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.96it/s]
(EngineCore_DP0 pid=1342899) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.40it/s]
(EngineCore_DP0 pid=1342899) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.46it/s]
(EngineCore_DP0 pid=1342899) 
(EngineCore_DP0 pid=1342899) [2026-01-26 12:14:39] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=1342899) [2026-01-26 12:14:39] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 15482880 bytes
(EngineCore_DP0 pid=1342899) [2026-01-26 12:14:39] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=1342899) [2026-01-26 12:14:39] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12042240 bytes
(EngineCore_DP0 pid=1342899) [2026-01-26 12:14:39] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=1342899) [2026-01-26 12:14:39] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 127303680 bytes
(EngineCore_DP0 pid=1342899) [2026-01-26 12:14:39] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=1342899) [2026-01-26 12:14:39] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 63651840 bytes
(EngineCore_DP0 pid=1342899) 2026-01-26 12:14:56,475 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1342899) 2026-01-26 12:14:56,522 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1342899) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  67%|██████▋   | 2/3 [00:00<00:00, 14.33it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00, 14.41it/s]
(EngineCore_DP0 pid=1342899) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00, 18.83it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00, 18.81it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:   8%|▊         | 21/256 [00:00<00:01, 206.33it/s]
Adding requests:  24%|██▍       | 62/256 [00:00<00:00, 324.31it/s]
Adding requests:  38%|███▊      | 98/256 [00:00<00:00, 339.00it/s]
Adding requests:  53%|█████▎    | 136/256 [00:00<00:00, 354.16it/s]
Adding requests:  69%|██████▉   | 176/256 [00:00<00:00, 367.57it/s]
Adding requests:  84%|████████▍ | 216/256 [00:00<00:00, 376.20it/s]
Adding requests: 100%|█████████▉| 255/256 [00:00<00:00, 378.35it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 359.09it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  11%|█         | 28/256 [00:00<00:00, 233.05it/s, est. speed input: 238785.07 toks/s, output: 233.07 toks/s]
Processed prompts:  20%|██        | 52/256 [00:00<00:03, 58.96it/s, est. speed input: 68662.12 toks/s, output: 67.05 toks/s]   
Processed prompts:  25%|██▌       | 64/256 [00:01<00:03, 50.44it/s, est. speed input: 59530.41 toks/s, output: 58.13 toks/s]
Processed prompts:  29%|██▊       | 73/256 [00:01<00:03, 47.91it/s, est. speed input: 56631.56 toks/s, output: 55.30 toks/s]
Processed prompts:  31%|███▏      | 80/256 [00:01<00:04, 43.54it/s, est. speed input: 53282.97 toks/s, output: 52.03 toks/s]
Processed prompts:  34%|███▎      | 86/256 [00:01<00:04, 41.99it/s, est. speed input: 51783.69 toks/s, output: 50.57 toks/s]
Processed prompts:  36%|███▌      | 91/256 [00:01<00:03, 42.65it/s, est. speed input: 51478.70 toks/s, output: 50.27 toks/s]
Processed prompts:  38%|███▊      | 96/256 [00:01<00:04, 39.33it/s, est. speed input: 49818.03 toks/s, output: 48.65 toks/s]
Processed prompts:  39%|███▉      | 101/256 [00:02<00:03, 40.69it/s, est. speed input: 49666.03 toks/s, output: 48.50 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:02<00:03, 37.57it/s, est. speed input: 48333.72 toks/s, output: 47.20 toks/s]
Processed prompts:  43%|████▎     | 110/256 [00:02<00:03, 37.33it/s, est. speed input: 47825.13 toks/s, output: 46.70 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:02<00:03, 37.18it/s, est. speed input: 47371.79 toks/s, output: 46.26 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:02<00:03, 37.04it/s, est. speed input: 46955.57 toks/s, output: 45.85 toks/s]
Processed prompts:  48%|████▊     | 122/256 [00:02<00:03, 36.95it/s, est. speed input: 46574.12 toks/s, output: 45.48 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:02<00:03, 36.88it/s, est. speed input: 46223.73 toks/s, output: 45.14 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:02<00:03, 36.85it/s, est. speed input: 45902.88 toks/s, output: 44.83 toks/s]
Processed prompts:  52%|█████▏    | 134/256 [00:03<00:03, 36.76it/s, est. speed input: 45592.94 toks/s, output: 44.52 toks/s]
Processed prompts:  54%|█████▍    | 138/256 [00:03<00:03, 36.81it/s, est. speed input: 45322.51 toks/s, output: 44.26 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:03<00:03, 36.71it/s, est. speed input: 45052.34 toks/s, output: 44.00 toks/s]
Processed prompts:  57%|█████▋    | 146/256 [00:03<00:03, 36.61it/s, est. speed input: 44795.32 toks/s, output: 43.74 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:03<00:02, 36.65it/s, est. speed input: 44568.55 toks/s, output: 43.52 toks/s]
Processed prompts:  60%|██████    | 154/256 [00:03<00:02, 36.62it/s, est. speed input: 44349.02 toks/s, output: 43.31 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:03<00:02, 36.68it/s, est. speed input: 44152.10 toks/s, output: 43.12 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:03<00:02, 36.65it/s, est. speed input: 43957.36 toks/s, output: 42.93 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:03<00:02, 36.61it/s, est. speed input: 43772.68 toks/s, output: 42.75 toks/s]
Processed prompts:  66%|██████▋   | 170/256 [00:03<00:02, 36.59it/s, est. speed input: 43598.81 toks/s, output: 42.58 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:04<00:02, 36.60it/s, est. speed input: 43436.33 toks/s, output: 42.42 toks/s]
Processed prompts:  70%|██████▉   | 178/256 [00:04<00:02, 36.49it/s, est. speed input: 43270.45 toks/s, output: 42.26 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:04<00:02, 36.57it/s, est. speed input: 43128.90 toks/s, output: 42.12 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:04<00:01, 36.68it/s, est. speed input: 42998.92 toks/s, output: 41.99 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:04<00:01, 36.69it/s, est. speed input: 42868.88 toks/s, output: 41.86 toks/s]
Processed prompts:  76%|███████▌  | 194/256 [00:04<00:01, 36.72it/s, est. speed input: 42747.53 toks/s, output: 41.75 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:04<00:01, 36.69it/s, est. speed input: 42627.19 toks/s, output: 41.63 toks/s]
Processed prompts:  80%|███████▉  | 204/256 [00:04<00:01, 38.41it/s, est. speed input: 42621.06 toks/s, output: 41.62 toks/s]
Processed prompts:  81%|████████▏ | 208/256 [00:05<00:01, 37.92it/s, est. speed input: 42510.76 toks/s, output: 41.51 toks/s]
Processed prompts:  83%|████████▎ | 212/256 [00:05<00:01, 37.59it/s, est. speed input: 42407.12 toks/s, output: 41.41 toks/s]
Processed prompts:  84%|████████▍ | 216/256 [00:05<00:01, 37.29it/s, est. speed input: 42303.53 toks/s, output: 41.31 toks/s]
Processed prompts:  86%|████████▌ | 220/256 [00:05<00:00, 37.15it/s, est. speed input: 42209.69 toks/s, output: 41.22 toks/s]
Processed prompts:  88%|████████▊ | 224/256 [00:05<00:00, 37.04it/s, est. speed input: 42118.57 toks/s, output: 41.13 toks/s]
Processed prompts:  89%|████████▉ | 228/256 [00:05<00:00, 36.92it/s, est. speed input: 42027.92 toks/s, output: 41.04 toks/s]
Processed prompts:  91%|█████████ | 232/256 [00:05<00:00, 36.89it/s, est. speed input: 41945.03 toks/s, output: 40.96 toks/s]
Processed prompts:  92%|█████████▏| 236/256 [00:05<00:00, 36.75it/s, est. speed input: 41856.46 toks/s, output: 40.88 toks/s]
Processed prompts:  94%|█████████▍| 240/256 [00:05<00:00, 36.79it/s, est. speed input: 41781.30 toks/s, output: 40.80 toks/s]
Processed prompts:  95%|█████████▌| 244/256 [00:05<00:00, 36.65it/s, est. speed input: 41697.25 toks/s, output: 40.72 toks/s]
Processed prompts:  97%|█████████▋| 248/256 [00:06<00:00, 36.71it/s, est. speed input: 41626.72 toks/s, output: 40.65 toks/s]
Processed prompts:  98%|█████████▊| 252/256 [00:06<00:00, 36.71it/s, est. speed input: 41555.64 toks/s, output: 40.58 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:06<00:00, 36.71it/s, est. speed input: 41647.64 toks/s, output: 40.67 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:06<00:00, 40.67it/s, est. speed input: 41647.64 toks/s, output: 40.67 toks/s]
[rank0]:[W126 12:15:05.639758696 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=4096 ==========
Time: 2026-01-26 12:15:07
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-FP8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=512, max_num_seqs=4
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-FP8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 512 --max-num-seqs 4 --max-model-len 1025 --max-num-batched-tokens 4096 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_FP8E4M3_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-7B-FP8_M4096.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 12:15:17 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1344064) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1344064) WARNING 01-26 12:15:33 [backends.py:609] Failed to read file <frozen os>
Throughput: 37.68 requests/s, 38626.34 total tokens/s, 37.68 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512

STDERR:
[2026-01-26 12:15:16] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 12:15:17] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 12:15:17] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 12:15:17] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:15:17] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:15:17] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:15:17] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:15:17] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:15:17] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 12:15:17] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 12:15:17] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 12:15:17] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 12:15:17] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 12:15:17] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 12:15:23] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 12:15:24] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 12:15:24] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 12:15:24] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:15:24] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:15:24] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:15:24] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:15:24] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:15:24] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 12:15:24] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 12:15:24] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 12:15:24] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 12:15:24] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 12:15:24] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1344064) [2026-01-26 12:15:26] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1344064) [2026-01-26 12:15:26] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1344064) [2026-01-26 12:15:26] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1344064) [2026-01-26 12:15:26] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1344064) [2026-01-26 12:15:26] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1344064) [2026-01-26 12:15:26] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1344064) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1344064) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
(EngineCore_DP0 pid=1344064) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.41it/s]
(EngineCore_DP0 pid=1344064) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.47it/s]
(EngineCore_DP0 pid=1344064) 
(EngineCore_DP0 pid=1344064) [2026-01-26 12:15:27] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=1344064) [2026-01-26 12:15:27] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 15482880 bytes
(EngineCore_DP0 pid=1344064) [2026-01-26 12:15:27] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=1344064) [2026-01-26 12:15:27] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12042240 bytes
(EngineCore_DP0 pid=1344064) [2026-01-26 12:15:27] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=1344064) [2026-01-26 12:15:27] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 127303680 bytes
(EngineCore_DP0 pid=1344064) [2026-01-26 12:15:27] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=1344064) [2026-01-26 12:15:27] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 63651840 bytes
(EngineCore_DP0 pid=1344064) 2026-01-26 12:15:44,375 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1344064) 2026-01-26 12:15:44,399 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1344064) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  25%|██▌       | 1/4 [00:00<00:00,  8.84it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 2/4 [00:00<00:00,  2.63it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  75%|███████▌  | 3/4 [00:00<00:00,  3.26it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  4.10it/s]
(EngineCore_DP0 pid=1344064) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  67%|██████▋   | 2/3 [00:00<00:00, 19.39it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00, 19.87it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   4%|▎         | 19/512 [00:00<00:02, 189.75it/s]
Adding requests:  11%|█▏        | 58/512 [00:00<00:01, 307.19it/s]
Adding requests:  19%|█▊        | 95/512 [00:00<00:01, 334.27it/s]
Adding requests:  26%|██▌       | 133/512 [00:00<00:01, 349.62it/s]
Adding requests:  34%|███▎      | 172/512 [00:00<00:00, 363.16it/s]
Adding requests:  41%|████▏     | 212/512 [00:00<00:00, 373.50it/s]
Adding requests:  49%|████▉     | 250/512 [00:00<00:00, 375.19it/s]
Adding requests:  56%|█████▋    | 288/512 [00:00<00:00, 374.88it/s]
Adding requests:  64%|██████▍   | 327/512 [00:00<00:00, 378.98it/s]
Adding requests:  72%|███████▏  | 368/512 [00:01<00:00, 387.75it/s]
Adding requests:  80%|███████▉  | 409/512 [00:01<00:00, 392.92it/s]
Adding requests:  88%|████████▊ | 449/512 [00:01<00:00, 386.95it/s]
Adding requests:  96%|█████████▌| 492/512 [00:01<00:00, 397.43it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 373.70it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  10%|▉         | 50/512 [00:00<00:01, 434.10it/s, est. speed input: 444606.23 toks/s, output: 434.13 toks/s]
Processed prompts:  18%|█▊        | 94/512 [00:01<00:06, 63.67it/s, est. speed input: 75473.97 toks/s, output: 73.70 toks/s]   
Processed prompts:  22%|██▏       | 115/512 [00:01<00:07, 54.59it/s, est. speed input: 65256.54 toks/s, output: 63.73 toks/s]
Processed prompts:  25%|██▌       | 128/512 [00:02<00:07, 51.22it/s, est. speed input: 61745.04 toks/s, output: 60.30 toks/s]
Processed prompts:  27%|██▋       | 138/512 [00:02<00:08, 46.32it/s, est. speed input: 58046.39 toks/s, output: 56.69 toks/s]
Processed prompts:  29%|██▊       | 146/512 [00:02<00:08, 44.62it/s, est. speed input: 56493.14 toks/s, output: 55.17 toks/s]
Processed prompts:  30%|██▉       | 152/512 [00:02<00:07, 46.06it/s, est. speed input: 56530.63 toks/s, output: 55.21 toks/s]
Processed prompts:  31%|███       | 158/512 [00:02<00:08, 41.21it/s, est. speed input: 54492.35 toks/s, output: 53.21 toks/s]
Processed prompts:  32%|███▏      | 163/512 [00:03<00:08, 42.20it/s, est. speed input: 54293.15 toks/s, output: 53.02 toks/s]
Processed prompts:  33%|███▎      | 168/512 [00:03<00:07, 43.16it/s, est. speed input: 54103.09 toks/s, output: 52.83 toks/s]
Processed prompts:  34%|███▍      | 173/512 [00:03<00:07, 44.06it/s, est. speed input: 53929.51 toks/s, output: 52.67 toks/s]
Processed prompts:  35%|███▍      | 178/512 [00:03<00:09, 36.69it/s, est. speed input: 52186.02 toks/s, output: 50.96 toks/s]
Processed prompts:  36%|███▌      | 183/512 [00:03<00:08, 38.99it/s, est. speed input: 52086.46 toks/s, output: 50.87 toks/s]
Processed prompts:  37%|███▋      | 188/512 [00:03<00:07, 40.79it/s, est. speed input: 51961.55 toks/s, output: 50.74 toks/s]
Processed prompts:  38%|███▊      | 193/512 [00:03<00:07, 42.32it/s, est. speed input: 51852.31 toks/s, output: 50.64 toks/s]
Processed prompts:  39%|███▊      | 198/512 [00:04<00:09, 34.49it/s, est. speed input: 50384.95 toks/s, output: 49.20 toks/s]
Processed prompts:  40%|████      | 206/512 [00:04<00:08, 36.90it/s, est. speed input: 50015.19 toks/s, output: 48.84 toks/s]
Processed prompts:  41%|████      | 210/512 [00:04<00:08, 37.14it/s, est. speed input: 49745.71 toks/s, output: 48.58 toks/s]
Processed prompts:  42%|████▏     | 214/512 [00:04<00:07, 37.36it/s, est. speed input: 49490.42 toks/s, output: 48.33 toks/s]
Processed prompts:  43%|████▎     | 218/512 [00:04<00:07, 37.57it/s, est. speed input: 49250.32 toks/s, output: 48.10 toks/s]
Processed prompts:  43%|████▎     | 222/512 [00:04<00:07, 37.70it/s, est. speed input: 49017.60 toks/s, output: 47.87 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:04<00:07, 37.65it/s, est. speed input: 48779.83 toks/s, output: 47.64 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:04<00:07, 37.52it/s, est. speed input: 48542.61 toks/s, output: 47.40 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:04<00:07, 37.58it/s, est. speed input: 48330.95 toks/s, output: 47.20 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:05<00:07, 37.49it/s, est. speed input: 48115.33 toks/s, output: 46.99 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:05<00:07, 37.68it/s, est. speed input: 47932.15 toks/s, output: 46.81 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:05<00:07, 37.78it/s, est. speed input: 47752.70 toks/s, output: 46.63 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:05<00:06, 37.80it/s, est. speed input: 47575.27 toks/s, output: 46.46 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:05<00:06, 37.80it/s, est. speed input: 47404.60 toks/s, output: 46.29 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:05<00:06, 37.89it/s, est. speed input: 47246.76 toks/s, output: 46.14 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:05<00:06, 37.86it/s, est. speed input: 47087.92 toks/s, output: 45.98 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:05<00:06, 37.72it/s, est. speed input: 46926.04 toks/s, output: 45.83 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:05<00:06, 37.61it/s, est. speed input: 46769.18 toks/s, output: 45.67 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:06<00:06, 37.62it/s, est. speed input: 46623.48 toks/s, output: 45.53 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:06<00:06, 37.72it/s, est. speed input: 46490.05 toks/s, output: 45.40 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:06<00:06, 37.72it/s, est. speed input: 46356.01 toks/s, output: 45.27 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:06<00:05, 37.87it/s, est. speed input: 46237.27 toks/s, output: 45.15 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:06<00:05, 37.89it/s, est. speed input: 46115.89 toks/s, output: 45.03 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:06<00:05, 37.85it/s, est. speed input: 45995.35 toks/s, output: 44.92 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:06<00:05, 37.85it/s, est. speed input: 45880.42 toks/s, output: 44.80 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:06<00:05, 37.89it/s, est. speed input: 45771.20 toks/s, output: 44.70 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:06<00:05, 39.37it/s, est. speed input: 45672.70 toks/s, output: 44.60 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:07<00:05, 38.95it/s, est. speed input: 45566.83 toks/s, output: 44.50 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:07<00:05, 38.60it/s, est. speed input: 45462.91 toks/s, output: 44.40 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:07<00:04, 38.36it/s, est. speed input: 45363.47 toks/s, output: 44.30 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:07<00:04, 38.23it/s, est. speed input: 45269.67 toks/s, output: 44.21 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:07<00:04, 38.10it/s, est. speed input: 45176.35 toks/s, output: 44.12 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:07<00:04, 38.01it/s, est. speed input: 45085.77 toks/s, output: 44.03 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:07<00:04, 37.85it/s, est. speed input: 44992.87 toks/s, output: 43.94 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:07<00:04, 37.92it/s, est. speed input: 44911.96 toks/s, output: 43.86 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:07<00:04, 37.84it/s, est. speed input: 44826.44 toks/s, output: 43.78 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:08<00:04, 37.82it/s, est. speed input: 44745.34 toks/s, output: 43.70 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:08<00:04, 37.74it/s, est. speed input: 44662.94 toks/s, output: 43.62 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:08<00:04, 37.68it/s, est. speed input: 44582.41 toks/s, output: 43.54 toks/s]
Processed prompts:  71%|███████   | 362/512 [00:08<00:03, 37.72it/s, est. speed input: 44507.75 toks/s, output: 43.46 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:08<00:03, 37.78it/s, est. speed input: 44437.16 toks/s, output: 43.40 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [00:08<00:03, 37.71it/s, est. speed input: 44362.18 toks/s, output: 43.32 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [00:08<00:03, 37.68it/s, est. speed input: 44290.13 toks/s, output: 43.25 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [00:08<00:03, 37.73it/s, est. speed input: 44223.47 toks/s, output: 43.19 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [00:08<00:03, 37.82it/s, est. speed input: 44160.61 toks/s, output: 43.13 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [00:08<00:03, 37.78it/s, est. speed input: 44094.58 toks/s, output: 43.06 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [00:09<00:03, 37.64it/s, est. speed input: 44024.93 toks/s, output: 42.99 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [00:09<00:03, 37.66it/s, est. speed input: 43962.45 toks/s, output: 42.93 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [00:09<00:03, 37.68it/s, est. speed input: 43901.64 toks/s, output: 42.87 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [00:09<00:02, 37.63it/s, est. speed input: 43839.25 toks/s, output: 42.81 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [00:09<00:02, 37.63it/s, est. speed input: 43780.03 toks/s, output: 42.75 toks/s]
Processed prompts:  80%|████████  | 410/512 [00:09<00:02, 37.66it/s, est. speed input: 43723.01 toks/s, output: 42.70 toks/s]
Processed prompts:  81%|████████  | 414/512 [00:09<00:02, 37.65it/s, est. speed input: 43666.35 toks/s, output: 42.64 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [00:09<00:02, 37.68it/s, est. speed input: 43612.32 toks/s, output: 42.59 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [00:09<00:02, 37.63it/s, est. speed input: 43556.20 toks/s, output: 42.54 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [00:10<00:02, 37.64it/s, est. speed input: 43503.56 toks/s, output: 42.48 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [00:10<00:02, 37.68it/s, est. speed input: 43453.10 toks/s, output: 42.43 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [00:10<00:01, 39.23it/s, est. speed input: 43429.51 toks/s, output: 42.41 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [00:10<00:01, 38.82it/s, est. speed input: 43379.40 toks/s, output: 42.36 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [00:10<00:01, 38.54it/s, est. speed input: 43331.99 toks/s, output: 42.32 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [00:10<00:01, 38.31it/s, est. speed input: 43285.07 toks/s, output: 42.27 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [00:10<00:01, 38.16it/s, est. speed input: 43239.73 toks/s, output: 42.23 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [00:10<00:01, 38.06it/s, est. speed input: 43195.62 toks/s, output: 42.18 toks/s]
Processed prompts:  90%|█████████ | 462/512 [00:10<00:01, 37.89it/s, est. speed input: 43148.66 toks/s, output: 42.14 toks/s]
Processed prompts:  91%|█████████ | 466/512 [00:11<00:01, 37.74it/s, est. speed input: 43101.61 toks/s, output: 42.09 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [00:11<00:01, 37.80it/s, est. speed input: 43061.70 toks/s, output: 42.05 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [00:11<00:01, 37.61it/s, est. speed input: 43013.78 toks/s, output: 42.01 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [00:11<00:00, 37.56it/s, est. speed input: 42970.10 toks/s, output: 41.96 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [00:11<00:00, 37.68it/s, est. speed input: 42932.44 toks/s, output: 41.93 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [00:11<00:00, 37.66it/s, est. speed input: 42892.00 toks/s, output: 41.89 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [00:11<00:00, 37.69it/s, est. speed input: 42853.61 toks/s, output: 41.85 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [00:11<00:00, 37.79it/s, est. speed input: 42818.85 toks/s, output: 41.82 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [00:11<00:00, 37.81it/s, est. speed input: 42782.89 toks/s, output: 41.78 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [00:12<00:00, 37.75it/s, est. speed input: 42745.27 toks/s, output: 41.74 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [00:12<00:00, 37.74it/s, est. speed input: 42709.27 toks/s, output: 41.71 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:12<00:00, 37.74it/s, est. speed input: 42923.40 toks/s, output: 41.92 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:12<00:00, 41.92it/s, est. speed input: 42923.40 toks/s, output: 41.92 toks/s]
[rank0]:[W126 12:16:00.926184292 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=8192 ==========
Time: 2026-01-26 12:16:02
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-FP8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=1024, max_num_seqs=8
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-FP8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 1024 --max-num-seqs 8 --max-model-len 1025 --max-num-batched-tokens 8192 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_FP8E4M3_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-7B-FP8_M8192.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 12:16:14 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1345344) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1345344) WARNING 01-26 12:16:31 [backends.py:609] Failed to read file <frozen os>
Throughput: 38.03 requests/s, 38977.55 total tokens/s, 38.03 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024

STDERR:
[2026-01-26 12:16:14] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 12:16:14] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 12:16:14] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 12:16:14] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:16:14] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:16:14] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:16:14] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:16:14] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:16:14] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 12:16:14] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 12:16:14] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 12:16:14] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 12:16:14] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 12:16:14] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 12:16:21] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 12:16:21] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 12:16:21] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 12:16:21] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:16:21] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:16:21] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:16:21] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:16:21] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:16:21] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 12:16:21] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 12:16:21] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 12:16:21] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 12:16:21] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 12:16:21] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1345344) [2026-01-26 12:16:23] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1345344) [2026-01-26 12:16:23] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1345344) [2026-01-26 12:16:23] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1345344) [2026-01-26 12:16:23] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1345344) [2026-01-26 12:16:23] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1345344) [2026-01-26 12:16:23] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1345344) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1345344) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.96it/s]
(EngineCore_DP0 pid=1345344) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.41it/s]
(EngineCore_DP0 pid=1345344) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.47it/s]
(EngineCore_DP0 pid=1345344) 
(EngineCore_DP0 pid=1345344) [2026-01-26 12:16:24] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=1345344) [2026-01-26 12:16:25] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 15482880 bytes
(EngineCore_DP0 pid=1345344) [2026-01-26 12:16:25] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=1345344) [2026-01-26 12:16:25] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12042240 bytes
(EngineCore_DP0 pid=1345344) [2026-01-26 12:16:25] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=1345344) [2026-01-26 12:16:25] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 127303680 bytes
(EngineCore_DP0 pid=1345344) [2026-01-26 12:16:25] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=1345344) [2026-01-26 12:16:25] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 63651840 bytes
(EngineCore_DP0 pid=1345344) 2026-01-26 12:16:42,278 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1345344) 2026-01-26 12:16:42,376 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1345344) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:00,  4.72it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  60%|██████    | 3/5 [00:00<00:00, 10.64it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00, 10.06it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00,  9.50it/s]
(EngineCore_DP0 pid=1345344) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 2/4 [00:00<00:00,  8.88it/s]
Capturing CUDA graphs (decode, FULL):  75%|███████▌  | 3/4 [00:00<00:00,  3.56it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  4.84it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 23/1024 [00:00<00:04, 227.94it/s]
Adding requests:   6%|▋         | 64/1024 [00:00<00:02, 330.33it/s]
Adding requests:  10%|▉         | 100/1024 [00:00<00:02, 343.10it/s]
Adding requests:  13%|█▎        | 138/1024 [00:00<00:02, 355.25it/s]
Adding requests:  17%|█▋        | 178/1024 [00:00<00:02, 367.69it/s]
Adding requests:  21%|██▏       | 220/1024 [00:00<00:02, 384.53it/s]
Adding requests:  25%|██▌       | 259/1024 [00:00<00:02, 381.15it/s]
Adding requests:  29%|██▉       | 299/1024 [00:00<00:01, 386.65it/s]
Adding requests:  33%|███▎      | 340/1024 [00:00<00:01, 392.48it/s]
Adding requests:  37%|███▋      | 381/1024 [00:01<00:01, 395.49it/s]
Adding requests:  41%|████▏     | 424/1024 [00:01<00:01, 402.62it/s]
Adding requests:  45%|████▌     | 465/1024 [00:01<00:01, 397.27it/s]
Adding requests:  50%|████▉     | 509/1024 [00:01<00:01, 407.13it/s]
Adding requests:  54%|█████▎    | 550/1024 [00:01<00:01, 405.43it/s]
Adding requests:  58%|█████▊    | 591/1024 [00:01<00:01, 400.33it/s]
Adding requests:  62%|██████▏   | 632/1024 [00:01<00:00, 396.28it/s]
Adding requests:  66%|██████▌   | 672/1024 [00:01<00:00, 387.06it/s]
Adding requests:  70%|██████▉   | 714/1024 [00:01<00:00, 394.59it/s]
Adding requests:  74%|███████▎  | 754/1024 [00:01<00:00, 386.98it/s]
Adding requests:  77%|███████▋  | 793/1024 [00:02<00:00, 386.81it/s]
Adding requests:  82%|████████▏ | 835/1024 [00:02<00:00, 393.75it/s]
Adding requests:  85%|████████▌ | 875/1024 [00:02<00:00, 392.71it/s]
Adding requests:  89%|████████▉ | 915/1024 [00:02<00:00, 391.81it/s]
Adding requests:  93%|█████████▎| 955/1024 [00:02<00:00, 391.01it/s]
Adding requests:  97%|█████████▋| 995/1024 [00:02<00:00, 384.46it/s]
Adding requests: 100%|██████████| 1024/1024 [00:02<00:00, 385.72it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   9%|▉         | 90/1024 [00:00<00:02, 399.55it/s, est. speed input: 409178.73 toks/s, output: 399.56 toks/s]
Processed prompts:  13%|█▎        | 130/1024 [00:01<00:10, 86.07it/s, est. speed input: 105293.96 toks/s, output: 102.82 toks/s]
Processed prompts:  15%|█▍        | 149/1024 [00:01<00:12, 72.87it/s, est. speed input: 90995.55 toks/s, output: 88.86 toks/s]  
Processed prompts:  16%|█▌        | 162/1024 [00:02<00:14, 59.24it/s, est. speed input: 79090.48 toks/s, output: 77.24 toks/s]
Processed prompts:  17%|█▋        | 171/1024 [00:02<00:15, 56.33it/s, est. speed input: 75994.66 toks/s, output: 74.21 toks/s]
Processed prompts:  17%|█▋        | 179/1024 [00:02<00:16, 52.73it/s, est. speed input: 73052.01 toks/s, output: 71.34 toks/s]
Processed prompts:  18%|█▊        | 186/1024 [00:02<00:17, 48.30it/s, est. speed input: 70095.99 toks/s, output: 68.45 toks/s]
Processed prompts:  19%|█▉        | 194/1024 [00:02<00:18, 45.68it/s, est. speed input: 67838.15 toks/s, output: 66.25 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [00:03<00:18, 44.86it/s, est. speed input: 66353.32 toks/s, output: 64.80 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:03<00:18, 43.26it/s, est. speed input: 64722.08 toks/s, output: 63.20 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [00:03<00:19, 42.11it/s, est. speed input: 63296.43 toks/s, output: 61.81 toks/s]
Processed prompts:  22%|██▏       | 226/1024 [00:03<00:19, 41.00it/s, est. speed input: 61949.76 toks/s, output: 60.50 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:03<00:19, 40.06it/s, est. speed input: 60706.77 toks/s, output: 59.28 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:04<00:19, 39.52it/s, est. speed input: 59619.65 toks/s, output: 58.22 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:04<00:19, 39.34it/s, est. speed input: 58686.52 toks/s, output: 57.31 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:04<00:19, 39.17it/s, est. speed input: 57829.08 toks/s, output: 56.47 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:04<00:19, 38.93it/s, est. speed input: 57019.61 toks/s, output: 55.68 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:04<00:19, 38.69it/s, est. speed input: 56264.26 toks/s, output: 54.95 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:05<00:19, 38.54it/s, est. speed input: 55572.21 toks/s, output: 54.27 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:05<00:18, 38.69it/s, est. speed input: 54981.09 toks/s, output: 53.69 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:05<00:18, 38.76it/s, est. speed input: 54426.87 toks/s, output: 53.15 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:05<00:18, 39.83it/s, est. speed input: 54076.58 toks/s, output: 52.81 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:06<00:18, 39.40it/s, est. speed input: 53565.28 toks/s, output: 52.31 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:06<00:17, 39.03it/s, est. speed input: 53078.14 toks/s, output: 51.83 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:06<00:17, 38.91it/s, est. speed input: 52641.70 toks/s, output: 51.41 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:06<00:17, 38.95it/s, est. speed input: 52250.37 toks/s, output: 51.03 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:06<00:17, 38.71it/s, est. speed input: 51846.69 toks/s, output: 50.63 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:07<00:17, 38.59it/s, est. speed input: 51472.80 toks/s, output: 50.27 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:07<00:17, 38.63it/s, est. speed input: 51135.15 toks/s, output: 49.94 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:07<00:16, 38.51it/s, est. speed input: 50798.64 toks/s, output: 49.61 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:07<00:16, 38.60it/s, est. speed input: 50501.65 toks/s, output: 49.32 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:07<00:16, 38.45it/s, est. speed input: 50195.61 toks/s, output: 49.02 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [00:08<00:16, 38.43it/s, est. speed input: 49915.18 toks/s, output: 48.75 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:08<00:16, 38.52it/s, est. speed input: 49659.29 toks/s, output: 48.50 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:08<00:15, 38.45it/s, est. speed input: 49402.07 toks/s, output: 48.24 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:08<00:15, 38.52it/s, est. speed input: 49169.44 toks/s, output: 48.02 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:08<00:15, 38.35it/s, est. speed input: 48926.75 toks/s, output: 47.78 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:09<00:14, 39.60it/s, est. speed input: 48822.98 toks/s, output: 47.68 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:09<00:14, 39.38it/s, est. speed input: 48623.45 toks/s, output: 47.48 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:09<00:14, 39.14it/s, est. speed input: 48425.04 toks/s, output: 47.29 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:09<00:14, 38.98it/s, est. speed input: 48235.40 toks/s, output: 47.10 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:09<00:14, 38.82it/s, est. speed input: 48050.55 toks/s, output: 46.92 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:10<00:14, 38.70it/s, est. speed input: 47871.15 toks/s, output: 46.75 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:10<00:14, 38.71it/s, est. speed input: 47707.55 toks/s, output: 46.59 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:10<00:13, 38.61it/s, est. speed input: 47541.75 toks/s, output: 46.43 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:10<00:13, 38.52it/s, est. speed input: 47380.72 toks/s, output: 46.27 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:10<00:13, 38.52it/s, est. speed input: 47230.32 toks/s, output: 46.12 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:11<00:13, 38.45it/s, est. speed input: 47080.37 toks/s, output: 45.98 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:11<00:13, 38.47it/s, est. speed input: 46940.72 toks/s, output: 45.84 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:11<00:12, 38.46it/s, est. speed input: 46804.70 toks/s, output: 45.71 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:11<00:12, 38.42it/s, est. speed input: 46670.96 toks/s, output: 45.58 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:12<00:12, 38.40it/s, est. speed input: 46542.68 toks/s, output: 45.45 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:12<00:12, 38.50it/s, est. speed input: 46426.28 toks/s, output: 45.34 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:12<00:11, 38.59it/s, est. speed input: 46315.60 toks/s, output: 45.23 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:12<00:11, 38.56it/s, est. speed input: 46201.91 toks/s, output: 45.12 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:12<00:11, 38.45it/s, est. speed input: 46085.88 toks/s, output: 45.01 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:13<00:11, 38.40it/s, est. speed input: 45975.84 toks/s, output: 44.90 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:13<00:11, 38.43it/s, est. speed input: 45872.96 toks/s, output: 44.80 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:13<00:10, 38.52it/s, est. speed input: 45777.76 toks/s, output: 44.70 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:13<00:10, 38.38it/s, est. speed input: 45673.41 toks/s, output: 44.60 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:13<00:10, 38.30it/s, est. speed input: 45572.53 toks/s, output: 44.50 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:14<00:10, 38.24it/s, est. speed input: 45474.93 toks/s, output: 44.41 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:14<00:10, 38.32it/s, est. speed input: 45387.53 toks/s, output: 44.32 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:14<00:09, 38.35it/s, est. speed input: 45300.37 toks/s, output: 44.24 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:14<00:09, 38.38it/s, est. speed input: 45216.89 toks/s, output: 44.16 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:14<00:09, 38.47it/s, est. speed input: 45139.16 toks/s, output: 44.08 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:15<00:09, 38.39it/s, est. speed input: 45055.97 toks/s, output: 44.00 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:15<00:09, 38.37it/s, est. speed input: 44976.73 toks/s, output: 43.92 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:15<00:08, 38.29it/s, est. speed input: 44896.62 toks/s, output: 43.84 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:15<00:08, 38.26it/s, est. speed input: 44819.34 toks/s, output: 43.77 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:15<00:08, 38.25it/s, est. speed input: 44745.05 toks/s, output: 43.70 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:16<00:08, 38.19it/s, est. speed input: 44669.88 toks/s, output: 43.62 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:16<00:08, 38.21it/s, est. speed input: 44599.67 toks/s, output: 43.55 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:16<00:07, 38.24it/s, est. speed input: 44532.48 toks/s, output: 43.49 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:16<00:07, 38.24it/s, est. speed input: 44465.37 toks/s, output: 43.42 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:17<00:07, 38.29it/s, est. speed input: 44402.75 toks/s, output: 43.36 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:17<00:07, 38.35it/s, est. speed input: 44342.22 toks/s, output: 43.30 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:17<00:07, 38.27it/s, est. speed input: 44277.94 toks/s, output: 43.24 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:17<00:06, 38.29it/s, est. speed input: 44218.69 toks/s, output: 43.18 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:17<00:06, 38.16it/s, est. speed input: 44154.06 toks/s, output: 43.12 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:18<00:06, 38.28it/s, est. speed input: 44100.67 toks/s, output: 43.07 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:18<00:06, 39.61it/s, est. speed input: 44100.92 toks/s, output: 43.07 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:18<00:05, 39.16it/s, est. speed input: 44043.68 toks/s, output: 43.01 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:18<00:05, 38.96it/s, est. speed input: 43992.14 toks/s, output: 42.96 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:18<00:05, 38.73it/s, est. speed input: 43938.01 toks/s, output: 42.91 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:19<00:05, 38.54it/s, est. speed input: 43884.14 toks/s, output: 42.86 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:19<00:05, 38.46it/s, est. speed input: 43833.35 toks/s, output: 42.81 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:19<00:04, 38.36it/s, est. speed input: 43781.64 toks/s, output: 42.76 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [00:19<00:04, 38.34it/s, est. speed input: 43733.11 toks/s, output: 42.71 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [00:19<00:04, 38.34it/s, est. speed input: 43686.56 toks/s, output: 42.66 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:20<00:04, 38.30it/s, est. speed input: 43639.10 toks/s, output: 42.62 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [00:20<00:04, 38.26it/s, est. speed input: 43592.06 toks/s, output: 42.57 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [00:20<00:03, 38.44it/s, est. speed input: 43554.27 toks/s, output: 42.53 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [00:20<00:03, 38.38it/s, est. speed input: 43509.80 toks/s, output: 42.49 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [00:20<00:03, 38.42it/s, est. speed input: 43469.48 toks/s, output: 42.45 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [00:21<00:03, 38.38it/s, est. speed input: 43427.43 toks/s, output: 42.41 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [00:21<00:03, 38.38it/s, est. speed input: 43387.03 toks/s, output: 42.37 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [00:21<00:02, 38.50it/s, est. speed input: 43351.90 toks/s, output: 42.34 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [00:21<00:02, 38.43it/s, est. speed input: 43312.24 toks/s, output: 42.30 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [00:22<00:02, 38.51it/s, est. speed input: 43277.32 toks/s, output: 42.26 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [00:22<00:02, 38.40it/s, est. speed input: 43237.64 toks/s, output: 42.22 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [00:22<00:02, 38.39it/s, est. speed input: 43200.91 toks/s, output: 42.19 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [00:22<00:01, 38.43it/s, est. speed input: 43166.30 toks/s, output: 42.15 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [00:22<00:01, 38.50it/s, est. speed input: 43134.14 toks/s, output: 42.12 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [00:23<00:01, 38.51it/s, est. speed input: 43100.99 toks/s, output: 42.09 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [00:23<00:01, 38.43it/s, est. speed input: 43065.64 toks/s, output: 42.06 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [00:23<00:00, 38.38it/s, est. speed input: 43030.99 toks/s, output: 42.02 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [00:23<00:00, 38.37it/s, est. speed input: 42997.75 toks/s, output: 41.99 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [00:23<00:00, 38.39it/s, est. speed input: 42966.08 toks/s, output: 41.96 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [00:24<00:00, 38.47it/s, est. speed input: 42937.19 toks/s, output: 41.93 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [00:24<00:00, 39.87it/s, est. speed input: 42949.79 toks/s, output: 41.94 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:24<00:00, 39.87it/s, est. speed input: 43202.18 toks/s, output: 42.19 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:24<00:00, 42.19it/s, est. speed input: 43202.18 toks/s, output: 42.19 toks/s]
[rank0]:[W126 12:17:12.489762750 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=16384 ==========
Time: 2026-01-26 12:17:14
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-FP8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=2048, max_num_seqs=16
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-FP8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 2048 --max-num-seqs 16 --max-model-len 1025 --max-num-batched-tokens 16384 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_FP8E4M3_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-7B-FP8_M16384.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 12:17:32 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1346882) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1346882) WARNING 01-26 12:17:49 [backends.py:609] Failed to read file <frozen os>
Throughput: 39.49 requests/s, 40476.94 total tokens/s, 39.49 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048

STDERR:
[2026-01-26 12:17:31] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 12:17:32] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 12:17:32] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 12:17:32] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:17:32] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:17:32] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:17:32] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:17:32] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:17:32] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 12:17:32] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 12:17:32] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 12:17:32] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 12:17:32] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 12:17:32] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 12:17:39] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 12:17:40] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 12:17:40] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 12:17:40] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:17:40] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:17:40] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:17:40] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:17:40] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:17:40] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 12:17:40] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 12:17:40] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 12:17:40] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 12:17:40] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 12:17:40] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1346882) [2026-01-26 12:17:41] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1346882) [2026-01-26 12:17:41] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1346882) [2026-01-26 12:17:41] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1346882) [2026-01-26 12:17:41] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1346882) [2026-01-26 12:17:41] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1346882) [2026-01-26 12:17:41] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1346882) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1346882) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
(EngineCore_DP0 pid=1346882) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.42it/s]
(EngineCore_DP0 pid=1346882) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.49it/s]
(EngineCore_DP0 pid=1346882) 
(EngineCore_DP0 pid=1346882) [2026-01-26 12:17:43] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=1346882) [2026-01-26 12:17:43] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 15482880 bytes
(EngineCore_DP0 pid=1346882) [2026-01-26 12:17:43] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=1346882) [2026-01-26 12:17:43] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12042240 bytes
(EngineCore_DP0 pid=1346882) [2026-01-26 12:17:43] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=1346882) [2026-01-26 12:17:43] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 127303680 bytes
(EngineCore_DP0 pid=1346882) [2026-01-26 12:17:43] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=1346882) [2026-01-26 12:17:43] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 63651840 bytes
(EngineCore_DP0 pid=1346882) [rank0]:W0126 12:17:54.827000 1346882 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1346882) [rank0]:W0126 12:17:54.904000 1346882 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1346882) [rank0]:W0126 12:17:56.152000 1346882 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1346882) [rank0]:W0126 12:17:56.275000 1346882 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1346882) 2026-01-26 12:17:59,794 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1346882) 2026-01-26 12:17:59,820 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1346882) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  29%|██▊       | 2/7 [00:00<00:00, 13.07it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  57%|█████▋    | 4/7 [00:00<00:00,  7.90it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  71%|███████▏  | 5/7 [00:00<00:00,  5.32it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  86%|████████▌ | 6/7 [00:01<00:00,  4.16it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:01<00:00,  5.60it/s]
(EngineCore_DP0 pid=1346882) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  40%|████      | 2/5 [00:00<00:00, 19.23it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00, 19.84it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00, 19.76it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   1%|          | 22/2048 [00:00<00:09, 218.34it/s]
Adding requests:   3%|▎         | 62/2048 [00:00<00:06, 324.67it/s]
Adding requests:   5%|▍         | 98/2048 [00:00<00:05, 339.31it/s]
Adding requests:   7%|▋         | 136/2048 [00:00<00:05, 354.74it/s]
Adding requests:   9%|▊         | 176/2048 [00:00<00:05, 367.56it/s]
Adding requests:  11%|█         | 217/2048 [00:00<00:04, 379.98it/s]
Adding requests:  12%|█▎        | 256/2048 [00:00<00:04, 380.13it/s]
Adding requests:  14%|█▍        | 296/2048 [00:00<00:04, 384.36it/s]
Adding requests:  16%|█▋        | 337/2048 [00:00<00:04, 392.04it/s]
Adding requests:  18%|█▊        | 377/2048 [00:01<00:04, 393.57it/s]
Adding requests:  20%|██        | 419/2048 [00:01<00:04, 400.48it/s]
Adding requests:  22%|██▏       | 460/2048 [00:01<00:04, 395.68it/s]
Adding requests:  25%|██▍       | 503/2048 [00:01<00:03, 403.54it/s]
Adding requests:  27%|██▋       | 546/2048 [00:01<00:03, 407.91it/s]
Adding requests:  29%|██▊       | 587/2048 [00:01<00:03, 402.32it/s]
Adding requests:  31%|███       | 628/2048 [00:01<00:03, 397.77it/s]
Adding requests:  33%|███▎      | 668/2048 [00:01<00:03, 386.74it/s]
Adding requests:  35%|███▍      | 709/2048 [00:01<00:03, 391.52it/s]
Adding requests:  37%|███▋      | 749/2048 [00:01<00:03, 379.41it/s]
Adding requests:  39%|███▊      | 789/2048 [00:02<00:03, 382.56it/s]
Adding requests:  40%|████      | 829/2048 [00:02<00:03, 387.15it/s]
Adding requests:  42%|████▏     | 869/2048 [00:02<00:03, 389.80it/s]
Adding requests:  44%|████▍     | 909/2048 [00:02<00:02, 392.29it/s]
Adding requests:  46%|████▋     | 949/2048 [00:02<00:02, 383.86it/s]
Adding requests:  48%|████▊     | 989/2048 [00:02<00:02, 386.24it/s]
Adding requests:  50%|█████     | 1028/2048 [00:02<00:02, 383.58it/s]
Adding requests:  52%|█████▏    | 1067/2048 [00:02<00:02, 380.49it/s]
Adding requests:  54%|█████▍    | 1106/2048 [00:02<00:02, 378.60it/s]
Adding requests:  56%|█████▌    | 1147/2048 [00:02<00:02, 385.07it/s]
Adding requests:  58%|█████▊    | 1186/2048 [00:03<00:02, 383.51it/s]
Adding requests:  60%|█████▉    | 1227/2048 [00:03<00:02, 389.50it/s]
Adding requests:  62%|██████▏   | 1266/2048 [00:03<00:02, 386.37it/s]
Adding requests:  64%|██████▎   | 1305/2048 [00:03<00:01, 383.86it/s]
Adding requests:  66%|██████▌   | 1344/2048 [00:03<00:01, 383.84it/s]
Adding requests:  68%|██████▊   | 1384/2048 [00:03<00:01, 388.32it/s]
Adding requests:  69%|██████▉   | 1423/2048 [00:03<00:01, 385.75it/s]
Adding requests:  71%|███████▏  | 1463/2048 [00:03<00:01, 388.67it/s]
Adding requests:  73%|███████▎  | 1503/2048 [00:03<00:01, 390.82it/s]
Adding requests:  75%|███████▌  | 1543/2048 [00:04<00:01, 390.14it/s]
Adding requests:  77%|███████▋  | 1583/2048 [00:04<00:01, 383.36it/s]
Adding requests:  79%|███████▉  | 1622/2048 [00:04<00:01, 377.43it/s]
Adding requests:  81%|████████  | 1660/2048 [00:04<00:01, 371.25it/s]
Adding requests:  83%|████████▎ | 1699/2048 [00:04<00:00, 375.00it/s]
Adding requests:  85%|████████▍ | 1738/2048 [00:04<00:00, 379.35it/s]
Adding requests:  87%|████████▋ | 1779/2048 [00:04<00:00, 387.41it/s]
Adding requests:  89%|████████▉ | 1818/2048 [00:04<00:00, 381.90it/s]
Adding requests:  91%|█████████ | 1858/2048 [00:04<00:00, 387.00it/s]
Adding requests:  93%|█████████▎| 1897/2048 [00:04<00:00, 386.08it/s]
Adding requests:  95%|█████████▍| 1936/2048 [00:05<00:00, 381.20it/s]
Adding requests:  96%|█████████▋| 1976/2048 [00:05<00:00, 385.00it/s]
Adding requests:  98%|█████████▊| 2015/2048 [00:05<00:00, 380.28it/s]
Adding requests: 100%|██████████| 2048/2048 [00:05<00:00, 383.31it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  10%|█         | 210/2048 [00:00<00:03, 463.89it/s, est. speed input: 475048.45 toks/s, output: 463.90 toks/s]
Processed prompts:  13%|█▎        | 257/2048 [00:01<00:10, 171.26it/s, est. speed input: 207446.18 toks/s, output: 202.58 toks/s]
Processed prompts:  14%|█▎        | 280/2048 [00:02<00:17, 99.19it/s, est. speed input: 138073.06 toks/s, output: 134.84 toks/s] 
Processed prompts:  14%|█▍        | 294/2048 [00:02<00:21, 82.16it/s, est. speed input: 121431.34 toks/s, output: 118.58 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [00:02<00:25, 68.92it/s, est. speed input: 109628.45 toks/s, output: 107.06 toks/s]
Processed prompts:  16%|█▌        | 322/2048 [00:03<00:28, 60.50it/s, est. speed input: 101037.48 toks/s, output: 98.67 toks/s] 
Processed prompts:  17%|█▋        | 338/2048 [00:03<00:31, 54.52it/s, est. speed input: 94420.71 toks/s, output: 92.21 toks/s] 
Processed prompts:  17%|█▋        | 354/2048 [00:04<00:33, 50.19it/s, est. speed input: 89091.98 toks/s, output: 87.00 toks/s]
Processed prompts:  18%|█▊        | 370/2048 [00:04<00:35, 47.02it/s, est. speed input: 84685.82 toks/s, output: 82.70 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [00:04<00:37, 44.87it/s, est. speed input: 81054.39 toks/s, output: 79.15 toks/s]
Processed prompts:  20%|█▉        | 402/2048 [00:05<00:38, 43.24it/s, est. speed input: 77924.74 toks/s, output: 76.10 toks/s]
Processed prompts:  20%|██        | 418/2048 [00:05<00:38, 42.18it/s, est. speed input: 75278.83 toks/s, output: 73.51 toks/s]
Processed prompts:  21%|██        | 434/2048 [00:06<00:38, 42.08it/s, est. speed input: 73234.15 toks/s, output: 71.52 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [00:06<00:38, 41.31it/s, est. speed input: 71189.54 toks/s, output: 69.52 toks/s]
Processed prompts:  23%|██▎       | 466/2048 [00:06<00:38, 40.85it/s, est. speed input: 69406.24 toks/s, output: 67.78 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [00:07<00:38, 40.36it/s, est. speed input: 67769.85 toks/s, output: 66.18 toks/s]
Processed prompts:  24%|██▍       | 498/2048 [00:07<00:38, 40.13it/s, est. speed input: 66337.30 toks/s, output: 64.78 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [00:08<00:38, 39.96it/s, est. speed input: 65048.63 toks/s, output: 63.52 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [00:08<00:38, 39.83it/s, est. speed input: 63878.42 toks/s, output: 62.38 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [00:08<00:37, 39.73it/s, est. speed input: 62810.16 toks/s, output: 61.34 toks/s]
Processed prompts:  27%|██▋       | 562/2048 [00:09<00:37, 39.63it/s, est. speed input: 61830.27 toks/s, output: 60.38 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [00:09<00:37, 39.62it/s, est. speed input: 60945.21 toks/s, output: 59.52 toks/s]
Processed prompts:  29%|██▉       | 594/2048 [00:10<00:36, 39.57it/s, est. speed input: 60122.20 toks/s, output: 58.71 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [00:10<00:36, 39.54it/s, est. speed input: 59362.39 toks/s, output: 57.97 toks/s]
Processed prompts:  31%|███       | 626/2048 [00:10<00:36, 39.49it/s, est. speed input: 58653.69 toks/s, output: 57.28 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [00:11<00:35, 39.48it/s, est. speed input: 58002.02 toks/s, output: 56.64 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [00:11<00:35, 39.46it/s, est. speed input: 57391.80 toks/s, output: 56.05 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [00:12<00:34, 39.45it/s, est. speed input: 56822.50 toks/s, output: 55.49 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [00:12<00:34, 39.44it/s, est. speed input: 56289.85 toks/s, output: 54.97 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [00:12<00:33, 39.47it/s, est. speed input: 55797.42 toks/s, output: 54.49 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [00:13<00:33, 39.42it/s, est. speed input: 55323.79 toks/s, output: 54.03 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [00:13<00:33, 39.44it/s, est. speed input: 54884.93 toks/s, output: 53.60 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [00:14<00:32, 39.44it/s, est. speed input: 54470.28 toks/s, output: 53.19 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [00:14<00:32, 39.37it/s, est. speed input: 54069.52 toks/s, output: 52.80 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [00:14<00:31, 40.03it/s, est. speed input: 53777.28 toks/s, output: 52.52 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [00:15<00:31, 39.90it/s, est. speed input: 53429.53 toks/s, output: 52.18 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [00:15<00:30, 39.79it/s, est. speed input: 53096.90 toks/s, output: 51.85 toks/s]
Processed prompts:  41%|████      | 834/2048 [00:16<00:30, 39.66it/s, est. speed input: 52775.67 toks/s, output: 51.54 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [00:16<00:30, 39.55it/s, est. speed input: 52467.67 toks/s, output: 51.24 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [00:16<00:29, 39.54it/s, est. speed input: 52181.93 toks/s, output: 50.96 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [00:17<00:29, 39.49it/s, est. speed input: 51904.94 toks/s, output: 50.69 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [00:17<00:29, 39.43it/s, est. speed input: 51638.03 toks/s, output: 50.43 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [00:18<00:28, 39.45it/s, est. speed input: 51389.45 toks/s, output: 50.18 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [00:18<00:28, 39.41it/s, est. speed input: 51146.19 toks/s, output: 49.95 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [00:19<00:27, 39.40it/s, est. speed input: 50914.95 toks/s, output: 49.72 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [00:19<00:27, 39.41it/s, est. speed input: 50695.03 toks/s, output: 49.51 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [00:19<00:27, 39.43it/s, est. speed input: 50485.48 toks/s, output: 49.30 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [00:20<00:26, 39.38it/s, est. speed input: 50278.05 toks/s, output: 49.10 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [00:20<00:26, 39.36it/s, est. speed input: 50080.57 toks/s, output: 48.91 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [00:21<00:25, 39.37it/s, est. speed input: 49892.73 toks/s, output: 48.72 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [00:21<00:25, 39.35it/s, est. speed input: 49709.71 toks/s, output: 48.54 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [00:21<00:25, 39.32it/s, est. speed input: 49532.57 toks/s, output: 48.37 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [00:22<00:24, 39.38it/s, est. speed input: 49367.54 toks/s, output: 48.21 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [00:22<00:24, 39.32it/s, est. speed input: 49201.32 toks/s, output: 48.05 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [00:23<00:23, 39.38it/s, est. speed input: 49048.33 toks/s, output: 47.90 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [00:23<00:23, 39.37it/s, est. speed input: 48896.90 toks/s, output: 47.75 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [00:23<00:23, 39.28it/s, est. speed input: 48744.35 toks/s, output: 47.60 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [00:24<00:22, 39.35it/s, est. speed input: 48606.44 toks/s, output: 47.47 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [00:24<00:22, 39.35it/s, est. speed input: 48469.73 toks/s, output: 47.33 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [00:25<00:21, 39.34it/s, est. speed input: 48336.44 toks/s, output: 47.20 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [00:25<00:21, 39.92it/s, est. speed input: 48245.71 toks/s, output: 47.11 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [00:25<00:20, 39.75it/s, est. speed input: 48120.82 toks/s, output: 46.99 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [00:26<00:20, 40.29it/s, est. speed input: 48040.14 toks/s, output: 46.91 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [00:26<00:19, 39.92it/s, est. speed input: 47917.20 toks/s, output: 46.79 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [00:27<00:19, 39.72it/s, est. speed input: 47801.20 toks/s, output: 46.68 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [00:27<00:19, 39.57it/s, est. speed input: 47688.35 toks/s, output: 46.57 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [00:27<00:19, 39.42it/s, est. speed input: 47575.71 toks/s, output: 46.46 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [00:28<00:18, 39.39it/s, est. speed input: 47470.73 toks/s, output: 46.36 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [00:28<00:17, 39.95it/s, est. speed input: 47401.44 toks/s, output: 46.29 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [00:29<00:17, 39.77it/s, est. speed input: 47302.29 toks/s, output: 46.19 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [00:29<00:17, 39.58it/s, est. speed input: 47202.30 toks/s, output: 46.10 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [00:29<00:16, 39.48it/s, est. speed input: 47107.01 toks/s, output: 46.00 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [00:30<00:16, 39.37it/s, est. speed input: 47011.82 toks/s, output: 45.91 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [00:30<00:16, 39.29it/s, est. speed input: 46919.03 toks/s, output: 45.82 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [00:31<00:15, 39.28it/s, est. speed input: 46831.58 toks/s, output: 45.73 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [00:31<00:15, 39.24it/s, est. speed input: 46743.93 toks/s, output: 45.65 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [00:31<00:14, 39.94it/s, est. speed input: 46695.06 toks/s, output: 45.60 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [00:32<00:14, 39.70it/s, est. speed input: 46611.83 toks/s, output: 45.52 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [00:32<00:14, 39.51it/s, est. speed input: 46529.55 toks/s, output: 45.44 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [00:33<00:13, 39.50it/s, est. speed input: 46454.81 toks/s, output: 45.37 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [00:33<00:13, 39.99it/s, est. speed input: 46405.10 toks/s, output: 45.32 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [00:33<00:12, 39.71it/s, est. speed input: 46328.25 toks/s, output: 45.24 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [00:34<00:12, 40.25it/s, est. speed input: 46285.99 toks/s, output: 45.20 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [00:34<00:11, 39.89it/s, est. speed input: 46212.04 toks/s, output: 45.13 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [00:35<00:11, 39.68it/s, est. speed input: 46141.63 toks/s, output: 45.06 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [00:35<00:11, 39.46it/s, est. speed input: 46069.85 toks/s, output: 44.99 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [00:35<00:10, 40.06it/s, est. speed input: 46031.65 toks/s, output: 44.95 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [00:36<00:10, 39.81it/s, est. speed input: 45966.37 toks/s, output: 44.89 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [00:36<00:10, 39.55it/s, est. speed input: 45898.65 toks/s, output: 44.82 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [00:37<00:09, 39.44it/s, est. speed input: 45835.24 toks/s, output: 44.76 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [00:37<00:09, 39.34it/s, est. speed input: 45772.41 toks/s, output: 44.70 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [00:38<00:08, 39.30it/s, est. speed input: 45711.96 toks/s, output: 44.64 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [00:38<00:08, 39.22it/s, est. speed input: 45650.69 toks/s, output: 44.58 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [00:38<00:07, 39.87it/s, est. speed input: 45619.18 toks/s, output: 44.55 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [00:39<00:07, 40.37it/s, est. speed input: 45589.25 toks/s, output: 44.52 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [00:39<00:07, 39.91it/s, est. speed input: 45529.22 toks/s, output: 44.46 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [00:40<00:06, 39.68it/s, est. speed input: 45473.97 toks/s, output: 44.41 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [00:40<00:06, 39.48it/s, est. speed input: 45418.11 toks/s, output: 44.35 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [00:40<00:06, 39.40it/s, est. speed input: 45365.38 toks/s, output: 44.30 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [00:41<00:05, 39.30it/s, est. speed input: 45312.08 toks/s, output: 44.25 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [00:41<00:05, 39.22it/s, est. speed input: 45259.72 toks/s, output: 44.20 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [00:42<00:04, 39.18it/s, est. speed input: 45208.77 toks/s, output: 44.15 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [00:42<00:04, 39.14it/s, est. speed input: 45158.41 toks/s, output: 44.10 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [00:42<00:03, 39.79it/s, est. speed input: 45133.48 toks/s, output: 44.08 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [00:43<00:03, 39.58it/s, est. speed input: 45085.13 toks/s, output: 44.03 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [00:43<00:03, 39.45it/s, est. speed input: 45038.44 toks/s, output: 43.98 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [00:44<00:02, 39.33it/s, est. speed input: 44991.45 toks/s, output: 43.94 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [00:44<00:02, 39.24it/s, est. speed input: 44945.40 toks/s, output: 43.89 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [00:44<00:01, 39.21it/s, est. speed input: 44901.07 toks/s, output: 43.85 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [00:45<00:01, 39.82it/s, est. speed input: 44879.02 toks/s, output: 43.83 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [00:45<00:01, 39.60it/s, est. speed input: 44835.76 toks/s, output: 43.78 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [00:46<00:00, 39.44it/s, est. speed input: 44792.65 toks/s, output: 43.74 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [00:46<00:00, 40.13it/s, est. speed input: 44776.85 toks/s, output: 43.73 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:46<00:00, 40.13it/s, est. speed input: 45084.41 toks/s, output: 44.03 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:46<00:00, 44.03it/s, est. speed input: 45084.41 toks/s, output: 44.03 toks/s]
[rank0]:[W126 12:18:55.110988548 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=32768 ==========
Time: 2026-01-26 12:18:57
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-FP8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=4096, max_num_seqs=32
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-FP8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 4096 --max-num-seqs 32 --max-model-len 1025 --max-num-batched-tokens 32768 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_FP8E4M3_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-7B-FP8_M32768.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 12:19:25 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1348868) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1348868) WARNING 01-26 12:19:43 [backends.py:609] Failed to read file <frozen os>
Throughput: 39.01 requests/s, 39989.66 total tokens/s, 39.01 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096

STDERR:
[2026-01-26 12:19:24] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 12:19:25] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 12:19:25] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 12:19:25] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:19:25] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:19:25] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:19:25] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:19:25] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:19:25] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 12:19:25] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 12:19:25] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 12:19:25] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 12:19:25] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 12:19:25] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 12:19:31] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 12:19:32] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 12:19:32] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 12:19:32] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:19:32] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:19:32] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:19:32] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:19:32] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:19:32] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 12:19:32] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 12:19:32] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 12:19:32] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 12:19:32] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 12:19:32] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1348868) [2026-01-26 12:19:34] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1348868) [2026-01-26 12:19:34] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1348868) [2026-01-26 12:19:34] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1348868) [2026-01-26 12:19:34] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1348868) [2026-01-26 12:19:34] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1348868) [2026-01-26 12:19:34] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1348868) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1348868) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.94it/s]
(EngineCore_DP0 pid=1348868) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.41it/s]
(EngineCore_DP0 pid=1348868) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.47it/s]
(EngineCore_DP0 pid=1348868) 
(EngineCore_DP0 pid=1348868) [2026-01-26 12:19:37] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=1348868) [2026-01-26 12:19:37] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 15482880 bytes
(EngineCore_DP0 pid=1348868) [2026-01-26 12:19:37] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=1348868) [2026-01-26 12:19:37] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12042240 bytes
(EngineCore_DP0 pid=1348868) [2026-01-26 12:19:37] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=1348868) [2026-01-26 12:19:37] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 127303680 bytes
(EngineCore_DP0 pid=1348868) [2026-01-26 12:19:37] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=1348868) [2026-01-26 12:19:37] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 63651840 bytes
(EngineCore_DP0 pid=1348868) [rank0]:W0126 12:19:48.628000 1348868 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1348868) [rank0]:W0126 12:19:48.706000 1348868 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1348868) [rank0]:W0126 12:19:49.926000 1348868 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1348868) [rank0]:W0126 12:19:50.054000 1348868 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1348868) 2026-01-26 12:19:53,719 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1348868) 2026-01-26 12:19:53,746 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1348868) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   9%|▉         | 1/11 [00:00<00:08,  1.12it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  18%|█▊        | 2/11 [00:01<00:04,  2.20it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  36%|███▋      | 4/11 [00:01<00:01,  4.84it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  55%|█████▍    | 6/11 [00:01<00:00,  7.47it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  73%|███████▎  | 8/11 [00:01<00:00,  9.98it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  91%|█████████ | 10/11 [00:01<00:00, 12.18it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00,  7.16it/s]
(EngineCore_DP0 pid=1348868) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  29%|██▊       | 2/7 [00:00<00:00, 19.11it/s]
Capturing CUDA graphs (decode, FULL):  71%|███████▏  | 5/7 [00:00<00:00, 10.89it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:01<00:00,  5.12it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:01<00:00,  6.11it/s]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   1%|          | 25/4096 [00:00<00:16, 249.47it/s]
Adding requests:   2%|▏         | 65/4096 [00:00<00:12, 335.79it/s]
Adding requests:   2%|▏         | 101/4096 [00:00<00:11, 344.77it/s]
Adding requests:   3%|▎         | 139/4096 [00:00<00:11, 357.39it/s]
Adding requests:   4%|▍         | 178/4096 [00:00<00:10, 367.73it/s]
Adding requests:   5%|▌         | 217/4096 [00:00<00:10, 373.70it/s]
Adding requests:   6%|▌         | 255/4096 [00:00<00:10, 375.14it/s]
Adding requests:   7%|▋         | 295/4096 [00:00<00:10, 380.02it/s]
Adding requests:   8%|▊         | 336/4096 [00:00<00:09, 389.14it/s]
Adding requests:   9%|▉         | 376/4096 [00:01<00:09, 391.98it/s]
Adding requests:  10%|█         | 418/4096 [00:01<00:09, 398.94it/s]
Adding requests:  11%|█         | 458/4096 [00:01<00:09, 394.40it/s]
Adding requests:  12%|█▏        | 500/4096 [00:01<00:08, 401.84it/s]
Adding requests:  13%|█▎        | 542/4096 [00:01<00:08, 406.97it/s]
Adding requests:  14%|█▍        | 583/4096 [00:01<00:08, 401.73it/s]
Adding requests:  15%|█▌        | 624/4096 [00:01<00:08, 394.61it/s]
Adding requests:  16%|█▌        | 664/4096 [00:01<00:08, 388.32it/s]
Adding requests:  17%|█▋        | 704/4096 [00:01<00:08, 390.25it/s]
Adding requests:  18%|█▊        | 744/4096 [00:01<00:08, 383.99it/s]
Adding requests:  19%|█▉        | 784/4096 [00:02<00:08, 386.86it/s]
Adding requests:  20%|██        | 823/4096 [00:02<00:08, 385.79it/s]
Adding requests:  21%|██        | 864/4096 [00:02<00:08, 390.03it/s]
Adding requests:  22%|██▏       | 905/4096 [00:02<00:08, 395.84it/s]
Adding requests:  23%|██▎       | 945/4096 [00:02<00:08, 385.62it/s]
Adding requests:  24%|██▍       | 984/4096 [00:02<00:08, 386.78it/s]
Adding requests:  25%|██▍       | 1023/4096 [00:02<00:08, 382.38it/s]
Adding requests:  26%|██▌       | 1062/4096 [00:02<00:07, 380.32it/s]
Adding requests:  27%|██▋       | 1101/4096 [00:02<00:08, 373.92it/s]
Adding requests:  28%|██▊       | 1141/4096 [00:02<00:07, 379.34it/s]
Adding requests:  29%|██▉       | 1179/4096 [00:03<00:07, 378.68it/s]
Adding requests:  30%|██▉       | 1220/4096 [00:03<00:07, 384.94it/s]
Adding requests:  31%|███       | 1259/4096 [00:03<00:07, 382.94it/s]
Adding requests:  32%|███▏      | 1298/4096 [00:03<00:07, 380.48it/s]
Adding requests:  33%|███▎      | 1337/4096 [00:03<00:07, 382.00it/s]
Adding requests:  34%|███▎      | 1378/4096 [00:03<00:07, 387.39it/s]
Adding requests:  35%|███▍      | 1417/4096 [00:03<00:06, 382.80it/s]
Adding requests:  36%|███▌      | 1457/4096 [00:03<00:06, 386.90it/s]
Adding requests:  37%|███▋      | 1497/4096 [00:03<00:06, 390.38it/s]
Adding requests:  38%|███▊      | 1537/4096 [00:04<00:06, 387.83it/s]
Adding requests:  38%|███▊      | 1576/4096 [00:04<00:06, 383.22it/s]
Adding requests:  39%|███▉      | 1615/4096 [00:04<00:06, 380.91it/s]
Adding requests:  40%|████      | 1654/4096 [00:04<00:06, 372.71it/s]
Adding requests:  41%|████▏     | 1692/4096 [00:04<00:06, 373.92it/s]
Adding requests:  42%|████▏     | 1732/4096 [00:04<00:06, 378.59it/s]
Adding requests:  43%|████▎     | 1773/4096 [00:04<00:06, 385.40it/s]
Adding requests:  44%|████▍     | 1812/4096 [00:04<00:05, 383.07it/s]
Adding requests:  45%|████▌     | 1851/4096 [00:04<00:05, 383.09it/s]
Adding requests:  46%|████▌     | 1891/4096 [00:04<00:05, 387.71it/s]
Adding requests:  47%|████▋     | 1931/4096 [00:05<00:05, 390.83it/s]
Adding requests:  48%|████▊     | 1971/4096 [00:05<00:05, 391.76it/s]
Adding requests:  49%|████▉     | 2011/4096 [00:05<00:05, 387.81it/s]
Adding requests:  50%|█████     | 2050/4096 [00:05<00:05, 381.42it/s]
Adding requests:  51%|█████     | 2089/4096 [00:05<00:05, 370.30it/s]
Adding requests:  52%|█████▏    | 2129/4096 [00:05<00:05, 376.67it/s]
Adding requests:  53%|█████▎    | 2167/4096 [00:05<00:05, 374.31it/s]
Adding requests:  54%|█████▍    | 2205/4096 [00:05<00:05, 369.87it/s]
Adding requests:  55%|█████▍    | 2244/4096 [00:05<00:04, 375.17it/s]
Adding requests:  56%|█████▌    | 2285/4096 [00:05<00:04, 382.41it/s]
Adding requests:  57%|█████▋    | 2324/4096 [00:06<00:04, 379.34it/s]
Adding requests:  58%|█████▊    | 2364/4096 [00:06<00:04, 383.12it/s]
Adding requests:  59%|█████▊    | 2405/4096 [00:06<00:04, 388.78it/s]
Adding requests:  60%|█████▉    | 2445/4096 [00:06<00:04, 390.18it/s]
Adding requests:  61%|██████    | 2485/4096 [00:06<00:04, 388.81it/s]
Adding requests:  62%|██████▏   | 2526/4096 [00:06<00:03, 393.19it/s]
Adding requests:  63%|██████▎   | 2570/4096 [00:06<00:03, 404.61it/s]
Adding requests:  64%|██████▎   | 2611/4096 [00:06<00:03, 401.08it/s]
Adding requests:  65%|██████▍   | 2652/4096 [00:06<00:03, 391.23it/s]
Adding requests:  66%|██████▌   | 2692/4096 [00:07<00:03, 388.85it/s]
Adding requests:  67%|██████▋   | 2731/4096 [00:07<00:03, 386.07it/s]
Adding requests:  68%|██████▊   | 2772/4096 [00:07<00:03, 392.06it/s]
Adding requests:  69%|██████▊   | 2813/4096 [00:07<00:03, 395.41it/s]
Adding requests:  70%|██████▉   | 2853/4096 [00:07<00:03, 395.68it/s]
Adding requests:  71%|███████   | 2893/4096 [00:07<00:03, 394.07it/s]
Adding requests:  72%|███████▏  | 2933/4096 [00:07<00:02, 394.72it/s]
Adding requests:  73%|███████▎  | 2973/4096 [00:07<00:02, 395.69it/s]
Adding requests:  74%|███████▎  | 3013/4096 [00:07<00:02, 395.09it/s]
Adding requests:  75%|███████▍  | 3054/4096 [00:07<00:02, 399.24it/s]
Adding requests:  76%|███████▌  | 3094/4096 [00:08<00:02, 397.96it/s]
Adding requests:  77%|███████▋  | 3135/4096 [00:08<00:02, 400.74it/s]
Adding requests:  78%|███████▊  | 3176/4096 [00:08<00:02, 392.64it/s]
Adding requests:  79%|███████▊  | 3216/4096 [00:08<00:02, 389.91it/s]
Adding requests:  80%|███████▉  | 3257/4096 [00:08<00:02, 394.95it/s]
Adding requests:  80%|████████  | 3297/4096 [00:08<00:02, 381.16it/s]
Adding requests:  81%|████████▏ | 3336/4096 [00:08<00:02, 379.33it/s]
Adding requests:  82%|████████▏ | 3377/4096 [00:08<00:01, 386.95it/s]
Adding requests:  83%|████████▎ | 3417/4096 [00:08<00:01, 387.72it/s]
Adding requests:  84%|████████▍ | 3456/4096 [00:08<00:01, 387.65it/s]
Adding requests:  85%|████████▌ | 3495/4096 [00:09<00:01, 385.02it/s]
Adding requests:  86%|████████▋ | 3538/4096 [00:09<00:01, 397.67it/s]
Adding requests:  87%|████████▋ | 3578/4096 [00:09<00:01, 395.35it/s]
Adding requests:  88%|████████▊ | 3618/4096 [00:09<00:01, 396.45it/s]
Adding requests:  89%|████████▉ | 3658/4096 [00:09<00:01, 394.76it/s]
Adding requests:  90%|█████████ | 3698/4096 [00:09<00:01, 377.66it/s]
Adding requests:  91%|█████████▏| 3738/4096 [00:09<00:00, 382.90it/s]
Adding requests:  92%|█████████▏| 3777/4096 [00:09<00:00, 373.95it/s]
Adding requests:  93%|█████████▎| 3815/4096 [00:09<00:00, 364.11it/s]
Adding requests:  94%|█████████▍| 3854/4096 [00:10<00:00, 370.24it/s]
Adding requests:  95%|█████████▌| 3892/4096 [00:10<00:00, 370.99it/s]
Adding requests:  96%|█████████▌| 3930/4096 [00:10<00:00, 366.43it/s]
Adding requests:  97%|█████████▋| 3969/4096 [00:10<00:00, 370.60it/s]
Adding requests:  98%|█████████▊| 4007/4096 [00:10<00:00, 371.28it/s]
Adding requests:  99%|█████████▉| 4045/4096 [00:10<00:00, 370.37it/s]
Adding requests: 100%|█████████▉| 4083/4096 [00:10<00:00, 371.33it/s]
Adding requests: 100%|██████████| 4096/4096 [00:10<00:00, 384.12it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  10%|▉         | 405/4096 [00:00<00:07, 525.49it/s, est. speed input: 538157.67 toks/s, output: 525.50 toks/s]
Processed prompts:  11%|█         | 458/4096 [00:01<00:14, 248.71it/s, est. speed input: 296047.28 toks/s, output: 289.11 toks/s]
Processed prompts:  12%|█▏        | 484/4096 [00:02<00:24, 148.59it/s, est. speed input: 206734.27 toks/s, output: 201.89 toks/s]
Processed prompts:  12%|█▏        | 501/4096 [00:03<00:36, 97.88it/s, est. speed input: 159855.69 toks/s, output: 156.11 toks/s] 
Processed prompts:  13%|█▎        | 533/4096 [00:04<00:46, 76.73it/s, est. speed input: 135743.82 toks/s, output: 132.56 toks/s]
Processed prompts:  14%|█▍        | 565/4096 [00:04<00:55, 64.02it/s, est. speed input: 119729.95 toks/s, output: 116.92 toks/s]
Processed prompts:  15%|█▍        | 597/4096 [00:05<01:02, 55.97it/s, est. speed input: 108319.75 toks/s, output: 105.78 toks/s]
Processed prompts:  15%|█▌        | 629/4096 [00:06<01:08, 50.62it/s, est. speed input: 99713.43 toks/s, output: 97.38 toks/s]  
Processed prompts:  16%|█▌        | 661/4096 [00:07<01:12, 47.09it/s, est. speed input: 93066.60 toks/s, output: 90.88 toks/s]
Processed prompts:  17%|█▋        | 693/4096 [00:08<01:16, 44.72it/s, est. speed input: 87773.47 toks/s, output: 85.72 toks/s]
Processed prompts:  18%|█▊        | 725/4096 [00:08<01:18, 43.05it/s, est. speed input: 83419.65 toks/s, output: 81.46 toks/s]
Processed prompts:  18%|█▊        | 757/4096 [00:09<01:19, 42.23it/s, est. speed input: 79967.16 toks/s, output: 78.09 toks/s]
Processed prompts:  19%|█▉        | 789/4096 [00:10<01:19, 41.34it/s, est. speed input: 76890.96 toks/s, output: 75.09 toks/s]
Processed prompts:  20%|██        | 821/4096 [00:11<01:20, 40.75it/s, est. speed input: 74266.09 toks/s, output: 72.53 toks/s]
Processed prompts:  21%|██        | 853/4096 [00:12<01:20, 40.27it/s, est. speed input: 71967.34 toks/s, output: 70.28 toks/s]
Processed prompts:  22%|██▏       | 885/4096 [00:12<01:20, 39.97it/s, est. speed input: 69971.72 toks/s, output: 68.33 toks/s]
Processed prompts:  22%|██▏       | 917/4096 [00:13<01:19, 39.75it/s, est. speed input: 68204.74 toks/s, output: 66.61 toks/s]
Processed prompts:  23%|██▎       | 949/4096 [00:14<01:19, 39.58it/s, est. speed input: 66633.38 toks/s, output: 65.07 toks/s]
Processed prompts:  24%|██▍       | 981/4096 [00:15<01:18, 39.49it/s, est. speed input: 65236.93 toks/s, output: 63.71 toks/s]
Processed prompts:  25%|██▍       | 1013/4096 [00:16<01:18, 39.38it/s, est. speed input: 63967.70 toks/s, output: 62.47 toks/s]
Processed prompts:  26%|██▌       | 1045/4096 [00:17<01:17, 39.33it/s, est. speed input: 62825.22 toks/s, output: 61.35 toks/s]
Processed prompts:  26%|██▋       | 1077/4096 [00:17<01:16, 39.27it/s, est. speed input: 61783.92 toks/s, output: 60.34 toks/s]
Processed prompts:  27%|██▋       | 1109/4096 [00:18<01:16, 39.25it/s, est. speed input: 60836.47 toks/s, output: 59.41 toks/s]
Processed prompts:  28%|██▊       | 1141/4096 [00:19<01:15, 39.23it/s, est. speed input: 59967.97 toks/s, output: 58.56 toks/s]
Processed prompts:  29%|██▊       | 1173/4096 [00:20<01:14, 39.17it/s, est. speed input: 59160.01 toks/s, output: 57.77 toks/s]
Processed prompts:  29%|██▉       | 1205/4096 [00:21<01:13, 39.46it/s, est. speed input: 58478.50 toks/s, output: 57.11 toks/s]
Processed prompts:  30%|███       | 1237/4096 [00:21<01:12, 39.64it/s, est. speed input: 57842.42 toks/s, output: 56.49 toks/s]
Processed prompts:  31%|███       | 1269/4096 [00:22<01:11, 39.44it/s, est. speed input: 57194.11 toks/s, output: 55.85 toks/s]
Processed prompts:  32%|███▏      | 1301/4096 [00:23<01:11, 39.33it/s, est. speed input: 56596.44 toks/s, output: 55.27 toks/s]
Processed prompts:  33%|███▎      | 1333/4096 [00:24<01:09, 39.55it/s, est. speed input: 56085.37 toks/s, output: 54.77 toks/s]
Processed prompts:  33%|███▎      | 1365/4096 [00:25<01:09, 39.43it/s, est. speed input: 55566.53 toks/s, output: 54.26 toks/s]
Processed prompts:  34%|███▍      | 1397/4096 [00:25<01:08, 39.33it/s, est. speed input: 55076.60 toks/s, output: 53.79 toks/s]
Processed prompts:  35%|███▍      | 1429/4096 [00:26<01:07, 39.58it/s, est. speed input: 54662.08 toks/s, output: 53.38 toks/s]
Processed prompts:  36%|███▌      | 1461/4096 [00:27<01:06, 39.42it/s, est. speed input: 54226.10 toks/s, output: 52.96 toks/s]
Processed prompts:  36%|███▋      | 1493/4096 [00:28<01:06, 39.29it/s, est. speed input: 53813.47 toks/s, output: 52.55 toks/s]
Processed prompts:  37%|███▋      | 1525/4096 [00:29<01:05, 39.54it/s, est. speed input: 53466.32 toks/s, output: 52.21 toks/s]
Processed prompts:  38%|███▊      | 1557/4096 [00:30<01:03, 39.72it/s, est. speed input: 53138.20 toks/s, output: 51.89 toks/s]
Processed prompts:  39%|███▉      | 1589/4096 [00:30<01:03, 39.48it/s, est. speed input: 52783.94 toks/s, output: 51.55 toks/s]
Processed prompts:  40%|███▉      | 1621/4096 [00:31<01:02, 39.69it/s, est. speed input: 52490.91 toks/s, output: 51.26 toks/s]
Processed prompts:  40%|████      | 1653/4096 [00:32<01:01, 39.45it/s, est. speed input: 52169.96 toks/s, output: 50.95 toks/s]
Processed prompts:  41%|████      | 1685/4096 [00:33<01:01, 39.33it/s, est. speed input: 51869.66 toks/s, output: 50.65 toks/s]
Processed prompts:  42%|████▏     | 1717/4096 [00:34<01:00, 39.55it/s, est. speed input: 51616.02 toks/s, output: 50.41 toks/s]
Processed prompts:  43%|████▎     | 1749/4096 [00:34<00:59, 39.67it/s, est. speed input: 51370.05 toks/s, output: 50.17 toks/s]
Processed prompts:  43%|████▎     | 1781/4096 [00:35<00:58, 39.44it/s, est. speed input: 51104.19 toks/s, output: 49.91 toks/s]
Processed prompts:  44%|████▍     | 1813/4096 [00:36<00:58, 39.30it/s, est. speed input: 50852.79 toks/s, output: 49.66 toks/s]
Processed prompts:  45%|████▌     | 1845/4096 [00:37<00:57, 39.17it/s, est. speed input: 50609.54 toks/s, output: 49.42 toks/s]
Processed prompts:  46%|████▌     | 1877/4096 [00:38<00:56, 39.44it/s, est. speed input: 50409.33 toks/s, output: 49.23 toks/s]
Processed prompts:  47%|████▋     | 1909/4096 [00:38<00:55, 39.32it/s, est. speed input: 50189.21 toks/s, output: 49.01 toks/s]
Processed prompts:  47%|████▋     | 1941/4096 [00:39<00:55, 39.16it/s, est. speed input: 49972.83 toks/s, output: 48.80 toks/s]
Processed prompts:  48%|████▊     | 1973/4096 [00:40<00:53, 39.42it/s, est. speed input: 49795.96 toks/s, output: 48.63 toks/s]
Processed prompts:  49%|████▉     | 2005/4096 [00:41<00:53, 39.28it/s, est. speed input: 49599.50 toks/s, output: 48.44 toks/s]
Processed prompts:  50%|████▉     | 2037/4096 [00:42<00:52, 39.12it/s, est. speed input: 49405.72 toks/s, output: 48.25 toks/s]
Processed prompts:  51%|█████     | 2069/4096 [00:43<00:51, 39.37it/s, est. speed input: 49247.74 toks/s, output: 48.09 toks/s]
Processed prompts:  51%|█████▏    | 2101/4096 [00:43<00:50, 39.19it/s, est. speed input: 49068.28 toks/s, output: 47.92 toks/s]
Processed prompts:  52%|█████▏    | 2133/4096 [00:44<00:50, 39.12it/s, est. speed input: 48899.21 toks/s, output: 47.75 toks/s]
Processed prompts:  53%|█████▎    | 2165/4096 [00:45<00:49, 39.35it/s, est. speed input: 48757.77 toks/s, output: 47.61 toks/s]
Processed prompts:  54%|█████▎    | 2197/4096 [00:46<00:48, 39.20it/s, est. speed input: 48598.16 toks/s, output: 47.46 toks/s]
Processed prompts:  54%|█████▍    | 2229/4096 [00:47<00:47, 39.08it/s, est. speed input: 48442.78 toks/s, output: 47.31 toks/s]
Processed prompts:  55%|█████▌    | 2261/4096 [00:47<00:47, 39.00it/s, est. speed input: 48293.54 toks/s, output: 47.16 toks/s]
Processed prompts:  56%|█████▌    | 2293/4096 [00:48<00:46, 38.93it/s, est. speed input: 48147.97 toks/s, output: 47.02 toks/s]
Processed prompts:  57%|█████▋    | 2325/4096 [00:49<00:45, 38.92it/s, est. speed input: 48009.94 toks/s, output: 46.88 toks/s]
Processed prompts:  58%|█████▊    | 2357/4096 [00:50<00:44, 38.89it/s, est. speed input: 47874.76 toks/s, output: 46.75 toks/s]
Processed prompts:  58%|█████▊    | 2389/4096 [00:51<00:43, 38.89it/s, est. speed input: 47745.79 toks/s, output: 46.63 toks/s]
Processed prompts:  59%|█████▉    | 2421/4096 [00:52<00:43, 38.86it/s, est. speed input: 47618.20 toks/s, output: 46.50 toks/s]
Processed prompts:  60%|█████▉    | 2453/4096 [00:52<00:42, 38.78it/s, est. speed input: 47491.46 toks/s, output: 46.38 toks/s]
Processed prompts:  61%|██████    | 2485/4096 [00:53<00:41, 38.77it/s, est. speed input: 47371.06 toks/s, output: 46.26 toks/s]
Processed prompts:  61%|██████▏   | 2517/4096 [00:54<00:40, 39.09it/s, est. speed input: 47274.54 toks/s, output: 46.17 toks/s]
Processed prompts:  62%|██████▏   | 2549/4096 [00:55<00:39, 38.96it/s, est. speed input: 47159.65 toks/s, output: 46.05 toks/s]
Processed prompts:  63%|██████▎   | 2581/4096 [00:56<00:38, 39.23it/s, est. speed input: 47069.42 toks/s, output: 45.97 toks/s]
Processed prompts:  64%|██████▍   | 2613/4096 [00:56<00:37, 39.08it/s, est. speed input: 46961.80 toks/s, output: 45.86 toks/s]
Processed prompts:  65%|██████▍   | 2645/4096 [00:57<00:37, 38.97it/s, est. speed input: 46857.44 toks/s, output: 45.76 toks/s]
Processed prompts:  65%|██████▌   | 2677/4096 [00:58<00:36, 38.89it/s, est. speed input: 46755.56 toks/s, output: 45.66 toks/s]
Processed prompts:  66%|██████▌   | 2709/4096 [00:59<00:35, 38.83it/s, est. speed input: 46656.49 toks/s, output: 45.56 toks/s]
Processed prompts:  67%|██████▋   | 2741/4096 [01:00<00:34, 39.09it/s, est. speed input: 46576.33 toks/s, output: 45.48 toks/s]
Processed prompts:  68%|██████▊   | 2773/4096 [01:01<00:33, 38.97it/s, est. speed input: 46482.13 toks/s, output: 45.39 toks/s]
Processed prompts:  68%|██████▊   | 2805/4096 [01:01<00:33, 38.91it/s, est. speed input: 46391.81 toks/s, output: 45.30 toks/s]
Processed prompts:  69%|██████▉   | 2837/4096 [01:02<00:32, 38.86it/s, est. speed input: 46303.29 toks/s, output: 45.22 toks/s]
Processed prompts:  70%|███████   | 2869/4096 [01:03<00:31, 38.79it/s, est. speed input: 46215.18 toks/s, output: 45.13 toks/s]
Processed prompts:  71%|███████   | 2901/4096 [01:04<00:29, 39.88it/s, est. speed input: 46185.80 toks/s, output: 45.10 toks/s]
Processed prompts:  72%|███████▏  | 2933/4096 [01:05<00:29, 39.53it/s, est. speed input: 46103.33 toks/s, output: 45.02 toks/s]
Processed prompts:  72%|███████▏  | 2965/4096 [01:05<00:28, 39.27it/s, est. speed input: 46021.68 toks/s, output: 44.94 toks/s]
Processed prompts:  73%|███████▎  | 2997/4096 [01:06<00:28, 39.06it/s, est. speed input: 45940.94 toks/s, output: 44.86 toks/s]
Processed prompts:  74%|███████▍  | 3029/4096 [01:07<00:27, 38.94it/s, est. speed input: 45863.07 toks/s, output: 44.79 toks/s]
Processed prompts:  75%|███████▍  | 3061/4096 [01:08<00:26, 38.83it/s, est. speed input: 45786.22 toks/s, output: 44.71 toks/s]
Processed prompts:  76%|███████▌  | 3093/4096 [01:09<00:25, 38.77it/s, est. speed input: 45711.80 toks/s, output: 44.64 toks/s]
Processed prompts:  76%|███████▋  | 3125/4096 [01:10<00:25, 38.76it/s, est. speed input: 45640.32 toks/s, output: 44.57 toks/s]
Processed prompts:  77%|███████▋  | 3157/4096 [01:10<00:24, 38.70it/s, est. speed input: 45568.30 toks/s, output: 44.50 toks/s]
Processed prompts:  78%|███████▊  | 3189/4096 [01:11<00:23, 38.67it/s, est. speed input: 45498.44 toks/s, output: 44.43 toks/s]
Processed prompts:  79%|███████▊  | 3221/4096 [01:12<00:22, 38.66it/s, est. speed input: 45430.87 toks/s, output: 44.37 toks/s]
Processed prompts:  79%|███████▉  | 3253/4096 [01:13<00:21, 38.63it/s, est. speed input: 45363.85 toks/s, output: 44.30 toks/s]
Processed prompts:  80%|████████  | 3285/4096 [01:14<00:21, 38.61it/s, est. speed input: 45298.26 toks/s, output: 44.24 toks/s]
Processed prompts:  81%|████████  | 3317/4096 [01:15<00:20, 38.60it/s, est. speed input: 45234.07 toks/s, output: 44.17 toks/s]
Processed prompts:  82%|████████▏ | 3349/4096 [01:15<00:19, 38.61it/s, est. speed input: 45172.08 toks/s, output: 44.11 toks/s]
Processed prompts:  83%|████████▎ | 3381/4096 [01:16<00:18, 38.59it/s, est. speed input: 45110.53 toks/s, output: 44.05 toks/s]
Processed prompts:  83%|████████▎ | 3413/4096 [01:17<00:17, 38.63it/s, est. speed input: 45052.31 toks/s, output: 44.00 toks/s]
Processed prompts:  84%|████████▍ | 3445/4096 [01:18<00:16, 38.63it/s, est. speed input: 44994.38 toks/s, output: 43.94 toks/s]
Processed prompts:  85%|████████▍ | 3477/4096 [01:19<00:16, 38.61it/s, est. speed input: 44936.78 toks/s, output: 43.88 toks/s]
Processed prompts:  86%|████████▌ | 3509/4096 [01:20<00:15, 38.61it/s, est. speed input: 44880.77 toks/s, output: 43.83 toks/s]
Processed prompts:  86%|████████▋ | 3541/4096 [01:20<00:14, 38.91it/s, est. speed input: 44837.90 toks/s, output: 43.79 toks/s]
Processed prompts:  87%|████████▋ | 3573/4096 [01:21<00:13, 38.81it/s, est. speed input: 44783.56 toks/s, output: 43.73 toks/s]
Processed prompts:  88%|████████▊ | 3605/4096 [01:22<00:12, 38.75it/s, est. speed input: 44730.88 toks/s, output: 43.68 toks/s]
Processed prompts:  89%|████████▉ | 3637/4096 [01:23<00:11, 38.73it/s, est. speed input: 44680.30 toks/s, output: 43.63 toks/s]
Processed prompts:  90%|████████▉ | 3669/4096 [01:24<00:10, 39.02it/s, est. speed input: 44641.94 toks/s, output: 43.60 toks/s]
Processed prompts:  90%|█████████ | 3701/4096 [01:24<00:10, 38.85it/s, est. speed input: 44590.46 toks/s, output: 43.55 toks/s]
Processed prompts:  91%|█████████ | 3733/4096 [01:25<00:09, 38.76it/s, est. speed input: 44540.78 toks/s, output: 43.50 toks/s]
Processed prompts:  92%|█████████▏| 3765/4096 [01:26<00:08, 38.69it/s, est. speed input: 44492.06 toks/s, output: 43.45 toks/s]
Processed prompts:  93%|█████████▎| 3797/4096 [01:27<00:07, 38.67it/s, est. speed input: 44445.17 toks/s, output: 43.40 toks/s]
Processed prompts:  93%|█████████▎| 3829/4096 [01:28<00:06, 38.63it/s, est. speed input: 44398.40 toks/s, output: 43.36 toks/s]
Processed prompts:  94%|█████████▍| 3861/4096 [01:29<00:06, 38.58it/s, est. speed input: 44351.46 toks/s, output: 43.31 toks/s]
Processed prompts:  95%|█████████▌| 3893/4096 [01:29<00:05, 38.57it/s, est. speed input: 44306.51 toks/s, output: 43.27 toks/s]
Processed prompts:  96%|█████████▌| 3925/4096 [01:30<00:04, 39.28it/s, est. speed input: 44286.93 toks/s, output: 43.25 toks/s]
Processed prompts:  97%|█████████▋| 3957/4096 [01:31<00:03, 39.09it/s, est. speed input: 44244.26 toks/s, output: 43.21 toks/s]
Processed prompts:  97%|█████████▋| 3989/4096 [01:32<00:02, 39.21it/s, est. speed input: 44211.01 toks/s, output: 43.17 toks/s]
Processed prompts:  98%|█████████▊| 4021/4096 [01:33<00:01, 38.98it/s, est. speed input: 44167.88 toks/s, output: 43.13 toks/s]
Processed prompts:  99%|█████████▉| 4053/4096 [01:34<00:01, 39.19it/s, est. speed input: 44137.52 toks/s, output: 43.10 toks/s]
Processed prompts: 100%|█████████▉| 4085/4096 [01:34<00:00, 48.60it/s, est. speed input: 44349.59 toks/s, output: 43.31 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [01:34<00:00, 48.60it/s, est. speed input: 44468.78 toks/s, output: 43.43 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [01:34<00:00, 43.43it/s, est. speed input: 44468.78 toks/s, output: 43.43 toks/s]
[rank0]:[W126 12:21:43.369900211 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=65536 ==========
Time: 2026-01-26 12:21:45
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-FP8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=8192, max_num_seqs=64
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-FP8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 8192 --max-num-seqs 64 --max-model-len 1025 --max-num-batched-tokens 65536 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_FP8E4M3_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-7B-FP8_M65536.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 12:22:35 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1351827) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1351827) WARNING 01-26 12:22:52 [backends.py:609] Failed to read file <frozen os>
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 240, in _initialize_kv_caches
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     available_gpu_memory = self.model_executor.determine_available_memory()
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     return self.collective_rpc("determine_available_memory")
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     result = run_method(self.driver_worker, method, args, kwargs)
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/root/vllmbench/vllm/v1/serial_utils.py", line 461, in run_method
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 340, in determine_available_memory
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     self.model_runner.profile_run()
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4474, in profile_run
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     hidden_states, last_hidden_states = self._dummy_run(
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]                                         ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4198, in _dummy_run
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     outputs = self.model(
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]               ^^^^^^^^^^^
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 583, in forward
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     hidden_states = self.model(
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]                     ^^^^^^^^^^^
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/root/vllmbench/vllm/compilation/decorators.py", line 526, in __call__
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/root/vllmbench/vllm/compilation/wrapper.py", line 218, in __call__
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     return self._call_with_optional_nvtx_range(
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/root/vllmbench/vllm/compilation/wrapper.py", line 109, in _call_with_optional_nvtx_range
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     return callable_fn(*args, **kwargs)
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 832, in compile_wrapper
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     return fn(*args, **kwargs)
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 418, in forward
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     def forward(
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     return fn(*args, **kwargs)
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/root/vllmbench/vllm/compilation/caching.py", line 54, in __call__
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     return self.optimized_call(*args, **kwargs)
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 837, in call_wrapped
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     return self._wrapped_call(self, *args, **kwargs)
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 413, in __call__
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     raise e
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 400, in __call__
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     return super(self.cls, obj).__call__(*args, **kwargs)  # type: ignore[misc]
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "<eval_with_key>.58", line 325, in forward
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     submod_2 = self.submod_2(getitem_3, s72, l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_scale_, l_self_modules_layers_modules_0_modules_post_attention_layernorm_parameters_weight_, getitem_4, l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_scale_, l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_input_layernorm_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_bias_, l_positions_, l_self_modules_layers_modules_0_modules_self_attn_modules_rotary_emb_buffers_cos_sin_cache_);  getitem_3 = l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_scale_ = l_self_modules_layers_modules_0_modules_post_attention_layernorm_parameters_weight_ = getitem_4 = l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_scale_ = l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_input_layernorm_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_bias_ = None
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/root/vllmbench/vllm/compilation/piecewise_backend.py", line 178, in __call__
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     return range_entry.runnable(*args)
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/standalone_compile.py", line 63, in __call__
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     return self._compiled_fn(*args)
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     return fn(*args, **kwargs)
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/aot_autograd.py", line 1130, in forward
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     return compiled_fn(full_args)
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 353, in runtime_wrapper
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     all_outs = call_func_at_runtime_with_args(
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/utils.py", line 129, in call_func_at_runtime_with_args
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     out = normalize_as_list(f(args))
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]                             ^^^^^^^
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 724, in inner_fn
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     outs = compiled_fn(args)
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]            ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 526, in wrapper
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     return compiled_fn(runtime_args)
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/output_code.py", line 613, in __call__
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     return self.current_callable(inputs)
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/utils.py", line 2962, in run
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     out = model(new_inputs)
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]           ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/tmp/torchinductor_root/u6/cu6dytawyh3h74e6lffae3logvtiims3p4oi2vj4ej76rdwc6mjk.py", line 1093, in call
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     buf17 = torch.ops.slidesparse.quant_slide_fp8.default(buf16, 'Qwen2.5-7B-FP8', 8)
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_ops.py", line 841, in __call__
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     return self._op(*args, **kwargs)
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/root/vllmbench/slidesparse/core/kernels.py", line 521, in _quant_slide_fp8_impl
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     return fn(input, L)
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]            ^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/root/vllmbench/slidesparse/csrc/fused_quant_slide_triton/build/H100_cc90_py312_cu129_x86_64/quant_slide_tuned_Qwen2.5-7B.py", line 233, in quant_slide_fp8_triton
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     _quant_slide_fp8_kernel[(M,)](
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/triton/runtime/jit.py", line 419, in <lambda>
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/triton/runtime/jit.py", line 756, in run
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     launch_metadata = kernel.launch_metadata(grid, stream, *bound_args.values())
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 490, in launch_metadata
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     self._init_handles()
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 473, in _init_handles
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]     self.module, self.function, self.n_regs, self.n_spills, self.n_max_threads = driver.active.utils.load_binary(
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866]                                                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827) ERROR 01-26 12:23:00 [core.py:866] RuntimeError: Triton Error [CUDA]: an illegal memory access was encountered

STDERR:
[2026-01-26 12:22:34] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 12:22:35] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 12:22:35] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 12:22:35] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:22:35] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:22:35] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:22:35] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:22:35] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:22:35] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 12:22:35] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 12:22:35] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 12:22:35] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 12:22:35] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 12:22:35] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 12:22:42] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 12:22:42] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 12:22:42] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 12:22:42] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:22:42] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:22:42] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:22:42] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:22:42] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 12:22:42] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 12:22:42] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 12:22:42] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 12:22:42] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 12:22:42] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 12:22:42] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1351827) [2026-01-26 12:22:44] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1351827) [2026-01-26 12:22:44] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1351827) [2026-01-26 12:22:44] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1351827) [2026-01-26 12:22:44] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1351827) [2026-01-26 12:22:44] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1351827) [2026-01-26 12:22:44] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1351827) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1351827) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.95it/s]
(EngineCore_DP0 pid=1351827) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.40it/s]
(EngineCore_DP0 pid=1351827) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.46it/s]
(EngineCore_DP0 pid=1351827) 
(EngineCore_DP0 pid=1351827) [2026-01-26 12:22:46] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=1351827) [2026-01-26 12:22:46] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 15482880 bytes
(EngineCore_DP0 pid=1351827) [2026-01-26 12:22:46] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=1351827) [2026-01-26 12:22:46] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12042240 bytes
(EngineCore_DP0 pid=1351827) [2026-01-26 12:22:46] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=1351827) [2026-01-26 12:22:46] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 127303680 bytes
(EngineCore_DP0 pid=1351827) [2026-01-26 12:22:46] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=1351827) [2026-01-26 12:22:46] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 63651840 bytes
(EngineCore_DP0 pid=1351827) [rank0]:W0126 12:22:57.943000 1351827 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1351827) [rank0]:W0126 12:22:58.018000 1351827 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1351827) [rank0]:W0126 12:22:59.248000 1351827 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1351827) [rank0]:W0126 12:22:59.366000 1351827 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1351827) Process EngineCore_DP0:
(EngineCore_DP0 pid=1351827) Traceback (most recent call last):
(EngineCore_DP0 pid=1351827)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=1351827)     self.run()
(EngineCore_DP0 pid=1351827)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=1351827)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=1351827)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=1351827)     raise e
(EngineCore_DP0 pid=1351827)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=1351827)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=1351827)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=1351827)     super().__init__(
(EngineCore_DP0 pid=1351827)   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=1351827)     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=1351827)                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827)   File "/root/vllmbench/vllm/v1/engine/core.py", line 240, in _initialize_kv_caches
(EngineCore_DP0 pid=1351827)     available_gpu_memory = self.model_executor.determine_available_memory()
(EngineCore_DP0 pid=1351827)                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827)   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
(EngineCore_DP0 pid=1351827)     return self.collective_rpc("determine_available_memory")
(EngineCore_DP0 pid=1351827)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827)   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
(EngineCore_DP0 pid=1351827)     result = run_method(self.driver_worker, method, args, kwargs)
(EngineCore_DP0 pid=1351827)              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827)   File "/root/vllmbench/vllm/v1/serial_utils.py", line 461, in run_method
(EngineCore_DP0 pid=1351827)     return func(*args, **kwargs)
(EngineCore_DP0 pid=1351827)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827)   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1351827)     return func(*args, **kwargs)
(EngineCore_DP0 pid=1351827)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827)   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 340, in determine_available_memory
(EngineCore_DP0 pid=1351827)     self.model_runner.profile_run()
(EngineCore_DP0 pid=1351827)   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4474, in profile_run
(EngineCore_DP0 pid=1351827)     hidden_states, last_hidden_states = self._dummy_run(
(EngineCore_DP0 pid=1351827)                                         ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827)   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1351827)     return func(*args, **kwargs)
(EngineCore_DP0 pid=1351827)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827)   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4198, in _dummy_run
(EngineCore_DP0 pid=1351827)     outputs = self.model(
(EngineCore_DP0 pid=1351827)               ^^^^^^^^^^^
(EngineCore_DP0 pid=1351827)   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=1351827)     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=1351827)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1351827)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1351827)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1351827)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1351827)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 583, in forward
(EngineCore_DP0 pid=1351827)     hidden_states = self.model(
(EngineCore_DP0 pid=1351827)                     ^^^^^^^^^^^
(EngineCore_DP0 pid=1351827)   File "/root/vllmbench/vllm/compilation/decorators.py", line 526, in __call__
(EngineCore_DP0 pid=1351827)     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
(EngineCore_DP0 pid=1351827)              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827)   File "/root/vllmbench/vllm/compilation/wrapper.py", line 218, in __call__
(EngineCore_DP0 pid=1351827)     return self._call_with_optional_nvtx_range(
(EngineCore_DP0 pid=1351827)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827)   File "/root/vllmbench/vllm/compilation/wrapper.py", line 109, in _call_with_optional_nvtx_range
(EngineCore_DP0 pid=1351827)     return callable_fn(*args, **kwargs)
(EngineCore_DP0 pid=1351827)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827)   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 832, in compile_wrapper
(EngineCore_DP0 pid=1351827)     return fn(*args, **kwargs)
(EngineCore_DP0 pid=1351827)            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 418, in forward
(EngineCore_DP0 pid=1351827)     def forward(
(EngineCore_DP0 pid=1351827)   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=1351827)     return fn(*args, **kwargs)
(EngineCore_DP0 pid=1351827)            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827)   File "/root/vllmbench/vllm/compilation/caching.py", line 54, in __call__
(EngineCore_DP0 pid=1351827)     return self.optimized_call(*args, **kwargs)
(EngineCore_DP0 pid=1351827)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827)   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 837, in call_wrapped
(EngineCore_DP0 pid=1351827)     return self._wrapped_call(self, *args, **kwargs)
(EngineCore_DP0 pid=1351827)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827)   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 413, in __call__
(EngineCore_DP0 pid=1351827)     raise e
(EngineCore_DP0 pid=1351827)   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 400, in __call__
(EngineCore_DP0 pid=1351827)     return super(self.cls, obj).__call__(*args, **kwargs)  # type: ignore[misc]
(EngineCore_DP0 pid=1351827)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1351827)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1351827)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1351827)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1351827)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827)   File "<eval_with_key>.58", line 325, in forward
(EngineCore_DP0 pid=1351827)     submod_2 = self.submod_2(getitem_3, s72, l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_scale_, l_self_modules_layers_modules_0_modules_post_attention_layernorm_parameters_weight_, getitem_4, l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_scale_, l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_input_layernorm_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_bias_, l_positions_, l_self_modules_layers_modules_0_modules_self_attn_modules_rotary_emb_buffers_cos_sin_cache_);  getitem_3 = l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_scale_ = l_self_modules_layers_modules_0_modules_post_attention_layernorm_parameters_weight_ = getitem_4 = l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_scale_ = l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_input_layernorm_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_bias_ = None
(EngineCore_DP0 pid=1351827)                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827)   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=1351827)     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=1351827)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827)   File "/root/vllmbench/vllm/compilation/piecewise_backend.py", line 178, in __call__
(EngineCore_DP0 pid=1351827)     return range_entry.runnable(*args)
(EngineCore_DP0 pid=1351827)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/standalone_compile.py", line 63, in __call__
(EngineCore_DP0 pid=1351827)     return self._compiled_fn(*args)
(EngineCore_DP0 pid=1351827)            ^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827)   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=1351827)     return fn(*args, **kwargs)
(EngineCore_DP0 pid=1351827)            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/aot_autograd.py", line 1130, in forward
(EngineCore_DP0 pid=1351827)     return compiled_fn(full_args)
(EngineCore_DP0 pid=1351827)            ^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 353, in runtime_wrapper
(EngineCore_DP0 pid=1351827)     all_outs = call_func_at_runtime_with_args(
(EngineCore_DP0 pid=1351827)                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/utils.py", line 129, in call_func_at_runtime_with_args
(EngineCore_DP0 pid=1351827)     out = normalize_as_list(f(args))
(EngineCore_DP0 pid=1351827)                             ^^^^^^^
(EngineCore_DP0 pid=1351827)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 724, in inner_fn
(EngineCore_DP0 pid=1351827)     outs = compiled_fn(args)
(EngineCore_DP0 pid=1351827)            ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 526, in wrapper
(EngineCore_DP0 pid=1351827)     return compiled_fn(runtime_args)
(EngineCore_DP0 pid=1351827)            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/output_code.py", line 613, in __call__
(EngineCore_DP0 pid=1351827)     return self.current_callable(inputs)
(EngineCore_DP0 pid=1351827)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/utils.py", line 2962, in run
(EngineCore_DP0 pid=1351827)     out = model(new_inputs)
(EngineCore_DP0 pid=1351827)           ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827)   File "/tmp/torchinductor_root/u6/cu6dytawyh3h74e6lffae3logvtiims3p4oi2vj4ej76rdwc6mjk.py", line 1093, in call
(EngineCore_DP0 pid=1351827)     buf17 = torch.ops.slidesparse.quant_slide_fp8.default(buf16, 'Qwen2.5-7B-FP8', 8)
(EngineCore_DP0 pid=1351827)             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827)   File "/usr/local/lib/python3.12/dist-packages/torch/_ops.py", line 841, in __call__
(EngineCore_DP0 pid=1351827)     return self._op(*args, **kwargs)
(EngineCore_DP0 pid=1351827)            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827)   File "/root/vllmbench/slidesparse/core/kernels.py", line 521, in _quant_slide_fp8_impl
(EngineCore_DP0 pid=1351827)     return fn(input, L)
(EngineCore_DP0 pid=1351827)            ^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827)   File "/root/vllmbench/slidesparse/csrc/fused_quant_slide_triton/build/H100_cc90_py312_cu129_x86_64/quant_slide_tuned_Qwen2.5-7B.py", line 233, in quant_slide_fp8_triton
(EngineCore_DP0 pid=1351827)     _quant_slide_fp8_kernel[(M,)](
(EngineCore_DP0 pid=1351827)   File "/usr/local/lib/python3.12/dist-packages/triton/runtime/jit.py", line 419, in <lambda>
(EngineCore_DP0 pid=1351827)     return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)
(EngineCore_DP0 pid=1351827)                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827)   File "/usr/local/lib/python3.12/dist-packages/triton/runtime/jit.py", line 756, in run
(EngineCore_DP0 pid=1351827)     launch_metadata = kernel.launch_metadata(grid, stream, *bound_args.values())
(EngineCore_DP0 pid=1351827)                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827)   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 490, in launch_metadata
(EngineCore_DP0 pid=1351827)     self._init_handles()
(EngineCore_DP0 pid=1351827)   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 473, in _init_handles
(EngineCore_DP0 pid=1351827)     self.module, self.function, self.n_regs, self.n_spills, self.n_max_threads = driver.active.utils.load_binary(
(EngineCore_DP0 pid=1351827)                                                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1351827) RuntimeError: Triton Error [CUDA]: an illegal memory access was encountered
[rank0]:[W126 12:23:01.272064520 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

ERROR: Test failed for M=65536

========== M=512 ==========
Time: 2026-01-26 15:15:34
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-FP8-SlideSparse-2_8
Params: prompt_len=512, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-FP8-SlideSparse-2_8 --dataset-name random --input-len 512 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 513 --max-num-batched-tokens 513 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_FP8E4M3_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-14B-FP8_M512.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 15:15:41 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1525615) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1525615) WARNING 01-26 15:16:04 [backends.py:609] Failed to read file <frozen os>
Throughput: 23.86 requests/s, 12239.47 total tokens/s, 23.86 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128

STDERR:
[2026-01-26 15:15:41] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 15:15:41] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-FP8'
[2026-01-26 15:15:41] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-FP8
[2026-01-26 15:15:41] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:15:41] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:15:41] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:15:41] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:15:41] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:15:41] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-FP8'
[2026-01-26 15:15:41] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 15:15:41] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 15:15:41] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 15:15:41] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 15:15:41] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 15:15:48] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 15:15:48] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-FP8'
[2026-01-26 15:15:48] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-FP8
[2026-01-26 15:15:48] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:15:48] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:15:48] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:15:48] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:15:48] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:15:48] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-FP8'
[2026-01-26 15:15:48] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 15:15:48] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 15:15:48] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 15:15:48] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 15:15:48] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1525615) [2026-01-26 15:15:50] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1525615) [2026-01-26 15:15:50] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1525615) [2026-01-26 15:15:50] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1525615) [2026-01-26 15:15:50] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1525615) [2026-01-26 15:15:50] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-14B-FP8
(EngineCore_DP0 pid=1525615) [2026-01-26 15:15:50] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1525615) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1525615) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.31it/s]
(EngineCore_DP0 pid=1525615) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.19it/s]
(EngineCore_DP0 pid=1525615) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:01<00:00,  1.63it/s]
(EngineCore_DP0 pid=1525615) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.45it/s]
(EngineCore_DP0 pid=1525615) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.43it/s]
(EngineCore_DP0 pid=1525615) 
(EngineCore_DP0 pid=1525615) [2026-01-26 15:15:54] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [7168, 7680] -> 1D uint8
(EngineCore_DP0 pid=1525615) [2026-01-26 15:15:55] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 34406400 bytes
(EngineCore_DP0 pid=1525615) [2026-01-26 15:15:55] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 7680] -> 1D uint8
(EngineCore_DP0 pid=1525615) [2026-01-26 15:15:55] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 24576000 bytes
(EngineCore_DP0 pid=1525615) [2026-01-26 15:15:55] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [27648, 7680] -> 1D uint8
(EngineCore_DP0 pid=1525615) [2026-01-26 15:15:55] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 132710400 bytes
(EngineCore_DP0 pid=1525615) [2026-01-26 15:15:55] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 20736] -> 1D uint8
(EngineCore_DP0 pid=1525615) [2026-01-26 15:15:55] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 66355200 bytes
(EngineCore_DP0 pid=1525615) 2026-01-26 15:16:18,167 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1525615) 2026-01-26 15:16:18,206 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1525615) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  3.16it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  2.14it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  2.24it/s]
(EngineCore_DP0 pid=1525615) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  3.40it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  3.40it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  30%|███       | 39/128 [00:00<00:00, 384.57it/s]
Adding requests:  86%|████████▌ | 110/128 [00:00<00:00, 573.70it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 561.18it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:02, 45.16it/s, est. speed input: 23129.57 toks/s, output: 45.17 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:00<00:03, 30.15it/s, est. speed input: 16250.02 toks/s, output: 31.74 toks/s]
Processed prompts:  11%|█         | 14/128 [00:00<00:04, 27.57it/s, est. speed input: 14974.34 toks/s, output: 29.24 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:00<00:04, 26.59it/s, est. speed input: 14486.12 toks/s, output: 28.29 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:00<00:04, 25.90it/s, est. speed input: 14151.23 toks/s, output: 27.64 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:00<00:04, 25.40it/s, est. speed input: 13902.85 toks/s, output: 27.15 toks/s]
Processed prompts:  20%|██        | 26/128 [00:00<00:04, 25.10it/s, est. speed input: 13725.87 toks/s, output: 26.81 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:01<00:03, 24.92it/s, est. speed input: 13594.53 toks/s, output: 26.55 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:01<00:03, 24.83it/s, est. speed input: 13494.46 toks/s, output: 26.36 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:01<00:03, 24.75it/s, est. speed input: 13411.47 toks/s, output: 26.19 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:01<00:03, 24.71it/s, est. speed input: 13343.14 toks/s, output: 26.06 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:01<00:03, 24.64it/s, est. speed input: 13281.07 toks/s, output: 25.94 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:01<00:03, 24.58it/s, est. speed input: 13225.72 toks/s, output: 25.83 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:01<00:03, 24.55it/s, est. speed input: 13178.98 toks/s, output: 25.74 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:01<00:03, 24.50it/s, est. speed input: 13135.64 toks/s, output: 25.66 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:02<00:03, 24.51it/s, est. speed input: 13101.59 toks/s, output: 25.59 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:02<00:02, 24.50it/s, est. speed input: 13069.82 toks/s, output: 25.53 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:02<00:02, 24.50it/s, est. speed input: 13041.58 toks/s, output: 25.47 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:02<00:02, 24.49it/s, est. speed input: 13015.84 toks/s, output: 25.42 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:02<00:02, 24.47it/s, est. speed input: 12991.68 toks/s, output: 25.37 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:02<00:02, 24.47it/s, est. speed input: 12970.40 toks/s, output: 25.33 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:02<00:02, 24.43it/s, est. speed input: 12948.10 toks/s, output: 25.29 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:02<00:02, 24.43it/s, est. speed input: 12929.32 toks/s, output: 25.25 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:03<00:02, 24.44it/s, est. speed input: 12913.28 toks/s, output: 25.22 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:03<00:01, 24.45it/s, est. speed input: 12898.37 toks/s, output: 25.19 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:03<00:01, 24.47it/s, est. speed input: 12885.62 toks/s, output: 25.17 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:03<00:01, 24.51it/s, est. speed input: 12875.13 toks/s, output: 25.15 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:03<00:01, 24.52it/s, est. speed input: 12864.41 toks/s, output: 25.13 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:03<00:01, 24.52it/s, est. speed input: 12854.10 toks/s, output: 25.11 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:03<00:01, 24.50it/s, est. speed input: 12843.51 toks/s, output: 25.08 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:03<00:01, 24.52it/s, est. speed input: 12834.97 toks/s, output: 25.07 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:04<00:01, 24.50it/s, est. speed input: 12825.47 toks/s, output: 25.05 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:04<00:00, 24.49it/s, est. speed input: 12816.90 toks/s, output: 25.03 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:04<00:00, 24.47it/s, est. speed input: 12807.81 toks/s, output: 25.02 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:04<00:00, 24.45it/s, est. speed input: 12799.00 toks/s, output: 25.00 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:04<00:00, 24.41it/s, est. speed input: 12789.72 toks/s, output: 24.98 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:04<00:00, 24.45it/s, est. speed input: 12783.58 toks/s, output: 24.97 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:04<00:00, 24.47it/s, est. speed input: 12777.54 toks/s, output: 24.96 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:04<00:00, 24.47it/s, est. speed input: 12771.34 toks/s, output: 24.94 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:05<00:00, 24.51it/s, est. speed input: 12767.18 toks/s, output: 24.94 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:05<00:00, 24.53it/s, est. speed input: 12762.65 toks/s, output: 24.93 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:05<00:00, 24.53it/s, est. speed input: 12762.65 toks/s, output: 24.93 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:05<00:00, 24.93it/s, est. speed input: 12762.65 toks/s, output: 24.93 toks/s]
[rank0]:[W126 15:16:26.736697079 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=1024 ==========
Time: 2026-01-26 15:16:28
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-FP8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-FP8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 1025 --max-num-batched-tokens 1025 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_FP8E4M3_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-14B-FP8_M1024.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 15:16:36 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1526895) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1526895) WARNING 01-26 15:16:59 [backends.py:609] Failed to read file <frozen os>
Throughput: 17.06 requests/s, 17488.28 total tokens/s, 17.06 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128

STDERR:
[2026-01-26 15:16:35] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 15:16:36] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-FP8'
[2026-01-26 15:16:36] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-FP8
[2026-01-26 15:16:36] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:16:36] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:16:36] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:16:36] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:16:36] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:16:36] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-FP8'
[2026-01-26 15:16:36] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 15:16:36] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 15:16:36] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 15:16:36] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 15:16:36] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 15:16:43] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 15:16:43] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-FP8'
[2026-01-26 15:16:43] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-FP8
[2026-01-26 15:16:43] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:16:43] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:16:43] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:16:43] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:16:43] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:16:43] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-FP8'
[2026-01-26 15:16:43] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 15:16:43] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 15:16:43] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 15:16:43] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 15:16:43] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1526895) [2026-01-26 15:16:45] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1526895) [2026-01-26 15:16:45] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1526895) [2026-01-26 15:16:45] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1526895) [2026-01-26 15:16:45] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1526895) [2026-01-26 15:16:45] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-14B-FP8
(EngineCore_DP0 pid=1526895) [2026-01-26 15:16:45] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1526895) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1526895) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.29it/s]
(EngineCore_DP0 pid=1526895) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.19it/s]
(EngineCore_DP0 pid=1526895) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.63it/s]
(EngineCore_DP0 pid=1526895) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.45it/s]
(EngineCore_DP0 pid=1526895) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.42it/s]
(EngineCore_DP0 pid=1526895) 
(EngineCore_DP0 pid=1526895) [2026-01-26 15:16:49] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [7168, 7680] -> 1D uint8
(EngineCore_DP0 pid=1526895) [2026-01-26 15:16:49] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 34406400 bytes
(EngineCore_DP0 pid=1526895) [2026-01-26 15:16:49] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 7680] -> 1D uint8
(EngineCore_DP0 pid=1526895) [2026-01-26 15:16:49] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 24576000 bytes
(EngineCore_DP0 pid=1526895) [2026-01-26 15:16:49] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [27648, 7680] -> 1D uint8
(EngineCore_DP0 pid=1526895) [2026-01-26 15:16:49] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 132710400 bytes
(EngineCore_DP0 pid=1526895) [2026-01-26 15:16:49] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 20736] -> 1D uint8
(EngineCore_DP0 pid=1526895) [2026-01-26 15:16:49] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 66355200 bytes
(EngineCore_DP0 pid=1526895) 2026-01-26 15:17:13,135 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1526895) 2026-01-26 15:17:13,183 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1526895) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  4.32it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  6.24it/s]
(EngineCore_DP0 pid=1526895) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00, 11.11it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  16%|█▌        | 20/128 [00:00<00:00, 195.60it/s]
Adding requests:  48%|████▊     | 61/128 [00:00<00:00, 316.78it/s]
Adding requests:  77%|███████▋  | 98/128 [00:00<00:00, 336.95it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 330.96it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 2/128 [00:00<00:08, 15.38it/s, est. speed input: 15751.32 toks/s, output: 15.38 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:07, 17.01it/s, est. speed input: 17150.51 toks/s, output: 16.75 toks/s]
Processed prompts:   5%|▍         | 6/128 [00:00<00:06, 17.50it/s, est. speed input: 17594.50 toks/s, output: 17.18 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:00<00:06, 17.72it/s, est. speed input: 17814.27 toks/s, output: 17.40 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:00<00:06, 17.91it/s, est. speed input: 17985.50 toks/s, output: 17.56 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:00<00:06, 18.02it/s, est. speed input: 18093.34 toks/s, output: 17.67 toks/s]
Processed prompts:  11%|█         | 14/128 [00:00<00:06, 17.99it/s, est. speed input: 18130.61 toks/s, output: 17.70 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:00<00:06, 18.07it/s, est. speed input: 18200.15 toks/s, output: 17.77 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:01<00:06, 18.05it/s, est. speed input: 18226.04 toks/s, output: 17.80 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:01<00:06, 17.99it/s, est. speed input: 18232.02 toks/s, output: 17.80 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:01<00:05, 17.98it/s, est. speed input: 18246.74 toks/s, output: 17.82 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:01<00:05, 18.04it/s, est. speed input: 18276.16 toks/s, output: 17.85 toks/s]
Processed prompts:  20%|██        | 26/128 [00:01<00:05, 18.08it/s, est. speed input: 18301.48 toks/s, output: 17.87 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:01<00:05, 18.05it/s, est. speed input: 18309.98 toks/s, output: 17.88 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:01<00:05, 18.06it/s, est. speed input: 18322.74 toks/s, output: 17.89 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:01<00:05, 18.09it/s, est. speed input: 18340.73 toks/s, output: 17.91 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:01<00:05, 18.03it/s, est. speed input: 18339.88 toks/s, output: 17.91 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:02<00:05, 18.06it/s, est. speed input: 18350.81 toks/s, output: 17.92 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:02<00:05, 17.98it/s, est. speed input: 18344.70 toks/s, output: 17.91 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:02<00:04, 18.04it/s, est. speed input: 18357.70 toks/s, output: 17.93 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:02<00:04, 18.00it/s, est. speed input: 18356.97 toks/s, output: 17.93 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:02<00:04, 18.04it/s, est. speed input: 18366.21 toks/s, output: 17.94 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:02<00:04, 18.06it/s, est. speed input: 18374.25 toks/s, output: 17.94 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:02<00:04, 18.06it/s, est. speed input: 18378.56 toks/s, output: 17.95 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:02<00:04, 18.05it/s, est. speed input: 18382.49 toks/s, output: 17.95 toks/s]
Processed prompts:  41%|████      | 52/128 [00:02<00:04, 18.00it/s, est. speed input: 18379.18 toks/s, output: 17.95 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:03<00:04, 18.04it/s, est. speed input: 18386.85 toks/s, output: 17.96 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:03<00:03, 18.06it/s, est. speed input: 18392.27 toks/s, output: 17.96 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:03<00:03, 18.08it/s, est. speed input: 18397.86 toks/s, output: 17.97 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:03<00:03, 18.02it/s, est. speed input: 18395.08 toks/s, output: 17.96 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:03<00:03, 18.07it/s, est. speed input: 18402.22 toks/s, output: 17.97 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:03<00:03, 18.09it/s, est. speed input: 18407.23 toks/s, output: 17.98 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:03<00:03, 18.11it/s, est. speed input: 18413.27 toks/s, output: 17.98 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:03<00:03, 18.08it/s, est. speed input: 18414.18 toks/s, output: 17.98 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:03<00:03, 18.04it/s, est. speed input: 18413.37 toks/s, output: 17.98 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:04<00:03, 18.07it/s, est. speed input: 18417.37 toks/s, output: 17.99 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:04<00:02, 18.02it/s, est. speed input: 18415.68 toks/s, output: 17.98 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:04<00:02, 18.06it/s, est. speed input: 18419.98 toks/s, output: 17.99 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:04<00:02, 18.03it/s, est. speed input: 18418.69 toks/s, output: 17.99 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:04<00:02, 18.03it/s, est. speed input: 18420.20 toks/s, output: 17.99 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:04<00:02, 18.08it/s, est. speed input: 18425.35 toks/s, output: 17.99 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:04<00:02, 18.08it/s, est. speed input: 18427.07 toks/s, output: 18.00 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:04<00:02, 17.98it/s, est. speed input: 18421.69 toks/s, output: 17.99 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:04<00:02, 18.02it/s, est. speed input: 18423.98 toks/s, output: 17.99 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:05<00:02, 18.00it/s, est. speed input: 18423.11 toks/s, output: 17.99 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:05<00:02, 17.95it/s, est. speed input: 18419.68 toks/s, output: 17.99 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:05<00:01, 17.97it/s, est. speed input: 18420.45 toks/s, output: 17.99 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:05<00:01, 17.96it/s, est. speed input: 18419.37 toks/s, output: 17.99 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:05<00:01, 18.00it/s, est. speed input: 18421.40 toks/s, output: 17.99 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:05<00:01, 17.98it/s, est. speed input: 18420.49 toks/s, output: 17.99 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:05<00:01, 18.01it/s, est. speed input: 18421.97 toks/s, output: 17.99 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:05<00:01, 17.98it/s, est. speed input: 18420.66 toks/s, output: 17.99 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:05<00:01, 18.03it/s, est. speed input: 18423.65 toks/s, output: 17.99 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:06<00:01, 18.03it/s, est. speed input: 18424.21 toks/s, output: 17.99 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:06<00:01, 17.97it/s, est. speed input: 18421.39 toks/s, output: 17.99 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:06<00:00, 18.00it/s, est. speed input: 18422.84 toks/s, output: 17.99 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:06<00:00, 17.98it/s, est. speed input: 18421.66 toks/s, output: 17.99 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:06<00:00, 18.01it/s, est. speed input: 18423.18 toks/s, output: 17.99 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:06<00:00, 17.98it/s, est. speed input: 18421.72 toks/s, output: 17.99 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:06<00:00, 18.02it/s, est. speed input: 18423.66 toks/s, output: 17.99 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:06<00:00, 18.00it/s, est. speed input: 18423.41 toks/s, output: 17.99 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:06<00:00, 18.00it/s, est. speed input: 18423.58 toks/s, output: 17.99 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:07<00:00, 18.04it/s, est. speed input: 18425.91 toks/s, output: 17.99 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 18.03it/s, est. speed input: 18425.80 toks/s, output: 17.99 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 18.03it/s, est. speed input: 18425.80 toks/s, output: 17.99 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 17.99it/s, est. speed input: 18425.80 toks/s, output: 17.99 toks/s]
[rank0]:[W126 15:17:23.161830198 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=2048 ==========
Time: 2026-01-26 15:17:25
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-FP8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=256, max_num_seqs=2
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-FP8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 256 --max-num-seqs 2 --max-model-len 1025 --max-num-batched-tokens 2048 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_FP8E4M3_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-14B-FP8_M2048.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 15:17:33 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1528171) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1528171) WARNING 01-26 15:17:56 [backends.py:609] Failed to read file <frozen os>
Throughput: 18.91 requests/s, 19382.06 total tokens/s, 18.91 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256

STDERR:
[2026-01-26 15:17:32] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 15:17:33] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-FP8'
[2026-01-26 15:17:33] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-FP8
[2026-01-26 15:17:33] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:17:33] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:17:33] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:17:33] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:17:33] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:17:33] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-FP8'
[2026-01-26 15:17:33] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 15:17:33] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 15:17:33] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 15:17:33] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 15:17:33] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 15:17:39] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 15:17:40] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-FP8'
[2026-01-26 15:17:40] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-FP8
[2026-01-26 15:17:40] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:17:40] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:17:40] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:17:40] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:17:40] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:17:40] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-FP8'
[2026-01-26 15:17:40] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 15:17:40] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 15:17:40] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 15:17:40] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 15:17:40] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1528171) [2026-01-26 15:17:42] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1528171) [2026-01-26 15:17:42] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1528171) [2026-01-26 15:17:42] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1528171) [2026-01-26 15:17:42] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1528171) [2026-01-26 15:17:42] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-14B-FP8
(EngineCore_DP0 pid=1528171) [2026-01-26 15:17:42] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1528171) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1528171) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.30it/s]
(EngineCore_DP0 pid=1528171) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.19it/s]
(EngineCore_DP0 pid=1528171) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.62it/s]
(EngineCore_DP0 pid=1528171) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.45it/s]
(EngineCore_DP0 pid=1528171) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.42it/s]
(EngineCore_DP0 pid=1528171) 
(EngineCore_DP0 pid=1528171) [2026-01-26 15:17:46] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [7168, 7680] -> 1D uint8
(EngineCore_DP0 pid=1528171) [2026-01-26 15:17:46] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 34406400 bytes
(EngineCore_DP0 pid=1528171) [2026-01-26 15:17:46] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 7680] -> 1D uint8
(EngineCore_DP0 pid=1528171) [2026-01-26 15:17:46] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 24576000 bytes
(EngineCore_DP0 pid=1528171) [2026-01-26 15:17:46] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [27648, 7680] -> 1D uint8
(EngineCore_DP0 pid=1528171) [2026-01-26 15:17:46] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 132710400 bytes
(EngineCore_DP0 pid=1528171) [2026-01-26 15:17:46] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 20736] -> 1D uint8
(EngineCore_DP0 pid=1528171) [2026-01-26 15:17:46] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 66355200 bytes
(EngineCore_DP0 pid=1528171) 2026-01-26 15:18:09,905 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1528171) 2026-01-26 15:18:09,944 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1528171) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  33%|███▎      | 1/3 [00:00<00:00,  8.12it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00, 10.06it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00,  9.82it/s]
(EngineCore_DP0 pid=1528171) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00, 11.77it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00, 11.76it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:   8%|▊         | 21/256 [00:00<00:01, 203.78it/s]
Adding requests:  24%|██▍       | 62/256 [00:00<00:00, 320.79it/s]
Adding requests:  38%|███▊      | 98/256 [00:00<00:00, 336.23it/s]
Adding requests:  53%|█████▎    | 136/256 [00:00<00:00, 351.67it/s]
Adding requests:  69%|██████▉   | 176/256 [00:00<00:00, 365.34it/s]
Adding requests:  84%|████████▍ | 216/256 [00:00<00:00, 373.19it/s]
Adding requests:  99%|█████████▉| 254/256 [00:00<00:00, 374.31it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 355.64it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▍         | 12/256 [00:00<00:02, 86.63it/s, est. speed input: 88727.84 toks/s, output: 86.64 toks/s]
Processed prompts:   8%|▊         | 21/256 [00:00<00:06, 34.17it/s, est. speed input: 39039.56 toks/s, output: 38.12 toks/s]
Processed prompts:  10%|█         | 26/256 [00:00<00:09, 25.45it/s, est. speed input: 30620.94 toks/s, output: 29.90 toks/s]
Processed prompts:  12%|█▏        | 30/256 [00:01<00:09, 23.43it/s, est. speed input: 28423.61 toks/s, output: 27.76 toks/s]
Processed prompts:  13%|█▎        | 33/256 [00:01<00:09, 24.43it/s, est. speed input: 28538.31 toks/s, output: 27.87 toks/s]
Processed prompts:  14%|█▍        | 36/256 [00:01<00:10, 21.14it/s, est. speed input: 26531.30 toks/s, output: 25.91 toks/s]
Processed prompts:  15%|█▌        | 39/256 [00:01<00:09, 22.66it/s, est. speed input: 26749.59 toks/s, output: 26.12 toks/s]
Processed prompts:  16%|█▋        | 42/256 [00:01<00:10, 19.68it/s, est. speed input: 25272.24 toks/s, output: 24.68 toks/s]
Processed prompts:  18%|█▊        | 45/256 [00:01<00:09, 21.39it/s, est. speed input: 25464.07 toks/s, output: 24.87 toks/s]
Processed prompts:  19%|█▉        | 48/256 [00:02<00:11, 18.75it/s, est. speed input: 24329.99 toks/s, output: 23.76 toks/s]
Processed prompts:  20%|█▉        | 51/256 [00:02<00:09, 20.80it/s, est. speed input: 24573.80 toks/s, output: 24.00 toks/s]
Processed prompts:  21%|██        | 54/256 [00:02<00:10, 18.55it/s, est. speed input: 23734.14 toks/s, output: 23.18 toks/s]
Processed prompts:  22%|██▏       | 57/256 [00:02<00:09, 20.70it/s, est. speed input: 23979.43 toks/s, output: 23.42 toks/s]
Processed prompts:  23%|██▎       | 60/256 [00:02<00:10, 18.40it/s, est. speed input: 23270.11 toks/s, output: 22.72 toks/s]
Processed prompts:  25%|██▍       | 63/256 [00:02<00:09, 20.52it/s, est. speed input: 23488.01 toks/s, output: 22.94 toks/s]
Processed prompts:  26%|██▌       | 66/256 [00:02<00:10, 18.09it/s, est. speed input: 22840.62 toks/s, output: 22.31 toks/s]
Processed prompts:  27%|██▋       | 69/256 [00:03<00:09, 20.29it/s, est. speed input: 23056.81 toks/s, output: 22.52 toks/s]
Processed prompts:  28%|██▊       | 72/256 [00:03<00:10, 18.13it/s, est. speed input: 22537.41 toks/s, output: 22.01 toks/s]
Processed prompts:  29%|██▉       | 75/256 [00:03<00:08, 20.38it/s, est. speed input: 22750.31 toks/s, output: 22.22 toks/s]
Processed prompts:  30%|███       | 78/256 [00:03<00:09, 18.21it/s, est. speed input: 22301.29 toks/s, output: 21.78 toks/s]
Processed prompts:  32%|███▏      | 81/256 [00:03<00:08, 20.45it/s, est. speed input: 22501.94 toks/s, output: 21.97 toks/s]
Processed prompts:  33%|███▎      | 84/256 [00:03<00:09, 18.04it/s, est. speed input: 22065.31 toks/s, output: 21.55 toks/s]
Processed prompts:  34%|███▍      | 87/256 [00:04<00:08, 20.28it/s, est. speed input: 22253.83 toks/s, output: 21.73 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:04<00:09, 18.02it/s, est. speed input: 21875.57 toks/s, output: 21.36 toks/s]
Processed prompts:  36%|███▋      | 93/256 [00:04<00:08, 20.31it/s, est. speed input: 22060.88 toks/s, output: 21.54 toks/s]
Processed prompts:  38%|███▊      | 96/256 [00:04<00:08, 18.14it/s, est. speed input: 21732.02 toks/s, output: 21.22 toks/s]
Processed prompts:  39%|███▊      | 99/256 [00:04<00:07, 20.39it/s, est. speed input: 21905.05 toks/s, output: 21.39 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:04<00:08, 18.10it/s, est. speed input: 21592.99 toks/s, output: 21.09 toks/s]
Processed prompts:  41%|████      | 105/256 [00:04<00:07, 20.38it/s, est. speed input: 21760.40 toks/s, output: 21.25 toks/s]
Processed prompts:  42%|████▏     | 108/256 [00:05<00:08, 18.03it/s, est. speed input: 21465.06 toks/s, output: 20.96 toks/s]
Processed prompts:  43%|████▎     | 111/256 [00:05<00:07, 20.31it/s, est. speed input: 21623.98 toks/s, output: 21.12 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:05<00:07, 18.06it/s, est. speed input: 21358.89 toks/s, output: 20.86 toks/s]
Processed prompts:  46%|████▌     | 117/256 [00:05<00:06, 20.33it/s, est. speed input: 21511.00 toks/s, output: 21.01 toks/s]
Processed prompts:  47%|████▋     | 120/256 [00:05<00:07, 18.05it/s, est. speed input: 21261.62 toks/s, output: 20.76 toks/s]
Processed prompts:  48%|████▊     | 123/256 [00:05<00:06, 20.30it/s, est. speed input: 21404.96 toks/s, output: 20.90 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:06<00:07, 18.02it/s, est. speed input: 21171.32 toks/s, output: 20.67 toks/s]
Processed prompts:  50%|█████     | 129/256 [00:06<00:06, 20.27it/s, est. speed input: 21308.47 toks/s, output: 20.81 toks/s]
Processed prompts:  52%|█████▏    | 132/256 [00:06<00:06, 18.06it/s, est. speed input: 21095.45 toks/s, output: 20.60 toks/s]
Processed prompts:  53%|█████▎    | 135/256 [00:06<00:05, 20.33it/s, est. speed input: 21228.63 toks/s, output: 20.73 toks/s]
Processed prompts:  54%|█████▍    | 138/256 [00:06<00:06, 18.08it/s, est. speed input: 21026.87 toks/s, output: 20.53 toks/s]
Processed prompts:  55%|█████▌    | 141/256 [00:06<00:05, 20.30it/s, est. speed input: 21151.73 toks/s, output: 20.66 toks/s]
Processed prompts:  56%|█████▋    | 144/256 [00:07<00:06, 18.03it/s, est. speed input: 20958.16 toks/s, output: 20.47 toks/s]
Processed prompts:  57%|█████▋    | 147/256 [00:07<00:05, 20.32it/s, est. speed input: 21083.36 toks/s, output: 20.59 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:07<00:05, 18.06it/s, est. speed input: 20900.82 toks/s, output: 20.41 toks/s]
Processed prompts:  60%|█████▉    | 153/256 [00:07<00:05, 20.31it/s, est. speed input: 21019.24 toks/s, output: 20.53 toks/s]
Processed prompts:  61%|██████    | 156/256 [00:07<00:05, 18.01it/s, est. speed input: 20842.81 toks/s, output: 20.35 toks/s]
Processed prompts:  62%|██████▏   | 159/256 [00:07<00:04, 20.24it/s, est. speed input: 20955.23 toks/s, output: 20.46 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:07<00:05, 18.01it/s, est. speed input: 20790.05 toks/s, output: 20.30 toks/s]
Processed prompts:  64%|██████▍   | 165/256 [00:08<00:04, 20.27it/s, est. speed input: 20901.07 toks/s, output: 20.41 toks/s]
Processed prompts:  66%|██████▌   | 168/256 [00:08<00:04, 18.06it/s, est. speed input: 20746.26 toks/s, output: 20.26 toks/s]
Processed prompts:  67%|██████▋   | 171/256 [00:08<00:04, 20.33it/s, est. speed input: 20854.30 toks/s, output: 20.37 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:08<00:04, 18.06it/s, est. speed input: 20704.28 toks/s, output: 20.22 toks/s]
Processed prompts:  69%|██████▉   | 177/256 [00:08<00:03, 20.26it/s, est. speed input: 20804.57 toks/s, output: 20.32 toks/s]
Processed prompts:  70%|███████   | 180/256 [00:08<00:04, 18.02it/s, est. speed input: 20660.90 toks/s, output: 20.18 toks/s]
Processed prompts:  71%|███████▏  | 183/256 [00:09<00:03, 20.28it/s, est. speed input: 20761.64 toks/s, output: 20.28 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:09<00:03, 18.05it/s, est. speed input: 20624.71 toks/s, output: 20.14 toks/s]
Processed prompts:  74%|███████▍  | 189/256 [00:09<00:03, 20.32it/s, est. speed input: 20723.08 toks/s, output: 20.24 toks/s]
Processed prompts:  75%|███████▌  | 192/256 [00:09<00:03, 18.07it/s, est. speed input: 20591.25 toks/s, output: 20.11 toks/s]
Processed prompts:  76%|███████▌  | 195/256 [00:09<00:03, 20.29it/s, est. speed input: 20684.83 toks/s, output: 20.20 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:09<00:03, 18.03it/s, est. speed input: 20556.77 toks/s, output: 20.07 toks/s]
Processed prompts:  79%|███████▊  | 201/256 [00:09<00:02, 20.26it/s, est. speed input: 20647.36 toks/s, output: 20.16 toks/s]
Processed prompts:  80%|███████▉  | 204/256 [00:10<00:02, 19.50it/s, est. speed input: 20609.86 toks/s, output: 20.13 toks/s]
Processed prompts:  81%|████████  | 207/256 [00:10<00:02, 21.61it/s, est. speed input: 20700.77 toks/s, output: 20.22 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:10<00:02, 18.75it/s, est. speed input: 20580.17 toks/s, output: 20.10 toks/s]
Processed prompts:  83%|████████▎ | 213/256 [00:10<00:02, 20.90it/s, est. speed input: 20665.95 toks/s, output: 20.18 toks/s]
Processed prompts:  84%|████████▍ | 216/256 [00:10<00:02, 18.37it/s, est. speed input: 20549.13 toks/s, output: 20.07 toks/s]
Processed prompts:  86%|████████▌ | 219/256 [00:10<00:01, 20.54it/s, est. speed input: 20631.82 toks/s, output: 20.15 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:11<00:01, 18.11it/s, est. speed input: 20515.66 toks/s, output: 20.03 toks/s]
Processed prompts:  88%|████████▊ | 225/256 [00:11<00:01, 20.40it/s, est. speed input: 20600.20 toks/s, output: 20.12 toks/s]
Processed prompts:  89%|████████▉ | 228/256 [00:11<00:01, 18.12it/s, est. speed input: 20492.14 toks/s, output: 20.01 toks/s]
Processed prompts:  90%|█████████ | 231/256 [00:11<00:01, 20.38it/s, est. speed input: 20573.20 toks/s, output: 20.09 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:11<00:01, 18.04it/s, est. speed input: 20465.18 toks/s, output: 19.99 toks/s]
Processed prompts:  93%|█████████▎| 237/256 [00:11<00:00, 20.28it/s, est. speed input: 20543.37 toks/s, output: 20.06 toks/s]
Processed prompts:  94%|█████████▍| 240/256 [00:12<00:00, 17.95it/s, est. speed input: 20436.69 toks/s, output: 19.96 toks/s]
Processed prompts:  95%|█████████▍| 243/256 [00:12<00:00, 20.25it/s, est. speed input: 20514.96 toks/s, output: 20.03 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:12<00:00, 18.04it/s, est. speed input: 20417.29 toks/s, output: 19.94 toks/s]
Processed prompts:  97%|█████████▋| 249/256 [00:12<00:00, 20.33it/s, est. speed input: 20493.41 toks/s, output: 20.01 toks/s]
Processed prompts:  98%|█████████▊| 252/256 [00:12<00:00, 18.00it/s, est. speed input: 20394.28 toks/s, output: 19.92 toks/s]
Processed prompts: 100%|█████████▉| 255/256 [00:12<00:00, 20.23it/s, est. speed input: 20466.47 toks/s, output: 19.99 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:12<00:00, 20.23it/s, est. speed input: 20453.25 toks/s, output: 19.97 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:12<00:00, 19.97it/s, est. speed input: 20453.25 toks/s, output: 19.97 toks/s]
[rank0]:[W126 15:18:25.929133477 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=4096 ==========
Time: 2026-01-26 15:18:28
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-FP8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=512, max_num_seqs=4
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-FP8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 512 --max-num-seqs 4 --max-model-len 1025 --max-num-batched-tokens 4096 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_FP8E4M3_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-14B-FP8_M4096.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 15:18:38 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1529535) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1529535) WARNING 01-26 15:18:59 [backends.py:609] Failed to read file <frozen os>
Throughput: 19.73 requests/s, 20221.40 total tokens/s, 19.73 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512

STDERR:
[2026-01-26 15:18:37] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 15:18:38] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-FP8'
[2026-01-26 15:18:38] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-FP8
[2026-01-26 15:18:38] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:18:38] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:18:38] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:18:38] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:18:38] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:18:38] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-FP8'
[2026-01-26 15:18:38] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 15:18:38] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 15:18:38] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 15:18:38] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 15:18:38] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 15:18:44] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 15:18:45] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-FP8'
[2026-01-26 15:18:45] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-FP8
[2026-01-26 15:18:45] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:18:45] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:18:45] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:18:45] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:18:45] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:18:45] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-FP8'
[2026-01-26 15:18:45] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 15:18:45] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 15:18:45] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 15:18:45] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 15:18:45] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1529535) [2026-01-26 15:18:47] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1529535) [2026-01-26 15:18:47] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1529535) [2026-01-26 15:18:47] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1529535) [2026-01-26 15:18:47] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1529535) [2026-01-26 15:18:47] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-14B-FP8
(EngineCore_DP0 pid=1529535) [2026-01-26 15:18:47] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1529535) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1529535) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.30it/s]
(EngineCore_DP0 pid=1529535) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.19it/s]
(EngineCore_DP0 pid=1529535) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.63it/s]
(EngineCore_DP0 pid=1529535) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.45it/s]
(EngineCore_DP0 pid=1529535) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.42it/s]
(EngineCore_DP0 pid=1529535) 
(EngineCore_DP0 pid=1529535) [2026-01-26 15:18:50] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [7168, 7680] -> 1D uint8
(EngineCore_DP0 pid=1529535) [2026-01-26 15:18:50] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 34406400 bytes
(EngineCore_DP0 pid=1529535) [2026-01-26 15:18:50] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 7680] -> 1D uint8
(EngineCore_DP0 pid=1529535) [2026-01-26 15:18:50] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 24576000 bytes
(EngineCore_DP0 pid=1529535) [2026-01-26 15:18:50] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [27648, 7680] -> 1D uint8
(EngineCore_DP0 pid=1529535) [2026-01-26 15:18:50] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 132710400 bytes
(EngineCore_DP0 pid=1529535) [2026-01-26 15:18:50] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 20736] -> 1D uint8
(EngineCore_DP0 pid=1529535) [2026-01-26 15:18:50] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 66355200 bytes
(EngineCore_DP0 pid=1529535) 2026-01-26 15:19:13,343 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1529535) 2026-01-26 15:19:13,400 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1529535) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  25%|██▌       | 1/4 [00:00<00:00,  8.24it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  75%|███████▌  | 3/4 [00:00<00:00, 10.85it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00, 10.29it/s]
(EngineCore_DP0 pid=1529535) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  33%|███▎      | 1/3 [00:00<00:00,  9.43it/s]
Capturing CUDA graphs (decode, FULL):  67%|██████▋   | 2/3 [00:00<00:00,  4.18it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  2.70it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  3.11it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   4%|▍         | 23/512 [00:00<00:02, 228.54it/s]
Adding requests:  12%|█▏        | 63/512 [00:00<00:01, 326.62it/s]
Adding requests:  19%|█▉        | 98/512 [00:00<00:01, 336.50it/s]
Adding requests:  27%|██▋       | 136/512 [00:00<00:01, 350.62it/s]
Adding requests:  34%|███▍      | 175/512 [00:00<00:00, 363.40it/s]
Adding requests:  42%|████▏     | 215/512 [00:00<00:00, 373.90it/s]
Adding requests:  49%|████▉     | 253/512 [00:00<00:00, 374.09it/s]
Adding requests:  57%|█████▋    | 291/512 [00:00<00:00, 375.84it/s]
Adding requests:  65%|██████▍   | 331/512 [00:00<00:00, 381.71it/s]
Adding requests:  72%|███████▏  | 371/512 [00:01<00:00, 387.13it/s]
Adding requests:  80%|████████  | 411/512 [00:01<00:00, 390.30it/s]
Adding requests:  88%|████████▊ | 451/512 [00:01<00:00, 387.56it/s]
Adding requests:  96%|█████████▋| 494/512 [00:01<00:00, 399.07it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 375.30it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   4%|▍         | 22/512 [00:00<00:05, 84.68it/s, est. speed input: 86722.18 toks/s, output: 84.68 toks/s]
Processed prompts:   6%|▌         | 31/512 [00:00<00:11, 42.18it/s, est. speed input: 48363.67 toks/s, output: 47.23 toks/s]
Processed prompts:   7%|▋         | 36/512 [00:00<00:12, 36.86it/s, est. speed input: 43345.99 toks/s, output: 42.33 toks/s]
Processed prompts:   8%|▊         | 40/512 [00:01<00:15, 31.28it/s, est. speed input: 38893.50 toks/s, output: 37.98 toks/s]
Processed prompts:   9%|▊         | 44/512 [00:01<00:17, 27.51it/s, est. speed input: 35810.70 toks/s, output: 34.97 toks/s]
Processed prompts:   9%|▉         | 47/512 [00:01<00:19, 23.68it/s, est. speed input: 33021.30 toks/s, output: 32.25 toks/s]
Processed prompts:  10%|▉         | 50/512 [00:01<00:21, 21.20it/s, est. speed input: 30997.02 toks/s, output: 30.27 toks/s]
Processed prompts:  11%|█         | 54/512 [00:01<00:21, 20.98it/s, est. speed input: 29932.53 toks/s, output: 29.23 toks/s]
Processed prompts:  11%|█▏        | 58/512 [00:02<00:21, 20.71it/s, est. speed input: 29020.74 toks/s, output: 28.34 toks/s]
Processed prompts:  12%|█▏        | 62/512 [00:02<00:22, 20.35it/s, est. speed input: 28203.36 toks/s, output: 27.54 toks/s]
Processed prompts:  13%|█▎        | 66/512 [00:02<00:22, 20.20it/s, est. speed input: 27555.67 toks/s, output: 26.91 toks/s]
Processed prompts:  14%|█▎        | 70/512 [00:02<00:21, 20.16it/s, est. speed input: 27029.61 toks/s, output: 26.40 toks/s]
Processed prompts:  14%|█▍        | 74/512 [00:02<00:21, 20.26it/s, est. speed input: 26614.18 toks/s, output: 25.99 toks/s]
Processed prompts:  15%|█▌        | 78/512 [00:03<00:21, 20.15it/s, est. speed input: 26202.87 toks/s, output: 25.59 toks/s]
Processed prompts:  16%|█▌        | 82/512 [00:03<00:21, 20.02it/s, est. speed input: 25827.75 toks/s, output: 25.22 toks/s]
Processed prompts:  17%|█▋        | 86/512 [00:03<00:21, 19.99it/s, est. speed input: 25511.59 toks/s, output: 24.91 toks/s]
Processed prompts:  18%|█▊        | 90/512 [00:03<00:21, 19.99it/s, est. speed input: 25235.17 toks/s, output: 24.64 toks/s]
Processed prompts:  18%|█▊        | 94/512 [00:03<00:20, 20.09it/s, est. speed input: 25009.22 toks/s, output: 24.42 toks/s]
Processed prompts:  19%|█▉        | 98/512 [00:04<00:20, 20.07it/s, est. speed input: 24787.72 toks/s, output: 24.21 toks/s]
Processed prompts:  20%|█▉        | 102/512 [00:04<00:20, 19.98it/s, est. speed input: 24570.86 toks/s, output: 23.99 toks/s]
Processed prompts:  21%|██        | 106/512 [00:04<00:20, 20.01it/s, est. speed input: 24392.39 toks/s, output: 23.82 toks/s]
Processed prompts:  21%|██▏       | 110/512 [00:04<00:20, 20.06it/s, est. speed input: 24232.42 toks/s, output: 23.66 toks/s]
Processed prompts:  22%|██▏       | 114/512 [00:04<00:19, 20.17it/s, est. speed input: 24098.13 toks/s, output: 23.53 toks/s]
Processed prompts:  23%|██▎       | 118/512 [00:05<00:19, 20.11it/s, est. speed input: 23953.67 toks/s, output: 23.39 toks/s]
Processed prompts:  24%|██▍       | 122/512 [00:05<00:19, 20.05it/s, est. speed input: 23816.96 toks/s, output: 23.26 toks/s]
Processed prompts:  25%|██▍       | 126/512 [00:05<00:19, 20.00it/s, est. speed input: 23690.09 toks/s, output: 23.13 toks/s]
Processed prompts:  25%|██▌       | 130/512 [00:05<00:19, 19.94it/s, est. speed input: 23568.47 toks/s, output: 23.02 toks/s]
Processed prompts:  26%|██▌       | 134/512 [00:05<00:18, 20.00it/s, est. speed input: 23467.29 toks/s, output: 22.92 toks/s]
Processed prompts:  27%|██▋       | 138/512 [00:06<00:18, 19.98it/s, est. speed input: 23366.55 toks/s, output: 22.82 toks/s]
Processed prompts:  28%|██▊       | 142/512 [00:06<00:18, 19.97it/s, est. speed input: 23272.49 toks/s, output: 22.73 toks/s]
Processed prompts:  29%|██▊       | 146/512 [00:06<00:18, 19.95it/s, est. speed input: 23181.47 toks/s, output: 22.64 toks/s]
Processed prompts:  29%|██▉       | 150/512 [00:06<00:18, 19.91it/s, est. speed input: 23093.99 toks/s, output: 22.55 toks/s]
Processed prompts:  30%|███       | 154/512 [00:06<00:17, 20.03it/s, est. speed input: 23028.67 toks/s, output: 22.49 toks/s]
Processed prompts:  31%|███       | 158/512 [00:07<00:17, 20.10it/s, est. speed input: 22964.32 toks/s, output: 22.43 toks/s]
Processed prompts:  32%|███▏      | 162/512 [00:07<00:17, 20.09it/s, est. speed input: 22897.59 toks/s, output: 22.36 toks/s]
Processed prompts:  32%|███▏      | 166/512 [00:07<00:17, 20.04it/s, est. speed input: 22831.22 toks/s, output: 22.30 toks/s]
Processed prompts:  33%|███▎      | 170/512 [00:07<00:17, 19.95it/s, est. speed input: 22761.53 toks/s, output: 22.23 toks/s]
Processed prompts:  34%|███▍      | 174/512 [00:07<00:16, 20.01it/s, est. speed input: 22707.84 toks/s, output: 22.18 toks/s]
Processed prompts:  35%|███▍      | 178/512 [00:08<00:16, 19.94it/s, est. speed input: 22646.51 toks/s, output: 22.12 toks/s]
Processed prompts:  36%|███▌      | 182/512 [00:08<00:16, 19.98it/s, est. speed input: 22595.53 toks/s, output: 22.07 toks/s]
Processed prompts:  36%|███▋      | 186/512 [00:08<00:16, 19.91it/s, est. speed input: 22538.58 toks/s, output: 22.01 toks/s]
Processed prompts:  37%|███▋      | 190/512 [00:08<00:16, 19.92it/s, est. speed input: 22489.38 toks/s, output: 21.96 toks/s]
Processed prompts:  38%|███▊      | 194/512 [00:08<00:15, 19.93it/s, est. speed input: 22443.37 toks/s, output: 21.92 toks/s]
Processed prompts:  39%|███▊      | 198/512 [00:09<00:15, 20.02it/s, est. speed input: 22405.52 toks/s, output: 21.88 toks/s]
Processed prompts:  39%|███▉      | 202/512 [00:09<00:14, 21.29it/s, est. speed input: 22460.92 toks/s, output: 21.93 toks/s]
Processed prompts:  40%|████      | 206/512 [00:09<00:14, 20.83it/s, est. speed input: 22414.63 toks/s, output: 21.89 toks/s]
Processed prompts:  41%|████      | 210/512 [00:09<00:14, 20.50it/s, est. speed input: 22369.28 toks/s, output: 21.84 toks/s]
Processed prompts:  42%|████▏     | 214/512 [00:09<00:14, 20.36it/s, est. speed input: 22331.61 toks/s, output: 21.81 toks/s]
Processed prompts:  43%|████▎     | 218/512 [00:10<00:14, 20.21it/s, est. speed input: 22291.74 toks/s, output: 21.77 toks/s]
Processed prompts:  43%|████▎     | 222/512 [00:10<00:14, 20.17it/s, est. speed input: 22257.49 toks/s, output: 21.74 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:10<00:14, 20.10it/s, est. speed input: 22222.39 toks/s, output: 21.70 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:10<00:14, 19.99it/s, est. speed input: 22184.24 toks/s, output: 21.66 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:10<00:13, 19.99it/s, est. speed input: 22152.30 toks/s, output: 21.63 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:11<00:13, 20.02it/s, est. speed input: 22123.41 toks/s, output: 21.60 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:11<00:13, 20.02it/s, est. speed input: 22094.95 toks/s, output: 21.58 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:11<00:13, 20.02it/s, est. speed input: 22066.75 toks/s, output: 21.55 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:11<00:13, 19.99it/s, est. speed input: 22037.99 toks/s, output: 21.52 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:11<00:12, 19.98it/s, est. speed input: 22010.93 toks/s, output: 21.49 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:12<00:12, 19.93it/s, est. speed input: 21981.86 toks/s, output: 21.47 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:12<00:12, 19.93it/s, est. speed input: 21955.78 toks/s, output: 21.44 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:12<00:12, 19.91it/s, est. speed input: 21929.77 toks/s, output: 21.42 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:12<00:12, 19.88it/s, est. speed input: 21903.52 toks/s, output: 21.39 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:12<00:11, 19.88it/s, est. speed input: 21879.07 toks/s, output: 21.37 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:13<00:11, 19.90it/s, est. speed input: 21856.57 toks/s, output: 21.34 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:13<00:11, 19.88it/s, est. speed input: 21833.33 toks/s, output: 21.32 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:13<00:11, 19.85it/s, est. speed input: 21809.58 toks/s, output: 21.30 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:13<00:11, 19.82it/s, est. speed input: 21786.07 toks/s, output: 21.28 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:13<00:10, 19.84it/s, est. speed input: 21765.02 toks/s, output: 21.25 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:14<00:10, 19.86it/s, est. speed input: 21745.18 toks/s, output: 21.24 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:14<00:10, 19.86it/s, est. speed input: 21725.57 toks/s, output: 21.22 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:14<00:10, 19.85it/s, est. speed input: 21705.73 toks/s, output: 21.20 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:14<00:10, 19.95it/s, est. speed input: 21691.44 toks/s, output: 21.18 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:14<00:09, 19.96it/s, est. speed input: 21675.07 toks/s, output: 21.17 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:15<00:09, 20.04it/s, est. speed input: 21662.32 toks/s, output: 21.15 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:15<00:09, 19.98it/s, est. speed input: 21644.80 toks/s, output: 21.14 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:15<00:09, 20.04it/s, est. speed input: 21632.17 toks/s, output: 21.13 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:15<00:09, 20.02it/s, est. speed input: 21616.78 toks/s, output: 21.11 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:15<00:08, 20.03it/s, est. speed input: 21603.23 toks/s, output: 21.10 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:16<00:08, 20.05it/s, est. speed input: 21590.67 toks/s, output: 21.08 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:16<00:08, 20.00it/s, est. speed input: 21575.50 toks/s, output: 21.07 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:16<00:08, 20.03it/s, est. speed input: 21563.27 toks/s, output: 21.06 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:16<00:08, 20.00it/s, est. speed input: 21549.20 toks/s, output: 21.04 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:16<00:07, 20.03it/s, est. speed input: 21537.69 toks/s, output: 21.03 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:17<00:07, 20.09it/s, est. speed input: 21528.31 toks/s, output: 21.02 toks/s]
Processed prompts:  71%|███████   | 362/512 [00:17<00:07, 20.08it/s, est. speed input: 21516.94 toks/s, output: 21.01 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:17<00:07, 20.06it/s, est. speed input: 21505.13 toks/s, output: 21.00 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [00:17<00:07, 20.04it/s, est. speed input: 21493.49 toks/s, output: 20.99 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [00:17<00:06, 20.06it/s, est. speed input: 21483.30 toks/s, output: 20.98 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [00:18<00:06, 20.07it/s, est. speed input: 21473.38 toks/s, output: 20.97 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [00:18<00:06, 20.02it/s, est. speed input: 21461.11 toks/s, output: 20.96 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [00:18<00:06, 19.96it/s, est. speed input: 21448.66 toks/s, output: 20.95 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [00:18<00:06, 19.96it/s, est. speed input: 21437.81 toks/s, output: 20.94 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [00:18<00:05, 20.03it/s, est. speed input: 21429.79 toks/s, output: 20.93 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [00:19<00:05, 20.07it/s, est. speed input: 21421.63 toks/s, output: 20.92 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [00:19<00:05, 20.01it/s, est. speed input: 21410.47 toks/s, output: 20.91 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [00:19<00:05, 19.96it/s, est. speed input: 21399.24 toks/s, output: 20.90 toks/s]
Processed prompts:  80%|████████  | 410/512 [00:19<00:05, 19.93it/s, est. speed input: 21388.36 toks/s, output: 20.89 toks/s]
Processed prompts:  81%|████████  | 414/512 [00:19<00:04, 19.99it/s, est. speed input: 21380.33 toks/s, output: 20.88 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [00:20<00:04, 20.08it/s, est. speed input: 21374.70 toks/s, output: 20.87 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [00:20<00:04, 20.06it/s, est. speed input: 21366.01 toks/s, output: 20.87 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [00:20<00:04, 20.00it/s, est. speed input: 21355.88 toks/s, output: 20.86 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [00:20<00:04, 20.00it/s, est. speed input: 21347.20 toks/s, output: 20.85 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [00:20<00:03, 19.94it/s, est. speed input: 21336.83 toks/s, output: 20.84 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [00:21<00:03, 20.00it/s, est. speed input: 21330.05 toks/s, output: 20.83 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [00:21<00:03, 20.02it/s, est. speed input: 21322.79 toks/s, output: 20.82 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [00:21<00:03, 19.96it/s, est. speed input: 21312.99 toks/s, output: 20.81 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [00:21<00:03, 19.94it/s, est. speed input: 21304.25 toks/s, output: 20.80 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [00:21<00:02, 19.97it/s, est. speed input: 21297.17 toks/s, output: 20.80 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [00:22<00:02, 20.00it/s, est. speed input: 21290.34 toks/s, output: 20.79 toks/s]
Processed prompts:  90%|█████████ | 462/512 [00:22<00:02, 20.00it/s, est. speed input: 21282.98 toks/s, output: 20.78 toks/s]
Processed prompts:  91%|█████████ | 466/512 [00:22<00:02, 19.96it/s, est. speed input: 21274.54 toks/s, output: 20.78 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [00:22<00:02, 19.92it/s, est. speed input: 21265.94 toks/s, output: 20.77 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [00:22<00:01, 19.99it/s, est. speed input: 21260.47 toks/s, output: 20.76 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [00:23<00:01, 20.02it/s, est. speed input: 21254.44 toks/s, output: 20.76 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [00:23<00:01, 19.98it/s, est. speed input: 21246.92 toks/s, output: 20.75 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [00:23<00:01, 19.97it/s, est. speed input: 21239.79 toks/s, output: 20.74 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [00:23<00:01, 19.96it/s, est. speed input: 21232.91 toks/s, output: 20.74 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [00:23<00:00, 19.99it/s, est. speed input: 21226.97 toks/s, output: 20.73 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [00:24<00:00, 20.00it/s, est. speed input: 21221.02 toks/s, output: 20.72 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [00:24<00:00, 19.95it/s, est. speed input: 21213.32 toks/s, output: 20.72 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [00:24<00:00, 19.93it/s, est. speed input: 21206.28 toks/s, output: 20.71 toks/s]
Processed prompts: 100%|█████████▉| 510/512 [00:24<00:00, 21.45it/s, est. speed input: 21240.72 toks/s, output: 20.74 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:24<00:00, 21.45it/s, est. speed input: 21323.77 toks/s, output: 20.82 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:24<00:00, 20.82it/s, est. speed input: 21323.77 toks/s, output: 20.82 toks/s]
[rank0]:[W126 15:19:42.685864092 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=8192 ==========
Time: 2026-01-26 15:19:44
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-FP8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=1024, max_num_seqs=8
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-FP8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 1024 --max-num-seqs 8 --max-model-len 1025 --max-num-batched-tokens 8192 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_FP8E4M3_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-14B-FP8_M8192.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 15:19:57 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1531091) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1531091) WARNING 01-26 15:20:19 [backends.py:609] Failed to read file <frozen os>
Throughput: 20.43 requests/s, 20941.92 total tokens/s, 20.43 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024

STDERR:
[2026-01-26 15:19:56] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 15:19:57] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-FP8'
[2026-01-26 15:19:57] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-FP8
[2026-01-26 15:19:57] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:19:57] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:19:57] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:19:57] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:19:57] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:19:57] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-FP8'
[2026-01-26 15:19:57] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 15:19:57] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 15:19:57] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 15:19:57] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 15:19:57] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 15:20:03] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 15:20:03] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-FP8'
[2026-01-26 15:20:03] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-FP8
[2026-01-26 15:20:03] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:20:03] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:20:03] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:20:03] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:20:03] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:20:03] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-FP8'
[2026-01-26 15:20:03] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 15:20:03] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 15:20:03] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 15:20:03] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 15:20:03] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1531091) [2026-01-26 15:20:05] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1531091) [2026-01-26 15:20:05] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1531091) [2026-01-26 15:20:05] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1531091) [2026-01-26 15:20:05] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1531091) [2026-01-26 15:20:05] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-14B-FP8
(EngineCore_DP0 pid=1531091) [2026-01-26 15:20:05] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1531091) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1531091) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.29it/s]
(EngineCore_DP0 pid=1531091) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.18it/s]
(EngineCore_DP0 pid=1531091) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.62it/s]
(EngineCore_DP0 pid=1531091) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.45it/s]
(EngineCore_DP0 pid=1531091) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.42it/s]
(EngineCore_DP0 pid=1531091) 
(EngineCore_DP0 pid=1531091) [2026-01-26 15:20:09] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [7168, 7680] -> 1D uint8
(EngineCore_DP0 pid=1531091) [2026-01-26 15:20:10] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 34406400 bytes
(EngineCore_DP0 pid=1531091) [2026-01-26 15:20:10] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 7680] -> 1D uint8
(EngineCore_DP0 pid=1531091) [2026-01-26 15:20:10] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 24576000 bytes
(EngineCore_DP0 pid=1531091) [2026-01-26 15:20:10] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [27648, 7680] -> 1D uint8
(EngineCore_DP0 pid=1531091) [2026-01-26 15:20:10] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 132710400 bytes
(EngineCore_DP0 pid=1531091) [2026-01-26 15:20:10] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 20736] -> 1D uint8
(EngineCore_DP0 pid=1531091) [2026-01-26 15:20:10] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 66355200 bytes
(EngineCore_DP0 pid=1531091) 2026-01-26 15:20:33,690 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1531091) 2026-01-26 15:20:33,798 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1531091) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:00,  8.03it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  60%|██████    | 3/5 [00:00<00:00, 10.58it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:01<00:00,  3.68it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:01<00:00,  4.27it/s]
(EngineCore_DP0 pid=1531091) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:00,  7.33it/s]
Capturing CUDA graphs (decode, FULL):  75%|███████▌  | 3/4 [00:00<00:00, 10.64it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00, 10.65it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 23/1024 [00:00<00:04, 226.17it/s]
Adding requests:   6%|▋         | 64/1024 [00:00<00:02, 328.10it/s]
Adding requests:  10%|▉         | 100/1024 [00:00<00:02, 340.71it/s]
Adding requests:  13%|█▎        | 138/1024 [00:00<00:02, 353.12it/s]
Adding requests:  17%|█▋        | 177/1024 [00:00<00:02, 365.61it/s]
Adding requests:  21%|██▏       | 218/1024 [00:00<00:02, 380.13it/s]
Adding requests:  25%|██▌       | 257/1024 [00:00<00:02, 378.46it/s]
Adding requests:  29%|██▉       | 298/1024 [00:00<00:01, 385.16it/s]
Adding requests:  33%|███▎      | 339/1024 [00:00<00:01, 390.14it/s]
Adding requests:  37%|███▋      | 380/1024 [00:01<00:01, 393.28it/s]
Adding requests:  41%|████      | 422/1024 [00:01<00:01, 399.96it/s]
Adding requests:  45%|████▌     | 463/1024 [00:01<00:01, 395.37it/s]
Adding requests:  49%|████▉     | 506/1024 [00:01<00:01, 404.07it/s]
Adding requests:  53%|█████▎    | 547/1024 [00:01<00:01, 401.41it/s]
Adding requests:  57%|█████▋    | 588/1024 [00:01<00:01, 396.64it/s]
Adding requests:  61%|██████▏   | 628/1024 [00:01<00:01, 395.65it/s]
Adding requests:  65%|██████▌   | 668/1024 [00:01<00:00, 385.53it/s]
Adding requests:  69%|██████▉   | 709/1024 [00:01<00:00, 390.88it/s]
Adding requests:  73%|███████▎  | 749/1024 [00:01<00:00, 383.05it/s]
Adding requests:  77%|███████▋  | 789/1024 [00:02<00:00, 385.91it/s]
Adding requests:  81%|████████  | 829/1024 [00:02<00:00, 389.06it/s]
Adding requests:  85%|████████▍ | 868/1024 [00:02<00:00, 388.78it/s]
Adding requests:  89%|████████▉ | 909/1024 [00:02<00:00, 393.28it/s]
Adding requests:  93%|█████████▎| 949/1024 [00:02<00:00, 384.51it/s]
Adding requests:  97%|█████████▋| 989/1024 [00:02<00:00, 386.75it/s]
Adding requests: 100%|██████████| 1024/1024 [00:02<00:00, 383.30it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▍         | 50/1024 [00:00<00:03, 244.19it/s, est. speed input: 250077.87 toks/s, output: 244.20 toks/s]
Processed prompts:   7%|▋         | 75/1024 [00:01<00:20, 45.70it/s, est. speed input: 55882.93 toks/s, output: 54.57 toks/s]   
Processed prompts:   8%|▊         | 87/1024 [00:01<00:22, 41.10it/s, est. speed input: 50361.03 toks/s, output: 49.18 toks/s]
Processed prompts:   9%|▉         | 95/1024 [00:02<00:26, 35.12it/s, est. speed input: 45174.54 toks/s, output: 44.12 toks/s]
Processed prompts:  10%|▉         | 101/1024 [00:02<00:31, 29.12it/s, est. speed input: 40599.29 toks/s, output: 39.65 toks/s]
Processed prompts:  10%|█         | 106/1024 [00:02<00:37, 24.29it/s, est. speed input: 36982.10 toks/s, output: 36.11 toks/s]
Processed prompts:  11%|█         | 114/1024 [00:03<00:39, 23.20it/s, est. speed input: 35130.25 toks/s, output: 34.31 toks/s]
Processed prompts:  12%|█▏        | 122/1024 [00:03<00:40, 22.30it/s, est. speed input: 33599.11 toks/s, output: 32.81 toks/s]
Processed prompts:  13%|█▎        | 130/1024 [00:04<00:41, 21.80it/s, est. speed input: 32419.60 toks/s, output: 31.66 toks/s]
Processed prompts:  13%|█▎        | 138/1024 [00:04<00:41, 21.38it/s, est. speed input: 31413.11 toks/s, output: 30.68 toks/s]
Processed prompts:  14%|█▍        | 146/1024 [00:04<00:41, 21.08it/s, est. speed input: 30568.39 toks/s, output: 29.85 toks/s]
Processed prompts:  15%|█▌        | 154/1024 [00:05<00:41, 20.92it/s, est. speed input: 29865.91 toks/s, output: 29.17 toks/s]
Processed prompts:  16%|█▌        | 162/1024 [00:05<00:41, 20.77it/s, est. speed input: 29245.54 toks/s, output: 28.56 toks/s]
Processed prompts:  17%|█▋        | 170/1024 [00:06<00:41, 20.74it/s, est. speed input: 28730.25 toks/s, output: 28.06 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [00:06<00:41, 20.63it/s, est. speed input: 28251.61 toks/s, output: 27.59 toks/s]
Processed prompts:  18%|█▊        | 186/1024 [00:06<00:40, 20.58it/s, est. speed input: 27835.00 toks/s, output: 27.18 toks/s]
Processed prompts:  19%|█▉        | 194/1024 [00:07<00:40, 20.58it/s, est. speed input: 27472.10 toks/s, output: 26.83 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [00:07<00:38, 21.12it/s, est. speed input: 27263.25 toks/s, output: 26.62 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:07<00:38, 20.95it/s, est. speed input: 26960.87 toks/s, output: 26.33 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [00:08<00:38, 20.75it/s, est. speed input: 26670.63 toks/s, output: 26.05 toks/s]
Processed prompts:  22%|██▏       | 226/1024 [00:08<00:38, 20.65it/s, est. speed input: 26412.28 toks/s, output: 25.79 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:09<00:38, 20.61it/s, est. speed input: 26183.26 toks/s, output: 25.57 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:09<00:38, 20.55it/s, est. speed input: 25965.03 toks/s, output: 25.36 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:09<00:37, 20.54it/s, est. speed input: 25771.74 toks/s, output: 25.17 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:10<00:37, 20.48it/s, est. speed input: 25582.62 toks/s, output: 24.98 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:10<00:37, 20.40it/s, est. speed input: 25403.27 toks/s, output: 24.81 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:11<00:36, 20.45it/s, est. speed input: 25251.25 toks/s, output: 24.66 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:11<00:36, 20.49it/s, est. speed input: 25109.65 toks/s, output: 24.52 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:11<00:35, 20.52it/s, est. speed input: 24977.68 toks/s, output: 24.39 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:12<00:35, 20.52it/s, est. speed input: 24852.16 toks/s, output: 24.27 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:12<00:34, 20.55it/s, est. speed input: 24737.33 toks/s, output: 24.16 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:13<00:34, 20.55it/s, est. speed input: 24628.03 toks/s, output: 24.05 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:13<00:34, 20.54it/s, est. speed input: 24522.27 toks/s, output: 23.95 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:13<00:33, 20.54it/s, est. speed input: 24424.63 toks/s, output: 23.85 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:14<00:33, 20.56it/s, est. speed input: 24333.82 toks/s, output: 23.76 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:14<00:32, 20.57it/s, est. speed input: 24247.83 toks/s, output: 23.68 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:15<00:32, 20.58it/s, est. speed input: 24165.88 toks/s, output: 23.60 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:15<00:32, 20.56it/s, est. speed input: 24085.44 toks/s, output: 23.52 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:15<00:31, 20.52it/s, est. speed input: 24007.27 toks/s, output: 23.44 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:16<00:31, 20.52it/s, est. speed input: 23935.26 toks/s, output: 23.37 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:16<00:31, 20.50it/s, est. speed input: 23864.66 toks/s, output: 23.31 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [00:16<00:30, 20.53it/s, est. speed input: 23800.82 toks/s, output: 23.24 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:17<00:30, 20.54it/s, est. speed input: 23739.58 toks/s, output: 23.18 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:17<00:29, 20.51it/s, est. speed input: 23677.69 toks/s, output: 23.12 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:18<00:29, 20.53it/s, est. speed input: 23621.42 toks/s, output: 23.07 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:18<00:29, 20.51it/s, est. speed input: 23564.95 toks/s, output: 23.01 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:18<00:28, 20.53it/s, est. speed input: 23513.52 toks/s, output: 22.96 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:19<00:28, 20.51it/s, est. speed input: 23462.18 toks/s, output: 22.91 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:19<00:28, 20.49it/s, est. speed input: 23411.96 toks/s, output: 22.86 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:20<00:27, 20.49it/s, est. speed input: 23364.16 toks/s, output: 22.82 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:20<00:27, 20.49it/s, est. speed input: 23318.71 toks/s, output: 22.77 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:20<00:26, 20.48it/s, est. speed input: 23274.34 toks/s, output: 22.73 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:21<00:26, 20.47it/s, est. speed input: 23231.07 toks/s, output: 22.69 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:21<00:26, 20.48it/s, est. speed input: 23190.94 toks/s, output: 22.65 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:22<00:25, 20.49it/s, est. speed input: 23152.41 toks/s, output: 22.61 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:22<00:25, 20.49it/s, est. speed input: 23114.50 toks/s, output: 22.57 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:22<00:24, 20.48it/s, est. speed input: 23077.63 toks/s, output: 22.54 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:23<00:24, 20.46it/s, est. speed input: 23040.65 toks/s, output: 22.50 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:23<00:24, 20.50it/s, est. speed input: 23008.45 toks/s, output: 22.47 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:23<00:23, 20.50it/s, est. speed input: 22975.48 toks/s, output: 22.44 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:24<00:23, 20.45it/s, est. speed input: 22940.56 toks/s, output: 22.40 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:24<00:22, 20.46it/s, est. speed input: 22909.94 toks/s, output: 22.37 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:25<00:22, 20.41it/s, est. speed input: 22876.67 toks/s, output: 22.34 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:25<00:22, 20.45it/s, est. speed input: 22848.34 toks/s, output: 22.31 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:25<00:21, 20.47it/s, est. speed input: 22820.64 toks/s, output: 22.29 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:26<00:21, 20.45it/s, est. speed input: 22792.10 toks/s, output: 22.26 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:26<00:21, 20.43it/s, est. speed input: 22763.91 toks/s, output: 22.23 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:27<00:20, 20.42it/s, est. speed input: 22736.50 toks/s, output: 22.20 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:27<00:20, 20.42it/s, est. speed input: 22710.54 toks/s, output: 22.18 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:27<00:19, 20.43it/s, est. speed input: 22685.99 toks/s, output: 22.15 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:28<00:19, 20.41it/s, est. speed input: 22660.27 toks/s, output: 22.13 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:28<00:19, 20.40it/s, est. speed input: 22636.00 toks/s, output: 22.11 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:29<00:18, 20.41it/s, est. speed input: 22612.87 toks/s, output: 22.08 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:29<00:18, 20.42it/s, est. speed input: 22590.47 toks/s, output: 22.06 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:29<00:17, 20.44it/s, est. speed input: 22569.49 toks/s, output: 22.04 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:30<00:17, 20.42it/s, est. speed input: 22547.49 toks/s, output: 22.02 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:30<00:17, 20.43it/s, est. speed input: 22526.67 toks/s, output: 22.00 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:31<00:16, 20.45it/s, est. speed input: 22507.34 toks/s, output: 21.98 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:31<00:16, 20.43it/s, est. speed input: 22486.99 toks/s, output: 21.96 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:31<00:15, 20.47it/s, est. speed input: 22469.40 toks/s, output: 21.94 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:32<00:15, 20.47it/s, est. speed input: 22451.18 toks/s, output: 21.92 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:32<00:15, 20.41it/s, est. speed input: 22430.71 toks/s, output: 21.90 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:32<00:14, 20.40it/s, est. speed input: 22412.15 toks/s, output: 21.89 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:33<00:14, 20.41it/s, est. speed input: 22394.49 toks/s, output: 21.87 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:33<00:13, 20.45it/s, est. speed input: 22379.05 toks/s, output: 21.85 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:34<00:13, 20.45it/s, est. speed input: 22362.28 toks/s, output: 21.84 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:34<00:13, 20.44it/s, est. speed input: 22345.75 toks/s, output: 21.82 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:34<00:12, 20.43it/s, est. speed input: 22329.65 toks/s, output: 21.81 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:35<00:12, 20.39it/s, est. speed input: 22312.41 toks/s, output: 21.79 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:35<00:12, 20.35it/s, est. speed input: 22295.01 toks/s, output: 21.77 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:36<00:11, 20.98it/s, est. speed input: 22303.38 toks/s, output: 21.78 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:36<00:11, 20.77it/s, est. speed input: 22286.94 toks/s, output: 21.76 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:36<00:10, 20.66it/s, est. speed input: 22272.29 toks/s, output: 21.75 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:37<00:10, 20.55it/s, est. speed input: 22256.40 toks/s, output: 21.73 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:37<00:10, 20.50it/s, est. speed input: 22242.23 toks/s, output: 21.72 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:38<00:09, 20.49it/s, est. speed input: 22228.93 toks/s, output: 21.71 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:38<00:09, 20.45it/s, est. speed input: 22214.92 toks/s, output: 21.69 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [00:38<00:08, 20.44it/s, est. speed input: 22201.51 toks/s, output: 21.68 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [00:39<00:08, 20.40it/s, est. speed input: 22187.47 toks/s, output: 21.67 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:39<00:08, 20.42it/s, est. speed input: 22175.17 toks/s, output: 21.66 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [00:40<00:07, 20.43it/s, est. speed input: 22163.12 toks/s, output: 21.64 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [00:40<00:07, 20.40it/s, est. speed input: 22150.29 toks/s, output: 21.63 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [00:40<00:06, 20.38it/s, est. speed input: 22137.43 toks/s, output: 21.62 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [00:41<00:06, 20.35it/s, est. speed input: 22124.26 toks/s, output: 21.61 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [00:41<00:06, 20.38it/s, est. speed input: 22113.21 toks/s, output: 21.59 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [00:41<00:05, 20.39it/s, est. speed input: 22101.89 toks/s, output: 21.58 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [00:42<00:05, 20.35it/s, est. speed input: 22089.06 toks/s, output: 21.57 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [00:42<00:05, 20.35it/s, est. speed input: 22077.50 toks/s, output: 21.56 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [00:43<00:04, 20.33it/s, est. speed input: 22065.55 toks/s, output: 21.55 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [00:43<00:04, 20.32it/s, est. speed input: 22054.01 toks/s, output: 21.54 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [00:43<00:03, 20.30it/s, est. speed input: 22042.26 toks/s, output: 21.53 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [00:44<00:03, 20.26it/s, est. speed input: 22029.85 toks/s, output: 21.51 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [00:44<00:03, 20.30it/s, est. speed input: 22019.69 toks/s, output: 21.50 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [00:45<00:02, 20.32it/s, est. speed input: 22009.69 toks/s, output: 21.49 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [00:45<00:02, 20.31it/s, est. speed input: 21998.96 toks/s, output: 21.48 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [00:45<00:01, 20.33it/s, est. speed input: 21989.29 toks/s, output: 21.47 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [00:46<00:01, 20.30it/s, est. speed input: 21978.45 toks/s, output: 21.46 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [00:46<00:01, 20.33it/s, est. speed input: 21969.20 toks/s, output: 21.45 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [00:47<00:00, 20.34it/s, est. speed input: 21959.83 toks/s, output: 21.45 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [00:47<00:00, 21.06it/s, est. speed input: 21971.17 toks/s, output: 21.46 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:47<00:00, 21.06it/s, est. speed input: 22100.45 toks/s, output: 21.58 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:47<00:00, 21.58it/s, est. speed input: 22100.45 toks/s, output: 21.58 toks/s]
[rank0]:[W126 15:21:27.489197056 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=16384 ==========
Time: 2026-01-26 15:21:29
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-FP8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=2048, max_num_seqs=16
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-FP8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 2048 --max-num-seqs 16 --max-model-len 1025 --max-num-batched-tokens 16384 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_FP8E4M3_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-14B-FP8_M16384.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 15:21:47 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1533046) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1533046) WARNING 01-26 15:22:10 [backends.py:609] Failed to read file <frozen os>
Throughput: 20.34 requests/s, 20853.48 total tokens/s, 20.34 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048

STDERR:
[2026-01-26 15:21:46] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 15:21:47] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-FP8'
[2026-01-26 15:21:47] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-FP8
[2026-01-26 15:21:47] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:21:47] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:21:47] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:21:47] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:21:47] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:21:47] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-FP8'
[2026-01-26 15:21:47] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 15:21:47] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 15:21:47] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 15:21:47] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 15:21:47] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 15:21:54] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 15:21:54] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-FP8'
[2026-01-26 15:21:54] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-FP8
[2026-01-26 15:21:54] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:21:54] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:21:54] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:21:54] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:21:54] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:21:54] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-FP8'
[2026-01-26 15:21:54] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 15:21:54] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 15:21:54] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 15:21:54] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 15:21:54] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1533046) [2026-01-26 15:21:56] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1533046) [2026-01-26 15:21:56] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1533046) [2026-01-26 15:21:56] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1533046) [2026-01-26 15:21:56] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1533046) [2026-01-26 15:21:56] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-14B-FP8
(EngineCore_DP0 pid=1533046) [2026-01-26 15:21:56] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1533046) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1533046) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.30it/s]
(EngineCore_DP0 pid=1533046) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.19it/s]
(EngineCore_DP0 pid=1533046) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.63it/s]
(EngineCore_DP0 pid=1533046) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.45it/s]
(EngineCore_DP0 pid=1533046) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.42it/s]
(EngineCore_DP0 pid=1533046) 
(EngineCore_DP0 pid=1533046) [2026-01-26 15:22:00] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [7168, 7680] -> 1D uint8
(EngineCore_DP0 pid=1533046) [2026-01-26 15:22:00] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 34406400 bytes
(EngineCore_DP0 pid=1533046) [2026-01-26 15:22:00] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 7680] -> 1D uint8
(EngineCore_DP0 pid=1533046) [2026-01-26 15:22:00] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 24576000 bytes
(EngineCore_DP0 pid=1533046) [2026-01-26 15:22:00] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [27648, 7680] -> 1D uint8
(EngineCore_DP0 pid=1533046) [2026-01-26 15:22:00] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 132710400 bytes
(EngineCore_DP0 pid=1533046) [2026-01-26 15:22:00] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 20736] -> 1D uint8
(EngineCore_DP0 pid=1533046) [2026-01-26 15:22:00] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 66355200 bytes
(EngineCore_DP0 pid=1533046) [rank0]:W0126 15:22:19.105000 1533046 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1533046) [rank0]:W0126 15:22:19.158000 1533046 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1533046) [rank0]:W0126 15:22:19.781000 1533046 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1533046) [rank0]:W0126 15:22:19.865000 1533046 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1533046) 2026-01-26 15:22:24,605 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1533046) 2026-01-26 15:22:24,838 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1533046) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  14%|█▍        | 1/7 [00:00<00:02,  2.09it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  29%|██▊       | 2/7 [00:00<00:02,  2.00it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  57%|█████▋    | 4/7 [00:01<00:00,  3.62it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  86%|████████▌ | 6/7 [00:01<00:00,  5.36it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:01<00:00,  6.05it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:01<00:00,  4.50it/s]
(EngineCore_DP0 pid=1533046) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  40%|████      | 2/5 [00:00<00:00, 11.59it/s]
Capturing CUDA graphs (decode, FULL):  80%|████████  | 4/5 [00:00<00:00, 12.03it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00,  7.55it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   1%|          | 19/2048 [00:00<00:11, 183.36it/s]
Adding requests:   3%|▎         | 57/2048 [00:00<00:06, 293.10it/s]
Adding requests:   5%|▍         | 95/2048 [00:00<00:05, 330.57it/s]
Adding requests:   6%|▋         | 133/2048 [00:00<00:05, 349.53it/s]
Adding requests:   8%|▊         | 173/2048 [00:00<00:05, 365.05it/s]
Adding requests:  10%|█         | 214/2048 [00:00<00:04, 377.97it/s]
Adding requests:  12%|█▏        | 253/2048 [00:00<00:04, 379.48it/s]
Adding requests:  14%|█▍        | 292/2048 [00:00<00:04, 382.73it/s]
Adding requests:  16%|█▋        | 333/2048 [00:00<00:04, 390.51it/s]
Adding requests:  18%|█▊        | 374/2048 [00:01<00:04, 393.71it/s]
Adding requests:  20%|██        | 415/2048 [00:01<00:04, 398.53it/s]
Adding requests:  22%|██▏       | 455/2048 [00:01<00:04, 396.92it/s]
Adding requests:  24%|██▍       | 498/2048 [00:01<00:03, 403.75it/s]
Adding requests:  26%|██▋       | 541/2048 [00:01<00:03, 408.38it/s]
Adding requests:  28%|██▊       | 582/2048 [00:01<00:03, 403.62it/s]
Adding requests:  30%|███       | 623/2048 [00:01<00:03, 396.69it/s]
Adding requests:  32%|███▏      | 663/2048 [00:01<00:03, 388.69it/s]
Adding requests:  34%|███▍      | 703/2048 [00:01<00:03, 391.43it/s]
Adding requests:  36%|███▋      | 743/2048 [00:01<00:03, 385.70it/s]
Adding requests:  38%|███▊      | 782/2048 [00:02<00:03, 379.54it/s]
Adding requests:  40%|████      | 821/2048 [00:02<00:03, 381.69it/s]
Adding requests:  42%|████▏     | 862/2048 [00:02<00:03, 388.91it/s]
Adding requests:  44%|████▍     | 903/2048 [00:02<00:02, 394.37it/s]
Adding requests:  46%|████▌     | 943/2048 [00:02<00:02, 387.46it/s]
Adding requests:  48%|████▊     | 982/2048 [00:02<00:02, 387.16it/s]
Adding requests:  50%|████▉     | 1021/2048 [00:02<00:02, 384.94it/s]
Adding requests:  52%|█████▏    | 1060/2048 [00:02<00:02, 382.40it/s]
Adding requests:  54%|█████▎    | 1099/2048 [00:02<00:02, 381.65it/s]
Adding requests:  56%|█████▌    | 1140/2048 [00:02<00:02, 389.86it/s]
Adding requests:  58%|█████▊    | 1180/2048 [00:03<00:02, 384.77it/s]
Adding requests:  60%|█████▉    | 1221/2048 [00:03<00:02, 390.38it/s]
Adding requests:  62%|██████▏   | 1261/2048 [00:03<00:02, 386.68it/s]
Adding requests:  63%|██████▎   | 1300/2048 [00:03<00:01, 383.84it/s]
Adding requests:  65%|██████▌   | 1339/2048 [00:03<00:01, 385.38it/s]
Adding requests:  67%|██████▋   | 1379/2048 [00:03<00:01, 389.52it/s]
Adding requests:  69%|██████▉   | 1418/2048 [00:03<00:01, 385.45it/s]
Adding requests:  71%|███████   | 1458/2048 [00:03<00:01, 389.49it/s]
Adding requests:  73%|███████▎  | 1499/2048 [00:03<00:01, 393.60it/s]
Adding requests:  75%|███████▌  | 1539/2048 [00:04<00:01, 392.83it/s]
Adding requests:  77%|███████▋  | 1579/2048 [00:04<00:01, 384.95it/s]
Adding requests:  79%|███████▉  | 1618/2048 [00:04<00:01, 380.65it/s]
Adding requests:  81%|████████  | 1657/2048 [00:04<00:01, 373.81it/s]
Adding requests:  83%|████████▎ | 1695/2048 [00:04<00:00, 374.04it/s]
Adding requests:  85%|████████▍ | 1735/2048 [00:04<00:00, 379.68it/s]
Adding requests:  87%|████████▋ | 1777/2048 [00:04<00:00, 389.59it/s]
Adding requests:  89%|████████▊ | 1816/2048 [00:04<00:00, 384.63it/s]
Adding requests:  91%|█████████ | 1856/2048 [00:04<00:00, 388.91it/s]
Adding requests:  93%|█████████▎| 1895/2048 [00:04<00:00, 388.62it/s]
Adding requests:  94%|█████████▍| 1934/2048 [00:05<00:00, 384.00it/s]
Adding requests:  96%|█████████▋| 1974/2048 [00:05<00:00, 386.43it/s]
Adding requests:  98%|█████████▊| 2013/2048 [00:05<00:00, 384.39it/s]
Adding requests: 100%|██████████| 2048/2048 [00:05<00:00, 383.49it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▍         | 98/2048 [00:00<00:14, 133.49it/s, est. speed input: 136704.34 toks/s, output: 133.49 toks/s]
Processed prompts:   6%|▌         | 114/2048 [00:01<00:29, 65.51it/s, est. speed input: 77225.26 toks/s, output: 75.41 toks/s]  
Processed prompts:   6%|▋         | 130/2048 [00:02<00:42, 44.77it/s, est. speed input: 58187.90 toks/s, output: 56.82 toks/s]
Processed prompts:   7%|▋         | 146/2048 [00:03<00:54, 35.14it/s, est. speed input: 48768.32 toks/s, output: 47.62 toks/s]
Processed prompts:   8%|▊         | 162/2048 [00:03<01:03, 29.81it/s, est. speed input: 43125.88 toks/s, output: 42.11 toks/s]
Processed prompts:   9%|▊         | 178/2048 [00:04<01:09, 26.72it/s, est. speed input: 39456.47 toks/s, output: 38.53 toks/s]
Processed prompts:   9%|▉         | 194/2048 [00:05<01:13, 25.22it/s, est. speed input: 37138.99 toks/s, output: 36.27 toks/s]
Processed prompts:  10%|█         | 210/2048 [00:06<01:17, 23.77it/s, est. speed input: 35132.97 toks/s, output: 34.31 toks/s]
Processed prompts:  11%|█         | 226/2048 [00:06<01:20, 22.77it/s, est. speed input: 33551.12 toks/s, output: 32.76 toks/s]
Processed prompts:  12%|█▏        | 242/2048 [00:07<01:21, 22.09it/s, est. speed input: 32289.19 toks/s, output: 31.53 toks/s]
Processed prompts:  13%|█▎        | 258/2048 [00:08<01:22, 21.67it/s, est. speed input: 31275.82 toks/s, output: 30.54 toks/s]
Processed prompts:  13%|█▎        | 274/2048 [00:09<01:23, 21.37it/s, est. speed input: 30429.15 toks/s, output: 29.72 toks/s]
Processed prompts:  14%|█▍        | 290/2048 [00:09<01:23, 21.16it/s, est. speed input: 29712.13 toks/s, output: 29.02 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [00:10<01:22, 21.00it/s, est. speed input: 29093.64 toks/s, output: 28.41 toks/s]
Processed prompts:  16%|█▌        | 322/2048 [00:11<01:22, 20.89it/s, est. speed input: 28558.65 toks/s, output: 27.89 toks/s]
Processed prompts:  17%|█▋        | 338/2048 [00:12<01:22, 20.81it/s, est. speed input: 28091.68 toks/s, output: 27.43 toks/s]
Processed prompts:  17%|█▋        | 354/2048 [00:13<01:21, 20.76it/s, est. speed input: 27680.26 toks/s, output: 27.03 toks/s]
Processed prompts:  18%|█▊        | 370/2048 [00:13<01:20, 20.73it/s, est. speed input: 27315.03 toks/s, output: 26.67 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [00:14<01:20, 20.70it/s, est. speed input: 26987.89 toks/s, output: 26.36 toks/s]
Processed prompts:  20%|█▉        | 402/2048 [00:15<01:19, 20.69it/s, est. speed input: 26696.28 toks/s, output: 26.07 toks/s]
Processed prompts:  20%|██        | 418/2048 [00:16<01:18, 20.65it/s, est. speed input: 26423.76 toks/s, output: 25.80 toks/s]
Processed prompts:  21%|██        | 434/2048 [00:16<01:18, 20.62it/s, est. speed input: 26177.28 toks/s, output: 25.56 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [00:17<01:17, 20.62it/s, est. speed input: 25956.53 toks/s, output: 25.35 toks/s]
Processed prompts:  23%|██▎       | 466/2048 [00:18<01:16, 20.63it/s, est. speed input: 25755.60 toks/s, output: 25.15 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [00:19<01:15, 20.62it/s, est. speed input: 25567.56 toks/s, output: 24.97 toks/s]
Processed prompts:  24%|██▍       | 498/2048 [00:20<01:15, 20.60it/s, est. speed input: 25392.37 toks/s, output: 24.80 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [00:20<01:14, 20.58it/s, est. speed input: 25229.16 toks/s, output: 24.64 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [00:21<01:13, 20.57it/s, est. speed input: 25077.81 toks/s, output: 24.49 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [00:22<01:13, 20.56it/s, est. speed input: 24938.12 toks/s, output: 24.35 toks/s]
Processed prompts:  27%|██▋       | 562/2048 [00:23<01:12, 20.55it/s, est. speed input: 24805.82 toks/s, output: 24.22 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [00:23<01:11, 20.54it/s, est. speed input: 24682.87 toks/s, output: 24.10 toks/s]
Processed prompts:  29%|██▉       | 594/2048 [00:24<01:10, 20.53it/s, est. speed input: 24566.21 toks/s, output: 23.99 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [00:25<01:10, 20.54it/s, est. speed input: 24459.07 toks/s, output: 23.89 toks/s]
Processed prompts:  31%|███       | 626/2048 [00:26<01:09, 20.52it/s, est. speed input: 24356.17 toks/s, output: 23.79 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [00:27<01:08, 20.52it/s, est. speed input: 24259.63 toks/s, output: 23.69 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [00:27<01:07, 20.51it/s, est. speed input: 24168.13 toks/s, output: 23.60 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [00:28<01:07, 20.51it/s, est. speed input: 24081.27 toks/s, output: 23.52 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [00:29<01:06, 20.51it/s, est. speed input: 23999.74 toks/s, output: 23.44 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [00:30<01:05, 20.49it/s, est. speed input: 23920.85 toks/s, output: 23.36 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [00:31<01:04, 20.47it/s, est. speed input: 23844.82 toks/s, output: 23.29 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [00:31<01:03, 20.48it/s, est. speed input: 23774.35 toks/s, output: 23.22 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [00:32<01:03, 20.48it/s, est. speed input: 23707.10 toks/s, output: 23.15 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [00:33<01:02, 20.48it/s, est. speed input: 23643.31 toks/s, output: 23.09 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [00:34<01:00, 20.82it/s, est. speed input: 23611.16 toks/s, output: 23.06 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [00:34<01:00, 20.71it/s, est. speed input: 23551.93 toks/s, output: 23.00 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [00:35<00:59, 20.63it/s, est. speed input: 23494.16 toks/s, output: 22.94 toks/s]
Processed prompts:  41%|████      | 834/2048 [00:36<00:58, 20.58it/s, est. speed input: 23440.18 toks/s, output: 22.89 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [00:37<00:58, 20.55it/s, est. speed input: 23388.42 toks/s, output: 22.84 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [00:37<00:57, 20.53it/s, est. speed input: 23338.82 toks/s, output: 22.79 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [00:38<00:56, 20.50it/s, est. speed input: 23290.00 toks/s, output: 22.74 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [00:39<00:56, 20.48it/s, est. speed input: 23242.81 toks/s, output: 22.70 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [00:40<00:55, 20.45it/s, est. speed input: 23196.75 toks/s, output: 22.65 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [00:41<00:54, 20.45it/s, est. speed input: 23154.11 toks/s, output: 22.61 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [00:41<00:53, 20.44it/s, est. speed input: 23112.00 toks/s, output: 22.57 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [00:42<00:53, 20.43it/s, est. speed input: 23071.60 toks/s, output: 22.53 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [00:43<00:52, 20.42it/s, est. speed input: 23032.23 toks/s, output: 22.49 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [00:44<00:51, 20.41it/s, est. speed input: 22993.95 toks/s, output: 22.46 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [00:45<00:50, 20.41it/s, est. speed input: 22957.47 toks/s, output: 22.42 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [00:45<00:50, 20.40it/s, est. speed input: 22921.42 toks/s, output: 22.38 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [00:46<00:49, 20.41it/s, est. speed input: 22887.85 toks/s, output: 22.35 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [00:47<00:48, 20.41it/s, est. speed input: 22854.94 toks/s, output: 22.32 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [00:48<00:47, 20.39it/s, est. speed input: 22822.23 toks/s, output: 22.29 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [00:48<00:46, 20.41it/s, est. speed input: 22792.17 toks/s, output: 22.26 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [00:49<00:46, 20.42it/s, est. speed input: 22763.20 toks/s, output: 22.23 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [00:50<00:45, 20.43it/s, est. speed input: 22734.97 toks/s, output: 22.20 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [00:51<00:44, 20.42it/s, est. speed input: 22706.68 toks/s, output: 22.17 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [00:52<00:43, 20.41it/s, est. speed input: 22679.34 toks/s, output: 22.15 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [00:52<00:43, 20.42it/s, est. speed input: 22653.21 toks/s, output: 22.12 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [00:53<00:42, 20.41it/s, est. speed input: 22627.37 toks/s, output: 22.10 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [00:54<00:41, 20.40it/s, est. speed input: 22601.83 toks/s, output: 22.07 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [00:55<00:40, 20.38it/s, est. speed input: 22576.53 toks/s, output: 22.05 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [00:56<00:39, 20.37it/s, est. speed input: 22552.23 toks/s, output: 22.02 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [00:56<00:39, 20.38it/s, est. speed input: 22529.30 toks/s, output: 22.00 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [00:57<00:38, 20.39it/s, est. speed input: 22507.03 toks/s, output: 21.98 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [00:58<00:37, 20.38it/s, est. speed input: 22484.50 toks/s, output: 21.96 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [00:59<00:36, 20.37it/s, est. speed input: 22462.52 toks/s, output: 21.94 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [00:59<00:36, 20.37it/s, est. speed input: 22441.58 toks/s, output: 21.92 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [01:00<00:35, 20.36it/s, est. speed input: 22420.79 toks/s, output: 21.90 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [01:01<00:34, 20.35it/s, est. speed input: 22400.33 toks/s, output: 21.88 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [01:02<00:33, 20.35it/s, est. speed input: 22380.68 toks/s, output: 21.86 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [01:03<00:32, 20.35it/s, est. speed input: 22361.34 toks/s, output: 21.84 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [01:03<00:32, 20.37it/s, est. speed input: 22343.29 toks/s, output: 21.82 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [01:04<00:31, 20.37it/s, est. speed input: 22325.27 toks/s, output: 21.80 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [01:05<00:30, 20.38it/s, est. speed input: 22308.11 toks/s, output: 21.79 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [01:06<00:29, 20.35it/s, est. speed input: 22289.81 toks/s, output: 21.77 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [01:07<00:29, 20.33it/s, est. speed input: 22271.92 toks/s, output: 21.75 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [01:07<00:28, 20.36it/s, est. speed input: 22256.50 toks/s, output: 21.73 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [01:08<00:27, 20.36it/s, est. speed input: 22240.37 toks/s, output: 21.72 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [01:09<00:26, 20.33it/s, est. speed input: 22223.39 toks/s, output: 21.70 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [01:10<00:25, 20.32it/s, est. speed input: 22207.10 toks/s, output: 21.69 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [01:10<00:25, 20.32it/s, est. speed input: 22191.45 toks/s, output: 21.67 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [01:11<00:23, 20.66it/s, est. speed input: 22189.73 toks/s, output: 21.67 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [01:12<00:23, 20.55it/s, est. speed input: 22174.55 toks/s, output: 21.65 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [01:13<00:22, 20.45it/s, est. speed input: 22158.72 toks/s, output: 21.64 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [01:14<00:21, 20.41it/s, est. speed input: 22144.10 toks/s, output: 21.63 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [01:14<00:20, 20.70it/s, est. speed input: 22141.83 toks/s, output: 21.62 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [01:15<00:20, 20.57it/s, est. speed input: 22127.59 toks/s, output: 21.61 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [01:16<00:19, 20.48it/s, est. speed input: 22113.27 toks/s, output: 21.59 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [01:17<00:18, 20.43it/s, est. speed input: 22099.97 toks/s, output: 21.58 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [01:17<00:17, 20.38it/s, est. speed input: 22086.36 toks/s, output: 21.57 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [01:18<00:17, 20.35it/s, est. speed input: 22073.08 toks/s, output: 21.56 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [01:19<00:16, 20.34it/s, est. speed input: 22060.64 toks/s, output: 21.54 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [01:20<00:15, 20.32it/s, est. speed input: 22047.81 toks/s, output: 21.53 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [01:21<00:14, 20.31it/s, est. speed input: 22035.32 toks/s, output: 21.52 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [01:21<00:14, 20.29it/s, est. speed input: 22022.77 toks/s, output: 21.51 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [01:22<00:13, 20.27it/s, est. speed input: 22010.33 toks/s, output: 21.49 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [01:23<00:12, 20.26it/s, est. speed input: 21998.14 toks/s, output: 21.48 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [01:24<00:11, 20.27it/s, est. speed input: 21986.72 toks/s, output: 21.47 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [01:25<00:10, 20.26it/s, est. speed input: 21974.95 toks/s, output: 21.46 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [01:25<00:10, 20.25it/s, est. speed input: 21963.23 toks/s, output: 21.45 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [01:26<00:09, 20.23it/s, est. speed input: 21951.61 toks/s, output: 21.44 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [01:27<00:08, 20.26it/s, est. speed input: 21941.29 toks/s, output: 21.43 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [01:28<00:07, 20.27it/s, est. speed input: 21930.88 toks/s, output: 21.42 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [01:29<00:07, 20.25it/s, est. speed input: 21919.98 toks/s, output: 21.41 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [01:29<00:06, 20.25it/s, est. speed input: 21909.33 toks/s, output: 21.40 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [01:30<00:05, 20.26it/s, est. speed input: 21899.38 toks/s, output: 21.39 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [01:31<00:04, 20.24it/s, est. speed input: 21888.74 toks/s, output: 21.38 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [01:32<00:03, 20.23it/s, est. speed input: 21878.62 toks/s, output: 21.37 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [01:32<00:03, 20.21it/s, est. speed input: 21868.13 toks/s, output: 21.36 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [01:33<00:02, 20.21it/s, est. speed input: 21858.24 toks/s, output: 21.35 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [01:34<00:01, 20.21it/s, est. speed input: 21848.44 toks/s, output: 21.34 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [01:35<00:00, 20.61it/s, est. speed input: 21850.58 toks/s, output: 21.34 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [01:35<00:00, 20.61it/s, est. speed input: 22000.85 toks/s, output: 21.49 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [01:35<00:00, 21.49it/s, est. speed input: 22000.85 toks/s, output: 21.49 toks/s]
[rank0]:[W126 15:24:09.923464664 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=32768 ==========
Time: 2026-01-26 15:24:11
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-FP8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=4096, max_num_seqs=32
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-FP8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 4096 --max-num-seqs 32 --max-model-len 1025 --max-num-batched-tokens 32768 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_FP8E4M3_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-14B-FP8_M32768.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 15:24:40 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1535804) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1535804) WARNING 01-26 15:25:03 [backends.py:609] Failed to read file <frozen os>
Throughput: 20.54 requests/s, 21054.45 total tokens/s, 20.54 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096

STDERR:
[2026-01-26 15:24:39] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 15:24:40] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-FP8'
[2026-01-26 15:24:40] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-FP8
[2026-01-26 15:24:40] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:24:40] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:24:40] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:24:40] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:24:40] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:24:40] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-FP8'
[2026-01-26 15:24:40] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 15:24:40] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 15:24:40] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 15:24:40] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 15:24:40] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 15:24:46] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 15:24:47] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-FP8'
[2026-01-26 15:24:47] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-FP8
[2026-01-26 15:24:47] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:24:47] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:24:47] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:24:47] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:24:47] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:24:47] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-FP8'
[2026-01-26 15:24:47] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 15:24:47] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 15:24:47] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 15:24:47] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 15:24:47] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1535804) [2026-01-26 15:24:49] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1535804) [2026-01-26 15:24:49] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1535804) [2026-01-26 15:24:49] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1535804) [2026-01-26 15:24:49] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1535804) [2026-01-26 15:24:49] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-14B-FP8
(EngineCore_DP0 pid=1535804) [2026-01-26 15:24:49] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1535804) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1535804) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.28it/s]
(EngineCore_DP0 pid=1535804) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.18it/s]
(EngineCore_DP0 pid=1535804) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.62it/s]
(EngineCore_DP0 pid=1535804) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.45it/s]
(EngineCore_DP0 pid=1535804) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.42it/s]
(EngineCore_DP0 pid=1535804) 
(EngineCore_DP0 pid=1535804) [2026-01-26 15:24:53] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [7168, 7680] -> 1D uint8
(EngineCore_DP0 pid=1535804) [2026-01-26 15:24:53] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 34406400 bytes
(EngineCore_DP0 pid=1535804) [2026-01-26 15:24:53] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 7680] -> 1D uint8
(EngineCore_DP0 pid=1535804) [2026-01-26 15:24:53] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 24576000 bytes
(EngineCore_DP0 pid=1535804) [2026-01-26 15:24:53] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [27648, 7680] -> 1D uint8
(EngineCore_DP0 pid=1535804) [2026-01-26 15:24:53] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 132710400 bytes
(EngineCore_DP0 pid=1535804) [2026-01-26 15:24:53] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 20736] -> 1D uint8
(EngineCore_DP0 pid=1535804) [2026-01-26 15:24:53] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 66355200 bytes
(EngineCore_DP0 pid=1535804) [rank0]:W0126 15:25:11.953000 1535804 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1535804) [rank0]:W0126 15:25:12.007000 1535804 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1535804) [rank0]:W0126 15:25:12.687000 1535804 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1535804) [rank0]:W0126 15:25:12.772000 1535804 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=1535804) 2026-01-26 15:25:17,355 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1535804) 2026-01-26 15:25:17,858 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1535804) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   9%|▉         | 1/11 [00:00<00:05,  1.96it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  27%|██▋       | 3/11 [00:00<00:01,  5.06it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  45%|████▌     | 5/11 [00:00<00:00,  6.38it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  55%|█████▍    | 6/11 [00:01<00:00,  6.49it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  73%|███████▎  | 8/11 [00:01<00:00,  8.09it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  91%|█████████ | 10/11 [00:01<00:00,  6.32it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:02<00:00,  4.06it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:02<00:00,  4.92it/s]
(EngineCore_DP0 pid=1535804) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  14%|█▍        | 1/7 [00:00<00:00,  8.15it/s]
Capturing CUDA graphs (decode, FULL):  43%|████▎     | 3/7 [00:00<00:00, 10.82it/s]
Capturing CUDA graphs (decode, FULL):  71%|███████▏  | 5/7 [00:00<00:00, 11.38it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00,  8.55it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00,  9.13it/s]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   0%|          | 20/4096 [00:00<00:20, 194.27it/s]
Adding requests:   1%|▏         | 61/4096 [00:00<00:12, 315.35it/s]
Adding requests:   2%|▏         | 98/4096 [00:00<00:11, 336.45it/s]
Adding requests:   3%|▎         | 136/4096 [00:00<00:11, 351.96it/s]
Adding requests:   4%|▍         | 176/4096 [00:00<00:10, 365.82it/s]
Adding requests:   5%|▌         | 217/4096 [00:00<00:10, 378.86it/s]
Adding requests:   6%|▌         | 255/4096 [00:00<00:10, 378.53it/s]
Adding requests:   7%|▋         | 295/4096 [00:00<00:09, 382.83it/s]
Adding requests:   8%|▊         | 337/4096 [00:00<00:09, 391.23it/s]
Adding requests:   9%|▉         | 377/4096 [00:01<00:09, 393.54it/s]
Adding requests:  10%|█         | 419/4096 [00:01<00:09, 400.59it/s]
Adding requests:  11%|█         | 460/4096 [00:01<00:09, 395.55it/s]
Adding requests:  12%|█▏        | 503/4096 [00:01<00:08, 403.64it/s]
Adding requests:  13%|█▎        | 545/4096 [00:01<00:08, 408.01it/s]
Adding requests:  14%|█▍        | 586/4096 [00:01<00:08, 402.28it/s]
Adding requests:  15%|█▌        | 627/4096 [00:01<00:08, 400.11it/s]
Adding requests:  16%|█▋        | 668/4096 [00:01<00:08, 388.66it/s]
Adding requests:  17%|█▋        | 709/4096 [00:01<00:08, 393.32it/s]
Adding requests:  18%|█▊        | 749/4096 [00:01<00:08, 385.00it/s]
Adding requests:  19%|█▉        | 789/4096 [00:02<00:08, 387.77it/s]
Adding requests:  20%|██        | 829/4096 [00:02<00:08, 390.30it/s]
Adding requests:  21%|██        | 869/4096 [00:02<00:08, 392.76it/s]
Adding requests:  22%|██▏       | 909/4096 [00:02<00:08, 394.82it/s]
Adding requests:  23%|██▎       | 949/4096 [00:02<00:08, 385.44it/s]
Adding requests:  24%|██▍       | 989/4096 [00:02<00:08, 387.78it/s]
Adding requests:  25%|██▌       | 1028/4096 [00:02<00:07, 384.26it/s]
Adding requests:  26%|██▌       | 1067/4096 [00:02<00:07, 382.22it/s]
Adding requests:  27%|██▋       | 1106/4096 [00:02<00:07, 379.88it/s]
Adding requests:  28%|██▊       | 1145/4096 [00:02<00:07, 377.77it/s]
Adding requests:  29%|██▉       | 1184/4096 [00:03<00:07, 378.00it/s]
Adding requests:  30%|██▉       | 1225/4096 [00:03<00:07, 384.88it/s]
Adding requests:  31%|███       | 1264/4096 [00:03<00:07, 383.38it/s]
Adding requests:  32%|███▏      | 1303/4096 [00:03<00:07, 382.66it/s]
Adding requests:  33%|███▎      | 1342/4096 [00:03<00:07, 383.63it/s]
Adding requests:  34%|███▎      | 1382/4096 [00:03<00:07, 387.19it/s]
Adding requests:  35%|███▍      | 1421/4096 [00:03<00:06, 384.27it/s]
Adding requests:  36%|███▌      | 1460/4096 [00:03<00:06, 385.71it/s]
Adding requests:  37%|███▋      | 1501/4096 [00:03<00:06, 390.99it/s]
Adding requests:  38%|███▊      | 1541/4096 [00:04<00:06, 391.24it/s]
Adding requests:  39%|███▊      | 1581/4096 [00:04<00:06, 383.20it/s]
Adding requests:  40%|███▉      | 1620/4096 [00:04<00:06, 379.22it/s]
Adding requests:  40%|████      | 1658/4096 [00:04<00:06, 372.24it/s]
Adding requests:  41%|████▏     | 1696/4096 [00:04<00:06, 373.99it/s]
Adding requests:  42%|████▏     | 1736/4096 [00:04<00:06, 379.89it/s]
Adding requests:  43%|████▎     | 1777/4096 [00:04<00:05, 388.65it/s]
Adding requests:  44%|████▍     | 1816/4096 [00:04<00:05, 382.55it/s]
Adding requests:  45%|████▌     | 1856/4096 [00:04<00:05, 387.19it/s]
Adding requests:  46%|████▋     | 1895/4096 [00:04<00:05, 386.32it/s]
Adding requests:  47%|████▋     | 1936/4096 [00:05<00:05, 392.06it/s]
Adding requests:  48%|████▊     | 1976/4096 [00:05<00:05, 393.18it/s]
Adding requests:  49%|████▉     | 2016/4096 [00:05<00:05, 385.49it/s]
Adding requests:  50%|█████     | 2055/4096 [00:05<00:05, 382.65it/s]
Adding requests:  51%|█████     | 2094/4096 [00:05<00:05, 378.59it/s]
Adding requests:  52%|█████▏    | 2133/4096 [00:05<00:05, 379.62it/s]
Adding requests:  53%|█████▎    | 2171/4096 [00:05<00:05, 375.85it/s]
Adding requests:  54%|█████▍    | 2209/4096 [00:05<00:05, 372.81it/s]
Adding requests:  55%|█████▍    | 2248/4096 [00:05<00:04, 377.55it/s]
Adding requests:  56%|█████▌    | 2289/4096 [00:05<00:04, 385.48it/s]
Adding requests:  57%|█████▋    | 2329/4096 [00:06<00:04, 382.25it/s]
Adding requests:  58%|█████▊    | 2369/4096 [00:06<00:04, 386.24it/s]
Adding requests:  59%|█████▉    | 2410/4096 [00:06<00:04, 392.45it/s]
Adding requests:  60%|█████▉    | 2450/4096 [00:06<00:04, 392.13it/s]
Adding requests:  61%|██████    | 2490/4096 [00:06<00:04, 392.23it/s]
Adding requests:  62%|██████▏   | 2532/4096 [00:06<00:03, 397.38it/s]
Adding requests:  63%|██████▎   | 2575/4096 [00:06<00:03, 405.34it/s]
Adding requests:  64%|██████▍   | 2616/4096 [00:06<00:03, 401.23it/s]
Adding requests:  65%|██████▍   | 2657/4096 [00:06<00:03, 393.53it/s]
Adding requests:  66%|██████▌   | 2697/4096 [00:07<00:03, 389.15it/s]
Adding requests:  67%|██████▋   | 2736/4096 [00:07<00:03, 386.78it/s]
Adding requests:  68%|██████▊   | 2777/4096 [00:07<00:03, 392.64it/s]
Adding requests:  69%|██████▉   | 2819/4096 [00:07<00:03, 400.05it/s]
Adding requests:  70%|██████▉   | 2860/4096 [00:07<00:03, 398.31it/s]
Adding requests:  71%|███████   | 2900/4096 [00:07<00:03, 396.16it/s]
Adding requests:  72%|███████▏  | 2941/4096 [00:07<00:02, 398.52it/s]
Adding requests:  73%|███████▎  | 2981/4096 [00:07<00:02, 397.62it/s]
Adding requests:  74%|███████▍  | 3022/4096 [00:07<00:02, 399.25it/s]
Adding requests:  75%|███████▍  | 3064/4096 [00:07<00:02, 403.60it/s]
Adding requests:  76%|███████▌  | 3105/4096 [00:08<00:02, 403.25it/s]
Adding requests:  77%|███████▋  | 3146/4096 [00:08<00:02, 405.23it/s]
Adding requests:  78%|███████▊  | 3187/4096 [00:08<00:02, 397.49it/s]
Adding requests:  79%|███████▉  | 3227/4096 [00:08<00:02, 396.90it/s]
Adding requests:  80%|███████▉  | 3267/4096 [00:08<00:02, 392.17it/s]
Adding requests:  81%|████████  | 3307/4096 [00:08<00:02, 382.25it/s]
Adding requests:  82%|████████▏ | 3347/4096 [00:08<00:01, 385.63it/s]
Adding requests:  83%|████████▎ | 3388/4096 [00:08<00:01, 389.91it/s]
Adding requests:  84%|████████▎ | 3428/4096 [00:08<00:01, 389.75it/s]
Adding requests:  85%|████████▍ | 3469/4096 [00:08<00:01, 393.45it/s]
Adding requests:  86%|████████▌ | 3509/4096 [00:09<00:01, 394.78it/s]
Adding requests:  87%|████████▋ | 3550/4096 [00:09<00:01, 399.20it/s]
Adding requests:  88%|████████▊ | 3590/4096 [00:09<00:01, 395.36it/s]
Adding requests:  89%|████████▊ | 3631/4096 [00:09<00:01, 399.11it/s]
Adding requests:  90%|████████▉ | 3671/4096 [00:09<00:01, 391.93it/s]
Adding requests:  91%|█████████ | 3711/4096 [00:09<00:01, 380.71it/s]
Adding requests:  92%|█████████▏| 3750/4096 [00:09<00:00, 380.40it/s]
Adding requests:  93%|█████████▎| 3789/4096 [00:09<00:00, 371.87it/s]
Adding requests:  93%|█████████▎| 3827/4096 [00:09<00:00, 369.77it/s]
Adding requests:  94%|█████████▍| 3866/4096 [00:09<00:00, 374.29it/s]
Adding requests:  95%|█████████▌| 3904/4096 [00:10<00:00, 374.00it/s]
Adding requests:  96%|█████████▌| 3942/4096 [00:10<00:00, 370.74it/s]
Adding requests:  97%|█████████▋| 3980/4096 [00:10<00:00, 373.26it/s]
Adding requests:  98%|█████████▊| 4019/4096 [00:10<00:00, 377.23it/s]
Adding requests:  99%|█████████▉| 4057/4096 [00:10<00:00, 374.36it/s]
Adding requests: 100%|█████████▉| 4095/4096 [00:10<00:00, 374.68it/s]
Adding requests: 100%|██████████| 4096/4096 [00:10<00:00, 385.91it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▍         | 194/4096 [00:00<00:03, 985.21it/s, est. speed input: 1009086.19 toks/s, output: 985.27 toks/s]
Processed prompts:   7%|▋         | 293/4096 [00:04<01:16, 49.60it/s, est. speed input: 62595.04 toks/s, output: 61.13 toks/s]    
Processed prompts:   8%|▊         | 335/4096 [00:06<01:28, 42.54it/s, est. speed input: 54187.71 toks/s, output: 52.92 toks/s]
Processed prompts:   9%|▉         | 359/4096 [00:07<01:49, 34.15it/s, est. speed input: 46729.45 toks/s, output: 45.63 toks/s]
Processed prompts:   9%|▉         | 386/4096 [00:09<02:07, 29.04it/s, est. speed input: 42028.68 toks/s, output: 41.04 toks/s]
Processed prompts:  10%|█         | 418/4096 [00:10<02:18, 26.52it/s, est. speed input: 39117.34 toks/s, output: 38.20 toks/s]
Processed prompts:  11%|█         | 450/4096 [00:12<02:27, 24.78it/s, est. speed input: 36921.04 toks/s, output: 36.06 toks/s]
Processed prompts:  12%|█▏        | 482/4096 [00:14<02:33, 23.57it/s, est. speed input: 35203.29 toks/s, output: 34.38 toks/s]
Processed prompts:  13%|█▎        | 514/4096 [00:15<02:37, 22.73it/s, est. speed input: 33826.29 toks/s, output: 33.03 toks/s]
Processed prompts:  13%|█▎        | 546/4096 [00:17<02:40, 22.14it/s, est. speed input: 32694.78 toks/s, output: 31.93 toks/s]
Processed prompts:  14%|█▍        | 578/4096 [00:18<02:41, 21.72it/s, est. speed input: 31747.45 toks/s, output: 31.00 toks/s]
Processed prompts:  15%|█▍        | 610/4096 [00:20<02:42, 21.43it/s, est. speed input: 30947.49 toks/s, output: 30.22 toks/s]
Processed prompts:  16%|█▌        | 642/4096 [00:21<02:42, 21.22it/s, est. speed input: 30256.28 toks/s, output: 29.55 toks/s]
Processed prompts:  16%|█▋        | 674/4096 [00:23<02:42, 21.08it/s, est. speed input: 29659.02 toks/s, output: 28.96 toks/s]
Processed prompts:  17%|█▋        | 706/4096 [00:24<02:41, 20.96it/s, est. speed input: 29130.36 toks/s, output: 28.45 toks/s]
Processed prompts:  18%|█▊        | 738/4096 [00:26<02:40, 20.89it/s, est. speed input: 28666.92 toks/s, output: 27.99 toks/s]
Processed prompts:  19%|█▉        | 770/4096 [00:27<02:38, 20.99it/s, est. speed input: 28293.78 toks/s, output: 27.63 toks/s]
Processed prompts:  20%|█▉        | 802/4096 [00:29<02:37, 20.90it/s, est. speed input: 27919.84 toks/s, output: 27.27 toks/s]
Processed prompts:  20%|██        | 834/4096 [00:30<02:36, 20.83it/s, est. speed input: 27582.76 toks/s, output: 26.94 toks/s]
Processed prompts:  21%|██        | 866/4096 [00:32<02:35, 20.78it/s, est. speed input: 27276.54 toks/s, output: 26.64 toks/s]
Processed prompts:  22%|██▏       | 898/4096 [00:34<02:34, 20.74it/s, est. speed input: 26996.95 toks/s, output: 26.36 toks/s]
Processed prompts:  23%|██▎       | 930/4096 [00:35<02:32, 20.71it/s, est. speed input: 26742.53 toks/s, output: 26.12 toks/s]
Processed prompts:  23%|██▎       | 962/4096 [00:37<02:31, 20.67it/s, est. speed input: 26505.46 toks/s, output: 25.88 toks/s]
Processed prompts:  24%|██▍       | 994/4096 [00:38<02:30, 20.66it/s, est. speed input: 26289.81 toks/s, output: 25.67 toks/s]
Processed prompts:  25%|██▌       | 1026/4096 [00:40<02:28, 20.64it/s, est. speed input: 26088.50 toks/s, output: 25.48 toks/s]
Processed prompts:  26%|██▌       | 1058/4096 [00:41<02:27, 20.62it/s, est. speed input: 25902.55 toks/s, output: 25.30 toks/s]
Processed prompts:  27%|██▋       | 1090/4096 [00:43<02:25, 20.61it/s, est. speed input: 25730.02 toks/s, output: 25.13 toks/s]
Processed prompts:  27%|██▋       | 1122/4096 [00:44<02:24, 20.60it/s, est. speed input: 25569.09 toks/s, output: 24.97 toks/s]
Processed prompts:  28%|██▊       | 1154/4096 [00:46<02:22, 20.60it/s, est. speed input: 25418.81 toks/s, output: 24.82 toks/s]
Processed prompts:  29%|██▉       | 1186/4096 [00:48<02:21, 20.61it/s, est. speed input: 25280.12 toks/s, output: 24.69 toks/s]
Processed prompts:  30%|██▉       | 1218/4096 [00:49<02:19, 20.59it/s, est. speed input: 25147.25 toks/s, output: 24.56 toks/s]
Processed prompts:  31%|███       | 1250/4096 [00:51<02:18, 20.58it/s, est. speed input: 25022.66 toks/s, output: 24.44 toks/s]
Processed prompts:  31%|███▏      | 1282/4096 [00:52<02:16, 20.57it/s, est. speed input: 24905.24 toks/s, output: 24.32 toks/s]
Processed prompts:  32%|███▏      | 1314/4096 [00:54<02:15, 20.56it/s, est. speed input: 24793.70 toks/s, output: 24.21 toks/s]
Processed prompts:  33%|███▎      | 1346/4096 [00:55<02:13, 20.55it/s, est. speed input: 24688.84 toks/s, output: 24.11 toks/s]
Processed prompts:  34%|███▎      | 1378/4096 [00:57<02:12, 20.55it/s, est. speed input: 24589.78 toks/s, output: 24.01 toks/s]
Processed prompts:  34%|███▍      | 1410/4096 [00:58<02:10, 20.55it/s, est. speed input: 24495.59 toks/s, output: 23.92 toks/s]
Processed prompts:  35%|███▌      | 1442/4096 [01:00<02:09, 20.55it/s, est. speed input: 24406.75 toks/s, output: 23.83 toks/s]
Processed prompts:  36%|███▌      | 1474/4096 [01:02<02:07, 20.54it/s, est. speed input: 24321.64 toks/s, output: 23.75 toks/s]
Processed prompts:  37%|███▋      | 1506/4096 [01:03<02:06, 20.53it/s, est. speed input: 24240.23 toks/s, output: 23.67 toks/s]
Processed prompts:  38%|███▊      | 1538/4096 [01:05<02:03, 20.69it/s, est. speed input: 24178.07 toks/s, output: 23.61 toks/s]
Processed prompts:  38%|███▊      | 1570/4096 [01:06<02:02, 20.63it/s, est. speed input: 24102.85 toks/s, output: 23.54 toks/s]
Processed prompts:  39%|███▉      | 1602/4096 [01:08<02:00, 20.75it/s, est. speed input: 24045.76 toks/s, output: 23.48 toks/s]
Processed prompts:  40%|███▉      | 1634/4096 [01:09<01:59, 20.66it/s, est. speed input: 23976.72 toks/s, output: 23.41 toks/s]
Processed prompts:  41%|████      | 1666/4096 [01:11<01:57, 20.62it/s, est. speed input: 23911.57 toks/s, output: 23.35 toks/s]
Processed prompts:  41%|████▏     | 1698/4096 [01:12<01:56, 20.57it/s, est. speed input: 23848.05 toks/s, output: 23.29 toks/s]
Processed prompts:  42%|████▏     | 1730/4096 [01:14<01:55, 20.54it/s, est. speed input: 23787.44 toks/s, output: 23.23 toks/s]
Processed prompts:  43%|████▎     | 1762/4096 [01:16<01:53, 20.51it/s, est. speed input: 23728.98 toks/s, output: 23.17 toks/s]
Processed prompts:  44%|████▍     | 1794/4096 [01:17<01:52, 20.51it/s, est. speed input: 23673.65 toks/s, output: 23.12 toks/s]
Processed prompts:  45%|████▍     | 1826/4096 [01:19<01:50, 20.49it/s, est. speed input: 23619.92 toks/s, output: 23.07 toks/s]
Processed prompts:  45%|████▌     | 1858/4096 [01:20<01:49, 20.48it/s, est. speed input: 23568.10 toks/s, output: 23.02 toks/s]
Processed prompts:  46%|████▌     | 1890/4096 [01:22<01:47, 20.48it/s, est. speed input: 23518.48 toks/s, output: 22.97 toks/s]
Processed prompts:  47%|████▋     | 1922/4096 [01:23<01:46, 20.46it/s, est. speed input: 23469.82 toks/s, output: 22.92 toks/s]
Processed prompts:  48%|████▊     | 1954/4096 [01:25<01:44, 20.47it/s, est. speed input: 23424.28 toks/s, output: 22.88 toks/s]
Processed prompts:  48%|████▊     | 1986/4096 [01:26<01:43, 20.46it/s, est. speed input: 23379.43 toks/s, output: 22.83 toks/s]
Processed prompts:  49%|████▉     | 2018/4096 [01:28<01:41, 20.46it/s, est. speed input: 23336.50 toks/s, output: 22.79 toks/s]
Processed prompts:  50%|█████     | 2050/4096 [01:30<01:40, 20.44it/s, est. speed input: 23293.78 toks/s, output: 22.75 toks/s]
Processed prompts:  51%|█████     | 2082/4096 [01:31<01:38, 20.44it/s, est. speed input: 23253.70 toks/s, output: 22.71 toks/s]
Processed prompts:  52%|█████▏    | 2114/4096 [01:33<01:36, 20.44it/s, est. speed input: 23214.57 toks/s, output: 22.67 toks/s]
Processed prompts:  52%|█████▏    | 2146/4096 [01:34<01:35, 20.43it/s, est. speed input: 23176.15 toks/s, output: 22.63 toks/s]
Processed prompts:  53%|█████▎    | 2178/4096 [01:36<01:33, 20.59it/s, est. speed input: 23149.20 toks/s, output: 22.61 toks/s]
Processed prompts:  54%|█████▍    | 2210/4096 [01:37<01:31, 20.54it/s, est. speed input: 23113.22 toks/s, output: 22.57 toks/s]
Processed prompts:  55%|█████▍    | 2242/4096 [01:39<01:30, 20.49it/s, est. speed input: 23077.63 toks/s, output: 22.54 toks/s]
Processed prompts:  56%|█████▌    | 2274/4096 [01:41<01:28, 20.47it/s, est. speed input: 23044.40 toks/s, output: 22.50 toks/s]
Processed prompts:  56%|█████▋    | 2306/4096 [01:42<01:27, 20.45it/s, est. speed input: 23011.63 toks/s, output: 22.47 toks/s]
Processed prompts:  57%|█████▋    | 2338/4096 [01:44<01:26, 20.44it/s, est. speed input: 22979.75 toks/s, output: 22.44 toks/s]
Processed prompts:  58%|█████▊    | 2370/4096 [01:45<01:24, 20.43it/s, est. speed input: 22948.64 toks/s, output: 22.41 toks/s]
Processed prompts:  59%|█████▊    | 2402/4096 [01:47<01:22, 20.41it/s, est. speed input: 22918.30 toks/s, output: 22.38 toks/s]
Processed prompts:  59%|█████▉    | 2434/4096 [01:48<01:21, 20.41it/s, est. speed input: 22888.85 toks/s, output: 22.35 toks/s]
Processed prompts:  60%|██████    | 2466/4096 [01:50<01:19, 20.40it/s, est. speed input: 22860.16 toks/s, output: 22.32 toks/s]
Processed prompts:  61%|██████    | 2498/4096 [01:52<01:18, 20.40it/s, est. speed input: 22832.79 toks/s, output: 22.30 toks/s]
Processed prompts:  62%|██████▏   | 2530/4096 [01:53<01:16, 20.39it/s, est. speed input: 22805.59 toks/s, output: 22.27 toks/s]
Processed prompts:  63%|██████▎   | 2562/4096 [01:55<01:15, 20.41it/s, est. speed input: 22780.41 toks/s, output: 22.25 toks/s]
Processed prompts:  63%|██████▎   | 2594/4096 [01:56<01:13, 20.39it/s, est. speed input: 22754.20 toks/s, output: 22.22 toks/s]
Processed prompts:  64%|██████▍   | 2626/4096 [01:58<01:12, 20.39it/s, est. speed input: 22729.38 toks/s, output: 22.20 toks/s]
Processed prompts:  65%|██████▍   | 2658/4096 [01:59<01:10, 20.39it/s, est. speed input: 22705.22 toks/s, output: 22.17 toks/s]
Processed prompts:  66%|██████▌   | 2690/4096 [02:01<01:08, 20.39it/s, est. speed input: 22681.73 toks/s, output: 22.15 toks/s]
Processed prompts:  66%|██████▋   | 2722/4096 [02:03<01:07, 20.40it/s, est. speed input: 22658.89 toks/s, output: 22.13 toks/s]
Processed prompts:  67%|██████▋   | 2754/4096 [02:04<01:05, 20.39it/s, est. speed input: 22636.03 toks/s, output: 22.11 toks/s]
Processed prompts:  68%|██████▊   | 2786/4096 [02:06<01:04, 20.40it/s, est. speed input: 22614.64 toks/s, output: 22.08 toks/s]
Processed prompts:  69%|██████▉   | 2818/4096 [02:07<01:02, 20.38it/s, est. speed input: 22592.85 toks/s, output: 22.06 toks/s]
Processed prompts:  70%|██████▉   | 2850/4096 [02:09<01:01, 20.39it/s, est. speed input: 22572.03 toks/s, output: 22.04 toks/s]
Processed prompts:  70%|███████   | 2882/4096 [02:10<00:59, 20.53it/s, est. speed input: 22558.21 toks/s, output: 22.03 toks/s]
Processed prompts:  71%|███████   | 2914/4096 [02:12<00:57, 20.50it/s, est. speed input: 22538.62 toks/s, output: 22.01 toks/s]
Processed prompts:  72%|███████▏  | 2946/4096 [02:13<00:56, 20.45it/s, est. speed input: 22518.56 toks/s, output: 21.99 toks/s]
Processed prompts:  73%|███████▎  | 2978/4096 [02:15<00:54, 20.43it/s, est. speed input: 22499.50 toks/s, output: 21.97 toks/s]
Processed prompts:  73%|███████▎  | 3010/4096 [02:17<00:53, 20.41it/s, est. speed input: 22480.76 toks/s, output: 21.95 toks/s]
Processed prompts:  74%|███████▍  | 3042/4096 [02:18<00:51, 20.41it/s, est. speed input: 22462.75 toks/s, output: 21.94 toks/s]
Processed prompts:  75%|███████▌  | 3074/4096 [02:20<00:50, 20.40it/s, est. speed input: 22444.83 toks/s, output: 21.92 toks/s]
Processed prompts:  76%|███████▌  | 3106/4096 [02:21<00:48, 20.40it/s, est. speed input: 22427.59 toks/s, output: 21.90 toks/s]
Processed prompts:  77%|███████▋  | 3138/4096 [02:23<00:46, 20.39it/s, est. speed input: 22410.37 toks/s, output: 21.89 toks/s]
Processed prompts:  77%|███████▋  | 3170/4096 [02:24<00:45, 20.39it/s, est. speed input: 22393.99 toks/s, output: 21.87 toks/s]
Processed prompts:  78%|███████▊  | 3202/4096 [02:26<00:43, 20.39it/s, est. speed input: 22377.63 toks/s, output: 21.85 toks/s]
Processed prompts:  79%|███████▉  | 3234/4096 [02:28<00:42, 20.39it/s, est. speed input: 22361.91 toks/s, output: 21.84 toks/s]
Processed prompts:  80%|███████▉  | 3266/4096 [02:29<00:40, 20.38it/s, est. speed input: 22346.02 toks/s, output: 21.82 toks/s]
Processed prompts:  81%|████████  | 3298/4096 [02:31<00:39, 20.38it/s, est. speed input: 22330.75 toks/s, output: 21.81 toks/s]
Processed prompts:  81%|████████▏ | 3330/4096 [02:32<00:37, 20.38it/s, est. speed input: 22315.60 toks/s, output: 21.79 toks/s]
Processed prompts:  82%|████████▏ | 3362/4096 [02:34<00:36, 20.39it/s, est. speed input: 22301.09 toks/s, output: 21.78 toks/s]
Processed prompts:  83%|████████▎ | 3394/4096 [02:35<00:34, 20.37it/s, est. speed input: 22286.33 toks/s, output: 21.76 toks/s]
Processed prompts:  84%|████████▎ | 3426/4096 [02:37<00:32, 20.38it/s, est. speed input: 22272.32 toks/s, output: 21.75 toks/s]
Processed prompts:  84%|████████▍ | 3458/4096 [02:39<00:31, 20.38it/s, est. speed input: 22258.42 toks/s, output: 21.74 toks/s]
Processed prompts:  85%|████████▌ | 3490/4096 [02:40<00:29, 20.39it/s, est. speed input: 22245.27 toks/s, output: 21.72 toks/s]
Processed prompts:  86%|████████▌ | 3522/4096 [02:42<00:28, 20.38it/s, est. speed input: 22231.87 toks/s, output: 21.71 toks/s]
Processed prompts:  87%|████████▋ | 3554/4096 [02:43<00:26, 20.38it/s, est. speed input: 22218.81 toks/s, output: 21.70 toks/s]
Processed prompts:  88%|████████▊ | 3586/4096 [02:45<00:25, 20.39it/s, est. speed input: 22206.19 toks/s, output: 21.69 toks/s]
Processed prompts:  88%|████████▊ | 3618/4096 [02:46<00:23, 20.38it/s, est. speed input: 22193.53 toks/s, output: 21.67 toks/s]
Processed prompts:  89%|████████▉ | 3650/4096 [02:48<00:21, 20.37it/s, est. speed input: 22180.91 toks/s, output: 21.66 toks/s]
Processed prompts:  90%|████████▉ | 3682/4096 [02:50<00:20, 20.53it/s, est. speed input: 22174.04 toks/s, output: 21.65 toks/s]
Processed prompts:  91%|█████████ | 3714/4096 [02:51<00:18, 20.49it/s, est. speed input: 22162.21 toks/s, output: 21.64 toks/s]
Processed prompts:  91%|█████████▏| 3746/4096 [02:53<00:17, 20.46it/s, est. speed input: 22150.55 toks/s, output: 21.63 toks/s]
Processed prompts:  92%|█████████▏| 3778/4096 [02:54<00:15, 20.42it/s, est. speed input: 22138.50 toks/s, output: 21.62 toks/s]
Processed prompts:  93%|█████████▎| 3810/4096 [02:56<00:14, 20.40it/s, est. speed input: 22127.01 toks/s, output: 21.61 toks/s]
Processed prompts:  94%|█████████▍| 3842/4096 [02:57<00:12, 20.40it/s, est. speed input: 22116.07 toks/s, output: 21.60 toks/s]
Processed prompts:  95%|█████████▍| 3874/4096 [02:59<00:10, 20.39it/s, est. speed input: 22105.09 toks/s, output: 21.59 toks/s]
Processed prompts:  95%|█████████▌| 3906/4096 [03:00<00:09, 20.54it/s, est. speed input: 22099.02 toks/s, output: 21.58 toks/s]
Processed prompts:  96%|█████████▌| 3938/4096 [03:02<00:07, 20.49it/s, est. speed input: 22088.40 toks/s, output: 21.57 toks/s]
Processed prompts:  97%|█████████▋| 3970/4096 [03:04<00:06, 20.46it/s, est. speed input: 22078.01 toks/s, output: 21.56 toks/s]
Processed prompts:  98%|█████████▊| 4002/4096 [03:05<00:04, 20.42it/s, est. speed input: 22067.49 toks/s, output: 21.55 toks/s]
Processed prompts:  98%|█████████▊| 4034/4096 [03:07<00:03, 20.41it/s, est. speed input: 22057.47 toks/s, output: 21.54 toks/s]
Processed prompts:  99%|█████████▉| 4066/4096 [03:08<00:01, 20.63it/s, est. speed input: 22054.28 toks/s, output: 21.54 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [03:08<00:00, 20.63it/s, est. speed input: 22216.89 toks/s, output: 21.70 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [03:08<00:00, 21.70it/s, est. speed input: 22216.89 toks/s, output: 21.70 toks/s]
[rank0]:[W126 15:28:42.435208305 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=65536 ==========
Time: 2026-01-26 15:28:44
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-FP8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=8192, max_num_seqs=64
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-FP8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 8192 --max-num-seqs 64 --max-model-len 1025 --max-num-batched-tokens 65536 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/H100_cc90_FP8E4M3_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-14B-FP8_M65536.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 15:29:34 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=1540123) [INFO] Loading compress extension: cusparselt_compress_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1540123) WARNING 01-26 15:29:57 [backends.py:609] Failed to read file <frozen os>
Throughput: 20.66 requests/s, 21175.99 total tokens/s, 20.66 output tokens/s
Total num prompt tokens:  8388608
Total num output tokens:  8192

STDERR:
[2026-01-26 15:29:34] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 15:29:34] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-FP8'
[2026-01-26 15:29:34] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-FP8
[2026-01-26 15:29:34] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:29:34] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:29:34] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:29:34] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:29:34] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:29:34] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-FP8'
[2026-01-26 15:29:34] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 15:29:34] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 15:29:34] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 15:29:34] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 15:29:34] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 15:29:41] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 15:29:41] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-FP8'
[2026-01-26 15:29:41] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-FP8
[2026-01-26 15:29:41] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:29:41] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:29:41] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:29:41] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:29:41] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-FP8
[2026-01-26 15:29:41] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-FP8'
[2026-01-26 15:29:41] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 15:29:41] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 15:29:41] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 15:29:41] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 15:29:41] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1540123) [2026-01-26 15:29:44] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1540123) [2026-01-26 15:29:44] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_H100_cc90_py312_cu129_x86_64.so
(EngineCore_DP0 pid=1540123) [2026-01-26 15:29:44] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1540123) [2026-01-26 15:29:44] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1540123) [2026-01-26 15:29:44] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-14B-FP8
(EngineCore_DP0 pid=1540123) [2026-01-26 15:29:44] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1540123) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1540123) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.27it/s]
(EngineCore_DP0 pid=1540123) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.18it/s]
(EngineCore_DP0 pid=1540123) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.62it/s]
(EngineCore_DP0 pid=1540123) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.44it/s]
(EngineCore_DP0 pid=1540123) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.41it/s]
(EngineCore_DP0 pid=1540123) 
(EngineCore_DP0 pid=1540123) [2026-01-26 15:29:48] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [7168, 7680] -> 1D uint8
(EngineCore_DP0 pid=1540123) [2026-01-26 15:29:48] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 34406400 bytes
(EngineCore_DP0 pid=1540123) [2026-01-26 15:29:48] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 7680] -> 1D uint8
(EngineCore_DP0 pid=1540123) [2026-01-26 15:29:48] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 24576000 bytes
(EngineCore_DP0 pid=1540123) [2026-01-26 15:29:48] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [27648, 7680] -> 1D uint8
(EngineCore_DP0 pid=1540123) [2026-01-26 15:29:48] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 132710400 bytes
(EngineCore_DP0 pid=1540123) [2026-01-26 15:29:48] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [5120, 20736] -> 1D uint8
(EngineCore_DP0 pid=1540123) [2026-01-26 15:29:48] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 66355200 bytes
(EngineCore_DP0 pid=1540123) [rank0]:W0126 15:30:05.883000 1540123 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=1540123) [rank0]:W0126 15:30:05.936000 1540123 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=1540123) [rank0]:W0126 15:30:06.600000 1540123 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=1540123) [rank0]:W0126 15:30:06.685000 1540123 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=1540123) 2026-01-26 15:30:11,584 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1540123) 2026-01-26 15:30:12,443 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=1540123) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/19 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   5%|▌         | 1/19 [00:01<00:23,  1.30s/it]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  11%|█         | 2/19 [00:01<00:11,  1.54it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  16%|█▌        | 3/19 [00:02<00:09,  1.61it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  21%|██        | 4/19 [00:02<00:07,  2.13it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  26%|██▋       | 5/19 [00:02<00:04,  2.96it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  37%|███▋      | 7/19 [00:02<00:02,  4.74it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  47%|████▋     | 9/19 [00:02<00:01,  6.06it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  58%|█████▊    | 11/19 [00:02<00:01,  7.38it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  63%|██████▎   | 12/19 [00:03<00:01,  5.82it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  68%|██████▊   | 13/19 [00:04<00:01,  3.29it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  79%|███████▉  | 15/19 [00:04<00:00,  4.58it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  84%|████████▍ | 16/19 [00:04<00:00,  4.80it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  89%|████████▉ | 17/19 [00:04<00:00,  5.45it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 19/19 [00:04<00:00,  6.80it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 19/19 [00:04<00:00,  4.07it/s]
(EngineCore_DP0 pid=1540123) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  18%|█▊        | 2/11 [00:00<00:00, 11.44it/s]
Capturing CUDA graphs (decode, FULL):  36%|███▋      | 4/11 [00:00<00:01,  6.53it/s]
Capturing CUDA graphs (decode, FULL):  45%|████▌     | 5/11 [00:01<00:01,  3.50it/s]
Capturing CUDA graphs (decode, FULL):  55%|█████▍    | 6/11 [00:01<00:01,  4.19it/s]
Capturing CUDA graphs (decode, FULL):  73%|███████▎  | 8/11 [00:01<00:00,  6.01it/s]
Capturing CUDA graphs (decode, FULL):  91%|█████████ | 10/11 [00:01<00:00,  6.51it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 11/11 [00:01<00:00,  6.04it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 11/11 [00:01<00:00,  5.67it/s]

Adding requests:   0%|          | 0/8192 [00:00<?, ?it/s]
Adding requests:   0%|          | 29/8192 [00:00<00:28, 288.28it/s]
Adding requests:   1%|          | 69/8192 [00:00<00:23, 352.82it/s]
Adding requests:   1%|▏         | 106/8192 [00:00<00:22, 356.21it/s]
Adding requests:   2%|▏         | 144/8192 [00:00<00:22, 361.45it/s]
Adding requests:   2%|▏         | 184/8192 [00:00<00:21, 375.08it/s]
Adding requests:   3%|▎         | 224/8192 [00:00<00:20, 380.51it/s]
Adding requests:   3%|▎         | 263/8192 [00:00<00:20, 378.93it/s]
Adding requests:   4%|▎         | 303/8192 [00:00<00:20, 383.46it/s]
Adding requests:   4%|▍         | 343/8192 [00:00<00:20, 387.42it/s]
Adding requests:   5%|▍         | 384/8192 [00:01<00:19, 391.89it/s]
Adding requests:   5%|▌         | 425/8192 [00:01<00:19, 396.72it/s]
Adding requests:   6%|▌         | 465/8192 [00:01<00:19, 392.55it/s]
Adding requests:   6%|▌         | 507/8192 [00:01<00:19, 399.75it/s]
Adding requests:   7%|▋         | 548/8192 [00:01<00:18, 402.38it/s]
Adding requests:   7%|▋         | 589/8192 [00:01<00:19, 397.66it/s]
Adding requests:   8%|▊         | 629/8192 [00:01<00:19, 392.04it/s]
Adding requests:   8%|▊         | 669/8192 [00:01<00:19, 380.40it/s]
Adding requests:   9%|▊         | 710/8192 [00:01<00:19, 386.44it/s]
Adding requests:   9%|▉         | 749/8192 [00:01<00:19, 372.16it/s]
Adding requests:  10%|▉         | 788/8192 [00:02<00:19, 377.11it/s]
Adding requests:  10%|█         | 827/8192 [00:02<00:19, 379.80it/s]
Adding requests:  11%|█         | 867/8192 [00:02<00:19, 382.80it/s]
Adding requests:  11%|█         | 908/8192 [00:02<00:18, 387.28it/s]
Adding requests:  12%|█▏        | 947/8192 [00:02<00:19, 378.44it/s]
Adding requests:  12%|█▏        | 986/8192 [00:02<00:18, 380.17it/s]
Adding requests:  13%|█▎        | 1025/8192 [00:02<00:19, 374.68it/s]
Adding requests:  13%|█▎        | 1063/8192 [00:02<00:19, 373.58it/s]
Adding requests:  13%|█▎        | 1101/8192 [00:02<00:18, 374.36it/s]
Adding requests:  14%|█▍        | 1141/8192 [00:02<00:18, 380.08it/s]
Adding requests:  14%|█▍        | 1180/8192 [00:03<00:18, 377.48it/s]
Adding requests:  15%|█▍        | 1220/8192 [00:03<00:18, 382.59it/s]
Adding requests:  15%|█▌        | 1259/8192 [00:03<00:18, 378.50it/s]
Adding requests:  16%|█▌        | 1297/8192 [00:03<00:18, 374.10it/s]
Adding requests:  16%|█▋        | 1335/8192 [00:03<00:18, 372.57it/s]
Adding requests:  17%|█▋        | 1375/8192 [00:03<00:18, 377.26it/s]
Adding requests:  17%|█▋        | 1413/8192 [00:03<00:18, 373.48it/s]
Adding requests:  18%|█▊        | 1451/8192 [00:03<00:18, 373.69it/s]
Adding requests:  18%|█▊        | 1490/8192 [00:03<00:17, 378.33it/s]
Adding requests:  19%|█▊        | 1528/8192 [00:04<00:17, 378.03it/s]
Adding requests:  19%|█▉        | 1566/8192 [00:04<00:17, 373.60it/s]
Adding requests:  20%|█▉        | 1604/8192 [00:04<00:17, 368.90it/s]
Adding requests:  20%|██        | 1641/8192 [00:04<00:18, 362.31it/s]
Adding requests:  20%|██        | 1678/8192 [00:04<00:18, 358.78it/s]
Adding requests:  21%|██        | 1717/8192 [00:04<00:17, 366.52it/s]
Adding requests:  21%|██▏       | 1755/8192 [00:04<00:17, 369.17it/s]
Adding requests:  22%|██▏       | 1793/8192 [00:04<00:17, 372.09it/s]
Adding requests:  22%|██▏       | 1832/8192 [00:04<00:16, 374.32it/s]
Adding requests:  23%|██▎       | 1870/8192 [00:04<00:16, 375.56it/s]
Adding requests:  23%|██▎       | 1908/8192 [00:05<00:17, 368.02it/s]
Adding requests:  24%|██▍       | 1950/8192 [00:05<00:16, 380.95it/s]
Adding requests:  24%|██▍       | 1989/8192 [00:05<00:16, 380.75it/s]
Adding requests:  25%|██▍       | 2028/8192 [00:05<00:16, 370.94it/s]
Adding requests:  25%|██▌       | 2066/8192 [00:05<00:16, 369.75it/s]
Adding requests:  26%|██▌       | 2104/8192 [00:05<00:16, 370.64it/s]
Adding requests:  26%|██▌       | 2142/8192 [00:05<00:16, 372.76it/s]
Adding requests:  27%|██▋       | 2180/8192 [00:05<00:16, 368.78it/s]
Adding requests:  27%|██▋       | 2217/8192 [00:05<00:16, 368.43it/s]
Adding requests:  28%|██▊       | 2256/8192 [00:05<00:15, 374.45it/s]
Adding requests:  28%|██▊       | 2296/8192 [00:06<00:15, 379.43it/s]
Adding requests:  29%|██▊       | 2335/8192 [00:06<00:15, 382.36it/s]
Adding requests:  29%|██▉       | 2375/8192 [00:06<00:15, 385.22it/s]
Adding requests:  29%|██▉       | 2416/8192 [00:06<00:14, 390.92it/s]
Adding requests:  30%|██▉       | 2456/8192 [00:06<00:14, 386.98it/s]
Adding requests:  30%|███       | 2495/8192 [00:06<00:14, 387.57it/s]
Adding requests:  31%|███       | 2536/8192 [00:06<00:14, 392.32it/s]
Adding requests:  31%|███▏      | 2579/8192 [00:06<00:13, 401.82it/s]
Adding requests:  32%|███▏      | 2620/8192 [00:06<00:14, 397.92it/s]
Adding requests:  32%|███▏      | 2660/8192 [00:07<00:14, 388.30it/s]
Adding requests:  33%|███▎      | 2699/8192 [00:07<00:14, 384.24it/s]
Adding requests:  33%|███▎      | 2738/8192 [00:07<00:14, 383.58it/s]
Adding requests:  34%|███▍      | 2779/8192 [00:07<00:13, 390.25it/s]
Adding requests:  34%|███▍      | 2820/8192 [00:07<00:13, 394.21it/s]
Adding requests:  35%|███▍      | 2860/8192 [00:07<00:13, 392.78it/s]
Adding requests:  35%|███▌      | 2900/8192 [00:07<00:13, 389.53it/s]
Adding requests:  36%|███▌      | 2941/8192 [00:07<00:13, 392.52it/s]
Adding requests:  36%|███▋      | 2981/8192 [00:07<00:13, 391.77it/s]
Adding requests:  37%|███▋      | 3022/8192 [00:07<00:13, 395.09it/s]
Adding requests:  37%|███▋      | 3064/8192 [00:08<00:12, 399.63it/s]
Adding requests:  38%|███▊      | 3104/8192 [00:08<00:12, 399.43it/s]
Adding requests:  38%|███▊      | 3145/8192 [00:08<00:12, 400.41it/s]
Adding requests:  39%|███▉      | 3186/8192 [00:08<00:12, 392.04it/s]
Adding requests:  39%|███▉      | 3226/8192 [00:08<00:12, 390.21it/s]
Adding requests:  40%|███▉      | 3266/8192 [00:08<00:13, 378.67it/s]
Adding requests:  40%|████      | 3304/8192 [00:08<00:13, 371.41it/s]
Adding requests:  41%|████      | 3344/8192 [00:08<00:12, 376.99it/s]
Adding requests:  41%|████▏     | 3383/8192 [00:08<00:12, 380.13it/s]
Adding requests:  42%|████▏     | 3423/8192 [00:08<00:12, 382.99it/s]
Adding requests:  42%|████▏     | 3463/8192 [00:09<00:12, 386.96it/s]
Adding requests:  43%|████▎     | 3502/8192 [00:09<00:12, 384.65it/s]
Adding requests:  43%|████▎     | 3545/8192 [00:09<00:11, 396.78it/s]
Adding requests:  44%|████▍     | 3585/8192 [00:09<00:11, 392.71it/s]
Adding requests:  44%|████▍     | 3625/8192 [00:09<00:11, 391.77it/s]
Adding requests:  45%|████▍     | 3665/8192 [00:09<00:11, 389.30it/s]
Adding requests:  45%|████▌     | 3704/8192 [00:09<00:11, 386.29it/s]
Adding requests:  46%|████▌     | 3743/8192 [00:09<00:11, 383.94it/s]
Adding requests:  46%|████▌     | 3782/8192 [00:09<00:11, 373.98it/s]
Adding requests:  47%|████▋     | 3820/8192 [00:10<00:11, 367.12it/s]
Adding requests:  47%|████▋     | 3859/8192 [00:10<00:11, 371.10it/s]
Adding requests:  48%|████▊     | 3897/8192 [00:10<00:11, 372.05it/s]
Adding requests:  48%|████▊     | 3935/8192 [00:10<00:11, 368.51it/s]
Adding requests:  48%|████▊     | 3973/8192 [00:10<00:11, 369.13it/s]
Adding requests:  49%|████▉     | 4011/8192 [00:10<00:11, 371.96it/s]
Adding requests:  49%|████▉     | 4049/8192 [00:10<00:11, 371.00it/s]
Adding requests:  50%|████▉     | 4087/8192 [00:10<00:11, 370.91it/s]
Adding requests:  50%|█████     | 4126/8192 [00:10<00:10, 375.77it/s]
Adding requests:  51%|█████     | 4164/8192 [00:10<00:10, 374.92it/s]
Adding requests:  51%|█████▏    | 4202/8192 [00:11<00:10, 376.24it/s]
Adding requests:  52%|█████▏    | 4240/8192 [00:11<00:10, 377.16it/s]
Adding requests:  52%|█████▏    | 4278/8192 [00:11<00:10, 372.33it/s]
Adding requests:  53%|█████▎    | 4317/8192 [00:11<00:10, 375.97it/s]
Adding requests:  53%|█████▎    | 4356/8192 [00:11<00:10, 379.20it/s]
Adding requests:  54%|█████▎    | 4394/8192 [00:11<00:10, 377.29it/s]
Adding requests:  54%|█████▍    | 4433/8192 [00:11<00:09, 380.41it/s]
Adding requests:  55%|█████▍    | 4472/8192 [00:11<00:09, 381.05it/s]
Adding requests:  55%|█████▌    | 4511/8192 [00:11<00:09, 381.77it/s]
Adding requests:  56%|█████▌    | 4551/8192 [00:11<00:09, 384.45it/s]
Adding requests:  56%|█████▌    | 4590/8192 [00:12<00:09, 384.90it/s]
Adding requests:  57%|█████▋    | 4629/8192 [00:12<00:09, 372.37it/s]
Adding requests:  57%|█████▋    | 4667/8192 [00:12<00:09, 369.45it/s]
Adding requests:  57%|█████▋    | 4705/8192 [00:12<00:09, 366.79it/s]
Adding requests:  58%|█████▊    | 4747/8192 [00:12<00:09, 379.67it/s]
Adding requests:  58%|█████▊    | 4786/8192 [00:12<00:09, 375.93it/s]
Adding requests:  59%|█████▉    | 4824/8192 [00:12<00:08, 375.90it/s]
Adding requests:  59%|█████▉    | 4862/8192 [00:12<00:08, 372.11it/s]
Adding requests:  60%|█████▉    | 4901/8192 [00:12<00:08, 375.98it/s]
Adding requests:  60%|██████    | 4941/8192 [00:13<00:08, 382.70it/s]
Adding requests:  61%|██████    | 4980/8192 [00:13<00:08, 382.80it/s]
Adding requests:  61%|██████▏   | 5020/8192 [00:13<00:08, 386.34it/s]
Adding requests:  62%|██████▏   | 5059/8192 [00:13<00:08, 386.13it/s]
Adding requests:  62%|██████▏   | 5098/8192 [00:13<00:07, 387.20it/s]
Adding requests:  63%|██████▎   | 5137/8192 [00:13<00:07, 386.67it/s]
Adding requests:  63%|██████▎   | 5176/8192 [00:13<00:07, 385.30it/s]
Adding requests:  64%|██████▎   | 5215/8192 [00:13<00:07, 381.18it/s]
Adding requests:  64%|██████▍   | 5254/8192 [00:13<00:07, 380.37it/s]
Adding requests:  65%|██████▍   | 5293/8192 [00:13<00:07, 380.39it/s]
Adding requests:  65%|██████▌   | 5332/8192 [00:14<00:07, 379.55it/s]
Adding requests:  66%|██████▌   | 5371/8192 [00:14<00:07, 382.15it/s]
Adding requests:  66%|██████▌   | 5410/8192 [00:14<00:07, 374.61it/s]
Adding requests:  67%|██████▋   | 5450/8192 [00:14<00:07, 379.29it/s]
Adding requests:  67%|██████▋   | 5490/8192 [00:14<00:07, 383.55it/s]
Adding requests:  67%|██████▋   | 5529/8192 [00:14<00:06, 383.27it/s]
Adding requests:  68%|██████▊   | 5568/8192 [00:14<00:06, 380.06it/s]
Adding requests:  68%|██████▊   | 5607/8192 [00:14<00:06, 379.22it/s]
Adding requests:  69%|██████▉   | 5646/8192 [00:14<00:06, 381.78it/s]
Adding requests:  69%|██████▉   | 5685/8192 [00:14<00:06, 380.26it/s]
Adding requests:  70%|██████▉   | 5724/8192 [00:15<00:06, 380.88it/s]
Adding requests:  70%|███████   | 5763/8192 [00:15<00:06, 382.98it/s]
Adding requests:  71%|███████   | 5803/8192 [00:15<00:06, 386.46it/s]
Adding requests:  71%|███████▏  | 5842/8192 [00:15<00:06, 383.49it/s]
Adding requests:  72%|███████▏  | 5881/8192 [00:15<00:06, 384.30it/s]
Adding requests:  72%|███████▏  | 5921/8192 [00:15<00:05, 386.94it/s]
Adding requests:  73%|███████▎  | 5962/8192 [00:15<00:05, 392.60it/s]
Adding requests:  73%|███████▎  | 6002/8192 [00:15<00:05, 380.24it/s]
Adding requests:  74%|███████▎  | 6041/8192 [00:15<00:05, 382.70it/s]
Adding requests:  74%|███████▍  | 6080/8192 [00:15<00:05, 381.98it/s]
Adding requests:  75%|███████▍  | 6119/8192 [00:16<00:05, 378.97it/s]
Adding requests:  75%|███████▌  | 6160/8192 [00:16<00:05, 386.78it/s]
Adding requests:  76%|███████▌  | 6199/8192 [00:16<00:05, 377.70it/s]
Adding requests:  76%|███████▌  | 6238/8192 [00:16<00:05, 380.13it/s]
Adding requests:  77%|███████▋  | 6277/8192 [00:16<00:05, 381.24it/s]
Adding requests:  77%|███████▋  | 6317/8192 [00:16<00:04, 384.87it/s]
Adding requests:  78%|███████▊  | 6358/8192 [00:16<00:04, 390.20it/s]
Adding requests:  78%|███████▊  | 6398/8192 [00:16<00:04, 386.36it/s]
Adding requests:  79%|███████▊  | 6437/8192 [00:16<00:04, 376.33it/s]
Adding requests:  79%|███████▉  | 6475/8192 [00:17<00:04, 374.70it/s]
Adding requests:  80%|███████▉  | 6515/8192 [00:17<00:04, 379.39it/s]
Adding requests:  80%|███████▉  | 6553/8192 [00:17<00:04, 378.74it/s]
Adding requests:  80%|████████  | 6591/8192 [00:17<00:04, 377.85it/s]
Adding requests:  81%|████████  | 6631/8192 [00:17<00:04, 383.37it/s]
Adding requests:  81%|████████▏ | 6670/8192 [00:17<00:03, 381.41it/s]
Adding requests:  82%|████████▏ | 6709/8192 [00:17<00:03, 381.42it/s]
Adding requests:  82%|████████▏ | 6749/8192 [00:17<00:03, 385.70it/s]
Adding requests:  83%|████████▎ | 6788/8192 [00:17<00:03, 386.75it/s]
Adding requests:  83%|████████▎ | 6827/8192 [00:17<00:03, 378.40it/s]
Adding requests:  84%|████████▍ | 6866/8192 [00:18<00:03, 381.57it/s]
Adding requests:  84%|████████▍ | 6905/8192 [00:18<00:03, 379.20it/s]
Adding requests:  85%|████████▍ | 6945/8192 [00:18<00:03, 384.73it/s]
Adding requests:  85%|████████▌ | 6984/8192 [00:18<00:03, 382.40it/s]
Adding requests:  86%|████████▌ | 7024/8192 [00:18<00:03, 384.92it/s]
Adding requests:  86%|████████▌ | 7063/8192 [00:18<00:02, 381.23it/s]
Adding requests:  87%|████████▋ | 7102/8192 [00:18<00:02, 376.34it/s]
Adding requests:  87%|████████▋ | 7142/8192 [00:18<00:02, 382.35it/s]
Adding requests:  88%|████████▊ | 7181/8192 [00:18<00:02, 383.16it/s]
Adding requests:  88%|████████▊ | 7222/8192 [00:18<00:02, 388.59it/s]
Adding requests:  89%|████████▊ | 7261/8192 [00:19<00:02, 388.31it/s]
Adding requests:  89%|████████▉ | 7300/8192 [00:19<00:02, 387.86it/s]
Adding requests:  90%|████████▉ | 7339/8192 [00:19<00:02, 375.76it/s]
Adding requests:  90%|█████████ | 7378/8192 [00:19<00:02, 379.71it/s]
Adding requests:  91%|█████████ | 7417/8192 [00:19<00:02, 377.92it/s]
Adding requests:  91%|█████████ | 7455/8192 [00:19<00:01, 377.29it/s]
Adding requests:  91%|█████████▏| 7493/8192 [00:19<00:01, 375.44it/s]
Adding requests:  92%|█████████▏| 7533/8192 [00:19<00:01, 378.95it/s]
Adding requests:  92%|█████████▏| 7572/8192 [00:19<00:01, 379.12it/s]
Adding requests:  93%|█████████▎| 7610/8192 [00:19<00:01, 378.29it/s]
Adding requests:  93%|█████████▎| 7650/8192 [00:20<00:01, 381.91it/s]
Adding requests:  94%|█████████▍| 7692/8192 [00:20<00:01, 392.00it/s]
Adding requests:  94%|█████████▍| 7732/8192 [00:20<00:01, 389.85it/s]
Adding requests:  95%|█████████▍| 7771/8192 [00:20<00:01, 384.44it/s]
Adding requests:  95%|█████████▌| 7810/8192 [00:20<00:00, 384.51it/s]
Adding requests:  96%|█████████▌| 7849/8192 [00:20<00:00, 377.18it/s]
Adding requests:  96%|█████████▋| 7888/8192 [00:20<00:00, 380.23it/s]
Adding requests:  97%|█████████▋| 7929/8192 [00:20<00:00, 388.09it/s]
Adding requests:  97%|█████████▋| 7970/8192 [00:20<00:00, 393.98it/s]
Adding requests:  98%|█████████▊| 8010/8192 [00:21<00:00, 392.17it/s]
Adding requests:  98%|█████████▊| 8050/8192 [00:21<00:00, 387.59it/s]
Adding requests:  99%|█████████▉| 8092/8192 [00:21<00:00, 394.49it/s]
Adding requests:  99%|█████████▉| 8132/8192 [00:21<00:00, 386.85it/s]
Adding requests: 100%|█████████▉| 8171/8192 [00:21<00:00, 381.36it/s]
Adding requests: 100%|██████████| 8192/8192 [00:21<00:00, 381.05it/s]

Processed prompts:   0%|          | 0/8192 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▌         | 432/8192 [00:02<00:40, 193.26it/s, est. speed input: 197899.09 toks/s, output: 193.26 toks/s]
Processed prompts:   6%|▌         | 496/8192 [00:05<01:37, 79.29it/s, est. speed input: 95983.51 toks/s, output: 93.73 toks/s]   
Processed prompts:   7%|▋         | 560/8192 [00:08<02:29, 50.98it/s, est. speed input: 68726.22 toks/s, output: 67.12 toks/s]
Processed prompts:   8%|▊         | 624/8192 [00:11<03:16, 38.60it/s, est. speed input: 55984.46 toks/s, output: 54.67 toks/s]
Processed prompts:   8%|▊         | 688/8192 [00:14<03:54, 32.02it/s, est. speed input: 48632.23 toks/s, output: 47.49 toks/s]
Processed prompts:   9%|▉         | 752/8192 [00:17<04:22, 28.33it/s, est. speed input: 43993.79 toks/s, output: 42.96 toks/s]
Processed prompts:  10%|▉         | 816/8192 [00:20<04:45, 25.85it/s, est. speed input: 40616.71 toks/s, output: 39.66 toks/s]
Processed prompts:  11%|█         | 880/8192 [00:23<05:01, 24.25it/s, est. speed input: 38119.37 toks/s, output: 37.23 toks/s]
Processed prompts:  12%|█▏        | 944/8192 [00:26<05:12, 23.17it/s, est. speed input: 36189.69 toks/s, output: 35.34 toks/s]
Processed prompts:  12%|█▏        | 1008/8192 [00:29<05:19, 22.46it/s, est. speed input: 34663.48 toks/s, output: 33.85 toks/s]
Processed prompts:  13%|█▎        | 1072/8192 [00:32<05:24, 21.96it/s, est. speed input: 33415.15 toks/s, output: 32.63 toks/s]
Processed prompts:  14%|█▍        | 1136/8192 [00:35<05:26, 21.59it/s, est. speed input: 32373.56 toks/s, output: 31.61 toks/s]
Processed prompts:  15%|█▍        | 1200/8192 [00:39<05:27, 21.36it/s, est. speed input: 31503.18 toks/s, output: 30.76 toks/s]
Processed prompts:  15%|█▌        | 1264/8192 [00:42<05:27, 21.17it/s, est. speed input: 30750.51 toks/s, output: 30.03 toks/s]
Processed prompts:  16%|█▌        | 1328/8192 [00:45<05:26, 21.05it/s, est. speed input: 30103.30 toks/s, output: 29.40 toks/s]
Processed prompts:  17%|█▋        | 1392/8192 [00:48<05:24, 20.96it/s, est. speed input: 29538.28 toks/s, output: 28.85 toks/s]
Processed prompts:  18%|█▊        | 1456/8192 [00:51<05:22, 20.89it/s, est. speed input: 29039.19 toks/s, output: 28.36 toks/s]
Processed prompts:  19%|█▊        | 1520/8192 [00:54<05:20, 20.84it/s, est. speed input: 28593.68 toks/s, output: 27.92 toks/s]
Processed prompts:  19%|█▉        | 1584/8192 [00:57<05:16, 20.88it/s, est. speed input: 28215.54 toks/s, output: 27.55 toks/s]
Processed prompts:  20%|██        | 1648/8192 [01:00<05:14, 20.83it/s, est. speed input: 27858.29 toks/s, output: 27.21 toks/s]
Processed prompts:  21%|██        | 1712/8192 [01:03<05:11, 20.79it/s, est. speed input: 27534.99 toks/s, output: 26.89 toks/s]
Processed prompts:  22%|██▏       | 1776/8192 [01:06<05:09, 20.74it/s, est. speed input: 27237.86 toks/s, output: 26.60 toks/s]
Processed prompts:  22%|██▏       | 1840/8192 [01:09<05:06, 20.72it/s, est. speed input: 26967.95 toks/s, output: 26.34 toks/s]
Processed prompts:  23%|██▎       | 1904/8192 [01:12<05:03, 20.71it/s, est. speed input: 26722.27 toks/s, output: 26.10 toks/s]
Processed prompts:  24%|██▍       | 1968/8192 [01:16<05:00, 20.69it/s, est. speed input: 26495.15 toks/s, output: 25.87 toks/s]
Processed prompts:  25%|██▍       | 2032/8192 [01:19<04:58, 20.67it/s, est. speed input: 26284.39 toks/s, output: 25.67 toks/s]
Processed prompts:  26%|██▌       | 2096/8192 [01:22<04:54, 20.67it/s, est. speed input: 26091.67 toks/s, output: 25.48 toks/s]
Processed prompts:  26%|██▋       | 2160/8192 [01:25<04:50, 20.75it/s, est. speed input: 25924.59 toks/s, output: 25.32 toks/s]
Processed prompts:  27%|██▋       | 2224/8192 [01:28<04:48, 20.70it/s, est. speed input: 25755.08 toks/s, output: 25.15 toks/s]
Processed prompts:  28%|██▊       | 2288/8192 [01:31<04:45, 20.67it/s, est. speed input: 25596.66 toks/s, output: 25.00 toks/s]
Processed prompts:  29%|██▊       | 2352/8192 [01:34<04:42, 20.66it/s, est. speed input: 25449.72 toks/s, output: 24.85 toks/s]
Processed prompts:  29%|██▉       | 2416/8192 [01:37<04:39, 20.65it/s, est. speed input: 25312.50 toks/s, output: 24.72 toks/s]
Processed prompts:  30%|███       | 2480/8192 [01:40<04:36, 20.64it/s, est. speed input: 25183.47 toks/s, output: 24.59 toks/s]
Processed prompts:  31%|███       | 2544/8192 [01:43<04:33, 20.63it/s, est. speed input: 25060.98 toks/s, output: 24.47 toks/s]
Processed prompts:  32%|███▏      | 2608/8192 [01:47<04:30, 20.62it/s, est. speed input: 24945.70 toks/s, output: 24.36 toks/s]
Processed prompts:  33%|███▎      | 2672/8192 [01:50<04:27, 20.61it/s, est. speed input: 24836.50 toks/s, output: 24.25 toks/s]
Processed prompts:  33%|███▎      | 2736/8192 [01:53<04:24, 20.60it/s, est. speed input: 24733.71 toks/s, output: 24.15 toks/s]
Processed prompts:  34%|███▍      | 2800/8192 [01:56<04:21, 20.60it/s, est. speed input: 24636.56 toks/s, output: 24.06 toks/s]
Processed prompts:  35%|███▍      | 2864/8192 [01:59<04:17, 20.68it/s, est. speed input: 24552.68 toks/s, output: 23.98 toks/s]
Processed prompts:  36%|███▌      | 2928/8192 [02:02<04:14, 20.66it/s, est. speed input: 24465.08 toks/s, output: 23.89 toks/s]
Processed prompts:  37%|███▋      | 2992/8192 [02:05<04:11, 20.64it/s, est. speed input: 24382.01 toks/s, output: 23.81 toks/s]
Processed prompts:  37%|███▋      | 3056/8192 [02:08<04:08, 20.63it/s, est. speed input: 24302.36 toks/s, output: 23.73 toks/s]
Processed prompts:  38%|███▊      | 3120/8192 [02:11<04:05, 20.62it/s, est. speed input: 24226.87 toks/s, output: 23.66 toks/s]
Processed prompts:  39%|███▉      | 3184/8192 [02:14<04:02, 20.62it/s, est. speed input: 24155.69 toks/s, output: 23.59 toks/s]
Processed prompts:  40%|███▉      | 3248/8192 [02:18<03:59, 20.61it/s, est. speed input: 24086.56 toks/s, output: 23.52 toks/s]
Processed prompts:  40%|████      | 3312/8192 [02:21<03:56, 20.61it/s, est. speed input: 24020.81 toks/s, output: 23.46 toks/s]
Processed prompts:  41%|████      | 3376/8192 [02:24<03:53, 20.61it/s, est. speed input: 23957.65 toks/s, output: 23.40 toks/s]
Processed prompts:  42%|████▏     | 3440/8192 [02:27<03:50, 20.60it/s, est. speed input: 23897.06 toks/s, output: 23.34 toks/s]
Processed prompts:  43%|████▎     | 3504/8192 [02:30<03:47, 20.60it/s, est. speed input: 23839.55 toks/s, output: 23.28 toks/s]
Processed prompts:  44%|████▎     | 3568/8192 [02:33<03:44, 20.61it/s, est. speed input: 23784.79 toks/s, output: 23.23 toks/s]
Processed prompts:  44%|████▍     | 3632/8192 [02:36<03:40, 20.68it/s, est. speed input: 23736.52 toks/s, output: 23.18 toks/s]
Processed prompts:  45%|████▌     | 3696/8192 [02:39<03:37, 20.65it/s, est. speed input: 23684.75 toks/s, output: 23.13 toks/s]
Processed prompts:  46%|████▌     | 3760/8192 [02:42<03:34, 20.63it/s, est. speed input: 23635.26 toks/s, output: 23.08 toks/s]
Processed prompts:  47%|████▋     | 3824/8192 [02:46<03:31, 20.62it/s, est. speed input: 23587.42 toks/s, output: 23.03 toks/s]
Processed prompts:  47%|████▋     | 3888/8192 [02:49<03:28, 20.69it/s, est. speed input: 23546.98 toks/s, output: 23.00 toks/s]
Processed prompts:  48%|████▊     | 3952/8192 [02:52<03:25, 20.65it/s, est. speed input: 23501.91 toks/s, output: 22.95 toks/s]
Processed prompts:  49%|████▉     | 4016/8192 [02:55<03:22, 20.63it/s, est. speed input: 23458.92 toks/s, output: 22.91 toks/s]
Processed prompts:  50%|████▉     | 4080/8192 [02:58<03:18, 20.70it/s, est. speed input: 23422.59 toks/s, output: 22.87 toks/s]
Processed prompts:  51%|█████     | 4144/8192 [03:01<03:15, 20.66it/s, est. speed input: 23382.06 toks/s, output: 22.83 toks/s]
Processed prompts:  51%|█████▏    | 4208/8192 [03:04<03:13, 20.63it/s, est. speed input: 23342.98 toks/s, output: 22.80 toks/s]
Processed prompts:  52%|█████▏    | 4272/8192 [03:07<03:10, 20.60it/s, est. speed input: 23304.62 toks/s, output: 22.76 toks/s]
Processed prompts:  53%|█████▎    | 4336/8192 [03:10<03:07, 20.59it/s, est. speed input: 23268.03 toks/s, output: 22.72 toks/s]
Processed prompts:  54%|█████▎    | 4400/8192 [03:13<03:04, 20.58it/s, est. speed input: 23232.49 toks/s, output: 22.69 toks/s]
Processed prompts:  54%|█████▍    | 4464/8192 [03:17<03:01, 20.58it/s, est. speed input: 23198.08 toks/s, output: 22.65 toks/s]
Processed prompts:  55%|█████▌    | 4528/8192 [03:20<02:57, 20.59it/s, est. speed input: 23165.80 toks/s, output: 22.62 toks/s]
Processed prompts:  56%|█████▌    | 4592/8192 [03:23<02:54, 20.58it/s, est. speed input: 23133.61 toks/s, output: 22.59 toks/s]
Processed prompts:  57%|█████▋    | 4656/8192 [03:26<02:51, 20.58it/s, est. speed input: 23102.37 toks/s, output: 22.56 toks/s]
Processed prompts:  58%|█████▊    | 4720/8192 [03:29<02:48, 20.58it/s, est. speed input: 23072.55 toks/s, output: 22.53 toks/s]
Processed prompts:  58%|█████▊    | 4784/8192 [03:32<02:45, 20.59it/s, est. speed input: 23043.56 toks/s, output: 22.50 toks/s]
Processed prompts:  59%|█████▉    | 4848/8192 [03:35<02:42, 20.58it/s, est. speed input: 23015.08 toks/s, output: 22.48 toks/s]
Processed prompts:  60%|█████▉    | 4912/8192 [03:38<02:39, 20.59it/s, est. speed input: 22987.92 toks/s, output: 22.45 toks/s]
Processed prompts:  61%|██████    | 4976/8192 [03:41<02:35, 20.68it/s, est. speed input: 22965.83 toks/s, output: 22.43 toks/s]
Processed prompts:  62%|██████▏   | 5040/8192 [03:44<02:32, 20.65it/s, est. speed input: 22939.53 toks/s, output: 22.40 toks/s]
Processed prompts:  62%|██████▏   | 5104/8192 [03:48<02:29, 20.63it/s, est. speed input: 22914.12 toks/s, output: 22.38 toks/s]
Processed prompts:  63%|██████▎   | 5168/8192 [03:51<02:26, 20.61it/s, est. speed input: 22889.01 toks/s, output: 22.35 toks/s]
Processed prompts:  64%|██████▍   | 5232/8192 [03:54<02:23, 20.59it/s, est. speed input: 22864.76 toks/s, output: 22.33 toks/s]
Processed prompts:  65%|██████▍   | 5296/8192 [03:57<02:20, 20.60it/s, est. speed input: 22841.64 toks/s, output: 22.31 toks/s]
Processed prompts:  65%|██████▌   | 5360/8192 [04:00<02:17, 20.59it/s, est. speed input: 22818.83 toks/s, output: 22.28 toks/s]
Processed prompts:  66%|██████▌   | 5424/8192 [04:03<02:14, 20.58it/s, est. speed input: 22796.07 toks/s, output: 22.26 toks/s]
Processed prompts:  67%|██████▋   | 5488/8192 [04:06<02:11, 20.58it/s, est. speed input: 22774.43 toks/s, output: 22.24 toks/s]
Processed prompts:  68%|██████▊   | 5552/8192 [04:09<02:08, 20.56it/s, est. speed input: 22752.42 toks/s, output: 22.22 toks/s]
Processed prompts:  69%|██████▊   | 5616/8192 [04:12<02:05, 20.57it/s, est. speed input: 22732.13 toks/s, output: 22.20 toks/s]
Processed prompts:  69%|██████▉   | 5680/8192 [04:16<02:02, 20.57it/s, est. speed input: 22711.73 toks/s, output: 22.18 toks/s]
Processed prompts:  70%|███████   | 5744/8192 [04:19<01:58, 20.58it/s, est. speed input: 22692.30 toks/s, output: 22.16 toks/s]
Processed prompts:  71%|███████   | 5808/8192 [04:22<01:55, 20.58it/s, est. speed input: 22673.01 toks/s, output: 22.14 toks/s]
Processed prompts:  72%|███████▏  | 5872/8192 [04:25<01:52, 20.66it/s, est. speed input: 22657.81 toks/s, output: 22.13 toks/s]
Processed prompts:  72%|███████▏  | 5936/8192 [04:28<01:48, 20.72it/s, est. speed input: 22642.83 toks/s, output: 22.11 toks/s]
Processed prompts:  73%|███████▎  | 6000/8192 [04:31<01:46, 20.68it/s, est. speed input: 22624.90 toks/s, output: 22.09 toks/s]
Processed prompts:  74%|███████▍  | 6064/8192 [04:34<01:43, 20.63it/s, est. speed input: 22606.75 toks/s, output: 22.08 toks/s]
Processed prompts:  75%|███████▍  | 6128/8192 [04:37<01:40, 20.62it/s, est. speed input: 22589.81 toks/s, output: 22.06 toks/s]
Processed prompts:  76%|███████▌  | 6192/8192 [04:40<01:37, 20.61it/s, est. speed input: 22572.91 toks/s, output: 22.04 toks/s]
Processed prompts:  76%|███████▋  | 6256/8192 [04:44<01:33, 20.60it/s, est. speed input: 22556.50 toks/s, output: 22.03 toks/s]
Processed prompts:  77%|███████▋  | 6320/8192 [04:47<01:30, 20.60it/s, est. speed input: 22540.56 toks/s, output: 22.01 toks/s]
Processed prompts:  78%|███████▊  | 6384/8192 [04:50<01:27, 20.59it/s, est. speed input: 22524.98 toks/s, output: 22.00 toks/s]
Processed prompts:  79%|███████▊  | 6448/8192 [04:53<01:24, 20.59it/s, est. speed input: 22509.54 toks/s, output: 21.98 toks/s]
Processed prompts:  79%|███████▉  | 6512/8192 [04:56<01:21, 20.58it/s, est. speed input: 22494.05 toks/s, output: 21.97 toks/s]
Processed prompts:  80%|████████  | 6576/8192 [04:59<01:18, 20.58it/s, est. speed input: 22479.47 toks/s, output: 21.95 toks/s]
Processed prompts:  81%|████████  | 6640/8192 [05:02<01:15, 20.58it/s, est. speed input: 22465.10 toks/s, output: 21.94 toks/s]
Processed prompts:  82%|████████▏ | 6704/8192 [05:05<01:12, 20.58it/s, est. speed input: 22450.85 toks/s, output: 21.92 toks/s]
Processed prompts:  83%|████████▎ | 6768/8192 [05:08<01:09, 20.58it/s, est. speed input: 22436.93 toks/s, output: 21.91 toks/s]
Processed prompts:  83%|████████▎ | 6832/8192 [05:11<01:06, 20.58it/s, est. speed input: 22423.47 toks/s, output: 21.90 toks/s]
Processed prompts:  84%|████████▍ | 6896/8192 [05:15<01:02, 20.57it/s, est. speed input: 22409.80 toks/s, output: 21.88 toks/s]
Processed prompts:  85%|████████▍ | 6960/8192 [05:18<00:59, 20.58it/s, est. speed input: 22396.81 toks/s, output: 21.87 toks/s]
Processed prompts:  86%|████████▌ | 7024/8192 [05:21<00:56, 20.58it/s, est. speed input: 22384.23 toks/s, output: 21.86 toks/s]
Processed prompts:  87%|████████▋ | 7088/8192 [05:24<00:53, 20.58it/s, est. speed input: 22371.57 toks/s, output: 21.85 toks/s]
Processed prompts:  87%|████████▋ | 7152/8192 [05:27<00:50, 20.58it/s, est. speed input: 22359.28 toks/s, output: 21.84 toks/s]
Processed prompts:  88%|████████▊ | 7216/8192 [05:30<00:47, 20.58it/s, est. speed input: 22347.12 toks/s, output: 21.82 toks/s]
Processed prompts:  89%|████████▉ | 7280/8192 [05:33<00:44, 20.59it/s, est. speed input: 22335.53 toks/s, output: 21.81 toks/s]
Processed prompts:  90%|████████▉ | 7344/8192 [05:36<00:41, 20.58it/s, est. speed input: 22323.80 toks/s, output: 21.80 toks/s]
Processed prompts:  90%|█████████ | 7408/8192 [05:39<00:38, 20.58it/s, est. speed input: 22312.40 toks/s, output: 21.79 toks/s]
Processed prompts:  91%|█████████ | 7472/8192 [05:43<00:34, 20.57it/s, est. speed input: 22300.87 toks/s, output: 21.78 toks/s]
Processed prompts:  92%|█████████▏| 7536/8192 [05:46<00:31, 20.57it/s, est. speed input: 22289.60 toks/s, output: 21.77 toks/s]
Processed prompts:  93%|█████████▎| 7600/8192 [05:49<00:28, 20.57it/s, est. speed input: 22278.69 toks/s, output: 21.76 toks/s]
Processed prompts:  94%|█████████▎| 7664/8192 [05:52<00:25, 20.58it/s, est. speed input: 22268.17 toks/s, output: 21.75 toks/s]
Processed prompts:  94%|█████████▍| 7728/8192 [05:55<00:22, 20.57it/s, est. speed input: 22257.59 toks/s, output: 21.74 toks/s]
Processed prompts:  95%|█████████▌| 7792/8192 [05:58<00:19, 20.57it/s, est. speed input: 22247.29 toks/s, output: 21.73 toks/s]
Processed prompts:  96%|█████████▌| 7856/8192 [06:01<00:16, 20.58it/s, est. speed input: 22237.48 toks/s, output: 21.72 toks/s]
Processed prompts:  97%|█████████▋| 7920/8192 [06:04<00:13, 20.59it/s, est. speed input: 22227.66 toks/s, output: 21.71 toks/s]
Processed prompts:  97%|█████████▋| 7984/8192 [06:07<00:10, 20.59it/s, est. speed input: 22218.06 toks/s, output: 21.70 toks/s]
Processed prompts:  98%|█████████▊| 8048/8192 [06:11<00:06, 20.59it/s, est. speed input: 22208.53 toks/s, output: 21.69 toks/s]
Processed prompts:  99%|█████████▉| 8112/8192 [06:14<00:03, 20.60it/s, est. speed input: 22199.40 toks/s, output: 21.68 toks/s]
Processed prompts: 100%|█████████▉| 8176/8192 [06:15<00:00, 26.38it/s, est. speed input: 22324.72 toks/s, output: 21.80 toks/s]
Processed prompts: 100%|██████████| 8192/8192 [06:15<00:00, 26.38it/s, est. speed input: 22368.38 toks/s, output: 21.84 toks/s]
Processed prompts: 100%|██████████| 8192/8192 [06:15<00:00, 21.84it/s, est. speed input: 22368.38 toks/s, output: 21.84 toks/s]
[rank0]:[W126 15:36:57.826568099 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

