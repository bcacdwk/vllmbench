
========== M=16 ==========
Time: 2026-01-25 17:07:06
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_6
Params: prompt_len=16, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_6 --dataset-name random --input-len 16 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 17 --max-num-batched-tokens 17 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Llama3.2-1B-INT8_M16.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 17:07:12 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 17:07:13 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=166291) WARNING 01-25 17:07:21 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=166291) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=166291) WARNING 01-25 17:07:30 [backends.py:609] Failed to read file <frozen os>
Throughput: 14.69 requests/s, 249.75 total tokens/s, 14.69 output tokens/s
Total num prompt tokens:  2048
Total num output tokens:  128

STDERR:
[2026-01-25 17:07:12] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:07:12] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 17:07:12] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 17:07:12] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:07:12] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:07:12] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:07:12] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:07:12] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:07:12] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 17:07:12] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:07:12] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:07:12] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:07:12] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:07:12] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 17:07:20] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:07:20] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 17:07:20] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 17:07:20] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:07:20] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:07:20] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:07:20] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:07:20] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:07:20] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 17:07:20] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:07:20] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:07:20] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:07:20] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:07:20] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=166291) [2026-01-25 17:07:22] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=166291) [2026-01-25 17:07:22] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=166291) [2026-01-25 17:07:22] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=166291) [2026-01-25 17:07:22] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=166291) [2026-01-25 17:07:22] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-1B-INT8
(EngineCore_DP0 pid=166291) [2026-01-25 17:07:22] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=166291) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=166291) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:01<00:00,  1.42s/it]
(EngineCore_DP0 pid=166291) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:01<00:00,  1.42s/it]
(EngineCore_DP0 pid=166291) 
(EngineCore_DP0 pid=166291) [2026-01-25 17:07:23] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 2752] -> 1D uint8
(EngineCore_DP0 pid=166291) [2026-01-25 17:07:23] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 6389760 bytes
(EngineCore_DP0 pid=166291) [2026-01-25 17:07:23] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 2752] -> 1D uint8
(EngineCore_DP0 pid=166291) [2026-01-25 17:07:23] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4259840 bytes
(EngineCore_DP0 pid=166291) [2026-01-25 17:07:23] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 2752] -> 1D uint8
(EngineCore_DP0 pid=166291) [2026-01-25 17:07:23] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 34078720 bytes
(EngineCore_DP0 pid=166291) [2026-01-25 17:07:23] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 10944] -> 1D uint8
(EngineCore_DP0 pid=166291) [2026-01-25 17:07:23] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 16842752 bytes
(EngineCore_DP0 pid=166291) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  9.70it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  3.66it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  4.04it/s]
(EngineCore_DP0 pid=166291) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  8.84it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  8.82it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 2734.13it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:48,  2.63it/s, est. speed input: 42.11 toks/s, output: 2.63 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:18,  6.94it/s, est. speed input: 95.45 toks/s, output: 5.97 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:12,  9.85it/s, est. speed input: 127.85 toks/s, output: 7.99 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:10, 11.64it/s, est. speed input: 148.37 toks/s, output: 9.27 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:00<00:09, 12.81it/s, est. speed input: 162.71 toks/s, output: 10.17 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:01<00:01, 76.21it/s, est. speed input: 585.42 toks/s, output: 36.59 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:01<00:02, 35.76it/s, est. speed input: 462.21 toks/s, output: 28.89 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:02<00:02, 26.26it/s, est. speed input: 407.68 toks/s, output: 25.48 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:02<00:03, 22.60it/s, est. speed input: 382.57 toks/s, output: 23.91 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:02<00:03, 20.36it/s, est. speed input: 366.34 toks/s, output: 22.90 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:02<00:03, 19.08it/s, est. speed input: 356.77 toks/s, output: 22.30 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:03<00:03, 17.98it/s, est. speed input: 348.40 toks/s, output: 21.78 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:03<00:03, 17.12it/s, est. speed input: 341.30 toks/s, output: 21.33 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:03<00:03, 16.61it/s, est. speed input: 336.92 toks/s, output: 21.06 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:03<00:03, 16.10it/s, est. speed input: 332.74 toks/s, output: 20.80 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:03<00:03, 15.65it/s, est. speed input: 328.79 toks/s, output: 20.55 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:03<00:03, 15.30it/s, est. speed input: 325.18 toks/s, output: 20.32 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:04<00:03, 15.19it/s, est. speed input: 322.25 toks/s, output: 20.14 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:04<00:02, 15.31it/s, est. speed input: 320.03 toks/s, output: 20.00 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:04<00:02, 15.34it/s, est. speed input: 317.82 toks/s, output: 19.86 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:04<00:02, 15.35it/s, est. speed input: 315.71 toks/s, output: 19.73 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:04<00:02, 15.50it/s, est. speed input: 313.99 toks/s, output: 19.62 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:04<00:02, 15.48it/s, est. speed input: 312.13 toks/s, output: 19.51 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:04<00:02, 15.44it/s, est. speed input: 310.32 toks/s, output: 19.40 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:04<00:02, 15.54it/s, est. speed input: 308.84 toks/s, output: 19.30 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:05<00:02, 15.42it/s, est. speed input: 307.09 toks/s, output: 19.19 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:05<00:01, 15.48it/s, est. speed input: 305.68 toks/s, output: 19.10 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:05<00:01, 15.65it/s, est. speed input: 304.53 toks/s, output: 19.03 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:05<00:01, 15.71it/s, est. speed input: 303.36 toks/s, output: 18.96 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:05<00:01, 15.66it/s, est. speed input: 302.10 toks/s, output: 18.88 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:05<00:01, 15.72it/s, est. speed input: 301.02 toks/s, output: 18.81 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:05<00:01, 15.52it/s, est. speed input: 299.66 toks/s, output: 18.73 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:05<00:01, 15.48it/s, est. speed input: 298.50 toks/s, output: 18.66 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:06<00:00, 15.57it/s, est. speed input: 297.54 toks/s, output: 18.60 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:06<00:00, 15.62it/s, est. speed input: 296.60 toks/s, output: 18.54 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:06<00:00, 15.57it/s, est. speed input: 295.60 toks/s, output: 18.47 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:06<00:00, 15.59it/s, est. speed input: 294.70 toks/s, output: 18.42 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:06<00:00, 15.59it/s, est. speed input: 293.82 toks/s, output: 18.36 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:06<00:00, 15.48it/s, est. speed input: 292.83 toks/s, output: 18.30 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:06<00:00, 15.45it/s, est. speed input: 291.95 toks/s, output: 18.25 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:06<00:00, 15.49it/s, est. speed input: 291.16 toks/s, output: 18.20 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 15.49it/s, est. speed input: 290.79 toks/s, output: 18.17 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 18.17it/s, est. speed input: 290.79 toks/s, output: 18.17 toks/s]
[rank0]:[W125 17:07:50.378205293 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=128 ==========
Time: 2026-01-25 17:07:53
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_6
Params: prompt_len=128, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_6 --dataset-name random --input-len 128 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 129 --max-num-batched-tokens 129 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Llama3.2-1B-INT8_M128.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 17:08:01 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 17:08:02 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=167240) WARNING 01-25 17:08:10 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=167240) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=167240) WARNING 01-25 17:08:16 [backends.py:609] Failed to read file <frozen os>
Throughput: 15.43 requests/s, 1990.27 total tokens/s, 15.43 output tokens/s
Total num prompt tokens:  16384
Total num output tokens:  128

STDERR:
[2026-01-25 17:08:01] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:08:01] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 17:08:01] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 17:08:01] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:08:01] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:08:01] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:08:01] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:08:01] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:08:01] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 17:08:01] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:08:01] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:08:01] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:08:01] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:08:01] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 17:08:09] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:08:09] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 17:08:09] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 17:08:09] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:08:09] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:08:09] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:08:09] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:08:09] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:08:09] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 17:08:09] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:08:09] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:08:09] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:08:09] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:08:09] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=167240) [2026-01-25 17:08:11] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=167240) [2026-01-25 17:08:11] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=167240) [2026-01-25 17:08:11] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=167240) [2026-01-25 17:08:11] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=167240) [2026-01-25 17:08:11] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-1B-INT8
(EngineCore_DP0 pid=167240) [2026-01-25 17:08:11] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=167240) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=167240) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.47it/s]
(EngineCore_DP0 pid=167240) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.47it/s]
(EngineCore_DP0 pid=167240) 
(EngineCore_DP0 pid=167240) [2026-01-25 17:08:11] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 2752] -> 1D uint8
(EngineCore_DP0 pid=167240) [2026-01-25 17:08:11] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 6389760 bytes
(EngineCore_DP0 pid=167240) [2026-01-25 17:08:11] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 2752] -> 1D uint8
(EngineCore_DP0 pid=167240) [2026-01-25 17:08:11] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4259840 bytes
(EngineCore_DP0 pid=167240) [2026-01-25 17:08:11] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 2752] -> 1D uint8
(EngineCore_DP0 pid=167240) [2026-01-25 17:08:11] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 34078720 bytes
(EngineCore_DP0 pid=167240) [2026-01-25 17:08:11] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 10944] -> 1D uint8
(EngineCore_DP0 pid=167240) [2026-01-25 17:08:11] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 16842752 bytes
(EngineCore_DP0 pid=167240) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  8.69it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  8.92it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  8.87it/s]
(EngineCore_DP0 pid=167240) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  8.24it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  8.22it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 1406.20it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:43,  2.89it/s, est. speed input: 369.55 toks/s, output: 2.89 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:16,  7.57it/s, est. speed input: 833.82 toks/s, output: 6.51 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:11, 10.71it/s, est. speed input: 1114.59 toks/s, output: 8.71 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:09, 12.80it/s, est. speed input: 1300.50 toks/s, output: 10.16 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:00<00:08, 14.26it/s, est. speed input: 1434.96 toks/s, output: 11.21 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:00<00:07, 15.39it/s, est. speed input: 1541.25 toks/s, output: 12.04 toks/s]
Processed prompts:  10%|█         | 13/128 [00:01<00:07, 15.99it/s, est. speed input: 1617.44 toks/s, output: 12.64 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:01<00:06, 16.38it/s, est. speed input: 1677.22 toks/s, output: 13.10 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:01<00:06, 16.43it/s, est. speed input: 1719.23 toks/s, output: 13.43 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:01<00:06, 16.35it/s, est. speed input: 1750.62 toks/s, output: 13.68 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:01<00:06, 16.35it/s, est. speed input: 1778.36 toks/s, output: 13.89 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:01<00:06, 16.32it/s, est. speed input: 1801.12 toks/s, output: 14.07 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:01<00:06, 16.30it/s, est. speed input: 1820.73 toks/s, output: 14.22 toks/s]
Processed prompts:  21%|██        | 27/128 [00:01<00:06, 16.27it/s, est. speed input: 1837.19 toks/s, output: 14.35 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:02<00:06, 16.29it/s, est. speed input: 1852.83 toks/s, output: 14.48 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:02<00:05, 16.24it/s, est. speed input: 1865.08 toks/s, output: 14.57 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:02<00:05, 16.15it/s, est. speed input: 1874.87 toks/s, output: 14.65 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:02<00:05, 16.07it/s, est. speed input: 1883.18 toks/s, output: 14.71 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:02<00:05, 16.23it/s, est. speed input: 1895.02 toks/s, output: 14.80 toks/s]
Processed prompts:  30%|███       | 39/128 [00:02<00:05, 16.36it/s, est. speed input: 1905.94 toks/s, output: 14.89 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:02<00:05, 16.46it/s, est. speed input: 1916.02 toks/s, output: 14.97 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:02<00:05, 16.47it/s, est. speed input: 1924.29 toks/s, output: 15.03 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:02<00:05, 16.56it/s, est. speed input: 1933.23 toks/s, output: 15.10 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:03<00:04, 16.45it/s, est. speed input: 1938.80 toks/s, output: 15.15 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:03<00:04, 16.17it/s, est. speed input: 1940.88 toks/s, output: 15.16 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:03<00:04, 15.74it/s, est. speed input: 1939.17 toks/s, output: 15.15 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:03<00:04, 15.83it/s, est. speed input: 1943.28 toks/s, output: 15.18 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:03<00:04, 15.84it/s, est. speed input: 1946.34 toks/s, output: 15.21 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:03<00:04, 15.60it/s, est. speed input: 1945.66 toks/s, output: 15.20 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:03<00:04, 15.68it/s, est. speed input: 1948.42 toks/s, output: 15.22 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:03<00:04, 15.84it/s, est. speed input: 1952.39 toks/s, output: 15.25 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:04<00:04, 15.88it/s, est. speed input: 1955.23 toks/s, output: 15.28 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:04<00:04, 15.52it/s, est. speed input: 1953.07 toks/s, output: 15.26 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:04<00:03, 15.77it/s, est. speed input: 1957.00 toks/s, output: 15.29 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:04<00:03, 15.85it/s, est. speed input: 1959.68 toks/s, output: 15.31 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:04<00:03, 15.92it/s, est. speed input: 1962.33 toks/s, output: 15.33 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:04<00:03, 15.94it/s, est. speed input: 1964.51 toks/s, output: 15.35 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:04<00:03, 15.98it/s, est. speed input: 1966.93 toks/s, output: 15.37 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:05<00:03, 16.07it/s, est. speed input: 1969.76 toks/s, output: 15.39 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:05<00:03, 16.11it/s, est. speed input: 1972.28 toks/s, output: 15.41 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:05<00:02, 16.10it/s, est. speed input: 1974.30 toks/s, output: 15.42 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:05<00:02, 16.05it/s, est. speed input: 1975.88 toks/s, output: 15.44 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:05<00:02, 16.17it/s, est. speed input: 1978.71 toks/s, output: 15.46 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:05<00:02, 16.15it/s, est. speed input: 1980.52 toks/s, output: 15.47 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:05<00:02, 16.13it/s, est. speed input: 1982.22 toks/s, output: 15.49 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:05<00:02, 16.08it/s, est. speed input: 1983.51 toks/s, output: 15.50 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:05<00:02, 16.08it/s, est. speed input: 1985.12 toks/s, output: 15.51 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:06<00:02, 16.15it/s, est. speed input: 1987.18 toks/s, output: 15.52 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:06<00:01, 16.20it/s, est. speed input: 1989.17 toks/s, output: 15.54 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:06<00:01, 16.08it/s, est. speed input: 1989.84 toks/s, output: 15.55 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:06<00:01, 16.46it/s, est. speed input: 1994.06 toks/s, output: 15.58 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:06<00:01, 16.73it/s, est. speed input: 1998.11 toks/s, output: 15.61 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:06<00:01, 16.93it/s, est. speed input: 2002.10 toks/s, output: 15.64 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:06<00:01, 16.40it/s, est. speed input: 2001.22 toks/s, output: 15.63 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:06<00:01, 16.16it/s, est. speed input: 2001.20 toks/s, output: 15.63 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:07<00:01, 15.93it/s, est. speed input: 2000.71 toks/s, output: 15.63 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:07<00:00, 15.63it/s, est. speed input: 1999.16 toks/s, output: 15.62 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:07<00:00, 15.68it/s, est. speed input: 1999.54 toks/s, output: 15.62 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:07<00:00, 15.26it/s, est. speed input: 1996.55 toks/s, output: 15.60 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:07<00:00, 15.29it/s, est. speed input: 1996.00 toks/s, output: 15.59 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:07<00:00, 15.48it/s, est. speed input: 1996.72 toks/s, output: 15.60 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:07<00:00, 15.50it/s, est. speed input: 1996.60 toks/s, output: 15.60 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:08<00:00, 15.56it/s, est. speed input: 1996.83 toks/s, output: 15.60 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:08<00:00, 15.60it/s, est. speed input: 1997.00 toks/s, output: 15.60 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:08<00:00, 15.60it/s, est. speed input: 1997.14 toks/s, output: 15.60 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:08<00:00, 15.60it/s, est. speed input: 1997.14 toks/s, output: 15.60 toks/s]
[rank0]:[W125 17:08:37.298975040 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=256 ==========
Time: 2026-01-25 17:08:40
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_6
Params: prompt_len=256, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_6 --dataset-name random --input-len 256 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 257 --max-num-batched-tokens 257 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Llama3.2-1B-INT8_M256.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 17:08:47 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 17:08:48 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=168144) WARNING 01-25 17:08:56 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=168144) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=168144) WARNING 01-25 17:09:03 [backends.py:609] Failed to read file <frozen os>
Throughput: 16.05 requests/s, 4124.80 total tokens/s, 16.05 output tokens/s
Total num prompt tokens:  32768
Total num output tokens:  128

STDERR:
[2026-01-25 17:08:47] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:08:47] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 17:08:47] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 17:08:47] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:08:47] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:08:47] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:08:47] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:08:47] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:08:47] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 17:08:47] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:08:47] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:08:47] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:08:47] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:08:47] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 17:08:55] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:08:55] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 17:08:55] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 17:08:55] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:08:55] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:08:55] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:08:55] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:08:55] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:08:55] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 17:08:55] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:08:55] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:08:55] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:08:55] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:08:55] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=168144) [2026-01-25 17:08:56] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=168144) [2026-01-25 17:08:56] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=168144) [2026-01-25 17:08:56] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=168144) [2026-01-25 17:08:56] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=168144) [2026-01-25 17:08:56] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-1B-INT8
(EngineCore_DP0 pid=168144) [2026-01-25 17:08:56] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=168144) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=168144) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.43it/s]
(EngineCore_DP0 pid=168144) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.43it/s]
(EngineCore_DP0 pid=168144) 
(EngineCore_DP0 pid=168144) [2026-01-25 17:08:57] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 2752] -> 1D uint8
(EngineCore_DP0 pid=168144) [2026-01-25 17:08:57] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 6389760 bytes
(EngineCore_DP0 pid=168144) [2026-01-25 17:08:57] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 2752] -> 1D uint8
(EngineCore_DP0 pid=168144) [2026-01-25 17:08:57] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4259840 bytes
(EngineCore_DP0 pid=168144) [2026-01-25 17:08:57] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 2752] -> 1D uint8
(EngineCore_DP0 pid=168144) [2026-01-25 17:08:57] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 34078720 bytes
(EngineCore_DP0 pid=168144) [2026-01-25 17:08:57] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 10944] -> 1D uint8
(EngineCore_DP0 pid=168144) [2026-01-25 17:08:57] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 16842752 bytes
(EngineCore_DP0 pid=168144) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  6.49it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  7.79it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  7.56it/s]
(EngineCore_DP0 pid=168144) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  8.32it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  8.30it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  75%|███████▌  | 96/128 [00:00<00:00, 950.97it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 966.59it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:33,  3.80it/s, est. speed input: 973.62 toks/s, output: 3.80 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:13,  8.99it/s, est. speed input: 2024.91 toks/s, output: 7.91 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:00<00:01, 91.19it/s, est. speed input: 16286.44 toks/s, output: 63.62 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:01<00:02, 37.99it/s, est. speed input: 9786.26 toks/s, output: 38.23 toks/s] 
Processed prompts:  41%|████      | 52/128 [00:01<00:02, 29.04it/s, est. speed input: 8238.33 toks/s, output: 32.18 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:01<00:02, 25.46it/s, est. speed input: 7585.04 toks/s, output: 29.63 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:02<00:02, 23.60it/s, est. speed input: 7254.99 toks/s, output: 28.34 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:02<00:02, 22.01it/s, est. speed input: 6982.63 toks/s, output: 27.28 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:02<00:02, 20.85it/s, est. speed input: 6793.50 toks/s, output: 26.54 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:02<00:02, 19.81it/s, est. speed input: 6625.69 toks/s, output: 25.88 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:02<00:02, 18.96it/s, est. speed input: 6477.25 toks/s, output: 25.30 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:03<00:02, 18.30it/s, est. speed input: 6346.85 toks/s, output: 24.79 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:03<00:02, 17.98it/s, est. speed input: 6270.75 toks/s, output: 24.49 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:03<00:02, 17.50it/s, est. speed input: 6188.92 toks/s, output: 24.18 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:03<00:02, 17.24it/s, est. speed input: 6120.23 toks/s, output: 23.91 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:03<00:02, 17.02it/s, est. speed input: 6055.68 toks/s, output: 23.65 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:03<00:02, 16.76it/s, est. speed input: 5991.46 toks/s, output: 23.40 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:03<00:02, 16.46it/s, est. speed input: 5926.83 toks/s, output: 23.15 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:04<00:02, 16.47it/s, est. speed input: 5875.10 toks/s, output: 22.95 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:04<00:02, 16.38it/s, est. speed input: 5823.07 toks/s, output: 22.75 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:04<00:01, 16.36it/s, est. speed input: 5775.51 toks/s, output: 22.56 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:04<00:01, 16.29it/s, est. speed input: 5728.97 toks/s, output: 22.38 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:04<00:01, 16.06it/s, est. speed input: 5679.04 toks/s, output: 22.18 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:04<00:01, 16.02it/s, est. speed input: 5635.58 toks/s, output: 22.01 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:04<00:01, 16.00it/s, est. speed input: 5594.77 toks/s, output: 21.85 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:04<00:01, 16.03it/s, est. speed input: 5557.17 toks/s, output: 21.71 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:05<00:01, 15.89it/s, est. speed input: 5516.96 toks/s, output: 21.55 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:05<00:01, 15.96it/s, est. speed input: 5483.32 toks/s, output: 21.42 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:05<00:00, 16.14it/s, est. speed input: 5454.85 toks/s, output: 21.31 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:05<00:00, 16.19it/s, est. speed input: 5425.62 toks/s, output: 21.19 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:05<00:00, 16.27it/s, est. speed input: 5398.99 toks/s, output: 21.09 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:05<00:00, 15.76it/s, est. speed input: 5359.24 toks/s, output: 20.93 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:05<00:00, 15.79it/s, est. speed input: 5330.92 toks/s, output: 20.82 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:05<00:00, 15.99it/s, est. speed input: 5307.99 toks/s, output: 20.73 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:06<00:00, 16.13it/s, est. speed input: 5285.77 toks/s, output: 20.65 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:06<00:00, 16.22it/s, est. speed input: 5264.43 toks/s, output: 20.56 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:06<00:00, 16.14it/s, est. speed input: 5240.81 toks/s, output: 20.47 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:06<00:00, 16.14it/s, est. speed input: 5240.81 toks/s, output: 20.47 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:06<00:00, 20.47it/s, est. speed input: 5240.81 toks/s, output: 20.47 toks/s]
[rank0]:[W125 17:09:23.619331669 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=512 ==========
Time: 2026-01-25 17:59:04
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_6
Params: prompt_len=512, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_6 --dataset-name random --input-len 512 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 513 --max-num-batched-tokens 513 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Llama3.2-1B-INT8_M512.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 17:59:11 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 17:59:12 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=224067) WARNING 01-25 17:59:30 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=224067) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=224067) WARNING 01-25 17:59:38 [backends.py:609] Failed to read file <frozen os>
Throughput: 16.31 requests/s, 8366.30 total tokens/s, 16.31 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128

STDERR:
[2026-01-25 17:59:11] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:59:11] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 17:59:11] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 17:59:11] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:59:11] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:59:11] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:59:11] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:59:11] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:59:11] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 17:59:11] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:59:11] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:59:11] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:59:11] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:59:11] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 17:59:19] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:59:19] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 17:59:19] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 17:59:19] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:59:19] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:59:19] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:59:19] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:59:19] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:59:19] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 17:59:19] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:59:19] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:59:19] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:59:19] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:59:19] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[W125 17:59:29.347052497 socket.cpp:209] [c10d] The hostname of the client socket cannot be retrieved. err=-3
(EngineCore_DP0 pid=224067) [2026-01-25 17:59:30] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=224067) [2026-01-25 17:59:30] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=224067) [2026-01-25 17:59:30] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=224067) [2026-01-25 17:59:30] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=224067) [2026-01-25 17:59:30] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-1B-INT8
(EngineCore_DP0 pid=224067) [2026-01-25 17:59:30] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=224067) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=224067) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.90it/s]
(EngineCore_DP0 pid=224067) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.90it/s]
(EngineCore_DP0 pid=224067) 
(EngineCore_DP0 pid=224067) [2026-01-25 17:59:31] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 2752] -> 1D uint8
(EngineCore_DP0 pid=224067) [2026-01-25 17:59:31] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 6389760 bytes
(EngineCore_DP0 pid=224067) [2026-01-25 17:59:31] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 2752] -> 1D uint8
(EngineCore_DP0 pid=224067) [2026-01-25 17:59:31] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4259840 bytes
(EngineCore_DP0 pid=224067) [2026-01-25 17:59:31] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 2752] -> 1D uint8
(EngineCore_DP0 pid=224067) [2026-01-25 17:59:31] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 34078720 bytes
(EngineCore_DP0 pid=224067) [2026-01-25 17:59:31] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 10944] -> 1D uint8
(EngineCore_DP0 pid=224067) [2026-01-25 17:59:31] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 16842752 bytes
(EngineCore_DP0 pid=224067) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  7.44it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  5.61it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  5.82it/s]
(EngineCore_DP0 pid=224067) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.56it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.55it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  42%|████▏     | 54/128 [00:00<00:00, 530.52it/s]
Adding requests:  88%|████████▊ | 112/128 [00:00<00:00, 553.86it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 552.97it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:03, 34.66it/s, est. speed input: 17747.59 toks/s, output: 34.66 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:00<00:05, 21.47it/s, est. speed input: 11736.33 toks/s, output: 22.92 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:00<00:06, 19.05it/s, est. speed input: 10570.61 toks/s, output: 20.64 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:00<00:06, 17.96it/s, est. speed input: 10019.35 toks/s, output: 19.57 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:00<00:06, 17.46it/s, est. speed input: 9768.69 toks/s, output: 19.08 toks/s] 
Processed prompts:  15%|█▍        | 19/128 [00:01<00:06, 17.03it/s, est. speed input: 9570.02 toks/s, output: 18.69 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:01<00:06, 16.78it/s, est. speed input: 9426.75 toks/s, output: 18.41 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:01<00:06, 16.88it/s, est. speed input: 9367.63 toks/s, output: 18.30 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:01<00:06, 17.04it/s, est. speed input: 9331.93 toks/s, output: 18.23 toks/s]
Processed prompts:  21%|██        | 27/128 [00:01<00:05, 17.21it/s, est. speed input: 9309.15 toks/s, output: 18.18 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:01<00:05, 17.39it/s, est. speed input: 9297.06 toks/s, output: 18.16 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:01<00:05, 17.39it/s, est. speed input: 9270.14 toks/s, output: 18.11 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:01<00:05, 17.32it/s, est. speed input: 9239.24 toks/s, output: 18.05 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:01<00:05, 17.41it/s, est. speed input: 9226.72 toks/s, output: 18.02 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:02<00:05, 17.37it/s, est. speed input: 9205.22 toks/s, output: 17.98 toks/s]
Processed prompts:  30%|███       | 39/128 [00:02<00:05, 17.45it/s, est. speed input: 9196.09 toks/s, output: 17.96 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:02<00:05, 17.23it/s, est. speed input: 9163.74 toks/s, output: 17.90 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:02<00:04, 17.32it/s, est. speed input: 9154.43 toks/s, output: 17.88 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:02<00:04, 17.36it/s, est. speed input: 9145.08 toks/s, output: 17.86 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:02<00:04, 17.44it/s, est. speed input: 9139.63 toks/s, output: 17.85 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:02<00:04, 17.46it/s, est. speed input: 9132.47 toks/s, output: 17.84 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:02<00:04, 17.46it/s, est. speed input: 9124.63 toks/s, output: 17.82 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:02<00:04, 17.35it/s, est. speed input: 9109.98 toks/s, output: 17.79 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:03<00:04, 17.41it/s, est. speed input: 9105.25 toks/s, output: 17.78 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:03<00:04, 17.46it/s, est. speed input: 9101.72 toks/s, output: 17.78 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:03<00:03, 17.40it/s, est. speed input: 9092.35 toks/s, output: 17.76 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:03<00:03, 17.41it/s, est. speed input: 9086.77 toks/s, output: 17.75 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:03<00:03, 17.41it/s, est. speed input: 9081.15 toks/s, output: 17.74 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:03<00:03, 17.11it/s, est. speed input: 9059.62 toks/s, output: 17.69 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:03<00:03, 16.85it/s, est. speed input: 9035.70 toks/s, output: 17.65 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:03<00:03, 16.54it/s, est. speed input: 9006.52 toks/s, output: 17.59 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:04<00:03, 16.09it/s, est. speed input: 8965.44 toks/s, output: 17.51 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:04<00:03, 16.15it/s, est. speed input: 8947.30 toks/s, output: 17.48 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:04<00:03, 16.15it/s, est. speed input: 8927.86 toks/s, output: 17.44 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:04<00:03, 16.14it/s, est. speed input: 8908.69 toks/s, output: 17.40 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:04<00:03, 16.07it/s, est. speed input: 8887.70 toks/s, output: 17.36 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:04<00:02, 16.09it/s, est. speed input: 8871.23 toks/s, output: 17.33 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:04<00:02, 16.10it/s, est. speed input: 8855.13 toks/s, output: 17.30 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:04<00:02, 16.05it/s, est. speed input: 8837.40 toks/s, output: 17.26 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:05<00:02, 16.04it/s, est. speed input: 8821.78 toks/s, output: 17.23 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:05<00:02, 16.13it/s, est. speed input: 8810.77 toks/s, output: 17.21 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:05<00:02, 16.05it/s, est. speed input: 8794.44 toks/s, output: 17.18 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:05<00:02, 16.01it/s, est. speed input: 8779.79 toks/s, output: 17.15 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:05<00:02, 16.02it/s, est. speed input: 8766.82 toks/s, output: 17.12 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:05<00:01, 15.98it/s, est. speed input: 8753.05 toks/s, output: 17.10 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:05<00:01, 16.09it/s, est. speed input: 8744.87 toks/s, output: 17.08 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:05<00:01, 16.22it/s, est. speed input: 8739.31 toks/s, output: 17.07 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:06<00:01, 16.15it/s, est. speed input: 8727.70 toks/s, output: 17.05 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:06<00:01, 16.18it/s, est. speed input: 8719.46 toks/s, output: 17.03 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:06<00:01, 16.16it/s, est. speed input: 8710.42 toks/s, output: 17.01 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:06<00:01, 16.07it/s, est. speed input: 8698.87 toks/s, output: 16.99 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:06<00:01, 16.06it/s, est. speed input: 8689.38 toks/s, output: 16.97 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:06<00:00, 16.02it/s, est. speed input: 8679.31 toks/s, output: 16.95 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:06<00:00, 15.95it/s, est. speed input: 8668.36 toks/s, output: 16.93 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:06<00:00, 15.94it/s, est. speed input: 8658.93 toks/s, output: 16.91 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:07<00:00, 15.96it/s, est. speed input: 8650.60 toks/s, output: 16.90 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:07<00:00, 15.98it/s, est. speed input: 8643.00 toks/s, output: 16.88 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:07<00:00, 15.95it/s, est. speed input: 8634.02 toks/s, output: 16.86 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:07<00:00, 15.93it/s, est. speed input: 8625.48 toks/s, output: 16.85 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:07<00:00, 15.58it/s, est. speed input: 8607.08 toks/s, output: 16.81 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 15.58it/s, est. speed input: 8605.63 toks/s, output: 16.81 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 16.81it/s, est. speed input: 8605.63 toks/s, output: 16.81 toks/s]
[rank0]:[W125 17:59:57.855620545 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=1024 ==========
Time: 2026-01-25 18:00:00
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 1025 --max-num-batched-tokens 1025 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Llama3.2-1B-INT8_M1024.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 18:00:09 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 18:00:10 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=225093) WARNING 01-25 18:00:17 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=225093) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=225093) WARNING 01-25 18:00:25 [backends.py:609] Failed to read file <frozen os>
Throughput: 16.06 requests/s, 16464.47 total tokens/s, 16.06 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128

STDERR:
[2026-01-25 18:00:09] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:00:09] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 18:00:09] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 18:00:09] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:00:09] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:00:09] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:00:09] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:00:09] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:00:09] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 18:00:09] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:00:09] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:00:09] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:00:09] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:00:09] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 18:00:16] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:00:16] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 18:00:16] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 18:00:16] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:00:16] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:00:16] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:00:16] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:00:16] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:00:16] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 18:00:16] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:00:16] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:00:16] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:00:16] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:00:16] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=225093) [2026-01-25 18:00:18] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=225093) [2026-01-25 18:00:18] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=225093) [2026-01-25 18:00:18] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=225093) [2026-01-25 18:00:18] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=225093) [2026-01-25 18:00:18] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-1B-INT8
(EngineCore_DP0 pid=225093) [2026-01-25 18:00:18] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=225093) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=225093) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.41it/s]
(EngineCore_DP0 pid=225093) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.41it/s]
(EngineCore_DP0 pid=225093) 
(EngineCore_DP0 pid=225093) [2026-01-25 18:00:18] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 2752] -> 1D uint8
(EngineCore_DP0 pid=225093) [2026-01-25 18:00:19] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 6389760 bytes
(EngineCore_DP0 pid=225093) [2026-01-25 18:00:19] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 2752] -> 1D uint8
(EngineCore_DP0 pid=225093) [2026-01-25 18:00:19] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4259840 bytes
(EngineCore_DP0 pid=225093) [2026-01-25 18:00:19] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 2752] -> 1D uint8
(EngineCore_DP0 pid=225093) [2026-01-25 18:00:19] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 34078720 bytes
(EngineCore_DP0 pid=225093) [2026-01-25 18:00:19] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 10944] -> 1D uint8
(EngineCore_DP0 pid=225093) [2026-01-25 18:00:19] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 16842752 bytes
(EngineCore_DP0 pid=225093) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  7.80it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  5.50it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  5.75it/s]
(EngineCore_DP0 pid=225093) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.37it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.35it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  23%|██▎       | 29/128 [00:00<00:00, 289.85it/s]
Adding requests:  47%|████▋     | 60/128 [00:00<00:00, 299.21it/s]
Adding requests:  71%|███████   | 91/128 [00:00<00:00, 299.52it/s]
Adding requests:  95%|█████████▍| 121/128 [00:00<00:00, 289.63it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 292.00it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:02, 43.22it/s, est. speed input: 44264.32 toks/s, output: 43.22 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:00<00:05, 22.76it/s, est. speed input: 25087.53 toks/s, output: 24.50 toks/s]
Processed prompts:  10%|█         | 13/128 [00:00<00:05, 20.54it/s, est. speed input: 22851.20 toks/s, output: 22.31 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:00<00:05, 19.05it/s, est. speed input: 21450.53 toks/s, output: 20.95 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:00<00:05, 18.38it/s, est. speed input: 20709.94 toks/s, output: 20.22 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:01<00:05, 18.08it/s, est. speed input: 20363.15 toks/s, output: 19.89 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:01<00:05, 17.83it/s, est. speed input: 20081.92 toks/s, output: 19.61 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:01<00:05, 17.68it/s, est. speed input: 19864.55 toks/s, output: 19.40 toks/s]
Processed prompts:  21%|██        | 27/128 [00:01<00:05, 17.64it/s, est. speed input: 19710.47 toks/s, output: 19.25 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:01<00:05, 17.64it/s, est. speed input: 19587.32 toks/s, output: 19.13 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:01<00:05, 17.62it/s, est. speed input: 19474.65 toks/s, output: 19.02 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:01<00:05, 17.61it/s, est. speed input: 19378.67 toks/s, output: 18.92 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:01<00:05, 17.60it/s, est. speed input: 19295.16 toks/s, output: 18.84 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:01<00:05, 17.51it/s, est. speed input: 19202.37 toks/s, output: 18.75 toks/s]
Processed prompts:  30%|███       | 39/128 [00:02<00:05, 17.55it/s, est. speed input: 19140.96 toks/s, output: 18.69 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:02<00:04, 17.68it/s, est. speed input: 19104.53 toks/s, output: 18.66 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:02<00:04, 17.86it/s, est. speed input: 19087.91 toks/s, output: 18.64 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:02<00:04, 17.79it/s, est. speed input: 19039.42 toks/s, output: 18.59 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:02<00:04, 17.50it/s, est. speed input: 18955.13 toks/s, output: 18.51 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:02<00:04, 17.08it/s, est. speed input: 18844.35 toks/s, output: 18.40 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:02<00:04, 16.71it/s, est. speed input: 18729.08 toks/s, output: 18.29 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:02<00:04, 16.54it/s, est. speed input: 18636.78 toks/s, output: 18.20 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:03<00:04, 16.21it/s, est. speed input: 18518.33 toks/s, output: 18.08 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:03<00:04, 16.22it/s, est. speed input: 18445.76 toks/s, output: 18.01 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:03<00:04, 16.30it/s, est. speed input: 18388.27 toks/s, output: 17.96 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:03<00:04, 16.36it/s, est. speed input: 18335.31 toks/s, output: 17.91 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:03<00:03, 16.34it/s, est. speed input: 18277.73 toks/s, output: 17.85 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:03<00:03, 16.13it/s, est. speed input: 18199.36 toks/s, output: 17.77 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:03<00:03, 16.10it/s, est. speed input: 18141.07 toks/s, output: 17.72 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:03<00:03, 16.06it/s, est. speed input: 18083.39 toks/s, output: 17.66 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:04<00:03, 16.11it/s, est. speed input: 18038.28 toks/s, output: 17.62 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:04<00:03, 16.06it/s, est. speed input: 17986.84 toks/s, output: 17.57 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:04<00:03, 16.11it/s, est. speed input: 17947.10 toks/s, output: 17.53 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:04<00:03, 16.31it/s, est. speed input: 17927.47 toks/s, output: 17.51 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:04<00:02, 16.46it/s, est. speed input: 17908.96 toks/s, output: 17.49 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:04<00:02, 16.48it/s, est. speed input: 17883.25 toks/s, output: 17.46 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:04<00:02, 16.43it/s, est. speed input: 17852.60 toks/s, output: 17.43 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:04<00:02, 16.41it/s, est. speed input: 17825.64 toks/s, output: 17.41 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:05<00:02, 16.38it/s, est. speed input: 17798.02 toks/s, output: 17.38 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:05<00:00, 81.71it/s, est. speed input: 23142.84 toks/s, output: 22.60 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:05<00:00, 40.31it/s, est. speed input: 22563.82 toks/s, output: 22.03 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:05<00:00, 40.31it/s, est. speed input: 22307.27 toks/s, output: 21.78 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:05<00:00, 21.78it/s, est. speed input: 22307.27 toks/s, output: 21.78 toks/s]
[rank0]:[W125 18:00:45.712970810 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=2048 ==========
Time: 2026-01-25 18:00:48
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=256, max_num_seqs=2
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 256 --max-num-seqs 2 --max-model-len 1025 --max-num-batched-tokens 2048 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Llama3.2-1B-INT8_M2048.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 18:00:57 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 18:00:58 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=225994) WARNING 01-25 18:01:06 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=225994) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=225994) WARNING 01-25 18:01:14 [backends.py:609] Failed to read file <frozen os>
Throughput: 31.72 requests/s, 32510.74 total tokens/s, 31.72 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256

STDERR:
[2026-01-25 18:00:57] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:00:57] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 18:00:57] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 18:00:57] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:00:57] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:00:57] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:00:57] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:00:57] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:00:57] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 18:00:57] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:00:57] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:00:57] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:00:57] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:00:57] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 18:01:05] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:01:05] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 18:01:05] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 18:01:05] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:01:05] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:01:05] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:01:05] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:01:05] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:01:05] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 18:01:05] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:01:05] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:01:05] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:01:05] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:01:05] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=225994) [2026-01-25 18:01:07] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=225994) [2026-01-25 18:01:07] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=225994) [2026-01-25 18:01:07] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=225994) [2026-01-25 18:01:07] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=225994) [2026-01-25 18:01:07] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-1B-INT8
(EngineCore_DP0 pid=225994) [2026-01-25 18:01:07] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=225994) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=225994) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.43it/s]
(EngineCore_DP0 pid=225994) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.43it/s]
(EngineCore_DP0 pid=225994) 
(EngineCore_DP0 pid=225994) [2026-01-25 18:01:08] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 2752] -> 1D uint8
(EngineCore_DP0 pid=225994) [2026-01-25 18:01:08] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 6389760 bytes
(EngineCore_DP0 pid=225994) [2026-01-25 18:01:08] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 2752] -> 1D uint8
(EngineCore_DP0 pid=225994) [2026-01-25 18:01:08] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4259840 bytes
(EngineCore_DP0 pid=225994) [2026-01-25 18:01:08] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 2752] -> 1D uint8
(EngineCore_DP0 pid=225994) [2026-01-25 18:01:08] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 34078720 bytes
(EngineCore_DP0 pid=225994) [2026-01-25 18:01:08] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 10944] -> 1D uint8
(EngineCore_DP0 pid=225994) [2026-01-25 18:01:08] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 16842752 bytes
(EngineCore_DP0 pid=225994) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  33%|███▎      | 1/3 [00:00<00:00,  6.11it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  67%|██████▋   | 2/3 [00:00<00:00,  5.24it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00,  6.06it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00,  5.90it/s]
(EngineCore_DP0 pid=225994) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 1/2 [00:00<00:00,  7.43it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  8.52it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  11%|█▏        | 29/256 [00:00<00:00, 285.43it/s]
Adding requests:  24%|██▍       | 61/256 [00:00<00:00, 301.17it/s]
Adding requests:  36%|███▌      | 92/256 [00:00<00:00, 298.34it/s]
Adding requests:  48%|████▊     | 122/256 [00:00<00:00, 298.34it/s]
Adding requests:  59%|█████▉    | 152/256 [00:00<00:00, 294.97it/s]
Adding requests:  71%|███████   | 182/256 [00:00<00:00, 293.01it/s]
Adding requests:  83%|████████▎ | 212/256 [00:00<00:00, 285.27it/s]
Adding requests:  95%|█████████▍| 242/256 [00:00<00:00, 288.58it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 290.94it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   9%|▉         | 24/256 [00:00<00:01, 219.33it/s, est. speed input: 224662.05 toks/s, output: 219.34 toks/s]
Processed prompts:  18%|█▊        | 46/256 [00:00<00:04, 51.43it/s, est. speed input: 59837.85 toks/s, output: 58.43 toks/s]   
Processed prompts:  22%|██▏       | 57/256 [00:01<00:04, 45.46it/s, est. speed input: 53135.07 toks/s, output: 51.89 toks/s]
Processed prompts:  25%|██▌       | 65/256 [00:01<00:04, 42.66it/s, est. speed input: 50244.34 toks/s, output: 49.07 toks/s]
Processed prompts:  28%|██▊       | 71/256 [00:01<00:04, 40.91it/s, est. speed input: 48610.27 toks/s, output: 47.47 toks/s]
Processed prompts:  30%|███       | 77/256 [00:01<00:04, 39.56it/s, est. speed input: 47352.75 toks/s, output: 46.24 toks/s]
Processed prompts:  32%|███▏      | 82/256 [00:01<00:04, 36.58it/s, est. speed input: 45611.83 toks/s, output: 44.54 toks/s]
Processed prompts:  34%|███▎      | 86/256 [00:01<00:04, 36.16it/s, est. speed input: 45001.63 toks/s, output: 43.95 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:02<00:04, 35.78it/s, est. speed input: 44456.83 toks/s, output: 43.41 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:02<00:04, 35.53it/s, est. speed input: 43988.87 toks/s, output: 42.96 toks/s]
Processed prompts:  38%|███▊      | 98/256 [00:02<00:04, 35.19it/s, est. speed input: 43535.01 toks/s, output: 42.51 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:02<00:04, 35.42it/s, est. speed input: 43233.32 toks/s, output: 42.22 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:02<00:04, 35.44it/s, est. speed input: 42926.49 toks/s, output: 41.92 toks/s]
Processed prompts:  43%|████▎     | 110/256 [00:02<00:04, 35.31it/s, est. speed input: 42618.60 toks/s, output: 41.62 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:02<00:04, 35.30it/s, est. speed input: 42351.45 toks/s, output: 41.36 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:02<00:03, 35.13it/s, est. speed input: 42079.32 toks/s, output: 41.09 toks/s]
Processed prompts:  48%|████▊     | 122/256 [00:02<00:03, 34.68it/s, est. speed input: 41776.13 toks/s, output: 40.80 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:03<00:03, 33.77it/s, est. speed input: 41403.30 toks/s, output: 40.43 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:03<00:03, 33.29it/s, est. speed input: 41079.85 toks/s, output: 40.12 toks/s]
Processed prompts:  52%|█████▏    | 134/256 [00:03<00:03, 33.09it/s, est. speed input: 40800.10 toks/s, output: 39.84 toks/s]
Processed prompts:  54%|█████▍    | 138/256 [00:03<00:03, 32.80it/s, est. speed input: 40518.51 toks/s, output: 39.57 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:03<00:03, 32.87it/s, est. speed input: 40293.57 toks/s, output: 39.35 toks/s]
Processed prompts:  57%|█████▋    | 146/256 [00:03<00:03, 32.79it/s, est. speed input: 40066.60 toks/s, output: 39.13 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:03<00:03, 32.38it/s, est. speed input: 39808.43 toks/s, output: 38.87 toks/s]
Processed prompts:  60%|██████    | 154/256 [00:03<00:03, 31.90it/s, est. speed input: 39540.08 toks/s, output: 38.61 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:04<00:03, 31.68it/s, est. speed input: 39303.24 toks/s, output: 38.38 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:04<00:02, 31.87it/s, est. speed input: 39122.50 toks/s, output: 38.20 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:04<00:02, 31.96it/s, est. speed input: 38945.90 toks/s, output: 38.03 toks/s]
Processed prompts:  66%|██████▋   | 170/256 [00:04<00:02, 31.78it/s, est. speed input: 38752.39 toks/s, output: 37.84 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:04<00:02, 31.94it/s, est. speed input: 38600.28 toks/s, output: 37.70 toks/s]
Processed prompts:  70%|██████▉   | 178/256 [00:04<00:02, 31.98it/s, est. speed input: 38448.61 toks/s, output: 37.55 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:04<00:02, 31.95it/s, est. speed input: 38299.18 toks/s, output: 37.40 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:04<00:02, 31.94it/s, est. speed input: 38157.88 toks/s, output: 37.26 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:05<00:02, 32.01it/s, est. speed input: 38031.92 toks/s, output: 37.14 toks/s]
Processed prompts:  76%|███████▌  | 194/256 [00:05<00:01, 32.05it/s, est. speed input: 37910.30 toks/s, output: 37.02 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:05<00:01, 32.03it/s, est. speed input: 37789.93 toks/s, output: 36.90 toks/s]
Processed prompts:  79%|███████▉  | 202/256 [00:05<00:01, 32.01it/s, est. speed input: 37674.40 toks/s, output: 36.79 toks/s]
Processed prompts:  80%|████████  | 206/256 [00:05<00:01, 31.98it/s, est. speed input: 37562.93 toks/s, output: 36.68 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:05<00:01, 32.19it/s, est. speed input: 37476.06 toks/s, output: 36.60 toks/s]
Processed prompts:  84%|████████▎ | 214/256 [00:05<00:01, 32.30it/s, est. speed input: 37389.43 toks/s, output: 36.51 toks/s]
Processed prompts:  85%|████████▌ | 218/256 [00:05<00:01, 32.37it/s, est. speed input: 37305.25 toks/s, output: 36.43 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:06<00:01, 32.32it/s, est. speed input: 37217.43 toks/s, output: 36.34 toks/s]
Processed prompts:  88%|████████▊ | 226/256 [00:06<00:00, 31.90it/s, est. speed input: 37102.86 toks/s, output: 36.23 toks/s]
Processed prompts:  90%|████████▉ | 230/256 [00:06<00:00, 31.84it/s, est. speed input: 37011.30 toks/s, output: 36.14 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:06<00:00, 31.42it/s, est. speed input: 36894.21 toks/s, output: 36.03 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:06<00:00, 31.36it/s, est. speed input: 36798.94 toks/s, output: 35.94 toks/s]
Processed prompts:  95%|█████████▍| 242/256 [00:06<00:00, 31.50it/s, est. speed input: 36720.43 toks/s, output: 35.86 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:06<00:00, 31.34it/s, est. speed input: 36626.60 toks/s, output: 35.77 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:07<00:00, 31.48it/s, est. speed input: 36553.63 toks/s, output: 35.70 toks/s]
Processed prompts:  99%|█████████▉| 254/256 [00:07<00:00, 31.71it/s, est. speed input: 36492.69 toks/s, output: 35.64 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:07<00:00, 31.71it/s, est. speed input: 36462.57 toks/s, output: 35.61 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:07<00:00, 35.61it/s, est. speed input: 36462.57 toks/s, output: 35.61 toks/s]
[rank0]:[W125 18:01:34.437450536 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=4096 ==========
Time: 2026-01-25 18:01:37
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=512, max_num_seqs=4
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 512 --max-num-seqs 4 --max-model-len 1025 --max-num-batched-tokens 4096 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Llama3.2-1B-INT8_M4096.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 18:01:46 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 18:01:47 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=226914) WARNING 01-25 18:01:55 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=226914) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=226914) WARNING 01-25 18:02:03 [backends.py:609] Failed to read file <frozen os>
Throughput: 61.90 requests/s, 63448.20 total tokens/s, 61.90 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512

STDERR:
[2026-01-25 18:01:46] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:01:46] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 18:01:46] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 18:01:46] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:01:46] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:01:46] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:01:46] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:01:46] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:01:46] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 18:01:46] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:01:46] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:01:46] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:01:46] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:01:46] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 18:01:54] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:01:54] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 18:01:54] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 18:01:54] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:01:54] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:01:54] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:01:54] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:01:54] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:01:54] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 18:01:54] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:01:54] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:01:54] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:01:54] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:01:54] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=226914) [2026-01-25 18:01:56] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=226914) [2026-01-25 18:01:56] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=226914) [2026-01-25 18:01:56] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=226914) [2026-01-25 18:01:56] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=226914) [2026-01-25 18:01:56] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-1B-INT8
(EngineCore_DP0 pid=226914) [2026-01-25 18:01:56] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=226914) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=226914) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.49it/s]
(EngineCore_DP0 pid=226914) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.49it/s]
(EngineCore_DP0 pid=226914) 
(EngineCore_DP0 pid=226914) [2026-01-25 18:01:56] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 2752] -> 1D uint8
(EngineCore_DP0 pid=226914) [2026-01-25 18:01:56] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 6389760 bytes
(EngineCore_DP0 pid=226914) [2026-01-25 18:01:56] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 2752] -> 1D uint8
(EngineCore_DP0 pid=226914) [2026-01-25 18:01:56] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4259840 bytes
(EngineCore_DP0 pid=226914) [2026-01-25 18:01:56] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 2752] -> 1D uint8
(EngineCore_DP0 pid=226914) [2026-01-25 18:01:56] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 34078720 bytes
(EngineCore_DP0 pid=226914) [2026-01-25 18:01:56] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 10944] -> 1D uint8
(EngineCore_DP0 pid=226914) [2026-01-25 18:01:56] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 16842752 bytes
(EngineCore_DP0 pid=226914) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  25%|██▌       | 1/4 [00:00<00:00,  7.25it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 2/4 [00:00<00:00,  8.52it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  8.66it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  8.52it/s]
(EngineCore_DP0 pid=226914) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  33%|███▎      | 1/3 [00:00<00:00,  7.81it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  9.55it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  9.34it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   6%|▌         | 31/512 [00:00<00:01, 308.95it/s]
Adding requests:  13%|█▎        | 65/512 [00:00<00:01, 325.89it/s]
Adding requests:  19%|█▉        | 98/512 [00:00<00:01, 327.08it/s]
Adding requests:  26%|██▌       | 132/512 [00:00<00:01, 329.08it/s]
Adding requests:  32%|███▏      | 165/512 [00:00<00:01, 323.30it/s]
Adding requests:  39%|███▊      | 198/512 [00:00<00:00, 314.74it/s]
Adding requests:  46%|████▌     | 233/512 [00:00<00:00, 325.37it/s]
Adding requests:  52%|█████▏    | 266/512 [00:00<00:00, 325.23it/s]
Adding requests:  58%|█████▊    | 299/512 [00:00<00:00, 322.50it/s]
Adding requests:  65%|██████▌   | 333/512 [00:01<00:00, 326.63it/s]
Adding requests:  72%|███████▏  | 368/512 [00:01<00:00, 331.59it/s]
Adding requests:  79%|███████▊  | 402/512 [00:01<00:00, 332.28it/s]
Adding requests:  85%|████████▌ | 436/512 [00:01<00:00, 321.40it/s]
Adding requests:  92%|█████████▏| 469/512 [00:01<00:00, 323.85it/s]
Adding requests:  98%|█████████▊| 502/512 [00:01<00:00, 319.63it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 323.33it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  16%|█▌        | 82/512 [00:00<00:00, 538.76it/s, est. speed input: 551792.87 toks/s, output: 538.79 toks/s]
Processed prompts:  27%|██▋       | 136/512 [00:00<00:02, 132.38it/s, est. speed input: 156973.51 toks/s, output: 153.29 toks/s]
Processed prompts:  32%|███▏      | 163/512 [00:01<00:03, 104.46it/s, est. speed input: 128093.67 toks/s, output: 125.09 toks/s]
Processed prompts:  35%|███▌      | 181/512 [00:01<00:03, 96.37it/s, est. speed input: 119662.83 toks/s, output: 116.86 toks/s] 
Processed prompts:  38%|███▊      | 195/512 [00:01<00:03, 85.76it/s, est. speed input: 111283.26 toks/s, output: 108.67 toks/s]
Processed prompts:  40%|████      | 206/512 [00:01<00:03, 79.84it/s, est. speed input: 106571.55 toks/s, output: 104.07 toks/s]
Processed prompts:  42%|████▏     | 216/512 [00:02<00:03, 79.85it/s, est. speed input: 105099.97 toks/s, output: 102.64 toks/s]
Processed prompts:  44%|████▍     | 225/512 [00:02<00:03, 78.33it/s, est. speed input: 103368.75 toks/s, output: 100.95 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:02<00:04, 69.05it/s, est. speed input: 99133.43 toks/s, output: 96.81 toks/s]  
Processed prompts:  47%|████▋     | 242/512 [00:02<00:03, 68.32it/s, est. speed input: 97607.63 toks/s, output: 95.32 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:02<00:03, 67.61it/s, est. speed input: 96197.55 toks/s, output: 93.94 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:02<00:03, 66.81it/s, est. speed input: 94855.12 toks/s, output: 92.63 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:02<00:03, 65.82it/s, est. speed input: 93543.57 toks/s, output: 91.35 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:03<00:03, 64.63it/s, est. speed input: 92245.15 toks/s, output: 90.08 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:03<00:03, 64.78it/s, est. speed input: 91255.53 toks/s, output: 89.12 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:03<00:03, 64.46it/s, est. speed input: 90260.31 toks/s, output: 88.14 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:03<00:03, 64.11it/s, est. speed input: 89318.28 toks/s, output: 87.22 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:03<00:03, 63.83it/s, est. speed input: 88437.95 toks/s, output: 86.36 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:03<00:03, 63.91it/s, est. speed input: 87661.24 toks/s, output: 85.61 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:03<00:02, 64.25it/s, est. speed input: 86979.73 toks/s, output: 84.94 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:03<00:02, 64.36it/s, est. speed input: 86322.15 toks/s, output: 84.30 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:04<00:02, 64.40it/s, est. speed input: 85698.32 toks/s, output: 83.69 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:04<00:02, 63.73it/s, est. speed input: 85020.32 toks/s, output: 83.03 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:04<00:02, 64.71it/s, est. speed input: 84567.57 toks/s, output: 82.59 toks/s]
Processed prompts:  71%|███████   | 362/512 [00:04<00:02, 64.59it/s, est. speed input: 84040.58 toks/s, output: 82.07 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [00:04<00:02, 64.41it/s, est. speed input: 83530.17 toks/s, output: 81.57 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [00:04<00:02, 64.95it/s, est. speed input: 83123.39 toks/s, output: 81.17 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [00:04<00:01, 64.70it/s, est. speed input: 82667.95 toks/s, output: 80.73 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [00:04<00:01, 64.80it/s, est. speed input: 82264.52 toks/s, output: 80.34 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [00:05<00:01, 65.11it/s, est. speed input: 81906.08 toks/s, output: 79.99 toks/s]
Processed prompts:  80%|████████  | 410/512 [00:05<00:01, 64.83it/s, est. speed input: 81513.93 toks/s, output: 79.60 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [00:05<00:01, 64.80it/s, est. speed input: 81156.97 toks/s, output: 79.25 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [00:05<00:01, 64.67it/s, est. speed input: 80805.91 toks/s, output: 78.91 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [00:05<00:01, 64.23it/s, est. speed input: 80438.05 toks/s, output: 78.55 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [00:05<00:01, 63.61it/s, est. speed input: 80057.81 toks/s, output: 78.18 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [00:05<00:00, 63.16it/s, est. speed input: 79692.00 toks/s, output: 77.82 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [00:05<00:00, 63.42it/s, est. speed input: 79392.84 toks/s, output: 77.53 toks/s]
Processed prompts:  91%|█████████ | 466/512 [00:06<00:00, 63.57it/s, est. speed input: 79103.98 toks/s, output: 77.25 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [00:06<00:00, 64.11it/s, est. speed input: 78862.95 toks/s, output: 77.01 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [00:06<00:00, 64.73it/s, est. speed input: 78650.57 toks/s, output: 76.81 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [00:06<00:00, 64.72it/s, est. speed input: 78411.04 toks/s, output: 76.57 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [00:06<00:00, 66.35it/s, est. speed input: 78301.96 toks/s, output: 76.47 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [00:06<00:00, 67.58it/s, est. speed input: 78200.04 toks/s, output: 76.37 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:06<00:00, 67.58it/s, est. speed input: 78415.02 toks/s, output: 76.58 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:06<00:00, 76.58it/s, est. speed input: 78415.02 toks/s, output: 76.58 toks/s]
[rank0]:[W125 18:02:23.104107966 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=8192 ==========
Time: 2026-01-25 18:02:26
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=1024, max_num_seqs=8
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 1024 --max-num-seqs 8 --max-model-len 1025 --max-num-batched-tokens 8192 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Llama3.2-1B-INT8_M8192.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 18:02:41 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 18:02:42 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=227899) WARNING 01-25 18:02:48 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=227899) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=227899) WARNING 01-25 18:02:56 [backends.py:609] Failed to read file <frozen os>
Throughput: 101.35 requests/s, 103882.25 total tokens/s, 101.35 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024

STDERR:
[2026-01-25 18:02:41] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:02:41] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 18:02:41] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 18:02:41] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:02:41] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:02:41] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:02:41] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:02:41] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:02:41] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 18:02:41] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:02:41] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:02:41] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:02:41] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:02:41] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 18:02:48] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:02:48] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 18:02:48] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 18:02:48] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:02:48] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:02:48] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:02:48] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:02:48] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:02:48] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 18:02:48] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:02:48] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:02:48] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:02:48] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:02:48] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=227899) [2026-01-25 18:02:49] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=227899) [2026-01-25 18:02:49] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=227899) [2026-01-25 18:02:49] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=227899) [2026-01-25 18:02:49] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=227899) [2026-01-25 18:02:49] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-1B-INT8
(EngineCore_DP0 pid=227899) [2026-01-25 18:02:49] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=227899) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=227899) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.61it/s]
(EngineCore_DP0 pid=227899) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.61it/s]
(EngineCore_DP0 pid=227899) 
(EngineCore_DP0 pid=227899) [2026-01-25 18:02:50] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 2752] -> 1D uint8
(EngineCore_DP0 pid=227899) [2026-01-25 18:02:50] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 6389760 bytes
(EngineCore_DP0 pid=227899) [2026-01-25 18:02:50] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 2752] -> 1D uint8
(EngineCore_DP0 pid=227899) [2026-01-25 18:02:50] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4259840 bytes
(EngineCore_DP0 pid=227899) [2026-01-25 18:02:50] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 2752] -> 1D uint8
(EngineCore_DP0 pid=227899) [2026-01-25 18:02:50] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 34078720 bytes
(EngineCore_DP0 pid=227899) [2026-01-25 18:02:50] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 10944] -> 1D uint8
(EngineCore_DP0 pid=227899) [2026-01-25 18:02:50] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 16842752 bytes
(EngineCore_DP0 pid=227899) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:00,  8.79it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  40%|████      | 2/5 [00:00<00:00,  9.11it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  60%|██████    | 3/5 [00:00<00:00,  9.45it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  80%|████████  | 4/5 [00:00<00:00,  9.55it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00,  8.50it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00,  8.84it/s]
(EngineCore_DP0 pid=227899) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:00,  7.18it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 2/4 [00:00<00:00,  7.31it/s]
Capturing CUDA graphs (decode, FULL):  75%|███████▌  | 3/4 [00:00<00:00,  5.15it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  6.32it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  6.25it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   3%|▎         | 27/1024 [00:00<00:03, 268.32it/s]
Adding requests:   5%|▌         | 56/1024 [00:00<00:03, 279.79it/s]
Adding requests:   9%|▊         | 88/1024 [00:00<00:03, 293.72it/s]
Adding requests:  12%|█▏        | 119/1024 [00:00<00:03, 297.10it/s]
Adding requests:  15%|█▍        | 150/1024 [00:00<00:02, 300.16it/s]
Adding requests:  18%|█▊        | 181/1024 [00:00<00:02, 302.88it/s]
Adding requests:  21%|██        | 212/1024 [00:00<00:02, 304.17it/s]
Adding requests:  24%|██▍       | 244/1024 [00:00<00:02, 306.87it/s]
Adding requests:  27%|██▋       | 275/1024 [00:00<00:02, 306.20it/s]
Adding requests:  30%|██▉       | 307/1024 [00:01<00:02, 308.37it/s]
Adding requests:  33%|███▎      | 338/1024 [00:01<00:02, 307.62it/s]
Adding requests:  36%|███▋      | 372/1024 [00:01<00:02, 316.53it/s]
Adding requests:  40%|███▉      | 405/1024 [00:01<00:01, 318.54it/s]
Adding requests:  43%|████▎     | 437/1024 [00:01<00:01, 317.87it/s]
Adding requests:  46%|████▌     | 469/1024 [00:01<00:01, 309.41it/s]
Adding requests:  49%|████▉     | 500/1024 [00:01<00:01, 302.21it/s]
Adding requests:  52%|█████▏    | 531/1024 [00:01<00:01, 296.68it/s]
Adding requests:  55%|█████▍    | 562/1024 [00:01<00:01, 298.62it/s]
Adding requests:  58%|█████▊    | 596/1024 [00:01<00:01, 308.76it/s]
Adding requests:  61%|██████▏   | 628/1024 [00:02<00:01, 310.20it/s]
Adding requests:  65%|██████▍   | 661/1024 [00:02<00:01, 314.23it/s]
Adding requests:  68%|██████▊   | 695/1024 [00:02<00:01, 321.01it/s]
Adding requests:  71%|███████▏  | 731/1024 [00:02<00:00, 330.50it/s]
Adding requests:  75%|███████▍  | 766/1024 [00:02<00:00, 335.34it/s]
Adding requests:  78%|███████▊  | 800/1024 [00:02<00:00, 334.46it/s]
Adding requests:  81%|████████▏ | 834/1024 [00:02<00:00, 323.07it/s]
Adding requests:  85%|████████▍ | 867/1024 [00:02<00:00, 324.13it/s]
Adding requests:  88%|████████▊ | 901/1024 [00:02<00:00, 327.39it/s]
Adding requests:  91%|█████████▏| 935/1024 [00:02<00:00, 330.94it/s]
Adding requests:  95%|█████████▍| 971/1024 [00:03<00:00, 336.67it/s]
Adding requests:  98%|█████████▊| 1005/1024 [00:03<00:00, 337.08it/s]
Adding requests: 100%|██████████| 1024/1024 [00:03<00:00, 316.45it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:00<00:00, 2506.91it/s, est. speed input: 2567653.89 toks/s, output: 2507.08 toks/s]
Processed prompts:  56%|█████▌    | 573/1024 [00:02<00:02, 190.76it/s, est. speed input: 231378.15 toks/s, output: 225.95 toks/s]   
Processed prompts:  67%|██████▋   | 683/1024 [00:03<00:02, 156.45it/s, est. speed input: 193074.01 toks/s, output: 188.55 toks/s]
Processed prompts:  73%|███████▎  | 748/1024 [00:04<00:01, 143.97it/s, est. speed input: 180395.84 toks/s, output: 176.17 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [00:04<00:00, 219.63it/s, est. speed input: 214121.04 toks/s, output: 209.10 toks/s]
Processed prompts:  96%|█████████▋| 988/1024 [00:05<00:00, 186.17it/s, est. speed input: 201775.99 toks/s, output: 197.05 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:05<00:00, 186.17it/s, est. speed input: 197178.15 toks/s, output: 192.56 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:05<00:00, 192.55it/s, est. speed input: 197178.15 toks/s, output: 192.56 toks/s]
[rank0]:[W125 18:03:19.224858399 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=16384 ==========
Time: 2026-01-25 18:03:22
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=2048, max_num_seqs=16
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 2048 --max-num-seqs 16 --max-model-len 1025 --max-num-batched-tokens 16384 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Llama3.2-1B-INT8_M16384.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 18:03:44 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 18:03:45 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=228985) WARNING 01-25 18:03:51 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=228985) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=228985) WARNING 01-25 18:03:59 [backends.py:609] Failed to read file <frozen os>
Throughput: 103.03 requests/s, 105607.16 total tokens/s, 103.03 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048

STDERR:
[2026-01-25 18:03:44] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:03:44] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 18:03:44] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 18:03:44] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:03:44] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:03:44] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:03:44] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:03:44] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:03:44] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 18:03:44] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:03:44] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:03:44] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:03:44] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:03:44] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 18:03:50] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:03:50] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 18:03:50] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 18:03:50] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:03:50] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:03:50] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:03:50] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:03:50] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:03:50] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 18:03:50] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:03:50] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:03:50] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:03:50] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:03:50] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=228985) [2026-01-25 18:03:52] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=228985) [2026-01-25 18:03:52] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=228985) [2026-01-25 18:03:52] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=228985) [2026-01-25 18:03:52] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=228985) [2026-01-25 18:03:52] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-1B-INT8
(EngineCore_DP0 pid=228985) [2026-01-25 18:03:52] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=228985) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=228985) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.71it/s]
(EngineCore_DP0 pid=228985) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.71it/s]
(EngineCore_DP0 pid=228985) 
(EngineCore_DP0 pid=228985) [2026-01-25 18:03:52] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 2752] -> 1D uint8
(EngineCore_DP0 pid=228985) [2026-01-25 18:03:52] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 6389760 bytes
(EngineCore_DP0 pid=228985) [2026-01-25 18:03:52] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 2752] -> 1D uint8
(EngineCore_DP0 pid=228985) [2026-01-25 18:03:52] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4259840 bytes
(EngineCore_DP0 pid=228985) [2026-01-25 18:03:52] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 2752] -> 1D uint8
(EngineCore_DP0 pid=228985) [2026-01-25 18:03:52] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 34078720 bytes
(EngineCore_DP0 pid=228985) [2026-01-25 18:03:52] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 10944] -> 1D uint8
(EngineCore_DP0 pid=228985) [2026-01-25 18:03:52] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 16842752 bytes
(EngineCore_DP0 pid=228985) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  14%|█▍        | 1/7 [00:00<00:00,  8.96it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  29%|██▊       | 2/7 [00:00<00:00,  9.43it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  57%|█████▋    | 4/7 [00:00<00:00,  9.88it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  86%|████████▌ | 6/7 [00:00<00:00, 10.05it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00,  9.34it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00,  9.52it/s]
(EngineCore_DP0 pid=228985) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  20%|██        | 1/5 [00:00<00:00,  7.56it/s]
Capturing CUDA graphs (decode, FULL):  60%|██████    | 3/5 [00:00<00:00,  9.23it/s]
Capturing CUDA graphs (decode, FULL):  80%|████████  | 4/5 [00:00<00:00,  9.42it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00,  9.59it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00,  9.34it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   1%|▏         | 29/2048 [00:00<00:07, 285.45it/s]
Adding requests:   3%|▎         | 59/2048 [00:00<00:06, 293.03it/s]
Adding requests:   4%|▍         | 91/2048 [00:00<00:06, 302.11it/s]
Adding requests:   6%|▌         | 123/2048 [00:00<00:06, 307.61it/s]
Adding requests:   8%|▊         | 154/2048 [00:00<00:06, 303.99it/s]
Adding requests:   9%|▉         | 185/2048 [00:00<00:06, 305.89it/s]
Adding requests:  11%|█         | 217/2048 [00:00<00:05, 307.25it/s]
Adding requests:  12%|█▏        | 249/2048 [00:00<00:05, 310.55it/s]
Adding requests:  14%|█▎        | 281/2048 [00:00<00:05, 310.53it/s]
Adding requests:  15%|█▌        | 313/2048 [00:01<00:05, 311.76it/s]
Adding requests:  17%|█▋        | 345/2048 [00:01<00:05, 308.93it/s]
Adding requests:  18%|█▊        | 377/2048 [00:01<00:05, 311.69it/s]
Adding requests:  20%|█▉        | 409/2048 [00:01<00:05, 310.31it/s]
Adding requests:  22%|██▏       | 441/2048 [00:01<00:05, 308.19it/s]
Adding requests:  23%|██▎       | 473/2048 [00:01<00:05, 310.59it/s]
Adding requests:  25%|██▍       | 505/2048 [00:01<00:04, 310.28it/s]
Adding requests:  26%|██▌       | 537/2048 [00:01<00:04, 305.41it/s]
Adding requests:  28%|██▊       | 570/2048 [00:01<00:04, 312.42it/s]
Adding requests:  29%|██▉       | 602/2048 [00:01<00:04, 307.24it/s]
Adding requests:  31%|███       | 637/2048 [00:02<00:04, 317.38it/s]
Adding requests:  33%|███▎      | 672/2048 [00:02<00:04, 324.86it/s]
Adding requests:  35%|███▍      | 707/2048 [00:02<00:04, 330.80it/s]
Adding requests:  36%|███▌      | 741/2048 [00:02<00:03, 327.85it/s]
Adding requests:  38%|███▊      | 775/2048 [00:02<00:03, 329.49it/s]
Adding requests:  39%|███▉      | 808/2048 [00:02<00:03, 321.00it/s]
Adding requests:  41%|████      | 841/2048 [00:02<00:03, 311.73it/s]
Adding requests:  43%|████▎     | 875/2048 [00:02<00:03, 318.03it/s]
Adding requests:  44%|████▍     | 911/2048 [00:02<00:03, 328.89it/s]
Adding requests:  46%|████▌     | 946/2048 [00:02<00:03, 333.07it/s]
Adding requests:  48%|████▊     | 980/2048 [00:03<00:03, 329.49it/s]
Adding requests:  50%|████▉     | 1015/2048 [00:03<00:03, 333.76it/s]
Adding requests:  51%|█████▏    | 1051/2048 [00:03<00:02, 338.59it/s]
Adding requests:  53%|█████▎    | 1085/2048 [00:03<00:02, 335.63it/s]
Adding requests:  55%|█████▍    | 1119/2048 [00:03<00:02, 329.35it/s]
Adding requests:  56%|█████▋    | 1155/2048 [00:03<00:02, 337.28it/s]
Adding requests:  58%|█████▊    | 1193/2048 [00:03<00:02, 348.47it/s]
Adding requests:  60%|█████▉    | 1228/2048 [00:03<00:02, 345.42it/s]
Adding requests:  62%|██████▏   | 1263/2048 [00:03<00:02, 344.74it/s]
Adding requests:  63%|██████▎   | 1299/2048 [00:04<00:02, 347.13it/s]
Adding requests:  65%|██████▌   | 1337/2048 [00:04<00:02, 354.93it/s]
Adding requests:  67%|██████▋   | 1374/2048 [00:04<00:01, 356.64it/s]
Adding requests:  69%|██████▉   | 1411/2048 [00:04<00:01, 359.93it/s]
Adding requests:  71%|███████   | 1448/2048 [00:04<00:01, 355.98it/s]
Adding requests:  72%|███████▏  | 1484/2048 [00:04<00:01, 350.61it/s]
Adding requests:  74%|███████▍  | 1521/2048 [00:04<00:01, 353.21it/s]
Adding requests:  76%|███████▌  | 1558/2048 [00:04<00:01, 358.06it/s]
Adding requests:  78%|███████▊  | 1595/2048 [00:04<00:01, 361.17it/s]
Adding requests:  80%|███████▉  | 1632/2048 [00:04<00:01, 357.47it/s]
Adding requests:  81%|████████▏ | 1668/2048 [00:05<00:01, 349.89it/s]
Adding requests:  83%|████████▎ | 1704/2048 [00:05<00:00, 347.93it/s]
Adding requests:  85%|████████▍ | 1739/2048 [00:05<00:00, 347.76it/s]
Adding requests:  87%|████████▋ | 1774/2048 [00:05<00:00, 342.38it/s]
Adding requests:  88%|████████▊ | 1809/2048 [00:05<00:00, 343.52it/s]
Adding requests:  90%|█████████ | 1844/2048 [00:05<00:00, 330.46it/s]
Adding requests:  92%|█████████▏| 1878/2048 [00:05<00:00, 322.35it/s]
Adding requests:  93%|█████████▎| 1911/2048 [00:05<00:00, 316.25it/s]
Adding requests:  95%|█████████▍| 1945/2048 [00:05<00:00, 320.73it/s]
Adding requests:  97%|█████████▋| 1978/2048 [00:06<00:00, 310.91it/s]
Adding requests:  98%|█████████▊| 2013/2048 [00:06<00:00, 319.34it/s]
Adding requests: 100%|█████████▉| 2046/2048 [00:06<00:00, 321.35it/s]
Adding requests: 100%|██████████| 2048/2048 [00:06<00:00, 328.21it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  31%|███       | 626/2048 [00:00<00:00, 3509.38it/s, est. speed input: 3594311.89 toks/s, output: 3509.71 toks/s]
Processed prompts:  48%|████▊     | 977/2048 [00:01<00:02, 447.81it/s, est. speed input: 550946.70 toks/s, output: 538.03 toks/s]   
Processed prompts:  55%|█████▌    | 1135/2048 [00:03<00:03, 255.03it/s, est. speed input: 345089.58 toks/s, output: 337.00 toks/s]
Processed prompts:  60%|█████▉    | 1226/2048 [00:04<00:04, 204.22it/s, est. speed input: 292051.76 toks/s, output: 285.21 toks/s]
Processed prompts:  63%|██████▎   | 1285/2048 [00:04<00:04, 181.53it/s, est. speed input: 269875.56 toks/s, output: 263.55 toks/s]
Processed prompts:  65%|██████▍   | 1326/2048 [00:05<00:04, 176.08it/s, est. speed input: 262898.20 toks/s, output: 256.74 toks/s]
Processed prompts:  66%|██████▋   | 1358/2048 [00:05<00:04, 165.48it/s, est. speed input: 255036.73 toks/s, output: 249.06 toks/s]
Processed prompts:  68%|██████▊   | 1384/2048 [00:05<00:04, 151.22it/s, est. speed input: 246873.00 toks/s, output: 241.09 toks/s]
Processed prompts:  69%|██████▊   | 1404/2048 [00:05<00:04, 149.75it/s, est. speed input: 244310.24 toks/s, output: 238.58 toks/s]
Processed prompts:  69%|██████▉   | 1423/2048 [00:06<00:04, 147.17it/s, est. speed input: 241705.28 toks/s, output: 236.04 toks/s]
Processed prompts:  70%|███████   | 1440/2048 [00:06<00:04, 142.14it/s, est. speed input: 238882.47 toks/s, output: 233.28 toks/s]
Processed prompts:  71%|███████   | 1456/2048 [00:06<00:04, 136.05it/s, est. speed input: 236035.48 toks/s, output: 230.50 toks/s]
Processed prompts:  72%|███████▏  | 1470/2048 [00:06<00:04, 127.58it/s, est. speed input: 233006.62 toks/s, output: 227.55 toks/s]
Processed prompts:  72%|███████▏  | 1483/2048 [00:06<00:04, 118.65it/s, est. speed input: 229939.32 toks/s, output: 224.55 toks/s]
Processed prompts:  73%|███████▎  | 1495/2048 [00:06<00:05, 109.58it/s, est. speed input: 226840.82 toks/s, output: 221.52 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [00:06<00:05, 100.44it/s, est. speed input: 223686.06 toks/s, output: 218.44 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [00:07<00:05, 103.33it/s, est. speed input: 221430.24 toks/s, output: 216.24 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [00:07<00:04, 105.43it/s, est. speed input: 219257.45 toks/s, output: 214.12 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [00:07<00:04, 106.03it/s, est. speed input: 217039.50 toks/s, output: 211.95 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [00:07<00:04, 104.69it/s, est. speed input: 214666.76 toks/s, output: 209.63 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [00:07<00:04, 103.98it/s, est. speed input: 212420.88 toks/s, output: 207.44 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [00:07<00:04, 103.49it/s, est. speed input: 210265.07 toks/s, output: 205.34 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [00:07<00:04, 103.30it/s, est. speed input: 208213.18 toks/s, output: 203.33 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [00:08<00:04, 103.09it/s, est. speed input: 206230.81 toks/s, output: 201.40 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [00:08<00:03, 102.87it/s, est. speed input: 204314.14 toks/s, output: 199.52 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [00:08<00:03, 102.85it/s, est. speed input: 202484.28 toks/s, output: 197.74 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [00:08<00:03, 102.86it/s, est. speed input: 200723.76 toks/s, output: 196.02 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [00:08<00:03, 102.80it/s, est. speed input: 199018.90 toks/s, output: 194.35 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [00:08<00:03, 102.73it/s, est. speed input: 197369.87 toks/s, output: 192.74 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [00:09<00:03, 102.68it/s, est. speed input: 195777.93 toks/s, output: 191.19 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [00:09<00:02, 102.57it/s, est. speed input: 194232.08 toks/s, output: 189.68 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [00:09<00:02, 102.63it/s, est. speed input: 192751.36 toks/s, output: 188.23 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [00:09<00:02, 102.60it/s, est. speed input: 191312.93 toks/s, output: 186.83 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [00:09<00:02, 102.56it/s, est. speed input: 189918.03 toks/s, output: 185.47 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [00:09<00:02, 102.37it/s, est. speed input: 188552.50 toks/s, output: 184.13 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [00:09<00:02, 102.31it/s, est. speed input: 187236.17 toks/s, output: 182.85 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [00:10<00:02, 102.28it/s, est. speed input: 185961.43 toks/s, output: 181.60 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [00:10<00:01, 102.27it/s, est. speed input: 184726.85 toks/s, output: 180.40 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [00:10<00:01, 103.87it/s, est. speed input: 183671.09 toks/s, output: 179.37 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [00:10<00:01, 103.33it/s, est. speed input: 182501.50 toks/s, output: 178.22 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [00:10<00:01, 102.97it/s, est. speed input: 181367.50 toks/s, output: 177.12 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [00:10<00:01, 102.61it/s, est. speed input: 180256.74 toks/s, output: 176.03 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [00:11<00:01, 102.45it/s, est. speed input: 179185.26 toks/s, output: 174.99 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [00:11<00:00, 103.96it/s, est. speed input: 178272.53 toks/s, output: 174.09 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [00:11<00:00, 103.36it/s, est. speed input: 177254.32 toks/s, output: 173.10 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [00:11<00:00, 102.96it/s, est. speed input: 176265.11 toks/s, output: 172.13 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [00:11<00:00, 102.65it/s, est. speed input: 175300.60 toks/s, output: 171.19 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [00:11<00:00, 102.44it/s, est. speed input: 174361.93 toks/s, output: 170.27 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [00:11<00:00, 104.21it/s, est. speed input: 173586.25 toks/s, output: 169.52 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:11<00:00, 104.21it/s, est. speed input: 174775.49 toks/s, output: 170.68 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:11<00:00, 170.68it/s, est. speed input: 174775.49 toks/s, output: 170.68 toks/s]
[rank0]:[W125 18:04:31.487438989 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=32768 ==========
Time: 2026-01-25 18:04:34
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=4096, max_num_seqs=32
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 4096 --max-num-seqs 32 --max-model-len 1025 --max-num-batched-tokens 32768 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Llama3.2-1B-INT8_M32768.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 18:05:07 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 18:05:09 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=230417) WARNING 01-25 18:05:16 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=230417) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=230417) WARNING 01-25 18:05:22 [backends.py:609] Failed to read file <frozen os>
Throughput: 104.54 requests/s, 107150.65 total tokens/s, 104.54 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096

STDERR:
[2026-01-25 18:05:07] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:05:07] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 18:05:07] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 18:05:07] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:05:07] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:05:07] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:05:07] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:05:07] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:05:07] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 18:05:07] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:05:07] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:05:07] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:05:07] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:05:07] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 18:05:16] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:05:16] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 18:05:16] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 18:05:16] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:05:16] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:05:16] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:05:16] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:05:16] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:05:16] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 18:05:16] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:05:16] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:05:16] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:05:16] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:05:16] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=230417) [2026-01-25 18:05:17] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=230417) [2026-01-25 18:05:17] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=230417) [2026-01-25 18:05:17] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=230417) [2026-01-25 18:05:17] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=230417) [2026-01-25 18:05:17] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-1B-INT8
(EngineCore_DP0 pid=230417) [2026-01-25 18:05:17] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=230417) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=230417) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.52it/s]
(EngineCore_DP0 pid=230417) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.52it/s]
(EngineCore_DP0 pid=230417) 
(EngineCore_DP0 pid=230417) [2026-01-25 18:05:18] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 2752] -> 1D uint8
(EngineCore_DP0 pid=230417) [2026-01-25 18:05:18] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 6389760 bytes
(EngineCore_DP0 pid=230417) [2026-01-25 18:05:18] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 2752] -> 1D uint8
(EngineCore_DP0 pid=230417) [2026-01-25 18:05:18] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4259840 bytes
(EngineCore_DP0 pid=230417) [2026-01-25 18:05:18] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 2752] -> 1D uint8
(EngineCore_DP0 pid=230417) [2026-01-25 18:05:18] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 34078720 bytes
(EngineCore_DP0 pid=230417) [2026-01-25 18:05:18] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 10944] -> 1D uint8
(EngineCore_DP0 pid=230417) [2026-01-25 18:05:18] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 16842752 bytes
(EngineCore_DP0 pid=230417) [rank0]:W0125 18:05:28.226000 230417 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=230417) [rank0]:W0125 18:05:28.310000 230417 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=230417) [rank0]:W0125 18:05:29.414000 230417 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=230417) [rank0]:W0125 18:05:29.520000 230417 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=230417) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   9%|▉         | 1/11 [00:00<00:01,  7.99it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  18%|█▊        | 2/11 [00:00<00:01,  8.10it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  27%|██▋       | 3/11 [00:00<00:00,  8.43it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  36%|███▋      | 4/11 [00:00<00:00,  8.64it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  45%|████▌     | 5/11 [00:00<00:00,  8.76it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  55%|█████▍    | 6/11 [00:00<00:00,  8.91it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  64%|██████▎   | 7/11 [00:00<00:00,  8.81it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  73%|███████▎  | 8/11 [00:00<00:00,  8.96it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  82%|████████▏ | 9/11 [00:01<00:00,  9.09it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  91%|█████████ | 10/11 [00:01<00:00,  9.13it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00,  8.42it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00,  8.66it/s]
(EngineCore_DP0 pid=230417) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  14%|█▍        | 1/7 [00:00<00:00,  6.60it/s]
Capturing CUDA graphs (decode, FULL):  29%|██▊       | 2/7 [00:00<00:00,  7.23it/s]
Capturing CUDA graphs (decode, FULL):  43%|████▎     | 3/7 [00:00<00:00,  6.89it/s]
Capturing CUDA graphs (decode, FULL):  57%|█████▋    | 4/7 [00:00<00:00,  7.74it/s]
Capturing CUDA graphs (decode, FULL):  71%|███████▏  | 5/7 [00:00<00:00,  7.64it/s]
Capturing CUDA graphs (decode, FULL):  86%|████████▌ | 6/7 [00:00<00:00,  5.93it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:01<00:00,  6.73it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:01<00:00,  6.85it/s]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   1%|          | 31/4096 [00:00<00:13, 308.72it/s]
Adding requests:   2%|▏         | 65/4096 [00:00<00:12, 321.50it/s]
Adding requests:   2%|▏         | 99/4096 [00:00<00:12, 328.82it/s]
Adding requests:   3%|▎         | 134/4096 [00:00<00:11, 334.40it/s]
Adding requests:   4%|▍         | 168/4096 [00:00<00:12, 324.90it/s]
Adding requests:   5%|▍         | 201/4096 [00:00<00:12, 319.36it/s]
Adding requests:   6%|▌         | 234/4096 [00:00<00:12, 321.70it/s]
Adding requests:   7%|▋         | 269/4096 [00:00<00:11, 327.60it/s]
Adding requests:   7%|▋         | 302/4096 [00:00<00:11, 325.14it/s]
Adding requests:   8%|▊         | 335/4096 [00:01<00:11, 326.27it/s]
Adding requests:   9%|▉         | 368/4096 [00:01<00:11, 326.78it/s]
Adding requests:  10%|▉         | 401/4096 [00:01<00:11, 319.65it/s]
Adding requests:  11%|█         | 434/4096 [00:01<00:11, 307.12it/s]
Adding requests:  11%|█▏        | 466/4096 [00:01<00:11, 309.09it/s]
Adding requests:  12%|█▏        | 498/4096 [00:01<00:11, 307.80it/s]
Adding requests:  13%|█▎        | 529/4096 [00:01<00:11, 297.72it/s]
Adding requests:  14%|█▎        | 563/4096 [00:01<00:11, 309.44it/s]
Adding requests:  15%|█▍        | 595/4096 [00:01<00:11, 308.81it/s]
Adding requests:  15%|█▌        | 628/4096 [00:01<00:11, 313.83it/s]
Adding requests:  16%|█▌        | 662/4096 [00:02<00:10, 318.72it/s]
Adding requests:  17%|█▋        | 696/4096 [00:02<00:10, 323.10it/s]
Adding requests:  18%|█▊        | 730/4096 [00:02<00:10, 326.57it/s]
Adding requests:  19%|█▊        | 763/4096 [00:02<00:10, 324.85it/s]
Adding requests:  19%|█▉        | 796/4096 [00:02<00:10, 318.59it/s]
Adding requests:  20%|██        | 828/4096 [00:02<00:10, 312.12it/s]
Adding requests:  21%|██        | 860/4096 [00:02<00:10, 311.58it/s]
Adding requests:  22%|██▏       | 893/4096 [00:02<00:10, 316.12it/s]
Adding requests:  23%|██▎       | 926/4096 [00:02<00:09, 320.17it/s]
Adding requests:  23%|██▎       | 960/4096 [00:03<00:09, 323.88it/s]
Adding requests:  24%|██▍       | 993/4096 [00:03<00:09, 324.18it/s]
Adding requests:  25%|██▌       | 1027/4096 [00:03<00:09, 328.32it/s]
Adding requests:  26%|██▌       | 1061/4096 [00:03<00:09, 329.94it/s]
Adding requests:  27%|██▋       | 1095/4096 [00:03<00:09, 321.19it/s]
Adding requests:  28%|██▊       | 1128/4096 [00:03<00:09, 317.28it/s]
Adding requests:  28%|██▊       | 1160/4096 [00:03<00:09, 309.26it/s]
Adding requests:  29%|██▉       | 1191/4096 [00:03<00:09, 307.61it/s]
Adding requests:  30%|██▉       | 1224/4096 [00:03<00:09, 310.95it/s]
Adding requests:  31%|███       | 1256/4096 [00:03<00:09, 305.54it/s]
Adding requests:  31%|███▏      | 1288/4096 [00:04<00:09, 307.57it/s]
Adding requests:  32%|███▏      | 1322/4096 [00:04<00:08, 314.41it/s]
Adding requests:  33%|███▎      | 1356/4096 [00:04<00:08, 319.30it/s]
Adding requests:  34%|███▍      | 1389/4096 [00:04<00:08, 320.02it/s]
Adding requests:  35%|███▍      | 1422/4096 [00:04<00:08, 319.38it/s]
Adding requests:  35%|███▌      | 1454/4096 [00:04<00:08, 316.80it/s]
Adding requests:  36%|███▋      | 1487/4096 [00:04<00:08, 318.46it/s]
Adding requests:  37%|███▋      | 1521/4096 [00:04<00:07, 322.13it/s]
Adding requests:  38%|███▊      | 1554/4096 [00:04<00:07, 317.98it/s]
Adding requests:  39%|███▉      | 1589/4096 [00:04<00:07, 324.90it/s]
Adding requests:  40%|███▉      | 1623/4096 [00:05<00:07, 329.15it/s]
Adding requests:  40%|████      | 1657/4096 [00:05<00:07, 329.53it/s]
Adding requests:  41%|████▏     | 1690/4096 [00:05<00:07, 324.91it/s]
Adding requests:  42%|████▏     | 1724/4096 [00:05<00:07, 327.55it/s]
Adding requests:  43%|████▎     | 1757/4096 [00:05<00:07, 322.82it/s]
Adding requests:  44%|████▎     | 1790/4096 [00:05<00:07, 324.46it/s]
Adding requests:  45%|████▍     | 1823/4096 [00:05<00:07, 324.34it/s]
Adding requests:  45%|████▌     | 1856/4096 [00:05<00:06, 325.52it/s]
Adding requests:  46%|████▌     | 1889/4096 [00:05<00:06, 319.55it/s]
Adding requests:  47%|████▋     | 1921/4096 [00:06<00:06, 318.38it/s]
Adding requests:  48%|████▊     | 1954/4096 [00:06<00:06, 321.61it/s]
Adding requests:  49%|████▊     | 1988/4096 [00:06<00:06, 325.03it/s]
Adding requests:  49%|████▉     | 2022/4096 [00:06<00:06, 328.95it/s]
Adding requests:  50%|█████     | 2059/4096 [00:06<00:05, 340.08it/s]
Adding requests:  51%|█████     | 2095/4096 [00:06<00:05, 344.21it/s]
Adding requests:  52%|█████▏    | 2130/4096 [00:06<00:05, 342.89it/s]
Adding requests:  53%|█████▎    | 2165/4096 [00:06<00:05, 344.58it/s]
Adding requests:  54%|█████▎    | 2200/4096 [00:06<00:05, 342.82it/s]
Adding requests:  55%|█████▍    | 2235/4096 [00:06<00:05, 336.87it/s]
Adding requests:  55%|█████▌    | 2269/4096 [00:07<00:05, 337.76it/s]
Adding requests:  56%|█████▋    | 2304/4096 [00:07<00:05, 340.62it/s]
Adding requests:  57%|█████▋    | 2339/4096 [00:07<00:05, 329.70it/s]
Adding requests:  58%|█████▊    | 2374/4096 [00:07<00:05, 335.31it/s]
Adding requests:  59%|█████▉    | 2409/4096 [00:07<00:05, 337.10it/s]
Adding requests:  60%|█████▉    | 2443/4096 [00:07<00:04, 337.10it/s]
Adding requests:  60%|██████    | 2477/4096 [00:07<00:04, 333.73it/s]
Adding requests:  61%|██████▏   | 2511/4096 [00:07<00:04, 330.30it/s]
Adding requests:  62%|██████▏   | 2547/4096 [00:07<00:04, 338.26it/s]
Adding requests:  63%|██████▎   | 2582/4096 [00:07<00:04, 340.72it/s]
Adding requests:  64%|██████▍   | 2617/4096 [00:08<00:04, 334.94it/s]
Adding requests:  65%|██████▍   | 2654/4096 [00:08<00:04, 344.13it/s]
Adding requests:  66%|██████▌   | 2689/4096 [00:08<00:04, 342.78it/s]
Adding requests:  67%|██████▋   | 2725/4096 [00:08<00:03, 345.93it/s]
Adding requests:  67%|██████▋   | 2761/4096 [00:08<00:03, 349.65it/s]
Adding requests:  68%|██████▊   | 2796/4096 [00:08<00:03, 345.92it/s]
Adding requests:  69%|██████▉   | 2832/4096 [00:08<00:03, 348.11it/s]
Adding requests:  70%|███████   | 2868/4096 [00:08<00:03, 349.92it/s]
Adding requests:  71%|███████   | 2904/4096 [00:08<00:03, 348.28it/s]
Adding requests:  72%|███████▏  | 2939/4096 [00:09<00:03, 345.02it/s]
Adding requests:  73%|███████▎  | 2974/4096 [00:09<00:03, 346.22it/s]
Adding requests:  73%|███████▎  | 3009/4096 [00:09<00:03, 336.31it/s]
Adding requests:  74%|███████▍  | 3043/4096 [00:09<00:03, 331.36it/s]
Adding requests:  75%|███████▌  | 3077/4096 [00:09<00:03, 326.74it/s]
Adding requests:  76%|███████▌  | 3110/4096 [00:09<00:03, 326.14it/s]
Adding requests:  77%|███████▋  | 3143/4096 [00:09<00:02, 322.58it/s]
Adding requests:  78%|███████▊  | 3176/4096 [00:09<00:02, 323.88it/s]
Adding requests:  78%|███████▊  | 3209/4096 [00:09<00:02, 320.04it/s]
Adding requests:  79%|███████▉  | 3242/4096 [00:09<00:02, 317.77it/s]
Adding requests:  80%|███████▉  | 3274/4096 [00:10<00:02, 314.41it/s]
Adding requests:  81%|████████  | 3306/4096 [00:10<00:02, 311.48it/s]
Adding requests:  81%|████████▏ | 3338/4096 [00:10<00:02, 311.00it/s]
Adding requests:  82%|████████▏ | 3370/4096 [00:10<00:02, 311.30it/s]
Adding requests:  83%|████████▎ | 3402/4096 [00:10<00:02, 309.83it/s]
Adding requests:  84%|████████▍ | 3435/4096 [00:10<00:02, 315.49it/s]
Adding requests:  85%|████████▍ | 3467/4096 [00:10<00:02, 311.08it/s]
Adding requests:  85%|████████▌ | 3499/4096 [00:10<00:01, 310.38it/s]
Adding requests:  86%|████████▌ | 3531/4096 [00:10<00:01, 310.77it/s]
Adding requests:  87%|████████▋ | 3564/4096 [00:10<00:01, 313.71it/s]
Adding requests:  88%|████████▊ | 3597/4096 [00:11<00:01, 317.76it/s]
Adding requests:  89%|████████▊ | 3630/4096 [00:11<00:01, 318.59it/s]
Adding requests:  89%|████████▉ | 3662/4096 [00:11<00:01, 306.58it/s]
Adding requests:  90%|█████████ | 3695/4096 [00:11<00:01, 312.06it/s]
Adding requests:  91%|█████████ | 3727/4096 [00:11<00:01, 313.59it/s]
Adding requests:  92%|█████████▏| 3760/4096 [00:11<00:01, 317.03it/s]
Adding requests:  93%|█████████▎| 3793/4096 [00:11<00:00, 318.38it/s]
Adding requests:  93%|█████████▎| 3826/4096 [00:11<00:00, 321.01it/s]
Adding requests:  94%|█████████▍| 3861/4096 [00:11<00:00, 328.04it/s]
Adding requests:  95%|█████████▌| 3894/4096 [00:12<00:00, 324.49it/s]
Adding requests:  96%|█████████▌| 3927/4096 [00:12<00:00, 323.17it/s]
Adding requests:  97%|█████████▋| 3960/4096 [00:12<00:00, 322.62it/s]
Adding requests:  97%|█████████▋| 3993/4096 [00:12<00:00, 317.01it/s]
Adding requests:  98%|█████████▊| 4027/4096 [00:12<00:00, 321.34it/s]
Adding requests:  99%|█████████▉| 4060/4096 [00:12<00:00, 312.71it/s]
Adding requests: 100%|█████████▉| 4092/4096 [00:12<00:00, 311.45it/s]
Adding requests: 100%|██████████| 4096/4096 [00:12<00:00, 323.62it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  31%|███▏      | 1280/4096 [00:00<00:00, 7363.34it/s, est. speed input: 7541200.98 toks/s, output: 7363.68 toks/s]
Processed prompts:  49%|████▉     | 2017/4096 [00:05<00:06, 308.38it/s, est. speed input: 386239.75 toks/s, output: 377.18 toks/s]   
Processed prompts:  57%|█████▋    | 2329/4096 [00:08<00:07, 224.19it/s, est. speed input: 293301.92 toks/s, output: 286.43 toks/s]
Processed prompts:  61%|██████    | 2504/4096 [00:09<00:08, 186.51it/s, est. speed input: 256732.75 toks/s, output: 250.72 toks/s]
Processed prompts:  64%|██████▍   | 2614/4096 [00:10<00:08, 177.13it/s, est. speed input: 246805.02 toks/s, output: 241.02 toks/s]
Processed prompts:  66%|██████▌   | 2689/4096 [00:11<00:08, 160.12it/s, est. speed input: 235122.99 toks/s, output: 229.61 toks/s]
Processed prompts:  67%|██████▋   | 2742/4096 [00:12<00:08, 162.03it/s, est. speed input: 233980.82 toks/s, output: 228.50 toks/s]
Processed prompts:  68%|██████▊   | 2784/4096 [00:12<00:09, 144.74it/s, est. speed input: 226546.35 toks/s, output: 221.24 toks/s]
Processed prompts:  69%|██████▉   | 2816/4096 [00:12<00:09, 139.31it/s, est. speed input: 223595.42 toks/s, output: 218.35 toks/s]
Processed prompts:  70%|██████▉   | 2848/4096 [00:13<00:09, 133.57it/s, est. speed input: 220778.30 toks/s, output: 215.60 toks/s]
Processed prompts:  70%|███████   | 2880/4096 [00:13<00:09, 127.90it/s, est. speed input: 218091.97 toks/s, output: 212.98 toks/s]
Processed prompts:  71%|███████   | 2912/4096 [00:13<00:09, 122.69it/s, est. speed input: 215538.70 toks/s, output: 210.49 toks/s]
Processed prompts:  72%|███████▏  | 2944/4096 [00:14<00:09, 118.03it/s, est. speed input: 213082.95 toks/s, output: 208.09 toks/s]
Processed prompts:  73%|███████▎  | 2976/4096 [00:14<00:09, 114.20it/s, est. speed input: 210743.62 toks/s, output: 205.80 toks/s]
Processed prompts:  73%|███████▎  | 3008/4096 [00:14<00:09, 111.30it/s, est. speed input: 208527.60 toks/s, output: 203.64 toks/s]
Processed prompts:  74%|███████▍  | 3040/4096 [00:15<00:09, 108.71it/s, est. speed input: 206352.72 toks/s, output: 201.52 toks/s]
Processed prompts:  75%|███████▌  | 3072/4096 [00:15<00:09, 106.95it/s, est. speed input: 204292.30 toks/s, output: 199.50 toks/s]
Processed prompts:  76%|███████▌  | 3104/4096 [00:15<00:09, 105.67it/s, est. speed input: 202316.49 toks/s, output: 197.57 toks/s]
Processed prompts:  77%|███████▋  | 3136/4096 [00:16<00:09, 105.53it/s, est. speed input: 200518.48 toks/s, output: 195.82 toks/s]
Processed prompts:  77%|███████▋  | 3168/4096 [00:16<00:08, 104.58it/s, est. speed input: 198684.28 toks/s, output: 194.03 toks/s]
Processed prompts:  78%|███████▊  | 3200/4096 [00:16<00:08, 103.90it/s, est. speed input: 196917.73 toks/s, output: 192.30 toks/s]
Processed prompts:  79%|███████▉  | 3232/4096 [00:16<00:08, 103.49it/s, est. speed input: 195224.46 toks/s, output: 190.65 toks/s]
Processed prompts:  80%|███████▉  | 3264/4096 [00:17<00:08, 103.12it/s, est. speed input: 193583.43 toks/s, output: 189.05 toks/s]
Processed prompts:  80%|████████  | 3296/4096 [00:17<00:07, 102.87it/s, est. speed input: 192002.74 toks/s, output: 187.50 toks/s]
Processed prompts:  81%|████████▏ | 3328/4096 [00:17<00:07, 103.09it/s, est. speed input: 190518.84 toks/s, output: 186.05 toks/s]
Processed prompts:  82%|████████▏ | 3360/4096 [00:18<00:06, 105.30it/s, est. speed input: 189297.17 toks/s, output: 184.86 toks/s]
Processed prompts:  83%|████████▎ | 3392/4096 [00:18<00:06, 106.91it/s, est. speed input: 188112.72 toks/s, output: 183.70 toks/s]
Processed prompts:  84%|████████▎ | 3424/4096 [00:18<00:06, 108.05it/s, est. speed input: 186964.08 toks/s, output: 182.58 toks/s]
Processed prompts:  84%|████████▍ | 3456/4096 [00:19<00:05, 108.87it/s, est. speed input: 185849.92 toks/s, output: 181.49 toks/s]
Processed prompts:  85%|████████▌ | 3488/4096 [00:19<00:05, 109.51it/s, est. speed input: 184774.69 toks/s, output: 180.44 toks/s]
Processed prompts:  86%|████████▌ | 3520/4096 [00:19<00:05, 109.96it/s, est. speed input: 183729.65 toks/s, output: 179.42 toks/s]
Processed prompts:  87%|████████▋ | 3552/4096 [00:19<00:04, 110.22it/s, est. speed input: 182711.50 toks/s, output: 178.43 toks/s]
Processed prompts:  88%|████████▊ | 3584/4096 [00:20<00:04, 110.42it/s, est. speed input: 181722.97 toks/s, output: 177.46 toks/s]
Processed prompts:  88%|████████▊ | 3616/4096 [00:20<00:04, 110.58it/s, est. speed input: 180763.90 toks/s, output: 176.53 toks/s]
Processed prompts:  89%|████████▉ | 3648/4096 [00:20<00:04, 108.32it/s, est. speed input: 179649.45 toks/s, output: 175.44 toks/s]
Processed prompts:  90%|████████▉ | 3680/4096 [00:21<00:03, 106.42it/s, est. speed input: 178537.57 toks/s, output: 174.35 toks/s]
Processed prompts:  91%|█████████ | 3712/4096 [00:21<00:03, 105.15it/s, est. speed input: 177460.14 toks/s, output: 173.30 toks/s]
Processed prompts:  91%|█████████▏| 3744/4096 [00:21<00:03, 105.17it/s, est. speed input: 176483.77 toks/s, output: 172.35 toks/s]
Processed prompts:  92%|█████████▏| 3776/4096 [00:22<00:03, 104.32it/s, est. speed input: 175467.96 toks/s, output: 171.36 toks/s]
Processed prompts:  93%|█████████▎| 3808/4096 [00:22<00:02, 103.72it/s, est. speed input: 174479.17 toks/s, output: 170.39 toks/s]
Processed prompts:  94%|█████████▍| 3840/4096 [00:22<00:02, 103.31it/s, est. speed input: 173518.05 toks/s, output: 169.45 toks/s]
Processed prompts:  95%|█████████▍| 3872/4096 [00:22<00:02, 103.02it/s, est. speed input: 172583.74 toks/s, output: 168.54 toks/s]
Processed prompts:  95%|█████████▌| 3904/4096 [00:23<00:01, 102.80it/s, est. speed input: 171671.60 toks/s, output: 167.65 toks/s]
Processed prompts:  96%|█████████▌| 3936/4096 [00:23<00:01, 102.79it/s, est. speed input: 170795.03 toks/s, output: 166.79 toks/s]
Processed prompts:  97%|█████████▋| 3968/4096 [00:23<00:01, 102.57it/s, est. speed input: 169925.91 toks/s, output: 165.94 toks/s]
Processed prompts:  98%|█████████▊| 4000/4096 [00:24<00:00, 102.52it/s, est. speed input: 169086.72 toks/s, output: 165.12 toks/s]
Processed prompts:  98%|█████████▊| 4032/4096 [00:24<00:00, 103.30it/s, est. speed input: 168324.93 toks/s, output: 164.38 toks/s]
Processed prompts:  99%|█████████▉| 4064/4096 [00:24<00:00, 103.41it/s, est. speed input: 167552.66 toks/s, output: 163.63 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [00:24<00:00, 103.41it/s, est. speed input: 168443.57 toks/s, output: 164.50 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [00:24<00:00, 164.49it/s, est. speed input: 168443.57 toks/s, output: 164.50 toks/s]
[rank0]:[W125 18:06:15.577191422 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=65536 ==========
Time: 2026-01-25 18:06:18
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=8192, max_num_seqs=64
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 8192 --max-num-seqs 64 --max-model-len 1025 --max-num-batched-tokens 65536 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Llama3.2-1B-INT8_M65536.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 18:07:17 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 18:07:18 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=232464) WARNING 01-25 18:07:25 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=232464) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=232464) WARNING 01-25 18:07:33 [backends.py:609] Failed to read file <frozen os>
Throughput: 106.07 requests/s, 108722.95 total tokens/s, 106.07 output tokens/s
Total num prompt tokens:  8388608
Total num output tokens:  8192

STDERR:
[2026-01-25 18:07:17] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:07:17] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 18:07:17] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 18:07:17] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:07:17] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:07:17] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:07:17] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:07:17] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:07:17] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 18:07:17] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:07:17] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:07:17] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:07:17] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:07:17] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 18:07:24] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:07:24] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 18:07:24] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 18:07:24] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:07:24] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:07:24] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:07:24] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:07:24] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 18:07:24] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 18:07:24] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:07:24] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:07:24] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:07:24] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:07:24] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=232464) [2026-01-25 18:07:25] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=232464) [2026-01-25 18:07:25] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=232464) [2026-01-25 18:07:25] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=232464) [2026-01-25 18:07:25] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=232464) [2026-01-25 18:07:25] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-1B-INT8
(EngineCore_DP0 pid=232464) [2026-01-25 18:07:25] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=232464) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=232464) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.39it/s]
(EngineCore_DP0 pid=232464) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.39it/s]
(EngineCore_DP0 pid=232464) 
(EngineCore_DP0 pid=232464) [2026-01-25 18:07:26] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 2752] -> 1D uint8
(EngineCore_DP0 pid=232464) [2026-01-25 18:07:26] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 6389760 bytes
(EngineCore_DP0 pid=232464) [2026-01-25 18:07:26] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 2752] -> 1D uint8
(EngineCore_DP0 pid=232464) [2026-01-25 18:07:26] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4259840 bytes
(EngineCore_DP0 pid=232464) [2026-01-25 18:07:26] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 2752] -> 1D uint8
(EngineCore_DP0 pid=232464) [2026-01-25 18:07:26] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 34078720 bytes
(EngineCore_DP0 pid=232464) [2026-01-25 18:07:26] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 10944] -> 1D uint8
(EngineCore_DP0 pid=232464) [2026-01-25 18:07:26] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 16842752 bytes
(EngineCore_DP0 pid=232464) [rank0]:W0125 18:07:38.638000 232464 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=232464) [rank0]:W0125 18:07:38.715000 232464 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=232464) [rank0]:W0125 18:07:39.833000 232464 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=232464) [rank0]:W0125 18:07:39.937000 232464 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=232464) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/19 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   5%|▌         | 1/19 [00:00<00:02,  8.62it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  11%|█         | 2/19 [00:00<00:01,  8.85it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  16%|█▌        | 3/19 [00:00<00:01,  8.72it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  21%|██        | 4/19 [00:00<00:01,  9.09it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  26%|██▋       | 5/19 [00:00<00:01,  9.24it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  32%|███▏      | 6/19 [00:00<00:01,  9.47it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  37%|███▋      | 7/19 [00:00<00:01,  7.17it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  42%|████▏     | 8/19 [00:00<00:01,  7.70it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  47%|████▋     | 9/19 [00:01<00:01,  6.63it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  53%|█████▎    | 10/19 [00:01<00:01,  6.57it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  63%|██████▎   | 12/19 [00:01<00:00,  7.95it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  74%|███████▎  | 14/19 [00:01<00:00,  8.89it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  84%|████████▍ | 16/19 [00:01<00:00,  9.48it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  95%|█████████▍| 18/19 [00:02<00:00,  9.93it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 19/19 [00:02<00:00,  9.55it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 19/19 [00:02<00:00,  8.68it/s]
(EngineCore_DP0 pid=232464) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):   9%|▉         | 1/11 [00:00<00:01,  8.15it/s]
Capturing CUDA graphs (decode, FULL):  27%|██▋       | 3/11 [00:00<00:00,  9.92it/s]
Capturing CUDA graphs (decode, FULL):  45%|████▌     | 5/11 [00:00<00:00, 10.57it/s]
Capturing CUDA graphs (decode, FULL):  64%|██████▎   | 7/11 [00:00<00:00, 10.74it/s]
Capturing CUDA graphs (decode, FULL):  82%|████████▏ | 9/11 [00:00<00:00, 10.91it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 11/11 [00:01<00:00, 10.91it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 11/11 [00:01<00:00, 10.67it/s]

Adding requests:   0%|          | 0/8192 [00:00<?, ?it/s]
Adding requests:   0%|          | 29/8192 [00:00<00:28, 281.83it/s]
Adding requests:   1%|          | 59/8192 [00:00<00:28, 287.93it/s]
Adding requests:   1%|          | 91/8192 [00:00<00:26, 301.82it/s]
Adding requests:   1%|▏         | 122/8192 [00:00<00:26, 303.91it/s]
Adding requests:   2%|▏         | 153/8192 [00:00<00:26, 299.07it/s]
Adding requests:   2%|▏         | 183/8192 [00:00<00:26, 297.09it/s]
Adding requests:   3%|▎         | 214/8192 [00:00<00:26, 298.87it/s]
Adding requests:   3%|▎         | 247/8192 [00:00<00:25, 306.65it/s]
Adding requests:   3%|▎         | 279/8192 [00:00<00:25, 309.72it/s]
Adding requests:   4%|▍         | 311/8192 [00:01<00:25, 311.26it/s]
Adding requests:   4%|▍         | 343/8192 [00:01<00:25, 311.51it/s]
Adding requests:   5%|▍         | 375/8192 [00:01<00:24, 313.82it/s]
Adding requests:   5%|▍         | 407/8192 [00:01<00:24, 313.75it/s]
Adding requests:   5%|▌         | 439/8192 [00:01<00:24, 310.93it/s]
Adding requests:   6%|▌         | 472/8192 [00:01<00:24, 316.02it/s]
Adding requests:   6%|▌         | 504/8192 [00:01<00:24, 310.51it/s]
Adding requests:   7%|▋         | 536/8192 [00:01<00:25, 303.66it/s]
Adding requests:   7%|▋         | 570/8192 [00:01<00:24, 312.37it/s]
Adding requests:   7%|▋         | 602/8192 [00:01<00:24, 310.27it/s]
Adding requests:   8%|▊         | 636/8192 [00:02<00:23, 316.75it/s]
Adding requests:   8%|▊         | 669/8192 [00:02<00:23, 320.30it/s]
Adding requests:   9%|▊         | 702/8192 [00:02<00:24, 309.15it/s]
Adding requests:   9%|▉         | 735/8192 [00:02<00:23, 315.01it/s]
Adding requests:   9%|▉         | 767/8192 [00:02<00:23, 315.18it/s]
Adding requests:  10%|▉         | 799/8192 [00:02<00:24, 304.57it/s]
Adding requests:  10%|█         | 830/8192 [00:02<00:24, 305.62it/s]
Adding requests:  11%|█         | 863/8192 [00:02<00:23, 311.44it/s]
Adding requests:  11%|█         | 898/8192 [00:02<00:22, 320.57it/s]
Adding requests:  11%|█▏        | 933/8192 [00:02<00:22, 327.89it/s]
Adding requests:  12%|█▏        | 967/8192 [00:03<00:21, 330.48it/s]
Adding requests:  12%|█▏        | 1001/8192 [00:03<00:22, 323.88it/s]
Adding requests:  13%|█▎        | 1036/8192 [00:03<00:21, 329.48it/s]
Adding requests:  13%|█▎        | 1071/8192 [00:03<00:21, 333.50it/s]
Adding requests:  14%|█▎        | 1108/8192 [00:03<00:20, 343.24it/s]
Adding requests:  14%|█▍        | 1144/8192 [00:03<00:20, 348.10it/s]
Adding requests:  14%|█▍        | 1182/8192 [00:03<00:19, 356.09it/s]
Adding requests:  15%|█▍        | 1219/8192 [00:03<00:19, 359.10it/s]
Adding requests:  15%|█▌        | 1255/8192 [00:03<00:19, 354.47it/s]
Adding requests:  16%|█▌        | 1292/8192 [00:04<00:19, 358.23it/s]
Adding requests:  16%|█▌        | 1330/8192 [00:04<00:18, 361.84it/s]
Adding requests:  17%|█▋        | 1367/8192 [00:04<00:19, 358.93it/s]
Adding requests:  17%|█▋        | 1404/8192 [00:04<00:18, 360.20it/s]
Adding requests:  18%|█▊        | 1441/8192 [00:04<00:18, 358.62it/s]
Adding requests:  18%|█▊        | 1479/8192 [00:04<00:18, 364.20it/s]
Adding requests:  19%|█▊        | 1516/8192 [00:04<00:18, 364.28it/s]
Adding requests:  19%|█▉        | 1553/8192 [00:04<00:18, 356.89it/s]
Adding requests:  19%|█▉        | 1590/8192 [00:04<00:18, 360.08it/s]
Adding requests:  20%|█▉        | 1627/8192 [00:04<00:18, 355.21it/s]
Adding requests:  20%|██        | 1663/8192 [00:05<00:18, 352.89it/s]
Adding requests:  21%|██        | 1699/8192 [00:05<00:18, 354.48it/s]
Adding requests:  21%|██        | 1735/8192 [00:05<00:18, 355.31it/s]
Adding requests:  22%|██▏       | 1771/8192 [00:05<00:18, 353.50it/s]
Adding requests:  22%|██▏       | 1807/8192 [00:05<00:18, 354.25it/s]
Adding requests:  22%|██▏       | 1843/8192 [00:05<00:18, 342.70it/s]
Adding requests:  23%|██▎       | 1878/8192 [00:05<00:18, 344.49it/s]
Adding requests:  23%|██▎       | 1914/8192 [00:05<00:18, 348.60it/s]
Adding requests:  24%|██▍       | 1951/8192 [00:05<00:17, 354.71it/s]
Adding requests:  24%|██▍       | 1987/8192 [00:05<00:17, 356.10it/s]
Adding requests:  25%|██▍       | 2023/8192 [00:06<00:17, 354.38it/s]
Adding requests:  25%|██▌       | 2059/8192 [00:06<00:17, 355.67it/s]
Adding requests:  26%|██▌       | 2096/8192 [00:06<00:16, 358.79it/s]
Adding requests:  26%|██▌       | 2132/8192 [00:06<00:17, 349.95it/s]
Adding requests:  26%|██▋       | 2168/8192 [00:06<00:17, 350.20it/s]
Adding requests:  27%|██▋       | 2204/8192 [00:06<00:17, 343.53it/s]
Adding requests:  27%|██▋       | 2239/8192 [00:06<00:17, 339.54it/s]
Adding requests:  28%|██▊       | 2273/8192 [00:06<00:17, 334.87it/s]
Adding requests:  28%|██▊       | 2308/8192 [00:06<00:17, 337.65it/s]
Adding requests:  35%|███▌      | 2879/8192 [00:07<00:02, 1880.86it/s]
Adding requests:  37%|███▋      | 3068/8192 [00:07<00:07, 710.96it/s] 
Adding requests:  39%|███▉      | 3209/8192 [00:08<00:09, 549.80it/s]
Adding requests:  40%|████      | 3317/8192 [00:08<00:10, 487.22it/s]
Adding requests:  42%|████▏     | 3403/8192 [00:08<00:10, 445.43it/s]
Adding requests:  42%|████▏     | 3473/8192 [00:08<00:11, 412.17it/s]
Adding requests:  43%|████▎     | 3532/8192 [00:09<00:11, 396.91it/s]
Adding requests:  44%|████▎     | 3583/8192 [00:09<00:12, 380.33it/s]
Adding requests:  44%|████▍     | 3629/8192 [00:09<00:12, 366.34it/s]
Adding requests:  45%|████▍     | 3671/8192 [00:09<00:12, 352.82it/s]
Adding requests:  45%|████▌     | 3709/8192 [00:09<00:12, 345.21it/s]
Adding requests:  46%|████▌     | 3746/8192 [00:09<00:13, 336.12it/s]
Adding requests:  46%|████▌     | 3781/8192 [00:09<00:13, 334.41it/s]
Adding requests:  47%|████▋     | 3816/8192 [00:10<00:13, 327.97it/s]
Adding requests:  47%|████▋     | 3850/8192 [00:10<00:13, 329.26it/s]
Adding requests:  47%|████▋     | 3884/8192 [00:10<00:13, 327.18it/s]
Adding requests:  48%|████▊     | 3917/8192 [00:10<00:13, 327.18it/s]
Adding requests:  48%|████▊     | 3950/8192 [00:10<00:13, 324.73it/s]
Adding requests:  49%|████▊     | 3983/8192 [00:10<00:13, 317.83it/s]
Adding requests:  49%|████▉     | 4015/8192 [00:10<00:13, 312.67it/s]
Adding requests:  49%|████▉     | 4047/8192 [00:10<00:13, 307.27it/s]
Adding requests:  50%|████▉     | 4079/8192 [00:10<00:13, 309.81it/s]
Adding requests:  50%|█████     | 4111/8192 [00:10<00:13, 308.51it/s]
Adding requests:  51%|█████     | 4142/8192 [00:11<00:13, 308.37it/s]
Adding requests:  51%|█████     | 4176/8192 [00:11<00:12, 315.36it/s]
Adding requests:  51%|█████▏    | 4208/8192 [00:11<00:12, 315.91it/s]
Adding requests:  52%|█████▏    | 4242/8192 [00:11<00:12, 322.43it/s]
Adding requests:  52%|█████▏    | 4276/8192 [00:11<00:12, 325.78it/s]
Adding requests:  53%|█████▎    | 4309/8192 [00:11<00:11, 325.22it/s]
Adding requests:  53%|█████▎    | 4344/8192 [00:11<00:11, 329.93it/s]
Adding requests:  53%|█████▎    | 4378/8192 [00:11<00:11, 331.81it/s]
Adding requests:  54%|█████▍    | 4412/8192 [00:11<00:11, 318.65it/s]
Adding requests:  54%|█████▍    | 4445/8192 [00:11<00:11, 320.73it/s]
Adding requests:  55%|█████▍    | 4478/8192 [00:12<00:11, 321.60it/s]
Adding requests:  55%|█████▌    | 4511/8192 [00:12<00:11, 321.52it/s]
Adding requests:  55%|█████▌    | 4544/8192 [00:12<00:11, 322.00it/s]
Adding requests:  56%|█████▌    | 4578/8192 [00:12<00:11, 325.47it/s]
Adding requests:  56%|█████▋    | 4613/8192 [00:12<00:10, 331.04it/s]
Adding requests:  57%|█████▋    | 4647/8192 [00:12<00:10, 327.06it/s]
Adding requests:  57%|█████▋    | 4680/8192 [00:12<00:10, 322.11it/s]
Adding requests:  58%|█████▊    | 4713/8192 [00:12<00:10, 322.67it/s]
Adding requests:  58%|█████▊    | 4746/8192 [00:12<00:10, 323.12it/s]
Adding requests:  58%|█████▊    | 4779/8192 [00:13<00:10, 320.31it/s]
Adding requests:  59%|█████▊    | 4812/8192 [00:13<00:10, 321.39it/s]
Adding requests:  59%|█████▉    | 4846/8192 [00:13<00:10, 326.68it/s]
Adding requests:  60%|█████▉    | 4879/8192 [00:13<00:10, 325.43it/s]
Adding requests:  60%|█████▉    | 4912/8192 [00:13<00:10, 325.65it/s]
Adding requests:  60%|██████    | 4947/8192 [00:13<00:09, 329.78it/s]
Adding requests:  61%|██████    | 4981/8192 [00:13<00:09, 332.04it/s]
Adding requests:  61%|██████    | 5016/8192 [00:13<00:09, 336.33it/s]
Adding requests:  62%|██████▏   | 5050/8192 [00:13<00:09, 335.62it/s]
Adding requests:  62%|██████▏   | 5084/8192 [00:13<00:09, 335.22it/s]
Adding requests:  62%|██████▏   | 5118/8192 [00:14<00:09, 332.88it/s]
Adding requests:  63%|██████▎   | 5152/8192 [00:14<00:09, 330.50it/s]
Adding requests:  63%|██████▎   | 5186/8192 [00:14<00:09, 329.23it/s]
Adding requests:  64%|██████▎   | 5220/8192 [00:14<00:08, 330.34it/s]
Adding requests:  64%|██████▍   | 5254/8192 [00:14<00:08, 327.33it/s]
Adding requests:  65%|██████▍   | 5287/8192 [00:14<00:09, 315.28it/s]
Adding requests:  65%|██████▍   | 5319/8192 [00:14<00:09, 315.29it/s]
Adding requests:  65%|██████▌   | 5351/8192 [00:14<00:09, 314.00it/s]
Adding requests:  66%|██████▌   | 5383/8192 [00:14<00:09, 310.17it/s]
Adding requests:  66%|██████▌   | 5415/8192 [00:14<00:09, 307.89it/s]
Adding requests:  66%|██████▋   | 5446/8192 [00:15<00:09, 304.68it/s]
Adding requests:  67%|██████▋   | 5477/8192 [00:15<00:08, 305.32it/s]
Adding requests:  67%|██████▋   | 5508/8192 [00:15<00:09, 297.43it/s]
Adding requests:  68%|██████▊   | 5539/8192 [00:15<00:08, 298.96it/s]
Adding requests:  68%|██████▊   | 5571/8192 [00:15<00:08, 304.65it/s]
Adding requests:  68%|██████▊   | 5603/8192 [00:15<00:08, 306.35it/s]
Adding requests:  69%|██████▉   | 5634/8192 [00:15<00:08, 306.50it/s]
Adding requests:  69%|██████▉   | 5666/8192 [00:15<00:08, 308.26it/s]
Adding requests:  70%|██████▉   | 5698/8192 [00:15<00:08, 311.64it/s]
Adding requests:  70%|██████▉   | 5730/8192 [00:16<00:08, 303.04it/s]
Adding requests:  70%|███████   | 5763/8192 [00:16<00:07, 310.82it/s]
Adding requests:  71%|███████   | 5795/8192 [00:16<00:07, 312.57it/s]
Adding requests:  71%|███████   | 5827/8192 [00:16<00:07, 312.27it/s]
Adding requests:  72%|███████▏  | 5859/8192 [00:16<00:07, 313.69it/s]
Adding requests:  72%|███████▏  | 5891/8192 [00:16<00:07, 315.49it/s]
Adding requests:  72%|███████▏  | 5923/8192 [00:16<00:07, 312.45it/s]
Adding requests:  73%|███████▎  | 5955/8192 [00:16<00:07, 311.33it/s]
Adding requests:  73%|███████▎  | 5990/8192 [00:16<00:06, 321.76it/s]
Adding requests:  74%|███████▎  | 6024/8192 [00:16<00:06, 324.21it/s]
Adding requests:  74%|███████▍  | 6058/8192 [00:17<00:06, 325.83it/s]
Adding requests:  74%|███████▍  | 6091/8192 [00:17<00:06, 320.44it/s]
Adding requests:  75%|███████▍  | 6125/8192 [00:17<00:06, 323.59it/s]
Adding requests:  75%|███████▌  | 6158/8192 [00:17<00:06, 323.78it/s]
Adding requests:  76%|███████▌  | 6192/8192 [00:17<00:06, 326.15it/s]
Adding requests:  76%|███████▌  | 6225/8192 [00:17<00:06, 324.96it/s]
Adding requests:  76%|███████▋  | 6258/8192 [00:17<00:05, 326.31it/s]
Adding requests:  77%|███████▋  | 6291/8192 [00:17<00:05, 323.73it/s]
Adding requests:  77%|███████▋  | 6325/8192 [00:17<00:05, 327.18it/s]
Adding requests:  78%|███████▊  | 6359/8192 [00:17<00:05, 330.51it/s]
Adding requests:  78%|███████▊  | 6393/8192 [00:18<00:05, 331.54it/s]
Adding requests:  78%|███████▊  | 6428/8192 [00:18<00:05, 335.90it/s]
Adding requests:  79%|███████▉  | 6463/8192 [00:18<00:05, 338.39it/s]
Adding requests:  79%|███████▉  | 6497/8192 [00:18<00:05, 335.77it/s]
Adding requests:  80%|███████▉  | 6531/8192 [00:18<00:04, 336.28it/s]
Adding requests:  80%|████████  | 6565/8192 [00:18<00:04, 332.35it/s]
Adding requests:  81%|████████  | 6599/8192 [00:18<00:04, 326.76it/s]
Adding requests:  81%|████████  | 6632/8192 [00:18<00:04, 326.95it/s]
Adding requests:  81%|████████▏ | 6665/8192 [00:18<00:04, 322.02it/s]
Adding requests:  82%|████████▏ | 6698/8192 [00:18<00:04, 318.62it/s]
Adding requests:  82%|████████▏ | 6730/8192 [00:19<00:04, 315.27it/s]
Adding requests:  83%|████████▎ | 6762/8192 [00:19<00:04, 315.68it/s]
Adding requests:  83%|████████▎ | 6796/8192 [00:19<00:04, 322.04it/s]
Adding requests:  83%|████████▎ | 6829/8192 [00:19<00:04, 321.38it/s]
Adding requests:  84%|████████▍ | 6863/8192 [00:19<00:04, 323.68it/s]
Adding requests:  84%|████████▍ | 6896/8192 [00:19<00:04, 318.97it/s]
Adding requests:  85%|████████▍ | 6929/8192 [00:19<00:03, 321.04it/s]
Adding requests:  85%|████████▍ | 6962/8192 [00:19<00:03, 321.61it/s]
Adding requests:  85%|████████▌ | 6995/8192 [00:19<00:03, 321.24it/s]
Adding requests:  86%|████████▌ | 7028/8192 [00:20<00:03, 307.86it/s]
Adding requests:  86%|████████▌ | 7062/8192 [00:20<00:03, 315.25it/s]
Adding requests:  87%|████████▋ | 7095/8192 [00:20<00:03, 316.79it/s]
Adding requests:  87%|████████▋ | 7129/8192 [00:20<00:03, 321.80it/s]
Adding requests:  87%|████████▋ | 7162/8192 [00:20<00:03, 321.10it/s]
Adding requests:  88%|████████▊ | 7195/8192 [00:20<00:03, 322.06it/s]
Adding requests:  88%|████████▊ | 7228/8192 [00:20<00:02, 323.66it/s]
Adding requests:  89%|████████▊ | 7263/8192 [00:20<00:02, 328.80it/s]
Adding requests:  89%|████████▉ | 7298/8192 [00:20<00:02, 333.89it/s]
Adding requests:  90%|████████▉ | 7335/8192 [00:20<00:02, 342.72it/s]
Adding requests:  90%|████████▉ | 7370/8192 [00:21<00:02, 342.00it/s]
Adding requests:  90%|█████████ | 7406/8192 [00:21<00:02, 344.27it/s]
Adding requests:  91%|█████████ | 7444/8192 [00:21<00:02, 353.66it/s]
Adding requests:  91%|█████████▏| 7480/8192 [00:21<00:02, 353.37it/s]
Adding requests:  92%|█████████▏| 7516/8192 [00:21<00:01, 354.58it/s]
Adding requests:  92%|█████████▏| 7553/8192 [00:21<00:01, 356.19it/s]
Adding requests:  93%|█████████▎| 7589/8192 [00:21<00:01, 349.87it/s]
Adding requests:  93%|█████████▎| 7625/8192 [00:21<00:01, 350.83it/s]
Adding requests:  94%|█████████▎| 7664/8192 [00:21<00:01, 359.86it/s]
Adding requests:  94%|█████████▍| 7701/8192 [00:21<00:01, 356.53it/s]
Adding requests:  94%|█████████▍| 7737/8192 [00:22<00:01, 348.79it/s]
Adding requests:  95%|█████████▍| 7772/8192 [00:22<00:01, 347.17it/s]
Adding requests:  95%|█████████▌| 7807/8192 [00:22<00:01, 343.18it/s]
Adding requests:  96%|█████████▌| 7844/8192 [00:22<00:00, 349.48it/s]
Adding requests:  96%|█████████▌| 7879/8192 [00:22<00:00, 346.25it/s]
Adding requests:  97%|█████████▋| 7914/8192 [00:22<00:00, 333.21it/s]
Adding requests:  97%|█████████▋| 7948/8192 [00:22<00:00, 328.86it/s]
Adding requests:  97%|█████████▋| 7981/8192 [00:22<00:00, 324.45it/s]
Adding requests:  98%|█████████▊| 8014/8192 [00:22<00:00, 319.95it/s]
Adding requests:  98%|█████████▊| 8047/8192 [00:23<00:00, 319.35it/s]
Adding requests:  99%|█████████▊| 8080/8192 [00:23<00:00, 321.62it/s]
Adding requests:  99%|█████████▉| 8113/8192 [00:23<00:00, 318.84it/s]
Adding requests:  99%|█████████▉| 8146/8192 [00:23<00:00, 319.72it/s]
Adding requests: 100%|█████████▉| 8180/8192 [00:23<00:00, 325.61it/s]
Adding requests: 100%|██████████| 8192/8192 [00:23<00:00, 348.75it/s]

Processed prompts:   0%|          | 0/8192 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  32%|███▏      | 2594/8192 [00:00<00:00, 11614.53it/s, est. speed input: 11897962.67 toks/s, output: 11615.16 toks/s]
Processed prompts:  46%|████▌     | 3756/8192 [00:11<00:16, 269.21it/s, est. speed input: 345621.97 toks/s, output: 337.52 toks/s]      
Processed prompts:  47%|████▋     | 3810/8192 [00:11<00:17, 255.70it/s, est. speed input: 332082.29 toks/s, output: 324.30 toks/s]
Processed prompts:  52%|█████▏    | 4294/8192 [00:14<00:16, 242.31it/s, est. speed input: 312522.12 toks/s, output: 305.20 toks/s]
Processed prompts:  56%|█████▌    | 4567/8192 [00:16<00:17, 204.52it/s, est. speed input: 284089.16 toks/s, output: 277.43 toks/s]
Processed prompts:  58%|█████▊    | 4737/8192 [00:18<00:19, 176.49it/s, est. speed input: 264671.99 toks/s, output: 258.47 toks/s]
Processed prompts:  59%|█████▉    | 4849/8192 [00:19<00:20, 160.47it/s, est. speed input: 253953.63 toks/s, output: 248.00 toks/s]
Processed prompts:  60%|██████    | 4926/8192 [00:20<00:20, 156.07it/s, est. speed input: 250034.98 toks/s, output: 244.17 toks/s]
Processed prompts:  61%|██████    | 4982/8192 [00:20<00:21, 147.91it/s, est. speed input: 245827.26 toks/s, output: 240.07 toks/s]
Processed prompts:  61%|██████▏   | 5026/8192 [00:21<00:23, 136.29it/s, est. speed input: 241328.31 toks/s, output: 235.67 toks/s]
Processed prompts:  62%|██████▏   | 5090/8192 [00:21<00:23, 131.63it/s, est. speed input: 238001.54 toks/s, output: 232.42 toks/s]
Processed prompts:  63%|██████▎   | 5154/8192 [00:22<00:23, 127.38it/s, est. speed input: 234846.35 toks/s, output: 229.34 toks/s]
Processed prompts:  64%|██████▎   | 5218/8192 [00:23<00:24, 123.70it/s, est. speed input: 231846.43 toks/s, output: 226.41 toks/s]
Processed prompts:  64%|██████▍   | 5282/8192 [00:23<00:24, 118.24it/s, est. speed input: 228533.68 toks/s, output: 223.18 toks/s]
Processed prompts:  65%|██████▌   | 5346/8192 [00:24<00:24, 114.05it/s, est. speed input: 225384.72 toks/s, output: 220.10 toks/s]
Processed prompts:  66%|██████▌   | 5410/8192 [00:24<00:25, 110.93it/s, est. speed input: 222391.88 toks/s, output: 217.18 toks/s]
Processed prompts:  67%|██████▋   | 5474/8192 [00:25<00:25, 108.70it/s, est. speed input: 219555.08 toks/s, output: 214.41 toks/s]
Processed prompts:  68%|██████▊   | 5538/8192 [00:26<00:24, 107.51it/s, est. speed input: 216920.86 toks/s, output: 211.84 toks/s]
Processed prompts:  68%|██████▊   | 5602/8192 [00:26<00:24, 106.17it/s, est. speed input: 214331.80 toks/s, output: 209.31 toks/s]
Processed prompts:  69%|██████▉   | 5666/8192 [00:27<00:24, 105.23it/s, est. speed input: 211862.10 toks/s, output: 206.90 toks/s]
Processed prompts:  70%|██████▉   | 5730/8192 [00:28<00:23, 104.57it/s, est. speed input: 209501.46 toks/s, output: 204.59 toks/s]
Processed prompts:  71%|███████   | 5794/8192 [00:28<00:22, 104.90it/s, est. speed input: 207359.04 toks/s, output: 202.50 toks/s]
Processed prompts:  72%|███████▏  | 5858/8192 [00:29<00:21, 106.83it/s, est. speed input: 205533.58 toks/s, output: 200.72 toks/s]
Processed prompts:  72%|███████▏  | 5922/8192 [00:29<00:20, 108.20it/s, est. speed input: 203774.43 toks/s, output: 199.00 toks/s]
Processed prompts:  73%|███████▎  | 5986/8192 [00:30<00:20, 109.22it/s, est. speed input: 202085.44 toks/s, output: 197.35 toks/s]
Processed prompts:  74%|███████▍  | 6050/8192 [00:30<00:19, 109.95it/s, est. speed input: 200459.29 toks/s, output: 195.76 toks/s]
Processed prompts:  75%|███████▍  | 6114/8192 [00:31<00:19, 108.70it/s, est. speed input: 198693.88 toks/s, output: 194.04 toks/s]
Processed prompts:  75%|███████▌  | 6178/8192 [00:32<00:18, 106.93it/s, est. speed input: 196891.49 toks/s, output: 192.28 toks/s]
Processed prompts:  76%|███████▌  | 6242/8192 [00:32<00:18, 105.43it/s, est. speed input: 195123.18 toks/s, output: 190.55 toks/s]
Processed prompts:  77%|███████▋  | 6306/8192 [00:33<00:17, 105.00it/s, est. speed input: 193489.46 toks/s, output: 188.95 toks/s]
Processed prompts:  78%|███████▊  | 6370/8192 [00:33<00:17, 104.37it/s, est. speed input: 191878.06 toks/s, output: 187.38 toks/s]
Processed prompts:  79%|███████▊  | 6434/8192 [00:34<00:16, 103.97it/s, est. speed input: 190328.70 toks/s, output: 185.87 toks/s]
Processed prompts:  79%|███████▉  | 6498/8192 [00:35<00:16, 103.71it/s, est. speed input: 188835.96 toks/s, output: 184.41 toks/s]
Processed prompts:  80%|████████  | 6562/8192 [00:35<00:15, 103.96it/s, est. speed input: 187439.50 toks/s, output: 183.05 toks/s]
Processed prompts:  81%|████████  | 6626/8192 [00:36<00:14, 104.89it/s, est. speed input: 186165.13 toks/s, output: 181.80 toks/s]
Processed prompts:  82%|████████▏ | 6690/8192 [00:37<00:14, 106.92it/s, est. speed input: 185061.06 toks/s, output: 180.72 toks/s]
Processed prompts:  82%|████████▏ | 6754/8192 [00:37<00:13, 108.29it/s, est. speed input: 183981.57 toks/s, output: 179.67 toks/s]
Processed prompts:  83%|████████▎ | 6818/8192 [00:38<00:12, 109.26it/s, est. speed input: 182934.64 toks/s, output: 178.65 toks/s]
Processed prompts:  84%|████████▍ | 6882/8192 [00:38<00:11, 109.92it/s, est. speed input: 181915.69 toks/s, output: 177.65 toks/s]
Processed prompts:  85%|████████▍ | 6946/8192 [00:39<00:11, 109.29it/s, est. speed input: 180836.78 toks/s, output: 176.60 toks/s]
Processed prompts:  86%|████████▌ | 7010/8192 [00:39<00:10, 107.66it/s, est. speed input: 179692.58 toks/s, output: 175.48 toks/s]
Processed prompts:  86%|████████▋ | 7074/8192 [00:40<00:10, 106.26it/s, est. speed input: 178559.70 toks/s, output: 174.37 toks/s]
Processed prompts:  87%|████████▋ | 7138/8192 [00:41<00:09, 105.73it/s, est. speed input: 177495.71 toks/s, output: 173.34 toks/s]
Processed prompts:  88%|████████▊ | 7202/8192 [00:41<00:09, 104.85it/s, est. speed input: 176421.07 toks/s, output: 172.29 toks/s]
Processed prompts:  89%|████████▊ | 7266/8192 [00:42<00:08, 104.73it/s, est. speed input: 175417.70 toks/s, output: 171.31 toks/s]
Processed prompts:  89%|████████▉ | 7330/8192 [00:43<00:08, 104.28it/s, est. speed input: 174413.69 toks/s, output: 170.33 toks/s]
Processed prompts:  90%|█████████ | 7394/8192 [00:43<00:07, 103.96it/s, est. speed input: 173438.17 toks/s, output: 169.37 toks/s]
Processed prompts:  91%|█████████ | 7458/8192 [00:44<00:07, 103.71it/s, est. speed input: 172487.26 toks/s, output: 168.44 toks/s]
Processed prompts:  92%|█████████▏| 7522/8192 [00:44<00:06, 105.12it/s, est. speed input: 171681.65 toks/s, output: 167.66 toks/s]
Processed prompts:  95%|█████████▍| 7778/8192 [00:45<00:02, 194.29it/s, est. speed input: 174929.27 toks/s, output: 170.83 toks/s]
Processed prompts:  96%|█████████▌| 7842/8192 [00:46<00:02, 171.04it/s, est. speed input: 174177.75 toks/s, output: 170.10 toks/s]
Processed prompts:  97%|█████████▋| 7906/8192 [00:46<00:01, 154.00it/s, est. speed input: 173443.23 toks/s, output: 169.38 toks/s]
Processed prompts:  97%|█████████▋| 7970/8192 [00:47<00:01, 141.32it/s, est. speed input: 172707.66 toks/s, output: 168.66 toks/s]
Processed prompts:  98%|█████████▊| 8034/8192 [00:47<00:01, 129.49it/s, est. speed input: 171838.00 toks/s, output: 167.81 toks/s]
Processed prompts:  99%|█████████▉| 8098/8192 [00:48<00:00, 121.91it/s, est. speed input: 171019.97 toks/s, output: 167.01 toks/s]
Processed prompts: 100%|█████████▉| 8162/8192 [00:48<00:00, 138.79it/s, est. speed input: 171348.07 toks/s, output: 167.33 toks/s]
Processed prompts: 100%|██████████| 8192/8192 [00:48<00:00, 138.79it/s, est. speed input: 171975.64 toks/s, output: 167.94 toks/s]
Processed prompts: 100%|██████████| 8192/8192 [00:48<00:00, 167.94it/s, est. speed input: 171975.64 toks/s, output: 167.94 toks/s]
[rank0]:[W125 18:09:02.823502083 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=512 ==========
Time: 2026-01-25 20:37:54
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_6
Params: prompt_len=512, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_6 --dataset-name random --input-len 512 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 513 --max-num-batched-tokens 513 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Llama3.2-3B-INT8_M512.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 20:38:02 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 20:38:03 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=377573) WARNING 01-25 20:38:10 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=377573) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=377573) WARNING 01-25 20:38:25 [backends.py:609] Failed to read file <frozen os>
Throughput: 14.46 requests/s, 7420.15 total tokens/s, 14.46 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128

STDERR:
[2026-01-25 20:38:02] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 20:38:02] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 20:38:02] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 20:38:02] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:38:02] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:38:02] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:38:02] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:38:02] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:38:02] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 20:38:02] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 20:38:02] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 20:38:02] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 20:38:02] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 20:38:02] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 20:38:09] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 20:38:09] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 20:38:09] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 20:38:09] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:38:09] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:38:09] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:38:09] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:38:09] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:38:09] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 20:38:09] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 20:38:09] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 20:38:09] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 20:38:09] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 20:38:09] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=377573) [2026-01-25 20:38:10] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=377573) [2026-01-25 20:38:10] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=377573) [2026-01-25 20:38:10] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=377573) [2026-01-25 20:38:10] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=377573) [2026-01-25 20:38:10] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-3B-INT8
(EngineCore_DP0 pid=377573) [2026-01-25 20:38:10] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=377573) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=377573) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:03<00:00,  3.89s/it]
(EngineCore_DP0 pid=377573) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:03<00:00,  3.89s/it]
(EngineCore_DP0 pid=377573) 
(EngineCore_DP0 pid=377573) [2026-01-25 20:38:15] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 4096] -> 1D uint8
(EngineCore_DP0 pid=377573) [2026-01-25 20:38:15] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 15728640 bytes
(EngineCore_DP0 pid=377573) [2026-01-25 20:38:15] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 4096] -> 1D uint8
(EngineCore_DP0 pid=377573) [2026-01-25 20:38:15] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9437184 bytes
(EngineCore_DP0 pid=377573) [2026-01-25 20:38:15] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 4096] -> 1D uint8
(EngineCore_DP0 pid=377573) [2026-01-25 20:38:15] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 50331648 bytes
(EngineCore_DP0 pid=377573) [2026-01-25 20:38:15] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 10944] -> 1D uint8
(EngineCore_DP0 pid=377573) [2026-01-25 20:38:15] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 25264128 bytes
(EngineCore_DP0 pid=377573) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  2.15it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  2.11it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  2.11it/s]
(EngineCore_DP0 pid=377573) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.32it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.31it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  42%|████▏     | 54/128 [00:00<00:00, 536.46it/s]
Adding requests:  85%|████████▌ | 109/128 [00:00<00:00, 541.63it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 542.57it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:27,  4.67it/s, est. speed input: 2389.02 toks/s, output: 4.67 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:13,  9.29it/s, est. speed input: 4327.24 toks/s, output: 8.45 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:10, 11.48it/s, est. speed input: 5220.59 toks/s, output: 10.20 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:09, 12.59it/s, est. speed input: 5704.27 toks/s, output: 11.14 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:00<00:08, 13.32it/s, est. speed input: 6031.91 toks/s, output: 11.78 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:00<00:08, 13.77it/s, est. speed input: 6256.48 toks/s, output: 12.22 toks/s]
Processed prompts:  10%|█         | 13/128 [00:01<00:08, 13.65it/s, est. speed input: 6344.14 toks/s, output: 12.39 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:01<00:08, 13.85it/s, est. speed input: 6457.69 toks/s, output: 12.61 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:01<00:07, 13.96it/s, est. speed input: 6544.07 toks/s, output: 12.78 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:01<00:07, 14.12it/s, est. speed input: 6627.30 toks/s, output: 12.94 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:01<00:07, 14.11it/s, est. speed input: 6678.92 toks/s, output: 13.04 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:01<00:07, 14.36it/s, est. speed input: 6753.83 toks/s, output: 13.19 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:01<00:07, 14.52it/s, est. speed input: 6816.95 toks/s, output: 13.31 toks/s]
Processed prompts:  21%|██        | 27/128 [00:02<00:06, 14.55it/s, est. speed input: 6861.45 toks/s, output: 13.40 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:02<00:06, 14.57it/s, est. speed input: 6901.08 toks/s, output: 13.48 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:02<00:06, 14.57it/s, est. speed input: 6934.85 toks/s, output: 13.54 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:02<00:06, 14.56it/s, est. speed input: 6963.43 toks/s, output: 13.60 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:02<00:06, 14.49it/s, est. speed input: 6984.20 toks/s, output: 13.64 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:02<00:06, 14.55it/s, est. speed input: 7011.07 toks/s, output: 13.69 toks/s]
Processed prompts:  30%|███       | 39/128 [00:02<00:06, 14.57it/s, est. speed input: 7033.91 toks/s, output: 13.74 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:02<00:05, 14.58it/s, est. speed input: 7054.59 toks/s, output: 13.78 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:03<00:05, 14.97it/s, est. speed input: 7099.83 toks/s, output: 13.87 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:03<00:05, 15.30it/s, est. speed input: 7144.29 toks/s, output: 13.95 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:03<00:05, 15.55it/s, est. speed input: 7186.12 toks/s, output: 14.04 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:03<00:05, 15.63it/s, est. speed input: 7219.27 toks/s, output: 14.10 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:03<00:04, 15.73it/s, est. speed input: 7252.49 toks/s, output: 14.16 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:03<00:04, 15.87it/s, est. speed input: 7287.19 toks/s, output: 14.23 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:03<00:04, 15.90it/s, est. speed input: 7316.22 toks/s, output: 14.29 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:03<00:04, 15.85it/s, est. speed input: 7339.66 toks/s, output: 14.34 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:04<00:04, 15.91it/s, est. speed input: 7366.41 toks/s, output: 14.39 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:04<00:04, 15.93it/s, est. speed input: 7390.73 toks/s, output: 14.43 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:04<00:04, 15.89it/s, est. speed input: 7410.93 toks/s, output: 14.47 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:04<00:03, 15.92it/s, est. speed input: 7432.66 toks/s, output: 14.52 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:04<00:03, 15.82it/s, est. speed input: 7447.83 toks/s, output: 14.55 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:04<00:03, 15.84it/s, est. speed input: 7466.27 toks/s, output: 14.58 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:04<00:03, 15.83it/s, est. speed input: 7482.44 toks/s, output: 14.61 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:04<00:03, 15.71it/s, est. speed input: 7493.58 toks/s, output: 14.64 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:05<00:03, 15.75it/s, est. speed input: 7508.92 toks/s, output: 14.67 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:05<00:03, 15.85it/s, est. speed input: 7525.92 toks/s, output: 14.70 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:05<00:03, 15.90it/s, est. speed input: 7541.91 toks/s, output: 14.73 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:05<00:02, 15.90it/s, est. speed input: 7555.69 toks/s, output: 14.76 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:05<00:02, 15.60it/s, est. speed input: 7557.78 toks/s, output: 14.76 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:05<00:02, 15.51it/s, est. speed input: 7563.96 toks/s, output: 14.77 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:05<00:02, 15.39it/s, est. speed input: 7568.12 toks/s, output: 14.78 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:06<00:02, 15.36it/s, est. speed input: 7573.58 toks/s, output: 14.79 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:06<00:02, 15.31it/s, est. speed input: 7578.18 toks/s, output: 14.80 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:06<00:02, 15.19it/s, est. speed input: 7579.41 toks/s, output: 14.80 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:06<00:02, 15.18it/s, est. speed input: 7583.02 toks/s, output: 14.81 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:06<00:02, 15.13it/s, est. speed input: 7585.05 toks/s, output: 14.81 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:06<00:01, 15.05it/s, est. speed input: 7585.54 toks/s, output: 14.82 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:06<00:01, 15.08it/s, est. speed input: 7589.01 toks/s, output: 14.82 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:06<00:01, 15.12it/s, est. speed input: 7592.72 toks/s, output: 14.83 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:07<00:01, 15.16it/s, est. speed input: 7596.88 toks/s, output: 14.84 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:07<00:01, 15.20it/s, est. speed input: 7600.98 toks/s, output: 14.85 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:07<00:01, 15.08it/s, est. speed input: 7600.74 toks/s, output: 14.85 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:07<00:01, 15.03it/s, est. speed input: 7601.41 toks/s, output: 14.85 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:07<00:01, 14.94it/s, est. speed input: 7600.43 toks/s, output: 14.84 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:07<00:00, 14.94it/s, est. speed input: 7601.14 toks/s, output: 14.85 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:07<00:00, 14.97it/s, est. speed input: 7602.91 toks/s, output: 14.85 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:08<00:00, 15.01it/s, est. speed input: 7605.07 toks/s, output: 14.85 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:08<00:00, 15.01it/s, est. speed input: 7606.26 toks/s, output: 14.86 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:08<00:00, 15.05it/s, est. speed input: 7608.70 toks/s, output: 14.86 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:08<00:00, 14.99it/s, est. speed input: 7608.65 toks/s, output: 14.86 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:08<00:00, 14.97it/s, est. speed input: 7609.14 toks/s, output: 14.86 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:08<00:00, 14.97it/s, est. speed input: 7609.87 toks/s, output: 14.86 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:08<00:00, 14.86it/s, est. speed input: 7609.87 toks/s, output: 14.86 toks/s]
[rank0]:[W125 20:38:51.899375660 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=1024 ==========
Time: 2026-01-25 20:38:54
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 1025 --max-num-batched-tokens 1025 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Llama3.2-3B-INT8_M1024.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 20:39:03 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 20:39:04 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=378694) WARNING 01-25 20:39:10 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=378694) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=378694) WARNING 01-25 20:39:23 [backends.py:609] Failed to read file <frozen os>
Throughput: 15.12 requests/s, 15494.40 total tokens/s, 15.12 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128

STDERR:
[2026-01-25 20:39:03] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 20:39:03] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 20:39:03] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 20:39:03] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:39:03] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:39:03] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:39:03] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:39:03] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:39:03] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 20:39:03] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 20:39:03] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 20:39:03] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 20:39:03] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 20:39:03] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 20:39:10] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 20:39:10] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 20:39:10] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 20:39:10] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:39:10] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:39:10] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:39:10] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:39:10] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:39:10] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 20:39:10] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 20:39:10] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 20:39:10] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 20:39:10] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 20:39:10] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=378694) [2026-01-25 20:39:11] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=378694) [2026-01-25 20:39:11] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=378694) [2026-01-25 20:39:11] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=378694) [2026-01-25 20:39:11] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=378694) [2026-01-25 20:39:11] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-3B-INT8
(EngineCore_DP0 pid=378694) [2026-01-25 20:39:11] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=378694) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=378694) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:01<00:00,  1.07s/it]
(EngineCore_DP0 pid=378694) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:01<00:00,  1.07s/it]
(EngineCore_DP0 pid=378694) 
(EngineCore_DP0 pid=378694) [2026-01-25 20:39:13] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 4096] -> 1D uint8
(EngineCore_DP0 pid=378694) [2026-01-25 20:39:13] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 15728640 bytes
(EngineCore_DP0 pid=378694) [2026-01-25 20:39:13] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 4096] -> 1D uint8
(EngineCore_DP0 pid=378694) [2026-01-25 20:39:13] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9437184 bytes
(EngineCore_DP0 pid=378694) [2026-01-25 20:39:13] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 4096] -> 1D uint8
(EngineCore_DP0 pid=378694) [2026-01-25 20:39:13] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 50331648 bytes
(EngineCore_DP0 pid=378694) [2026-01-25 20:39:13] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 10944] -> 1D uint8
(EngineCore_DP0 pid=378694) [2026-01-25 20:39:13] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 25264128 bytes
(EngineCore_DP0 pid=378694) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  7.45it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  7.78it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  7.72it/s]
(EngineCore_DP0 pid=378694) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  6.76it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  6.75it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  23%|██▎       | 29/128 [00:00<00:00, 280.62it/s]
Adding requests:  46%|████▌     | 59/128 [00:00<00:00, 291.72it/s]
Adding requests:  71%|███████   | 91/128 [00:00<00:00, 302.79it/s]
Adding requests:  95%|█████████▌| 122/128 [00:00<00:00, 302.17it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 299.58it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 2/128 [00:00<00:07, 15.75it/s, est. speed input: 16136.18 toks/s, output: 15.76 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:07, 15.54it/s, est. speed input: 15943.44 toks/s, output: 15.57 toks/s]
Processed prompts:   5%|▍         | 6/128 [00:00<00:07, 15.47it/s, est. speed input: 15888.45 toks/s, output: 15.51 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:00<00:07, 15.44it/s, est. speed input: 15852.43 toks/s, output: 15.48 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:00<00:07, 15.32it/s, est. speed input: 15773.30 toks/s, output: 15.40 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:00<00:07, 15.30it/s, est. speed input: 15748.74 toks/s, output: 15.38 toks/s]
Processed prompts:  11%|█         | 14/128 [00:00<00:07, 15.30it/s, est. speed input: 15736.08 toks/s, output: 15.37 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:01<00:07, 15.32it/s, est. speed input: 15738.04 toks/s, output: 15.37 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:01<00:07, 15.41it/s, est. speed input: 15763.44 toks/s, output: 15.39 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:01<00:07, 15.39it/s, est. speed input: 15759.98 toks/s, output: 15.39 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:01<00:06, 15.40it/s, est. speed input: 15760.60 toks/s, output: 15.39 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:01<00:06, 15.45it/s, est. speed input: 15777.62 toks/s, output: 15.41 toks/s]
Processed prompts:  20%|██        | 26/128 [00:01<00:06, 15.38it/s, est. speed input: 15762.91 toks/s, output: 15.39 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:01<00:06, 15.28it/s, est. speed input: 15736.15 toks/s, output: 15.37 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:01<00:06, 15.26it/s, est. speed input: 15725.17 toks/s, output: 15.36 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:02<00:06, 15.60it/s, est. speed input: 15790.82 toks/s, output: 15.42 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:02<00:05, 15.85it/s, est. speed input: 15850.96 toks/s, output: 15.48 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:02<00:05, 16.08it/s, est. speed input: 15911.70 toks/s, output: 15.54 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:02<00:05, 16.33it/s, est. speed input: 15981.10 toks/s, output: 15.61 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:02<00:05, 16.59it/s, est. speed input: 16056.94 toks/s, output: 15.68 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:02<00:05, 16.72it/s, est. speed input: 16117.50 toks/s, output: 15.74 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:02<00:05, 16.71it/s, est. speed input: 16159.68 toks/s, output: 15.78 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:02<00:04, 16.72it/s, est. speed input: 16199.46 toks/s, output: 15.82 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:03<00:04, 16.76it/s, est. speed input: 16241.65 toks/s, output: 15.86 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:03<00:04, 16.84it/s, est. speed input: 16285.89 toks/s, output: 15.90 toks/s]
Processed prompts:  41%|████      | 52/128 [00:03<00:04, 16.97it/s, est. speed input: 16335.60 toks/s, output: 15.95 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:03<00:04, 16.96it/s, est. speed input: 16371.90 toks/s, output: 15.99 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:03<00:04, 16.92it/s, est. speed input: 16400.50 toks/s, output: 16.02 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:03<00:04, 16.97it/s, est. speed input: 16436.57 toks/s, output: 16.05 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:03<00:03, 17.04it/s, est. speed input: 16473.03 toks/s, output: 16.09 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:03<00:03, 16.95it/s, est. speed input: 16493.89 toks/s, output: 16.11 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:03<00:03, 16.96it/s, est. speed input: 16520.85 toks/s, output: 16.13 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:04<00:03, 16.93it/s, est. speed input: 16541.77 toks/s, output: 16.15 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:04<00:03, 16.93it/s, est. speed input: 16564.24 toks/s, output: 16.18 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:04<00:03, 16.93it/s, est. speed input: 16585.56 toks/s, output: 16.20 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:04<00:03, 16.93it/s, est. speed input: 16605.79 toks/s, output: 16.22 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:04<00:03, 16.92it/s, est. speed input: 16623.27 toks/s, output: 16.23 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:04<00:03, 16.30it/s, est. speed input: 16588.14 toks/s, output: 16.20 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:04<00:03, 16.02it/s, est. speed input: 16566.56 toks/s, output: 16.18 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:04<00:03, 15.84it/s, est. speed input: 16545.96 toks/s, output: 16.16 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:05<00:02, 15.64it/s, est. speed input: 16520.87 toks/s, output: 16.13 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:05<00:02, 15.57it/s, est. speed input: 16501.95 toks/s, output: 16.12 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:05<00:02, 15.47it/s, est. speed input: 16480.25 toks/s, output: 16.09 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:05<00:02, 15.47it/s, est. speed input: 16464.74 toks/s, output: 16.08 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:05<00:02, 15.47it/s, est. speed input: 16450.38 toks/s, output: 16.06 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:05<00:02, 15.56it/s, est. speed input: 16443.72 toks/s, output: 16.06 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:05<00:02, 15.60it/s, est. speed input: 16435.70 toks/s, output: 16.05 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:05<00:02, 15.69it/s, est. speed input: 16432.39 toks/s, output: 16.05 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:06<00:01, 15.68it/s, est. speed input: 16424.49 toks/s, output: 16.04 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:06<00:01, 15.72it/s, est. speed input: 16419.67 toks/s, output: 16.03 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:06<00:01, 15.73it/s, est. speed input: 16413.68 toks/s, output: 16.03 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:06<00:01, 15.62it/s, est. speed input: 16400.40 toks/s, output: 16.02 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:06<00:01, 15.64it/s, est. speed input: 16393.92 toks/s, output: 16.01 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:06<00:01, 15.71it/s, est. speed input: 16391.43 toks/s, output: 16.01 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:06<00:01, 15.54it/s, est. speed input: 16374.93 toks/s, output: 15.99 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:07<00:01, 15.64it/s, est. speed input: 16372.38 toks/s, output: 15.99 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:07<00:00, 15.72it/s, est. speed input: 16371.06 toks/s, output: 15.99 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:07<00:00, 15.69it/s, est. speed input: 16364.69 toks/s, output: 15.98 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:07<00:00, 15.55it/s, est. speed input: 16351.02 toks/s, output: 15.97 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:07<00:00, 15.40it/s, est. speed input: 16334.54 toks/s, output: 15.95 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:07<00:00, 15.40it/s, est. speed input: 16324.80 toks/s, output: 15.94 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:07<00:00, 15.42it/s, est. speed input: 16316.71 toks/s, output: 15.93 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:07<00:00, 15.44it/s, est. speed input: 16309.28 toks/s, output: 15.93 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:08<00:00, 15.52it/s, est. speed input: 16305.69 toks/s, output: 15.92 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:08<00:00, 15.52it/s, est. speed input: 16305.69 toks/s, output: 15.92 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:08<00:00, 15.92it/s, est. speed input: 16305.69 toks/s, output: 15.92 toks/s]
[rank0]:[W125 20:39:48.665191338 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=2048 ==========
Time: 2026-01-25 20:39:51
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=256, max_num_seqs=2
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 256 --max-num-seqs 2 --max-model-len 1025 --max-num-batched-tokens 2048 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Llama3.2-3B-INT8_M2048.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 20:40:00 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 20:40:01 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=379732) WARNING 01-25 20:40:09 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=379732) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=379732) WARNING 01-25 20:40:19 [backends.py:609] Failed to read file <frozen os>
Throughput: 30.36 requests/s, 31116.31 total tokens/s, 30.36 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256

STDERR:
[2026-01-25 20:40:00] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 20:40:00] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 20:40:00] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 20:40:00] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:40:00] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:40:00] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:40:00] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:40:00] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:40:00] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 20:40:00] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 20:40:00] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 20:40:00] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 20:40:00] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 20:40:00] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 20:40:08] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 20:40:08] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 20:40:08] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 20:40:08] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:40:08] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:40:08] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:40:08] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:40:08] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:40:08] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 20:40:08] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 20:40:08] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 20:40:08] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 20:40:08] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 20:40:08] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=379732) [2026-01-25 20:40:09] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=379732) [2026-01-25 20:40:09] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=379732) [2026-01-25 20:40:09] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=379732) [2026-01-25 20:40:09] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=379732) [2026-01-25 20:40:09] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-3B-INT8
(EngineCore_DP0 pid=379732) [2026-01-25 20:40:09] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=379732) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=379732) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:01<00:00,  1.06s/it]
(EngineCore_DP0 pid=379732) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:01<00:00,  1.06s/it]
(EngineCore_DP0 pid=379732) 
(EngineCore_DP0 pid=379732) [2026-01-25 20:40:10] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 4096] -> 1D uint8
(EngineCore_DP0 pid=379732) [2026-01-25 20:40:10] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 15728640 bytes
(EngineCore_DP0 pid=379732) [2026-01-25 20:40:10] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 4096] -> 1D uint8
(EngineCore_DP0 pid=379732) [2026-01-25 20:40:10] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9437184 bytes
(EngineCore_DP0 pid=379732) [2026-01-25 20:40:10] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 4096] -> 1D uint8
(EngineCore_DP0 pid=379732) [2026-01-25 20:40:10] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 50331648 bytes
(EngineCore_DP0 pid=379732) [2026-01-25 20:40:10] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 10944] -> 1D uint8
(EngineCore_DP0 pid=379732) [2026-01-25 20:40:10] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 25264128 bytes
(EngineCore_DP0 pid=379732) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  33%|███▎      | 1/3 [00:00<00:00,  7.66it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  67%|██████▋   | 2/3 [00:00<00:00,  8.26it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00,  7.54it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00,  7.66it/s]
(EngineCore_DP0 pid=379732) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 1/2 [00:00<00:00,  7.04it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  7.96it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  7.80it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  13%|█▎        | 33/256 [00:00<00:00, 323.55it/s]
Adding requests:  27%|██▋       | 68/256 [00:00<00:00, 334.80it/s]
Adding requests:  40%|███▉      | 102/256 [00:00<00:00, 336.85it/s]
Adding requests:  54%|█████▍    | 138/256 [00:00<00:00, 344.21it/s]
Adding requests:  68%|██████▊   | 173/256 [00:00<00:00, 344.37it/s]
Adding requests:  81%|████████▏ | 208/256 [00:00<00:00, 338.75it/s]
Adding requests:  95%|█████████▍| 242/256 [00:00<00:00, 338.41it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 338.84it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   7%|▋         | 18/256 [00:00<00:01, 144.35it/s, est. speed input: 147847.41 toks/s, output: 144.36 toks/s]
Processed prompts:  13%|█▎        | 33/256 [00:00<00:04, 53.90it/s, est. speed input: 61498.82 toks/s, output: 60.06 toks/s]   
Processed prompts:  16%|█▋        | 42/256 [00:00<00:05, 42.65it/s, est. speed input: 50303.72 toks/s, output: 49.12 toks/s]
Processed prompts:  19%|█▉        | 48/256 [00:01<00:05, 39.91it/s, est. speed input: 47389.29 toks/s, output: 46.28 toks/s]
Processed prompts:  21%|██        | 53/256 [00:01<00:05, 40.04it/s, est. speed input: 46762.48 toks/s, output: 45.67 toks/s]
Processed prompts:  23%|██▎       | 58/256 [00:01<00:05, 36.08it/s, est. speed input: 44205.36 toks/s, output: 43.17 toks/s]
Processed prompts:  24%|██▍       | 62/256 [00:01<00:05, 35.31it/s, est. speed input: 43315.28 toks/s, output: 42.30 toks/s]
Processed prompts:  26%|██▌       | 66/256 [00:01<00:05, 34.61it/s, est. speed input: 42538.20 toks/s, output: 41.54 toks/s]
Processed prompts:  27%|██▋       | 70/256 [00:01<00:05, 34.08it/s, est. speed input: 41880.23 toks/s, output: 40.90 toks/s]
Processed prompts:  29%|██▉       | 74/256 [00:01<00:05, 33.74it/s, est. speed input: 41330.19 toks/s, output: 40.36 toks/s]
Processed prompts:  30%|███       | 78/256 [00:01<00:05, 33.43it/s, est. speed input: 40834.18 toks/s, output: 39.88 toks/s]
Processed prompts:  32%|███▏      | 82/256 [00:02<00:05, 33.18it/s, est. speed input: 40391.22 toks/s, output: 39.44 toks/s]
Processed prompts:  34%|███▎      | 86/256 [00:02<00:05, 33.10it/s, est. speed input: 40020.29 toks/s, output: 39.08 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:02<00:05, 32.99it/s, est. speed input: 39677.76 toks/s, output: 38.75 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:02<00:05, 32.26it/s, est. speed input: 39234.87 toks/s, output: 38.32 toks/s]
Processed prompts:  38%|███▊      | 98/256 [00:02<00:04, 31.75it/s, est. speed input: 38834.11 toks/s, output: 37.92 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:02<00:04, 31.53it/s, est. speed input: 38498.01 toks/s, output: 37.60 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:02<00:04, 31.52it/s, est. speed input: 38219.36 toks/s, output: 37.32 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:02<00:00, 145.44it/s, est. speed input: 55457.57 toks/s, output: 54.16 toks/s]
Processed prompts:  69%|██████▉   | 176/256 [00:03<00:01, 78.13it/s, est. speed input: 52365.77 toks/s, output: 51.14 toks/s] 
Processed prompts:  73%|███████▎  | 187/256 [00:03<00:01, 61.43it/s, est. speed input: 50842.44 toks/s, output: 49.65 toks/s]
Processed prompts:  77%|███████▋  | 196/256 [00:04<00:01, 49.79it/s, est. speed input: 49097.96 toks/s, output: 47.95 toks/s]
Processed prompts:  79%|███████▉  | 203/256 [00:04<00:01, 46.75it/s, est. speed input: 48572.50 toks/s, output: 47.43 toks/s]
Processed prompts:  82%|████████▏ | 209/256 [00:04<00:01, 43.01it/s, est. speed input: 47876.31 toks/s, output: 46.75 toks/s]
Processed prompts:  84%|████████▎ | 214/256 [00:04<00:01, 38.69it/s, est. speed input: 47023.65 toks/s, output: 45.92 toks/s]
Processed prompts:  86%|████████▌ | 219/256 [00:04<00:00, 38.51it/s, est. speed input: 46794.33 toks/s, output: 45.70 toks/s]
Processed prompts:  88%|████████▊ | 224/256 [00:04<00:00, 34.57it/s, est. speed input: 45980.49 toks/s, output: 44.90 toks/s]
Processed prompts:  89%|████████▉ | 228/256 [00:05<00:00, 33.83it/s, est. speed input: 45629.20 toks/s, output: 44.56 toks/s]
Processed prompts:  91%|█████████ | 232/256 [00:05<00:00, 33.21it/s, est. speed input: 45296.00 toks/s, output: 44.23 toks/s]
Processed prompts:  92%|█████████▏| 236/256 [00:05<00:00, 32.73it/s, est. speed input: 44981.32 toks/s, output: 43.93 toks/s]
Processed prompts:  94%|█████████▍| 240/256 [00:05<00:00, 32.30it/s, est. speed input: 44675.37 toks/s, output: 43.63 toks/s]
Processed prompts:  95%|█████████▌| 244/256 [00:05<00:00, 31.98it/s, est. speed input: 44384.01 toks/s, output: 43.34 toks/s]
Processed prompts:  97%|█████████▋| 248/256 [00:05<00:00, 31.66it/s, est. speed input: 44095.89 toks/s, output: 43.06 toks/s]
Processed prompts:  98%|█████████▊| 252/256 [00:05<00:00, 31.57it/s, est. speed input: 43835.43 toks/s, output: 42.81 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:06<00:00, 31.53it/s, est. speed input: 43588.76 toks/s, output: 42.57 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:06<00:00, 31.53it/s, est. speed input: 43588.76 toks/s, output: 42.57 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:06<00:00, 42.56it/s, est. speed input: 43588.76 toks/s, output: 42.57 toks/s]
[rank0]:[W125 20:40:44.457061451 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=4096 ==========
Time: 2026-01-25 20:40:47
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=512, max_num_seqs=4
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 512 --max-num-seqs 4 --max-model-len 1025 --max-num-batched-tokens 4096 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Llama3.2-3B-INT8_M4096.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 20:40:59 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 20:41:00 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=380763) WARNING 01-25 20:41:08 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=380763) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=380763) WARNING 01-25 20:41:18 [backends.py:609] Failed to read file <frozen os>
Throughput: 47.31 requests/s, 48489.15 total tokens/s, 47.31 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512

STDERR:
[2026-01-25 20:40:58] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 20:40:58] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 20:40:58] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 20:40:58] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:40:58] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:40:58] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:40:58] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:40:58] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:40:58] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 20:40:58] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 20:40:58] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 20:40:58] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 20:40:58] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 20:40:58] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 20:41:06] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 20:41:07] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 20:41:07] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 20:41:07] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:41:07] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:41:07] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:41:07] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:41:07] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:41:07] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 20:41:07] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 20:41:07] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 20:41:07] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 20:41:07] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 20:41:07] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=380763) [2026-01-25 20:41:08] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=380763) [2026-01-25 20:41:08] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=380763) [2026-01-25 20:41:08] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=380763) [2026-01-25 20:41:08] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=380763) [2026-01-25 20:41:08] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-3B-INT8
(EngineCore_DP0 pid=380763) [2026-01-25 20:41:08] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=380763) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=380763) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:01<00:00,  1.05s/it]
(EngineCore_DP0 pid=380763) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:01<00:00,  1.05s/it]
(EngineCore_DP0 pid=380763) 
(EngineCore_DP0 pid=380763) [2026-01-25 20:41:10] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 4096] -> 1D uint8
(EngineCore_DP0 pid=380763) [2026-01-25 20:41:10] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 15728640 bytes
(EngineCore_DP0 pid=380763) [2026-01-25 20:41:10] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 4096] -> 1D uint8
(EngineCore_DP0 pid=380763) [2026-01-25 20:41:10] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9437184 bytes
(EngineCore_DP0 pid=380763) [2026-01-25 20:41:10] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 4096] -> 1D uint8
(EngineCore_DP0 pid=380763) [2026-01-25 20:41:10] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 50331648 bytes
(EngineCore_DP0 pid=380763) [2026-01-25 20:41:10] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 10944] -> 1D uint8
(EngineCore_DP0 pid=380763) [2026-01-25 20:41:10] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 25264128 bytes
(EngineCore_DP0 pid=380763) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  25%|██▌       | 1/4 [00:00<00:00,  8.20it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 2/4 [00:00<00:00,  8.83it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  75%|███████▌  | 3/4 [00:00<00:00,  9.08it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  8.24it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  8.44it/s]
(EngineCore_DP0 pid=380763) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  33%|███▎      | 1/3 [00:00<00:00,  7.55it/s]
Capturing CUDA graphs (decode, FULL):  67%|██████▋   | 2/3 [00:00<00:00,  8.73it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  9.20it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  8.91it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   6%|▌         | 29/512 [00:00<00:01, 285.05it/s]
Adding requests:  12%|█▏        | 63/512 [00:00<00:01, 311.87it/s]
Adding requests:  19%|█▉        | 96/512 [00:00<00:01, 319.37it/s]
Adding requests:  25%|██▌       | 130/512 [00:00<00:01, 325.50it/s]
Adding requests:  32%|███▏      | 163/512 [00:00<00:01, 319.07it/s]
Adding requests:  38%|███▊      | 195/512 [00:00<00:01, 314.89it/s]
Adding requests:  45%|████▍     | 229/512 [00:00<00:00, 321.94it/s]
Adding requests:  51%|█████     | 262/512 [00:00<00:00, 322.50it/s]
Adding requests:  58%|█████▊    | 295/512 [00:00<00:00, 321.93it/s]
Adding requests:  64%|██████▍   | 328/512 [00:01<00:00, 311.63it/s]
Adding requests:  71%|███████   | 362/512 [00:01<00:00, 317.63it/s]
Adding requests:  77%|███████▋  | 396/512 [00:01<00:00, 321.62it/s]
Adding requests:  84%|████████▍ | 429/512 [00:01<00:00, 323.85it/s]
Adding requests:  90%|█████████ | 462/512 [00:01<00:00, 324.76it/s]
Adding requests:  97%|█████████▋| 495/512 [00:01<00:00, 323.98it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 319.42it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  14%|█▎        | 70/512 [00:00<00:01, 406.39it/s, est. speed input: 416216.45 toks/s, output: 406.41 toks/s]
Processed prompts:  22%|██▏       | 111/512 [00:01<00:04, 92.22it/s, est. speed input: 110608.87 toks/s, output: 108.02 toks/s]
Processed prompts:  26%|██▌       | 131/512 [00:01<00:05, 74.61it/s, est. speed input: 92076.54 toks/s, output: 89.92 toks/s]  
Processed prompts:  28%|██▊       | 144/512 [00:01<00:05, 68.63it/s, est. speed input: 86019.57 toks/s, output: 84.00 toks/s]
Processed prompts:  30%|███       | 154/512 [00:01<00:05, 60.89it/s, est. speed input: 80026.31 toks/s, output: 78.15 toks/s]
Processed prompts:  32%|███▏      | 162/512 [00:02<00:06, 58.11it/s, est. speed input: 77477.57 toks/s, output: 75.66 toks/s]
Processed prompts:  33%|███▎      | 170/512 [00:02<00:06, 55.53it/s, est. speed input: 75258.40 toks/s, output: 73.49 toks/s]
Processed prompts:  35%|███▍      | 178/512 [00:02<00:06, 53.45it/s, est. speed input: 73386.21 toks/s, output: 71.67 toks/s]
Processed prompts:  36%|███▋      | 186/512 [00:02<00:06, 51.74it/s, est. speed input: 71742.60 toks/s, output: 70.06 toks/s]
Processed prompts:  38%|███▊      | 194/512 [00:02<00:06, 50.42it/s, est. speed input: 70301.90 toks/s, output: 68.65 toks/s]
Processed prompts:  39%|███▉      | 202/512 [00:02<00:06, 49.45it/s, est. speed input: 69034.06 toks/s, output: 67.42 toks/s]
Processed prompts:  41%|████      | 210/512 [00:03<00:06, 48.73it/s, est. speed input: 67902.35 toks/s, output: 66.31 toks/s]
Processed prompts:  43%|████▎     | 218/512 [00:03<00:06, 48.14it/s, est. speed input: 66869.76 toks/s, output: 65.30 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:03<00:05, 47.74it/s, est. speed input: 65945.51 toks/s, output: 64.40 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:03<00:05, 47.46it/s, est. speed input: 65106.69 toks/s, output: 63.58 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:03<00:05, 47.47it/s, est. speed input: 64385.78 toks/s, output: 62.88 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:04<00:05, 48.38it/s, est. speed input: 63894.94 toks/s, output: 62.40 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:04<00:05, 49.03it/s, est. speed input: 63439.49 toks/s, output: 61.95 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:04<00:00, 198.65it/s, est. speed input: 82629.48 toks/s, output: 80.69 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [00:04<00:01, 124.21it/s, est. speed input: 80057.03 toks/s, output: 78.18 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [00:05<00:01, 97.23it/s, est. speed input: 78272.11 toks/s, output: 76.44 toks/s] 
Processed prompts:  78%|███████▊  | 399/512 [00:05<00:01, 85.29it/s, est. speed input: 77274.77 toks/s, output: 75.46 toks/s]
Processed prompts:  80%|████████  | 410/512 [00:05<00:01, 74.14it/s, est. speed input: 75995.75 toks/s, output: 74.21 toks/s]
Processed prompts:  82%|████████▏ | 419/512 [00:05<00:01, 70.46it/s, est. speed input: 75504.18 toks/s, output: 73.73 toks/s]
Processed prompts:  83%|████████▎ | 427/512 [00:05<00:01, 65.81it/s, est. speed input: 74862.69 toks/s, output: 73.11 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [00:05<00:01, 60.33it/s, est. speed input: 74074.55 toks/s, output: 72.34 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [00:06<00:01, 57.72it/s, est. speed input: 73497.18 toks/s, output: 71.77 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [00:06<00:01, 55.64it/s, est. speed input: 72939.18 toks/s, output: 71.23 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [00:06<00:01, 53.92it/s, est. speed input: 72387.55 toks/s, output: 70.69 toks/s]
Processed prompts:  91%|█████████ | 466/512 [00:06<00:00, 51.78it/s, est. speed input: 71758.57 toks/s, output: 70.08 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [00:06<00:00, 50.20it/s, est. speed input: 71153.72 toks/s, output: 69.48 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [00:06<00:00, 49.14it/s, est. speed input: 70578.59 toks/s, output: 68.92 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [00:07<00:00, 48.40it/s, est. speed input: 70034.55 toks/s, output: 68.39 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [00:07<00:00, 47.88it/s, est. speed input: 69515.27 toks/s, output: 67.89 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [00:07<00:00, 47.49it/s, est. speed input: 69015.45 toks/s, output: 67.40 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:07<00:00, 47.49it/s, est. speed input: 69208.88 toks/s, output: 67.59 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:07<00:00, 67.59it/s, est. speed input: 69208.88 toks/s, output: 67.59 toks/s]
[rank0]:[W125 20:41:46.608072497 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=8192 ==========
Time: 2026-01-25 20:41:49
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=1024, max_num_seqs=8
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 1024 --max-num-seqs 8 --max-model-len 1025 --max-num-batched-tokens 8192 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Llama3.2-3B-INT8_M8192.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 20:42:04 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 20:42:05 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=381899) WARNING 01-25 20:42:12 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=381899) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=381899) WARNING 01-25 20:42:23 [backends.py:609] Failed to read file <frozen os>
Throughput: 45.54 requests/s, 46683.13 total tokens/s, 45.54 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024

STDERR:
[2026-01-25 20:42:03] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 20:42:03] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 20:42:03] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 20:42:03] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:42:03] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:42:03] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:42:03] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:42:03] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:42:03] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 20:42:03] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 20:42:03] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 20:42:03] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 20:42:03] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 20:42:03] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 20:42:11] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 20:42:12] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 20:42:12] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 20:42:12] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:42:12] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:42:12] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:42:12] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:42:12] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:42:12] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 20:42:12] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 20:42:12] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 20:42:12] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 20:42:12] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 20:42:12] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=381899) [2026-01-25 20:42:13] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=381899) [2026-01-25 20:42:13] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=381899) [2026-01-25 20:42:13] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=381899) [2026-01-25 20:42:13] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=381899) [2026-01-25 20:42:13] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-3B-INT8
(EngineCore_DP0 pid=381899) [2026-01-25 20:42:13] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=381899) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=381899) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:01<00:00,  1.08s/it]
(EngineCore_DP0 pid=381899) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:01<00:00,  1.08s/it]
(EngineCore_DP0 pid=381899) 
(EngineCore_DP0 pid=381899) [2026-01-25 20:42:13] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 4096] -> 1D uint8
(EngineCore_DP0 pid=381899) [2026-01-25 20:42:13] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 15728640 bytes
(EngineCore_DP0 pid=381899) [2026-01-25 20:42:13] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 4096] -> 1D uint8
(EngineCore_DP0 pid=381899) [2026-01-25 20:42:13] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9437184 bytes
(EngineCore_DP0 pid=381899) [2026-01-25 20:42:13] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 4096] -> 1D uint8
(EngineCore_DP0 pid=381899) [2026-01-25 20:42:13] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 50331648 bytes
(EngineCore_DP0 pid=381899) [2026-01-25 20:42:13] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 10944] -> 1D uint8
(EngineCore_DP0 pid=381899) [2026-01-25 20:42:13] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 25264128 bytes
(EngineCore_DP0 pid=381899) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:02,  1.99it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  40%|████      | 2/5 [00:00<00:00,  3.12it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  60%|██████    | 3/5 [00:01<00:00,  2.96it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  80%|████████  | 4/5 [00:01<00:00,  4.06it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:01<00:00,  4.81it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:01<00:00,  3.84it/s]
(EngineCore_DP0 pid=381899) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:00,  7.49it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 2/4 [00:00<00:00,  8.69it/s]
Capturing CUDA graphs (decode, FULL):  75%|███████▌  | 3/4 [00:00<00:00,  9.07it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  9.31it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  9.02it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   3%|▎         | 29/1024 [00:00<00:03, 288.06it/s]
Adding requests:   6%|▌         | 62/1024 [00:00<00:03, 310.71it/s]
Adding requests:   9%|▉         | 94/1024 [00:00<00:02, 311.90it/s]
Adding requests:  12%|█▏        | 127/1024 [00:00<00:02, 316.75it/s]
Adding requests:  16%|█▌        | 159/1024 [00:00<00:02, 313.48it/s]
Adding requests:  19%|█▊        | 191/1024 [00:00<00:02, 311.04it/s]
Adding requests:  22%|██▏       | 224/1024 [00:00<00:02, 315.15it/s]
Adding requests:  25%|██▌       | 256/1024 [00:00<00:02, 312.96it/s]
Adding requests:  28%|██▊       | 288/1024 [00:00<00:02, 314.77it/s]
Adding requests:  31%|███▏      | 320/1024 [00:01<00:02, 315.97it/s]
Adding requests:  34%|███▍      | 353/1024 [00:01<00:02, 319.73it/s]
Adding requests:  38%|███▊      | 385/1024 [00:01<00:02, 317.45it/s]
Adding requests:  41%|████      | 420/1024 [00:01<00:01, 325.31it/s]
Adding requests:  44%|████▍     | 453/1024 [00:01<00:01, 323.88it/s]
Adding requests:  47%|████▋     | 486/1024 [00:01<00:01, 323.67it/s]
Adding requests:  51%|█████     | 519/1024 [00:01<00:01, 318.61it/s]
Adding requests:  54%|█████▍    | 552/1024 [00:01<00:01, 318.47it/s]
Adding requests:  57%|█████▋    | 584/1024 [00:01<00:01, 317.67it/s]
Adding requests:  60%|██████    | 616/1024 [00:01<00:01, 317.38it/s]
Adding requests: 100%|██████████| 1024/1024 [00:01<00:00, 678.96it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  13%|█▎        | 130/1024 [00:00<00:00, 1001.07it/s, est. speed input: 1025396.36 toks/s, output: 1001.20 toks/s]
Processed prompts:  23%|██▎       | 231/1024 [00:02<00:09, 86.94it/s, est. speed input: 105255.99 toks/s, output: 102.79 toks/s]    
Processed prompts:  27%|██▋       | 276/1024 [00:03<00:10, 70.46it/s, est. speed input: 87026.61 toks/s, output: 84.99 toks/s]  
Processed prompts:  29%|██▉       | 302/1024 [00:03<00:10, 66.72it/s, est. speed input: 82746.75 toks/s, output: 80.81 toks/s]
Processed prompts:  31%|███▏      | 320/1024 [00:04<00:10, 64.74it/s, est. speed input: 80632.26 toks/s, output: 78.74 toks/s]
Processed prompts:  33%|███▎      | 334/1024 [00:04<00:11, 60.48it/s, est. speed input: 77909.83 toks/s, output: 76.08 toks/s]
Processed prompts:  34%|███▎      | 345/1024 [00:04<00:11, 61.33it/s, est. speed input: 77592.23 toks/s, output: 75.77 toks/s]
Processed prompts:  35%|███▍      | 355/1024 [00:04<00:12, 53.38it/s, est. speed input: 74506.79 toks/s, output: 72.76 toks/s]
Processed prompts:  35%|███▌      | 363/1024 [00:05<00:12, 52.69it/s, est. speed input: 73716.76 toks/s, output: 71.99 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:05<00:12, 50.43it/s, est. speed input: 72667.60 toks/s, output: 70.96 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:05<00:13, 49.33it/s, est. speed input: 71811.03 toks/s, output: 70.13 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:05<00:13, 48.37it/s, est. speed input: 71004.62 toks/s, output: 69.34 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [00:05<00:13, 47.58it/s, est. speed input: 70245.56 toks/s, output: 68.60 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:05<00:13, 46.93it/s, est. speed input: 69526.62 toks/s, output: 67.90 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:06<00:13, 46.48it/s, est. speed input: 68855.77 toks/s, output: 67.24 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:06<00:13, 46.12it/s, est. speed input: 68219.69 toks/s, output: 66.62 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:06<00:13, 45.85it/s, est. speed input: 67617.61 toks/s, output: 66.03 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:06<00:12, 45.67it/s, est. speed input: 67048.67 toks/s, output: 65.48 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:06<00:12, 45.52it/s, est. speed input: 66507.33 toks/s, output: 64.95 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:06<00:12, 45.42it/s, est. speed input: 65993.48 toks/s, output: 64.45 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:07<00:12, 45.34it/s, est. speed input: 65504.26 toks/s, output: 63.97 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:07<00:12, 45.32it/s, est. speed input: 65042.92 toks/s, output: 63.52 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:07<00:12, 45.30it/s, est. speed input: 64602.99 toks/s, output: 63.09 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:07<00:11, 45.30it/s, est. speed input: 64185.10 toks/s, output: 62.68 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:07<00:11, 45.29it/s, est. speed input: 63784.20 toks/s, output: 62.29 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:08<00:11, 45.31it/s, est. speed input: 63403.93 toks/s, output: 61.92 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:08<00:11, 45.29it/s, est. speed input: 63036.62 toks/s, output: 61.56 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:08<00:11, 45.33it/s, est. speed input: 62689.87 toks/s, output: 61.22 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:08<00:11, 45.32it/s, est. speed input: 62353.67 toks/s, output: 60.89 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:08<00:10, 45.29it/s, est. speed input: 62029.85 toks/s, output: 60.58 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:08<00:10, 45.28it/s, est. speed input: 61719.08 toks/s, output: 60.27 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:09<00:10, 45.25it/s, est. speed input: 61418.55 toks/s, output: 59.98 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:09<00:10, 45.22it/s, est. speed input: 61128.20 toks/s, output: 59.70 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:09<00:10, 45.21it/s, est. speed input: 60849.82 toks/s, output: 59.42 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:09<00:10, 45.21it/s, est. speed input: 60582.48 toks/s, output: 59.16 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:09<00:09, 45.23it/s, est. speed input: 60326.21 toks/s, output: 58.91 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:09<00:09, 45.23it/s, est. speed input: 60077.98 toks/s, output: 58.67 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:10<00:09, 45.21it/s, est. speed input: 59837.44 toks/s, output: 58.43 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:10<00:09, 45.21it/s, est. speed input: 59605.63 toks/s, output: 58.21 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:10<00:09, 45.23it/s, est. speed input: 59383.00 toks/s, output: 57.99 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:10<00:08, 45.25it/s, est. speed input: 59168.48 toks/s, output: 57.78 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:10<00:08, 45.24it/s, est. speed input: 58958.80 toks/s, output: 57.58 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:11<00:08, 45.47it/s, est. speed input: 58772.76 toks/s, output: 57.40 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:11<00:08, 46.46it/s, est. speed input: 58646.76 toks/s, output: 57.27 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:11<00:07, 47.23it/s, est. speed input: 58527.38 toks/s, output: 57.16 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:11<00:07, 47.79it/s, est. speed input: 58411.49 toks/s, output: 57.04 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:11<00:07, 48.17it/s, est. speed input: 58297.98 toks/s, output: 56.93 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:11<00:07, 48.40it/s, est. speed input: 58185.18 toks/s, output: 56.82 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:12<00:07, 48.58it/s, est. speed input: 58076.45 toks/s, output: 56.72 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:12<00:06, 48.70it/s, est. speed input: 57970.22 toks/s, output: 56.61 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:12<00:06, 48.78it/s, est. speed input: 57866.90 toks/s, output: 56.51 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:12<00:06, 48.83it/s, est. speed input: 57765.76 toks/s, output: 56.41 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:12<00:06, 48.82it/s, est. speed input: 57664.97 toks/s, output: 56.31 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:12<00:06, 48.83it/s, est. speed input: 57567.35 toks/s, output: 56.22 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:13<00:06, 48.85it/s, est. speed input: 57473.02 toks/s, output: 56.13 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:13<00:05, 48.66it/s, est. speed input: 57371.06 toks/s, output: 56.03 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:13<00:05, 47.54it/s, est. speed input: 57222.89 toks/s, output: 55.88 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:13<00:05, 46.78it/s, est. speed input: 57077.88 toks/s, output: 55.74 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:13<00:05, 46.27it/s, est. speed input: 56937.39 toks/s, output: 55.60 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:13<00:05, 45.92it/s, est. speed input: 56800.04 toks/s, output: 55.47 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:14<00:05, 45.67it/s, est. speed input: 56666.26 toks/s, output: 55.34 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:14<00:05, 45.53it/s, est. speed input: 56537.47 toks/s, output: 55.21 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:14<00:05, 45.42it/s, est. speed input: 56410.99 toks/s, output: 55.09 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:14<00:04, 45.34it/s, est. speed input: 56287.33 toks/s, output: 54.97 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:14<00:04, 45.29it/s, est. speed input: 56166.90 toks/s, output: 54.85 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:14<00:04, 45.23it/s, est. speed input: 56048.26 toks/s, output: 54.73 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:15<00:04, 45.19it/s, est. speed input: 55932.74 toks/s, output: 54.62 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:15<00:04, 45.17it/s, est. speed input: 55819.77 toks/s, output: 54.51 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [00:15<00:04, 45.14it/s, est. speed input: 55709.04 toks/s, output: 54.40 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [00:15<00:03, 45.11it/s, est. speed input: 55600.40 toks/s, output: 54.30 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:15<00:03, 45.11it/s, est. speed input: 55495.00 toks/s, output: 54.19 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [00:16<00:03, 45.10it/s, est. speed input: 55391.39 toks/s, output: 54.09 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [00:16<00:03, 45.09it/s, est. speed input: 55290.15 toks/s, output: 53.99 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [00:16<00:03, 45.09it/s, est. speed input: 55191.25 toks/s, output: 53.90 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [00:16<00:02, 45.08it/s, est. speed input: 55094.02 toks/s, output: 53.80 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [00:16<00:02, 45.09it/s, est. speed input: 54999.54 toks/s, output: 53.71 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [00:16<00:02, 45.08it/s, est. speed input: 54906.61 toks/s, output: 53.62 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [00:17<00:02, 45.07it/s, est. speed input: 54815.05 toks/s, output: 53.53 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [00:17<00:02, 45.08it/s, est. speed input: 54726.33 toks/s, output: 53.44 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [00:17<00:02, 45.07it/s, est. speed input: 54638.87 toks/s, output: 53.36 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [00:17<00:01, 45.10it/s, est. speed input: 54554.53 toks/s, output: 53.28 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [00:17<00:01, 45.12it/s, est. speed input: 54471.63 toks/s, output: 53.19 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [00:17<00:01, 45.14it/s, est. speed input: 54390.72 toks/s, output: 53.12 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [00:18<00:01, 45.14it/s, est. speed input: 54311.01 toks/s, output: 53.04 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [00:18<00:01, 45.13it/s, est. speed input: 54232.27 toks/s, output: 52.96 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [00:18<00:01, 45.51it/s, est. speed input: 54169.86 toks/s, output: 52.90 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [00:18<00:00, 46.44it/s, est. speed input: 54132.64 toks/s, output: 52.86 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [00:18<00:00, 47.11it/s, est. speed input: 54095.91 toks/s, output: 52.83 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [00:18<00:00, 47.62it/s, est. speed input: 54060.78 toks/s, output: 52.79 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [00:19<00:00, 47.99it/s, est. speed input: 54026.46 toks/s, output: 52.76 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [00:19<00:00, 49.92it/s, est. speed input: 54044.33 toks/s, output: 52.78 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:19<00:00, 49.92it/s, est. speed input: 54362.15 toks/s, output: 53.09 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:19<00:00, 53.09it/s, est. speed input: 54362.15 toks/s, output: 53.09 toks/s]
[rank0]:[W125 20:43:03.196632171 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=16384 ==========
Time: 2026-01-25 20:43:06
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=2048, max_num_seqs=16
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 2048 --max-num-seqs 16 --max-model-len 1025 --max-num-batched-tokens 16384 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Llama3.2-3B-INT8_M16384.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 20:43:25 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 20:43:26 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=383281) WARNING 01-25 20:43:34 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=383281) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=383281) WARNING 01-25 20:43:46 [backends.py:609] Failed to read file <frozen os>
Throughput: 45.75 requests/s, 46896.37 total tokens/s, 45.75 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048

STDERR:
[2026-01-25 20:43:25] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 20:43:25] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 20:43:25] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 20:43:25] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:43:25] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:43:25] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:43:25] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:43:25] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:43:25] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 20:43:25] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 20:43:25] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 20:43:25] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 20:43:25] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 20:43:25] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 20:43:34] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 20:43:34] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 20:43:34] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 20:43:34] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:43:34] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:43:34] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:43:34] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:43:34] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:43:34] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 20:43:34] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 20:43:34] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 20:43:34] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 20:43:34] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 20:43:34] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=383281) [2026-01-25 20:43:35] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=383281) [2026-01-25 20:43:35] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=383281) [2026-01-25 20:43:35] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=383281) [2026-01-25 20:43:35] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=383281) [2026-01-25 20:43:35] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-3B-INT8
(EngineCore_DP0 pid=383281) [2026-01-25 20:43:35] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=383281) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=383281) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:01<00:00,  1.00s/it]
(EngineCore_DP0 pid=383281) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:01<00:00,  1.00s/it]
(EngineCore_DP0 pid=383281) 
(EngineCore_DP0 pid=383281) [2026-01-25 20:43:36] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 4096] -> 1D uint8
(EngineCore_DP0 pid=383281) [2026-01-25 20:43:36] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 15728640 bytes
(EngineCore_DP0 pid=383281) [2026-01-25 20:43:36] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 4096] -> 1D uint8
(EngineCore_DP0 pid=383281) [2026-01-25 20:43:36] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9437184 bytes
(EngineCore_DP0 pid=383281) [2026-01-25 20:43:36] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 4096] -> 1D uint8
(EngineCore_DP0 pid=383281) [2026-01-25 20:43:36] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 50331648 bytes
(EngineCore_DP0 pid=383281) [2026-01-25 20:43:36] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 10944] -> 1D uint8
(EngineCore_DP0 pid=383281) [2026-01-25 20:43:36] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 25264128 bytes
(EngineCore_DP0 pid=383281) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  14%|█▍        | 1/7 [00:00<00:00,  7.88it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  29%|██▊       | 2/7 [00:00<00:00,  8.22it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  43%|████▎     | 3/7 [00:00<00:00,  8.65it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  57%|█████▋    | 4/7 [00:00<00:00,  8.93it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  71%|███████▏  | 5/7 [00:00<00:00,  8.78it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  86%|████████▌ | 6/7 [00:00<00:00,  8.58it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00,  7.76it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00,  8.21it/s]
(EngineCore_DP0 pid=383281) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  20%|██        | 1/5 [00:00<00:00,  6.70it/s]
Capturing CUDA graphs (decode, FULL):  40%|████      | 2/5 [00:00<00:00,  7.70it/s]
Capturing CUDA graphs (decode, FULL):  60%|██████    | 3/5 [00:00<00:00,  8.11it/s]
Capturing CUDA graphs (decode, FULL):  80%|████████  | 4/5 [00:00<00:00,  8.30it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00,  8.39it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00,  8.14it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 31/2048 [00:00<00:06, 302.94it/s]
Adding requests:   3%|▎         | 65/2048 [00:00<00:06, 321.28it/s]
Adding requests:   5%|▍         | 98/2048 [00:00<00:06, 319.36it/s]
Adding requests:   6%|▋         | 131/2048 [00:00<00:05, 319.59it/s]
Adding requests:   8%|▊         | 163/2048 [00:00<00:06, 310.49it/s]
Adding requests:  10%|▉         | 195/2048 [00:00<00:05, 311.58it/s]
Adding requests:  11%|█         | 230/2048 [00:00<00:05, 321.88it/s]
Adding requests:  13%|█▎        | 263/2048 [00:00<00:05, 323.51it/s]
Adding requests:  14%|█▍        | 296/2048 [00:00<00:05, 323.12it/s]
Adding requests:  16%|█▌        | 329/2048 [00:01<00:05, 321.91it/s]
Adding requests:  18%|█▊        | 363/2048 [00:01<00:05, 326.93it/s]
Adding requests:  19%|█▉        | 396/2048 [00:01<00:05, 323.73it/s]
Adding requests:  21%|██        | 429/2048 [00:01<00:04, 324.15it/s]
Adding requests:  23%|██▎       | 462/2048 [00:01<00:04, 323.41it/s]
Adding requests:  24%|██▍       | 495/2048 [00:01<00:04, 318.90it/s]
Adding requests:  26%|██▌       | 527/2048 [00:01<00:04, 310.36it/s]
Adding requests:  27%|██▋       | 560/2048 [00:01<00:04, 315.25it/s]
Adding requests:  29%|██▉       | 594/2048 [00:01<00:04, 321.02it/s]
Adding requests:  31%|███       | 627/2048 [00:01<00:04, 322.62it/s]
Adding requests:  32%|███▏      | 661/2048 [00:02<00:04, 324.89it/s]
Adding requests:  34%|███▍      | 695/2048 [00:02<00:04, 327.10it/s]
Adding requests:  36%|███▌      | 728/2048 [00:02<00:04, 325.65it/s]
Adding requests:  37%|███▋      | 761/2048 [00:02<00:03, 323.84it/s]
Adding requests:  39%|███▉      | 795/2048 [00:02<00:03, 327.06it/s]
Adding requests:  40%|████      | 828/2048 [00:02<00:03, 327.25it/s]
Adding requests:  42%|████▏     | 861/2048 [00:02<00:03, 321.23it/s]
Adding requests:  44%|████▍     | 900/2048 [00:02<00:03, 339.20it/s]
Adding requests:  46%|████▌     | 937/2048 [00:02<00:03, 347.71it/s]
Adding requests:  48%|████▊     | 974/2048 [00:02<00:03, 353.86it/s]
Adding requests:  49%|████▉     | 1012/2048 [00:03<00:02, 360.05it/s]
Adding requests:  51%|█████▏    | 1050/2048 [00:03<00:02, 363.87it/s]
Adding requests:  53%|█████▎    | 1087/2048 [00:03<00:02, 360.83it/s]
Adding requests:  55%|█████▍    | 1124/2048 [00:03<00:02, 358.49it/s]
Adding requests:  57%|█████▋    | 1163/2048 [00:03<00:02, 365.55it/s]
Adding requests:  59%|█████▊    | 1202/2048 [00:03<00:02, 372.26it/s]
Adding requests:  61%|██████    | 1240/2048 [00:03<00:02, 371.30it/s]
Adding requests:  62%|██████▏   | 1278/2048 [00:03<00:02, 365.40it/s]
Adding requests:  64%|██████▍   | 1315/2048 [00:03<00:02, 366.01it/s]
Adding requests:  66%|██████▌   | 1353/2048 [00:04<00:01, 368.17it/s]
Adding requests:  68%|██████▊   | 1391/2048 [00:04<00:01, 370.50it/s]
Adding requests:  70%|██████▉   | 1429/2048 [00:04<00:01, 370.83it/s]
Adding requests:  72%|███████▏  | 1467/2048 [00:04<00:01, 368.89it/s]
Adding requests:  73%|███████▎  | 1504/2048 [00:04<00:01, 367.91it/s]
Adding requests:  75%|███████▌  | 1541/2048 [00:04<00:01, 363.84it/s]
Adding requests:  77%|███████▋  | 1578/2048 [00:04<00:01, 361.08it/s]
Adding requests:  79%|███████▉  | 1615/2048 [00:04<00:01, 362.29it/s]
Adding requests:  81%|████████  | 1652/2048 [00:04<00:01, 362.34it/s]
Adding requests:  82%|████████▏ | 1689/2048 [00:04<00:01, 357.18it/s]
Adding requests:  84%|████████▍ | 1727/2048 [00:05<00:00, 362.28it/s]
Adding requests:  86%|████████▌ | 1764/2048 [00:05<00:00, 360.38it/s]
Adding requests:  88%|████████▊ | 1801/2048 [00:05<00:00, 355.10it/s]
Adding requests:  90%|████████▉ | 1837/2048 [00:05<00:00, 346.74it/s]
Adding requests:  91%|█████████▏| 1872/2048 [00:05<00:00, 340.28it/s]
Adding requests:  93%|█████████▎| 1907/2048 [00:05<00:00, 335.93it/s]
Adding requests:  95%|█████████▍| 1941/2048 [00:05<00:00, 334.10it/s]
Adding requests:  96%|█████████▋| 1976/2048 [00:05<00:00, 337.10it/s]
Adding requests:  98%|█████████▊| 2010/2048 [00:05<00:00, 326.21it/s]
Adding requests: 100%|█████████▉| 2044/2048 [00:05<00:00, 329.70it/s]
Adding requests: 100%|██████████| 2048/2048 [00:06<00:00, 341.01it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  13%|█▎        | 258/2048 [00:00<00:01, 1132.96it/s, est. speed input: 1160297.55 toks/s, output: 1133.01 toks/s]
Processed prompts:  18%|█▊        | 372/2048 [00:02<00:15, 111.06it/s, est. speed input: 139994.26 toks/s, output: 136.71 toks/s]   
Processed prompts:  21%|██        | 422/2048 [00:03<00:18, 87.58it/s, est. speed input: 114028.29 toks/s, output: 111.36 toks/s] 
Processed prompts:  22%|██▏       | 451/2048 [00:04<00:20, 76.30it/s, est. speed input: 103257.03 toks/s, output: 100.84 toks/s]
Processed prompts:  23%|██▎       | 471/2048 [00:04<00:21, 74.01it/s, est. speed input: 100443.20 toks/s, output: 98.09 toks/s] 
Processed prompts:  24%|██▎       | 486/2048 [00:05<00:22, 69.10it/s, est. speed input: 97003.18 toks/s, output: 94.73 toks/s] 
Processed prompts:  24%|██▍       | 498/2048 [00:05<00:24, 62.35it/s, est. speed input: 93286.05 toks/s, output: 91.10 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [00:05<00:25, 59.33it/s, est. speed input: 90818.04 toks/s, output: 88.69 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [00:06<00:26, 56.78it/s, est. speed input: 88618.80 toks/s, output: 86.54 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [00:06<00:27, 54.71it/s, est. speed input: 86639.89 toks/s, output: 84.61 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [00:06<00:11, 121.60it/s, est. speed input: 97458.19 toks/s, output: 95.17 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [00:07<00:13, 100.99it/s, est. speed input: 95238.36 toks/s, output: 93.01 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [00:07<00:16, 84.99it/s, est. speed input: 93055.08 toks/s, output: 90.87 toks/s] 
Processed prompts:  34%|███▎      | 690/2048 [00:07<00:18, 72.72it/s, est. speed input: 90891.12 toks/s, output: 88.76 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [00:08<00:20, 64.24it/s, est. speed input: 88915.62 toks/s, output: 86.83 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [00:08<00:22, 58.36it/s, est. speed input: 87107.10 toks/s, output: 85.07 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [00:08<00:24, 54.28it/s, est. speed input: 85445.08 toks/s, output: 83.44 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [00:09<00:25, 51.42it/s, est. speed input: 83908.14 toks/s, output: 81.94 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [00:09<00:25, 49.42it/s, est. speed input: 82486.06 toks/s, output: 80.55 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [00:09<00:26, 48.04it/s, est. speed input: 81169.70 toks/s, output: 79.27 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [00:10<00:26, 47.08it/s, est. speed input: 79944.22 toks/s, output: 78.07 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [00:10<00:26, 46.39it/s, est. speed input: 78799.62 toks/s, output: 76.95 toks/s]
Processed prompts:  41%|████      | 834/2048 [00:10<00:26, 45.92it/s, est. speed input: 77730.57 toks/s, output: 75.91 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [00:11<00:26, 45.58it/s, est. speed input: 76726.79 toks/s, output: 74.93 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [00:11<00:26, 45.35it/s, est. speed input: 75785.31 toks/s, output: 74.01 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [00:12<00:25, 45.19it/s, est. speed input: 74900.38 toks/s, output: 73.14 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [00:12<00:25, 45.07it/s, est. speed input: 74065.21 toks/s, output: 72.33 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [00:12<00:24, 45.44it/s, est. speed input: 73344.92 toks/s, output: 71.63 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [00:13<00:24, 46.32it/s, est. speed input: 72748.97 toks/s, output: 71.04 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [00:13<00:23, 46.96it/s, est. speed input: 72182.06 toks/s, output: 70.49 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [00:13<00:22, 47.40it/s, est. speed input: 71640.27 toks/s, output: 69.96 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [00:14<00:22, 47.72it/s, est. speed input: 71125.48 toks/s, output: 69.46 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [00:14<00:21, 47.95it/s, est. speed input: 70633.31 toks/s, output: 68.98 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [00:14<00:21, 48.11it/s, est. speed input: 70164.01 toks/s, output: 68.52 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [00:15<00:21, 48.23it/s, est. speed input: 69715.69 toks/s, output: 68.08 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [00:15<00:21, 47.90it/s, est. speed input: 69243.58 toks/s, output: 67.62 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [00:15<00:21, 46.91it/s, est. speed input: 68712.82 toks/s, output: 67.10 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [00:16<00:21, 46.24it/s, est. speed input: 68204.88 toks/s, output: 66.61 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [00:16<00:20, 45.78it/s, est. speed input: 67718.72 toks/s, output: 66.13 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [00:16<00:20, 45.46it/s, est. speed input: 67253.16 toks/s, output: 65.68 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [00:17<00:20, 45.23it/s, est. speed input: 66806.62 toks/s, output: 65.24 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [00:17<00:20, 45.08it/s, est. speed input: 66378.24 toks/s, output: 64.82 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [00:17<00:19, 45.72it/s, est. speed input: 66038.57 toks/s, output: 64.49 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [00:18<00:19, 45.41it/s, est. speed input: 65641.70 toks/s, output: 64.10 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [00:18<00:19, 45.21it/s, est. speed input: 65260.99 toks/s, output: 63.73 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [00:18<00:18, 45.06it/s, est. speed input: 64893.89 toks/s, output: 63.37 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [00:19<00:18, 44.96it/s, est. speed input: 64540.42 toks/s, output: 63.03 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [00:19<00:18, 44.90it/s, est. speed input: 64200.16 toks/s, output: 62.70 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [00:20<00:17, 44.84it/s, est. speed input: 63871.14 toks/s, output: 62.37 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [00:20<00:17, 44.80it/s, est. speed input: 63554.19 toks/s, output: 62.06 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [00:20<00:17, 44.82it/s, est. speed input: 63251.01 toks/s, output: 61.77 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [00:21<00:16, 45.84it/s, est. speed input: 63037.03 toks/s, output: 61.56 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [00:21<00:15, 46.60it/s, est. speed input: 62830.14 toks/s, output: 61.36 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [00:21<00:15, 47.14it/s, est. speed input: 62629.81 toks/s, output: 61.16 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [00:22<00:14, 47.52it/s, est. speed input: 62434.81 toks/s, output: 60.97 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [00:22<00:14, 47.79it/s, est. speed input: 62245.62 toks/s, output: 60.79 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [00:22<00:13, 47.98it/s, est. speed input: 62061.60 toks/s, output: 60.61 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [00:23<00:13, 48.11it/s, est. speed input: 61882.68 toks/s, output: 60.43 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [00:23<00:13, 47.90it/s, est. speed input: 61690.55 toks/s, output: 60.24 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [00:23<00:13, 46.90it/s, est. speed input: 61451.24 toks/s, output: 60.01 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [00:24<00:13, 46.23it/s, est. speed input: 61219.24 toks/s, output: 59.78 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [00:24<00:12, 45.76it/s, est. speed input: 60993.39 toks/s, output: 59.56 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [00:24<00:12, 45.44it/s, est. speed input: 60773.97 toks/s, output: 59.35 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [00:25<00:12, 45.21it/s, est. speed input: 60560.60 toks/s, output: 59.14 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [00:25<00:12, 45.05it/s, est. speed input: 60353.31 toks/s, output: 58.94 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [00:25<00:11, 44.94it/s, est. speed input: 60151.28 toks/s, output: 58.74 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [00:26<00:11, 44.86it/s, est. speed input: 59954.73 toks/s, output: 58.55 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [00:26<00:11, 44.80it/s, est. speed input: 59763.70 toks/s, output: 58.36 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [00:26<00:10, 44.77it/s, est. speed input: 59577.91 toks/s, output: 58.18 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [00:27<00:10, 44.75it/s, est. speed input: 59397.10 toks/s, output: 58.00 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [00:27<00:09, 44.73it/s, est. speed input: 59220.78 toks/s, output: 57.83 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [00:28<00:09, 44.70it/s, est. speed input: 59048.11 toks/s, output: 57.66 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [00:28<00:09, 44.69it/s, est. speed input: 58880.10 toks/s, output: 57.50 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [00:28<00:08, 45.29it/s, est. speed input: 58749.12 toks/s, output: 57.37 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [00:29<00:08, 46.18it/s, est. speed input: 58644.76 toks/s, output: 57.27 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [00:29<00:07, 46.81it/s, est. speed input: 58542.07 toks/s, output: 57.17 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [00:29<00:07, 47.28it/s, est. speed input: 58442.36 toks/s, output: 57.07 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [00:30<00:07, 47.61it/s, est. speed input: 58344.90 toks/s, output: 56.98 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [00:30<00:06, 47.84it/s, est. speed input: 58249.36 toks/s, output: 56.88 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [00:30<00:06, 48.00it/s, est. speed input: 58155.62 toks/s, output: 56.79 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [00:31<00:05, 48.12it/s, est. speed input: 58064.09 toks/s, output: 56.70 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [00:31<00:05, 47.97it/s, est. speed input: 57964.57 toks/s, output: 56.61 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [00:31<00:05, 46.92it/s, est. speed input: 57826.53 toks/s, output: 56.47 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [00:32<00:05, 46.22it/s, est. speed input: 57691.66 toks/s, output: 56.34 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [00:32<00:04, 45.73it/s, est. speed input: 57559.26 toks/s, output: 56.21 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [00:32<00:04, 45.40it/s, est. speed input: 57430.29 toks/s, output: 56.08 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [00:33<00:04, 45.17it/s, est. speed input: 57303.64 toks/s, output: 55.96 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [00:33<00:03, 45.80it/s, est. speed input: 57214.54 toks/s, output: 55.87 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [00:33<00:03, 45.45it/s, est. speed input: 57093.41 toks/s, output: 55.76 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [00:34<00:03, 45.22it/s, est. speed input: 56974.96 toks/s, output: 55.64 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [00:34<00:02, 45.05it/s, est. speed input: 56858.38 toks/s, output: 55.53 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [00:34<00:02, 44.93it/s, est. speed input: 56744.61 toks/s, output: 55.41 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [00:35<00:02, 44.86it/s, est. speed input: 56633.15 toks/s, output: 55.31 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [00:35<00:01, 44.79it/s, est. speed input: 56523.45 toks/s, output: 55.20 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [00:36<00:01, 44.73it/s, est. speed input: 56415.34 toks/s, output: 55.09 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [00:36<00:01, 44.71it/s, est. speed input: 56310.15 toks/s, output: 54.99 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [00:36<00:00, 44.80it/s, est. speed input: 56211.45 toks/s, output: 54.89 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [00:37<00:00, 46.64it/s, est. speed input: 56183.19 toks/s, output: 54.87 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:37<00:00, 46.64it/s, est. speed input: 56569.36 toks/s, output: 55.24 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:37<00:00, 55.24it/s, est. speed input: 56569.36 toks/s, output: 55.24 toks/s]
[rank0]:[W125 20:44:47.349166383 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=32768 ==========
Time: 2026-01-25 20:44:49
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=4096, max_num_seqs=32
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 4096 --max-num-seqs 32 --max-model-len 1025 --max-num-batched-tokens 32768 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Llama3.2-3B-INT8_M32768.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 20:45:21 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 20:45:22 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=385145) WARNING 01-25 20:45:31 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=385145) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=385145) WARNING 01-25 20:45:43 [backends.py:609] Failed to read file <frozen os>
Throughput: 45.98 requests/s, 47128.72 total tokens/s, 45.98 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096

STDERR:
[2026-01-25 20:45:21] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 20:45:21] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 20:45:21] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 20:45:21] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:45:21] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:45:21] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:45:21] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:45:21] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:45:21] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 20:45:21] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 20:45:21] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 20:45:21] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 20:45:21] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 20:45:21] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 20:45:29] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 20:45:29] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 20:45:29] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 20:45:29] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:45:29] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:45:29] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:45:29] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:45:29] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:45:29] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 20:45:29] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 20:45:29] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 20:45:29] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 20:45:29] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 20:45:29] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=385145) [2026-01-25 20:45:31] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=385145) [2026-01-25 20:45:31] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=385145) [2026-01-25 20:45:31] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=385145) [2026-01-25 20:45:31] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=385145) [2026-01-25 20:45:31] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-3B-INT8
(EngineCore_DP0 pid=385145) [2026-01-25 20:45:31] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=385145) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=385145) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:01<00:00,  1.08s/it]
(EngineCore_DP0 pid=385145) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:01<00:00,  1.08s/it]
(EngineCore_DP0 pid=385145) 
(EngineCore_DP0 pid=385145) [2026-01-25 20:45:33] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 4096] -> 1D uint8
(EngineCore_DP0 pid=385145) [2026-01-25 20:45:33] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 15728640 bytes
(EngineCore_DP0 pid=385145) [2026-01-25 20:45:33] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 4096] -> 1D uint8
(EngineCore_DP0 pid=385145) [2026-01-25 20:45:33] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9437184 bytes
(EngineCore_DP0 pid=385145) [2026-01-25 20:45:33] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 4096] -> 1D uint8
(EngineCore_DP0 pid=385145) [2026-01-25 20:45:33] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 50331648 bytes
(EngineCore_DP0 pid=385145) [2026-01-25 20:45:33] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 10944] -> 1D uint8
(EngineCore_DP0 pid=385145) [2026-01-25 20:45:33] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 25264128 bytes
(EngineCore_DP0 pid=385145) [rank0]:W0125 20:45:49.616000 385145 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=385145) [rank0]:W0125 20:45:49.737000 385145 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=385145) [rank0]:W0125 20:45:51.287000 385145 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=385145) [rank0]:W0125 20:45:51.474000 385145 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=385145) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   9%|▉         | 1/11 [00:00<00:01,  7.02it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  18%|█▊        | 2/11 [00:00<00:01,  7.53it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  27%|██▋       | 3/11 [00:00<00:01,  7.94it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  36%|███▋      | 4/11 [00:00<00:00,  8.09it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  45%|████▌     | 5/11 [00:00<00:00,  8.14it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  55%|█████▍    | 6/11 [00:00<00:00,  8.22it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  64%|██████▎   | 7/11 [00:00<00:00,  8.12it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  73%|███████▎  | 8/11 [00:01<00:00,  7.98it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  82%|████████▏ | 9/11 [00:01<00:00,  8.08it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  91%|█████████ | 10/11 [00:01<00:00,  8.14it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00,  7.51it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00,  7.85it/s]
(EngineCore_DP0 pid=385145) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  14%|█▍        | 1/7 [00:00<00:00,  6.44it/s]
Capturing CUDA graphs (decode, FULL):  29%|██▊       | 2/7 [00:00<00:00,  5.80it/s]
Capturing CUDA graphs (decode, FULL):  43%|████▎     | 3/7 [00:00<00:00,  4.12it/s]
Capturing CUDA graphs (decode, FULL):  57%|█████▋    | 4/7 [00:00<00:00,  5.14it/s]
Capturing CUDA graphs (decode, FULL):  71%|███████▏  | 5/7 [00:00<00:00,  5.73it/s]
Capturing CUDA graphs (decode, FULL):  86%|████████▌ | 6/7 [00:01<00:00,  5.23it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:01<00:00,  5.47it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:01<00:00,  5.32it/s]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   1%|          | 31/4096 [00:00<00:13, 304.82it/s]
Adding requests:   2%|▏         | 64/4096 [00:00<00:12, 316.25it/s]
Adding requests:   2%|▏         | 96/4096 [00:00<00:12, 314.62it/s]
Adding requests:   3%|▎         | 128/4096 [00:00<00:12, 313.58it/s]
Adding requests:   4%|▍         | 160/4096 [00:00<00:12, 306.76it/s]
Adding requests:   5%|▍         | 192/4096 [00:00<00:12, 307.96it/s]
Adding requests:   5%|▌         | 225/4096 [00:00<00:12, 313.00it/s]
Adding requests:   6%|▋         | 257/4096 [00:00<00:12, 313.52it/s]
Adding requests:   7%|▋         | 289/4096 [00:00<00:12, 310.51it/s]
Adding requests:   8%|▊         | 321/4096 [00:01<00:12, 305.93it/s]
Adding requests:   9%|▊         | 354/4096 [00:01<00:12, 311.52it/s]
Adding requests:   9%|▉         | 386/4096 [00:01<00:11, 311.93it/s]
Adding requests:  10%|█         | 418/4096 [00:01<00:11, 310.49it/s]
Adding requests:  11%|█         | 450/4096 [00:01<00:11, 309.96it/s]
Adding requests:  12%|█▏        | 482/4096 [00:01<00:11, 311.63it/s]
Adding requests:  13%|█▎        | 514/4096 [00:01<00:11, 312.46it/s]
Adding requests:  13%|█▎        | 546/4096 [00:01<00:11, 313.33it/s]
Adding requests:  14%|█▍        | 580/4096 [00:01<00:10, 321.20it/s]
Adding requests:  15%|█▍        | 614/4096 [00:01<00:10, 324.13it/s]
Adding requests:  16%|█▌        | 649/4096 [00:02<00:10, 331.72it/s]
Adding requests:  17%|█▋        | 684/4096 [00:02<00:10, 336.87it/s]
Adding requests:  18%|█▊        | 718/4096 [00:02<00:10, 336.48it/s]
Adding requests:  18%|█▊        | 752/4096 [00:02<00:10, 333.12it/s]
Adding requests:  19%|█▉        | 786/4096 [00:02<00:09, 333.01it/s]
Adding requests:  20%|██        | 820/4096 [00:02<00:10, 323.14it/s]
Adding requests:  21%|██        | 854/4096 [00:02<00:09, 326.62it/s]
Adding requests:  22%|██▏       | 889/4096 [00:02<00:09, 332.86it/s]
Adding requests:  23%|██▎       | 923/4096 [00:02<00:09, 333.88it/s]
Adding requests:  23%|██▎       | 957/4096 [00:02<00:09, 331.57it/s]
Adding requests:  24%|██▍       | 991/4096 [00:03<00:09, 328.72it/s]
Adding requests:  25%|██▌       | 1026/4096 [00:03<00:09, 332.19it/s]
Adding requests:  26%|██▌       | 1060/4096 [00:03<00:09, 330.28it/s]
Adding requests:  27%|██▋       | 1094/4096 [00:03<00:09, 323.24it/s]
Adding requests:  28%|██▊       | 1127/4096 [00:03<00:09, 322.35it/s]
Adding requests:  28%|██▊       | 1160/4096 [00:03<00:09, 324.23it/s]
Adding requests:  29%|██▉       | 1193/4096 [00:03<00:09, 313.45it/s]
Adding requests:  30%|██▉       | 1227/4096 [00:03<00:08, 320.41it/s]
Adding requests:  31%|███       | 1260/4096 [00:03<00:08, 318.50it/s]
Adding requests:  32%|███▏      | 1293/4096 [00:04<00:08, 319.26it/s]
Adding requests:  32%|███▏      | 1327/4096 [00:04<00:08, 322.97it/s]
Adding requests:  33%|███▎      | 1361/4096 [00:04<00:08, 327.36it/s]
Adding requests:  34%|███▍      | 1395/4096 [00:04<00:08, 329.92it/s]
Adding requests:  35%|███▍      | 1429/4096 [00:04<00:08, 326.14it/s]
Adding requests:  36%|███▌      | 1463/4096 [00:04<00:07, 329.71it/s]
Adding requests:  37%|███▋      | 1496/4096 [00:04<00:07, 328.64it/s]
Adding requests:  37%|███▋      | 1529/4096 [00:04<00:07, 323.60it/s]
Adding requests:  38%|███▊      | 1563/4096 [00:04<00:07, 327.00it/s]
Adding requests:  39%|███▉      | 1598/4096 [00:04<00:07, 332.87it/s]
Adding requests:  40%|███▉      | 1633/4096 [00:05<00:07, 335.61it/s]
Adding requests:  41%|████      | 1667/4096 [00:05<00:07, 326.86it/s]
Adding requests:  42%|████▏     | 1701/4096 [00:05<00:07, 329.40it/s]
Adding requests:  42%|████▏     | 1737/4096 [00:05<00:07, 336.69it/s]
Adding requests:  43%|████▎     | 1771/4096 [00:05<00:06, 335.87it/s]
Adding requests:  44%|████▍     | 1808/4096 [00:05<00:06, 345.21it/s]
Adding requests:  45%|████▌     | 1847/4096 [00:05<00:06, 356.27it/s]
Adding requests:  46%|████▌     | 1883/4096 [00:05<00:06, 356.57it/s]
Adding requests:  47%|████▋     | 1920/4096 [00:05<00:06, 359.42it/s]
Adding requests:  48%|████▊     | 1957/4096 [00:05<00:05, 362.17it/s]
Adding requests:  49%|████▊     | 1994/4096 [00:06<00:05, 363.81it/s]
Adding requests:  50%|████▉     | 2031/4096 [00:06<00:05, 365.01it/s]
Adding requests:  50%|█████     | 2068/4096 [00:06<00:05, 365.77it/s]
Adding requests:  51%|█████▏    | 2105/4096 [00:06<00:05, 354.83it/s]
Adding requests:  52%|█████▏    | 2141/4096 [00:06<00:05, 348.75it/s]
Adding requests:  53%|█████▎    | 2177/4096 [00:06<00:05, 351.25it/s]
Adding requests:  54%|█████▍    | 2213/4096 [00:06<00:05, 352.97it/s]
Adding requests:  55%|█████▍    | 2251/4096 [00:06<00:05, 359.88it/s]
Adding requests:  56%|█████▌    | 2288/4096 [00:06<00:05, 358.95it/s]
Adding requests:  57%|█████▋    | 2325/4096 [00:07<00:04, 359.69it/s]
Adding requests:  58%|█████▊    | 2361/4096 [00:07<00:04, 359.46it/s]
Adding requests:  59%|█████▊    | 2397/4096 [00:07<00:04, 358.34it/s]
Adding requests:  59%|█████▉    | 2433/4096 [00:07<00:04, 342.82it/s]
Adding requests:  60%|██████    | 2469/4096 [00:07<00:04, 345.14it/s]
Adding requests:  61%|██████    | 2504/4096 [00:07<00:04, 345.97it/s]
Adding requests:  62%|██████▏   | 2541/4096 [00:07<00:04, 351.40it/s]
Adding requests:  63%|██████▎   | 2578/4096 [00:07<00:04, 354.63it/s]
Adding requests:  64%|██████▍   | 2614/4096 [00:07<00:04, 353.05it/s]
Adding requests:  65%|██████▍   | 2651/4096 [00:07<00:04, 355.46it/s]
Adding requests:  66%|██████▌   | 2688/4096 [00:08<00:03, 357.93it/s]
Adding requests:  67%|██████▋   | 2726/4096 [00:08<00:03, 361.88it/s]
Adding requests:  67%|██████▋   | 2763/4096 [00:08<00:03, 359.01it/s]
Adding requests:  68%|██████▊   | 2799/4096 [00:08<00:03, 351.30it/s]
Adding requests:  69%|██████▉   | 2835/4096 [00:08<00:03, 346.76it/s]
Adding requests:  70%|███████   | 2870/4096 [00:08<00:03, 347.19it/s]
Adding requests:  71%|███████   | 2906/4096 [00:08<00:03, 348.87it/s]
Adding requests:  72%|███████▏  | 2941/4096 [00:08<00:03, 342.34it/s]
Adding requests:  73%|███████▎  | 2976/4096 [00:08<00:03, 341.08it/s]
Adding requests:  74%|███████▎  | 3011/4096 [00:08<00:03, 341.44it/s]
Adding requests:  74%|███████▍  | 3046/4096 [00:09<00:03, 341.02it/s]
Adding requests:  75%|███████▌  | 3081/4096 [00:09<00:03, 335.75it/s]
Adding requests:  76%|███████▌  | 3116/4096 [00:09<00:02, 337.90it/s]
Adding requests:  77%|███████▋  | 3150/4096 [00:09<00:02, 333.87it/s]
Adding requests:  78%|███████▊  | 3185/4096 [00:09<00:02, 336.35it/s]
Adding requests:  79%|███████▊  | 3219/4096 [00:09<00:02, 331.28it/s]
Adding requests:  79%|███████▉  | 3254/4096 [00:09<00:02, 336.63it/s]
Adding requests:  80%|████████  | 3288/4096 [00:09<00:02, 334.34it/s]
Adding requests:  81%|████████  | 3322/4096 [00:09<00:02, 327.87it/s]
Adding requests:  82%|████████▏ | 3357/4096 [00:10<00:02, 332.90it/s]
Adding requests:  83%|████████▎ | 3391/4096 [00:10<00:02, 330.65it/s]
Adding requests:  84%|████████▎ | 3426/4096 [00:10<00:02, 334.61it/s]
Adding requests:  84%|████████▍ | 3460/4096 [00:10<00:01, 329.44it/s]
Adding requests:  85%|████████▌ | 3494/4096 [00:10<00:01, 329.63it/s]
Adding requests:  86%|████████▌ | 3527/4096 [00:10<00:01, 327.19it/s]
Adding requests:  87%|████████▋ | 3560/4096 [00:10<00:01, 327.48it/s]
Adding requests:  88%|████████▊ | 3594/4096 [00:10<00:01, 329.21it/s]
Adding requests:  89%|████████▊ | 3627/4096 [00:10<00:01, 325.47it/s]
Adding requests:  89%|████████▉ | 3660/4096 [00:10<00:01, 322.52it/s]
Adding requests:  90%|█████████ | 3695/4096 [00:11<00:01, 328.66it/s]
Adding requests:  91%|█████████ | 3729/4096 [00:11<00:01, 331.81it/s]
Adding requests:  92%|█████████▏| 3763/4096 [00:11<00:01, 319.79it/s]
Adding requests:  93%|█████████▎| 3797/4096 [00:11<00:00, 323.75it/s]
Adding requests:  94%|█████████▎| 3831/4096 [00:11<00:00, 327.92it/s]
Adding requests:  94%|█████████▍| 3865/4096 [00:11<00:00, 331.42it/s]
Adding requests:  95%|█████████▌| 3899/4096 [00:11<00:00, 330.83it/s]
Adding requests:  96%|█████████▌| 3934/4096 [00:11<00:00, 334.61it/s]
Adding requests:  97%|█████████▋| 3970/4096 [00:11<00:00, 339.53it/s]
Adding requests:  98%|█████████▊| 4004/4096 [00:11<00:00, 333.87it/s]
Adding requests:  99%|█████████▊| 4038/4096 [00:12<00:00, 331.84it/s]
Adding requests:  99%|█████████▉| 4073/4096 [00:12<00:00, 333.55it/s]
Adding requests: 100%|██████████| 4096/4096 [00:12<00:00, 334.31it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  13%|█▎        | 514/4096 [00:00<00:02, 1598.53it/s, est. speed input: 1637078.30 toks/s, output: 1598.59 toks/s]
Processed prompts:  16%|█▋        | 674/4096 [00:03<00:23, 148.02it/s, est. speed input: 191282.13 toks/s, output: 186.80 toks/s]   
Processed prompts:  18%|█▊        | 743/4096 [00:04<00:29, 112.52it/s, est. speed input: 152259.78 toks/s, output: 148.69 toks/s]
Processed prompts:  19%|█▉        | 783/4096 [00:05<00:32, 100.84it/s, est. speed input: 140527.53 toks/s, output: 137.23 toks/s]
Processed prompts:  21%|██        | 866/4096 [00:06<00:28, 112.60it/s, est. speed input: 143167.08 toks/s, output: 139.81 toks/s]
Processed prompts:  22%|██▏       | 898/4096 [00:06<00:33, 94.99it/s, est. speed input: 133204.80 toks/s, output: 130.08 toks/s] 
Processed prompts:  23%|██▎       | 930/4096 [00:07<00:38, 81.43it/s, est. speed input: 125089.07 toks/s, output: 122.16 toks/s]
Processed prompts:  23%|██▎       | 962/4096 [00:08<00:43, 71.25it/s, est. speed input: 118351.06 toks/s, output: 115.58 toks/s]
Processed prompts:  24%|██▍       | 994/4096 [00:09<00:48, 63.78it/s, est. speed input: 112680.11 toks/s, output: 110.04 toks/s]
Processed prompts:  25%|██▌       | 1026/4096 [00:09<00:52, 58.36it/s, est. speed input: 107829.07 toks/s, output: 105.30 toks/s]
Processed prompts:  26%|██▌       | 1058/4096 [00:10<00:54, 55.70it/s, est. speed input: 104172.93 toks/s, output: 101.73 toks/s]
Processed prompts:  27%|██▋       | 1090/4096 [00:11<00:55, 53.70it/s, est. speed input: 100942.49 toks/s, output: 98.58 toks/s] 
Processed prompts:  27%|██▋       | 1122/4096 [00:11<00:56, 52.29it/s, est. speed input: 98087.41 toks/s, output: 95.79 toks/s] 
Processed prompts:  28%|██▊       | 1154/4096 [00:12<00:57, 51.13it/s, est. speed input: 95486.73 toks/s, output: 93.25 toks/s]
Processed prompts:  29%|██▉       | 1186/4096 [00:13<00:59, 49.24it/s, est. speed input: 92807.57 toks/s, output: 90.63 toks/s]
Processed prompts:  30%|██▉       | 1218/4096 [00:13<01:00, 47.95it/s, est. speed input: 90403.45 toks/s, output: 88.28 toks/s]
Processed prompts:  31%|███       | 1250/4096 [00:14<01:00, 47.05it/s, est. speed input: 88229.09 toks/s, output: 86.16 toks/s]
Processed prompts:  31%|███▏      | 1282/4096 [00:15<01:00, 46.43it/s, est. speed input: 86260.66 toks/s, output: 84.24 toks/s]
Processed prompts:  32%|███▏      | 1314/4096 [00:15<01:00, 46.01it/s, est. speed input: 84471.04 toks/s, output: 82.49 toks/s]
Processed prompts:  33%|███▎      | 1346/4096 [00:16<01:00, 45.71it/s, est. speed input: 82832.78 toks/s, output: 80.89 toks/s]
Processed prompts:  34%|███▎      | 1378/4096 [00:17<00:59, 45.51it/s, est. speed input: 81328.96 toks/s, output: 79.42 toks/s]
Processed prompts:  34%|███▍      | 1410/4096 [00:18<00:58, 45.69it/s, est. speed input: 80018.51 toks/s, output: 78.14 toks/s]
Processed prompts:  35%|███▌      | 1442/4096 [00:18<00:57, 46.51it/s, est. speed input: 78950.24 toks/s, output: 77.10 toks/s]
Processed prompts:  36%|███▌      | 1474/4096 [00:19<00:55, 47.12it/s, est. speed input: 77958.02 toks/s, output: 76.13 toks/s]
Processed prompts:  37%|███▋      | 1506/4096 [00:20<00:54, 47.60it/s, est. speed input: 77038.59 toks/s, output: 75.23 toks/s]
Processed prompts:  38%|███▊      | 1538/4096 [00:20<00:54, 47.01it/s, est. speed input: 76016.61 toks/s, output: 74.23 toks/s]
Processed prompts:  38%|███▊      | 1570/4096 [00:21<00:54, 46.44it/s, est. speed input: 75031.85 toks/s, output: 73.27 toks/s]
Processed prompts:  39%|███▉      | 1602/4096 [00:22<00:54, 46.02it/s, est. speed input: 74105.53 toks/s, output: 72.37 toks/s]
Processed prompts:  40%|███▉      | 1634/4096 [00:22<00:53, 45.76it/s, est. speed input: 73241.55 toks/s, output: 71.52 toks/s]
Processed prompts:  41%|████      | 1666/4096 [00:23<00:53, 45.56it/s, est. speed input: 72426.57 toks/s, output: 70.73 toks/s]
Processed prompts:  41%|████▏     | 1698/4096 [00:24<00:52, 45.43it/s, est. speed input: 71660.73 toks/s, output: 69.98 toks/s]
Processed prompts:  42%|████▏     | 1730/4096 [00:24<00:51, 45.54it/s, est. speed input: 70967.59 toks/s, output: 69.30 toks/s]
Processed prompts:  43%|████▎     | 1762/4096 [00:25<00:50, 46.44it/s, est. speed input: 70425.25 toks/s, output: 68.77 toks/s]
Processed prompts:  44%|████▍     | 1794/4096 [00:26<00:48, 47.11it/s, est. speed input: 69913.65 toks/s, output: 68.27 toks/s]
Processed prompts:  45%|████▍     | 1826/4096 [00:26<00:47, 47.58it/s, est. speed input: 69425.56 toks/s, output: 67.80 toks/s]
Processed prompts:  45%|████▌     | 1858/4096 [00:27<00:46, 48.32it/s, est. speed input: 69006.91 toks/s, output: 67.39 toks/s]
Processed prompts:  46%|████▌     | 1890/4096 [00:28<00:45, 48.44it/s, est. speed input: 68562.14 toks/s, output: 66.96 toks/s]
Processed prompts:  47%|████▋     | 1922/4096 [00:28<00:45, 47.36it/s, est. speed input: 68010.12 toks/s, output: 66.42 toks/s]
Processed prompts:  48%|████▊     | 1954/4096 [00:29<00:45, 46.62it/s, est. speed input: 67483.45 toks/s, output: 65.90 toks/s]
Processed prompts:  48%|████▊     | 1986/4096 [00:30<00:45, 46.11it/s, est. speed input: 66980.42 toks/s, output: 65.41 toks/s]
Processed prompts:  49%|████▉     | 2018/4096 [00:31<00:45, 45.77it/s, est. speed input: 66501.79 toks/s, output: 64.94 toks/s]
Processed prompts:  50%|█████     | 2050/4096 [00:31<00:44, 45.53it/s, est. speed input: 66044.08 toks/s, output: 64.50 toks/s]
Processed prompts:  51%|█████     | 2082/4096 [00:32<00:44, 45.36it/s, est. speed input: 65606.53 toks/s, output: 64.07 toks/s]
Processed prompts:  52%|█████▏    | 2114/4096 [00:33<00:43, 45.24it/s, est. speed input: 65186.79 toks/s, output: 63.66 toks/s]
Processed prompts:  52%|█████▏    | 2146/4096 [00:33<00:42, 46.10it/s, est. speed input: 64877.56 toks/s, output: 63.36 toks/s]
Processed prompts:  53%|█████▎    | 2178/4096 [00:34<00:40, 46.85it/s, est. speed input: 64592.26 toks/s, output: 63.08 toks/s]
Processed prompts:  54%|█████▍    | 2210/4096 [00:35<00:39, 47.40it/s, est. speed input: 64317.85 toks/s, output: 62.81 toks/s]
Processed prompts:  55%|█████▍    | 2242/4096 [00:35<00:38, 47.80it/s, est. speed input: 64054.25 toks/s, output: 62.55 toks/s]
Processed prompts:  56%|█████▌    | 2274/4096 [00:36<00:38, 47.72it/s, est. speed input: 63771.22 toks/s, output: 62.28 toks/s]
Processed prompts:  58%|█████▊    | 2370/4096 [00:37<00:20, 83.07it/s, est. speed input: 65583.42 toks/s, output: 64.05 toks/s]
Processed prompts:  59%|█████▊    | 2402/4096 [00:37<00:24, 70.47it/s, est. speed input: 65215.30 toks/s, output: 63.69 toks/s]
Processed prompts:  59%|█████▉    | 2434/4096 [00:38<00:26, 62.29it/s, est. speed input: 64861.03 toks/s, output: 63.34 toks/s]
Processed prompts:  60%|██████    | 2466/4096 [00:39<00:28, 56.85it/s, est. speed input: 64519.28 toks/s, output: 63.01 toks/s]
Processed prompts:  61%|██████    | 2498/4096 [00:39<00:29, 53.65it/s, est. speed input: 64222.68 toks/s, output: 62.72 toks/s]
Processed prompts:  62%|██████▏   | 2530/4096 [00:40<00:30, 50.98it/s, est. speed input: 63904.26 toks/s, output: 62.41 toks/s]
Processed prompts:  63%|██████▎   | 2562/4096 [00:41<00:30, 49.81it/s, est. speed input: 63644.64 toks/s, output: 62.15 toks/s]
Processed prompts:  63%|██████▎   | 2594/4096 [00:41<00:30, 49.51it/s, est. speed input: 63429.81 toks/s, output: 61.94 toks/s]
Processed prompts:  64%|██████▍   | 2626/4096 [00:42<00:29, 49.29it/s, est. speed input: 63221.87 toks/s, output: 61.74 toks/s]
Processed prompts:  65%|██████▍   | 2658/4096 [00:43<00:29, 49.14it/s, est. speed input: 63020.34 toks/s, output: 61.54 toks/s]
Processed prompts:  66%|██████▌   | 2690/4096 [00:43<00:28, 49.03it/s, est. speed input: 62824.17 toks/s, output: 61.35 toks/s]
Processed prompts:  66%|██████▋   | 2722/4096 [00:44<00:28, 48.66it/s, est. speed input: 62615.68 toks/s, output: 61.15 toks/s]
Processed prompts:  67%|██████▋   | 2754/4096 [00:45<00:28, 47.51it/s, est. speed input: 62355.87 toks/s, output: 60.89 toks/s]
Processed prompts:  68%|██████▊   | 2786/4096 [00:45<00:28, 46.74it/s, est. speed input: 62104.48 toks/s, output: 60.65 toks/s]
Processed prompts:  69%|██████▉   | 2818/4096 [00:46<00:27, 46.22it/s, est. speed input: 61860.82 toks/s, output: 60.41 toks/s]
Processed prompts:  70%|██████▉   | 2850/4096 [00:47<00:27, 45.86it/s, est. speed input: 61624.49 toks/s, output: 60.18 toks/s]
Processed prompts:  70%|███████   | 2882/4096 [00:48<00:26, 45.60it/s, est. speed input: 61394.95 toks/s, output: 59.96 toks/s]
Processed prompts:  71%|███████   | 2914/4096 [00:48<00:26, 45.46it/s, est. speed input: 61174.08 toks/s, output: 59.74 toks/s]
Processed prompts:  72%|███████▏  | 2946/4096 [00:49<00:25, 45.29it/s, est. speed input: 60955.03 toks/s, output: 59.53 toks/s]
Processed prompts:  73%|███████▎  | 2978/4096 [00:50<00:24, 45.19it/s, est. speed input: 60743.99 toks/s, output: 59.32 toks/s]
Processed prompts:  73%|███████▎  | 3010/4096 [00:50<00:23, 45.58it/s, est. speed input: 60566.29 toks/s, output: 59.15 toks/s]
Processed prompts:  74%|███████▍  | 3042/4096 [00:51<00:22, 46.49it/s, est. speed input: 60431.11 toks/s, output: 59.01 toks/s]
Processed prompts:  75%|███████▌  | 3074/4096 [00:52<00:21, 47.16it/s, est. speed input: 60299.48 toks/s, output: 58.89 toks/s]
Processed prompts:  76%|███████▌  | 3106/4096 [00:52<00:21, 46.87it/s, est. speed input: 60129.78 toks/s, output: 58.72 toks/s]
Processed prompts:  77%|███████▋  | 3138/4096 [00:53<00:20, 46.29it/s, est. speed input: 59943.06 toks/s, output: 58.54 toks/s]
Processed prompts:  77%|███████▋  | 3170/4096 [00:54<00:20, 45.89it/s, est. speed input: 59761.37 toks/s, output: 58.36 toks/s]
Processed prompts:  78%|███████▊  | 3202/4096 [00:55<00:19, 45.63it/s, est. speed input: 59584.91 toks/s, output: 58.19 toks/s]
Processed prompts:  79%|███████▉  | 3234/4096 [00:55<00:18, 45.44it/s, est. speed input: 59412.93 toks/s, output: 58.02 toks/s]
Processed prompts:  80%|███████▉  | 3266/4096 [00:56<00:18, 45.30it/s, est. speed input: 59244.61 toks/s, output: 57.86 toks/s]
Processed prompts:  81%|████████  | 3298/4096 [00:57<00:17, 45.21it/s, est. speed input: 59080.93 toks/s, output: 57.70 toks/s]
Processed prompts:  81%|████████▏ | 3330/4096 [00:57<00:16, 45.43it/s, est. speed input: 58935.94 toks/s, output: 57.55 toks/s]
Processed prompts:  82%|████████▏ | 3362/4096 [00:58<00:15, 46.38it/s, est. speed input: 58835.00 toks/s, output: 57.46 toks/s]
Processed prompts:  83%|████████▎ | 3394/4096 [00:59<00:14, 47.07it/s, est. speed input: 58736.10 toks/s, output: 57.36 toks/s]
Processed prompts:  84%|████████▎ | 3426/4096 [00:59<00:14, 47.56it/s, est. speed input: 58639.63 toks/s, output: 57.27 toks/s]
Processed prompts:  84%|████████▍ | 3458/4096 [01:00<00:13, 47.90it/s, est. speed input: 58544.55 toks/s, output: 57.17 toks/s]
Processed prompts:  85%|████████▌ | 3490/4096 [01:01<00:12, 46.99it/s, est. speed input: 58399.64 toks/s, output: 57.03 toks/s]
Processed prompts:  86%|████████▌ | 3522/4096 [01:01<00:12, 46.38it/s, est. speed input: 58258.20 toks/s, output: 56.89 toks/s]
Processed prompts:  87%|████████▋ | 3554/4096 [01:02<00:11, 45.96it/s, est. speed input: 58120.32 toks/s, output: 56.76 toks/s]
Processed prompts:  88%|████████▊ | 3586/4096 [01:03<00:11, 45.68it/s, est. speed input: 57985.46 toks/s, output: 56.63 toks/s]
Processed prompts:  88%|████████▊ | 3618/4096 [01:04<00:10, 45.48it/s, est. speed input: 57853.35 toks/s, output: 56.50 toks/s]
Processed prompts:  89%|████████▉ | 3650/4096 [01:04<00:09, 45.33it/s, est. speed input: 57724.06 toks/s, output: 56.37 toks/s]
Processed prompts:  90%|████████▉ | 3682/4096 [01:05<00:09, 45.25it/s, est. speed input: 57598.38 toks/s, output: 56.25 toks/s]
Processed prompts:  91%|█████████ | 3714/4096 [01:06<00:08, 46.23it/s, est. speed input: 57521.64 toks/s, output: 56.17 toks/s]
Processed prompts:  91%|█████████▏| 3746/4096 [01:06<00:07, 46.96it/s, est. speed input: 57447.06 toks/s, output: 56.10 toks/s]
Processed prompts:  92%|█████████▏| 3778/4096 [01:07<00:06, 47.48it/s, est. speed input: 57373.53 toks/s, output: 56.03 toks/s]
Processed prompts:  95%|█████████▍| 3874/4096 [01:07<00:02, 92.96it/s, est. speed input: 58602.55 toks/s, output: 57.23 toks/s]
Processed prompts:  95%|█████████▌| 3906/4096 [01:08<00:02, 78.01it/s, est. speed input: 58519.20 toks/s, output: 57.15 toks/s]
Processed prompts:  96%|█████████▌| 3938/4096 [01:09<00:02, 67.20it/s, est. speed input: 58404.85 toks/s, output: 57.04 toks/s]
Processed prompts:  97%|█████████▋| 3970/4096 [01:09<00:02, 59.85it/s, est. speed input: 58279.14 toks/s, output: 56.91 toks/s]
Processed prompts:  98%|█████████▊| 4002/4096 [01:10<00:01, 55.08it/s, est. speed input: 58155.95 toks/s, output: 56.79 toks/s]
Processed prompts:  98%|█████████▊| 4034/4096 [01:11<00:01, 52.40it/s, est. speed input: 58052.32 toks/s, output: 56.69 toks/s]
Processed prompts:  99%|█████████▉| 4066/4096 [01:11<00:00, 50.69it/s, est. speed input: 57955.48 toks/s, output: 56.60 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [01:11<00:00, 50.69it/s, est. speed input: 58382.57 toks/s, output: 57.01 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [01:11<00:00, 57.01it/s, est. speed input: 58382.57 toks/s, output: 57.01 toks/s]
[rank0]:[W125 20:47:26.107195463 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=65536 ==========
Time: 2026-01-25 20:47:29
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=8192, max_num_seqs=64
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 8192 --max-num-seqs 64 --max-model-len 1025 --max-num-batched-tokens 65536 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Llama3.2-3B-INT8_M65536.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 20:48:27 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 20:48:28 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=387971) WARNING 01-25 20:48:37 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=387971) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=387971) WARNING 01-25 20:48:49 [backends.py:609] Failed to read file <frozen os>
Throughput: 18.02 requests/s, 18465.38 total tokens/s, 18.02 output tokens/s
Total num prompt tokens:  8388608
Total num output tokens:  8192

STDERR:
[2026-01-25 20:48:27] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 20:48:27] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 20:48:27] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 20:48:27] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:48:27] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:48:27] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:48:27] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:48:27] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:48:27] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 20:48:27] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 20:48:27] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 20:48:27] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 20:48:27] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 20:48:27] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 20:48:35] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 20:48:36] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 20:48:36] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 20:48:36] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:48:36] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:48:36] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:48:36] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:48:36] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 20:48:36] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 20:48:36] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 20:48:36] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 20:48:36] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 20:48:36] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 20:48:36] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=387971) [2026-01-25 20:48:37] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=387971) [2026-01-25 20:48:37] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=387971) [2026-01-25 20:48:37] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=387971) [2026-01-25 20:48:37] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=387971) [2026-01-25 20:48:37] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-3B-INT8
(EngineCore_DP0 pid=387971) [2026-01-25 20:48:37] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=387971) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=387971) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:01<00:00,  1.06s/it]
(EngineCore_DP0 pid=387971) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:01<00:00,  1.06s/it]
(EngineCore_DP0 pid=387971) 
(EngineCore_DP0 pid=387971) [2026-01-25 20:48:39] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 4096] -> 1D uint8
(EngineCore_DP0 pid=387971) [2026-01-25 20:48:39] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 15728640 bytes
(EngineCore_DP0 pid=387971) [2026-01-25 20:48:39] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 4096] -> 1D uint8
(EngineCore_DP0 pid=387971) [2026-01-25 20:48:39] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9437184 bytes
(EngineCore_DP0 pid=387971) [2026-01-25 20:48:39] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 4096] -> 1D uint8
(EngineCore_DP0 pid=387971) [2026-01-25 20:48:39] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 50331648 bytes
(EngineCore_DP0 pid=387971) [2026-01-25 20:48:39] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 10944] -> 1D uint8
(EngineCore_DP0 pid=387971) [2026-01-25 20:48:39] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 25264128 bytes
(EngineCore_DP0 pid=387971) [rank0]:W0125 20:48:56.036000 387971 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=387971) [rank0]:W0125 20:48:56.161000 387971 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=387971) [rank0]:W0125 20:48:58.083000 387971 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=387971) [rank0]:W0125 20:48:58.259000 387971 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=387971) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/19 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   5%|▌         | 1/19 [00:00<00:09,  1.95it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  11%|█         | 2/19 [00:01<00:08,  1.98it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  16%|█▌        | 3/19 [00:01<00:05,  3.01it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  21%|██        | 4/19 [00:01<00:03,  4.03it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  26%|██▋       | 5/19 [00:01<00:03,  4.65it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  32%|███▏      | 6/19 [00:01<00:02,  4.66it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  37%|███▋      | 7/19 [00:02<00:03,  3.60it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  42%|████▏     | 8/19 [00:02<00:02,  3.85it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  47%|████▋     | 9/19 [00:02<00:03,  3.32it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  53%|█████▎    | 10/19 [00:02<00:02,  4.03it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  58%|█████▊    | 11/19 [00:02<00:01,  4.75it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  63%|██████▎   | 12/19 [00:03<00:01,  5.50it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  68%|██████▊   | 13/19 [00:03<00:00,  6.21it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  74%|███████▎  | 14/19 [00:03<00:00,  6.84it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  79%|███████▉  | 15/19 [00:03<00:00,  7.31it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  84%|████████▍ | 16/19 [00:03<00:00,  7.74it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  89%|████████▉ | 17/19 [00:03<00:00,  8.11it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  95%|█████████▍| 18/19 [00:03<00:00,  8.29it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 19/19 [00:03<00:00,  7.77it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 19/19 [00:03<00:00,  4.94it/s]
(EngineCore_DP0 pid=387971) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):   9%|▉         | 1/11 [00:00<00:01,  7.21it/s]
Capturing CUDA graphs (decode, FULL):  18%|█▊        | 2/11 [00:00<00:01,  8.33it/s]
Capturing CUDA graphs (decode, FULL):  27%|██▋       | 3/11 [00:00<00:00,  8.66it/s]
Capturing CUDA graphs (decode, FULL):  36%|███▋      | 4/11 [00:00<00:00,  8.88it/s]
Capturing CUDA graphs (decode, FULL):  45%|████▌     | 5/11 [00:00<00:00,  8.96it/s]
Capturing CUDA graphs (decode, FULL):  55%|█████▍    | 6/11 [00:00<00:00,  8.98it/s]
Capturing CUDA graphs (decode, FULL):  64%|██████▎   | 7/11 [00:00<00:00,  7.78it/s]
Capturing CUDA graphs (decode, FULL):  73%|███████▎  | 8/11 [00:01<00:00,  4.98it/s]
Capturing CUDA graphs (decode, FULL):  82%|████████▏ | 9/11 [00:01<00:00,  5.39it/s]
Capturing CUDA graphs (decode, FULL):  91%|█████████ | 10/11 [00:01<00:00,  5.74it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 11/11 [00:01<00:00,  5.41it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 11/11 [00:01<00:00,  6.41it/s]

Adding requests:   0%|          | 0/8192 [00:00<?, ?it/s]
Adding requests:   0%|          | 29/8192 [00:00<00:28, 287.24it/s]
Adding requests:   1%|          | 62/8192 [00:00<00:26, 309.43it/s]
Adding requests:   1%|          | 93/8192 [00:00<00:26, 308.79it/s]
Adding requests:   2%|▏         | 124/8192 [00:00<00:26, 299.25it/s]
Adding requests:   2%|▏         | 154/8192 [00:00<00:27, 295.13it/s]
Adding requests:   2%|▏         | 184/8192 [00:00<00:27, 294.00it/s]
Adding requests:   3%|▎         | 214/8192 [00:00<00:27, 292.97it/s]
Adding requests:   3%|▎         | 246/8192 [00:00<00:26, 299.32it/s]
Adding requests:   3%|▎         | 277/8192 [00:00<00:26, 301.10it/s]
Adding requests:   4%|▍         | 308/8192 [00:01<00:26, 298.82it/s]
Adding requests:   4%|▍         | 338/8192 [00:01<00:26, 297.30it/s]
Adding requests:   5%|▍         | 370/8192 [00:01<00:25, 301.21it/s]
Adding requests:   5%|▍         | 401/8192 [00:01<00:25, 300.06it/s]
Adding requests:   5%|▌         | 432/8192 [00:01<00:25, 302.49it/s]
Adding requests:   6%|▌         | 463/8192 [00:01<00:25, 303.68it/s]
Adding requests:   6%|▌         | 495/8192 [00:01<00:25, 306.58it/s]
Adding requests:   6%|▋         | 526/8192 [00:01<00:25, 295.15it/s]
Adding requests:   7%|▋         | 559/8192 [00:01<00:25, 304.63it/s]
Adding requests:   7%|▋         | 593/8192 [00:01<00:24, 312.98it/s]
Adding requests:   8%|▊         | 625/8192 [00:02<00:24, 313.07it/s]
Adding requests:   8%|▊         | 658/8192 [00:02<00:23, 316.07it/s]
Adding requests:   8%|▊         | 690/8192 [00:02<00:23, 316.89it/s]
Adding requests:   9%|▉         | 722/8192 [00:02<00:23, 314.03it/s]
Adding requests:   9%|▉         | 754/8192 [00:02<00:23, 314.36it/s]
Adding requests:  10%|▉         | 787/8192 [00:02<00:23, 316.78it/s]
Adding requests:  10%|█         | 820/8192 [00:02<00:23, 317.96it/s]
Adding requests:  10%|█         | 855/8192 [00:02<00:22, 326.91it/s]
Adding requests:  11%|█         | 893/8192 [00:02<00:21, 339.95it/s]
Adding requests:  11%|█▏        | 929/8192 [00:02<00:21, 344.54it/s]
Adding requests:  12%|█▏        | 965/8192 [00:03<00:20, 347.07it/s]
Adding requests:  12%|█▏        | 1000/8192 [00:03<00:20, 345.24it/s]
Adding requests:  13%|█▎        | 1035/8192 [00:03<00:20, 345.92it/s]
Adding requests:  13%|█▎        | 1070/8192 [00:03<00:21, 338.26it/s]
Adding requests:  13%|█▎        | 1104/8192 [00:03<00:21, 331.22it/s]
Adding requests:  14%|█▍        | 1138/8192 [00:03<00:21, 331.09it/s]
Adding requests:  14%|█▍        | 1174/8192 [00:03<00:20, 336.92it/s]
Adding requests:  15%|█▍        | 1211/8192 [00:03<00:20, 345.39it/s]
Adding requests:  15%|█▌        | 1247/8192 [00:03<00:19, 347.50it/s]
Adding requests:  16%|█▌        | 1282/8192 [00:04<00:20, 344.18it/s]
Adding requests:  16%|█▌        | 1319/8192 [00:04<00:19, 349.85it/s]
Adding requests:  17%|█▋        | 1355/8192 [00:04<00:19, 350.91it/s]
Adding requests:  17%|█▋        | 1393/8192 [00:04<00:19, 356.89it/s]
Adding requests:  17%|█▋        | 1429/8192 [00:04<00:19, 348.15it/s]
Adding requests:  18%|█▊        | 1465/8192 [00:04<00:19, 350.89it/s]
Adding requests:  18%|█▊        | 1501/8192 [00:04<00:19, 349.48it/s]
Adding requests:  19%|█▉        | 1536/8192 [00:04<00:19, 348.61it/s]
Adding requests:  19%|█▉        | 1572/8192 [00:04<00:18, 351.28it/s]
Adding requests:  20%|█▉        | 1608/8192 [00:04<00:18, 352.62it/s]
Adding requests:  20%|██        | 1644/8192 [00:05<00:18, 350.75it/s]
Adding requests:  21%|██        | 1680/8192 [00:05<00:18, 349.56it/s]
Adding requests:  21%|██        | 1717/8192 [00:05<00:18, 353.26it/s]
Adding requests:  21%|██▏       | 1754/8192 [00:05<00:18, 356.78it/s]
Adding requests:  22%|██▏       | 1790/8192 [00:05<00:18, 350.62it/s]
Adding requests:  22%|██▏       | 1826/8192 [00:05<00:18, 344.59it/s]
Adding requests:  23%|██▎       | 1861/8192 [00:05<00:18, 338.21it/s]
Adding requests:  23%|██▎       | 1895/8192 [00:05<00:19, 326.43it/s]
Adding requests:  24%|██▎       | 1929/8192 [00:05<00:18, 329.67it/s]
Adding requests:  24%|██▍       | 1963/8192 [00:05<00:18, 330.10it/s]
Adding requests:  24%|██▍       | 1997/8192 [00:06<00:18, 331.14it/s]
Adding requests:  25%|██▍       | 2031/8192 [00:06<00:18, 327.39it/s]
Adding requests:  25%|██▌       | 2065/8192 [00:06<00:18, 330.56it/s]
Adding requests:  26%|██▌       | 2099/8192 [00:06<00:18, 331.01it/s]
Adding requests:  26%|██▌       | 2133/8192 [00:06<00:18, 322.51it/s]
Adding requests:  26%|██▋       | 2166/8192 [00:06<00:18, 318.97it/s]
Adding requests:  27%|██▋       | 2198/8192 [00:06<00:18, 317.79it/s]
Adding requests:  27%|██▋       | 2230/8192 [00:06<00:18, 317.91it/s]
Adding requests:  28%|██▊       | 2263/8192 [00:06<00:18, 320.48it/s]
Adding requests:  28%|██▊       | 2297/8192 [00:07<00:18, 323.69it/s]
Adding requests:  28%|██▊       | 2330/8192 [00:07<00:18, 321.65it/s]
Adding requests:  29%|██▉       | 2363/8192 [00:07<00:18, 320.59it/s]
Adding requests:  29%|██▉       | 2397/8192 [00:07<00:17, 323.75it/s]
Adding requests:  30%|██▉       | 2430/8192 [00:07<00:17, 325.21it/s]
Adding requests:  30%|███       | 2463/8192 [00:07<00:18, 316.89it/s]
Adding requests:  30%|███       | 2496/8192 [00:07<00:17, 320.62it/s]
Adding requests:  31%|███       | 2529/8192 [00:07<00:17, 318.35it/s]
Adding requests:  31%|███▏      | 2562/8192 [00:07<00:17, 320.95it/s]
Adding requests:  32%|███▏      | 2595/8192 [00:07<00:17, 322.09it/s]
Adding requests:  32%|███▏      | 2628/8192 [00:08<00:17, 318.60it/s]
Adding requests:  32%|███▏      | 2661/8192 [00:08<00:17, 319.30it/s]
Adding requests:  33%|███▎      | 2693/8192 [00:08<00:17, 317.91it/s]
Adding requests:  33%|███▎      | 2725/8192 [00:08<00:17, 318.13it/s]
Adding requests:  34%|███▎      | 2757/8192 [00:08<00:17, 318.25it/s]
Adding requests:  34%|███▍      | 2789/8192 [00:08<00:17, 315.65it/s]
Adding requests:  34%|███▍      | 2821/8192 [00:08<00:17, 314.85it/s]
Adding requests:  35%|███▍      | 2856/8192 [00:08<00:16, 322.23it/s]
Adding requests:  35%|███▌      | 2890/8192 [00:08<00:16, 326.00it/s]
Adding requests:  36%|███▌      | 2923/8192 [00:08<00:16, 321.37it/s]
Adding requests:  36%|███▌      | 2956/8192 [00:09<00:16, 316.22it/s]
Adding requests:  36%|███▋      | 2989/8192 [00:09<00:16, 319.89it/s]
Adding requests:  37%|███▋      | 3022/8192 [00:09<00:16, 316.26it/s]
Adding requests:  37%|███▋      | 3054/8192 [00:09<00:16, 312.95it/s]
Adding requests:  38%|███▊      | 3086/8192 [00:09<00:16, 313.68it/s]
Adding requests:  38%|███▊      | 3118/8192 [00:09<00:16, 312.90it/s]
Adding requests:  38%|███▊      | 3150/8192 [00:09<00:16, 311.46it/s]
Adding requests:  39%|███▉      | 3183/8192 [00:09<00:15, 314.02it/s]
Adding requests:  39%|███▉      | 3217/8192 [00:09<00:15, 320.56it/s]
Adding requests:  40%|███▉      | 3250/8192 [00:10<00:15, 315.01it/s]
Adding requests:  40%|████      | 3284/8192 [00:10<00:15, 320.99it/s]
Adding requests:  41%|████      | 3320/8192 [00:10<00:14, 330.49it/s]
Adding requests:  41%|████      | 3356/8192 [00:10<00:14, 336.61it/s]
Adding requests:  41%|████▏     | 3390/8192 [00:10<00:14, 337.20it/s]
Adding requests:  42%|████▏     | 3427/8192 [00:10<00:13, 346.50it/s]
Adding requests:  42%|████▏     | 3462/8192 [00:10<00:14, 337.11it/s]
Adding requests:  43%|████▎     | 3497/8192 [00:10<00:13, 337.92it/s]
Adding requests:  43%|████▎     | 3531/8192 [00:10<00:13, 336.59it/s]
Adding requests:  44%|████▎     | 3566/8192 [00:10<00:13, 339.26it/s]
Adding requests:  44%|████▍     | 3600/8192 [00:11<00:13, 335.23it/s]
Adding requests:  44%|████▍     | 3634/8192 [00:11<00:13, 333.97it/s]
Adding requests:  45%|████▍     | 3668/8192 [00:11<00:13, 335.01it/s]
Adding requests:  45%|████▌     | 3703/8192 [00:11<00:13, 338.39it/s]
Adding requests:  46%|████▌     | 3737/8192 [00:11<00:13, 338.56it/s]
Adding requests:  46%|████▌     | 3774/8192 [00:11<00:12, 345.90it/s]
Adding requests:  46%|████▋     | 3809/8192 [00:11<00:12, 346.89it/s]
Adding requests:  47%|████▋     | 3844/8192 [00:11<00:12, 347.15it/s]
Adding requests:  47%|████▋     | 3880/8192 [00:11<00:12, 349.91it/s]
Adding requests:  48%|████▊     | 3916/8192 [00:11<00:12, 350.49it/s]
Adding requests:  48%|████▊     | 3952/8192 [00:12<00:12, 350.30it/s]
Adding requests:  49%|████▊     | 3988/8192 [00:12<00:12, 350.24it/s]
Adding requests:  49%|████▉     | 4024/8192 [00:12<00:11, 350.31it/s]
Adding requests:  50%|████▉     | 4060/8192 [00:12<00:11, 344.89it/s]
Adding requests:  50%|█████     | 4097/8192 [00:12<00:11, 350.63it/s]
Adding requests:  50%|█████     | 4134/8192 [00:12<00:11, 354.49it/s]
Adding requests:  51%|█████     | 4170/8192 [00:12<00:11, 354.19it/s]
Adding requests:  51%|█████▏    | 4206/8192 [00:12<00:11, 348.05it/s]
Adding requests:  52%|█████▏    | 4242/8192 [00:12<00:11, 350.18it/s]
Adding requests:  52%|█████▏    | 4278/8192 [00:13<00:11, 346.99it/s]
Adding requests:  53%|█████▎    | 4313/8192 [00:13<00:11, 346.88it/s]
Adding requests:  53%|█████▎    | 4349/8192 [00:13<00:10, 349.52it/s]
Adding requests:  54%|█████▎    | 4385/8192 [00:13<00:10, 350.51it/s]
Adding requests:  54%|█████▍    | 4421/8192 [00:13<00:10, 345.41it/s]
Adding requests:  54%|█████▍    | 4456/8192 [00:13<00:10, 342.03it/s]
Adding requests:  55%|█████▍    | 4491/8192 [00:13<00:11, 332.26it/s]
Adding requests:  55%|█████▌    | 4525/8192 [00:13<00:11, 325.10it/s]
Adding requests:  56%|█████▌    | 4558/8192 [00:13<00:11, 321.05it/s]
Adding requests:  56%|█████▌    | 4591/8192 [00:13<00:11, 319.69it/s]
Adding requests:  56%|█████▋    | 4623/8192 [00:14<00:11, 302.30it/s]
Adding requests:  57%|█████▋    | 4656/8192 [00:14<00:11, 307.97it/s]
Adding requests:  57%|█████▋    | 4687/8192 [00:14<00:11, 304.13it/s]
Adding requests:  64%|██████▍   | 5246/8192 [00:14<00:01, 1800.63it/s]
Adding requests:  66%|██████▋   | 5431/8192 [00:14<00:03, 757.09it/s] 
Adding requests:  68%|██████▊   | 5570/8192 [00:15<00:04, 560.69it/s]
Adding requests:  69%|██████▉   | 5677/8192 [00:15<00:05, 480.38it/s]
Adding requests:  70%|███████   | 5761/8192 [00:16<00:05, 435.22it/s]
Adding requests:  71%|███████   | 5829/8192 [00:16<00:05, 408.18it/s]
Adding requests:  72%|███████▏  | 5887/8192 [00:16<00:05, 389.99it/s]
Adding requests:  72%|███████▏  | 5937/8192 [00:16<00:06, 374.79it/s]
Adding requests:  73%|███████▎  | 5982/8192 [00:16<00:06, 356.62it/s]
Adding requests:  74%|███████▎  | 6022/8192 [00:16<00:06, 350.21it/s]
Adding requests:  74%|███████▍  | 6060/8192 [00:16<00:06, 347.45it/s]
Adding requests:  74%|███████▍  | 6097/8192 [00:17<00:06, 336.73it/s]
Adding requests:  75%|███████▍  | 6132/8192 [00:17<00:06, 334.91it/s]
Adding requests:  75%|███████▌  | 6167/8192 [00:17<00:06, 325.34it/s]
Adding requests:  76%|███████▌  | 6200/8192 [00:17<00:06, 326.23it/s]
Adding requests:  76%|███████▌  | 6235/8192 [00:17<00:05, 331.07it/s]
Adding requests:  77%|███████▋  | 6269/8192 [00:17<00:05, 328.23it/s]
Adding requests:  77%|███████▋  | 6302/8192 [00:17<00:05, 325.02it/s]
Adding requests:  77%|███████▋  | 6335/8192 [00:17<00:05, 321.84it/s]
Adding requests:  78%|███████▊  | 6368/8192 [00:17<00:05, 323.67it/s]
Adding requests:  78%|███████▊  | 6401/8192 [00:18<00:05, 316.58it/s]
Adding requests:  79%|███████▊  | 6433/8192 [00:18<00:05, 313.78it/s]
Adding requests:  79%|███████▉  | 6465/8192 [00:18<00:05, 314.66it/s]
Adding requests:  79%|███████▉  | 6497/8192 [00:18<00:05, 315.26it/s]
Adding requests:  80%|███████▉  | 6531/8192 [00:18<00:05, 321.21it/s]
Adding requests:  80%|████████  | 6565/8192 [00:18<00:04, 326.39it/s]
Adding requests:  81%|████████  | 6598/8192 [00:18<00:04, 325.79it/s]
Adding requests:  81%|████████  | 6632/8192 [00:18<00:04, 327.53it/s]
Adding requests:  81%|████████▏ | 6665/8192 [00:18<00:04, 326.79it/s]
Adding requests:  82%|████████▏ | 6698/8192 [00:18<00:04, 327.52it/s]
Adding requests:  82%|████████▏ | 6732/8192 [00:19<00:04, 330.15it/s]
Adding requests:  83%|████████▎ | 6766/8192 [00:19<00:04, 326.48it/s]
Adding requests:  83%|████████▎ | 6803/8192 [00:19<00:04, 336.31it/s]
Adding requests:  83%|████████▎ | 6837/8192 [00:19<00:04, 334.17it/s]
Adding requests:  84%|████████▍ | 6874/8192 [00:19<00:03, 341.72it/s]
Adding requests:  84%|████████▍ | 6909/8192 [00:19<00:03, 343.81it/s]
Adding requests:  85%|████████▍ | 6945/8192 [00:19<00:03, 348.13it/s]
Adding requests:  85%|████████▌ | 6980/8192 [00:19<00:03, 346.78it/s]
Adding requests:  86%|████████▌ | 7015/8192 [00:19<00:03, 343.47it/s]
Adding requests:  86%|████████▌ | 7051/8192 [00:19<00:03, 347.31it/s]
Adding requests:  86%|████████▋ | 7086/8192 [00:20<00:03, 347.47it/s]
Adding requests:  87%|████████▋ | 7122/8192 [00:20<00:03, 350.54it/s]
Adding requests:  87%|████████▋ | 7158/8192 [00:20<00:02, 348.21it/s]
Adding requests:  88%|████████▊ | 7193/8192 [00:20<00:02, 344.14it/s]
Adding requests:  88%|████████▊ | 7228/8192 [00:20<00:02, 342.18it/s]
Adding requests:  89%|████████▊ | 7263/8192 [00:20<00:02, 342.64it/s]
Adding requests:  89%|████████▉ | 7298/8192 [00:20<00:02, 341.96it/s]
Adding requests:  90%|████████▉ | 7333/8192 [00:20<00:02, 316.53it/s]
Adding requests:  90%|████████▉ | 7367/8192 [00:20<00:02, 321.26it/s]
Adding requests:  90%|█████████ | 7402/8192 [00:21<00:02, 328.81it/s]
Adding requests:  91%|█████████ | 7438/8192 [00:21<00:02, 336.84it/s]
Adding requests:  91%|█████████ | 7473/8192 [00:21<00:02, 340.52it/s]
Adding requests:  92%|█████████▏| 7508/8192 [00:21<00:02, 338.04it/s]
Adding requests:  92%|█████████▏| 7543/8192 [00:21<00:01, 339.01it/s]
Adding requests:  92%|█████████▏| 7577/8192 [00:21<00:01, 331.64it/s]
Adding requests:  93%|█████████▎| 7611/8192 [00:21<00:01, 323.72it/s]
Adding requests:  93%|█████████▎| 7644/8192 [00:21<00:01, 324.63it/s]
Adding requests:  94%|█████████▎| 7677/8192 [00:21<00:01, 318.58it/s]
Adding requests:  94%|█████████▍| 7709/8192 [00:21<00:01, 317.78it/s]
Adding requests:  94%|█████████▍| 7741/8192 [00:22<00:01, 314.11it/s]
Adding requests:  95%|█████████▍| 7773/8192 [00:22<00:01, 314.48it/s]
Adding requests:  95%|█████████▌| 7805/8192 [00:22<00:01, 306.97it/s]
Adding requests:  96%|█████████▌| 7838/8192 [00:22<00:01, 312.28it/s]
Adding requests:  96%|█████████▌| 7870/8192 [00:22<00:01, 310.68it/s]
Adding requests:  96%|█████████▋| 7902/8192 [00:22<00:00, 311.10it/s]
Adding requests:  97%|█████████▋| 7934/8192 [00:22<00:00, 313.19it/s]
Adding requests:  97%|█████████▋| 7966/8192 [00:22<00:00, 311.89it/s]
Adding requests:  98%|█████████▊| 7998/8192 [00:22<00:00, 312.16it/s]
Adding requests:  98%|█████████▊| 8030/8192 [00:23<00:00, 308.92it/s]
Adding requests:  98%|█████████▊| 8064/8192 [00:23<00:00, 316.38it/s]
Adding requests:  99%|█████████▉| 8097/8192 [00:23<00:00, 320.14it/s]
Adding requests:  99%|█████████▉| 8130/8192 [00:23<00:00, 313.46it/s]
Adding requests: 100%|█████████▉| 8162/8192 [00:23<00:00, 310.74it/s]
Adding requests: 100%|██████████| 8192/8192 [00:23<00:00, 348.35it/s]

Processed prompts:   0%|          | 0/8192 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▍         | 386/8192 [00:00<00:14, 523.77it/s, est. speed input: 536359.39 toks/s, output: 523.77 toks/s]
Processed prompts:   5%|▌         | 450/8192 [00:04<01:36, 80.14it/s, est. speed input: 104933.81 toks/s, output: 102.47 toks/s] 
Processed prompts:   6%|▋         | 514/8192 [00:07<02:45, 46.28it/s, est. speed input: 66541.93 toks/s, output: 64.98 toks/s]  
Processed prompts:   7%|▋         | 578/8192 [00:11<03:46, 33.63it/s, est. speed input: 51428.29 toks/s, output: 50.22 toks/s]
Processed prompts:   8%|▊         | 642/8192 [00:14<04:29, 27.99it/s, est. speed input: 44010.10 toks/s, output: 42.98 toks/s]
Processed prompts:   9%|▊         | 706/8192 [00:18<05:09, 24.18it/s, est. speed input: 38894.26 toks/s, output: 37.98 toks/s]
Processed prompts:   9%|▉         | 770/8192 [00:20<04:37, 26.77it/s, est. speed input: 38840.91 toks/s, output: 37.93 toks/s]
Processed prompts:  10%|█         | 834/8192 [00:23<05:09, 23.78it/s, est. speed input: 35942.07 toks/s, output: 35.10 toks/s]
Processed prompts:  11%|█         | 898/8192 [00:27<05:35, 21.76it/s, est. speed input: 33656.04 toks/s, output: 32.87 toks/s]
Processed prompts:  12%|█▏        | 962/8192 [00:30<05:48, 20.72it/s, est. speed input: 32013.76 toks/s, output: 31.26 toks/s]
Processed prompts:  13%|█▎        | 1026/8192 [00:34<06:04, 19.67it/s, est. speed input: 30523.61 toks/s, output: 29.81 toks/s]
Processed prompts:  13%|█▎        | 1090/8192 [00:37<06:09, 19.21it/s, est. speed input: 29418.58 toks/s, output: 28.73 toks/s]
Processed prompts:  14%|█▍        | 1154/8192 [00:41<06:16, 18.72it/s, est. speed input: 28428.45 toks/s, output: 27.76 toks/s]
Processed prompts:  15%|█▍        | 1218/8192 [00:45<06:16, 18.54it/s, est. speed input: 27657.87 toks/s, output: 27.01 toks/s]
Processed prompts:  16%|█▌        | 1282/8192 [00:48<06:16, 18.36it/s, est. speed input: 26979.04 toks/s, output: 26.35 toks/s]
Processed prompts:  16%|█▋        | 1346/8192 [00:52<06:15, 18.25it/s, est. speed input: 26394.92 toks/s, output: 25.78 toks/s]
Processed prompts:  17%|█▋        | 1410/8192 [00:54<05:17, 21.39it/s, est. speed input: 26736.31 toks/s, output: 26.11 toks/s]
Processed prompts:  18%|█▊        | 1474/8192 [00:57<05:34, 20.09it/s, est. speed input: 26185.15 toks/s, output: 25.57 toks/s]
Processed prompts:  19%|█▉        | 1538/8192 [01:01<05:41, 19.48it/s, est. speed input: 25749.76 toks/s, output: 25.15 toks/s]
Processed prompts:  20%|█▉        | 1602/8192 [01:04<05:47, 18.98it/s, est. speed input: 25340.67 toks/s, output: 24.75 toks/s]
Processed prompts:  20%|██        | 1666/8192 [01:08<05:50, 18.59it/s, est. speed input: 24962.76 toks/s, output: 24.38 toks/s]
Processed prompts:  21%|██        | 1730/8192 [01:11<05:48, 18.52it/s, est. speed input: 24664.01 toks/s, output: 24.09 toks/s]
Processed prompts:  22%|██▏       | 1794/8192 [01:15<05:51, 18.21it/s, est. speed input: 24339.02 toks/s, output: 23.77 toks/s]
Processed prompts:  23%|██▎       | 1858/8192 [01:18<05:42, 18.52it/s, est. speed input: 24145.02 toks/s, output: 23.58 toks/s]
Processed prompts:  23%|██▎       | 1922/8192 [01:22<05:44, 18.21it/s, est. speed input: 23870.03 toks/s, output: 23.31 toks/s]
Processed prompts:  24%|██▍       | 1986/8192 [01:24<04:55, 20.99it/s, est. speed input: 24092.02 toks/s, output: 23.53 toks/s]
Processed prompts:  25%|██▌       | 2050/8192 [01:27<05:05, 20.09it/s, est. speed input: 23877.34 toks/s, output: 23.32 toks/s]
Processed prompts:  26%|██▌       | 2114/8192 [01:31<05:16, 19.23it/s, est. speed input: 23638.70 toks/s, output: 23.08 toks/s]
Processed prompts:  27%|██▋       | 2178/8192 [01:35<05:16, 19.00it/s, est. speed input: 23467.52 toks/s, output: 22.92 toks/s]
Processed prompts:  27%|██▋       | 2242/8192 [01:38<05:21, 18.52it/s, est. speed input: 23261.14 toks/s, output: 22.72 toks/s]
Processed prompts:  28%|██▊       | 2306/8192 [01:42<05:18, 18.49it/s, est. speed input: 23111.19 toks/s, output: 22.57 toks/s]
Processed prompts:  29%|██▉       | 2370/8192 [01:45<05:19, 18.23it/s, est. speed input: 22939.34 toks/s, output: 22.40 toks/s]
Processed prompts:  30%|██▉       | 2434/8192 [01:49<05:16, 18.20it/s, est. speed input: 22797.59 toks/s, output: 22.26 toks/s]
Processed prompts:  30%|███       | 2498/8192 [01:52<05:10, 18.33it/s, est. speed input: 22684.23 toks/s, output: 22.15 toks/s]
Processed prompts:  31%|███▏      | 2562/8192 [01:54<04:26, 21.13it/s, est. speed input: 22870.73 toks/s, output: 22.33 toks/s]
Processed prompts:  32%|███▏      | 2626/8192 [01:58<04:34, 20.29it/s, est. speed input: 22758.27 toks/s, output: 22.22 toks/s]
Processed prompts:  33%|███▎      | 2690/8192 [02:01<04:42, 19.46it/s, est. speed input: 22623.37 toks/s, output: 22.09 toks/s]
Processed prompts:  34%|███▎      | 2754/8192 [02:05<04:47, 18.90it/s, est. speed input: 22494.20 toks/s, output: 21.97 toks/s]
Processed prompts:  34%|███▍      | 2818/8192 [02:08<04:48, 18.64it/s, est. speed input: 22384.00 toks/s, output: 21.86 toks/s]
Processed prompts:  35%|███▌      | 2882/8192 [02:12<04:49, 18.33it/s, est. speed input: 22265.83 toks/s, output: 21.74 toks/s]
Processed prompts:  36%|███▌      | 2946/8192 [02:16<04:45, 18.37it/s, est. speed input: 22179.99 toks/s, output: 21.66 toks/s]
Processed prompts:  37%|███▋      | 3010/8192 [02:19<04:46, 18.11it/s, est. speed input: 22069.15 toks/s, output: 21.55 toks/s]
Processed prompts:  38%|███▊      | 3074/8192 [02:23<04:39, 18.30it/s, est. speed input: 22001.72 toks/s, output: 21.49 toks/s]
Processed prompts:  38%|███▊      | 3138/8192 [02:25<03:59, 21.06it/s, est. speed input: 22154.61 toks/s, output: 21.64 toks/s]
Processed prompts:  39%|███▉      | 3202/8192 [02:28<04:09, 19.99it/s, est. speed input: 22061.77 toks/s, output: 21.54 toks/s]
Processed prompts:  40%|███▉      | 3266/8192 [02:32<04:12, 19.52it/s, est. speed input: 21990.97 toks/s, output: 21.48 toks/s]
Processed prompts:  41%|████      | 3330/8192 [02:35<04:17, 18.86it/s, est. speed input: 21895.01 toks/s, output: 21.38 toks/s]
Processed prompts:  41%|████▏     | 3394/8192 [02:39<04:16, 18.67it/s, est. speed input: 21824.00 toks/s, output: 21.31 toks/s]
Processed prompts:  42%|████▏     | 3458/8192 [02:42<04:18, 18.30it/s, est. speed input: 21735.94 toks/s, output: 21.23 toks/s]
Processed prompts:  43%|████▎     | 3522/8192 [02:46<04:14, 18.32it/s, est. speed input: 21674.53 toks/s, output: 21.17 toks/s]
Processed prompts:  44%|████▍     | 3586/8192 [02:49<04:13, 18.16it/s, est. speed input: 21602.02 toks/s, output: 21.10 toks/s]
Processed prompts:  45%|████▍     | 3650/8192 [02:53<04:09, 18.19it/s, est. speed input: 21543.28 toks/s, output: 21.04 toks/s]
Processed prompts:  45%|████▌     | 3714/8192 [02:55<03:31, 21.17it/s, est. speed input: 21687.55 toks/s, output: 21.18 toks/s]
Processed prompts:  46%|████▌     | 3778/8192 [02:59<03:41, 19.90it/s, est. speed input: 21609.29 toks/s, output: 21.10 toks/s]
Processed prompts:  47%|████▋     | 3842/8192 [03:02<03:42, 19.52it/s, est. speed input: 21562.90 toks/s, output: 21.06 toks/s]
Processed prompts:  48%|████▊     | 3906/8192 [03:06<03:46, 18.96it/s, est. speed input: 21498.05 toks/s, output: 20.99 toks/s]
Processed prompts:  48%|████▊     | 3970/8192 [03:09<03:48, 18.51it/s, est. speed input: 21429.47 toks/s, output: 20.93 toks/s]
Processed prompts:  49%|████▉     | 4034/8192 [03:13<03:43, 18.57it/s, est. speed input: 21389.45 toks/s, output: 20.89 toks/s]
Processed prompts:  50%|█████     | 4098/8192 [03:16<03:43, 18.31it/s, est. speed input: 21329.85 toks/s, output: 20.83 toks/s]
Processed prompts:  51%|█████     | 4162/8192 [03:20<03:38, 18.41it/s, est. speed input: 21291.74 toks/s, output: 20.79 toks/s]
Processed prompts:  52%|█████▏    | 4226/8192 [03:23<03:36, 18.29it/s, est. speed input: 21242.20 toks/s, output: 20.74 toks/s]
Processed prompts:  52%|█████▏    | 4290/8192 [03:25<03:00, 21.56it/s, est. speed input: 21382.45 toks/s, output: 20.88 toks/s]
Processed prompts:  53%|█████▎    | 4354/8192 [03:28<03:07, 20.47it/s, est. speed input: 21338.43 toks/s, output: 20.84 toks/s]
Processed prompts:  54%|█████▍    | 4418/8192 [03:32<03:13, 19.48it/s, est. speed input: 21279.85 toks/s, output: 20.78 toks/s]
Processed prompts:  55%|█████▍    | 4482/8192 [03:36<03:12, 19.23it/s, est. speed input: 21245.48 toks/s, output: 20.75 toks/s]
Processed prompts:  55%|█████▌    | 4546/8192 [03:39<03:15, 18.68it/s, est. speed input: 21190.18 toks/s, output: 20.69 toks/s]
Processed prompts:  56%|█████▋    | 4610/8192 [03:43<03:12, 18.61it/s, est. speed input: 21154.49 toks/s, output: 20.66 toks/s]
Processed prompts:  57%|█████▋    | 4674/8192 [03:46<03:11, 18.33it/s, est. speed input: 21106.54 toks/s, output: 20.61 toks/s]
Processed prompts:  58%|█████▊    | 4738/8192 [03:50<03:09, 18.26it/s, est. speed input: 21067.17 toks/s, output: 20.57 toks/s]
Processed prompts:  59%|█████▊    | 4802/8192 [03:53<03:06, 18.21it/s, est. speed input: 21028.67 toks/s, output: 20.54 toks/s]
Processed prompts:  59%|█████▉    | 4866/8192 [03:57<03:04, 18.06it/s, est. speed input: 20984.99 toks/s, output: 20.49 toks/s]
Processed prompts:  60%|██████    | 4930/8192 [03:59<02:32, 21.33it/s, est. speed input: 21106.81 toks/s, output: 20.61 toks/s]
Processed prompts:  61%|██████    | 4994/8192 [04:02<02:37, 20.33it/s, est. speed input: 21072.92 toks/s, output: 20.58 toks/s]
Processed prompts:  62%|██████▏   | 5058/8192 [04:06<02:40, 19.57it/s, est. speed input: 21035.05 toks/s, output: 20.54 toks/s]
Processed prompts:  63%|██████▎   | 5122/8192 [04:09<02:40, 19.13it/s, est. speed input: 21000.83 toks/s, output: 20.51 toks/s]
Processed prompts:  63%|██████▎   | 5186/8192 [04:13<02:41, 18.65it/s, est. speed input: 20958.47 toks/s, output: 20.47 toks/s]
Processed prompts:  64%|██████▍   | 5250/8192 [04:16<02:38, 18.62it/s, est. speed input: 20931.85 toks/s, output: 20.44 toks/s]
Processed prompts:  65%|██████▍   | 5314/8192 [04:20<02:37, 18.28it/s, est. speed input: 20890.04 toks/s, output: 20.40 toks/s]
Processed prompts:  66%|██████▌   | 5378/8192 [04:23<02:32, 18.40it/s, est. speed input: 20867.18 toks/s, output: 20.38 toks/s]
Processed prompts:  66%|██████▋   | 5442/8192 [04:27<02:31, 18.13it/s, est. speed input: 20827.53 toks/s, output: 20.34 toks/s]
Processed prompts:  67%|██████▋   | 5506/8192 [04:29<02:09, 20.72it/s, est. speed input: 20911.58 toks/s, output: 20.42 toks/s]
Processed prompts:  68%|██████▊   | 5570/8192 [04:33<02:11, 20.01it/s, est. speed input: 20887.22 toks/s, output: 20.40 toks/s]
Processed prompts:  69%|██████▉   | 5634/8192 [04:36<02:13, 19.20it/s, est. speed input: 20848.60 toks/s, output: 20.36 toks/s]
Processed prompts:  70%|██████▉   | 5698/8192 [04:40<02:11, 19.01it/s, est. speed input: 20826.14 toks/s, output: 20.34 toks/s]
Processed prompts:  70%|███████   | 5762/8192 [04:43<02:11, 18.54it/s, est. speed input: 20789.12 toks/s, output: 20.30 toks/s]
Processed prompts:  71%|███████   | 5826/8192 [04:47<02:08, 18.45it/s, est. speed input: 20763.58 toks/s, output: 20.28 toks/s]
Processed prompts:  72%|███████▏  | 5890/8192 [04:50<02:05, 18.29it/s, est. speed input: 20733.86 toks/s, output: 20.25 toks/s]
Processed prompts:  73%|███████▎  | 5954/8192 [04:54<02:03, 18.18it/s, est. speed input: 20705.29 toks/s, output: 20.22 toks/s]
Processed prompts:  73%|███████▎  | 6018/8192 [04:57<01:59, 18.24it/s, est. speed input: 20682.99 toks/s, output: 20.20 toks/s]
Processed prompts:  74%|███████▍  | 6082/8192 [04:59<01:40, 20.95it/s, est. speed input: 20763.95 toks/s, output: 20.28 toks/s]
Processed prompts:  75%|███████▌  | 6146/8192 [05:03<01:42, 20.03it/s, est. speed input: 20738.96 toks/s, output: 20.25 toks/s]
Processed prompts:  76%|███████▌  | 6210/8192 [05:07<01:42, 19.34it/s, est. speed input: 20711.01 toks/s, output: 20.23 toks/s]
Processed prompts:  77%|███████▋  | 6274/8192 [05:10<01:41, 18.83it/s, est. speed input: 20681.23 toks/s, output: 20.20 toks/s]
Processed prompts:  77%|███████▋  | 6338/8192 [05:14<01:39, 18.69it/s, est. speed input: 20660.38 toks/s, output: 20.18 toks/s]
Processed prompts:  78%|███████▊  | 6402/8192 [05:17<01:37, 18.31it/s, est. speed input: 20628.52 toks/s, output: 20.15 toks/s]
Processed prompts:  79%|███████▉  | 6466/8192 [05:21<01:33, 18.43it/s, est. speed input: 20612.94 toks/s, output: 20.13 toks/s]
Processed prompts:  80%|███████▉  | 6530/8192 [05:24<01:31, 18.14it/s, est. speed input: 20582.88 toks/s, output: 20.10 toks/s]
Processed prompts:  80%|████████  | 6594/8192 [05:28<01:26, 18.40it/s, est. speed input: 20571.50 toks/s, output: 20.09 toks/s]
Processed prompts:  81%|████████▏ | 6658/8192 [05:30<01:11, 21.46it/s, est. speed input: 20656.27 toks/s, output: 20.17 toks/s]
Processed prompts:  82%|████████▏ | 6722/8192 [05:33<01:13, 20.10it/s, est. speed input: 20626.45 toks/s, output: 20.14 toks/s]
Processed prompts:  83%|████████▎ | 6786/8192 [05:37<01:11, 19.68it/s, est. speed input: 20612.26 toks/s, output: 20.13 toks/s]
Processed prompts:  84%|████████▎ | 6850/8192 [05:40<01:10, 18.99it/s, est. speed input: 20584.01 toks/s, output: 20.10 toks/s]
Processed prompts:  84%|████████▍ | 6914/8192 [05:44<01:08, 18.72it/s, est. speed input: 20563.03 toks/s, output: 20.08 toks/s]
Processed prompts:  85%|████████▌ | 6978/8192 [05:47<01:05, 18.44it/s, est. speed input: 20539.24 toks/s, output: 20.06 toks/s]
Processed prompts:  86%|████████▌ | 7042/8192 [05:51<01:02, 18.31it/s, est. speed input: 20518.15 toks/s, output: 20.04 toks/s]
Processed prompts:  87%|████████▋ | 7106/8192 [05:54<00:59, 18.30it/s, est. speed input: 20500.17 toks/s, output: 20.02 toks/s]
Processed prompts:  88%|████████▊ | 7170/8192 [05:58<00:56, 18.13it/s, est. speed input: 20476.96 toks/s, output: 20.00 toks/s]
Processed prompts:  88%|████████▊ | 7234/8192 [06:00<00:44, 21.40it/s, est. speed input: 20560.21 toks/s, output: 20.08 toks/s]
Processed prompts:  89%|████████▉ | 7298/8192 [06:03<00:44, 20.29it/s, est. speed input: 20540.70 toks/s, output: 20.06 toks/s]
Processed prompts:  90%|████████▉ | 7362/8192 [06:07<00:42, 19.47it/s, est. speed input: 20517.99 toks/s, output: 20.04 toks/s]
Processed prompts:  91%|█████████ | 7426/8192 [06:10<00:40, 19.08it/s, est. speed input: 20500.48 toks/s, output: 20.02 toks/s]
Processed prompts:  91%|█████████▏| 7490/8192 [06:14<00:37, 18.59it/s, est. speed input: 20475.52 toks/s, output: 20.00 toks/s]
Processed prompts:  92%|█████████▏| 7554/8192 [06:18<00:34, 18.53it/s, est. speed input: 20460.38 toks/s, output: 19.98 toks/s]
Processed prompts:  93%|█████████▎| 7618/8192 [06:21<00:31, 18.21it/s, est. speed input: 20436.24 toks/s, output: 19.96 toks/s]
Processed prompts:  94%|█████████▍| 7682/8192 [06:25<00:27, 18.34it/s, est. speed input: 20424.16 toks/s, output: 19.95 toks/s]
Processed prompts:  95%|█████████▍| 7746/8192 [06:28<00:24, 18.10it/s, est. speed input: 20401.31 toks/s, output: 19.92 toks/s]
Processed prompts:  95%|█████████▌| 7810/8192 [06:30<00:18, 21.04it/s, est. speed input: 20470.52 toks/s, output: 19.99 toks/s]
Processed prompts:  96%|█████████▌| 7874/8192 [06:34<00:15, 20.29it/s, est. speed input: 20459.26 toks/s, output: 19.98 toks/s]
Processed prompts:  97%|█████████▋| 7938/8192 [06:37<00:13, 19.39it/s, est. speed input: 20436.71 toks/s, output: 19.96 toks/s]
Processed prompts:  98%|█████████▊| 8002/8192 [06:41<00:09, 19.10it/s, est. speed input: 20423.42 toks/s, output: 19.94 toks/s]
Processed prompts:  98%|█████████▊| 8066/8192 [06:44<00:06, 18.81it/s, est. speed input: 20407.65 toks/s, output: 19.93 toks/s]
Processed prompts:  99%|█████████▉| 8130/8192 [06:48<00:03, 18.74it/s, est. speed input: 20395.94 toks/s, output: 19.92 toks/s]
Processed prompts: 100%|██████████| 8192/8192 [06:48<00:00, 18.74it/s, est. speed input: 20551.43 toks/s, output: 20.07 toks/s]
Processed prompts: 100%|██████████| 8192/8192 [06:48<00:00, 20.07it/s, est. speed input: 20551.43 toks/s, output: 20.07 toks/s]
[rank0]:[W125 20:56:23.925616076 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=512 ==========
Time: 2026-01-25 23:49:27
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_6
Params: prompt_len=512, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_6 --dataset-name random --input-len 512 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 513 --max-num-batched-tokens 513 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Qwen2.5-7B-INT8_M512.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 23:49:36 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 23:49:37 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=560056) WARNING 01-25 23:49:45 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=560056) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=560056) WARNING 01-25 23:50:05 [backends.py:609] Failed to read file <frozen os>
Throughput: 14.74 requests/s, 7559.33 total tokens/s, 14.74 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128

STDERR:
[2026-01-25 23:49:36] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 23:49:36] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 23:49:36] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 23:49:36] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:49:36] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:49:36] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:49:36] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:49:36] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:49:36] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 23:49:36] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 23:49:36] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 23:49:36] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 23:49:36] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 23:49:36] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 23:49:45] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 23:49:45] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 23:49:45] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 23:49:45] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:49:45] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:49:45] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:49:45] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:49:45] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:49:45] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 23:49:45] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 23:49:45] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 23:49:45] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 23:49:45] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 23:49:45] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=560056) [2026-01-25 23:49:46] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=560056) [2026-01-25 23:49:46] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=560056) [2026-01-25 23:49:46] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=560056) [2026-01-25 23:49:46] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=560056) [2026-01-25 23:49:46] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=560056) [2026-01-25 23:49:46] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=560056) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=560056) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:03<00:03,  3.72s/it]
(EngineCore_DP0 pid=560056) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:07<00:00,  3.79s/it]
(EngineCore_DP0 pid=560056) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:07<00:00,  3.78s/it]
(EngineCore_DP0 pid=560056) 
(EngineCore_DP0 pid=560056) [2026-01-25 23:49:55] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 4800] -> 1D uint8
(EngineCore_DP0 pid=560056) [2026-01-25 23:49:55] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 16662528 bytes
(EngineCore_DP0 pid=560056) [2026-01-25 23:49:55] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 4800] -> 1D uint8
(EngineCore_DP0 pid=560056) [2026-01-25 23:49:55] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12959744 bytes
(EngineCore_DP0 pid=560056) [2026-01-25 23:49:55] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 4800] -> 1D uint8
(EngineCore_DP0 pid=560056) [2026-01-25 23:49:55] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 137003008 bytes
(EngineCore_DP0 pid=560056) [2026-01-25 23:49:55] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 25280] -> 1D uint8
(EngineCore_DP0 pid=560056) [2026-01-25 23:49:55] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 68009984 bytes
(EngineCore_DP0 pid=560056) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00, -25.61it/s]
(EngineCore_DP0 pid=560056) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  6.74it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  6.73it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  30%|███       | 39/128 [00:00<00:00, 389.38it/s]
Adding requests:  64%|██████▍   | 82/128 [00:00<00:00, 410.54it/s]
Adding requests:  98%|█████████▊| 125/128 [00:00<00:00, 417.87it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 412.78it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:52,  2.41it/s, est. speed input: 1232.05 toks/s, output: 2.41 toks/s]
Processed prompts:   2%|▏         | 2/128 [00:00<00:36,  3.43it/s, est. speed input: 1652.00 toks/s, output: 3.23 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:18,  6.70it/s, est. speed input: 2733.43 toks/s, output: 5.34 toks/s]
Processed prompts:   5%|▍         | 6/128 [00:00<00:13,  9.00it/s, est. speed input: 3465.06 toks/s, output: 6.77 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:01<00:11, 10.80it/s, est. speed input: 4027.92 toks/s, output: 7.87 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:01<00:09, 12.06it/s, est. speed input: 4455.97 toks/s, output: 8.70 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:01<00:08, 13.06it/s, est. speed input: 4808.18 toks/s, output: 9.39 toks/s]
Processed prompts:  11%|█         | 14/128 [00:01<00:08, 13.94it/s, est. speed input: 5114.04 toks/s, output: 9.99 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:01<00:07, 14.51it/s, est. speed input: 5363.36 toks/s, output: 10.48 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:01<00:07, 15.25it/s, est. speed input: 5606.46 toks/s, output: 10.95 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:01<00:06, 15.82it/s, est. speed input: 5819.34 toks/s, output: 11.37 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:01<00:06, 16.30it/s, est. speed input: 6011.04 toks/s, output: 11.74 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:01<00:06, 16.68it/s, est. speed input: 6182.37 toks/s, output: 12.07 toks/s]
Processed prompts:  20%|██        | 26/128 [00:02<00:06, 16.90it/s, est. speed input: 6332.21 toks/s, output: 12.37 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:02<00:05, 16.95it/s, est. speed input: 6459.50 toks/s, output: 12.62 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:02<00:05, 16.92it/s, est. speed input: 6569.64 toks/s, output: 12.83 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:02<00:05, 16.87it/s, est. speed input: 6666.80 toks/s, output: 13.02 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:02<00:05, 16.90it/s, est. speed input: 6759.22 toks/s, output: 13.20 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:02<00:05, 16.90it/s, est. speed input: 6842.31 toks/s, output: 13.36 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:02<00:05, 16.84it/s, est. speed input: 6915.15 toks/s, output: 13.51 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:02<00:05, 16.85it/s, est. speed input: 6984.86 toks/s, output: 13.64 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:03<00:05, 16.81it/s, est. speed input: 7046.57 toks/s, output: 13.76 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:03<00:04, 16.84it/s, est. speed input: 7106.58 toks/s, output: 13.88 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:03<00:04, 16.75it/s, est. speed input: 7156.84 toks/s, output: 13.98 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:03<00:04, 16.70it/s, est. speed input: 7204.16 toks/s, output: 14.07 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:03<00:04, 16.74it/s, est. speed input: 7251.75 toks/s, output: 14.16 toks/s]
Processed prompts:  41%|████      | 52/128 [00:03<00:04, 16.75it/s, est. speed input: 7295.10 toks/s, output: 14.25 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:03<00:04, 16.71it/s, est. speed input: 7334.19 toks/s, output: 14.32 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:03<00:04, 16.69it/s, est. speed input: 7370.95 toks/s, output: 14.40 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:04<00:04, 16.71it/s, est. speed input: 7406.63 toks/s, output: 14.47 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:04<00:04, 16.77it/s, est. speed input: 7442.63 toks/s, output: 14.54 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:04<00:03, 16.81it/s, est. speed input: 7476.58 toks/s, output: 14.60 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:04<00:03, 16.72it/s, est. speed input: 7503.60 toks/s, output: 14.66 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:04<00:03, 16.72it/s, est. speed input: 7531.60 toks/s, output: 14.71 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:04<00:03, 16.72it/s, est. speed input: 7558.53 toks/s, output: 14.76 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:04<00:03, 16.77it/s, est. speed input: 7585.92 toks/s, output: 14.82 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:04<00:03, 16.80it/s, est. speed input: 7611.61 toks/s, output: 14.87 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:04<00:03, 16.79it/s, est. speed input: 7635.09 toks/s, output: 14.91 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:05<00:03, 16.79it/s, est. speed input: 7657.64 toks/s, output: 14.96 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:05<00:02, 16.68it/s, est. speed input: 7675.24 toks/s, output: 14.99 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:05<00:02, 16.33it/s, est. speed input: 7682.32 toks/s, output: 15.00 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:05<00:02, 16.07it/s, est. speed input: 7688.41 toks/s, output: 15.02 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:05<00:02, 15.90it/s, est. speed input: 7694.08 toks/s, output: 15.03 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:05<00:02, 15.80it/s, est. speed input: 7700.44 toks/s, output: 15.04 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:05<00:02, 15.72it/s, est. speed input: 7706.12 toks/s, output: 15.05 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:05<00:02, 15.68it/s, est. speed input: 7712.05 toks/s, output: 15.06 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:06<00:02, 15.43it/s, est. speed input: 7709.99 toks/s, output: 15.06 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:06<00:02, 15.48it/s, est. speed input: 7715.73 toks/s, output: 15.07 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:06<00:02, 15.60it/s, est. speed input: 7724.06 toks/s, output: 15.09 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:06<00:01, 15.63it/s, est. speed input: 7730.00 toks/s, output: 15.10 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:06<00:01, 15.73it/s, est. speed input: 7738.60 toks/s, output: 15.11 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:06<00:01, 15.75it/s, est. speed input: 7745.22 toks/s, output: 15.13 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:06<00:01, 15.80it/s, est. speed input: 7752.45 toks/s, output: 15.14 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:06<00:01, 15.76it/s, est. speed input: 7757.39 toks/s, output: 15.15 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:07<00:01, 15.78it/s, est. speed input: 7763.52 toks/s, output: 15.16 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:07<00:01, 15.79it/s, est. speed input: 7769.43 toks/s, output: 15.17 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:07<00:01, 15.86it/s, est. speed input: 7776.79 toks/s, output: 15.19 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:07<00:00, 15.93it/s, est. speed input: 7784.59 toks/s, output: 15.20 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:07<00:00, 15.94it/s, est. speed input: 7791.01 toks/s, output: 15.22 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:07<00:00, 15.97it/s, est. speed input: 7797.84 toks/s, output: 15.23 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:07<00:00, 15.98it/s, est. speed input: 7803.93 toks/s, output: 15.24 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:07<00:00, 16.00it/s, est. speed input: 7810.39 toks/s, output: 15.25 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:08<00:00, 16.05it/s, est. speed input: 7817.51 toks/s, output: 15.27 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:08<00:00, 16.01it/s, est. speed input: 7822.56 toks/s, output: 15.28 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:08<00:00, 15.91it/s, est. speed input: 7825.63 toks/s, output: 15.28 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:08<00:00, 15.91it/s, est. speed input: 7825.63 toks/s, output: 15.28 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:08<00:00, 15.28it/s, est. speed input: 7825.63 toks/s, output: 15.28 toks/s]
[rank0]:[W125 23:50:32.162603311 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=1024 ==========
Time: 2026-01-25 23:50:35
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 1025 --max-num-batched-tokens 1025 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Qwen2.5-7B-INT8_M1024.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 23:50:44 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 23:50:45 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=561295) WARNING 01-25 23:50:52 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=561295) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=561295) WARNING 01-25 23:51:08 [backends.py:609] Failed to read file <frozen os>
Throughput: 14.81 requests/s, 15179.97 total tokens/s, 14.81 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128

STDERR:
[2026-01-25 23:50:44] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 23:50:44] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 23:50:44] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 23:50:44] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:50:44] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:50:44] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:50:44] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:50:44] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:50:44] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 23:50:44] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 23:50:44] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 23:50:44] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 23:50:44] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 23:50:44] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 23:50:51] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 23:50:51] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 23:50:51] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 23:50:51] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:50:51] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:50:51] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:50:51] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:50:51] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:50:51] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 23:50:51] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 23:50:51] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 23:50:51] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 23:50:51] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 23:50:51] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=561295) [2026-01-25 23:50:52] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=561295) [2026-01-25 23:50:52] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=561295) [2026-01-25 23:50:52] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=561295) [2026-01-25 23:50:52] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=561295) [2026-01-25 23:50:52] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=561295) [2026-01-25 23:50:52] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=561295) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=561295) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:01<00:01,  1.13s/it]
(EngineCore_DP0 pid=561295) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.48s/it]
(EngineCore_DP0 pid=561295) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.43s/it]
(EngineCore_DP0 pid=561295) 
(EngineCore_DP0 pid=561295) [2026-01-25 23:50:58] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 4800] -> 1D uint8
(EngineCore_DP0 pid=561295) [2026-01-25 23:50:58] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 16662528 bytes
(EngineCore_DP0 pid=561295) [2026-01-25 23:50:58] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 4800] -> 1D uint8
(EngineCore_DP0 pid=561295) [2026-01-25 23:50:58] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12959744 bytes
(EngineCore_DP0 pid=561295) [2026-01-25 23:50:58] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 4800] -> 1D uint8
(EngineCore_DP0 pid=561295) [2026-01-25 23:50:58] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 137003008 bytes
(EngineCore_DP0 pid=561295) [2026-01-25 23:50:58] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 25280] -> 1D uint8
(EngineCore_DP0 pid=561295) [2026-01-25 23:50:58] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 68009984 bytes
(EngineCore_DP0 pid=561295) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  1.51it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:01<00:00,  1.99it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:01<00:00,  1.90it/s]
(EngineCore_DP0 pid=561295) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  1.84it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  1.84it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  16%|█▋        | 21/128 [00:00<00:00, 206.03it/s]
Adding requests:  35%|███▌      | 45/128 [00:00<00:00, 221.15it/s]
Adding requests:  55%|█████▍    | 70/128 [00:00<00:00, 228.09it/s]
Adding requests:  73%|███████▎  | 93/128 [00:00<00:00, 223.80it/s]
Adding requests:  91%|█████████ | 116/128 [00:00<00:00, 224.95it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 224.22it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:07, 17.18it/s, est. speed input: 17599.46 toks/s, output: 17.18 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:07, 15.51it/s, est. speed input: 16164.69 toks/s, output: 15.78 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:07, 15.50it/s, est. speed input: 16080.72 toks/s, output: 15.70 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:00<00:07, 15.55it/s, est. speed input: 16062.49 toks/s, output: 15.69 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:00<00:07, 15.14it/s, est. speed input: 15809.24 toks/s, output: 15.44 toks/s]
Processed prompts:  10%|█         | 13/128 [00:00<00:07, 15.22it/s, est. speed input: 15801.60 toks/s, output: 15.43 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:00<00:07, 15.22it/s, est. speed input: 15770.63 toks/s, output: 15.40 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:01<00:07, 15.27it/s, est. speed input: 15770.89 toks/s, output: 15.40 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:01<00:07, 15.41it/s, est. speed input: 15805.90 toks/s, output: 15.44 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:01<00:06, 15.46it/s, est. speed input: 15818.23 toks/s, output: 15.45 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:01<00:06, 15.49it/s, est. speed input: 15828.77 toks/s, output: 15.46 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:01<00:06, 15.56it/s, est. speed input: 15849.40 toks/s, output: 15.48 toks/s]
Processed prompts:  21%|██        | 27/128 [00:01<00:06, 15.43it/s, est. speed input: 15823.80 toks/s, output: 15.45 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:01<00:06, 15.42it/s, est. speed input: 15818.60 toks/s, output: 15.45 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:02<00:06, 15.34it/s, est. speed input: 15801.02 toks/s, output: 15.43 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:02<00:06, 15.42it/s, est. speed input: 15810.06 toks/s, output: 15.44 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:02<00:06, 15.45it/s, est. speed input: 15815.42 toks/s, output: 15.44 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:02<00:05, 15.49it/s, est. speed input: 15823.38 toks/s, output: 15.45 toks/s]
Processed prompts:  30%|███       | 39/128 [00:02<00:05, 15.50it/s, est. speed input: 15826.83 toks/s, output: 15.46 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:02<00:05, 15.54it/s, est. speed input: 15835.87 toks/s, output: 15.46 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:02<00:05, 15.48it/s, est. speed input: 15830.00 toks/s, output: 15.46 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:02<00:05, 15.41it/s, est. speed input: 15820.25 toks/s, output: 15.45 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:03<00:05, 15.34it/s, est. speed input: 15808.59 toks/s, output: 15.44 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:03<00:05, 15.37it/s, est. speed input: 15808.59 toks/s, output: 15.44 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:03<00:05, 15.36it/s, est. speed input: 15804.50 toks/s, output: 15.43 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:03<00:04, 15.36it/s, est. speed input: 15801.12 toks/s, output: 15.43 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:03<00:04, 15.35it/s, est. speed input: 15797.90 toks/s, output: 15.43 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:03<00:04, 15.35it/s, est. speed input: 15794.82 toks/s, output: 15.42 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:03<00:04, 15.51it/s, est. speed input: 15810.78 toks/s, output: 15.44 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:03<00:04, 15.81it/s, est. speed input: 15845.60 toks/s, output: 15.47 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:04<00:04, 16.03it/s, est. speed input: 15879.14 toks/s, output: 15.51 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:04<00:03, 16.27it/s, est. speed input: 15917.96 toks/s, output: 15.54 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:04<00:03, 16.48it/s, est. speed input: 15959.00 toks/s, output: 15.58 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:04<00:03, 16.60it/s, est. speed input: 15994.34 toks/s, output: 15.62 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:04<00:03, 16.72it/s, est. speed input: 16031.37 toks/s, output: 15.66 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:04<00:03, 16.84it/s, est. speed input: 16068.86 toks/s, output: 15.69 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:04<00:03, 16.91it/s, est. speed input: 16103.49 toks/s, output: 15.73 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:04<00:03, 16.86it/s, est. speed input: 16128.92 toks/s, output: 15.75 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:05<00:02, 16.86it/s, est. speed input: 16156.22 toks/s, output: 15.78 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:05<00:02, 16.47it/s, est. speed input: 16152.94 toks/s, output: 15.77 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:05<00:02, 16.58it/s, est. speed input: 16176.85 toks/s, output: 15.80 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:05<00:02, 16.69it/s, est. speed input: 16202.63 toks/s, output: 15.82 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:05<00:02, 16.74it/s, est. speed input: 16225.61 toks/s, output: 15.85 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:05<00:02, 16.39it/s, est. speed input: 16220.82 toks/s, output: 15.84 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:05<00:02, 16.32it/s, est. speed input: 16227.46 toks/s, output: 15.85 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:05<00:02, 16.51it/s, est. speed input: 16250.78 toks/s, output: 15.87 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:05<00:01, 16.60it/s, est. speed input: 16270.13 toks/s, output: 15.89 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:06<00:01, 16.65it/s, est. speed input: 16287.90 toks/s, output: 15.91 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:06<00:01, 16.68it/s, est. speed input: 16304.35 toks/s, output: 15.92 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:06<00:01, 16.73it/s, est. speed input: 16321.92 toks/s, output: 15.94 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:06<00:01, 16.52it/s, est. speed input: 16324.26 toks/s, output: 15.94 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:06<00:01, 16.23it/s, est. speed input: 16317.16 toks/s, output: 15.93 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:06<00:01, 15.99it/s, est. speed input: 16307.91 toks/s, output: 15.93 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:06<00:01, 15.83it/s, est. speed input: 16298.68 toks/s, output: 15.92 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:06<00:01, 15.51it/s, est. speed input: 16276.75 toks/s, output: 15.90 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:07<00:00, 15.51it/s, est. speed input: 16269.86 toks/s, output: 15.89 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:07<00:00, 15.49it/s, est. speed input: 16261.70 toks/s, output: 15.88 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:07<00:00, 15.57it/s, est. speed input: 16259.73 toks/s, output: 15.88 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:07<00:00, 15.68it/s, est. speed input: 16260.93 toks/s, output: 15.88 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:07<00:00, 15.77it/s, est. speed input: 16262.62 toks/s, output: 15.88 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:07<00:00, 15.76it/s, est. speed input: 16260.20 toks/s, output: 15.88 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:07<00:00, 15.62it/s, est. speed input: 16250.43 toks/s, output: 15.87 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:08<00:00, 15.55it/s, est. speed input: 16242.29 toks/s, output: 15.86 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:08<00:00, 15.55it/s, est. speed input: 16241.10 toks/s, output: 15.86 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:08<00:00, 15.86it/s, est. speed input: 16241.10 toks/s, output: 15.86 toks/s]
[rank0]:[W125 23:51:35.219573407 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=2048 ==========
Time: 2026-01-25 23:51:38
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=256, max_num_seqs=2
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 256 --max-num-seqs 2 --max-model-len 1025 --max-num-batched-tokens 2048 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Qwen2.5-7B-INT8_M2048.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 23:51:48 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 23:51:49 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=562442) WARNING 01-25 23:51:56 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=562442) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=562442) WARNING 01-25 23:52:10 [backends.py:609] Failed to read file <frozen os>
Throughput: 22.35 requests/s, 22912.70 total tokens/s, 22.35 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256

STDERR:
[2026-01-25 23:51:48] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 23:51:48] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 23:51:48] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 23:51:48] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:51:48] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:51:48] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:51:48] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:51:48] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:51:48] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 23:51:48] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 23:51:48] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 23:51:48] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 23:51:48] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 23:51:48] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 23:51:55] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 23:51:55] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 23:51:55] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 23:51:55] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:51:55] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:51:55] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:51:55] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:51:55] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:51:55] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 23:51:55] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 23:51:55] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 23:51:55] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 23:51:55] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 23:51:55] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=562442) [2026-01-25 23:51:57] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=562442) [2026-01-25 23:51:57] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=562442) [2026-01-25 23:51:57] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=562442) [2026-01-25 23:51:57] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=562442) [2026-01-25 23:51:57] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=562442) [2026-01-25 23:51:57] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=562442) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=562442) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:01<00:01,  1.01s/it]
(EngineCore_DP0 pid=562442) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.35s/it]
(EngineCore_DP0 pid=562442) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.30s/it]
(EngineCore_DP0 pid=562442) 
(EngineCore_DP0 pid=562442) [2026-01-25 23:52:01] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 4800] -> 1D uint8
(EngineCore_DP0 pid=562442) [2026-01-25 23:52:01] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 16662528 bytes
(EngineCore_DP0 pid=562442) [2026-01-25 23:52:01] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 4800] -> 1D uint8
(EngineCore_DP0 pid=562442) [2026-01-25 23:52:01] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12959744 bytes
(EngineCore_DP0 pid=562442) [2026-01-25 23:52:01] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 4800] -> 1D uint8
(EngineCore_DP0 pid=562442) [2026-01-25 23:52:01] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 137003008 bytes
(EngineCore_DP0 pid=562442) [2026-01-25 23:52:01] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 25280] -> 1D uint8
(EngineCore_DP0 pid=562442) [2026-01-25 23:52:01] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 68009984 bytes
(EngineCore_DP0 pid=562442) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  33%|███▎      | 1/3 [00:00<00:01,  1.74it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  67%|██████▋   | 2/3 [00:00<00:00,  2.53it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:01<00:00,  2.35it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:01<00:00,  2.30it/s]
(EngineCore_DP0 pid=562442) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 1/2 [00:00<00:00,  4.92it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  6.84it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  6.46it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:   8%|▊         | 21/256 [00:00<00:01, 200.95it/s]
Adding requests:  18%|█▊        | 45/256 [00:00<00:00, 220.19it/s]
Adding requests:  28%|██▊       | 71/256 [00:00<00:00, 234.49it/s]
Adding requests:  37%|███▋      | 95/256 [00:00<00:00, 233.26it/s]
Adding requests:  46%|████▋     | 119/256 [00:00<00:00, 231.26it/s]
Adding requests:  56%|█████▌    | 143/256 [00:00<00:00, 232.06it/s]
Adding requests:  65%|██████▌   | 167/256 [00:00<00:00, 232.62it/s]
Adding requests:  75%|███████▌  | 192/256 [00:00<00:00, 237.15it/s]
Adding requests:  84%|████████▍ | 216/256 [00:00<00:00, 235.45it/s]
Adding requests:  94%|█████████▍| 240/256 [00:01<00:00, 234.51it/s]
Adding requests: 100%|██████████| 256/256 [00:01<00:00, 231.64it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   7%|▋         | 18/256 [00:00<00:01, 127.39it/s, est. speed input: 130474.51 toks/s, output: 127.40 toks/s]
Processed prompts:  12%|█▏        | 31/256 [00:00<00:05, 41.09it/s, est. speed input: 47705.15 toks/s, output: 46.59 toks/s]   
Processed prompts:  15%|█▍        | 38/256 [00:01<00:06, 31.75it/s, est. speed input: 38365.01 toks/s, output: 37.46 toks/s]
Processed prompts:  17%|█▋        | 43/256 [00:01<00:06, 31.01it/s, est. speed input: 37049.10 toks/s, output: 36.18 toks/s]
Processed prompts:  18%|█▊        | 47/256 [00:01<00:07, 28.87it/s, est. speed input: 35271.54 toks/s, output: 34.44 toks/s]
Processed prompts:  20%|█▉        | 51/256 [00:01<00:07, 27.27it/s, est. speed input: 33925.28 toks/s, output: 33.13 toks/s]
Processed prompts:  21%|██        | 54/256 [00:01<00:08, 24.47it/s, est. speed input: 32256.50 toks/s, output: 31.50 toks/s]
Processed prompts:  23%|██▎       | 58/256 [00:01<00:08, 24.01it/s, est. speed input: 31437.10 toks/s, output: 30.70 toks/s]
Processed prompts:  24%|██▍       | 62/256 [00:02<00:08, 23.69it/s, est. speed input: 30760.34 toks/s, output: 30.04 toks/s]
Processed prompts:  26%|██▌       | 66/256 [00:02<00:08, 23.46it/s, est. speed input: 30189.75 toks/s, output: 29.48 toks/s]
Processed prompts:  27%|██▋       | 70/256 [00:02<00:07, 23.26it/s, est. speed input: 29689.75 toks/s, output: 28.99 toks/s]
Processed prompts:  29%|██▉       | 74/256 [00:02<00:07, 23.11it/s, est. speed input: 29256.88 toks/s, output: 28.57 toks/s]
Processed prompts:  30%|███       | 78/256 [00:02<00:07, 22.98it/s, est. speed input: 28871.80 toks/s, output: 28.19 toks/s]
Processed prompts:  32%|███▏      | 82/256 [00:02<00:07, 22.93it/s, est. speed input: 28543.60 toks/s, output: 27.87 toks/s]
Processed prompts:  34%|███▎      | 86/256 [00:03<00:07, 22.92it/s, est. speed input: 28257.14 toks/s, output: 27.59 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:03<00:07, 22.90it/s, est. speed input: 27998.20 toks/s, output: 27.34 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:03<00:07, 22.89it/s, est. speed input: 27766.75 toks/s, output: 27.12 toks/s]
Processed prompts:  38%|███▊      | 98/256 [00:03<00:06, 22.88it/s, est. speed input: 27558.25 toks/s, output: 26.91 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:03<00:06, 22.89it/s, est. speed input: 27370.93 toks/s, output: 26.73 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:03<00:06, 22.91it/s, est. speed input: 27201.19 toks/s, output: 26.56 toks/s]
Processed prompts:  43%|████▎     | 110/256 [00:04<00:06, 22.90it/s, est. speed input: 27043.57 toks/s, output: 26.41 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:04<00:06, 22.90it/s, est. speed input: 26898.75 toks/s, output: 26.27 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:04<00:06, 22.87it/s, est. speed input: 26761.24 toks/s, output: 26.13 toks/s]
Processed prompts:  48%|████▊     | 122/256 [00:04<00:05, 22.84it/s, est. speed input: 26631.86 toks/s, output: 26.01 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:04<00:05, 23.36it/s, est. speed input: 26586.55 toks/s, output: 25.96 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:05<00:05, 23.76it/s, est. speed input: 26546.15 toks/s, output: 25.92 toks/s]
Processed prompts:  52%|█████▏    | 134/256 [00:05<00:05, 24.05it/s, est. speed input: 26509.38 toks/s, output: 25.89 toks/s]
Processed prompts:  54%|█████▍    | 138/256 [00:05<00:04, 24.27it/s, est. speed input: 26475.11 toks/s, output: 25.85 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:05<00:04, 24.44it/s, est. speed input: 26444.63 toks/s, output: 25.82 toks/s]
Processed prompts:  57%|█████▋    | 146/256 [00:05<00:04, 24.50it/s, est. speed input: 26410.45 toks/s, output: 25.79 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:05<00:04, 24.56it/s, est. speed input: 26379.35 toks/s, output: 25.76 toks/s]
Processed prompts:  60%|██████    | 154/256 [00:05<00:04, 24.61it/s, est. speed input: 26350.64 toks/s, output: 25.73 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:06<00:03, 24.65it/s, est. speed input: 26324.27 toks/s, output: 25.71 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:06<00:03, 24.68it/s, est. speed input: 26298.64 toks/s, output: 25.68 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:06<00:03, 24.67it/s, est. speed input: 26272.36 toks/s, output: 25.66 toks/s]
Processed prompts:  66%|██████▋   | 170/256 [00:06<00:03, 24.69it/s, est. speed input: 26249.74 toks/s, output: 25.63 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:06<00:03, 24.68it/s, est. speed input: 26225.65 toks/s, output: 25.61 toks/s]
Processed prompts:  70%|██████▉   | 178/256 [00:06<00:03, 24.35it/s, est. speed input: 26175.56 toks/s, output: 25.56 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:07<00:03, 23.90it/s, est. speed input: 26109.12 toks/s, output: 25.50 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:07<00:02, 23.60it/s, est. speed input: 26046.26 toks/s, output: 25.44 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:07<00:02, 23.37it/s, est. speed input: 25984.70 toks/s, output: 25.38 toks/s]
Processed prompts:  76%|███████▌  | 194/256 [00:07<00:02, 23.18it/s, est. speed input: 25922.50 toks/s, output: 25.31 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:07<00:02, 23.06it/s, est. speed input: 25865.07 toks/s, output: 25.26 toks/s]
Processed prompts:  79%|███████▉  | 202/256 [00:08<00:02, 23.55it/s, est. speed input: 25854.87 toks/s, output: 25.25 toks/s]
Processed prompts:  80%|████████  | 206/256 [00:08<00:02, 23.32it/s, est. speed input: 25800.97 toks/s, output: 25.20 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:08<00:01, 23.16it/s, est. speed input: 25749.19 toks/s, output: 25.15 toks/s]
Processed prompts:  84%|████████▎ | 214/256 [00:08<00:01, 23.05it/s, est. speed input: 25700.10 toks/s, output: 25.10 toks/s]
Processed prompts:  85%|████████▌ | 218/256 [00:08<00:01, 22.98it/s, est. speed input: 25652.67 toks/s, output: 25.05 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:08<00:01, 22.90it/s, est. speed input: 25605.44 toks/s, output: 25.01 toks/s]
Processed prompts:  88%|████████▊ | 226/256 [00:09<00:01, 22.85it/s, est. speed input: 25560.25 toks/s, output: 24.96 toks/s]
Processed prompts:  90%|████████▉ | 230/256 [00:09<00:01, 22.83it/s, est. speed input: 25517.98 toks/s, output: 24.92 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:09<00:00, 22.82it/s, est. speed input: 25477.32 toks/s, output: 24.88 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:09<00:00, 22.81it/s, est. speed input: 25438.28 toks/s, output: 24.84 toks/s]
Processed prompts:  95%|█████████▍| 242/256 [00:09<00:00, 22.77it/s, est. speed input: 25398.20 toks/s, output: 24.80 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:09<00:00, 22.80it/s, est. speed input: 25363.11 toks/s, output: 24.77 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:10<00:00, 22.81it/s, est. speed input: 25328.98 toks/s, output: 24.74 toks/s]
Processed prompts:  99%|█████████▉| 254/256 [00:10<00:00, 22.84it/s, est. speed input: 25297.01 toks/s, output: 24.70 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:10<00:00, 22.84it/s, est. speed input: 25339.52 toks/s, output: 24.75 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:10<00:00, 24.75it/s, est. speed input: 25339.52 toks/s, output: 24.75 toks/s]
[rank0]:[W125 23:52:41.632613067 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=4096 ==========
Time: 2026-01-25 23:52:44
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=512, max_num_seqs=4
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 512 --max-num-seqs 4 --max-model-len 1025 --max-num-batched-tokens 4096 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Qwen2.5-7B-INT8_M4096.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 23:52:54 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 23:52:55 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=563632) WARNING 01-25 23:53:04 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=563632) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=563632) WARNING 01-25 23:53:19 [backends.py:609] Failed to read file <frozen os>
Throughput: 24.02 requests/s, 24624.04 total tokens/s, 24.02 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512

STDERR:
[2026-01-25 23:52:54] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 23:52:54] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 23:52:54] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 23:52:54] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:52:54] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:52:54] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:52:54] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:52:54] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:52:54] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 23:52:54] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 23:52:54] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 23:52:54] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 23:52:54] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 23:52:54] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 23:53:02] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 23:53:02] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 23:53:02] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 23:53:02] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:53:02] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:53:02] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:53:02] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:53:02] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:53:02] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 23:53:02] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 23:53:02] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 23:53:02] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 23:53:02] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 23:53:02] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=563632) [2026-01-25 23:53:05] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=563632) [2026-01-25 23:53:05] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=563632) [2026-01-25 23:53:05] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=563632) [2026-01-25 23:53:05] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=563632) [2026-01-25 23:53:05] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=563632) [2026-01-25 23:53:05] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=563632) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=563632) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.01it/s]
(EngineCore_DP0 pid=563632) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.27s/it]
(EngineCore_DP0 pid=563632) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.23s/it]
(EngineCore_DP0 pid=563632) 
(EngineCore_DP0 pid=563632) [2026-01-25 23:53:08] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 4800] -> 1D uint8
(EngineCore_DP0 pid=563632) [2026-01-25 23:53:09] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 16662528 bytes
(EngineCore_DP0 pid=563632) [2026-01-25 23:53:09] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 4800] -> 1D uint8
(EngineCore_DP0 pid=563632) [2026-01-25 23:53:09] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12959744 bytes
(EngineCore_DP0 pid=563632) [2026-01-25 23:53:09] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 4800] -> 1D uint8
(EngineCore_DP0 pid=563632) [2026-01-25 23:53:09] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 137003008 bytes
(EngineCore_DP0 pid=563632) [2026-01-25 23:53:09] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 25280] -> 1D uint8
(EngineCore_DP0 pid=563632) [2026-01-25 23:53:09] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 68009984 bytes
(EngineCore_DP0 pid=563632) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  25%|██▌       | 1/4 [00:00<00:00,  7.43it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 2/4 [00:00<00:00,  8.04it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  75%|███████▌  | 3/4 [00:00<00:00,  8.30it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  7.56it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  7.72it/s]
(EngineCore_DP0 pid=563632) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  33%|███▎      | 1/3 [00:00<00:00,  6.90it/s]
Capturing CUDA graphs (decode, FULL):  67%|██████▋   | 2/3 [00:00<00:00,  7.75it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  8.29it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  8.03it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   4%|▍         | 21/512 [00:00<00:02, 199.98it/s]
Adding requests:   8%|▊         | 43/512 [00:00<00:02, 210.82it/s]
Adding requests:  13%|█▎        | 69/512 [00:00<00:01, 230.95it/s]
Adding requests:  18%|█▊        | 93/512 [00:00<00:01, 229.24it/s]
Adding requests:  23%|██▎       | 118/512 [00:00<00:01, 234.91it/s]
Adding requests:  28%|██▊       | 143/512 [00:00<00:01, 238.52it/s]
Adding requests:  33%|███▎      | 169/512 [00:00<00:01, 243.78it/s]
Adding requests:  38%|███▊      | 195/512 [00:00<00:01, 248.50it/s]
Adding requests:  43%|████▎     | 222/512 [00:00<00:01, 253.37it/s]
Adding requests:  48%|████▊     | 248/512 [00:01<00:01, 250.26it/s]
Adding requests:  54%|█████▎    | 274/512 [00:01<00:00, 247.83it/s]
Adding requests:  59%|█████▊    | 300/512 [00:01<00:00, 250.58it/s]
Adding requests:  64%|██████▎   | 326/512 [00:01<00:00, 246.06it/s]
Adding requests:  69%|██████▉   | 353/512 [00:01<00:00, 251.83it/s]
Adding requests:  74%|███████▍  | 379/512 [00:01<00:00, 252.93it/s]
Adding requests:  79%|███████▉  | 406/512 [00:01<00:00, 256.54it/s]
Adding requests:  84%|████████▍ | 432/512 [00:01<00:00, 252.40it/s]
Adding requests:  89%|████████▉ | 458/512 [00:01<00:00, 249.39it/s]
Adding requests:  95%|█████████▍| 485/512 [00:01<00:00, 253.89it/s]
Adding requests: 100%|██████████| 512/512 [00:02<00:00, 256.45it/s]
Adding requests: 100%|██████████| 512/512 [00:02<00:00, 247.16it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   9%|▉         | 46/512 [00:00<00:02, 224.51it/s, est. speed input: 229927.85 toks/s, output: 224.51 toks/s]
Processed prompts:  13%|█▎        | 69/512 [00:01<00:07, 55.61it/s, est. speed input: 67034.74 toks/s, output: 65.46 toks/s]   
Processed prompts:  16%|█▌        | 80/512 [00:01<00:10, 41.85it/s, est. speed input: 53008.12 toks/s, output: 51.77 toks/s]
Processed prompts:  17%|█▋        | 87/512 [00:01<00:11, 36.50it/s, est. speed input: 47923.01 toks/s, output: 46.80 toks/s]
Processed prompts:  18%|█▊        | 93/512 [00:02<00:11, 36.80it/s, est. speed input: 47251.32 toks/s, output: 46.14 toks/s]
Processed prompts:  19%|█▉        | 98/512 [00:02<00:13, 30.17it/s, est. speed input: 43100.64 toks/s, output: 42.09 toks/s]
Processed prompts:  20%|█▉        | 102/512 [00:02<00:13, 29.30it/s, est. speed input: 42027.70 toks/s, output: 41.04 toks/s]
Processed prompts:  21%|██        | 106/512 [00:02<00:14, 28.50it/s, est. speed input: 41081.93 toks/s, output: 40.12 toks/s]
Processed prompts:  21%|██▏       | 110/512 [00:02<00:14, 27.82it/s, est. speed input: 40246.26 toks/s, output: 39.30 toks/s]
Processed prompts:  22%|██▏       | 114/512 [00:02<00:14, 27.26it/s, est. speed input: 39500.19 toks/s, output: 38.57 toks/s]
Processed prompts:  23%|██▎       | 118/512 [00:03<00:15, 26.26it/s, est. speed input: 38671.74 toks/s, output: 37.76 toks/s]
Processed prompts:  24%|██▍       | 122/512 [00:03<00:15, 25.49it/s, est. speed input: 37921.44 toks/s, output: 37.03 toks/s]
Processed prompts:  25%|██▍       | 126/512 [00:03<00:15, 24.93it/s, est. speed input: 37244.45 toks/s, output: 36.37 toks/s]
Processed prompts:  25%|██▌       | 130/512 [00:03<00:15, 24.52it/s, est. speed input: 36629.72 toks/s, output: 35.77 toks/s]
Processed prompts:  26%|██▌       | 134/512 [00:03<00:15, 24.25it/s, est. speed input: 36074.76 toks/s, output: 35.23 toks/s]
Processed prompts:  27%|██▋       | 138/512 [00:03<00:15, 24.03it/s, est. speed input: 35560.52 toks/s, output: 34.73 toks/s]
Processed prompts:  28%|██▊       | 142/512 [00:04<00:15, 23.89it/s, est. speed input: 35091.24 toks/s, output: 34.27 toks/s]
Processed prompts:  29%|██▊       | 146/512 [00:04<00:15, 23.78it/s, est. speed input: 34658.02 toks/s, output: 33.85 toks/s]
Processed prompts:  29%|██▉       | 150/512 [00:04<00:15, 23.71it/s, est. speed input: 34258.21 toks/s, output: 33.46 toks/s]
Processed prompts:  30%|███       | 154/512 [00:04<00:15, 23.65it/s, est. speed input: 33886.53 toks/s, output: 33.09 toks/s]
Processed prompts:  31%|███       | 158/512 [00:04<00:14, 23.61it/s, est. speed input: 33540.95 toks/s, output: 32.75 toks/s]
Processed prompts:  32%|███▏      | 162/512 [00:04<00:14, 23.62it/s, est. speed input: 33224.52 toks/s, output: 32.45 toks/s]
Processed prompts:  32%|███▏      | 166/512 [00:05<00:14, 23.62it/s, est. speed input: 32927.50 toks/s, output: 32.16 toks/s]
Processed prompts:  33%|███▎      | 170/512 [00:05<00:14, 23.60it/s, est. speed input: 32647.76 toks/s, output: 31.88 toks/s]
Processed prompts:  34%|███▍      | 174/512 [00:05<00:14, 23.59it/s, est. speed input: 32384.76 toks/s, output: 31.63 toks/s]
Processed prompts:  35%|███▍      | 178/512 [00:05<00:14, 23.58it/s, est. speed input: 32137.61 toks/s, output: 31.38 toks/s]
Processed prompts:  36%|███▌      | 182/512 [00:05<00:14, 23.56it/s, est. speed input: 31903.25 toks/s, output: 31.16 toks/s]
Processed prompts:  36%|███▋      | 186/512 [00:06<00:13, 23.55it/s, est. speed input: 31682.11 toks/s, output: 30.94 toks/s]
Processed prompts:  37%|███▋      | 190/512 [00:06<00:13, 23.55it/s, est. speed input: 31473.59 toks/s, output: 30.74 toks/s]
Processed prompts:  38%|███▊      | 194/512 [00:06<00:13, 23.55it/s, est. speed input: 31277.49 toks/s, output: 30.54 toks/s]
Processed prompts:  39%|███▊      | 198/512 [00:06<00:13, 23.55it/s, est. speed input: 31090.50 toks/s, output: 30.36 toks/s]
Processed prompts:  39%|███▉      | 202/512 [00:06<00:12, 24.92it/s, est. speed input: 31058.11 toks/s, output: 30.33 toks/s]
Processed prompts:  40%|████      | 206/512 [00:06<00:12, 24.50it/s, est. speed input: 30886.23 toks/s, output: 30.16 toks/s]
Processed prompts:  41%|████      | 210/512 [00:06<00:12, 24.20it/s, est. speed input: 30721.27 toks/s, output: 30.00 toks/s]
Processed prompts:  42%|████▏     | 214/512 [00:07<00:12, 23.97it/s, est. speed input: 30561.85 toks/s, output: 29.85 toks/s]
Processed prompts:  43%|████▎     | 218/512 [00:07<00:12, 23.84it/s, est. speed input: 30412.31 toks/s, output: 29.70 toks/s]
Processed prompts:  43%|████▎     | 222/512 [00:07<00:12, 23.73it/s, est. speed input: 30268.23 toks/s, output: 29.56 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:07<00:12, 23.67it/s, est. speed input: 30130.93 toks/s, output: 29.42 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:07<00:11, 23.62it/s, est. speed input: 30000.06 toks/s, output: 29.30 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:08<00:11, 23.58it/s, est. speed input: 29873.95 toks/s, output: 29.17 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:08<00:11, 23.57it/s, est. speed input: 29753.80 toks/s, output: 29.06 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:08<00:11, 23.77it/s, est. speed input: 29656.83 toks/s, output: 28.96 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:08<00:10, 24.27it/s, est. speed input: 29592.39 toks/s, output: 28.90 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:08<00:10, 24.62it/s, est. speed input: 29528.43 toks/s, output: 28.84 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:08<00:10, 24.87it/s, est. speed input: 29467.16 toks/s, output: 28.78 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:08<00:10, 25.05it/s, est. speed input: 29408.39 toks/s, output: 28.72 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:09<00:09, 25.18it/s, est. speed input: 29351.34 toks/s, output: 28.66 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:09<00:09, 25.25it/s, est. speed input: 29295.17 toks/s, output: 28.61 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:09<00:09, 25.33it/s, est. speed input: 29242.77 toks/s, output: 28.56 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:09<00:09, 25.37it/s, est. speed input: 29190.88 toks/s, output: 28.51 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:09<00:09, 25.41it/s, est. speed input: 29141.47 toks/s, output: 28.46 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:09<00:09, 25.41it/s, est. speed input: 29091.97 toks/s, output: 28.41 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:10<00:08, 25.40it/s, est. speed input: 29043.51 toks/s, output: 28.36 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:10<00:08, 25.40it/s, est. speed input: 28996.96 toks/s, output: 28.32 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:10<00:08, 25.40it/s, est. speed input: 28951.64 toks/s, output: 28.27 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:10<00:08, 25.42it/s, est. speed input: 28908.73 toks/s, output: 28.23 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:10<00:08, 25.41it/s, est. speed input: 28866.21 toks/s, output: 28.19 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:10<00:08, 25.43it/s, est. speed input: 28825.79 toks/s, output: 28.15 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:11<00:07, 25.39it/s, est. speed input: 28784.16 toks/s, output: 28.11 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:11<00:07, 24.80it/s, est. speed input: 28712.82 toks/s, output: 28.04 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:11<00:07, 24.43it/s, est. speed input: 28644.95 toks/s, output: 27.97 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:11<00:07, 24.17it/s, est. speed input: 28578.92 toks/s, output: 27.91 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:11<00:07, 23.97it/s, est. speed input: 28513.84 toks/s, output: 27.85 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:11<00:07, 23.81it/s, est. speed input: 28449.04 toks/s, output: 27.78 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:12<00:07, 23.71it/s, est. speed input: 28386.61 toks/s, output: 27.72 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:12<00:07, 23.62it/s, est. speed input: 28324.99 toks/s, output: 27.66 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:12<00:07, 23.58it/s, est. speed input: 28266.40 toks/s, output: 27.60 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:12<00:07, 23.55it/s, est. speed input: 28208.74 toks/s, output: 27.55 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:12<00:06, 23.48it/s, est. speed input: 28150.82 toks/s, output: 27.49 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:12<00:06, 23.48it/s, est. speed input: 28096.42 toks/s, output: 27.44 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:13<00:06, 23.48it/s, est. speed input: 28043.58 toks/s, output: 27.39 toks/s]
Processed prompts:  71%|███████   | 362/512 [00:13<00:06, 23.46it/s, est. speed input: 27991.12 toks/s, output: 27.34 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:13<00:06, 23.46it/s, est. speed input: 27940.59 toks/s, output: 27.29 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [00:13<00:06, 23.47it/s, est. speed input: 27891.90 toks/s, output: 27.24 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [00:13<00:05, 23.46it/s, est. speed input: 27843.89 toks/s, output: 27.19 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [00:13<00:05, 23.47it/s, est. speed input: 27797.35 toks/s, output: 27.15 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [00:14<00:05, 23.47it/s, est. speed input: 27751.89 toks/s, output: 27.10 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [00:14<00:05, 23.44it/s, est. speed input: 27706.13 toks/s, output: 27.06 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [00:14<00:05, 23.47it/s, est. speed input: 27663.76 toks/s, output: 27.02 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [00:14<00:05, 23.48it/s, est. speed input: 27621.84 toks/s, output: 26.97 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [00:14<00:04, 23.47it/s, est. speed input: 27580.29 toks/s, output: 26.93 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [00:14<00:04, 23.48it/s, est. speed input: 27540.02 toks/s, output: 26.89 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [00:15<00:04, 23.49it/s, est. speed input: 27501.00 toks/s, output: 26.86 toks/s]
Processed prompts:  80%|████████  | 410/512 [00:15<00:04, 23.47it/s, est. speed input: 27461.80 toks/s, output: 26.82 toks/s]
Processed prompts:  81%|████████  | 414/512 [00:15<00:04, 23.45it/s, est. speed input: 27423.31 toks/s, output: 26.78 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [00:15<00:04, 23.44it/s, est. speed input: 27385.62 toks/s, output: 26.74 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [00:15<00:03, 23.44it/s, est. speed input: 27349.24 toks/s, output: 26.71 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [00:15<00:03, 23.59it/s, est. speed input: 27319.48 toks/s, output: 26.68 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [00:16<00:03, 24.10it/s, est. speed input: 27306.64 toks/s, output: 26.67 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [00:16<00:03, 24.47it/s, est. speed input: 27293.85 toks/s, output: 26.65 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [00:16<00:02, 24.75it/s, est. speed input: 27281.71 toks/s, output: 26.64 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [00:16<00:02, 24.94it/s, est. speed input: 27269.57 toks/s, output: 26.63 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [00:16<00:02, 25.06it/s, est. speed input: 27257.23 toks/s, output: 26.62 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [00:16<00:02, 25.15it/s, est. speed input: 27245.32 toks/s, output: 26.61 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [00:17<00:02, 25.23it/s, est. speed input: 27233.88 toks/s, output: 26.60 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [00:17<00:02, 25.27it/s, est. speed input: 27222.31 toks/s, output: 26.58 toks/s]
Processed prompts:  90%|█████████ | 462/512 [00:17<00:01, 25.31it/s, est. speed input: 27211.46 toks/s, output: 26.57 toks/s]
Processed prompts:  91%|█████████ | 466/512 [00:17<00:01, 25.35it/s, est. speed input: 27200.98 toks/s, output: 26.56 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [00:17<00:01, 25.37it/s, est. speed input: 27190.65 toks/s, output: 26.55 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [00:17<00:01, 25.39it/s, est. speed input: 27180.69 toks/s, output: 26.54 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [00:18<00:01, 25.40it/s, est. speed input: 27170.61 toks/s, output: 26.53 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [00:18<00:01, 25.42it/s, est. speed input: 27161.12 toks/s, output: 26.52 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [00:18<00:01, 25.41it/s, est. speed input: 27151.08 toks/s, output: 26.51 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [00:18<00:00, 25.39it/s, est. speed input: 27140.79 toks/s, output: 26.50 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [00:18<00:00, 25.40it/s, est. speed input: 27131.42 toks/s, output: 26.50 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:17<00:00, 25.40it/s, est. speed input: 29857.06 toks/s, output: 29.16 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:17<00:00, 29.16it/s, est. speed input: 29857.06 toks/s, output: 29.16 toks/s]
[rank0]:[W125 23:53:56.201798387 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=8192 ==========
Time: 2026-01-25 23:53:59
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=1024, max_num_seqs=8
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 1024 --max-num-seqs 8 --max-model-len 1025 --max-num-batched-tokens 8192 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Qwen2.5-7B-INT8_M8192.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 23:54:16 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 23:54:17 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=564989) WARNING 01-25 23:54:26 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=564989) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=564989) WARNING 01-25 23:54:40 [backends.py:609] Failed to read file <frozen os>
Throughput: 24.09 requests/s, 24695.67 total tokens/s, 24.09 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024

STDERR:
[2026-01-25 23:54:16] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 23:54:16] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 23:54:16] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 23:54:16] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:54:16] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:54:16] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:54:16] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:54:16] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:54:16] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 23:54:16] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 23:54:16] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 23:54:16] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 23:54:16] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 23:54:16] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 23:54:24] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 23:54:24] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 23:54:24] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 23:54:24] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:54:24] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:54:24] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:54:24] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:54:24] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:54:24] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 23:54:24] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 23:54:24] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 23:54:24] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 23:54:24] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 23:54:24] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=564989) [2026-01-25 23:54:27] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=564989) [2026-01-25 23:54:27] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=564989) [2026-01-25 23:54:27] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=564989) [2026-01-25 23:54:27] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=564989) [2026-01-25 23:54:27] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=564989) [2026-01-25 23:54:27] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=564989) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=564989) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.06it/s]
(EngineCore_DP0 pid=564989) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.25s/it]
(EngineCore_DP0 pid=564989) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.20s/it]
(EngineCore_DP0 pid=564989) 
(EngineCore_DP0 pid=564989) [2026-01-25 23:54:30] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 4800] -> 1D uint8
(EngineCore_DP0 pid=564989) [2026-01-25 23:54:30] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 16662528 bytes
(EngineCore_DP0 pid=564989) [2026-01-25 23:54:30] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 4800] -> 1D uint8
(EngineCore_DP0 pid=564989) [2026-01-25 23:54:30] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12959744 bytes
(EngineCore_DP0 pid=564989) [2026-01-25 23:54:30] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 4800] -> 1D uint8
(EngineCore_DP0 pid=564989) [2026-01-25 23:54:30] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 137003008 bytes
(EngineCore_DP0 pid=564989) [2026-01-25 23:54:30] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 25280] -> 1D uint8
(EngineCore_DP0 pid=564989) [2026-01-25 23:54:30] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 68009984 bytes
(EngineCore_DP0 pid=564989) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:02,  1.94it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  40%|████      | 2/5 [00:00<00:00,  3.55it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  60%|██████    | 3/5 [00:00<00:00,  4.89it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  80%|████████  | 4/5 [00:00<00:00,  5.92it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00,  6.36it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00,  5.02it/s]
(EngineCore_DP0 pid=564989) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:00,  6.48it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 2/4 [00:00<00:00,  7.61it/s]
Capturing CUDA graphs (decode, FULL):  75%|███████▌  | 3/4 [00:00<00:00,  6.84it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  6.54it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  6.70it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 21/1024 [00:00<00:04, 203.65it/s]
Adding requests:  42%|████▏     | 433/1024 [00:00<00:00, 2454.62it/s]
Adding requests:  66%|██████▋   | 680/1024 [00:01<00:00, 514.52it/s] 
Adding requests:  81%|████████  | 827/1024 [00:01<00:00, 412.05it/s]
Adding requests:  91%|█████████ | 927/1024 [00:02<00:00, 371.98it/s]
Adding requests:  98%|█████████▊| 1001/1024 [00:02<00:00, 349.39it/s]
Adding requests: 100%|██████████| 1024/1024 [00:02<00:00, 424.83it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   9%|▉         | 90/1024 [00:00<00:01, 475.23it/s, est. speed input: 486714.32 toks/s, output: 475.25 toks/s]
Processed prompts:  13%|█▎        | 138/1024 [00:02<00:16, 52.73it/s, est. speed input: 65361.03 toks/s, output: 63.83 toks/s]  
Processed prompts:  16%|█▌        | 159/1024 [00:02<00:18, 45.96it/s, est. speed input: 57414.05 toks/s, output: 56.07 toks/s]
Processed prompts:  17%|█▋        | 172/1024 [00:03<00:22, 37.71it/s, est. speed input: 50183.80 toks/s, output: 49.01 toks/s]
Processed prompts:  18%|█▊        | 181/1024 [00:03<00:23, 35.71it/s, est. speed input: 48181.23 toks/s, output: 47.05 toks/s]
Processed prompts:  18%|█▊        | 188/1024 [00:04<00:25, 32.64it/s, est. speed input: 46010.94 toks/s, output: 44.93 toks/s]
Processed prompts:  19%|█▉        | 194/1024 [00:04<00:28, 29.26it/s, est. speed input: 43935.53 toks/s, output: 42.91 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [00:04<00:28, 28.58it/s, est. speed input: 42857.46 toks/s, output: 41.85 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:05<00:29, 27.29it/s, est. speed input: 41644.45 toks/s, output: 40.67 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [00:05<00:30, 26.32it/s, est. speed input: 40580.15 toks/s, output: 39.63 toks/s]
Processed prompts:  22%|██▏       | 226/1024 [00:05<00:31, 25.58it/s, est. speed input: 39637.54 toks/s, output: 38.71 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:06<00:31, 25.04it/s, est. speed input: 38798.37 toks/s, output: 37.89 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:06<00:31, 24.93it/s, est. speed input: 38120.83 toks/s, output: 37.23 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:06<00:30, 25.14it/s, est. speed input: 37579.74 toks/s, output: 36.70 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:07<00:30, 25.28it/s, est. speed input: 37084.21 toks/s, output: 36.21 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:07<00:29, 25.40it/s, est. speed input: 36632.46 toks/s, output: 35.77 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:07<00:29, 25.48it/s, est. speed input: 36216.53 toks/s, output: 35.37 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:08<00:29, 25.54it/s, est. speed input: 35832.60 toks/s, output: 34.99 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:08<00:28, 25.57it/s, est. speed input: 35476.04 toks/s, output: 34.64 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:08<00:28, 25.59it/s, est. speed input: 35145.30 toks/s, output: 34.32 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:09<00:28, 25.24it/s, est. speed input: 34777.23 toks/s, output: 33.96 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:09<00:28, 24.75it/s, est. speed input: 34396.83 toks/s, output: 33.59 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:09<00:28, 24.42it/s, est. speed input: 34042.91 toks/s, output: 33.24 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:10<00:28, 24.18it/s, est. speed input: 33711.32 toks/s, output: 32.92 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:10<00:28, 24.02it/s, est. speed input: 33401.63 toks/s, output: 32.62 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:10<00:28, 23.91it/s, est. speed input: 33111.81 toks/s, output: 32.34 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:11<00:28, 23.84it/s, est. speed input: 32839.50 toks/s, output: 32.07 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:11<00:27, 23.78it/s, est. speed input: 32583.15 toks/s, output: 31.82 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:11<00:27, 23.74it/s, est. speed input: 32341.44 toks/s, output: 31.58 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:12<00:27, 23.71it/s, est. speed input: 32113.62 toks/s, output: 31.36 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:12<00:26, 23.69it/s, est. speed input: 31897.73 toks/s, output: 31.15 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [00:12<00:26, 23.67it/s, est. speed input: 31692.73 toks/s, output: 30.95 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:13<00:26, 23.66it/s, est. speed input: 31498.72 toks/s, output: 30.76 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:13<00:25, 23.65it/s, est. speed input: 31313.66 toks/s, output: 30.58 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:13<00:25, 23.64it/s, est. speed input: 31138.01 toks/s, output: 30.41 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:14<00:25, 23.63it/s, est. speed input: 30970.29 toks/s, output: 30.24 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:14<00:24, 23.98it/s, est. speed input: 30846.85 toks/s, output: 30.12 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:14<00:23, 24.43it/s, est. speed input: 30747.59 toks/s, output: 30.03 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:15<00:23, 24.76it/s, est. speed input: 30652.42 toks/s, output: 29.93 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:15<00:22, 25.00it/s, est. speed input: 30561.32 toks/s, output: 29.84 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:15<00:22, 25.17it/s, est. speed input: 30473.78 toks/s, output: 29.76 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:15<00:21, 25.28it/s, est. speed input: 30389.40 toks/s, output: 29.68 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:16<00:21, 25.36it/s, est. speed input: 30308.27 toks/s, output: 29.60 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:16<00:21, 25.42it/s, est. speed input: 30230.32 toks/s, output: 29.52 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:16<00:20, 25.36it/s, est. speed input: 30147.71 toks/s, output: 29.44 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:17<00:20, 24.80it/s, est. speed input: 30029.86 toks/s, output: 29.33 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:17<00:20, 24.41it/s, est. speed input: 29915.80 toks/s, output: 29.21 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:17<00:20, 24.15it/s, est. speed input: 29805.90 toks/s, output: 29.11 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:18<00:20, 23.96it/s, est. speed input: 29699.55 toks/s, output: 29.00 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:18<00:20, 23.84it/s, est. speed input: 29597.90 toks/s, output: 28.90 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:18<00:20, 23.76it/s, est. speed input: 29500.15 toks/s, output: 28.81 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:19<00:19, 23.69it/s, est. speed input: 29404.64 toks/s, output: 28.72 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:19<00:19, 23.64it/s, est. speed input: 29312.51 toks/s, output: 28.63 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:19<00:19, 23.60it/s, est. speed input: 29223.62 toks/s, output: 28.54 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:20<00:18, 23.58it/s, est. speed input: 29137.43 toks/s, output: 28.45 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:20<00:18, 23.56it/s, est. speed input: 29054.31 toks/s, output: 28.37 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:20<00:18, 23.55it/s, est. speed input: 28973.82 toks/s, output: 28.29 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:21<00:17, 23.54it/s, est. speed input: 28895.76 toks/s, output: 28.22 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:21<00:17, 23.54it/s, est. speed input: 28820.60 toks/s, output: 28.15 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:22<00:17, 23.54it/s, est. speed input: 28747.76 toks/s, output: 28.07 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:22<00:16, 24.00it/s, est. speed input: 28704.98 toks/s, output: 28.03 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:22<00:15, 24.42it/s, est. speed input: 28668.62 toks/s, output: 28.00 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:22<00:15, 24.73it/s, est. speed input: 28633.51 toks/s, output: 27.96 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:23<00:14, 24.95it/s, est. speed input: 28599.10 toks/s, output: 27.93 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:23<00:14, 25.10it/s, est. speed input: 28565.34 toks/s, output: 27.90 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:23<00:14, 25.21it/s, est. speed input: 28532.65 toks/s, output: 27.86 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:24<00:13, 25.29it/s, est. speed input: 28501.06 toks/s, output: 27.83 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:24<00:13, 25.35it/s, est. speed input: 28470.44 toks/s, output: 27.80 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:24<00:13, 25.38it/s, est. speed input: 28440.09 toks/s, output: 27.77 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:25<00:13, 24.87it/s, est. speed input: 28384.91 toks/s, output: 27.72 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:25<00:13, 24.44it/s, est. speed input: 28327.39 toks/s, output: 27.66 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:25<00:12, 24.15it/s, est. speed input: 28271.11 toks/s, output: 27.61 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:26<00:12, 23.96it/s, est. speed input: 28216.64 toks/s, output: 27.56 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:26<00:12, 23.82it/s, est. speed input: 28163.45 toks/s, output: 27.50 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:26<00:12, 23.73it/s, est. speed input: 28111.76 toks/s, output: 27.45 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:27<00:11, 23.66it/s, est. speed input: 28061.45 toks/s, output: 27.40 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:27<00:11, 23.62it/s, est. speed input: 28012.33 toks/s, output: 27.36 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:27<00:11, 23.59it/s, est. speed input: 27964.43 toks/s, output: 27.31 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:28<00:10, 23.58it/s, est. speed input: 27918.23 toks/s, output: 27.26 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:28<00:10, 23.57it/s, est. speed input: 27872.95 toks/s, output: 27.22 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:28<00:03, 59.85it/s, est. speed input: 29263.13 toks/s, output: 28.58 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:29<00:03, 48.82it/s, est. speed input: 29202.91 toks/s, output: 28.52 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [00:29<00:04, 41.16it/s, est. speed input: 29144.06 toks/s, output: 28.46 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [00:29<00:04, 35.85it/s, est. speed input: 29086.91 toks/s, output: 28.41 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:30<00:05, 32.39it/s, est. speed input: 29039.11 toks/s, output: 28.36 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [00:30<00:05, 30.41it/s, est. speed input: 29008.94 toks/s, output: 28.33 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [00:30<00:05, 28.99it/s, est. speed input: 28979.38 toks/s, output: 28.30 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [00:31<00:05, 27.96it/s, est. speed input: 28950.22 toks/s, output: 28.27 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [00:31<00:04, 27.23it/s, est. speed input: 28921.74 toks/s, output: 28.24 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [00:31<00:04, 26.71it/s, est. speed input: 28893.93 toks/s, output: 28.22 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [00:32<00:04, 26.35it/s, est. speed input: 28866.56 toks/s, output: 28.19 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [00:32<00:04, 26.09it/s, est. speed input: 28839.94 toks/s, output: 28.16 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [00:32<00:03, 25.91it/s, est. speed input: 28813.75 toks/s, output: 28.14 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [00:33<00:03, 25.47it/s, est. speed input: 28776.55 toks/s, output: 28.10 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [00:33<00:03, 24.86it/s, est. speed input: 28728.86 toks/s, output: 28.06 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [00:33<00:03, 24.45it/s, est. speed input: 28682.39 toks/s, output: 28.01 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [00:34<00:02, 24.17it/s, est. speed input: 28636.57 toks/s, output: 27.97 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [00:34<00:02, 23.97it/s, est. speed input: 28591.58 toks/s, output: 27.92 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [00:34<00:02, 23.83it/s, est. speed input: 28547.50 toks/s, output: 27.88 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [00:35<00:01, 23.74it/s, est. speed input: 28504.29 toks/s, output: 27.84 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [00:35<00:01, 23.68it/s, est. speed input: 28462.15 toks/s, output: 27.80 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [00:35<00:01, 23.64it/s, est. speed input: 28420.74 toks/s, output: 27.75 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [00:36<00:00, 23.60it/s, est. speed input: 28379.96 toks/s, output: 27.71 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [00:36<00:00, 23.58it/s, est. speed input: 28340.12 toks/s, output: 27.68 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [00:36<00:00, 24.45it/s, est. speed input: 28332.37 toks/s, output: 27.67 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:36<00:00, 24.45it/s, est. speed input: 28499.12 toks/s, output: 27.83 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:36<00:00, 27.83it/s, est. speed input: 28499.12 toks/s, output: 27.83 toks/s]
[rank0]:[W125 23:55:38.054947131 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=16384 ==========
Time: 2026-01-25 23:55:42
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=2048, max_num_seqs=16
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 2048 --max-num-seqs 16 --max-model-len 1025 --max-num-batched-tokens 16384 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Qwen2.5-7B-INT8_M16384.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 23:56:04 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 23:56:05 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=566785) WARNING 01-25 23:56:13 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=566785) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=566785) WARNING 01-25 23:56:29 [backends.py:609] Failed to read file <frozen os>
Throughput: 24.10 requests/s, 24697.62 total tokens/s, 24.10 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048

STDERR:
[2026-01-25 23:56:04] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 23:56:04] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 23:56:04] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 23:56:04] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:56:04] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:56:04] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:56:04] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:56:04] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:56:04] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 23:56:04] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 23:56:04] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 23:56:04] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 23:56:04] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 23:56:04] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 23:56:13] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 23:56:13] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 23:56:13] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 23:56:13] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:56:13] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:56:13] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:56:13] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:56:13] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:56:13] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 23:56:13] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 23:56:13] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 23:56:13] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 23:56:13] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 23:56:13] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=566785) [2026-01-25 23:56:14] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=566785) [2026-01-25 23:56:14] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=566785) [2026-01-25 23:56:14] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=566785) [2026-01-25 23:56:14] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=566785) [2026-01-25 23:56:14] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=566785) [2026-01-25 23:56:14] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=566785) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=566785) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:01<00:01,  1.02s/it]
(EngineCore_DP0 pid=566785) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.35s/it]
(EngineCore_DP0 pid=566785) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.30s/it]
(EngineCore_DP0 pid=566785) 
(EngineCore_DP0 pid=566785) [2026-01-25 23:56:19] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 4800] -> 1D uint8
(EngineCore_DP0 pid=566785) [2026-01-25 23:56:19] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 16662528 bytes
(EngineCore_DP0 pid=566785) [2026-01-25 23:56:19] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 4800] -> 1D uint8
(EngineCore_DP0 pid=566785) [2026-01-25 23:56:19] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12959744 bytes
(EngineCore_DP0 pid=566785) [2026-01-25 23:56:19] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 4800] -> 1D uint8
(EngineCore_DP0 pid=566785) [2026-01-25 23:56:19] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 137003008 bytes
(EngineCore_DP0 pid=566785) [2026-01-25 23:56:19] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 25280] -> 1D uint8
(EngineCore_DP0 pid=566785) [2026-01-25 23:56:19] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 68009984 bytes
(EngineCore_DP0 pid=566785) [rank0]:W0125 23:56:35.710000 566785 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=566785) [rank0]:W0125 23:56:35.827000 566785 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=566785) [rank0]:W0125 23:56:37.468000 566785 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=566785) [rank0]:W0125 23:56:37.638000 566785 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=566785) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  14%|█▍        | 1/7 [00:00<00:00,  7.42it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  29%|██▊       | 2/7 [00:00<00:00,  7.78it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  43%|████▎     | 3/7 [00:00<00:00,  8.01it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  57%|█████▋    | 4/7 [00:00<00:00,  8.19it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  71%|███████▏  | 5/7 [00:00<00:00,  8.24it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  86%|████████▌ | 6/7 [00:00<00:00,  8.26it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00,  7.09it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00,  7.61it/s]
(EngineCore_DP0 pid=566785) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  20%|██        | 1/5 [00:00<00:01,  3.63it/s]
Capturing CUDA graphs (decode, FULL):  40%|████      | 2/5 [00:00<00:00,  3.06it/s]
Capturing CUDA graphs (decode, FULL):  60%|██████    | 3/5 [00:00<00:00,  3.60it/s]
Capturing CUDA graphs (decode, FULL):  80%|████████  | 4/5 [00:01<00:00,  4.26it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:01<00:00,  3.48it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:01<00:00,  3.55it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   1%|          | 21/2048 [00:00<00:09, 207.35it/s]
Adding requests:   2%|▏         | 46/2048 [00:00<00:08, 230.76it/s]
Adding requests:   3%|▎         | 71/2048 [00:00<00:08, 236.67it/s]
Adding requests:   5%|▍         | 95/2048 [00:00<00:08, 236.26it/s]
Adding requests:   6%|▌         | 119/2048 [00:00<00:08, 235.60it/s]
Adding requests:   7%|▋         | 144/2048 [00:00<00:08, 237.43it/s]
Adding requests:   8%|▊         | 170/2048 [00:00<00:07, 241.59it/s]
Adding requests:  10%|▉         | 197/2048 [00:00<00:07, 247.74it/s]
Adding requests:  11%|█         | 222/2048 [00:00<00:07, 247.33it/s]
Adding requests:  12%|█▏        | 247/2048 [00:01<00:07, 244.88it/s]
Adding requests:  13%|█▎        | 272/2048 [00:01<00:07, 242.16it/s]
Adding requests:  15%|█▍        | 298/2048 [00:01<00:07, 245.19it/s]
Adding requests:  16%|█▌        | 324/2048 [00:01<00:06, 246.78it/s]
Adding requests:  17%|█▋        | 350/2048 [00:01<00:06, 249.64it/s]
Adding requests:  18%|█▊        | 376/2048 [00:01<00:06, 250.84it/s]
Adding requests:  20%|█▉        | 402/2048 [00:01<00:06, 249.98it/s]
Adding requests:  21%|██        | 428/2048 [00:01<00:06, 252.64it/s]
Adding requests:  22%|██▏       | 454/2048 [00:01<00:06, 250.30it/s]
Adding requests:  23%|██▎       | 481/2048 [00:01<00:06, 254.77it/s]
Adding requests:  25%|██▍       | 509/2048 [00:02<00:05, 261.24it/s]
Adding requests:  26%|██▋       | 538/2048 [00:02<00:05, 266.37it/s]
Adding requests:  28%|██▊       | 566/2048 [00:02<00:05, 266.96it/s]
Adding requests:  29%|██▉       | 593/2048 [00:02<00:05, 258.46it/s]
Adding requests:  30%|███       | 619/2048 [00:02<00:05, 256.15it/s]
Adding requests:  31%|███▏      | 645/2048 [00:02<00:05, 251.47it/s]
Adding requests:  33%|███▎      | 671/2048 [00:02<00:05, 248.89it/s]
Adding requests:  34%|███▍      | 698/2048 [00:02<00:05, 252.89it/s]
Adding requests:  35%|███▌      | 724/2048 [00:02<00:05, 250.16it/s]
Adding requests:  37%|███▋      | 750/2048 [00:03<00:05, 244.63it/s]
Adding requests:  38%|███▊      | 775/2048 [00:03<00:05, 244.58it/s]
Adding requests:  39%|███▉      | 801/2048 [00:03<00:05, 246.65it/s]
Adding requests:  40%|████      | 827/2048 [00:03<00:04, 249.22it/s]
Adding requests:  42%|████▏     | 853/2048 [00:03<00:04, 249.82it/s]
Adding requests:  43%|████▎     | 878/2048 [00:03<00:04, 249.09it/s]
Adding requests:  44%|████▍     | 905/2048 [00:03<00:04, 252.37it/s]
Adding requests:  45%|████▌     | 931/2048 [00:03<00:04, 241.79it/s]
Adding requests:  47%|████▋     | 956/2048 [00:03<00:04, 236.25it/s]
Adding requests:  48%|████▊     | 980/2048 [00:03<00:04, 236.47it/s]
Adding requests:  49%|████▉     | 1004/2048 [00:04<00:04, 233.78it/s]
Adding requests:  50%|█████     | 1029/2048 [00:04<00:04, 237.90it/s]
Adding requests:  51%|█████▏    | 1053/2048 [00:04<00:04, 234.76it/s]
Adding requests:  53%|█████▎    | 1078/2048 [00:04<00:04, 236.96it/s]
Adding requests:  54%|█████▍    | 1102/2048 [00:04<00:03, 236.61it/s]
Adding requests:  55%|█████▌    | 1129/2048 [00:04<00:03, 246.24it/s]
Adding requests:  56%|█████▋    | 1154/2048 [00:04<00:03, 245.69it/s]
Adding requests:  58%|█████▊    | 1182/2048 [00:04<00:03, 253.09it/s]
Adding requests:  59%|█████▉    | 1210/2048 [00:04<00:03, 259.91it/s]
Adding requests:  60%|██████    | 1237/2048 [00:04<00:03, 259.28it/s]
Adding requests:  62%|██████▏   | 1263/2048 [00:05<00:03, 258.88it/s]
Adding requests:  63%|██████▎   | 1289/2048 [00:05<00:02, 258.38it/s]
Adding requests:  64%|██████▍   | 1318/2048 [00:05<00:02, 265.15it/s]
Adding requests:  66%|██████▌   | 1346/2048 [00:05<00:02, 268.64it/s]
Adding requests:  67%|██████▋   | 1374/2048 [00:05<00:02, 271.46it/s]
Adding requests:  68%|██████▊   | 1402/2048 [00:05<00:02, 267.91it/s]
Adding requests:  70%|██████▉   | 1429/2048 [00:05<00:02, 267.17it/s]
Adding requests:  71%|███████   | 1457/2048 [00:05<00:02, 268.93it/s]
Adding requests:  73%|███████▎  | 1486/2048 [00:05<00:02, 274.39it/s]
Adding requests:  74%|███████▍  | 1515/2048 [00:06<00:01, 277.00it/s]
Adding requests:  75%|███████▌  | 1543/2048 [00:06<00:01, 270.62it/s]
Adding requests:  77%|███████▋  | 1571/2048 [00:06<00:01, 260.47it/s]
Adding requests:  78%|███████▊  | 1598/2048 [00:06<00:01, 260.12it/s]
Adding requests:  79%|███████▉  | 1625/2048 [00:06<00:01, 257.06it/s]
Adding requests:  81%|████████  | 1651/2048 [00:06<00:01, 256.42it/s]
Adding requests:  82%|████████▏ | 1677/2048 [00:06<00:01, 252.11it/s]
Adding requests:  83%|████████▎ | 1704/2048 [00:06<00:01, 256.51it/s]
Adding requests:  85%|████████▍ | 1731/2048 [00:06<00:01, 259.05it/s]
Adding requests:  86%|████████▌ | 1758/2048 [00:06<00:01, 261.85it/s]
Adding requests:  87%|████████▋ | 1786/2048 [00:07<00:00, 265.63it/s]
Adding requests:  89%|████████▊ | 1813/2048 [00:07<00:00, 263.70it/s]
Adding requests:  90%|████████▉ | 1840/2048 [00:07<00:00, 264.19it/s]
Adding requests:  91%|█████████ | 1867/2048 [00:07<00:00, 256.67it/s]
Adding requests:  92%|█████████▏| 1893/2048 [00:07<00:00, 255.51it/s]
Adding requests:  94%|█████████▎| 1919/2048 [00:07<00:00, 254.41it/s]
Adding requests:  95%|█████████▍| 1945/2048 [00:07<00:00, 251.37it/s]
Adding requests:  96%|█████████▌| 1971/2048 [00:07<00:00, 247.57it/s]
Adding requests:  97%|█████████▋| 1996/2048 [00:07<00:00, 243.03it/s]
Adding requests:  99%|█████████▊| 2021/2048 [00:08<00:00, 236.42it/s]
Adding requests: 100%|█████████▉| 2046/2048 [00:08<00:00, 238.18it/s]
Adding requests: 100%|██████████| 2048/2048 [00:08<00:00, 251.59it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   9%|▊         | 178/2048 [00:00<00:05, 327.01it/s, est. speed input: 334872.93 toks/s, output: 327.01 toks/s]
Processed prompts:  10%|█         | 211/2048 [00:01<00:20, 91.05it/s, est. speed input: 114067.14 toks/s, output: 111.39 toks/s] 
Processed prompts:  11%|█         | 226/2048 [00:02<00:27, 66.42it/s, est. speed input: 90072.02 toks/s, output: 87.96 toks/s]  
Processed prompts:  12%|█▏        | 242/2048 [00:03<00:34, 51.97it/s, est. speed input: 76376.72 toks/s, output: 74.59 toks/s]
Processed prompts:  13%|█▎        | 258/2048 [00:03<00:41, 42.75it/s, est. speed input: 67395.33 toks/s, output: 65.82 toks/s]
Processed prompts:  13%|█▎        | 274/2048 [00:04<00:47, 37.38it/s, est. speed input: 61578.74 toks/s, output: 60.14 toks/s]
Processed prompts:  14%|█▍        | 290/2048 [00:05<00:51, 33.87it/s, est. speed input: 57325.68 toks/s, output: 55.98 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [00:05<00:55, 31.40it/s, est. speed input: 53982.13 toks/s, output: 52.72 toks/s]
Processed prompts:  16%|█▌        | 322/2048 [00:06<00:58, 29.67it/s, est. speed input: 51289.37 toks/s, output: 50.09 toks/s]
Processed prompts:  18%|█▊        | 370/2048 [00:06<00:30, 55.23it/s, est. speed input: 57204.96 toks/s, output: 55.86 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [00:07<00:37, 44.74it/s, est. speed input: 54503.46 toks/s, output: 53.23 toks/s]
Processed prompts:  20%|█▉        | 402/2048 [00:07<00:43, 37.62it/s, est. speed input: 52015.34 toks/s, output: 50.80 toks/s]
Processed prompts:  20%|██        | 418/2048 [00:08<00:49, 33.05it/s, est. speed input: 49867.76 toks/s, output: 48.70 toks/s]
Processed prompts:  21%|██        | 434/2048 [00:09<00:53, 30.20it/s, est. speed input: 48066.89 toks/s, output: 46.94 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [00:09<00:56, 28.30it/s, est. speed input: 46507.15 toks/s, output: 45.42 toks/s]
Processed prompts:  23%|██▎       | 466/2048 [00:10<00:58, 27.01it/s, est. speed input: 45141.09 toks/s, output: 44.08 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [00:11<00:59, 26.13it/s, est. speed input: 43935.79 toks/s, output: 42.91 toks/s]
Processed prompts:  24%|██▍       | 498/2048 [00:11<01:00, 25.52it/s, est. speed input: 42865.27 toks/s, output: 41.86 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [00:12<01:01, 25.10it/s, est. speed input: 41907.44 toks/s, output: 40.93 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [00:13<01:00, 24.93it/s, est. speed input: 41076.84 toks/s, output: 40.11 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [00:13<00:59, 25.11it/s, est. speed input: 40401.50 toks/s, output: 39.45 toks/s]
Processed prompts:  27%|██▋       | 562/2048 [00:14<00:58, 25.23it/s, est. speed input: 39783.12 toks/s, output: 38.85 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [00:15<00:58, 25.32it/s, est. speed input: 39216.94 toks/s, output: 38.30 toks/s]
Processed prompts:  29%|██▉       | 594/2048 [00:15<00:58, 24.88it/s, est. speed input: 38592.02 toks/s, output: 37.69 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [00:16<00:58, 24.46it/s, est. speed input: 37991.80 toks/s, output: 37.10 toks/s]
Processed prompts:  31%|███       | 626/2048 [00:17<00:58, 24.17it/s, est. speed input: 37439.75 toks/s, output: 36.56 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [00:17<00:58, 23.98it/s, est. speed input: 36930.03 toks/s, output: 36.06 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [00:18<00:58, 23.84it/s, est. speed input: 36457.45 toks/s, output: 35.60 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [00:19<00:57, 23.75it/s, est. speed input: 36020.05 toks/s, output: 35.18 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [00:19<00:57, 23.69it/s, est. speed input: 35612.35 toks/s, output: 34.78 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [00:20<00:56, 23.65it/s, est. speed input: 35231.42 toks/s, output: 34.41 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [00:21<00:56, 23.61it/s, est. speed input: 34874.62 toks/s, output: 34.06 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [00:21<00:54, 23.91it/s, est. speed input: 34587.59 toks/s, output: 33.78 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [00:22<00:53, 24.36it/s, est. speed input: 34350.68 toks/s, output: 33.55 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [00:23<00:51, 24.70it/s, est. speed input: 34128.41 toks/s, output: 33.33 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [00:23<00:50, 24.89it/s, est. speed input: 33910.42 toks/s, output: 33.12 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [00:24<00:50, 24.47it/s, est. speed input: 33637.72 toks/s, output: 32.85 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [00:25<00:50, 24.18it/s, est. speed input: 33379.60 toks/s, output: 32.60 toks/s]
Processed prompts:  41%|████      | 834/2048 [00:25<00:50, 23.99it/s, est. speed input: 33135.68 toks/s, output: 32.36 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [00:26<00:50, 23.86it/s, est. speed input: 32903.92 toks/s, output: 32.13 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [00:27<00:49, 23.77it/s, est. speed input: 32683.92 toks/s, output: 31.92 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [00:27<00:49, 23.70it/s, est. speed input: 32474.54 toks/s, output: 31.71 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [00:28<00:48, 23.65it/s, est. speed input: 32274.50 toks/s, output: 31.52 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [00:29<00:47, 23.99it/s, est. speed input: 32123.10 toks/s, output: 31.37 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [00:29<00:45, 24.43it/s, est. speed input: 31996.52 toks/s, output: 31.25 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [00:30<00:44, 24.74it/s, est. speed input: 31875.38 toks/s, output: 31.13 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [00:31<00:43, 24.97it/s, est. speed input: 31758.95 toks/s, output: 31.01 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [00:31<00:43, 24.79it/s, est. speed input: 31618.03 toks/s, output: 30.88 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [00:32<00:43, 24.40it/s, est. speed input: 31460.17 toks/s, output: 30.72 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [00:33<00:43, 24.13it/s, est. speed input: 31308.83 toks/s, output: 30.58 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [00:33<00:42, 23.95it/s, est. speed input: 31163.47 toks/s, output: 30.43 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [00:34<00:42, 23.83it/s, est. speed input: 31024.22 toks/s, output: 30.30 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [00:35<00:41, 23.74it/s, est. speed input: 30890.19 toks/s, output: 30.17 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [00:35<00:41, 23.68it/s, est. speed input: 30760.86 toks/s, output: 30.04 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [00:36<00:40, 23.72it/s, est. speed input: 30643.60 toks/s, output: 29.93 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [00:37<00:38, 24.23it/s, est. speed input: 30566.66 toks/s, output: 29.85 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [00:37<00:37, 24.60it/s, est. speed input: 30492.52 toks/s, output: 29.78 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [00:37<00:18, 47.70it/s, est. speed input: 31569.97 toks/s, output: 30.83 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [00:38<00:21, 40.29it/s, est. speed input: 31481.31 toks/s, output: 30.74 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [00:39<00:23, 35.52it/s, est. speed input: 31395.62 toks/s, output: 30.66 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [00:39<00:26, 31.68it/s, est. speed input: 31278.83 toks/s, output: 30.55 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [00:40<00:28, 29.04it/s, est. speed input: 31158.39 toks/s, output: 30.43 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [00:41<00:29, 27.30it/s, est. speed input: 31042.27 toks/s, output: 30.31 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [00:41<00:29, 26.13it/s, est. speed input: 30929.71 toks/s, output: 30.20 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [00:42<00:30, 25.33it/s, est. speed input: 30820.66 toks/s, output: 30.10 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [00:43<00:30, 24.79it/s, est. speed input: 30715.19 toks/s, output: 30.00 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [00:43<00:30, 24.41it/s, est. speed input: 30612.88 toks/s, output: 29.90 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [00:44<00:29, 24.14it/s, est. speed input: 30513.56 toks/s, output: 29.80 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [00:45<00:28, 24.48it/s, est. speed input: 30449.80 toks/s, output: 29.74 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [00:45<00:27, 24.77it/s, est. speed input: 30390.25 toks/s, output: 29.68 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [00:46<00:26, 24.98it/s, est. speed input: 30332.33 toks/s, output: 29.62 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [00:47<00:26, 25.13it/s, est. speed input: 30276.12 toks/s, output: 29.57 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [00:47<00:25, 24.86it/s, est. speed input: 30200.94 toks/s, output: 29.49 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [00:48<00:25, 24.45it/s, est. speed input: 30115.26 toks/s, output: 29.41 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [00:49<00:25, 24.17it/s, est. speed input: 30032.13 toks/s, output: 29.33 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [00:49<00:24, 23.97it/s, est. speed input: 29951.14 toks/s, output: 29.25 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [00:50<00:24, 23.84it/s, est. speed input: 29872.51 toks/s, output: 29.17 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [00:51<00:23, 23.75it/s, est. speed input: 29795.85 toks/s, output: 29.10 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [00:51<00:22, 23.69it/s, est. speed input: 29721.29 toks/s, output: 29.02 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [00:52<00:22, 23.64it/s, est. speed input: 29648.37 toks/s, output: 28.95 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [00:53<00:21, 23.93it/s, est. speed input: 29594.69 toks/s, output: 28.90 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [00:53<00:20, 24.38it/s, est. speed input: 29554.02 toks/s, output: 28.86 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [00:54<00:19, 24.71it/s, est. speed input: 29514.51 toks/s, output: 28.82 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [00:55<00:18, 24.94it/s, est. speed input: 29475.88 toks/s, output: 28.79 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [00:55<00:17, 24.80it/s, est. speed input: 29424.30 toks/s, output: 28.73 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [00:56<00:17, 24.82it/s, est. speed input: 29379.02 toks/s, output: 28.69 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [00:57<00:16, 24.42it/s, est. speed input: 29316.15 toks/s, output: 28.63 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [00:57<00:16, 24.15it/s, est. speed input: 29254.92 toks/s, output: 28.57 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [00:58<00:15, 23.97it/s, est. speed input: 29195.12 toks/s, output: 28.51 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [00:59<00:15, 23.84it/s, est. speed input: 29136.61 toks/s, output: 28.45 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [00:59<00:14, 23.75it/s, est. speed input: 29079.49 toks/s, output: 28.40 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [01:00<00:14, 23.68it/s, est. speed input: 29023.51 toks/s, output: 28.34 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [01:01<00:13, 24.04it/s, est. speed input: 28986.65 toks/s, output: 28.31 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [01:01<00:12, 24.46it/s, est. speed input: 28957.56 toks/s, output: 28.28 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [01:02<00:11, 24.77it/s, est. speed input: 28929.14 toks/s, output: 28.25 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [01:02<00:10, 24.99it/s, est. speed input: 28901.12 toks/s, output: 28.22 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [01:03<00:10, 24.96it/s, est. speed input: 28866.63 toks/s, output: 28.19 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [01:04<00:09, 24.52it/s, est. speed input: 28816.65 toks/s, output: 28.14 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [01:04<00:09, 24.22it/s, est. speed input: 28767.41 toks/s, output: 28.09 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [01:05<00:08, 24.02it/s, est. speed input: 28719.42 toks/s, output: 28.05 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [01:06<00:07, 23.87it/s, est. speed input: 28672.19 toks/s, output: 28.00 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [01:07<00:07, 23.78it/s, est. speed input: 28626.16 toks/s, output: 27.96 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [01:07<00:06, 23.71it/s, est. speed input: 28580.99 toks/s, output: 27.91 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [01:08<00:06, 23.66it/s, est. speed input: 28536.63 toks/s, output: 27.87 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [01:08<00:02, 43.08it/s, est. speed input: 29083.81 toks/s, output: 28.40 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [01:09<00:02, 37.61it/s, est. speed input: 29057.15 toks/s, output: 28.38 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [01:10<00:01, 33.88it/s, est. speed input: 29030.72 toks/s, output: 28.35 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [01:10<00:01, 31.33it/s, est. speed input: 29005.10 toks/s, output: 28.33 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [01:11<00:01, 29.57it/s, est. speed input: 28979.93 toks/s, output: 28.30 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [01:11<00:00, 28.41it/s, est. speed input: 28957.12 toks/s, output: 28.28 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [01:11<00:00, 28.41it/s, est. speed input: 29156.28 toks/s, output: 28.47 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [01:11<00:00, 28.47it/s, est. speed input: 29156.28 toks/s, output: 28.47 toks/s]
[rank0]:[W125 23:58:08.621179372 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=32768 ==========
Time: 2026-01-25 23:58:11
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=4096, max_num_seqs=32
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 4096 --max-num-seqs 32 --max-model-len 1025 --max-num-batched-tokens 32768 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Qwen2.5-7B-INT8_M32768.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 23:58:50 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-25 23:58:51 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=569305) WARNING 01-25 23:58:59 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=569305) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=569305) WARNING 01-25 23:59:13 [backends.py:609] Failed to read file <frozen os>
Throughput: 6.31 requests/s, 6463.27 total tokens/s, 6.31 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096

STDERR:
[2026-01-25 23:58:50] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 23:58:50] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 23:58:50] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 23:58:50] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:58:50] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:58:50] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:58:50] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:58:50] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:58:50] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 23:58:50] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 23:58:50] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 23:58:50] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 23:58:50] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 23:58:50] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 23:58:58] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 23:58:58] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 23:58:58] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 23:58:58] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:58:58] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:58:58] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:58:58] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:58:58] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 23:58:58] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 23:58:58] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 23:58:58] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 23:58:58] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 23:58:58] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 23:58:58] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=569305) [2026-01-25 23:59:00] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=569305) [2026-01-25 23:59:00] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=569305) [2026-01-25 23:59:00] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=569305) [2026-01-25 23:59:00] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=569305) [2026-01-25 23:59:00] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=569305) [2026-01-25 23:59:00] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=569305) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=569305) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.10it/s]
(EngineCore_DP0 pid=569305) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.20s/it]
(EngineCore_DP0 pid=569305) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.16s/it]
(EngineCore_DP0 pid=569305) 
(EngineCore_DP0 pid=569305) [2026-01-25 23:59:04] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 4800] -> 1D uint8
(EngineCore_DP0 pid=569305) [2026-01-25 23:59:04] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 16662528 bytes
(EngineCore_DP0 pid=569305) [2026-01-25 23:59:04] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 4800] -> 1D uint8
(EngineCore_DP0 pid=569305) [2026-01-25 23:59:04] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12959744 bytes
(EngineCore_DP0 pid=569305) [2026-01-25 23:59:05] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 4800] -> 1D uint8
(EngineCore_DP0 pid=569305) [2026-01-25 23:59:05] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 137003008 bytes
(EngineCore_DP0 pid=569305) [2026-01-25 23:59:05] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 25280] -> 1D uint8
(EngineCore_DP0 pid=569305) [2026-01-25 23:59:05] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 68009984 bytes
(EngineCore_DP0 pid=569305) [rank0]:W0125 23:59:21.536000 569305 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=569305) [rank0]:W0125 23:59:21.655000 569305 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=569305) [rank0]:W0125 23:59:23.732000 569305 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=569305) [rank0]:W0125 23:59:23.930000 569305 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=569305) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   9%|▉         | 1/11 [00:00<00:06,  1.44it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  18%|█▊        | 2/11 [00:01<00:04,  2.06it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  27%|██▋       | 3/11 [00:01<00:04,  1.90it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  36%|███▋      | 4/11 [00:01<00:02,  2.59it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  45%|████▌     | 5/11 [00:01<00:01,  3.42it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  55%|█████▍    | 6/11 [00:02<00:01,  4.26it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  64%|██████▎   | 7/11 [00:02<00:00,  5.03it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  73%|███████▎  | 8/11 [00:02<00:00,  5.75it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  82%|████████▏ | 9/11 [00:02<00:00,  6.31it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  91%|█████████ | 10/11 [00:02<00:00,  6.76it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:02<00:00,  6.61it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:02<00:00,  4.10it/s]
(EngineCore_DP0 pid=569305) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  14%|█▍        | 1/7 [00:00<00:00,  6.48it/s]
Capturing CUDA graphs (decode, FULL):  29%|██▊       | 2/7 [00:00<00:00,  7.37it/s]
Capturing CUDA graphs (decode, FULL):  43%|████▎     | 3/7 [00:00<00:00,  6.75it/s]
Capturing CUDA graphs (decode, FULL):  57%|█████▋    | 4/7 [00:00<00:00,  6.58it/s]
Capturing CUDA graphs (decode, FULL):  71%|███████▏  | 5/7 [00:00<00:00,  6.55it/s]
Capturing CUDA graphs (decode, FULL):  86%|████████▌ | 6/7 [00:01<00:00,  4.00it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:01<00:00,  4.87it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:01<00:00,  5.37it/s]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   1%|          | 21/4096 [00:00<00:19, 208.58it/s]
Adding requests:   1%|          | 47/4096 [00:00<00:16, 238.41it/s]
Adding requests:   2%|▏         | 74/4096 [00:00<00:16, 250.43it/s]
Adding requests:   2%|▏         | 100/4096 [00:00<00:15, 251.23it/s]
Adding requests:   3%|▎         | 126/4096 [00:00<00:15, 252.65it/s]
Adding requests:   4%|▎         | 152/4096 [00:00<00:15, 250.98it/s]
Adding requests:   4%|▍         | 179/4096 [00:00<00:15, 255.40it/s]
Adding requests:   5%|▌         | 206/4096 [00:00<00:15, 259.02it/s]
Adding requests:   6%|▌         | 232/4096 [00:00<00:15, 256.56it/s]
Adding requests:   6%|▋         | 258/4096 [00:01<00:15, 249.26it/s]
Adding requests:  16%|█▌        | 663/4096 [00:01<00:02, 1358.65it/s]
Adding requests:  20%|█▉        | 801/4096 [00:01<00:06, 540.67it/s] 
Adding requests:  22%|██▏       | 904/4096 [00:02<00:07, 407.94it/s]
Adding requests:  24%|██▍       | 983/4096 [00:02<00:08, 346.70it/s]
Adding requests:  26%|██▌       | 1045/4096 [00:02<00:09, 310.58it/s]
Adding requests:  27%|██▋       | 1095/4096 [00:03<00:10, 292.81it/s]
Adding requests:  28%|██▊       | 1137/4096 [00:03<00:10, 270.50it/s]
Adding requests:  29%|██▊       | 1173/4096 [00:03<00:11, 264.07it/s]
Adding requests:  29%|██▉       | 1205/4096 [00:03<00:11, 252.21it/s]
Adding requests:  30%|███       | 1234/4096 [00:03<00:11, 250.58it/s]
Adding requests:  31%|███       | 1262/4096 [00:03<00:11, 248.80it/s]
Adding requests:  31%|███▏      | 1289/4096 [00:03<00:12, 233.74it/s]
Adding requests:  32%|███▏      | 1314/4096 [00:04<00:11, 233.76it/s]
Adding requests:  33%|███▎      | 1339/4096 [00:04<00:11, 236.00it/s]
Adding requests:  33%|███▎      | 1364/4096 [00:04<00:11, 231.69it/s]
Adding requests:  34%|███▍      | 1388/4096 [00:04<00:11, 226.65it/s]
Adding requests:  34%|███▍      | 1412/4096 [00:04<00:11, 228.89it/s]
Adding requests:  35%|███▌      | 1438/4096 [00:04<00:11, 236.30it/s]
Adding requests:  36%|███▌      | 1462/4096 [00:04<00:11, 224.45it/s]
Adding requests:  36%|███▋      | 1488/4096 [00:04<00:11, 233.17it/s]
Adding requests:  37%|███▋      | 1514/4096 [00:04<00:10, 240.47it/s]
Adding requests:  38%|███▊      | 1539/4096 [00:05<00:11, 229.02it/s]
Adding requests:  38%|███▊      | 1563/4096 [00:05<00:11, 221.22it/s]
Adding requests:  39%|███▊      | 1587/4096 [00:05<00:11, 224.46it/s]
Adding requests:  39%|███▉      | 1611/4096 [00:05<00:11, 225.19it/s]
Adding requests:  40%|███▉      | 1634/4096 [00:05<00:11, 208.23it/s]
Adding requests:  40%|████      | 1657/4096 [00:05<00:11, 212.75it/s]
Adding requests:  41%|████      | 1683/4096 [00:05<00:10, 224.95it/s]
Adding requests:  42%|████▏     | 1706/4096 [00:05<00:10, 221.45it/s]
Adding requests:  42%|████▏     | 1732/4096 [00:05<00:10, 230.37it/s]
Adding requests:  43%|████▎     | 1760/4096 [00:06<00:09, 241.81it/s]
Adding requests:  44%|████▎     | 1785/4096 [00:06<00:09, 240.95it/s]
Adding requests:  44%|████▍     | 1810/4096 [00:06<00:09, 230.92it/s]
Adding requests:  45%|████▍     | 1836/4096 [00:06<00:09, 236.68it/s]
Adding requests:  45%|████▌     | 1860/4096 [00:06<00:09, 237.02it/s]
Adding requests:  46%|████▌     | 1884/4096 [00:06<00:09, 234.44it/s]
Adding requests:  47%|████▋     | 1911/4096 [00:06<00:08, 243.29it/s]
Adding requests:  47%|████▋     | 1938/4096 [00:06<00:08, 249.06it/s]
Adding requests:  48%|████▊     | 1963/4096 [00:06<00:08, 239.56it/s]
Adding requests:  49%|████▊     | 1990/4096 [00:06<00:08, 247.55it/s]
Adding requests:  49%|████▉     | 2016/4096 [00:07<00:08, 247.34it/s]
Adding requests:  50%|████▉     | 2041/4096 [00:07<00:08, 229.62it/s]
Adding requests:  50%|█████     | 2066/4096 [00:07<00:08, 235.07it/s]
Adding requests:  51%|█████     | 2093/4096 [00:07<00:08, 243.93it/s]
Adding requests:  52%|█████▏    | 2118/4096 [00:07<00:08, 240.83it/s]
Adding requests:  52%|█████▏    | 2143/4096 [00:07<00:08, 243.12it/s]
Adding requests:  53%|█████▎    | 2169/4096 [00:07<00:07, 247.31it/s]
Adding requests:  54%|█████▎    | 2194/4096 [00:07<00:07, 245.99it/s]
Adding requests:  54%|█████▍    | 2219/4096 [00:07<00:07, 241.41it/s]
Adding requests:  55%|█████▍    | 2244/4096 [00:08<00:07, 243.23it/s]
Adding requests:  55%|█████▌    | 2271/4096 [00:08<00:07, 250.78it/s]
Adding requests:  56%|█████▌    | 2297/4096 [00:08<00:07, 239.06it/s]
Adding requests:  57%|█████▋    | 2324/4096 [00:08<00:07, 247.01it/s]
Adding requests:  57%|█████▋    | 2349/4096 [00:08<00:07, 244.54it/s]
Adding requests:  58%|█████▊    | 2374/4096 [00:08<00:07, 233.69it/s]
Adding requests:  59%|█████▊    | 2402/4096 [00:08<00:06, 246.51it/s]
Adding requests:  59%|█████▉    | 2430/4096 [00:08<00:06, 253.83it/s]
Adding requests:  60%|█████▉    | 2456/4096 [00:08<00:06, 235.18it/s]
Adding requests:  61%|██████    | 2480/4096 [00:09<00:06, 233.00it/s]
Adding requests:  61%|██████    | 2505/4096 [00:09<00:06, 236.12it/s]
Adding requests:  62%|██████▏   | 2529/4096 [00:09<00:06, 233.06it/s]
Adding requests:  62%|██████▏   | 2553/4096 [00:09<00:06, 231.07it/s]
Adding requests:  63%|██████▎   | 2580/4096 [00:09<00:06, 240.92it/s]
Adding requests:  64%|██████▎   | 2606/4096 [00:09<00:06, 244.50it/s]
Adding requests:  64%|██████▍   | 2631/4096 [00:09<00:06, 224.21it/s]
Adding requests:  65%|██████▍   | 2655/4096 [00:09<00:06, 226.73it/s]
Adding requests:  65%|██████▌   | 2680/4096 [00:09<00:06, 231.93it/s]
Adding requests:  66%|██████▌   | 2704/4096 [00:09<00:06, 222.31it/s]
Adding requests:  67%|██████▋   | 2727/4096 [00:10<00:06, 218.53it/s]
Adding requests:  67%|██████▋   | 2752/4096 [00:10<00:05, 227.04it/s]
Adding requests:  68%|██████▊   | 2777/4096 [00:10<00:05, 231.03it/s]
Adding requests:  68%|██████▊   | 2801/4096 [00:10<00:05, 228.84it/s]
Adding requests:  69%|██████▉   | 2825/4096 [00:10<00:05, 230.72it/s]
Adding requests:  70%|██████▉   | 2852/4096 [00:10<00:05, 239.23it/s]
Adding requests:  70%|███████   | 2876/4096 [00:10<00:05, 238.81it/s]
Adding requests:  71%|███████   | 2900/4096 [00:10<00:05, 231.46it/s]
Adding requests:  71%|███████▏  | 2925/4096 [00:10<00:04, 236.62it/s]
Adding requests:  72%|███████▏  | 2953/4096 [00:11<00:04, 248.15it/s]
Adding requests:  73%|███████▎  | 2978/4096 [00:11<00:04, 236.02it/s]
Adding requests:  73%|███████▎  | 3002/4096 [00:11<00:04, 235.47it/s]
Adding requests:  74%|███████▍  | 3028/4096 [00:11<00:04, 239.89it/s]
Adding requests:  75%|███████▍  | 3053/4096 [00:11<00:04, 237.04it/s]
Adding requests:  75%|███████▌  | 3077/4096 [00:11<00:04, 228.09it/s]
Adding requests:  76%|███████▌  | 3103/4096 [00:11<00:04, 235.73it/s]
Adding requests:  76%|███████▋  | 3130/4096 [00:11<00:03, 244.99it/s]
Adding requests:  77%|███████▋  | 3155/4096 [00:11<00:04, 227.33it/s]
Adding requests:  78%|███████▊  | 3179/4096 [00:12<00:04, 229.24it/s]
Adding requests:  78%|███████▊  | 3205/4096 [00:12<00:03, 236.33it/s]
Adding requests:  79%|███████▉  | 3229/4096 [00:12<00:03, 234.51it/s]
Adding requests:  79%|███████▉  | 3253/4096 [00:12<00:03, 230.34it/s]
Adding requests:  80%|████████  | 3277/4096 [00:12<00:03, 227.17it/s]
Adding requests:  81%|████████  | 3300/4096 [00:12<00:03, 222.71it/s]
Adding requests:  81%|████████  | 3323/4096 [00:12<00:03, 210.80it/s]
Adding requests:  82%|████████▏ | 3348/4096 [00:12<00:03, 219.09it/s]
Adding requests:  82%|████████▏ | 3374/4096 [00:12<00:03, 229.87it/s]
Adding requests:  83%|████████▎ | 3398/4096 [00:12<00:03, 220.30it/s]
Adding requests:  84%|████████▎ | 3421/4096 [00:13<00:03, 220.09it/s]
Adding requests:  84%|████████▍ | 3447/4096 [00:13<00:02, 231.00it/s]
Adding requests:  85%|████████▍ | 3471/4096 [00:13<00:02, 232.53it/s]
Adding requests:  85%|████████▌ | 3495/4096 [00:13<00:02, 216.26it/s]
Adding requests:  86%|████████▌ | 3523/4096 [00:13<00:02, 232.65it/s]
Adding requests:  87%|████████▋ | 3552/4096 [00:13<00:02, 247.99it/s]
Adding requests:  87%|████████▋ | 3578/4096 [00:13<00:02, 233.90it/s]
Adding requests:  88%|████████▊ | 3604/4096 [00:13<00:02, 238.98it/s]
Adding requests:  89%|████████▊ | 3632/4096 [00:13<00:01, 248.94it/s]
Adding requests:  89%|████████▉ | 3658/4096 [00:14<00:01, 240.75it/s]
Adding requests:  90%|████████▉ | 3683/4096 [00:14<00:01, 232.90it/s]
Adding requests:  91%|█████████ | 3710/4096 [00:14<00:01, 241.09it/s]
Adding requests:  91%|█████████ | 3735/4096 [00:14<00:01, 228.21it/s]
Adding requests:  92%|█████████▏| 3759/4096 [00:14<00:01, 215.62it/s]
Adding requests:  92%|█████████▏| 3782/4096 [00:14<00:01, 218.30it/s]
Adding requests:  93%|█████████▎| 3805/4096 [00:14<00:01, 217.51it/s]
Adding requests:  93%|█████████▎| 3827/4096 [00:14<00:01, 209.90it/s]
Adding requests:  94%|█████████▍| 3850/4096 [00:14<00:01, 213.89it/s]
Adding requests:  95%|█████████▍| 3877/4096 [00:15<00:00, 228.63it/s]
Adding requests:  95%|█████████▌| 3901/4096 [00:15<00:00, 225.53it/s]
Adding requests:  96%|█████████▌| 3924/4096 [00:15<00:00, 226.18it/s]
Adding requests:  96%|█████████▋| 3951/4096 [00:15<00:00, 237.27it/s]
Adding requests:  97%|█████████▋| 3976/4096 [00:15<00:00, 239.08it/s]
Adding requests:  98%|█████████▊| 4000/4096 [00:15<00:00, 228.76it/s]
Adding requests:  98%|█████████▊| 4027/4096 [00:15<00:00, 237.96it/s]
Adding requests:  99%|█████████▉| 4053/4096 [00:15<00:00, 243.80it/s]
Adding requests: 100%|█████████▉| 4078/4096 [00:15<00:00, 231.42it/s]
Adding requests: 100%|██████████| 4096/4096 [00:15<00:00, 256.06it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 98/4096 [00:04<03:02, 21.85it/s, est. speed input: 22379.40 toks/s, output: 21.85 toks/s]
Processed prompts:   3%|▎         | 130/4096 [00:09<05:19, 12.41it/s, est. speed input: 14086.80 toks/s, output: 13.76 toks/s]
Processed prompts:   4%|▍         | 162/4096 [00:14<06:54,  9.48it/s, est. speed input: 11377.10 toks/s, output: 11.11 toks/s]
Processed prompts:   5%|▍         | 194/4096 [00:17<06:43,  9.68it/s, est. speed input: 11203.27 toks/s, output: 10.94 toks/s]
Processed prompts:   6%|▌         | 226/4096 [00:22<07:48,  8.26it/s, est. speed input: 10108.21 toks/s, output: 9.87 toks/s] 
Processed prompts:   6%|▋         | 258/4096 [00:27<08:26,  7.57it/s, est. speed input: 9461.19 toks/s, output: 9.24 toks/s] 
Processed prompts:   7%|▋         | 290/4096 [00:32<08:51,  7.17it/s, est. speed input: 9014.70 toks/s, output: 8.80 toks/s]
Processed prompts:   8%|▊         | 322/4096 [00:38<09:12,  6.83it/s, est. speed input: 8647.31 toks/s, output: 8.44 toks/s]
Processed prompts:   9%|▊         | 354/4096 [00:43<09:18,  6.70it/s, est. speed input: 8406.97 toks/s, output: 8.21 toks/s]
Processed prompts:   9%|▉         | 386/4096 [00:46<08:26,  7.32it/s, est. speed input: 8492.62 toks/s, output: 8.29 toks/s]
Processed prompts:  10%|█         | 418/4096 [00:51<08:43,  7.03it/s, est. speed input: 8307.29 toks/s, output: 8.11 toks/s]
Processed prompts:  11%|█         | 450/4096 [00:56<08:56,  6.79it/s, est. speed input: 8140.81 toks/s, output: 7.95 toks/s]
Processed prompts:  12%|█▏        | 482/4096 [01:01<09:07,  6.61it/s, est. speed input: 7992.28 toks/s, output: 7.80 toks/s]
Processed prompts:  13%|█▎        | 514/4096 [01:06<09:07,  6.55it/s, est. speed input: 7885.23 toks/s, output: 7.70 toks/s]
Processed prompts:  13%|█▎        | 546/4096 [01:11<09:10,  6.45it/s, est. speed input: 7779.47 toks/s, output: 7.60 toks/s]
Processed prompts:  14%|█▍        | 578/4096 [01:16<09:08,  6.41it/s, est. speed input: 7692.12 toks/s, output: 7.51 toks/s]
Processed prompts:  15%|█▍        | 610/4096 [01:20<08:15,  7.04it/s, est. speed input: 7763.81 toks/s, output: 7.58 toks/s]
Processed prompts:  16%|█▌        | 642/4096 [01:25<08:29,  6.78it/s, est. speed input: 7682.21 toks/s, output: 7.50 toks/s]
Processed prompts:  16%|█▋        | 674/4096 [01:30<08:34,  6.65it/s, est. speed input: 7617.75 toks/s, output: 7.44 toks/s]
Processed prompts:  17%|█▋        | 706/4096 [01:35<08:40,  6.51it/s, est. speed input: 7549.64 toks/s, output: 7.37 toks/s]
Processed prompts:  18%|█▊        | 738/4096 [01:40<08:40,  6.45it/s, est. speed input: 7495.98 toks/s, output: 7.32 toks/s]
Processed prompts:  19%|█▉        | 770/4096 [01:45<08:29,  6.53it/s, est. speed input: 7468.25 toks/s, output: 7.29 toks/s]
Processed prompts:  20%|█▉        | 802/4096 [01:49<07:41,  7.14it/s, est. speed input: 7528.25 toks/s, output: 7.35 toks/s]
Processed prompts:  20%|██        | 834/4096 [01:54<07:52,  6.91it/s, est. speed input: 7486.87 toks/s, output: 7.31 toks/s]
Processed prompts:  21%|██        | 866/4096 [01:59<08:05,  6.66it/s, est. speed input: 7434.27 toks/s, output: 7.26 toks/s]
Processed prompts:  22%|██▏       | 898/4096 [02:04<08:07,  6.56it/s, est. speed input: 7396.28 toks/s, output: 7.22 toks/s]
Processed prompts:  23%|██▎       | 930/4096 [02:09<08:07,  6.50it/s, est. speed input: 7361.63 toks/s, output: 7.19 toks/s]
Processed prompts:  23%|██▎       | 962/4096 [02:14<08:09,  6.40it/s, est. speed input: 7321.95 toks/s, output: 7.15 toks/s]
Processed prompts:  24%|██▍       | 994/4096 [02:17<07:14,  7.14it/s, est. speed input: 7386.04 toks/s, output: 7.21 toks/s]
Processed prompts:  25%|██▌       | 1026/4096 [02:23<07:30,  6.81it/s, est. speed input: 7346.16 toks/s, output: 7.17 toks/s]
Processed prompts:  26%|██▌       | 1058/4096 [02:27<07:34,  6.69it/s, est. speed input: 7320.52 toks/s, output: 7.15 toks/s]
Processed prompts:  27%|██▋       | 1090/4096 [02:33<07:38,  6.55it/s, est. speed input: 7289.74 toks/s, output: 7.12 toks/s]
Processed prompts:  27%|██▋       | 1122/4096 [02:38<07:41,  6.45it/s, est. speed input: 7259.70 toks/s, output: 7.09 toks/s]
Processed prompts:  28%|██▊       | 1154/4096 [02:43<07:36,  6.44it/s, est. speed input: 7238.89 toks/s, output: 7.07 toks/s]
Processed prompts:  29%|██▉       | 1186/4096 [02:48<07:33,  6.41it/s, est. speed input: 7216.68 toks/s, output: 7.05 toks/s]
Processed prompts:  30%|██▉       | 1218/4096 [02:51<06:47,  7.07it/s, est. speed input: 7262.62 toks/s, output: 7.09 toks/s]
Processed prompts:  31%|███       | 1250/4096 [02:56<06:56,  6.83it/s, est. speed input: 7240.67 toks/s, output: 7.07 toks/s]
Processed prompts:  31%|███▏      | 1282/4096 [03:01<07:03,  6.65it/s, est. speed input: 7217.27 toks/s, output: 7.05 toks/s]
Processed prompts:  32%|███▏      | 1314/4096 [03:06<07:05,  6.54it/s, est. speed input: 7196.55 toks/s, output: 7.03 toks/s]
Processed prompts:  33%|███▎      | 1346/4096 [03:12<07:06,  6.45it/s, est. speed input: 7175.11 toks/s, output: 7.01 toks/s]
Processed prompts:  34%|███▎      | 1378/4096 [03:17<07:03,  6.41it/s, est. speed input: 7157.50 toks/s, output: 6.99 toks/s]
Processed prompts:  34%|███▍      | 1410/4096 [03:20<06:13,  7.18it/s, est. speed input: 7206.38 toks/s, output: 7.04 toks/s]
Processed prompts:  35%|███▌      | 1442/4096 [03:25<06:24,  6.90it/s, est. speed input: 7188.11 toks/s, output: 7.02 toks/s]
Processed prompts:  36%|███▌      | 1474/4096 [03:30<06:28,  6.74it/s, est. speed input: 7173.25 toks/s, output: 7.01 toks/s]
Processed prompts:  37%|███▋      | 1506/4096 [03:35<06:35,  6.55it/s, est. speed input: 7151.98 toks/s, output: 6.98 toks/s]
Processed prompts:  38%|███▊      | 1538/4096 [03:40<06:33,  6.51it/s, est. speed input: 7138.40 toks/s, output: 6.97 toks/s]
Processed prompts:  38%|███▊      | 1570/4096 [03:45<06:30,  6.46it/s, est. speed input: 7124.41 toks/s, output: 6.96 toks/s]
Processed prompts:  39%|███▉      | 1602/4096 [03:50<06:26,  6.46it/s, est. speed input: 7113.49 toks/s, output: 6.95 toks/s]
Processed prompts:  40%|███▉      | 1634/4096 [03:53<05:41,  7.21it/s, est. speed input: 7155.08 toks/s, output: 6.99 toks/s]
Processed prompts:  41%|████      | 1666/4096 [03:59<05:53,  6.86it/s, est. speed input: 7137.07 toks/s, output: 6.97 toks/s]
Processed prompts:  41%|████▏     | 1698/4096 [04:04<05:57,  6.71it/s, est. speed input: 7124.81 toks/s, output: 6.96 toks/s]
Processed prompts:  42%|████▏     | 1730/4096 [04:09<05:59,  6.58it/s, est. speed input: 7110.67 toks/s, output: 6.94 toks/s]
Processed prompts:  43%|████▎     | 1762/4096 [04:14<06:00,  6.48it/s, est. speed input: 7096.47 toks/s, output: 6.93 toks/s]
Processed prompts:  44%|████▍     | 1794/4096 [04:19<05:56,  6.46it/s, est. speed input: 7086.54 toks/s, output: 6.92 toks/s]
Processed prompts:  45%|████▍     | 1826/4096 [04:22<05:23,  7.02it/s, est. speed input: 7113.02 toks/s, output: 6.95 toks/s]
Processed prompts:  45%|████▌     | 1858/4096 [04:27<05:28,  6.82it/s, est. speed input: 7102.65 toks/s, output: 6.94 toks/s]
Processed prompts:  46%|████▌     | 1890/4096 [04:33<05:32,  6.63it/s, est. speed input: 7088.99 toks/s, output: 6.92 toks/s]
Processed prompts:  47%|████▋     | 1922/4096 [04:38<05:33,  6.53it/s, est. speed input: 7077.10 toks/s, output: 6.91 toks/s]
Processed prompts:  48%|████▊     | 1954/4096 [04:43<05:30,  6.49it/s, est. speed input: 7067.90 toks/s, output: 6.90 toks/s]
Processed prompts:  48%|████▊     | 1986/4096 [04:48<05:29,  6.40it/s, est. speed input: 7054.99 toks/s, output: 6.89 toks/s]
Processed prompts:  49%|████▉     | 2018/4096 [04:53<05:25,  6.39it/s, est. speed input: 7045.88 toks/s, output: 6.88 toks/s]
Processed prompts:  50%|█████     | 2050/4096 [04:56<04:50,  7.05it/s, est. speed input: 7074.45 toks/s, output: 6.91 toks/s]
Processed prompts:  51%|█████     | 2082/4096 [05:01<04:55,  6.81it/s, est. speed input: 7064.42 toks/s, output: 6.90 toks/s]
Processed prompts:  52%|█████▏    | 2114/4096 [05:06<04:57,  6.67it/s, est. speed input: 7055.44 toks/s, output: 6.89 toks/s]
Processed prompts:  52%|█████▏    | 2146/4096 [05:12<04:59,  6.50it/s, est. speed input: 7042.57 toks/s, output: 6.88 toks/s]
Processed prompts:  53%|█████▎    | 2178/4096 [05:16<04:52,  6.56it/s, est. speed input: 7039.73 toks/s, output: 6.87 toks/s]
Processed prompts:  54%|█████▍    | 2210/4096 [05:21<04:49,  6.50it/s, est. speed input: 7031.80 toks/s, output: 6.87 toks/s]
Processed prompts:  55%|█████▍    | 2242/4096 [05:25<04:19,  7.13it/s, est. speed input: 7057.52 toks/s, output: 6.89 toks/s]
Processed prompts:  56%|█████▌    | 2274/4096 [05:30<04:24,  6.89it/s, est. speed input: 7049.75 toks/s, output: 6.88 toks/s]
Processed prompts:  56%|█████▋    | 2306/4096 [05:35<04:28,  6.66it/s, est. speed input: 7038.55 toks/s, output: 6.87 toks/s]
Processed prompts:  57%|█████▋    | 2338/4096 [05:40<04:27,  6.56it/s, est. speed input: 7030.48 toks/s, output: 6.87 toks/s]
Processed prompts:  58%|█████▊    | 2370/4096 [05:45<04:26,  6.48it/s, est. speed input: 7021.99 toks/s, output: 6.86 toks/s]
Processed prompts:  59%|█████▊    | 2402/4096 [05:50<04:24,  6.41it/s, est. speed input: 7013.05 toks/s, output: 6.85 toks/s]
Processed prompts:  59%|█████▉    | 2434/4096 [05:54<03:52,  7.15it/s, est. speed input: 7040.58 toks/s, output: 6.88 toks/s]
Processed prompts:  60%|██████    | 2466/4096 [05:59<03:59,  6.81it/s, est. speed input: 7029.61 toks/s, output: 6.86 toks/s]
Processed prompts:  61%|██████    | 2498/4096 [06:04<03:58,  6.70it/s, est. speed input: 7024.02 toks/s, output: 6.86 toks/s]
Processed prompts:  62%|██████▏   | 2530/4096 [06:09<03:59,  6.53it/s, est. speed input: 7013.92 toks/s, output: 6.85 toks/s]
Processed prompts:  63%|██████▎   | 2562/4096 [06:14<03:57,  6.46it/s, est. speed input: 7006.16 toks/s, output: 6.84 toks/s]
Processed prompts:  63%|██████▎   | 2594/4096 [06:19<03:52,  6.46it/s, est. speed input: 7000.94 toks/s, output: 6.84 toks/s]
Processed prompts:  64%|██████▍   | 2626/4096 [06:24<03:50,  6.38it/s, est. speed input: 6992.53 toks/s, output: 6.83 toks/s]
Processed prompts:  65%|██████▍   | 2658/4096 [06:27<03:20,  7.18it/s, est. speed input: 7020.21 toks/s, output: 6.86 toks/s]
Processed prompts:  66%|██████▌   | 2690/4096 [06:32<03:25,  6.85it/s, est. speed input: 7011.22 toks/s, output: 6.85 toks/s]
Processed prompts:  66%|██████▋   | 2722/4096 [06:37<03:25,  6.70it/s, est. speed input: 7004.84 toks/s, output: 6.84 toks/s]
Processed prompts:  67%|██████▋   | 2754/4096 [06:42<03:23,  6.60it/s, est. speed input: 6999.15 toks/s, output: 6.84 toks/s]
Processed prompts:  68%|██████▊   | 2786/4096 [06:48<03:22,  6.46it/s, est. speed input: 6990.21 toks/s, output: 6.83 toks/s]
Processed prompts:  69%|██████▉   | 2818/4096 [06:53<03:18,  6.45it/s, est. speed input: 6985.21 toks/s, output: 6.82 toks/s]
Processed prompts:  70%|██████▉   | 2850/4096 [06:56<02:55,  7.11it/s, est. speed input: 7006.53 toks/s, output: 6.84 toks/s]
Processed prompts:  70%|███████   | 2882/4096 [07:01<02:56,  6.88it/s, est. speed input: 7001.17 toks/s, output: 6.84 toks/s]
Processed prompts:  71%|███████   | 2914/4096 [07:06<02:56,  6.71it/s, est. speed input: 6994.96 toks/s, output: 6.83 toks/s]
Processed prompts:  72%|███████▏  | 2946/4096 [07:11<02:55,  6.54it/s, est. speed input: 6987.13 toks/s, output: 6.82 toks/s]
Processed prompts:  73%|███████▎  | 2978/4096 [07:16<02:52,  6.50it/s, est. speed input: 6982.19 toks/s, output: 6.82 toks/s]
Processed prompts:  73%|███████▎  | 3010/4096 [07:21<02:48,  6.43it/s, est. speed input: 6975.92 toks/s, output: 6.81 toks/s]
Processed prompts:  74%|███████▍  | 3042/4096 [07:26<02:45,  6.38it/s, est. speed input: 6969.60 toks/s, output: 6.81 toks/s]
Processed prompts:  75%|███████▌  | 3074/4096 [07:30<02:25,  7.03it/s, est. speed input: 6988.47 toks/s, output: 6.82 toks/s]
Processed prompts:  76%|███████▌  | 3106/4096 [07:35<02:26,  6.76it/s, est. speed input: 6981.44 toks/s, output: 6.82 toks/s]
Processed prompts:  77%|███████▋  | 3138/4096 [07:40<02:24,  6.64it/s, est. speed input: 6976.41 toks/s, output: 6.81 toks/s]
Processed prompts:  77%|███████▋  | 3170/4096 [07:45<02:22,  6.52it/s, est. speed input: 6970.00 toks/s, output: 6.81 toks/s]
Processed prompts:  78%|███████▊  | 3202/4096 [07:50<02:18,  6.45it/s, est. speed input: 6964.36 toks/s, output: 6.80 toks/s]
Processed prompts:  79%|███████▉  | 3234/4096 [07:55<02:13,  6.45it/s, est. speed input: 6960.62 toks/s, output: 6.80 toks/s]
Processed prompts:  80%|███████▉  | 3266/4096 [07:59<01:57,  7.06it/s, est. speed input: 6977.85 toks/s, output: 6.81 toks/s]
Processed prompts:  81%|████████  | 3298/4096 [08:04<01:56,  6.85it/s, est. speed input: 6973.56 toks/s, output: 6.81 toks/s]
Processed prompts:  81%|████████▏ | 3330/4096 [08:09<01:55,  6.63it/s, est. speed input: 6966.45 toks/s, output: 6.80 toks/s]
Processed prompts:  82%|████████▏ | 3362/4096 [08:14<01:52,  6.54it/s, est. speed input: 6961.50 toks/s, output: 6.80 toks/s]
Processed prompts:  83%|████████▎ | 3394/4096 [08:19<01:48,  6.50it/s, est. speed input: 6957.55 toks/s, output: 6.79 toks/s]
Processed prompts:  84%|████████▎ | 3426/4096 [08:24<01:44,  6.41it/s, est. speed input: 6951.40 toks/s, output: 6.79 toks/s]
Processed prompts:  84%|████████▍ | 3458/4096 [08:27<01:29,  7.12it/s, est. speed input: 6970.47 toks/s, output: 6.81 toks/s]
Processed prompts:  85%|████████▌ | 3490/4096 [08:33<01:28,  6.82it/s, est. speed input: 6964.10 toks/s, output: 6.80 toks/s]
Processed prompts:  86%|████████▌ | 3522/4096 [08:38<01:25,  6.68it/s, est. speed input: 6959.86 toks/s, output: 6.80 toks/s]
Processed prompts:  87%|████████▋ | 3554/4096 [08:43<01:22,  6.56it/s, est. speed input: 6954.99 toks/s, output: 6.79 toks/s]
Processed prompts:  88%|████████▊ | 3586/4096 [08:48<01:19,  6.44it/s, est. speed input: 6948.70 toks/s, output: 6.79 toks/s]
Processed prompts:  88%|████████▊ | 3618/4096 [08:53<01:14,  6.44it/s, est. speed input: 6945.57 toks/s, output: 6.78 toks/s]
Processed prompts:  89%|████████▉ | 3650/4096 [08:58<01:09,  6.41it/s, est. speed input: 6941.25 toks/s, output: 6.78 toks/s]
Processed prompts:  90%|████████▉ | 3682/4096 [09:01<00:57,  7.16it/s, est. speed input: 6960.08 toks/s, output: 6.80 toks/s]
Processed prompts:  91%|█████████ | 3714/4096 [09:06<00:55,  6.92it/s, est. speed input: 6956.51 toks/s, output: 6.79 toks/s]
Processed prompts:  91%|█████████▏| 3746/4096 [09:11<00:52,  6.70it/s, est. speed input: 6951.11 toks/s, output: 6.79 toks/s]
Processed prompts:  92%|█████████▏| 3778/4096 [09:16<00:48,  6.57it/s, est. speed input: 6946.59 toks/s, output: 6.78 toks/s]
Processed prompts:  93%|█████████▎| 3810/4096 [09:22<00:44,  6.47it/s, est. speed input: 6941.62 toks/s, output: 6.78 toks/s]
Processed prompts:  94%|█████████▍| 3842/4096 [09:27<00:39,  6.42it/s, est. speed input: 6937.22 toks/s, output: 6.77 toks/s]
Processed prompts:  95%|█████████▍| 3874/4096 [09:30<00:30,  7.18it/s, est. speed input: 6955.43 toks/s, output: 6.79 toks/s]
Processed prompts:  95%|█████████▌| 3906/4096 [09:35<00:27,  6.98it/s, est. speed input: 6953.36 toks/s, output: 6.79 toks/s]
Processed prompts:  96%|█████████▌| 3938/4096 [09:40<00:23,  6.80it/s, est. speed input: 6950.02 toks/s, output: 6.79 toks/s]
Processed prompts:  97%|█████████▋| 3970/4096 [09:45<00:19,  6.59it/s, est. speed input: 6944.13 toks/s, output: 6.78 toks/s]
Processed prompts:  98%|█████████▊| 4002/4096 [09:50<00:14,  6.53it/s, est. speed input: 6940.81 toks/s, output: 6.78 toks/s]
Processed prompts:  98%|█████████▊| 4034/4096 [09:55<00:09,  6.48it/s, est. speed input: 6937.15 toks/s, output: 6.77 toks/s]
Processed prompts:  99%|█████████▉| 4066/4096 [10:00<00:04,  6.48it/s, est. speed input: 6934.72 toks/s, output: 6.77 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [10:00<00:00,  6.48it/s, est. speed input: 6985.88 toks/s, output: 6.82 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [10:00<00:00,  6.82it/s, est. speed input: 6985.88 toks/s, output: 6.82 toks/s]
[rank0]:[W126 00:09:52.876813236 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=65536 ==========
Time: 2026-01-26 00:09:54
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=8192, max_num_seqs=64
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 8192 --max-num-seqs 64 --max-model-len 1025 --max-num-batched-tokens 65536 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Qwen2.5-7B-INT8_M65536.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 00:11:05 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 00:11:06 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=579617) WARNING 01-26 00:11:14 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=579617) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=579617) WARNING 01-26 00:11:27 [backends.py:609] Failed to read file <frozen os>
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 240, in _initialize_kv_caches
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     available_gpu_memory = self.model_executor.determine_available_memory()
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     return self.collective_rpc("determine_available_memory")
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     result = run_method(self.driver_worker, method, args, kwargs)
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/root/vllmbench/vllm/v1/serial_utils.py", line 461, in run_method
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 340, in determine_available_memory
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     self.model_runner.profile_run()
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4474, in profile_run
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     hidden_states, last_hidden_states = self._dummy_run(
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]                                         ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4198, in _dummy_run
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     outputs = self.model(
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]               ^^^^^^^^^^^
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 583, in forward
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     hidden_states = self.model(
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]                     ^^^^^^^^^^^
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/root/vllmbench/vllm/compilation/decorators.py", line 526, in __call__
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/root/vllmbench/vllm/compilation/wrapper.py", line 218, in __call__
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     return self._call_with_optional_nvtx_range(
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/root/vllmbench/vllm/compilation/wrapper.py", line 109, in _call_with_optional_nvtx_range
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     return callable_fn(*args, **kwargs)
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 832, in compile_wrapper
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     return fn(*args, **kwargs)
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 418, in forward
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     def forward(
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     return fn(*args, **kwargs)
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/root/vllmbench/vllm/compilation/caching.py", line 54, in __call__
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     return self.optimized_call(*args, **kwargs)
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 837, in call_wrapped
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     return self._wrapped_call(self, *args, **kwargs)
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 413, in __call__
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     raise e
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 400, in __call__
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     return super(self.cls, obj).__call__(*args, **kwargs)  # type: ignore[misc]
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "<eval_with_key>.58", line 325, in forward
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     submod_2 = self.submod_2(getitem_3, s72, l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_scale_, l_self_modules_layers_modules_0_modules_post_attention_layernorm_parameters_weight_, getitem_4, l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_scale_, l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_input_layernorm_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_bias_, l_positions_, l_self_modules_layers_modules_0_modules_self_attn_modules_rotary_emb_buffers_cos_sin_cache_);  getitem_3 = l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_scale_ = l_self_modules_layers_modules_0_modules_post_attention_layernorm_parameters_weight_ = getitem_4 = l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_scale_ = l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_input_layernorm_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_bias_ = None
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/root/vllmbench/vllm/compilation/piecewise_backend.py", line 178, in __call__
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     return range_entry.runnable(*args)
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/standalone_compile.py", line 63, in __call__
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     return self._compiled_fn(*args)
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     return fn(*args, **kwargs)
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/aot_autograd.py", line 1130, in forward
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     return compiled_fn(full_args)
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 353, in runtime_wrapper
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     all_outs = call_func_at_runtime_with_args(
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/utils.py", line 129, in call_func_at_runtime_with_args
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     out = normalize_as_list(f(args))
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]                             ^^^^^^^
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 724, in inner_fn
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     outs = compiled_fn(args)
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]            ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 526, in wrapper
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     return compiled_fn(runtime_args)
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/output_code.py", line 613, in __call__
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     return self.current_callable(inputs)
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/utils.py", line 2962, in run
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     out = model(new_inputs)
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]           ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/tmp/torchinductor_root/ax/caxhtv4z7pvejo2kecicfp7dovq5qwcbf7pbrxlmuivaiaz6ety5.py", line 1093, in call
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     buf17 = torch.ops.slidesparse.quant_slide_int8.default(buf16, 'Qwen2.5-7B-INT8', 6)
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_ops.py", line 841, in __call__
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     return self._op(*args, **kwargs)
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/root/vllmbench/slidesparse/core/kernels.py", line 564, in _quant_slide_int8_impl
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     return fn(input, L)
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]            ^^^^^^^^^^^^
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/root/vllmbench/slidesparse/csrc/fused_quant_slide_triton/build/RTX4090_cc89_py312_cu129_x86_64/quant_slide_tuned_Qwen2.5-7B.py", line 369, in quant_slide_int8_triton
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     _quant_slide_int8_kernel[(M,)](
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/triton/runtime/jit.py", line 419, in <lambda>
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/triton/runtime/jit.py", line 756, in run
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     launch_metadata = kernel.launch_metadata(grid, stream, *bound_args.values())
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 490, in launch_metadata
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     self._init_handles()
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 473, in _init_handles
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]     self.module, self.function, self.n_regs, self.n_spills, self.n_max_threads = driver.active.utils.load_binary(
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866]                                                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617) ERROR 01-26 00:11:40 [core.py:866] RuntimeError: Triton Error [CUDA]: an illegal memory access was encountered

STDERR:
[2026-01-26 00:11:04] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 00:11:05] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 00:11:05] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 00:11:05] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 00:11:05] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 00:11:05] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 00:11:05] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 00:11:05] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 00:11:05] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 00:11:05] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 00:11:05] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 00:11:05] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 00:11:05] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 00:11:05] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 00:11:13] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 00:11:13] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 00:11:13] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 00:11:13] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 00:11:13] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 00:11:13] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 00:11:13] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 00:11:13] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 00:11:13] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 00:11:13] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 00:11:13] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 00:11:13] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 00:11:13] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 00:11:13] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=579617) [2026-01-26 00:11:15] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=579617) [2026-01-26 00:11:15] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=579617) [2026-01-26 00:11:15] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=579617) [2026-01-26 00:11:15] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=579617) [2026-01-26 00:11:15] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=579617) [2026-01-26 00:11:15] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=579617) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=579617) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.03it/s]
(EngineCore_DP0 pid=579617) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.35s/it]
(EngineCore_DP0 pid=579617) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.29s/it]
(EngineCore_DP0 pid=579617) 
(EngineCore_DP0 pid=579617) [2026-01-26 00:11:19] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 4800] -> 1D uint8
(EngineCore_DP0 pid=579617) [2026-01-26 00:11:19] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 16662528 bytes
(EngineCore_DP0 pid=579617) [2026-01-26 00:11:19] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 4800] -> 1D uint8
(EngineCore_DP0 pid=579617) [2026-01-26 00:11:19] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12959744 bytes
(EngineCore_DP0 pid=579617) [2026-01-26 00:11:20] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 4800] -> 1D uint8
(EngineCore_DP0 pid=579617) [2026-01-26 00:11:20] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 137003008 bytes
(EngineCore_DP0 pid=579617) [2026-01-26 00:11:20] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 25280] -> 1D uint8
(EngineCore_DP0 pid=579617) [2026-01-26 00:11:20] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 68009984 bytes
(EngineCore_DP0 pid=579617) [rank0]:W0126 00:11:36.292000 579617 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=579617) [rank0]:W0126 00:11:36.413000 579617 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=579617) [rank0]:W0126 00:11:38.763000 579617 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=579617) [rank0]:W0126 00:11:38.945000 579617 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=579617) Process EngineCore_DP0:
(EngineCore_DP0 pid=579617) Traceback (most recent call last):
(EngineCore_DP0 pid=579617)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=579617)     self.run()
(EngineCore_DP0 pid=579617)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=579617)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=579617)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=579617)     raise e
(EngineCore_DP0 pid=579617)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=579617)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=579617)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=579617)     super().__init__(
(EngineCore_DP0 pid=579617)   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=579617)     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=579617)                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617)   File "/root/vllmbench/vllm/v1/engine/core.py", line 240, in _initialize_kv_caches
(EngineCore_DP0 pid=579617)     available_gpu_memory = self.model_executor.determine_available_memory()
(EngineCore_DP0 pid=579617)                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617)   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
(EngineCore_DP0 pid=579617)     return self.collective_rpc("determine_available_memory")
(EngineCore_DP0 pid=579617)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617)   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
(EngineCore_DP0 pid=579617)     result = run_method(self.driver_worker, method, args, kwargs)
(EngineCore_DP0 pid=579617)              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617)   File "/root/vllmbench/vllm/v1/serial_utils.py", line 461, in run_method
(EngineCore_DP0 pid=579617)     return func(*args, **kwargs)
(EngineCore_DP0 pid=579617)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617)   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=579617)     return func(*args, **kwargs)
(EngineCore_DP0 pid=579617)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617)   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 340, in determine_available_memory
(EngineCore_DP0 pid=579617)     self.model_runner.profile_run()
(EngineCore_DP0 pid=579617)   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4474, in profile_run
(EngineCore_DP0 pid=579617)     hidden_states, last_hidden_states = self._dummy_run(
(EngineCore_DP0 pid=579617)                                         ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617)   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=579617)     return func(*args, **kwargs)
(EngineCore_DP0 pid=579617)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617)   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4198, in _dummy_run
(EngineCore_DP0 pid=579617)     outputs = self.model(
(EngineCore_DP0 pid=579617)               ^^^^^^^^^^^
(EngineCore_DP0 pid=579617)   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=579617)     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=579617)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=579617)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=579617)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=579617)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=579617)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 583, in forward
(EngineCore_DP0 pid=579617)     hidden_states = self.model(
(EngineCore_DP0 pid=579617)                     ^^^^^^^^^^^
(EngineCore_DP0 pid=579617)   File "/root/vllmbench/vllm/compilation/decorators.py", line 526, in __call__
(EngineCore_DP0 pid=579617)     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
(EngineCore_DP0 pid=579617)              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617)   File "/root/vllmbench/vllm/compilation/wrapper.py", line 218, in __call__
(EngineCore_DP0 pid=579617)     return self._call_with_optional_nvtx_range(
(EngineCore_DP0 pid=579617)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617)   File "/root/vllmbench/vllm/compilation/wrapper.py", line 109, in _call_with_optional_nvtx_range
(EngineCore_DP0 pid=579617)     return callable_fn(*args, **kwargs)
(EngineCore_DP0 pid=579617)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617)   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 832, in compile_wrapper
(EngineCore_DP0 pid=579617)     return fn(*args, **kwargs)
(EngineCore_DP0 pid=579617)            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 418, in forward
(EngineCore_DP0 pid=579617)     def forward(
(EngineCore_DP0 pid=579617)   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=579617)     return fn(*args, **kwargs)
(EngineCore_DP0 pid=579617)            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617)   File "/root/vllmbench/vllm/compilation/caching.py", line 54, in __call__
(EngineCore_DP0 pid=579617)     return self.optimized_call(*args, **kwargs)
(EngineCore_DP0 pid=579617)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617)   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 837, in call_wrapped
(EngineCore_DP0 pid=579617)     return self._wrapped_call(self, *args, **kwargs)
(EngineCore_DP0 pid=579617)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617)   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 413, in __call__
(EngineCore_DP0 pid=579617)     raise e
(EngineCore_DP0 pid=579617)   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 400, in __call__
(EngineCore_DP0 pid=579617)     return super(self.cls, obj).__call__(*args, **kwargs)  # type: ignore[misc]
(EngineCore_DP0 pid=579617)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=579617)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=579617)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=579617)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=579617)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617)   File "<eval_with_key>.58", line 325, in forward
(EngineCore_DP0 pid=579617)     submod_2 = self.submod_2(getitem_3, s72, l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_scale_, l_self_modules_layers_modules_0_modules_post_attention_layernorm_parameters_weight_, getitem_4, l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_scale_, l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_input_layernorm_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_bias_, l_positions_, l_self_modules_layers_modules_0_modules_self_attn_modules_rotary_emb_buffers_cos_sin_cache_);  getitem_3 = l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_scale_ = l_self_modules_layers_modules_0_modules_post_attention_layernorm_parameters_weight_ = getitem_4 = l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_scale_ = l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_input_layernorm_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_bias_ = None
(EngineCore_DP0 pid=579617)                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617)   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=579617)     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=579617)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617)   File "/root/vllmbench/vllm/compilation/piecewise_backend.py", line 178, in __call__
(EngineCore_DP0 pid=579617)     return range_entry.runnable(*args)
(EngineCore_DP0 pid=579617)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/standalone_compile.py", line 63, in __call__
(EngineCore_DP0 pid=579617)     return self._compiled_fn(*args)
(EngineCore_DP0 pid=579617)            ^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617)   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=579617)     return fn(*args, **kwargs)
(EngineCore_DP0 pid=579617)            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/aot_autograd.py", line 1130, in forward
(EngineCore_DP0 pid=579617)     return compiled_fn(full_args)
(EngineCore_DP0 pid=579617)            ^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 353, in runtime_wrapper
(EngineCore_DP0 pid=579617)     all_outs = call_func_at_runtime_with_args(
(EngineCore_DP0 pid=579617)                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/utils.py", line 129, in call_func_at_runtime_with_args
(EngineCore_DP0 pid=579617)     out = normalize_as_list(f(args))
(EngineCore_DP0 pid=579617)                             ^^^^^^^
(EngineCore_DP0 pid=579617)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 724, in inner_fn
(EngineCore_DP0 pid=579617)     outs = compiled_fn(args)
(EngineCore_DP0 pid=579617)            ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 526, in wrapper
(EngineCore_DP0 pid=579617)     return compiled_fn(runtime_args)
(EngineCore_DP0 pid=579617)            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/output_code.py", line 613, in __call__
(EngineCore_DP0 pid=579617)     return self.current_callable(inputs)
(EngineCore_DP0 pid=579617)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/utils.py", line 2962, in run
(EngineCore_DP0 pid=579617)     out = model(new_inputs)
(EngineCore_DP0 pid=579617)           ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617)   File "/tmp/torchinductor_root/ax/caxhtv4z7pvejo2kecicfp7dovq5qwcbf7pbrxlmuivaiaz6ety5.py", line 1093, in call
(EngineCore_DP0 pid=579617)     buf17 = torch.ops.slidesparse.quant_slide_int8.default(buf16, 'Qwen2.5-7B-INT8', 6)
(EngineCore_DP0 pid=579617)             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617)   File "/usr/local/lib/python3.12/dist-packages/torch/_ops.py", line 841, in __call__
(EngineCore_DP0 pid=579617)     return self._op(*args, **kwargs)
(EngineCore_DP0 pid=579617)            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617)   File "/root/vllmbench/slidesparse/core/kernels.py", line 564, in _quant_slide_int8_impl
(EngineCore_DP0 pid=579617)     return fn(input, L)
(EngineCore_DP0 pid=579617)            ^^^^^^^^^^^^
(EngineCore_DP0 pid=579617)   File "/root/vllmbench/slidesparse/csrc/fused_quant_slide_triton/build/RTX4090_cc89_py312_cu129_x86_64/quant_slide_tuned_Qwen2.5-7B.py", line 369, in quant_slide_int8_triton
(EngineCore_DP0 pid=579617)     _quant_slide_int8_kernel[(M,)](
(EngineCore_DP0 pid=579617)   File "/usr/local/lib/python3.12/dist-packages/triton/runtime/jit.py", line 419, in <lambda>
(EngineCore_DP0 pid=579617)     return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)
(EngineCore_DP0 pid=579617)                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617)   File "/usr/local/lib/python3.12/dist-packages/triton/runtime/jit.py", line 756, in run
(EngineCore_DP0 pid=579617)     launch_metadata = kernel.launch_metadata(grid, stream, *bound_args.values())
(EngineCore_DP0 pid=579617)                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617)   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 490, in launch_metadata
(EngineCore_DP0 pid=579617)     self._init_handles()
(EngineCore_DP0 pid=579617)   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 473, in _init_handles
(EngineCore_DP0 pid=579617)     self.module, self.function, self.n_regs, self.n_spills, self.n_max_threads = driver.active.utils.load_binary(
(EngineCore_DP0 pid=579617)                                                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=579617) RuntimeError: Triton Error [CUDA]: an illegal memory access was encountered
[rank0]:[W126 00:11:41.428888115 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

ERROR: Test failed for M=65536

========== M=512 ==========
Time: 2026-01-26 02:03:48
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_6
Params: prompt_len=512, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_6 --dataset-name random --input-len 512 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 513 --max-num-batched-tokens 513 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Qwen2.5-7B-INT8_M512.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 02:03:56 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 02:03:57 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=40203) WARNING 01-26 02:04:04 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=40203) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=40203) WARNING 01-26 02:04:24 [backends.py:609] Failed to read file <frozen os>
Throughput: 17.15 requests/s, 8800.03 total tokens/s, 17.15 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128

STDERR:
[2026-01-26 02:03:56] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 02:03:56] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:03:56] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 02:03:56] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:03:56] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:03:56] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:03:56] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:03:56] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:03:56] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:03:56] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 02:03:56] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 02:03:56] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 02:03:56] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 02:03:56] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 02:04:03] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 02:04:03] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:04:03] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 02:04:03] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:04:03] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:04:03] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:04:03] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:04:03] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:04:03] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:04:03] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 02:04:03] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 02:04:03] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 02:04:03] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 02:04:03] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=40203) [2026-01-26 02:04:04] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=40203) [2026-01-26 02:04:04] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=40203) [2026-01-26 02:04:04] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=40203) [2026-01-26 02:04:04] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=40203) [2026-01-26 02:04:04] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=40203) [2026-01-26 02:04:04] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=40203) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=40203) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:03<00:03,  3.98s/it]
(EngineCore_DP0 pid=40203) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:09<00:00,  4.80s/it]
(EngineCore_DP0 pid=40203) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:09<00:00,  4.68s/it]
(EngineCore_DP0 pid=40203) 
(EngineCore_DP0 pid=40203) [2026-01-26 02:04:14] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 4800] -> 1D uint8
(EngineCore_DP0 pid=40203) [2026-01-26 02:04:14] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 16662528 bytes
(EngineCore_DP0 pid=40203) [2026-01-26 02:04:14] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 4800] -> 1D uint8
(EngineCore_DP0 pid=40203) [2026-01-26 02:04:14] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12959744 bytes
(EngineCore_DP0 pid=40203) [2026-01-26 02:04:14] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 4800] -> 1D uint8
(EngineCore_DP0 pid=40203) [2026-01-26 02:04:15] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 137003008 bytes
(EngineCore_DP0 pid=40203) [2026-01-26 02:04:15] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 25280] -> 1D uint8
(EngineCore_DP0 pid=40203) [2026-01-26 02:04:15] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 68009984 bytes
(EngineCore_DP0 pid=40203) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  7.77it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  8.14it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  8.07it/s]
(EngineCore_DP0 pid=40203) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.59it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.58it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  36%|███▌      | 46/128 [00:00<00:00, 453.90it/s]
Adding requests:  73%|███████▎  | 94/128 [00:00<00:00, 464.73it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 472.38it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▍         | 6/128 [00:00<00:03, 38.32it/s, est. speed input: 19623.64 toks/s, output: 38.32 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:00<00:04, 24.12it/s, est. speed input: 13234.59 toks/s, output: 25.85 toks/s]
Processed prompts:  10%|█         | 13/128 [00:00<00:05, 21.21it/s, est. speed input: 11862.97 toks/s, output: 23.17 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:00<00:05, 19.67it/s, est. speed input: 11128.21 toks/s, output: 21.73 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:00<00:05, 18.77it/s, est. speed input: 10674.02 toks/s, output: 20.85 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:01<00:05, 18.29it/s, est. speed input: 10439.00 toks/s, output: 20.39 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:01<00:05, 18.00it/s, est. speed input: 10271.94 toks/s, output: 20.06 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:01<00:05, 17.88it/s, est. speed input: 10155.80 toks/s, output: 19.84 toks/s]
Processed prompts:  21%|██        | 27/128 [00:01<00:05, 17.78it/s, est. speed input: 10056.72 toks/s, output: 19.64 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:01<00:05, 17.70it/s, est. speed input: 9973.55 toks/s, output: 19.48 toks/s] 
Processed prompts:  24%|██▍       | 31/128 [00:01<00:05, 17.63it/s, est. speed input: 9899.53 toks/s, output: 19.33 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:01<00:05, 17.60it/s, est. speed input: 9838.40 toks/s, output: 19.22 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:01<00:05, 17.54it/s, est. speed input: 9780.01 toks/s, output: 19.10 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:01<00:05, 17.54it/s, est. speed input: 9733.06 toks/s, output: 19.01 toks/s]
Processed prompts:  30%|███       | 39/128 [00:02<00:05, 17.44it/s, est. speed input: 9680.78 toks/s, output: 18.91 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:02<00:05, 17.33it/s, est. speed input: 9631.01 toks/s, output: 18.81 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:02<00:04, 17.28it/s, est. speed input: 9587.64 toks/s, output: 18.73 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:02<00:04, 17.33it/s, est. speed input: 9556.97 toks/s, output: 18.67 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:02<00:04, 17.38it/s, est. speed input: 9529.99 toks/s, output: 18.61 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:02<00:04, 17.31it/s, est. speed input: 9496.53 toks/s, output: 18.55 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:02<00:04, 17.34it/s, est. speed input: 9472.53 toks/s, output: 18.50 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:02<00:04, 17.43it/s, est. speed input: 9455.32 toks/s, output: 18.47 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:02<00:04, 17.53it/s, est. speed input: 9441.94 toks/s, output: 18.44 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:03<00:04, 17.50it/s, est. speed input: 9422.89 toks/s, output: 18.40 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:03<00:03, 17.47it/s, est. speed input: 9404.04 toks/s, output: 18.37 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:03<00:03, 17.45it/s, est. speed input: 9387.00 toks/s, output: 18.33 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:03<00:03, 17.40it/s, est. speed input: 9369.10 toks/s, output: 18.30 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:03<00:03, 17.42it/s, est. speed input: 9355.56 toks/s, output: 18.27 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:03<00:03, 17.44it/s, est. speed input: 9342.95 toks/s, output: 18.25 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:03<00:03, 17.41it/s, est. speed input: 9328.64 toks/s, output: 18.22 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:03<00:03, 17.41it/s, est. speed input: 9316.72 toks/s, output: 18.20 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:04<00:03, 17.39it/s, est. speed input: 9304.04 toks/s, output: 18.17 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:04<00:03, 17.33it/s, est. speed input: 9289.96 toks/s, output: 18.14 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:04<00:02, 17.33it/s, est. speed input: 9278.57 toks/s, output: 18.12 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:04<00:02, 17.26it/s, est. speed input: 9264.41 toks/s, output: 18.09 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:04<00:02, 17.31it/s, est. speed input: 9255.59 toks/s, output: 18.08 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:04<00:02, 17.32it/s, est. speed input: 9246.37 toks/s, output: 18.06 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:04<00:02, 17.27it/s, est. speed input: 9234.90 toks/s, output: 18.04 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:04<00:02, 17.32it/s, est. speed input: 9227.52 toks/s, output: 18.02 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:04<00:02, 17.34it/s, est. speed input: 9219.79 toks/s, output: 18.01 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:05<00:02, 17.39it/s, est. speed input: 9214.17 toks/s, output: 18.00 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:05<00:02, 17.50it/s, est. speed input: 9211.42 toks/s, output: 17.99 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:05<00:01, 17.41it/s, est. speed input: 9202.49 toks/s, output: 17.97 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:05<00:01, 17.42it/s, est. speed input: 9196.63 toks/s, output: 17.96 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:05<00:01, 17.35it/s, est. speed input: 9188.34 toks/s, output: 17.95 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:05<00:01, 17.38it/s, est. speed input: 9183.21 toks/s, output: 17.94 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:05<00:01, 17.37it/s, est. speed input: 9177.01 toks/s, output: 17.92 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:05<00:01, 17.40it/s, est. speed input: 9172.66 toks/s, output: 17.92 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:05<00:01, 17.42it/s, est. speed input: 9168.10 toks/s, output: 17.91 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:06<00:01, 17.46it/s, est. speed input: 9164.84 toks/s, output: 17.90 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:06<00:00, 17.44it/s, est. speed input: 9160.06 toks/s, output: 17.89 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:06<00:00, 17.31it/s, est. speed input: 9151.61 toks/s, output: 17.87 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:06<00:00, 17.24it/s, est. speed input: 9144.19 toks/s, output: 17.86 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:06<00:00, 17.28it/s, est. speed input: 9139.95 toks/s, output: 17.85 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:06<00:00, 17.30it/s, est. speed input: 9135.54 toks/s, output: 17.84 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:06<00:00, 17.26it/s, est. speed input: 9129.59 toks/s, output: 17.83 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:06<00:00, 17.27it/s, est. speed input: 9125.03 toks/s, output: 17.82 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:07<00:00, 17.30it/s, est. speed input: 9121.05 toks/s, output: 17.81 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:07<00:00, 17.32it/s, est. speed input: 9117.41 toks/s, output: 17.81 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 17.32it/s, est. speed input: 9115.94 toks/s, output: 17.80 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 17.80it/s, est. speed input: 9115.94 toks/s, output: 17.80 toks/s]
[rank0]:[W126 02:04:41.408011098 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=1024 ==========
Time: 2026-01-26 02:04:44
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 1025 --max-num-batched-tokens 1025 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Qwen2.5-7B-INT8_M1024.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 02:04:52 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 02:04:53 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=41235) WARNING 01-26 02:05:01 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=41235) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=41235) WARNING 01-26 02:05:12 [backends.py:609] Failed to read file <frozen os>
Throughput: 17.31 requests/s, 17740.05 total tokens/s, 17.31 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128

STDERR:
[2026-01-26 02:04:52] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 02:04:52] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:04:52] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 02:04:52] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:04:52] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:04:52] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:04:52] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:04:52] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:04:52] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:04:52] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 02:04:52] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 02:04:52] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 02:04:52] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 02:04:52] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 02:05:00] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 02:05:00] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:05:00] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 02:05:00] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:05:00] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:05:00] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:05:00] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:05:00] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:05:00] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:05:00] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 02:05:00] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 02:05:00] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 02:05:00] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 02:05:00] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=41235) [2026-01-26 02:05:01] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=41235) [2026-01-26 02:05:01] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=41235) [2026-01-26 02:05:01] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=41235) [2026-01-26 02:05:01] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=41235) [2026-01-26 02:05:01] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=41235) [2026-01-26 02:05:01] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=41235) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=41235) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.21it/s]
(EngineCore_DP0 pid=41235) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.16s/it]
(EngineCore_DP0 pid=41235) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.11s/it]
(EngineCore_DP0 pid=41235) 
(EngineCore_DP0 pid=41235) [2026-01-26 02:05:05] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 4800] -> 1D uint8
(EngineCore_DP0 pid=41235) [2026-01-26 02:05:05] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 16662528 bytes
(EngineCore_DP0 pid=41235) [2026-01-26 02:05:05] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 4800] -> 1D uint8
(EngineCore_DP0 pid=41235) [2026-01-26 02:05:05] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12959744 bytes
(EngineCore_DP0 pid=41235) [2026-01-26 02:05:05] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 4800] -> 1D uint8
(EngineCore_DP0 pid=41235) [2026-01-26 02:05:05] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 137003008 bytes
(EngineCore_DP0 pid=41235) [2026-01-26 02:05:05] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 25280] -> 1D uint8
(EngineCore_DP0 pid=41235) [2026-01-26 02:05:05] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 68009984 bytes
(EngineCore_DP0 pid=41235) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  8.39it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  8.59it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  8.56it/s]
(EngineCore_DP0 pid=41235) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.54it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.53it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  20%|█▉        | 25/128 [00:00<00:00, 244.46it/s]
Adding requests:  41%|████      | 52/128 [00:00<00:00, 252.36it/s]
Adding requests:  62%|██████▎   | 80/128 [00:00<00:00, 261.49it/s]
Adding requests:  84%|████████▎ | 107/128 [00:00<00:00, 264.33it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 260.35it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:00<00:02, 55.97it/s, est. speed input: 57321.26 toks/s, output: 55.97 toks/s]
Processed prompts:  11%|█         | 14/128 [00:00<00:04, 26.31it/s, est. speed input: 29635.56 toks/s, output: 28.94 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:00<00:04, 22.73it/s, est. speed input: 26019.74 toks/s, output: 25.41 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:00<00:05, 21.19it/s, est. speed input: 24520.61 toks/s, output: 23.95 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:01<00:05, 20.18it/s, est. speed input: 23527.79 toks/s, output: 22.98 toks/s]
Processed prompts:  21%|██        | 27/128 [00:01<00:05, 19.41it/s, est. speed input: 22768.49 toks/s, output: 22.23 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:01<00:05, 19.04it/s, est. speed input: 22380.14 toks/s, output: 21.86 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:01<00:05, 18.71it/s, est. speed input: 22043.41 toks/s, output: 21.53 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:01<00:05, 18.45it/s, est. speed input: 21758.11 toks/s, output: 21.25 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:01<00:05, 18.25it/s, est. speed input: 21513.11 toks/s, output: 21.01 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:01<00:05, 18.11it/s, est. speed input: 21301.83 toks/s, output: 20.80 toks/s]
Processed prompts:  30%|███       | 39/128 [00:01<00:04, 18.07it/s, est. speed input: 21130.85 toks/s, output: 20.64 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:02<00:04, 18.01it/s, est. speed input: 20972.57 toks/s, output: 20.48 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:02<00:04, 18.02it/s, est. speed input: 20841.23 toks/s, output: 20.35 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:02<00:04, 18.02it/s, est. speed input: 20721.32 toks/s, output: 20.24 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:02<00:04, 17.90it/s, est. speed input: 20590.90 toks/s, output: 20.11 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:02<00:04, 17.84it/s, est. speed input: 20477.31 toks/s, output: 20.00 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:02<00:04, 17.70it/s, est. speed input: 20358.01 toks/s, output: 19.88 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:02<00:04, 17.66it/s, est. speed input: 20257.21 toks/s, output: 19.78 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:02<00:04, 17.76it/s, est. speed input: 20184.63 toks/s, output: 19.71 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:02<00:03, 17.78it/s, est. speed input: 20110.23 toks/s, output: 19.64 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:03<00:03, 17.79it/s, est. speed input: 20039.65 toks/s, output: 19.57 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:03<00:03, 17.80it/s, est. speed input: 19975.66 toks/s, output: 19.51 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:03<00:03, 17.71it/s, est. speed input: 19903.80 toks/s, output: 19.44 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:03<00:03, 17.73it/s, est. speed input: 19846.90 toks/s, output: 19.38 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:03<00:03, 17.77it/s, est. speed input: 19796.54 toks/s, output: 19.33 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:03<00:03, 17.78it/s, est. speed input: 19746.74 toks/s, output: 19.28 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:03<00:03, 17.72it/s, est. speed input: 19693.33 toks/s, output: 19.23 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:03<00:03, 17.77it/s, est. speed input: 19652.54 toks/s, output: 19.19 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:03<00:02, 17.80it/s, est. speed input: 19614.11 toks/s, output: 19.15 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:04<00:02, 17.81it/s, est. speed input: 19576.43 toks/s, output: 19.12 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:04<00:02, 17.83it/s, est. speed input: 19542.02 toks/s, output: 19.08 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:04<00:02, 17.73it/s, est. speed input: 19498.14 toks/s, output: 19.04 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:04<00:02, 17.75it/s, est. speed input: 19465.47 toks/s, output: 19.01 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:04<00:02, 17.78it/s, est. speed input: 19435.42 toks/s, output: 18.98 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:04<00:02, 17.81it/s, est. speed input: 19408.62 toks/s, output: 18.95 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:04<00:02, 17.72it/s, est. speed input: 19372.77 toks/s, output: 18.92 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:04<00:02, 17.71it/s, est. speed input: 19343.42 toks/s, output: 18.89 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:04<00:01, 17.83it/s, est. speed input: 19325.86 toks/s, output: 18.87 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:05<00:01, 17.86it/s, est. speed input: 19303.77 toks/s, output: 18.85 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:05<00:01, 17.92it/s, est. speed input: 19286.62 toks/s, output: 18.83 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:05<00:01, 17.83it/s, est. speed input: 19260.23 toks/s, output: 18.81 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:05<00:01, 17.73it/s, est. speed input: 19231.86 toks/s, output: 18.78 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:05<00:01, 17.67it/s, est. speed input: 19205.21 toks/s, output: 18.76 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:05<00:01, 17.66it/s, est. speed input: 19182.22 toks/s, output: 18.73 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:05<00:01, 17.61it/s, est. speed input: 19156.84 toks/s, output: 18.71 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:05<00:01, 17.45it/s, est. speed input: 19123.40 toks/s, output: 18.68 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:05<00:00, 17.60it/s, est. speed input: 19109.91 toks/s, output: 18.66 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:06<00:00, 17.57it/s, est. speed input: 19087.15 toks/s, output: 18.64 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:06<00:00, 17.69it/s, est. speed input: 19074.99 toks/s, output: 18.63 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:06<00:00, 17.76it/s, est. speed input: 19062.49 toks/s, output: 18.62 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:06<00:00, 17.79it/s, est. speed input: 19048.87 toks/s, output: 18.60 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:06<00:00, 17.87it/s, est. speed input: 19039.08 toks/s, output: 18.59 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:06<00:00, 17.88it/s, est. speed input: 19027.59 toks/s, output: 18.58 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:06<00:00, 17.80it/s, est. speed input: 19010.80 toks/s, output: 18.57 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:06<00:00, 17.77it/s, est. speed input: 18995.99 toks/s, output: 18.55 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:06<00:00, 17.77it/s, est. speed input: 18989.61 toks/s, output: 18.54 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:06<00:00, 18.54it/s, est. speed input: 18989.61 toks/s, output: 18.54 toks/s]
[rank0]:[W126 02:05:31.616812399 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=2048 ==========
Time: 2026-01-26 02:05:34
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=256, max_num_seqs=2
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 256 --max-num-seqs 2 --max-model-len 1025 --max-num-batched-tokens 2048 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Qwen2.5-7B-INT8_M2048.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 02:05:42 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 02:05:43 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=42160) WARNING 01-26 02:05:51 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=42160) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=42160) WARNING 01-26 02:06:03 [backends.py:609] Failed to read file <frozen os>
Throughput: 23.35 requests/s, 23931.29 total tokens/s, 23.35 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256

STDERR:
[2026-01-26 02:05:42] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 02:05:42] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:05:42] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 02:05:42] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:05:42] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:05:42] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:05:42] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:05:42] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:05:42] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:05:42] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 02:05:42] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 02:05:42] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 02:05:42] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 02:05:42] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 02:05:50] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 02:05:50] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:05:50] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 02:05:50] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:05:50] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:05:50] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:05:50] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:05:50] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:05:50] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:05:50] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 02:05:50] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 02:05:50] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 02:05:50] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 02:05:50] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=42160) [2026-01-26 02:05:51] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=42160) [2026-01-26 02:05:51] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=42160) [2026-01-26 02:05:51] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=42160) [2026-01-26 02:05:51] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=42160) [2026-01-26 02:05:51] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=42160) [2026-01-26 02:05:51] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=42160) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=42160) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.18it/s]
(EngineCore_DP0 pid=42160) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.08s/it]
(EngineCore_DP0 pid=42160) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.05s/it]
(EngineCore_DP0 pid=42160) 
(EngineCore_DP0 pid=42160) [2026-01-26 02:05:54] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 4800] -> 1D uint8
(EngineCore_DP0 pid=42160) [2026-01-26 02:05:54] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 16662528 bytes
(EngineCore_DP0 pid=42160) [2026-01-26 02:05:54] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 4800] -> 1D uint8
(EngineCore_DP0 pid=42160) [2026-01-26 02:05:54] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12959744 bytes
(EngineCore_DP0 pid=42160) [2026-01-26 02:05:54] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 4800] -> 1D uint8
(EngineCore_DP0 pid=42160) [2026-01-26 02:05:54] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 137003008 bytes
(EngineCore_DP0 pid=42160) [2026-01-26 02:05:54] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 25280] -> 1D uint8
(EngineCore_DP0 pid=42160) [2026-01-26 02:05:54] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 68009984 bytes
(EngineCore_DP0 pid=42160) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  33%|███▎      | 1/3 [00:00<00:00,  8.33it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  67%|██████▋   | 2/3 [00:00<00:00,  8.77it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00,  8.05it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00,  8.19it/s]
(EngineCore_DP0 pid=42160) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 1/2 [00:00<00:00,  7.36it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  8.48it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  8.28it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  10%|▉         | 25/256 [00:00<00:00, 245.64it/s]
Adding requests:  20%|██        | 52/256 [00:00<00:00, 256.87it/s]
Adding requests:  31%|███▏      | 80/256 [00:00<00:00, 266.49it/s]
Adding requests:  42%|████▏     | 107/256 [00:00<00:00, 266.98it/s]
Adding requests:  52%|█████▏    | 134/256 [00:00<00:00, 260.15it/s]
Adding requests:  63%|██████▎   | 161/256 [00:00<00:00, 259.38it/s]
Adding requests:  73%|███████▎  | 188/256 [00:00<00:00, 262.22it/s]
Adding requests:  84%|████████▍ | 216/256 [00:00<00:00, 264.63it/s]
Adding requests:  95%|█████████▍| 243/256 [00:00<00:00, 262.32it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 261.12it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   8%|▊         | 20/256 [00:00<00:01, 183.03it/s, est. speed input: 187476.61 toks/s, output: 183.05 toks/s]
Processed prompts:  15%|█▌        | 39/256 [00:00<00:05, 39.66it/s, est. speed input: 46173.21 toks/s, output: 45.09 toks/s]   
Processed prompts:  19%|█▉        | 49/256 [00:01<00:06, 33.02it/s, est. speed input: 39054.69 toks/s, output: 38.14 toks/s]
Processed prompts:  21%|██▏       | 55/256 [00:01<00:06, 30.60it/s, est. speed input: 36657.66 toks/s, output: 35.80 toks/s]
Processed prompts:  23%|██▎       | 60/256 [00:01<00:07, 27.63it/s, est. speed input: 34341.14 toks/s, output: 33.54 toks/s]
Processed prompts:  25%|██▌       | 64/256 [00:01<00:07, 26.82it/s, est. speed input: 33479.09 toks/s, output: 32.69 toks/s]
Processed prompts:  27%|██▋       | 68/256 [00:02<00:07, 26.14it/s, est. speed input: 32760.44 toks/s, output: 31.99 toks/s]
Processed prompts:  28%|██▊       | 72/256 [00:02<00:07, 25.56it/s, est. speed input: 32144.93 toks/s, output: 31.39 toks/s]
Processed prompts:  30%|██▉       | 76/256 [00:02<00:07, 25.11it/s, est. speed input: 31616.00 toks/s, output: 30.87 toks/s]
Processed prompts:  31%|███▏      | 80/256 [00:02<00:07, 24.74it/s, est. speed input: 31147.99 toks/s, output: 30.42 toks/s]
Processed prompts:  33%|███▎      | 84/256 [00:02<00:07, 24.43it/s, est. speed input: 30729.03 toks/s, output: 30.01 toks/s]
Processed prompts:  34%|███▍      | 88/256 [00:02<00:06, 24.22it/s, est. speed input: 30359.92 toks/s, output: 29.65 toks/s]
Processed prompts:  36%|███▌      | 92/256 [00:03<00:06, 24.08it/s, est. speed input: 30034.56 toks/s, output: 29.33 toks/s]
Processed prompts:  38%|███▊      | 96/256 [00:03<00:06, 24.01it/s, est. speed input: 29750.04 toks/s, output: 29.05 toks/s]
Processed prompts:  39%|███▉      | 100/256 [00:03<00:06, 23.94it/s, est. speed input: 29487.91 toks/s, output: 28.80 toks/s]
Processed prompts:  41%|████      | 104/256 [00:03<00:06, 23.93it/s, est. speed input: 29258.03 toks/s, output: 28.57 toks/s]
Processed prompts:  42%|████▏     | 108/256 [00:03<00:06, 23.91it/s, est. speed input: 29046.20 toks/s, output: 28.37 toks/s]
Processed prompts:  44%|████▍     | 112/256 [00:03<00:06, 23.86it/s, est. speed input: 28844.90 toks/s, output: 28.17 toks/s]
Processed prompts:  45%|████▌     | 116/256 [00:04<00:05, 23.87it/s, est. speed input: 28668.21 toks/s, output: 28.00 toks/s]
Processed prompts:  47%|████▋     | 120/256 [00:04<00:05, 23.86it/s, est. speed input: 28503.15 toks/s, output: 27.83 toks/s]
Processed prompts:  48%|████▊     | 124/256 [00:04<00:05, 23.85it/s, est. speed input: 28348.02 toks/s, output: 27.68 toks/s]
Processed prompts:  50%|█████     | 128/256 [00:04<00:05, 23.82it/s, est. speed input: 28202.44 toks/s, output: 27.54 toks/s]
Processed prompts:  52%|█████▏    | 132/256 [00:04<00:05, 23.84it/s, est. speed input: 28072.60 toks/s, output: 27.41 toks/s]
Processed prompts:  53%|█████▎    | 136/256 [00:04<00:05, 23.82it/s, est. speed input: 27946.60 toks/s, output: 27.29 toks/s]
Processed prompts:  55%|█████▍    | 140/256 [00:05<00:04, 23.77it/s, est. speed input: 27824.88 toks/s, output: 27.17 toks/s]
Processed prompts:  56%|█████▋    | 144/256 [00:05<00:04, 23.80it/s, est. speed input: 27717.48 toks/s, output: 27.07 toks/s]
Processed prompts:  58%|█████▊    | 148/256 [00:05<00:04, 23.82it/s, est. speed input: 27617.34 toks/s, output: 26.97 toks/s]
Processed prompts:  59%|█████▉    | 152/256 [00:05<00:04, 23.83it/s, est. speed input: 27523.45 toks/s, output: 26.88 toks/s]
Processed prompts:  61%|██████    | 156/256 [00:05<00:04, 23.79it/s, est. speed input: 27429.09 toks/s, output: 26.79 toks/s]
Processed prompts:  62%|██████▎   | 160/256 [00:05<00:04, 23.75it/s, est. speed input: 27338.65 toks/s, output: 26.70 toks/s]
Processed prompts:  64%|██████▍   | 164/256 [00:06<00:03, 23.74it/s, est. speed input: 27254.97 toks/s, output: 26.62 toks/s]
Processed prompts:  66%|██████▌   | 168/256 [00:06<00:03, 23.73it/s, est. speed input: 27175.80 toks/s, output: 26.54 toks/s]
Processed prompts:  67%|██████▋   | 172/256 [00:06<00:03, 23.76it/s, est. speed input: 27103.84 toks/s, output: 26.47 toks/s]
Processed prompts:  69%|██████▉   | 176/256 [00:06<00:03, 23.77it/s, est. speed input: 27034.41 toks/s, output: 26.40 toks/s]
Processed prompts:  70%|███████   | 180/256 [00:06<00:03, 23.80it/s, est. speed input: 26971.50 toks/s, output: 26.34 toks/s]
Processed prompts:  72%|███████▏  | 184/256 [00:07<00:03, 23.82it/s, est. speed input: 26911.00 toks/s, output: 26.28 toks/s]
Processed prompts:  73%|███████▎  | 188/256 [00:07<00:02, 23.83it/s, est. speed input: 26852.24 toks/s, output: 26.22 toks/s]
Processed prompts:  75%|███████▌  | 192/256 [00:07<00:02, 23.83it/s, est. speed input: 26796.32 toks/s, output: 26.17 toks/s]
Processed prompts:  77%|███████▋  | 196/256 [00:07<00:02, 23.80it/s, est. speed input: 26739.99 toks/s, output: 26.11 toks/s]
Processed prompts:  78%|███████▊  | 200/256 [00:07<00:02, 23.79it/s, est. speed input: 26687.48 toks/s, output: 26.06 toks/s]
Processed prompts:  80%|███████▉  | 204/256 [00:07<00:02, 24.75it/s, est. speed input: 26711.80 toks/s, output: 26.09 toks/s]
Processed prompts:  81%|████████▏ | 208/256 [00:07<00:01, 24.45it/s, est. speed input: 26662.07 toks/s, output: 26.04 toks/s]
Processed prompts:  83%|████████▎ | 212/256 [00:08<00:01, 24.28it/s, est. speed input: 26617.11 toks/s, output: 25.99 toks/s]
Processed prompts:  84%|████████▍ | 216/256 [00:08<00:01, 24.12it/s, est. speed input: 26570.76 toks/s, output: 25.95 toks/s]
Processed prompts:  86%|████████▌ | 220/256 [00:08<00:01, 24.03it/s, est. speed input: 26527.86 toks/s, output: 25.91 toks/s]
Processed prompts:  88%|████████▊ | 224/256 [00:08<00:01, 23.93it/s, est. speed input: 26483.98 toks/s, output: 25.86 toks/s]
Processed prompts:  89%|████████▉ | 228/256 [00:08<00:01, 23.91it/s, est. speed input: 26444.97 toks/s, output: 25.83 toks/s]
Processed prompts:  91%|█████████ | 232/256 [00:08<00:01, 23.87it/s, est. speed input: 26405.46 toks/s, output: 25.79 toks/s]
Processed prompts:  92%|█████████▏| 236/256 [00:09<00:00, 23.83it/s, est. speed input: 26366.74 toks/s, output: 25.75 toks/s]
Processed prompts:  94%|█████████▍| 240/256 [00:09<00:00, 23.74it/s, est. speed input: 26325.69 toks/s, output: 25.71 toks/s]
Processed prompts:  95%|█████████▌| 244/256 [00:09<00:00, 23.76it/s, est. speed input: 26291.05 toks/s, output: 25.67 toks/s]
Processed prompts:  97%|█████████▋| 248/256 [00:09<00:00, 23.78it/s, est. speed input: 26258.54 toks/s, output: 25.64 toks/s]
Processed prompts:  98%|█████████▊| 252/256 [00:09<00:00, 23.79it/s, est. speed input: 26226.13 toks/s, output: 25.61 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:09<00:00, 24.90it/s, est. speed input: 26260.30 toks/s, output: 25.64 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:09<00:00, 24.90it/s, est. speed input: 26260.30 toks/s, output: 25.64 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:09<00:00, 25.64it/s, est. speed input: 26260.30 toks/s, output: 25.64 toks/s]
[rank0]:[W126 02:06:25.416678458 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=4096 ==========
Time: 2026-01-26 02:06:27
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=512, max_num_seqs=4
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 512 --max-num-seqs 4 --max-model-len 1025 --max-num-batched-tokens 4096 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Qwen2.5-7B-INT8_M4096.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 02:06:38 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 02:06:38 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=43145) WARNING 01-26 02:06:46 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=43145) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=43145) WARNING 01-26 02:06:58 [backends.py:609] Failed to read file <frozen os>
Throughput: 24.42 requests/s, 25032.74 total tokens/s, 24.42 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512

STDERR:
[2026-01-26 02:06:38] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 02:06:38] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:06:38] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 02:06:38] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:06:38] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:06:38] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:06:38] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:06:38] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:06:38] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:06:38] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 02:06:38] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 02:06:38] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 02:06:38] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 02:06:38] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 02:06:45] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 02:06:45] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:06:45] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 02:06:45] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:06:45] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:06:45] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:06:45] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:06:45] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:06:45] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:06:45] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 02:06:45] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 02:06:45] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 02:06:45] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 02:06:45] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=43145) [2026-01-26 02:06:46] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=43145) [2026-01-26 02:06:46] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=43145) [2026-01-26 02:06:46] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=43145) [2026-01-26 02:06:46] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=43145) [2026-01-26 02:06:46] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=43145) [2026-01-26 02:06:46] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=43145) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=43145) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.15it/s]
(EngineCore_DP0 pid=43145) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.10s/it]
(EngineCore_DP0 pid=43145) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.07s/it]
(EngineCore_DP0 pid=43145) 
(EngineCore_DP0 pid=43145) [2026-01-26 02:06:49] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 4800] -> 1D uint8
(EngineCore_DP0 pid=43145) [2026-01-26 02:06:49] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 16662528 bytes
(EngineCore_DP0 pid=43145) [2026-01-26 02:06:49] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 4800] -> 1D uint8
(EngineCore_DP0 pid=43145) [2026-01-26 02:06:49] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12959744 bytes
(EngineCore_DP0 pid=43145) [2026-01-26 02:06:49] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 4800] -> 1D uint8
(EngineCore_DP0 pid=43145) [2026-01-26 02:06:49] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 137003008 bytes
(EngineCore_DP0 pid=43145) [2026-01-26 02:06:49] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 25280] -> 1D uint8
(EngineCore_DP0 pid=43145) [2026-01-26 02:06:49] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 68009984 bytes
(EngineCore_DP0 pid=43145) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  25%|██▌       | 1/4 [00:00<00:00,  8.33it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 2/4 [00:00<00:00,  8.81it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  75%|███████▌  | 3/4 [00:00<00:00,  9.04it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  8.34it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  8.50it/s]
(EngineCore_DP0 pid=43145) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  33%|███▎      | 1/3 [00:00<00:00,  7.40it/s]
Capturing CUDA graphs (decode, FULL):  67%|██████▋   | 2/3 [00:00<00:00,  8.43it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  8.87it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  8.62it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   5%|▍         | 24/512 [00:00<00:02, 236.01it/s]
Adding requests:  10%|▉         | 50/512 [00:00<00:01, 247.89it/s]
Adding requests:  15%|█▌        | 77/512 [00:00<00:01, 256.14it/s]
Adding requests:  20%|██        | 103/512 [00:00<00:01, 256.75it/s]
Adding requests:  25%|██▌       | 130/512 [00:00<00:01, 259.69it/s]
Adding requests:  31%|███       | 158/512 [00:00<00:01, 264.80it/s]
Adding requests:  37%|███▋      | 187/512 [00:00<00:01, 270.81it/s]
Adding requests:  42%|████▏     | 215/512 [00:00<00:01, 265.88it/s]
Adding requests:  47%|████▋     | 242/512 [00:00<00:01, 264.53it/s]
Adding requests:  53%|█████▎    | 269/512 [00:01<00:00, 266.12it/s]
Adding requests:  58%|█████▊    | 296/512 [00:01<00:00, 266.89it/s]
Adding requests:  63%|██████▎   | 324/512 [00:01<00:00, 268.94it/s]
Adding requests:  69%|██████▉   | 353/512 [00:01<00:00, 273.18it/s]
Adding requests:  74%|███████▍  | 381/512 [00:01<00:00, 271.73it/s]
Adding requests:  80%|████████  | 410/512 [00:01<00:00, 274.64it/s]
Adding requests:  86%|████████▌ | 438/512 [00:01<00:00, 271.53it/s]
Adding requests:  91%|█████████ | 466/512 [00:01<00:00, 268.46it/s]
Adding requests:  97%|█████████▋| 495/512 [00:01<00:00, 274.41it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 267.57it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   9%|▉         | 46/512 [00:00<00:02, 193.03it/s, est. speed input: 197680.78 toks/s, output: 193.03 toks/s]
Processed prompts:  13%|█▎        | 66/512 [00:01<00:08, 54.26it/s, est. speed input: 65388.21 toks/s, output: 63.85 toks/s]   
Processed prompts:  15%|█▍        | 76/512 [00:01<00:09, 46.94it/s, est. speed input: 57580.82 toks/s, output: 56.23 toks/s]
Processed prompts:  16%|█▌        | 83/512 [00:01<00:10, 39.10it/s, est. speed input: 50898.55 toks/s, output: 49.71 toks/s]
Processed prompts:  17%|█▋        | 88/512 [00:01<00:11, 37.70it/s, est. speed input: 49273.53 toks/s, output: 48.12 toks/s]
Processed prompts:  18%|█▊        | 93/512 [00:01<00:11, 36.39it/s, est. speed input: 47903.97 toks/s, output: 46.78 toks/s]
Processed prompts:  19%|█▉        | 97/512 [00:02<00:12, 33.81it/s, est. speed input: 46258.06 toks/s, output: 45.17 toks/s]
Processed prompts:  20%|█▉        | 101/512 [00:02<00:12, 31.68it/s, est. speed input: 44845.54 toks/s, output: 43.79 toks/s]
Processed prompts:  21%|██        | 105/512 [00:02<00:13, 29.98it/s, est. speed input: 43611.56 toks/s, output: 42.59 toks/s]
Processed prompts:  21%|██        | 108/512 [00:02<00:15, 26.84it/s, est. speed input: 42095.89 toks/s, output: 41.11 toks/s]
Processed prompts:  22%|██▏       | 111/512 [00:02<00:16, 24.62it/s, est. speed input: 40793.47 toks/s, output: 39.84 toks/s]
Processed prompts:  22%|██▏       | 114/512 [00:02<00:17, 22.97it/s, est. speed input: 39629.91 toks/s, output: 38.70 toks/s]
Processed prompts:  23%|██▎       | 118/512 [00:03<00:16, 23.59it/s, est. speed input: 38916.75 toks/s, output: 38.00 toks/s]
Processed prompts:  24%|██▍       | 122/512 [00:03<00:16, 24.05it/s, est. speed input: 38275.53 toks/s, output: 37.38 toks/s]
Processed prompts:  25%|██▍       | 126/512 [00:03<00:15, 24.39it/s, est. speed input: 37697.21 toks/s, output: 36.81 toks/s]
Processed prompts:  25%|██▌       | 130/512 [00:03<00:15, 24.61it/s, est. speed input: 37166.49 toks/s, output: 36.30 toks/s]
Processed prompts:  26%|██▌       | 134/512 [00:03<00:15, 24.77it/s, est. speed input: 36681.61 toks/s, output: 35.82 toks/s]
Processed prompts:  27%|██▋       | 138/512 [00:03<00:15, 24.87it/s, est. speed input: 36232.27 toks/s, output: 35.38 toks/s]
Processed prompts:  28%|██▊       | 142/512 [00:04<00:14, 24.94it/s, est. speed input: 35819.21 toks/s, output: 34.98 toks/s]
Processed prompts:  29%|██▊       | 146/512 [00:04<00:14, 24.98it/s, est. speed input: 35435.71 toks/s, output: 34.60 toks/s]
Processed prompts:  29%|██▉       | 150/512 [00:04<00:14, 25.03it/s, est. speed input: 35083.75 toks/s, output: 34.26 toks/s]
Processed prompts:  30%|███       | 154/512 [00:04<00:14, 25.06it/s, est. speed input: 34755.94 toks/s, output: 33.94 toks/s]
Processed prompts:  31%|███       | 158/512 [00:04<00:14, 25.09it/s, est. speed input: 34451.00 toks/s, output: 33.64 toks/s]
Processed prompts:  32%|███▏      | 162/512 [00:04<00:13, 25.11it/s, est. speed input: 34166.76 toks/s, output: 33.37 toks/s]
Processed prompts:  32%|███▏      | 166/512 [00:05<00:13, 25.12it/s, est. speed input: 33898.98 toks/s, output: 33.10 toks/s]
Processed prompts:  33%|███▎      | 170/512 [00:05<00:13, 25.13it/s, est. speed input: 33649.55 toks/s, output: 32.86 toks/s]
Processed prompts:  34%|███▍      | 174/512 [00:05<00:13, 25.15it/s, est. speed input: 33415.93 toks/s, output: 32.63 toks/s]
Processed prompts:  35%|███▍      | 178/512 [00:05<00:13, 25.16it/s, est. speed input: 33194.60 toks/s, output: 32.42 toks/s]
Processed prompts:  36%|███▌      | 182/512 [00:05<00:13, 25.13it/s, est. speed input: 32981.57 toks/s, output: 32.21 toks/s]
Processed prompts:  36%|███▋      | 186/512 [00:05<00:12, 25.10it/s, est. speed input: 32780.32 toks/s, output: 32.01 toks/s]
Processed prompts:  37%|███▋      | 190/512 [00:05<00:12, 25.09it/s, est. speed input: 32589.35 toks/s, output: 31.83 toks/s]
Processed prompts:  38%|███▊      | 194/512 [00:06<00:12, 25.10it/s, est. speed input: 32411.69 toks/s, output: 31.65 toks/s]
Processed prompts:  39%|███▊      | 198/512 [00:06<00:12, 25.11it/s, est. speed input: 32242.18 toks/s, output: 31.49 toks/s]
Processed prompts:  39%|███▉      | 202/512 [00:06<00:11, 26.54it/s, est. speed input: 32224.27 toks/s, output: 31.47 toks/s]
Processed prompts:  40%|████      | 206/512 [00:06<00:11, 25.93it/s, est. speed input: 32050.56 toks/s, output: 31.30 toks/s]
Processed prompts:  41%|████      | 210/512 [00:06<00:11, 25.48it/s, est. speed input: 31881.83 toks/s, output: 31.13 toks/s]
Processed prompts:  42%|████▏     | 214/512 [00:06<00:11, 25.19it/s, est. speed input: 31721.93 toks/s, output: 30.98 toks/s]
Processed prompts:  43%|████▎     | 218/512 [00:07<00:11, 25.00it/s, est. speed input: 31571.23 toks/s, output: 30.83 toks/s]
Processed prompts:  43%|████▎     | 222/512 [00:07<00:11, 24.87it/s, est. speed input: 31427.10 toks/s, output: 30.69 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:07<00:11, 24.77it/s, est. speed input: 31288.42 toks/s, output: 30.55 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:07<00:11, 24.71it/s, est. speed input: 31156.10 toks/s, output: 30.43 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:07<00:11, 24.64it/s, est. speed input: 31027.30 toks/s, output: 30.30 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:07<00:11, 24.59it/s, est. speed input: 30903.88 toks/s, output: 30.18 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:08<00:10, 24.57it/s, est. speed input: 30786.52 toks/s, output: 30.06 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:08<00:10, 24.56it/s, est. speed input: 30674.02 toks/s, output: 29.95 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:08<00:10, 24.53it/s, est. speed input: 30564.34 toks/s, output: 29.85 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:08<00:10, 24.51it/s, est. speed input: 30458.91 toks/s, output: 29.74 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:08<00:10, 24.52it/s, est. speed input: 30358.78 toks/s, output: 29.65 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:08<00:10, 24.49it/s, est. speed input: 30260.05 toks/s, output: 29.55 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:09<00:10, 24.47it/s, est. speed input: 30164.87 toks/s, output: 29.46 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:09<00:09, 24.45it/s, est. speed input: 30072.24 toks/s, output: 29.37 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:09<00:09, 24.45it/s, est. speed input: 29984.11 toks/s, output: 29.28 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:09<00:09, 24.46it/s, est. speed input: 29900.28 toks/s, output: 29.20 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:09<00:09, 24.47it/s, est. speed input: 29819.06 toks/s, output: 29.12 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:09<00:09, 24.48it/s, est. speed input: 29740.27 toks/s, output: 29.04 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:10<00:09, 24.45it/s, est. speed input: 29662.34 toks/s, output: 28.97 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:10<00:08, 24.47it/s, est. speed input: 29589.43 toks/s, output: 28.90 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:10<00:08, 24.47it/s, est. speed input: 29517.40 toks/s, output: 28.83 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:10<00:08, 24.46it/s, est. speed input: 29447.36 toks/s, output: 28.76 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:10<00:08, 24.45it/s, est. speed input: 29379.37 toks/s, output: 28.69 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:10<00:08, 24.43it/s, est. speed input: 29312.73 toks/s, output: 28.63 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:10<00:08, 24.43it/s, est. speed input: 29248.85 toks/s, output: 28.56 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:11<00:07, 24.45it/s, est. speed input: 29187.58 toks/s, output: 28.50 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:11<00:07, 24.44it/s, est. speed input: 29127.23 toks/s, output: 28.44 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:11<00:07, 24.44it/s, est. speed input: 29068.86 toks/s, output: 28.39 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:11<00:07, 24.46it/s, est. speed input: 29013.16 toks/s, output: 28.33 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:11<00:07, 24.44it/s, est. speed input: 28957.07 toks/s, output: 28.28 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:11<00:07, 24.42it/s, est. speed input: 28902.51 toks/s, output: 28.23 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:12<00:06, 24.42it/s, est. speed input: 28849.94 toks/s, output: 28.17 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:12<00:06, 24.41it/s, est. speed input: 28797.87 toks/s, output: 28.12 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:12<00:06, 24.41it/s, est. speed input: 28747.96 toks/s, output: 28.07 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:12<00:06, 24.44it/s, est. speed input: 28700.79 toks/s, output: 28.03 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:12<00:06, 24.44it/s, est. speed input: 28653.63 toks/s, output: 27.98 toks/s]
Processed prompts:  71%|███████   | 362/512 [00:12<00:06, 24.42it/s, est. speed input: 28606.81 toks/s, output: 27.94 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:13<00:05, 24.41it/s, est. speed input: 28561.37 toks/s, output: 27.89 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [00:13<00:05, 24.41it/s, est. speed input: 28517.42 toks/s, output: 27.85 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [00:13<00:05, 24.42it/s, est. speed input: 28475.06 toks/s, output: 27.81 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [00:13<00:05, 24.43it/s, est. speed input: 28433.60 toks/s, output: 27.77 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [00:13<00:05, 24.44it/s, est. speed input: 28393.75 toks/s, output: 27.73 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [00:13<00:05, 24.43it/s, est. speed input: 28353.53 toks/s, output: 27.69 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [00:14<00:04, 24.41it/s, est. speed input: 28314.10 toks/s, output: 27.65 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [00:14<00:04, 24.41it/s, est. speed input: 28276.04 toks/s, output: 27.61 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [00:14<00:04, 24.42it/s, est. speed input: 28239.24 toks/s, output: 27.58 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [00:14<00:04, 24.42it/s, est. speed input: 28202.69 toks/s, output: 27.54 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [00:14<00:04, 24.43it/s, est. speed input: 28167.81 toks/s, output: 27.51 toks/s]
Processed prompts:  80%|████████  | 410/512 [00:14<00:04, 24.42it/s, est. speed input: 28132.92 toks/s, output: 27.47 toks/s]
Processed prompts:  81%|████████  | 414/512 [00:15<00:04, 24.41it/s, est. speed input: 28098.40 toks/s, output: 27.44 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [00:15<00:03, 24.38it/s, est. speed input: 28063.98 toks/s, output: 27.41 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [00:15<00:03, 24.38it/s, est. speed input: 28030.80 toks/s, output: 27.37 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [00:15<00:03, 24.38it/s, est. speed input: 27998.77 toks/s, output: 27.34 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [00:15<00:03, 24.40it/s, est. speed input: 27967.69 toks/s, output: 27.31 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [00:15<00:03, 24.27it/s, est. speed input: 27931.91 toks/s, output: 27.28 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [00:16<00:03, 24.17it/s, est. speed input: 27896.50 toks/s, output: 27.24 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [00:16<00:02, 24.09it/s, est. speed input: 27861.05 toks/s, output: 27.21 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [00:16<00:02, 24.03it/s, est. speed input: 27826.63 toks/s, output: 27.17 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [00:16<00:02, 24.01it/s, est. speed input: 27793.38 toks/s, output: 27.14 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [00:16<00:02, 23.99it/s, est. speed input: 27760.79 toks/s, output: 27.11 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [00:16<00:02, 23.97it/s, est. speed input: 27728.58 toks/s, output: 27.08 toks/s]
Processed prompts:  90%|█████████ | 462/512 [00:17<00:02, 23.96it/s, est. speed input: 27697.12 toks/s, output: 27.05 toks/s]
Processed prompts:  91%|█████████ | 466/512 [00:17<00:01, 23.96it/s, est. speed input: 27666.51 toks/s, output: 27.02 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [00:17<00:01, 23.94it/s, est. speed input: 27635.55 toks/s, output: 26.99 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [00:17<00:01, 23.95it/s, est. speed input: 27606.54 toks/s, output: 26.96 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [00:17<00:01, 23.97it/s, est. speed input: 27578.16 toks/s, output: 26.93 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [00:17<00:01, 23.95it/s, est. speed input: 27549.34 toks/s, output: 26.90 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [00:18<00:01, 23.93it/s, est. speed input: 27520.60 toks/s, output: 26.88 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [00:18<00:00, 23.94it/s, est. speed input: 27493.21 toks/s, output: 26.85 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [00:18<00:00, 23.91it/s, est. speed input: 27465.16 toks/s, output: 26.82 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [00:18<00:00, 23.89it/s, est. speed input: 27437.67 toks/s, output: 26.79 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [00:18<00:00, 23.88it/s, est. speed input: 27410.93 toks/s, output: 26.77 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [00:18<00:00, 23.90it/s, est. speed input: 27385.34 toks/s, output: 26.74 toks/s]
Processed prompts: 100%|█████████▉| 510/512 [00:19<00:00, 25.70it/s, est. speed input: 27415.82 toks/s, output: 26.77 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:19<00:00, 25.70it/s, est. speed input: 27523.01 toks/s, output: 26.88 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:19<00:00, 26.88it/s, est. speed input: 27523.01 toks/s, output: 26.88 toks/s]
[rank0]:[W126 02:07:30.907805903 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=8192 ==========
Time: 2026-01-26 02:07:33
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=1024, max_num_seqs=8
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 1024 --max-num-seqs 8 --max-model-len 1025 --max-num-batched-tokens 8192 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Qwen2.5-7B-INT8_M8192.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 02:07:47 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 02:07:48 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=44360) WARNING 01-26 02:07:55 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=44360) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=44360) WARNING 01-26 02:08:08 [backends.py:609] Failed to read file <frozen os>
Throughput: 24.47 requests/s, 25082.33 total tokens/s, 24.47 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024

STDERR:
[2026-01-26 02:07:47] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 02:07:47] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:07:47] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 02:07:47] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:07:47] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:07:47] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:07:47] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:07:47] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:07:47] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:07:47] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 02:07:47] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 02:07:47] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 02:07:47] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 02:07:47] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 02:07:55] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 02:07:55] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:07:55] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 02:07:55] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:07:55] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:07:55] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:07:55] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:07:55] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:07:55] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:07:55] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 02:07:55] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 02:07:55] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 02:07:55] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 02:07:55] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=44360) [2026-01-26 02:07:56] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=44360) [2026-01-26 02:07:56] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=44360) [2026-01-26 02:07:56] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=44360) [2026-01-26 02:07:56] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=44360) [2026-01-26 02:07:56] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=44360) [2026-01-26 02:07:56] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=44360) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=44360) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.17it/s]
(EngineCore_DP0 pid=44360) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.06s/it]
(EngineCore_DP0 pid=44360) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.03s/it]
(EngineCore_DP0 pid=44360) 
(EngineCore_DP0 pid=44360) [2026-01-26 02:07:58] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 4800] -> 1D uint8
(EngineCore_DP0 pid=44360) [2026-01-26 02:07:58] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 16662528 bytes
(EngineCore_DP0 pid=44360) [2026-01-26 02:07:58] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 4800] -> 1D uint8
(EngineCore_DP0 pid=44360) [2026-01-26 02:07:58] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12959744 bytes
(EngineCore_DP0 pid=44360) [2026-01-26 02:07:58] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 4800] -> 1D uint8
(EngineCore_DP0 pid=44360) [2026-01-26 02:07:58] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 137003008 bytes
(EngineCore_DP0 pid=44360) [2026-01-26 02:07:58] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 25280] -> 1D uint8
(EngineCore_DP0 pid=44360) [2026-01-26 02:07:58] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 68009984 bytes
(EngineCore_DP0 pid=44360) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:00,  7.90it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  40%|████      | 2/5 [00:00<00:00,  8.41it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  60%|██████    | 3/5 [00:00<00:00,  8.93it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  80%|████████  | 4/5 [00:00<00:00,  9.11it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00,  8.32it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00,  8.49it/s]
(EngineCore_DP0 pid=44360) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:00,  7.32it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 2/4 [00:00<00:00,  8.51it/s]
Capturing CUDA graphs (decode, FULL):  75%|███████▌  | 3/4 [00:00<00:00,  8.51it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  8.80it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  8.58it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 24/1024 [00:00<00:04, 233.62it/s]
Adding requests:   5%|▍         | 50/1024 [00:00<00:03, 245.78it/s]
Adding requests:   8%|▊         | 78/1024 [00:00<00:03, 260.48it/s]
Adding requests:  10%|█         | 105/1024 [00:00<00:03, 262.56it/s]
Adding requests:  13%|█▎        | 132/1024 [00:00<00:03, 261.66it/s]
Adding requests:  16%|█▌        | 160/1024 [00:00<00:03, 265.43it/s]
Adding requests:  18%|█▊        | 189/1024 [00:00<00:03, 269.97it/s]
Adding requests:  21%|██        | 217/1024 [00:00<00:02, 271.64it/s]
Adding requests:  24%|██▍       | 245/1024 [00:00<00:02, 271.41it/s]
Adding requests:  27%|██▋       | 273/1024 [00:01<00:02, 268.63it/s]
Adding requests:  29%|██▉       | 302/1024 [00:01<00:02, 273.37it/s]
Adding requests:  32%|███▏      | 330/1024 [00:01<00:02, 271.34it/s]
Adding requests:  35%|███▍      | 358/1024 [00:01<00:02, 271.35it/s]
Adding requests:  38%|███▊      | 386/1024 [00:01<00:02, 273.76it/s]
Adding requests:  41%|████      | 416/1024 [00:01<00:02, 279.75it/s]
Adding requests:  43%|████▎     | 444/1024 [00:01<00:02, 268.16it/s]
Adding requests:  46%|████▋     | 474/1024 [00:01<00:01, 275.04it/s]
Adding requests:  49%|████▉     | 505/1024 [00:01<00:01, 284.63it/s]
Adding requests:  52%|█████▏    | 536/1024 [00:01<00:01, 290.01it/s]
Adding requests:  55%|█████▌    | 566/1024 [00:02<00:01, 289.68it/s]
Adding requests:  58%|█████▊    | 596/1024 [00:02<00:01, 278.37it/s]
Adding requests:  61%|██████    | 624/1024 [00:02<00:01, 270.36it/s]
Adding requests:  64%|██████▎   | 652/1024 [00:02<00:01, 269.38it/s]
Adding requests:  67%|██████▋   | 681/1024 [00:02<00:01, 274.03it/s]
Adding requests:  69%|██████▉   | 710/1024 [00:02<00:01, 278.02it/s]
Adding requests:  72%|███████▏  | 738/1024 [00:02<00:01, 272.35it/s]
Adding requests:  75%|███████▍  | 766/1024 [00:02<00:00, 272.35it/s]
Adding requests:  78%|███████▊  | 794/1024 [00:02<00:00, 272.78it/s]
Adding requests:  80%|████████  | 822/1024 [00:03<00:00, 271.02it/s]
Adding requests:  83%|████████▎ | 851/1024 [00:03<00:00, 276.33it/s]
Adding requests:  86%|████████▌ | 879/1024 [00:03<00:00, 275.29it/s]
Adding requests:  89%|████████▊ | 908/1024 [00:03<00:00, 276.36it/s]
Adding requests:  91%|█████████▏| 936/1024 [00:03<00:00, 271.00it/s]
Adding requests:  94%|█████████▍| 966/1024 [00:03<00:00, 277.57it/s]
Adding requests:  97%|█████████▋| 994/1024 [00:03<00:00, 271.37it/s]
Adding requests: 100%|█████████▉| 1022/1024 [00:03<00:00, 268.52it/s]
Adding requests: 100%|██████████| 1024/1024 [00:03<00:00, 272.27it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   9%|▉         | 90/1024 [00:00<00:04, 222.72it/s, est. speed input: 228108.56 toks/s, output: 222.74 toks/s]
Processed prompts:  11%|█         | 113/1024 [00:01<00:09, 92.45it/s, est. speed input: 110048.51 toks/s, output: 107.47 toks/s]
Processed prompts:  12%|█▏        | 125/1024 [00:01<00:16, 55.61it/s, est. speed input: 75359.51 toks/s, output: 73.59 toks/s]  
Processed prompts:  13%|█▎        | 132/1024 [00:02<00:19, 46.69it/s, est. speed input: 66846.73 toks/s, output: 65.28 toks/s]
Processed prompts:  13%|█▎        | 138/1024 [00:02<00:22, 39.01it/s, est. speed input: 60240.79 toks/s, output: 58.83 toks/s]
Processed prompts:  14%|█▍        | 146/1024 [00:02<00:25, 34.99it/s, est. speed input: 55997.50 toks/s, output: 54.68 toks/s]
Processed prompts:  15%|█▌        | 154/1024 [00:02<00:27, 32.03it/s, est. speed input: 52666.22 toks/s, output: 51.43 toks/s]
Processed prompts:  16%|█▌        | 162/1024 [00:03<00:28, 29.91it/s, est. speed input: 49994.84 toks/s, output: 48.82 toks/s]
Processed prompts:  17%|█▋        | 170/1024 [00:03<00:30, 28.37it/s, est. speed input: 47795.11 toks/s, output: 46.67 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [00:03<00:30, 27.29it/s, est. speed input: 45958.67 toks/s, output: 44.88 toks/s]
Processed prompts:  18%|█▊        | 186/1024 [00:04<00:31, 26.51it/s, est. speed input: 44394.42 toks/s, output: 43.35 toks/s]
Processed prompts:  19%|█▉        | 194/1024 [00:04<00:31, 25.97it/s, est. speed input: 43052.54 toks/s, output: 42.04 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [00:04<00:31, 26.34it/s, est. speed input: 42149.97 toks/s, output: 41.16 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:05<00:31, 25.83it/s, est. speed input: 41101.91 toks/s, output: 40.14 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [00:05<00:31, 25.47it/s, est. speed input: 40177.10 toks/s, output: 39.24 toks/s]
Processed prompts:  22%|██▏       | 226/1024 [00:05<00:31, 25.22it/s, est. speed input: 39352.27 toks/s, output: 38.43 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:06<00:31, 25.04it/s, est. speed input: 38611.38 toks/s, output: 37.71 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:06<00:31, 24.93it/s, est. speed input: 37949.40 toks/s, output: 37.06 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:06<00:31, 24.84it/s, est. speed input: 37347.69 toks/s, output: 36.47 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:07<00:30, 24.78it/s, est. speed input: 36798.99 toks/s, output: 35.94 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:07<00:30, 24.73it/s, est. speed input: 36295.85 toks/s, output: 35.45 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:07<00:30, 24.71it/s, est. speed input: 35838.06 toks/s, output: 35.00 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:08<00:30, 24.68it/s, est. speed input: 35415.30 toks/s, output: 34.59 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:08<00:29, 24.66it/s, est. speed input: 35023.71 toks/s, output: 34.20 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:08<00:29, 24.65it/s, est. speed input: 34661.56 toks/s, output: 33.85 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:09<00:29, 24.65it/s, est. speed input: 34326.79 toks/s, output: 33.52 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:09<00:28, 24.63it/s, est. speed input: 34011.91 toks/s, output: 33.21 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:09<00:28, 24.62it/s, est. speed input: 33718.92 toks/s, output: 32.93 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:10<00:28, 24.61it/s, est. speed input: 33443.26 toks/s, output: 32.66 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:10<00:27, 24.60it/s, est. speed input: 33185.33 toks/s, output: 32.41 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:10<00:27, 24.60it/s, est. speed input: 32942.52 toks/s, output: 32.17 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:11<00:27, 24.60it/s, est. speed input: 32715.42 toks/s, output: 31.95 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:11<00:26, 24.58it/s, est. speed input: 32499.00 toks/s, output: 31.74 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:11<00:26, 24.59it/s, est. speed input: 32296.00 toks/s, output: 31.54 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:12<00:26, 24.59it/s, est. speed input: 32104.07 toks/s, output: 31.35 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:12<00:25, 24.58it/s, est. speed input: 31921.07 toks/s, output: 31.17 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [00:12<00:25, 24.59it/s, est. speed input: 31748.93 toks/s, output: 31.00 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:13<00:25, 24.58it/s, est. speed input: 31584.39 toks/s, output: 30.84 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:13<00:24, 24.57it/s, est. speed input: 31426.70 toks/s, output: 30.69 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:13<00:24, 24.56it/s, est. speed input: 31277.35 toks/s, output: 30.54 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:14<00:24, 24.56it/s, est. speed input: 31134.08 toks/s, output: 30.40 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:14<00:24, 24.56it/s, est. speed input: 30998.50 toks/s, output: 30.27 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:14<00:23, 24.55it/s, est. speed input: 30867.52 toks/s, output: 30.14 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:14<00:23, 24.54it/s, est. speed input: 30742.37 toks/s, output: 30.02 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:15<00:23, 24.55it/s, est. speed input: 30623.14 toks/s, output: 29.91 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:15<00:22, 24.55it/s, est. speed input: 30509.28 toks/s, output: 29.79 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:15<00:22, 24.54it/s, est. speed input: 30398.93 toks/s, output: 29.69 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:16<00:22, 24.54it/s, est. speed input: 30293.93 toks/s, output: 29.58 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:16<00:21, 24.54it/s, est. speed input: 30192.31 toks/s, output: 29.48 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:16<00:21, 24.53it/s, est. speed input: 30094.33 toks/s, output: 29.39 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:17<00:21, 24.53it/s, est. speed input: 30000.32 toks/s, output: 29.30 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:17<00:20, 24.53it/s, est. speed input: 29910.08 toks/s, output: 29.21 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:17<00:20, 24.53it/s, est. speed input: 29822.68 toks/s, output: 29.12 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:18<00:20, 24.53it/s, est. speed input: 29738.19 toks/s, output: 29.04 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:18<00:19, 24.51it/s, est. speed input: 29656.06 toks/s, output: 28.96 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:18<00:19, 24.53it/s, est. speed input: 29578.33 toks/s, output: 28.89 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:19<00:19, 24.52it/s, est. speed input: 29502.44 toks/s, output: 28.81 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:19<00:18, 24.52it/s, est. speed input: 29429.09 toks/s, output: 28.74 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:19<00:18, 24.51it/s, est. speed input: 29357.52 toks/s, output: 28.67 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:20<00:18, 24.51it/s, est. speed input: 29288.62 toks/s, output: 28.60 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:20<00:17, 24.51it/s, est. speed input: 29222.31 toks/s, output: 28.54 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:20<00:17, 24.52it/s, est. speed input: 29157.90 toks/s, output: 28.47 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:21<00:07, 52.81it/s, est. speed input: 30608.60 toks/s, output: 29.89 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:21<00:08, 44.44it/s, est. speed input: 30524.96 toks/s, output: 29.81 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:21<00:09, 38.53it/s, est. speed input: 30444.28 toks/s, output: 29.73 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:22<00:10, 34.35it/s, est. speed input: 30365.33 toks/s, output: 29.65 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:22<00:11, 31.41it/s, est. speed input: 30289.21 toks/s, output: 29.58 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:22<00:11, 29.36it/s, est. speed input: 30215.30 toks/s, output: 29.51 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:23<00:12, 27.90it/s, est. speed input: 30142.81 toks/s, output: 29.44 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:23<00:12, 26.89it/s, est. speed input: 30073.23 toks/s, output: 29.37 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:23<00:12, 26.18it/s, est. speed input: 30005.17 toks/s, output: 29.30 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:24<00:12, 25.69it/s, est. speed input: 29939.28 toks/s, output: 29.24 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:24<00:12, 25.33it/s, est. speed input: 29874.52 toks/s, output: 29.17 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:24<00:12, 25.08it/s, est. speed input: 29811.21 toks/s, output: 29.11 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:25<00:11, 24.91it/s, est. speed input: 29750.01 toks/s, output: 29.05 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:25<00:11, 24.78it/s, est. speed input: 29690.11 toks/s, output: 28.99 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:25<00:11, 24.71it/s, est. speed input: 29632.40 toks/s, output: 28.94 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:26<00:10, 24.66it/s, est. speed input: 29576.10 toks/s, output: 28.88 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:26<00:10, 24.61it/s, est. speed input: 29520.86 toks/s, output: 28.83 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:26<00:10, 24.58it/s, est. speed input: 29466.89 toks/s, output: 28.78 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:27<00:10, 24.57it/s, est. speed input: 29414.64 toks/s, output: 28.73 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:27<00:09, 25.33it/s, est. speed input: 29399.29 toks/s, output: 28.71 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:27<00:09, 25.08it/s, est. speed input: 29348.48 toks/s, output: 28.66 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:28<00:08, 24.90it/s, est. speed input: 29298.72 toks/s, output: 28.61 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:28<00:08, 24.79it/s, est. speed input: 29250.71 toks/s, output: 28.56 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:28<00:08, 24.71it/s, est. speed input: 29203.57 toks/s, output: 28.52 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:29<00:08, 24.66it/s, est. speed input: 29157.97 toks/s, output: 28.47 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:29<00:07, 24.62it/s, est. speed input: 29113.11 toks/s, output: 28.43 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [00:29<00:07, 24.57it/s, est. speed input: 29068.19 toks/s, output: 28.39 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [00:29<00:07, 24.56it/s, est. speed input: 29025.24 toks/s, output: 28.34 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:30<00:06, 24.55it/s, est. speed input: 28983.18 toks/s, output: 28.30 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [00:30<00:06, 24.54it/s, est. speed input: 28941.87 toks/s, output: 28.26 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [00:30<00:06, 24.54it/s, est. speed input: 28901.60 toks/s, output: 28.22 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [00:31<00:05, 24.53it/s, est. speed input: 28861.89 toks/s, output: 28.19 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [00:31<00:05, 24.54it/s, est. speed input: 28823.52 toks/s, output: 28.15 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [00:31<00:05, 24.53it/s, est. speed input: 28785.36 toks/s, output: 28.11 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [00:32<00:04, 24.52it/s, est. speed input: 28747.96 toks/s, output: 28.07 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [00:32<00:04, 24.51it/s, est. speed input: 28711.22 toks/s, output: 28.04 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [00:32<00:04, 24.52it/s, est. speed input: 28675.73 toks/s, output: 28.00 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [00:33<00:03, 24.52it/s, est. speed input: 28640.66 toks/s, output: 27.97 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [00:33<00:03, 24.51it/s, est. speed input: 28606.12 toks/s, output: 27.94 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [00:33<00:03, 24.51it/s, est. speed input: 28572.29 toks/s, output: 27.90 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [00:34<00:02, 24.51it/s, est. speed input: 28539.27 toks/s, output: 27.87 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [00:34<00:02, 24.50it/s, est. speed input: 28506.49 toks/s, output: 27.84 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [00:34<00:02, 24.51it/s, est. speed input: 28474.72 toks/s, output: 27.81 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [00:35<00:01, 24.50it/s, est. speed input: 28443.17 toks/s, output: 27.78 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [00:35<00:01, 24.50it/s, est. speed input: 28412.31 toks/s, output: 27.75 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [00:35<00:01, 24.50it/s, est. speed input: 28382.14 toks/s, output: 27.72 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [00:36<00:00, 24.50it/s, est. speed input: 28352.43 toks/s, output: 27.69 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [00:36<00:00, 24.51it/s, est. speed input: 28323.59 toks/s, output: 27.66 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [00:36<00:00, 25.44it/s, est. speed input: 28325.38 toks/s, output: 27.66 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:36<00:00, 25.44it/s, est. speed input: 28492.11 toks/s, output: 27.82 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:36<00:00, 27.82it/s, est. speed input: 28492.11 toks/s, output: 27.82 toks/s]
[rank0]:[W126 02:09:00.867207997 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=16384 ==========
Time: 2026-01-26 02:09:02
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=2048, max_num_seqs=16
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 2048 --max-num-seqs 16 --max-model-len 1025 --max-num-batched-tokens 16384 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Qwen2.5-7B-INT8_M16384.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 02:09:23 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 02:09:24 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=45941) WARNING 01-26 02:09:32 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=45941) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=45941) WARNING 01-26 02:09:44 [backends.py:609] Failed to read file <frozen os>
Throughput: 24.47 requests/s, 25085.41 total tokens/s, 24.47 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048

STDERR:
[2026-01-26 02:09:23] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 02:09:23] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:09:23] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 02:09:23] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:09:23] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:09:23] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:09:23] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:09:23] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:09:23] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:09:23] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 02:09:23] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 02:09:23] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 02:09:23] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 02:09:23] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 02:09:31] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 02:09:31] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:09:31] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 02:09:31] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:09:31] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:09:31] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:09:31] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:09:31] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:09:31] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:09:31] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 02:09:31] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 02:09:31] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 02:09:31] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 02:09:31] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=45941) [2026-01-26 02:09:32] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=45941) [2026-01-26 02:09:32] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=45941) [2026-01-26 02:09:32] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=45941) [2026-01-26 02:09:32] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=45941) [2026-01-26 02:09:32] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=45941) [2026-01-26 02:09:32] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=45941) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=45941) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.19it/s]
(EngineCore_DP0 pid=45941) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.07s/it]
(EngineCore_DP0 pid=45941) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.04s/it]
(EngineCore_DP0 pid=45941) 
(EngineCore_DP0 pid=45941) [2026-01-26 02:09:35] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 4800] -> 1D uint8
(EngineCore_DP0 pid=45941) [2026-01-26 02:09:35] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 16662528 bytes
(EngineCore_DP0 pid=45941) [2026-01-26 02:09:35] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 4800] -> 1D uint8
(EngineCore_DP0 pid=45941) [2026-01-26 02:09:35] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12959744 bytes
(EngineCore_DP0 pid=45941) [2026-01-26 02:09:35] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 4800] -> 1D uint8
(EngineCore_DP0 pid=45941) [2026-01-26 02:09:35] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 137003008 bytes
(EngineCore_DP0 pid=45941) [2026-01-26 02:09:35] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 25280] -> 1D uint8
(EngineCore_DP0 pid=45941) [2026-01-26 02:09:35] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 68009984 bytes
(EngineCore_DP0 pid=45941) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  14%|█▍        | 1/7 [00:00<00:00,  8.05it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  29%|██▊       | 2/7 [00:00<00:00,  8.36it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  43%|████▎     | 3/7 [00:00<00:00,  8.70it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  57%|█████▋    | 4/7 [00:00<00:00,  8.91it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  71%|███████▏  | 5/7 [00:00<00:00,  8.96it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  86%|████████▌ | 6/7 [00:00<00:00,  8.76it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00,  7.93it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00,  8.35it/s]
(EngineCore_DP0 pid=45941) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  20%|██        | 1/5 [00:00<00:00,  7.13it/s]
Capturing CUDA graphs (decode, FULL):  40%|████      | 2/5 [00:00<00:00,  8.28it/s]
Capturing CUDA graphs (decode, FULL):  60%|██████    | 3/5 [00:00<00:00,  8.71it/s]
Capturing CUDA graphs (decode, FULL):  80%|████████  | 4/5 [00:00<00:00,  8.93it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00,  9.06it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00,  8.77it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   1%|          | 25/2048 [00:00<00:08, 241.35it/s]
Adding requests:   2%|▏         | 51/2048 [00:00<00:07, 251.64it/s]
Adding requests:   4%|▍         | 78/2048 [00:00<00:07, 256.97it/s]
Adding requests:   5%|▌         | 104/2048 [00:00<00:07, 254.09it/s]
Adding requests:   6%|▋         | 131/2048 [00:00<00:07, 256.70it/s]
Adding requests:   8%|▊         | 158/2048 [00:00<00:07, 260.51it/s]
Adding requests:   9%|▉         | 186/2048 [00:00<00:06, 266.66it/s]
Adding requests:  10%|█         | 213/2048 [00:00<00:06, 266.26it/s]
Adding requests:  12%|█▏        | 240/2048 [00:00<00:06, 265.23it/s]
Adding requests:  13%|█▎        | 267/2048 [00:01<00:06, 262.30it/s]
Adding requests:  14%|█▍        | 295/2048 [00:01<00:06, 265.96it/s]
Adding requests:  16%|█▌        | 324/2048 [00:01<00:06, 272.21it/s]
Adding requests:  17%|█▋        | 353/2048 [00:01<00:06, 277.24it/s]
Adding requests:  19%|█▊        | 381/2048 [00:01<00:06, 276.05it/s]
Adding requests:  20%|██        | 410/2048 [00:01<00:05, 278.38it/s]
Adding requests:  21%|██▏       | 438/2048 [00:01<00:05, 276.96it/s]
Adding requests:  23%|██▎       | 466/2048 [00:01<00:05, 275.49it/s]
Adding requests:  24%|██▍       | 497/2048 [00:01<00:05, 282.91it/s]
Adding requests:  26%|██▌       | 529/2048 [00:01<00:05, 290.45it/s]
Adding requests:  27%|██▋       | 559/2048 [00:02<00:05, 287.94it/s]
Adding requests:  29%|██▊       | 588/2048 [00:02<00:05, 281.16it/s]
Adding requests:  30%|███       | 617/2048 [00:02<00:05, 277.05it/s]
Adding requests:  31%|███▏      | 645/2048 [00:02<00:05, 272.83it/s]
Adding requests:  33%|███▎      | 673/2048 [00:02<00:05, 266.42it/s]
Adding requests:  34%|███▍      | 702/2048 [00:02<00:04, 271.94it/s]
Adding requests:  36%|███▌      | 730/2048 [00:02<00:04, 268.91it/s]
Adding requests:  37%|███▋      | 758/2048 [00:02<00:04, 270.05it/s]
Adding requests:  38%|███▊      | 786/2048 [00:02<00:04, 272.67it/s]
Adding requests:  40%|███▉      | 814/2048 [00:03<00:04, 267.72it/s]
Adding requests:  41%|████      | 843/2048 [00:03<00:04, 273.99it/s]
Adding requests:  43%|████▎     | 871/2048 [00:03<00:04, 271.08it/s]
Adding requests:  44%|████▍     | 899/2048 [00:03<00:04, 272.70it/s]
Adding requests:  45%|████▌     | 927/2048 [00:03<00:04, 268.20it/s]
Adding requests:  47%|████▋     | 955/2048 [00:03<00:04, 270.37it/s]
Adding requests:  48%|████▊     | 983/2048 [00:03<00:03, 266.38it/s]
Adding requests:  49%|████▉     | 1010/2048 [00:03<00:03, 261.60it/s]
Adding requests:  51%|█████     | 1037/2048 [00:03<00:03, 261.88it/s]
Adding requests:  52%|█████▏    | 1064/2048 [00:03<00:03, 261.15it/s]
Adding requests:  53%|█████▎    | 1091/2048 [00:04<00:03, 259.89it/s]
Adding requests:  55%|█████▍    | 1119/2048 [00:04<00:03, 262.65it/s]
Adding requests:  56%|█████▌    | 1148/2048 [00:04<00:03, 267.43it/s]
Adding requests:  57%|█████▋    | 1176/2048 [00:04<00:03, 269.37it/s]
Adding requests:  59%|█████▉    | 1204/2048 [00:04<00:03, 270.44it/s]
Adding requests:  60%|██████    | 1232/2048 [00:04<00:02, 272.81it/s]
Adding requests:  62%|██████▏   | 1260/2048 [00:04<00:02, 271.39it/s]
Adding requests:  63%|██████▎   | 1288/2048 [00:04<00:02, 266.78it/s]
Adding requests:  64%|██████▍   | 1316/2048 [00:04<00:02, 269.49it/s]
Adding requests:  66%|██████▌   | 1344/2048 [00:04<00:02, 269.88it/s]
Adding requests:  67%|██████▋   | 1374/2048 [00:05<00:02, 276.44it/s]
Adding requests:  68%|██████▊   | 1402/2048 [00:05<00:02, 274.23it/s]
Adding requests:  70%|██████▉   | 1430/2048 [00:05<00:02, 274.09it/s]
Adding requests:  71%|███████   | 1458/2048 [00:05<00:02, 273.62it/s]
Adding requests:  73%|███████▎  | 1487/2048 [00:05<00:02, 276.30it/s]
Adding requests:  74%|███████▍  | 1515/2048 [00:05<00:01, 275.25it/s]
Adding requests:  75%|███████▌  | 1543/2048 [00:05<00:01, 270.63it/s]
Adding requests:  77%|███████▋  | 1571/2048 [00:05<00:01, 263.08it/s]
Adding requests:  78%|███████▊  | 1598/2048 [00:05<00:01, 264.58it/s]
Adding requests:  79%|███████▉  | 1625/2048 [00:06<00:01, 263.31it/s]
Adding requests:  81%|████████  | 1652/2048 [00:06<00:01, 261.64it/s]
Adding requests:  82%|████████▏ | 1679/2048 [00:06<00:01, 261.78it/s]
Adding requests:  83%|████████▎ | 1708/2048 [00:06<00:01, 269.12it/s]
Adding requests:  85%|████████▍ | 1735/2048 [00:06<00:01, 267.06it/s]
Adding requests:  86%|████████▌ | 1764/2048 [00:06<00:01, 273.78it/s]
Adding requests:  88%|████████▊ | 1792/2048 [00:06<00:00, 272.97it/s]
Adding requests:  89%|████████▉ | 1820/2048 [00:06<00:00, 270.12it/s]
Adding requests:  90%|█████████ | 1848/2048 [00:06<00:00, 265.58it/s]
Adding requests:  92%|█████████▏| 1876/2048 [00:06<00:00, 268.84it/s]
Adding requests:  93%|█████████▎| 1904/2048 [00:07<00:00, 270.05it/s]
Adding requests:  94%|█████████▍| 1933/2048 [00:07<00:00, 275.18it/s]
Adding requests:  96%|█████████▌| 1961/2048 [00:07<00:00, 274.64it/s]
Adding requests:  97%|█████████▋| 1989/2048 [00:07<00:00, 274.45it/s]
Adding requests:  98%|█████████▊| 2017/2048 [00:07<00:00, 266.31it/s]
Adding requests: 100%|█████████▉| 2044/2048 [00:07<00:00, 258.80it/s]
Adding requests: 100%|██████████| 2048/2048 [00:07<00:00, 269.25it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   9%|▊         | 178/2048 [00:00<00:04, 400.50it/s, est. speed input: 410146.79 toks/s, output: 400.51 toks/s]
Processed prompts:  11%|█         | 219/2048 [00:01<00:17, 103.00it/s, est. speed input: 128797.22 toks/s, output: 125.78 toks/s]
Processed prompts:  12%|█▏        | 238/2048 [00:02<00:23, 76.04it/s, est. speed input: 101971.12 toks/s, output: 99.58 toks/s]  
Processed prompts:  12%|█▏        | 250/2048 [00:03<00:31, 56.30it/s, est. speed input: 84248.49 toks/s, output: 82.27 toks/s] 
Processed prompts:  13%|█▎        | 258/2048 [00:03<00:42, 41.83it/s, est. speed input: 71644.70 toks/s, output: 69.97 toks/s]
Processed prompts:  13%|█▎        | 274/2048 [00:04<00:48, 36.34it/s, est. speed input: 64701.05 toks/s, output: 63.18 toks/s]
Processed prompts:  14%|█▍        | 290/2048 [00:04<00:53, 32.67it/s, est. speed input: 59558.74 toks/s, output: 58.16 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [00:05<00:57, 30.18it/s, est. speed input: 55599.91 toks/s, output: 54.30 toks/s]
Processed prompts:  16%|█▌        | 322/2048 [00:06<01:00, 28.48it/s, est. speed input: 52459.38 toks/s, output: 51.23 toks/s]
Processed prompts:  17%|█▋        | 338/2048 [00:06<01:02, 27.30it/s, est. speed input: 49904.44 toks/s, output: 48.73 toks/s]
Processed prompts:  17%|█▋        | 354/2048 [00:07<01:03, 26.48it/s, est. speed input: 47787.41 toks/s, output: 46.67 toks/s]
Processed prompts:  18%|█▊        | 370/2048 [00:08<01:04, 25.91it/s, est. speed input: 46002.97 toks/s, output: 44.92 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [00:08<01:05, 25.51it/s, est. speed input: 44478.49 toks/s, output: 43.44 toks/s]
Processed prompts:  20%|█▉        | 402/2048 [00:09<01:05, 25.24it/s, est. speed input: 43164.77 toks/s, output: 42.15 toks/s]
Processed prompts:  20%|██        | 418/2048 [00:10<01:05, 25.03it/s, est. speed input: 42011.58 toks/s, output: 41.03 toks/s]
Processed prompts:  21%|██        | 434/2048 [00:10<01:05, 24.82it/s, est. speed input: 40975.02 toks/s, output: 40.01 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [00:11<01:04, 24.75it/s, est. speed input: 40078.92 toks/s, output: 39.14 toks/s]
Processed prompts:  23%|██▎       | 466/2048 [00:12<01:04, 24.69it/s, est. speed input: 39279.40 toks/s, output: 38.36 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [00:12<01:03, 24.65it/s, est. speed input: 38560.30 toks/s, output: 37.66 toks/s]
Processed prompts:  24%|██▍       | 498/2048 [00:13<01:02, 24.63it/s, est. speed input: 37910.83 toks/s, output: 37.02 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [00:14<00:38, 38.99it/s, est. speed input: 39589.18 toks/s, output: 38.66 toks/s]
Processed prompts:  27%|██▋       | 562/2048 [00:14<00:42, 34.68it/s, est. speed input: 38951.22 toks/s, output: 38.04 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [00:15<00:46, 31.65it/s, est. speed input: 38367.30 toks/s, output: 37.47 toks/s]
Processed prompts:  29%|██▉       | 594/2048 [00:16<00:49, 29.52it/s, est. speed input: 37830.15 toks/s, output: 36.94 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [00:16<00:51, 28.03it/s, est. speed input: 37334.81 toks/s, output: 36.46 toks/s]
Processed prompts:  31%|███       | 626/2048 [00:17<00:52, 26.98it/s, est. speed input: 36877.03 toks/s, output: 36.01 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [00:18<00:53, 26.24it/s, est. speed input: 36451.22 toks/s, output: 35.60 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [00:18<00:54, 25.73it/s, est. speed input: 36054.87 toks/s, output: 35.21 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [00:19<00:54, 25.37it/s, est. speed input: 35686.47 toks/s, output: 34.85 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [00:19<00:54, 25.11it/s, est. speed input: 35341.05 toks/s, output: 34.51 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [00:20<00:53, 24.94it/s, est. speed input: 35017.54 toks/s, output: 34.20 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [00:21<00:53, 24.81it/s, est. speed input: 34713.52 toks/s, output: 33.90 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [00:21<00:52, 24.72it/s, est. speed input: 34427.60 toks/s, output: 33.62 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [00:22<00:52, 24.66it/s, est. speed input: 34158.59 toks/s, output: 33.36 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [00:23<00:51, 24.62it/s, est. speed input: 33904.67 toks/s, output: 33.11 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [00:23<00:50, 24.98it/s, est. speed input: 33712.16 toks/s, output: 32.92 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [00:24<00:50, 24.83it/s, est. speed input: 33482.78 toks/s, output: 32.70 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [00:25<00:49, 24.73it/s, est. speed input: 33264.45 toks/s, output: 32.48 toks/s]
Processed prompts:  41%|████      | 834/2048 [00:25<00:49, 24.66it/s, est. speed input: 33057.59 toks/s, output: 32.28 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [00:26<00:48, 24.61it/s, est. speed input: 32860.83 toks/s, output: 32.09 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [00:27<00:48, 24.58it/s, est. speed input: 32674.10 toks/s, output: 31.91 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [00:27<00:47, 24.55it/s, est. speed input: 32495.65 toks/s, output: 31.73 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [00:28<00:46, 24.54it/s, est. speed input: 32325.45 toks/s, output: 31.57 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [00:29<00:46, 24.52it/s, est. speed input: 32162.97 toks/s, output: 31.41 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [00:29<00:45, 24.52it/s, est. speed input: 32007.91 toks/s, output: 31.26 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [00:30<00:44, 24.53it/s, est. speed input: 31860.39 toks/s, output: 31.11 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [00:31<00:44, 24.51it/s, est. speed input: 31717.03 toks/s, output: 30.97 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [00:31<00:43, 24.51it/s, est. speed input: 31580.96 toks/s, output: 30.84 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [00:32<00:43, 24.50it/s, est. speed input: 31449.54 toks/s, output: 30.71 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [00:33<00:42, 24.50it/s, est. speed input: 31323.72 toks/s, output: 30.59 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [00:33<00:41, 24.50it/s, est. speed input: 31203.00 toks/s, output: 30.47 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [00:34<00:41, 24.50it/s, est. speed input: 31086.75 toks/s, output: 30.36 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [00:34<00:40, 24.51it/s, est. speed input: 30975.17 toks/s, output: 30.25 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [00:35<00:39, 24.51it/s, est. speed input: 30867.30 toks/s, output: 30.14 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [00:36<00:39, 24.51it/s, est. speed input: 30763.42 toks/s, output: 30.04 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [00:36<00:38, 24.50it/s, est. speed input: 30663.05 toks/s, output: 29.94 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [00:37<00:37, 24.50it/s, est. speed input: 30566.00 toks/s, output: 29.85 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [00:38<00:37, 24.49it/s, est. speed input: 30472.02 toks/s, output: 29.76 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [00:38<00:36, 24.49it/s, est. speed input: 30381.16 toks/s, output: 29.67 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [00:39<00:35, 24.49it/s, est. speed input: 30293.31 toks/s, output: 29.58 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [00:40<00:35, 24.49it/s, est. speed input: 30208.50 toks/s, output: 29.50 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [00:40<00:34, 24.49it/s, est. speed input: 30126.60 toks/s, output: 29.42 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [00:41<00:33, 24.49it/s, est. speed input: 30046.91 toks/s, output: 29.34 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [00:42<00:33, 24.49it/s, est. speed input: 29969.89 toks/s, output: 29.27 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [00:42<00:32, 24.49it/s, est. speed input: 29895.42 toks/s, output: 29.19 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [00:43<00:31, 24.49it/s, est. speed input: 29822.95 toks/s, output: 29.12 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [00:44<00:31, 24.49it/s, est. speed input: 29752.41 toks/s, output: 29.06 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [00:44<00:30, 24.49it/s, est. speed input: 29684.33 toks/s, output: 28.99 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [00:45<00:17, 39.02it/s, est. speed input: 30333.38 toks/s, output: 29.62 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [00:46<00:19, 34.69it/s, est. speed input: 30259.68 toks/s, output: 29.55 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [00:46<00:21, 31.63it/s, est. speed input: 30186.73 toks/s, output: 29.48 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [00:47<00:22, 29.49it/s, est. speed input: 30116.30 toks/s, output: 29.41 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [00:48<00:22, 27.99it/s, est. speed input: 30047.94 toks/s, output: 29.34 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [00:48<00:23, 26.95it/s, est. speed input: 29981.45 toks/s, output: 29.28 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [00:49<00:23, 26.21it/s, est. speed input: 29916.74 toks/s, output: 29.22 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [00:50<00:22, 25.70it/s, est. speed input: 29853.66 toks/s, output: 29.15 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [00:50<00:22, 25.34it/s, est. speed input: 29792.04 toks/s, output: 29.09 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [00:51<00:22, 25.08it/s, est. speed input: 29732.16 toks/s, output: 29.04 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [00:51<00:21, 24.91it/s, est. speed input: 29673.59 toks/s, output: 28.98 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [00:52<00:21, 24.78it/s, est. speed input: 29616.51 toks/s, output: 28.92 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [00:53<00:20, 24.68it/s, est. speed input: 29560.15 toks/s, output: 28.87 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [00:53<00:20, 24.61it/s, est. speed input: 29505.13 toks/s, output: 28.81 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [00:54<00:19, 24.56it/s, est. speed input: 29451.57 toks/s, output: 28.76 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [00:55<00:18, 24.53it/s, est. speed input: 29399.20 toks/s, output: 28.71 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [00:55<00:18, 24.50it/s, est. speed input: 29348.08 toks/s, output: 28.66 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [00:56<00:17, 24.88it/s, est. speed input: 29316.28 toks/s, output: 28.63 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [00:57<00:16, 24.75it/s, est. speed input: 29267.07 toks/s, output: 28.58 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [00:57<00:16, 24.66it/s, est. speed input: 29219.33 toks/s, output: 28.53 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [00:58<00:15, 24.60it/s, est. speed input: 29172.49 toks/s, output: 28.49 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [00:59<00:14, 24.55it/s, est. speed input: 29126.67 toks/s, output: 28.44 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [00:59<00:14, 24.52it/s, est. speed input: 29081.91 toks/s, output: 28.40 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [01:00<00:13, 24.50it/s, est. speed input: 29038.15 toks/s, output: 28.36 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [01:01<00:12, 24.50it/s, est. speed input: 28995.82 toks/s, output: 28.32 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [01:01<00:12, 24.49it/s, est. speed input: 28954.24 toks/s, output: 28.28 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [01:02<00:11, 24.49it/s, est. speed input: 28913.72 toks/s, output: 28.24 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [01:03<00:11, 24.50it/s, est. speed input: 28874.47 toks/s, output: 28.20 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [01:03<00:10, 24.49it/s, est. speed input: 28834.98 toks/s, output: 28.16 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [01:04<00:09, 24.49it/s, est. speed input: 28796.95 toks/s, output: 28.12 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [01:05<00:09, 24.49it/s, est. speed input: 28759.57 toks/s, output: 28.09 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [01:05<00:08, 24.49it/s, est. speed input: 28722.89 toks/s, output: 28.05 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [01:06<00:07, 24.49it/s, est. speed input: 28686.88 toks/s, output: 28.01 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [01:06<00:07, 24.49it/s, est. speed input: 28651.80 toks/s, output: 27.98 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [01:07<00:06, 24.49it/s, est. speed input: 28617.24 toks/s, output: 27.95 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [01:08<00:05, 24.49it/s, est. speed input: 28583.40 toks/s, output: 27.91 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [01:08<00:05, 24.47it/s, est. speed input: 28549.41 toks/s, output: 27.88 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [01:09<00:04, 24.43it/s, est. speed input: 28515.32 toks/s, output: 27.85 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [01:10<00:03, 24.41it/s, est. speed input: 28481.92 toks/s, output: 27.81 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [01:10<00:03, 24.40it/s, est. speed input: 28449.19 toks/s, output: 27.78 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [01:11<00:02, 24.38it/s, est. speed input: 28416.97 toks/s, output: 27.75 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [01:12<00:01, 24.38it/s, est. speed input: 28385.37 toks/s, output: 27.72 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [01:12<00:01, 24.37it/s, est. speed input: 28354.44 toks/s, output: 27.69 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [01:13<00:00, 24.85it/s, est. speed input: 28340.32 toks/s, output: 27.68 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [01:13<00:00, 24.85it/s, est. speed input: 28535.24 toks/s, output: 27.87 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [01:13<00:00, 27.87it/s, est. speed input: 28535.24 toks/s, output: 27.87 toks/s]
[rank0]:[W126 02:11:17.330381101 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=32768 ==========
Time: 2026-01-26 02:11:20
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=4096, max_num_seqs=32
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 4096 --max-num-seqs 32 --max-model-len 1025 --max-num-batched-tokens 32768 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Qwen2.5-7B-INT8_M32768.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 02:11:54 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 02:11:55 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=48331) WARNING 01-26 02:12:02 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=48331) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=48331) WARNING 01-26 02:12:15 [backends.py:609] Failed to read file <frozen os>
Throughput: 6.39 requests/s, 6544.83 total tokens/s, 6.39 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096

STDERR:
[2026-01-26 02:11:54] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 02:11:54] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:11:54] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 02:11:54] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:11:54] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:11:54] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:11:54] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:11:54] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:11:54] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:11:54] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 02:11:54] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 02:11:54] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 02:11:54] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 02:11:54] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 02:12:02] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 02:12:02] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:12:02] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 02:12:02] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:12:02] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:12:02] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:12:02] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:12:02] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:12:02] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:12:02] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 02:12:02] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 02:12:02] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 02:12:02] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 02:12:02] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=48331) [2026-01-26 02:12:03] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=48331) [2026-01-26 02:12:03] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=48331) [2026-01-26 02:12:03] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=48331) [2026-01-26 02:12:03] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=48331) [2026-01-26 02:12:03] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=48331) [2026-01-26 02:12:03] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=48331) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=48331) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.17it/s]
(EngineCore_DP0 pid=48331) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.10s/it]
(EngineCore_DP0 pid=48331) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.06s/it]
(EngineCore_DP0 pid=48331) 
(EngineCore_DP0 pid=48331) [2026-01-26 02:12:06] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 4800] -> 1D uint8
(EngineCore_DP0 pid=48331) [2026-01-26 02:12:06] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 16662528 bytes
(EngineCore_DP0 pid=48331) [2026-01-26 02:12:06] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 4800] -> 1D uint8
(EngineCore_DP0 pid=48331) [2026-01-26 02:12:06] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12959744 bytes
(EngineCore_DP0 pid=48331) [2026-01-26 02:12:06] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 4800] -> 1D uint8
(EngineCore_DP0 pid=48331) [2026-01-26 02:12:06] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 137003008 bytes
(EngineCore_DP0 pid=48331) [2026-01-26 02:12:06] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 25280] -> 1D uint8
(EngineCore_DP0 pid=48331) [2026-01-26 02:12:06] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 68009984 bytes
(EngineCore_DP0 pid=48331) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   9%|▉         | 1/11 [00:00<00:01,  8.10it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  18%|█▊        | 2/11 [00:00<00:01,  8.45it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  27%|██▋       | 3/11 [00:00<00:00,  8.69it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  36%|███▋      | 4/11 [00:00<00:00,  8.91it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  45%|████▌     | 5/11 [00:00<00:00,  8.91it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  55%|█████▍    | 6/11 [00:00<00:00,  8.97it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  64%|██████▎   | 7/11 [00:00<00:00,  8.94it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  73%|███████▎  | 8/11 [00:00<00:00,  8.99it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  82%|████████▏ | 9/11 [00:01<00:00,  9.00it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  91%|█████████ | 10/11 [00:01<00:00,  8.98it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00,  8.25it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00,  8.67it/s]
(EngineCore_DP0 pid=48331) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  14%|█▍        | 1/7 [00:00<00:00,  7.36it/s]
Capturing CUDA graphs (decode, FULL):  29%|██▊       | 2/7 [00:00<00:00,  8.39it/s]
Capturing CUDA graphs (decode, FULL):  43%|████▎     | 3/7 [00:00<00:00,  8.87it/s]
Capturing CUDA graphs (decode, FULL):  57%|█████▋    | 4/7 [00:00<00:00,  9.07it/s]
Capturing CUDA graphs (decode, FULL):  71%|███████▏  | 5/7 [00:00<00:00,  9.14it/s]
Capturing CUDA graphs (decode, FULL):  86%|████████▌ | 6/7 [00:00<00:00,  9.24it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00,  9.14it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00,  8.97it/s]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   1%|          | 25/4096 [00:00<00:16, 239.97it/s]
Adding requests:   1%|▏         | 52/4096 [00:00<00:16, 252.67it/s]
Adding requests:   2%|▏         | 80/4096 [00:00<00:15, 262.06it/s]
Adding requests:   3%|▎         | 107/4096 [00:00<00:15, 263.34it/s]
Adding requests:   3%|▎         | 134/4096 [00:00<00:15, 259.49it/s]
Adding requests:   4%|▍         | 160/4096 [00:00<00:15, 255.67it/s]
Adding requests:   5%|▍         | 186/4096 [00:00<00:15, 250.21it/s]
Adding requests:   5%|▌         | 213/4096 [00:00<00:15, 256.22it/s]
Adding requests:   6%|▌         | 240/4096 [00:00<00:14, 258.67it/s]
Adding requests:   6%|▋         | 266/4096 [00:01<00:15, 249.52it/s]
Adding requests:   7%|▋         | 292/4096 [00:01<00:15, 251.60it/s]
Adding requests:   8%|▊         | 321/4096 [00:01<00:14, 261.46it/s]
Adding requests:   8%|▊         | 348/4096 [00:01<00:15, 246.71it/s]
Adding requests:   9%|▉         | 373/4096 [00:01<00:16, 222.88it/s]
Adding requests:  10%|▉         | 396/4096 [00:01<00:17, 210.18it/s]
Adding requests:  10%|█         | 418/4096 [00:01<00:18, 196.60it/s]
Adding requests:  11%|█         | 439/4096 [00:01<00:19, 186.28it/s]
Adding requests:  11%|█         | 458/4096 [00:02<00:19, 185.96it/s]
Adding requests:  12%|█▏        | 477/4096 [00:02<00:19, 182.73it/s]
Adding requests:  12%|█▏        | 497/4096 [00:02<00:19, 186.02it/s]
Adding requests:  13%|█▎        | 517/4096 [00:02<00:18, 188.55it/s]
Adding requests:  13%|█▎        | 537/4096 [00:02<00:18, 188.41it/s]
Adding requests:  14%|█▎        | 556/4096 [00:02<00:19, 182.69it/s]
Adding requests:  14%|█▍        | 576/4096 [00:02<00:18, 185.92it/s]
Adding requests:  15%|█▍        | 595/4096 [00:02<00:19, 179.91it/s]
Adding requests:  15%|█▍        | 614/4096 [00:02<00:20, 170.76it/s]
Adding requests:  15%|█▌        | 633/4096 [00:02<00:19, 174.82it/s]
Adding requests:  16%|█▌        | 651/4096 [00:03<00:19, 172.26it/s]
Adding requests:  16%|█▋        | 671/4096 [00:03<00:19, 177.88it/s]
Adding requests:  17%|█▋        | 691/4096 [00:03<00:18, 184.08it/s]
Adding requests:  17%|█▋        | 710/4096 [00:03<00:18, 184.78it/s]
Adding requests:  18%|█▊        | 729/4096 [00:03<00:19, 174.56it/s]
Adding requests:  18%|█▊        | 747/4096 [00:03<00:19, 172.97it/s]
Adding requests:  19%|█▊        | 765/4096 [00:03<00:19, 173.73it/s]
Adding requests:  19%|█▉        | 786/4096 [00:03<00:18, 182.69it/s]
Adding requests:  20%|█▉        | 808/4096 [00:03<00:17, 193.33it/s]
Adding requests:  20%|██        | 837/4096 [00:04<00:14, 220.22it/s]
Adding requests:  21%|██        | 864/4096 [00:04<00:13, 234.02it/s]
Adding requests:  22%|██▏       | 890/4096 [00:04<00:13, 240.08it/s]
Adding requests:  22%|██▏       | 915/4096 [00:04<00:13, 240.51it/s]
Adding requests:  23%|██▎       | 943/4096 [00:04<00:12, 249.17it/s]
Adding requests:  24%|██▎       | 969/4096 [00:04<00:12, 251.64it/s]
Adding requests:  24%|██▍       | 995/4096 [00:04<00:13, 238.30it/s]
Adding requests:  25%|██▍       | 1021/4096 [00:04<00:12, 241.77it/s]
Adding requests:  26%|██▌       | 1047/4096 [00:04<00:12, 246.70it/s]
Adding requests:  26%|██▌       | 1072/4096 [00:04<00:12, 236.12it/s]
Adding requests:  27%|██▋       | 1098/4096 [00:05<00:12, 240.68it/s]
Adding requests:  27%|██▋       | 1125/4096 [00:05<00:11, 248.00it/s]
Adding requests:  28%|██▊       | 1150/4096 [00:05<00:12, 242.74it/s]
Adding requests:  29%|██▊       | 1175/4096 [00:05<00:12, 243.11it/s]
Adding requests:  29%|██▉       | 1203/4096 [00:05<00:11, 251.54it/s]
Adding requests:  30%|███       | 1229/4096 [00:05<00:11, 248.03it/s]
Adding requests:  31%|███       | 1254/4096 [00:05<00:11, 241.54it/s]
Adding requests:  31%|███▏      | 1280/4096 [00:05<00:11, 244.76it/s]
Adding requests:  32%|███▏      | 1308/4096 [00:05<00:11, 252.10it/s]
Adding requests:  33%|███▎      | 1334/4096 [00:06<00:11, 246.74it/s]
Adding requests:  33%|███▎      | 1362/4096 [00:06<00:10, 254.55it/s]
Adding requests:  34%|███▍      | 1388/4096 [00:06<00:10, 255.42it/s]
Adding requests:  35%|███▍      | 1414/4096 [00:06<00:10, 251.83it/s]
Adding requests:  35%|███▌      | 1440/4096 [00:06<00:10, 249.97it/s]
Adding requests:  36%|███▌      | 1468/4096 [00:06<00:10, 256.46it/s]
Adding requests:  37%|███▋      | 1497/4096 [00:06<00:09, 264.57it/s]
Adding requests:  37%|███▋      | 1524/4096 [00:06<00:10, 252.52it/s]
Adding requests:  38%|███▊      | 1551/4096 [00:06<00:09, 255.80it/s]
Adding requests:  39%|███▊      | 1577/4096 [00:06<00:09, 256.77it/s]
Adding requests:  39%|███▉      | 1603/4096 [00:07<00:09, 251.76it/s]
Adding requests:  40%|███▉      | 1629/4096 [00:07<00:10, 245.43it/s]
Adding requests:  40%|████      | 1654/4096 [00:07<00:09, 245.35it/s]
Adding requests:  41%|████      | 1679/4096 [00:07<00:09, 246.51it/s]
Adding requests:  42%|████▏     | 1704/4096 [00:07<00:09, 242.29it/s]
Adding requests:  42%|████▏     | 1732/4096 [00:07<00:09, 251.41it/s]
Adding requests:  43%|████▎     | 1759/4096 [00:07<00:09, 256.41it/s]
Adding requests:  44%|████▎     | 1785/4096 [00:07<00:09, 249.02it/s]
Adding requests:  44%|████▍     | 1810/4096 [00:07<00:09, 244.83it/s]
Adding requests:  45%|████▍     | 1836/4096 [00:08<00:09, 248.11it/s]
Adding requests:  45%|████▌     | 1861/4096 [00:08<00:08, 248.61it/s]
Adding requests:  46%|████▌     | 1886/4096 [00:08<00:09, 242.79it/s]
Adding requests:  47%|████▋     | 1914/4096 [00:08<00:08, 251.79it/s]
Adding requests:  47%|████▋     | 1943/4096 [00:08<00:08, 261.25it/s]
Adding requests:  48%|████▊     | 1970/4096 [00:08<00:08, 250.98it/s]
Adding requests:  49%|████▊     | 1996/4096 [00:08<00:08, 253.44it/s]
Adding requests:  49%|████▉     | 2022/4096 [00:08<00:08, 255.28it/s]
Adding requests:  50%|█████     | 2048/4096 [00:08<00:08, 248.09it/s]
Adding requests:  51%|█████     | 2073/4096 [00:08<00:08, 239.64it/s]
Adding requests:  51%|█████▏    | 2101/4096 [00:09<00:07, 250.46it/s]
Adding requests:  52%|█████▏    | 2127/4096 [00:09<00:07, 252.84it/s]
Adding requests:  53%|█████▎    | 2153/4096 [00:09<00:07, 244.02it/s]
Adding requests:  53%|█████▎    | 2178/4096 [00:09<00:07, 244.92it/s]
Adding requests:  54%|█████▍    | 2205/4096 [00:09<00:07, 249.59it/s]
Adding requests:  54%|█████▍    | 2231/4096 [00:09<00:07, 243.92it/s]
Adding requests:  55%|█████▌    | 2259/4096 [00:09<00:07, 250.87it/s]
Adding requests:  56%|█████▌    | 2287/4096 [00:09<00:07, 257.94it/s]
Adding requests:  56%|█████▋    | 2313/4096 [00:09<00:06, 255.32it/s]
Adding requests:  57%|█████▋    | 2339/4096 [00:10<00:06, 255.01it/s]
Adding requests:  58%|█████▊    | 2367/4096 [00:10<00:06, 261.18it/s]
Adding requests:  59%|█████▊    | 2397/4096 [00:10<00:06, 271.69it/s]
Adding requests:  59%|█████▉    | 2425/4096 [00:10<00:06, 259.71it/s]
Adding requests:  60%|█████▉    | 2452/4096 [00:10<00:06, 252.26it/s]
Adding requests:  61%|██████    | 2479/4096 [00:10<00:06, 255.79it/s]
Adding requests:  61%|██████    | 2505/4096 [00:10<00:06, 252.36it/s]
Adding requests:  62%|██████▏   | 2531/4096 [00:10<00:06, 253.23it/s]
Adding requests:  62%|██████▏   | 2559/4096 [00:10<00:05, 260.37it/s]
Adding requests:  63%|██████▎   | 2587/4096 [00:10<00:05, 266.04it/s]
Adding requests:  64%|██████▍   | 2614/4096 [00:11<00:05, 252.85it/s]
Adding requests:  64%|██████▍   | 2640/4096 [00:11<00:05, 251.69it/s]
Adding requests:  65%|██████▌   | 2667/4096 [00:11<00:05, 256.21it/s]
Adding requests:  66%|██████▌   | 2693/4096 [00:11<00:05, 245.42it/s]
Adding requests:  66%|██████▋   | 2720/4096 [00:11<00:05, 250.39it/s]
Adding requests:  67%|██████▋   | 2747/4096 [00:11<00:05, 255.53it/s]
Adding requests:  68%|██████▊   | 2774/4096 [00:11<00:05, 258.49it/s]
Adding requests:  68%|██████▊   | 2801/4096 [00:11<00:04, 260.64it/s]
Adding requests:  69%|██████▉   | 2828/4096 [00:11<00:04, 261.93it/s]
Adding requests:  70%|██████▉   | 2857/4096 [00:12<00:04, 267.06it/s]
Adding requests:  70%|███████   | 2884/4096 [00:12<00:04, 256.60it/s]
Adding requests:  71%|███████   | 2912/4096 [00:12<00:04, 261.55it/s]
Adding requests:  72%|███████▏  | 2941/4096 [00:12<00:04, 269.25it/s]
Adding requests:  72%|███████▏  | 2969/4096 [00:12<00:04, 265.13it/s]
Adding requests:  73%|███████▎  | 2996/4096 [00:12<00:04, 261.99it/s]
Adding requests:  74%|███████▍  | 3024/4096 [00:12<00:04, 265.80it/s]
Adding requests:  75%|███████▍  | 3053/4096 [00:12<00:03, 271.11it/s]
Adding requests:  75%|███████▌  | 3081/4096 [00:12<00:03, 259.14it/s]
Adding requests:  76%|███████▌  | 3109/4096 [00:12<00:03, 262.72it/s]
Adding requests:  77%|███████▋  | 3139/4096 [00:13<00:03, 271.35it/s]
Adding requests:  77%|███████▋  | 3167/4096 [00:13<00:03, 254.70it/s]
Adding requests:  78%|███████▊  | 3193/4096 [00:13<00:03, 255.87it/s]
Adding requests:  79%|███████▊  | 3222/4096 [00:13<00:03, 262.87it/s]
Adding requests:  79%|███████▉  | 3249/4096 [00:13<00:03, 261.15it/s]
Adding requests:  80%|███████▉  | 3276/4096 [00:13<00:03, 252.52it/s]
Adding requests:  81%|████████  | 3302/4096 [00:13<00:03, 250.90it/s]
Adding requests:  81%|████████▏ | 3328/4096 [00:13<00:03, 251.73it/s]
Adding requests:  82%|████████▏ | 3354/4096 [00:13<00:03, 244.05it/s]
Adding requests:  83%|████████▎ | 3382/4096 [00:14<00:02, 252.80it/s]
Adding requests:  83%|████████▎ | 3410/4096 [00:14<00:02, 260.01it/s]
Adding requests:  84%|████████▍ | 3437/4096 [00:14<00:02, 247.61it/s]
Adding requests:  85%|████████▍ | 3465/4096 [00:14<00:02, 255.96it/s]
Adding requests:  85%|████████▌ | 3492/4096 [00:14<00:02, 258.27it/s]
Adding requests:  86%|████████▌ | 3520/4096 [00:14<00:02, 262.61it/s]
Adding requests:  87%|████████▋ | 3547/4096 [00:14<00:02, 262.43it/s]
Adding requests:  87%|████████▋ | 3574/4096 [00:14<00:01, 263.63it/s]
Adding requests:  88%|████████▊ | 3602/4096 [00:14<00:01, 267.82it/s]
Adding requests:  89%|████████▊ | 3629/4096 [00:15<00:01, 256.23it/s]
Adding requests:  89%|████████▉ | 3656/4096 [00:15<00:01, 259.78it/s]
Adding requests:  90%|████████▉ | 3683/4096 [00:15<00:01, 262.16it/s]
Adding requests:  91%|█████████ | 3710/4096 [00:15<00:01, 257.32it/s]
Adding requests:  91%|█████████ | 3737/4096 [00:15<00:01, 258.53it/s]
Adding requests:  92%|█████████▏| 3764/4096 [00:15<00:01, 258.78it/s]
Adding requests:  93%|█████████▎| 3790/4096 [00:15<00:01, 251.73it/s]
Adding requests:  93%|█████████▎| 3816/4096 [00:15<00:01, 231.14it/s]
Adding requests:  94%|█████████▍| 3843/4096 [00:15<00:01, 241.57it/s]
Adding requests:  95%|█████████▍| 3871/4096 [00:15<00:00, 250.24it/s]
Adding requests:  95%|█████████▌| 3897/4096 [00:16<00:00, 239.91it/s]
Adding requests:  96%|█████████▌| 3923/4096 [00:16<00:00, 244.83it/s]
Adding requests:  96%|█████████▋| 3951/4096 [00:16<00:00, 253.42it/s]
Adding requests:  97%|█████████▋| 3977/4096 [00:16<00:00, 248.09it/s]
Adding requests:  98%|█████████▊| 4003/4096 [00:16<00:00, 251.23it/s]
Adding requests:  98%|█████████▊| 4031/4096 [00:16<00:00, 258.27it/s]
Adding requests:  99%|█████████▉| 4057/4096 [00:16<00:00, 257.37it/s]
Adding requests: 100%|█████████▉| 4083/4096 [00:16<00:00, 248.22it/s]
Adding requests: 100%|██████████| 4096/4096 [00:16<00:00, 242.50it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 98/4096 [00:03<02:29, 26.72it/s, est. speed input: 27362.86 toks/s, output: 26.72 toks/s]
Processed prompts:   3%|▎         | 130/4096 [00:07<04:08, 15.95it/s, est. speed input: 17971.61 toks/s, output: 17.55 toks/s]
Processed prompts:   4%|▍         | 162/4096 [00:12<06:01, 10.87it/s, est. speed input: 13360.47 toks/s, output: 13.05 toks/s]
Processed prompts:   5%|▍         | 194/4096 [00:17<07:16,  8.93it/s, est. speed input: 11400.11 toks/s, output: 11.13 toks/s]
Processed prompts:   6%|▌         | 226/4096 [00:22<08:06,  7.96it/s, est. speed input: 10314.81 toks/s, output: 10.07 toks/s]
Processed prompts:   6%|▋         | 258/4096 [00:27<08:38,  7.41it/s, est. speed input: 9625.54 toks/s, output: 9.40 toks/s]  
Processed prompts:   7%|▋         | 290/4096 [00:32<08:58,  7.06it/s, est. speed input: 9148.75 toks/s, output: 8.93 toks/s]
Processed prompts:   8%|▊         | 322/4096 [00:37<09:11,  6.84it/s, est. speed input: 8799.89 toks/s, output: 8.59 toks/s]
Processed prompts:   9%|▊         | 354/4096 [00:41<08:33,  7.29it/s, est. speed input: 8799.64 toks/s, output: 8.59 toks/s]
Processed prompts:   9%|▉         | 386/4096 [00:46<08:50,  6.99it/s, est. speed input: 8554.51 toks/s, output: 8.35 toks/s]
Processed prompts:  10%|█         | 418/4096 [00:51<09:01,  6.80it/s, est. speed input: 8356.52 toks/s, output: 8.16 toks/s]
Processed prompts:  11%|█         | 450/4096 [00:56<09:06,  6.67it/s, est. speed input: 8193.86 toks/s, output: 8.00 toks/s]
Processed prompts:  12%|█▏        | 482/4096 [01:01<09:09,  6.58it/s, est. speed input: 8058.17 toks/s, output: 7.87 toks/s]
Processed prompts:  13%|█▎        | 514/4096 [01:06<09:09,  6.52it/s, est. speed input: 7942.83 toks/s, output: 7.76 toks/s]
Processed prompts:  13%|█▎        | 546/4096 [01:09<08:24,  7.03it/s, est. speed input: 7989.25 toks/s, output: 7.80 toks/s]
Processed prompts:  14%|█▍        | 578/4096 [01:14<08:35,  6.82it/s, est. speed input: 7891.86 toks/s, output: 7.71 toks/s]
Processed prompts:  15%|█▍        | 610/4096 [01:20<08:41,  6.68it/s, est. speed input: 7806.75 toks/s, output: 7.62 toks/s]
Processed prompts:  16%|█▌        | 642/4096 [01:25<08:44,  6.59it/s, est. speed input: 7731.61 toks/s, output: 7.55 toks/s]
Processed prompts:  16%|█▋        | 674/4096 [01:30<08:44,  6.52it/s, est. speed input: 7664.79 toks/s, output: 7.49 toks/s]
Processed prompts:  17%|█▋        | 706/4096 [01:35<08:43,  6.48it/s, est. speed input: 7605.02 toks/s, output: 7.43 toks/s]
Processed prompts:  18%|█▊        | 738/4096 [01:40<08:40,  6.45it/s, est. speed input: 7551.13 toks/s, output: 7.37 toks/s]
Processed prompts:  19%|█▉        | 770/4096 [01:43<07:50,  7.07it/s, est. speed input: 7611.69 toks/s, output: 7.43 toks/s]
Processed prompts:  20%|█▉        | 802/4096 [01:48<08:01,  6.85it/s, est. speed input: 7561.79 toks/s, output: 7.38 toks/s]
Processed prompts:  20%|██        | 834/4096 [01:53<08:06,  6.70it/s, est. speed input: 7516.34 toks/s, output: 7.34 toks/s]
Processed prompts:  21%|██        | 866/4096 [01:58<08:09,  6.60it/s, est. speed input: 7474.79 toks/s, output: 7.30 toks/s]
Processed prompts:  22%|██▏       | 898/4096 [02:03<08:09,  6.53it/s, est. speed input: 7436.58 toks/s, output: 7.26 toks/s]
Processed prompts:  23%|██▎       | 930/4096 [02:08<08:08,  6.49it/s, est. speed input: 7401.21 toks/s, output: 7.23 toks/s]
Processed prompts:  23%|██▎       | 962/4096 [02:12<07:27,  7.01it/s, est. speed input: 7441.15 toks/s, output: 7.27 toks/s]
Processed prompts:  24%|██▍       | 994/4096 [02:17<07:35,  6.80it/s, est. speed input: 7407.70 toks/s, output: 7.23 toks/s]
Processed prompts:  25%|██▌       | 1026/4096 [02:22<07:40,  6.67it/s, est. speed input: 7376.77 toks/s, output: 7.20 toks/s]
Processed prompts:  26%|██▌       | 1058/4096 [02:27<07:41,  6.58it/s, est. speed input: 7348.01 toks/s, output: 7.18 toks/s]
Processed prompts:  27%|██▋       | 1090/4096 [02:32<07:41,  6.52it/s, est. speed input: 7321.32 toks/s, output: 7.15 toks/s]
Processed prompts:  27%|██▋       | 1122/4096 [02:37<07:39,  6.48it/s, est. speed input: 7296.07 toks/s, output: 7.13 toks/s]
Processed prompts:  28%|██▊       | 1154/4096 [02:42<07:36,  6.44it/s, est. speed input: 7271.80 toks/s, output: 7.10 toks/s]
Processed prompts:  29%|██▉       | 1186/4096 [02:46<06:57,  6.98it/s, est. speed input: 7307.34 toks/s, output: 7.14 toks/s]
Processed prompts:  30%|██▉       | 1218/4096 [02:51<07:04,  6.79it/s, est. speed input: 7284.71 toks/s, output: 7.11 toks/s]
Processed prompts:  31%|███       | 1250/4096 [02:56<07:07,  6.66it/s, est. speed input: 7263.20 toks/s, output: 7.09 toks/s]
Processed prompts:  31%|███▏      | 1282/4096 [03:01<07:08,  6.57it/s, est. speed input: 7242.96 toks/s, output: 7.07 toks/s]
Processed prompts:  32%|███▏      | 1314/4096 [03:06<07:06,  6.52it/s, est. speed input: 7224.28 toks/s, output: 7.05 toks/s]
Processed prompts:  33%|███▎      | 1346/4096 [03:11<07:04,  6.48it/s, est. speed input: 7206.42 toks/s, output: 7.04 toks/s]
Processed prompts:  34%|███▎      | 1378/4096 [03:14<06:28,  6.99it/s, est. speed input: 7236.59 toks/s, output: 7.07 toks/s]
Processed prompts:  34%|███▍      | 1410/4096 [03:20<06:35,  6.80it/s, est. speed input: 7219.00 toks/s, output: 7.05 toks/s]
Processed prompts:  35%|███▌      | 1442/4096 [03:25<06:38,  6.66it/s, est. speed input: 7201.96 toks/s, output: 7.03 toks/s]
Processed prompts:  36%|███▌      | 1474/4096 [03:30<06:40,  6.55it/s, est. speed input: 7183.92 toks/s, output: 7.02 toks/s]
Processed prompts:  37%|███▋      | 1506/4096 [03:35<06:39,  6.49it/s, est. speed input: 7167.63 toks/s, output: 7.00 toks/s]
Processed prompts:  38%|███▊      | 1538/4096 [03:40<06:36,  6.45it/s, est. speed input: 7152.75 toks/s, output: 6.99 toks/s]
Processed prompts:  38%|███▊      | 1570/4096 [03:45<06:32,  6.43it/s, est. speed input: 7139.18 toks/s, output: 6.97 toks/s]
Processed prompts:  39%|███▉      | 1602/4096 [03:48<05:50,  7.11it/s, est. speed input: 7176.37 toks/s, output: 7.01 toks/s]
Processed prompts:  40%|███▉      | 1634/4096 [03:53<05:56,  6.91it/s, est. speed input: 7165.51 toks/s, output: 7.00 toks/s]
Processed prompts:  41%|████      | 1666/4096 [03:58<06:00,  6.74it/s, est. speed input: 7151.66 toks/s, output: 6.98 toks/s]
Processed prompts:  41%|████▏     | 1698/4096 [04:03<06:04,  6.58it/s, est. speed input: 7135.49 toks/s, output: 6.97 toks/s]
Processed prompts:  42%|████▏     | 1730/4096 [04:08<06:02,  6.52it/s, est. speed input: 7123.39 toks/s, output: 6.96 toks/s]
Processed prompts:  43%|████▎     | 1762/4096 [04:13<06:00,  6.48it/s, est. speed input: 7111.87 toks/s, output: 6.95 toks/s]
Processed prompts:  44%|████▍     | 1794/4096 [04:17<05:28,  7.01it/s, est. speed input: 7137.20 toks/s, output: 6.97 toks/s]
Processed prompts:  45%|████▍     | 1826/4096 [04:22<05:33,  6.81it/s, est. speed input: 7125.95 toks/s, output: 6.96 toks/s]
Processed prompts:  45%|████▌     | 1858/4096 [04:27<05:35,  6.68it/s, est. speed input: 7114.96 toks/s, output: 6.95 toks/s]
Processed prompts:  46%|████▌     | 1890/4096 [04:32<05:34,  6.59it/s, est. speed input: 7104.34 toks/s, output: 6.94 toks/s]
Processed prompts:  47%|████▋     | 1922/4096 [04:37<05:33,  6.53it/s, est. speed input: 7094.12 toks/s, output: 6.93 toks/s]
Processed prompts:  48%|████▊     | 1954/4096 [04:42<05:30,  6.48it/s, est. speed input: 7084.22 toks/s, output: 6.92 toks/s]
Processed prompts:  48%|████▊     | 1986/4096 [04:47<05:26,  6.45it/s, est. speed input: 7074.71 toks/s, output: 6.91 toks/s]
Processed prompts:  49%|████▉     | 2018/4096 [04:51<04:58,  6.97it/s, est. speed input: 7096.30 toks/s, output: 6.93 toks/s]
Processed prompts:  50%|█████     | 2050/4096 [04:56<05:01,  6.78it/s, est. speed input: 7086.83 toks/s, output: 6.92 toks/s]
Processed prompts:  51%|█████     | 2082/4096 [05:01<05:02,  6.66it/s, est. speed input: 7077.69 toks/s, output: 6.91 toks/s]
Processed prompts:  52%|█████▏    | 2114/4096 [05:06<05:01,  6.57it/s, est. speed input: 7068.78 toks/s, output: 6.90 toks/s]
Processed prompts:  52%|█████▏    | 2146/4096 [05:11<04:59,  6.51it/s, est. speed input: 7060.16 toks/s, output: 6.89 toks/s]
Processed prompts:  53%|█████▎    | 2178/4096 [05:16<04:52,  6.55it/s, est. speed input: 7056.41 toks/s, output: 6.89 toks/s]
Processed prompts:  54%|█████▍    | 2210/4096 [05:19<04:27,  7.06it/s, est. speed input: 7076.79 toks/s, output: 6.91 toks/s]
Processed prompts:  55%|█████▍    | 2242/4096 [05:24<04:31,  6.84it/s, est. speed input: 7068.40 toks/s, output: 6.90 toks/s]
Processed prompts:  56%|█████▌    | 2274/4096 [05:29<04:32,  6.70it/s, est. speed input: 7060.28 toks/s, output: 6.89 toks/s]
Processed prompts:  56%|█████▋    | 2306/4096 [05:34<04:31,  6.60it/s, est. speed input: 7052.38 toks/s, output: 6.89 toks/s]
Processed prompts:  57%|█████▋    | 2338/4096 [05:39<04:29,  6.53it/s, est. speed input: 7044.69 toks/s, output: 6.88 toks/s]
Processed prompts:  58%|█████▊    | 2370/4096 [05:44<04:26,  6.48it/s, est. speed input: 7037.24 toks/s, output: 6.87 toks/s]
Processed prompts:  59%|█████▊    | 2402/4096 [05:49<04:22,  6.45it/s, est. speed input: 7030.01 toks/s, output: 6.87 toks/s]
Processed prompts:  59%|█████▉    | 2434/4096 [05:53<03:58,  6.98it/s, est. speed input: 7048.93 toks/s, output: 6.88 toks/s]
Processed prompts:  60%|██████    | 2466/4096 [05:58<04:00,  6.79it/s, est. speed input: 7041.72 toks/s, output: 6.88 toks/s]
Processed prompts:  61%|██████    | 2498/4096 [06:03<03:59,  6.66it/s, est. speed input: 7034.69 toks/s, output: 6.87 toks/s]
Processed prompts:  62%|██████▏   | 2530/4096 [06:08<03:58,  6.57it/s, est. speed input: 7027.87 toks/s, output: 6.86 toks/s]
Processed prompts:  63%|██████▎   | 2562/4096 [06:13<03:55,  6.51it/s, est. speed input: 7021.22 toks/s, output: 6.86 toks/s]
Processed prompts:  63%|██████▎   | 2594/4096 [06:18<03:52,  6.47it/s, est. speed input: 7014.73 toks/s, output: 6.85 toks/s]
Processed prompts:  64%|██████▍   | 2626/4096 [06:22<03:30,  7.00it/s, est. speed input: 7032.37 toks/s, output: 6.87 toks/s]
Processed prompts:  65%|██████▍   | 2658/4096 [06:27<03:31,  6.80it/s, est. speed input: 7025.89 toks/s, output: 6.86 toks/s]
Processed prompts:  66%|██████▌   | 2690/4096 [06:32<03:30,  6.67it/s, est. speed input: 7019.61 toks/s, output: 6.86 toks/s]
Processed prompts:  66%|██████▋   | 2722/4096 [06:37<03:28,  6.58it/s, est. speed input: 7013.47 toks/s, output: 6.85 toks/s]
Processed prompts:  67%|██████▋   | 2754/4096 [06:42<03:25,  6.52it/s, est. speed input: 7007.47 toks/s, output: 6.84 toks/s]
Processed prompts:  68%|██████▊   | 2786/4096 [06:47<03:22,  6.48it/s, est. speed input: 7001.62 toks/s, output: 6.84 toks/s]
Processed prompts:  69%|██████▉   | 2818/4096 [06:52<03:18,  6.45it/s, est. speed input: 6995.89 toks/s, output: 6.83 toks/s]
Processed prompts:  70%|██████▉   | 2850/4096 [06:56<02:58,  6.97it/s, est. speed input: 7012.25 toks/s, output: 6.85 toks/s]
Processed prompts:  70%|███████   | 2882/4096 [07:01<02:58,  6.78it/s, est. speed input: 7006.52 toks/s, output: 6.84 toks/s]
Processed prompts:  71%|███████   | 2914/4096 [07:06<02:57,  6.66it/s, est. speed input: 7000.94 toks/s, output: 6.84 toks/s]
Processed prompts:  72%|███████▏  | 2946/4096 [07:11<02:54,  6.57it/s, est. speed input: 6995.50 toks/s, output: 6.83 toks/s]
Processed prompts:  73%|███████▎  | 2978/4096 [07:16<02:51,  6.51it/s, est. speed input: 6990.20 toks/s, output: 6.83 toks/s]
Processed prompts:  73%|███████▎  | 3010/4096 [07:21<02:47,  6.47it/s, est. speed input: 6984.90 toks/s, output: 6.82 toks/s]
Processed prompts:  74%|███████▍  | 3042/4096 [07:24<02:30,  7.00it/s, est. speed input: 7000.39 toks/s, output: 6.84 toks/s]
Processed prompts:  75%|███████▌  | 3074/4096 [07:29<02:30,  6.80it/s, est. speed input: 6995.13 toks/s, output: 6.83 toks/s]
Processed prompts:  76%|███████▌  | 3106/4096 [07:35<02:28,  6.67it/s, est. speed input: 6989.99 toks/s, output: 6.83 toks/s]
Processed prompts:  77%|███████▋  | 3138/4096 [07:40<02:25,  6.58it/s, est. speed input: 6984.95 toks/s, output: 6.82 toks/s]
Processed prompts:  77%|███████▋  | 3170/4096 [07:45<02:22,  6.52it/s, est. speed input: 6980.13 toks/s, output: 6.82 toks/s]
Processed prompts:  78%|███████▊  | 3202/4096 [07:50<02:18,  6.47it/s, est. speed input: 6975.30 toks/s, output: 6.81 toks/s]
Processed prompts:  79%|███████▉  | 3234/4096 [07:55<02:14,  6.43it/s, est. speed input: 6970.05 toks/s, output: 6.81 toks/s]
Processed prompts:  80%|███████▉  | 3266/4096 [07:58<01:58,  6.98it/s, est. speed input: 6984.92 toks/s, output: 6.82 toks/s]
Processed prompts:  81%|████████  | 3298/4096 [08:03<01:57,  6.78it/s, est. speed input: 6980.22 toks/s, output: 6.82 toks/s]
Processed prompts:  81%|████████▏ | 3330/4096 [08:08<01:55,  6.65it/s, est. speed input: 6975.52 toks/s, output: 6.81 toks/s]
Processed prompts:  82%|████████▏ | 3362/4096 [08:13<01:51,  6.56it/s, est. speed input: 6970.85 toks/s, output: 6.81 toks/s]
Processed prompts:  83%|████████▎ | 3394/4096 [08:18<01:48,  6.50it/s, est. speed input: 6966.08 toks/s, output: 6.80 toks/s]
Processed prompts:  84%|████████▎ | 3426/4096 [08:23<01:43,  6.46it/s, est. speed input: 6961.63 toks/s, output: 6.80 toks/s]
Processed prompts:  84%|████████▍ | 3458/4096 [08:27<01:30,  7.02it/s, est. speed input: 6976.28 toks/s, output: 6.81 toks/s]
Processed prompts:  85%|████████▌ | 3490/4096 [08:32<01:28,  6.81it/s, est. speed input: 6971.97 toks/s, output: 6.81 toks/s]
Processed prompts:  86%|████████▌ | 3522/4096 [08:37<01:25,  6.68it/s, est. speed input: 6967.72 toks/s, output: 6.80 toks/s]
Processed prompts:  87%|████████▋ | 3554/4096 [08:42<01:22,  6.59it/s, est. speed input: 6963.55 toks/s, output: 6.80 toks/s]
Processed prompts:  88%|████████▊ | 3586/4096 [08:47<01:18,  6.52it/s, est. speed input: 6959.45 toks/s, output: 6.80 toks/s]
Processed prompts:  88%|████████▊ | 3618/4096 [08:52<01:13,  6.48it/s, est. speed input: 6955.41 toks/s, output: 6.79 toks/s]
Processed prompts:  89%|████████▉ | 3650/4096 [08:57<01:09,  6.45it/s, est. speed input: 6951.46 toks/s, output: 6.79 toks/s]
Processed prompts:  90%|████████▉ | 3682/4096 [09:01<00:58,  7.07it/s, est. speed input: 6966.96 toks/s, output: 6.80 toks/s]
Processed prompts:  91%|█████████ | 3714/4096 [09:06<00:55,  6.85it/s, est. speed input: 6962.95 toks/s, output: 6.80 toks/s]
Processed prompts:  91%|█████████▏| 3746/4096 [09:11<00:52,  6.70it/s, est. speed input: 6959.02 toks/s, output: 6.80 toks/s]
Processed prompts:  92%|█████████▏| 3778/4096 [09:16<00:48,  6.60it/s, est. speed input: 6955.15 toks/s, output: 6.79 toks/s]
Processed prompts:  93%|█████████▎| 3810/4096 [09:21<00:43,  6.53it/s, est. speed input: 6951.34 toks/s, output: 6.79 toks/s]
Processed prompts:  94%|█████████▍| 3842/4096 [09:26<00:39,  6.48it/s, est. speed input: 6947.62 toks/s, output: 6.78 toks/s]
Processed prompts:  95%|█████████▍| 3874/4096 [09:29<00:31,  7.01it/s, est. speed input: 6959.98 toks/s, output: 6.80 toks/s]
Processed prompts:  95%|█████████▌| 3906/4096 [09:34<00:27,  6.90it/s, est. speed input: 6958.75 toks/s, output: 6.80 toks/s]
Processed prompts:  96%|█████████▌| 3938/4096 [09:39<00:23,  6.73it/s, est. speed input: 6955.04 toks/s, output: 6.79 toks/s]
Processed prompts:  97%|█████████▋| 3970/4096 [09:44<00:19,  6.62it/s, est. speed input: 6951.40 toks/s, output: 6.79 toks/s]
Processed prompts:  98%|█████████▊| 4002/4096 [09:49<00:14,  6.55it/s, est. speed input: 6947.82 toks/s, output: 6.78 toks/s]
Processed prompts:  98%|█████████▊| 4034/4096 [09:54<00:09,  6.49it/s, est. speed input: 6944.29 toks/s, output: 6.78 toks/s]
Processed prompts:  99%|█████████▉| 4066/4096 [09:59<00:04,  6.55it/s, est. speed input: 6943.36 toks/s, output: 6.78 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [09:59<00:00,  6.55it/s, est. speed input: 6994.58 toks/s, output: 6.83 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [09:59<00:00,  6.83it/s, est. speed input: 6994.58 toks/s, output: 6.83 toks/s]
[rank0]:[W126 02:22:44.860713431 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=65536 ==========
Time: 2026-01-26 02:22:46
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=8192, max_num_seqs=64
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 8192 --max-num-seqs 64 --max-model-len 1025 --max-num-batched-tokens 65536 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Qwen2.5-7B-INT8_M65536.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 02:23:50 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 02:23:51 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=58798) WARNING 01-26 02:24:04 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=58798) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=58798) WARNING 01-26 02:24:17 [backends.py:609] Failed to read file <frozen os>
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 240, in _initialize_kv_caches
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     available_gpu_memory = self.model_executor.determine_available_memory()
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     return self.collective_rpc("determine_available_memory")
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     result = run_method(self.driver_worker, method, args, kwargs)
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/root/vllmbench/vllm/v1/serial_utils.py", line 461, in run_method
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 340, in determine_available_memory
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     self.model_runner.profile_run()
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4474, in profile_run
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     hidden_states, last_hidden_states = self._dummy_run(
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]                                         ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4198, in _dummy_run
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     outputs = self.model(
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]               ^^^^^^^^^^^
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 583, in forward
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     hidden_states = self.model(
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]                     ^^^^^^^^^^^
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/root/vllmbench/vllm/compilation/decorators.py", line 526, in __call__
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/root/vllmbench/vllm/compilation/wrapper.py", line 218, in __call__
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     return self._call_with_optional_nvtx_range(
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/root/vllmbench/vllm/compilation/wrapper.py", line 109, in _call_with_optional_nvtx_range
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     return callable_fn(*args, **kwargs)
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 832, in compile_wrapper
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     return fn(*args, **kwargs)
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 418, in forward
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     def forward(
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     return fn(*args, **kwargs)
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/root/vllmbench/vllm/compilation/caching.py", line 54, in __call__
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     return self.optimized_call(*args, **kwargs)
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 837, in call_wrapped
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     return self._wrapped_call(self, *args, **kwargs)
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 413, in __call__
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     raise e
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 400, in __call__
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     return super(self.cls, obj).__call__(*args, **kwargs)  # type: ignore[misc]
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "<eval_with_key>.58", line 325, in forward
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     submod_2 = self.submod_2(getitem_3, s72, l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_scale_, l_self_modules_layers_modules_0_modules_post_attention_layernorm_parameters_weight_, getitem_4, l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_scale_, l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_input_layernorm_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_bias_, l_positions_, l_self_modules_layers_modules_0_modules_self_attn_modules_rotary_emb_buffers_cos_sin_cache_);  getitem_3 = l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_scale_ = l_self_modules_layers_modules_0_modules_post_attention_layernorm_parameters_weight_ = getitem_4 = l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_scale_ = l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_input_layernorm_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_bias_ = None
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/root/vllmbench/vllm/compilation/piecewise_backend.py", line 178, in __call__
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     return range_entry.runnable(*args)
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/standalone_compile.py", line 63, in __call__
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     return self._compiled_fn(*args)
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     return fn(*args, **kwargs)
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/aot_autograd.py", line 1130, in forward
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     return compiled_fn(full_args)
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 353, in runtime_wrapper
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     all_outs = call_func_at_runtime_with_args(
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/utils.py", line 129, in call_func_at_runtime_with_args
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     out = normalize_as_list(f(args))
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]                             ^^^^^^^
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 526, in wrapper
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     return compiled_fn(runtime_args)
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/output_code.py", line 613, in __call__
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     return self.current_callable(inputs)
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/utils.py", line 2962, in run
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     out = model(new_inputs)
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]           ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/tmp/torchinductor_root/ax/caxhtv4z7pvejo2kecicfp7dovq5qwcbf7pbrxlmuivaiaz6ety5.py", line 1093, in call
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     buf17 = torch.ops.slidesparse.quant_slide_int8.default(buf16, 'Qwen2.5-7B-INT8', 6)
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_ops.py", line 841, in __call__
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     return self._op(*args, **kwargs)
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/root/vllmbench/slidesparse/core/kernels.py", line 564, in _quant_slide_int8_impl
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     return fn(input, L)
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]            ^^^^^^^^^^^^
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/root/vllmbench/slidesparse/csrc/fused_quant_slide_triton/build/RTX4090_cc89_py312_cu129_x86_64/quant_slide_tuned_Qwen2.5-7B.py", line 369, in quant_slide_int8_triton
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     _quant_slide_int8_kernel[(M,)](
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/triton/runtime/jit.py", line 419, in <lambda>
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/triton/runtime/jit.py", line 756, in run
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     launch_metadata = kernel.launch_metadata(grid, stream, *bound_args.values())
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 490, in launch_metadata
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     self._init_handles()
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 473, in _init_handles
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]     self.module, self.function, self.n_regs, self.n_spills, self.n_max_threads = driver.active.utils.load_binary(
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866]                                                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798) ERROR 01-26 02:24:23 [core.py:866] RuntimeError: Triton Error [CUDA]: an illegal memory access was encountered

STDERR:
[2026-01-26 02:23:50] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 02:23:50] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:23:50] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 02:23:50] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:23:50] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:23:50] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:23:50] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:23:50] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:23:50] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:23:50] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 02:23:50] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 02:23:50] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 02:23:50] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 02:23:50] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 02:23:58] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 02:23:58] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:23:58] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 02:23:58] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:23:58] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:23:58] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:23:58] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:23:58] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:23:58] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:23:58] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 02:23:58] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 02:23:58] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 02:23:58] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 02:23:58] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=58798) [2026-01-26 02:24:05] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=58798) [2026-01-26 02:24:05] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=58798) [2026-01-26 02:24:05] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=58798) [2026-01-26 02:24:05] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=58798) [2026-01-26 02:24:05] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=58798) [2026-01-26 02:24:05] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=58798) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=58798) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.17it/s]
(EngineCore_DP0 pid=58798) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.09s/it]
(EngineCore_DP0 pid=58798) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.05s/it]
(EngineCore_DP0 pid=58798) 
(EngineCore_DP0 pid=58798) [2026-01-26 02:24:07] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 4800] -> 1D uint8
(EngineCore_DP0 pid=58798) [2026-01-26 02:24:07] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 16662528 bytes
(EngineCore_DP0 pid=58798) [2026-01-26 02:24:07] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 4800] -> 1D uint8
(EngineCore_DP0 pid=58798) [2026-01-26 02:24:07] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12959744 bytes
(EngineCore_DP0 pid=58798) [2026-01-26 02:24:07] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 4800] -> 1D uint8
(EngineCore_DP0 pid=58798) [2026-01-26 02:24:07] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 137003008 bytes
(EngineCore_DP0 pid=58798) [2026-01-26 02:24:07] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 25280] -> 1D uint8
(EngineCore_DP0 pid=58798) [2026-01-26 02:24:07] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 68009984 bytes
(EngineCore_DP0 pid=58798) Process EngineCore_DP0:
(EngineCore_DP0 pid=58798) Traceback (most recent call last):
(EngineCore_DP0 pid=58798)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=58798)     self.run()
(EngineCore_DP0 pid=58798)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=58798)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=58798)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=58798)     raise e
(EngineCore_DP0 pid=58798)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=58798)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=58798)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=58798)     super().__init__(
(EngineCore_DP0 pid=58798)   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=58798)     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=58798)                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798)   File "/root/vllmbench/vllm/v1/engine/core.py", line 240, in _initialize_kv_caches
(EngineCore_DP0 pid=58798)     available_gpu_memory = self.model_executor.determine_available_memory()
(EngineCore_DP0 pid=58798)                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798)   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
(EngineCore_DP0 pid=58798)     return self.collective_rpc("determine_available_memory")
(EngineCore_DP0 pid=58798)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798)   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
(EngineCore_DP0 pid=58798)     result = run_method(self.driver_worker, method, args, kwargs)
(EngineCore_DP0 pid=58798)              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798)   File "/root/vllmbench/vllm/v1/serial_utils.py", line 461, in run_method
(EngineCore_DP0 pid=58798)     return func(*args, **kwargs)
(EngineCore_DP0 pid=58798)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798)   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=58798)     return func(*args, **kwargs)
(EngineCore_DP0 pid=58798)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798)   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 340, in determine_available_memory
(EngineCore_DP0 pid=58798)     self.model_runner.profile_run()
(EngineCore_DP0 pid=58798)   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4474, in profile_run
(EngineCore_DP0 pid=58798)     hidden_states, last_hidden_states = self._dummy_run(
(EngineCore_DP0 pid=58798)                                         ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798)   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=58798)     return func(*args, **kwargs)
(EngineCore_DP0 pid=58798)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798)   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4198, in _dummy_run
(EngineCore_DP0 pid=58798)     outputs = self.model(
(EngineCore_DP0 pid=58798)               ^^^^^^^^^^^
(EngineCore_DP0 pid=58798)   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=58798)     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=58798)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=58798)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=58798)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=58798)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=58798)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 583, in forward
(EngineCore_DP0 pid=58798)     hidden_states = self.model(
(EngineCore_DP0 pid=58798)                     ^^^^^^^^^^^
(EngineCore_DP0 pid=58798)   File "/root/vllmbench/vllm/compilation/decorators.py", line 526, in __call__
(EngineCore_DP0 pid=58798)     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
(EngineCore_DP0 pid=58798)              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798)   File "/root/vllmbench/vllm/compilation/wrapper.py", line 218, in __call__
(EngineCore_DP0 pid=58798)     return self._call_with_optional_nvtx_range(
(EngineCore_DP0 pid=58798)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798)   File "/root/vllmbench/vllm/compilation/wrapper.py", line 109, in _call_with_optional_nvtx_range
(EngineCore_DP0 pid=58798)     return callable_fn(*args, **kwargs)
(EngineCore_DP0 pid=58798)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798)   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 832, in compile_wrapper
(EngineCore_DP0 pid=58798)     return fn(*args, **kwargs)
(EngineCore_DP0 pid=58798)            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 418, in forward
(EngineCore_DP0 pid=58798)     def forward(
(EngineCore_DP0 pid=58798)   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=58798)     return fn(*args, **kwargs)
(EngineCore_DP0 pid=58798)            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798)   File "/root/vllmbench/vllm/compilation/caching.py", line 54, in __call__
(EngineCore_DP0 pid=58798)     return self.optimized_call(*args, **kwargs)
(EngineCore_DP0 pid=58798)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798)   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 837, in call_wrapped
(EngineCore_DP0 pid=58798)     return self._wrapped_call(self, *args, **kwargs)
(EngineCore_DP0 pid=58798)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798)   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 413, in __call__
(EngineCore_DP0 pid=58798)     raise e
(EngineCore_DP0 pid=58798)   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 400, in __call__
(EngineCore_DP0 pid=58798)     return super(self.cls, obj).__call__(*args, **kwargs)  # type: ignore[misc]
(EngineCore_DP0 pid=58798)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=58798)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=58798)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=58798)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=58798)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798)   File "<eval_with_key>.58", line 325, in forward
(EngineCore_DP0 pid=58798)     submod_2 = self.submod_2(getitem_3, s72, l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_scale_, l_self_modules_layers_modules_0_modules_post_attention_layernorm_parameters_weight_, getitem_4, l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_scale_, l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_input_layernorm_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_bias_, l_positions_, l_self_modules_layers_modules_0_modules_self_attn_modules_rotary_emb_buffers_cos_sin_cache_);  getitem_3 = l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_scale_ = l_self_modules_layers_modules_0_modules_post_attention_layernorm_parameters_weight_ = getitem_4 = l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_scale_ = l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_input_layernorm_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_bias_ = None
(EngineCore_DP0 pid=58798)                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798)   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=58798)     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=58798)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798)   File "/root/vllmbench/vllm/compilation/piecewise_backend.py", line 178, in __call__
(EngineCore_DP0 pid=58798)     return range_entry.runnable(*args)
(EngineCore_DP0 pid=58798)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/standalone_compile.py", line 63, in __call__
(EngineCore_DP0 pid=58798)     return self._compiled_fn(*args)
(EngineCore_DP0 pid=58798)            ^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798)   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=58798)     return fn(*args, **kwargs)
(EngineCore_DP0 pid=58798)            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/aot_autograd.py", line 1130, in forward
(EngineCore_DP0 pid=58798)     return compiled_fn(full_args)
(EngineCore_DP0 pid=58798)            ^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 353, in runtime_wrapper
(EngineCore_DP0 pid=58798)     all_outs = call_func_at_runtime_with_args(
(EngineCore_DP0 pid=58798)                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/utils.py", line 129, in call_func_at_runtime_with_args
(EngineCore_DP0 pid=58798)     out = normalize_as_list(f(args))
(EngineCore_DP0 pid=58798)                             ^^^^^^^
(EngineCore_DP0 pid=58798)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 526, in wrapper
(EngineCore_DP0 pid=58798)     return compiled_fn(runtime_args)
(EngineCore_DP0 pid=58798)            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/output_code.py", line 613, in __call__
(EngineCore_DP0 pid=58798)     return self.current_callable(inputs)
(EngineCore_DP0 pid=58798)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/utils.py", line 2962, in run
(EngineCore_DP0 pid=58798)     out = model(new_inputs)
(EngineCore_DP0 pid=58798)           ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798)   File "/tmp/torchinductor_root/ax/caxhtv4z7pvejo2kecicfp7dovq5qwcbf7pbrxlmuivaiaz6ety5.py", line 1093, in call
(EngineCore_DP0 pid=58798)     buf17 = torch.ops.slidesparse.quant_slide_int8.default(buf16, 'Qwen2.5-7B-INT8', 6)
(EngineCore_DP0 pid=58798)             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798)   File "/usr/local/lib/python3.12/dist-packages/torch/_ops.py", line 841, in __call__
(EngineCore_DP0 pid=58798)     return self._op(*args, **kwargs)
(EngineCore_DP0 pid=58798)            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798)   File "/root/vllmbench/slidesparse/core/kernels.py", line 564, in _quant_slide_int8_impl
(EngineCore_DP0 pid=58798)     return fn(input, L)
(EngineCore_DP0 pid=58798)            ^^^^^^^^^^^^
(EngineCore_DP0 pid=58798)   File "/root/vllmbench/slidesparse/csrc/fused_quant_slide_triton/build/RTX4090_cc89_py312_cu129_x86_64/quant_slide_tuned_Qwen2.5-7B.py", line 369, in quant_slide_int8_triton
(EngineCore_DP0 pid=58798)     _quant_slide_int8_kernel[(M,)](
(EngineCore_DP0 pid=58798)   File "/usr/local/lib/python3.12/dist-packages/triton/runtime/jit.py", line 419, in <lambda>
(EngineCore_DP0 pid=58798)     return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)
(EngineCore_DP0 pid=58798)                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798)   File "/usr/local/lib/python3.12/dist-packages/triton/runtime/jit.py", line 756, in run
(EngineCore_DP0 pid=58798)     launch_metadata = kernel.launch_metadata(grid, stream, *bound_args.values())
(EngineCore_DP0 pid=58798)                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798)   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 490, in launch_metadata
(EngineCore_DP0 pid=58798)     self._init_handles()
(EngineCore_DP0 pid=58798)   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 473, in _init_handles
(EngineCore_DP0 pid=58798)     self.module, self.function, self.n_regs, self.n_spills, self.n_max_threads = driver.active.utils.load_binary(
(EngineCore_DP0 pid=58798)                                                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=58798) RuntimeError: Triton Error [CUDA]: an illegal memory access was encountered
[rank0]:[W126 02:24:24.218424741 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

ERROR: Test failed for M=65536

========== M=512 ==========
Time: 2026-01-26 05:50:25
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_6
Params: prompt_len=512, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_6 --dataset-name random --input-len 512 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 513 --max-num-batched-tokens 513 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Qwen2.5-14B-INT8_M512.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 05:50:34 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 05:50:35 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=253218) WARNING 01-26 05:50:41 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=253218) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=253218) WARNING 01-26 05:51:11 [backends.py:609] Failed to read file <frozen os>
Throughput: 9.70 requests/s, 4978.09 total tokens/s, 9.70 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128

STDERR:
[2026-01-26 05:50:34] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:50:34] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:50:34] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:50:34] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:50:34] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:50:34] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:50:34] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:50:34] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:50:34] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:50:34] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:50:34] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:50:34] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:50:34] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:50:34] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 05:50:40] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:50:40] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:50:40] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:50:40] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:50:40] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:50:40] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:50:40] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:50:40] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:50:40] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:50:40] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:50:40] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:50:40] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:50:40] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:50:40] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=253218) [2026-01-26 05:50:42] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=253218) [2026-01-26 05:50:42] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=253218) [2026-01-26 05:50:42] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=253218) [2026-01-26 05:50:42] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=253218) [2026-01-26 05:50:42] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=253218) [2026-01-26 05:50:42] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=253218) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=253218) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:05<00:15,  5.04s/it]
(EngineCore_DP0 pid=253218) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:09<00:09,  4.75s/it]
(EngineCore_DP0 pid=253218) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:10<00:03,  3.14s/it]
(EngineCore_DP0 pid=253218) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:15<00:00,  3.81s/it]
(EngineCore_DP0 pid=253218) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:15<00:00,  3.91s/it]
(EngineCore_DP0 pid=253218) 
(EngineCore_DP0 pid=253218) [2026-01-26 05:50:58] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 6848] -> 1D uint8
(EngineCore_DP0 pid=253218) [2026-01-26 05:50:58] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 36929536 bytes
(EngineCore_DP0 pid=253218) [2026-01-26 05:50:58] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 6848] -> 1D uint8
(EngineCore_DP0 pid=253218) [2026-01-26 05:50:58] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 26378240 bytes
(EngineCore_DP0 pid=253218) [2026-01-26 05:50:58] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 6848] -> 1D uint8
(EngineCore_DP0 pid=253218) [2026-01-26 05:50:58] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 142442496 bytes
(EngineCore_DP0 pid=253218) [2026-01-26 05:50:58] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 18432] -> 1D uint8
(EngineCore_DP0 pid=253218) [2026-01-26 05:50:59] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 70778880 bytes
(EngineCore_DP0 pid=253218) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  1.74it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:01<00:00,  1.58it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:01<00:00,  1.60it/s]
(EngineCore_DP0 pid=253218) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  3.73it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  3.73it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  34%|███▍      | 44/128 [00:00<00:00, 430.69it/s]
Adding requests:  71%|███████   | 91/128 [00:00<00:00, 448.84it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 449.94it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:32,  3.90it/s, est. speed input: 1994.70 toks/s, output: 3.90 toks/s]
Processed prompts:   2%|▏         | 2/128 [00:00<00:20,  6.05it/s, est. speed input: 2861.75 toks/s, output: 5.59 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:16,  7.36it/s, est. speed input: 3347.52 toks/s, output: 6.54 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:15,  8.19it/s, est. speed input: 3659.09 toks/s, output: 7.15 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:14,  8.75it/s, est. speed input: 3876.98 toks/s, output: 7.57 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:12,  9.32it/s, est. speed input: 4161.92 toks/s, output: 8.13 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:00<00:12,  9.49it/s, est. speed input: 4261.46 toks/s, output: 8.32 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:01<00:12,  9.62it/s, est. speed input: 4341.42 toks/s, output: 8.48 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:01<00:12,  9.69it/s, est. speed input: 4403.80 toks/s, output: 8.60 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:01<00:11,  9.87it/s, est. speed input: 4515.54 toks/s, output: 8.82 toks/s]
Processed prompts:  11%|█         | 14/128 [00:01<00:11,  9.99it/s, est. speed input: 4604.22 toks/s, output: 8.99 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:01<00:11, 10.03it/s, est. speed input: 4667.56 toks/s, output: 9.12 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:01<00:10, 10.07it/s, est. speed input: 4720.50 toks/s, output: 9.22 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:02<00:10, 10.04it/s, est. speed input: 4757.69 toks/s, output: 9.29 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:02<00:10, 10.04it/s, est. speed input: 4790.05 toks/s, output: 9.36 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:02<00:10, 10.08it/s, est. speed input: 4821.84 toks/s, output: 9.42 toks/s]
Processed prompts:  20%|██        | 26/128 [00:02<00:10, 10.09it/s, est. speed input: 4847.24 toks/s, output: 9.47 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:02<00:09, 10.08it/s, est. speed input: 4867.67 toks/s, output: 9.51 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:03<00:09, 10.06it/s, est. speed input: 4884.61 toks/s, output: 9.54 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:03<00:09, 10.03it/s, est. speed input: 4897.50 toks/s, output: 9.57 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:03<00:09, 10.02it/s, est. speed input: 4909.93 toks/s, output: 9.59 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:03<00:09, 10.02it/s, est. speed input: 4921.81 toks/s, output: 9.61 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:03<00:08, 10.02it/s, est. speed input: 4932.63 toks/s, output: 9.63 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:04<00:08, 10.01it/s, est. speed input: 4941.49 toks/s, output: 9.65 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:04<00:08,  9.98it/s, est. speed input: 4947.30 toks/s, output: 9.66 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:04<00:08,  9.97it/s, est. speed input: 4950.56 toks/s, output: 9.67 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:04<00:08, 10.01it/s, est. speed input: 4959.57 toks/s, output: 9.69 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:04<00:08, 10.05it/s, est. speed input: 4968.94 toks/s, output: 9.70 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:05<00:07, 10.04it/s, est. speed input: 4975.35 toks/s, output: 9.72 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:05<00:07, 10.04it/s, est. speed input: 4981.87 toks/s, output: 9.73 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:05<00:07, 10.04it/s, est. speed input: 4987.39 toks/s, output: 9.74 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:05<00:07, 10.04it/s, est. speed input: 4992.93 toks/s, output: 9.75 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:05<00:07, 10.07it/s, est. speed input: 4999.84 toks/s, output: 9.77 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:06<00:06, 10.09it/s, est. speed input: 5006.08 toks/s, output: 9.78 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:06<00:06, 10.05it/s, est. speed input: 5008.95 toks/s, output: 9.78 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:06<00:01, 34.93it/s, est. speed input: 6141.38 toks/s, output: 11.99 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:06<00:02, 20.03it/s, est. speed input: 6059.95 toks/s, output: 11.84 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:07<00:02, 16.34it/s, est. speed input: 6008.22 toks/s, output: 11.73 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:07<00:02, 14.25it/s, est. speed input: 5967.55 toks/s, output: 11.66 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:08<00:02, 13.12it/s, est. speed input: 5937.07 toks/s, output: 11.60 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:08<00:02, 12.24it/s, est. speed input: 5907.23 toks/s, output: 11.54 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:08<00:02, 11.76it/s, est. speed input: 5888.07 toks/s, output: 11.50 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:08<00:02, 11.37it/s, est. speed input: 5871.30 toks/s, output: 11.47 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:08<00:02, 11.04it/s, est. speed input: 5854.97 toks/s, output: 11.44 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:09<00:02, 10.75it/s, est. speed input: 5837.82 toks/s, output: 11.40 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:09<00:02, 10.56it/s, est. speed input: 5823.13 toks/s, output: 11.37 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:09<00:01, 10.45it/s, est. speed input: 5810.11 toks/s, output: 11.35 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:09<00:01, 10.35it/s, est. speed input: 5797.05 toks/s, output: 11.32 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:09<00:01, 10.25it/s, est. speed input: 5783.64 toks/s, output: 11.30 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:10<00:01, 10.20it/s, est. speed input: 5771.54 toks/s, output: 11.27 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:10<00:01, 10.18it/s, est. speed input: 5760.11 toks/s, output: 11.25 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:10<00:00, 10.13it/s, est. speed input: 5748.05 toks/s, output: 11.23 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:10<00:00, 10.12it/s, est. speed input: 5737.55 toks/s, output: 11.21 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:10<00:00, 10.10it/s, est. speed input: 5726.68 toks/s, output: 11.18 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:11<00:00, 10.08it/s, est. speed input: 5716.10 toks/s, output: 11.16 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:11<00:00, 10.04it/s, est. speed input: 5704.87 toks/s, output: 11.14 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:11<00:00, 10.05it/s, est. speed input: 5695.65 toks/s, output: 11.12 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:11<00:00, 10.05it/s, est. speed input: 5695.65 toks/s, output: 11.12 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:11<00:00, 11.12it/s, est. speed input: 5695.65 toks/s, output: 11.12 toks/s]
[rank0]:[W126 05:51:47.763154497 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=1024 ==========
Time: 2026-01-26 05:51:50
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 1025 --max-num-batched-tokens 1025 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Qwen2.5-14B-INT8_M1024.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 05:51:59 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 05:52:00 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=254698) WARNING 01-26 05:52:08 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=254698) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=254698) WARNING 01-26 05:52:38 [backends.py:609] Failed to read file <frozen os>
Throughput: 9.71 requests/s, 9948.15 total tokens/s, 9.71 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128

STDERR:
[2026-01-26 05:51:59] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:51:59] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:51:59] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:51:59] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:51:59] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:51:59] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:51:59] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:51:59] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:51:59] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:51:59] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:51:59] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:51:59] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:51:59] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:51:59] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 05:52:07] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:52:07] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:52:07] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:52:07] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:52:07] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:52:07] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:52:07] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:52:07] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:52:07] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:52:07] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:52:07] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:52:07] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:52:07] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:52:07] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=254698) [2026-01-26 05:52:08] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=254698) [2026-01-26 05:52:08] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=254698) [2026-01-26 05:52:08] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=254698) [2026-01-26 05:52:08] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=254698) [2026-01-26 05:52:08] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=254698) [2026-01-26 05:52:08] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=254698) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=254698) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:03<00:10,  3.48s/it]
(EngineCore_DP0 pid=254698) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:08<00:08,  4.11s/it]
(EngineCore_DP0 pid=254698) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:09<00:02,  2.79s/it]
(EngineCore_DP0 pid=254698) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:14<00:00,  3.62s/it]
(EngineCore_DP0 pid=254698) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:14<00:00,  3.53s/it]
(EngineCore_DP0 pid=254698) 
(EngineCore_DP0 pid=254698) [2026-01-26 05:52:23] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 6848] -> 1D uint8
(EngineCore_DP0 pid=254698) [2026-01-26 05:52:23] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 36929536 bytes
(EngineCore_DP0 pid=254698) [2026-01-26 05:52:23] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 6848] -> 1D uint8
(EngineCore_DP0 pid=254698) [2026-01-26 05:52:23] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 26378240 bytes
(EngineCore_DP0 pid=254698) [2026-01-26 05:52:23] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 6848] -> 1D uint8
(EngineCore_DP0 pid=254698) [2026-01-26 05:52:23] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 142442496 bytes
(EngineCore_DP0 pid=254698) [2026-01-26 05:52:23] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 18432] -> 1D uint8
(EngineCore_DP0 pid=254698) [2026-01-26 05:52:23] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 70778880 bytes
(EngineCore_DP0 pid=254698) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  2.00it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  3.08it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  2.85it/s]
(EngineCore_DP0 pid=254698) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  4.66it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  4.66it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  17%|█▋        | 22/128 [00:00<00:00, 217.85it/s]
Adding requests:  37%|███▋      | 47/128 [00:00<00:00, 234.20it/s]
Adding requests:  57%|█████▋    | 73/128 [00:00<00:00, 241.21it/s]
Adding requests:  77%|███████▋  | 98/128 [00:00<00:00, 240.58it/s]
Adding requests:  96%|█████████▌| 123/128 [00:00<00:00, 240.46it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 238.50it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:05, 22.58it/s, est. speed input: 23126.70 toks/s, output: 22.58 toks/s]
Processed prompts:   5%|▍         | 6/128 [00:00<00:09, 12.99it/s, est. speed input: 14207.88 toks/s, output: 13.87 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:00<00:10, 11.73it/s, est. speed input: 12952.77 toks/s, output: 12.65 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:00<00:10, 11.12it/s, est. speed input: 12330.39 toks/s, output: 12.04 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:01<00:10, 10.76it/s, est. speed input: 11944.93 toks/s, output: 11.66 toks/s]
Processed prompts:  11%|█         | 14/128 [00:01<00:10, 10.45it/s, est. speed input: 11638.75 toks/s, output: 11.37 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:01<00:10, 10.30it/s, est. speed input: 11440.99 toks/s, output: 11.17 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:01<00:10, 10.17it/s, est. speed input: 11279.32 toks/s, output: 11.01 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:01<00:10, 10.09it/s, est. speed input: 11152.69 toks/s, output: 10.89 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:02<00:10, 10.02it/s, est. speed input: 11047.44 toks/s, output: 10.79 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:02<00:10,  9.96it/s, est. speed input: 10957.46 toks/s, output: 10.70 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:02<00:10,  9.93it/s, est. speed input: 10918.91 toks/s, output: 10.66 toks/s]
Processed prompts:  20%|██        | 26/128 [00:02<00:10,  9.92it/s, est. speed input: 10885.28 toks/s, output: 10.63 toks/s]
Processed prompts:  21%|██        | 27/128 [00:02<00:10,  9.90it/s, est. speed input: 10851.77 toks/s, output: 10.60 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:02<00:10,  9.89it/s, est. speed input: 10822.96 toks/s, output: 10.57 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:02<00:10,  9.86it/s, est. speed input: 10792.18 toks/s, output: 10.54 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:02<00:09,  9.86it/s, est. speed input: 10767.49 toks/s, output: 10.52 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:02<00:09,  9.83it/s, est. speed input: 10740.93 toks/s, output: 10.49 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:03<00:09,  9.82it/s, est. speed input: 10717.43 toks/s, output: 10.47 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:03<00:09,  9.79it/s, est. speed input: 10692.70 toks/s, output: 10.44 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:03<00:09,  9.91it/s, est. speed input: 10669.53 toks/s, output: 10.42 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:03<00:09, 10.05it/s, est. speed input: 10661.54 toks/s, output: 10.41 toks/s]
Processed prompts:  30%|███       | 39/128 [00:03<00:08, 10.11it/s, est. speed input: 10651.58 toks/s, output: 10.40 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:03<00:08, 10.14it/s, est. speed input: 10640.71 toks/s, output: 10.39 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:04<00:08, 10.16it/s, est. speed input: 10630.86 toks/s, output: 10.38 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:04<00:08, 10.13it/s, est. speed input: 10615.93 toks/s, output: 10.37 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:04<00:08, 10.12it/s, est. speed input: 10603.68 toks/s, output: 10.36 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:04<00:07, 10.11it/s, est. speed input: 10592.91 toks/s, output: 10.34 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:04<00:07, 10.10it/s, est. speed input: 10582.16 toks/s, output: 10.33 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:05<00:07, 10.16it/s, est. speed input: 10580.46 toks/s, output: 10.33 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:05<00:07, 10.11it/s, est. speed input: 10567.57 toks/s, output: 10.32 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:05<00:07, 10.09it/s, est. speed input: 10557.90 toks/s, output: 10.31 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:05<00:06, 10.11it/s, est. speed input: 10551.88 toks/s, output: 10.30 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:05<00:06, 10.09it/s, est. speed input: 10543.29 toks/s, output: 10.30 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:06<00:06, 10.10it/s, est. speed input: 10537.45 toks/s, output: 10.29 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:06<00:06, 10.02it/s, est. speed input: 10522.43 toks/s, output: 10.28 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:06<00:06, 10.05it/s, est. speed input: 10517.93 toks/s, output: 10.27 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:06<00:05, 10.08it/s, est. speed input: 10514.53 toks/s, output: 10.27 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:06<00:05, 10.11it/s, est. speed input: 10511.36 toks/s, output: 10.26 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:07<00:05, 10.13it/s, est. speed input: 10509.09 toks/s, output: 10.26 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:07<00:05, 10.11it/s, est. speed input: 10503.28 toks/s, output: 10.26 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:07<00:05, 10.13it/s, est. speed input: 10500.94 toks/s, output: 10.25 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:07<00:04, 10.15it/s, est. speed input: 10500.04 toks/s, output: 10.25 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:07<00:04, 10.13it/s, est. speed input: 10495.76 toks/s, output: 10.25 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:08<00:04, 10.07it/s, est. speed input: 10487.29 toks/s, output: 10.24 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:08<00:04, 10.05it/s, est. speed input: 10481.17 toks/s, output: 10.24 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:08<00:04,  9.97it/s, est. speed input: 10470.24 toks/s, output: 10.22 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:08<00:04,  9.95it/s, est. speed input: 10466.25 toks/s, output: 10.22 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:08<00:03,  9.94it/s, est. speed input: 10462.16 toks/s, output: 10.22 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:08<00:03,  9.94it/s, est. speed input: 10459.12 toks/s, output: 10.21 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:08<00:03,  9.95it/s, est. speed input: 10456.24 toks/s, output: 10.21 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:09<00:03,  9.94it/s, est. speed input: 10453.00 toks/s, output: 10.21 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:09<00:03,  9.93it/s, est. speed input: 10449.60 toks/s, output: 10.20 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:09<00:03,  9.93it/s, est. speed input: 10446.55 toks/s, output: 10.20 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:09<00:03,  9.87it/s, est. speed input: 10441.02 toks/s, output: 10.20 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:09<00:03,  9.84it/s, est. speed input: 10436.31 toks/s, output: 10.19 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:09<00:03,  9.84it/s, est. speed input: 10432.41 toks/s, output: 10.19 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:09<00:03,  9.86it/s, est. speed input: 10429.23 toks/s, output: 10.18 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:09<00:02,  9.89it/s, est. speed input: 10426.98 toks/s, output: 10.18 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:09<00:02,  9.95it/s, est. speed input: 10423.85 toks/s, output: 10.18 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:10<00:02,  9.96it/s, est. speed input: 10421.91 toks/s, output: 10.18 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:10<00:02,  9.97it/s, est. speed input: 10417.85 toks/s, output: 10.17 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:10<00:02,  9.96it/s, est. speed input: 10413.56 toks/s, output: 10.17 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:10<00:02,  9.93it/s, est. speed input: 10409.81 toks/s, output: 10.17 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:10<00:02,  9.93it/s, est. speed input: 10407.57 toks/s, output: 10.16 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:10<00:01,  9.97it/s, est. speed input: 10404.95 toks/s, output: 10.16 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:11<00:01,  9.98it/s, est. speed input: 10401.78 toks/s, output: 10.16 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:11<00:01,  9.98it/s, est. speed input: 10400.22 toks/s, output: 10.16 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:11<00:01,  9.98it/s, est. speed input: 10397.30 toks/s, output: 10.15 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:11<00:01,  9.92it/s, est. speed input: 10393.07 toks/s, output: 10.15 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:11<00:01,  9.88it/s, est. speed input: 10389.51 toks/s, output: 10.15 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:11<00:01,  9.86it/s, est. speed input: 10386.45 toks/s, output: 10.14 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:11<00:00,  9.86it/s, est. speed input: 10383.91 toks/s, output: 10.14 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:11<00:00,  9.86it/s, est. speed input: 10381.51 toks/s, output: 10.14 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:11<00:00,  9.84it/s, est. speed input: 10378.22 toks/s, output: 10.13 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:12<00:00,  9.85it/s, est. speed input: 10376.02 toks/s, output: 10.13 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:12<00:00,  9.87it/s, est. speed input: 10374.18 toks/s, output: 10.13 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:12<00:00,  9.88it/s, est. speed input: 10372.25 toks/s, output: 10.13 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:12<00:00,  9.86it/s, est. speed input: 10369.76 toks/s, output: 10.13 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:12<00:00,  9.85it/s, est. speed input: 10367.08 toks/s, output: 10.12 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:12<00:00,  9.83it/s, est. speed input: 10364.20 toks/s, output: 10.12 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:12<00:00,  9.82it/s, est. speed input: 10361.49 toks/s, output: 10.12 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:12<00:00,  9.82it/s, est. speed input: 10361.49 toks/s, output: 10.12 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:12<00:00, 10.12it/s, est. speed input: 10361.49 toks/s, output: 10.12 toks/s]
[rank0]:[W126 05:53:13.476951213 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=2048 ==========
Time: 2026-01-26 05:53:15
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=256, max_num_seqs=2
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 256 --max-num-seqs 2 --max-model-len 1025 --max-num-batched-tokens 2048 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Qwen2.5-14B-INT8_M2048.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 05:53:24 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 05:53:25 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=256134) WARNING 01-26 05:53:33 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=256134) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=256134) WARNING 01-26 05:53:52 [backends.py:609] Failed to read file <frozen os>
Throughput: 13.09 requests/s, 13419.97 total tokens/s, 13.09 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256

STDERR:
[2026-01-26 05:53:24] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:53:24] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:53:24] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:53:24] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:53:24] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:53:24] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:53:24] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:53:24] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:53:24] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:53:24] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:53:24] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:53:24] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:53:24] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:53:24] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 05:53:32] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:53:32] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:53:32] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:53:32] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:53:32] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:53:32] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:53:32] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:53:32] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:53:32] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:53:32] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:53:32] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:53:32] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:53:32] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:53:32] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=256134) [2026-01-26 05:53:34] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=256134) [2026-01-26 05:53:34] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=256134) [2026-01-26 05:53:34] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=256134) [2026-01-26 05:53:34] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=256134) [2026-01-26 05:53:34] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=256134) [2026-01-26 05:53:34] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=256134) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=256134) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:01<00:03,  1.26s/it]
(EngineCore_DP0 pid=256134) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:02<00:02,  1.27s/it]
(EngineCore_DP0 pid=256134) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.15it/s]
(EngineCore_DP0 pid=256134) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.00it/s]
(EngineCore_DP0 pid=256134) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.03s/it]
(EngineCore_DP0 pid=256134) 
(EngineCore_DP0 pid=256134) [2026-01-26 05:53:39] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 6848] -> 1D uint8
(EngineCore_DP0 pid=256134) [2026-01-26 05:53:39] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 36929536 bytes
(EngineCore_DP0 pid=256134) [2026-01-26 05:53:39] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 6848] -> 1D uint8
(EngineCore_DP0 pid=256134) [2026-01-26 05:53:39] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 26378240 bytes
(EngineCore_DP0 pid=256134) [2026-01-26 05:53:39] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 6848] -> 1D uint8
(EngineCore_DP0 pid=256134) [2026-01-26 05:53:39] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 142442496 bytes
(EngineCore_DP0 pid=256134) [2026-01-26 05:53:39] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 18432] -> 1D uint8
(EngineCore_DP0 pid=256134) [2026-01-26 05:53:39] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 70778880 bytes
(EngineCore_DP0 pid=256134) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  33%|███▎      | 1/3 [00:00<00:00,  2.59it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  67%|██████▋   | 2/3 [00:00<00:00,  2.83it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:01<00:00,  2.97it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:01<00:00,  2.90it/s]
(EngineCore_DP0 pid=256134) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 1/2 [00:00<00:00,  4.81it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  5.28it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  5.20it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:   9%|▊         | 22/256 [00:00<00:01, 218.42it/s]
Adding requests:  18%|█▊        | 47/256 [00:00<00:00, 232.26it/s]
Adding requests:  29%|██▉       | 74/256 [00:00<00:00, 244.74it/s]
Adding requests:  39%|███▊      | 99/256 [00:00<00:00, 244.03it/s]
Adding requests:  49%|████▉     | 126/256 [00:00<00:00, 250.47it/s]
Adding requests:  59%|█████▉    | 152/256 [00:00<00:00, 250.55it/s]
Adding requests:  70%|██████▉   | 178/256 [00:00<00:00, 252.44it/s]
Adding requests:  80%|████████  | 205/256 [00:00<00:00, 256.21it/s]
Adding requests:  91%|█████████ | 233/256 [00:00<00:00, 261.31it/s]
Adding requests: 100%|██████████| 256/256 [00:01<00:00, 251.92it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▍         | 12/256 [00:00<00:04, 53.86it/s, est. speed input: 55160.74 toks/s, output: 53.86 toks/s]
Processed prompts:  13%|█▎        | 34/256 [00:00<00:02, 78.52it/s, est. speed input: 76695.04 toks/s, output: 74.89 toks/s]
Processed prompts:  16%|█▋        | 42/256 [00:01<00:06, 33.58it/s, est. speed input: 40774.71 toks/s, output: 39.82 toks/s]
Processed prompts:  18%|█▊        | 47/256 [00:01<00:07, 28.00it/s, est. speed input: 35518.75 toks/s, output: 34.69 toks/s]
Processed prompts:  20%|█▉        | 51/256 [00:01<00:08, 23.33it/s, est. speed input: 31569.24 toks/s, output: 30.83 toks/s]
Processed prompts:  21%|██        | 54/256 [00:01<00:10, 19.16it/s, est. speed input: 28305.76 toks/s, output: 27.64 toks/s]
Processed prompts:  22%|██▏       | 57/256 [00:02<00:10, 19.30it/s, est. speed input: 27740.49 toks/s, output: 27.09 toks/s]
Processed prompts:  23%|██▎       | 60/256 [00:02<00:12, 16.12it/s, est. speed input: 25563.18 toks/s, output: 24.96 toks/s]
Processed prompts:  24%|██▍       | 62/256 [00:02<00:12, 15.56it/s, est. speed input: 24860.52 toks/s, output: 24.28 toks/s]
Processed prompts:  25%|██▌       | 64/256 [00:02<00:12, 15.08it/s, est. speed input: 24240.94 toks/s, output: 23.67 toks/s]
Processed prompts:  26%|██▌       | 66/256 [00:02<00:12, 14.67it/s, est. speed input: 23686.91 toks/s, output: 23.13 toks/s]
Processed prompts:  27%|██▋       | 68/256 [00:03<00:13, 14.31it/s, est. speed input: 23180.74 toks/s, output: 22.64 toks/s]
Processed prompts:  27%|██▋       | 70/256 [00:03<00:13, 14.04it/s, est. speed input: 22725.77 toks/s, output: 22.19 toks/s]
Processed prompts:  28%|██▊       | 72/256 [00:03<00:13, 13.84it/s, est. speed input: 22312.46 toks/s, output: 21.79 toks/s]
Processed prompts:  29%|██▉       | 74/256 [00:03<00:13, 13.70it/s, est. speed input: 21935.70 toks/s, output: 21.42 toks/s]
Processed prompts:  30%|██▉       | 76/256 [00:03<00:13, 13.57it/s, est. speed input: 21585.73 toks/s, output: 21.08 toks/s]
Processed prompts:  30%|███       | 78/256 [00:03<00:13, 13.49it/s, est. speed input: 21267.56 toks/s, output: 20.77 toks/s]
Processed prompts:  31%|███▏      | 80/256 [00:03<00:13, 13.43it/s, est. speed input: 20971.11 toks/s, output: 20.48 toks/s]
Processed prompts:  32%|███▏      | 82/256 [00:04<00:13, 13.38it/s, est. speed input: 20696.38 toks/s, output: 20.21 toks/s]
Processed prompts:  33%|███▎      | 84/256 [00:04<00:12, 13.36it/s, est. speed input: 20443.59 toks/s, output: 19.96 toks/s]
Processed prompts:  34%|███▎      | 86/256 [00:04<00:12, 13.35it/s, est. speed input: 20209.18 toks/s, output: 19.74 toks/s]
Processed prompts:  34%|███▍      | 88/256 [00:04<00:12, 13.33it/s, est. speed input: 19989.73 toks/s, output: 19.52 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:04<00:12, 13.31it/s, est. speed input: 19782.33 toks/s, output: 19.32 toks/s]
Processed prompts:  36%|███▌      | 92/256 [00:04<00:12, 13.32it/s, est. speed input: 19590.68 toks/s, output: 19.13 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:04<00:12, 13.33it/s, est. speed input: 19411.68 toks/s, output: 18.96 toks/s]
Processed prompts:  38%|███▊      | 96/256 [00:05<00:12, 13.33it/s, est. speed input: 19243.13 toks/s, output: 18.79 toks/s]
Processed prompts:  38%|███▊      | 98/256 [00:05<00:11, 13.33it/s, est. speed input: 19083.24 toks/s, output: 18.64 toks/s]
Processed prompts:  39%|███▉      | 100/256 [00:05<00:11, 13.32it/s, est. speed input: 18931.39 toks/s, output: 18.49 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:05<00:11, 13.33it/s, est. speed input: 18789.34 toks/s, output: 18.35 toks/s]
Processed prompts:  41%|████      | 104/256 [00:05<00:11, 13.32it/s, est. speed input: 18653.51 toks/s, output: 18.22 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:05<00:11, 13.33it/s, est. speed input: 18525.79 toks/s, output: 18.09 toks/s]
Processed prompts:  42%|████▏     | 108/256 [00:06<00:11, 13.33it/s, est. speed input: 18404.63 toks/s, output: 17.97 toks/s]
Processed prompts:  43%|████▎     | 110/256 [00:06<00:10, 13.33it/s, est. speed input: 18288.04 toks/s, output: 17.86 toks/s]
Processed prompts:  44%|████▍     | 112/256 [00:06<00:10, 13.32it/s, est. speed input: 18176.47 toks/s, output: 17.75 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:06<00:10, 13.30it/s, est. speed input: 18068.94 toks/s, output: 17.65 toks/s]
Processed prompts:  45%|████▌     | 116/256 [00:06<00:10, 13.30it/s, est. speed input: 17968.21 toks/s, output: 17.55 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:06<00:10, 13.30it/s, est. speed input: 17871.19 toks/s, output: 17.45 toks/s]
Processed prompts:  47%|████▋     | 120/256 [00:06<00:10, 13.29it/s, est. speed input: 17778.18 toks/s, output: 17.36 toks/s]
Processed prompts:  48%|████▊     | 122/256 [00:07<00:10, 13.29it/s, est. speed input: 17688.70 toks/s, output: 17.27 toks/s]
Processed prompts:  48%|████▊     | 124/256 [00:07<00:09, 13.28it/s, est. speed input: 17602.56 toks/s, output: 17.19 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:07<00:09, 13.28it/s, est. speed input: 17520.75 toks/s, output: 17.11 toks/s]
Processed prompts:  50%|█████     | 128/256 [00:07<00:09, 13.30it/s, est. speed input: 17443.82 toks/s, output: 17.03 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:07<00:09, 13.31it/s, est. speed input: 17369.42 toks/s, output: 16.96 toks/s]
Processed prompts:  52%|█████▏    | 132/256 [00:07<00:09, 13.30it/s, est. speed input: 17296.55 toks/s, output: 16.89 toks/s]
Processed prompts:  52%|█████▏    | 134/256 [00:07<00:09, 13.31it/s, est. speed input: 17228.22 toks/s, output: 16.82 toks/s]
Processed prompts:  53%|█████▎    | 136/256 [00:08<00:09, 13.31it/s, est. speed input: 17161.74 toks/s, output: 16.76 toks/s]
Processed prompts:  54%|█████▍    | 138/256 [00:08<00:08, 13.32it/s, est. speed input: 17097.89 toks/s, output: 16.70 toks/s]
Processed prompts:  55%|█████▍    | 140/256 [00:08<00:08, 13.32it/s, est. speed input: 17036.50 toks/s, output: 16.64 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:08<00:08, 13.32it/s, est. speed input: 16977.11 toks/s, output: 16.58 toks/s]
Processed prompts:  56%|█████▋    | 144/256 [00:08<00:08, 13.31it/s, est. speed input: 16919.03 toks/s, output: 16.52 toks/s]
Processed prompts:  57%|█████▋    | 146/256 [00:08<00:08, 13.29it/s, est. speed input: 16861.73 toks/s, output: 16.47 toks/s]
Processed prompts:  58%|█████▊    | 148/256 [00:09<00:08, 13.29it/s, est. speed input: 16807.54 toks/s, output: 16.41 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:09<00:07, 13.31it/s, est. speed input: 16755.97 toks/s, output: 16.36 toks/s]
Processed prompts:  59%|█████▉    | 152/256 [00:09<00:07, 13.30it/s, est. speed input: 16705.36 toks/s, output: 16.31 toks/s]
Processed prompts:  60%|██████    | 154/256 [00:09<00:07, 13.29it/s, est. speed input: 16655.35 toks/s, output: 16.26 toks/s]
Processed prompts:  61%|██████    | 156/256 [00:09<00:07, 13.28it/s, est. speed input: 16607.21 toks/s, output: 16.22 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:09<00:07, 13.28it/s, est. speed input: 16560.69 toks/s, output: 16.17 toks/s]
Processed prompts:  62%|██████▎   | 160/256 [00:09<00:07, 13.26it/s, est. speed input: 16514.81 toks/s, output: 16.13 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:10<00:07, 13.26it/s, est. speed input: 16470.43 toks/s, output: 16.08 toks/s]
Processed prompts:  64%|██████▍   | 164/256 [00:10<00:06, 13.25it/s, est. speed input: 16427.16 toks/s, output: 16.04 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:10<00:06, 13.25it/s, est. speed input: 16385.92 toks/s, output: 16.00 toks/s]
Processed prompts:  66%|██████▌   | 168/256 [00:10<00:06, 13.26it/s, est. speed input: 16346.17 toks/s, output: 15.96 toks/s]
Processed prompts:  66%|██████▋   | 170/256 [00:10<00:06, 13.26it/s, est. speed input: 16306.72 toks/s, output: 15.92 toks/s]
Processed prompts:  67%|██████▋   | 172/256 [00:10<00:06, 13.26it/s, est. speed input: 16268.64 toks/s, output: 15.89 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:10<00:06, 13.27it/s, est. speed input: 16232.22 toks/s, output: 15.85 toks/s]
Processed prompts:  69%|██████▉   | 176/256 [00:11<00:06, 13.29it/s, est. speed input: 16197.38 toks/s, output: 15.82 toks/s]
Processed prompts:  70%|██████▉   | 178/256 [00:11<00:05, 13.29it/s, est. speed input: 16163.22 toks/s, output: 15.78 toks/s]
Processed prompts:  70%|███████   | 180/256 [00:11<00:05, 13.31it/s, est. speed input: 16130.24 toks/s, output: 15.75 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:11<00:05, 13.30it/s, est. speed input: 16097.56 toks/s, output: 15.72 toks/s]
Processed prompts:  72%|███████▏  | 184/256 [00:11<00:05, 13.32it/s, est. speed input: 16066.51 toks/s, output: 15.69 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:11<00:05, 13.30it/s, est. speed input: 16034.74 toks/s, output: 15.66 toks/s]
Processed prompts:  73%|███████▎  | 188/256 [00:12<00:05, 13.28it/s, est. speed input: 16003.69 toks/s, output: 15.63 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:12<00:04, 13.27it/s, est. speed input: 15973.70 toks/s, output: 15.60 toks/s]
Processed prompts:  75%|███████▌  | 192/256 [00:12<00:04, 13.28it/s, est. speed input: 15944.98 toks/s, output: 15.57 toks/s]
Processed prompts:  76%|███████▌  | 194/256 [00:12<00:04, 13.28it/s, est. speed input: 15916.41 toks/s, output: 15.54 toks/s]
Processed prompts:  77%|███████▋  | 196/256 [00:12<00:04, 13.26it/s, est. speed input: 15887.86 toks/s, output: 15.52 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:12<00:04, 13.25it/s, est. speed input: 15860.04 toks/s, output: 15.49 toks/s]
Processed prompts:  78%|███████▊  | 200/256 [00:12<00:04, 13.25it/s, est. speed input: 15833.41 toks/s, output: 15.46 toks/s]
Processed prompts:  79%|███████▉  | 202/256 [00:13<00:04, 13.24it/s, est. speed input: 15806.93 toks/s, output: 15.44 toks/s]
Processed prompts:  80%|███████▉  | 204/256 [00:13<00:03, 13.23it/s, est. speed input: 15780.82 toks/s, output: 15.41 toks/s]
Processed prompts:  80%|████████  | 206/256 [00:13<00:03, 13.23it/s, est. speed input: 15755.61 toks/s, output: 15.39 toks/s]
Processed prompts:  81%|████████▏ | 208/256 [00:13<00:03, 13.23it/s, est. speed input: 15731.04 toks/s, output: 15.36 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:13<00:03, 13.25it/s, est. speed input: 15707.58 toks/s, output: 15.34 toks/s]
Processed prompts:  83%|████████▎ | 212/256 [00:13<00:03, 13.25it/s, est. speed input: 15684.30 toks/s, output: 15.32 toks/s]
Processed prompts:  84%|████████▎ | 214/256 [00:13<00:03, 13.23it/s, est. speed input: 15660.83 toks/s, output: 15.29 toks/s]
Processed prompts:  84%|████████▍ | 216/256 [00:14<00:03, 13.23it/s, est. speed input: 15638.37 toks/s, output: 15.27 toks/s]
Processed prompts:  85%|████████▌ | 218/256 [00:14<00:02, 13.25it/s, est. speed input: 15616.96 toks/s, output: 15.25 toks/s]
Processed prompts:  86%|████████▌ | 220/256 [00:14<00:02, 13.26it/s, est. speed input: 15595.77 toks/s, output: 15.23 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:14<00:02, 13.24it/s, est. speed input: 15574.32 toks/s, output: 15.21 toks/s]
Processed prompts:  88%|████████▊ | 224/256 [00:14<00:02, 13.25it/s, est. speed input: 15554.14 toks/s, output: 15.19 toks/s]
Processed prompts:  88%|████████▊ | 226/256 [00:14<00:02, 13.25it/s, est. speed input: 15533.97 toks/s, output: 15.17 toks/s]
Processed prompts:  89%|████████▉ | 228/256 [00:15<00:02, 13.25it/s, est. speed input: 15514.30 toks/s, output: 15.15 toks/s]
Processed prompts:  90%|████████▉ | 230/256 [00:15<00:01, 13.26it/s, est. speed input: 15495.20 toks/s, output: 15.13 toks/s]
Processed prompts:  91%|█████████ | 232/256 [00:15<00:01, 13.27it/s, est. speed input: 15476.71 toks/s, output: 15.11 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:15<00:01, 13.26it/s, est. speed input: 15458.17 toks/s, output: 15.10 toks/s]
Processed prompts:  92%|█████████▏| 236/256 [00:15<00:01, 13.23it/s, est. speed input: 15438.95 toks/s, output: 15.08 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:15<00:01, 13.22it/s, est. speed input: 15420.54 toks/s, output: 15.06 toks/s]
Processed prompts:  94%|█████████▍| 240/256 [00:15<00:01, 13.21it/s, est. speed input: 15402.34 toks/s, output: 15.04 toks/s]
Processed prompts:  95%|█████████▍| 242/256 [00:16<00:01, 13.21it/s, est. speed input: 15384.79 toks/s, output: 15.02 toks/s]
Processed prompts:  95%|█████████▌| 244/256 [00:16<00:00, 13.22it/s, est. speed input: 15367.90 toks/s, output: 15.01 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:16<00:00, 13.23it/s, est. speed input: 15351.09 toks/s, output: 14.99 toks/s]
Processed prompts:  97%|█████████▋| 248/256 [00:16<00:00, 13.22it/s, est. speed input: 15334.41 toks/s, output: 14.97 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:16<00:00, 13.21it/s, est. speed input: 15317.75 toks/s, output: 14.96 toks/s]
Processed prompts:  98%|█████████▊| 252/256 [00:16<00:00, 13.21it/s, est. speed input: 15301.85 toks/s, output: 14.94 toks/s]
Processed prompts:  99%|█████████▉| 254/256 [00:17<00:00, 13.22it/s, est. speed input: 15286.14 toks/s, output: 14.93 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:17<00:00, 14.66it/s, est. speed input: 15314.97 toks/s, output: 14.96 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:17<00:00, 14.66it/s, est. speed input: 15314.97 toks/s, output: 14.96 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:17<00:00, 14.96it/s, est. speed input: 15314.97 toks/s, output: 14.96 toks/s]
[rank0]:[W126 05:54:34.597204591 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=4096 ==========
Time: 2026-01-26 05:54:37
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=512, max_num_seqs=4
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 512 --max-num-seqs 4 --max-model-len 1025 --max-num-batched-tokens 4096 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Qwen2.5-14B-INT8_M4096.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 05:54:47 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 05:54:48 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=257523) WARNING 01-26 05:54:56 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=257523) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=257523) WARNING 01-26 05:55:17 [backends.py:609] Failed to read file <frozen os>
Throughput: 13.25 requests/s, 13585.49 total tokens/s, 13.25 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512

STDERR:
[2026-01-26 05:54:49] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:54:47] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:54:47] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:54:47] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:54:47] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:54:47] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:54:47] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:54:47] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:54:47] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:54:47] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:54:47] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:54:47] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:54:47] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:54:47] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 05:54:55] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:54:55] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:54:55] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:54:55] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:54:55] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:54:55] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:54:55] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:54:55] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:54:55] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:54:55] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:54:55] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:54:55] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:54:55] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:54:55] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=257523) [2026-01-26 05:54:57] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=257523) [2026-01-26 05:54:57] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=257523) [2026-01-26 05:54:57] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=257523) [2026-01-26 05:54:57] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=257523) [2026-01-26 05:54:57] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=257523) [2026-01-26 05:54:57] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=257523) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=257523) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:01<00:03,  1.26s/it]
(EngineCore_DP0 pid=257523) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:02<00:02,  1.28s/it]
(EngineCore_DP0 pid=257523) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.13it/s]
(EngineCore_DP0 pid=257523) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.03s/it]
(EngineCore_DP0 pid=257523) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.05s/it]
(EngineCore_DP0 pid=257523) 
(EngineCore_DP0 pid=257523) [2026-01-26 05:55:02] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 6848] -> 1D uint8
(EngineCore_DP0 pid=257523) [2026-01-26 05:55:02] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 36929536 bytes
(EngineCore_DP0 pid=257523) [2026-01-26 05:55:02] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 6848] -> 1D uint8
(EngineCore_DP0 pid=257523) [2026-01-26 05:55:02] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 26378240 bytes
(EngineCore_DP0 pid=257523) [2026-01-26 05:55:02] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 6848] -> 1D uint8
(EngineCore_DP0 pid=257523) [2026-01-26 05:55:02] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 142442496 bytes
(EngineCore_DP0 pid=257523) [2026-01-26 05:55:02] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 18432] -> 1D uint8
(EngineCore_DP0 pid=257523) [2026-01-26 05:55:02] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 70778880 bytes
(EngineCore_DP0 pid=257523) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  25%|██▌       | 1/4 [00:00<00:01,  2.75it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 2/4 [00:00<00:00,  3.82it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  75%|███████▌  | 3/4 [00:00<00:00,  4.39it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  4.43it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  4.15it/s]
(EngineCore_DP0 pid=257523) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  33%|███▎      | 1/3 [00:00<00:00,  4.63it/s]
Capturing CUDA graphs (decode, FULL):  67%|██████▋   | 2/3 [00:00<00:00,  5.01it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  5.22it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  5.11it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   5%|▍         | 24/512 [00:00<00:02, 235.35it/s]
Adding requests:  10%|▉         | 50/512 [00:00<00:01, 244.44it/s]
Adding requests:  15%|█▌        | 78/512 [00:00<00:01, 255.82it/s]
Adding requests:  20%|██        | 104/512 [00:00<00:01, 252.40it/s]
Adding requests:  25%|██▌       | 130/512 [00:00<00:01, 250.81it/s]
Adding requests:  31%|███       | 157/512 [00:00<00:01, 254.82it/s]
Adding requests:  36%|███▌      | 185/512 [00:00<00:01, 260.40it/s]
Adding requests:  41%|████▏     | 212/512 [00:00<00:01, 259.72it/s]
Adding requests:  46%|████▋     | 238/512 [00:00<00:01, 258.64it/s]
Adding requests:  52%|█████▏    | 264/512 [00:01<00:00, 255.74it/s]
Adding requests:  57%|█████▋    | 291/512 [00:01<00:00, 259.42it/s]
Adding requests:  62%|██████▎   | 320/512 [00:01<00:00, 266.53it/s]
Adding requests:  68%|██████▊   | 347/512 [00:01<00:00, 267.03it/s]
Adding requests:  73%|███████▎  | 375/512 [00:01<00:00, 269.45it/s]
Adding requests:  79%|███████▉  | 404/512 [00:01<00:00, 273.26it/s]
Adding requests:  84%|████████▍ | 432/512 [00:01<00:00, 273.00it/s]
Adding requests:  90%|████████▉ | 460/512 [00:01<00:00, 269.88it/s]
Adding requests:  96%|█████████▌| 489/512 [00:01<00:00, 273.50it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 263.73it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   4%|▍         | 22/512 [00:00<00:03, 144.91it/s, est. speed input: 148412.17 toks/s, output: 144.92 toks/s]
Processed prompts:   7%|▋         | 37/512 [00:01<00:15, 30.40it/s, est. speed input: 36236.00 toks/s, output: 35.39 toks/s]   
Processed prompts:   9%|▊         | 44/512 [00:01<00:21, 21.82it/s, est. speed input: 27445.04 toks/s, output: 26.80 toks/s]
Processed prompts:  10%|▉         | 49/512 [00:01<00:22, 20.58it/s, est. speed input: 25872.64 toks/s, output: 25.27 toks/s]
Processed prompts:  10%|█         | 53/512 [00:02<00:24, 18.71it/s, est. speed input: 24257.11 toks/s, output: 23.69 toks/s]
Processed prompts:  11%|█         | 56/512 [00:02<00:27, 16.37it/s, est. speed input: 22620.99 toks/s, output: 22.09 toks/s]
Processed prompts:  12%|█▏        | 59/512 [00:02<00:31, 14.61it/s, est. speed input: 21327.52 toks/s, output: 20.83 toks/s]
Processed prompts:  12%|█▏        | 62/512 [00:03<00:33, 13.32it/s, est. speed input: 20280.81 toks/s, output: 19.81 toks/s]
Processed prompts:  13%|█▎        | 66/512 [00:03<00:33, 13.35it/s, est. speed input: 19712.93 toks/s, output: 19.25 toks/s]
Processed prompts:  14%|█▎        | 70/512 [00:03<00:33, 13.37it/s, est. speed input: 19235.83 toks/s, output: 18.78 toks/s]
Processed prompts:  14%|█▍        | 74/512 [00:04<00:32, 13.38it/s, est. speed input: 18828.78 toks/s, output: 18.39 toks/s]
Processed prompts:  15%|█▌        | 78/512 [00:04<00:32, 13.40it/s, est. speed input: 18478.85 toks/s, output: 18.05 toks/s]
Processed prompts:  16%|█▌        | 82/512 [00:04<00:32, 13.40it/s, est. speed input: 18172.94 toks/s, output: 17.75 toks/s]
Processed prompts:  17%|█▋        | 86/512 [00:04<00:31, 13.41it/s, est. speed input: 17904.68 toks/s, output: 17.48 toks/s]
Processed prompts:  18%|█▊        | 90/512 [00:05<00:31, 13.41it/s, est. speed input: 17666.57 toks/s, output: 17.25 toks/s]
Processed prompts:  18%|█▊        | 94/512 [00:05<00:31, 13.42it/s, est. speed input: 17455.07 toks/s, output: 17.05 toks/s]
Processed prompts:  19%|█▉        | 98/512 [00:05<00:30, 13.42it/s, est. speed input: 17264.39 toks/s, output: 16.86 toks/s]
Processed prompts:  20%|█▉        | 102/512 [00:06<00:30, 13.42it/s, est. speed input: 17092.94 toks/s, output: 16.69 toks/s]
Processed prompts:  21%|██        | 106/512 [00:06<00:30, 13.42it/s, est. speed input: 16936.66 toks/s, output: 16.54 toks/s]
Processed prompts:  21%|██▏       | 110/512 [00:06<00:29, 13.41it/s, est. speed input: 16793.69 toks/s, output: 16.40 toks/s]
Processed prompts:  22%|██▏       | 114/512 [00:07<00:29, 13.41it/s, est. speed input: 16663.81 toks/s, output: 16.27 toks/s]
Processed prompts:  23%|██▎       | 118/512 [00:07<00:29, 13.41it/s, est. speed input: 16543.77 toks/s, output: 16.16 toks/s]
Processed prompts:  24%|██▍       | 122/512 [00:07<00:29, 13.41it/s, est. speed input: 16433.35 toks/s, output: 16.05 toks/s]
Processed prompts:  25%|██▍       | 126/512 [00:07<00:28, 13.41it/s, est. speed input: 16330.85 toks/s, output: 15.95 toks/s]
Processed prompts:  25%|██▌       | 130/512 [00:08<00:28, 13.41it/s, est. speed input: 16236.44 toks/s, output: 15.86 toks/s]
Processed prompts:  26%|██▌       | 134/512 [00:08<00:28, 13.41it/s, est. speed input: 16148.70 toks/s, output: 15.77 toks/s]
Processed prompts:  27%|██▋       | 138/512 [00:08<00:27, 13.41it/s, est. speed input: 16066.46 toks/s, output: 15.69 toks/s]
Processed prompts:  28%|██▊       | 142/512 [00:09<00:27, 13.40it/s, est. speed input: 15989.33 toks/s, output: 15.61 toks/s]
Processed prompts:  32%|███▏      | 166/512 [00:09<00:11, 31.11it/s, est. speed input: 17951.11 toks/s, output: 17.53 toks/s]
Processed prompts:  33%|███▎      | 170/512 [00:09<00:13, 26.07it/s, est. speed input: 17821.86 toks/s, output: 17.40 toks/s]
Processed prompts:  34%|███▍      | 174/512 [00:10<00:15, 22.39it/s, est. speed input: 17699.18 toks/s, output: 17.28 toks/s]
Processed prompts:  35%|███▍      | 178/512 [00:10<00:16, 19.76it/s, est. speed input: 17584.63 toks/s, output: 17.17 toks/s]
Processed prompts:  36%|███▌      | 182/512 [00:10<00:18, 17.89it/s, est. speed input: 17476.45 toks/s, output: 17.07 toks/s]
Processed prompts:  36%|███▋      | 186/512 [00:10<00:19, 16.55it/s, est. speed input: 17373.06 toks/s, output: 16.97 toks/s]
Processed prompts:  37%|███▋      | 190/512 [00:11<00:20, 15.60it/s, est. speed input: 17275.45 toks/s, output: 16.87 toks/s]
Processed prompts:  38%|███▊      | 194/512 [00:11<00:21, 14.93it/s, est. speed input: 17182.10 toks/s, output: 16.78 toks/s]
Processed prompts:  39%|███▊      | 198/512 [00:11<00:21, 14.46it/s, est. speed input: 17093.27 toks/s, output: 16.69 toks/s]
Processed prompts:  39%|███▉      | 202/512 [00:12<00:21, 14.12it/s, est. speed input: 17008.63 toks/s, output: 16.61 toks/s]
Processed prompts:  40%|████      | 206/512 [00:12<00:22, 13.90it/s, est. speed input: 16928.89 toks/s, output: 16.53 toks/s]
Processed prompts:  41%|████      | 210/512 [00:12<00:21, 13.74it/s, est. speed input: 16852.80 toks/s, output: 16.46 toks/s]
Processed prompts:  42%|████▏     | 214/512 [00:13<00:21, 13.62it/s, est. speed input: 16779.85 toks/s, output: 16.39 toks/s]
Processed prompts:  43%|████▎     | 218/512 [00:13<00:21, 13.54it/s, est. speed input: 16709.97 toks/s, output: 16.32 toks/s]
Processed prompts:  43%|████▎     | 222/512 [00:13<00:21, 13.48it/s, est. speed input: 16643.04 toks/s, output: 16.25 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:13<00:21, 13.44it/s, est. speed input: 16579.03 toks/s, output: 16.19 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:14<00:21, 13.41it/s, est. speed input: 16517.44 toks/s, output: 16.13 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:14<00:20, 13.38it/s, est. speed input: 16458.34 toks/s, output: 16.07 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:14<00:20, 13.37it/s, est. speed input: 16401.51 toks/s, output: 16.02 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:15<00:20, 13.35it/s, est. speed input: 16346.51 toks/s, output: 15.96 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:15<00:19, 13.34it/s, est. speed input: 16294.28 toks/s, output: 15.91 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:15<00:19, 13.34it/s, est. speed input: 16243.95 toks/s, output: 15.86 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:16<00:19, 13.33it/s, est. speed input: 16195.06 toks/s, output: 15.82 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:16<00:19, 13.33it/s, est. speed input: 16148.36 toks/s, output: 15.77 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:16<00:18, 13.33it/s, est. speed input: 16103.14 toks/s, output: 15.73 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:16<00:18, 13.33it/s, est. speed input: 16059.54 toks/s, output: 15.68 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:17<00:18, 13.32it/s, est. speed input: 16017.16 toks/s, output: 15.64 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:17<00:17, 13.31it/s, est. speed input: 15976.08 toks/s, output: 15.60 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:17<00:17, 13.31it/s, est. speed input: 15936.29 toks/s, output: 15.56 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:18<00:17, 13.30it/s, est. speed input: 15897.62 toks/s, output: 15.53 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:18<00:17, 13.29it/s, est. speed input: 15860.02 toks/s, output: 15.49 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:18<00:16, 13.29it/s, est. speed input: 15823.60 toks/s, output: 15.45 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:19<00:16, 13.29it/s, est. speed input: 15788.49 toks/s, output: 15.42 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:19<00:16, 13.29it/s, est. speed input: 15754.51 toks/s, output: 15.39 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:19<00:15, 13.28it/s, est. speed input: 15721.47 toks/s, output: 15.35 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:19<00:15, 13.28it/s, est. speed input: 15689.41 toks/s, output: 15.32 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:20<00:15, 13.28it/s, est. speed input: 15658.34 toks/s, output: 15.29 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:20<00:14, 13.28it/s, est. speed input: 15628.18 toks/s, output: 15.26 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:20<00:14, 13.28it/s, est. speed input: 15598.68 toks/s, output: 15.23 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:21<00:14, 13.28it/s, est. speed input: 15570.12 toks/s, output: 15.21 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:21<00:14, 13.27it/s, est. speed input: 15542.24 toks/s, output: 15.18 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:21<00:13, 13.28it/s, est. speed input: 15515.46 toks/s, output: 15.15 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:22<00:13, 13.27it/s, est. speed input: 15489.04 toks/s, output: 15.13 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:22<00:13, 13.28it/s, est. speed input: 15463.69 toks/s, output: 15.10 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:22<00:12, 13.28it/s, est. speed input: 15438.99 toks/s, output: 15.08 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:22<00:12, 13.28it/s, est. speed input: 15414.86 toks/s, output: 15.05 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:23<00:12, 13.28it/s, est. speed input: 15391.22 toks/s, output: 15.03 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:23<00:11, 13.28it/s, est. speed input: 15368.32 toks/s, output: 15.01 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:23<00:11, 13.28it/s, est. speed input: 15346.04 toks/s, output: 14.99 toks/s]
Processed prompts:  71%|███████   | 362/512 [00:24<00:11, 13.28it/s, est. speed input: 15324.12 toks/s, output: 14.96 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:24<00:11, 13.27it/s, est. speed input: 15302.68 toks/s, output: 14.94 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [00:24<00:10, 13.27it/s, est. speed input: 15281.89 toks/s, output: 14.92 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [00:25<00:10, 13.27it/s, est. speed input: 15261.65 toks/s, output: 14.90 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [00:25<00:10, 13.27it/s, est. speed input: 15241.84 toks/s, output: 14.88 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [00:25<00:09, 13.28it/s, est. speed input: 15222.55 toks/s, output: 14.87 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [00:25<00:09, 13.28it/s, est. speed input: 15203.82 toks/s, output: 14.85 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [00:26<00:09, 13.27it/s, est. speed input: 15185.26 toks/s, output: 14.83 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [00:26<00:08, 13.27it/s, est. speed input: 15167.22 toks/s, output: 14.81 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [00:26<00:08, 13.28it/s, est. speed input: 15149.71 toks/s, output: 14.79 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [00:27<00:08, 13.28it/s, est. speed input: 15132.41 toks/s, output: 14.78 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [00:27<00:07, 13.27it/s, est. speed input: 15115.51 toks/s, output: 14.76 toks/s]
Processed prompts:  80%|████████  | 410/512 [00:27<00:07, 13.27it/s, est. speed input: 15098.67 toks/s, output: 14.74 toks/s]
Processed prompts:  81%|████████  | 414/512 [00:28<00:07, 13.27it/s, est. speed input: 15082.52 toks/s, output: 14.73 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [00:28<00:07, 13.27it/s, est. speed input: 15066.53 toks/s, output: 14.71 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [00:28<00:06, 13.27it/s, est. speed input: 15051.03 toks/s, output: 14.70 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [00:29<00:06, 13.27it/s, est. speed input: 15035.84 toks/s, output: 14.68 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [00:29<00:06, 13.27it/s, est. speed input: 15021.07 toks/s, output: 14.67 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [00:29<00:05, 13.27it/s, est. speed input: 15006.37 toks/s, output: 14.65 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [00:29<00:05, 13.27it/s, est. speed input: 14992.05 toks/s, output: 14.64 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [00:30<00:05, 13.27it/s, est. speed input: 14977.96 toks/s, output: 14.63 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [00:30<00:04, 13.26it/s, est. speed input: 14964.07 toks/s, output: 14.61 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [00:30<00:04, 13.26it/s, est. speed input: 14950.60 toks/s, output: 14.60 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [00:31<00:04, 13.27it/s, est. speed input: 14937.55 toks/s, output: 14.59 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [00:31<00:04, 13.27it/s, est. speed input: 14924.51 toks/s, output: 14.57 toks/s]
Processed prompts:  90%|█████████ | 462/512 [00:31<00:03, 13.27it/s, est. speed input: 14911.80 toks/s, output: 14.56 toks/s]
Processed prompts:  91%|█████████ | 466/512 [00:32<00:03, 13.27it/s, est. speed input: 14899.50 toks/s, output: 14.55 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [00:32<00:03, 13.27it/s, est. speed input: 14887.31 toks/s, output: 14.54 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [00:32<00:02, 13.28it/s, est. speed input: 14875.44 toks/s, output: 14.53 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [00:32<00:02, 13.27it/s, est. speed input: 14863.58 toks/s, output: 14.52 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [00:33<00:02, 13.27it/s, est. speed input: 14851.98 toks/s, output: 14.50 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [00:33<00:01, 13.27it/s, est. speed input: 14840.68 toks/s, output: 14.49 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [00:33<00:01, 13.27it/s, est. speed input: 14829.53 toks/s, output: 14.48 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [00:34<00:01, 13.27it/s, est. speed input: 14818.69 toks/s, output: 14.47 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [00:34<00:01, 13.28it/s, est. speed input: 14808.01 toks/s, output: 14.46 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [00:34<00:00, 13.27it/s, est. speed input: 14797.39 toks/s, output: 14.45 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [00:35<00:00, 13.28it/s, est. speed input: 14787.31 toks/s, output: 14.44 toks/s]
Processed prompts: 100%|█████████▉| 510/512 [00:35<00:00, 14.31it/s, est. speed input: 14807.47 toks/s, output: 14.46 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:35<00:00, 14.31it/s, est. speed input: 14865.45 toks/s, output: 14.52 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:35<00:00, 14.52it/s, est. speed input: 14865.45 toks/s, output: 14.52 toks/s]
[rank0]:[W126 05:56:17.734636378 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=8192 ==========
Time: 2026-01-26 05:56:20
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=1024, max_num_seqs=8
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 1024 --max-num-seqs 8 --max-model-len 1025 --max-num-batched-tokens 8192 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Qwen2.5-14B-INT8_M8192.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 05:56:34 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 05:56:35 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=259222) WARNING 01-26 05:56:43 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=259222) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=259222) WARNING 01-26 05:57:02 [backends.py:609] Failed to read file <frozen os>
Throughput: 13.02 requests/s, 13341.75 total tokens/s, 13.02 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024

STDERR:
[2026-01-26 05:56:34] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:56:34] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:56:34] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:56:34] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:56:34] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:56:34] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:56:34] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:56:34] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:56:34] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:56:34] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:56:34] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:56:34] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:56:34] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:56:34] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 05:56:42] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:56:42] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:56:42] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:56:42] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:56:42] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:56:42] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:56:42] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:56:42] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:56:42] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:56:42] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:56:42] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:56:42] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:56:42] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:56:42] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=259222) [2026-01-26 05:56:44] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=259222) [2026-01-26 05:56:44] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=259222) [2026-01-26 05:56:44] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=259222) [2026-01-26 05:56:44] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=259222) [2026-01-26 05:56:44] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=259222) [2026-01-26 05:56:44] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=259222) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=259222) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:01<00:03,  1.29s/it]
(EngineCore_DP0 pid=259222) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:02<00:02,  1.26s/it]
(EngineCore_DP0 pid=259222) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.16it/s]
(EngineCore_DP0 pid=259222) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.00it/s]
(EngineCore_DP0 pid=259222) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.03s/it]
(EngineCore_DP0 pid=259222) 
(EngineCore_DP0 pid=259222) [2026-01-26 05:56:49] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 6848] -> 1D uint8
(EngineCore_DP0 pid=259222) [2026-01-26 05:56:49] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 36929536 bytes
(EngineCore_DP0 pid=259222) [2026-01-26 05:56:49] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 6848] -> 1D uint8
(EngineCore_DP0 pid=259222) [2026-01-26 05:56:49] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 26378240 bytes
(EngineCore_DP0 pid=259222) [2026-01-26 05:56:49] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 6848] -> 1D uint8
(EngineCore_DP0 pid=259222) [2026-01-26 05:56:49] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 142442496 bytes
(EngineCore_DP0 pid=259222) [2026-01-26 05:56:49] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 18432] -> 1D uint8
(EngineCore_DP0 pid=259222) [2026-01-26 05:56:49] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 70778880 bytes
(EngineCore_DP0 pid=259222) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:01,  2.74it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  40%|████      | 2/5 [00:00<00:00,  3.81it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  60%|██████    | 3/5 [00:00<00:00,  4.40it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  80%|████████  | 4/5 [00:00<00:00,  4.74it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:01<00:00,  4.71it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:01<00:00,  4.38it/s]
(EngineCore_DP0 pid=259222) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:00,  4.65it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 2/4 [00:00<00:00,  5.10it/s]
Capturing CUDA graphs (decode, FULL):  75%|███████▌  | 3/4 [00:00<00:00,  5.24it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  5.31it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  5.21it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 23/1024 [00:00<00:04, 227.30it/s]
Adding requests:   5%|▍         | 48/1024 [00:00<00:04, 239.99it/s]
Adding requests:   7%|▋         | 74/1024 [00:00<00:03, 245.17it/s]
Adding requests:  10%|▉         | 99/1024 [00:00<00:03, 239.35it/s]
Adding requests:  12%|█▏        | 123/1024 [00:00<00:03, 231.88it/s]
Adding requests:  15%|█▍        | 149/1024 [00:00<00:03, 238.32it/s]
Adding requests:  17%|█▋        | 176/1024 [00:00<00:03, 247.19it/s]
Adding requests:  20%|█▉        | 203/1024 [00:00<00:03, 253.77it/s]
Adding requests:  23%|██▎       | 231/1024 [00:00<00:03, 260.94it/s]
Adding requests:  25%|██▌       | 258/1024 [00:01<00:02, 257.99it/s]
Adding requests:  28%|██▊       | 285/1024 [00:01<00:02, 260.87it/s]
Adding requests:  30%|███       | 312/1024 [00:01<00:02, 262.76it/s]
Adding requests:  33%|███▎      | 339/1024 [00:01<00:02, 261.99it/s]
Adding requests:  36%|███▌      | 366/1024 [00:01<00:02, 262.08it/s]
Adding requests:  38%|███▊      | 393/1024 [00:01<00:02, 263.80it/s]
Adding requests:  41%|████      | 422/1024 [00:01<00:02, 269.18it/s]
Adding requests:  44%|████▍     | 449/1024 [00:01<00:02, 261.78it/s]
Adding requests:  47%|████▋     | 478/1024 [00:01<00:02, 267.88it/s]
Adding requests:  49%|████▉     | 506/1024 [00:01<00:01, 270.87it/s]
Adding requests:  52%|█████▏    | 534/1024 [00:02<00:01, 271.46it/s]
Adding requests:  55%|█████▍    | 562/1024 [00:02<00:01, 270.44it/s]
Adding requests:  58%|█████▊    | 590/1024 [00:02<00:01, 260.27it/s]
Adding requests:  60%|██████    | 617/1024 [00:02<00:01, 258.56it/s]
Adding requests:  63%|██████▎   | 643/1024 [00:02<00:01, 255.30it/s]
Adding requests:  65%|██████▌   | 669/1024 [00:02<00:01, 253.40it/s]
Adding requests:  68%|██████▊   | 697/1024 [00:02<00:01, 259.86it/s]
Adding requests:  71%|███████   | 724/1024 [00:02<00:01, 260.36it/s]
Adding requests:  73%|███████▎  | 751/1024 [00:02<00:01, 257.00it/s]
Adding requests:  76%|███████▌  | 778/1024 [00:03<00:00, 260.48it/s]
Adding requests:  79%|███████▊  | 805/1024 [00:03<00:00, 260.93it/s]
Adding requests:  81%|████████▏ | 833/1024 [00:03<00:00, 265.10it/s]
Adding requests:  84%|████████▍ | 860/1024 [00:03<00:00, 265.59it/s]
Adding requests:  87%|████████▋ | 888/1024 [00:03<00:00, 268.78it/s]
Adding requests:  89%|████████▉ | 915/1024 [00:03<00:00, 263.29it/s]
Adding requests:  92%|█████████▏| 942/1024 [00:03<00:00, 257.70it/s]
Adding requests:  95%|█████████▍| 969/1024 [00:03<00:00, 259.24it/s]
Adding requests:  97%|█████████▋| 995/1024 [00:03<00:00, 255.75it/s]
Adding requests: 100%|█████████▉| 1022/1024 [00:03<00:00, 257.60it/s]
Adding requests: 100%|██████████| 1024/1024 [00:03<00:00, 258.58it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   4%|▍         | 42/1024 [00:00<00:04, 235.98it/s, est. speed input: 241688.26 toks/s, output: 236.00 toks/s]
Processed prompts:   6%|▋         | 66/1024 [00:01<00:34, 27.44it/s, est. speed input: 33804.40 toks/s, output: 33.01 toks/s]   
Processed prompts:   8%|▊         | 77/1024 [00:02<00:38, 24.60it/s, est. speed input: 30283.35 toks/s, output: 29.57 toks/s]
Processed prompts:   8%|▊         | 84/1024 [00:03<00:45, 20.63it/s, est. speed input: 26815.43 toks/s, output: 26.19 toks/s]
Processed prompts:   9%|▉         | 90/1024 [00:03<00:53, 17.38it/s, est. speed input: 24172.63 toks/s, output: 23.61 toks/s]
Processed prompts:  10%|▉         | 98/1024 [00:04<00:57, 16.13it/s, est. speed input: 22720.31 toks/s, output: 22.19 toks/s]
Processed prompts:  10%|█         | 106/1024 [00:05<01:00, 15.25it/s, est. speed input: 21613.89 toks/s, output: 21.11 toks/s]
Processed prompts:  11%|█         | 114/1024 [00:05<01:02, 14.64it/s, est. speed input: 20745.39 toks/s, output: 20.26 toks/s]
Processed prompts:  12%|█▏        | 122/1024 [00:06<01:03, 14.21it/s, est. speed input: 20045.03 toks/s, output: 19.58 toks/s]
Processed prompts:  13%|█▎        | 130/1024 [00:06<01:04, 13.91it/s, est. speed input: 19468.94 toks/s, output: 19.01 toks/s]
Processed prompts:  13%|█▎        | 138/1024 [00:07<01:06, 13.34it/s, est. speed input: 18846.53 toks/s, output: 18.40 toks/s]
Processed prompts:  14%|█▍        | 146/1024 [00:08<01:06, 13.30it/s, est. speed input: 18448.62 toks/s, output: 18.02 toks/s]
Processed prompts:  15%|█▌        | 154/1024 [00:08<01:05, 13.27it/s, est. speed input: 18105.83 toks/s, output: 17.68 toks/s]
Processed prompts:  16%|█▌        | 162/1024 [00:09<01:05, 13.25it/s, est. speed input: 17806.15 toks/s, output: 17.39 toks/s]
Processed prompts:  17%|█▋        | 170/1024 [00:09<01:04, 13.23it/s, est. speed input: 17543.14 toks/s, output: 17.13 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [00:10<01:04, 13.21it/s, est. speed input: 17309.53 toks/s, output: 16.90 toks/s]
Processed prompts:  18%|█▊        | 186/1024 [00:11<01:03, 13.20it/s, est. speed input: 17100.98 toks/s, output: 16.70 toks/s]
Processed prompts:  19%|█▉        | 194/1024 [00:11<01:02, 13.19it/s, est. speed input: 16913.81 toks/s, output: 16.52 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [00:12<01:02, 13.10it/s, est. speed input: 16728.54 toks/s, output: 16.34 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:12<01:02, 13.12it/s, est. speed input: 16575.20 toks/s, output: 16.19 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [00:13<01:01, 13.13it/s, est. speed input: 16436.02 toks/s, output: 16.05 toks/s]
Processed prompts:  22%|██▏       | 226/1024 [00:14<01:00, 13.13it/s, est. speed input: 16308.38 toks/s, output: 15.93 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:14<01:00, 13.14it/s, est. speed input: 16191.27 toks/s, output: 15.81 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:15<00:59, 13.13it/s, est. speed input: 16082.58 toks/s, output: 15.71 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:16<00:58, 13.13it/s, est. speed input: 15982.22 toks/s, output: 15.61 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:16<00:58, 13.13it/s, est. speed input: 15889.11 toks/s, output: 15.52 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:17<00:57, 13.13it/s, est. speed input: 15802.69 toks/s, output: 15.43 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:17<00:57, 13.06it/s, est. speed input: 15713.10 toks/s, output: 15.34 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:18<00:56, 13.08it/s, est. speed input: 15638.01 toks/s, output: 15.27 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:19<00:56, 13.09it/s, est. speed input: 15567.53 toks/s, output: 15.20 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:19<00:55, 13.10it/s, est. speed input: 15501.43 toks/s, output: 15.14 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:20<00:54, 13.11it/s, est. speed input: 15439.67 toks/s, output: 15.08 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:20<00:54, 13.11it/s, est. speed input: 15381.37 toks/s, output: 15.02 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:21<00:53, 13.12it/s, est. speed input: 15326.49 toks/s, output: 14.97 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:22<00:52, 13.12it/s, est. speed input: 15274.40 toks/s, output: 14.92 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:22<00:53, 12.73it/s, est. speed input: 15183.12 toks/s, output: 14.83 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:23<00:52, 12.84it/s, est. speed input: 15137.34 toks/s, output: 14.78 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:24<00:51, 12.92it/s, est. speed input: 15094.25 toks/s, output: 14.74 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:24<00:50, 12.98it/s, est. speed input: 15053.24 toks/s, output: 14.70 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:25<00:50, 13.03it/s, est. speed input: 15014.27 toks/s, output: 14.66 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:25<00:49, 13.05it/s, est. speed input: 14977.02 toks/s, output: 14.63 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:26<00:48, 13.08it/s, est. speed input: 14941.67 toks/s, output: 14.59 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:26<00:26, 23.03it/s, est. speed input: 15619.58 toks/s, output: 15.25 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:27<00:30, 19.86it/s, est. speed input: 15571.09 toks/s, output: 15.21 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:28<00:33, 17.74it/s, est. speed input: 15524.58 toks/s, output: 15.16 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:28<00:36, 16.31it/s, est. speed input: 15480.22 toks/s, output: 15.12 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:29<00:37, 15.33it/s, est. speed input: 15437.32 toks/s, output: 15.08 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:29<00:39, 14.66it/s, est. speed input: 15396.43 toks/s, output: 15.04 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:30<00:39, 14.19it/s, est. speed input: 15357.19 toks/s, output: 15.00 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:31<00:40, 13.86it/s, est. speed input: 15319.40 toks/s, output: 14.96 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:31<00:40, 13.64it/s, est. speed input: 15283.30 toks/s, output: 14.93 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:32<00:40, 13.40it/s, est. speed input: 15242.60 toks/s, output: 14.89 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:32<00:40, 13.32it/s, est. speed input: 15209.14 toks/s, output: 14.85 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:33<00:39, 13.25it/s, est. speed input: 15176.53 toks/s, output: 14.82 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:34<00:39, 13.21it/s, est. speed input: 15145.31 toks/s, output: 14.79 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:34<00:38, 13.18it/s, est. speed input: 15115.39 toks/s, output: 14.76 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:35<00:38, 13.16it/s, est. speed input: 15086.45 toks/s, output: 14.73 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:36<00:37, 13.15it/s, est. speed input: 15058.30 toks/s, output: 14.71 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:36<00:36, 13.14it/s, est. speed input: 15031.04 toks/s, output: 14.68 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:37<00:37, 12.72it/s, est. speed input: 14978.65 toks/s, output: 14.63 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:37<00:36, 12.84it/s, est. speed input: 14953.80 toks/s, output: 14.60 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:38<00:35, 12.92it/s, est. speed input: 14929.53 toks/s, output: 14.58 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:39<00:34, 12.97it/s, est. speed input: 14906.07 toks/s, output: 14.56 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:39<00:34, 13.01it/s, est. speed input: 14883.34 toks/s, output: 14.53 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:40<00:33, 13.04it/s, est. speed input: 14861.38 toks/s, output: 14.51 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:40<00:32, 13.07it/s, est. speed input: 14840.05 toks/s, output: 14.49 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:41<00:32, 13.08it/s, est. speed input: 14819.18 toks/s, output: 14.47 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:42<00:31, 13.09it/s, est. speed input: 14799.11 toks/s, output: 14.45 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:42<00:31, 13.02it/s, est. speed input: 14775.27 toks/s, output: 14.43 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:43<00:30, 13.04it/s, est. speed input: 14756.23 toks/s, output: 14.41 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:44<00:29, 13.07it/s, est. speed input: 14737.99 toks/s, output: 14.39 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:44<00:29, 13.08it/s, est. speed input: 14719.99 toks/s, output: 14.37 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:45<00:28, 13.09it/s, est. speed input: 14702.74 toks/s, output: 14.36 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:45<00:27, 13.10it/s, est. speed input: 14685.88 toks/s, output: 14.34 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:46<00:27, 13.11it/s, est. speed input: 14669.49 toks/s, output: 14.33 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:47<00:26, 13.11it/s, est. speed input: 14653.60 toks/s, output: 14.31 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:47<00:26, 13.06it/s, est. speed input: 14635.31 toks/s, output: 14.29 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:48<00:25, 13.07it/s, est. speed input: 14620.01 toks/s, output: 14.28 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:48<00:24, 13.09it/s, est. speed input: 14605.36 toks/s, output: 14.26 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:49<00:24, 13.10it/s, est. speed input: 14590.87 toks/s, output: 14.25 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:50<00:23, 13.11it/s, est. speed input: 14576.89 toks/s, output: 14.24 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:50<00:23, 13.11it/s, est. speed input: 14563.16 toks/s, output: 14.22 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:51<00:22, 13.11it/s, est. speed input: 14549.78 toks/s, output: 14.21 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:51<00:21, 13.12it/s, est. speed input: 14536.80 toks/s, output: 14.20 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:52<00:21, 13.12it/s, est. speed input: 14524.05 toks/s, output: 14.18 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:53<00:20, 13.04it/s, est. speed input: 14508.00 toks/s, output: 14.17 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:53<00:20, 13.06it/s, est. speed input: 14495.98 toks/s, output: 14.16 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:54<00:19, 13.08it/s, est. speed input: 14484.12 toks/s, output: 14.14 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:55<00:18, 13.09it/s, est. speed input: 14472.58 toks/s, output: 14.13 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:55<00:18, 13.10it/s, est. speed input: 14461.20 toks/s, output: 14.12 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:56<00:17, 13.11it/s, est. speed input: 14450.27 toks/s, output: 14.11 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:56<00:16, 13.11it/s, est. speed input: 14439.39 toks/s, output: 14.10 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:57<00:16, 13.12it/s, est. speed input: 14428.83 toks/s, output: 14.09 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:57<00:08, 23.07it/s, est. speed input: 14746.98 toks/s, output: 14.40 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [00:58<00:09, 19.89it/s, est. speed input: 14733.39 toks/s, output: 14.39 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [00:59<00:09, 17.76it/s, est. speed input: 14720.00 toks/s, output: 14.37 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:59<00:10, 16.33it/s, est. speed input: 14706.92 toks/s, output: 14.36 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [01:00<00:10, 15.35it/s, est. speed input: 14694.14 toks/s, output: 14.35 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [01:00<00:10, 14.67it/s, est. speed input: 14681.59 toks/s, output: 14.34 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [01:01<00:09, 14.20it/s, est. speed input: 14669.29 toks/s, output: 14.33 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [01:02<00:09, 13.86it/s, est. speed input: 14656.58 toks/s, output: 14.31 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [01:02<00:09, 13.63it/s, est. speed input: 14644.71 toks/s, output: 14.30 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [01:03<00:08, 13.48it/s, est. speed input: 14633.11 toks/s, output: 14.29 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [01:04<00:08, 13.37it/s, est. speed input: 14621.60 toks/s, output: 14.28 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [01:04<00:07, 13.29it/s, est. speed input: 14610.34 toks/s, output: 14.27 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [01:05<00:07, 13.24it/s, est. speed input: 14599.35 toks/s, output: 14.26 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [01:05<00:06, 13.20it/s, est. speed input: 14588.54 toks/s, output: 14.25 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [01:06<00:05, 13.18it/s, est. speed input: 14577.93 toks/s, output: 14.24 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [01:07<00:05, 13.16it/s, est. speed input: 14567.54 toks/s, output: 14.23 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [01:07<00:04, 13.07it/s, est. speed input: 14554.60 toks/s, output: 14.21 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [01:08<00:04, 13.08it/s, est. speed input: 14544.59 toks/s, output: 14.20 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [01:08<00:03, 13.09it/s, est. speed input: 14534.68 toks/s, output: 14.19 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [01:09<00:02, 13.10it/s, est. speed input: 14525.01 toks/s, output: 14.18 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [01:10<00:02, 13.10it/s, est. speed input: 14515.49 toks/s, output: 14.18 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [01:10<00:01, 13.10it/s, est. speed input: 14506.05 toks/s, output: 14.17 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [01:11<00:01, 13.11it/s, est. speed input: 14496.78 toks/s, output: 14.16 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [01:11<00:00, 13.61it/s, est. speed input: 14502.76 toks/s, output: 14.16 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [01:11<00:00, 13.61it/s, est. speed input: 14588.18 toks/s, output: 14.25 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [01:11<00:00, 14.25it/s, est. speed input: 14588.18 toks/s, output: 14.25 toks/s]
[rank0]:[W126 05:58:41.391264794 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=16384 ==========
Time: 2026-01-26 05:58:43
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=2048, max_num_seqs=16
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 2048 --max-num-seqs 16 --max-model-len 1025 --max-num-batched-tokens 16384 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Qwen2.5-14B-INT8_M16384.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 05:59:05 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 05:59:06 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=261598) WARNING 01-26 05:59:14 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=261598) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=261598) WARNING 01-26 05:59:34 [backends.py:609] Failed to read file <frozen os>
Throughput: 13.09 requests/s, 13415.49 total tokens/s, 13.09 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048

STDERR:
[2026-01-26 05:59:05] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:59:05] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:59:05] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:59:05] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:59:05] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:59:05] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:59:05] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:59:05] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:59:05] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:59:05] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:59:05] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:59:05] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:59:05] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:59:05] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 05:59:13] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:59:13] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:59:13] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:59:13] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:59:13] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:59:13] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:59:13] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:59:13] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:59:13] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:59:13] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:59:13] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:59:13] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:59:13] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:59:13] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=261598) [2026-01-26 05:59:14] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=261598) [2026-01-26 05:59:14] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=261598) [2026-01-26 05:59:14] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=261598) [2026-01-26 05:59:14] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=261598) [2026-01-26 05:59:14] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=261598) [2026-01-26 05:59:14] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=261598) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=261598) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:01<00:03,  1.28s/it]
(EngineCore_DP0 pid=261598) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:02<00:02,  1.29s/it]
(EngineCore_DP0 pid=261598) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.13it/s]
(EngineCore_DP0 pid=261598) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.03s/it]
(EngineCore_DP0 pid=261598) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.06s/it]
(EngineCore_DP0 pid=261598) 
(EngineCore_DP0 pid=261598) [2026-01-26 05:59:20] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 6848] -> 1D uint8
(EngineCore_DP0 pid=261598) [2026-01-26 05:59:20] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 36929536 bytes
(EngineCore_DP0 pid=261598) [2026-01-26 05:59:20] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 6848] -> 1D uint8
(EngineCore_DP0 pid=261598) [2026-01-26 05:59:20] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 26378240 bytes
(EngineCore_DP0 pid=261598) [2026-01-26 05:59:20] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 6848] -> 1D uint8
(EngineCore_DP0 pid=261598) [2026-01-26 05:59:20] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 142442496 bytes
(EngineCore_DP0 pid=261598) [2026-01-26 05:59:20] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 18432] -> 1D uint8
(EngineCore_DP0 pid=261598) [2026-01-26 05:59:20] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 70778880 bytes
(EngineCore_DP0 pid=261598) [rank0]:W0126 05:59:47.381000 261598 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=261598) [rank0]:W0126 05:59:47.458000 261598 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=261598) [rank0]:W0126 05:59:48.561000 261598 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=261598) [rank0]:W0126 05:59:48.683000 261598 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=261598) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  14%|█▍        | 1/7 [00:00<00:02,  2.61it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  29%|██▊       | 2/7 [00:00<00:01,  3.61it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  43%|████▎     | 3/7 [00:00<00:00,  4.23it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  57%|█████▋    | 4/7 [00:00<00:00,  4.59it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  71%|███████▏  | 5/7 [00:01<00:00,  4.84it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  86%|████████▌ | 6/7 [00:01<00:00,  4.95it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:01<00:00,  4.80it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:01<00:00,  4.47it/s]
(EngineCore_DP0 pid=261598) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  20%|██        | 1/5 [00:00<00:00,  4.76it/s]
Capturing CUDA graphs (decode, FULL):  40%|████      | 2/5 [00:00<00:00,  5.18it/s]
Capturing CUDA graphs (decode, FULL):  60%|██████    | 3/5 [00:00<00:00,  5.27it/s]
Capturing CUDA graphs (decode, FULL):  80%|████████  | 4/5 [00:00<00:00,  5.30it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00,  5.34it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00,  5.27it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   1%|          | 23/2048 [00:00<00:08, 228.08it/s]
Adding requests:   2%|▏         | 48/2048 [00:00<00:08, 238.89it/s]
Adding requests:   4%|▎         | 73/2048 [00:00<00:08, 241.79it/s]
Adding requests:  22%|██▏       | 460/2048 [00:00<00:00, 1644.80it/s]
Adding requests:  30%|███       | 624/2048 [00:01<00:02, 573.71it/s] 
Adding requests:  36%|███▌      | 739/2048 [00:01<00:03, 435.13it/s]
Adding requests:  40%|████      | 824/2048 [00:01<00:03, 378.88it/s]
Adding requests:  43%|████▎     | 890/2048 [00:02<00:03, 350.54it/s]
Adding requests:  46%|████▌     | 943/2048 [00:02<00:03, 329.40it/s]
Adding requests:  48%|████▊     | 988/2048 [00:02<00:03, 314.11it/s]
Adding requests:  50%|█████     | 1027/2048 [00:02<00:03, 303.06it/s]
Adding requests:  52%|█████▏    | 1062/2048 [00:02<00:03, 293.65it/s]
Adding requests:  53%|█████▎    | 1095/2048 [00:02<00:03, 283.69it/s]
Adding requests:  55%|█████▍    | 1126/2048 [00:02<00:03, 279.60it/s]
Adding requests:  56%|█████▋    | 1155/2048 [00:03<00:03, 272.54it/s]
Adding requests:  58%|█████▊    | 1183/2048 [00:03<00:03, 271.67it/s]
Adding requests:  59%|█████▉    | 1211/2048 [00:03<00:03, 270.92it/s]
Adding requests:  60%|██████    | 1239/2048 [00:03<00:03, 268.11it/s]
Adding requests:  62%|██████▏   | 1266/2048 [00:03<00:02, 264.49it/s]
Adding requests:  63%|██████▎   | 1293/2048 [00:03<00:02, 260.38it/s]
Adding requests:  64%|██████▍   | 1320/2048 [00:03<00:02, 260.34it/s]
Adding requests:  66%|██████▌   | 1347/2048 [00:03<00:02, 259.78it/s]
Adding requests:  67%|██████▋   | 1373/2048 [00:03<00:02, 256.73it/s]
Adding requests:  68%|██████▊   | 1400/2048 [00:04<00:02, 258.99it/s]
Adding requests:  70%|██████▉   | 1427/2048 [00:04<00:02, 260.52it/s]
Adding requests:  71%|███████   | 1455/2048 [00:04<00:02, 264.65it/s]
Adding requests:  72%|███████▏  | 1483/2048 [00:04<00:02, 267.43it/s]
Adding requests:  74%|███████▍  | 1511/2048 [00:04<00:01, 270.41it/s]
Adding requests:  75%|███████▌  | 1539/2048 [00:04<00:01, 262.89it/s]
Adding requests:  76%|███████▋  | 1566/2048 [00:04<00:01, 261.19it/s]
Adding requests:  78%|███████▊  | 1593/2048 [00:04<00:01, 260.24it/s]
Adding requests:  79%|███████▉  | 1620/2048 [00:04<00:01, 258.39it/s]
Adding requests:  80%|████████  | 1646/2048 [00:04<00:01, 253.64it/s]
Adding requests:  82%|████████▏ | 1672/2048 [00:05<00:01, 252.93it/s]
Adding requests:  83%|████████▎ | 1699/2048 [00:05<00:01, 256.29it/s]
Adding requests:  84%|████████▍ | 1728/2048 [00:05<00:01, 263.11it/s]
Adding requests:  86%|████████▌ | 1756/2048 [00:05<00:01, 265.48it/s]
Adding requests:  87%|████████▋ | 1785/2048 [00:05<00:00, 270.39it/s]
Adding requests:  89%|████████▊ | 1813/2048 [00:05<00:00, 265.78it/s]
Adding requests:  90%|████████▉ | 1840/2048 [00:05<00:00, 264.66it/s]
Adding requests:  91%|█████████ | 1867/2048 [00:05<00:00, 261.81it/s]
Adding requests:  92%|█████████▏| 1894/2048 [00:05<00:00, 262.61it/s]
Adding requests:  94%|█████████▍| 1921/2048 [00:06<00:00, 263.69it/s]
Adding requests:  95%|█████████▌| 1948/2048 [00:06<00:00, 258.50it/s]
Adding requests:  96%|█████████▋| 1974/2048 [00:06<00:00, 256.99it/s]
Adding requests:  98%|█████████▊| 2000/2048 [00:06<00:00, 254.51it/s]
Adding requests:  99%|█████████▉| 2026/2048 [00:06<00:00, 248.63it/s]
Adding requests: 100%|██████████| 2048/2048 [00:06<00:00, 314.56it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▍         | 98/2048 [00:00<00:05, 329.28it/s, est. speed input: 337219.67 toks/s, output: 329.29 toks/s]
Processed prompts:   6%|▋         | 131/2048 [00:02<00:49, 38.79it/s, est. speed input: 49525.66 toks/s, output: 48.36 toks/s]  
Processed prompts:   7%|▋         | 146/2048 [00:03<01:07, 28.23it/s, est. speed input: 38086.21 toks/s, output: 37.19 toks/s]
Processed prompts:   8%|▊         | 155/2048 [00:04<01:14, 25.25it/s, est. speed input: 35006.09 toks/s, output: 34.19 toks/s]
Processed prompts:   8%|▊         | 162/2048 [00:05<01:25, 21.94it/s, est. speed input: 32255.20 toks/s, output: 31.50 toks/s]
Processed prompts:   8%|▊         | 170/2048 [00:05<01:35, 19.68it/s, est. speed input: 30260.45 toks/s, output: 29.55 toks/s]
Processed prompts:   9%|▊         | 178/2048 [00:06<01:44, 17.92it/s, est. speed input: 28647.79 toks/s, output: 27.98 toks/s]
Processed prompts:   9%|▉         | 186/2048 [00:06<01:52, 16.59it/s, est. speed input: 27317.67 toks/s, output: 26.68 toks/s]
Processed prompts:   9%|▉         | 194/2048 [00:07<01:58, 15.61it/s, est. speed input: 26200.38 toks/s, output: 25.59 toks/s]
Processed prompts:  10%|▉         | 202/2048 [00:08<02:04, 14.89it/s, est. speed input: 25248.28 toks/s, output: 24.66 toks/s]
Processed prompts:  10%|█         | 210/2048 [00:08<02:07, 14.37it/s, est. speed input: 24428.09 toks/s, output: 23.86 toks/s]
Processed prompts:  11%|█         | 218/2048 [00:09<02:10, 13.99it/s, est. speed input: 23713.60 toks/s, output: 23.16 toks/s]
Processed prompts:  11%|█         | 226/2048 [00:10<02:12, 13.73it/s, est. speed input: 23085.30 toks/s, output: 22.54 toks/s]
Processed prompts:  11%|█▏        | 234/2048 [00:10<02:14, 13.54it/s, est. speed input: 22528.56 toks/s, output: 22.00 toks/s]
Processed prompts:  12%|█▏        | 242/2048 [00:11<02:14, 13.41it/s, est. speed input: 22033.56 toks/s, output: 21.52 toks/s]
Processed prompts:  12%|█▏        | 250/2048 [00:11<02:15, 13.32it/s, est. speed input: 21590.02 toks/s, output: 21.08 toks/s]
Processed prompts:  13%|█▎        | 258/2048 [00:12<02:15, 13.26it/s, est. speed input: 21190.64 toks/s, output: 20.69 toks/s]
Processed prompts:  13%|█▎        | 266/2048 [00:13<02:14, 13.21it/s, est. speed input: 20827.63 toks/s, output: 20.34 toks/s]
Processed prompts:  13%|█▎        | 274/2048 [00:13<02:14, 13.18it/s, est. speed input: 20497.31 toks/s, output: 20.02 toks/s]
Processed prompts:  14%|█▍        | 282/2048 [00:14<02:14, 13.16it/s, est. speed input: 20194.87 toks/s, output: 19.72 toks/s]
Processed prompts:  14%|█▍        | 290/2048 [00:14<02:13, 13.14it/s, est. speed input: 19916.56 toks/s, output: 19.45 toks/s]
Processed prompts:  15%|█▍        | 298/2048 [00:15<02:13, 13.12it/s, est. speed input: 19660.33 toks/s, output: 19.20 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [00:16<02:12, 13.11it/s, est. speed input: 19423.43 toks/s, output: 18.97 toks/s]
Processed prompts:  15%|█▌        | 314/2048 [00:16<02:12, 13.11it/s, est. speed input: 19203.58 toks/s, output: 18.75 toks/s]
Processed prompts:  16%|█▌        | 322/2048 [00:17<02:11, 13.10it/s, est. speed input: 18999.17 toks/s, output: 18.55 toks/s]
Processed prompts:  16%|█▌        | 330/2048 [00:17<02:11, 13.10it/s, est. speed input: 18808.56 toks/s, output: 18.37 toks/s]
Processed prompts:  17%|█▋        | 338/2048 [00:18<02:10, 13.09it/s, est. speed input: 18630.25 toks/s, output: 18.19 toks/s]
Processed prompts:  17%|█▋        | 346/2048 [00:19<02:09, 13.10it/s, est. speed input: 18464.71 toks/s, output: 18.03 toks/s]
Processed prompts:  17%|█▋        | 354/2048 [00:19<02:09, 13.11it/s, est. speed input: 18310.21 toks/s, output: 17.88 toks/s]
Processed prompts:  18%|█▊        | 362/2048 [00:20<02:09, 13.07it/s, est. speed input: 18158.40 toks/s, output: 17.73 toks/s]
Processed prompts:  18%|█▊        | 370/2048 [00:21<02:08, 13.08it/s, est. speed input: 18021.48 toks/s, output: 17.60 toks/s]
Processed prompts:  18%|█▊        | 378/2048 [00:21<02:07, 13.09it/s, est. speed input: 17892.30 toks/s, output: 17.47 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [00:22<02:06, 13.10it/s, est. speed input: 17769.73 toks/s, output: 17.35 toks/s]
Processed prompts:  19%|█▉        | 394/2048 [00:22<02:06, 13.11it/s, est. speed input: 17654.02 toks/s, output: 17.24 toks/s]
Processed prompts:  20%|█▉        | 402/2048 [00:23<02:05, 13.11it/s, est. speed input: 17544.35 toks/s, output: 17.13 toks/s]
Processed prompts:  20%|██        | 410/2048 [00:24<02:04, 13.11it/s, est. speed input: 17440.08 toks/s, output: 17.03 toks/s]
Processed prompts:  20%|██        | 418/2048 [00:24<02:04, 13.11it/s, est. speed input: 17341.14 toks/s, output: 16.93 toks/s]
Processed prompts:  22%|██▏       | 442/2048 [00:25<01:08, 23.58it/s, est. speed input: 18054.74 toks/s, output: 17.63 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [00:25<01:19, 20.18it/s, est. speed input: 17945.02 toks/s, output: 17.52 toks/s]
Processed prompts:  22%|██▏       | 458/2048 [00:26<01:28, 17.94it/s, est. speed input: 17840.37 toks/s, output: 17.42 toks/s]
Processed prompts:  23%|██▎       | 466/2048 [00:26<01:36, 16.44it/s, est. speed input: 17740.28 toks/s, output: 17.32 toks/s]
Processed prompts:  23%|██▎       | 474/2048 [00:27<01:42, 15.41it/s, est. speed input: 17644.79 toks/s, output: 17.23 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [00:28<01:46, 14.71it/s, est. speed input: 17553.36 toks/s, output: 17.14 toks/s]
Processed prompts:  24%|██▍       | 490/2048 [00:28<01:49, 14.23it/s, est. speed input: 17465.91 toks/s, output: 17.06 toks/s]
Processed prompts:  24%|██▍       | 498/2048 [00:29<01:51, 13.89it/s, est. speed input: 17382.03 toks/s, output: 16.97 toks/s]
Processed prompts:  25%|██▍       | 506/2048 [00:29<01:52, 13.65it/s, est. speed input: 17301.34 toks/s, output: 16.90 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [00:30<01:53, 13.49it/s, est. speed input: 17224.19 toks/s, output: 16.82 toks/s]
Processed prompts:  25%|██▌       | 522/2048 [00:31<01:54, 13.38it/s, est. speed input: 17149.95 toks/s, output: 16.75 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [00:31<01:54, 13.30it/s, est. speed input: 17078.30 toks/s, output: 16.68 toks/s]
Processed prompts:  26%|██▋       | 538/2048 [00:32<01:54, 13.24it/s, est. speed input: 17009.71 toks/s, output: 16.61 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [00:32<01:53, 13.20it/s, est. speed input: 16943.26 toks/s, output: 16.55 toks/s]
Processed prompts:  27%|██▋       | 554/2048 [00:33<01:53, 13.18it/s, est. speed input: 16879.55 toks/s, output: 16.48 toks/s]
Processed prompts:  27%|██▋       | 562/2048 [00:34<01:52, 13.16it/s, est. speed input: 16818.28 toks/s, output: 16.42 toks/s]
Processed prompts:  28%|██▊       | 570/2048 [00:34<01:52, 13.15it/s, est. speed input: 16759.01 toks/s, output: 16.37 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [00:35<01:51, 13.14it/s, est. speed input: 16702.11 toks/s, output: 16.31 toks/s]
Processed prompts:  29%|██▊       | 586/2048 [00:36<01:51, 13.14it/s, est. speed input: 16646.89 toks/s, output: 16.26 toks/s]
Processed prompts:  29%|██▉       | 594/2048 [00:36<01:50, 13.13it/s, est. speed input: 16593.10 toks/s, output: 16.20 toks/s]
Processed prompts:  29%|██▉       | 602/2048 [00:37<01:50, 13.13it/s, est. speed input: 16541.45 toks/s, output: 16.15 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [00:37<01:49, 13.12it/s, est. speed input: 16491.50 toks/s, output: 16.10 toks/s]
Processed prompts:  30%|███       | 618/2048 [00:38<01:48, 13.12it/s, est. speed input: 16443.01 toks/s, output: 16.06 toks/s]
Processed prompts:  31%|███       | 626/2048 [00:39<01:48, 13.12it/s, est. speed input: 16396.16 toks/s, output: 16.01 toks/s]
Processed prompts:  31%|███       | 634/2048 [00:39<01:47, 13.12it/s, est. speed input: 16350.75 toks/s, output: 15.97 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [00:40<01:47, 13.12it/s, est. speed input: 16306.68 toks/s, output: 15.92 toks/s]
Processed prompts:  32%|███▏      | 650/2048 [00:40<01:46, 13.12it/s, est. speed input: 16263.82 toks/s, output: 15.88 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [00:41<01:45, 13.12it/s, est. speed input: 16222.32 toks/s, output: 15.84 toks/s]
Processed prompts:  33%|███▎      | 666/2048 [00:42<01:45, 13.12it/s, est. speed input: 16182.04 toks/s, output: 15.80 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [00:42<01:44, 13.12it/s, est. speed input: 16143.08 toks/s, output: 15.76 toks/s]
Processed prompts:  33%|███▎      | 682/2048 [00:43<01:44, 13.13it/s, est. speed input: 16105.35 toks/s, output: 15.73 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [00:43<01:43, 13.13it/s, est. speed input: 16068.60 toks/s, output: 15.69 toks/s]
Processed prompts:  34%|███▍      | 698/2048 [00:44<01:42, 13.13it/s, est. speed input: 16032.74 toks/s, output: 15.66 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [00:45<01:42, 13.13it/s, est. speed input: 15997.98 toks/s, output: 15.62 toks/s]
Processed prompts:  35%|███▍      | 714/2048 [00:45<01:41, 13.13it/s, est. speed input: 15964.16 toks/s, output: 15.59 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [00:46<01:40, 13.13it/s, est. speed input: 15931.15 toks/s, output: 15.56 toks/s]
Processed prompts:  36%|███▌      | 730/2048 [00:47<01:40, 13.13it/s, est. speed input: 15898.96 toks/s, output: 15.53 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [00:47<01:39, 13.13it/s, est. speed input: 15867.67 toks/s, output: 15.50 toks/s]
Processed prompts:  36%|███▋      | 746/2048 [00:48<01:39, 13.13it/s, est. speed input: 15837.14 toks/s, output: 15.47 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [00:48<01:38, 13.13it/s, est. speed input: 15807.22 toks/s, output: 15.44 toks/s]
Processed prompts:  37%|███▋      | 762/2048 [00:49<01:37, 13.13it/s, est. speed input: 15778.21 toks/s, output: 15.41 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [00:50<01:37, 13.14it/s, est. speed input: 15749.97 toks/s, output: 15.38 toks/s]
Processed prompts:  38%|███▊      | 778/2048 [00:50<01:36, 13.13it/s, est. speed input: 15722.29 toks/s, output: 15.35 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [00:51<01:36, 13.13it/s, est. speed input: 15695.10 toks/s, output: 15.33 toks/s]
Processed prompts:  39%|███▉      | 794/2048 [00:51<01:35, 13.13it/s, est. speed input: 15668.52 toks/s, output: 15.30 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [00:52<01:34, 13.12it/s, est. speed input: 15642.33 toks/s, output: 15.28 toks/s]
Processed prompts:  40%|███▉      | 810/2048 [00:53<01:34, 13.12it/s, est. speed input: 15616.97 toks/s, output: 15.25 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [00:53<01:33, 13.12it/s, est. speed input: 15592.11 toks/s, output: 15.23 toks/s]
Processed prompts:  40%|████      | 826/2048 [00:54<01:33, 13.12it/s, est. speed input: 15567.80 toks/s, output: 15.20 toks/s]
Processed prompts:  41%|████      | 834/2048 [00:54<01:32, 13.11it/s, est. speed input: 15544.03 toks/s, output: 15.18 toks/s]
Processed prompts:  41%|████      | 842/2048 [00:55<01:31, 13.11it/s, est. speed input: 15520.74 toks/s, output: 15.16 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [00:55<00:51, 23.06it/s, est. speed input: 15841.38 toks/s, output: 15.47 toks/s]
Processed prompts:  43%|████▎     | 874/2048 [00:56<00:59, 19.87it/s, est. speed input: 15815.24 toks/s, output: 15.44 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [00:57<01:05, 17.75it/s, est. speed input: 15789.72 toks/s, output: 15.42 toks/s]
Processed prompts:  43%|████▎     | 890/2048 [00:57<01:10, 16.31it/s, est. speed input: 15764.71 toks/s, output: 15.40 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [00:58<01:15, 15.33it/s, est. speed input: 15740.17 toks/s, output: 15.37 toks/s]
Processed prompts:  44%|████▍     | 906/2048 [00:59<01:17, 14.65it/s, est. speed input: 15716.08 toks/s, output: 15.35 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [00:59<01:20, 14.17it/s, est. speed input: 15692.33 toks/s, output: 15.32 toks/s]
Processed prompts:  45%|████▌     | 922/2048 [01:00<01:21, 13.84it/s, est. speed input: 15669.06 toks/s, output: 15.30 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [01:00<01:22, 13.62it/s, est. speed input: 15646.36 toks/s, output: 15.28 toks/s]
Processed prompts:  46%|████▌     | 938/2048 [01:01<01:22, 13.46it/s, est. speed input: 15624.03 toks/s, output: 15.26 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [01:02<01:22, 13.34it/s, est. speed input: 15602.08 toks/s, output: 15.24 toks/s]
Processed prompts:  47%|████▋     | 954/2048 [01:02<01:22, 13.27it/s, est. speed input: 15580.71 toks/s, output: 15.22 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [01:03<01:22, 13.21it/s, est. speed input: 15559.67 toks/s, output: 15.19 toks/s]
Processed prompts:  47%|████▋     | 970/2048 [01:03<01:21, 13.17it/s, est. speed input: 15538.96 toks/s, output: 15.17 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [01:04<01:21, 13.15it/s, est. speed input: 15518.67 toks/s, output: 15.15 toks/s]
Processed prompts:  48%|████▊     | 986/2048 [01:05<01:20, 13.13it/s, est. speed input: 15498.80 toks/s, output: 15.14 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [01:05<01:20, 13.12it/s, est. speed input: 15479.32 toks/s, output: 15.12 toks/s]
Processed prompts:  49%|████▉     | 1002/2048 [01:06<01:19, 13.11it/s, est. speed input: 15460.20 toks/s, output: 15.10 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [01:06<01:19, 13.10it/s, est. speed input: 15441.37 toks/s, output: 15.08 toks/s]
Processed prompts:  50%|████▉     | 1018/2048 [01:07<01:18, 13.10it/s, est. speed input: 15423.04 toks/s, output: 15.06 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [01:08<01:18, 13.10it/s, est. speed input: 15405.06 toks/s, output: 15.04 toks/s]
Processed prompts:  50%|█████     | 1034/2048 [01:08<01:17, 13.10it/s, est. speed input: 15387.47 toks/s, output: 15.03 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [01:09<01:16, 13.10it/s, est. speed input: 15370.07 toks/s, output: 15.01 toks/s]
Processed prompts:  51%|█████▏    | 1050/2048 [01:10<01:16, 13.10it/s, est. speed input: 15353.01 toks/s, output: 14.99 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [01:10<01:15, 13.10it/s, est. speed input: 15336.25 toks/s, output: 14.98 toks/s]
Processed prompts:  52%|█████▏    | 1066/2048 [01:11<01:14, 13.10it/s, est. speed input: 15319.81 toks/s, output: 14.96 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [01:11<01:14, 13.10it/s, est. speed input: 15303.72 toks/s, output: 14.95 toks/s]
Processed prompts:  53%|█████▎    | 1082/2048 [01:12<01:13, 13.10it/s, est. speed input: 15287.82 toks/s, output: 14.93 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [01:13<01:13, 13.10it/s, est. speed input: 15272.18 toks/s, output: 14.91 toks/s]
Processed prompts:  54%|█████▎    | 1098/2048 [01:13<01:12, 13.10it/s, est. speed input: 15256.78 toks/s, output: 14.90 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [01:14<01:11, 13.10it/s, est. speed input: 15241.64 toks/s, output: 14.88 toks/s]
Processed prompts:  54%|█████▍    | 1114/2048 [01:14<01:11, 13.10it/s, est. speed input: 15226.77 toks/s, output: 14.87 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [01:15<01:10, 13.10it/s, est. speed input: 15212.14 toks/s, output: 14.86 toks/s]
Processed prompts:  55%|█████▌    | 1130/2048 [01:16<01:10, 13.10it/s, est. speed input: 15197.66 toks/s, output: 14.84 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [01:16<01:09, 13.10it/s, est. speed input: 15183.47 toks/s, output: 14.83 toks/s]
Processed prompts:  56%|█████▌    | 1146/2048 [01:17<01:08, 13.10it/s, est. speed input: 15169.41 toks/s, output: 14.81 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [01:17<01:08, 13.10it/s, est. speed input: 15155.65 toks/s, output: 14.80 toks/s]
Processed prompts:  57%|█████▋    | 1162/2048 [01:18<01:07, 13.10it/s, est. speed input: 15142.06 toks/s, output: 14.79 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [01:19<01:07, 13.10it/s, est. speed input: 15128.71 toks/s, output: 14.77 toks/s]
Processed prompts:  58%|█████▊    | 1178/2048 [01:19<01:06, 13.09it/s, est. speed input: 15115.49 toks/s, output: 14.76 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [01:20<01:05, 13.09it/s, est. speed input: 15102.53 toks/s, output: 14.75 toks/s]
Processed prompts:  58%|█████▊    | 1194/2048 [01:21<01:05, 13.10it/s, est. speed input: 15089.78 toks/s, output: 14.74 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [01:21<01:04, 13.10it/s, est. speed input: 15077.26 toks/s, output: 14.72 toks/s]
Processed prompts:  59%|█████▉    | 1210/2048 [01:22<01:03, 13.10it/s, est. speed input: 15064.91 toks/s, output: 14.71 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [01:22<01:03, 13.10it/s, est. speed input: 15052.72 toks/s, output: 14.70 toks/s]
Processed prompts:  60%|█████▉    | 1226/2048 [01:23<01:02, 13.10it/s, est. speed input: 15040.70 toks/s, output: 14.69 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [01:24<01:02, 13.10it/s, est. speed input: 15028.87 toks/s, output: 14.68 toks/s]
Processed prompts:  61%|██████    | 1242/2048 [01:24<01:01, 13.10it/s, est. speed input: 15017.19 toks/s, output: 14.67 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [01:25<01:00, 13.10it/s, est. speed input: 15005.73 toks/s, output: 14.65 toks/s]
Processed prompts:  61%|██████▏   | 1258/2048 [01:25<01:00, 13.10it/s, est. speed input: 14994.42 toks/s, output: 14.64 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [01:26<00:59, 13.10it/s, est. speed input: 14983.23 toks/s, output: 14.63 toks/s]
Processed prompts:  63%|██████▎   | 1290/2048 [01:26<00:32, 23.34it/s, est. speed input: 15196.48 toks/s, output: 14.84 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [01:27<00:37, 20.03it/s, est. speed input: 15184.09 toks/s, output: 14.83 toks/s]
Processed prompts:  64%|██████▍   | 1306/2048 [01:28<00:41, 17.85it/s, est. speed input: 15171.87 toks/s, output: 14.82 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [01:28<00:44, 16.37it/s, est. speed input: 15159.74 toks/s, output: 14.80 toks/s]
Processed prompts:  65%|██████▍   | 1322/2048 [01:29<00:47, 15.37it/s, est. speed input: 15147.85 toks/s, output: 14.79 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [01:29<00:48, 14.67it/s, est. speed input: 15136.02 toks/s, output: 14.78 toks/s]
Processed prompts:  65%|██████▌   | 1338/2048 [01:30<00:50, 14.19it/s, est. speed input: 15124.43 toks/s, output: 14.77 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [01:31<00:50, 13.86it/s, est. speed input: 15113.01 toks/s, output: 14.76 toks/s]
Processed prompts:  66%|██████▌   | 1354/2048 [01:31<00:50, 13.63it/s, est. speed input: 15101.69 toks/s, output: 14.75 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [01:32<00:50, 13.47it/s, est. speed input: 15090.54 toks/s, output: 14.74 toks/s]
Processed prompts:  67%|██████▋   | 1370/2048 [01:33<00:50, 13.36it/s, est. speed input: 15079.48 toks/s, output: 14.73 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [01:33<00:50, 13.28it/s, est. speed input: 15068.62 toks/s, output: 14.72 toks/s]
Processed prompts:  68%|██████▊   | 1386/2048 [01:34<00:50, 13.22it/s, est. speed input: 15057.86 toks/s, output: 14.70 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [01:34<00:49, 13.19it/s, est. speed input: 15047.26 toks/s, output: 14.69 toks/s]
Processed prompts:  68%|██████▊   | 1402/2048 [01:35<00:49, 13.16it/s, est. speed input: 15036.81 toks/s, output: 14.68 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [01:36<00:48, 13.14it/s, est. speed input: 15026.43 toks/s, output: 14.67 toks/s]
Processed prompts:  69%|██████▉   | 1418/2048 [01:36<00:47, 13.13it/s, est. speed input: 15016.25 toks/s, output: 14.66 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [01:37<00:47, 13.12it/s, est. speed input: 15006.17 toks/s, output: 14.65 toks/s]
Processed prompts:  70%|███████   | 1434/2048 [01:37<00:46, 13.11it/s, est. speed input: 14996.25 toks/s, output: 14.64 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [01:38<00:46, 13.11it/s, est. speed input: 14986.44 toks/s, output: 14.64 toks/s]
Processed prompts:  71%|███████   | 1450/2048 [01:39<00:45, 13.11it/s, est. speed input: 14976.76 toks/s, output: 14.63 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [01:39<00:45, 13.10it/s, est. speed input: 14967.17 toks/s, output: 14.62 toks/s]
Processed prompts:  72%|███████▏  | 1466/2048 [01:40<00:44, 13.10it/s, est. speed input: 14957.71 toks/s, output: 14.61 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [01:40<00:43, 13.10it/s, est. speed input: 14948.41 toks/s, output: 14.60 toks/s]
Processed prompts:  72%|███████▏  | 1482/2048 [01:41<00:43, 13.10it/s, est. speed input: 14939.14 toks/s, output: 14.59 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [01:42<00:42, 13.10it/s, est. speed input: 14929.96 toks/s, output: 14.58 toks/s]
Processed prompts:  73%|███████▎  | 1498/2048 [01:42<00:41, 13.10it/s, est. speed input: 14920.95 toks/s, output: 14.57 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [01:43<00:41, 13.10it/s, est. speed input: 14912.03 toks/s, output: 14.56 toks/s]
Processed prompts:  74%|███████▍  | 1514/2048 [01:44<00:40, 13.10it/s, est. speed input: 14903.23 toks/s, output: 14.55 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [01:44<00:40, 13.10it/s, est. speed input: 14894.52 toks/s, output: 14.55 toks/s]
Processed prompts:  75%|███████▍  | 1530/2048 [01:45<00:39, 13.10it/s, est. speed input: 14885.86 toks/s, output: 14.54 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [01:45<00:38, 13.10it/s, est. speed input: 14877.36 toks/s, output: 14.53 toks/s]
Processed prompts:  75%|███████▌  | 1546/2048 [01:46<00:38, 13.10it/s, est. speed input: 14868.93 toks/s, output: 14.52 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [01:47<00:37, 13.10it/s, est. speed input: 14860.61 toks/s, output: 14.51 toks/s]
Processed prompts:  76%|███████▋  | 1562/2048 [01:47<00:37, 13.10it/s, est. speed input: 14852.39 toks/s, output: 14.50 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [01:48<00:36, 13.10it/s, est. speed input: 14844.31 toks/s, output: 14.50 toks/s]
Processed prompts:  77%|███████▋  | 1578/2048 [01:48<00:35, 13.10it/s, est. speed input: 14836.30 toks/s, output: 14.49 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [01:49<00:35, 13.10it/s, est. speed input: 14828.38 toks/s, output: 14.48 toks/s]
Processed prompts:  78%|███████▊  | 1594/2048 [01:50<00:34, 13.10it/s, est. speed input: 14820.57 toks/s, output: 14.47 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [01:50<00:34, 13.10it/s, est. speed input: 14812.81 toks/s, output: 14.47 toks/s]
Processed prompts:  79%|███████▊  | 1610/2048 [01:51<00:33, 13.10it/s, est. speed input: 14805.09 toks/s, output: 14.46 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [01:51<00:32, 13.10it/s, est. speed input: 14797.46 toks/s, output: 14.45 toks/s]
Processed prompts:  79%|███████▉  | 1626/2048 [01:52<00:32, 13.10it/s, est. speed input: 14789.97 toks/s, output: 14.44 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [01:53<00:31, 13.10it/s, est. speed input: 14782.47 toks/s, output: 14.44 toks/s]
Processed prompts:  80%|████████  | 1642/2048 [01:53<00:31, 13.10it/s, est. speed input: 14775.13 toks/s, output: 14.43 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [01:54<00:30, 13.09it/s, est. speed input: 14767.81 toks/s, output: 14.42 toks/s]
Processed prompts:  81%|████████  | 1658/2048 [01:55<00:29, 13.09it/s, est. speed input: 14760.59 toks/s, output: 14.41 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [01:55<00:29, 13.10it/s, est. speed input: 14753.46 toks/s, output: 14.41 toks/s]
Processed prompts:  82%|████████▏ | 1674/2048 [01:56<00:28, 13.10it/s, est. speed input: 14746.45 toks/s, output: 14.40 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [01:56<00:27, 13.10it/s, est. speed input: 14739.47 toks/s, output: 14.39 toks/s]
Processed prompts:  83%|████████▎ | 1690/2048 [01:57<00:27, 13.10it/s, est. speed input: 14732.56 toks/s, output: 14.39 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [01:58<00:26, 13.10it/s, est. speed input: 14725.74 toks/s, output: 14.38 toks/s]
Processed prompts:  84%|████████▍ | 1722/2048 [01:58<00:14, 23.26it/s, est. speed input: 14882.31 toks/s, output: 14.53 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [01:59<00:15, 19.99it/s, est. speed input: 14874.78 toks/s, output: 14.53 toks/s]
Processed prompts:  85%|████████▍ | 1738/2048 [01:59<00:17, 17.81it/s, est. speed input: 14867.32 toks/s, output: 14.52 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [02:00<00:18, 16.35it/s, est. speed input: 14859.95 toks/s, output: 14.51 toks/s]
Processed prompts:  86%|████████▌ | 1754/2048 [02:00<00:19, 15.35it/s, est. speed input: 14852.65 toks/s, output: 14.50 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [02:01<00:19, 14.66it/s, est. speed input: 14845.40 toks/s, output: 14.50 toks/s]
Processed prompts:  86%|████████▋ | 1770/2048 [02:02<00:19, 14.19it/s, est. speed input: 14838.23 toks/s, output: 14.49 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [02:02<00:19, 13.86it/s, est. speed input: 14831.12 toks/s, output: 14.48 toks/s]
Processed prompts:  87%|████████▋ | 1786/2048 [02:03<00:19, 13.63it/s, est. speed input: 14824.08 toks/s, output: 14.48 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [02:03<00:18, 13.47it/s, est. speed input: 14817.17 toks/s, output: 14.47 toks/s]
Processed prompts:  88%|████████▊ | 1802/2048 [02:04<00:18, 13.36it/s, est. speed input: 14810.28 toks/s, output: 14.46 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [02:05<00:17, 13.28it/s, est. speed input: 14803.45 toks/s, output: 14.46 toks/s]
Processed prompts:  89%|████████▉ | 1818/2048 [02:05<00:17, 13.23it/s, est. speed input: 14796.75 toks/s, output: 14.45 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [02:06<00:16, 13.19it/s, est. speed input: 14790.04 toks/s, output: 14.44 toks/s]
Processed prompts:  90%|████████▉ | 1834/2048 [02:07<00:16, 13.16it/s, est. speed input: 14783.46 toks/s, output: 14.44 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [02:07<00:15, 13.14it/s, est. speed input: 14776.89 toks/s, output: 14.43 toks/s]
Processed prompts:  90%|█████████ | 1850/2048 [02:08<00:15, 13.13it/s, est. speed input: 14770.41 toks/s, output: 14.42 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [02:08<00:14, 13.12it/s, est. speed input: 14763.95 toks/s, output: 14.42 toks/s]
Processed prompts:  91%|█████████ | 1866/2048 [02:09<00:13, 13.11it/s, est. speed input: 14757.58 toks/s, output: 14.41 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [02:10<00:13, 13.11it/s, est. speed input: 14751.26 toks/s, output: 14.41 toks/s]
Processed prompts:  92%|█████████▏| 1882/2048 [02:10<00:12, 13.11it/s, est. speed input: 14745.02 toks/s, output: 14.40 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [02:11<00:12, 13.10it/s, est. speed input: 14738.84 toks/s, output: 14.39 toks/s]
Processed prompts:  93%|█████████▎| 1898/2048 [02:11<00:11, 13.10it/s, est. speed input: 14732.67 toks/s, output: 14.39 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [02:12<00:10, 13.10it/s, est. speed input: 14726.59 toks/s, output: 14.38 toks/s]
Processed prompts:  93%|█████████▎| 1914/2048 [02:13<00:10, 13.10it/s, est. speed input: 14720.54 toks/s, output: 14.38 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [02:13<00:09, 13.10it/s, est. speed input: 14714.52 toks/s, output: 14.37 toks/s]
Processed prompts:  94%|█████████▍| 1930/2048 [02:14<00:09, 13.10it/s, est. speed input: 14708.60 toks/s, output: 14.36 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [02:14<00:08, 13.10it/s, est. speed input: 14702.78 toks/s, output: 14.36 toks/s]
Processed prompts:  95%|█████████▌| 1946/2048 [02:15<00:07, 13.10it/s, est. speed input: 14696.96 toks/s, output: 14.35 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [02:16<00:07, 13.10it/s, est. speed input: 14691.20 toks/s, output: 14.35 toks/s]
Processed prompts:  96%|█████████▌| 1962/2048 [02:16<00:06, 13.10it/s, est. speed input: 14685.49 toks/s, output: 14.34 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [02:17<00:05, 13.10it/s, est. speed input: 14679.87 toks/s, output: 14.34 toks/s]
Processed prompts:  97%|█████████▋| 1978/2048 [02:18<00:05, 13.10it/s, est. speed input: 14674.29 toks/s, output: 14.33 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [02:18<00:04, 13.10it/s, est. speed input: 14668.74 toks/s, output: 14.32 toks/s]
Processed prompts:  97%|█████████▋| 1994/2048 [02:19<00:04, 13.10it/s, est. speed input: 14663.22 toks/s, output: 14.32 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [02:19<00:03, 13.10it/s, est. speed input: 14657.78 toks/s, output: 14.31 toks/s]
Processed prompts:  98%|█████████▊| 2010/2048 [02:20<00:02, 13.10it/s, est. speed input: 14652.31 toks/s, output: 14.31 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [02:21<00:02, 13.10it/s, est. speed input: 14646.97 toks/s, output: 14.30 toks/s]
Processed prompts:  99%|█████████▉| 2026/2048 [02:21<00:01, 13.10it/s, est. speed input: 14641.66 toks/s, output: 14.30 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [02:22<00:01, 13.10it/s, est. speed input: 14636.39 toks/s, output: 14.29 toks/s]
Processed prompts: 100%|█████████▉| 2042/2048 [02:22<00:00, 13.59it/s, est. speed input: 14638.68 toks/s, output: 14.30 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [02:22<00:00, 13.59it/s, est. speed input: 14681.66 toks/s, output: 14.34 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [02:22<00:00, 14.34it/s, est. speed input: 14681.66 toks/s, output: 14.34 toks/s]
[rank0]:[W126 06:02:29.381898607 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=32768 ==========
Time: 2026-01-26 06:02:32
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=4096, max_num_seqs=32
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 4096 --max-num-seqs 32 --max-model-len 1025 --max-num-batched-tokens 32768 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Qwen2.5-14B-INT8_M32768.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 06:03:08 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 06:03:09 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=265251) WARNING 01-26 06:03:16 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=265251) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=265251) WARNING 01-26 06:03:37 [backends.py:609] Failed to read file <frozen os>
(EngineCore_DP0 pid=265251) ERROR 01-26 06:04:03 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=265251) ERROR 01-26 06:04:03 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=265251) ERROR 01-26 06:04:03 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=265251) ERROR 01-26 06:04:03 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=265251) ERROR 01-26 06:04:03 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=265251) ERROR 01-26 06:04:03 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=265251) ERROR 01-26 06:04:03 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=265251) ERROR 01-26 06:04:03 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=265251) ERROR 01-26 06:04:03 [core.py:866]     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=265251) ERROR 01-26 06:04:03 [core.py:866]                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=265251) ERROR 01-26 06:04:03 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 248, in _initialize_kv_caches
(EngineCore_DP0 pid=265251) ERROR 01-26 06:04:03 [core.py:866]     kv_cache_configs = get_kv_cache_configs(
(EngineCore_DP0 pid=265251) ERROR 01-26 06:04:03 [core.py:866]                        ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=265251) ERROR 01-26 06:04:03 [core.py:866]   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 1340, in get_kv_cache_configs
(EngineCore_DP0 pid=265251) ERROR 01-26 06:04:03 [core.py:866]     check_enough_kv_cache_memory(
(EngineCore_DP0 pid=265251) ERROR 01-26 06:04:03 [core.py:866]   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 687, in check_enough_kv_cache_memory
(EngineCore_DP0 pid=265251) ERROR 01-26 06:04:03 [core.py:866]     raise ValueError(
(EngineCore_DP0 pid=265251) ERROR 01-26 06:04:03 [core.py:866] ValueError: No available memory for the cache blocks. Try increasing `gpu_memory_utilization` when initializing the engine. See https://docs.vllm.ai/en/latest/configuration/conserving_memory/ for more details.

STDERR:
[2026-01-26 06:03:07] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 06:03:08] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:03:08] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 06:03:08] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:03:08] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:03:08] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:03:08] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:03:08] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:03:08] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:03:08] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 06:03:08] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 06:03:08] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 06:03:08] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 06:03:08] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 06:03:16] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 06:03:16] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:03:16] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 06:03:16] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:03:16] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:03:16] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:03:16] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:03:16] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:03:16] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:03:16] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 06:03:16] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 06:03:16] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 06:03:16] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 06:03:16] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=265251) [2026-01-26 06:03:17] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=265251) [2026-01-26 06:03:17] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=265251) [2026-01-26 06:03:17] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=265251) [2026-01-26 06:03:17] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=265251) [2026-01-26 06:03:17] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=265251) [2026-01-26 06:03:17] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=265251) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=265251) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:01<00:05,  1.73s/it]
(EngineCore_DP0 pid=265251) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:03<00:03,  1.72s/it]
(EngineCore_DP0 pid=265251) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:03<00:01,  1.17s/it]
(EngineCore_DP0 pid=265251) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:05<00:00,  1.38s/it]
(EngineCore_DP0 pid=265251) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:05<00:00,  1.41s/it]
(EngineCore_DP0 pid=265251) 
(EngineCore_DP0 pid=265251) [2026-01-26 06:03:24] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 6848] -> 1D uint8
(EngineCore_DP0 pid=265251) [2026-01-26 06:03:24] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 36929536 bytes
(EngineCore_DP0 pid=265251) [2026-01-26 06:03:24] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 6848] -> 1D uint8
(EngineCore_DP0 pid=265251) [2026-01-26 06:03:24] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 26378240 bytes
(EngineCore_DP0 pid=265251) [2026-01-26 06:03:24] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 6848] -> 1D uint8
(EngineCore_DP0 pid=265251) [2026-01-26 06:03:24] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 142442496 bytes
(EngineCore_DP0 pid=265251) [2026-01-26 06:03:24] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 18432] -> 1D uint8
(EngineCore_DP0 pid=265251) [2026-01-26 06:03:24] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 70778880 bytes
(EngineCore_DP0 pid=265251) [rank0]:W0126 06:03:51.204000 265251 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=265251) [rank0]:W0126 06:03:51.285000 265251 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=265251) [rank0]:W0126 06:03:52.560000 265251 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=265251) [rank0]:W0126 06:03:52.684000 265251 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=265251) Process EngineCore_DP0:
(EngineCore_DP0 pid=265251) Traceback (most recent call last):
(EngineCore_DP0 pid=265251)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=265251)     self.run()
(EngineCore_DP0 pid=265251)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=265251)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=265251)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=265251)     raise e
(EngineCore_DP0 pid=265251)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=265251)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=265251)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=265251)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=265251)     super().__init__(
(EngineCore_DP0 pid=265251)   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=265251)     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=265251)                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=265251)   File "/root/vllmbench/vllm/v1/engine/core.py", line 248, in _initialize_kv_caches
(EngineCore_DP0 pid=265251)     kv_cache_configs = get_kv_cache_configs(
(EngineCore_DP0 pid=265251)                        ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=265251)   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 1340, in get_kv_cache_configs
(EngineCore_DP0 pid=265251)     check_enough_kv_cache_memory(
(EngineCore_DP0 pid=265251)   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 687, in check_enough_kv_cache_memory
(EngineCore_DP0 pid=265251)     raise ValueError(
(EngineCore_DP0 pid=265251) ValueError: No available memory for the cache blocks. Try increasing `gpu_memory_utilization` when initializing the engine. See https://docs.vllm.ai/en/latest/configuration/conserving_memory/ for more details.
[rank0]:[W126 06:04:04.242686078 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

ERROR: Test failed for M=32768

========== M=65536 ==========
Time: 2026-01-26 06:04:07
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=8192, max_num_seqs=64
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 8192 --max-num-seqs 64 --max-model-len 1025 --max-num-batched-tokens 65536 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Qwen2.5-14B-INT8_M65536.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 06:05:15 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 06:05:16 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=267284) WARNING 01-26 06:05:32 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=267284) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=267284) WARNING 01-26 06:05:52 [backends.py:609] Failed to read file <frozen os>
(EngineCore_DP0 pid=267284) ERROR 01-26 06:07:16 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=267284) ERROR 01-26 06:07:16 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=267284) ERROR 01-26 06:07:16 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=267284) ERROR 01-26 06:07:16 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=267284) ERROR 01-26 06:07:16 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=267284) ERROR 01-26 06:07:16 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=267284) ERROR 01-26 06:07:16 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=267284) ERROR 01-26 06:07:16 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=267284) ERROR 01-26 06:07:16 [core.py:866]     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=267284) ERROR 01-26 06:07:16 [core.py:866]                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=267284) ERROR 01-26 06:07:16 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 248, in _initialize_kv_caches
(EngineCore_DP0 pid=267284) ERROR 01-26 06:07:16 [core.py:866]     kv_cache_configs = get_kv_cache_configs(
(EngineCore_DP0 pid=267284) ERROR 01-26 06:07:16 [core.py:866]                        ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=267284) ERROR 01-26 06:07:16 [core.py:866]   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 1340, in get_kv_cache_configs
(EngineCore_DP0 pid=267284) ERROR 01-26 06:07:16 [core.py:866]     check_enough_kv_cache_memory(
(EngineCore_DP0 pid=267284) ERROR 01-26 06:07:16 [core.py:866]   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 687, in check_enough_kv_cache_memory
(EngineCore_DP0 pid=267284) ERROR 01-26 06:07:16 [core.py:866]     raise ValueError(
(EngineCore_DP0 pid=267284) ERROR 01-26 06:07:16 [core.py:866] ValueError: No available memory for the cache blocks. Try increasing `gpu_memory_utilization` when initializing the engine. See https://docs.vllm.ai/en/latest/configuration/conserving_memory/ for more details.

STDERR:
[2026-01-26 06:05:15] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 06:05:15] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:05:15] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 06:05:15] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:05:15] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:05:15] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:05:15] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:05:15] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:05:15] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:05:15] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 06:05:15] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 06:05:15] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 06:05:15] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 06:05:15] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 06:05:23] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 06:05:23] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:05:23] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 06:05:23] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:05:23] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:05:23] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:05:23] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:05:23] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:05:23] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:05:23] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 06:05:23] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 06:05:23] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 06:05:23] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 06:05:23] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[W126 06:05:32.979947714 socket.cpp:209] [c10d] The hostname of the client socket cannot be retrieved. err=-3
(EngineCore_DP0 pid=267284) [2026-01-26 06:05:33] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=267284) [2026-01-26 06:05:33] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=267284) [2026-01-26 06:05:33] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=267284) [2026-01-26 06:05:33] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=267284) [2026-01-26 06:05:33] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=267284) [2026-01-26 06:05:33] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=267284) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=267284) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:01<00:03,  1.21s/it]
(EngineCore_DP0 pid=267284) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:02<00:02,  1.23s/it]
(EngineCore_DP0 pid=267284) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.17it/s]
(EngineCore_DP0 pid=267284) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.01s/it]
(EngineCore_DP0 pid=267284) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.03s/it]
(EngineCore_DP0 pid=267284) 
(EngineCore_DP0 pid=267284) [2026-01-26 06:05:39] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 6848] -> 1D uint8
(EngineCore_DP0 pid=267284) [2026-01-26 06:05:39] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 36929536 bytes
(EngineCore_DP0 pid=267284) [2026-01-26 06:05:39] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 6848] -> 1D uint8
(EngineCore_DP0 pid=267284) [2026-01-26 06:05:39] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 26378240 bytes
(EngineCore_DP0 pid=267284) [2026-01-26 06:05:39] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 6848] -> 1D uint8
(EngineCore_DP0 pid=267284) [2026-01-26 06:05:39] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 142442496 bytes
(EngineCore_DP0 pid=267284) [2026-01-26 06:05:39] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 18432] -> 1D uint8
(EngineCore_DP0 pid=267284) [2026-01-26 06:05:39] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 70778880 bytes
(EngineCore_DP0 pid=267284) [rank0]:W0126 06:06:05.794000 267284 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=267284) [rank0]:W0126 06:06:05.873000 267284 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=267284) [rank0]:W0126 06:06:07.752000 267284 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=267284) [rank0]:W0126 06:06:07.873000 267284 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=267284) Process EngineCore_DP0:
(EngineCore_DP0 pid=267284) Traceback (most recent call last):
(EngineCore_DP0 pid=267284)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=267284)     self.run()
(EngineCore_DP0 pid=267284)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=267284)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=267284)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=267284)     raise e
(EngineCore_DP0 pid=267284)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=267284)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=267284)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=267284)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=267284)     super().__init__(
(EngineCore_DP0 pid=267284)   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=267284)     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=267284)                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=267284)   File "/root/vllmbench/vllm/v1/engine/core.py", line 248, in _initialize_kv_caches
(EngineCore_DP0 pid=267284)     kv_cache_configs = get_kv_cache_configs(
(EngineCore_DP0 pid=267284)                        ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=267284)   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 1340, in get_kv_cache_configs
(EngineCore_DP0 pid=267284)     check_enough_kv_cache_memory(
(EngineCore_DP0 pid=267284)   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 687, in check_enough_kv_cache_memory
(EngineCore_DP0 pid=267284)     raise ValueError(
(EngineCore_DP0 pid=267284) ValueError: No available memory for the cache blocks. Try increasing `gpu_memory_utilization` when initializing the engine. See https://docs.vllm.ai/en/latest/configuration/conserving_memory/ for more details.
[rank0]:[W126 06:07:17.360643542 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

ERROR: Test failed for M=65536

========== M=32768 ==========
Time: 2026-01-26 20:38:26
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=4096, max_num_seqs=32
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 4096 --max-num-seqs 32 --max-model-len 1025 --max-num-batched-tokens 32768 --no-enable-chunked-prefill --gpu-memory-utilization 0.95 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Qwen2.5-14B-INT8_M32768.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 20:39:03 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 20:39:04 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=1044592) ERROR 01-26 20:39:15 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=1044592) ERROR 01-26 20:39:15 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=1044592) ERROR 01-26 20:39:15 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=1044592) ERROR 01-26 20:39:15 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=1044592) ERROR 01-26 20:39:15 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1044592) ERROR 01-26 20:39:15 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=1044592) ERROR 01-26 20:39:15 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=1044592) ERROR 01-26 20:39:15 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 102, in __init__
(EngineCore_DP0 pid=1044592) ERROR 01-26 20:39:15 [core.py:866]     self.model_executor = executor_class(vllm_config)
(EngineCore_DP0 pid=1044592) ERROR 01-26 20:39:15 [core.py:866]                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1044592) ERROR 01-26 20:39:15 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 101, in __init__
(EngineCore_DP0 pid=1044592) ERROR 01-26 20:39:15 [core.py:866]     self._init_executor()
(EngineCore_DP0 pid=1044592) ERROR 01-26 20:39:15 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 47, in _init_executor
(EngineCore_DP0 pid=1044592) ERROR 01-26 20:39:15 [core.py:866]     self.driver_worker.init_device()
(EngineCore_DP0 pid=1044592) ERROR 01-26 20:39:15 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/worker_base.py", line 326, in init_device
(EngineCore_DP0 pid=1044592) ERROR 01-26 20:39:15 [core.py:866]     self.worker.init_device()  # type: ignore
(EngineCore_DP0 pid=1044592) ERROR 01-26 20:39:15 [core.py:866]     ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1044592) ERROR 01-26 20:39:15 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 247, in init_device
(EngineCore_DP0 pid=1044592) ERROR 01-26 20:39:15 [core.py:866]     raise ValueError(
(EngineCore_DP0 pid=1044592) ERROR 01-26 20:39:15 [core.py:866] ValueError: Free memory on device (22.39/23.99 GiB) on startup is less than desired GPU memory utilization (0.95, 22.79 GiB). Decrease GPU memory utilization or reduce GPU memory used by other processes.

STDERR:
[2026-01-26 20:39:03] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 20:39:03] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 20:39:03] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 20:39:03] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 20:39:03] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 20:39:03] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 20:39:03] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 20:39:03] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 20:39:03] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 20:39:03] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 20:39:03] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 20:39:03] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 20:39:03] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 20:39:03] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 20:39:12] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 20:39:12] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 20:39:12] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 20:39:12] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 20:39:12] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 20:39:12] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 20:39:12] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 20:39:12] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 20:39:12] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 20:39:12] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 20:39:12] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 20:39:12] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 20:39:12] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 20:39:12] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1044592) Process EngineCore_DP0:
(EngineCore_DP0 pid=1044592) Traceback (most recent call last):
(EngineCore_DP0 pid=1044592)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=1044592)     self.run()
(EngineCore_DP0 pid=1044592)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=1044592)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=1044592)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=1044592)     raise e
(EngineCore_DP0 pid=1044592)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=1044592)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=1044592)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1044592)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=1044592)     super().__init__(
(EngineCore_DP0 pid=1044592)   File "/root/vllmbench/vllm/v1/engine/core.py", line 102, in __init__
(EngineCore_DP0 pid=1044592)     self.model_executor = executor_class(vllm_config)
(EngineCore_DP0 pid=1044592)                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1044592)   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 101, in __init__
(EngineCore_DP0 pid=1044592)     self._init_executor()
(EngineCore_DP0 pid=1044592)   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 47, in _init_executor
(EngineCore_DP0 pid=1044592)     self.driver_worker.init_device()
(EngineCore_DP0 pid=1044592)   File "/root/vllmbench/vllm/v1/worker/worker_base.py", line 326, in init_device
(EngineCore_DP0 pid=1044592)     self.worker.init_device()  # type: ignore
(EngineCore_DP0 pid=1044592)     ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1044592)   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 247, in init_device
(EngineCore_DP0 pid=1044592)     raise ValueError(
(EngineCore_DP0 pid=1044592) ValueError: Free memory on device (22.39/23.99 GiB) on startup is less than desired GPU memory utilization (0.95, 22.79 GiB). Decrease GPU memory utilization or reduce GPU memory used by other processes.
[rank0]:[W126 20:39:16.923424130 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

ERROR: Test failed for M=32768

========== M=32768 ==========
Time: 2026-01-26 20:39:39
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=4096, max_num_seqs=32
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 4096 --max-num-seqs 32 --max-model-len 1025 --max-num-batched-tokens 32768 --no-enable-chunked-prefill --gpu-memory-utilization 0.98 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Qwen2.5-14B-INT8_M32768.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 20:40:16 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 20:40:17 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=1045804) ERROR 01-26 20:40:26 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=1045804) ERROR 01-26 20:40:26 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=1045804) ERROR 01-26 20:40:26 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=1045804) ERROR 01-26 20:40:26 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=1045804) ERROR 01-26 20:40:26 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1045804) ERROR 01-26 20:40:26 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=1045804) ERROR 01-26 20:40:26 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=1045804) ERROR 01-26 20:40:26 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 102, in __init__
(EngineCore_DP0 pid=1045804) ERROR 01-26 20:40:26 [core.py:866]     self.model_executor = executor_class(vllm_config)
(EngineCore_DP0 pid=1045804) ERROR 01-26 20:40:26 [core.py:866]                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1045804) ERROR 01-26 20:40:26 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 101, in __init__
(EngineCore_DP0 pid=1045804) ERROR 01-26 20:40:26 [core.py:866]     self._init_executor()
(EngineCore_DP0 pid=1045804) ERROR 01-26 20:40:26 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 47, in _init_executor
(EngineCore_DP0 pid=1045804) ERROR 01-26 20:40:26 [core.py:866]     self.driver_worker.init_device()
(EngineCore_DP0 pid=1045804) ERROR 01-26 20:40:26 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/worker_base.py", line 326, in init_device
(EngineCore_DP0 pid=1045804) ERROR 01-26 20:40:26 [core.py:866]     self.worker.init_device()  # type: ignore
(EngineCore_DP0 pid=1045804) ERROR 01-26 20:40:26 [core.py:866]     ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1045804) ERROR 01-26 20:40:26 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 247, in init_device
(EngineCore_DP0 pid=1045804) ERROR 01-26 20:40:26 [core.py:866]     raise ValueError(
(EngineCore_DP0 pid=1045804) ERROR 01-26 20:40:26 [core.py:866] ValueError: Free memory on device (22.39/23.99 GiB) on startup is less than desired GPU memory utilization (0.98, 23.51 GiB). Decrease GPU memory utilization or reduce GPU memory used by other processes.

STDERR:
[2026-01-26 20:40:15] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 20:40:16] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 20:40:16] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 20:40:16] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 20:40:16] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 20:40:16] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 20:40:16] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 20:40:16] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 20:40:16] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 20:40:16] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 20:40:16] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 20:40:16] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 20:40:16] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 20:40:16] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 20:40:25] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 20:40:25] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 20:40:25] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 20:40:25] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 20:40:25] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 20:40:25] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 20:40:25] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 20:40:25] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 20:40:25] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 20:40:25] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 20:40:25] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 20:40:25] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 20:40:25] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 20:40:25] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1045804) Process EngineCore_DP0:
(EngineCore_DP0 pid=1045804) Traceback (most recent call last):
(EngineCore_DP0 pid=1045804)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=1045804)     self.run()
(EngineCore_DP0 pid=1045804)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=1045804)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=1045804)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=1045804)     raise e
(EngineCore_DP0 pid=1045804)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=1045804)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=1045804)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1045804)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=1045804)     super().__init__(
(EngineCore_DP0 pid=1045804)   File "/root/vllmbench/vllm/v1/engine/core.py", line 102, in __init__
(EngineCore_DP0 pid=1045804)     self.model_executor = executor_class(vllm_config)
(EngineCore_DP0 pid=1045804)                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1045804)   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 101, in __init__
(EngineCore_DP0 pid=1045804)     self._init_executor()
(EngineCore_DP0 pid=1045804)   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 47, in _init_executor
(EngineCore_DP0 pid=1045804)     self.driver_worker.init_device()
(EngineCore_DP0 pid=1045804)   File "/root/vllmbench/vllm/v1/worker/worker_base.py", line 326, in init_device
(EngineCore_DP0 pid=1045804)     self.worker.init_device()  # type: ignore
(EngineCore_DP0 pid=1045804)     ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1045804)   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 247, in init_device
(EngineCore_DP0 pid=1045804)     raise ValueError(
(EngineCore_DP0 pid=1045804) ValueError: Free memory on device (22.39/23.99 GiB) on startup is less than desired GPU memory utilization (0.98, 23.51 GiB). Decrease GPU memory utilization or reduce GPU memory used by other processes.
[rank0]:[W126 20:40:27.234731105 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

ERROR: Test failed for M=32768

========== M=65536 ==========
Time: 2026-01-26 20:40:51
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=8192, max_num_seqs=64
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 8192 --max-num-seqs 64 --max-model-len 1025 --max-num-batched-tokens 65536 --no-enable-chunked-prefill --gpu-memory-utilization 0.95 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Qwen2.5-14B-INT8_M65536.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 20:41:57 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 20:41:58 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=1047374) ERROR 01-26 20:42:06 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=1047374) ERROR 01-26 20:42:06 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=1047374) ERROR 01-26 20:42:06 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=1047374) ERROR 01-26 20:42:06 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=1047374) ERROR 01-26 20:42:06 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1047374) ERROR 01-26 20:42:06 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=1047374) ERROR 01-26 20:42:06 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=1047374) ERROR 01-26 20:42:06 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 102, in __init__
(EngineCore_DP0 pid=1047374) ERROR 01-26 20:42:06 [core.py:866]     self.model_executor = executor_class(vllm_config)
(EngineCore_DP0 pid=1047374) ERROR 01-26 20:42:06 [core.py:866]                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1047374) ERROR 01-26 20:42:06 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 101, in __init__
(EngineCore_DP0 pid=1047374) ERROR 01-26 20:42:06 [core.py:866]     self._init_executor()
(EngineCore_DP0 pid=1047374) ERROR 01-26 20:42:06 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 47, in _init_executor
(EngineCore_DP0 pid=1047374) ERROR 01-26 20:42:06 [core.py:866]     self.driver_worker.init_device()
(EngineCore_DP0 pid=1047374) ERROR 01-26 20:42:06 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/worker_base.py", line 326, in init_device
(EngineCore_DP0 pid=1047374) ERROR 01-26 20:42:06 [core.py:866]     self.worker.init_device()  # type: ignore
(EngineCore_DP0 pid=1047374) ERROR 01-26 20:42:06 [core.py:866]     ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1047374) ERROR 01-26 20:42:06 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 247, in init_device
(EngineCore_DP0 pid=1047374) ERROR 01-26 20:42:06 [core.py:866]     raise ValueError(
(EngineCore_DP0 pid=1047374) ERROR 01-26 20:42:06 [core.py:866] ValueError: Free memory on device (22.39/23.99 GiB) on startup is less than desired GPU memory utilization (0.95, 22.79 GiB). Decrease GPU memory utilization or reduce GPU memory used by other processes.

STDERR:
[2026-01-26 20:41:56] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 20:41:57] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 20:41:57] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 20:41:57] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 20:41:57] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 20:41:57] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 20:41:57] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 20:41:57] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 20:41:57] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 20:41:57] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 20:41:57] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 20:41:57] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 20:41:57] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 20:41:57] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 20:42:04] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 20:42:05] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 20:42:05] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 20:42:05] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 20:42:05] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 20:42:05] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 20:42:05] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 20:42:05] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 20:42:05] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 20:42:05] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 20:42:05] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 20:42:05] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 20:42:05] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 20:42:05] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1047374) Process EngineCore_DP0:
(EngineCore_DP0 pid=1047374) Traceback (most recent call last):
(EngineCore_DP0 pid=1047374)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=1047374)     self.run()
(EngineCore_DP0 pid=1047374)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=1047374)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=1047374)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=1047374)     raise e
(EngineCore_DP0 pid=1047374)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=1047374)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=1047374)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1047374)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=1047374)     super().__init__(
(EngineCore_DP0 pid=1047374)   File "/root/vllmbench/vllm/v1/engine/core.py", line 102, in __init__
(EngineCore_DP0 pid=1047374)     self.model_executor = executor_class(vllm_config)
(EngineCore_DP0 pid=1047374)                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1047374)   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 101, in __init__
(EngineCore_DP0 pid=1047374)     self._init_executor()
(EngineCore_DP0 pid=1047374)   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 47, in _init_executor
(EngineCore_DP0 pid=1047374)     self.driver_worker.init_device()
(EngineCore_DP0 pid=1047374)   File "/root/vllmbench/vllm/v1/worker/worker_base.py", line 326, in init_device
(EngineCore_DP0 pid=1047374)     self.worker.init_device()  # type: ignore
(EngineCore_DP0 pid=1047374)     ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1047374)   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 247, in init_device
(EngineCore_DP0 pid=1047374)     raise ValueError(
(EngineCore_DP0 pid=1047374) ValueError: Free memory on device (22.39/23.99 GiB) on startup is less than desired GPU memory utilization (0.95, 22.79 GiB). Decrease GPU memory utilization or reduce GPU memory used by other processes.
[rank0]:[W126 20:42:07.442082848 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

ERROR: Test failed for M=65536

========== M=65536 ==========
Time: 2026-01-26 20:42:29
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=8192, max_num_seqs=64
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 8192 --max-num-seqs 64 --max-model-len 1025 --max-num-batched-tokens 65536 --no-enable-chunked-prefill --gpu-memory-utilization 0.98 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/Qwen2.5-14B-INT8_M65536.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 20:43:35 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 20:43:36 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=1048925) ERROR 01-26 20:43:45 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=1048925) ERROR 01-26 20:43:45 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=1048925) ERROR 01-26 20:43:45 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=1048925) ERROR 01-26 20:43:45 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=1048925) ERROR 01-26 20:43:45 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1048925) ERROR 01-26 20:43:45 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=1048925) ERROR 01-26 20:43:45 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=1048925) ERROR 01-26 20:43:45 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 102, in __init__
(EngineCore_DP0 pid=1048925) ERROR 01-26 20:43:45 [core.py:866]     self.model_executor = executor_class(vllm_config)
(EngineCore_DP0 pid=1048925) ERROR 01-26 20:43:45 [core.py:866]                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1048925) ERROR 01-26 20:43:45 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 101, in __init__
(EngineCore_DP0 pid=1048925) ERROR 01-26 20:43:45 [core.py:866]     self._init_executor()
(EngineCore_DP0 pid=1048925) ERROR 01-26 20:43:45 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 47, in _init_executor
(EngineCore_DP0 pid=1048925) ERROR 01-26 20:43:45 [core.py:866]     self.driver_worker.init_device()
(EngineCore_DP0 pid=1048925) ERROR 01-26 20:43:45 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/worker_base.py", line 326, in init_device
(EngineCore_DP0 pid=1048925) ERROR 01-26 20:43:45 [core.py:866]     self.worker.init_device()  # type: ignore
(EngineCore_DP0 pid=1048925) ERROR 01-26 20:43:45 [core.py:866]     ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1048925) ERROR 01-26 20:43:45 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 247, in init_device
(EngineCore_DP0 pid=1048925) ERROR 01-26 20:43:45 [core.py:866]     raise ValueError(
(EngineCore_DP0 pid=1048925) ERROR 01-26 20:43:45 [core.py:866] ValueError: Free memory on device (22.39/23.99 GiB) on startup is less than desired GPU memory utilization (0.98, 23.51 GiB). Decrease GPU memory utilization or reduce GPU memory used by other processes.

STDERR:
[2026-01-26 20:43:34] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 20:43:35] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 20:43:35] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 20:43:35] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 20:43:35] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 20:43:35] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 20:43:35] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 20:43:35] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 20:43:35] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 20:43:35] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 20:43:35] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 20:43:35] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 20:43:35] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 20:43:35] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 20:43:43] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 20:43:44] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 20:43:44] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 20:43:44] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 20:43:44] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 20:43:44] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 20:43:44] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 20:43:44] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 20:43:44] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 20:43:44] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 20:43:44] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 20:43:44] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 20:43:44] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 20:43:44] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1048925) Process EngineCore_DP0:
(EngineCore_DP0 pid=1048925) Traceback (most recent call last):
(EngineCore_DP0 pid=1048925)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=1048925)     self.run()
(EngineCore_DP0 pid=1048925)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=1048925)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=1048925)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=1048925)     raise e
(EngineCore_DP0 pid=1048925)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=1048925)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=1048925)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1048925)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=1048925)     super().__init__(
(EngineCore_DP0 pid=1048925)   File "/root/vllmbench/vllm/v1/engine/core.py", line 102, in __init__
(EngineCore_DP0 pid=1048925)     self.model_executor = executor_class(vllm_config)
(EngineCore_DP0 pid=1048925)                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1048925)   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 101, in __init__
(EngineCore_DP0 pid=1048925)     self._init_executor()
(EngineCore_DP0 pid=1048925)   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 47, in _init_executor
(EngineCore_DP0 pid=1048925)     self.driver_worker.init_device()
(EngineCore_DP0 pid=1048925)   File "/root/vllmbench/vllm/v1/worker/worker_base.py", line 326, in init_device
(EngineCore_DP0 pid=1048925)     self.worker.init_device()  # type: ignore
(EngineCore_DP0 pid=1048925)     ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1048925)   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 247, in init_device
(EngineCore_DP0 pid=1048925)     raise ValueError(
(EngineCore_DP0 pid=1048925) ValueError: Free memory on device (22.39/23.99 GiB) on startup is less than desired GPU memory utilization (0.98, 23.51 GiB). Decrease GPU memory utilization or reduce GPU memory used by other processes.
[rank0]:[W126 20:43:46.033095182 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

ERROR: Test failed for M=65536

========== M=512 ==========
Time: 2026-01-28 06:33:09
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_6
Params: prompt_len=512, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_6 --dataset-name random --input-len 512 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 513 --max-num-batched-tokens 513 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/BitNet-2B-INT8_M512.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-28 06:33:47 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 06:33:47 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=801998) WARNING 01-28 06:35:03 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=801998) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=801998) WARNING 01-28 06:37:07 [backends.py:609] Failed to read file <frozen os>
Throughput: 15.00 requests/s, 7697.12 total tokens/s, 15.00 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128

STDERR:
[2026-01-28 06:33:44] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 06:33:47] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 06:33:47] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 06:33:47] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 06:33:47] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 06:33:47] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 06:33:47] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 06:33:47] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 06:33:47] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 06:33:47] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 06:33:47] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 06:33:47] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 06:33:47] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 06:33:47] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 06:34:12] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 06:34:24] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 06:34:24] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 06:34:24] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 06:34:24] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 06:34:24] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 06:34:24] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 06:34:24] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 06:34:24] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 06:34:24] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 06:34:24] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 06:34:24] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 06:34:24] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 06:34:24] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=801998) [2026-01-28 06:35:11] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=801998) [2026-01-28 06:35:11] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=801998) [2026-01-28 06:35:11] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=801998) [2026-01-28 06:35:11] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=801998) [2026-01-28 06:35:11] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=801998) [2026-01-28 06:35:11] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=801998) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=801998) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:03<00:00,  3.76s/it]
(EngineCore_DP0 pid=801998) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:03<00:00,  3.76s/it]
(EngineCore_DP0 pid=801998) 
(EngineCore_DP0 pid=801998) [2026-01-28 06:36:03] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 3424] -> 1D uint8
(EngineCore_DP0 pid=801998) [2026-01-28 06:36:03] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9891840 bytes
(EngineCore_DP0 pid=801998) [2026-01-28 06:36:03] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 3424] -> 1D uint8
(EngineCore_DP0 pid=801998) [2026-01-28 06:36:04] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 6594560 bytes
(EngineCore_DP0 pid=801998) [2026-01-28 06:36:04] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 3424] -> 1D uint8
(EngineCore_DP0 pid=801998) [2026-01-28 06:36:04] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 35610624 bytes
(EngineCore_DP0 pid=801998) [2026-01-28 06:36:04] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 9216] -> 1D uint8
(EngineCore_DP0 pid=801998) [2026-01-28 06:36:05] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 17694720 bytes
(EngineCore_DP0 pid=801998) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:03<00:03,  3.81s/it]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:21<00:00, 12.16s/it]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:21<00:00, 10.91s/it]
(EngineCore_DP0 pid=801998) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:05<00:00,  5.41s/it]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:05<00:00,  5.41s/it]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  50%|█████     | 64/128 [00:00<00:00, 635.65it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 646.56it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:42,  2.98it/s, est. speed input: 1526.82 toks/s, output: 2.98 toks/s]
Processed prompts:   2%|▏         | 2/128 [00:00<00:29,  4.29it/s, est. speed input: 2061.27 toks/s, output: 4.03 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:25,  5.00it/s, est. speed input: 2335.80 toks/s, output: 4.56 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:21,  5.83it/s, est. speed input: 2608.17 toks/s, output: 5.09 toks/s]
Processed prompts:   5%|▍         | 6/128 [00:00<00:13,  8.86it/s, est. speed input: 3387.50 toks/s, output: 6.62 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:01<00:10, 11.07it/s, est. speed input: 3984.29 toks/s, output: 7.78 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:01<00:09, 12.35it/s, est. speed input: 4414.76 toks/s, output: 8.62 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:01<00:08, 13.25it/s, est. speed input: 4761.81 toks/s, output: 9.30 toks/s]
Processed prompts:  11%|█         | 14/128 [00:01<00:08, 14.22it/s, est. speed input: 5081.96 toks/s, output: 9.93 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:01<00:07, 14.93it/s, est. speed input: 5352.50 toks/s, output: 10.45 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:01<00:07, 15.41it/s, est. speed input: 5580.98 toks/s, output: 10.90 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:01<00:06, 15.75it/s, est. speed input: 5778.46 toks/s, output: 11.29 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:01<00:06, 15.99it/s, est. speed input: 5951.05 toks/s, output: 11.62 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:02<00:06, 16.14it/s, est. speed input: 6101.21 toks/s, output: 11.92 toks/s]
Processed prompts:  20%|██        | 26/128 [00:02<00:06, 16.30it/s, est. speed input: 6238.34 toks/s, output: 12.18 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:02<00:06, 16.45it/s, est. speed input: 6363.24 toks/s, output: 12.43 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:02<00:05, 16.54it/s, est. speed input: 6474.47 toks/s, output: 12.65 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:02<00:05, 16.51it/s, est. speed input: 6569.25 toks/s, output: 12.83 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:02<00:05, 16.51it/s, est. speed input: 6656.39 toks/s, output: 13.00 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:02<00:05, 16.55it/s, est. speed input: 6738.27 toks/s, output: 13.16 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:02<00:05, 16.52it/s, est. speed input: 6809.82 toks/s, output: 13.30 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:02<00:05, 16.53it/s, est. speed input: 6877.73 toks/s, output: 13.43 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:03<00:05, 16.42it/s, est. speed input: 6933.30 toks/s, output: 13.54 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:03<00:05, 16.23it/s, est. speed input: 6978.72 toks/s, output: 13.63 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:03<00:05, 15.85it/s, est. speed input: 7006.90 toks/s, output: 13.69 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:03<00:05, 15.97it/s, est. speed input: 7053.54 toks/s, output: 13.78 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:03<00:04, 16.13it/s, est. speed input: 7100.86 toks/s, output: 13.87 toks/s]
Processed prompts:  41%|████      | 52/128 [00:03<00:04, 16.25it/s, est. speed input: 7144.88 toks/s, output: 13.95 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:03<00:04, 16.34it/s, est. speed input: 7186.93 toks/s, output: 14.04 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:03<00:04, 16.41it/s, est. speed input: 7226.32 toks/s, output: 14.11 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:04<00:04, 16.46it/s, est. speed input: 7263.64 toks/s, output: 14.19 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:04<00:04, 16.51it/s, est. speed input: 7299.32 toks/s, output: 14.26 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:04<00:03, 16.55it/s, est. speed input: 7333.30 toks/s, output: 14.32 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:04<00:03, 16.56it/s, est. speed input: 7364.51 toks/s, output: 14.38 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:04<00:03, 16.59it/s, est. speed input: 7395.03 toks/s, output: 14.44 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:04<00:03, 16.56it/s, est. speed input: 7422.37 toks/s, output: 14.50 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:04<00:03, 16.59it/s, est. speed input: 7450.07 toks/s, output: 14.55 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:04<00:03, 16.58it/s, est. speed input: 7475.21 toks/s, output: 14.60 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:05<00:03, 16.56it/s, est. speed input: 7498.65 toks/s, output: 14.65 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:05<00:03, 16.51it/s, est. speed input: 7519.81 toks/s, output: 14.69 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:05<00:03, 16.47it/s, est. speed input: 7539.89 toks/s, output: 14.73 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:05<00:02, 16.51it/s, est. speed input: 7561.32 toks/s, output: 14.77 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:05<00:02, 16.56it/s, est. speed input: 7582.48 toks/s, output: 14.81 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:05<00:02, 16.57it/s, est. speed input: 7601.75 toks/s, output: 14.85 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:05<00:02, 16.37it/s, est. speed input: 7613.75 toks/s, output: 14.87 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:05<00:02, 16.46it/s, est. speed input: 7632.59 toks/s, output: 14.91 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:06<00:02, 16.53it/s, est. speed input: 7650.82 toks/s, output: 14.94 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:06<00:02, 16.55it/s, est. speed input: 7667.27 toks/s, output: 14.98 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:06<00:02, 16.54it/s, est. speed input: 7682.71 toks/s, output: 15.01 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:06<00:01, 16.46it/s, est. speed input: 7695.22 toks/s, output: 15.03 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:06<00:01, 16.46it/s, est. speed input: 7708.97 toks/s, output: 15.06 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:06<00:01, 16.44it/s, est. speed input: 7721.61 toks/s, output: 15.08 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:06<00:01, 16.48it/s, est. speed input: 7735.07 toks/s, output: 15.11 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:06<00:01, 16.47it/s, est. speed input: 7747.17 toks/s, output: 15.13 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:06<00:01, 16.44it/s, est. speed input: 7758.33 toks/s, output: 15.15 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:07<00:01, 16.43it/s, est. speed input: 7769.38 toks/s, output: 15.17 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:07<00:01, 16.42it/s, est. speed input: 7779.88 toks/s, output: 15.20 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:07<00:00, 16.41it/s, est. speed input: 7789.99 toks/s, output: 15.21 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:07<00:00, 16.44it/s, est. speed input: 7800.83 toks/s, output: 15.24 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:07<00:00, 16.45it/s, est. speed input: 7810.93 toks/s, output: 15.26 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:07<00:00, 16.44it/s, est. speed input: 7820.35 toks/s, output: 15.27 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:07<00:00, 16.44it/s, est. speed input: 7829.61 toks/s, output: 15.29 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:07<00:00, 16.44it/s, est. speed input: 7838.52 toks/s, output: 15.31 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:08<00:00, 16.47it/s, est. speed input: 7847.99 toks/s, output: 15.33 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:08<00:00, 16.48it/s, est. speed input: 7856.86 toks/s, output: 15.35 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:08<00:00, 16.52it/s, est. speed input: 7866.19 toks/s, output: 15.36 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:08<00:00, 16.52it/s, est. speed input: 7866.19 toks/s, output: 15.36 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:08<00:00, 15.36it/s, est. speed input: 7866.19 toks/s, output: 15.36 toks/s]
[rank0]:[W128 06:38:34.271142931 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=1024 ==========
Time: 2026-01-28 06:38:46
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 1025 --max-num-batched-tokens 1025 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/BitNet-2B-INT8_M1024.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-28 06:39:17 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 06:39:18 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=804637) WARNING 01-28 06:40:40 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=804637) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=804637) WARNING 01-28 06:42:09 [backends.py:609] Failed to read file <frozen os>
Throughput: 15.07 requests/s, 15444.65 total tokens/s, 15.07 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128

STDERR:
[2026-01-28 06:39:01] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 06:39:17] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 06:39:17] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 06:39:17] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 06:39:17] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 06:39:17] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 06:39:17] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 06:39:17] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 06:39:17] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 06:39:17] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 06:39:17] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 06:39:17] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 06:39:17] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 06:39:17] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 06:39:41] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 06:39:44] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 06:39:44] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 06:39:44] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 06:39:44] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 06:39:44] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 06:39:44] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 06:39:44] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 06:39:44] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 06:39:44] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 06:39:44] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 06:39:44] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 06:39:44] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 06:39:44] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=804637) [2026-01-28 06:40:43] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=804637) [2026-01-28 06:40:43] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=804637) [2026-01-28 06:40:43] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=804637) [2026-01-28 06:40:43] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=804637) [2026-01-28 06:40:43] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=804637) [2026-01-28 06:40:43] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=804637) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=804637) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.27it/s]
(EngineCore_DP0 pid=804637) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.27it/s]
(EngineCore_DP0 pid=804637) 
(EngineCore_DP0 pid=804637) [2026-01-28 06:41:11] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 3424] -> 1D uint8
(EngineCore_DP0 pid=804637) [2026-01-28 06:41:11] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9891840 bytes
(EngineCore_DP0 pid=804637) [2026-01-28 06:41:11] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 3424] -> 1D uint8
(EngineCore_DP0 pid=804637) [2026-01-28 06:41:12] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 6594560 bytes
(EngineCore_DP0 pid=804637) [2026-01-28 06:41:12] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 3424] -> 1D uint8
(EngineCore_DP0 pid=804637) [2026-01-28 06:41:12] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 35610624 bytes
(EngineCore_DP0 pid=804637) [2026-01-28 06:41:12] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 9216] -> 1D uint8
(EngineCore_DP0 pid=804637) [2026-01-28 06:41:12] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 17694720 bytes
(EngineCore_DP0 pid=804637) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:06<00:06,  6.77s/it]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:09<00:00,  4.30s/it]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:09<00:00,  4.67s/it]
(EngineCore_DP0 pid=804637) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:02<00:00,  2.81s/it]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:02<00:00,  2.81s/it]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  26%|██▌       | 33/128 [00:00<00:00, 323.98it/s]
Adding requests:  54%|█████▍    | 69/128 [00:00<00:00, 340.63it/s]
Adding requests:  83%|████████▎ | 106/128 [00:00<00:00, 353.19it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 352.15it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:33,  3.75it/s, est. speed input: 3845.43 toks/s, output: 3.76 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:14,  8.55it/s, est. speed input: 7761.33 toks/s, output: 7.58 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:10, 11.28it/s, est. speed input: 9856.91 toks/s, output: 9.63 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:09, 12.92it/s, est. speed input: 11138.96 toks/s, output: 10.88 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:00<00:08, 13.99it/s, est. speed input: 12016.93 toks/s, output: 11.73 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:00<00:07, 14.71it/s, est. speed input: 12656.30 toks/s, output: 12.36 toks/s]
Processed prompts:  10%|█         | 13/128 [00:01<00:07, 15.20it/s, est. speed input: 13145.06 toks/s, output: 12.84 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:01<00:07, 15.57it/s, est. speed input: 13538.72 toks/s, output: 13.22 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:01<00:07, 15.80it/s, est. speed input: 13848.80 toks/s, output: 13.52 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:01<00:06, 15.98it/s, est. speed input: 14107.76 toks/s, output: 13.78 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:01<00:06, 16.10it/s, est. speed input: 14323.45 toks/s, output: 13.99 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:01<00:06, 16.04it/s, est. speed input: 14476.89 toks/s, output: 14.14 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:01<00:06, 15.97it/s, est. speed input: 14599.85 toks/s, output: 14.26 toks/s]
Processed prompts:  21%|██        | 27/128 [00:01<00:06, 15.93it/s, est. speed input: 14709.52 toks/s, output: 14.36 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:03<00:22,  4.35it/s, est. speed input: 9534.43 toks/s, output: 9.31 toks/s]  
Processed prompts:  24%|██▍       | 31/128 [00:03<00:17,  5.57it/s, est. speed input: 9803.21 toks/s, output: 9.57 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:03<00:13,  6.93it/s, est. speed input: 10048.43 toks/s, output: 9.81 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:03<00:11,  8.37it/s, est. speed input: 10280.22 toks/s, output: 10.04 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:03<00:09,  9.79it/s, est. speed input: 10495.29 toks/s, output: 10.25 toks/s]
Processed prompts:  30%|███       | 39/128 [00:03<00:08, 11.06it/s, est. speed input: 10688.57 toks/s, output: 10.44 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:03<00:07, 12.15it/s, est. speed input: 10868.35 toks/s, output: 10.61 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:03<00:06, 13.07it/s, est. speed input: 11037.93 toks/s, output: 10.78 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:04<00:06, 13.83it/s, est. speed input: 11200.06 toks/s, output: 10.94 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:04<00:05, 14.39it/s, est. speed input: 11351.08 toks/s, output: 11.08 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:04<00:05, 14.83it/s, est. speed input: 11494.83 toks/s, output: 11.23 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:04<00:05, 15.12it/s, est. speed input: 11627.81 toks/s, output: 11.36 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:04<00:04, 15.36it/s, est. speed input: 11755.67 toks/s, output: 11.48 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:04<00:04, 15.55it/s, est. speed input: 11877.87 toks/s, output: 11.60 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:04<00:04, 15.65it/s, est. speed input: 11991.61 toks/s, output: 11.71 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:04<00:04, 15.70it/s, est. speed input: 12098.17 toks/s, output: 11.81 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:05<00:04, 15.80it/s, est. speed input: 12203.61 toks/s, output: 11.92 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:05<00:04, 15.95it/s, est. speed input: 12308.88 toks/s, output: 12.02 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:05<00:03, 16.07it/s, est. speed input: 12409.98 toks/s, output: 12.12 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:05<00:03, 16.14it/s, est. speed input: 12505.79 toks/s, output: 12.21 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:05<00:03, 16.24it/s, est. speed input: 12600.32 toks/s, output: 12.30 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:05<00:03, 16.23it/s, est. speed input: 12686.56 toks/s, output: 12.39 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:05<00:03, 16.24it/s, est. speed input: 12769.64 toks/s, output: 12.47 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:05<00:03, 16.27it/s, est. speed input: 12850.99 toks/s, output: 12.55 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:06<00:03, 16.28it/s, est. speed input: 12928.07 toks/s, output: 12.63 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:06<00:03, 16.26it/s, est. speed input: 13001.00 toks/s, output: 12.70 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:06<00:02, 16.27it/s, est. speed input: 13072.12 toks/s, output: 12.77 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:06<00:02, 16.29it/s, est. speed input: 13141.34 toks/s, output: 12.83 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:06<00:02, 16.30it/s, est. speed input: 13208.04 toks/s, output: 12.90 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:06<00:02, 16.32it/s, est. speed input: 13272.40 toks/s, output: 12.96 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:06<00:02, 16.29it/s, est. speed input: 13332.72 toks/s, output: 13.02 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:06<00:02, 16.31it/s, est. speed input: 13392.72 toks/s, output: 13.08 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:07<00:02, 16.29it/s, est. speed input: 13448.97 toks/s, output: 13.13 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:07<00:02, 16.24it/s, est. speed input: 13501.80 toks/s, output: 13.19 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:07<00:01, 16.24it/s, est. speed input: 13554.53 toks/s, output: 13.24 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:07<00:01, 16.23it/s, est. speed input: 13604.59 toks/s, output: 13.29 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:07<00:01, 16.21it/s, est. speed input: 13652.81 toks/s, output: 13.33 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:07<00:01, 16.26it/s, est. speed input: 13702.21 toks/s, output: 13.38 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:07<00:01, 16.25it/s, est. speed input: 13748.30 toks/s, output: 13.43 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:07<00:01, 16.24it/s, est. speed input: 13792.41 toks/s, output: 13.47 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:08<00:01, 16.27it/s, est. speed input: 13837.34 toks/s, output: 13.51 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:08<00:01, 16.26it/s, est. speed input: 13878.98 toks/s, output: 13.55 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:08<00:00, 16.02it/s, est. speed input: 13909.73 toks/s, output: 13.58 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:08<00:00, 16.11it/s, est. speed input: 13950.58 toks/s, output: 13.62 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:08<00:00, 16.16it/s, est. speed input: 13989.73 toks/s, output: 13.66 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:08<00:00, 16.24it/s, est. speed input: 14029.12 toks/s, output: 13.70 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:08<00:00, 16.28it/s, est. speed input: 14067.36 toks/s, output: 13.74 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:08<00:00, 16.25it/s, est. speed input: 14102.05 toks/s, output: 13.77 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:09<00:00, 16.27it/s, est. speed input: 14137.21 toks/s, output: 13.81 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:09<00:00, 16.20it/s, est. speed input: 14168.41 toks/s, output: 13.84 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:09<00:00, 16.20it/s, est. speed input: 14184.96 toks/s, output: 13.85 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:09<00:00, 13.85it/s, est. speed input: 14184.96 toks/s, output: 13.85 toks/s]
[rank0]:[W128 06:43:21.165860339 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=2048 ==========
Time: 2026-01-28 06:45:18
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=256, max_num_seqs=2
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 256 --max-num-seqs 2 --max-model-len 1025 --max-num-batched-tokens 2048 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/BitNet-2B-INT8_M2048.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-28 06:45:36 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 06:45:37 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=807563) WARNING 01-28 06:47:21 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=807563) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=807563) WARNING 01-28 06:49:13 [backends.py:609] Failed to read file <frozen os>
Throughput: 31.42 requests/s, 32200.60 total tokens/s, 31.42 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256

STDERR:
[2026-01-28 06:45:31] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 06:45:36] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 06:45:36] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 06:45:36] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 06:45:36] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 06:45:36] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 06:45:36] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 06:45:36] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 06:45:36] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 06:45:36] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 06:45:36] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 06:45:36] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 06:45:36] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 06:45:36] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 06:46:00] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 06:46:29] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 06:46:29] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 06:46:29] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 06:46:29] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 06:46:29] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 06:46:29] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 06:46:29] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 06:46:29] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 06:46:29] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 06:46:29] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 06:46:29] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 06:46:29] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 06:46:29] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[W128 06:47:21.211081603 socket.cpp:209] [c10d] The hostname of the client socket cannot be retrieved. err=-3
(EngineCore_DP0 pid=807563) [2026-01-28 06:47:37] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=807563) [2026-01-28 06:47:37] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=807563) [2026-01-28 06:47:37] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=807563) [2026-01-28 06:47:37] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=807563) [2026-01-28 06:47:37] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=807563) [2026-01-28 06:47:37] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=807563) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=807563) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.27it/s]
(EngineCore_DP0 pid=807563) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.27it/s]
(EngineCore_DP0 pid=807563) 
(EngineCore_DP0 pid=807563) [2026-01-28 06:48:27] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 3424] -> 1D uint8
(EngineCore_DP0 pid=807563) [2026-01-28 06:48:27] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9891840 bytes
(EngineCore_DP0 pid=807563) [2026-01-28 06:48:27] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 3424] -> 1D uint8
(EngineCore_DP0 pid=807563) [2026-01-28 06:48:27] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 6594560 bytes
(EngineCore_DP0 pid=807563) [2026-01-28 06:48:27] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 3424] -> 1D uint8
(EngineCore_DP0 pid=807563) [2026-01-28 06:48:27] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 35610624 bytes
(EngineCore_DP0 pid=807563) [2026-01-28 06:48:27] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 9216] -> 1D uint8
(EngineCore_DP0 pid=807563) [2026-01-28 06:48:27] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 17694720 bytes
(EngineCore_DP0 pid=807563) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  33%|███▎      | 1/3 [00:02<00:05,  2.55s/it]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  67%|██████▋   | 2/3 [00:07<00:04,  4.23s/it]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:11<00:00,  3.80s/it]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:11<00:00,  3.75s/it]
(EngineCore_DP0 pid=807563) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 1/2 [00:00<00:00,  3.43it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:01<00:00,  1.73it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:01<00:00,  1.87it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  14%|█▎        | 35/256 [00:00<00:00, 346.73it/s]
Adding requests:  29%|██▊       | 73/256 [00:00<00:00, 364.02it/s]
Adding requests:  43%|████▎     | 110/256 [00:00<00:00, 366.69it/s]
Adding requests:  57%|█████▋    | 147/256 [00:00<00:00, 363.42it/s]
Adding requests:  72%|███████▏  | 184/256 [00:00<00:00, 361.61it/s]
Adding requests:  86%|████████▋ | 221/256 [00:00<00:00, 359.06it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 363.81it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   4%|▍         | 10/256 [00:00<00:03, 75.08it/s, est. speed input: 76893.57 toks/s, output: 75.08 toks/s]
Processed prompts:   7%|▋         | 18/256 [00:00<00:05, 45.30it/s, est. speed input: 49672.23 toks/s, output: 48.51 toks/s]
Processed prompts:   9%|▉         | 24/256 [00:00<00:06, 38.52it/s, est. speed input: 43292.46 toks/s, output: 42.28 toks/s]
Processed prompts:  11%|█▏        | 29/256 [00:00<00:05, 39.45it/s, est. speed input: 43207.58 toks/s, output: 42.19 toks/s]
Processed prompts:  13%|█▎        | 34/256 [00:00<00:06, 35.11it/s, est. speed input: 40201.60 toks/s, output: 39.26 toks/s]
Processed prompts:  15%|█▍        | 38/256 [00:00<00:06, 34.83it/s, est. speed input: 39562.95 toks/s, output: 38.63 toks/s]
Processed prompts:  16%|█▋        | 42/256 [00:01<00:06, 34.63it/s, est. speed input: 39070.12 toks/s, output: 38.15 toks/s]
Processed prompts:  18%|█▊        | 46/256 [00:01<00:06, 34.38it/s, est. speed input: 38630.00 toks/s, output: 37.72 toks/s]
Processed prompts:  20%|█▉        | 50/256 [00:01<00:06, 34.12it/s, est. speed input: 38242.49 toks/s, output: 37.35 toks/s]
Processed prompts:  21%|██        | 54/256 [00:01<00:05, 34.03it/s, est. speed input: 37948.09 toks/s, output: 37.06 toks/s]
Processed prompts:  23%|██▎       | 58/256 [00:01<00:05, 33.91it/s, est. speed input: 37682.83 toks/s, output: 36.80 toks/s]
Processed prompts:  24%|██▍       | 62/256 [00:01<00:05, 33.83it/s, est. speed input: 37456.25 toks/s, output: 36.58 toks/s]
Processed prompts:  26%|██▌       | 66/256 [00:01<00:05, 33.70it/s, est. speed input: 37241.30 toks/s, output: 36.37 toks/s]
Processed prompts:  27%|██▋       | 70/256 [00:01<00:05, 33.68it/s, est. speed input: 37069.04 toks/s, output: 36.20 toks/s]
Processed prompts:  29%|██▉       | 74/256 [00:02<00:05, 33.67it/s, est. speed input: 36916.50 toks/s, output: 36.05 toks/s]
Processed prompts:  30%|███       | 78/256 [00:02<00:05, 33.70it/s, est. speed input: 36789.85 toks/s, output: 35.93 toks/s]
Processed prompts:  32%|███▏      | 82/256 [00:02<00:05, 33.66it/s, est. speed input: 36663.82 toks/s, output: 35.80 toks/s]
Processed prompts:  34%|███▎      | 86/256 [00:02<00:05, 33.63it/s, est. speed input: 36549.46 toks/s, output: 35.69 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:02<00:04, 33.54it/s, est. speed input: 36434.44 toks/s, output: 35.58 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:02<00:04, 33.53it/s, est. speed input: 36339.32 toks/s, output: 35.49 toks/s]
Processed prompts:  38%|███▊      | 98/256 [00:02<00:04, 33.56it/s, est. speed input: 36257.58 toks/s, output: 35.41 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:02<00:04, 33.66it/s, est. speed input: 36194.24 toks/s, output: 35.35 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:03<00:04, 33.71it/s, est. speed input: 36133.58 toks/s, output: 35.29 toks/s]
Processed prompts:  43%|████▎     | 110/256 [00:03<00:04, 33.75it/s, est. speed input: 36077.70 toks/s, output: 35.23 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:03<00:04, 33.71it/s, est. speed input: 36016.98 toks/s, output: 35.17 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:03<00:04, 33.74it/s, est. speed input: 35967.66 toks/s, output: 35.12 toks/s]
Processed prompts:  48%|████▊     | 122/256 [00:03<00:03, 33.81it/s, est. speed input: 35927.35 toks/s, output: 35.09 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:03<00:03, 33.81it/s, est. speed input: 35884.27 toks/s, output: 35.04 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:03<00:03, 33.84it/s, est. speed input: 35847.79 toks/s, output: 35.01 toks/s]
Processed prompts:  52%|█████▏    | 134/256 [00:03<00:03, 33.74it/s, est. speed input: 35799.78 toks/s, output: 34.96 toks/s]
Processed prompts:  54%|█████▍    | 138/256 [00:03<00:03, 33.66it/s, est. speed input: 35754.34 toks/s, output: 34.92 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:04<00:03, 33.71it/s, est. speed input: 35721.81 toks/s, output: 34.88 toks/s]
Processed prompts:  57%|█████▋    | 146/256 [00:04<00:03, 33.72it/s, est. speed input: 35688.59 toks/s, output: 34.85 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:04<00:03, 33.75it/s, est. speed input: 35659.67 toks/s, output: 34.82 toks/s]
Processed prompts:  60%|██████    | 154/256 [00:04<00:03, 33.79it/s, est. speed input: 35633.58 toks/s, output: 34.80 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:04<00:02, 33.80it/s, est. speed input: 35607.44 toks/s, output: 34.77 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:04<00:02, 33.90it/s, est. speed input: 35591.59 toks/s, output: 34.76 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:04<00:02, 33.88it/s, est. speed input: 35568.03 toks/s, output: 34.73 toks/s]
Processed prompts:  66%|██████▋   | 170/256 [00:04<00:02, 33.82it/s, est. speed input: 35541.98 toks/s, output: 34.71 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:05<00:02, 33.81it/s, est. speed input: 35519.33 toks/s, output: 34.69 toks/s]
Processed prompts:  70%|██████▉   | 178/256 [00:05<00:02, 33.76it/s, est. speed input: 35495.07 toks/s, output: 34.66 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:05<00:02, 33.75it/s, est. speed input: 35472.94 toks/s, output: 34.64 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:05<00:02, 33.76it/s, est. speed input: 35453.79 toks/s, output: 34.62 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:05<00:01, 33.79it/s, est. speed input: 35436.83 toks/s, output: 34.61 toks/s]
Processed prompts:  76%|███████▌  | 194/256 [00:05<00:01, 33.82it/s, est. speed input: 35421.57 toks/s, output: 34.59 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:05<00:01, 33.81it/s, est. speed input: 35404.42 toks/s, output: 34.57 toks/s]
Processed prompts:  79%|███████▉  | 202/256 [00:05<00:01, 33.73it/s, est. speed input: 35382.70 toks/s, output: 34.55 toks/s]
Processed prompts:  80%|████████  | 206/256 [00:05<00:01, 33.68it/s, est. speed input: 35362.37 toks/s, output: 34.53 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:06<00:01, 33.75it/s, est. speed input: 35350.47 toks/s, output: 34.52 toks/s]
Processed prompts:  84%|████████▎ | 214/256 [00:06<00:01, 33.78it/s, est. speed input: 35337.41 toks/s, output: 34.51 toks/s]
Processed prompts:  85%|████████▌ | 218/256 [00:06<00:01, 33.74it/s, est. speed input: 35320.34 toks/s, output: 34.49 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:06<00:01, 33.72it/s, est. speed input: 35304.77 toks/s, output: 34.48 toks/s]
Processed prompts:  88%|████████▊ | 226/256 [00:06<00:00, 33.71it/s, est. speed input: 35290.04 toks/s, output: 34.46 toks/s]
Processed prompts:  90%|████████▉ | 230/256 [00:06<00:00, 33.77it/s, est. speed input: 35280.54 toks/s, output: 34.45 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:06<00:00, 33.77it/s, est. speed input: 35268.07 toks/s, output: 34.44 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:06<00:00, 33.78it/s, est. speed input: 35257.07 toks/s, output: 34.43 toks/s]
Processed prompts:  95%|█████████▍| 242/256 [00:07<00:00, 33.75it/s, est. speed input: 35244.10 toks/s, output: 34.42 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:07<00:00, 33.82it/s, est. speed input: 35236.99 toks/s, output: 34.41 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:07<00:00, 33.83it/s, est. speed input: 35227.79 toks/s, output: 34.40 toks/s]
Processed prompts:  99%|█████████▉| 254/256 [00:07<00:00, 33.90it/s, est. speed input: 35221.94 toks/s, output: 34.40 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:07<00:00, 33.90it/s, est. speed input: 35217.78 toks/s, output: 34.39 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:07<00:00, 34.39it/s, est. speed input: 35217.78 toks/s, output: 34.39 toks/s]
[rank0]:[W128 06:50:26.197009444 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=4096 ==========
Time: 2026-01-28 06:52:47
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=512, max_num_seqs=4
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 512 --max-num-seqs 4 --max-model-len 1025 --max-num-batched-tokens 4096 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/BitNet-2B-INT8_M4096.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-28 06:53:07 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 06:53:08 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=810987) WARNING 01-28 06:54:34 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=810987) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=810987) WARNING 01-28 06:56:43 [backends.py:609] Failed to read file <frozen os>
Throughput: 52.25 requests/s, 53555.93 total tokens/s, 52.25 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512

STDERR:
[2026-01-28 06:53:01] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 06:53:07] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 06:53:07] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 06:53:07] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 06:53:07] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 06:53:07] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 06:53:07] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 06:53:07] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 06:53:07] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 06:53:07] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 06:53:07] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 06:53:07] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 06:53:07] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 06:53:07] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 06:53:26] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 06:53:30] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 06:53:30] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 06:53:30] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 06:53:30] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 06:53:30] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 06:53:30] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 06:53:30] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 06:53:30] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 06:53:30] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 06:53:30] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 06:53:30] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 06:53:30] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 06:53:30] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=810987) [2026-01-28 06:54:46] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=810987) [2026-01-28 06:54:46] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=810987) [2026-01-28 06:54:46] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=810987) [2026-01-28 06:54:46] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=810987) [2026-01-28 06:54:46] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=810987) [2026-01-28 06:54:46] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=810987) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=810987) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.25it/s]
(EngineCore_DP0 pid=810987) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.25it/s]
(EngineCore_DP0 pid=810987) 
(EngineCore_DP0 pid=810987) [2026-01-28 06:55:50] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 3424] -> 1D uint8
(EngineCore_DP0 pid=810987) [2026-01-28 06:55:50] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9891840 bytes
(EngineCore_DP0 pid=810987) [2026-01-28 06:55:50] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 3424] -> 1D uint8
(EngineCore_DP0 pid=810987) [2026-01-28 06:55:51] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 6594560 bytes
(EngineCore_DP0 pid=810987) [2026-01-28 06:55:51] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 3424] -> 1D uint8
(EngineCore_DP0 pid=810987) [2026-01-28 06:55:52] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 35610624 bytes
(EngineCore_DP0 pid=810987) [2026-01-28 06:55:52] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 9216] -> 1D uint8
(EngineCore_DP0 pid=810987) [2026-01-28 06:55:52] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 17694720 bytes
(EngineCore_DP0 pid=810987) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  25%|██▌       | 1/4 [00:02<00:07,  2.47s/it]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 2/4 [00:12<00:13,  6.80s/it]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  75%|███████▌  | 3/4 [00:12<00:03,  3.97s/it]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:13<00:00,  2.76s/it]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:13<00:00,  3.45s/it]
(EngineCore_DP0 pid=810987) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  33%|███▎      | 1/3 [00:00<00:01,  1.20it/s]
Capturing CUDA graphs (decode, FULL):  67%|██████▋   | 2/3 [00:01<00:00,  2.18it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:01<00:00,  2.87it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:01<00:00,  2.41it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   7%|▋         | 36/512 [00:00<00:01, 357.50it/s]
Adding requests:  15%|█▍        | 76/512 [00:00<00:01, 376.70it/s]
Adding requests:  22%|██▏       | 114/512 [00:00<00:01, 374.85it/s]
Adding requests:  30%|██▉       | 152/512 [00:00<00:00, 363.75it/s]
Adding requests:  37%|███▋      | 189/512 [00:00<00:00, 361.75it/s]
Adding requests:  44%|████▍     | 227/512 [00:00<00:00, 367.64it/s]
Adding requests:  52%|█████▏    | 264/512 [00:00<00:00, 368.35it/s]
Adding requests:  59%|█████▉    | 301/512 [00:00<00:00, 364.00it/s]
Adding requests:  66%|██████▌   | 339/512 [00:00<00:00, 367.37it/s]
Adding requests:  74%|███████▍  | 378/512 [00:01<00:00, 372.23it/s]
Adding requests:  81%|████████▏ | 416/512 [00:01<00:00, 373.05it/s]
Adding requests:  89%|████████▊ | 454/512 [00:01<00:00, 372.57it/s]
Adding requests:  96%|█████████▌| 492/512 [00:01<00:00, 373.44it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 369.28it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  13%|█▎        | 66/512 [00:00<00:01, 421.28it/s, est. speed input: 431455.93 toks/s, output: 421.30 toks/s]
Processed prompts:  21%|██▏       | 109/512 [00:00<00:03, 104.68it/s, est. speed input: 124145.63 toks/s, output: 121.24 toks/s]
Processed prompts:  25%|██▌       | 130/512 [00:01<00:04, 80.07it/s, est. speed input: 99001.41 toks/s, output: 96.68 toks/s]   
Processed prompts:  28%|██▊       | 144/512 [00:01<00:04, 76.05it/s, est. speed input: 94081.00 toks/s, output: 91.88 toks/s]
Processed prompts:  30%|███       | 155/512 [00:01<00:05, 69.35it/s, est. speed input: 88652.02 toks/s, output: 86.57 toks/s]
Processed prompts:  32%|███▏      | 164/512 [00:01<00:05, 67.60it/s, est. speed input: 86582.01 toks/s, output: 84.55 toks/s]
Processed prompts:  34%|███▎      | 172/512 [00:02<00:05, 64.57it/s, est. speed input: 84318.10 toks/s, output: 82.34 toks/s]
Processed prompts:  35%|███▍      | 179/512 [00:02<00:05, 60.49it/s, est. speed input: 81934.63 toks/s, output: 80.01 toks/s]
Processed prompts:  36%|███▋      | 186/512 [00:02<00:05, 57.10it/s, est. speed input: 79829.45 toks/s, output: 77.96 toks/s]
Processed prompts:  38%|███▊      | 194/512 [00:02<00:05, 56.24it/s, est. speed input: 78380.00 toks/s, output: 76.54 toks/s]
Processed prompts:  39%|███▉      | 202/512 [00:02<00:05, 55.56it/s, est. speed input: 77086.20 toks/s, output: 75.28 toks/s]
Processed prompts:  41%|████      | 210/512 [00:02<00:05, 55.09it/s, est. speed input: 75938.94 toks/s, output: 74.16 toks/s]
Processed prompts:  43%|████▎     | 218/512 [00:02<00:05, 54.68it/s, est. speed input: 74888.62 toks/s, output: 73.13 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:03<00:05, 54.38it/s, est. speed input: 73937.47 toks/s, output: 72.20 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:03<00:05, 54.16it/s, est. speed input: 73072.34 toks/s, output: 71.36 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:03<00:05, 53.97it/s, est. speed input: 72276.24 toks/s, output: 70.58 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:03<00:04, 53.88it/s, est. speed input: 71554.80 toks/s, output: 69.88 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:03<00:04, 53.81it/s, est. speed input: 70889.44 toks/s, output: 69.23 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:03<00:04, 53.69it/s, est. speed input: 70263.13 toks/s, output: 68.62 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:04<00:04, 53.70it/s, est. speed input: 69699.99 toks/s, output: 68.07 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:04<00:04, 53.67it/s, est. speed input: 69169.69 toks/s, output: 67.55 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:04<00:04, 53.68it/s, est. speed input: 68681.70 toks/s, output: 67.07 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:04<00:03, 53.64it/s, est. speed input: 68218.50 toks/s, output: 66.62 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:04<00:03, 53.68it/s, est. speed input: 67795.33 toks/s, output: 66.21 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:04<00:03, 53.62it/s, est. speed input: 67387.21 toks/s, output: 65.81 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:04<00:03, 53.61it/s, est. speed input: 67007.09 toks/s, output: 65.44 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:05<00:03, 53.56it/s, est. speed input: 66644.84 toks/s, output: 65.08 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:05<00:03, 53.52it/s, est. speed input: 66302.81 toks/s, output: 64.75 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:05<00:03, 53.58it/s, est. speed input: 65989.31 toks/s, output: 64.44 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:05<00:02, 53.61it/s, est. speed input: 65691.71 toks/s, output: 64.15 toks/s]
Processed prompts:  71%|███████   | 362/512 [00:05<00:02, 53.67it/s, est. speed input: 65413.48 toks/s, output: 63.88 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [00:05<00:02, 53.64it/s, est. speed input: 65142.44 toks/s, output: 63.62 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [00:05<00:02, 53.57it/s, est. speed input: 64880.18 toks/s, output: 63.36 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [00:06<00:02, 53.58it/s, est. speed input: 64636.19 toks/s, output: 63.12 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [00:06<00:02, 53.60it/s, est. speed input: 64406.66 toks/s, output: 62.90 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [00:06<00:02, 53.57it/s, est. speed input: 64182.26 toks/s, output: 62.68 toks/s]
Processed prompts:  80%|████████  | 410/512 [00:06<00:01, 53.65it/s, est. speed input: 63977.33 toks/s, output: 62.48 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [00:06<00:01, 53.68it/s, est. speed input: 63778.07 toks/s, output: 62.28 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [00:06<00:01, 53.71it/s, est. speed input: 63588.58 toks/s, output: 62.10 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [00:07<00:01, 53.69it/s, est. speed input: 63405.30 toks/s, output: 61.92 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [00:07<00:01, 53.70it/s, est. speed input: 63230.83 toks/s, output: 61.75 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [00:07<00:01, 53.69it/s, est. speed input: 63061.16 toks/s, output: 61.58 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [00:07<00:01, 53.72it/s, est. speed input: 62902.00 toks/s, output: 61.43 toks/s]
Processed prompts:  91%|█████████ | 466/512 [00:07<00:00, 53.76it/s, est. speed input: 62750.23 toks/s, output: 61.28 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [00:07<00:00, 53.79it/s, est. speed input: 62604.86 toks/s, output: 61.14 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [00:07<00:00, 53.82it/s, est. speed input: 62465.53 toks/s, output: 61.00 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [00:08<00:00, 53.86it/s, est. speed input: 62333.08 toks/s, output: 60.87 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [00:08<00:00, 53.86it/s, est. speed input: 62202.25 toks/s, output: 60.74 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [00:08<00:00, 53.86it/s, est. speed input: 62077.08 toks/s, output: 60.62 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:08<00:00, 53.86it/s, est. speed input: 62333.95 toks/s, output: 60.87 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:08<00:00, 60.87it/s, est. speed input: 62333.95 toks/s, output: 60.87 toks/s]
[rank0]:[W128 06:57:44.895753425 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=8192 ==========
Time: 2026-01-28 06:59:08
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=1024, max_num_seqs=8
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 1024 --max-num-seqs 8 --max-model-len 1025 --max-num-batched-tokens 8192 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/BitNet-2B-INT8_M8192.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-28 07:00:11 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 07:00:12 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=814330) WARNING 01-28 07:01:19 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=814330) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=814330) WARNING 01-28 07:03:39 [backends.py:609] Failed to read file <frozen os>
Throughput: 32.78 requests/s, 33601.91 total tokens/s, 32.78 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024

STDERR:
[2026-01-28 07:00:07] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 07:00:11] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 07:00:11] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 07:00:11] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 07:00:11] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 07:00:11] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 07:00:11] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 07:00:11] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 07:00:11] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 07:00:11] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 07:00:11] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 07:00:11] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 07:00:11] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 07:00:11] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 07:00:31] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 07:01:05] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 07:01:05] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 07:01:05] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 07:01:05] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 07:01:05] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 07:01:05] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 07:01:05] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 07:01:05] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 07:01:05] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 07:01:05] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 07:01:05] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 07:01:05] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 07:01:05] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=814330) [2026-01-28 07:01:26] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=814330) [2026-01-28 07:01:26] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=814330) [2026-01-28 07:01:26] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=814330) [2026-01-28 07:01:26] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=814330) [2026-01-28 07:01:26] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=814330) [2026-01-28 07:01:26] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=814330) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=814330) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.23it/s]
(EngineCore_DP0 pid=814330) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.23it/s]
(EngineCore_DP0 pid=814330) 
(EngineCore_DP0 pid=814330) [2026-01-28 07:02:30] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 3424] -> 1D uint8
(EngineCore_DP0 pid=814330) [2026-01-28 07:02:33] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9891840 bytes
(EngineCore_DP0 pid=814330) [2026-01-28 07:02:33] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 3424] -> 1D uint8
(EngineCore_DP0 pid=814330) [2026-01-28 07:02:33] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 6594560 bytes
(EngineCore_DP0 pid=814330) [2026-01-28 07:02:33] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 3424] -> 1D uint8
(EngineCore_DP0 pid=814330) [2026-01-28 07:02:33] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 35610624 bytes
(EngineCore_DP0 pid=814330) [2026-01-28 07:02:33] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 9216] -> 1D uint8
(EngineCore_DP0 pid=814330) [2026-01-28 07:02:33] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 17694720 bytes
(EngineCore_DP0 pid=814330) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:01<00:07,  1.97s/it]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  40%|████      | 2/5 [00:03<00:05,  2.00s/it]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  60%|██████    | 3/5 [00:06<00:04,  2.24s/it]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  80%|████████  | 4/5 [00:08<00:02,  2.04s/it]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:09<00:00,  1.84s/it]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:09<00:00,  1.95s/it]
(EngineCore_DP0 pid=814330) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:01,  2.76it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 2/4 [00:00<00:00,  3.46it/s]
Capturing CUDA graphs (decode, FULL):  75%|███████▌  | 3/4 [00:01<00:00,  2.49it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:01<00:00,  2.18it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:01<00:00,  2.38it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   3%|▎         | 35/1024 [00:00<00:02, 348.76it/s]
Adding requests:   7%|▋         | 74/1024 [00:00<00:02, 371.42it/s]
Adding requests:  11%|█         | 113/1024 [00:00<00:02, 378.11it/s]
Adding requests:  15%|█▍        | 151/1024 [00:00<00:02, 377.98it/s]
Adding requests:  19%|█▊        | 190/1024 [00:00<00:02, 381.61it/s]
Adding requests:  22%|██▏       | 230/1024 [00:00<00:02, 386.32it/s]
Adding requests:  26%|██▋       | 270/1024 [00:00<00:01, 388.87it/s]
Adding requests:  30%|███       | 309/1024 [00:00<00:01, 386.36it/s]
Adding requests:  34%|███▍      | 348/1024 [00:00<00:01, 385.10it/s]
Adding requests:  38%|███▊      | 387/1024 [00:01<00:01, 386.19it/s]
Adding requests:  42%|████▏     | 427/1024 [00:01<00:01, 387.73it/s]
Adding requests:  46%|████▌     | 467/1024 [00:01<00:01, 388.57it/s]
Adding requests:  49%|████▉     | 506/1024 [00:01<00:01, 386.63it/s]
Adding requests:  53%|█████▎    | 545/1024 [00:01<00:01, 379.59it/s]
Adding requests:  57%|█████▋    | 586/1024 [00:01<00:01, 388.39it/s]
Adding requests:  61%|██████    | 627/1024 [00:01<00:01, 393.42it/s]
Adding requests:  65%|██████▌   | 667/1024 [00:01<00:00, 388.43it/s]
Adding requests:  69%|██████▉   | 708/1024 [00:01<00:00, 393.39it/s]
Adding requests:  73%|███████▎  | 748/1024 [00:01<00:00, 391.36it/s]
Adding requests:  77%|███████▋  | 789/1024 [00:02<00:00, 392.75it/s]
Adding requests:  81%|████████  | 829/1024 [00:02<00:00, 386.87it/s]
Adding requests:  85%|████████▍ | 869/1024 [00:02<00:00, 389.28it/s]
Adding requests:  89%|████████▉ | 911/1024 [00:02<00:00, 396.44it/s]
Adding requests:  93%|█████████▎| 951/1024 [00:02<00:00, 396.98it/s]
Adding requests:  97%|█████████▋| 993/1024 [00:02<00:00, 401.25it/s]
Adding requests: 100%|██████████| 1024/1024 [00:02<00:00, 389.82it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   0%|          | 2/1024 [00:09<1:25:02,  4.99s/it, est. speed input: 205.08 toks/s, output: 0.20 toks/s]
Processed prompts:   1%|          | 10/1024 [00:10<12:49,  1.32it/s, est. speed input: 1010.94 toks/s, output: 0.99 toks/s]
Processed prompts:   2%|▏         | 18/1024 [00:10<05:54,  2.84it/s, est. speed input: 1794.34 toks/s, output: 1.75 toks/s]
Processed prompts:   3%|▎         | 26/1024 [00:10<03:25,  4.87it/s, est. speed input: 2555.59 toks/s, output: 2.50 toks/s]
Processed prompts:   3%|▎         | 34/1024 [00:10<02:11,  7.50it/s, est. speed input: 3295.83 toks/s, output: 3.22 toks/s]
Processed prompts:   4%|▍         | 42/1024 [00:10<01:30, 10.82it/s, est. speed input: 4016.02 toks/s, output: 3.92 toks/s]
Processed prompts:   5%|▍         | 50/1024 [00:10<01:05, 14.84it/s, est. speed input: 4716.90 toks/s, output: 4.61 toks/s]
Processed prompts:   6%|▌         | 58/1024 [00:11<00:49, 19.44it/s, est. speed input: 5399.16 toks/s, output: 5.27 toks/s]
Processed prompts:   6%|▋         | 66/1024 [00:11<00:39, 24.45it/s, est. speed input: 6063.61 toks/s, output: 5.92 toks/s]
Processed prompts:   7%|▋         | 74/1024 [00:11<00:32, 29.57it/s, est. speed input: 6710.98 toks/s, output: 6.55 toks/s]
Processed prompts:   8%|▊         | 82/1024 [00:11<00:27, 34.47it/s, est. speed input: 7341.87 toks/s, output: 7.17 toks/s]
Processed prompts:   9%|▉         | 90/1024 [00:11<00:24, 38.90it/s, est. speed input: 7956.81 toks/s, output: 7.77 toks/s]
Processed prompts:  10%|▉         | 98/1024 [00:11<00:21, 42.70it/s, est. speed input: 8556.60 toks/s, output: 8.36 toks/s]
Processed prompts:  10%|█         | 106/1024 [00:11<00:20, 45.82it/s, est. speed input: 9141.90 toks/s, output: 8.93 toks/s]
Processed prompts:  11%|█         | 114/1024 [00:12<00:18, 48.20it/s, est. speed input: 9712.48 toks/s, output: 9.48 toks/s]
Processed prompts:  12%|█▏        | 122/1024 [00:12<00:18, 50.08it/s, est. speed input: 10269.85 toks/s, output: 10.03 toks/s]
Processed prompts:  13%|█▎        | 130/1024 [00:12<00:17, 51.46it/s, est. speed input: 10813.90 toks/s, output: 10.56 toks/s]
Processed prompts:  13%|█▎        | 138/1024 [00:12<00:16, 52.46it/s, est. speed input: 11345.19 toks/s, output: 11.08 toks/s]
Processed prompts:  14%|█▍        | 146/1024 [00:12<00:16, 53.16it/s, est. speed input: 11864.04 toks/s, output: 11.59 toks/s]
Processed prompts:  15%|█▌        | 154/1024 [00:12<00:16, 53.69it/s, est. speed input: 12371.19 toks/s, output: 12.08 toks/s]
Processed prompts:  16%|█▌        | 162/1024 [00:12<00:15, 54.01it/s, est. speed input: 12866.46 toks/s, output: 12.56 toks/s]
Processed prompts:  17%|█▋        | 170/1024 [00:13<00:15, 54.29it/s, est. speed input: 13351.04 toks/s, output: 13.04 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [00:13<00:15, 54.50it/s, est. speed input: 13825.09 toks/s, output: 13.50 toks/s]
Processed prompts:  18%|█▊        | 186/1024 [00:13<00:15, 54.64it/s, est. speed input: 14288.69 toks/s, output: 13.95 toks/s]
Processed prompts:  19%|█▉        | 194/1024 [00:13<00:15, 54.73it/s, est. speed input: 14742.27 toks/s, output: 14.40 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [00:13<00:14, 54.81it/s, est. speed input: 15186.24 toks/s, output: 14.83 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:13<00:14, 54.82it/s, est. speed input: 15620.38 toks/s, output: 15.25 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [00:13<00:14, 54.86it/s, est. speed input: 16045.80 toks/s, output: 15.67 toks/s]
Processed prompts:  22%|██▏       | 226/1024 [00:14<00:14, 54.85it/s, est. speed input: 16461.94 toks/s, output: 16.08 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:14<00:14, 54.87it/s, est. speed input: 16869.86 toks/s, output: 16.47 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:14<00:14, 54.91it/s, est. speed input: 17269.74 toks/s, output: 16.86 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:14<00:14, 54.92it/s, est. speed input: 17661.48 toks/s, output: 17.25 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:14<00:13, 54.92it/s, est. speed input: 18045.31 toks/s, output: 17.62 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:14<00:13, 54.94it/s, est. speed input: 18421.72 toks/s, output: 17.99 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:14<00:13, 54.91it/s, est. speed input: 18790.44 toks/s, output: 18.35 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:15<00:13, 54.90it/s, est. speed input: 19152.07 toks/s, output: 18.70 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:15<00:13, 54.88it/s, est. speed input: 19506.69 toks/s, output: 19.05 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:15<00:13, 54.86it/s, est. speed input: 19854.42 toks/s, output: 19.39 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:15<00:13, 54.86it/s, est. speed input: 20195.74 toks/s, output: 19.72 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:15<00:12, 54.86it/s, est. speed input: 20530.84 toks/s, output: 20.05 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:15<00:12, 54.84it/s, est. speed input: 20859.38 toks/s, output: 20.37 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:15<00:12, 54.74it/s, est. speed input: 21181.00 toks/s, output: 20.68 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:16<00:12, 54.80it/s, est. speed input: 21498.30 toks/s, output: 20.99 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:16<00:12, 54.83it/s, est. speed input: 21809.74 toks/s, output: 21.30 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:16<00:12, 54.81it/s, est. speed input: 22115.13 toks/s, output: 21.60 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:16<00:12, 54.83it/s, est. speed input: 22415.57 toks/s, output: 21.89 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:16<00:11, 54.87it/s, est. speed input: 22711.00 toks/s, output: 22.18 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:16<00:11, 54.89it/s, est. speed input: 23001.24 toks/s, output: 22.46 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:16<00:11, 54.90it/s, est. speed input: 23286.59 toks/s, output: 22.74 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [00:17<00:11, 54.93it/s, est. speed input: 23567.22 toks/s, output: 23.01 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:17<00:11, 54.93it/s, est. speed input: 23842.90 toks/s, output: 23.28 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:17<00:11, 54.90it/s, est. speed input: 24113.57 toks/s, output: 23.55 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:17<00:11, 54.89it/s, est. speed input: 24379.95 toks/s, output: 23.81 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:17<00:10, 54.88it/s, est. speed input: 24641.81 toks/s, output: 24.06 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:17<00:10, 54.84it/s, est. speed input: 24899.07 toks/s, output: 24.32 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:17<00:10, 54.81it/s, est. speed input: 25152.06 toks/s, output: 24.56 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:18<00:10, 54.25it/s, est. speed input: 25394.23 toks/s, output: 24.80 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:18<00:10, 54.42it/s, est. speed input: 25639.46 toks/s, output: 25.04 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:18<00:10, 54.55it/s, est. speed input: 25881.21 toks/s, output: 25.27 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:18<00:10, 54.66it/s, est. speed input: 26118.91 toks/s, output: 25.51 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:18<00:09, 54.72it/s, est. speed input: 26353.02 toks/s, output: 25.74 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:18<00:09, 54.77it/s, est. speed input: 26583.47 toks/s, output: 25.96 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:19<00:09, 54.80it/s, est. speed input: 26810.41 toks/s, output: 26.18 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:19<00:09, 54.81it/s, est. speed input: 27033.77 toks/s, output: 26.40 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:19<00:09, 54.79it/s, est. speed input: 27253.40 toks/s, output: 26.61 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:19<00:09, 54.80it/s, est. speed input: 27469.96 toks/s, output: 26.83 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:19<00:09, 54.80it/s, est. speed input: 27683.33 toks/s, output: 27.03 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:19<00:08, 54.79it/s, est. speed input: 27893.38 toks/s, output: 27.24 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:19<00:08, 54.81it/s, est. speed input: 28100.58 toks/s, output: 27.44 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:20<00:08, 54.80it/s, est. speed input: 28304.55 toks/s, output: 27.64 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:20<00:08, 54.82it/s, est. speed input: 28505.92 toks/s, output: 27.84 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:20<00:08, 54.80it/s, est. speed input: 28703.92 toks/s, output: 28.03 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:20<00:08, 54.80it/s, est. speed input: 28899.35 toks/s, output: 28.22 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:20<00:07, 54.82it/s, est. speed input: 29092.25 toks/s, output: 28.41 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:20<00:07, 54.84it/s, est. speed input: 29282.52 toks/s, output: 28.60 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:20<00:07, 54.87it/s, est. speed input: 29470.25 toks/s, output: 28.78 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:21<00:07, 54.88it/s, est. speed input: 29655.26 toks/s, output: 28.96 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:21<00:07, 54.88it/s, est. speed input: 29837.68 toks/s, output: 29.14 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:21<00:07, 54.89it/s, est. speed input: 30017.81 toks/s, output: 29.31 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:21<00:07, 54.72it/s, est. speed input: 30193.16 toks/s, output: 29.49 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:21<00:06, 54.73it/s, est. speed input: 30367.82 toks/s, output: 29.66 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:21<00:06, 54.76it/s, est. speed input: 30540.38 toks/s, output: 29.82 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:21<00:06, 54.69it/s, est. speed input: 30709.59 toks/s, output: 29.99 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:23<00:21, 16.31it/s, est. speed input: 29352.65 toks/s, output: 28.66 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:23<00:16, 20.60it/s, est. speed input: 29514.68 toks/s, output: 28.82 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:23<00:13, 25.25it/s, est. speed input: 29674.36 toks/s, output: 28.98 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:23<00:11, 29.98it/s, est. speed input: 29832.22 toks/s, output: 29.13 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:23<00:09, 34.51it/s, est. speed input: 29988.10 toks/s, output: 29.29 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:23<00:08, 38.61it/s, est. speed input: 30142.46 toks/s, output: 29.44 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:24<00:07, 42.11it/s, est. speed input: 30294.73 toks/s, output: 29.58 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:24<00:06, 44.93it/s, est. speed input: 30444.70 toks/s, output: 29.73 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:24<00:06, 47.15it/s, est. speed input: 30592.95 toks/s, output: 29.88 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:24<00:05, 48.83it/s, est. speed input: 30739.30 toks/s, output: 30.02 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:24<00:05, 50.14it/s, est. speed input: 30884.50 toks/s, output: 30.16 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:24<00:05, 51.08it/s, est. speed input: 31027.87 toks/s, output: 30.30 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:25<00:05, 51.76it/s, est. speed input: 31169.48 toks/s, output: 30.44 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:25<00:04, 52.22it/s, est. speed input: 31309.15 toks/s, output: 30.58 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:25<00:04, 52.56it/s, est. speed input: 31447.26 toks/s, output: 30.71 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:25<00:04, 52.80it/s, est. speed input: 31583.76 toks/s, output: 30.84 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:25<00:04, 52.94it/s, est. speed input: 31718.22 toks/s, output: 30.97 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:25<00:04, 53.07it/s, est. speed input: 31851.63 toks/s, output: 31.11 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:25<00:04, 53.16it/s, est. speed input: 31983.37 toks/s, output: 31.23 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:26<00:03, 53.25it/s, est. speed input: 32113.98 toks/s, output: 31.36 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:26<00:03, 53.30it/s, est. speed input: 32242.96 toks/s, output: 31.49 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:26<00:03, 53.33it/s, est. speed input: 32370.34 toks/s, output: 31.61 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [00:26<00:03, 53.37it/s, est. speed input: 32496.49 toks/s, output: 31.73 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [00:26<00:03, 53.38it/s, est. speed input: 32621.10 toks/s, output: 31.86 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:26<00:03, 53.38it/s, est. speed input: 32744.17 toks/s, output: 31.98 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [00:26<00:02, 53.37it/s, est. speed input: 32865.84 toks/s, output: 32.10 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [00:27<00:02, 53.39it/s, est. speed input: 32986.38 toks/s, output: 32.21 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [00:27<00:02, 53.36it/s, est. speed input: 33105.14 toks/s, output: 32.33 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [00:27<00:02, 53.34it/s, est. speed input: 33222.64 toks/s, output: 32.44 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [00:27<00:02, 53.32it/s, est. speed input: 33338.75 toks/s, output: 32.56 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [00:27<00:02, 53.33it/s, est. speed input: 33453.88 toks/s, output: 32.67 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [00:27<00:02, 53.34it/s, est. speed input: 33567.85 toks/s, output: 32.78 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [00:28<00:01, 53.35it/s, est. speed input: 33680.61 toks/s, output: 32.89 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [00:28<00:01, 53.78it/s, est. speed input: 33796.87 toks/s, output: 33.00 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [00:28<00:01, 54.08it/s, est. speed input: 33911.90 toks/s, output: 33.12 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [00:28<00:01, 54.27it/s, est. speed input: 34025.52 toks/s, output: 33.23 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [00:28<00:01, 54.42it/s, est. speed input: 34138.07 toks/s, output: 33.34 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [00:28<00:01, 54.51it/s, est. speed input: 34249.38 toks/s, output: 33.45 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [00:28<00:00, 54.57it/s, est. speed input: 34359.49 toks/s, output: 33.55 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [00:29<00:00, 54.62it/s, est. speed input: 34468.67 toks/s, output: 33.66 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [00:29<00:00, 56.55it/s, est. speed input: 34596.05 toks/s, output: 33.79 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [00:29<00:00, 55.98it/s, est. speed input: 34702.80 toks/s, output: 33.89 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [00:29<00:00, 55.63it/s, est. speed input: 34808.90 toks/s, output: 33.99 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [00:29<00:00, 55.37it/s, est. speed input: 34913.89 toks/s, output: 34.10 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [00:29<00:00, 57.31it/s, est. speed input: 35038.74 toks/s, output: 34.22 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:29<00:00, 57.31it/s, est. speed input: 35244.95 toks/s, output: 34.42 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:29<00:00, 34.42it/s, est. speed input: 35244.95 toks/s, output: 34.42 toks/s]
[rank0]:[W128 07:05:16.509222711 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=16384 ==========
Time: 2026-01-28 07:06:47
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=2048, max_num_seqs=16
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 2048 --max-num-seqs 16 --max-model-len 1025 --max-num-batched-tokens 16384 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/BitNet-2B-INT8_M16384.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-28 07:07:27 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 07:07:28 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=817764) WARNING 01-28 07:09:55 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=817764) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=817764) WARNING 01-28 07:11:03 [backends.py:609] Failed to read file <frozen os>
Throughput: 52.75 requests/s, 54065.00 total tokens/s, 52.75 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048

STDERR:
[2026-01-28 07:07:13] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 07:07:27] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 07:07:27] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 07:07:27] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 07:07:27] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 07:07:27] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 07:07:27] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 07:07:27] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 07:07:27] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 07:07:27] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 07:07:27] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 07:07:27] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 07:07:27] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 07:07:27] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 07:08:00] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 07:08:08] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 07:08:08] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 07:08:08] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 07:08:08] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 07:08:08] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 07:08:08] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 07:08:08] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 07:08:08] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 07:08:08] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 07:08:08] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 07:08:08] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 07:08:08] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 07:08:08] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[W128 07:09:55.387440171 socket.cpp:209] [c10d] The hostname of the client socket cannot be retrieved. err=-3
(EngineCore_DP0 pid=817764) [2026-01-28 07:09:58] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=817764) [2026-01-28 07:09:58] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=817764) [2026-01-28 07:09:58] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=817764) [2026-01-28 07:09:58] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=817764) [2026-01-28 07:09:58] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=817764) [2026-01-28 07:09:58] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=817764) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=817764) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.30it/s]
(EngineCore_DP0 pid=817764) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.30it/s]
(EngineCore_DP0 pid=817764) 
(EngineCore_DP0 pid=817764) [2026-01-28 07:10:09] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 3424] -> 1D uint8
(EngineCore_DP0 pid=817764) [2026-01-28 07:10:10] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9891840 bytes
(EngineCore_DP0 pid=817764) [2026-01-28 07:10:10] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 3424] -> 1D uint8
(EngineCore_DP0 pid=817764) [2026-01-28 07:10:10] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 6594560 bytes
(EngineCore_DP0 pid=817764) [2026-01-28 07:10:10] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 3424] -> 1D uint8
(EngineCore_DP0 pid=817764) [2026-01-28 07:10:10] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 35610624 bytes
(EngineCore_DP0 pid=817764) [2026-01-28 07:10:10] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 9216] -> 1D uint8
(EngineCore_DP0 pid=817764) [2026-01-28 07:10:10] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 17694720 bytes
(EngineCore_DP0 pid=817764) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  14%|█▍        | 1/7 [00:07<00:45,  7.64s/it]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  29%|██▊       | 2/7 [00:10<00:24,  4.83s/it]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  43%|████▎     | 3/7 [00:13<00:16,  4.10s/it]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  57%|█████▋    | 4/7 [00:25<00:21,  7.01s/it]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  71%|███████▏  | 5/7 [00:26<00:09,  5.00s/it]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  86%|████████▌ | 6/7 [00:29<00:04,  4.24s/it]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:29<00:00,  3.04s/it]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:29<00:00,  4.28s/it]
(EngineCore_DP0 pid=817764) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  20%|██        | 1/5 [00:01<00:04,  1.23s/it]
Capturing CUDA graphs (decode, FULL):  40%|████      | 2/5 [00:02<00:03,  1.16s/it]
Capturing CUDA graphs (decode, FULL):  60%|██████    | 3/5 [00:04<00:02,  1.47s/it]
Capturing CUDA graphs (decode, FULL):  80%|████████  | 4/5 [00:05<00:01,  1.45s/it]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:07<00:00,  1.43s/it]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:07<00:00,  1.40s/it]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 36/2048 [00:00<00:05, 353.47it/s]
Adding requests:   4%|▎         | 75/2048 [00:00<00:05, 369.34it/s]
Adding requests:   6%|▌         | 114/2048 [00:00<00:05, 374.13it/s]
Adding requests:   7%|▋         | 152/2048 [00:00<00:05, 372.14it/s]
Adding requests:   9%|▉         | 190/2048 [00:00<00:05, 367.44it/s]
Adding requests:  11%|█         | 227/2048 [00:00<00:04, 367.50it/s]
Adding requests:  13%|█▎        | 264/2048 [00:00<00:04, 368.28it/s]
Adding requests:  15%|█▍        | 301/2048 [00:00<00:04, 365.55it/s]
Adding requests:  17%|█▋        | 338/2048 [00:00<00:04, 366.40it/s]
Adding requests:  18%|█▊        | 375/2048 [00:01<00:04, 367.21it/s]
Adding requests:  20%|██        | 413/2048 [00:01<00:04, 370.33it/s]
Adding requests:  22%|██▏       | 451/2048 [00:01<00:04, 370.90it/s]
Adding requests:  24%|██▍       | 489/2048 [00:01<00:04, 370.19it/s]
Adding requests:  26%|██▌       | 527/2048 [00:01<00:04, 365.23it/s]
Adding requests:  28%|██▊       | 567/2048 [00:01<00:03, 373.45it/s]
Adding requests:  30%|██▉       | 605/2048 [00:01<00:03, 375.28it/s]
Adding requests:  32%|███▏      | 646/2048 [00:01<00:03, 382.91it/s]
Adding requests:  33%|███▎      | 686/2048 [00:01<00:03, 385.46it/s]
Adding requests:  35%|███▌      | 726/2048 [00:01<00:03, 388.09it/s]
Adding requests:  37%|███▋      | 765/2048 [00:02<00:03, 380.96it/s]
Adding requests:  39%|███▉      | 804/2048 [00:02<00:03, 375.83it/s]
Adding requests:  41%|████      | 842/2048 [00:02<00:03, 370.40it/s]
Adding requests:  43%|████▎     | 880/2048 [00:02<00:03, 367.37it/s]
Adding requests:  45%|████▍     | 919/2048 [00:02<00:03, 372.21it/s]
Adding requests:  47%|████▋     | 957/2048 [00:02<00:02, 372.92it/s]
Adding requests:  49%|████▊     | 996/2048 [00:02<00:02, 377.81it/s]
Adding requests:  50%|█████     | 1034/2048 [00:02<00:02, 376.67it/s]
Adding requests:  52%|█████▏    | 1072/2048 [00:02<00:02, 374.63it/s]
Adding requests:  54%|█████▍    | 1112/2048 [00:02<00:02, 379.89it/s]
Adding requests:  56%|█████▌    | 1150/2048 [00:03<00:02, 376.11it/s]
Adding requests:  58%|█████▊    | 1192/2048 [00:03<00:02, 386.44it/s]
Adding requests:  60%|██████    | 1231/2048 [00:03<00:02, 384.30it/s]
Adding requests:  62%|██████▏   | 1270/2048 [00:03<00:02, 380.15it/s]
Adding requests:  64%|██████▍   | 1310/2048 [00:03<00:01, 383.97it/s]
Adding requests:  66%|██████▌   | 1350/2048 [00:03<00:01, 387.76it/s]
Adding requests:  68%|██████▊   | 1390/2048 [00:03<00:01, 388.50it/s]
Adding requests:  70%|██████▉   | 1429/2048 [00:03<00:01, 388.61it/s]
Adding requests:  72%|███████▏  | 1469/2048 [00:03<00:01, 389.71it/s]
Adding requests:  74%|███████▎  | 1509/2048 [00:03<00:01, 391.46it/s]
Adding requests:  76%|███████▌  | 1549/2048 [00:04<00:01, 389.23it/s]
Adding requests:  78%|███████▊  | 1589/2048 [00:04<00:01, 389.81it/s]
Adding requests:  80%|███████▉  | 1629/2048 [00:04<00:01, 390.43it/s]
Adding requests:  81%|████████▏ | 1669/2048 [00:04<00:00, 386.96it/s]
Adding requests:  83%|████████▎ | 1708/2048 [00:04<00:00, 387.20it/s]
Adding requests:  85%|████████▌ | 1747/2048 [00:04<00:00, 386.26it/s]
Adding requests:  87%|████████▋ | 1786/2048 [00:04<00:00, 386.36it/s]
Adding requests:  89%|████████▉ | 1825/2048 [00:04<00:00, 383.19it/s]
Adding requests:  91%|█████████ | 1864/2048 [00:04<00:00, 382.14it/s]
Adding requests:  93%|█████████▎| 1904/2048 [00:05<00:00, 384.79it/s]
Adding requests:  95%|█████████▍| 1943/2048 [00:05<00:00, 380.65it/s]
Adding requests:  97%|█████████▋| 1982/2048 [00:05<00:00, 383.19it/s]
Adding requests:  99%|█████████▊| 2021/2048 [00:05<00:00, 374.72it/s]
Adding requests: 100%|██████████| 2048/2048 [00:05<00:00, 379.00it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  12%|█▏        | 242/2048 [00:00<00:01, 1158.39it/s, est. speed input: 1186349.43 toks/s, output: 1158.44 toks/s]
Processed prompts:  17%|█▋        | 358/2048 [00:02<00:12, 136.93it/s, est. speed input: 170744.84 toks/s, output: 166.74 toks/s]   
Processed prompts:  20%|██        | 410/2048 [00:02<00:14, 110.07it/s, est. speed input: 141105.27 toks/s, output: 137.80 toks/s]
Processed prompts:  22%|██▏       | 441/2048 [00:03<00:16, 96.24it/s, est. speed input: 128014.94 toks/s, output: 125.01 toks/s] 
Processed prompts:  23%|██▎       | 462/2048 [00:03<00:17, 93.11it/s, est. speed input: 124369.32 toks/s, output: 121.45 toks/s]
Processed prompts:  23%|██▎       | 479/2048 [00:04<00:17, 87.43it/s, est. speed input: 120236.10 toks/s, output: 117.42 toks/s]
Processed prompts:  24%|██▍       | 492/2048 [00:04<00:19, 79.09it/s, est. speed input: 115649.17 toks/s, output: 112.94 toks/s]
Processed prompts:  25%|██▍       | 503/2048 [00:04<00:22, 70.18it/s, est. speed input: 111187.61 toks/s, output: 108.58 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [00:04<00:24, 62.74it/s, est. speed input: 107224.01 toks/s, output: 104.71 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [00:05<00:24, 61.51it/s, est. speed input: 104676.56 toks/s, output: 102.22 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [00:05<00:24, 60.53it/s, est. speed input: 102379.57 toks/s, output: 99.98 toks/s] 
Processed prompts:  27%|██▋       | 562/2048 [00:05<00:24, 59.81it/s, est. speed input: 100306.89 toks/s, output: 97.96 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [00:06<00:24, 59.27it/s, est. speed input: 98424.52 toks/s, output: 96.12 toks/s] 
Processed prompts:  29%|██▉       | 594/2048 [00:06<00:24, 58.88it/s, est. speed input: 96705.78 toks/s, output: 94.44 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [00:06<00:24, 58.59it/s, est. speed input: 95130.12 toks/s, output: 92.90 toks/s]
Processed prompts:  31%|███       | 626/2048 [00:06<00:24, 57.11it/s, est. speed input: 93397.68 toks/s, output: 91.21 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [00:07<00:25, 55.77it/s, est. speed input: 91734.17 toks/s, output: 89.58 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [00:07<00:25, 54.91it/s, est. speed input: 90216.92 toks/s, output: 88.10 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [00:07<00:25, 54.35it/s, est. speed input: 88825.33 toks/s, output: 86.74 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [00:08<00:25, 53.79it/s, est. speed input: 87502.42 toks/s, output: 85.45 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [00:08<00:25, 53.24it/s, est. speed input: 86245.74 toks/s, output: 84.22 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [00:08<00:25, 52.90it/s, est. speed input: 85084.25 toks/s, output: 83.09 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [00:08<00:24, 52.67it/s, est. speed input: 84002.13 toks/s, output: 82.03 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [00:09<00:24, 52.49it/s, est. speed input: 82990.21 toks/s, output: 81.04 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [00:09<00:24, 52.38it/s, est. speed input: 82043.51 toks/s, output: 80.12 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [00:09<00:24, 52.28it/s, est. speed input: 81152.17 toks/s, output: 79.25 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [00:10<00:23, 52.22it/s, est. speed input: 80316.08 toks/s, output: 78.43 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [00:10<00:23, 52.17it/s, est. speed input: 79528.22 toks/s, output: 77.66 toks/s]
Processed prompts:  41%|████      | 834/2048 [00:10<00:23, 52.15it/s, est. speed input: 78786.33 toks/s, output: 76.94 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [00:11<00:22, 52.14it/s, est. speed input: 78086.14 toks/s, output: 76.26 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [00:11<00:22, 52.13it/s, est. speed input: 77423.42 toks/s, output: 75.61 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [00:11<00:22, 52.10it/s, est. speed input: 76792.33 toks/s, output: 74.99 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [00:12<00:22, 52.08it/s, est. speed input: 76193.51 toks/s, output: 74.41 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [00:12<00:21, 52.09it/s, est. speed input: 75627.07 toks/s, output: 73.85 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [00:12<00:21, 52.08it/s, est. speed input: 75086.44 toks/s, output: 73.33 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [00:12<00:21, 52.09it/s, est. speed input: 74572.85 toks/s, output: 72.82 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [00:13<00:20, 52.09it/s, est. speed input: 74082.04 toks/s, output: 72.35 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [00:13<00:20, 52.94it/s, est. speed input: 73703.05 toks/s, output: 71.98 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [00:13<00:20, 52.67it/s, est. speed input: 73251.79 toks/s, output: 71.53 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [00:14<00:19, 52.48it/s, est. speed input: 72819.77 toks/s, output: 71.11 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [00:14<00:19, 52.37it/s, est. speed input: 72407.81 toks/s, output: 70.71 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [00:14<00:19, 52.27it/s, est. speed input: 72011.18 toks/s, output: 70.32 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [00:15<00:18, 52.25it/s, est. speed input: 71635.26 toks/s, output: 69.96 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [00:15<00:18, 52.14it/s, est. speed input: 71265.20 toks/s, output: 69.59 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [00:15<00:18, 52.10it/s, est. speed input: 70913.53 toks/s, output: 69.25 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [00:16<00:18, 52.27it/s, est. speed input: 70591.74 toks/s, output: 68.94 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [00:16<00:17, 52.67it/s, est. speed input: 70305.27 toks/s, output: 68.66 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [00:16<00:17, 52.92it/s, est. speed input: 70027.02 toks/s, output: 68.39 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [00:16<00:16, 54.04it/s, est. speed input: 69830.47 toks/s, output: 68.19 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [00:17<00:16, 53.91it/s, est. speed input: 69571.89 toks/s, output: 67.94 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [00:17<00:16, 53.81it/s, est. speed input: 69321.12 toks/s, output: 67.70 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [00:17<00:15, 53.75it/s, est. speed input: 69079.48 toks/s, output: 67.46 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [00:18<00:15, 53.70it/s, est. speed input: 68845.06 toks/s, output: 67.23 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [00:18<00:15, 53.65it/s, est. speed input: 68617.38 toks/s, output: 67.01 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [00:18<00:14, 53.61it/s, est. speed input: 68397.08 toks/s, output: 66.79 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [00:19<00:14, 53.58it/s, est. speed input: 68182.68 toks/s, output: 66.58 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [00:19<00:14, 53.55it/s, est. speed input: 67975.09 toks/s, output: 66.38 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [00:19<00:14, 53.55it/s, est. speed input: 67775.14 toks/s, output: 66.19 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [00:19<00:13, 53.54it/s, est. speed input: 67580.41 toks/s, output: 66.00 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [00:20<00:13, 53.54it/s, est. speed input: 67391.49 toks/s, output: 65.81 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [00:20<00:13, 53.53it/s, est. speed input: 67207.87 toks/s, output: 65.63 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [00:20<00:12, 53.51it/s, est. speed input: 67028.47 toks/s, output: 65.46 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [00:21<00:12, 53.51it/s, est. speed input: 66855.32 toks/s, output: 65.29 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [00:21<00:12, 53.50it/s, est. speed input: 66686.43 toks/s, output: 65.12 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [00:21<00:11, 53.50it/s, est. speed input: 66522.37 toks/s, output: 64.96 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [00:22<00:11, 53.50it/s, est. speed input: 66362.71 toks/s, output: 64.81 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [00:22<00:11, 53.49it/s, est. speed input: 66206.94 toks/s, output: 64.66 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [00:22<00:11, 53.48it/s, est. speed input: 66055.16 toks/s, output: 64.51 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [00:22<00:10, 53.47it/s, est. speed input: 65906.85 toks/s, output: 64.36 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [00:23<00:10, 53.46it/s, est. speed input: 65762.39 toks/s, output: 64.22 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [00:23<00:10, 53.45it/s, est. speed input: 65621.75 toks/s, output: 64.08 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [00:23<00:09, 53.46it/s, est. speed input: 65485.07 toks/s, output: 63.95 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [00:24<00:09, 53.37it/s, est. speed input: 65347.02 toks/s, output: 63.82 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [00:24<00:09, 53.23it/s, est. speed input: 65208.49 toks/s, output: 63.68 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [00:24<00:08, 53.13it/s, est. speed input: 65073.52 toks/s, output: 63.55 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [00:25<00:08, 53.07it/s, est. speed input: 64941.96 toks/s, output: 63.42 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [00:25<00:08, 53.01it/s, est. speed input: 64812.96 toks/s, output: 63.29 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [00:25<00:08, 52.97it/s, est. speed input: 64686.86 toks/s, output: 63.17 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [00:25<00:07, 52.94it/s, est. speed input: 64563.71 toks/s, output: 63.05 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [00:26<00:07, 52.95it/s, est. speed input: 64444.71 toks/s, output: 62.93 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [00:26<00:07, 52.92it/s, est. speed input: 64326.84 toks/s, output: 62.82 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [00:27<00:11, 31.38it/s, est. speed input: 62598.46 toks/s, output: 61.13 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [00:27<00:09, 35.74it/s, est. speed input: 62506.22 toks/s, output: 61.04 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [00:28<00:08, 39.58it/s, est. speed input: 62415.59 toks/s, output: 60.95 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [00:28<00:07, 42.80it/s, est. speed input: 62327.12 toks/s, output: 60.87 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [00:28<00:06, 45.38it/s, est. speed input: 62240.08 toks/s, output: 60.78 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [00:29<00:06, 47.39it/s, est. speed input: 62155.23 toks/s, output: 60.70 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [00:29<00:05, 48.93it/s, est. speed input: 62073.72 toks/s, output: 60.62 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [00:29<00:05, 50.00it/s, est. speed input: 61990.47 toks/s, output: 60.54 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [00:29<00:04, 50.81it/s, est. speed input: 61910.08 toks/s, output: 60.46 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [00:30<00:04, 51.39it/s, est. speed input: 61831.76 toks/s, output: 60.38 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [00:30<00:03, 51.80it/s, est. speed input: 61754.32 toks/s, output: 60.31 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [00:30<00:03, 52.10it/s, est. speed input: 61679.06 toks/s, output: 60.23 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [00:31<00:03, 53.20it/s, est. speed input: 61638.87 toks/s, output: 60.19 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [00:31<00:02, 53.08it/s, est. speed input: 61565.68 toks/s, output: 60.12 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [00:31<00:02, 52.99it/s, est. speed input: 61493.87 toks/s, output: 60.05 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [00:32<00:02, 52.94it/s, est. speed input: 61423.80 toks/s, output: 59.98 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [00:32<00:02, 52.89it/s, est. speed input: 61354.83 toks/s, output: 59.92 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [00:32<00:01, 52.89it/s, est. speed input: 61287.97 toks/s, output: 59.85 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [00:32<00:01, 53.19it/s, est. speed input: 61233.18 toks/s, output: 59.80 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [00:33<00:01, 53.40it/s, est. speed input: 61179.19 toks/s, output: 59.75 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [00:33<00:00, 53.55it/s, est. speed input: 61126.13 toks/s, output: 59.69 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [00:33<00:00, 53.65it/s, est. speed input: 61074.00 toks/s, output: 59.64 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [00:34<00:00, 54.79it/s, est. speed input: 61057.34 toks/s, output: 59.63 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:34<00:00, 54.79it/s, est. speed input: 61476.93 toks/s, output: 60.04 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:34<00:00, 60.04it/s, est. speed input: 61476.93 toks/s, output: 60.04 toks/s]
[rank0]:[W128 07:13:50.926074175 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=32768 ==========
Time: 2026-01-28 07:14:13
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=4096, max_num_seqs=32
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 4096 --max-num-seqs 32 --max-model-len 1025 --max-num-batched-tokens 32768 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/BitNet-2B-INT8_M32768.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-28 07:15:13 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 07:15:14 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=821307) WARNING 01-28 07:16:53 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=821307) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=821307) WARNING 01-28 07:19:43 [backends.py:609] Failed to read file <frozen os>
Throughput: 51.82 requests/s, 53111.57 total tokens/s, 51.82 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096

STDERR:
[2026-01-28 07:15:09] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 07:15:13] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 07:15:13] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 07:15:13] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 07:15:13] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 07:15:13] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 07:15:13] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 07:15:13] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 07:15:13] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 07:15:13] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 07:15:13] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 07:15:13] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 07:15:13] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 07:15:13] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 07:16:09] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 07:16:24] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 07:16:24] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 07:16:24] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 07:16:24] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 07:16:24] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 07:16:24] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 07:16:24] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 07:16:24] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 07:16:24] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 07:16:24] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 07:16:24] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 07:16:24] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 07:16:24] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=821307) [2026-01-28 07:17:20] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=821307) [2026-01-28 07:17:20] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=821307) [2026-01-28 07:17:20] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=821307) [2026-01-28 07:17:20] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=821307) [2026-01-28 07:17:20] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=821307) [2026-01-28 07:17:20] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=821307) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=821307) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.26it/s]
(EngineCore_DP0 pid=821307) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.26it/s]
(EngineCore_DP0 pid=821307) 
(EngineCore_DP0 pid=821307) [2026-01-28 07:18:01] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 3424] -> 1D uint8
(EngineCore_DP0 pid=821307) [2026-01-28 07:18:02] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9891840 bytes
(EngineCore_DP0 pid=821307) [2026-01-28 07:18:02] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 3424] -> 1D uint8
(EngineCore_DP0 pid=821307) [2026-01-28 07:18:02] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 6594560 bytes
(EngineCore_DP0 pid=821307) [2026-01-28 07:18:05] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 3424] -> 1D uint8
(EngineCore_DP0 pid=821307) [2026-01-28 07:18:05] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 35610624 bytes
(EngineCore_DP0 pid=821307) [2026-01-28 07:18:05] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 9216] -> 1D uint8
(EngineCore_DP0 pid=821307) [2026-01-28 07:18:05] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 17694720 bytes
(EngineCore_DP0 pid=821307) [rank0]:W0128 07:19:52.358000 821307 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=821307) [rank0]:W0128 07:19:52.458000 821307 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=821307) [rank0]:W0128 07:19:54.458000 821307 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=821307) [rank0]:W0128 07:19:54.622000 821307 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=821307) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   9%|▉         | 1/11 [00:04<00:40,  4.09s/it]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  18%|█▊        | 2/11 [00:05<00:20,  2.25s/it]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  27%|██▋       | 3/11 [00:05<00:12,  1.53s/it]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  36%|███▋      | 4/11 [00:09<00:16,  2.30s/it]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  45%|████▌     | 5/11 [00:16<00:24,  4.15s/it]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  55%|█████▍    | 6/11 [00:17<00:15,  3.07s/it]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  64%|██████▎   | 7/11 [00:19<00:11,  2.84s/it]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  73%|███████▎  | 8/11 [00:22<00:08,  2.89s/it]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  82%|████████▏ | 9/11 [00:27<00:07,  3.50s/it]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  91%|█████████ | 10/11 [00:30<00:03,  3.32s/it]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:33<00:00,  3.09s/it]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:33<00:00,  3.03s/it]
(EngineCore_DP0 pid=821307) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  14%|█▍        | 1/7 [00:04<00:24,  4.10s/it]
Capturing CUDA graphs (decode, FULL):  29%|██▊       | 2/7 [00:07<00:17,  3.59s/it]
Capturing CUDA graphs (decode, FULL):  43%|████▎     | 3/7 [00:14<00:21,  5.37s/it]
Capturing CUDA graphs (decode, FULL):  57%|█████▋    | 4/7 [00:19<00:15,  5.04s/it]
Capturing CUDA graphs (decode, FULL):  71%|███████▏  | 5/7 [00:22<00:08,  4.40s/it]
Capturing CUDA graphs (decode, FULL):  86%|████████▌ | 6/7 [00:23<00:03,  3.31s/it]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:25<00:00,  2.89s/it]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:25<00:00,  3.69s/it]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   1%|          | 32/4096 [00:00<00:12, 314.51it/s]
Adding requests:   2%|▏         | 68/4096 [00:00<00:11, 339.95it/s]
Adding requests:   3%|▎         | 106/4096 [00:00<00:11, 355.15it/s]
Adding requests:   4%|▎         | 145/4096 [00:00<00:10, 366.51it/s]
Adding requests:   4%|▍         | 184/4096 [00:00<00:10, 372.80it/s]
Adding requests:   5%|▌         | 224/4096 [00:00<00:10, 380.21it/s]
Adding requests:   6%|▋         | 263/4096 [00:00<00:10, 377.35it/s]
Adding requests:   7%|▋         | 301/4096 [00:00<00:10, 368.96it/s]
Adding requests:   8%|▊         | 339/4096 [00:00<00:10, 369.87it/s]
Adding requests:   9%|▉         | 377/4096 [00:01<00:10, 371.36it/s]
Adding requests:  10%|█         | 415/4096 [00:01<00:09, 368.89it/s]
Adding requests:  11%|█         | 452/4096 [00:01<00:09, 369.08it/s]
Adding requests:  12%|█▏        | 490/4096 [00:01<00:09, 371.66it/s]
Adding requests:  13%|█▎        | 528/4096 [00:01<00:09, 362.65it/s]
Adding requests:  14%|█▍        | 568/4096 [00:01<00:09, 372.85it/s]
Adding requests:  15%|█▍        | 606/4096 [00:01<00:09, 374.49it/s]
Adding requests:  16%|█▌        | 646/4096 [00:01<00:09, 379.01it/s]
Adding requests:  17%|█▋        | 686/4096 [00:01<00:08, 384.01it/s]
Adding requests:  18%|█▊        | 725/4096 [00:01<00:08, 381.17it/s]
Adding requests:  19%|█▊        | 764/4096 [00:02<00:08, 379.75it/s]
Adding requests:  20%|█▉        | 802/4096 [00:02<00:08, 378.82it/s]
Adding requests:  21%|██        | 840/4096 [00:02<00:08, 369.56it/s]
Adding requests:  21%|██▏       | 879/4096 [00:02<00:08, 374.60it/s]
Adding requests:  22%|██▏       | 919/4096 [00:02<00:08, 381.16it/s]
Adding requests:  23%|██▎       | 958/4096 [00:02<00:08, 382.58it/s]
Adding requests:  24%|██▍       | 997/4096 [00:02<00:08, 383.48it/s]
Adding requests:  25%|██▌       | 1037/4096 [00:02<00:07, 386.85it/s]
Adding requests:  26%|██▋       | 1076/4096 [00:02<00:07, 385.41it/s]
Adding requests:  27%|██▋       | 1115/4096 [00:02<00:07, 383.67it/s]
Adding requests:  28%|██▊       | 1154/4096 [00:03<00:07, 381.49it/s]
Adding requests:  29%|██▉       | 1196/4096 [00:03<00:07, 390.89it/s]
Adding requests:  30%|███       | 1236/4096 [00:03<00:07, 378.19it/s]
Adding requests:  31%|███       | 1274/4096 [00:03<00:07, 377.11it/s]
Adding requests:  32%|███▏      | 1313/4096 [00:03<00:07, 380.16it/s]
Adding requests:  33%|███▎      | 1353/4096 [00:03<00:07, 383.02it/s]
Adding requests:  34%|███▍      | 1392/4096 [00:03<00:07, 383.94it/s]
Adding requests:  35%|███▍      | 1431/4096 [00:03<00:06, 384.69it/s]
Adding requests:  36%|███▌      | 1471/4096 [00:03<00:06, 387.31it/s]
Adding requests:  37%|███▋      | 1510/4096 [00:04<00:06, 386.17it/s]
Adding requests:  38%|███▊      | 1549/4096 [00:04<00:06, 386.19it/s]
Adding requests:  39%|███▉      | 1590/4096 [00:04<00:06, 392.80it/s]
Adding requests:  40%|███▉      | 1630/4096 [00:04<00:06, 392.52it/s]
Adding requests:  41%|████      | 1670/4096 [00:04<00:06, 383.91it/s]
Adding requests:  42%|████▏     | 1709/4096 [00:04<00:06, 383.06it/s]
Adding requests:  43%|████▎     | 1748/4096 [00:04<00:06, 380.84it/s]
Adding requests:  44%|████▎     | 1787/4096 [00:04<00:06, 382.07it/s]
Adding requests:  45%|████▍     | 1826/4096 [00:04<00:05, 384.39it/s]
Adding requests:  46%|████▌     | 1865/4096 [00:04<00:05, 381.66it/s]
Adding requests:  47%|████▋     | 1905/4096 [00:05<00:05, 384.48it/s]
Adding requests:  47%|████▋     | 1944/4096 [00:05<00:05, 383.45it/s]
Adding requests:  48%|████▊     | 1983/4096 [00:05<00:05, 383.99it/s]
Adding requests:  49%|████▉     | 2023/4096 [00:05<00:05, 386.57it/s]
Adding requests:  50%|█████     | 2063/4096 [00:05<00:05, 390.34it/s]
Adding requests:  51%|█████▏    | 2103/4096 [00:05<00:05, 391.79it/s]
Adding requests:  52%|█████▏    | 2143/4096 [00:05<00:05, 386.31it/s]
Adding requests:  53%|█████▎    | 2182/4096 [00:05<00:05, 381.04it/s]
Adding requests:  54%|█████▍    | 2222/4096 [00:05<00:04, 386.38it/s]
Adding requests:  55%|█████▌    | 2261/4096 [00:05<00:04, 385.15it/s]
Adding requests:  56%|█████▌    | 2300/4096 [00:06<00:04, 384.78it/s]
Adding requests:  57%|█████▋    | 2339/4096 [00:06<00:04, 377.50it/s]
Adding requests:  58%|█████▊    | 2378/4096 [00:06<00:04, 379.25it/s]
Adding requests:  59%|█████▉    | 2417/4096 [00:06<00:04, 381.82it/s]
Adding requests:  60%|█████▉    | 2456/4096 [00:06<00:04, 369.51it/s]
Adding requests:  61%|██████    | 2495/4096 [00:06<00:04, 373.29it/s]
Adding requests:  62%|██████▏   | 2534/4096 [00:06<00:04, 377.73it/s]
Adding requests:  63%|██████▎   | 2573/4096 [00:06<00:04, 380.17it/s]
Adding requests:  64%|██████▍   | 2612/4096 [00:06<00:03, 381.68it/s]
Adding requests:  65%|██████▍   | 2652/4096 [00:06<00:03, 385.09it/s]
Adding requests:  66%|██████▌   | 2691/4096 [00:07<00:03, 381.98it/s]
Adding requests:  67%|██████▋   | 2730/4096 [00:07<00:03, 379.22it/s]
Adding requests:  68%|██████▊   | 2769/4096 [00:07<00:03, 380.75it/s]
Adding requests:  69%|██████▊   | 2808/4096 [00:07<00:03, 376.50it/s]
Adding requests:  70%|██████▉   | 2848/4096 [00:07<00:03, 381.57it/s]
Adding requests:  71%|███████   | 2889/4096 [00:07<00:03, 387.79it/s]
Adding requests:  71%|███████▏  | 2928/4096 [00:07<00:03, 380.48it/s]
Adding requests:  72%|███████▏  | 2967/4096 [00:07<00:02, 381.62it/s]
Adding requests:  73%|███████▎  | 3006/4096 [00:07<00:02, 381.52it/s]
Adding requests:  74%|███████▍  | 3045/4096 [00:08<00:02, 381.76it/s]
Adding requests:  75%|███████▌  | 3084/4096 [00:08<00:02, 377.67it/s]
Adding requests:  76%|███████▌  | 3123/4096 [00:08<00:02, 380.20it/s]
Adding requests:  77%|███████▋  | 3162/4096 [00:08<00:02, 374.33it/s]
Adding requests:  78%|███████▊  | 3201/4096 [00:08<00:02, 376.71it/s]
Adding requests:  79%|███████▉  | 3241/4096 [00:08<00:02, 383.39it/s]
Adding requests:  80%|████████  | 3280/4096 [00:08<00:02, 383.71it/s]
Adding requests:  81%|████████  | 3319/4096 [00:08<00:02, 383.03it/s]
Adding requests:  82%|████████▏ | 3358/4096 [00:08<00:01, 383.90it/s]
Adding requests:  83%|████████▎ | 3397/4096 [00:08<00:01, 378.98it/s]
Adding requests:  84%|████████▍ | 3438/4096 [00:09<00:01, 383.91it/s]
Adding requests:  85%|████████▍ | 3477/4096 [00:09<00:01, 378.68it/s]
Adding requests:  86%|████████▌ | 3516/4096 [00:09<00:01, 379.07it/s]
Adding requests:  87%|████████▋ | 3554/4096 [00:09<00:01, 379.07it/s]
Adding requests:  88%|████████▊ | 3592/4096 [00:09<00:01, 374.70it/s]
Adding requests:  89%|████████▊ | 3630/4096 [00:09<00:01, 374.44it/s]
Adding requests:  90%|████████▉ | 3669/4096 [00:09<00:01, 377.23it/s]
Adding requests:  91%|█████████ | 3708/4096 [00:09<00:01, 380.44it/s]
Adding requests:  91%|█████████▏| 3747/4096 [00:09<00:00, 379.92it/s]
Adding requests:  92%|█████████▏| 3787/4096 [00:09<00:00, 384.78it/s]
Adding requests:  93%|█████████▎| 3826/4096 [00:10<00:00, 371.10it/s]
Adding requests:  94%|█████████▍| 3866/4096 [00:10<00:00, 378.88it/s]
Adding requests:  95%|█████████▌| 3904/4096 [00:10<00:00, 378.99it/s]
Adding requests:  96%|█████████▋| 3943/4096 [00:10<00:00, 380.81it/s]
Adding requests:  97%|█████████▋| 3982/4096 [00:10<00:00, 379.96it/s]
Adding requests:  98%|█████████▊| 4021/4096 [00:10<00:00, 382.76it/s]
Adding requests:  99%|█████████▉| 4060/4096 [00:10<00:00, 374.75it/s]
Adding requests: 100%|██████████| 4096/4096 [00:10<00:00, 379.71it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   3%|▎         | 130/4096 [00:00<00:06, 630.18it/s, est. speed input: 645393.90 toks/s, output: 630.21 toks/s]
Processed prompts:   5%|▍         | 194/4096 [00:01<00:31, 124.73it/s, est. speed input: 152283.29 toks/s, output: 148.71 toks/s]
Processed prompts:   6%|▌         | 226/4096 [00:01<00:39, 99.01it/s, est. speed input: 124841.03 toks/s, output: 121.91 toks/s] 
Processed prompts:   6%|▋         | 258/4096 [00:02<00:45, 84.52it/s, est. speed input: 109956.48 toks/s, output: 107.38 toks/s]
Processed prompts:   7%|▋         | 290/4096 [00:02<00:50, 75.64it/s, est. speed input: 100578.83 toks/s, output: 98.22 toks/s] 
Processed prompts:   8%|▊         | 322/4096 [00:03<00:53, 70.00it/s, est. speed input: 94165.71 toks/s, output: 91.96 toks/s] 
Processed prompts:   9%|▊         | 354/4096 [00:04<00:56, 66.23it/s, est. speed input: 89460.57 toks/s, output: 87.36 toks/s]
Processed prompts:   9%|▉         | 386/4096 [00:04<00:58, 63.72it/s, est. speed input: 85891.27 toks/s, output: 83.88 toks/s]
Processed prompts:  10%|█         | 418/4096 [00:05<00:59, 61.99it/s, est. speed input: 83068.77 toks/s, output: 81.12 toks/s]
Processed prompts:  11%|█         | 450/4096 [00:05<00:59, 60.82it/s, est. speed input: 80799.82 toks/s, output: 78.91 toks/s]
Processed prompts:  12%|█▏        | 482/4096 [00:06<01:00, 60.01it/s, est. speed input: 78932.67 toks/s, output: 77.08 toks/s]
Processed prompts:  13%|█▎        | 514/4096 [00:06<01:00, 59.45it/s, est. speed input: 77365.76 toks/s, output: 75.55 toks/s]
Processed prompts:  13%|█▎        | 546/4096 [00:07<01:00, 59.05it/s, est. speed input: 76029.80 toks/s, output: 74.25 toks/s]
Processed prompts:  14%|█▍        | 578/4096 [00:07<00:59, 58.76it/s, est. speed input: 74875.93 toks/s, output: 73.12 toks/s]
Processed prompts:  15%|█▍        | 610/4096 [00:08<00:59, 58.56it/s, est. speed input: 73873.48 toks/s, output: 72.14 toks/s]
Processed prompts:  16%|█▌        | 642/4096 [00:09<00:59, 58.41it/s, est. speed input: 72992.10 toks/s, output: 71.28 toks/s]
Processed prompts:  16%|█▋        | 674/4096 [00:09<00:58, 58.31it/s, est. speed input: 72213.38 toks/s, output: 70.52 toks/s]
Processed prompts:  17%|█▋        | 706/4096 [00:10<00:58, 58.25it/s, est. speed input: 71519.70 toks/s, output: 69.84 toks/s]
Processed prompts:  18%|█▊        | 738/4096 [00:10<00:57, 58.20it/s, est. speed input: 70896.63 toks/s, output: 69.23 toks/s]
Processed prompts:  19%|█▉        | 770/4096 [00:11<00:57, 58.16it/s, est. speed input: 70334.87 toks/s, output: 68.69 toks/s]
Processed prompts:  20%|█▉        | 802/4096 [00:11<00:56, 58.13it/s, est. speed input: 69825.37 toks/s, output: 68.19 toks/s]
Processed prompts:  20%|██        | 834/4096 [00:12<00:56, 58.10it/s, est. speed input: 69360.11 toks/s, output: 67.73 toks/s]
Processed prompts:  21%|██        | 866/4096 [00:12<00:55, 58.09it/s, est. speed input: 68936.26 toks/s, output: 67.32 toks/s]
Processed prompts:  22%|██▏       | 898/4096 [00:13<00:55, 58.09it/s, est. speed input: 68547.86 toks/s, output: 66.94 toks/s]
Processed prompts:  23%|██▎       | 930/4096 [00:13<00:54, 58.08it/s, est. speed input: 68188.28 toks/s, output: 66.59 toks/s]
Processed prompts:  23%|██▎       | 962/4096 [00:15<01:20, 38.94it/s, est. speed input: 63885.20 toks/s, output: 62.39 toks/s]
Processed prompts:  24%|██▍       | 994/4096 [00:15<01:11, 43.20it/s, est. speed input: 63730.46 toks/s, output: 62.24 toks/s]
Processed prompts:  25%|██▌       | 1026/4096 [00:16<01:05, 46.79it/s, est. speed input: 63587.22 toks/s, output: 62.10 toks/s]
Processed prompts:  26%|██▌       | 1058/4096 [00:17<01:01, 49.67it/s, est. speed input: 63451.92 toks/s, output: 61.96 toks/s]
Processed prompts:  27%|██▋       | 1090/4096 [00:17<00:57, 51.91it/s, est. speed input: 63325.10 toks/s, output: 61.84 toks/s]
Processed prompts:  27%|██▋       | 1122/4096 [00:18<00:55, 53.59it/s, est. speed input: 63204.80 toks/s, output: 61.72 toks/s]
Processed prompts:  28%|██▊       | 1154/4096 [00:18<00:53, 55.29it/s, est. speed input: 63145.95 toks/s, output: 61.67 toks/s]
Processed prompts:  29%|██▉       | 1186/4096 [00:19<00:51, 56.07it/s, est. speed input: 63036.98 toks/s, output: 61.56 toks/s]
Processed prompts:  30%|██▉       | 1218/4096 [00:19<00:50, 56.63it/s, est. speed input: 62934.92 toks/s, output: 61.46 toks/s]
Processed prompts:  31%|███       | 1250/4096 [00:20<00:49, 57.02it/s, est. speed input: 62838.26 toks/s, output: 61.37 toks/s]
Processed prompts:  31%|███▏      | 1282/4096 [00:20<00:49, 57.31it/s, est. speed input: 62746.69 toks/s, output: 61.28 toks/s]
Processed prompts:  32%|███▏      | 1314/4096 [00:21<00:48, 57.49it/s, est. speed input: 62658.32 toks/s, output: 61.19 toks/s]
Processed prompts:  33%|███▎      | 1346/4096 [00:22<00:47, 57.62it/s, est. speed input: 62574.60 toks/s, output: 61.11 toks/s]
Processed prompts:  34%|███▎      | 1378/4096 [00:22<00:47, 57.77it/s, est. speed input: 62499.92 toks/s, output: 61.04 toks/s]
Processed prompts:  34%|███▍      | 1410/4096 [00:23<00:46, 57.76it/s, est. speed input: 62418.63 toks/s, output: 60.96 toks/s]
Processed prompts:  35%|███▌      | 1442/4096 [00:23<00:45, 57.80it/s, est. speed input: 62345.92 toks/s, output: 60.88 toks/s]
Processed prompts:  36%|███▌      | 1474/4096 [00:24<00:45, 57.82it/s, est. speed input: 62275.43 toks/s, output: 60.82 toks/s]
Processed prompts:  37%|███▋      | 1506/4096 [00:24<00:44, 57.84it/s, est. speed input: 62208.76 toks/s, output: 60.75 toks/s]
Processed prompts:  38%|███▊      | 1538/4096 [00:25<00:44, 57.84it/s, est. speed input: 62143.45 toks/s, output: 60.69 toks/s]
Processed prompts:  38%|███▊      | 1570/4096 [00:25<00:43, 57.85it/s, est. speed input: 62081.76 toks/s, output: 60.63 toks/s]
Processed prompts:  39%|███▉      | 1602/4096 [00:26<00:43, 57.85it/s, est. speed input: 62022.11 toks/s, output: 60.57 toks/s]
Processed prompts:  40%|███▉      | 1634/4096 [00:27<00:42, 57.84it/s, est. speed input: 61964.79 toks/s, output: 60.51 toks/s]
Processed prompts:  41%|████      | 1666/4096 [00:27<00:42, 57.84it/s, est. speed input: 61909.95 toks/s, output: 60.46 toks/s]
Processed prompts:  41%|████▏     | 1698/4096 [00:28<00:41, 57.82it/s, est. speed input: 61855.63 toks/s, output: 60.41 toks/s]
Processed prompts:  42%|████▏     | 1730/4096 [00:28<00:40, 57.80it/s, est. speed input: 61802.99 toks/s, output: 60.35 toks/s]
Processed prompts:  43%|████▎     | 1762/4096 [00:29<00:40, 57.78it/s, est. speed input: 61751.88 toks/s, output: 60.30 toks/s]
Processed prompts:  44%|████▍     | 1794/4096 [00:29<00:39, 57.76it/s, est. speed input: 61702.86 toks/s, output: 60.26 toks/s]
Processed prompts:  45%|████▍     | 1826/4096 [00:30<00:39, 57.75it/s, est. speed input: 61655.45 toks/s, output: 60.21 toks/s]
Processed prompts:  45%|████▌     | 1858/4096 [00:30<00:38, 58.25it/s, est. speed input: 61641.49 toks/s, output: 60.20 toks/s]
Processed prompts:  46%|████▌     | 1890/4096 [00:31<00:37, 58.08it/s, est. speed input: 61596.35 toks/s, output: 60.15 toks/s]
Processed prompts:  47%|████▋     | 1922/4096 [00:31<00:37, 57.95it/s, est. speed input: 61552.10 toks/s, output: 60.11 toks/s]
Processed prompts:  48%|████▊     | 1954/4096 [00:32<00:37, 57.87it/s, est. speed input: 61509.32 toks/s, output: 60.07 toks/s]
Processed prompts:  48%|████▊     | 1986/4096 [00:33<00:36, 57.79it/s, est. speed input: 61467.24 toks/s, output: 60.03 toks/s]
Processed prompts:  49%|████▉     | 2018/4096 [00:33<00:35, 57.74it/s, est. speed input: 61426.29 toks/s, output: 59.99 toks/s]
Processed prompts:  50%|█████     | 2050/4096 [00:34<00:35, 57.70it/s, est. speed input: 61387.07 toks/s, output: 59.95 toks/s]
Processed prompts:  51%|█████     | 2082/4096 [00:34<00:34, 57.67it/s, est. speed input: 61348.55 toks/s, output: 59.91 toks/s]
Processed prompts:  52%|█████▏    | 2114/4096 [00:35<00:34, 57.64it/s, est. speed input: 61310.92 toks/s, output: 59.87 toks/s]
Processed prompts:  52%|█████▏    | 2146/4096 [00:35<00:33, 57.64it/s, est. speed input: 61275.21 toks/s, output: 59.84 toks/s]
Processed prompts:  53%|█████▎    | 2178/4096 [00:36<00:33, 57.62it/s, est. speed input: 61239.66 toks/s, output: 59.80 toks/s]
Processed prompts:  54%|█████▍    | 2210/4096 [00:36<00:32, 57.60it/s, est. speed input: 61204.96 toks/s, output: 59.77 toks/s]
Processed prompts:  55%|█████▍    | 2242/4096 [00:37<00:32, 57.57it/s, est. speed input: 61170.86 toks/s, output: 59.74 toks/s]
Processed prompts:  56%|█████▌    | 2274/4096 [00:38<00:31, 58.07it/s, est. speed input: 61163.94 toks/s, output: 59.73 toks/s]
Processed prompts:  56%|█████▋    | 2306/4096 [00:38<00:30, 57.91it/s, est. speed input: 61131.74 toks/s, output: 59.70 toks/s]
Processed prompts:  57%|█████▋    | 2338/4096 [00:39<00:30, 57.80it/s, est. speed input: 61100.13 toks/s, output: 59.67 toks/s]
Processed prompts:  58%|█████▊    | 2370/4096 [00:39<00:29, 57.73it/s, est. speed input: 61070.11 toks/s, output: 59.64 toks/s]
Processed prompts:  59%|█████▊    | 2402/4096 [00:40<00:29, 57.74it/s, est. speed input: 61043.70 toks/s, output: 59.61 toks/s]
Processed prompts:  59%|█████▉    | 2434/4096 [00:40<00:28, 57.61it/s, est. speed input: 61011.28 toks/s, output: 59.58 toks/s]
Processed prompts:  60%|██████    | 2466/4096 [00:41<00:28, 57.58it/s, est. speed input: 60983.05 toks/s, output: 59.55 toks/s]
Processed prompts:  61%|██████    | 2498/4096 [00:41<00:27, 58.07it/s, est. speed input: 60978.74 toks/s, output: 59.55 toks/s]
Processed prompts:  62%|██████▏   | 2530/4096 [00:42<00:27, 57.93it/s, est. speed input: 60952.71 toks/s, output: 59.52 toks/s]
Processed prompts:  63%|██████▎   | 2562/4096 [00:43<00:26, 57.76it/s, est. speed input: 60924.34 toks/s, output: 59.50 toks/s]
Processed prompts:  63%|██████▎   | 2594/4096 [00:43<00:26, 57.68it/s, est. speed input: 60897.98 toks/s, output: 59.47 toks/s]
Processed prompts:  64%|██████▍   | 2626/4096 [00:44<00:25, 57.62it/s, est. speed input: 60872.32 toks/s, output: 59.45 toks/s]
Processed prompts:  65%|██████▍   | 2658/4096 [00:44<00:24, 57.56it/s, est. speed input: 60846.57 toks/s, output: 59.42 toks/s]
Processed prompts:  66%|██████▌   | 2690/4096 [00:45<00:24, 57.46it/s, est. speed input: 60818.95 toks/s, output: 59.39 toks/s]
Processed prompts:  66%|██████▋   | 2722/4096 [00:45<00:23, 57.47it/s, est. speed input: 60795.34 toks/s, output: 59.37 toks/s]
Processed prompts:  67%|██████▋   | 2754/4096 [00:46<00:23, 57.49it/s, est. speed input: 60772.72 toks/s, output: 59.35 toks/s]
Processed prompts:  68%|██████▊   | 2786/4096 [00:46<00:22, 57.50it/s, est. speed input: 60750.80 toks/s, output: 59.33 toks/s]
Processed prompts:  69%|██████▉   | 2818/4096 [00:47<00:22, 57.51it/s, est. speed input: 60729.12 toks/s, output: 59.31 toks/s]
Processed prompts:  70%|██████▉   | 2850/4096 [00:48<00:31, 39.84it/s, est. speed input: 59686.29 toks/s, output: 58.29 toks/s]
Processed prompts:  70%|███████   | 2882/4096 [00:49<00:27, 43.89it/s, est. speed input: 59677.48 toks/s, output: 58.28 toks/s]
Processed prompts:  71%|███████   | 2914/4096 [00:50<00:25, 47.24it/s, est. speed input: 59668.55 toks/s, output: 58.27 toks/s]
Processed prompts:  72%|███████▏  | 2946/4096 [00:50<00:23, 49.91it/s, est. speed input: 59659.97 toks/s, output: 58.26 toks/s]
Processed prompts:  73%|███████▎  | 2978/4096 [00:51<00:21, 51.96it/s, est. speed input: 59651.13 toks/s, output: 58.25 toks/s]
Processed prompts:  73%|███████▎  | 3010/4096 [00:51<00:20, 53.50it/s, est. speed input: 59642.64 toks/s, output: 58.24 toks/s]
Processed prompts:  74%|███████▍  | 3042/4096 [00:52<00:19, 54.66it/s, est. speed input: 59635.01 toks/s, output: 58.24 toks/s]
Processed prompts:  75%|███████▌  | 3074/4096 [00:52<00:18, 55.44it/s, est. speed input: 59625.60 toks/s, output: 58.23 toks/s]
Processed prompts:  76%|███████▌  | 3106/4096 [00:53<00:17, 56.04it/s, est. speed input: 59617.54 toks/s, output: 58.22 toks/s]
Processed prompts:  77%|███████▋  | 3138/4096 [00:53<00:16, 56.45it/s, est. speed input: 59609.20 toks/s, output: 58.21 toks/s]
Processed prompts:  77%|███████▋  | 3170/4096 [00:54<00:16, 56.76it/s, est. speed input: 59601.73 toks/s, output: 58.20 toks/s]
Processed prompts:  78%|███████▊  | 3202/4096 [00:55<00:15, 56.97it/s, est. speed input: 59594.18 toks/s, output: 58.20 toks/s]
Processed prompts:  79%|███████▉  | 3234/4096 [00:55<00:15, 57.12it/s, est. speed input: 59586.83 toks/s, output: 58.19 toks/s]
Processed prompts:  80%|███████▉  | 3266/4096 [00:56<00:14, 57.23it/s, est. speed input: 59579.52 toks/s, output: 58.18 toks/s]
Processed prompts:  81%|████████  | 3298/4096 [00:56<00:13, 57.30it/s, est. speed input: 59572.18 toks/s, output: 58.18 toks/s]
Processed prompts:  81%|████████▏ | 3330/4096 [00:57<00:13, 57.35it/s, est. speed input: 59565.21 toks/s, output: 58.17 toks/s]
Processed prompts:  82%|████████▏ | 3362/4096 [00:57<00:12, 57.39it/s, est. speed input: 59558.42 toks/s, output: 58.16 toks/s]
Processed prompts:  83%|████████▎ | 3394/4096 [00:58<00:12, 57.41it/s, est. speed input: 59551.55 toks/s, output: 58.16 toks/s]
Processed prompts:  84%|████████▎ | 3426/4096 [00:58<00:11, 57.43it/s, est. speed input: 59545.12 toks/s, output: 58.15 toks/s]
Processed prompts:  84%|████████▍ | 3458/4096 [00:59<00:11, 57.45it/s, est. speed input: 59538.93 toks/s, output: 58.14 toks/s]
Processed prompts:  85%|████████▌ | 3490/4096 [01:00<00:10, 57.46it/s, est. speed input: 59532.37 toks/s, output: 58.14 toks/s]
Processed prompts:  86%|████████▌ | 3522/4096 [01:00<00:09, 57.46it/s, est. speed input: 59526.07 toks/s, output: 58.13 toks/s]
Processed prompts:  87%|████████▋ | 3554/4096 [01:01<00:09, 57.46it/s, est. speed input: 59519.81 toks/s, output: 58.12 toks/s]
Processed prompts:  88%|████████▊ | 3586/4096 [01:01<00:08, 57.47it/s, est. speed input: 59513.95 toks/s, output: 58.12 toks/s]
Processed prompts:  88%|████████▊ | 3618/4096 [01:02<00:08, 57.46it/s, est. speed input: 59507.79 toks/s, output: 58.11 toks/s]
Processed prompts:  89%|████████▉ | 3650/4096 [01:02<00:07, 57.47it/s, est. speed input: 59502.24 toks/s, output: 58.11 toks/s]
Processed prompts:  90%|████████▉ | 3682/4096 [01:03<00:07, 57.49it/s, est. speed input: 59497.01 toks/s, output: 58.10 toks/s]
Processed prompts:  91%|█████████ | 3714/4096 [01:03<00:06, 57.99it/s, est. speed input: 59506.40 toks/s, output: 58.11 toks/s]
Processed prompts:  91%|█████████▏| 3746/4096 [01:04<00:06, 57.84it/s, est. speed input: 59500.83 toks/s, output: 58.11 toks/s]
Processed prompts:  92%|█████████▏| 3778/4096 [01:05<00:05, 57.73it/s, est. speed input: 59495.41 toks/s, output: 58.10 toks/s]
Processed prompts:  93%|█████████▎| 3810/4096 [01:05<00:04, 57.66it/s, est. speed input: 59490.05 toks/s, output: 58.10 toks/s]
Processed prompts:  94%|█████████▍| 3842/4096 [01:06<00:04, 57.59it/s, est. speed input: 59484.32 toks/s, output: 58.09 toks/s]
Processed prompts:  95%|█████████▍| 3874/4096 [01:06<00:03, 57.55it/s, est. speed input: 59479.01 toks/s, output: 58.08 toks/s]
Processed prompts:  95%|█████████▌| 3906/4096 [01:07<00:03, 57.53it/s, est. speed input: 59474.02 toks/s, output: 58.08 toks/s]
Processed prompts:  96%|█████████▌| 3938/4096 [01:07<00:02, 57.51it/s, est. speed input: 59468.72 toks/s, output: 58.07 toks/s]
Processed prompts:  97%|█████████▋| 3970/4096 [01:08<00:02, 57.50it/s, est. speed input: 59463.77 toks/s, output: 58.07 toks/s]
Processed prompts:  98%|█████████▊| 4002/4096 [01:08<00:01, 57.50it/s, est. speed input: 59458.92 toks/s, output: 58.07 toks/s]
Processed prompts:  98%|█████████▊| 4034/4096 [01:09<00:01, 57.99it/s, est. speed input: 59467.82 toks/s, output: 58.07 toks/s]
Processed prompts:  99%|█████████▉| 4066/4096 [01:09<00:00, 58.51it/s, est. speed input: 59480.87 toks/s, output: 58.09 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [01:09<00:00, 58.51it/s, est. speed input: 59919.27 toks/s, output: 58.51 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [01:09<00:00, 58.51it/s, est. speed input: 59919.27 toks/s, output: 58.51 toks/s]
[rank0]:[W128 07:22:53.713624214 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=512 ==========
Time: 2026-01-28 11:17:50
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_6
Params: prompt_len=512, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_6 --dataset-name random --input-len 512 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 513 --max-num-batched-tokens 513 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/BitNet-2B-INT8_M512.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-28 11:17:56 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 11:17:57 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=13610) WARNING 01-28 11:18:04 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=13610) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=13610) WARNING 01-28 11:18:18 [backends.py:609] Failed to read file <frozen os>
Throughput: 17.37 requests/s, 8910.05 total tokens/s, 17.37 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128

STDERR:
[2026-01-28 11:17:56] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 11:17:56] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 11:17:56] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 11:17:56] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:17:56] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:17:56] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:17:56] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:17:56] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:17:56] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 11:17:56] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 11:17:56] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 11:17:56] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 11:17:56] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 11:17:56] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 11:18:03] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 11:18:03] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 11:18:03] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 11:18:03] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:18:03] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:18:03] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:18:03] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:18:03] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:18:03] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 11:18:03] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 11:18:03] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 11:18:03] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 11:18:03] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 11:18:03] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=13610) [2026-01-28 11:18:05] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=13610) [2026-01-28 11:18:05] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=13610) [2026-01-28 11:18:05] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=13610) [2026-01-28 11:18:05] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=13610) [2026-01-28 11:18:05] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=13610) [2026-01-28 11:18:05] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=13610) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=13610) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:04<00:00,  4.86s/it]
(EngineCore_DP0 pid=13610) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:04<00:00,  4.86s/it]
(EngineCore_DP0 pid=13610) 
(EngineCore_DP0 pid=13610) [2026-01-28 11:18:10] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 3424] -> 1D uint8
(EngineCore_DP0 pid=13610) [2026-01-28 11:18:10] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9891840 bytes
(EngineCore_DP0 pid=13610) [2026-01-28 11:18:10] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 3424] -> 1D uint8
(EngineCore_DP0 pid=13610) [2026-01-28 11:18:10] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 6594560 bytes
(EngineCore_DP0 pid=13610) [2026-01-28 11:18:10] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 3424] -> 1D uint8
(EngineCore_DP0 pid=13610) [2026-01-28 11:18:10] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 35610624 bytes
(EngineCore_DP0 pid=13610) [2026-01-28 11:18:10] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 9216] -> 1D uint8
(EngineCore_DP0 pid=13610) [2026-01-28 11:18:10] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 17694720 bytes
(EngineCore_DP0 pid=13610) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  8.12it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  8.23it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  8.20it/s]
(EngineCore_DP0 pid=13610) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.82it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.81it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  55%|█████▍    | 70/128 [00:00<00:00, 698.31it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 701.75it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:03, 37.24it/s, est. speed input: 19074.50 toks/s, output: 37.25 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:00<00:05, 22.56it/s, est. speed input: 12279.93 toks/s, output: 23.98 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:00<00:05, 20.46it/s, est. speed input: 11220.28 toks/s, output: 21.91 toks/s]
Processed prompts:  11%|█         | 14/128 [00:00<00:05, 19.37it/s, est. speed input: 10672.37 toks/s, output: 20.84 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:00<00:05, 18.64it/s, est. speed input: 10304.21 toks/s, output: 20.12 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:00<00:05, 18.38it/s, est. speed input: 10152.89 toks/s, output: 19.83 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:01<00:05, 18.23it/s, est. speed input: 10044.42 toks/s, output: 19.62 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:01<00:05, 18.17it/s, est. speed input: 9967.67 toks/s, output: 19.47 toks/s] 
Processed prompts:  20%|█▉        | 25/128 [00:01<00:05, 18.10it/s, est. speed input: 9898.40 toks/s, output: 19.33 toks/s]
Processed prompts:  21%|██        | 27/128 [00:01<00:05, 17.98it/s, est. speed input: 9830.40 toks/s, output: 19.20 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:01<00:05, 17.94it/s, est. speed input: 9779.76 toks/s, output: 19.10 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:01<00:05, 17.93it/s, est. speed input: 9738.14 toks/s, output: 19.02 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:01<00:05, 17.90it/s, est. speed input: 9698.96 toks/s, output: 18.94 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:01<00:05, 17.89it/s, est. speed input: 9665.14 toks/s, output: 18.88 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:01<00:05, 17.89it/s, est. speed input: 9636.38 toks/s, output: 18.82 toks/s]
Processed prompts:  30%|███       | 39/128 [00:02<00:04, 17.84it/s, est. speed input: 9606.02 toks/s, output: 18.76 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:02<00:04, 17.77it/s, est. speed input: 9575.82 toks/s, output: 18.70 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:02<00:04, 17.83it/s, est. speed input: 9557.16 toks/s, output: 18.67 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:02<00:04, 17.83it/s, est. speed input: 9537.54 toks/s, output: 18.63 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:02<00:04, 17.87it/s, est. speed input: 9522.16 toks/s, output: 18.60 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:02<00:04, 17.90it/s, est. speed input: 9508.73 toks/s, output: 18.57 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:02<00:04, 17.87it/s, est. speed input: 9492.44 toks/s, output: 18.54 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:02<00:04, 17.77it/s, est. speed input: 9472.59 toks/s, output: 18.50 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:02<00:04, 17.77it/s, est. speed input: 9458.09 toks/s, output: 18.47 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:03<00:03, 17.75it/s, est. speed input: 9443.80 toks/s, output: 18.44 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:03<00:03, 17.63it/s, est. speed input: 9423.64 toks/s, output: 18.41 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:03<00:03, 17.47it/s, est. speed input: 9400.36 toks/s, output: 18.36 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:03<00:03, 17.43it/s, est. speed input: 9382.88 toks/s, output: 18.33 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:03<00:03, 17.37it/s, est. speed input: 9364.64 toks/s, output: 18.29 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:03<00:03, 17.41it/s, est. speed input: 9352.18 toks/s, output: 18.27 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:03<00:03, 17.44it/s, est. speed input: 9340.26 toks/s, output: 18.24 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:03<00:03, 17.46it/s, est. speed input: 9329.51 toks/s, output: 18.22 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:04<00:03, 17.45it/s, est. speed input: 9317.63 toks/s, output: 18.20 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:04<00:03, 17.39it/s, est. speed input: 9303.91 toks/s, output: 18.17 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:04<00:02, 17.31it/s, est. speed input: 9289.51 toks/s, output: 18.14 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:04<00:02, 17.34it/s, est. speed input: 9279.64 toks/s, output: 18.12 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:04<00:02, 17.34it/s, est. speed input: 9269.07 toks/s, output: 18.10 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:04<00:02, 17.36it/s, est. speed input: 9260.02 toks/s, output: 18.09 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:04<00:02, 17.40it/s, est. speed input: 9252.79 toks/s, output: 18.07 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:04<00:02, 17.37it/s, est. speed input: 9243.43 toks/s, output: 18.05 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:04<00:02, 17.36it/s, est. speed input: 9234.66 toks/s, output: 18.04 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:05<00:02, 17.37it/s, est. speed input: 9227.11 toks/s, output: 18.02 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:05<00:02, 17.33it/s, est. speed input: 9218.10 toks/s, output: 18.00 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:05<00:01, 17.28it/s, est. speed input: 9208.85 toks/s, output: 17.99 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:05<00:01, 17.30it/s, est. speed input: 9201.58 toks/s, output: 17.97 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:05<00:01, 17.33it/s, est. speed input: 9195.48 toks/s, output: 17.96 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:05<00:01, 17.39it/s, est. speed input: 9191.11 toks/s, output: 17.95 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:05<00:01, 17.39it/s, est. speed input: 9185.32 toks/s, output: 17.94 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:05<00:01, 17.40it/s, est. speed input: 9180.00 toks/s, output: 17.93 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:05<00:01, 17.39it/s, est. speed input: 9174.38 toks/s, output: 17.92 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:06<00:01, 17.31it/s, est. speed input: 9166.82 toks/s, output: 17.90 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:06<00:00, 17.28it/s, est. speed input: 9160.24 toks/s, output: 17.89 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:06<00:00, 17.19it/s, est. speed input: 9151.44 toks/s, output: 17.87 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:06<00:00, 17.19it/s, est. speed input: 9145.29 toks/s, output: 17.86 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:06<00:00, 17.27it/s, est. speed input: 9141.53 toks/s, output: 17.85 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:06<00:00, 17.32it/s, est. speed input: 9137.80 toks/s, output: 17.85 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:06<00:00, 17.31it/s, est. speed input: 9132.96 toks/s, output: 17.84 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:06<00:00, 17.28it/s, est. speed input: 9127.66 toks/s, output: 17.83 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:07<00:00, 17.29it/s, est. speed input: 9123.25 toks/s, output: 17.82 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:07<00:00, 17.37it/s, est. speed input: 9121.18 toks/s, output: 17.81 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 17.37it/s, est. speed input: 9120.27 toks/s, output: 17.81 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 17.81it/s, est. speed input: 9120.27 toks/s, output: 17.81 toks/s]
[rank0]:[W128 11:18:37.565609216 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=1024 ==========
Time: 2026-01-28 11:18:39
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 1025 --max-num-batched-tokens 1025 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/BitNet-2B-INT8_M1024.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-28 11:18:49 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 11:18:50 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=14147) WARNING 01-28 11:18:56 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=14147) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=14147) WARNING 01-28 11:19:06 [backends.py:609] Failed to read file <frozen os>
Throughput: 16.61 requests/s, 17024.56 total tokens/s, 16.61 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128

STDERR:
[2026-01-28 11:18:49] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 11:18:49] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 11:18:49] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 11:18:49] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:18:49] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:18:49] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:18:49] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:18:49] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:18:49] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 11:18:49] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 11:18:49] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 11:18:49] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 11:18:49] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 11:18:49] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 11:18:56] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 11:18:56] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 11:18:56] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 11:18:56] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:18:56] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:18:56] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:18:56] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:18:56] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:18:56] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 11:18:56] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 11:18:56] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 11:18:56] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 11:18:56] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 11:18:56] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=14147) [2026-01-28 11:18:57] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=14147) [2026-01-28 11:18:57] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=14147) [2026-01-28 11:18:57] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=14147) [2026-01-28 11:18:57] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=14147) [2026-01-28 11:18:57] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=14147) [2026-01-28 11:18:57] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=14147) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=14147) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.61it/s]
(EngineCore_DP0 pid=14147) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.61it/s]
(EngineCore_DP0 pid=14147) 
(EngineCore_DP0 pid=14147) [2026-01-28 11:18:58] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 3424] -> 1D uint8
(EngineCore_DP0 pid=14147) [2026-01-28 11:18:58] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9891840 bytes
(EngineCore_DP0 pid=14147) [2026-01-28 11:18:58] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 3424] -> 1D uint8
(EngineCore_DP0 pid=14147) [2026-01-28 11:18:58] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 6594560 bytes
(EngineCore_DP0 pid=14147) [2026-01-28 11:18:58] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 3424] -> 1D uint8
(EngineCore_DP0 pid=14147) [2026-01-28 11:18:58] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 35610624 bytes
(EngineCore_DP0 pid=14147) [2026-01-28 11:18:58] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 9216] -> 1D uint8
(EngineCore_DP0 pid=14147) [2026-01-28 11:18:58] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 17694720 bytes
(EngineCore_DP0 pid=14147) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  4.51it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  6.31it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  5.95it/s]
(EngineCore_DP0 pid=14147) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.89it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.88it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  28%|██▊       | 36/128 [00:00<00:00, 354.18it/s]
Adding requests:  59%|█████▉    | 76/128 [00:00<00:00, 379.36it/s]
Adding requests:  91%|█████████ | 116/128 [00:00<00:00, 385.64it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 382.62it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:02, 46.81it/s, est. speed input: 47940.48 toks/s, output: 46.81 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:00<00:04, 25.06it/s, est. speed input: 27937.46 toks/s, output: 27.28 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:00<00:05, 21.49it/s, est. speed input: 24564.09 toks/s, output: 23.99 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:00<00:05, 19.56it/s, est. speed input: 22735.62 toks/s, output: 22.20 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:00<00:05, 18.59it/s, est. speed input: 21707.43 toks/s, output: 21.20 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:01<00:05, 18.10it/s, est. speed input: 21193.80 toks/s, output: 20.70 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:01<00:05, 17.73it/s, est. speed input: 20791.83 toks/s, output: 20.30 toks/s]
Processed prompts:  21%|██        | 27/128 [00:01<00:05, 17.45it/s, est. speed input: 20461.05 toks/s, output: 19.98 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:01<00:05, 17.19it/s, est. speed input: 20168.80 toks/s, output: 19.70 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:01<00:05, 16.99it/s, est. speed input: 19919.14 toks/s, output: 19.45 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:01<00:05, 16.84it/s, est. speed input: 19703.89 toks/s, output: 19.24 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:01<00:05, 16.74it/s, est. speed input: 19517.97 toks/s, output: 19.06 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:01<00:05, 16.72it/s, est. speed input: 19368.40 toks/s, output: 18.91 toks/s]
Processed prompts:  30%|███       | 39/128 [00:02<00:05, 16.65it/s, est. speed input: 19222.33 toks/s, output: 18.77 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:02<00:05, 16.55it/s, est. speed input: 19081.80 toks/s, output: 18.63 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:02<00:05, 16.55it/s, est. speed input: 18971.35 toks/s, output: 18.53 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:02<00:05, 16.51it/s, est. speed input: 18863.23 toks/s, output: 18.42 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:02<00:04, 16.45it/s, est. speed input: 18760.16 toks/s, output: 18.32 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:02<00:04, 16.37it/s, est. speed input: 18659.83 toks/s, output: 18.22 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:02<00:04, 16.38it/s, est. speed input: 18578.97 toks/s, output: 18.14 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:02<00:04, 16.44it/s, est. speed input: 18512.79 toks/s, output: 18.08 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:03<00:04, 16.23it/s, est. speed input: 18413.97 toks/s, output: 17.98 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:03<00:04, 16.06it/s, est. speed input: 18320.11 toks/s, output: 17.89 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:03<00:04, 16.10it/s, est. speed input: 18254.49 toks/s, output: 17.83 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:03<00:04, 16.14it/s, est. speed input: 18196.35 toks/s, output: 17.77 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:03<00:04, 16.13it/s, est. speed input: 18137.02 toks/s, output: 17.71 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:03<00:03, 16.18it/s, est. speed input: 18088.87 toks/s, output: 17.66 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:03<00:03, 16.19it/s, est. speed input: 18041.08 toks/s, output: 17.62 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:03<00:03, 16.17it/s, est. speed input: 17992.00 toks/s, output: 17.57 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:04<00:03, 16.19it/s, est. speed input: 17950.93 toks/s, output: 17.53 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:04<00:03, 16.16it/s, est. speed input: 17906.69 toks/s, output: 17.49 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:04<00:03, 16.13it/s, est. speed input: 17864.76 toks/s, output: 17.45 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:04<00:03, 16.11it/s, est. speed input: 17824.76 toks/s, output: 17.41 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:04<00:03, 16.10it/s, est. speed input: 17787.60 toks/s, output: 17.37 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:04<00:02, 16.13it/s, est. speed input: 17755.36 toks/s, output: 17.34 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:04<00:02, 16.19it/s, est. speed input: 17729.06 toks/s, output: 17.31 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:04<00:02, 16.55it/s, est. speed input: 17732.66 toks/s, output: 17.32 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:05<00:02, 16.83it/s, est. speed input: 17737.51 toks/s, output: 17.32 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:05<00:02, 17.03it/s, est. speed input: 17742.20 toks/s, output: 17.33 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:05<00:02, 17.20it/s, est. speed input: 17748.48 toks/s, output: 17.33 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:05<00:02, 17.26it/s, est. speed input: 17749.88 toks/s, output: 17.33 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:05<00:01, 17.28it/s, est. speed input: 17750.05 toks/s, output: 17.33 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:05<00:01, 17.29it/s, est. speed input: 17749.68 toks/s, output: 17.33 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:05<00:01, 17.29it/s, est. speed input: 17748.80 toks/s, output: 17.33 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:05<00:01, 17.37it/s, est. speed input: 17753.23 toks/s, output: 17.34 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:05<00:01, 17.42it/s, est. speed input: 17757.30 toks/s, output: 17.34 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:06<00:01, 17.45it/s, est. speed input: 17760.68 toks/s, output: 17.34 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:06<00:01, 17.47it/s, est. speed input: 17764.17 toks/s, output: 17.35 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:06<00:01, 17.39it/s, est. speed input: 17761.41 toks/s, output: 17.35 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:06<00:00, 17.42it/s, est. speed input: 17763.97 toks/s, output: 17.35 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:06<00:00, 17.42it/s, est. speed input: 17765.44 toks/s, output: 17.35 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:06<00:00, 17.46it/s, est. speed input: 17768.88 toks/s, output: 17.35 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:06<00:00, 17.44it/s, est. speed input: 17769.86 toks/s, output: 17.35 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:06<00:00, 17.40it/s, est. speed input: 17769.06 toks/s, output: 17.35 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:06<00:00, 17.42it/s, est. speed input: 17770.72 toks/s, output: 17.35 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:07<00:00, 17.46it/s, est. speed input: 17773.98 toks/s, output: 17.36 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:07<00:00, 17.47it/s, est. speed input: 17776.49 toks/s, output: 17.36 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:07<00:00, 17.51it/s, est. speed input: 17780.30 toks/s, output: 17.36 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 17.51it/s, est. speed input: 17783.32 toks/s, output: 17.37 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 17.37it/s, est. speed input: 17783.32 toks/s, output: 17.37 toks/s]
[rank0]:[W128 11:19:27.450498808 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=2048 ==========
Time: 2026-01-28 11:19:29
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=256, max_num_seqs=2
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 256 --max-num-seqs 2 --max-model-len 1025 --max-num-batched-tokens 2048 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/BitNet-2B-INT8_M2048.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-28 11:19:37 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 11:19:38 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=14745) WARNING 01-28 11:19:45 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=14745) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=14745) WARNING 01-28 11:19:57 [backends.py:609] Failed to read file <frozen os>
Throughput: 34.81 requests/s, 35684.14 total tokens/s, 34.81 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256

STDERR:
[2026-01-28 11:19:37] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 11:19:37] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 11:19:37] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 11:19:37] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:19:37] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:19:37] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:19:37] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:19:37] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:19:37] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 11:19:37] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 11:19:37] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 11:19:37] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 11:19:37] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 11:19:37] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 11:19:44] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 11:19:44] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 11:19:44] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 11:19:44] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:19:44] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:19:44] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:19:44] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:19:44] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:19:44] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 11:19:44] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 11:19:44] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 11:19:44] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 11:19:44] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 11:19:44] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=14745) [2026-01-28 11:19:45] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=14745) [2026-01-28 11:19:45] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=14745) [2026-01-28 11:19:45] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=14745) [2026-01-28 11:19:45] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=14745) [2026-01-28 11:19:45] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=14745) [2026-01-28 11:19:45] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=14745) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=14745) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.69it/s]
(EngineCore_DP0 pid=14745) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.69it/s]
(EngineCore_DP0 pid=14745) 
(EngineCore_DP0 pid=14745) [2026-01-28 11:19:46] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 3424] -> 1D uint8
(EngineCore_DP0 pid=14745) [2026-01-28 11:19:46] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9891840 bytes
(EngineCore_DP0 pid=14745) [2026-01-28 11:19:46] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 3424] -> 1D uint8
(EngineCore_DP0 pid=14745) [2026-01-28 11:19:46] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 6594560 bytes
(EngineCore_DP0 pid=14745) [2026-01-28 11:19:46] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 3424] -> 1D uint8
(EngineCore_DP0 pid=14745) [2026-01-28 11:19:46] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 35610624 bytes
(EngineCore_DP0 pid=14745) [2026-01-28 11:19:46] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 9216] -> 1D uint8
(EngineCore_DP0 pid=14745) [2026-01-28 11:19:46] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 17694720 bytes
(EngineCore_DP0 pid=14745) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  33%|███▎      | 1/3 [00:00<00:00,  8.05it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  67%|██████▋   | 2/3 [00:00<00:00,  8.58it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00,  7.97it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00,  8.07it/s]
(EngineCore_DP0 pid=14745) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 1/2 [00:00<00:00,  7.54it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  8.35it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  8.22it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  15%|█▌        | 39/256 [00:00<00:00, 381.90it/s]
Adding requests:  31%|███       | 79/256 [00:00<00:00, 389.30it/s]
Adding requests:  46%|████▌     | 118/256 [00:00<00:00, 389.54it/s]
Adding requests:  62%|██████▏   | 158/256 [00:00<00:00, 391.59it/s]
Adding requests:  77%|███████▋  | 198/256 [00:00<00:00, 379.75it/s]
Adding requests:  94%|█████████▍| 240/256 [00:00<00:00, 390.12it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 389.07it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   7%|▋         | 18/256 [00:00<00:01, 168.15it/s, est. speed input: 172218.91 toks/s, output: 168.16 toks/s]
Processed prompts:  14%|█▎        | 35/256 [00:00<00:03, 56.19it/s, est. speed input: 64123.51 toks/s, output: 62.62 toks/s]   
Processed prompts:  18%|█▊        | 45/256 [00:00<00:04, 47.46it/s, est. speed input: 55021.50 toks/s, output: 53.73 toks/s]
Processed prompts:  20%|██        | 52/256 [00:01<00:04, 42.24it/s, est. speed input: 50277.33 toks/s, output: 49.10 toks/s]
Processed prompts:  23%|██▎       | 58/256 [00:01<00:04, 40.35it/s, est. speed input: 48290.88 toks/s, output: 47.16 toks/s]
Processed prompts:  25%|██▍       | 63/256 [00:01<00:04, 41.13it/s, est. speed input: 48034.75 toks/s, output: 46.91 toks/s]
Processed prompts:  27%|██▋       | 68/256 [00:01<00:04, 38.00it/s, est. speed input: 46205.78 toks/s, output: 45.12 toks/s]
Processed prompts:  29%|██▊       | 73/256 [00:01<00:04, 39.58it/s, est. speed input: 46206.50 toks/s, output: 45.12 toks/s]
Processed prompts:  30%|███       | 78/256 [00:01<00:04, 36.62it/s, est. speed input: 44804.13 toks/s, output: 43.75 toks/s]
Processed prompts:  32%|███▏      | 82/256 [00:01<00:04, 36.63it/s, est. speed input: 44386.02 toks/s, output: 43.35 toks/s]
Processed prompts:  34%|███▎      | 86/256 [00:02<00:04, 36.64it/s, est. speed input: 44012.64 toks/s, output: 42.98 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:02<00:04, 36.53it/s, est. speed input: 43652.19 toks/s, output: 42.63 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:02<00:04, 36.39it/s, est. speed input: 43314.41 toks/s, output: 42.30 toks/s]
Processed prompts:  38%|███▊      | 98/256 [00:02<00:04, 36.08it/s, est. speed input: 42967.03 toks/s, output: 41.96 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:02<00:04, 36.08it/s, est. speed input: 42693.62 toks/s, output: 41.69 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:02<00:04, 36.22it/s, est. speed input: 42469.30 toks/s, output: 41.47 toks/s]
Processed prompts:  43%|████▎     | 110/256 [00:02<00:04, 36.37it/s, est. speed input: 42270.49 toks/s, output: 41.28 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:02<00:03, 36.43it/s, est. speed input: 42080.70 toks/s, output: 41.09 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:02<00:03, 36.49it/s, est. speed input: 41907.20 toks/s, output: 40.92 toks/s]
Processed prompts:  48%|████▊     | 122/256 [00:02<00:03, 36.54it/s, est. speed input: 41748.93 toks/s, output: 40.77 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:03<00:03, 36.51it/s, est. speed input: 41591.29 toks/s, output: 40.62 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:03<00:03, 36.35it/s, est. speed input: 41426.78 toks/s, output: 40.46 toks/s]
Processed prompts:  52%|█████▏    | 134/256 [00:03<00:03, 36.15it/s, est. speed input: 41262.56 toks/s, output: 40.30 toks/s]
Processed prompts:  54%|█████▍    | 138/256 [00:03<00:03, 36.12it/s, est. speed input: 41121.84 toks/s, output: 40.16 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:03<00:03, 36.05it/s, est. speed input: 40984.95 toks/s, output: 40.02 toks/s]
Processed prompts:  57%|█████▋    | 146/256 [00:03<00:03, 36.02it/s, est. speed input: 40857.84 toks/s, output: 39.90 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:03<00:02, 36.10it/s, est. speed input: 40749.26 toks/s, output: 39.79 toks/s]
Processed prompts:  60%|██████    | 154/256 [00:03<00:02, 36.15it/s, est. speed input: 40646.92 toks/s, output: 39.69 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:03<00:02, 36.23it/s, est. speed input: 40554.36 toks/s, output: 39.60 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:04<00:02, 36.13it/s, est. speed input: 40451.08 toks/s, output: 39.50 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:04<00:02, 36.23it/s, est. speed input: 40370.18 toks/s, output: 39.42 toks/s]
Processed prompts:  66%|██████▋   | 170/256 [00:04<00:02, 36.27it/s, est. speed input: 40290.66 toks/s, output: 39.35 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:04<00:02, 36.20it/s, est. speed input: 40205.65 toks/s, output: 39.26 toks/s]
Processed prompts:  70%|██████▉   | 178/256 [00:04<00:02, 36.28it/s, est. speed input: 40136.70 toks/s, output: 39.20 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:04<00:02, 36.35it/s, est. speed input: 40071.55 toks/s, output: 39.13 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:04<00:01, 36.43it/s, est. speed input: 40012.33 toks/s, output: 39.07 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:04<00:01, 36.49it/s, est. speed input: 39956.28 toks/s, output: 39.02 toks/s]
Processed prompts:  76%|███████▌  | 194/256 [00:04<00:01, 36.57it/s, est. speed input: 39905.70 toks/s, output: 38.97 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:05<00:01, 36.46it/s, est. speed input: 39844.68 toks/s, output: 38.91 toks/s]
Processed prompts:  79%|███████▉  | 202/256 [00:05<00:01, 36.37it/s, est. speed input: 39784.24 toks/s, output: 38.85 toks/s]
Processed prompts:  80%|████████  | 206/256 [00:05<00:01, 36.23it/s, est. speed input: 39720.86 toks/s, output: 38.79 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:05<00:01, 36.33it/s, est. speed input: 39675.40 toks/s, output: 38.75 toks/s]
Processed prompts:  84%|████████▎ | 214/256 [00:05<00:01, 36.30it/s, est. speed input: 39623.81 toks/s, output: 38.69 toks/s]
Processed prompts:  85%|████████▌ | 218/256 [00:05<00:01, 36.27it/s, est. speed input: 39574.04 toks/s, output: 38.65 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:05<00:00, 36.01it/s, est. speed input: 39509.04 toks/s, output: 38.58 toks/s]
Processed prompts:  88%|████████▊ | 226/256 [00:05<00:00, 36.19it/s, est. speed input: 39471.25 toks/s, output: 38.55 toks/s]
Processed prompts:  90%|████████▉ | 230/256 [00:05<00:00, 36.10it/s, est. speed input: 39420.64 toks/s, output: 38.50 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:06<00:00, 36.00it/s, est. speed input: 39369.48 toks/s, output: 38.45 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:06<00:00, 36.06it/s, est. speed input: 39328.25 toks/s, output: 38.41 toks/s]
Processed prompts:  95%|█████████▍| 242/256 [00:06<00:00, 36.00it/s, est. speed input: 39282.26 toks/s, output: 38.36 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:06<00:00, 36.09it/s, est. speed input: 39246.09 toks/s, output: 38.33 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:06<00:00, 36.16it/s, est. speed input: 39211.76 toks/s, output: 38.29 toks/s]
Processed prompts:  99%|█████████▉| 254/256 [00:06<00:00, 36.20it/s, est. speed input: 39177.47 toks/s, output: 38.26 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:06<00:00, 36.20it/s, est. speed input: 39160.85 toks/s, output: 38.24 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:06<00:00, 38.24it/s, est. speed input: 39160.85 toks/s, output: 38.24 toks/s]
[rank0]:[W128 11:20:15.395376694 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=4096 ==========
Time: 2026-01-28 11:20:18
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=512, max_num_seqs=4
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 512 --max-num-seqs 4 --max-model-len 1025 --max-num-batched-tokens 4096 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/BitNet-2B-INT8_M4096.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-28 11:20:29 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 11:20:30 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=15271) WARNING 01-28 11:20:37 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=15271) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=15271) WARNING 01-28 11:20:47 [backends.py:609] Failed to read file <frozen os>
Throughput: 53.25 requests/s, 54579.34 total tokens/s, 53.25 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512

STDERR:
[2026-01-28 11:20:29] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 11:20:29] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 11:20:29] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 11:20:29] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:20:29] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:20:29] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:20:29] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:20:29] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:20:29] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 11:20:29] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 11:20:29] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 11:20:29] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 11:20:29] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 11:20:29] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 11:20:37] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 11:20:37] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 11:20:37] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 11:20:37] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:20:37] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:20:37] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:20:37] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:20:37] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:20:37] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 11:20:37] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 11:20:37] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 11:20:37] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 11:20:37] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 11:20:37] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=15271) [2026-01-28 11:20:38] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=15271) [2026-01-28 11:20:38] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=15271) [2026-01-28 11:20:38] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=15271) [2026-01-28 11:20:38] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=15271) [2026-01-28 11:20:38] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=15271) [2026-01-28 11:20:38] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=15271) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=15271) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.62it/s]
(EngineCore_DP0 pid=15271) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.62it/s]
(EngineCore_DP0 pid=15271) 
(EngineCore_DP0 pid=15271) [2026-01-28 11:20:39] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 3424] -> 1D uint8
(EngineCore_DP0 pid=15271) [2026-01-28 11:20:39] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9891840 bytes
(EngineCore_DP0 pid=15271) [2026-01-28 11:20:39] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 3424] -> 1D uint8
(EngineCore_DP0 pid=15271) [2026-01-28 11:20:39] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 6594560 bytes
(EngineCore_DP0 pid=15271) [2026-01-28 11:20:39] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 3424] -> 1D uint8
(EngineCore_DP0 pid=15271) [2026-01-28 11:20:39] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 35610624 bytes
(EngineCore_DP0 pid=15271) [2026-01-28 11:20:39] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 9216] -> 1D uint8
(EngineCore_DP0 pid=15271) [2026-01-28 11:20:39] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 17694720 bytes
(EngineCore_DP0 pid=15271) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  25%|██▌       | 1/4 [00:00<00:00,  8.22it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 2/4 [00:00<00:00,  8.76it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  75%|███████▌  | 3/4 [00:00<00:00,  8.89it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  8.20it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  8.38it/s]
(EngineCore_DP0 pid=15271) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  33%|███▎      | 1/3 [00:00<00:00,  7.63it/s]
Capturing CUDA graphs (decode, FULL):  67%|██████▋   | 2/3 [00:00<00:00,  8.63it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  9.08it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  8.83it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   7%|▋         | 35/512 [00:00<00:01, 344.87it/s]
Adding requests:  14%|█▍        | 73/512 [00:00<00:01, 360.88it/s]
Adding requests:  21%|██▏       | 110/512 [00:00<00:01, 364.32it/s]
Adding requests:  29%|██▊       | 147/512 [00:00<00:01, 363.87it/s]
Adding requests:  36%|███▌      | 184/512 [00:00<00:00, 361.51it/s]
Adding requests:  43%|████▎     | 221/512 [00:00<00:00, 358.15it/s]
Adding requests:  51%|█████     | 259/512 [00:00<00:00, 363.50it/s]
Adding requests:  58%|█████▊    | 296/512 [00:00<00:00, 352.47it/s]
Adding requests:  65%|██████▍   | 332/512 [00:00<00:00, 352.22it/s]
Adding requests:  72%|███████▏  | 369/512 [00:01<00:00, 355.22it/s]
Adding requests:  79%|███████▉  | 405/512 [00:01<00:00, 352.78it/s]
Adding requests:  86%|████████▌ | 441/512 [00:01<00:00, 352.53it/s]
Adding requests:  93%|█████████▎| 478/512 [00:01<00:00, 357.09it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 357.14it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  13%|█▎        | 66/512 [00:00<00:00, 496.58it/s, est. speed input: 508590.21 toks/s, output: 496.60 toks/s]
Processed prompts:  23%|██▎       | 116/512 [00:01<00:04, 98.29it/s, est. speed input: 116617.28 toks/s, output: 113.88 toks/s]
Processed prompts:  27%|██▋       | 140/512 [00:01<00:04, 81.07it/s, est. speed input: 98184.87 toks/s, output: 95.88 toks/s]  
Processed prompts:  30%|███       | 156/512 [00:01<00:04, 73.79it/s, est. speed input: 91037.01 toks/s, output: 88.90 toks/s]
Processed prompts:  33%|███▎      | 168/512 [00:04<00:15, 21.91it/s, est. speed input: 41978.66 toks/s, output: 40.99 toks/s]
Processed prompts:  34%|███▍      | 176/512 [00:04<00:14, 23.97it/s, est. speed input: 42449.10 toks/s, output: 41.45 toks/s]
Processed prompts:  36%|███▌      | 183/512 [00:04<00:12, 25.93it/s, est. speed input: 42659.52 toks/s, output: 41.66 toks/s]
Processed prompts:  37%|███▋      | 190/512 [00:04<00:11, 28.21it/s, est. speed input: 42850.38 toks/s, output: 41.84 toks/s]
Processed prompts:  39%|███▊      | 198/512 [00:04<00:09, 31.62it/s, est. speed input: 43240.87 toks/s, output: 42.23 toks/s]
Processed prompts:  40%|████      | 206/512 [00:04<00:08, 35.18it/s, est. speed input: 43609.84 toks/s, output: 42.59 toks/s]
Processed prompts:  42%|████▏     | 214/512 [00:04<00:07, 38.68it/s, est. speed input: 43962.56 toks/s, output: 42.93 toks/s]
Processed prompts:  43%|████▎     | 222/512 [00:05<00:06, 41.91it/s, est. speed input: 44292.10 toks/s, output: 43.25 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:05<00:06, 44.73it/s, est. speed input: 44604.63 toks/s, output: 43.56 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:05<00:05, 47.02it/s, est. speed input: 44895.74 toks/s, output: 43.84 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:05<00:05, 48.87it/s, est. speed input: 45174.31 toks/s, output: 44.12 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:05<00:05, 50.32it/s, est. speed input: 45440.55 toks/s, output: 44.38 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:05<00:04, 51.41it/s, est. speed input: 45694.03 toks/s, output: 44.62 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:06<00:04, 52.20it/s, est. speed input: 45935.46 toks/s, output: 44.86 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:06<00:04, 52.76it/s, est. speed input: 46161.66 toks/s, output: 45.08 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:06<00:04, 53.18it/s, est. speed input: 46380.18 toks/s, output: 45.29 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:06<00:04, 53.49it/s, est. speed input: 46589.66 toks/s, output: 45.50 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:06<00:03, 53.69it/s, est. speed input: 46787.61 toks/s, output: 45.69 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:06<00:03, 53.85it/s, est. speed input: 46978.30 toks/s, output: 45.88 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:06<00:03, 53.91it/s, est. speed input: 47157.69 toks/s, output: 46.05 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:07<00:03, 53.97it/s, est. speed input: 47330.49 toks/s, output: 46.22 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:07<00:03, 54.03it/s, est. speed input: 47497.32 toks/s, output: 46.38 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:07<00:03, 54.89it/s, est. speed input: 47705.19 toks/s, output: 46.59 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:07<00:02, 54.66it/s, est. speed input: 47857.71 toks/s, output: 46.74 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:07<00:02, 54.47it/s, est. speed input: 48002.80 toks/s, output: 46.88 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:07<00:02, 54.36it/s, est. speed input: 48143.07 toks/s, output: 47.01 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [00:07<00:02, 54.72it/s, est. speed input: 48302.35 toks/s, output: 47.17 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [00:08<00:02, 55.45it/s, est. speed input: 48480.63 toks/s, output: 47.34 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [00:08<00:02, 55.93it/s, est. speed input: 48651.02 toks/s, output: 47.51 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [00:08<00:02, 56.29it/s, est. speed input: 48816.39 toks/s, output: 47.67 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [00:08<00:01, 56.59it/s, est. speed input: 48978.67 toks/s, output: 47.83 toks/s]
Processed prompts:  81%|████████  | 414/512 [00:08<00:01, 56.75it/s, est. speed input: 49133.18 toks/s, output: 47.98 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [00:08<00:01, 56.79it/s, est. speed input: 49279.57 toks/s, output: 48.12 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [00:08<00:01, 56.93it/s, est. speed input: 49425.95 toks/s, output: 48.27 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [00:09<00:01, 56.99it/s, est. speed input: 49566.49 toks/s, output: 48.40 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [00:09<00:01, 57.02it/s, est. speed input: 49702.28 toks/s, output: 48.54 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [00:09<00:01, 57.06it/s, est. speed input: 49834.60 toks/s, output: 48.67 toks/s]
Processed prompts:  90%|█████████ | 462/512 [00:09<00:00, 57.02it/s, est. speed input: 49959.94 toks/s, output: 48.79 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [00:09<00:00, 57.07it/s, est. speed input: 50085.17 toks/s, output: 48.91 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [00:09<00:00, 57.03it/s, est. speed input: 50203.73 toks/s, output: 49.03 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [00:09<00:00, 57.03it/s, est. speed input: 50320.31 toks/s, output: 49.14 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [00:10<00:00, 57.05it/s, est. speed input: 50433.58 toks/s, output: 49.25 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [00:10<00:00, 57.09it/s, est. speed input: 50545.58 toks/s, output: 49.36 toks/s]
Processed prompts: 100%|█████████▉| 510/512 [00:10<00:00, 58.15it/s, est. speed input: 50695.09 toks/s, output: 49.51 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:10<00:00, 58.15it/s, est. speed input: 50892.99 toks/s, output: 49.70 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:10<00:00, 49.70it/s, est. speed input: 50892.99 toks/s, output: 49.70 toks/s]
[rank0]:[W128 11:21:10.412359074 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=8192 ==========
Time: 2026-01-28 11:21:12
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=1024, max_num_seqs=8
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 1024 --max-num-seqs 8 --max-model-len 1025 --max-num-batched-tokens 8192 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/BitNet-2B-INT8_M8192.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-28 11:21:24 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 11:21:25 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=15835) WARNING 01-28 11:21:32 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=15835) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=15835) WARNING 01-28 11:21:44 [backends.py:609] Failed to read file <frozen os>
Throughput: 55.31 requests/s, 56696.32 total tokens/s, 55.31 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024

STDERR:
[2026-01-28 11:21:24] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 11:21:24] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 11:21:24] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 11:21:24] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:21:24] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:21:24] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:21:24] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:21:24] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:21:24] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 11:21:24] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 11:21:24] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 11:21:24] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 11:21:24] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 11:21:24] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 11:21:31] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 11:21:31] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 11:21:31] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 11:21:31] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:21:31] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:21:31] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:21:31] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:21:31] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:21:31] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 11:21:31] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 11:21:31] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 11:21:31] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 11:21:31] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 11:21:31] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=15835) [2026-01-28 11:21:33] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=15835) [2026-01-28 11:21:33] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=15835) [2026-01-28 11:21:33] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=15835) [2026-01-28 11:21:33] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=15835) [2026-01-28 11:21:33] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=15835) [2026-01-28 11:21:33] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=15835) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=15835) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.64it/s]
(EngineCore_DP0 pid=15835) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.64it/s]
(EngineCore_DP0 pid=15835) 
(EngineCore_DP0 pid=15835) [2026-01-28 11:21:34] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 3424] -> 1D uint8
(EngineCore_DP0 pid=15835) [2026-01-28 11:21:34] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9891840 bytes
(EngineCore_DP0 pid=15835) [2026-01-28 11:21:34] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 3424] -> 1D uint8
(EngineCore_DP0 pid=15835) [2026-01-28 11:21:34] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 6594560 bytes
(EngineCore_DP0 pid=15835) [2026-01-28 11:21:34] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 3424] -> 1D uint8
(EngineCore_DP0 pid=15835) [2026-01-28 11:21:34] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 35610624 bytes
(EngineCore_DP0 pid=15835) [2026-01-28 11:21:34] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 9216] -> 1D uint8
(EngineCore_DP0 pid=15835) [2026-01-28 11:21:34] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 17694720 bytes
(EngineCore_DP0 pid=15835) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:00,  8.26it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  40%|████      | 2/5 [00:00<00:00,  8.49it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  60%|██████    | 3/5 [00:00<00:00,  8.82it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  80%|████████  | 4/5 [00:00<00:00,  8.93it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00,  8.26it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00,  8.45it/s]
(EngineCore_DP0 pid=15835) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:00,  7.50it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 2/4 [00:00<00:00,  8.54it/s]
Capturing CUDA graphs (decode, FULL):  75%|███████▌  | 3/4 [00:00<00:00,  8.88it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  9.02it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  8.80it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   4%|▎         | 37/1024 [00:00<00:02, 362.20it/s]
Adding requests:   7%|▋         | 75/1024 [00:00<00:02, 370.30it/s]
Adding requests:  11%|█         | 114/1024 [00:00<00:02, 374.91it/s]
Adding requests:  15%|█▍        | 152/1024 [00:00<00:02, 372.69it/s]
Adding requests:  19%|█▊        | 191/1024 [00:00<00:02, 376.03it/s]
Adding requests:  22%|██▏       | 230/1024 [00:00<00:02, 379.30it/s]
Adding requests:  26%|██▋       | 269/1024 [00:00<00:01, 380.10it/s]
Adding requests:  30%|███       | 308/1024 [00:00<00:01, 376.40it/s]
Adding requests:  34%|███▍      | 347/1024 [00:00<00:01, 377.88it/s]
Adding requests:  38%|███▊      | 386/1024 [00:01<00:01, 380.78it/s]
Adding requests:  42%|████▏     | 426/1024 [00:01<00:01, 382.92it/s]
Adding requests:  45%|████▌     | 465/1024 [00:01<00:01, 380.52it/s]
Adding requests:  49%|████▉     | 504/1024 [00:01<00:01, 380.18it/s]
Adding requests:  53%|█████▎    | 543/1024 [00:01<00:01, 371.12it/s]
Adding requests:  57%|█████▋    | 582/1024 [00:01<00:01, 375.92it/s]
Adding requests:  61%|██████    | 620/1024 [00:01<00:01, 369.61it/s]
Adding requests:  64%|██████▍   | 659/1024 [00:01<00:00, 373.41it/s]
Adding requests:  68%|██████▊   | 697/1024 [00:01<00:00, 374.40it/s]
Adding requests:  72%|███████▏  | 737/1024 [00:01<00:00, 380.33it/s]
Adding requests:  76%|███████▌  | 776/1024 [00:02<00:00, 378.86it/s]
Adding requests:  79%|███████▉  | 814/1024 [00:02<00:00, 375.04it/s]
Adding requests:  83%|████████▎ | 853/1024 [00:02<00:00, 377.48it/s]
Adding requests:  87%|████████▋ | 894/1024 [00:02<00:00, 386.90it/s]
Adding requests:  91%|█████████▏| 935/1024 [00:02<00:00, 391.30it/s]
Adding requests:  95%|█████████▌| 975/1024 [00:02<00:00, 393.48it/s]
Adding requests:  99%|█████████▉| 1015/1024 [00:02<00:00, 394.95it/s]
Adding requests: 100%|██████████| 1024/1024 [00:02<00:00, 380.60it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  14%|█▍        | 146/1024 [00:00<00:01, 675.71it/s, est. speed input: 692008.11 toks/s, output: 675.73 toks/s]
Processed prompts:  21%|██        | 214/1024 [00:01<00:06, 131.39it/s, est. speed input: 161101.01 toks/s, output: 157.32 toks/s]
Processed prompts:  24%|██▍       | 246/1024 [00:01<00:07, 102.09it/s, est. speed input: 130257.72 toks/s, output: 127.20 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:02<00:08, 85.78it/s, est. speed input: 115215.05 toks/s, output: 112.51 toks/s] 
Processed prompts:  27%|██▋       | 280/1024 [00:02<00:08, 87.23it/s, est. speed input: 114342.23 toks/s, output: 111.66 toks/s]
Processed prompts:  29%|██▊       | 293/1024 [00:02<00:09, 76.40it/s, est. speed input: 107391.95 toks/s, output: 104.87 toks/s]
Processed prompts:  30%|██▉       | 303/1024 [00:02<00:09, 75.36it/s, est. speed input: 105636.47 toks/s, output: 103.16 toks/s]
Processed prompts:  30%|███       | 312/1024 [00:03<00:09, 73.08it/s, est. speed input: 103718.11 toks/s, output: 101.29 toks/s]
Processed prompts:  31%|███▏      | 320/1024 [00:03<00:10, 69.52it/s, est. speed input: 101652.53 toks/s, output: 99.27 toks/s] 
Processed prompts:  32%|███▏      | 328/1024 [00:03<00:10, 66.39it/s, est. speed input: 99755.43 toks/s, output: 97.42 toks/s] 
Processed prompts:  33%|███▎      | 335/1024 [00:03<00:11, 62.01it/s, est. speed input: 97707.92 toks/s, output: 95.42 toks/s]
Processed prompts:  33%|███▎      | 342/1024 [00:03<00:11, 58.57it/s, est. speed input: 95832.60 toks/s, output: 93.59 toks/s]
Processed prompts:  34%|███▍      | 348/1024 [00:03<00:12, 54.06it/s, est. speed input: 93835.61 toks/s, output: 91.64 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:03<00:13, 50.68it/s, est. speed input: 91987.68 toks/s, output: 89.83 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:04<00:12, 52.17it/s, est. speed input: 90771.00 toks/s, output: 88.64 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:04<00:12, 53.22it/s, est. speed input: 89630.23 toks/s, output: 87.53 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:04<00:11, 53.90it/s, est. speed input: 88549.86 toks/s, output: 86.47 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:04<00:11, 54.46it/s, est. speed input: 87552.91 toks/s, output: 85.50 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [00:04<00:11, 54.84it/s, est. speed input: 86614.24 toks/s, output: 84.58 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:04<00:11, 55.11it/s, est. speed input: 85731.41 toks/s, output: 83.72 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:04<00:11, 55.29it/s, est. speed input: 84898.37 toks/s, output: 82.91 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:05<00:10, 55.43it/s, est. speed input: 84114.54 toks/s, output: 82.14 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:05<00:10, 55.53it/s, est. speed input: 83373.57 toks/s, output: 81.42 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:05<00:10, 55.60it/s, est. speed input: 82673.00 toks/s, output: 80.74 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:05<00:10, 55.62it/s, est. speed input: 82003.92 toks/s, output: 80.08 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:05<00:10, 55.64it/s, est. speed input: 81370.40 toks/s, output: 79.46 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:05<00:10, 55.67it/s, est. speed input: 80769.69 toks/s, output: 78.88 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:05<00:10, 55.71it/s, est. speed input: 80200.76 toks/s, output: 78.32 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:06<00:09, 55.75it/s, est. speed input: 79659.78 toks/s, output: 77.79 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:06<00:09, 55.78it/s, est. speed input: 79143.52 toks/s, output: 77.29 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:06<00:09, 55.79it/s, est. speed input: 78649.03 toks/s, output: 76.81 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:06<00:09, 55.79it/s, est. speed input: 78176.49 toks/s, output: 76.34 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:06<00:09, 55.78it/s, est. speed input: 77722.95 toks/s, output: 75.90 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:06<00:09, 55.78it/s, est. speed input: 77289.14 toks/s, output: 75.48 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:06<00:08, 55.79it/s, est. speed input: 76874.08 toks/s, output: 75.07 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:07<00:08, 55.82it/s, est. speed input: 76477.53 toks/s, output: 74.68 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:07<00:08, 55.86it/s, est. speed input: 76099.07 toks/s, output: 74.32 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:07<00:08, 55.87it/s, est. speed input: 75733.33 toks/s, output: 73.96 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:07<00:08, 55.86it/s, est. speed input: 75379.97 toks/s, output: 73.61 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:07<00:08, 55.84it/s, est. speed input: 75038.86 toks/s, output: 73.28 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:07<00:08, 55.83it/s, est. speed input: 74710.10 toks/s, output: 72.96 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:07<00:07, 55.85it/s, est. speed input: 74396.04 toks/s, output: 72.65 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:08<00:07, 55.85it/s, est. speed input: 74092.00 toks/s, output: 72.36 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:08<00:07, 55.86it/s, est. speed input: 73798.86 toks/s, output: 72.07 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:08<00:07, 55.85it/s, est. speed input: 73514.39 toks/s, output: 71.79 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:08<00:07, 55.87it/s, est. speed input: 73241.73 toks/s, output: 71.52 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:08<00:07, 55.85it/s, est. speed input: 72975.80 toks/s, output: 71.27 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:08<00:07, 55.84it/s, est. speed input: 72718.39 toks/s, output: 71.01 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:08<00:06, 55.82it/s, est. speed input: 72468.57 toks/s, output: 70.77 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:09<00:06, 55.85it/s, est. speed input: 72229.60 toks/s, output: 70.54 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:09<00:06, 55.85it/s, est. speed input: 71996.46 toks/s, output: 70.31 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:09<00:06, 55.88it/s, est. speed input: 71772.35 toks/s, output: 70.09 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:09<00:06, 55.86it/s, est. speed input: 71552.95 toks/s, output: 69.88 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:09<00:06, 55.81it/s, est. speed input: 71337.30 toks/s, output: 69.67 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:09<00:06, 55.83it/s, est. speed input: 71131.52 toks/s, output: 69.46 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:09<00:05, 55.85it/s, est. speed input: 70931.73 toks/s, output: 69.27 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:10<00:05, 55.85it/s, est. speed input: 70736.77 toks/s, output: 69.08 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:10<00:05, 55.84it/s, est. speed input: 70546.72 toks/s, output: 68.89 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:10<00:05, 55.79it/s, est. speed input: 70359.63 toks/s, output: 68.71 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:10<00:05, 55.76it/s, est. speed input: 70178.06 toks/s, output: 68.53 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:10<00:05, 55.73it/s, est. speed input: 70000.53 toks/s, output: 68.36 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:10<00:05, 55.75it/s, est. speed input: 69829.87 toks/s, output: 68.19 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:10<00:04, 55.79it/s, est. speed input: 69665.68 toks/s, output: 68.03 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:11<00:04, 55.81it/s, est. speed input: 69504.55 toks/s, output: 67.88 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:11<00:04, 55.80it/s, est. speed input: 69346.52 toks/s, output: 67.72 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:11<00:04, 55.81it/s, est. speed input: 69193.62 toks/s, output: 67.57 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:11<00:04, 55.83it/s, est. speed input: 69044.93 toks/s, output: 67.43 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:11<00:04, 55.79it/s, est. speed input: 68897.48 toks/s, output: 67.28 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:11<00:04, 55.74it/s, est. speed input: 68751.94 toks/s, output: 67.14 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:11<00:03, 55.75it/s, est. speed input: 68612.77 toks/s, output: 67.00 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:13<00:17, 12.11it/s, est. speed input: 59942.39 toks/s, output: 58.54 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:13<00:13, 15.82it/s, est. speed input: 59914.00 toks/s, output: 58.51 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:14<00:09, 20.16it/s, est. speed input: 59886.61 toks/s, output: 58.48 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:14<00:07, 24.94it/s, est. speed input: 59858.87 toks/s, output: 58.46 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [00:14<00:06, 29.89it/s, est. speed input: 59831.16 toks/s, output: 58.43 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [00:14<00:05, 34.73it/s, est. speed input: 59804.67 toks/s, output: 58.40 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:14<00:04, 39.17it/s, est. speed input: 59778.84 toks/s, output: 58.38 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [00:14<00:03, 43.00it/s, est. speed input: 59752.61 toks/s, output: 58.35 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [00:14<00:03, 46.16it/s, est. speed input: 59726.63 toks/s, output: 58.33 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [00:15<00:02, 48.64it/s, est. speed input: 59700.21 toks/s, output: 58.30 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [00:15<00:02, 50.56it/s, est. speed input: 59675.16 toks/s, output: 58.28 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [00:15<00:02, 52.01it/s, est. speed input: 59650.77 toks/s, output: 58.25 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [00:15<00:02, 53.04it/s, est. speed input: 59625.85 toks/s, output: 58.23 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [00:15<00:02, 53.81it/s, est. speed input: 59602.13 toks/s, output: 58.21 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [00:15<00:01, 54.40it/s, est. speed input: 59580.12 toks/s, output: 58.18 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [00:15<00:01, 54.77it/s, est. speed input: 59556.69 toks/s, output: 58.16 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [00:16<00:01, 55.03it/s, est. speed input: 59533.79 toks/s, output: 58.14 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [00:16<00:01, 55.23it/s, est. speed input: 59511.80 toks/s, output: 58.12 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [00:16<00:01, 55.41it/s, est. speed input: 59491.26 toks/s, output: 58.10 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [00:16<00:01, 55.49it/s, est. speed input: 59469.97 toks/s, output: 58.08 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [00:16<00:00, 55.47it/s, est. speed input: 59446.48 toks/s, output: 58.05 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [00:16<00:00, 55.36it/s, est. speed input: 59420.48 toks/s, output: 58.03 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [00:16<00:00, 57.21it/s, est. speed input: 59451.60 toks/s, output: 58.06 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [00:17<00:00, 56.61it/s, est. speed input: 59427.42 toks/s, output: 58.03 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [00:17<00:00, 56.17it/s, est. speed input: 59402.90 toks/s, output: 58.01 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [00:17<00:00, 55.90it/s, est. speed input: 59379.60 toks/s, output: 57.99 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [00:17<00:00, 57.79it/s, est. speed input: 59414.88 toks/s, output: 58.02 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:17<00:00, 57.79it/s, est. speed input: 59764.27 toks/s, output: 58.36 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:17<00:00, 58.36it/s, est. speed input: 59764.27 toks/s, output: 58.36 toks/s]
[rank0]:[W128 11:22:16.959794254 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=16384 ==========
Time: 2026-01-28 11:22:18
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=2048, max_num_seqs=16
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 2048 --max-num-seqs 16 --max-model-len 1025 --max-num-batched-tokens 16384 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/BitNet-2B-INT8_M16384.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-28 11:22:36 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 11:22:37 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=16518) WARNING 01-28 11:22:44 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=16518) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=16518) WARNING 01-28 11:22:55 [backends.py:609] Failed to read file <frozen os>
Throughput: 55.37 requests/s, 56756.52 total tokens/s, 55.37 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048

STDERR:
[2026-01-28 11:22:36] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 11:22:36] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 11:22:36] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 11:22:36] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:22:36] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:22:36] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:22:36] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:22:36] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:22:36] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 11:22:36] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 11:22:36] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 11:22:36] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 11:22:36] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 11:22:36] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 11:22:43] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 11:22:43] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 11:22:43] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 11:22:43] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:22:43] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:22:43] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:22:43] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:22:43] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:22:43] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 11:22:43] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 11:22:43] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 11:22:43] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 11:22:43] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 11:22:43] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=16518) [2026-01-28 11:22:44] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=16518) [2026-01-28 11:22:44] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=16518) [2026-01-28 11:22:44] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=16518) [2026-01-28 11:22:44] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=16518) [2026-01-28 11:22:44] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=16518) [2026-01-28 11:22:44] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=16518) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=16518) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:02<00:00,  2.38s/it]
(EngineCore_DP0 pid=16518) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:02<00:00,  2.38s/it]
(EngineCore_DP0 pid=16518) 
(EngineCore_DP0 pid=16518) [2026-01-28 11:22:47] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 3424] -> 1D uint8
(EngineCore_DP0 pid=16518) [2026-01-28 11:22:47] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9891840 bytes
(EngineCore_DP0 pid=16518) [2026-01-28 11:22:47] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 3424] -> 1D uint8
(EngineCore_DP0 pid=16518) [2026-01-28 11:22:47] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 6594560 bytes
(EngineCore_DP0 pid=16518) [2026-01-28 11:22:47] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 3424] -> 1D uint8
(EngineCore_DP0 pid=16518) [2026-01-28 11:22:47] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 35610624 bytes
(EngineCore_DP0 pid=16518) [2026-01-28 11:22:47] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 9216] -> 1D uint8
(EngineCore_DP0 pid=16518) [2026-01-28 11:22:47] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 17694720 bytes
(EngineCore_DP0 pid=16518) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  14%|█▍        | 1/7 [00:00<00:00,  8.11it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  29%|██▊       | 2/7 [00:00<00:00,  8.27it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  43%|████▎     | 3/7 [00:00<00:00,  8.62it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  57%|█████▋    | 4/7 [00:00<00:00,  8.83it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  71%|███████▏  | 5/7 [00:00<00:00,  8.96it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  86%|████████▌ | 6/7 [00:00<00:00,  8.98it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00,  8.37it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00,  8.56it/s]
(EngineCore_DP0 pid=16518) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  20%|██        | 1/5 [00:00<00:00,  7.52it/s]
Capturing CUDA graphs (decode, FULL):  40%|████      | 2/5 [00:00<00:00,  8.50it/s]
Capturing CUDA graphs (decode, FULL):  60%|██████    | 3/5 [00:00<00:00,  8.96it/s]
Capturing CUDA graphs (decode, FULL):  80%|████████  | 4/5 [00:00<00:00,  9.21it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00,  9.36it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00,  9.05it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 36/2048 [00:00<00:05, 357.94it/s]
Adding requests:   4%|▎         | 75/2048 [00:00<00:05, 372.59it/s]
Adding requests:   6%|▌         | 115/2048 [00:00<00:05, 381.67it/s]
Adding requests:   8%|▊         | 154/2048 [00:00<00:04, 382.15it/s]
Adding requests:   9%|▉         | 193/2048 [00:00<00:04, 381.09it/s]
Adding requests:  11%|█▏        | 234/2048 [00:00<00:04, 387.46it/s]
Adding requests:  13%|█▎        | 274/2048 [00:00<00:04, 391.29it/s]
Adding requests:  15%|█▌        | 314/2048 [00:00<00:04, 387.49it/s]
Adding requests:  17%|█▋        | 354/2048 [00:00<00:04, 390.43it/s]
Adding requests:  19%|█▉        | 394/2048 [00:01<00:04, 391.35it/s]
Adding requests:  21%|██        | 434/2048 [00:01<00:04, 388.92it/s]
Adding requests:  23%|██▎       | 474/2048 [00:01<00:04, 391.27it/s]
Adding requests:  25%|██▌       | 514/2048 [00:01<00:03, 390.83it/s]
Adding requests:  27%|██▋       | 554/2048 [00:01<00:03, 386.68it/s]
Adding requests:  29%|██▉       | 596/2048 [00:01<00:03, 392.13it/s]
Adding requests:  31%|███       | 636/2048 [00:01<00:03, 389.21it/s]
Adding requests:  33%|███▎      | 676/2048 [00:01<00:03, 391.07it/s]
Adding requests:  35%|███▍      | 716/2048 [00:01<00:03, 393.02it/s]
Adding requests:  37%|███▋      | 756/2048 [00:01<00:03, 386.17it/s]
Adding requests:  39%|███▉      | 795/2048 [00:02<00:03, 385.69it/s]
Adding requests:  41%|████      | 834/2048 [00:02<00:03, 383.07it/s]
Adding requests:  43%|████▎     | 873/2048 [00:02<00:03, 380.55it/s]
Adding requests:  45%|████▍     | 915/2048 [00:02<00:02, 391.13it/s]
Adding requests:  47%|████▋     | 956/2048 [00:02<00:02, 395.26it/s]
Adding requests:  49%|████▊     | 996/2048 [00:02<00:02, 395.91it/s]
Adding requests:  51%|█████     | 1038/2048 [00:02<00:02, 401.12it/s]
Adding requests:  53%|█████▎    | 1079/2048 [00:02<00:02, 401.18it/s]
Adding requests:  55%|█████▍    | 1120/2048 [00:02<00:02, 398.00it/s]
Adding requests:  57%|█████▋    | 1163/2048 [00:02<00:02, 404.69it/s]
Adding requests:  59%|█████▉    | 1206/2048 [00:03<00:02, 411.29it/s]
Adding requests:  61%|██████    | 1248/2048 [00:03<00:01, 405.07it/s]
Adding requests:  63%|██████▎   | 1289/2048 [00:03<00:01, 404.28it/s]
Adding requests:  65%|██████▍   | 1331/2048 [00:03<00:01, 406.29it/s]
Adding requests:  67%|██████▋   | 1373/2048 [00:03<00:01, 408.10it/s]
Adding requests:  69%|██████▉   | 1415/2048 [00:03<00:01, 410.57it/s]
Adding requests:  71%|███████   | 1457/2048 [00:03<00:01, 407.79it/s]
Adding requests:  73%|███████▎  | 1499/2048 [00:03<00:01, 410.68it/s]
Adding requests:  75%|███████▌  | 1541/2048 [00:03<00:01, 409.54it/s]
Adding requests:  77%|███████▋  | 1582/2048 [00:04<00:01, 404.36it/s]
Adding requests:  79%|███████▉  | 1624/2048 [00:04<00:01, 407.38it/s]
Adding requests:  81%|████████▏ | 1665/2048 [00:04<00:00, 407.62it/s]
Adding requests:  83%|████████▎ | 1706/2048 [00:04<00:00, 406.50it/s]
Adding requests:  85%|████████▌ | 1747/2048 [00:04<00:00, 406.74it/s]
Adding requests:  87%|████████▋ | 1788/2048 [00:04<00:00, 402.44it/s]
Adding requests:  89%|████████▉ | 1829/2048 [00:04<00:00, 400.94it/s]
Adding requests:  91%|█████████▏| 1870/2048 [00:04<00:00, 399.27it/s]
Adding requests:  93%|█████████▎| 1911/2048 [00:04<00:00, 400.61it/s]
Adding requests:  95%|█████████▌| 1952/2048 [00:04<00:00, 402.93it/s]
Adding requests:  97%|█████████▋| 1993/2048 [00:05<00:00, 403.36it/s]
Adding requests:  99%|█████████▉| 2034/2048 [00:05<00:00, 393.28it/s]
Adding requests: 100%|██████████| 2048/2048 [00:05<00:00, 396.49it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  13%|█▎        | 274/2048 [00:00<00:01, 1418.99it/s, est. speed input: 1453310.44 toks/s, output: 1419.11 toks/s]
Processed prompts:  20%|██        | 416/2048 [00:02<00:11, 137.44it/s, est. speed input: 171305.61 toks/s, output: 167.29 toks/s]   
Processed prompts:  23%|██▎       | 479/2048 [00:03<00:15, 103.91it/s, est. speed input: 134694.18 toks/s, output: 131.54 toks/s]
Processed prompts:  25%|██▌       | 516/2048 [00:04<00:17, 85.58it/s, est. speed input: 117370.42 toks/s, output: 114.62 toks/s] 
Processed prompts:  26%|██▋       | 540/2048 [00:04<00:17, 85.33it/s, est. speed input: 115463.32 toks/s, output: 112.76 toks/s]
Processed prompts:  27%|██▋       | 559/2048 [00:05<00:18, 82.40it/s, est. speed input: 112758.08 toks/s, output: 110.12 toks/s]
Processed prompts:  28%|██▊       | 574/2048 [00:05<00:19, 77.01it/s, est. speed input: 109578.92 toks/s, output: 107.01 toks/s]
Processed prompts:  29%|██▊       | 586/2048 [00:05<00:20, 69.86it/s, est. speed input: 106185.69 toks/s, output: 103.70 toks/s]
Processed prompts:  29%|██▉       | 596/2048 [00:05<00:23, 61.97it/s, est. speed input: 102773.52 toks/s, output: 100.36 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [00:06<00:24, 58.74it/s, est. speed input: 100329.49 toks/s, output: 97.98 toks/s] 
Processed prompts:  31%|███       | 626/2048 [00:08<01:03, 22.23it/s, est. speed input: 77199.50 toks/s, output: 75.39 toks/s] 
Processed prompts:  31%|███▏      | 642/2048 [00:08<00:53, 26.37it/s, est. speed input: 76522.32 toks/s, output: 74.73 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [00:08<00:45, 30.77it/s, est. speed input: 75887.89 toks/s, output: 74.11 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [00:09<00:39, 35.17it/s, est. speed input: 75295.02 toks/s, output: 73.53 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [00:09<00:34, 39.29it/s, est. speed input: 74735.40 toks/s, output: 72.98 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [00:09<00:31, 42.94it/s, est. speed input: 74208.73 toks/s, output: 72.47 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [00:10<00:28, 45.98it/s, est. speed input: 73708.23 toks/s, output: 71.98 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [00:10<00:27, 48.33it/s, est. speed input: 73220.26 toks/s, output: 71.50 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [00:10<00:25, 50.14it/s, est. speed input: 72758.79 toks/s, output: 71.05 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [00:10<00:24, 51.51it/s, est. speed input: 72321.56 toks/s, output: 70.63 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [00:11<00:24, 52.50it/s, est. speed input: 71905.11 toks/s, output: 70.22 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [00:11<00:23, 53.25it/s, est. speed input: 71513.89 toks/s, output: 69.84 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [00:11<00:22, 53.79it/s, est. speed input: 71141.70 toks/s, output: 69.47 toks/s]
Processed prompts:  41%|████      | 834/2048 [00:12<00:22, 54.18it/s, est. speed input: 70787.98 toks/s, output: 69.13 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [00:12<00:22, 54.44it/s, est. speed input: 70448.93 toks/s, output: 68.80 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [00:12<00:21, 54.63it/s, est. speed input: 70126.49 toks/s, output: 68.48 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [00:12<00:21, 54.76it/s, est. speed input: 69817.44 toks/s, output: 68.18 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [00:13<00:20, 54.86it/s, est. speed input: 69522.97 toks/s, output: 67.89 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [00:13<00:20, 54.93it/s, est. speed input: 69242.04 toks/s, output: 67.62 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [00:13<00:20, 54.97it/s, est. speed input: 68971.31 toks/s, output: 67.35 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [00:14<00:20, 55.01it/s, est. speed input: 68712.72 toks/s, output: 67.10 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [00:14<00:19, 55.03it/s, est. speed input: 68464.60 toks/s, output: 66.86 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [00:14<00:19, 55.96it/s, est. speed input: 68299.45 toks/s, output: 66.70 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [00:14<00:18, 55.68it/s, est. speed input: 68067.13 toks/s, output: 66.47 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [00:15<00:18, 55.49it/s, est. speed input: 67844.39 toks/s, output: 66.25 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [00:15<00:18, 55.36it/s, est. speed input: 67629.78 toks/s, output: 66.04 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [00:15<00:18, 55.25it/s, est. speed input: 67421.52 toks/s, output: 65.84 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [00:16<00:17, 55.18it/s, est. speed input: 67221.87 toks/s, output: 65.65 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [00:16<00:17, 55.11it/s, est. speed input: 67027.57 toks/s, output: 65.46 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [00:16<00:17, 55.07it/s, est. speed input: 66840.68 toks/s, output: 65.27 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [00:16<00:17, 55.04it/s, est. speed input: 66659.56 toks/s, output: 65.10 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [00:17<00:16, 55.01it/s, est. speed input: 66484.42 toks/s, output: 64.93 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [00:17<00:16, 55.00it/s, est. speed input: 66315.77 toks/s, output: 64.76 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [00:17<00:15, 55.96it/s, est. speed input: 66214.35 toks/s, output: 64.66 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [00:18<00:15, 55.82it/s, est. speed input: 66065.13 toks/s, output: 64.52 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [00:18<00:15, 55.88it/s, est. speed input: 65930.37 toks/s, output: 64.39 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [00:18<00:15, 55.95it/s, est. speed input: 65801.13 toks/s, output: 64.26 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [00:18<00:14, 55.98it/s, est. speed input: 65674.77 toks/s, output: 64.14 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [00:19<00:14, 56.00it/s, est. speed input: 65552.39 toks/s, output: 64.02 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [00:19<00:14, 56.02it/s, est. speed input: 65433.40 toks/s, output: 63.90 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [00:19<00:13, 56.06it/s, est. speed input: 65319.82 toks/s, output: 63.79 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [00:20<00:13, 56.02it/s, est. speed input: 65205.47 toks/s, output: 63.68 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [00:20<00:13, 56.04it/s, est. speed input: 65096.81 toks/s, output: 63.57 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [00:20<00:13, 56.05it/s, est. speed input: 64990.69 toks/s, output: 63.47 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [00:20<00:12, 56.03it/s, est. speed input: 64886.48 toks/s, output: 63.37 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [00:21<00:12, 56.02it/s, est. speed input: 64785.24 toks/s, output: 63.27 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [00:21<00:12, 56.02it/s, est. speed input: 64687.08 toks/s, output: 63.17 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [00:21<00:11, 56.01it/s, est. speed input: 64590.57 toks/s, output: 63.08 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [00:22<00:11, 56.01it/s, est. speed input: 64497.02 toks/s, output: 62.99 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [00:22<00:11, 56.01it/s, est. speed input: 64406.23 toks/s, output: 62.90 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [00:22<00:11, 56.00it/s, est. speed input: 64317.20 toks/s, output: 62.81 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [00:22<00:10, 56.00it/s, est. speed input: 64230.57 toks/s, output: 62.73 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [00:23<00:10, 56.00it/s, est. speed input: 64145.77 toks/s, output: 62.64 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [00:23<00:10, 56.00it/s, est. speed input: 64063.51 toks/s, output: 62.56 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [00:23<00:09, 55.99it/s, est. speed input: 63982.64 toks/s, output: 62.48 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [00:24<00:09, 55.99it/s, est. speed input: 63903.97 toks/s, output: 62.41 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [00:24<00:09, 56.01it/s, est. speed input: 63827.62 toks/s, output: 62.33 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [00:24<00:09, 56.00it/s, est. speed input: 63752.67 toks/s, output: 62.26 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [00:24<00:08, 55.98it/s, est. speed input: 63678.58 toks/s, output: 62.19 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [00:25<00:08, 55.99it/s, est. speed input: 63606.94 toks/s, output: 62.12 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [00:25<00:08, 55.98it/s, est. speed input: 63536.46 toks/s, output: 62.05 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [00:25<00:07, 55.97it/s, est. speed input: 63467.17 toks/s, output: 61.98 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [00:26<00:07, 55.89it/s, est. speed input: 63396.51 toks/s, output: 61.91 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [00:26<00:07, 55.75it/s, est. speed input: 63324.09 toks/s, output: 61.84 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [00:26<00:07, 55.63it/s, est. speed input: 63252.35 toks/s, output: 61.77 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [00:27<00:06, 55.57it/s, est. speed input: 63182.72 toks/s, output: 61.70 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [00:27<00:06, 55.53it/s, est. speed input: 63114.85 toks/s, output: 61.64 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [00:27<00:06, 55.47it/s, est. speed input: 63047.40 toks/s, output: 61.57 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [00:27<00:06, 55.45it/s, est. speed input: 62981.75 toks/s, output: 61.51 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [00:28<00:05, 55.45it/s, est. speed input: 62918.11 toks/s, output: 61.44 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [00:28<00:05, 55.44it/s, est. speed input: 62855.55 toks/s, output: 61.38 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [00:28<00:05, 55.44it/s, est. speed input: 62794.29 toks/s, output: 61.32 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [00:29<00:04, 55.44it/s, est. speed input: 62734.57 toks/s, output: 61.26 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [00:29<00:04, 55.43it/s, est. speed input: 62675.34 toks/s, output: 61.21 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [00:29<00:04, 55.40it/s, est. speed input: 62616.66 toks/s, output: 61.15 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [00:29<00:04, 55.38it/s, est. speed input: 62559.18 toks/s, output: 61.09 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [00:30<00:03, 55.44it/s, est. speed input: 62505.22 toks/s, output: 61.04 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [00:30<00:03, 55.37it/s, est. speed input: 62448.44 toks/s, output: 60.98 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [00:30<00:03, 56.33it/s, est. speed input: 62427.55 toks/s, output: 60.96 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [00:31<00:02, 56.05it/s, est. speed input: 62374.83 toks/s, output: 60.91 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [00:31<00:02, 55.85it/s, est. speed input: 62322.53 toks/s, output: 60.86 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [00:31<00:02, 55.72it/s, est. speed input: 62271.66 toks/s, output: 60.81 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [00:31<00:01, 55.62it/s, est. speed input: 62221.47 toks/s, output: 60.76 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [00:32<00:01, 55.57it/s, est. speed input: 62172.54 toks/s, output: 60.72 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [00:32<00:01, 55.52it/s, est. speed input: 62124.24 toks/s, output: 60.67 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [00:32<00:01, 55.50it/s, est. speed input: 62077.05 toks/s, output: 60.62 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [00:33<00:00, 55.46it/s, est. speed input: 62030.02 toks/s, output: 60.58 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [00:33<00:00, 55.45it/s, est. speed input: 61984.27 toks/s, output: 60.53 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [00:33<00:00, 56.52it/s, est. speed input: 61973.42 toks/s, output: 60.52 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:33<00:00, 56.52it/s, est. speed input: 62399.33 toks/s, output: 60.94 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:33<00:00, 60.94it/s, est. speed input: 62399.33 toks/s, output: 60.94 toks/s]
[rank0]:[W128 11:23:46.741363310 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=32768 ==========
Time: 2026-01-28 11:23:49
Backend: cuSPARSELt (2:6)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_6
Params: prompt_len=1024, output_len=1, num_prompts=4096, max_num_seqs=32
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_6 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 4096 --max-num-seqs 32 --max-model-len 1025 --max-num-batched-tokens 32768 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/json/BitNet-2B-INT8_M32768.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-28 11:24:18 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 11:24:19 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=17383) WARNING 01-28 11:24:26 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=17383) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=17383) WARNING 01-28 11:24:38 [backends.py:609] Failed to read file <frozen os>
Throughput: 59.23 requests/s, 60713.72 total tokens/s, 59.23 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096

STDERR:
[2026-01-28 11:24:18] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 11:24:18] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 11:24:18] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 11:24:18] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:24:18] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:24:18] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:24:18] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:24:18] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:24:18] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 11:24:18] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 11:24:18] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 11:24:18] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 11:24:18] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 11:24:18] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 11:24:26] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 11:24:26] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 11:24:26] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 11:24:26] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:24:26] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:24:26] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:24:26] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:24:26] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 11:24:26] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 11:24:26] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 11:24:26] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 11:24:26] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 11:24:26] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 11:24:26] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=17383) [2026-01-28 11:24:27] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=17383) [2026-01-28 11:24:27] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=17383) [2026-01-28 11:24:27] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=17383) [2026-01-28 11:24:27] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=17383) [2026-01-28 11:24:27] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=17383) [2026-01-28 11:24:27] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=17383) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=17383) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:02<00:00,  2.46s/it]
(EngineCore_DP0 pid=17383) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:02<00:00,  2.46s/it]
(EngineCore_DP0 pid=17383) 
(EngineCore_DP0 pid=17383) [2026-01-28 11:24:30] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 3424] -> 1D uint8
(EngineCore_DP0 pid=17383) [2026-01-28 11:24:30] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9891840 bytes
(EngineCore_DP0 pid=17383) [2026-01-28 11:24:30] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 3424] -> 1D uint8
(EngineCore_DP0 pid=17383) [2026-01-28 11:24:30] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 6594560 bytes
(EngineCore_DP0 pid=17383) [2026-01-28 11:24:30] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 3424] -> 1D uint8
(EngineCore_DP0 pid=17383) [2026-01-28 11:24:30] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 35610624 bytes
(EngineCore_DP0 pid=17383) [2026-01-28 11:24:30] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 9216] -> 1D uint8
(EngineCore_DP0 pid=17383) [2026-01-28 11:24:30] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 17694720 bytes
(EngineCore_DP0 pid=17383) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   9%|▉         | 1/11 [00:00<00:01,  7.64it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  18%|█▊        | 2/11 [00:00<00:01,  7.96it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  27%|██▋       | 3/11 [00:00<00:00,  8.29it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  36%|███▋      | 4/11 [00:00<00:00,  8.50it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  45%|████▌     | 5/11 [00:00<00:00,  8.57it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  55%|█████▍    | 6/11 [00:00<00:00,  8.64it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  64%|██████▎   | 7/11 [00:00<00:00,  8.70it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  73%|███████▎  | 8/11 [00:00<00:00,  8.84it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  82%|████████▏ | 9/11 [00:01<00:00,  8.80it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  91%|█████████ | 10/11 [00:01<00:00,  8.88it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00,  8.30it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00,  8.49it/s]
(EngineCore_DP0 pid=17383) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  14%|█▍        | 1/7 [00:00<00:00,  7.47it/s]
Capturing CUDA graphs (decode, FULL):  29%|██▊       | 2/7 [00:00<00:00,  8.48it/s]
Capturing CUDA graphs (decode, FULL):  43%|████▎     | 3/7 [00:00<00:00,  8.86it/s]
Capturing CUDA graphs (decode, FULL):  57%|█████▋    | 4/7 [00:00<00:00,  9.13it/s]
Capturing CUDA graphs (decode, FULL):  71%|███████▏  | 5/7 [00:00<00:00,  9.16it/s]
Capturing CUDA graphs (decode, FULL):  86%|████████▌ | 6/7 [00:00<00:00,  9.27it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00,  9.30it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00,  9.06it/s]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   1%|          | 35/4096 [00:00<00:11, 342.98it/s]
Adding requests:   2%|▏         | 72/4096 [00:00<00:11, 356.46it/s]
Adding requests:   3%|▎         | 110/4096 [00:00<00:10, 363.91it/s]
Adding requests:   4%|▎         | 148/4096 [00:00<00:10, 368.86it/s]
Adding requests:   5%|▍         | 187/4096 [00:00<00:10, 375.12it/s]
Adding requests:   5%|▌         | 225/4096 [00:00<00:10, 375.90it/s]
Adding requests:   6%|▋         | 265/4096 [00:00<00:10, 380.95it/s]
Adding requests:   7%|▋         | 304/4096 [00:00<00:10, 374.83it/s]
Adding requests:   8%|▊         | 342/4096 [00:00<00:10, 373.95it/s]
Adding requests:   9%|▉         | 382/4096 [00:01<00:09, 380.76it/s]
Adding requests:  10%|█         | 422/4096 [00:01<00:09, 384.08it/s]
Adding requests:  11%|█▏        | 461/4096 [00:01<00:09, 385.49it/s]
Adding requests:  12%|█▏        | 500/4096 [00:01<00:09, 384.89it/s]
Adding requests:  13%|█▎        | 539/4096 [00:01<00:09, 375.32it/s]
Adding requests:  14%|█▍        | 580/4096 [00:01<00:09, 384.86it/s]
Adding requests:  15%|█▌        | 620/4096 [00:01<00:08, 389.13it/s]
Adding requests:  16%|█▌        | 661/4096 [00:01<00:08, 393.95it/s]
Adding requests:  17%|█▋        | 702/4096 [00:01<00:08, 398.47it/s]
Adding requests:  18%|█▊        | 742/4096 [00:01<00:08, 391.45it/s]
Adding requests:  19%|█▉        | 782/4096 [00:02<00:08, 393.26it/s]
Adding requests:  20%|██        | 822/4096 [00:02<00:08, 385.81it/s]
Adding requests:  21%|██        | 863/4096 [00:02<00:08, 391.35it/s]
Adding requests:  22%|██▏       | 905/4096 [00:02<00:08, 397.08it/s]
Adding requests:  23%|██▎       | 945/4096 [00:02<00:07, 397.17it/s]
Adding requests:  24%|██▍       | 986/4096 [00:02<00:07, 398.56it/s]
Adding requests:  25%|██▌       | 1026/4096 [00:02<00:07, 396.84it/s]
Adding requests:  26%|██▌       | 1066/4096 [00:02<00:07, 397.57it/s]
Adding requests:  27%|██▋       | 1106/4096 [00:02<00:07, 388.37it/s]
Adding requests:  28%|██▊       | 1145/4096 [00:02<00:07, 387.36it/s]
Adding requests:  29%|██▉       | 1184/4096 [00:03<00:07, 380.18it/s]
Adding requests:  30%|██▉       | 1225/4096 [00:03<00:07, 386.23it/s]
Adding requests:  31%|███       | 1265/4096 [00:03<00:07, 388.29it/s]
Adding requests:  32%|███▏      | 1305/4096 [00:03<00:07, 390.72it/s]
Adding requests:  33%|███▎      | 1346/4096 [00:03<00:06, 395.06it/s]
Adding requests:  34%|███▍      | 1386/4096 [00:03<00:06, 396.28it/s]
Adding requests:  35%|███▍      | 1427/4096 [00:03<00:06, 399.66it/s]
Adding requests:  36%|███▌      | 1469/4096 [00:03<00:06, 404.06it/s]
Adding requests:  37%|███▋      | 1510/4096 [00:03<00:06, 405.47it/s]
Adding requests:  38%|███▊      | 1551/4096 [00:03<00:06, 406.30it/s]
Adding requests:  39%|███▉      | 1592/4096 [00:04<00:06, 405.58it/s]
Adding requests:  40%|███▉      | 1634/4096 [00:04<00:06, 408.37it/s]
Adding requests:  41%|████      | 1675/4096 [00:04<00:05, 403.85it/s]
Adding requests:  42%|████▏     | 1717/4096 [00:04<00:05, 406.09it/s]
Adding requests:  43%|████▎     | 1758/4096 [00:04<00:05, 405.64it/s]
Adding requests:  44%|████▍     | 1799/4096 [00:04<00:05, 404.05it/s]
Adding requests:  45%|████▍     | 1840/4096 [00:04<00:05, 398.50it/s]
Adding requests:  46%|████▌     | 1880/4096 [00:04<00:05, 395.74it/s]
Adding requests:  47%|████▋     | 1920/4096 [00:04<00:05, 394.75it/s]
Adding requests:  48%|████▊     | 1960/4096 [00:05<00:05, 396.10it/s]
Adding requests:  49%|████▉     | 2001/4096 [00:05<00:05, 398.57it/s]
Adding requests:  50%|████▉     | 2041/4096 [00:05<00:05, 397.26it/s]
Adding requests:  51%|█████     | 2083/4096 [00:05<00:05, 402.03it/s]
Adding requests:  52%|█████▏    | 2124/4096 [00:05<00:04, 400.29it/s]
Adding requests:  53%|█████▎    | 2165/4096 [00:05<00:04, 395.43it/s]
Adding requests:  54%|█████▍    | 2205/4096 [00:05<00:04, 391.38it/s]
Adding requests:  55%|█████▍    | 2245/4096 [00:05<00:04, 390.43it/s]
Adding requests:  56%|█████▌    | 2285/4096 [00:05<00:04, 389.66it/s]
Adding requests:  57%|█████▋    | 2325/4096 [00:05<00:04, 389.90it/s]
Adding requests:  58%|█████▊    | 2365/4096 [00:06<00:04, 389.89it/s]
Adding requests:  59%|█████▊    | 2404/4096 [00:06<00:04, 380.41it/s]
Adding requests:  60%|█████▉    | 2445/4096 [00:06<00:04, 387.11it/s]
Adding requests:  61%|██████    | 2486/4096 [00:06<00:04, 391.65it/s]
Adding requests:  62%|██████▏   | 2526/4096 [00:06<00:03, 392.61it/s]
Adding requests:  63%|██████▎   | 2568/4096 [00:06<00:03, 398.18it/s]
Adding requests:  64%|██████▎   | 2608/4096 [00:06<00:03, 397.97it/s]
Adding requests:  65%|██████▍   | 2648/4096 [00:06<00:03, 394.36it/s]
Adding requests:  66%|██████▌   | 2688/4096 [00:06<00:03, 390.77it/s]
Adding requests:  67%|██████▋   | 2728/4096 [00:06<00:03, 385.78it/s]
Adding requests:  68%|██████▊   | 2768/4096 [00:07<00:03, 388.64it/s]
Adding requests:  69%|██████▊   | 2808/4096 [00:07<00:03, 389.37it/s]
Adding requests:  70%|██████▉   | 2848/4096 [00:07<00:03, 391.46it/s]
Adding requests:  71%|███████   | 2889/4096 [00:07<00:03, 394.80it/s]
Adding requests:  72%|███████▏  | 2929/4096 [00:07<00:02, 389.64it/s]
Adding requests:  72%|███████▏  | 2969/4096 [00:07<00:02, 391.70it/s]
Adding requests:  73%|███████▎  | 3010/4096 [00:07<00:02, 395.59it/s]
Adding requests:  74%|███████▍  | 3050/4096 [00:07<00:02, 395.44it/s]
Adding requests:  75%|███████▌  | 3090/4096 [00:07<00:02, 387.51it/s]
Adding requests:  76%|███████▋  | 3131/4096 [00:07<00:02, 391.22it/s]
Adding requests:  77%|███████▋  | 3171/4096 [00:08<00:02, 390.87it/s]
Adding requests:  78%|███████▊  | 3211/4096 [00:08<00:02, 390.99it/s]
Adding requests:  79%|███████▉  | 3252/4096 [00:08<00:02, 395.92it/s]
Adding requests:  80%|████████  | 3292/4096 [00:08<00:02, 394.12it/s]
Adding requests:  81%|████████▏ | 3332/4096 [00:08<00:01, 395.28it/s]
Adding requests:  82%|████████▏ | 3372/4096 [00:08<00:01, 391.44it/s]
Adding requests:  83%|████████▎ | 3412/4096 [00:08<00:01, 392.28it/s]
Adding requests:  84%|████████▍ | 3452/4096 [00:08<00:01, 384.22it/s]
Adding requests:  85%|████████▌ | 3491/4096 [00:08<00:01, 382.20it/s]
Adding requests:  86%|████████▌ | 3530/4096 [00:09<00:01, 381.45it/s]
Adding requests:  87%|████████▋ | 3570/4096 [00:09<00:01, 385.85it/s]
Adding requests:  88%|████████▊ | 3611/4096 [00:09<00:01, 390.80it/s]
Adding requests:  89%|████████▉ | 3651/4096 [00:09<00:01, 391.03it/s]
Adding requests:  90%|█████████ | 3691/4096 [00:09<00:01, 391.99it/s]
Adding requests:  91%|█████████ | 3731/4096 [00:09<00:00, 391.44it/s]
Adding requests:  92%|█████████▏| 3771/4096 [00:09<00:00, 382.29it/s]
Adding requests:  93%|█████████▎| 3812/4096 [00:09<00:00, 389.37it/s]
Adding requests:  94%|█████████▍| 3853/4096 [00:09<00:00, 394.43it/s]
Adding requests:  95%|█████████▌| 3894/4096 [00:09<00:00, 396.57it/s]
Adding requests:  96%|█████████▌| 3934/4096 [00:10<00:00, 394.73it/s]
Adding requests:  97%|█████████▋| 3974/4096 [00:10<00:00, 396.17it/s]
Adding requests:  98%|█████████▊| 4015/4096 [00:10<00:00, 397.17it/s]
Adding requests:  99%|█████████▉| 4055/4096 [00:10<00:00, 394.26it/s]
Adding requests: 100%|██████████| 4096/4096 [00:10<00:00, 396.47it/s]
Adding requests: 100%|██████████| 4096/4096 [00:10<00:00, 391.55it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  15%|█▍        | 610/4096 [00:02<00:13, 255.63it/s, est. speed input: 261764.80 toks/s, output: 255.63 toks/s]
Processed prompts:  16%|█▌        | 642/4096 [00:02<00:16, 207.48it/s, est. speed input: 224512.53 toks/s, output: 219.25 toks/s]
Processed prompts:  16%|█▋        | 674/4096 [00:03<00:20, 168.85it/s, est. speed input: 198784.24 toks/s, output: 194.12 toks/s]
Processed prompts:  17%|█▋        | 706/4096 [00:04<00:24, 138.77it/s, est. speed input: 179835.95 toks/s, output: 175.62 toks/s]
Processed prompts:  18%|█▊        | 738/4096 [00:04<00:28, 116.37it/s, est. speed input: 165500.95 toks/s, output: 161.62 toks/s]
Processed prompts:  19%|█▉        | 770/4096 [00:05<00:33, 99.88it/s, est. speed input: 154225.08 toks/s, output: 150.61 toks/s] 
Processed prompts:  20%|█▉        | 802/4096 [00:05<00:37, 87.91it/s, est. speed input: 145122.89 toks/s, output: 141.72 toks/s]
Processed prompts:  20%|██        | 834/4096 [00:06<00:41, 79.30it/s, est. speed input: 137614.06 toks/s, output: 134.39 toks/s]
Processed prompts:  21%|██        | 866/4096 [00:06<00:44, 73.19it/s, est. speed input: 131328.71 toks/s, output: 128.25 toks/s]
Processed prompts:  22%|██▏       | 898/4096 [00:07<00:46, 68.84it/s, est. speed input: 125981.10 toks/s, output: 123.03 toks/s]
Processed prompts:  23%|██▎       | 930/4096 [00:07<00:48, 65.76it/s, est. speed input: 121371.08 toks/s, output: 118.53 toks/s]
Processed prompts:  23%|██▎       | 962/4096 [00:08<00:48, 64.12it/s, est. speed input: 117575.53 toks/s, output: 114.82 toks/s]
Processed prompts:  24%|██▍       | 994/4096 [00:08<00:49, 62.41it/s, est. speed input: 114035.26 toks/s, output: 111.36 toks/s]
Processed prompts:  25%|██▌       | 1026/4096 [00:09<00:50, 61.22it/s, est. speed input: 110902.44 toks/s, output: 108.30 toks/s]
Processed prompts:  26%|██▌       | 1058/4096 [00:10<00:50, 60.37it/s, est. speed input: 108108.92 toks/s, output: 105.57 toks/s]
Processed prompts:  27%|██▋       | 1090/4096 [00:10<00:50, 59.78it/s, est. speed input: 105603.08 toks/s, output: 103.13 toks/s]
Processed prompts:  27%|██▋       | 1122/4096 [00:11<00:49, 59.88it/s, est. speed input: 103493.51 toks/s, output: 101.07 toks/s]
Processed prompts:  28%|██▊       | 1154/4096 [00:11<00:48, 60.57it/s, est. speed input: 101734.26 toks/s, output: 99.35 toks/s] 
Processed prompts:  29%|██▉       | 1186/4096 [00:12<00:48, 60.53it/s, est. speed input: 99998.58 toks/s, output: 97.65 toks/s] 
Processed prompts:  30%|██▉       | 1218/4096 [00:12<00:47, 60.51it/s, est. speed input: 98406.68 toks/s, output: 96.10 toks/s]
Processed prompts:  31%|███       | 1250/4096 [00:13<00:47, 60.50it/s, est. speed input: 96944.67 toks/s, output: 94.67 toks/s]
Processed prompts:  31%|███▏      | 1282/4096 [00:13<00:46, 60.48it/s, est. speed input: 95592.52 toks/s, output: 93.35 toks/s]
Processed prompts:  32%|███▏      | 1314/4096 [00:14<00:46, 60.46it/s, est. speed input: 94341.13 toks/s, output: 92.13 toks/s]
Processed prompts:  33%|███▎      | 1346/4096 [00:14<00:45, 60.45it/s, est. speed input: 93178.00 toks/s, output: 90.99 toks/s]
Processed prompts:  34%|███▎      | 1378/4096 [00:15<00:44, 60.45it/s, est. speed input: 92097.08 toks/s, output: 89.94 toks/s]
Processed prompts:  34%|███▍      | 1410/4096 [00:15<00:44, 60.43it/s, est. speed input: 91085.45 toks/s, output: 88.95 toks/s]
Processed prompts:  35%|███▌      | 1442/4096 [00:16<00:43, 60.42it/s, est. speed input: 90139.49 toks/s, output: 88.03 toks/s]
Processed prompts:  36%|███▌      | 1474/4096 [00:16<00:43, 60.40it/s, est. speed input: 89252.02 toks/s, output: 87.16 toks/s]
Processed prompts:  37%|███▋      | 1506/4096 [00:17<00:42, 60.39it/s, est. speed input: 88418.03 toks/s, output: 86.35 toks/s]
Processed prompts:  38%|███▊      | 1538/4096 [00:17<00:42, 60.37it/s, est. speed input: 87631.25 toks/s, output: 85.58 toks/s]
Processed prompts:  38%|███▊      | 1570/4096 [00:18<00:41, 60.36it/s, est. speed input: 86890.64 toks/s, output: 84.85 toks/s]
Processed prompts:  39%|███▉      | 1602/4096 [00:19<00:41, 60.14it/s, est. speed input: 86161.92 toks/s, output: 84.14 toks/s]
Processed prompts:  40%|███▉      | 1634/4096 [00:19<00:41, 59.81it/s, est. speed input: 85452.00 toks/s, output: 83.45 toks/s]
Processed prompts:  41%|████      | 1666/4096 [00:20<00:40, 59.59it/s, est. speed input: 84780.28 toks/s, output: 82.79 toks/s]
Processed prompts:  41%|████▏     | 1698/4096 [00:20<00:40, 59.52it/s, est. speed input: 84154.23 toks/s, output: 82.18 toks/s]
Processed prompts:  42%|████▏     | 1730/4096 [00:21<00:39, 59.47it/s, est. speed input: 83559.23 toks/s, output: 81.60 toks/s]
Processed prompts:  43%|████▎     | 1762/4096 [00:21<00:39, 59.42it/s, est. speed input: 82992.83 toks/s, output: 81.05 toks/s]
Processed prompts:  44%|████▍     | 1794/4096 [00:22<00:38, 59.39it/s, est. speed input: 82454.52 toks/s, output: 80.52 toks/s]
Processed prompts:  45%|████▍     | 1826/4096 [00:22<00:38, 59.38it/s, est. speed input: 81942.20 toks/s, output: 80.02 toks/s]
Processed prompts:  45%|████▌     | 1858/4096 [00:23<00:37, 59.88it/s, est. speed input: 81507.16 toks/s, output: 79.60 toks/s]
Processed prompts:  46%|████▌     | 1890/4096 [00:23<00:36, 59.72it/s, est. speed input: 81039.05 toks/s, output: 79.14 toks/s]
Processed prompts:  47%|████▋     | 1922/4096 [00:24<00:36, 59.61it/s, est. speed input: 80591.23 toks/s, output: 78.70 toks/s]
Processed prompts:  48%|████▊     | 1954/4096 [00:24<00:35, 59.52it/s, est. speed input: 80162.02 toks/s, output: 78.28 toks/s]
Processed prompts:  48%|████▊     | 1986/4096 [00:25<00:35, 59.45it/s, est. speed input: 79750.44 toks/s, output: 77.88 toks/s]
Processed prompts:  49%|████▉     | 2018/4096 [00:26<00:34, 59.40it/s, est. speed input: 79355.83 toks/s, output: 77.50 toks/s]
Processed prompts:  50%|█████     | 2050/4096 [00:26<00:34, 59.37it/s, est. speed input: 78977.04 toks/s, output: 77.13 toks/s]
Processed prompts:  51%|█████     | 2082/4096 [00:27<00:34, 59.21it/s, est. speed input: 78601.69 toks/s, output: 76.76 toks/s]
Processed prompts:  52%|█████▏    | 2114/4096 [00:27<00:33, 59.07it/s, est. speed input: 78238.57 toks/s, output: 76.40 toks/s]
Processed prompts:  52%|█████▏    | 2146/4096 [00:28<00:33, 58.97it/s, est. speed input: 77889.74 toks/s, output: 76.06 toks/s]
Processed prompts:  53%|█████▎    | 2178/4096 [00:28<00:32, 58.91it/s, est. speed input: 77554.04 toks/s, output: 75.74 toks/s]
Processed prompts:  54%|█████▍    | 2210/4096 [00:29<00:32, 58.87it/s, est. speed input: 77231.44 toks/s, output: 75.42 toks/s]
Processed prompts:  55%|█████▍    | 2242/4096 [00:29<00:31, 58.83it/s, est. speed input: 76919.82 toks/s, output: 75.12 toks/s]
Processed prompts:  56%|█████▌    | 2274/4096 [00:30<00:30, 59.32it/s, est. speed input: 76659.10 toks/s, output: 74.86 toks/s]
Processed prompts:  56%|█████▋    | 2306/4096 [00:30<00:30, 59.16it/s, est. speed input: 76369.19 toks/s, output: 74.58 toks/s]
Processed prompts:  57%|█████▋    | 2338/4096 [00:31<00:29, 59.05it/s, est. speed input: 76089.30 toks/s, output: 74.31 toks/s]
Processed prompts:  58%|█████▊    | 2370/4096 [00:32<00:29, 58.96it/s, est. speed input: 75818.85 toks/s, output: 74.04 toks/s]
Processed prompts:  59%|█████▊    | 2402/4096 [00:32<00:28, 58.90it/s, est. speed input: 75557.07 toks/s, output: 73.79 toks/s]
Processed prompts:  59%|█████▉    | 2434/4096 [00:33<00:28, 58.86it/s, est. speed input: 75303.94 toks/s, output: 73.54 toks/s]
Processed prompts:  60%|██████    | 2466/4096 [00:33<00:27, 58.83it/s, est. speed input: 75059.22 toks/s, output: 73.30 toks/s]
Processed prompts:  61%|██████    | 2498/4096 [00:34<00:26, 59.33it/s, est. speed input: 74856.45 toks/s, output: 73.10 toks/s]
Processed prompts:  62%|██████▏   | 2530/4096 [00:36<00:53, 29.39it/s, est. speed input: 70896.71 toks/s, output: 69.24 toks/s]
Processed prompts:  63%|██████▎   | 2562/4096 [00:37<00:44, 34.45it/s, est. speed input: 70717.44 toks/s, output: 69.06 toks/s]
Processed prompts:  63%|██████▎   | 2594/4096 [00:37<00:38, 39.19it/s, est. speed input: 70547.45 toks/s, output: 68.89 toks/s]
Processed prompts:  64%|██████▍   | 2626/4096 [00:38<00:33, 43.38it/s, est. speed input: 70381.94 toks/s, output: 68.73 toks/s]
Processed prompts:  65%|██████▍   | 2658/4096 [00:38<00:30, 46.87it/s, est. speed input: 70220.67 toks/s, output: 68.57 toks/s]
Processed prompts:  66%|██████▌   | 2690/4096 [00:39<00:28, 49.73it/s, est. speed input: 70068.49 toks/s, output: 68.43 toks/s]
Processed prompts:  66%|██████▋   | 2722/4096 [00:39<00:26, 51.84it/s, est. speed input: 69913.18 toks/s, output: 68.27 toks/s]
Processed prompts:  67%|██████▋   | 2754/4096 [00:40<00:25, 53.50it/s, est. speed input: 69766.17 toks/s, output: 68.13 toks/s]
Processed prompts:  68%|██████▊   | 2786/4096 [00:40<00:23, 54.77it/s, est. speed input: 69626.04 toks/s, output: 67.99 toks/s]
Processed prompts:  69%|██████▉   | 2818/4096 [00:41<00:22, 55.59it/s, est. speed input: 69483.89 toks/s, output: 67.86 toks/s]
Processed prompts:  70%|██████▉   | 2850/4096 [00:42<00:22, 56.24it/s, est. speed input: 69348.77 toks/s, output: 67.72 toks/s]
Processed prompts:  70%|███████   | 2882/4096 [00:42<00:21, 56.69it/s, est. speed input: 69216.49 toks/s, output: 67.59 toks/s]
Processed prompts:  71%|███████   | 2914/4096 [00:43<00:20, 57.02it/s, est. speed input: 69087.92 toks/s, output: 67.47 toks/s]
Processed prompts:  72%|███████▏  | 2946/4096 [00:43<00:20, 57.25it/s, est. speed input: 68962.53 toks/s, output: 67.35 toks/s]
Processed prompts:  73%|███████▎  | 2978/4096 [00:44<00:19, 57.41it/s, est. speed input: 68839.90 toks/s, output: 67.23 toks/s]
Processed prompts:  73%|███████▎  | 3010/4096 [00:44<00:18, 58.09it/s, est. speed input: 68748.55 toks/s, output: 67.14 toks/s]
Processed prompts:  74%|███████▍  | 3042/4096 [00:45<00:17, 58.95it/s, est. speed input: 68676.52 toks/s, output: 67.07 toks/s]
Processed prompts:  75%|███████▌  | 3074/4096 [00:45<00:17, 59.56it/s, est. speed input: 68605.82 toks/s, output: 67.00 toks/s]
Processed prompts:  76%|███████▌  | 3106/4096 [00:46<00:16, 60.00it/s, est. speed input: 68536.97 toks/s, output: 66.93 toks/s]
Processed prompts:  77%|███████▋  | 3138/4096 [00:46<00:15, 60.31it/s, est. speed input: 68469.71 toks/s, output: 66.86 toks/s]
Processed prompts:  77%|███████▋  | 3170/4096 [00:47<00:15, 60.53it/s, est. speed input: 68404.14 toks/s, output: 66.80 toks/s]
Processed prompts:  78%|███████▊  | 3202/4096 [00:47<00:14, 60.69it/s, est. speed input: 68340.05 toks/s, output: 66.74 toks/s]
Processed prompts:  79%|███████▉  | 3234/4096 [00:48<00:14, 60.80it/s, est. speed input: 68277.25 toks/s, output: 66.68 toks/s]
Processed prompts:  80%|███████▉  | 3266/4096 [00:49<00:13, 60.88it/s, est. speed input: 68215.62 toks/s, output: 66.62 toks/s]
Processed prompts:  81%|████████  | 3298/4096 [00:49<00:13, 60.94it/s, est. speed input: 68155.69 toks/s, output: 66.56 toks/s]
Processed prompts:  81%|████████▏ | 3330/4096 [00:50<00:12, 60.97it/s, est. speed input: 68096.56 toks/s, output: 66.50 toks/s]
Processed prompts:  82%|████████▏ | 3362/4096 [00:50<00:12, 61.00it/s, est. speed input: 68038.82 toks/s, output: 66.44 toks/s]
Processed prompts:  83%|████████▎ | 3394/4096 [00:51<00:11, 61.02it/s, est. speed input: 67982.57 toks/s, output: 66.39 toks/s]
Processed prompts:  84%|████████▎ | 3426/4096 [00:51<00:10, 61.02it/s, est. speed input: 67926.80 toks/s, output: 66.33 toks/s]
Processed prompts:  84%|████████▍ | 3458/4096 [00:52<00:10, 61.04it/s, est. speed input: 67872.81 toks/s, output: 66.28 toks/s]
Processed prompts:  85%|████████▌ | 3490/4096 [00:52<00:09, 60.91it/s, est. speed input: 67814.70 toks/s, output: 66.23 toks/s]
Processed prompts:  86%|████████▌ | 3522/4096 [00:53<00:09, 60.57it/s, est. speed input: 67748.41 toks/s, output: 66.16 toks/s]
Processed prompts:  87%|████████▋ | 3554/4096 [00:53<00:08, 60.33it/s, est. speed input: 67683.26 toks/s, output: 66.10 toks/s]
Processed prompts:  88%|████████▊ | 3586/4096 [00:54<00:08, 60.16it/s, est. speed input: 67619.34 toks/s, output: 66.03 toks/s]
Processed prompts:  88%|████████▊ | 3618/4096 [00:54<00:07, 60.04it/s, est. speed input: 67556.80 toks/s, output: 65.97 toks/s]
Processed prompts:  89%|████████▉ | 3650/4096 [00:55<00:07, 60.01it/s, est. speed input: 67497.28 toks/s, output: 65.92 toks/s]
Processed prompts:  90%|████████▉ | 3682/4096 [00:55<00:06, 59.86it/s, est. speed input: 67434.23 toks/s, output: 65.85 toks/s]
Processed prompts:  91%|█████████ | 3714/4096 [00:56<00:06, 60.35it/s, est. speed input: 67393.38 toks/s, output: 65.81 toks/s]
Processed prompts:  91%|█████████▏| 3746/4096 [00:56<00:05, 60.17it/s, est. speed input: 67334.95 toks/s, output: 65.76 toks/s]
Processed prompts:  92%|█████████▏| 3778/4096 [00:57<00:05, 60.05it/s, est. speed input: 67277.94 toks/s, output: 65.70 toks/s]
Processed prompts:  93%|█████████▎| 3810/4096 [00:58<00:04, 59.97it/s, est. speed input: 67222.05 toks/s, output: 65.65 toks/s]
Processed prompts:  94%|█████████▍| 3842/4096 [00:58<00:04, 59.91it/s, est. speed input: 67166.91 toks/s, output: 65.59 toks/s]
Processed prompts:  95%|█████████▍| 3874/4096 [00:59<00:03, 59.86it/s, est. speed input: 67112.90 toks/s, output: 65.54 toks/s]
Processed prompts:  95%|█████████▌| 3906/4096 [00:59<00:03, 59.83it/s, est. speed input: 67059.80 toks/s, output: 65.49 toks/s]
Processed prompts:  96%|█████████▌| 3938/4096 [01:00<00:02, 59.81it/s, est. speed input: 67007.69 toks/s, output: 65.44 toks/s]
Processed prompts:  97%|█████████▋| 3970/4096 [01:00<00:02, 59.65it/s, est. speed input: 66951.53 toks/s, output: 65.38 toks/s]
Processed prompts:  98%|█████████▊| 4002/4096 [01:01<00:01, 59.27it/s, est. speed input: 66887.50 toks/s, output: 65.32 toks/s]
Processed prompts:  98%|█████████▊| 4034/4096 [01:01<00:01, 59.52it/s, est. speed input: 66841.57 toks/s, output: 65.27 toks/s]
Processed prompts:  99%|█████████▉| 4066/4096 [01:02<00:00, 59.86it/s, est. speed input: 66801.71 toks/s, output: 65.24 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [01:02<00:00, 59.86it/s, est. speed input: 67293.98 toks/s, output: 65.72 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [01:02<00:00, 65.72it/s, est. speed input: 67293.98 toks/s, output: 65.72 toks/s]
[rank0]:[W128 11:26:04.142898497 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

