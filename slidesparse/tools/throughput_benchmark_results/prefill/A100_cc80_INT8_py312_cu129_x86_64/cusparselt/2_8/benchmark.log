
========== M=512 ==========
Time: 2026-01-25 17:15:42
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_8
Params: prompt_len=512, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_8 --dataset-name random --input-len 512 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 513 --max-num-batched-tokens 513 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-1B-INT8_M512.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 17:15:50 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=235011) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=235011) WARNING 01-25 17:17:47 [backends.py:609] Failed to read file <frozen os>
Throughput: 19.63 requests/s, 10070.14 total tokens/s, 19.63 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128

STDERR:
[2026-01-25 17:15:50] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:15:50] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 17:15:50] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 17:15:50] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:15:50] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:15:50] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:15:50] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:15:50] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:15:50] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 17:15:50] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:15:50] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:15:50] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:15:50] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:15:50] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 17:15:58] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:15:58] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 17:15:58] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 17:15:58] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:15:58] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:15:58] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:15:58] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:15:58] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:15:58] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 17:15:58] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:15:58] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:15:58] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:15:58] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:15:58] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=235011) [2026-01-25 17:15:59] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=235011) [2026-01-25 17:15:59] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=235011) [2026-01-25 17:15:59] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=235011) [2026-01-25 17:15:59] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=235011) [2026-01-25 17:15:59] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-1B-INT8
(EngineCore_DP0 pid=235011) [2026-01-25 17:15:59] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=235011) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=235011) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [01:42<00:00, 102.78s/it]
(EngineCore_DP0 pid=235011) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [01:42<00:00, 102.78s/it]
(EngineCore_DP0 pid=235011) 
(EngineCore_DP0 pid=235011) [2026-01-25 17:17:42] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 3072] -> 1D uint8
(EngineCore_DP0 pid=235011) [2026-01-25 17:17:42] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7077888 bytes
(EngineCore_DP0 pid=235011) [2026-01-25 17:17:42] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 3072] -> 1D uint8
(EngineCore_DP0 pid=235011) [2026-01-25 17:17:42] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4718592 bytes
(EngineCore_DP0 pid=235011) [2026-01-25 17:17:42] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 3072] -> 1D uint8
(EngineCore_DP0 pid=235011) [2026-01-25 17:17:42] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 37748736 bytes
(EngineCore_DP0 pid=235011) [2026-01-25 17:17:42] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 12288] -> 1D uint8
(EngineCore_DP0 pid=235011) [2026-01-25 17:17:42] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 18874368 bytes
(EngineCore_DP0 pid=235011) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  2.63it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  2.65it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  2.65it/s]
(EngineCore_DP0 pid=235011) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00, 10.10it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  51%|█████     | 65/128 [00:00<00:00, 648.39it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 660.24it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:23,  5.40it/s, est. speed input: 2766.93 toks/s, output: 5.40 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:10, 11.69it/s, est. speed input: 5362.39 toks/s, output: 10.47 toks/s]
Processed prompts:   5%|▍         | 6/128 [00:00<00:07, 15.85it/s, est. speed input: 7090.53 toks/s, output: 13.85 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:00<00:06, 17.93it/s, est. speed input: 8007.52 toks/s, output: 15.64 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:00<00:06, 18.37it/s, est. speed input: 8301.92 toks/s, output: 16.21 toks/s]
Processed prompts:  11%|█         | 14/128 [00:00<00:05, 19.35it/s, est. speed input: 8732.13 toks/s, output: 17.05 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:00<00:05, 20.05it/s, est. speed input: 9058.12 toks/s, output: 17.69 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:01<00:05, 20.29it/s, est. speed input: 9263.28 toks/s, output: 18.09 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:01<00:05, 20.43it/s, est. speed input: 9419.07 toks/s, output: 18.40 toks/s]
Processed prompts:  20%|██        | 26/128 [00:01<00:04, 20.65it/s, est. speed input: 9562.98 toks/s, output: 18.68 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:01<00:04, 20.71it/s, est. speed input: 9666.66 toks/s, output: 18.88 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:01<00:04, 20.86it/s, est. speed input: 9767.46 toks/s, output: 19.08 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:01<00:04, 20.34it/s, est. speed input: 9774.45 toks/s, output: 19.09 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:01<00:04, 20.13it/s, est. speed input: 9797.02 toks/s, output: 19.13 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:02<00:04, 20.31it/s, est. speed input: 9852.69 toks/s, output: 19.24 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:02<00:04, 20.75it/s, est. speed input: 9933.72 toks/s, output: 19.40 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:02<00:03, 21.11it/s, est. speed input: 10008.88 toks/s, output: 19.55 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:02<00:03, 21.13it/s, est. speed input: 10055.42 toks/s, output: 19.64 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:02<00:03, 21.08it/s, est. speed input: 10091.26 toks/s, output: 19.71 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:02<00:03, 21.03it/s, est. speed input: 10122.67 toks/s, output: 19.77 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:02<00:03, 21.11it/s, est. speed input: 10159.65 toks/s, output: 19.84 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:03<00:03, 21.27it/s, est. speed input: 10200.81 toks/s, output: 19.92 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:03<00:02, 21.34it/s, est. speed input: 10235.40 toks/s, output: 19.99 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:03<00:02, 21.37it/s, est. speed input: 10266.26 toks/s, output: 20.05 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:03<00:02, 20.97it/s, est. speed input: 10266.99 toks/s, output: 20.05 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:03<00:02, 20.51it/s, est. speed input: 10255.85 toks/s, output: 20.03 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:03<00:02, 20.57it/s, est. speed input: 10268.84 toks/s, output: 20.06 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:03<00:02, 20.47it/s, est. speed input: 10272.12 toks/s, output: 20.06 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:04<00:02, 20.04it/s, est. speed input: 10253.51 toks/s, output: 20.03 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:04<00:02, 20.44it/s, est. speed input: 10277.10 toks/s, output: 20.07 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:04<00:01, 20.50it/s, est. speed input: 10286.45 toks/s, output: 20.09 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:04<00:01, 20.78it/s, est. speed input: 10308.28 toks/s, output: 20.13 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:04<00:01, 20.62it/s, est. speed input: 10310.10 toks/s, output: 20.14 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:04<00:01, 20.84it/s, est. speed input: 10328.18 toks/s, output: 20.17 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:05<00:01, 20.56it/s, est. speed input: 10324.62 toks/s, output: 20.17 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:05<00:01, 20.28it/s, est. speed input: 10316.82 toks/s, output: 20.15 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:05<00:01, 20.66it/s, est. speed input: 10336.35 toks/s, output: 20.19 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:05<00:00, 20.67it/s, est. speed input: 10343.32 toks/s, output: 20.20 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:05<00:00, 20.60it/s, est. speed input: 10346.64 toks/s, output: 20.21 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:05<00:00, 20.48it/s, est. speed input: 10346.51 toks/s, output: 20.21 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:05<00:00, 20.45it/s, est. speed input: 10348.56 toks/s, output: 20.21 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:06<00:00, 20.83it/s, est. speed input: 10366.98 toks/s, output: 20.25 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:06<00:00, 20.64it/s, est. speed input: 10366.35 toks/s, output: 20.25 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:06<00:00, 20.37it/s, est. speed input: 10360.72 toks/s, output: 20.24 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:06<00:00, 20.37it/s, est. speed input: 10360.72 toks/s, output: 20.24 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:06<00:00, 20.23it/s, est. speed input: 10360.72 toks/s, output: 20.24 toks/s]
[rank0]:[W125 17:18:06.830216798 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=1024 ==========
Time: 2026-01-25 17:18:08
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 1025 --max-num-batched-tokens 1025 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-1B-INT8_M1024.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 17:18:16 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=237317) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=237317) WARNING 01-25 17:18:30 [backends.py:609] Failed to read file <frozen os>
Throughput: 20.26 requests/s, 20762.52 total tokens/s, 20.26 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128

STDERR:
[2026-01-25 17:18:16] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:18:16] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 17:18:16] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 17:18:16] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:18:16] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:18:16] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:18:16] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:18:16] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:18:16] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 17:18:16] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:18:16] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:18:16] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:18:16] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:18:16] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 17:18:23] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:18:23] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 17:18:23] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 17:18:23] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:18:23] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:18:23] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:18:23] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:18:23] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:18:23] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 17:18:23] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:18:23] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:18:23] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:18:23] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:18:23] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=237317) [2026-01-25 17:18:24] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=237317) [2026-01-25 17:18:24] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=237317) [2026-01-25 17:18:24] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=237317) [2026-01-25 17:18:24] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=237317) [2026-01-25 17:18:24] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-1B-INT8
(EngineCore_DP0 pid=237317) [2026-01-25 17:18:24] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=237317) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=237317) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.09it/s]
(EngineCore_DP0 pid=237317) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.09it/s]
(EngineCore_DP0 pid=237317) 
(EngineCore_DP0 pid=237317) [2026-01-25 17:18:25] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 3072] -> 1D uint8
(EngineCore_DP0 pid=237317) [2026-01-25 17:18:25] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7077888 bytes
(EngineCore_DP0 pid=237317) [2026-01-25 17:18:25] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 3072] -> 1D uint8
(EngineCore_DP0 pid=237317) [2026-01-25 17:18:25] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4718592 bytes
(EngineCore_DP0 pid=237317) [2026-01-25 17:18:25] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 3072] -> 1D uint8
(EngineCore_DP0 pid=237317) [2026-01-25 17:18:25] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 37748736 bytes
(EngineCore_DP0 pid=237317) [2026-01-25 17:18:25] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 12288] -> 1D uint8
(EngineCore_DP0 pid=237317) [2026-01-25 17:18:25] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 18874368 bytes
(EngineCore_DP0 pid=237317) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00, 11.50it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00, 11.49it/s]
(EngineCore_DP0 pid=237317) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00, 10.39it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  29%|██▉       | 37/128 [00:00<00:00, 363.04it/s]
Adding requests:  59%|█████▊    | 75/128 [00:00<00:00, 370.72it/s]
Adding requests:  88%|████████▊ | 113/128 [00:00<00:00, 360.59it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 358.99it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:02, 43.40it/s, est. speed input: 44448.48 toks/s, output: 43.40 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:00<00:04, 26.05it/s, est. speed input: 28378.95 toks/s, output: 27.71 toks/s]
Processed prompts:  10%|█         | 13/128 [00:00<00:04, 24.45it/s, est. speed input: 26707.64 toks/s, output: 26.08 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:00<00:04, 23.08it/s, est. speed input: 25453.89 toks/s, output: 24.86 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:00<00:04, 22.21it/s, est. speed input: 24635.17 toks/s, output: 24.06 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:00<00:04, 21.90it/s, est. speed input: 24198.61 toks/s, output: 23.63 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:01<00:04, 21.80it/s, est. speed input: 23925.31 toks/s, output: 23.36 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:01<00:04, 21.78it/s, est. speed input: 23734.05 toks/s, output: 23.18 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:01<00:04, 21.79it/s, est. speed input: 23593.04 toks/s, output: 23.04 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:01<00:04, 21.83it/s, est. speed input: 23487.41 toks/s, output: 22.94 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:01<00:04, 21.46it/s, est. speed input: 23278.89 toks/s, output: 22.73 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:01<00:04, 21.32it/s, est. speed input: 23134.78 toks/s, output: 22.59 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:01<00:04, 20.48it/s, est. speed input: 22809.59 toks/s, output: 22.27 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:02<00:04, 20.39it/s, est. speed input: 22655.53 toks/s, output: 22.12 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:02<00:03, 20.60it/s, est. speed input: 22590.67 toks/s, output: 22.06 toks/s]
Processed prompts:  41%|████      | 52/128 [00:02<00:03, 20.67it/s, est. speed input: 22514.34 toks/s, output: 21.99 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:02<00:03, 21.01it/s, est. speed input: 22506.96 toks/s, output: 21.98 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:02<00:03, 20.95it/s, est. speed input: 22441.40 toks/s, output: 21.92 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:02<00:03, 20.72it/s, est. speed input: 22348.38 toks/s, output: 21.82 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:02<00:03, 20.80it/s, est. speed input: 22305.76 toks/s, output: 21.78 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:03<00:02, 21.09it/s, est. speed input: 22306.67 toks/s, output: 21.78 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:03<00:02, 21.26it/s, est. speed input: 22302.40 toks/s, output: 21.78 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:03<00:02, 21.15it/s, est. speed input: 22263.44 toks/s, output: 21.74 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:03<00:02, 21.46it/s, est. speed input: 22282.03 toks/s, output: 21.76 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:03<00:02, 21.54it/s, est. speed input: 22281.41 toks/s, output: 21.76 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:03<00:02, 21.38it/s, est. speed input: 22252.95 toks/s, output: 21.73 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:03<00:02, 21.04it/s, est. speed input: 22197.13 toks/s, output: 21.68 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:04<00:01, 20.76it/s, est. speed input: 22139.56 toks/s, output: 21.62 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:04<00:01, 20.93it/s, est. speed input: 22129.73 toks/s, output: 21.61 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:04<00:01, 21.11it/s, est. speed input: 22127.83 toks/s, output: 21.61 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:04<00:01, 21.30it/s, est. speed input: 22131.87 toks/s, output: 21.61 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:04<00:01, 21.53it/s, est. speed input: 22146.47 toks/s, output: 21.63 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:04<00:01, 21.39it/s, est. speed input: 22129.41 toks/s, output: 21.61 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:04<00:01, 21.45it/s, est. speed input: 22128.77 toks/s, output: 21.61 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:05<00:00, 20.90it/s, est. speed input: 22070.74 toks/s, output: 21.55 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:05<00:00, 20.79it/s, est. speed input: 22041.68 toks/s, output: 21.53 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:05<00:00, 21.12it/s, est. speed input: 22052.41 toks/s, output: 21.54 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:05<00:00, 21.36it/s, est. speed input: 22063.00 toks/s, output: 21.55 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:05<00:00, 21.41it/s, est. speed input: 22062.71 toks/s, output: 21.55 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:05<00:00, 20.80it/s, est. speed input: 22007.06 toks/s, output: 21.49 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:05<00:00, 20.80it/s, est. speed input: 21989.81 toks/s, output: 21.47 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:05<00:00, 20.80it/s, est. speed input: 21987.93 toks/s, output: 21.47 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:05<00:00, 21.47it/s, est. speed input: 21987.93 toks/s, output: 21.47 toks/s]
[rank0]:[W125 17:18:48.574093404 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=2048 ==========
Time: 2026-01-25 17:18:50
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=256, max_num_seqs=2
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 256 --max-num-seqs 2 --max-model-len 1025 --max-num-batched-tokens 2048 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-1B-INT8_M2048.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 17:18:58 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=238152) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=238152) WARNING 01-25 17:19:12 [backends.py:609] Failed to read file <frozen os>
Throughput: 39.77 requests/s, 40767.61 total tokens/s, 39.77 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256

STDERR:
[2026-01-25 17:18:58] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:18:58] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 17:18:58] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 17:18:58] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:18:58] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:18:58] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:18:58] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:18:58] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:18:58] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 17:18:58] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:18:58] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:18:58] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:18:58] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:18:58] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 17:19:06] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:19:06] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 17:19:06] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 17:19:06] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:19:06] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:19:06] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:19:06] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:19:06] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:19:06] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 17:19:06] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:19:06] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:19:06] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:19:06] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:19:06] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=238152) [2026-01-25 17:19:07] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=238152) [2026-01-25 17:19:07] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=238152) [2026-01-25 17:19:07] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=238152) [2026-01-25 17:19:07] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=238152) [2026-01-25 17:19:07] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-1B-INT8
(EngineCore_DP0 pid=238152) [2026-01-25 17:19:07] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=238152) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=238152) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.28it/s]
(EngineCore_DP0 pid=238152) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.28it/s]
(EngineCore_DP0 pid=238152) 
(EngineCore_DP0 pid=238152) [2026-01-25 17:19:07] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 3072] -> 1D uint8
(EngineCore_DP0 pid=238152) [2026-01-25 17:19:07] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7077888 bytes
(EngineCore_DP0 pid=238152) [2026-01-25 17:19:07] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 3072] -> 1D uint8
(EngineCore_DP0 pid=238152) [2026-01-25 17:19:07] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4718592 bytes
(EngineCore_DP0 pid=238152) [2026-01-25 17:19:07] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 3072] -> 1D uint8
(EngineCore_DP0 pid=238152) [2026-01-25 17:19:07] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 37748736 bytes
(EngineCore_DP0 pid=238152) [2026-01-25 17:19:07] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 12288] -> 1D uint8
(EngineCore_DP0 pid=238152) [2026-01-25 17:19:07] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 18874368 bytes
(EngineCore_DP0 pid=238152) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  67%|██████▋   | 2/3 [00:00<00:00, 12.11it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00, 11.31it/s]
(EngineCore_DP0 pid=238152) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 1/2 [00:00<00:00,  9.52it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00, 10.60it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  14%|█▍        | 36/256 [00:00<00:00, 357.96it/s]
Adding requests:  29%|██▊       | 73/256 [00:00<00:00, 360.44it/s]
Adding requests:  43%|████▎     | 110/256 [00:00<00:00, 353.41it/s]
Adding requests:  57%|█████▋    | 146/256 [00:00<00:00, 350.25it/s]
Adding requests:  71%|███████   | 182/256 [00:00<00:00, 343.26it/s]
Adding requests:  85%|████████▍ | 217/256 [00:00<00:00, 342.97it/s]
Adding requests:  99%|█████████▉| 254/256 [00:00<00:00, 349.59it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 349.38it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  10%|█         | 26/256 [00:00<00:01, 181.99it/s, est. speed input: 186376.18 toks/s, output: 181.99 toks/s]
Processed prompts:  18%|█▊        | 45/256 [00:00<00:02, 71.73it/s, est. speed input: 82071.36 toks/s, output: 80.15 toks/s]   
Processed prompts:  22%|██▏       | 56/256 [00:00<00:03, 57.48it/s, est. speed input: 68042.59 toks/s, output: 66.45 toks/s]
Processed prompts:  25%|██▌       | 64/256 [00:01<00:03, 51.40it/s, est. speed input: 62312.05 toks/s, output: 60.85 toks/s]
Processed prompts:  27%|██▋       | 70/256 [00:01<00:03, 48.28it/s, est. speed input: 59440.58 toks/s, output: 58.05 toks/s]
Processed prompts:  30%|██▉       | 76/256 [00:01<00:03, 46.04it/s, est. speed input: 57342.52 toks/s, output: 56.00 toks/s]
Processed prompts:  32%|███▏      | 82/256 [00:01<00:03, 45.40it/s, est. speed input: 56161.59 toks/s, output: 54.84 toks/s]
Processed prompts:  34%|███▍      | 88/256 [00:01<00:03, 44.75it/s, est. speed input: 55123.96 toks/s, output: 53.83 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:01<00:03, 44.25it/s, est. speed input: 54243.94 toks/s, output: 52.97 toks/s]
Processed prompts:  39%|███▉      | 100/256 [00:01<00:03, 43.81it/s, est. speed input: 53472.03 toks/s, output: 52.22 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:02<00:03, 43.45it/s, est. speed input: 52795.10 toks/s, output: 51.56 toks/s]
Processed prompts:  44%|████▍     | 112/256 [00:02<00:03, 42.72it/s, est. speed input: 52079.35 toks/s, output: 50.86 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:02<00:03, 42.60it/s, est. speed input: 51548.34 toks/s, output: 50.34 toks/s]
Processed prompts:  48%|████▊     | 124/256 [00:02<00:03, 42.62it/s, est. speed input: 51103.76 toks/s, output: 49.91 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:02<00:02, 42.76it/s, est. speed input: 50733.77 toks/s, output: 49.54 toks/s]
Processed prompts:  53%|█████▎    | 136/256 [00:02<00:02, 42.79it/s, est. speed input: 50387.72 toks/s, output: 49.21 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:02<00:02, 42.43it/s, est. speed input: 50001.50 toks/s, output: 48.83 toks/s]
Processed prompts:  58%|█████▊    | 148/256 [00:03<00:02, 42.33it/s, est. speed input: 49679.07 toks/s, output: 48.51 toks/s]
Processed prompts:  60%|█████▉    | 153/256 [00:03<00:02, 43.65it/s, est. speed input: 49655.78 toks/s, output: 48.49 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:03<00:02, 39.93it/s, est. speed input: 48897.33 toks/s, output: 47.75 toks/s]
Processed prompts:  64%|██████▍   | 164/256 [00:03<00:02, 40.60it/s, est. speed input: 48659.51 toks/s, output: 47.52 toks/s]
Processed prompts:  66%|██████▌   | 169/256 [00:03<00:02, 42.58it/s, est. speed input: 48698.68 toks/s, output: 47.56 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:03<00:02, 40.36it/s, est. speed input: 48234.07 toks/s, output: 47.10 toks/s]
Processed prompts:  70%|███████   | 180/256 [00:03<00:01, 41.09it/s, est. speed input: 48068.96 toks/s, output: 46.94 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:03<00:01, 41.03it/s, est. speed input: 47840.67 toks/s, output: 46.72 toks/s]
Processed prompts:  75%|███████▌  | 192/256 [00:04<00:01, 41.55it/s, est. speed input: 47702.26 toks/s, output: 46.58 toks/s]
Processed prompts:  77%|███████▋  | 197/256 [00:04<00:01, 42.62it/s, est. speed input: 47681.38 toks/s, output: 46.56 toks/s]
Processed prompts:  79%|███████▉  | 202/256 [00:04<00:01, 38.91it/s, est. speed input: 47137.35 toks/s, output: 46.03 toks/s]
Processed prompts:  81%|████████▏ | 208/256 [00:04<00:01, 39.50it/s, est. speed input: 46964.23 toks/s, output: 45.86 toks/s]
Processed prompts:  83%|████████▎ | 212/256 [00:04<00:01, 39.47it/s, est. speed input: 46818.74 toks/s, output: 45.72 toks/s]
Processed prompts:  85%|████████▌ | 218/256 [00:04<00:00, 40.16it/s, est. speed input: 46691.20 toks/s, output: 45.60 toks/s]
Processed prompts:  88%|████████▊ | 224/256 [00:04<00:00, 40.64it/s, est. speed input: 46574.32 toks/s, output: 45.48 toks/s]
Processed prompts:  89%|████████▉ | 229/256 [00:05<00:00, 42.72it/s, est. speed input: 46652.12 toks/s, output: 45.56 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:05<00:00, 40.57it/s, est. speed input: 46389.26 toks/s, output: 45.30 toks/s]
Processed prompts:  93%|█████████▎| 239/256 [00:05<00:00, 42.20it/s, est. speed input: 46420.42 toks/s, output: 45.33 toks/s]
Processed prompts:  95%|█████████▌| 244/256 [00:05<00:00, 39.36it/s, est. speed input: 46100.54 toks/s, output: 45.02 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:05<00:00, 40.34it/s, est. speed input: 46033.42 toks/s, output: 44.95 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:05<00:00, 41.01it/s, est. speed input: 45970.98 toks/s, output: 44.89 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:05<00:00, 41.01it/s, est. speed input: 45970.98 toks/s, output: 44.89 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:05<00:00, 44.89it/s, est. speed input: 45970.98 toks/s, output: 44.89 toks/s]
[rank0]:[W125 17:19:30.345613805 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=4096 ==========
Time: 2026-01-25 17:19:32
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=512, max_num_seqs=4
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 512 --max-num-seqs 4 --max-model-len 1025 --max-num-batched-tokens 4096 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-1B-INT8_M4096.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 17:19:42 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=239009) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=239009) WARNING 01-25 17:19:57 [backends.py:609] Failed to read file <frozen os>
Throughput: 77.15 requests/s, 79073.71 total tokens/s, 77.15 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512

STDERR:
[2026-01-25 17:19:42] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:19:42] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 17:19:42] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 17:19:42] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:19:42] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:19:42] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:19:42] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:19:42] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:19:42] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 17:19:42] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:19:42] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:19:42] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:19:42] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:19:42] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 17:19:50] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:19:50] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 17:19:50] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 17:19:50] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:19:50] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:19:50] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:19:50] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:19:50] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:19:50] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 17:19:50] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:19:50] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:19:50] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:19:50] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:19:50] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=239009) [2026-01-25 17:19:51] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=239009) [2026-01-25 17:19:51] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=239009) [2026-01-25 17:19:51] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=239009) [2026-01-25 17:19:51] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=239009) [2026-01-25 17:19:51] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-1B-INT8
(EngineCore_DP0 pid=239009) [2026-01-25 17:19:51] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=239009) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=239009) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.18it/s]
(EngineCore_DP0 pid=239009) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.17it/s]
(EngineCore_DP0 pid=239009) 
(EngineCore_DP0 pid=239009) [2026-01-25 17:19:52] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 3072] -> 1D uint8
(EngineCore_DP0 pid=239009) [2026-01-25 17:19:52] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7077888 bytes
(EngineCore_DP0 pid=239009) [2026-01-25 17:19:52] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 3072] -> 1D uint8
(EngineCore_DP0 pid=239009) [2026-01-25 17:19:52] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4718592 bytes
(EngineCore_DP0 pid=239009) [2026-01-25 17:19:52] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 3072] -> 1D uint8
(EngineCore_DP0 pid=239009) [2026-01-25 17:19:52] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 37748736 bytes
(EngineCore_DP0 pid=239009) [2026-01-25 17:19:52] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 12288] -> 1D uint8
(EngineCore_DP0 pid=239009) [2026-01-25 17:19:52] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 18874368 bytes
(EngineCore_DP0 pid=239009) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 2/4 [00:00<00:00, 12.01it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00, 11.86it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00, 11.87it/s]
(EngineCore_DP0 pid=239009) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  67%|██████▋   | 2/3 [00:00<00:00, 11.70it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00, 12.07it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   7%|▋         | 36/512 [00:00<00:01, 354.55it/s]
Adding requests:  14%|█▍        | 72/512 [00:00<00:01, 354.84it/s]
Adding requests:  21%|██        | 108/512 [00:00<00:01, 351.70it/s]
Adding requests:  28%|██▊       | 144/512 [00:00<00:01, 354.63it/s]
Adding requests:  35%|███▌      | 180/512 [00:00<00:00, 353.70it/s]
Adding requests:  42%|████▏     | 216/512 [00:00<00:00, 351.51it/s]
Adding requests:  50%|████▉     | 255/512 [00:00<00:00, 361.21it/s]
Adding requests:  57%|█████▋    | 292/512 [00:00<00:00, 361.09it/s]
Adding requests:  64%|██████▍   | 329/512 [00:00<00:00, 354.20it/s]
Adding requests:  71%|███████▏  | 365/512 [00:01<00:00, 354.33it/s]
Adding requests:  79%|███████▊  | 402/512 [00:01<00:00, 358.77it/s]
Adding requests:  86%|████████▌ | 439/512 [00:01<00:00, 360.66it/s]
Adding requests:  93%|█████████▎| 476/512 [00:01<00:00, 357.83it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 355.16it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 356.10it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  18%|█▊        | 94/512 [00:00<00:00, 874.32it/s, est. speed input: 895453.67 toks/s, output: 874.36 toks/s]
Processed prompts:  36%|███▌      | 182/512 [00:01<00:02, 134.55it/s, est. speed input: 158571.98 toks/s, output: 154.85 toks/s]
Processed prompts:  44%|████▎     | 223/512 [00:01<00:02, 115.08it/s, est. speed input: 136987.44 toks/s, output: 133.78 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:02<00:02, 105.25it/s, est. speed input: 127494.77 toks/s, output: 124.51 toks/s]
Processed prompts:  53%|█████▎    | 269/512 [00:02<00:02, 104.87it/s, est. speed input: 125649.18 toks/s, output: 122.70 toks/s]
Processed prompts:  56%|█████▌    | 285/512 [00:02<00:02, 100.81it/s, est. speed input: 122583.46 toks/s, output: 119.71 toks/s]
Processed prompts:  58%|█████▊    | 299/512 [00:02<00:02, 93.26it/s, est. speed input: 118516.55 toks/s, output: 115.74 toks/s] 
Processed prompts:  61%|██████    | 311/512 [00:02<00:02, 90.75it/s, est. speed input: 116559.68 toks/s, output: 113.83 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:02<00:02, 86.61it/s, est. speed input: 114326.37 toks/s, output: 111.65 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:03<00:02, 85.48it/s, est. speed input: 112850.39 toks/s, output: 110.20 toks/s]
Processed prompts:  67%|██████▋   | 343/512 [00:03<00:01, 85.38it/s, est. speed input: 111977.24 toks/s, output: 109.35 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:03<00:01, 83.49it/s, est. speed input: 110620.95 toks/s, output: 108.03 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:03<00:01, 83.14it/s, est. speed input: 109496.70 toks/s, output: 106.93 toks/s]
Processed prompts:  73%|███████▎  | 375/512 [00:03<00:01, 84.22it/s, est. speed input: 108932.59 toks/s, output: 106.38 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [00:03<00:01, 81.65it/s, est. speed input: 107704.07 toks/s, output: 105.18 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [00:03<00:01, 82.12it/s, est. speed input: 106852.97 toks/s, output: 104.35 toks/s]
Processed prompts:  80%|████████  | 410/512 [00:03<00:01, 82.08it/s, est. speed input: 106006.13 toks/s, output: 103.52 toks/s]
Processed prompts:  82%|████████▏ | 419/512 [00:04<00:01, 82.92it/s, est. speed input: 105530.09 toks/s, output: 103.06 toks/s]
Processed prompts:  84%|████████▎ | 428/512 [00:04<00:00, 84.11it/s, est. speed input: 105142.64 toks/s, output: 102.68 toks/s]
Processed prompts:  85%|████████▌ | 437/512 [00:04<00:00, 83.72it/s, est. speed input: 104621.63 toks/s, output: 102.17 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [00:04<00:00, 75.84it/s, est. speed input: 103220.31 toks/s, output: 100.80 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [00:04<00:00, 76.47it/s, est. speed input: 102699.45 toks/s, output: 100.29 toks/s]
Processed prompts:  91%|█████████ | 466/512 [00:04<00:00, 78.16it/s, est. speed input: 102088.20 toks/s, output: 99.70 toks/s] 
Processed prompts:  93%|█████████▎| 478/512 [00:04<00:00, 80.14it/s, est. speed input: 101621.58 toks/s, output: 99.24 toks/s]
Processed prompts:  95%|█████████▌| 487/512 [00:04<00:00, 82.54it/s, est. speed input: 101428.06 toks/s, output: 99.05 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [00:05<00:00, 81.21it/s, est. speed input: 100844.88 toks/s, output: 98.48 toks/s]
Processed prompts: 100%|█████████▉| 510/512 [00:05<00:00, 82.51it/s, est. speed input: 100478.45 toks/s, output: 98.12 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:05<00:00, 82.51it/s, est. speed input: 100868.32 toks/s, output: 98.50 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:05<00:00, 98.50it/s, est. speed input: 100868.32 toks/s, output: 98.50 toks/s]
[rank0]:[W125 17:20:15.221683966 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=8192 ==========
Time: 2026-01-25 17:20:17
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=1024, max_num_seqs=8
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 1024 --max-num-seqs 8 --max-model-len 1025 --max-num-batched-tokens 8192 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-1B-INT8_M8192.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 17:20:30 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=239902) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=239902) WARNING 01-25 17:20:44 [backends.py:609] Failed to read file <frozen os>
Throughput: 122.86 requests/s, 125928.31 total tokens/s, 122.86 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024

STDERR:
[2026-01-25 17:20:30] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:20:30] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 17:20:30] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 17:20:30] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:20:30] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:20:30] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:20:30] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:20:30] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:20:30] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 17:20:30] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:20:30] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:20:30] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:20:30] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:20:30] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 17:20:38] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:20:38] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 17:20:38] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 17:20:38] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:20:38] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:20:38] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:20:38] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:20:38] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:20:38] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 17:20:38] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:20:38] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:20:38] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:20:38] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:20:38] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=239902) [2026-01-25 17:20:39] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=239902) [2026-01-25 17:20:39] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=239902) [2026-01-25 17:20:39] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=239902) [2026-01-25 17:20:39] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=239902) [2026-01-25 17:20:39] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-1B-INT8
(EngineCore_DP0 pid=239902) [2026-01-25 17:20:39] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=239902) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=239902) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.26it/s]
(EngineCore_DP0 pid=239902) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.26it/s]
(EngineCore_DP0 pid=239902) 
(EngineCore_DP0 pid=239902) [2026-01-25 17:20:39] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 3072] -> 1D uint8
(EngineCore_DP0 pid=239902) [2026-01-25 17:20:39] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7077888 bytes
(EngineCore_DP0 pid=239902) [2026-01-25 17:20:39] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 3072] -> 1D uint8
(EngineCore_DP0 pid=239902) [2026-01-25 17:20:39] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4718592 bytes
(EngineCore_DP0 pid=239902) [2026-01-25 17:20:39] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 3072] -> 1D uint8
(EngineCore_DP0 pid=239902) [2026-01-25 17:20:39] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 37748736 bytes
(EngineCore_DP0 pid=239902) [2026-01-25 17:20:39] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 12288] -> 1D uint8
(EngineCore_DP0 pid=239902) [2026-01-25 17:20:39] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 18874368 bytes
(EngineCore_DP0 pid=239902) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:00,  4.43it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  60%|██████    | 3/5 [00:00<00:00,  8.60it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00,  9.58it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00,  8.80it/s]
(EngineCore_DP0 pid=239902) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 2/4 [00:00<00:00, 10.85it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00, 11.58it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00, 11.46it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   3%|▎         | 35/1024 [00:00<00:02, 348.72it/s]
Adding requests:   7%|▋         | 72/1024 [00:00<00:02, 360.99it/s]
Adding requests:  11%|█         | 109/1024 [00:00<00:02, 356.96it/s]
Adding requests:  14%|█▍        | 145/1024 [00:00<00:02, 353.08it/s]
Adding requests:  18%|█▊        | 181/1024 [00:00<00:02, 349.14it/s]
Adding requests:  21%|██        | 216/1024 [00:00<00:02, 348.71it/s]
Adding requests:  25%|██▍       | 253/1024 [00:00<00:02, 353.57it/s]
Adding requests:  28%|██▊       | 289/1024 [00:00<00:02, 350.40it/s]
Adding requests:  32%|███▏      | 325/1024 [00:00<00:02, 347.88it/s]
Adding requests:  35%|███▌      | 361/1024 [00:01<00:01, 351.23it/s]
Adding requests:  39%|███▉      | 397/1024 [00:01<00:01, 346.50it/s]
Adding requests:  42%|████▏     | 432/1024 [00:01<00:01, 343.85it/s]
Adding requests:  46%|████▌     | 468/1024 [00:01<00:01, 345.85it/s]
Adding requests:  49%|████▉     | 503/1024 [00:01<00:01, 345.34it/s]
Adding requests:  53%|█████▎    | 538/1024 [00:01<00:01, 335.89it/s]
Adding requests:  56%|█████▌    | 572/1024 [00:01<00:01, 327.21it/s]
Adding requests:  59%|█████▉    | 605/1024 [00:01<00:01, 300.59it/s]
Adding requests:  62%|██████▏   | 636/1024 [00:01<00:01, 293.82it/s]
Adding requests:  65%|██████▌   | 666/1024 [00:02<00:01, 288.15it/s]
Adding requests:  69%|██████▊   | 702/1024 [00:02<00:01, 306.35it/s]
Adding requests:  72%|███████▏  | 737/1024 [00:02<00:00, 315.54it/s]
Adding requests:  75%|███████▌  | 769/1024 [00:02<00:00, 300.67it/s]
Adding requests:  78%|███████▊  | 800/1024 [00:02<00:00, 302.81it/s]
Adding requests:  81%|████████  | 831/1024 [00:02<00:00, 300.71it/s]
Adding requests:  84%|████████▍ | 864/1024 [00:02<00:00, 307.84it/s]
Adding requests:  88%|████████▊ | 901/1024 [00:02<00:00, 323.57it/s]
Adding requests:  92%|█████████▏| 939/1024 [00:02<00:00, 338.05it/s]
Adding requests:  95%|█████████▌| 977/1024 [00:02<00:00, 348.60it/s]
Adding requests:  99%|█████████▉| 1016/1024 [00:03<00:00, 360.29it/s]
Adding requests: 100%|██████████| 1024/1024 [00:03<00:00, 333.13it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:00<00:00, 2574.01it/s, est. speed input: 2636074.47 toks/s, output: 2574.09 toks/s]
Processed prompts:  62%|██████▏   | 636/1024 [00:02<00:01, 242.76it/s, est. speed input: 296457.28 toks/s, output: 289.51 toks/s]   
Processed prompts:  73%|███████▎  | 750/1024 [00:03<00:01, 199.63it/s, est. speed input: 248268.77 toks/s, output: 242.45 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:03<00:01, 178.69it/s, est. speed input: 228172.01 toks/s, output: 222.82 toks/s]
Processed prompts:  84%|████████▍ | 864/1024 [00:03<00:00, 172.64it/s, est. speed input: 221572.52 toks/s, output: 216.38 toks/s]
Processed prompts:  88%|████████▊ | 899/1024 [00:04<00:00, 160.26it/s, est. speed input: 213376.81 toks/s, output: 208.38 toks/s]
Processed prompts:  90%|█████████ | 926/1024 [00:04<00:00, 157.49it/s, est. speed input: 210427.51 toks/s, output: 205.50 toks/s]
Processed prompts:  93%|█████████▎| 949/1024 [00:04<00:00, 151.62it/s, est. speed input: 207004.81 toks/s, output: 202.15 toks/s]
Processed prompts:  95%|█████████▍| 969/1024 [00:04<00:00, 152.33it/s, est. speed input: 205774.24 toks/s, output: 200.95 toks/s]
Processed prompts:  96%|█████████▋| 988/1024 [00:05<00:00, 141.07it/s, est. speed input: 202013.04 toks/s, output: 197.28 toks/s]
Processed prompts:  98%|█████████▊| 1004/1024 [00:05<00:00, 138.18it/s, est. speed input: 200170.69 toks/s, output: 195.48 toks/s]
Processed prompts: 100%|█████████▉| 1019/1024 [00:05<00:00, 134.88it/s, est. speed input: 198396.35 toks/s, output: 193.75 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:05<00:00, 134.88it/s, est. speed input: 199361.63 toks/s, output: 194.69 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:05<00:00, 194.68it/s, est. speed input: 199361.63 toks/s, output: 194.69 toks/s]
[rank0]:[W125 17:21:04.996342201 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=16384 ==========
Time: 2026-01-25 17:21:06
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=2048, max_num_seqs=16
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 2048 --max-num-seqs 16 --max-model-len 1025 --max-num-batched-tokens 16384 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-1B-INT8_M16384.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 17:21:24 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=240888) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=240888) WARNING 01-25 17:21:38 [backends.py:609] Failed to read file <frozen os>
Throughput: 127.42 requests/s, 130610.00 total tokens/s, 127.42 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048

STDERR:
[2026-01-25 17:21:24] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:21:24] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 17:21:24] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 17:21:24] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:21:24] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:21:24] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:21:24] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:21:24] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:21:24] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 17:21:24] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:21:24] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:21:24] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:21:24] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:21:24] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 17:21:32] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:21:32] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 17:21:32] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 17:21:32] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:21:32] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:21:32] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:21:32] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:21:32] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:21:32] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 17:21:32] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:21:32] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:21:32] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:21:32] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:21:32] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=240888) [2026-01-25 17:21:33] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=240888) [2026-01-25 17:21:33] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=240888) [2026-01-25 17:21:33] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=240888) [2026-01-25 17:21:33] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=240888) [2026-01-25 17:21:33] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-1B-INT8
(EngineCore_DP0 pid=240888) [2026-01-25 17:21:33] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=240888) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=240888) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.21it/s]
(EngineCore_DP0 pid=240888) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.20it/s]
(EngineCore_DP0 pid=240888) 
(EngineCore_DP0 pid=240888) [2026-01-25 17:21:33] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 3072] -> 1D uint8
(EngineCore_DP0 pid=240888) [2026-01-25 17:21:33] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7077888 bytes
(EngineCore_DP0 pid=240888) [2026-01-25 17:21:33] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 3072] -> 1D uint8
(EngineCore_DP0 pid=240888) [2026-01-25 17:21:33] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4718592 bytes
(EngineCore_DP0 pid=240888) [2026-01-25 17:21:33] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 3072] -> 1D uint8
(EngineCore_DP0 pid=240888) [2026-01-25 17:21:33] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 37748736 bytes
(EngineCore_DP0 pid=240888) [2026-01-25 17:21:33] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 12288] -> 1D uint8
(EngineCore_DP0 pid=240888) [2026-01-25 17:21:33] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 18874368 bytes
(EngineCore_DP0 pid=240888) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  29%|██▊       | 2/7 [00:00<00:00, 12.00it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  57%|█████▋    | 4/7 [00:00<00:00, 11.45it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  86%|████████▌ | 6/7 [00:00<00:00, 11.63it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00, 11.37it/s]
(EngineCore_DP0 pid=240888) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  20%|██        | 1/5 [00:00<00:00,  9.29it/s]
Capturing CUDA graphs (decode, FULL):  60%|██████    | 3/5 [00:00<00:00, 11.20it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00, 11.59it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00, 11.35it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 35/2048 [00:00<00:05, 347.49it/s]
Adding requests:   4%|▎         | 72/2048 [00:00<00:05, 356.38it/s]
Adding requests:   5%|▌         | 108/2048 [00:00<00:05, 356.32it/s]
Adding requests:   7%|▋         | 144/2048 [00:00<00:05, 347.27it/s]
Adding requests:   9%|▉         | 180/2048 [00:00<00:05, 349.00it/s]
Adding requests:  11%|█         | 217/2048 [00:00<00:05, 353.76it/s]
Adding requests:  12%|█▎        | 256/2048 [00:00<00:04, 365.16it/s]
Adding requests:  14%|█▍        | 293/2048 [00:00<00:04, 364.04it/s]
Adding requests:  16%|█▌        | 330/2048 [00:00<00:04, 360.88it/s]
Adding requests:  18%|█▊        | 369/2048 [00:01<00:04, 367.34it/s]
Adding requests:  20%|█▉        | 406/2048 [00:01<00:04, 364.85it/s]
Adding requests:  22%|██▏       | 443/2048 [00:01<00:04, 360.66it/s]
Adding requests:  23%|██▎       | 481/2048 [00:01<00:04, 366.02it/s]
Adding requests:  25%|██▌       | 518/2048 [00:01<00:04, 358.11it/s]
Adding requests:  27%|██▋       | 555/2048 [00:01<00:04, 361.59it/s]
Adding requests:  29%|██▉       | 594/2048 [00:01<00:03, 367.45it/s]
Adding requests:  31%|███       | 634/2048 [00:01<00:03, 375.23it/s]
Adding requests:  33%|███▎      | 675/2048 [00:01<00:03, 384.03it/s]
Adding requests:  35%|███▍      | 716/2048 [00:01<00:03, 389.47it/s]
Adding requests:  37%|███▋      | 755/2048 [00:02<00:03, 380.90it/s]
Adding requests:  39%|███▉      | 794/2048 [00:02<00:03, 378.77it/s]
Adding requests:  41%|████      | 832/2048 [00:02<00:03, 368.46it/s]
Adding requests:  43%|████▎     | 873/2048 [00:02<00:03, 378.36it/s]
Adding requests:  44%|████▍     | 911/2048 [00:02<00:03, 378.32it/s]
Adding requests:  46%|████▋     | 949/2048 [00:02<00:02, 374.80it/s]
Adding requests:  48%|████▊     | 987/2048 [00:02<00:02, 375.50it/s]
Adding requests:  50%|█████     | 1025/2048 [00:02<00:02, 376.54it/s]
Adding requests:  52%|█████▏    | 1063/2048 [00:02<00:02, 375.41it/s]
Adding requests:  54%|█████▍    | 1101/2048 [00:02<00:02, 373.23it/s]
Adding requests:  56%|█████▌    | 1139/2048 [00:03<00:02, 372.78it/s]
Adding requests:  58%|█████▊    | 1180/2048 [00:03<00:02, 382.52it/s]
Adding requests:  60%|█████▉    | 1220/2048 [00:03<00:02, 386.19it/s]
Adding requests:  61%|██████▏   | 1259/2048 [00:03<00:02, 369.40it/s]
Adding requests:  63%|██████▎   | 1297/2048 [00:03<00:02, 366.13it/s]
Adding requests:  65%|██████▌   | 1336/2048 [00:03<00:01, 370.74it/s]
Adding requests:  67%|██████▋   | 1376/2048 [00:03<00:01, 378.53it/s]
Adding requests:  69%|██████▉   | 1415/2048 [00:03<00:01, 380.80it/s]
Adding requests:  71%|███████   | 1454/2048 [00:03<00:01, 378.05it/s]
Adding requests:  73%|███████▎  | 1496/2048 [00:04<00:01, 389.41it/s]
Adding requests:  75%|███████▌  | 1537/2048 [00:04<00:01, 395.14it/s]
Adding requests:  77%|███████▋  | 1578/2048 [00:04<00:01, 396.84it/s]
Adding requests:  79%|███████▉  | 1618/2048 [00:04<00:01, 388.95it/s]
Adding requests:  81%|████████  | 1657/2048 [00:04<00:01, 384.08it/s]
Adding requests:  83%|████████▎ | 1696/2048 [00:04<00:00, 379.48it/s]
Adding requests:  85%|████████▍ | 1735/2048 [00:04<00:00, 380.12it/s]
Adding requests:  87%|████████▋ | 1774/2048 [00:04<00:00, 372.96it/s]
Adding requests:  89%|████████▊ | 1813/2048 [00:04<00:00, 377.22it/s]
Adding requests:  90%|█████████ | 1851/2048 [00:04<00:00, 365.65it/s]
Adding requests:  92%|█████████▏| 1888/2048 [00:05<00:00, 361.47it/s]
Adding requests:  94%|█████████▍| 1925/2048 [00:05<00:00, 363.05it/s]
Adding requests:  96%|█████████▌| 1965/2048 [00:05<00:00, 372.57it/s]
Adding requests:  98%|█████████▊| 2004/2048 [00:05<00:00, 377.22it/s]
Adding requests: 100%|█████████▉| 2045/2048 [00:05<00:00, 383.99it/s]
Adding requests: 100%|██████████| 2048/2048 [00:05<00:00, 373.61it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [00:00<00:00, 5083.67it/s, est. speed input: 5206414.25 toks/s, output: 5083.84 toks/s]
Processed prompts:  59%|█████▊    | 1199/2048 [00:04<00:03, 250.46it/s, est. speed input: 306839.08 toks/s, output: 299.65 toks/s]  
Processed prompts:  69%|██████▉   | 1417/2048 [00:05<00:03, 202.04it/s, est. speed input: 252573.79 toks/s, output: 246.65 toks/s]
Processed prompts:  75%|███████▌  | 1541/2048 [00:06<00:02, 183.15it/s, est. speed input: 233850.02 toks/s, output: 228.37 toks/s]
Processed prompts:  79%|███████▉  | 1621/2048 [00:07<00:02, 173.64it/s, est. speed input: 225277.58 toks/s, output: 220.00 toks/s]
Processed prompts:  82%|████████▏ | 1677/2048 [00:07<00:02, 170.74it/s, est. speed input: 221914.21 toks/s, output: 216.71 toks/s]
Processed prompts:  84%|████████▍ | 1719/2048 [00:08<00:02, 161.29it/s, est. speed input: 216902.83 toks/s, output: 211.82 toks/s]
Processed prompts:  85%|████████▌ | 1751/2048 [00:08<00:01, 156.90it/s, est. speed input: 214329.72 toks/s, output: 209.31 toks/s]
Processed prompts:  87%|████████▋ | 1777/2048 [00:08<00:01, 161.11it/s, est. speed input: 214272.52 toks/s, output: 209.25 toks/s]
Processed prompts:  88%|████████▊ | 1802/2048 [00:08<00:01, 149.04it/s, est. speed input: 211057.32 toks/s, output: 206.11 toks/s]
Processed prompts:  89%|████████▉ | 1822/2048 [00:08<00:01, 150.26it/s, est. speed input: 210371.47 toks/s, output: 205.44 toks/s]
Processed prompts:  90%|████████▉ | 1841/2048 [00:08<00:01, 150.35it/s, est. speed input: 209589.74 toks/s, output: 204.68 toks/s]
Processed prompts:  91%|█████████ | 1859/2048 [00:09<00:01, 126.78it/s, est. speed input: 205890.67 toks/s, output: 201.06 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [00:09<00:01, 126.67it/s, est. speed input: 204916.72 toks/s, output: 200.11 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [00:09<00:01, 126.86it/s, est. speed input: 203936.23 toks/s, output: 199.16 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [00:09<00:01, 126.88it/s, est. speed input: 202966.90 toks/s, output: 198.21 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [00:09<00:00, 126.96it/s, est. speed input: 202028.43 toks/s, output: 197.29 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [00:09<00:00, 127.19it/s, est. speed input: 201126.30 toks/s, output: 196.41 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [00:09<00:00, 129.42it/s, est. speed input: 200395.61 toks/s, output: 195.70 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [00:10<00:00, 128.84it/s, est. speed input: 199525.94 toks/s, output: 194.85 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [00:10<00:00, 130.60it/s, est. speed input: 198819.98 toks/s, output: 194.16 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [00:10<00:00, 131.79it/s, est. speed input: 198122.91 toks/s, output: 193.48 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [00:10<00:00, 130.59it/s, est. speed input: 197318.35 toks/s, output: 192.69 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [00:10<00:00, 132.65it/s, est. speed input: 196703.32 toks/s, output: 192.09 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:10<00:00, 132.65it/s, est. speed input: 198050.05 toks/s, output: 193.41 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:10<00:00, 193.41it/s, est. speed input: 198050.05 toks/s, output: 193.41 toks/s]
[rank0]:[W125 17:22:06.416666206 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=32768 ==========
Time: 2026-01-25 17:22:08
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=4096, max_num_seqs=32
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 4096 --max-num-seqs 32 --max-model-len 1025 --max-num-batched-tokens 32768 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-1B-INT8_M32768.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 17:22:37 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=242108) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=242108) WARNING 01-25 17:22:52 [backends.py:609] Failed to read file <frozen os>
Throughput: 129.43 requests/s, 132662.26 total tokens/s, 129.43 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096

STDERR:
[2026-01-25 17:22:37] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:22:37] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 17:22:37] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 17:22:37] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:22:37] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:22:37] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:22:37] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:22:37] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:22:37] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 17:22:37] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:22:37] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:22:37] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:22:37] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:22:37] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 17:22:45] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:22:45] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 17:22:45] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 17:22:45] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:22:45] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:22:45] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:22:45] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:22:45] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:22:45] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 17:22:45] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:22:45] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:22:45] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:22:45] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:22:45] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=242108) [2026-01-25 17:22:46] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=242108) [2026-01-25 17:22:46] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=242108) [2026-01-25 17:22:46] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=242108) [2026-01-25 17:22:46] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=242108) [2026-01-25 17:22:46] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-1B-INT8
(EngineCore_DP0 pid=242108) [2026-01-25 17:22:46] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=242108) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=242108) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.08it/s]
(EngineCore_DP0 pid=242108) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.08it/s]
(EngineCore_DP0 pid=242108) 
(EngineCore_DP0 pid=242108) [2026-01-25 17:22:46] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 3072] -> 1D uint8
(EngineCore_DP0 pid=242108) [2026-01-25 17:22:46] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7077888 bytes
(EngineCore_DP0 pid=242108) [2026-01-25 17:22:46] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 3072] -> 1D uint8
(EngineCore_DP0 pid=242108) [2026-01-25 17:22:46] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4718592 bytes
(EngineCore_DP0 pid=242108) [2026-01-25 17:22:46] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 3072] -> 1D uint8
(EngineCore_DP0 pid=242108) [2026-01-25 17:22:46] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 37748736 bytes
(EngineCore_DP0 pid=242108) [2026-01-25 17:22:46] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 12288] -> 1D uint8
(EngineCore_DP0 pid=242108) [2026-01-25 17:22:46] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 18874368 bytes
(EngineCore_DP0 pid=242108) [rank0]:W0125 17:22:57.318000 242108 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=242108) [rank0]:W0125 17:22:57.395000 242108 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=242108) [rank0]:W0125 17:22:58.304000 242108 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=242108) [rank0]:W0125 17:22:58.413000 242108 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=242108) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  18%|█▊        | 2/11 [00:00<00:00, 11.41it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  36%|███▋      | 4/11 [00:00<00:00, 12.14it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  55%|█████▍    | 6/11 [00:00<00:00, 12.34it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  73%|███████▎  | 8/11 [00:00<00:00, 12.48it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  91%|█████████ | 10/11 [00:00<00:00, 12.44it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:00<00:00, 12.09it/s]
(EngineCore_DP0 pid=242108) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  29%|██▊       | 2/7 [00:00<00:00, 11.57it/s]
Capturing CUDA graphs (decode, FULL):  57%|█████▋    | 4/7 [00:00<00:00, 12.41it/s]
Capturing CUDA graphs (decode, FULL):  86%|████████▌ | 6/7 [00:00<00:00, 12.28it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00, 12.10it/s]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   1%|          | 33/4096 [00:00<00:12, 328.14it/s]
Adding requests:   2%|▏         | 70/4096 [00:00<00:11, 349.57it/s]
Adding requests:   3%|▎         | 106/4096 [00:00<00:11, 351.24it/s]
Adding requests:   3%|▎         | 143/4096 [00:00<00:11, 356.94it/s]
Adding requests:   4%|▍         | 179/4096 [00:00<00:11, 354.33it/s]
Adding requests:   5%|▌         | 220/4096 [00:00<00:10, 372.92it/s]
Adding requests:   6%|▋         | 260/4096 [00:00<00:10, 379.70it/s]
Adding requests:   7%|▋         | 299/4096 [00:00<00:09, 381.87it/s]
Adding requests:   8%|▊         | 338/4096 [00:00<00:09, 384.00it/s]
Adding requests:   9%|▉         | 377/4096 [00:01<00:09, 381.46it/s]
Adding requests:  10%|█         | 418/4096 [00:01<00:09, 388.96it/s]
Adding requests:  11%|█         | 458/4096 [00:01<00:09, 390.79it/s]
Adding requests:  12%|█▏        | 498/4096 [00:01<00:09, 382.50it/s]
Adding requests:  13%|█▎        | 537/4096 [00:01<00:09, 379.08it/s]
Adding requests:  14%|█▍        | 576/4096 [00:01<00:09, 380.00it/s]
Adding requests:  15%|█▌        | 617/4096 [00:01<00:08, 388.26it/s]
Adding requests:  16%|█▌        | 656/4096 [00:01<00:08, 388.23it/s]
Adding requests:  17%|█▋        | 695/4096 [00:01<00:08, 385.88it/s]
Adding requests:  18%|█▊        | 734/4096 [00:01<00:08, 386.74it/s]
Adding requests:  19%|█▉        | 773/4096 [00:02<00:08, 376.47it/s]
Adding requests:  20%|█▉        | 813/4096 [00:02<00:08, 379.17it/s]
Adding requests:  21%|██        | 851/4096 [00:02<00:08, 369.88it/s]
Adding requests:  22%|██▏       | 892/4096 [00:02<00:08, 380.26it/s]
Adding requests:  23%|██▎       | 934/4096 [00:02<00:08, 388.96it/s]
Adding requests:  24%|██▍       | 976/4096 [00:02<00:07, 396.95it/s]
Adding requests:  25%|██▍       | 1019/4096 [00:02<00:07, 404.65it/s]
Adding requests:  26%|██▌       | 1060/4096 [00:02<00:07, 389.22it/s]
Adding requests:  27%|██▋       | 1101/4096 [00:02<00:07, 392.28it/s]
Adding requests:  28%|██▊       | 1141/4096 [00:02<00:07, 383.89it/s]
Adding requests:  29%|██▉       | 1183/4096 [00:03<00:07, 394.02it/s]
Adding requests:  30%|██▉       | 1223/4096 [00:03<00:07, 393.79it/s]
Adding requests:  31%|███       | 1263/4096 [00:03<00:07, 387.39it/s]
Adding requests:  32%|███▏      | 1302/4096 [00:03<00:07, 382.19it/s]
Adding requests:  33%|███▎      | 1342/4096 [00:03<00:07, 386.55it/s]
Adding requests:  34%|███▍      | 1384/4096 [00:03<00:06, 394.27it/s]
Adding requests:  35%|███▍      | 1424/4096 [00:03<00:06, 393.64it/s]
Adding requests:  36%|███▌      | 1464/4096 [00:03<00:06, 392.31it/s]
Adding requests:  37%|███▋      | 1506/4096 [00:03<00:06, 398.75it/s]
Adding requests:  38%|███▊      | 1546/4096 [00:04<00:06, 395.22it/s]
Adding requests:  39%|███▉      | 1589/4096 [00:04<00:06, 404.19it/s]
Adding requests:  40%|███▉      | 1630/4096 [00:04<00:06, 399.27it/s]
Adding requests:  41%|████      | 1670/4096 [00:04<00:06, 387.02it/s]
Adding requests:  42%|████▏     | 1710/4096 [00:04<00:06, 387.75it/s]
Adding requests:  43%|████▎     | 1749/4096 [00:04<00:06, 386.20it/s]
Adding requests:  44%|████▎     | 1790/4096 [00:04<00:05, 391.27it/s]
Adding requests:  45%|████▍     | 1830/4096 [00:04<00:05, 388.33it/s]
Adding requests:  46%|████▌     | 1870/4096 [00:04<00:05, 390.51it/s]
Adding requests:  47%|████▋     | 1910/4096 [00:04<00:05, 385.44it/s]
Adding requests:  48%|████▊     | 1949/4096 [00:05<00:05, 383.67it/s]
Adding requests:  49%|████▊     | 1989/4096 [00:05<00:05, 388.35it/s]
Adding requests:  50%|████▉     | 2030/4096 [00:05<00:05, 394.50it/s]
Adding requests:  51%|█████     | 2072/4096 [00:05<00:05, 399.92it/s]
Adding requests:  52%|█████▏    | 2113/4096 [00:05<00:05, 392.85it/s]
Adding requests:  53%|█████▎    | 2153/4096 [00:05<00:04, 393.79it/s]
Adding requests:  54%|█████▎    | 2193/4096 [00:05<00:04, 385.08it/s]
Adding requests:  54%|█████▍    | 2232/4096 [00:05<00:04, 377.68it/s]
Adding requests:  55%|█████▌    | 2271/4096 [00:05<00:04, 380.72it/s]
Adding requests:  56%|█████▋    | 2310/4096 [00:05<00:04, 378.52it/s]
Adding requests:  57%|█████▋    | 2350/4096 [00:06<00:04, 383.87it/s]
Adding requests:  58%|█████▊    | 2390/4096 [00:06<00:04, 386.58it/s]
Adding requests:  59%|█████▉    | 2432/4096 [00:06<00:04, 396.12it/s]
Adding requests:  60%|██████    | 2472/4096 [00:06<00:04, 385.80it/s]
Adding requests:  61%|██████▏   | 2511/4096 [00:06<00:04, 382.81it/s]
Adding requests:  62%|██████▏   | 2553/4096 [00:06<00:03, 392.97it/s]
Adding requests:  63%|██████▎   | 2593/4096 [00:06<00:03, 389.83it/s]
Adding requests:  64%|██████▍   | 2636/4096 [00:06<00:03, 400.26it/s]
Adding requests:  65%|██████▌   | 2677/4096 [00:06<00:03, 398.19it/s]
Adding requests:  66%|██████▋   | 2717/4096 [00:07<00:03, 395.15it/s]
Adding requests:  67%|██████▋   | 2757/4096 [00:07<00:03, 395.85it/s]
Adding requests:  68%|██████▊   | 2797/4096 [00:07<00:03, 388.04it/s]
Adding requests:  69%|██████▉   | 2837/4096 [00:07<00:03, 391.13it/s]
Adding requests:  70%|███████   | 2878/4096 [00:07<00:03, 395.80it/s]
Adding requests:  71%|███████   | 2918/4096 [00:07<00:03, 392.14it/s]
Adding requests:  72%|███████▏  | 2959/4096 [00:07<00:02, 393.96it/s]
Adding requests:  73%|███████▎  | 2999/4096 [00:07<00:02, 391.63it/s]
Adding requests:  74%|███████▍  | 3040/4096 [00:07<00:02, 394.97it/s]
Adding requests:  75%|███████▌  | 3080/4096 [00:07<00:02, 388.71it/s]
Adding requests:  76%|███████▌  | 3122/4096 [00:08<00:02, 395.77it/s]
Adding requests:  77%|███████▋  | 3162/4096 [00:08<00:02, 386.81it/s]
Adding requests:  78%|███████▊  | 3201/4096 [00:08<00:02, 379.32it/s]
Adding requests:  79%|███████▉  | 3239/4096 [00:08<00:02, 377.90it/s]
Adding requests:  80%|████████  | 3277/4096 [00:08<00:02, 372.57it/s]
Adding requests:  81%|████████  | 3315/4096 [00:08<00:02, 374.26it/s]
Adding requests:  82%|████████▏ | 3354/4096 [00:08<00:01, 378.51it/s]
Adding requests:  83%|████████▎ | 3392/4096 [00:08<00:01, 377.67it/s]
Adding requests:  84%|████████▍ | 3432/4096 [00:08<00:01, 383.77it/s]
Adding requests:  85%|████████▍ | 3471/4096 [00:08<00:01, 379.30it/s]
Adding requests:  86%|████████▌ | 3513/4096 [00:09<00:01, 389.72it/s]
Adding requests:  87%|████████▋ | 3552/4096 [00:09<00:01, 378.19it/s]
Adding requests:  88%|████████▊ | 3591/4096 [00:09<00:01, 379.65it/s]
Adding requests:  89%|████████▊ | 3630/4096 [00:09<00:01, 371.96it/s]
Adding requests:  90%|████████▉ | 3671/4096 [00:09<00:01, 381.15it/s]
Adding requests:  91%|█████████ | 3711/4096 [00:09<00:00, 386.29it/s]
Adding requests:  92%|█████████▏| 3750/4096 [00:09<00:00, 386.55it/s]
Adding requests:  93%|█████████▎| 3792/4096 [00:09<00:00, 395.49it/s]
Adding requests:  94%|█████████▎| 3832/4096 [00:09<00:00, 395.07it/s]
Adding requests:  95%|█████████▍| 3872/4096 [00:10<00:00, 393.79it/s]
Adding requests:  96%|█████████▌| 3912/4096 [00:10<00:00, 392.44it/s]
Adding requests:  96%|█████████▋| 3952/4096 [00:10<00:00, 391.84it/s]
Adding requests:  97%|█████████▋| 3992/4096 [00:10<00:00, 385.16it/s]
Adding requests:  98%|█████████▊| 4031/4096 [00:10<00:00, 386.45it/s]
Adding requests:  99%|█████████▉| 4070/4096 [00:10<00:00, 385.68it/s]
Adding requests: 100%|██████████| 4096/4096 [00:10<00:00, 386.26it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  33%|███▎      | 1339/4096 [00:00<00:00, 6441.87it/s, est. speed input: 6596992.51 toks/s, output: 6442.01 toks/s]
Processed prompts:  48%|████▊     | 1984/4096 [00:05<00:06, 312.76it/s, est. speed input: 396683.73 toks/s, output: 387.39 toks/s]   
Processed prompts:  55%|█████▌    | 2257/4096 [00:07<00:07, 252.38it/s, est. speed input: 327800.98 toks/s, output: 320.12 toks/s]
Processed prompts:  59%|█████▉    | 2412/4096 [00:08<00:07, 223.37it/s, est. speed input: 299682.69 toks/s, output: 292.66 toks/s]
Processed prompts:  61%|██████▏   | 2511/4096 [00:08<00:07, 208.57it/s, est. speed input: 286788.24 toks/s, output: 280.07 toks/s]
Processed prompts:  63%|██████▎   | 2580/4096 [00:09<00:07, 198.71it/s, est. speed input: 279264.88 toks/s, output: 272.72 toks/s]
Processed prompts:  64%|██████▍   | 2630/4096 [00:09<00:08, 182.55it/s, est. speed input: 270705.54 toks/s, output: 264.36 toks/s]
Processed prompts:  65%|██████▌   | 2667/4096 [00:10<00:07, 178.92it/s, est. speed input: 267833.18 toks/s, output: 261.56 toks/s]
Processed prompts:  66%|██████▌   | 2697/4096 [00:10<00:08, 171.62it/s, est. speed input: 264544.23 toks/s, output: 258.34 toks/s]
Processed prompts:  66%|██████▋   | 2722/4096 [00:10<00:08, 160.15it/s, est. speed input: 260787.33 toks/s, output: 254.67 toks/s]
Processed prompts:  67%|██████▋   | 2747/4096 [00:10<00:09, 149.15it/s, est. speed input: 257238.67 toks/s, output: 251.21 toks/s]
Processed prompts:  68%|██████▊   | 2779/4096 [00:11<00:09, 144.99it/s, est. speed input: 254479.99 toks/s, output: 248.52 toks/s]
Processed prompts:  69%|██████▊   | 2811/4096 [00:11<00:08, 143.08it/s, est. speed input: 252119.89 toks/s, output: 246.21 toks/s]
Processed prompts:  69%|██████▉   | 2843/4096 [00:11<00:08, 139.52it/s, est. speed input: 249564.17 toks/s, output: 243.71 toks/s]
Processed prompts:  70%|███████   | 2875/4096 [00:11<00:08, 137.71it/s, est. speed input: 247254.99 toks/s, output: 241.46 toks/s]
Processed prompts:  71%|███████   | 2907/4096 [00:12<00:08, 135.26it/s, est. speed input: 244897.64 toks/s, output: 239.16 toks/s]
Processed prompts:  72%|███████▏  | 2939/4096 [00:12<00:08, 134.37it/s, est. speed input: 242753.98 toks/s, output: 237.06 toks/s]
Processed prompts:  73%|███████▎  | 2971/4096 [00:12<00:08, 132.90it/s, est. speed input: 240593.13 toks/s, output: 234.95 toks/s]
Processed prompts:  73%|███████▎  | 3003/4096 [00:12<00:08, 131.86it/s, est. speed input: 238517.90 toks/s, output: 232.93 toks/s]
Processed prompts:  74%|███████▍  | 3035/4096 [00:13<00:08, 131.03it/s, est. speed input: 236509.97 toks/s, output: 230.97 toks/s]
Processed prompts:  75%|███████▍  | 3067/4096 [00:13<00:07, 130.43it/s, est. speed input: 234575.82 toks/s, output: 229.08 toks/s]
Processed prompts:  76%|███████▌  | 3099/4096 [00:13<00:07, 130.92it/s, est. speed input: 232810.84 toks/s, output: 227.35 toks/s]
Processed prompts:  76%|███████▋  | 3131/4096 [00:13<00:07, 133.82it/s, est. speed input: 231369.61 toks/s, output: 225.95 toks/s]
Processed prompts:  77%|███████▋  | 3163/4096 [00:14<00:07, 132.45it/s, est. speed input: 229633.88 toks/s, output: 224.25 toks/s]
Processed prompts:  78%|███████▊  | 3195/4096 [00:14<00:06, 132.42it/s, est. speed input: 228047.58 toks/s, output: 222.70 toks/s]
Processed prompts:  79%|███████▉  | 3227/4096 [00:14<00:06, 132.38it/s, est. speed input: 226512.54 toks/s, output: 221.20 toks/s]
Processed prompts:  80%|███████▉  | 3259/4096 [00:14<00:06, 131.18it/s, est. speed input: 224917.77 toks/s, output: 219.65 toks/s]
Processed prompts:  80%|████████  | 3291/4096 [00:15<00:06, 130.31it/s, est. speed input: 223371.92 toks/s, output: 218.14 toks/s]
Processed prompts:  81%|████████  | 3323/4096 [00:15<00:05, 129.98it/s, est. speed input: 221901.33 toks/s, output: 216.70 toks/s]
Processed prompts:  82%|████████▏ | 3355/4096 [00:15<00:05, 129.52it/s, est. speed input: 220457.07 toks/s, output: 215.29 toks/s]
Processed prompts:  83%|████████▎ | 3387/4096 [00:15<00:05, 129.18it/s, est. speed input: 219055.93 toks/s, output: 213.92 toks/s]
Processed prompts:  83%|████████▎ | 3419/4096 [00:16<00:05, 129.01it/s, est. speed input: 217704.95 toks/s, output: 212.60 toks/s]
Processed prompts:  84%|████████▍ | 3451/4096 [00:16<00:04, 131.32it/s, est. speed input: 216597.65 toks/s, output: 211.52 toks/s]
Processed prompts:  85%|████████▌ | 3483/4096 [00:16<00:04, 132.75it/s, est. speed input: 215502.84 toks/s, output: 210.45 toks/s]
Processed prompts:  86%|████████▌ | 3515/4096 [00:16<00:04, 131.59it/s, est. speed input: 214270.26 toks/s, output: 209.25 toks/s]
Processed prompts:  87%|████████▋ | 3547/4096 [00:17<00:04, 130.53it/s, est. speed input: 213053.08 toks/s, output: 208.06 toks/s]
Processed prompts:  87%|████████▋ | 3579/4096 [00:17<00:03, 129.98it/s, est. speed input: 211885.53 toks/s, output: 206.92 toks/s]
Processed prompts:  88%|████████▊ | 3611/4096 [00:17<00:03, 129.66it/s, est. speed input: 210755.46 toks/s, output: 205.82 toks/s]
Processed prompts:  89%|████████▉ | 3643/4096 [00:17<00:03, 129.50it/s, est. speed input: 209661.57 toks/s, output: 204.75 toks/s]
Processed prompts:  90%|████████▉ | 3675/4096 [00:18<00:03, 129.31it/s, est. speed input: 208591.93 toks/s, output: 203.70 toks/s]
Processed prompts:  91%|█████████ | 3707/4096 [00:18<00:03, 129.05it/s, est. speed input: 207542.38 toks/s, output: 202.68 toks/s]
Processed prompts:  91%|█████████▏| 3739/4096 [00:18<00:02, 129.68it/s, est. speed input: 206578.40 toks/s, output: 201.74 toks/s]
Processed prompts:  92%|█████████▏| 3771/4096 [00:18<00:02, 129.23it/s, est. speed input: 205577.67 toks/s, output: 200.76 toks/s]
Processed prompts:  93%|█████████▎| 3803/4096 [00:19<00:02, 128.95it/s, est. speed input: 204605.59 toks/s, output: 199.81 toks/s]
Processed prompts:  94%|█████████▎| 3835/4096 [00:19<00:01, 131.23it/s, est. speed input: 203823.49 toks/s, output: 199.05 toks/s]
Processed prompts:  94%|█████████▍| 3867/4096 [00:19<00:01, 130.51it/s, est. speed input: 202908.73 toks/s, output: 198.15 toks/s]
Processed prompts:  95%|█████████▌| 3899/4096 [00:19<00:01, 129.84it/s, est. speed input: 202006.33 toks/s, output: 197.27 toks/s]
Processed prompts:  96%|█████████▌| 3931/4096 [00:20<00:01, 129.56it/s, est. speed input: 201137.73 toks/s, output: 196.42 toks/s]
Processed prompts:  97%|█████████▋| 3963/4096 [00:20<00:01, 129.27it/s, est. speed input: 200285.00 toks/s, output: 195.59 toks/s]
Processed prompts:  98%|█████████▊| 3995/4096 [00:20<00:00, 128.98it/s, est. speed input: 199447.07 toks/s, output: 194.77 toks/s]
Processed prompts:  98%|█████████▊| 4027/4096 [00:20<00:00, 131.25it/s, est. speed input: 198778.96 toks/s, output: 194.12 toks/s]
Processed prompts:  99%|█████████▉| 4059/4096 [00:20<00:00, 131.81it/s, est. speed input: 198063.68 toks/s, output: 193.42 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [00:21<00:00, 131.81it/s, est. speed input: 199343.22 toks/s, output: 194.67 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [00:21<00:00, 194.67it/s, est. speed input: 199343.22 toks/s, output: 194.67 toks/s]
[rank0]:[W125 17:23:36.618858481 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=65536 ==========
Time: 2026-01-25 17:23:38
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=8192, max_num_seqs=64
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 8192 --max-num-seqs 64 --max-model-len 1025 --max-num-batched-tokens 65536 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-1B-INT8_M65536.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 17:24:28 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=243870) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=243870) WARNING 01-25 17:24:42 [backends.py:609] Failed to read file <frozen os>
Throughput: 130.30 requests/s, 133560.41 total tokens/s, 130.30 output tokens/s
Total num prompt tokens:  8388608
Total num output tokens:  8192

STDERR:
[2026-01-25 17:24:28] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:24:28] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 17:24:28] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 17:24:28] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:24:28] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:24:28] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:24:28] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:24:28] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:24:28] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 17:24:28] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:24:28] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:24:28] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:24:28] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:24:28] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 17:24:36] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:24:36] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 17:24:36] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 17:24:36] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:24:36] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:24:36] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:24:36] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:24:36] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:24:36] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 17:24:36] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:24:36] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:24:36] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:24:36] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:24:36] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=243870) [2026-01-25 17:24:37] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=243870) [2026-01-25 17:24:37] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=243870) [2026-01-25 17:24:37] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=243870) [2026-01-25 17:24:37] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=243870) [2026-01-25 17:24:37] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-1B-INT8
(EngineCore_DP0 pid=243870) [2026-01-25 17:24:37] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=243870) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=243870) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.26it/s]
(EngineCore_DP0 pid=243870) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.26it/s]
(EngineCore_DP0 pid=243870) 
(EngineCore_DP0 pid=243870) [2026-01-25 17:24:37] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 3072] -> 1D uint8
(EngineCore_DP0 pid=243870) [2026-01-25 17:24:37] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7077888 bytes
(EngineCore_DP0 pid=243870) [2026-01-25 17:24:37] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 3072] -> 1D uint8
(EngineCore_DP0 pid=243870) [2026-01-25 17:24:37] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4718592 bytes
(EngineCore_DP0 pid=243870) [2026-01-25 17:24:37] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 3072] -> 1D uint8
(EngineCore_DP0 pid=243870) [2026-01-25 17:24:37] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 37748736 bytes
(EngineCore_DP0 pid=243870) [2026-01-25 17:24:37] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 12288] -> 1D uint8
(EngineCore_DP0 pid=243870) [2026-01-25 17:24:37] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 18874368 bytes
(EngineCore_DP0 pid=243870) [rank0]:W0125 17:24:48.146000 243870 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=243870) [rank0]:W0125 17:24:48.223000 243870 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=243870) [rank0]:W0125 17:24:49.141000 243870 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=243870) [rank0]:W0125 17:24:49.249000 243870 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=243870) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/19 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   5%|▌         | 1/19 [00:00<00:07,  2.56it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  11%|█         | 2/19 [00:00<00:06,  2.57it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  21%|██        | 4/19 [00:00<00:02,  5.03it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  32%|███▏      | 6/19 [00:01<00:01,  7.01it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  42%|████▏     | 8/19 [00:01<00:01,  8.43it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  53%|█████▎    | 10/19 [00:01<00:00,  9.51it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  63%|██████▎   | 12/19 [00:01<00:00, 10.19it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  74%|███████▎  | 14/19 [00:01<00:00, 10.63it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  84%|████████▍ | 16/19 [00:01<00:00, 11.19it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  95%|█████████▍| 18/19 [00:02<00:00, 11.41it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 19/19 [00:02<00:00,  8.63it/s]
(EngineCore_DP0 pid=243870) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):   9%|▉         | 1/11 [00:00<00:01,  9.98it/s]
Capturing CUDA graphs (decode, FULL):  27%|██▋       | 3/11 [00:00<00:00, 11.55it/s]
Capturing CUDA graphs (decode, FULL):  45%|████▌     | 5/11 [00:00<00:00, 11.86it/s]
Capturing CUDA graphs (decode, FULL):  64%|██████▎   | 7/11 [00:00<00:00, 11.96it/s]
Capturing CUDA graphs (decode, FULL):  82%|████████▏ | 9/11 [00:00<00:00, 11.93it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 11/11 [00:00<00:00, 11.98it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 11/11 [00:00<00:00, 11.86it/s]

Adding requests:   0%|          | 0/8192 [00:00<?, ?it/s]
Adding requests:   0%|          | 36/8192 [00:00<00:22, 359.77it/s]
Adding requests:   1%|          | 73/8192 [00:00<00:22, 362.18it/s]
Adding requests:   1%|▏         | 110/8192 [00:00<00:22, 361.60it/s]
Adding requests:   2%|▏         | 147/8192 [00:00<00:22, 356.06it/s]
Adding requests:   2%|▏         | 186/8192 [00:00<00:21, 365.51it/s]
Adding requests:   3%|▎         | 224/8192 [00:00<00:21, 368.67it/s]
Adding requests:   3%|▎         | 263/8192 [00:00<00:21, 374.82it/s]
Adding requests:   4%|▎         | 301/8192 [00:00<00:21, 371.06it/s]
Adding requests:   4%|▍         | 341/8192 [00:00<00:20, 377.70it/s]
Adding requests:   5%|▍         | 380/8192 [00:01<00:20, 378.79it/s]
Adding requests:   5%|▌         | 422/8192 [00:01<00:19, 389.48it/s]
Adding requests:   6%|▌         | 461/8192 [00:01<00:20, 385.99it/s]
Adding requests:   6%|▌         | 500/8192 [00:01<00:20, 373.67it/s]
Adding requests:   7%|▋         | 538/8192 [00:01<00:21, 364.03it/s]
Adding requests:   7%|▋         | 581/8192 [00:01<00:19, 382.48it/s]
Adding requests:   8%|▊         | 620/8192 [00:01<00:19, 380.81it/s]
Adding requests:   8%|▊         | 659/8192 [00:01<00:19, 383.07it/s]
Adding requests:   9%|▊         | 698/8192 [00:01<00:19, 380.96it/s]
Adding requests:   9%|▉         | 740/8192 [00:01<00:19, 389.77it/s]
Adding requests:  10%|▉         | 780/8192 [00:02<00:19, 381.91it/s]
Adding requests:  10%|▉         | 819/8192 [00:02<00:19, 372.76it/s]
Adding requests:  10%|█         | 857/8192 [00:02<00:19, 373.20it/s]
Adding requests:  11%|█         | 898/8192 [00:02<00:19, 382.68it/s]
Adding requests:  11%|█▏        | 939/8192 [00:02<00:18, 387.96it/s]
Adding requests:  12%|█▏        | 979/8192 [00:02<00:18, 391.31it/s]
Adding requests:  12%|█▏        | 1019/8192 [00:02<00:18, 391.08it/s]
Adding requests:  13%|█▎        | 1059/8192 [00:02<00:18, 383.59it/s]
Adding requests:  13%|█▎        | 1098/8192 [00:02<00:18, 385.15it/s]
Adding requests:  14%|█▍        | 1138/8192 [00:02<00:18, 388.79it/s]
Adding requests:  14%|█▍        | 1183/8192 [00:03<00:17, 404.83it/s]
Adding requests:  15%|█▍        | 1224/8192 [00:03<00:17, 405.99it/s]
Adding requests:  15%|█▌        | 1265/8192 [00:03<00:17, 388.65it/s]
Adding requests:  16%|█▌        | 1305/8192 [00:03<00:17, 387.63it/s]
Adding requests:  16%|█▋        | 1346/8192 [00:03<00:17, 392.59it/s]
Adding requests:  17%|█▋        | 1389/8192 [00:03<00:16, 402.18it/s]
Adding requests:  17%|█▋        | 1431/8192 [00:03<00:16, 406.45it/s]
Adding requests:  18%|█▊        | 1472/8192 [00:03<00:16, 395.83it/s]
Adding requests:  18%|█▊        | 1512/8192 [00:03<00:16, 393.90it/s]
Adding requests:  19%|█▉        | 1552/8192 [00:04<00:16, 392.93it/s]
Adding requests:  19%|█▉        | 1595/8192 [00:04<00:16, 401.26it/s]
Adding requests:  20%|█▉        | 1636/8192 [00:04<00:16, 402.06it/s]
Adding requests:  20%|██        | 1677/8192 [00:04<00:16, 392.22it/s]
Adding requests:  21%|██        | 1718/8192 [00:04<00:16, 388.50it/s]
Adding requests:  21%|██▏       | 1759/8192 [00:04<00:16, 393.25it/s]
Adding requests:  22%|██▏       | 1801/8192 [00:04<00:15, 399.82it/s]
Adding requests:  22%|██▏       | 1842/8192 [00:04<00:16, 389.81it/s]
Adding requests:  23%|██▎       | 1882/8192 [00:04<00:16, 392.50it/s]
Adding requests:  23%|██▎       | 1922/8192 [00:04<00:16, 389.60it/s]
Adding requests:  24%|██▍       | 1962/8192 [00:05<00:16, 382.99it/s]
Adding requests:  24%|██▍       | 2001/8192 [00:05<00:16, 382.77it/s]
Adding requests:  25%|██▍       | 2040/8192 [00:05<00:16, 378.79it/s]
Adding requests:  25%|██▌       | 2080/8192 [00:05<00:15, 382.32it/s]
Adding requests:  26%|██▌       | 2120/8192 [00:05<00:15, 384.84it/s]
Adding requests:  26%|██▋       | 2161/8192 [00:05<00:15, 390.85it/s]
Adding requests:  27%|██▋       | 2203/8192 [00:05<00:15, 398.06it/s]
Adding requests:  27%|██▋       | 2244/8192 [00:05<00:14, 400.53it/s]
Adding requests:  28%|██▊       | 2286/8192 [00:05<00:14, 403.52it/s]
Adding requests:  28%|██▊       | 2330/8192 [00:06<00:14, 411.00it/s]
Adding requests:  29%|██▉       | 2373/8192 [00:06<00:13, 416.11it/s]
Adding requests:  29%|██▉       | 2416/8192 [00:06<00:13, 418.52it/s]
Adding requests:  30%|███       | 2458/8192 [00:06<00:13, 410.54it/s]
Adding requests:  31%|███       | 2500/8192 [00:06<00:14, 399.71it/s]
Adding requests:  31%|███       | 2541/8192 [00:06<00:14, 399.86it/s]
Adding requests:  32%|███▏      | 2583/8192 [00:06<00:13, 402.23it/s]
Adding requests:  32%|███▏      | 2624/8192 [00:06<00:13, 400.19it/s]
Adding requests:  33%|███▎      | 2665/8192 [00:06<00:14, 393.20it/s]
Adding requests:  33%|███▎      | 2705/8192 [00:06<00:14, 385.83it/s]
Adding requests:  34%|███▎      | 2745/8192 [00:07<00:14, 387.64it/s]
Adding requests:  34%|███▍      | 2786/8192 [00:07<00:13, 392.08it/s]
Adding requests:  34%|███▍      | 2826/8192 [00:07<00:13, 388.40it/s]
Adding requests:  35%|███▌      | 2868/8192 [00:07<00:13, 397.03it/s]
Adding requests:  35%|███▌      | 2908/8192 [00:07<00:13, 396.36it/s]
Adding requests:  36%|███▌      | 2948/8192 [00:07<00:13, 391.84it/s]
Adding requests:  36%|███▋      | 2988/8192 [00:07<00:13, 390.26it/s]
Adding requests:  37%|███▋      | 3028/8192 [00:07<00:13, 382.26it/s]
Adding requests:  37%|███▋      | 3067/8192 [00:07<00:13, 381.20it/s]
Adding requests:  38%|███▊      | 3107/8192 [00:07<00:13, 384.36it/s]
Adding requests:  38%|███▊      | 3149/8192 [00:08<00:12, 393.04it/s]
Adding requests:  39%|███▉      | 3190/8192 [00:08<00:12, 396.28it/s]
Adding requests:  39%|███▉      | 3230/8192 [00:08<00:12, 392.46it/s]
Adding requests:  40%|███▉      | 3273/8192 [00:08<00:12, 400.98it/s]
Adding requests:  40%|████      | 3314/8192 [00:08<00:12, 393.39it/s]
Adding requests:  41%|████      | 3354/8192 [00:08<00:12, 390.02it/s]
Adding requests:  41%|████▏     | 3394/8192 [00:08<00:12, 383.03it/s]
Adding requests:  42%|████▏     | 3437/8192 [00:08<00:12, 394.61it/s]
Adding requests:  42%|████▏     | 3477/8192 [00:08<00:12, 380.61it/s]
Adding requests:  43%|████▎     | 3519/8192 [00:09<00:12, 389.39it/s]
Adding requests:  43%|████▎     | 3560/8192 [00:09<00:11, 394.51it/s]
Adding requests:  44%|████▍     | 3600/8192 [00:09<00:11, 388.59it/s]
Adding requests:  44%|████▍     | 3639/8192 [00:09<00:11, 382.55it/s]
Adding requests:  45%|████▍     | 3681/8192 [00:09<00:11, 390.14it/s]
Adding requests:  45%|████▌     | 3721/8192 [00:09<00:11, 385.80it/s]
Adding requests:  46%|████▌     | 3762/8192 [00:09<00:11, 390.61it/s]
Adding requests:  46%|████▋     | 3803/8192 [00:09<00:11, 395.10it/s]
Adding requests:  47%|████▋     | 3846/8192 [00:09<00:10, 403.38it/s]
Adding requests:  47%|████▋     | 3888/8192 [00:09<00:10, 406.04it/s]
Adding requests:  48%|████▊     | 3931/8192 [00:10<00:10, 411.51it/s]
Adding requests:  48%|████▊     | 3973/8192 [00:10<00:10, 407.75it/s]
Adding requests:  49%|████▉     | 4014/8192 [00:10<00:10, 405.46it/s]
Adding requests:  49%|████▉     | 4055/8192 [00:10<00:10, 403.32it/s]
Adding requests:  50%|█████     | 4097/8192 [00:10<00:10, 405.65it/s]
Adding requests:  51%|█████     | 4138/8192 [00:10<00:09, 406.05it/s]
Adding requests:  51%|█████     | 4179/8192 [00:10<00:09, 402.40it/s]
Adding requests:  52%|█████▏    | 4221/8192 [00:10<00:09, 406.61it/s]
Adding requests:  52%|█████▏    | 4263/8192 [00:10<00:09, 408.84it/s]
Adding requests:  53%|█████▎    | 4304/8192 [00:11<00:10, 387.39it/s]
Adding requests:  53%|█████▎    | 4345/8192 [00:11<00:09, 393.35it/s]
Adding requests:  54%|█████▎    | 4386/8192 [00:11<00:09, 397.92it/s]
Adding requests:  54%|█████▍    | 4426/8192 [00:11<00:09, 397.60it/s]
Adding requests:  55%|█████▍    | 4469/8192 [00:11<00:09, 404.69it/s]
Adding requests:  55%|█████▌    | 4510/8192 [00:11<00:09, 399.77it/s]
Adding requests:  56%|█████▌    | 4551/8192 [00:11<00:09, 390.19it/s]
Adding requests:  56%|█████▌    | 4591/8192 [00:11<00:09, 383.12it/s]
Adding requests:  57%|█████▋    | 4630/8192 [00:11<00:09, 380.59it/s]
Adding requests:  57%|█████▋    | 4671/8192 [00:11<00:09, 388.31it/s]
Adding requests:  58%|█████▊    | 4713/8192 [00:12<00:08, 395.11it/s]
Adding requests:  58%|█████▊    | 4754/8192 [00:12<00:08, 398.70it/s]
Adding requests:  59%|█████▊    | 4794/8192 [00:12<00:08, 392.85it/s]
Adding requests:  59%|█████▉    | 4834/8192 [00:12<00:08, 389.19it/s]
Adding requests:  59%|█████▉    | 4873/8192 [00:12<00:08, 386.27it/s]
Adding requests:  60%|█████▉    | 4912/8192 [00:12<00:08, 380.94it/s]
Adding requests:  60%|██████    | 4951/8192 [00:12<00:08, 375.83it/s]
Adding requests:  61%|██████    | 4989/8192 [00:12<00:08, 374.15it/s]
Adding requests:  61%|██████▏   | 5028/8192 [00:12<00:08, 377.51it/s]
Adding requests:  62%|██████▏   | 5066/8192 [00:12<00:08, 376.54it/s]
Adding requests:  62%|██████▏   | 5105/8192 [00:13<00:08, 378.37it/s]
Adding requests:  63%|██████▎   | 5143/8192 [00:13<00:08, 377.86it/s]
Adding requests:  63%|██████▎   | 5183/8192 [00:13<00:07, 383.45it/s]
Adding requests:  64%|██████▍   | 5225/8192 [00:13<00:07, 391.26it/s]
Adding requests:  64%|██████▍   | 5267/8192 [00:13<00:07, 398.08it/s]
Adding requests:  65%|██████▍   | 5307/8192 [00:13<00:07, 398.42it/s]
Adding requests:  65%|██████▌   | 5347/8192 [00:13<00:07, 386.56it/s]
Adding requests:  66%|██████▌   | 5387/8192 [00:13<00:07, 390.18it/s]
Adding requests:  66%|██████▋   | 5429/8192 [00:13<00:06, 398.34it/s]
Adding requests:  67%|██████▋   | 5470/8192 [00:13<00:06, 399.86it/s]
Adding requests:  67%|██████▋   | 5511/8192 [00:14<00:06, 398.79it/s]
Adding requests:  68%|██████▊   | 5552/8192 [00:14<00:06, 399.49it/s]
Adding requests:  68%|██████▊   | 5592/8192 [00:14<00:06, 395.21it/s]
Adding requests:  69%|██████▉   | 5632/8192 [00:14<00:06, 393.08it/s]
Adding requests:  69%|██████▉   | 5672/8192 [00:14<00:06, 392.93it/s]
Adding requests:  70%|██████▉   | 5712/8192 [00:14<00:06, 394.85it/s]
Adding requests:  70%|███████   | 5752/8192 [00:14<00:06, 387.28it/s]
Adding requests:  71%|███████   | 5792/8192 [00:14<00:06, 390.89it/s]
Adding requests:  71%|███████   | 5832/8192 [00:14<00:06, 388.07it/s]
Adding requests:  72%|███████▏  | 5871/8192 [00:15<00:06, 385.34it/s]
Adding requests:  72%|███████▏  | 5910/8192 [00:15<00:05, 380.87it/s]
Adding requests:  73%|███████▎  | 5949/8192 [00:15<00:05, 378.90it/s]
Adding requests:  73%|███████▎  | 5991/8192 [00:15<00:05, 390.60it/s]
Adding requests:  74%|███████▎  | 6031/8192 [00:15<00:05, 388.45it/s]
Adding requests:  74%|███████▍  | 6072/8192 [00:15<00:05, 390.23it/s]
Adding requests:  75%|███████▍  | 6112/8192 [00:15<00:05, 381.81it/s]
Adding requests:  75%|███████▌  | 6152/8192 [00:15<00:05, 384.32it/s]
Adding requests:  76%|███████▌  | 6194/8192 [00:15<00:05, 394.64it/s]
Adding requests:  76%|███████▌  | 6238/8192 [00:15<00:04, 406.14it/s]
Adding requests:  77%|███████▋  | 6279/8192 [00:16<00:04, 401.73it/s]
Adding requests:  77%|███████▋  | 6320/8192 [00:16<00:04, 397.45it/s]
Adding requests:  78%|███████▊  | 6361/8192 [00:16<00:04, 399.19it/s]
Adding requests:  78%|███████▊  | 6402/8192 [00:16<00:04, 400.55it/s]
Adding requests:  79%|███████▊  | 6443/8192 [00:16<00:04, 400.33it/s]
Adding requests:  79%|███████▉  | 6484/8192 [00:16<00:04, 399.36it/s]
Adding requests:  80%|███████▉  | 6524/8192 [00:16<00:04, 398.20it/s]
Adding requests:  80%|████████  | 6564/8192 [00:16<00:04, 391.12it/s]
Adding requests:  81%|████████  | 6604/8192 [00:16<00:04, 390.73it/s]
Adding requests:  81%|████████  | 6644/8192 [00:16<00:03, 393.31it/s]
Adding requests:  82%|████████▏ | 6684/8192 [00:17<00:03, 392.61it/s]
Adding requests:  82%|████████▏ | 6725/8192 [00:17<00:03, 395.67it/s]
Adding requests:  83%|████████▎ | 6765/8192 [00:17<00:03, 387.10it/s]
Adding requests:  83%|████████▎ | 6807/8192 [00:17<00:03, 396.68it/s]
Adding requests:  84%|████████▎ | 6847/8192 [00:17<00:03, 393.49it/s]
Adding requests:  84%|████████▍ | 6889/8192 [00:17<00:03, 401.08it/s]
Adding requests:  85%|████████▍ | 6930/8192 [00:17<00:03, 390.06it/s]
Adding requests:  85%|████████▌ | 6970/8192 [00:17<00:03, 386.00it/s]
Adding requests:  86%|████████▌ | 7011/8192 [00:17<00:03, 391.58it/s]
Adding requests:  86%|████████▌ | 7051/8192 [00:18<00:02, 390.92it/s]
Adding requests:  87%|████████▋ | 7092/8192 [00:18<00:02, 394.69it/s]
Adding requests:  87%|████████▋ | 7132/8192 [00:18<00:02, 389.15it/s]
Adding requests:  88%|████████▊ | 7171/8192 [00:18<00:02, 388.60it/s]
Adding requests:  88%|████████▊ | 7212/8192 [00:18<00:02, 394.24it/s]
Adding requests:  89%|████████▊ | 7252/8192 [00:18<00:02, 387.53it/s]
Adding requests:  89%|████████▉ | 7293/8192 [00:18<00:02, 391.20it/s]
Adding requests:  90%|████████▉ | 7333/8192 [00:18<00:02, 387.95it/s]
Adding requests:  90%|████████▉ | 7372/8192 [00:18<00:02, 384.71it/s]
Adding requests:  90%|█████████ | 7413/8192 [00:18<00:01, 390.02it/s]
Adding requests:  91%|█████████ | 7455/8192 [00:19<00:01, 396.47it/s]
Adding requests:  92%|█████████▏| 7496/8192 [00:19<00:01, 397.84it/s]
Adding requests:  92%|█████████▏| 7537/8192 [00:19<00:01, 401.30it/s]
Adding requests:  93%|█████████▎| 7578/8192 [00:19<00:01, 393.69it/s]
Adding requests:  93%|█████████▎| 7618/8192 [00:19<00:01, 381.04it/s]
Adding requests:  94%|█████████▎| 7661/8192 [00:19<00:01, 392.93it/s]
Adding requests:  94%|█████████▍| 7703/8192 [00:19<00:01, 398.20it/s]
Adding requests:  95%|█████████▍| 7743/8192 [00:19<00:01, 395.44it/s]
Adding requests:  95%|█████████▌| 7783/8192 [00:19<00:01, 392.07it/s]
Adding requests:  95%|█████████▌| 7823/8192 [00:19<00:00, 390.07it/s]
Adding requests:  96%|█████████▌| 7865/8192 [00:20<00:00, 397.40it/s]
Adding requests:  96%|█████████▋| 7905/8192 [00:20<00:00, 397.21it/s]
Adding requests:  97%|█████████▋| 7946/8192 [00:20<00:00, 399.96it/s]
Adding requests:  97%|█████████▋| 7987/8192 [00:20<00:00, 399.76it/s]
Adding requests:  98%|█████████▊| 8027/8192 [00:20<00:00, 384.06it/s]
Adding requests:  99%|█████████▊| 8070/8192 [00:20<00:00, 396.10it/s]
Adding requests:  99%|█████████▉| 8112/8192 [00:20<00:00, 401.17it/s]
Adding requests: 100%|█████████▉| 8153/8192 [00:20<00:00, 401.53it/s]
Adding requests: 100%|██████████| 8192/8192 [00:20<00:00, 391.43it/s]

Processed prompts:   0%|          | 0/8192 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  33%|███▎      | 2716/8192 [00:00<00:00, 6279.77it/s, est. speed input: 6430800.45 toks/s, output: 6279.85 toks/s]
Processed prompts:  41%|████      | 3344/8192 [00:04<00:08, 539.26it/s, est. speed input: 710444.28 toks/s, output: 693.79 toks/s]   
Processed prompts:  44%|████▍     | 3611/8192 [00:06<00:11, 389.22it/s, est. speed input: 546063.33 toks/s, output: 533.26 toks/s]
Processed prompts:  46%|████▌     | 3763/8192 [00:08<00:14, 306.68it/s, est. speed input: 466885.28 toks/s, output: 455.94 toks/s]
Processed prompts:  47%|████▋     | 3859/8192 [00:08<00:14, 294.04it/s, est. speed input: 452407.51 toks/s, output: 441.80 toks/s]
Processed prompts:  48%|████▊     | 3928/8192 [00:09<00:15, 271.12it/s, est. speed input: 435742.81 toks/s, output: 425.53 toks/s]
Processed prompts:  49%|████▊     | 3978/8192 [00:09<00:17, 241.24it/s, est. speed input: 418699.00 toks/s, output: 408.89 toks/s]
Processed prompts:  49%|████▉     | 4015/8192 [00:10<00:19, 209.17it/s, est. speed input: 402628.93 toks/s, output: 393.19 toks/s]
Processed prompts:  50%|████▉     | 4060/8192 [00:10<00:22, 183.24it/s, est. speed input: 388474.22 toks/s, output: 379.37 toks/s]
Processed prompts:  50%|█████     | 4124/8192 [00:11<00:23, 170.73it/s, est. speed input: 377357.71 toks/s, output: 368.51 toks/s]
Processed prompts:  51%|█████     | 4188/8192 [00:11<00:24, 161.31it/s, est. speed input: 367442.53 toks/s, output: 358.83 toks/s]
Processed prompts:  52%|█████▏    | 4252/8192 [00:12<00:25, 153.14it/s, est. speed input: 358048.24 toks/s, output: 349.66 toks/s]
Processed prompts:  53%|█████▎    | 4316/8192 [00:12<00:26, 146.60it/s, est. speed input: 349258.68 toks/s, output: 341.07 toks/s]
Processed prompts:  53%|█████▎    | 4380/8192 [00:13<00:26, 141.51it/s, est. speed input: 341045.94 toks/s, output: 333.05 toks/s]
Processed prompts:  54%|█████▍    | 4444/8192 [00:13<00:27, 138.43it/s, est. speed input: 333613.70 toks/s, output: 325.79 toks/s]
Processed prompts:  55%|█████▌    | 4508/8192 [00:14<00:27, 136.17it/s, est. speed input: 326686.94 toks/s, output: 319.03 toks/s]
Processed prompts:  56%|█████▌    | 4572/8192 [00:14<00:26, 134.67it/s, est. speed input: 320256.91 toks/s, output: 312.75 toks/s]
Processed prompts:  57%|█████▋    | 4636/8192 [00:15<00:26, 132.95it/s, est. speed input: 314074.21 toks/s, output: 306.71 toks/s]
Processed prompts:  57%|█████▋    | 4700/8192 [00:15<00:26, 131.88it/s, est. speed input: 308316.45 toks/s, output: 301.09 toks/s]
Processed prompts:  58%|█████▊    | 4764/8192 [00:16<00:26, 131.31it/s, est. speed input: 302957.60 toks/s, output: 295.86 toks/s]
Processed prompts:  59%|█████▉    | 4828/8192 [00:16<00:25, 130.88it/s, est. speed input: 297911.23 toks/s, output: 290.93 toks/s]
Processed prompts:  60%|█████▉    | 4892/8192 [00:17<00:25, 130.34it/s, est. speed input: 293102.58 toks/s, output: 286.23 toks/s]
Processed prompts:  60%|██████    | 4956/8192 [00:17<00:24, 130.41it/s, est. speed input: 288659.07 toks/s, output: 281.89 toks/s]
Processed prompts:  61%|██████▏   | 5020/8192 [00:18<00:24, 130.42it/s, est. speed input: 284449.41 toks/s, output: 277.78 toks/s]
Processed prompts:  62%|██████▏   | 5084/8192 [00:18<00:23, 131.16it/s, est. speed input: 280598.99 toks/s, output: 274.02 toks/s]
Processed prompts:  63%|██████▎   | 5148/8192 [00:19<00:23, 130.96it/s, est. speed input: 276814.48 toks/s, output: 270.33 toks/s]
Processed prompts:  64%|██████▎   | 5212/8192 [00:19<00:22, 131.91it/s, est. speed input: 273408.98 toks/s, output: 267.00 toks/s]
Processed prompts:  64%|██████▍   | 5276/8192 [00:20<00:22, 131.42it/s, est. speed input: 269971.59 toks/s, output: 263.64 toks/s]
Processed prompts:  65%|██████▌   | 5340/8192 [00:20<00:21, 131.22it/s, est. speed input: 266722.80 toks/s, output: 260.47 toks/s]
Processed prompts:  66%|██████▌   | 5404/8192 [00:20<00:21, 131.02it/s, est. speed input: 263617.01 toks/s, output: 257.44 toks/s]
Processed prompts:  67%|██████▋   | 5468/8192 [00:21<00:20, 131.50it/s, est. speed input: 260744.73 toks/s, output: 254.63 toks/s]
Processed prompts:  68%|██████▊   | 5532/8192 [00:21<00:20, 131.14it/s, est. speed input: 257897.50 toks/s, output: 251.85 toks/s]
Processed prompts:  68%|██████▊   | 5596/8192 [00:22<00:19, 130.64it/s, est. speed input: 255140.72 toks/s, output: 249.16 toks/s]
Processed prompts:  69%|██████▉   | 5660/8192 [00:22<00:19, 131.05it/s, est. speed input: 252605.31 toks/s, output: 246.68 toks/s]
Processed prompts:  70%|██████▉   | 5724/8192 [00:23<00:18, 130.13it/s, est. speed input: 250014.89 toks/s, output: 244.15 toks/s]
Processed prompts:  71%|███████   | 5788/8192 [00:23<00:18, 129.75it/s, est. speed input: 247566.18 toks/s, output: 241.76 toks/s]
Processed prompts:  71%|███████▏  | 5852/8192 [00:24<00:18, 129.51it/s, est. speed input: 245220.78 toks/s, output: 239.47 toks/s]
Processed prompts:  72%|███████▏  | 5916/8192 [00:24<00:17, 130.48it/s, est. speed input: 243107.30 toks/s, output: 237.41 toks/s]
Processed prompts:  73%|███████▎  | 5980/8192 [00:25<00:17, 129.99it/s, est. speed input: 240935.18 toks/s, output: 235.29 toks/s]
Processed prompts:  74%|███████▍  | 6044/8192 [00:25<00:16, 129.98it/s, est. speed input: 238885.20 toks/s, output: 233.29 toks/s]
Processed prompts:  75%|███████▍  | 6108/8192 [00:26<00:16, 129.59it/s, est. speed input: 236867.83 toks/s, output: 231.32 toks/s]
Processed prompts:  75%|███████▌  | 6172/8192 [00:26<00:15, 130.37it/s, est. speed input: 235040.92 toks/s, output: 229.53 toks/s]
Processed prompts:  76%|███████▌  | 6236/8192 [00:27<00:15, 130.24it/s, est. speed input: 233206.82 toks/s, output: 227.74 toks/s]
Processed prompts:  77%|███████▋  | 6300/8192 [00:27<00:14, 129.64it/s, est. speed input: 231383.92 toks/s, output: 225.96 toks/s]
Processed prompts:  78%|███████▊  | 6364/8192 [00:28<00:14, 130.42it/s, est. speed input: 229746.93 toks/s, output: 224.36 toks/s]
Processed prompts:  78%|███████▊  | 6428/8192 [00:28<00:13, 129.80it/s, est. speed input: 228050.05 toks/s, output: 222.70 toks/s]
Processed prompts:  79%|███████▉  | 6492/8192 [00:29<00:13, 129.54it/s, est. speed input: 226426.79 toks/s, output: 221.12 toks/s]
Processed prompts:  80%|████████  | 6556/8192 [00:29<00:12, 130.34it/s, est. speed input: 224950.64 toks/s, output: 219.68 toks/s]
Processed prompts:  81%|████████  | 6620/8192 [00:30<00:12, 130.28it/s, est. speed input: 223464.23 toks/s, output: 218.23 toks/s]
Processed prompts:  82%|████████▏ | 6684/8192 [00:30<00:11, 129.60it/s, est. speed input: 221967.49 toks/s, output: 216.76 toks/s]
Processed prompts:  82%|████████▏ | 6748/8192 [00:31<00:11, 129.29it/s, est. speed input: 220532.14 toks/s, output: 215.36 toks/s]
Processed prompts:  83%|████████▎ | 6812/8192 [00:31<00:10, 129.62it/s, est. speed input: 219190.14 toks/s, output: 214.05 toks/s]
Processed prompts:  84%|████████▍ | 6876/8192 [00:32<00:10, 129.80it/s, est. speed input: 217885.05 toks/s, output: 212.78 toks/s]
Processed prompts:  85%|████████▍ | 6940/8192 [00:32<00:09, 129.22it/s, est. speed input: 216559.68 toks/s, output: 211.48 toks/s]
Processed prompts:  85%|████████▌ | 7004/8192 [00:33<00:09, 129.42it/s, est. speed input: 215322.99 toks/s, output: 210.28 toks/s]
Processed prompts:  86%|████████▋ | 7068/8192 [00:33<00:08, 130.23it/s, est. speed input: 214176.62 toks/s, output: 209.16 toks/s]
Processed prompts:  87%|████████▋ | 7132/8192 [00:34<00:08, 130.77it/s, est. speed input: 213060.66 toks/s, output: 208.07 toks/s]
Processed prompts:  88%|████████▊ | 7196/8192 [00:34<00:07, 129.98it/s, est. speed input: 211885.44 toks/s, output: 206.92 toks/s]
Processed prompts:  89%|████████▊ | 7260/8192 [00:35<00:07, 131.39it/s, est. speed input: 210891.33 toks/s, output: 205.95 toks/s]
Processed prompts:  89%|████████▉ | 7324/8192 [00:35<00:06, 130.47it/s, est. speed input: 209783.68 toks/s, output: 204.87 toks/s]
Processed prompts:  90%|█████████ | 7388/8192 [00:36<00:06, 131.04it/s, est. speed input: 208793.50 toks/s, output: 203.90 toks/s]
Processed prompts:  91%|█████████ | 7452/8192 [00:36<00:05, 130.27it/s, est. speed input: 207746.79 toks/s, output: 202.88 toks/s]
Processed prompts:  92%|█████████▏| 7516/8192 [00:37<00:05, 130.76it/s, est. speed input: 206799.49 toks/s, output: 201.95 toks/s]
Processed prompts:  93%|█████████▎| 7580/8192 [00:37<00:04, 131.21it/s, est. speed input: 205884.15 toks/s, output: 201.06 toks/s]
Processed prompts:  93%|█████████▎| 7644/8192 [00:38<00:04, 130.45it/s, est. speed input: 204919.23 toks/s, output: 200.12 toks/s]
Processed prompts:  94%|█████████▍| 7708/8192 [00:38<00:03, 130.31it/s, est. speed input: 204005.35 toks/s, output: 199.22 toks/s]
Processed prompts:  95%|█████████▍| 7772/8192 [00:39<00:03, 129.71it/s, est. speed input: 203081.72 toks/s, output: 198.32 toks/s]
Processed prompts:  96%|█████████▌| 7836/8192 [00:39<00:02, 129.40it/s, est. speed input: 202187.91 toks/s, output: 197.45 toks/s]
Processed prompts:  96%|█████████▋| 7900/8192 [00:40<00:02, 129.39it/s, est. speed input: 201329.71 toks/s, output: 196.61 toks/s]
Processed prompts:  97%|█████████▋| 7964/8192 [00:40<00:01, 129.10it/s, est. speed input: 200474.29 toks/s, output: 195.78 toks/s]
Processed prompts:  98%|█████████▊| 8028/8192 [00:41<00:01, 129.29it/s, est. speed input: 199664.02 toks/s, output: 194.98 toks/s]
Processed prompts:  99%|█████████▉| 8092/8192 [00:41<00:00, 130.05it/s, est. speed input: 198911.07 toks/s, output: 194.25 toks/s]
Processed prompts: 100%|█████████▉| 8156/8192 [00:41<00:00, 149.52it/s, est. speed input: 199152.73 toks/s, output: 194.48 toks/s]
Processed prompts: 100%|██████████| 8192/8192 [00:41<00:00, 149.52it/s, est. speed input: 200027.86 toks/s, output: 195.34 toks/s]
Processed prompts: 100%|██████████| 8192/8192 [00:41<00:00, 195.34it/s, est. speed input: 200027.86 toks/s, output: 195.34 toks/s]
[rank0]:[W125 17:25:59.427854865 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=512 ==========
Time: 2026-01-25 18:23:26
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_8
Params: prompt_len=512, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_8 --dataset-name random --input-len 512 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 513 --max-num-batched-tokens 513 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-3B-INT8_M512.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 18:23:34 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=301314) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=301314) WARNING 01-25 18:27:39 [backends.py:609] Failed to read file <frozen os>
Throughput: 20.59 requests/s, 10560.18 total tokens/s, 20.59 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128

STDERR:
[2026-01-25 18:23:34] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:23:34] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 18:23:34] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 18:23:34] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:23:34] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:23:34] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:23:34] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:23:34] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:23:34] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 18:23:34] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:23:34] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:23:34] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:23:34] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:23:34] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 18:23:42] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:23:42] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 18:23:42] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 18:23:42] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:23:42] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:23:42] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:23:42] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:23:42] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:23:42] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 18:23:42] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:23:42] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:23:42] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:23:42] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:23:42] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=301314) [2026-01-25 18:23:43] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=301314) [2026-01-25 18:23:43] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=301314) [2026-01-25 18:23:43] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=301314) [2026-01-25 18:23:43] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=301314) [2026-01-25 18:23:43] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-3B-INT8
(EngineCore_DP0 pid=301314) [2026-01-25 18:23:43] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=301314) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=301314) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [03:48<00:00, 228.16s/it]
(EngineCore_DP0 pid=301314) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [03:48<00:00, 228.16s/it]
(EngineCore_DP0 pid=301314) 
(EngineCore_DP0 pid=301314) [2026-01-25 18:27:31] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 4608] -> 1D uint8
(EngineCore_DP0 pid=301314) [2026-01-25 18:27:31] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 17694720 bytes
(EngineCore_DP0 pid=301314) [2026-01-25 18:27:31] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 4608] -> 1D uint8
(EngineCore_DP0 pid=301314) [2026-01-25 18:27:31] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 10616832 bytes
(EngineCore_DP0 pid=301314) [2026-01-25 18:27:31] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 4608] -> 1D uint8
(EngineCore_DP0 pid=301314) [2026-01-25 18:27:31] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 56623104 bytes
(EngineCore_DP0 pid=301314) [2026-01-25 18:27:31] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 12288] -> 1D uint8
(EngineCore_DP0 pid=301314) [2026-01-25 18:27:31] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 28311552 bytes
(EngineCore_DP0 pid=301314) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  2.31it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  2.30it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  2.30it/s]
(EngineCore_DP0 pid=301314) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00, 10.11it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  53%|█████▎    | 68/128 [00:00<00:00, 672.61it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 677.13it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:23,  5.51it/s, est. speed input: 2821.21 toks/s, output: 5.51 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:08, 13.86it/s, est. speed input: 6372.08 toks/s, output: 12.44 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:07, 17.07it/s, est. speed input: 7758.10 toks/s, output: 15.15 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:00<00:06, 18.76it/s, est. speed input: 8515.44 toks/s, output: 16.63 toks/s]
Processed prompts:  10%|█         | 13/128 [00:00<00:05, 19.85it/s, est. speed input: 9016.25 toks/s, output: 17.61 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:00<00:05, 20.11it/s, est. speed input: 9269.09 toks/s, output: 18.10 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:01<00:05, 20.42it/s, est. speed input: 9479.66 toks/s, output: 18.51 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:01<00:05, 20.97it/s, est. speed input: 9700.54 toks/s, output: 18.95 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:01<00:04, 21.35it/s, est. speed input: 9874.52 toks/s, output: 19.29 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:01<00:04, 21.65it/s, est. speed input: 10022.12 toks/s, output: 19.57 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:01<00:04, 21.33it/s, est. speed input: 10071.76 toks/s, output: 19.67 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:01<00:04, 21.51it/s, est. speed input: 10164.65 toks/s, output: 19.85 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:01<00:04, 21.63it/s, est. speed input: 10242.81 toks/s, output: 20.01 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:01<00:04, 21.64it/s, est. speed input: 10301.80 toks/s, output: 20.12 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:02<00:03, 21.79it/s, est. speed input: 10367.68 toks/s, output: 20.25 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:02<00:03, 21.90it/s, est. speed input: 10426.40 toks/s, output: 20.36 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:02<00:03, 21.82it/s, est. speed input: 10463.63 toks/s, output: 20.44 toks/s]
Processed prompts:  41%|████      | 52/128 [00:02<00:03, 21.87it/s, est. speed input: 10506.99 toks/s, output: 20.52 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:02<00:03, 21.82it/s, est. speed input: 10537.98 toks/s, output: 20.58 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:02<00:03, 21.64it/s, est. speed input: 10555.00 toks/s, output: 20.62 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:02<00:03, 21.74it/s, est. speed input: 10586.98 toks/s, output: 20.68 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:03<00:02, 21.83it/s, est. speed input: 10617.51 toks/s, output: 20.74 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:03<00:02, 21.94it/s, est. speed input: 10649.35 toks/s, output: 20.80 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:03<00:02, 21.94it/s, est. speed input: 10673.29 toks/s, output: 20.85 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:03<00:02, 21.98it/s, est. speed input: 10697.58 toks/s, output: 20.89 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:03<00:02, 21.81it/s, est. speed input: 10708.03 toks/s, output: 20.91 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:03<00:02, 21.63it/s, est. speed input: 10714.10 toks/s, output: 20.93 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:03<00:02, 21.73it/s, est. speed input: 10732.37 toks/s, output: 20.96 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:04<00:01, 21.67it/s, est. speed input: 10742.69 toks/s, output: 20.98 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:04<00:01, 21.51it/s, est. speed input: 10745.31 toks/s, output: 20.99 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:04<00:01, 21.68it/s, est. speed input: 10763.10 toks/s, output: 21.02 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:04<00:01, 21.85it/s, est. speed input: 10782.02 toks/s, output: 21.06 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:04<00:01, 21.95it/s, est. speed input: 10799.05 toks/s, output: 21.09 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:04<00:01, 21.87it/s, est. speed input: 10807.75 toks/s, output: 21.11 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:04<00:01, 21.95it/s, est. speed input: 10822.50 toks/s, output: 21.14 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:05<00:01, 21.98it/s, est. speed input: 10835.05 toks/s, output: 21.16 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:05<00:00, 21.95it/s, est. speed input: 10845.03 toks/s, output: 21.18 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:05<00:00, 22.06it/s, est. speed input: 10859.92 toks/s, output: 21.21 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:05<00:00, 21.74it/s, est. speed input: 10857.53 toks/s, output: 21.21 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:05<00:00, 21.56it/s, est. speed input: 10856.66 toks/s, output: 21.20 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:05<00:00, 21.48it/s, est. speed input: 10857.85 toks/s, output: 21.21 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:05<00:00, 21.42it/s, est. speed input: 10858.86 toks/s, output: 21.21 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:05<00:00, 21.55it/s, est. speed input: 10866.36 toks/s, output: 21.22 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:06<00:00, 21.55it/s, est. speed input: 10872.39 toks/s, output: 21.24 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:06<00:00, 21.23it/s, est. speed input: 10872.39 toks/s, output: 21.24 toks/s]
[rank0]:[W125 18:28:03.407194419 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=1024 ==========
Time: 2026-01-25 18:28:05
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 1025 --max-num-batched-tokens 1025 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-3B-INT8_M1024.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 18:28:14 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=305464) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=305464) WARNING 01-25 18:28:31 [backends.py:609] Failed to read file <frozen os>
Throughput: 20.77 requests/s, 21292.60 total tokens/s, 20.77 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128

STDERR:
[2026-01-25 18:28:14] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:28:14] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 18:28:14] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 18:28:14] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:28:14] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:28:14] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:28:14] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:28:14] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:28:14] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 18:28:14] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:28:14] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:28:14] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:28:14] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:28:14] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 18:28:21] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:28:21] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 18:28:21] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 18:28:21] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:28:21] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:28:21] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:28:21] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:28:21] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:28:21] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 18:28:21] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:28:21] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:28:21] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:28:21] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:28:21] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=305464) [2026-01-25 18:28:22] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=305464) [2026-01-25 18:28:22] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=305464) [2026-01-25 18:28:22] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=305464) [2026-01-25 18:28:22] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=305464) [2026-01-25 18:28:22] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-3B-INT8
(EngineCore_DP0 pid=305464) [2026-01-25 18:28:22] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=305464) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=305464) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.76it/s]
(EngineCore_DP0 pid=305464) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.76it/s]
(EngineCore_DP0 pid=305464) 
(EngineCore_DP0 pid=305464) [2026-01-25 18:28:23] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 4608] -> 1D uint8
(EngineCore_DP0 pid=305464) [2026-01-25 18:28:23] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 17694720 bytes
(EngineCore_DP0 pid=305464) [2026-01-25 18:28:23] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 4608] -> 1D uint8
(EngineCore_DP0 pid=305464) [2026-01-25 18:28:23] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 10616832 bytes
(EngineCore_DP0 pid=305464) [2026-01-25 18:28:23] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 4608] -> 1D uint8
(EngineCore_DP0 pid=305464) [2026-01-25 18:28:23] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 56623104 bytes
(EngineCore_DP0 pid=305464) [2026-01-25 18:28:23] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 12288] -> 1D uint8
(EngineCore_DP0 pid=305464) [2026-01-25 18:28:23] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 28311552 bytes
(EngineCore_DP0 pid=305464) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00, 10.65it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00, 10.64it/s]
(EngineCore_DP0 pid=305464) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00, 10.03it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  29%|██▉       | 37/128 [00:00<00:00, 361.96it/s]
Adding requests:  59%|█████▉    | 76/128 [00:00<00:00, 373.67it/s]
Adding requests:  89%|████████▉ | 114/128 [00:00<00:00, 375.00it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 371.51it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:02, 47.26it/s, est. speed input: 48402.29 toks/s, output: 47.26 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:00<00:04, 27.32it/s, est. speed input: 29866.13 toks/s, output: 29.16 toks/s]
Processed prompts:  11%|█         | 14/128 [00:00<00:04, 24.19it/s, est. speed input: 26728.65 toks/s, output: 26.10 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:00<00:04, 23.09it/s, est. speed input: 25601.18 toks/s, output: 25.00 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:00<00:04, 22.21it/s, est. speed input: 24760.41 toks/s, output: 24.18 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:00<00:04, 22.01it/s, est. speed input: 24377.65 toks/s, output: 23.81 toks/s]
Processed prompts:  20%|██        | 26/128 [00:01<00:04, 22.00it/s, est. speed input: 24145.16 toks/s, output: 23.58 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:01<00:04, 21.85it/s, est. speed input: 23906.92 toks/s, output: 23.35 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:01<00:04, 21.90it/s, est. speed input: 23770.38 toks/s, output: 23.21 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:01<00:04, 21.85it/s, est. speed input: 23632.86 toks/s, output: 23.08 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:01<00:04, 21.88it/s, est. speed input: 23539.17 toks/s, output: 22.99 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:01<00:03, 21.87it/s, est. speed input: 23448.28 toks/s, output: 22.90 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:01<00:03, 21.85it/s, est. speed input: 23368.25 toks/s, output: 22.82 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:02<00:03, 21.95it/s, est. speed input: 23325.77 toks/s, output: 22.78 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:02<00:03, 22.03it/s, est. speed input: 23291.53 toks/s, output: 22.75 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:02<00:03, 22.03it/s, est. speed input: 23247.91 toks/s, output: 22.70 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:02<00:03, 22.03it/s, est. speed input: 23210.16 toks/s, output: 22.67 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:02<00:03, 21.84it/s, est. speed input: 23141.52 toks/s, output: 22.60 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:02<00:03, 21.56it/s, est. speed input: 23052.24 toks/s, output: 22.51 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:02<00:02, 21.63it/s, est. speed input: 23017.08 toks/s, output: 22.48 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:03<00:02, 21.55it/s, est. speed input: 22965.03 toks/s, output: 22.43 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:03<00:02, 21.74it/s, est. speed input: 22955.18 toks/s, output: 22.42 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:03<00:02, 21.83it/s, est. speed input: 22938.52 toks/s, output: 22.40 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:03<00:02, 21.81it/s, est. speed input: 22912.19 toks/s, output: 22.38 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:03<00:02, 21.84it/s, est. speed input: 22894.59 toks/s, output: 22.36 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:03<00:02, 21.87it/s, est. speed input: 22878.88 toks/s, output: 22.34 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:03<00:01, 21.74it/s, est. speed input: 22845.50 toks/s, output: 22.31 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:04<00:01, 21.29it/s, est. speed input: 22770.00 toks/s, output: 22.24 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:04<00:01, 21.45it/s, est. speed input: 22755.64 toks/s, output: 22.22 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:04<00:01, 21.40it/s, est. speed input: 22723.85 toks/s, output: 22.19 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:04<00:01, 21.56it/s, est. speed input: 22715.76 toks/s, output: 22.18 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:04<00:01, 21.44it/s, est. speed input: 22683.36 toks/s, output: 22.15 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:04<00:01, 21.34it/s, est. speed input: 22651.32 toks/s, output: 22.12 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:04<00:00, 21.21it/s, est. speed input: 22614.91 toks/s, output: 22.08 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:04<00:00, 21.44it/s, est. speed input: 22612.42 toks/s, output: 22.08 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:05<00:00, 21.32it/s, est. speed input: 22582.42 toks/s, output: 22.05 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:05<00:00, 21.31it/s, est. speed input: 22561.67 toks/s, output: 22.03 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:05<00:00, 21.50it/s, est. speed input: 22559.57 toks/s, output: 22.03 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:05<00:00, 21.42it/s, est. speed input: 22539.30 toks/s, output: 22.01 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:05<00:00, 21.64it/s, est. speed input: 22543.36 toks/s, output: 22.01 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:05<00:00, 21.68it/s, est. speed input: 22536.96 toks/s, output: 22.01 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:05<00:00, 21.68it/s, est. speed input: 22536.96 toks/s, output: 22.01 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:05<00:00, 22.01it/s, est. speed input: 22536.96 toks/s, output: 22.01 toks/s]
[rank0]:[W125 18:28:55.590967051 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=2048 ==========
Time: 2026-01-25 18:28:57
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=256, max_num_seqs=2
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 256 --max-num-seqs 2 --max-model-len 1025 --max-num-batched-tokens 2048 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-3B-INT8_M2048.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 18:29:05 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=306404) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=306404) WARNING 01-25 18:29:23 [backends.py:609] Failed to read file <frozen os>
Throughput: 41.45 requests/s, 42483.37 total tokens/s, 41.45 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256

STDERR:
[2026-01-25 18:29:05] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:29:05] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 18:29:05] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 18:29:05] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:29:05] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:29:05] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:29:05] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:29:05] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:29:05] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 18:29:05] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:29:05] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:29:05] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:29:05] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:29:05] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 18:29:13] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:29:13] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 18:29:13] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 18:29:13] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:29:13] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:29:13] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:29:13] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:29:13] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:29:13] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 18:29:13] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:29:13] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:29:13] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:29:13] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:29:13] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=306404) [2026-01-25 18:29:14] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=306404) [2026-01-25 18:29:14] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=306404) [2026-01-25 18:29:14] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=306404) [2026-01-25 18:29:14] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=306404) [2026-01-25 18:29:14] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-3B-INT8
(EngineCore_DP0 pid=306404) [2026-01-25 18:29:14] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=306404) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=306404) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.71it/s]
(EngineCore_DP0 pid=306404) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.71it/s]
(EngineCore_DP0 pid=306404) 
(EngineCore_DP0 pid=306404) [2026-01-25 18:29:15] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 4608] -> 1D uint8
(EngineCore_DP0 pid=306404) [2026-01-25 18:29:15] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 17694720 bytes
(EngineCore_DP0 pid=306404) [2026-01-25 18:29:15] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 4608] -> 1D uint8
(EngineCore_DP0 pid=306404) [2026-01-25 18:29:15] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 10616832 bytes
(EngineCore_DP0 pid=306404) [2026-01-25 18:29:15] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 4608] -> 1D uint8
(EngineCore_DP0 pid=306404) [2026-01-25 18:29:15] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 56623104 bytes
(EngineCore_DP0 pid=306404) [2026-01-25 18:29:15] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 12288] -> 1D uint8
(EngineCore_DP0 pid=306404) [2026-01-25 18:29:15] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 28311552 bytes
(EngineCore_DP0 pid=306404) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  67%|██████▋   | 2/3 [00:00<00:00, 10.89it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00, 10.56it/s]
(EngineCore_DP0 pid=306404) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00, 10.43it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00, 10.42it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  14%|█▍        | 36/256 [00:00<00:00, 354.96it/s]
Adding requests:  29%|██▉       | 75/256 [00:00<00:00, 370.73it/s]
Adding requests:  45%|████▍     | 114/256 [00:00<00:00, 377.72it/s]
Adding requests:  60%|██████    | 154/256 [00:00<00:00, 383.06it/s]
Adding requests:  75%|███████▌  | 193/256 [00:00<00:00, 385.07it/s]
Adding requests:  92%|█████████▏| 236/256 [00:00<00:00, 396.73it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 388.53it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  10%|█         | 26/256 [00:00<00:01, 175.61it/s, est. speed input: 179851.91 toks/s, output: 175.62 toks/s]
Processed prompts:  17%|█▋        | 44/256 [00:00<00:03, 69.08it/s, est. speed input: 79267.57 toks/s, output: 77.41 toks/s]   
Processed prompts:  21%|██        | 54/256 [00:00<00:03, 59.33it/s, est. speed input: 69358.29 toks/s, output: 67.73 toks/s]
Processed prompts:  24%|██▍       | 62/256 [00:00<00:03, 54.43it/s, est. speed input: 64663.62 toks/s, output: 63.15 toks/s]
Processed prompts:  27%|██▋       | 69/256 [00:01<00:03, 53.60it/s, est. speed input: 63149.22 toks/s, output: 61.67 toks/s]
Processed prompts:  29%|██▉       | 75/256 [00:01<00:03, 50.30it/s, est. speed input: 60769.70 toks/s, output: 59.34 toks/s]
Processed prompts:  32%|███▏      | 81/256 [00:01<00:03, 48.23it/s, est. speed input: 59064.56 toks/s, output: 57.68 toks/s]
Processed prompts:  34%|███▎      | 86/256 [00:01<00:03, 44.88it/s, est. speed input: 57087.17 toks/s, output: 55.75 toks/s]
Processed prompts:  36%|███▌      | 92/256 [00:01<00:03, 44.52it/s, est. speed input: 56070.28 toks/s, output: 54.76 toks/s]
Processed prompts:  38%|███▊      | 98/256 [00:01<00:03, 44.16it/s, est. speed input: 55171.89 toks/s, output: 53.88 toks/s]
Processed prompts:  40%|████      | 103/256 [00:01<00:03, 45.17it/s, est. speed input: 54873.71 toks/s, output: 53.59 toks/s]
Processed prompts:  42%|████▏     | 108/256 [00:02<00:03, 42.06it/s, est. speed input: 53590.94 toks/s, output: 52.33 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:02<00:03, 42.09it/s, est. speed input: 52918.34 toks/s, output: 51.68 toks/s]
Processed prompts:  47%|████▋     | 120/256 [00:02<00:03, 42.34it/s, est. speed input: 52384.09 toks/s, output: 51.16 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:02<00:03, 42.45it/s, est. speed input: 51894.19 toks/s, output: 50.68 toks/s]
Processed prompts:  51%|█████     | 131/256 [00:02<00:02, 43.97it/s, est. speed input: 51816.04 toks/s, output: 50.60 toks/s]
Processed prompts:  53%|█████▎    | 136/256 [00:02<00:02, 40.66it/s, est. speed input: 50900.05 toks/s, output: 49.71 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:02<00:02, 41.71it/s, est. speed input: 50628.75 toks/s, output: 49.44 toks/s]
Processed prompts:  58%|█████▊    | 148/256 [00:03<00:02, 41.86it/s, est. speed input: 50277.64 toks/s, output: 49.10 toks/s]
Processed prompts:  60%|██████    | 154/256 [00:03<00:02, 42.22it/s, est. speed input: 50003.95 toks/s, output: 48.83 toks/s]
Processed prompts:  62%|██████▎   | 160/256 [00:03<00:02, 42.50it/s, est. speed input: 49758.62 toks/s, output: 48.59 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:03<00:02, 42.97it/s, est. speed input: 49575.25 toks/s, output: 48.41 toks/s]
Processed prompts:  67%|██████▋   | 172/256 [00:03<00:01, 43.25it/s, est. speed input: 49398.87 toks/s, output: 48.24 toks/s]
Processed prompts:  70%|██████▉   | 178/256 [00:03<00:01, 42.66it/s, est. speed input: 49122.38 toks/s, output: 47.97 toks/s]
Processed prompts:  72%|███████▏  | 184/256 [00:03<00:01, 42.62it/s, est. speed input: 48918.05 toks/s, output: 47.77 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:03<00:01, 42.97it/s, est. speed input: 48778.71 toks/s, output: 47.64 toks/s]
Processed prompts:  77%|███████▋  | 196/256 [00:04<00:01, 43.23it/s, est. speed input: 48649.71 toks/s, output: 47.51 toks/s]
Processed prompts:  79%|███████▉  | 202/256 [00:04<00:01, 43.42it/s, est. speed input: 48530.44 toks/s, output: 47.39 toks/s]
Processed prompts:  81%|████████▏ | 208/256 [00:04<00:01, 42.76it/s, est. speed input: 48324.17 toks/s, output: 47.19 toks/s]
Processed prompts:  84%|████████▎ | 214/256 [00:04<00:00, 42.82it/s, est. speed input: 48190.90 toks/s, output: 47.06 toks/s]
Processed prompts:  86%|████████▌ | 220/256 [00:04<00:00, 42.89it/s, est. speed input: 48069.51 toks/s, output: 46.94 toks/s]
Processed prompts:  88%|████████▊ | 226/256 [00:04<00:00, 42.71it/s, est. speed input: 47929.07 toks/s, output: 46.81 toks/s]
Processed prompts:  91%|█████████ | 232/256 [00:04<00:00, 42.90it/s, est. speed input: 47831.07 toks/s, output: 46.71 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:05<00:00, 43.11it/s, est. speed input: 47745.62 toks/s, output: 46.63 toks/s]
Processed prompts:  95%|█████████▌| 244/256 [00:05<00:00, 43.26it/s, est. speed input: 47664.83 toks/s, output: 46.55 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:05<00:00, 43.32it/s, est. speed input: 47583.17 toks/s, output: 46.47 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:05<00:00, 43.55it/s, est. speed input: 47523.19 toks/s, output: 46.41 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:05<00:00, 43.55it/s, est. speed input: 47523.19 toks/s, output: 46.41 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:05<00:00, 46.41it/s, est. speed input: 47523.19 toks/s, output: 46.41 toks/s]
[rank0]:[W125 18:29:47.803973355 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=4096 ==========
Time: 2026-01-25 18:29:49
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=512, max_num_seqs=4
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 512 --max-num-seqs 4 --max-model-len 1025 --max-num-batched-tokens 4096 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-3B-INT8_M4096.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 18:29:59 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=307404) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=307404) WARNING 01-25 18:30:17 [backends.py:609] Failed to read file <frozen os>
Throughput: 50.96 requests/s, 52237.74 total tokens/s, 50.96 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512

STDERR:
[2026-01-25 18:29:59] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:29:59] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 18:29:59] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 18:29:59] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:29:59] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:29:59] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:29:59] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:29:59] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:29:59] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 18:29:59] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:29:59] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:29:59] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:29:59] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:29:59] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 18:30:07] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:30:07] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 18:30:07] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 18:30:07] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:30:07] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:30:07] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:30:07] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:30:07] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:30:07] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 18:30:07] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:30:07] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:30:07] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:30:07] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:30:07] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=307404) [2026-01-25 18:30:08] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=307404) [2026-01-25 18:30:08] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=307404) [2026-01-25 18:30:08] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=307404) [2026-01-25 18:30:08] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=307404) [2026-01-25 18:30:08] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-3B-INT8
(EngineCore_DP0 pid=307404) [2026-01-25 18:30:08] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=307404) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=307404) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.77it/s]
(EngineCore_DP0 pid=307404) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.77it/s]
(EngineCore_DP0 pid=307404) 
(EngineCore_DP0 pid=307404) [2026-01-25 18:30:09] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 4608] -> 1D uint8
(EngineCore_DP0 pid=307404) [2026-01-25 18:30:09] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 17694720 bytes
(EngineCore_DP0 pid=307404) [2026-01-25 18:30:09] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 4608] -> 1D uint8
(EngineCore_DP0 pid=307404) [2026-01-25 18:30:09] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 10616832 bytes
(EngineCore_DP0 pid=307404) [2026-01-25 18:30:09] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 4608] -> 1D uint8
(EngineCore_DP0 pid=307404) [2026-01-25 18:30:09] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 56623104 bytes
(EngineCore_DP0 pid=307404) [2026-01-25 18:30:09] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 12288] -> 1D uint8
(EngineCore_DP0 pid=307404) [2026-01-25 18:30:09] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 28311552 bytes
(EngineCore_DP0 pid=307404) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 2/4 [00:00<00:00, 10.62it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00, 10.46it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00, 10.48it/s]
(EngineCore_DP0 pid=307404) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  33%|███▎      | 1/3 [00:00<00:00,  8.94it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00, 10.61it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00, 10.41it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   7%|▋         | 36/512 [00:00<00:01, 358.10it/s]
Adding requests:  14%|█▍        | 74/512 [00:00<00:01, 366.29it/s]
Adding requests:  22%|██▏       | 112/512 [00:00<00:01, 368.22it/s]
Adding requests:  30%|██▉       | 152/512 [00:00<00:00, 377.52it/s]
Adding requests:  38%|███▊      | 193/512 [00:00<00:00, 385.28it/s]
Adding requests:  45%|████▌     | 232/512 [00:00<00:00, 384.52it/s]
Adding requests:  53%|█████▎    | 271/512 [00:00<00:00, 381.80it/s]
Adding requests:  61%|██████    | 310/512 [00:00<00:00, 382.69it/s]
Adding requests:  69%|██████▊   | 351/512 [00:00<00:00, 388.49it/s]
Adding requests:  76%|███████▌  | 390/512 [00:01<00:00, 383.06it/s]
Adding requests:  84%|████████▍ | 429/512 [00:01<00:00, 384.22it/s]
Adding requests:  92%|█████████▏| 470/512 [00:01<00:00, 390.38it/s]
Adding requests: 100%|█████████▉| 510/512 [00:01<00:00, 391.80it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 384.45it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  14%|█▎        | 70/512 [00:00<00:00, 454.22it/s, est. speed input: 465172.11 toks/s, output: 454.23 toks/s]
Processed prompts:  23%|██▎       | 116/512 [00:01<00:04, 98.49it/s, est. speed input: 117519.15 toks/s, output: 114.76 toks/s]
Processed prompts:  27%|██▋       | 138/512 [00:01<00:04, 77.42it/s, est. speed input: 95570.01 toks/s, output: 93.33 toks/s]  
Processed prompts:  30%|██▉       | 153/512 [00:01<00:04, 74.31it/s, est. speed input: 91407.44 toks/s, output: 89.26 toks/s]
Processed prompts:  32%|███▏      | 165/512 [00:01<00:05, 68.66it/s, est. speed input: 86714.45 toks/s, output: 84.68 toks/s]
Processed prompts:  34%|███▍      | 174/512 [00:02<00:05, 60.81it/s, est. speed input: 81612.83 toks/s, output: 79.70 toks/s]
Processed prompts:  36%|███▌      | 182/512 [00:02<00:05, 58.92it/s, est. speed input: 79671.38 toks/s, output: 77.80 toks/s]
Processed prompts:  37%|███▋      | 190/512 [00:02<00:05, 57.15it/s, est. speed input: 77935.25 toks/s, output: 76.11 toks/s]
Processed prompts:  39%|███▊      | 198/512 [00:02<00:05, 55.83it/s, est. speed input: 76469.14 toks/s, output: 74.68 toks/s]
Processed prompts:  40%|████      | 206/512 [00:02<00:05, 54.65it/s, est. speed input: 75130.01 toks/s, output: 73.37 toks/s]
Processed prompts:  42%|████▏     | 214/512 [00:02<00:05, 53.72it/s, est. speed input: 73930.35 toks/s, output: 72.20 toks/s]
Processed prompts:  43%|████▎     | 222/512 [00:03<00:05, 53.06it/s, est. speed input: 72863.87 toks/s, output: 71.16 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:03<00:05, 52.60it/s, est. speed input: 71904.37 toks/s, output: 70.22 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:03<00:05, 52.15it/s, est. speed input: 71006.36 toks/s, output: 69.34 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:03<00:05, 51.81it/s, est. speed input: 70185.45 toks/s, output: 68.54 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:03<00:04, 51.65it/s, est. speed input: 69447.90 toks/s, output: 67.82 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:03<00:04, 51.58it/s, est. speed input: 68777.35 toks/s, output: 67.17 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:04<00:04, 51.37it/s, est. speed input: 68131.05 toks/s, output: 66.53 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:04<00:04, 51.31it/s, est. speed input: 67547.18 toks/s, output: 65.96 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:04<00:04, 51.19it/s, est. speed input: 66993.04 toks/s, output: 65.42 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:04<00:04, 51.16it/s, est. speed input: 66485.30 toks/s, output: 64.93 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:04<00:04, 51.16it/s, est. speed input: 66014.55 toks/s, output: 64.47 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:04<00:03, 51.05it/s, est. speed input: 65559.75 toks/s, output: 64.02 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:04<00:03, 51.15it/s, est. speed input: 65156.46 toks/s, output: 63.63 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:05<00:03, 51.18it/s, est. speed input: 64772.08 toks/s, output: 63.25 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:05<00:03, 51.14it/s, est. speed input: 64403.41 toks/s, output: 62.89 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:05<00:03, 52.39it/s, est. speed input: 64205.42 toks/s, output: 62.70 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:05<00:03, 52.09it/s, est. speed input: 63883.93 toks/s, output: 62.39 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:05<00:02, 51.79it/s, est. speed input: 63570.82 toks/s, output: 62.08 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:05<00:02, 51.52it/s, est. speed input: 63266.86 toks/s, output: 61.78 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [00:06<00:02, 51.36it/s, est. speed input: 62981.69 toks/s, output: 61.51 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [00:06<00:02, 51.32it/s, est. speed input: 62718.10 toks/s, output: 61.25 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [00:06<00:02, 51.25it/s, est. speed input: 62463.16 toks/s, output: 61.00 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [00:06<00:02, 51.22it/s, est. speed input: 62222.51 toks/s, output: 60.76 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [00:06<00:02, 51.22it/s, est. speed input: 61994.39 toks/s, output: 60.54 toks/s]
Processed prompts:  81%|████████  | 414/512 [00:06<00:01, 51.12it/s, est. speed input: 61768.01 toks/s, output: 60.32 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [00:07<00:01, 51.13it/s, est. speed input: 61558.73 toks/s, output: 60.12 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [00:07<00:01, 51.15it/s, est. speed input: 61360.42 toks/s, output: 59.92 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [00:07<00:01, 51.16it/s, est. speed input: 61169.31 toks/s, output: 59.74 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [00:07<00:01, 51.05it/s, est. speed input: 60977.24 toks/s, output: 59.55 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [00:07<00:01, 52.64it/s, est. speed input: 60924.54 toks/s, output: 59.50 toks/s]
Processed prompts:  90%|█████████ | 462/512 [00:07<00:00, 52.18it/s, est. speed input: 60752.06 toks/s, output: 59.33 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [00:07<00:00, 51.77it/s, est. speed input: 60579.96 toks/s, output: 59.16 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [00:08<00:00, 51.45it/s, est. speed input: 60411.40 toks/s, output: 59.00 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [00:08<00:00, 51.30it/s, est. speed input: 60255.12 toks/s, output: 58.84 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [00:08<00:00, 51.20it/s, est. speed input: 60104.97 toks/s, output: 58.70 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [00:08<00:00, 51.12it/s, est. speed input: 59959.42 toks/s, output: 58.55 toks/s]
Processed prompts: 100%|█████████▉| 510/512 [00:08<00:00, 52.82it/s, est. speed input: 59938.20 toks/s, output: 58.53 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:08<00:00, 52.82it/s, est. speed input: 60171.66 toks/s, output: 58.76 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:08<00:00, 58.76it/s, est. speed input: 60171.66 toks/s, output: 58.76 toks/s]
[rank0]:[W125 18:30:46.516052727 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=8192 ==========
Time: 2026-01-25 18:30:48
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=1024, max_num_seqs=8
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 1024 --max-num-seqs 8 --max-model-len 1025 --max-num-batched-tokens 8192 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-3B-INT8_M8192.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 18:31:00 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=308475) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=308475) WARNING 01-25 18:31:18 [backends.py:609] Failed to read file <frozen os>
Throughput: 52.31 requests/s, 53616.80 total tokens/s, 52.31 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024

STDERR:
[2026-01-25 18:31:00] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:31:00] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 18:31:00] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 18:31:00] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:31:00] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:31:00] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:31:00] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:31:00] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:31:00] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 18:31:00] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:31:00] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:31:00] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:31:00] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:31:00] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 18:31:08] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:31:08] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 18:31:08] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 18:31:08] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:31:08] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:31:08] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:31:08] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:31:08] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:31:08] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 18:31:08] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:31:08] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:31:08] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:31:08] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:31:08] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=308475) [2026-01-25 18:31:09] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=308475) [2026-01-25 18:31:09] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=308475) [2026-01-25 18:31:09] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=308475) [2026-01-25 18:31:09] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=308475) [2026-01-25 18:31:09] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-3B-INT8
(EngineCore_DP0 pid=308475) [2026-01-25 18:31:09] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=308475) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=308475) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.77it/s]
(EngineCore_DP0 pid=308475) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.77it/s]
(EngineCore_DP0 pid=308475) 
(EngineCore_DP0 pid=308475) [2026-01-25 18:31:10] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 4608] -> 1D uint8
(EngineCore_DP0 pid=308475) [2026-01-25 18:31:10] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 17694720 bytes
(EngineCore_DP0 pid=308475) [2026-01-25 18:31:10] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 4608] -> 1D uint8
(EngineCore_DP0 pid=308475) [2026-01-25 18:31:10] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 10616832 bytes
(EngineCore_DP0 pid=308475) [2026-01-25 18:31:10] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 4608] -> 1D uint8
(EngineCore_DP0 pid=308475) [2026-01-25 18:31:10] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 56623104 bytes
(EngineCore_DP0 pid=308475) [2026-01-25 18:31:10] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 12288] -> 1D uint8
(EngineCore_DP0 pid=308475) [2026-01-25 18:31:10] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 28311552 bytes
(EngineCore_DP0 pid=308475) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  40%|████      | 2/5 [00:00<00:00, 10.45it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  80%|████████  | 4/5 [00:00<00:00, 11.09it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00, 10.69it/s]
(EngineCore_DP0 pid=308475) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:00,  9.82it/s]
Capturing CUDA graphs (decode, FULL):  75%|███████▌  | 3/4 [00:00<00:00, 10.83it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00, 10.95it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   4%|▎         | 38/1024 [00:00<00:02, 372.34it/s]
Adding requests:   8%|▊         | 79/1024 [00:00<00:02, 390.20it/s]
Adding requests:  12%|█▏        | 119/1024 [00:00<00:02, 384.79it/s]
Adding requests:  15%|█▌        | 158/1024 [00:00<00:02, 385.03it/s]
Adding requests:  19%|█▉        | 197/1024 [00:00<00:02, 378.82it/s]
Adding requests:  23%|██▎       | 236/1024 [00:00<00:02, 381.84it/s]
Adding requests:  27%|██▋       | 275/1024 [00:00<00:01, 383.84it/s]
Adding requests:  31%|███       | 314/1024 [00:00<00:01, 384.54it/s]
Adding requests:  35%|███▍      | 355/1024 [00:00<00:01, 390.39it/s]
Adding requests:  39%|███▊      | 396/1024 [00:01<00:01, 393.71it/s]
Adding requests:  43%|████▎     | 436/1024 [00:01<00:01, 386.66it/s]
Adding requests:  47%|████▋     | 477/1024 [00:01<00:01, 391.22it/s]
Adding requests:  50%|█████     | 517/1024 [00:01<00:01, 393.06it/s]
Adding requests:  54%|█████▍    | 557/1024 [00:01<00:01, 382.74it/s]
Adding requests:  58%|█████▊    | 598/1024 [00:01<00:01, 388.02it/s]
Adding requests:  62%|██████▎   | 640/1024 [00:01<00:00, 395.76it/s]
Adding requests:  67%|██████▋   | 683/1024 [00:01<00:00, 404.26it/s]
Adding requests:  71%|███████   | 724/1024 [00:01<00:00, 403.99it/s]
Adding requests:  75%|███████▍  | 765/1024 [00:01<00:00, 397.84it/s]
Adding requests:  79%|███████▊  | 805/1024 [00:02<00:00, 392.95it/s]
Adding requests:  83%|████████▎ | 845/1024 [00:02<00:00, 382.56it/s]
Adding requests:  86%|████████▋ | 884/1024 [00:02<00:00, 383.15it/s]
Adding requests:  90%|█████████ | 924/1024 [00:02<00:00, 385.48it/s]
Adding requests:  94%|█████████▍| 963/1024 [00:02<00:00, 386.64it/s]
Adding requests:  98%|█████████▊| 1002/1024 [00:02<00:00, 386.18it/s]
Adding requests: 100%|██████████| 1024/1024 [00:02<00:00, 388.51it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  13%|█▎        | 138/1024 [00:00<00:01, 692.40it/s, est. speed input: 709092.36 toks/s, output: 692.42 toks/s]
Processed prompts:  20%|██        | 208/1024 [00:01<00:06, 122.41it/s, est. speed input: 149913.96 toks/s, output: 146.40 toks/s]
Processed prompts:  23%|██▎       | 240/1024 [00:02<00:08, 95.10it/s, est. speed input: 121010.20 toks/s, output: 118.17 toks/s] 
Processed prompts:  25%|██▌       | 260/1024 [00:02<00:09, 79.92it/s, est. speed input: 106968.42 toks/s, output: 104.46 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:02<00:10, 72.45it/s, est. speed input: 100413.77 toks/s, output: 98.06 toks/s] 
Processed prompts:  28%|██▊       | 285/1024 [00:02<00:10, 72.38it/s, est. speed input: 99025.35 toks/s, output: 96.70 toks/s] 
Processed prompts:  29%|██▉       | 295/1024 [00:03<00:10, 71.28it/s, est. speed input: 97457.95 toks/s, output: 95.17 toks/s]
Processed prompts:  30%|██▉       | 304/1024 [00:03<00:10, 68.88it/s, est. speed input: 95689.97 toks/s, output: 93.45 toks/s]
Processed prompts:  30%|███       | 312/1024 [00:03<00:10, 65.42it/s, est. speed input: 93811.98 toks/s, output: 91.61 toks/s]
Processed prompts:  31%|███       | 319/1024 [00:03<00:11, 60.86it/s, est. speed input: 91797.38 toks/s, output: 89.65 toks/s]
Processed prompts:  32%|███▏      | 326/1024 [00:03<00:12, 57.16it/s, est. speed input: 89962.20 toks/s, output: 87.85 toks/s]
Processed prompts:  32%|███▏      | 332/1024 [00:03<00:13, 52.34it/s, est. speed input: 87963.66 toks/s, output: 85.90 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:04<00:13, 49.94it/s, est. speed input: 86428.86 toks/s, output: 84.40 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:04<00:13, 50.54it/s, est. speed input: 85204.56 toks/s, output: 83.21 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:04<00:13, 51.14it/s, est. speed input: 84100.37 toks/s, output: 82.13 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:04<00:12, 51.39it/s, est. speed input: 83035.83 toks/s, output: 81.09 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:04<00:12, 51.70it/s, est. speed input: 82066.69 toks/s, output: 80.14 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:04<00:12, 51.93it/s, est. speed input: 81161.77 toks/s, output: 79.26 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:04<00:12, 51.97it/s, est. speed input: 80292.66 toks/s, output: 78.41 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [00:05<00:12, 52.11it/s, est. speed input: 79492.82 toks/s, output: 77.63 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:05<00:11, 52.20it/s, est. speed input: 78738.94 toks/s, output: 76.89 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:05<00:11, 52.23it/s, est. speed input: 78022.66 toks/s, output: 76.19 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:05<00:11, 52.31it/s, est. speed input: 77354.94 toks/s, output: 75.54 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:05<00:11, 52.37it/s, est. speed input: 76722.54 toks/s, output: 74.92 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:05<00:11, 52.35it/s, est. speed input: 76116.41 toks/s, output: 74.33 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:05<00:11, 52.30it/s, est. speed input: 75535.74 toks/s, output: 73.77 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:06<00:10, 54.07it/s, est. speed input: 75192.75 toks/s, output: 73.43 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:06<00:10, 53.43it/s, est. speed input: 74654.95 toks/s, output: 72.90 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:06<00:10, 53.17it/s, est. speed input: 74162.95 toks/s, output: 72.42 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:06<00:10, 53.00it/s, est. speed input: 73694.33 toks/s, output: 71.97 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:06<00:10, 52.64it/s, est. speed input: 73221.29 toks/s, output: 71.50 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:06<00:10, 52.57it/s, est. speed input: 72788.00 toks/s, output: 71.08 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:07<00:10, 52.35it/s, est. speed input: 72356.78 toks/s, output: 70.66 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:07<00:09, 52.44it/s, est. speed input: 71967.86 toks/s, output: 70.28 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:07<00:09, 52.30it/s, est. speed input: 71575.29 toks/s, output: 69.90 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:07<00:09, 52.42it/s, est. speed input: 71219.05 toks/s, output: 69.55 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:07<00:09, 52.39it/s, est. speed input: 70866.42 toks/s, output: 69.21 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:07<00:09, 52.38it/s, est. speed input: 70529.11 toks/s, output: 68.88 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:07<00:09, 52.44it/s, est. speed input: 70210.78 toks/s, output: 68.57 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:08<00:08, 52.40it/s, est. speed input: 69896.65 toks/s, output: 68.26 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:08<00:08, 52.31it/s, est. speed input: 69589.17 toks/s, output: 67.96 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:08<00:08, 52.40it/s, est. speed input: 69305.89 toks/s, output: 67.68 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:08<00:08, 52.40it/s, est. speed input: 69027.47 toks/s, output: 67.41 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:08<00:08, 52.42it/s, est. speed input: 68760.19 toks/s, output: 67.15 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:08<00:08, 52.44it/s, est. speed input: 68502.24 toks/s, output: 66.90 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:09<00:08, 52.42it/s, est. speed input: 68251.03 toks/s, output: 66.65 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:09<00:07, 52.35it/s, est. speed input: 68003.19 toks/s, output: 66.41 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:09<00:07, 52.42it/s, est. speed input: 67772.87 toks/s, output: 66.18 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:09<00:07, 52.41it/s, est. speed input: 67545.61 toks/s, output: 65.96 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:09<00:07, 52.44it/s, est. speed input: 67328.06 toks/s, output: 65.75 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:09<00:07, 52.45it/s, est. speed input: 67116.58 toks/s, output: 65.54 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:09<00:07, 52.39it/s, est. speed input: 66907.12 toks/s, output: 65.34 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:10<00:06, 52.36it/s, est. speed input: 66704.53 toks/s, output: 65.14 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:10<00:06, 52.34it/s, est. speed input: 66508.40 toks/s, output: 64.95 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:10<00:06, 52.28it/s, est. speed input: 66315.24 toks/s, output: 64.76 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:10<00:06, 52.38it/s, est. speed input: 66135.83 toks/s, output: 64.59 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:10<00:06, 52.39it/s, est. speed input: 65958.36 toks/s, output: 64.41 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:10<00:06, 52.36it/s, est. speed input: 65783.63 toks/s, output: 64.24 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:11<00:06, 52.29it/s, est. speed input: 65610.93 toks/s, output: 64.07 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:11<00:05, 52.27it/s, est. speed input: 65444.67 toks/s, output: 63.91 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:11<00:05, 52.21it/s, est. speed input: 65280.27 toks/s, output: 63.75 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:11<00:05, 52.34it/s, est. speed input: 65129.58 toks/s, output: 63.60 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:11<00:05, 52.35it/s, est. speed input: 64978.33 toks/s, output: 63.46 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:11<00:05, 52.28it/s, est. speed input: 64827.36 toks/s, output: 63.31 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:11<00:05, 52.41it/s, est. speed input: 64689.23 toks/s, output: 63.17 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:12<00:05, 52.38it/s, est. speed input: 64548.54 toks/s, output: 63.04 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:12<00:04, 52.31it/s, est. speed input: 64408.83 toks/s, output: 62.90 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:12<00:04, 52.23it/s, est. speed input: 64271.18 toks/s, output: 62.76 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:12<00:04, 52.31it/s, est. speed input: 64143.55 toks/s, output: 62.64 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:12<00:04, 52.33it/s, est. speed input: 64016.80 toks/s, output: 62.52 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:12<00:04, 52.26it/s, est. speed input: 63889.34 toks/s, output: 62.39 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:13<00:04, 52.31it/s, est. speed input: 63770.00 toks/s, output: 62.28 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:13<00:03, 52.32it/s, est. speed input: 63651.44 toks/s, output: 62.16 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:13<00:03, 52.23it/s, est. speed input: 63531.63 toks/s, output: 62.04 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:13<00:03, 52.35it/s, est. speed input: 63422.84 toks/s, output: 61.94 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [00:13<00:03, 52.26it/s, est. speed input: 63308.89 toks/s, output: 61.82 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [00:13<00:03, 52.31it/s, est. speed input: 63201.97 toks/s, output: 61.72 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:13<00:03, 52.28it/s, est. speed input: 63094.67 toks/s, output: 61.62 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [00:14<00:03, 52.31it/s, est. speed input: 62992.22 toks/s, output: 61.52 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [00:14<00:02, 52.25it/s, est. speed input: 62888.51 toks/s, output: 61.41 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [00:14<00:02, 52.28it/s, est. speed input: 62789.67 toks/s, output: 61.32 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [00:14<00:02, 52.26it/s, est. speed input: 62691.50 toks/s, output: 61.22 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [00:14<00:02, 52.16it/s, est. speed input: 62591.64 toks/s, output: 61.12 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [00:14<00:02, 52.14it/s, est. speed input: 62496.12 toks/s, output: 61.03 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [00:14<00:02, 52.18it/s, est. speed input: 62404.30 toks/s, output: 60.94 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [00:15<00:01, 52.23it/s, est. speed input: 62315.54 toks/s, output: 60.85 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [00:15<00:01, 52.22it/s, est. speed input: 62226.94 toks/s, output: 60.77 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [00:15<00:01, 53.99it/s, est. speed input: 62207.33 toks/s, output: 60.75 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [00:15<00:01, 53.38it/s, est. speed input: 62119.25 toks/s, output: 60.66 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [00:15<00:01, 53.06it/s, est. speed input: 62036.17 toks/s, output: 60.58 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [00:15<00:01, 52.82it/s, est. speed input: 61954.43 toks/s, output: 60.50 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [00:16<00:01, 52.60it/s, est. speed input: 61871.94 toks/s, output: 60.42 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [00:16<00:00, 52.52it/s, est. speed input: 61793.78 toks/s, output: 60.35 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [00:16<00:00, 54.31it/s, est. speed input: 61782.45 toks/s, output: 60.33 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [00:16<00:00, 53.61it/s, est. speed input: 61703.21 toks/s, output: 60.26 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [00:16<00:00, 52.98it/s, est. speed input: 61620.60 toks/s, output: 60.18 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [00:16<00:00, 52.76it/s, est. speed input: 61546.49 toks/s, output: 60.10 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [00:16<00:00, 54.64it/s, est. speed input: 61542.35 toks/s, output: 60.10 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:16<00:00, 54.64it/s, est. speed input: 61904.17 toks/s, output: 60.45 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:16<00:00, 60.45it/s, est. speed input: 61904.17 toks/s, output: 60.45 toks/s]
[rank0]:[W125 18:31:56.399222979 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=16384 ==========
Time: 2026-01-25 18:31:58
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=2048, max_num_seqs=16
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 2048 --max-num-seqs 16 --max-model-len 1025 --max-num-batched-tokens 16384 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-3B-INT8_M16384.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 18:32:17 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=309751) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=309751) WARNING 01-25 18:32:34 [backends.py:609] Failed to read file <frozen os>
Throughput: 53.71 requests/s, 55054.73 total tokens/s, 53.71 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048

STDERR:
[2026-01-25 18:32:16] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:32:16] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 18:32:16] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 18:32:16] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:32:16] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:32:16] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:32:17] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:32:17] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:32:17] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 18:32:17] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:32:17] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:32:17] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:32:17] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:32:17] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 18:32:24] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:32:24] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 18:32:24] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 18:32:24] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:32:24] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:32:24] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:32:24] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:32:24] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:32:24] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 18:32:24] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:32:24] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:32:24] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:32:24] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:32:24] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=309751) [2026-01-25 18:32:25] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=309751) [2026-01-25 18:32:25] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=309751) [2026-01-25 18:32:25] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=309751) [2026-01-25 18:32:25] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=309751) [2026-01-25 18:32:25] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-3B-INT8
(EngineCore_DP0 pid=309751) [2026-01-25 18:32:25] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=309751) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=309751) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.76it/s]
(EngineCore_DP0 pid=309751) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.76it/s]
(EngineCore_DP0 pid=309751) 
(EngineCore_DP0 pid=309751) [2026-01-25 18:32:26] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 4608] -> 1D uint8
(EngineCore_DP0 pid=309751) [2026-01-25 18:32:26] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 17694720 bytes
(EngineCore_DP0 pid=309751) [2026-01-25 18:32:26] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 4608] -> 1D uint8
(EngineCore_DP0 pid=309751) [2026-01-25 18:32:26] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 10616832 bytes
(EngineCore_DP0 pid=309751) [2026-01-25 18:32:26] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 4608] -> 1D uint8
(EngineCore_DP0 pid=309751) [2026-01-25 18:32:26] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 56623104 bytes
(EngineCore_DP0 pid=309751) [2026-01-25 18:32:26] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 12288] -> 1D uint8
(EngineCore_DP0 pid=309751) [2026-01-25 18:32:26] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 28311552 bytes
(EngineCore_DP0 pid=309751) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  29%|██▊       | 2/7 [00:00<00:00, 10.80it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  57%|█████▋    | 4/7 [00:00<00:00, 11.49it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  86%|████████▌ | 6/7 [00:00<00:00, 11.42it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00, 11.06it/s]
(EngineCore_DP0 pid=309751) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  40%|████      | 2/5 [00:00<00:00, 11.02it/s]
Capturing CUDA graphs (decode, FULL):  80%|████████  | 4/5 [00:00<00:00, 11.23it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00, 11.33it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 36/2048 [00:00<00:05, 353.12it/s]
Adding requests:   4%|▎         | 73/2048 [00:00<00:05, 362.70it/s]
Adding requests:   5%|▌         | 110/2048 [00:00<00:05, 362.71it/s]
Adding requests:   7%|▋         | 147/2048 [00:00<00:05, 360.13it/s]
Adding requests:   9%|▉         | 186/2048 [00:00<00:05, 368.55it/s]
Adding requests:  11%|█         | 226/2048 [00:00<00:04, 378.16it/s]
Adding requests:  13%|█▎        | 264/2048 [00:00<00:04, 374.09it/s]
Adding requests:  15%|█▍        | 303/2048 [00:00<00:04, 376.15it/s]
Adding requests:  17%|█▋        | 344/2048 [00:00<00:04, 384.65it/s]
Adding requests:  19%|█▉        | 385/2048 [00:01<00:04, 390.59it/s]
Adding requests:  21%|██        | 426/2048 [00:01<00:04, 393.11it/s]
Adding requests:  23%|██▎       | 466/2048 [00:01<00:04, 395.15it/s]
Adding requests:  25%|██▍       | 506/2048 [00:01<00:03, 386.63it/s]
Adding requests:  27%|██▋       | 545/2048 [00:01<00:04, 373.77it/s]
Adding requests:  29%|██▊       | 585/2048 [00:01<00:03, 380.79it/s]
Adding requests:  31%|███       | 627/2048 [00:01<00:03, 390.11it/s]
Adding requests:  33%|███▎      | 668/2048 [00:01<00:03, 395.53it/s]
Adding requests:  35%|███▍      | 711/2048 [00:01<00:03, 404.06it/s]
Adding requests:  37%|███▋      | 752/2048 [00:01<00:03, 396.58it/s]
Adding requests:  39%|███▊      | 793/2048 [00:02<00:03, 397.88it/s]
Adding requests:  41%|████      | 833/2048 [00:02<00:03, 389.20it/s]
Adding requests:  43%|████▎     | 872/2048 [00:02<00:03, 385.16it/s]
Adding requests:  44%|████▍     | 911/2048 [00:02<00:02, 385.58it/s]
Adding requests:  46%|████▋     | 950/2048 [00:02<00:02, 384.92it/s]
Adding requests:  48%|████▊     | 991/2048 [00:02<00:02, 389.64it/s]
Adding requests:  50%|█████     | 1032/2048 [00:02<00:02, 393.64it/s]
Adding requests:  52%|█████▏    | 1072/2048 [00:02<00:02, 384.92it/s]
Adding requests:  54%|█████▍    | 1113/2048 [00:02<00:02, 390.90it/s]
Adding requests:  56%|█████▋    | 1153/2048 [00:02<00:02, 391.46it/s]
Adding requests:  58%|█████▊    | 1196/2048 [00:03<00:02, 400.61it/s]
Adding requests:  60%|██████    | 1237/2048 [00:03<00:02, 395.40it/s]
Adding requests:  62%|██████▏   | 1277/2048 [00:03<00:02, 384.31it/s]
Adding requests:  64%|██████▍   | 1318/2048 [00:03<00:01, 389.39it/s]
Adding requests:  66%|██████▋   | 1359/2048 [00:03<00:01, 392.14it/s]
Adding requests:  68%|██████▊   | 1400/2048 [00:03<00:01, 396.26it/s]
Adding requests:  70%|███████   | 1440/2048 [00:03<00:01, 393.71it/s]
Adding requests:  72%|███████▏  | 1482/2048 [00:03<00:01, 401.05it/s]
Adding requests:  74%|███████▍  | 1525/2048 [00:03<00:01, 407.16it/s]
Adding requests:  76%|███████▋  | 1566/2048 [00:04<00:01, 403.38it/s]
Adding requests:  79%|███████▊  | 1610/2048 [00:04<00:01, 412.03it/s]
Adding requests:  81%|████████  | 1652/2048 [00:04<00:00, 404.68it/s]
Adding requests:  83%|████████▎ | 1694/2048 [00:04<00:00, 407.35it/s]
Adding requests:  85%|████████▍ | 1736/2048 [00:04<00:00, 408.78it/s]
Adding requests:  87%|████████▋ | 1777/2048 [00:04<00:00, 393.72it/s]
Adding requests:  89%|████████▊ | 1817/2048 [00:04<00:00, 388.62it/s]
Adding requests:  91%|█████████ | 1858/2048 [00:04<00:00, 392.82it/s]
Adding requests:  93%|█████████▎| 1898/2048 [00:04<00:00, 390.28it/s]
Adding requests:  95%|█████████▍| 1938/2048 [00:04<00:00, 381.15it/s]
Adding requests:  97%|█████████▋| 1979/2048 [00:05<00:00, 388.96it/s]
Adding requests:  99%|█████████▊| 2022/2048 [00:05<00:00, 399.98it/s]
Adding requests: 100%|██████████| 2048/2048 [00:05<00:00, 390.93it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  13%|█▎        | 274/2048 [00:00<00:01, 1405.73it/s, est. speed input: 1439608.64 toks/s, output: 1405.77 toks/s]
Processed prompts:  20%|██        | 415/2048 [00:02<00:12, 133.44it/s, est. speed input: 166493.36 toks/s, output: 162.59 toks/s]   
Processed prompts:  23%|██▎       | 477/2048 [00:03<00:15, 101.09it/s, est. speed input: 131143.24 toks/s, output: 128.07 toks/s]
Processed prompts:  25%|██▌       | 513/2048 [00:04<00:16, 91.96it/s, est. speed input: 121637.30 toks/s, output: 118.79 toks/s] 
Processed prompts:  26%|██▋       | 538/2048 [00:04<00:18, 79.83it/s, est. speed input: 112148.38 toks/s, output: 109.52 toks/s]
Processed prompts:  27%|██▋       | 555/2048 [00:05<00:19, 76.48it/s, est. speed input: 109095.09 toks/s, output: 106.54 toks/s]
Processed prompts:  28%|██▊       | 569/2048 [00:05<00:20, 71.35it/s, est. speed input: 105811.41 toks/s, output: 103.33 toks/s]
Processed prompts:  28%|██▊       | 580/2048 [00:05<00:22, 64.51it/s, est. speed input: 102341.42 toks/s, output: 99.94 toks/s] 
Processed prompts:  29%|██▉       | 594/2048 [00:06<00:23, 60.70it/s, est. speed input: 99726.80 toks/s, output: 97.39 toks/s] 
Processed prompts:  30%|██▉       | 610/2048 [00:06<00:24, 58.98it/s, est. speed input: 97634.88 toks/s, output: 95.35 toks/s]
Processed prompts:  31%|███       | 626/2048 [00:06<00:24, 57.68it/s, est. speed input: 95750.85 toks/s, output: 93.51 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [00:06<00:24, 56.69it/s, est. speed input: 94034.56 toks/s, output: 91.83 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [00:07<00:24, 55.85it/s, est. speed input: 92436.42 toks/s, output: 90.27 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [00:07<00:24, 55.24it/s, est. speed input: 90965.24 toks/s, output: 88.83 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [00:07<00:24, 54.88it/s, est. speed input: 89624.64 toks/s, output: 87.52 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [00:08<00:24, 54.62it/s, est. speed input: 88379.04 toks/s, output: 86.31 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [00:08<00:24, 54.32it/s, est. speed input: 87201.29 toks/s, output: 85.16 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [00:08<00:24, 54.19it/s, est. speed input: 86117.53 toks/s, output: 84.10 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [00:09<00:23, 54.11it/s, est. speed input: 85106.23 toks/s, output: 83.11 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [00:09<00:23, 54.00it/s, est. speed input: 84151.39 toks/s, output: 82.18 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [00:09<00:23, 53.92it/s, est. speed input: 83254.42 toks/s, output: 81.30 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [00:09<00:23, 53.92it/s, est. speed input: 82418.40 toks/s, output: 80.49 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [00:10<00:22, 53.91it/s, est. speed input: 81631.09 toks/s, output: 79.72 toks/s]
Processed prompts:  41%|████      | 834/2048 [00:10<00:22, 53.77it/s, est. speed input: 80867.66 toks/s, output: 78.97 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [00:10<00:22, 53.76it/s, est. speed input: 80158.61 toks/s, output: 78.28 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [00:11<00:21, 53.78it/s, est. speed input: 79492.02 toks/s, output: 77.63 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [00:11<00:21, 53.76it/s, est. speed input: 78855.27 toks/s, output: 77.01 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [00:11<00:21, 53.75it/s, est. speed input: 78250.95 toks/s, output: 76.42 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [00:12<00:21, 53.77it/s, est. speed input: 77679.78 toks/s, output: 75.86 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [00:12<00:20, 54.71it/s, est. speed input: 77241.03 toks/s, output: 75.43 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [00:12<00:20, 54.40it/s, est. speed input: 76715.62 toks/s, output: 74.92 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [00:12<00:20, 54.23it/s, est. speed input: 76219.71 toks/s, output: 74.43 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [00:13<00:19, 55.00it/s, est. speed input: 75837.12 toks/s, output: 74.06 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [00:13<00:19, 54.55it/s, est. speed input: 75371.55 toks/s, output: 73.60 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [00:13<00:19, 54.31it/s, est. speed input: 74933.68 toks/s, output: 73.18 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [00:14<00:18, 54.19it/s, est. speed input: 74517.95 toks/s, output: 72.77 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [00:14<00:18, 53.98it/s, est. speed input: 74107.87 toks/s, output: 72.37 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [00:14<00:18, 53.89it/s, est. speed input: 73719.78 toks/s, output: 71.99 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [00:14<00:18, 53.84it/s, est. speed input: 73348.19 toks/s, output: 71.63 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [00:15<00:17, 53.76it/s, est. speed input: 72986.99 toks/s, output: 71.28 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [00:15<00:17, 53.67it/s, est. speed input: 72637.11 toks/s, output: 70.93 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [00:15<00:17, 53.74it/s, est. speed input: 72311.36 toks/s, output: 70.62 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [00:16<00:16, 53.70it/s, est. speed input: 71990.39 toks/s, output: 70.30 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [00:16<00:16, 54.52it/s, est. speed input: 71748.14 toks/s, output: 70.07 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [00:16<00:16, 54.15it/s, est. speed input: 71440.80 toks/s, output: 69.77 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [00:17<00:15, 54.04it/s, est. speed input: 71155.16 toks/s, output: 69.49 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [00:17<00:15, 53.94it/s, est. speed input: 70878.20 toks/s, output: 69.22 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [00:17<00:15, 53.77it/s, est. speed input: 70602.66 toks/s, output: 68.95 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [00:17<00:15, 53.67it/s, est. speed input: 70337.89 toks/s, output: 68.69 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [00:18<00:14, 53.64it/s, est. speed input: 70085.23 toks/s, output: 68.44 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [00:18<00:14, 53.58it/s, est. speed input: 69837.21 toks/s, output: 68.20 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [00:18<00:14, 53.49it/s, est. speed input: 69594.13 toks/s, output: 67.96 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [00:19<00:13, 53.58it/s, est. speed input: 69368.91 toks/s, output: 67.74 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [00:19<00:13, 53.64it/s, est. speed input: 69150.16 toks/s, output: 67.53 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [00:19<00:13, 53.57it/s, est. speed input: 68930.89 toks/s, output: 67.32 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [00:20<00:13, 53.47it/s, est. speed input: 68715.09 toks/s, output: 67.10 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [00:20<00:12, 53.52it/s, est. speed input: 68512.94 toks/s, output: 66.91 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [00:20<00:12, 53.57it/s, est. speed input: 68317.87 toks/s, output: 66.72 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [00:20<00:12, 53.51it/s, est. speed input: 68122.18 toks/s, output: 66.53 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [00:21<00:11, 53.55it/s, est. speed input: 67937.00 toks/s, output: 66.34 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [00:21<00:11, 53.57it/s, est. speed input: 67756.42 toks/s, output: 66.17 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [00:21<00:11, 53.47it/s, est. speed input: 67574.22 toks/s, output: 65.99 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [00:22<00:11, 53.46it/s, est. speed input: 67400.44 toks/s, output: 65.82 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [00:22<00:10, 53.50it/s, est. speed input: 67233.77 toks/s, output: 65.66 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [00:22<00:10, 53.48it/s, est. speed input: 67069.21 toks/s, output: 65.50 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [00:23<00:10, 53.46it/s, est. speed input: 66908.50 toks/s, output: 65.34 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [00:23<00:09, 53.48it/s, est. speed input: 66753.34 toks/s, output: 65.19 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [00:23<00:09, 53.51it/s, est. speed input: 66603.24 toks/s, output: 65.04 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [00:23<00:09, 53.48it/s, est. speed input: 66454.36 toks/s, output: 64.90 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [00:24<00:08, 53.46it/s, est. speed input: 66308.84 toks/s, output: 64.75 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [00:24<00:08, 53.52it/s, est. speed input: 66170.96 toks/s, output: 64.62 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [00:24<00:08, 53.52it/s, est. speed input: 66034.14 toks/s, output: 64.49 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [00:25<00:08, 53.38it/s, est. speed input: 65893.93 toks/s, output: 64.35 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [00:25<00:07, 53.39it/s, est. speed input: 65761.84 toks/s, output: 64.22 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [00:25<00:07, 53.42it/s, est. speed input: 65634.50 toks/s, output: 64.10 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [00:26<00:07, 53.33it/s, est. speed input: 65504.36 toks/s, output: 63.97 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [00:26<00:06, 53.36it/s, est. speed input: 65381.56 toks/s, output: 63.85 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [00:26<00:06, 53.42it/s, est. speed input: 65263.38 toks/s, output: 63.73 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [00:26<00:06, 53.42it/s, est. speed input: 65146.09 toks/s, output: 63.62 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [00:27<00:05, 53.39it/s, est. speed input: 65029.88 toks/s, output: 63.51 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [00:27<00:05, 53.35it/s, est. speed input: 64915.25 toks/s, output: 63.39 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [00:27<00:05, 53.34it/s, est. speed input: 64804.08 toks/s, output: 63.29 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [00:28<00:05, 53.31it/s, est. speed input: 64694.22 toks/s, output: 63.18 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [00:28<00:04, 53.28it/s, est. speed input: 64586.15 toks/s, output: 63.07 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [00:28<00:04, 53.38it/s, est. speed input: 64485.84 toks/s, output: 62.97 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [00:29<00:04, 53.40it/s, est. speed input: 64385.26 toks/s, output: 62.88 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [00:29<00:03, 53.38it/s, est. speed input: 64285.23 toks/s, output: 62.78 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [00:29<00:03, 53.40it/s, est. speed input: 64188.91 toks/s, output: 62.68 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [00:29<00:03, 54.30it/s, est. speed input: 64129.31 toks/s, output: 62.63 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [00:30<00:02, 54.00it/s, est. speed input: 64034.48 toks/s, output: 62.53 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [00:30<00:02, 53.84it/s, est. speed input: 63943.32 toks/s, output: 62.44 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [00:30<00:02, 53.62it/s, est. speed input: 63850.04 toks/s, output: 62.35 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [00:31<00:02, 53.49it/s, est. speed input: 63759.54 toks/s, output: 62.27 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [00:31<00:01, 54.37it/s, est. speed input: 63706.52 toks/s, output: 62.21 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [00:31<00:01, 54.06it/s, est. speed input: 63620.68 toks/s, output: 62.13 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [00:32<00:01, 53.85it/s, est. speed input: 63536.49 toks/s, output: 62.05 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [00:32<00:00, 53.65it/s, est. speed input: 63451.98 toks/s, output: 61.96 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [00:32<00:00, 53.54it/s, est. speed input: 63370.17 toks/s, output: 61.88 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [00:32<00:00, 54.59it/s, est. speed input: 63329.43 toks/s, output: 61.85 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:32<00:00, 54.59it/s, est. speed input: 63764.64 toks/s, output: 62.27 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:32<00:00, 62.27it/s, est. speed input: 63764.64 toks/s, output: 62.27 toks/s]
[rank0]:[W125 18:33:32.438224051 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=32768 ==========
Time: 2026-01-25 18:33:34
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=4096, max_num_seqs=32
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 4096 --max-num-seqs 32 --max-model-len 1025 --max-num-batched-tokens 32768 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-3B-INT8_M32768.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 18:34:04 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=311466) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=311466) WARNING 01-25 18:34:22 [backends.py:609] Failed to read file <frozen os>
Throughput: 54.06 requests/s, 55409.63 total tokens/s, 54.06 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096

STDERR:
[2026-01-25 18:34:04] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:34:04] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 18:34:04] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 18:34:04] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:34:04] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:34:04] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:34:04] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:34:04] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:34:04] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 18:34:04] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:34:04] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:34:04] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:34:04] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:34:04] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 18:34:11] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:34:11] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 18:34:11] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 18:34:11] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:34:11] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:34:11] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:34:11] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:34:11] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:34:11] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 18:34:11] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:34:11] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:34:11] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:34:11] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:34:11] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=311466) [2026-01-25 18:34:13] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=311466) [2026-01-25 18:34:13] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=311466) [2026-01-25 18:34:13] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=311466) [2026-01-25 18:34:13] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=311466) [2026-01-25 18:34:13] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-3B-INT8
(EngineCore_DP0 pid=311466) [2026-01-25 18:34:13] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=311466) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=311466) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.77it/s]
(EngineCore_DP0 pid=311466) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.77it/s]
(EngineCore_DP0 pid=311466) 
(EngineCore_DP0 pid=311466) [2026-01-25 18:34:14] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 4608] -> 1D uint8
(EngineCore_DP0 pid=311466) [2026-01-25 18:34:14] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 17694720 bytes
(EngineCore_DP0 pid=311466) [2026-01-25 18:34:14] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 4608] -> 1D uint8
(EngineCore_DP0 pid=311466) [2026-01-25 18:34:14] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 10616832 bytes
(EngineCore_DP0 pid=311466) [2026-01-25 18:34:14] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 4608] -> 1D uint8
(EngineCore_DP0 pid=311466) [2026-01-25 18:34:14] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 56623104 bytes
(EngineCore_DP0 pid=311466) [2026-01-25 18:34:14] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 12288] -> 1D uint8
(EngineCore_DP0 pid=311466) [2026-01-25 18:34:14] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 28311552 bytes
(EngineCore_DP0 pid=311466) [rank0]:W0125 18:34:31.176000 311466 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=311466) [rank0]:W0125 18:34:31.303000 311466 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=311466) [rank0]:W0125 18:34:32.786000 311466 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=311466) [rank0]:W0125 18:34:32.970000 311466 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=311466) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   9%|▉         | 1/11 [00:00<00:01,  9.97it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  27%|██▋       | 3/11 [00:00<00:00, 10.50it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  45%|████▌     | 5/11 [00:00<00:00, 11.03it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  64%|██████▎   | 7/11 [00:00<00:00, 11.07it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  82%|████████▏ | 9/11 [00:00<00:00, 11.01it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00, 10.83it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00, 10.86it/s]
(EngineCore_DP0 pid=311466) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  14%|█▍        | 1/7 [00:00<00:00,  9.75it/s]
Capturing CUDA graphs (decode, FULL):  43%|████▎     | 3/7 [00:00<00:00, 11.03it/s]
Capturing CUDA graphs (decode, FULL):  71%|███████▏  | 5/7 [00:00<00:00, 11.39it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00, 11.43it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00, 11.29it/s]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   1%|          | 36/4096 [00:00<00:11, 352.60it/s]
Adding requests:   2%|▏         | 73/4096 [00:00<00:11, 360.95it/s]
Adding requests:   3%|▎         | 111/4096 [00:00<00:10, 365.19it/s]
Adding requests:   4%|▎         | 149/4096 [00:00<00:10, 370.41it/s]
Adding requests:   5%|▍         | 189/4096 [00:00<00:10, 377.98it/s]
Adding requests:   6%|▌         | 230/4096 [00:00<00:09, 386.66it/s]
Adding requests:   7%|▋         | 270/4096 [00:00<00:09, 389.30it/s]
Adding requests:   8%|▊         | 309/4096 [00:00<00:10, 378.10it/s]
Adding requests:   8%|▊         | 347/4096 [00:00<00:10, 372.87it/s]
Adding requests:   9%|▉         | 385/4096 [00:01<00:10, 370.39it/s]
Adding requests:  10%|█         | 424/4096 [00:01<00:09, 376.10it/s]
Adding requests:  11%|█▏        | 462/4096 [00:01<00:09, 370.78it/s]
Adding requests:  12%|█▏        | 501/4096 [00:01<00:09, 375.62it/s]
Adding requests:  13%|█▎        | 539/4096 [00:01<00:09, 368.23it/s]
Adding requests:  14%|█▍        | 577/4096 [00:01<00:09, 371.61it/s]
Adding requests:  15%|█▌        | 615/4096 [00:01<00:09, 373.62it/s]
Adding requests:  16%|█▌        | 658/4096 [00:01<00:08, 388.66it/s]
Adding requests:  17%|█▋        | 699/4096 [00:01<00:08, 392.10it/s]
Adding requests:  18%|█▊        | 739/4096 [00:01<00:08, 390.00it/s]
Adding requests:  19%|█▉        | 779/4096 [00:02<00:08, 383.90it/s]
Adding requests:  20%|█▉        | 818/4096 [00:02<00:08, 379.68it/s]
Adding requests:  21%|██        | 856/4096 [00:02<00:08, 376.80it/s]
Adding requests:  22%|██▏       | 896/4096 [00:02<00:08, 382.12it/s]
Adding requests:  23%|██▎       | 936/4096 [00:02<00:08, 386.68it/s]
Adding requests:  24%|██▍       | 975/4096 [00:02<00:08, 382.55it/s]
Adding requests:  25%|██▍       | 1014/4096 [00:02<00:08, 384.59it/s]
Adding requests:  26%|██▌       | 1054/4096 [00:02<00:07, 386.58it/s]
Adding requests:  27%|██▋       | 1093/4096 [00:02<00:07, 380.35it/s]
Adding requests:  28%|██▊       | 1132/4096 [00:02<00:07, 375.35it/s]
Adding requests:  29%|██▊       | 1172/4096 [00:03<00:07, 381.29it/s]
Adding requests:  30%|██▉       | 1211/4096 [00:03<00:07, 374.64it/s]
Adding requests:  30%|███       | 1249/4096 [00:03<00:07, 375.24it/s]
Adding requests:  31%|███▏      | 1289/4096 [00:03<00:07, 382.26it/s]
Adding requests:  32%|███▏      | 1329/4096 [00:03<00:07, 386.83it/s]
Adding requests:  33%|███▎      | 1371/4096 [00:03<00:06, 395.28it/s]
Adding requests:  35%|███▍      | 1414/4096 [00:03<00:06, 404.56it/s]
Adding requests:  36%|███▌      | 1456/4096 [00:03<00:06, 406.57it/s]
Adding requests:  37%|███▋      | 1499/4096 [00:03<00:06, 413.35it/s]
Adding requests:  38%|███▊      | 1542/4096 [00:04<00:06, 416.65it/s]
Adding requests:  39%|███▊      | 1584/4096 [00:04<00:06, 413.28it/s]
Adding requests:  40%|███▉      | 1626/4096 [00:04<00:06, 409.77it/s]
Adding requests:  41%|████      | 1667/4096 [00:04<00:06, 400.61it/s]
Adding requests:  42%|████▏     | 1708/4096 [00:04<00:05, 400.84it/s]
Adding requests:  43%|████▎     | 1749/4096 [00:04<00:05, 403.17it/s]
Adding requests:  44%|████▎     | 1790/4096 [00:04<00:05, 402.52it/s]
Adding requests:  45%|████▍     | 1831/4096 [00:04<00:05, 399.81it/s]
Adding requests:  46%|████▌     | 1871/4096 [00:04<00:05, 394.97it/s]
Adding requests:  47%|████▋     | 1911/4096 [00:04<00:05, 392.68it/s]
Adding requests:  48%|████▊     | 1952/4096 [00:05<00:05, 396.42it/s]
Adding requests:  49%|████▊     | 1994/4096 [00:05<00:05, 402.53it/s]
Adding requests:  50%|████▉     | 2036/4096 [00:05<00:05, 404.81it/s]
Adding requests:  51%|█████     | 2077/4096 [00:05<00:04, 405.16it/s]
Adding requests:  52%|█████▏    | 2118/4096 [00:05<00:04, 404.03it/s]
Adding requests:  53%|█████▎    | 2159/4096 [00:05<00:04, 392.44it/s]
Adding requests:  54%|█████▎    | 2201/4096 [00:05<00:04, 398.07it/s]
Adding requests:  55%|█████▍    | 2243/4096 [00:05<00:04, 404.42it/s]
Adding requests:  56%|█████▌    | 2285/4096 [00:05<00:04, 408.14it/s]
Adding requests:  57%|█████▋    | 2326/4096 [00:05<00:04, 398.50it/s]
Adding requests:  58%|█████▊    | 2369/4096 [00:06<00:04, 405.81it/s]
Adding requests:  59%|█████▉    | 2410/4096 [00:06<00:04, 397.27it/s]
Adding requests:  60%|█████▉    | 2451/4096 [00:06<00:04, 398.24it/s]
Adding requests:  61%|██████    | 2492/4096 [00:06<00:04, 400.26it/s]
Adding requests:  62%|██████▏   | 2533/4096 [00:06<00:03, 400.26it/s]
Adding requests:  63%|██████▎   | 2575/4096 [00:06<00:03, 403.46it/s]
Adding requests:  64%|██████▍   | 2617/4096 [00:06<00:03, 407.72it/s]
Adding requests:  65%|██████▍   | 2660/4096 [00:06<00:03, 412.15it/s]
Adding requests:  66%|██████▌   | 2702/4096 [00:06<00:03, 402.13it/s]
Adding requests:  67%|██████▋   | 2743/4096 [00:07<00:03, 396.76it/s]
Adding requests:  68%|██████▊   | 2783/4096 [00:07<00:03, 394.80it/s]
Adding requests:  69%|██████▉   | 2824/4096 [00:07<00:03, 398.12it/s]
Adding requests:  70%|██████▉   | 2864/4096 [00:07<00:03, 394.89it/s]
Adding requests:  71%|███████   | 2904/4096 [00:07<00:03, 391.85it/s]
Adding requests:  72%|███████▏  | 2944/4096 [00:07<00:02, 387.84it/s]
Adding requests:  73%|███████▎  | 2984/4096 [00:07<00:02, 389.60it/s]
Adding requests:  74%|███████▍  | 3024/4096 [00:07<00:02, 391.07it/s]
Adding requests:  75%|███████▍  | 3064/4096 [00:07<00:02, 392.81it/s]
Adding requests:  76%|███████▌  | 3104/4096 [00:07<00:02, 392.11it/s]
Adding requests:  77%|███████▋  | 3144/4096 [00:08<00:02, 387.65it/s]
Adding requests:  78%|███████▊  | 3185/4096 [00:08<00:02, 392.57it/s]
Adding requests:  79%|███████▊  | 3225/4096 [00:08<00:02, 390.74it/s]
Adding requests:  80%|███████▉  | 3269/4096 [00:08<00:02, 402.87it/s]
Adding requests:  81%|████████  | 3311/4096 [00:08<00:01, 404.67it/s]
Adding requests:  82%|████████▏ | 3352/4096 [00:08<00:01, 394.92it/s]
Adding requests:  83%|████████▎ | 3392/4096 [00:08<00:01, 390.74it/s]
Adding requests:  84%|████████▍ | 3434/4096 [00:08<00:01, 398.39it/s]
Adding requests:  85%|████████▍ | 3474/4096 [00:08<00:01, 392.90it/s]
Adding requests:  86%|████████▌ | 3516/4096 [00:08<00:01, 398.77it/s]
Adding requests:  87%|████████▋ | 3556/4096 [00:09<00:01, 398.82it/s]
Adding requests:  88%|████████▊ | 3596/4096 [00:09<00:01, 390.51it/s]
Adding requests:  89%|████████▉ | 3636/4096 [00:09<00:01, 392.38it/s]
Adding requests:  90%|████████▉ | 3677/4096 [00:09<00:01, 395.87it/s]
Adding requests:  91%|█████████ | 3717/4096 [00:09<00:00, 393.94it/s]
Adding requests:  92%|█████████▏| 3757/4096 [00:09<00:00, 380.44it/s]
Adding requests:  93%|█████████▎| 3798/4096 [00:09<00:00, 388.33it/s]
Adding requests:  94%|█████████▎| 3838/4096 [00:09<00:00, 389.14it/s]
Adding requests:  95%|█████████▍| 3881/4096 [00:09<00:00, 397.57it/s]
Adding requests:  96%|█████████▌| 3921/4096 [00:10<00:00, 394.10it/s]
Adding requests:  97%|█████████▋| 3963/4096 [00:10<00:00, 400.13it/s]
Adding requests:  98%|█████████▊| 4004/4096 [00:10<00:00, 395.01it/s]
Adding requests:  99%|█████████▊| 4044/4096 [00:10<00:00, 395.95it/s]
Adding requests: 100%|█████████▉| 4086/4096 [00:10<00:00, 402.31it/s]
Adding requests: 100%|██████████| 4096/4096 [00:10<00:00, 392.30it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  14%|█▍        | 571/4096 [00:00<00:04, 862.17it/s, est. speed input: 882896.93 toks/s, output: 862.18 toks/s]
Processed prompts:  16%|█▌        | 658/4096 [00:01<00:11, 296.96it/s, est. speed input: 366666.38 toks/s, output: 358.07 toks/s]
Processed prompts:  17%|█▋        | 698/4096 [00:02<00:15, 219.41it/s, est. speed input: 294690.48 toks/s, output: 287.78 toks/s]
Processed prompts:  18%|█▊        | 723/4096 [00:03<00:20, 161.62it/s, est. speed input: 245608.90 toks/s, output: 239.85 toks/s]
Processed prompts:  18%|█▊        | 740/4096 [00:03<00:28, 119.37it/s, est. speed input: 210273.11 toks/s, output: 205.34 toks/s]
Processed prompts:  19%|█▊        | 763/4096 [00:04<00:35, 94.27it/s, est. speed input: 186350.84 toks/s, output: 181.98 toks/s] 
Processed prompts:  19%|█▉        | 795/4096 [00:04<00:40, 81.86it/s, est. speed input: 170176.00 toks/s, output: 166.19 toks/s]
Processed prompts:  20%|██        | 827/4096 [00:05<00:44, 73.51it/s, est. speed input: 157673.02 toks/s, output: 153.98 toks/s]
Processed prompts:  21%|██        | 859/4096 [00:05<00:47, 67.70it/s, est. speed input: 147607.86 toks/s, output: 144.15 toks/s]
Processed prompts:  22%|██▏       | 891/4096 [00:06<00:50, 63.59it/s, est. speed input: 139296.91 toks/s, output: 136.03 toks/s]
Processed prompts:  23%|██▎       | 923/4096 [00:07<00:51, 61.36it/s, est. speed input: 132726.77 toks/s, output: 129.62 toks/s]
Processed prompts:  23%|██▎       | 955/4096 [00:07<00:52, 59.65it/s, est. speed input: 127065.57 toks/s, output: 124.09 toks/s]
Processed prompts:  24%|██▍       | 987/4096 [00:08<00:53, 58.05it/s, est. speed input: 121996.49 toks/s, output: 119.14 toks/s]
Processed prompts:  25%|██▍       | 1019/4096 [00:08<00:54, 56.88it/s, est. speed input: 117572.62 toks/s, output: 114.82 toks/s]
Processed prompts:  26%|██▌       | 1051/4096 [00:09<00:54, 56.08it/s, est. speed input: 113704.76 toks/s, output: 111.04 toks/s]
Processed prompts:  26%|██▋       | 1083/4096 [00:10<00:54, 55.57it/s, est. speed input: 110307.31 toks/s, output: 107.72 toks/s]
Processed prompts:  27%|██▋       | 1115/4096 [00:10<00:54, 55.18it/s, est. speed input: 107276.21 toks/s, output: 104.76 toks/s]
Processed prompts:  28%|██▊       | 1147/4096 [00:11<00:53, 55.30it/s, est. speed input: 104691.41 toks/s, output: 102.24 toks/s]
Processed prompts:  29%|██▉       | 1179/4096 [00:11<00:53, 54.97it/s, est. speed input: 102234.39 toks/s, output: 99.84 toks/s] 
Processed prompts:  30%|██▉       | 1211/4096 [00:12<00:52, 54.76it/s, est. speed input: 100013.72 toks/s, output: 97.67 toks/s]
Processed prompts:  30%|███       | 1243/4096 [00:12<00:52, 54.52it/s, est. speed input: 97972.28 toks/s, output: 95.68 toks/s] 
Processed prompts:  31%|███       | 1275/4096 [00:13<00:51, 54.41it/s, est. speed input: 96121.77 toks/s, output: 93.87 toks/s]
Processed prompts:  32%|███▏      | 1307/4096 [00:14<00:51, 54.33it/s, est. speed input: 94425.80 toks/s, output: 92.21 toks/s]
Processed prompts:  33%|███▎      | 1339/4096 [00:14<00:50, 54.25it/s, est. speed input: 92859.02 toks/s, output: 90.68 toks/s]
Processed prompts:  33%|███▎      | 1371/4096 [00:15<00:50, 54.19it/s, est. speed input: 91413.68 toks/s, output: 89.27 toks/s]
Processed prompts:  34%|███▍      | 1403/4096 [00:15<00:49, 54.18it/s, est. speed input: 90082.24 toks/s, output: 87.97 toks/s]
Processed prompts:  35%|███▌      | 1435/4096 [00:16<00:49, 54.11it/s, est. speed input: 88831.50 toks/s, output: 86.75 toks/s]
Processed prompts:  36%|███▌      | 1467/4096 [00:17<00:48, 54.12it/s, est. speed input: 87679.31 toks/s, output: 85.62 toks/s]
Processed prompts:  37%|███▋      | 1499/4096 [00:17<00:47, 54.11it/s, est. speed input: 86602.71 toks/s, output: 84.57 toks/s]
Processed prompts:  37%|███▋      | 1531/4096 [00:18<00:47, 54.11it/s, est. speed input: 85594.77 toks/s, output: 83.59 toks/s]
Processed prompts:  38%|███▊      | 1563/4096 [00:18<00:46, 54.07it/s, est. speed input: 84644.31 toks/s, output: 82.66 toks/s]
Processed prompts:  39%|███▉      | 1595/4096 [00:19<00:46, 54.05it/s, est. speed input: 83752.98 toks/s, output: 81.79 toks/s]
Processed prompts:  40%|███▉      | 1627/4096 [00:20<00:45, 54.08it/s, est. speed input: 82919.98 toks/s, output: 80.98 toks/s]
Processed prompts:  41%|████      | 1659/4096 [00:20<00:45, 54.03it/s, est. speed input: 82124.78 toks/s, output: 80.20 toks/s]
Processed prompts:  41%|████▏     | 1691/4096 [00:21<00:44, 54.03it/s, est. speed input: 81379.13 toks/s, output: 79.47 toks/s]
Processed prompts:  42%|████▏     | 1723/4096 [00:21<00:43, 54.01it/s, est. speed input: 80670.19 toks/s, output: 78.78 toks/s]
Processed prompts:  43%|████▎     | 1755/4096 [00:22<00:43, 53.91it/s, est. speed input: 79988.06 toks/s, output: 78.11 toks/s]
Processed prompts:  44%|████▎     | 1787/4096 [00:23<00:42, 53.98it/s, est. speed input: 79359.49 toks/s, output: 77.50 toks/s]
Processed prompts:  44%|████▍     | 1819/4096 [00:23<00:42, 53.95it/s, est. speed input: 78752.61 toks/s, output: 76.91 toks/s]
Processed prompts:  45%|████▌     | 1851/4096 [00:24<00:41, 54.56it/s, est. speed input: 78248.87 toks/s, output: 76.41 toks/s]
Processed prompts:  46%|████▌     | 1883/4096 [00:24<00:40, 54.38it/s, est. speed input: 77699.44 toks/s, output: 75.88 toks/s]
Processed prompts:  47%|████▋     | 1915/4096 [00:25<00:40, 54.22it/s, est. speed input: 77171.35 toks/s, output: 75.36 toks/s]
Processed prompts:  48%|████▊     | 1947/4096 [00:25<00:39, 54.70it/s, est. speed input: 76731.25 toks/s, output: 74.93 toks/s]
Processed prompts:  48%|████▊     | 1979/4096 [00:26<00:38, 54.47it/s, est. speed input: 76250.96 toks/s, output: 74.46 toks/s]
Processed prompts:  49%|████▉     | 2011/4096 [00:27<00:38, 54.32it/s, est. speed input: 75793.03 toks/s, output: 74.02 toks/s]
Processed prompts:  50%|████▉     | 2043/4096 [00:27<00:37, 54.21it/s, est. speed input: 75354.69 toks/s, output: 73.59 toks/s]
Processed prompts:  51%|█████     | 2075/4096 [00:28<00:37, 54.12it/s, est. speed input: 74933.03 toks/s, output: 73.18 toks/s]
Processed prompts:  51%|█████▏    | 2107/4096 [00:28<00:36, 53.99it/s, est. speed input: 74522.41 toks/s, output: 72.78 toks/s]
Processed prompts:  52%|█████▏    | 2139/4096 [00:29<00:36, 54.02it/s, est. speed input: 74138.61 toks/s, output: 72.40 toks/s]
Processed prompts:  53%|█████▎    | 2171/4096 [00:30<00:35, 53.94it/s, est. speed input: 73761.79 toks/s, output: 72.03 toks/s]
Processed prompts:  54%|█████▍    | 2203/4096 [00:30<00:35, 53.94it/s, est. speed input: 73403.84 toks/s, output: 71.68 toks/s]
Processed prompts:  55%|█████▍    | 2235/4096 [00:31<00:33, 54.78it/s, est. speed input: 73131.11 toks/s, output: 71.42 toks/s]
Processed prompts:  55%|█████▌    | 2267/4096 [00:31<00:33, 54.54it/s, est. speed input: 72798.98 toks/s, output: 71.09 toks/s]
Processed prompts:  56%|█████▌    | 2299/4096 [00:32<00:32, 54.84it/s, est. speed input: 72516.89 toks/s, output: 70.82 toks/s]
Processed prompts:  57%|█████▋    | 2331/4096 [00:33<00:32, 55.06it/s, est. speed input: 72244.66 toks/s, output: 70.55 toks/s]
Processed prompts:  58%|█████▊    | 2363/4096 [00:33<00:31, 54.66it/s, est. speed input: 71939.91 toks/s, output: 70.25 toks/s]
Processed prompts:  58%|█████▊    | 2395/4096 [00:34<00:31, 54.43it/s, est. speed input: 71649.50 toks/s, output: 69.97 toks/s]
Processed prompts:  59%|█████▉    | 2427/4096 [00:34<00:30, 54.23it/s, est. speed input: 71365.76 toks/s, output: 69.69 toks/s]
Processed prompts:  60%|██████    | 2459/4096 [00:35<00:30, 54.10it/s, est. speed input: 71092.72 toks/s, output: 69.43 toks/s]
Processed prompts:  61%|██████    | 2491/4096 [00:35<00:29, 54.56it/s, est. speed input: 70867.44 toks/s, output: 69.21 toks/s]
Processed prompts:  62%|██████▏   | 2523/4096 [00:36<00:28, 54.29it/s, est. speed input: 70608.64 toks/s, output: 68.95 toks/s]
Processed prompts:  62%|██████▏   | 2555/4096 [00:37<00:28, 54.17it/s, est. speed input: 70362.37 toks/s, output: 68.71 toks/s]
Processed prompts:  63%|██████▎   | 2587/4096 [00:37<00:27, 54.48it/s, est. speed input: 70150.42 toks/s, output: 68.51 toks/s]
Processed prompts:  64%|██████▍   | 2619/4096 [00:38<00:27, 54.28it/s, est. speed input: 69917.22 toks/s, output: 68.28 toks/s]
Processed prompts:  65%|██████▍   | 2651/4096 [00:38<00:26, 54.04it/s, est. speed input: 69684.45 toks/s, output: 68.05 toks/s]
Processed prompts:  66%|██████▌   | 2683/4096 [00:39<00:26, 53.99it/s, est. speed input: 69466.50 toks/s, output: 67.84 toks/s]
Processed prompts:  66%|██████▋   | 2715/4096 [00:40<00:25, 53.87it/s, est. speed input: 69249.27 toks/s, output: 67.63 toks/s]
Processed prompts:  67%|██████▋   | 2747/4096 [00:40<00:25, 53.82it/s, est. speed input: 69041.14 toks/s, output: 67.42 toks/s]
Processed prompts:  68%|██████▊   | 2779/4096 [00:41<00:24, 53.78it/s, est. speed input: 68838.16 toks/s, output: 67.22 toks/s]
Processed prompts:  69%|██████▊   | 2811/4096 [00:41<00:23, 53.74it/s, est. speed input: 68640.45 toks/s, output: 67.03 toks/s]
Processed prompts:  69%|██████▉   | 2843/4096 [00:42<00:23, 53.68it/s, est. speed input: 68446.52 toks/s, output: 66.84 toks/s]
Processed prompts:  70%|███████   | 2875/4096 [00:43<00:22, 53.67it/s, est. speed input: 68259.74 toks/s, output: 66.66 toks/s]
Processed prompts:  71%|███████   | 2907/4096 [00:43<00:22, 53.71it/s, est. speed input: 68080.42 toks/s, output: 66.48 toks/s]
Processed prompts:  72%|███████▏  | 2939/4096 [00:44<00:21, 53.68it/s, est. speed input: 67903.16 toks/s, output: 66.31 toks/s]
Processed prompts:  73%|███████▎  | 2971/4096 [00:44<00:20, 53.68it/s, est. speed input: 67731.16 toks/s, output: 66.14 toks/s]
Processed prompts:  73%|███████▎  | 3003/4096 [00:45<00:20, 53.68it/s, est. speed input: 67564.32 toks/s, output: 65.98 toks/s]
Processed prompts:  74%|███████▍  | 3035/4096 [00:46<00:19, 53.68it/s, est. speed input: 67401.34 toks/s, output: 65.82 toks/s]
Processed prompts:  75%|███████▍  | 3067/4096 [00:46<00:19, 53.67it/s, est. speed input: 67242.27 toks/s, output: 65.67 toks/s]
Processed prompts:  76%|███████▌  | 3099/4096 [00:47<00:18, 53.60it/s, est. speed input: 67083.58 toks/s, output: 65.51 toks/s]
Processed prompts:  76%|███████▋  | 3131/4096 [00:47<00:17, 54.07it/s, est. speed input: 66956.03 toks/s, output: 65.39 toks/s]
Processed prompts:  77%|███████▋  | 3163/4096 [00:48<00:17, 53.94it/s, est. speed input: 66808.06 toks/s, output: 65.24 toks/s]
Processed prompts:  78%|███████▊  | 3195/4096 [00:49<00:16, 53.85it/s, est. speed input: 66663.61 toks/s, output: 65.10 toks/s]
Processed prompts:  79%|███████▉  | 3227/4096 [00:49<00:16, 53.78it/s, est. speed input: 66522.40 toks/s, output: 64.96 toks/s]
Processed prompts:  80%|███████▉  | 3259/4096 [00:50<00:15, 53.67it/s, est. speed input: 66381.51 toks/s, output: 64.83 toks/s]
Processed prompts:  80%|████████  | 3291/4096 [00:50<00:15, 53.63it/s, est. speed input: 66245.64 toks/s, output: 64.69 toks/s]
Processed prompts:  81%|████████  | 3323/4096 [00:51<00:14, 53.60it/s, est. speed input: 66112.62 toks/s, output: 64.56 toks/s]
Processed prompts:  82%|████████▏ | 3355/4096 [00:52<00:13, 53.57it/s, est. speed input: 65982.42 toks/s, output: 64.44 toks/s]
Processed prompts:  83%|████████▎ | 3387/4096 [00:52<00:13, 53.55it/s, est. speed input: 65855.46 toks/s, output: 64.31 toks/s]
Processed prompts:  83%|████████▎ | 3419/4096 [00:53<00:12, 53.47it/s, est. speed input: 65728.11 toks/s, output: 64.19 toks/s]
Processed prompts:  84%|████████▍ | 3451/4096 [00:53<00:12, 53.56it/s, est. speed input: 65610.07 toks/s, output: 64.07 toks/s]
Processed prompts:  85%|████████▌ | 3483/4096 [00:54<00:11, 53.54it/s, est. speed input: 65491.02 toks/s, output: 63.96 toks/s]
Processed prompts:  86%|████████▌ | 3515/4096 [00:55<00:10, 53.45it/s, est. speed input: 65371.58 toks/s, output: 63.84 toks/s]
Processed prompts:  87%|████████▋ | 3547/4096 [00:55<00:10, 53.48it/s, est. speed input: 65258.18 toks/s, output: 63.73 toks/s]
Processed prompts:  87%|████████▋ | 3579/4096 [00:56<00:09, 53.48it/s, est. speed input: 65146.68 toks/s, output: 63.62 toks/s]
Processed prompts:  88%|████████▊ | 3611/4096 [00:56<00:09, 53.47it/s, est. speed input: 65037.09 toks/s, output: 63.51 toks/s]
Processed prompts:  89%|████████▉ | 3643/4096 [00:57<00:08, 53.47it/s, est. speed input: 64929.88 toks/s, output: 63.41 toks/s]
Processed prompts:  90%|████████▉ | 3675/4096 [00:58<00:07, 53.55it/s, est. speed input: 64828.12 toks/s, output: 63.31 toks/s]
Processed prompts:  91%|█████████ | 3707/4096 [00:58<00:07, 53.46it/s, est. speed input: 64722.66 toks/s, output: 63.21 toks/s]
Processed prompts:  91%|█████████▏| 3739/4096 [00:59<00:06, 53.92it/s, est. speed input: 64640.55 toks/s, output: 63.13 toks/s]
Processed prompts:  92%|█████████▏| 3771/4096 [00:59<00:06, 53.74it/s, est. speed input: 64539.90 toks/s, output: 63.03 toks/s]
Processed prompts:  93%|█████████▎| 3803/4096 [01:00<00:05, 53.61it/s, est. speed input: 64440.81 toks/s, output: 62.93 toks/s]
Processed prompts:  94%|█████████▎| 3835/4096 [01:01<00:04, 53.56it/s, est. speed input: 64345.57 toks/s, output: 62.84 toks/s]
Processed prompts:  94%|█████████▍| 3867/4096 [01:01<00:04, 53.55it/s, est. speed input: 64253.14 toks/s, output: 62.75 toks/s]
Processed prompts:  95%|█████████▌| 3899/4096 [01:02<00:03, 53.47it/s, est. speed input: 64159.69 toks/s, output: 62.66 toks/s]
Processed prompts:  96%|█████████▌| 3931/4096 [01:02<00:03, 53.47it/s, est. speed input: 64070.05 toks/s, output: 62.57 toks/s]
Processed prompts:  97%|█████████▋| 3963/4096 [01:03<00:02, 53.42it/s, est. speed input: 63980.18 toks/s, output: 62.48 toks/s]
Processed prompts:  98%|█████████▊| 3995/4096 [01:04<00:01, 53.42it/s, est. speed input: 63893.38 toks/s, output: 62.40 toks/s]
Processed prompts:  98%|█████████▊| 4027/4096 [01:04<00:01, 53.85it/s, est. speed input: 63823.82 toks/s, output: 62.33 toks/s]
Processed prompts:  99%|█████████▉| 4059/4096 [01:05<00:00, 53.80it/s, est. speed input: 63742.91 toks/s, output: 62.25 toks/s]
Processed prompts: 100%|█████████▉| 4091/4096 [01:05<00:00, 70.70it/s, est. speed input: 64126.74 toks/s, output: 62.62 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [01:05<00:00, 70.70it/s, est. speed input: 64204.87 toks/s, output: 62.70 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [01:05<00:00, 62.70it/s, est. speed input: 64204.87 toks/s, output: 62.70 toks/s]
[rank0]:[W125 18:35:59.896780264 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=65536 ==========
Time: 2026-01-25 18:36:01
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=8192, max_num_seqs=64
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 8192 --max-num-seqs 64 --max-model-len 1025 --max-num-batched-tokens 65536 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Llama3.2-3B-INT8_M65536.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 18:36:52 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=314003) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=314003) WARNING 01-25 18:37:10 [backends.py:609] Failed to read file <frozen os>
Throughput: 54.19 requests/s, 55540.49 total tokens/s, 54.19 output tokens/s
Total num prompt tokens:  8388608
Total num output tokens:  8192

STDERR:
[2026-01-25 18:36:52] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:36:52] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 18:36:52] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 18:36:52] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:36:52] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:36:52] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:36:52] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:36:52] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:36:52] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 18:36:52] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:36:52] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:36:52] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:36:52] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:36:52] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 18:36:59] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:36:59] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 18:36:59] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 18:36:59] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:36:59] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:36:59] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:36:59] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:36:59] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:36:59] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 18:36:59] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:36:59] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:36:59] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:36:59] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:36:59] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=314003) [2026-01-25 18:37:01] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=314003) [2026-01-25 18:37:01] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=314003) [2026-01-25 18:37:01] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=314003) [2026-01-25 18:37:01] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=314003) [2026-01-25 18:37:01] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-3B-INT8
(EngineCore_DP0 pid=314003) [2026-01-25 18:37:01] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=314003) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=314003) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.75it/s]
(EngineCore_DP0 pid=314003) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.75it/s]
(EngineCore_DP0 pid=314003) 
(EngineCore_DP0 pid=314003) [2026-01-25 18:37:02] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 4608] -> 1D uint8
(EngineCore_DP0 pid=314003) [2026-01-25 18:37:02] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 17694720 bytes
(EngineCore_DP0 pid=314003) [2026-01-25 18:37:02] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 4608] -> 1D uint8
(EngineCore_DP0 pid=314003) [2026-01-25 18:37:02] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 10616832 bytes
(EngineCore_DP0 pid=314003) [2026-01-25 18:37:02] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 4608] -> 1D uint8
(EngineCore_DP0 pid=314003) [2026-01-25 18:37:02] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 56623104 bytes
(EngineCore_DP0 pid=314003) [2026-01-25 18:37:02] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 12288] -> 1D uint8
(EngineCore_DP0 pid=314003) [2026-01-25 18:37:02] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 28311552 bytes
(EngineCore_DP0 pid=314003) [rank0]:W0125 18:37:18.997000 314003 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=314003) [rank0]:W0125 18:37:19.135000 314003 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=314003) [rank0]:W0125 18:37:20.437000 314003 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=314003) [rank0]:W0125 18:37:20.650000 314003 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=314003) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/19 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   5%|▌         | 1/19 [00:00<00:05,  3.41it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  11%|█         | 2/19 [00:00<00:06,  2.60it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  16%|█▌        | 3/19 [00:00<00:04,  3.90it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  26%|██▋       | 5/19 [00:01<00:02,  6.11it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  37%|███▋      | 7/19 [00:01<00:01,  7.41it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  47%|████▋     | 9/19 [00:01<00:01,  8.41it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  58%|█████▊    | 11/19 [00:01<00:00,  9.08it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  68%|██████▊   | 13/19 [00:01<00:00,  9.48it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  79%|███████▉  | 15/19 [00:01<00:00,  9.97it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  89%|████████▉ | 17/19 [00:02<00:00, 10.31it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 19/19 [00:02<00:00, 10.26it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 19/19 [00:02<00:00,  8.07it/s]
(EngineCore_DP0 pid=314003) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):   9%|▉         | 1/11 [00:00<00:01,  9.42it/s]
Capturing CUDA graphs (decode, FULL):  27%|██▋       | 3/11 [00:00<00:00, 10.73it/s]
Capturing CUDA graphs (decode, FULL):  45%|████▌     | 5/11 [00:00<00:00, 10.43it/s]
Capturing CUDA graphs (decode, FULL):  64%|██████▎   | 7/11 [00:00<00:00, 10.79it/s]
Capturing CUDA graphs (decode, FULL):  82%|████████▏ | 9/11 [00:00<00:00, 10.99it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 11/11 [00:01<00:00, 11.14it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 11/11 [00:01<00:00, 10.91it/s]

Adding requests:   0%|          | 0/8192 [00:00<?, ?it/s]
Adding requests:   0%|          | 35/8192 [00:00<00:23, 342.34it/s]
Adding requests:   1%|          | 72/8192 [00:00<00:22, 355.61it/s]
Adding requests:   1%|▏         | 111/8192 [00:00<00:21, 368.73it/s]
Adding requests:   2%|▏         | 148/8192 [00:00<00:22, 364.51it/s]
Adding requests:   2%|▏         | 185/8192 [00:00<00:21, 366.33it/s]
Adding requests:   3%|▎         | 225/8192 [00:00<00:21, 376.18it/s]
Adding requests:   3%|▎         | 264/8192 [00:00<00:20, 378.03it/s]
Adding requests:   4%|▎         | 302/8192 [00:00<00:21, 370.84it/s]
Adding requests:   4%|▍         | 340/8192 [00:00<00:21, 367.54it/s]
Adding requests:   5%|▍         | 378/8192 [00:01<00:21, 369.37it/s]
Adding requests:   5%|▌         | 416/8192 [00:01<00:20, 371.20it/s]
Adding requests:   6%|▌         | 456/8192 [00:01<00:20, 379.50it/s]
Adding requests:   6%|▌         | 495/8192 [00:01<00:20, 380.93it/s]
Adding requests:   7%|▋         | 534/8192 [00:01<00:20, 374.92it/s]
Adding requests:   7%|▋         | 577/8192 [00:01<00:19, 389.56it/s]
Adding requests:   8%|▊         | 617/8192 [00:01<00:19, 388.14it/s]
Adding requests:   8%|▊         | 657/8192 [00:01<00:19, 388.70it/s]
Adding requests:   9%|▊         | 700/8192 [00:01<00:18, 399.16it/s]
Adding requests:   9%|▉         | 741/8192 [00:01<00:18, 401.01it/s]
Adding requests:  10%|▉         | 782/8192 [00:02<00:18, 399.50it/s]
Adding requests:  10%|█         | 822/8192 [00:02<00:19, 381.06it/s]
Adding requests:  11%|█         | 864/8192 [00:02<00:18, 389.72it/s]
Adding requests:  11%|█         | 907/8192 [00:02<00:18, 399.69it/s]
Adding requests:  12%|█▏        | 949/8192 [00:02<00:17, 405.27it/s]
Adding requests:  12%|█▏        | 992/8192 [00:02<00:17, 411.49it/s]
Adding requests:  13%|█▎        | 1035/8192 [00:02<00:17, 416.00it/s]
Adding requests:  13%|█▎        | 1077/8192 [00:02<00:17, 402.12it/s]
Adding requests:  14%|█▎        | 1118/8192 [00:02<00:18, 392.52it/s]
Adding requests:  14%|█▍        | 1160/8192 [00:02<00:17, 398.11it/s]
Adding requests:  15%|█▍        | 1202/8192 [00:03<00:17, 403.20it/s]
Adding requests:  15%|█▌        | 1243/8192 [00:03<00:17, 400.91it/s]
Adding requests:  16%|█▌        | 1284/8192 [00:03<00:17, 398.57it/s]
Adding requests:  16%|█▌        | 1324/8192 [00:03<00:17, 398.92it/s]
Adding requests:  17%|█▋        | 1365/8192 [00:03<00:16, 401.84it/s]
Adding requests:  17%|█▋        | 1408/8192 [00:03<00:16, 409.16it/s]
Adding requests:  18%|█▊        | 1450/8192 [00:03<00:16, 410.76it/s]
Adding requests:  18%|█▊        | 1493/8192 [00:03<00:16, 414.89it/s]
Adding requests:  19%|█▊        | 1535/8192 [00:03<00:16, 409.30it/s]
Adding requests:  19%|█▉        | 1576/8192 [00:04<00:16, 401.51it/s]
Adding requests:  20%|█▉        | 1617/8192 [00:04<00:16, 400.40it/s]
Adding requests:  20%|██        | 1658/8192 [00:04<00:16, 392.30it/s]
Adding requests:  21%|██        | 1698/8192 [00:04<00:16, 390.99it/s]
Adding requests:  21%|██▏       | 1741/8192 [00:04<00:16, 401.96it/s]
Adding requests:  22%|██▏       | 1782/8192 [00:04<00:16, 386.72it/s]
Adding requests:  22%|██▏       | 1824/8192 [00:04<00:16, 393.81it/s]
Adding requests:  23%|██▎       | 1864/8192 [00:04<00:16, 395.35it/s]
Adding requests:  23%|██▎       | 1907/8192 [00:04<00:15, 403.30it/s]
Adding requests:  24%|██▍       | 1949/8192 [00:04<00:15, 405.03it/s]
Adding requests:  24%|██▍       | 1990/8192 [00:05<00:15, 402.56it/s]
Adding requests:  25%|██▍       | 2033/8192 [00:05<00:15, 408.31it/s]
Adding requests:  25%|██▌       | 2074/8192 [00:05<00:15, 400.53it/s]
Adding requests:  26%|██▌       | 2115/8192 [00:05<00:15, 392.46it/s]
Adding requests:  26%|██▋       | 2155/8192 [00:05<00:15, 382.19it/s]
Adding requests:  27%|██▋       | 2194/8192 [00:05<00:15, 377.49it/s]
Adding requests:  27%|██▋       | 2233/8192 [00:05<00:15, 379.76it/s]
Adding requests:  28%|██▊       | 2272/8192 [00:05<00:15, 381.74it/s]
Adding requests:  28%|██▊       | 2311/8192 [00:05<00:15, 378.78it/s]
Adding requests:  29%|██▊       | 2349/8192 [00:06<00:15, 373.14it/s]
Adding requests:  29%|██▉       | 2387/8192 [00:06<00:15, 373.60it/s]
Adding requests:  30%|██▉       | 2427/8192 [00:06<00:15, 379.75it/s]
Adding requests:  30%|███       | 2465/8192 [00:06<00:15, 372.34it/s]
Adding requests:  31%|███       | 2503/8192 [00:06<00:15, 369.43it/s]
Adding requests:  31%|███       | 2543/8192 [00:06<00:15, 374.00it/s]
Adding requests:  32%|███▏      | 2583/8192 [00:06<00:14, 378.38it/s]
Adding requests:  32%|███▏      | 2621/8192 [00:06<00:14, 376.19it/s]
Adding requests:  33%|███▎      | 2663/8192 [00:06<00:14, 386.15it/s]
Adding requests:  33%|███▎      | 2702/8192 [00:06<00:14, 377.54it/s]
Adding requests:  33%|███▎      | 2740/8192 [00:07<00:14, 372.13it/s]
Adding requests:  34%|███▍      | 2780/8192 [00:07<00:14, 378.41it/s]
Adding requests:  34%|███▍      | 2820/8192 [00:07<00:14, 380.07it/s]
Adding requests:  35%|███▍      | 2859/8192 [00:07<00:14, 376.80it/s]
Adding requests:  35%|███▌      | 2897/8192 [00:07<00:14, 376.16it/s]
Adding requests:  36%|███▌      | 2935/8192 [00:07<00:14, 368.18it/s]
Adding requests:  36%|███▋      | 2973/8192 [00:07<00:14, 369.66it/s]
Adding requests:  37%|███▋      | 3011/8192 [00:07<00:13, 370.33it/s]
Adding requests:  37%|███▋      | 3051/8192 [00:07<00:13, 376.77it/s]
Adding requests:  38%|███▊      | 3089/8192 [00:07<00:13, 364.77it/s]
Adding requests:  38%|███▊      | 3127/8192 [00:08<00:13, 368.73it/s]
Adding requests:  39%|███▊      | 3165/8192 [00:08<00:13, 371.13it/s]
Adding requests:  39%|███▉      | 3204/8192 [00:08<00:13, 375.84it/s]
Adding requests:  40%|███▉      | 3242/8192 [00:08<00:13, 373.20it/s]
Adding requests:  40%|████      | 3282/8192 [00:08<00:12, 380.88it/s]
Adding requests:  41%|████      | 3322/8192 [00:08<00:12, 384.15it/s]
Adding requests:  41%|████      | 3361/8192 [00:08<00:12, 384.71it/s]
Adding requests:  42%|████▏     | 3400/8192 [00:08<00:12, 375.31it/s]
Adding requests:  42%|████▏     | 3438/8192 [00:08<00:12, 376.40it/s]
Adding requests:  42%|████▏     | 3476/8192 [00:09<00:12, 367.59it/s]
Adding requests:  43%|████▎     | 3513/8192 [00:09<00:12, 366.72it/s]
Adding requests:  43%|████▎     | 3550/8192 [00:09<00:12, 366.05it/s]
Adding requests:  44%|████▍     | 3589/8192 [00:09<00:12, 372.46it/s]
Adding requests:  44%|████▍     | 3627/8192 [00:09<00:12, 366.92it/s]
Adding requests:  45%|████▍     | 3667/8192 [00:09<00:12, 375.66it/s]
Adding requests:  45%|████▌     | 3707/8192 [00:09<00:11, 381.02it/s]
Adding requests:  46%|████▌     | 3746/8192 [00:09<00:11, 378.43it/s]
Adding requests:  46%|████▌     | 3787/8192 [00:09<00:11, 385.49it/s]
Adding requests:  47%|████▋     | 3827/8192 [00:09<00:11, 387.36it/s]
Adding requests:  47%|████▋     | 3866/8192 [00:10<00:11, 385.27it/s]
Adding requests:  48%|████▊     | 3905/8192 [00:10<00:11, 385.73it/s]
Adding requests:  48%|████▊     | 3944/8192 [00:10<00:11, 385.65it/s]
Adding requests:  49%|████▊     | 3983/8192 [00:10<00:11, 378.77it/s]
Adding requests:  49%|████▉     | 4021/8192 [00:10<00:11, 372.48it/s]
Adding requests:  50%|████▉     | 4059/8192 [00:10<00:11, 366.57it/s]
Adding requests:  50%|█████     | 4098/8192 [00:10<00:10, 372.47it/s]
Adding requests:  51%|█████     | 4137/8192 [00:10<00:10, 375.18it/s]
Adding requests:  51%|█████     | 4177/8192 [00:10<00:10, 380.07it/s]
Adding requests:  51%|█████▏    | 4216/8192 [00:10<00:10, 372.75it/s]
Adding requests:  52%|█████▏    | 4254/8192 [00:11<00:10, 372.14it/s]
Adding requests:  52%|█████▏    | 4293/8192 [00:11<00:10, 376.16it/s]
Adding requests:  53%|█████▎    | 4335/8192 [00:11<00:09, 386.70it/s]
Adding requests:  53%|█████▎    | 4374/8192 [00:11<00:09, 387.34it/s]
Adding requests:  54%|█████▍    | 4413/8192 [00:11<00:10, 377.66it/s]
Adding requests:  54%|█████▍    | 4452/8192 [00:11<00:09, 380.60it/s]
Adding requests:  55%|█████▍    | 4491/8192 [00:11<00:09, 378.69it/s]
Adding requests:  55%|█████▌    | 4529/8192 [00:11<00:09, 374.16it/s]
Adding requests:  56%|█████▌    | 4570/8192 [00:11<00:09, 382.77it/s]
Adding requests:  56%|█████▋    | 4609/8192 [00:12<00:09, 377.97it/s]
Adding requests:  57%|█████▋    | 4647/8192 [00:12<00:09, 372.47it/s]
Adding requests:  57%|█████▋    | 4685/8192 [00:12<00:09, 366.04it/s]
Adding requests:  58%|█████▊    | 4722/8192 [00:12<00:09, 364.74it/s]
Adding requests:  58%|█████▊    | 4759/8192 [00:12<00:09, 360.57it/s]
Adding requests:  59%|█████▊    | 4796/8192 [00:12<00:09, 358.63it/s]
Adding requests:  59%|█████▉    | 4834/8192 [00:12<00:09, 363.83it/s]
Adding requests:  59%|█████▉    | 4872/8192 [00:12<00:09, 367.88it/s]
Adding requests:  60%|█████▉    | 4911/8192 [00:12<00:08, 374.03it/s]
Adding requests:  60%|██████    | 4950/8192 [00:12<00:08, 377.34it/s]
Adding requests:  61%|██████    | 4988/8192 [00:13<00:08, 372.22it/s]
Adding requests:  61%|██████▏   | 5026/8192 [00:13<00:08, 373.81it/s]
Adding requests:  62%|██████▏   | 5066/8192 [00:13<00:08, 379.26it/s]
Adding requests:  62%|██████▏   | 5107/8192 [00:13<00:08, 385.11it/s]
Adding requests:  63%|██████▎   | 5147/8192 [00:13<00:07, 387.53it/s]
Adding requests:  63%|██████▎   | 5186/8192 [00:13<00:07, 384.77it/s]
Adding requests:  64%|██████▍   | 5225/8192 [00:13<00:07, 383.58it/s]
Adding requests:  64%|██████▍   | 5265/8192 [00:13<00:07, 386.04it/s]
Adding requests:  65%|██████▍   | 5306/8192 [00:13<00:07, 391.78it/s]
Adding requests:  65%|██████▌   | 5346/8192 [00:13<00:07, 392.49it/s]
Adding requests:  66%|██████▌   | 5386/8192 [00:14<00:07, 392.26it/s]
Adding requests:  66%|██████▌   | 5426/8192 [00:14<00:07, 392.61it/s]
Adding requests:  67%|██████▋   | 5466/8192 [00:14<00:06, 391.87it/s]
Adding requests:  67%|██████▋   | 5506/8192 [00:14<00:06, 387.53it/s]
Adding requests:  68%|██████▊   | 5545/8192 [00:14<00:06, 383.15it/s]
Adding requests:  68%|██████▊   | 5584/8192 [00:14<00:06, 377.13it/s]
Adding requests:  69%|██████▊   | 5622/8192 [00:14<00:06, 370.95it/s]
Adding requests:  69%|██████▉   | 5660/8192 [00:14<00:06, 372.34it/s]
Adding requests:  70%|██████▉   | 5700/8192 [00:14<00:06, 379.50it/s]
Adding requests:  70%|███████   | 5739/8192 [00:15<00:06, 379.60it/s]
Adding requests:  71%|███████   | 5777/8192 [00:15<00:06, 375.55it/s]
Adding requests:  71%|███████   | 5815/8192 [00:15<00:06, 373.93it/s]
Adding requests:  71%|███████▏  | 5855/8192 [00:15<00:06, 380.85it/s]
Adding requests:  72%|███████▏  | 5896/8192 [00:15<00:05, 386.47it/s]
Adding requests:  72%|███████▏  | 5935/8192 [00:15<00:05, 377.18it/s]
Adding requests:  73%|███████▎  | 5973/8192 [00:15<00:05, 371.13it/s]
Adding requests:  73%|███████▎  | 6011/8192 [00:15<00:05, 369.28it/s]
Adding requests:  74%|███████▍  | 6048/8192 [00:15<00:05, 369.36it/s]
Adding requests:  74%|███████▍  | 6086/8192 [00:15<00:05, 369.51it/s]
Adding requests:  75%|███████▍  | 6124/8192 [00:16<00:05, 369.70it/s]
Adding requests:  75%|███████▌  | 6163/8192 [00:16<00:05, 374.94it/s]
Adding requests:  76%|███████▌  | 6204/8192 [00:16<00:05, 384.49it/s]
Adding requests:  76%|███████▌  | 6244/8192 [00:16<00:05, 386.95it/s]
Adding requests:  77%|███████▋  | 6285/8192 [00:16<00:04, 392.91it/s]
Adding requests:  77%|███████▋  | 6326/8192 [00:16<00:04, 397.32it/s]
Adding requests:  78%|███████▊  | 6366/8192 [00:16<00:04, 392.97it/s]
Adding requests:  78%|███████▊  | 6406/8192 [00:16<00:04, 384.00it/s]
Adding requests:  79%|███████▊  | 6446/8192 [00:16<00:04, 387.60it/s]
Adding requests:  79%|███████▉  | 6485/8192 [00:16<00:04, 387.96it/s]
Adding requests:  80%|███████▉  | 6524/8192 [00:17<00:04, 386.97it/s]
Adding requests:  80%|████████  | 6563/8192 [00:17<00:04, 379.18it/s]
Adding requests:  81%|████████  | 6602/8192 [00:17<00:04, 381.45it/s]
Adding requests:  81%|████████  | 6641/8192 [00:17<00:04, 375.22it/s]
Adding requests:  82%|████████▏ | 6679/8192 [00:17<00:04, 373.96it/s]
Adding requests:  82%|████████▏ | 6720/8192 [00:17<00:03, 383.33it/s]
Adding requests:  83%|████████▎ | 6759/8192 [00:17<00:03, 380.09it/s]
Adding requests:  83%|████████▎ | 6798/8192 [00:17<00:03, 381.45it/s]
Adding requests:  83%|████████▎ | 6837/8192 [00:17<00:03, 382.17it/s]
Adding requests:  84%|████████▍ | 6878/8192 [00:17<00:03, 389.18it/s]
Adding requests:  84%|████████▍ | 6917/8192 [00:18<00:03, 388.20it/s]
Adding requests:  85%|████████▍ | 6958/8192 [00:18<00:03, 393.24it/s]
Adding requests:  85%|████████▌ | 6998/8192 [00:18<00:03, 391.95it/s]
Adding requests:  86%|████████▌ | 7038/8192 [00:18<00:02, 388.53it/s]
Adding requests:  86%|████████▋ | 7077/8192 [00:18<00:02, 382.15it/s]
Adding requests:  87%|████████▋ | 7116/8192 [00:18<00:02, 376.37it/s]
Adding requests:  87%|████████▋ | 7154/8192 [00:18<00:02, 366.98it/s]
Adding requests:  88%|████████▊ | 7191/8192 [00:18<00:02, 361.84it/s]
Adding requests:  88%|████████▊ | 7229/8192 [00:18<00:02, 367.04it/s]
Adding requests:  89%|████████▊ | 7268/8192 [00:19<00:02, 371.72it/s]
Adding requests:  89%|████████▉ | 7308/8192 [00:19<00:02, 379.61it/s]
Adding requests:  90%|████████▉ | 7348/8192 [00:19<00:02, 384.64it/s]
Adding requests:  90%|█████████ | 7389/8192 [00:19<00:02, 389.56it/s]
Adding requests:  91%|█████████ | 7431/8192 [00:19<00:01, 397.62it/s]
Adding requests:  91%|█████████ | 7471/8192 [00:19<00:01, 392.52it/s]
Adding requests:  92%|█████████▏| 7512/8192 [00:19<00:01, 395.64it/s]
Adding requests:  92%|█████████▏| 7552/8192 [00:19<00:01, 393.00it/s]
Adding requests:  93%|█████████▎| 7592/8192 [00:19<00:01, 380.84it/s]
Adding requests:  93%|█████████▎| 7631/8192 [00:19<00:01, 379.52it/s]
Adding requests:  94%|█████████▎| 7670/8192 [00:20<00:01, 376.08it/s]
Adding requests:  94%|█████████▍| 7708/8192 [00:20<00:01, 371.71it/s]
Adding requests:  95%|█████████▍| 7746/8192 [00:20<00:01, 370.44it/s]
Adding requests:  95%|█████████▌| 7784/8192 [00:20<00:01, 372.89it/s]
Adding requests:  95%|█████████▌| 7822/8192 [00:20<00:00, 371.48it/s]
Adding requests:  96%|█████████▌| 7861/8192 [00:20<00:00, 376.08it/s]
Adding requests:  96%|█████████▋| 7899/8192 [00:20<00:00, 373.77it/s]
Adding requests:  97%|█████████▋| 7937/8192 [00:20<00:00, 368.71it/s]
Adding requests:  97%|█████████▋| 7974/8192 [00:20<00:00, 364.55it/s]
Adding requests:  98%|█████████▊| 8011/8192 [00:20<00:00, 362.99it/s]
Adding requests:  98%|█████████▊| 8048/8192 [00:21<00:00, 362.61it/s]
Adding requests:  99%|█████████▊| 8087/8192 [00:21<00:00, 370.18it/s]
Adding requests:  99%|█████████▉| 8126/8192 [00:21<00:00, 374.01it/s]
Adding requests: 100%|█████████▉| 8165/8192 [00:21<00:00, 377.41it/s]
Adding requests: 100%|██████████| 8192/8192 [00:21<00:00, 381.54it/s]

Processed prompts:   0%|          | 0/8192 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  14%|█▍        | 1179/8192 [00:01<00:07, 989.88it/s, est. speed input: 1013660.51 toks/s, output: 989.88 toks/s]
Processed prompts:  16%|█▌        | 1278/8192 [00:02<00:14, 461.11it/s, est. speed input: 554097.13 toks/s, output: 541.11 toks/s] 
Processed prompts:  16%|█▌        | 1324/8192 [00:03<00:25, 269.42it/s, est. speed input: 383976.91 toks/s, output: 374.98 toks/s]
Processed prompts:  17%|█▋        | 1371/8192 [00:04<00:38, 179.05it/s, est. speed input: 298563.65 toks/s, output: 291.56 toks/s]
Processed prompts:  18%|█▊        | 1435/8192 [00:05<00:50, 134.27it/s, est. speed input: 250222.26 toks/s, output: 244.36 toks/s]
Processed prompts:  18%|█▊        | 1499/8192 [00:07<01:02, 107.22it/s, est. speed input: 217927.30 toks/s, output: 212.82 toks/s]
Processed prompts:  19%|█▉        | 1563/8192 [00:08<01:13, 90.04it/s, est. speed input: 194835.80 toks/s, output: 190.27 toks/s] 
Processed prompts:  20%|█▉        | 1627/8192 [00:09<01:23, 78.76it/s, est. speed input: 177497.71 toks/s, output: 173.34 toks/s]
Processed prompts:  21%|██        | 1691/8192 [00:10<01:31, 71.23it/s, est. speed input: 164016.23 toks/s, output: 160.17 toks/s]
Processed prompts:  21%|██▏       | 1755/8192 [00:11<01:37, 66.10it/s, est. speed input: 153218.11 toks/s, output: 149.63 toks/s]
Processed prompts:  22%|██▏       | 1819/8192 [00:12<01:41, 62.90it/s, est. speed input: 144598.27 toks/s, output: 141.21 toks/s]
Processed prompts:  23%|██▎       | 1883/8192 [00:14<01:44, 60.35it/s, est. speed input: 137189.97 toks/s, output: 133.97 toks/s]
Processed prompts:  24%|██▍       | 1947/8192 [00:15<01:46, 58.79it/s, est. speed input: 131038.26 toks/s, output: 127.97 toks/s]
Processed prompts:  25%|██▍       | 2011/8192 [00:16<01:47, 57.40it/s, est. speed input: 125604.08 toks/s, output: 122.66 toks/s]
Processed prompts:  25%|██▌       | 2075/8192 [00:17<01:48, 56.46it/s, est. speed input: 120907.51 toks/s, output: 118.07 toks/s]
Processed prompts:  26%|██▌       | 2139/8192 [00:18<01:48, 55.82it/s, est. speed input: 116810.83 toks/s, output: 114.07 toks/s]
Processed prompts:  27%|██▋       | 2203/8192 [00:19<01:47, 55.83it/s, est. speed input: 113374.80 toks/s, output: 110.72 toks/s]
Processed prompts:  28%|██▊       | 2267/8192 [00:21<01:46, 55.63it/s, est. speed input: 110242.86 toks/s, output: 107.66 toks/s]
Processed prompts:  28%|██▊       | 2331/8192 [00:22<01:45, 55.51it/s, est. speed input: 107443.10 toks/s, output: 104.92 toks/s]
Processed prompts:  29%|██▉       | 2395/8192 [00:23<01:45, 55.11it/s, est. speed input: 104819.18 toks/s, output: 102.36 toks/s]
Processed prompts:  30%|███       | 2459/8192 [00:24<01:44, 55.09it/s, est. speed input: 102526.18 toks/s, output: 100.12 toks/s]
Processed prompts:  31%|███       | 2523/8192 [00:25<01:43, 54.83it/s, est. speed input: 100370.57 toks/s, output: 98.02 toks/s] 
Processed prompts:  32%|███▏      | 2587/8192 [00:26<01:42, 54.87it/s, est. speed input: 98462.98 toks/s, output: 96.16 toks/s] 
Processed prompts:  32%|███▏      | 2651/8192 [00:28<01:41, 54.68it/s, est. speed input: 96660.20 toks/s, output: 94.39 toks/s]
Processed prompts:  33%|███▎      | 2715/8192 [00:29<01:40, 54.53it/s, est. speed input: 94997.40 toks/s, output: 92.77 toks/s]
Processed prompts:  34%|███▍      | 2779/8192 [00:30<01:39, 54.41it/s, est. speed input: 93461.92 toks/s, output: 91.27 toks/s]
Processed prompts:  35%|███▍      | 2843/8192 [00:31<01:38, 54.34it/s, est. speed input: 92042.01 toks/s, output: 89.88 toks/s]
Processed prompts:  35%|███▌      | 2907/8192 [00:32<01:37, 54.25it/s, est. speed input: 90718.01 toks/s, output: 88.59 toks/s]
Processed prompts:  36%|███▋      | 2971/8192 [00:33<01:36, 54.21it/s, est. speed input: 89489.23 toks/s, output: 87.39 toks/s]
Processed prompts:  37%|███▋      | 3035/8192 [00:35<01:35, 54.21it/s, est. speed input: 88349.57 toks/s, output: 86.28 toks/s]
Processed prompts:  38%|███▊      | 3099/8192 [00:36<01:33, 54.44it/s, est. speed input: 87323.27 toks/s, output: 85.28 toks/s]
Processed prompts:  39%|███▊      | 3163/8192 [00:37<01:32, 54.32it/s, est. speed input: 86313.76 toks/s, output: 84.29 toks/s]
Processed prompts:  39%|███▉      | 3227/8192 [00:38<01:31, 54.24it/s, est. speed input: 85365.93 toks/s, output: 83.37 toks/s]
Processed prompts:  40%|████      | 3291/8192 [00:39<01:30, 54.15it/s, est. speed input: 84470.88 toks/s, output: 82.49 toks/s]
Processed prompts:  41%|████      | 3355/8192 [00:41<01:29, 54.11it/s, est. speed input: 83628.95 toks/s, output: 81.67 toks/s]
Processed prompts:  42%|████▏     | 3419/8192 [00:42<01:28, 54.07it/s, est. speed input: 82833.96 toks/s, output: 80.89 toks/s]
Processed prompts:  43%|████▎     | 3483/8192 [00:43<01:27, 54.03it/s, est. speed input: 82080.30 toks/s, output: 80.16 toks/s]
Processed prompts:  43%|████▎     | 3547/8192 [00:44<01:26, 54.01it/s, est. speed input: 81367.39 toks/s, output: 79.46 toks/s]
Processed prompts:  44%|████▍     | 3611/8192 [00:45<01:24, 53.96it/s, est. speed input: 80687.62 toks/s, output: 78.80 toks/s]
Processed prompts:  45%|████▍     | 3675/8192 [00:47<01:23, 53.94it/s, est. speed input: 80043.26 toks/s, output: 78.17 toks/s]
Processed prompts:  46%|████▌     | 3739/8192 [00:48<01:22, 54.16it/s, est. speed input: 79458.42 toks/s, output: 77.60 toks/s]
Processed prompts:  46%|████▋     | 3803/8192 [00:49<01:21, 54.06it/s, est. speed input: 78873.20 toks/s, output: 77.02 toks/s]
Processed prompts:  47%|████▋     | 3867/8192 [00:50<01:20, 53.98it/s, est. speed input: 78313.20 toks/s, output: 76.48 toks/s]
Processed prompts:  48%|████▊     | 3931/8192 [00:51<01:19, 53.91it/s, est. speed input: 77777.95 toks/s, output: 75.95 toks/s]
Processed prompts:  49%|████▉     | 3995/8192 [00:52<01:17, 54.11it/s, est. speed input: 77292.49 toks/s, output: 75.48 toks/s]
Processed prompts:  50%|████▉     | 4059/8192 [00:54<01:16, 54.03it/s, est. speed input: 76806.35 toks/s, output: 75.01 toks/s]
Processed prompts:  50%|█████     | 4123/8192 [00:55<01:15, 53.94it/s, est. speed input: 76337.29 toks/s, output: 74.55 toks/s]
Processed prompts:  51%|█████     | 4187/8192 [00:56<01:13, 54.13it/s, est. speed input: 75912.86 toks/s, output: 74.13 toks/s]
Processed prompts:  52%|█████▏    | 4251/8192 [00:57<01:12, 54.27it/s, est. speed input: 75505.49 toks/s, output: 73.74 toks/s]
Processed prompts:  53%|█████▎    | 4315/8192 [00:58<01:11, 54.40it/s, est. speed input: 75117.92 toks/s, output: 73.36 toks/s]
Processed prompts:  53%|█████▎    | 4379/8192 [01:00<01:10, 54.23it/s, est. speed input: 74721.88 toks/s, output: 72.97 toks/s]
Processed prompts:  54%|█████▍    | 4443/8192 [01:01<01:09, 54.10it/s, est. speed input: 74340.43 toks/s, output: 72.60 toks/s]
Processed prompts:  55%|█████▌    | 4507/8192 [01:02<01:08, 53.99it/s, est. speed input: 73972.16 toks/s, output: 72.24 toks/s]
Processed prompts:  56%|█████▌    | 4571/8192 [01:03<01:07, 53.94it/s, est. speed input: 73618.83 toks/s, output: 71.89 toks/s]
Processed prompts:  57%|█████▋    | 4635/8192 [01:04<01:06, 53.89it/s, est. speed input: 73278.31 toks/s, output: 71.56 toks/s]
Processed prompts:  57%|█████▋    | 4699/8192 [01:05<01:04, 53.86it/s, est. speed input: 72949.62 toks/s, output: 71.24 toks/s]
Processed prompts:  58%|█████▊    | 4763/8192 [01:07<01:03, 54.07it/s, est. speed input: 72651.86 toks/s, output: 70.95 toks/s]
Processed prompts:  59%|█████▉    | 4827/8192 [01:08<01:02, 54.21it/s, est. speed input: 72362.92 toks/s, output: 70.67 toks/s]
Processed prompts:  60%|█████▉    | 4891/8192 [01:09<01:01, 54.03it/s, est. speed input: 72063.03 toks/s, output: 70.37 toks/s]
Processed prompts:  60%|██████    | 4955/8192 [01:10<00:59, 54.11it/s, est. speed input: 71788.86 toks/s, output: 70.11 toks/s]
Processed prompts:  61%|██████▏   | 5019/8192 [01:11<00:58, 53.93it/s, est. speed input: 71505.96 toks/s, output: 69.83 toks/s]
Processed prompts:  62%|██████▏   | 5083/8192 [01:13<00:57, 53.88it/s, est. speed input: 71238.01 toks/s, output: 69.57 toks/s]
Processed prompts:  63%|██████▎   | 5147/8192 [01:14<00:56, 53.84it/s, est. speed input: 70977.87 toks/s, output: 69.31 toks/s]
Processed prompts:  64%|██████▎   | 5211/8192 [01:15<00:55, 53.78it/s, est. speed input: 70724.34 toks/s, output: 69.07 toks/s]
Processed prompts:  64%|██████▍   | 5275/8192 [01:16<00:54, 53.81it/s, est. speed input: 70483.17 toks/s, output: 68.83 toks/s]
Processed prompts:  65%|██████▌   | 5339/8192 [01:17<00:53, 53.80it/s, est. speed input: 70247.60 toks/s, output: 68.60 toks/s]
Processed prompts:  66%|██████▌   | 5403/8192 [01:19<00:51, 53.81it/s, est. speed input: 70019.96 toks/s, output: 68.38 toks/s]
Processed prompts:  67%|██████▋   | 5467/8192 [01:20<00:50, 53.80it/s, est. speed input: 69798.09 toks/s, output: 68.16 toks/s]
Processed prompts:  68%|██████▊   | 5531/8192 [01:21<00:49, 53.99it/s, est. speed input: 69594.90 toks/s, output: 67.96 toks/s]
Processed prompts:  68%|██████▊   | 5595/8192 [01:22<00:48, 53.92it/s, est. speed input: 69385.45 toks/s, output: 67.76 toks/s]
Processed prompts:  69%|██████▉   | 5659/8192 [01:23<00:47, 53.84it/s, est. speed input: 69179.68 toks/s, output: 67.56 toks/s]
Processed prompts:  70%|██████▉   | 5723/8192 [01:24<00:45, 53.80it/s, est. speed input: 68980.43 toks/s, output: 67.36 toks/s]
Processed prompts:  71%|███████   | 5787/8192 [01:26<00:44, 53.74it/s, est. speed input: 68785.45 toks/s, output: 67.17 toks/s]
Processed prompts:  71%|███████▏  | 5851/8192 [01:27<00:43, 53.71it/s, est. speed input: 68596.00 toks/s, output: 66.99 toks/s]
Processed prompts:  72%|███████▏  | 5915/8192 [01:28<00:42, 53.68it/s, est. speed input: 68411.18 toks/s, output: 66.81 toks/s]
Processed prompts:  73%|███████▎  | 5979/8192 [01:29<00:41, 53.60it/s, est. speed input: 68228.09 toks/s, output: 66.63 toks/s]
Processed prompts:  74%|███████▍  | 6043/8192 [01:30<00:40, 53.65it/s, est. speed input: 68055.88 toks/s, output: 66.46 toks/s]
Processed prompts:  75%|███████▍  | 6107/8192 [01:32<00:38, 53.65it/s, est. speed input: 67885.87 toks/s, output: 66.29 toks/s]
Processed prompts:  75%|███████▌  | 6171/8192 [01:33<00:37, 53.67it/s, est. speed input: 67721.41 toks/s, output: 66.13 toks/s]
Processed prompts:  76%|███████▌  | 6235/8192 [01:34<00:36, 53.69it/s, est. speed input: 67561.51 toks/s, output: 65.98 toks/s]
Processed prompts:  77%|███████▋  | 6299/8192 [01:35<00:35, 53.69it/s, est. speed input: 67404.81 toks/s, output: 65.82 toks/s]
Processed prompts:  78%|███████▊  | 6363/8192 [01:36<00:34, 53.70it/s, est. speed input: 67252.34 toks/s, output: 65.68 toks/s]
Processed prompts:  78%|███████▊  | 6427/8192 [01:38<00:32, 53.69it/s, est. speed input: 67103.02 toks/s, output: 65.53 toks/s]
Processed prompts:  79%|███████▉  | 6491/8192 [01:39<00:31, 53.66it/s, est. speed input: 66955.97 toks/s, output: 65.39 toks/s]
Processed prompts:  80%|████████  | 6555/8192 [01:40<00:30, 53.90it/s, est. speed input: 66824.84 toks/s, output: 65.26 toks/s]
Processed prompts:  81%|████████  | 6619/8192 [01:41<00:29, 54.05it/s, est. speed input: 66696.27 toks/s, output: 65.13 toks/s]
Processed prompts:  82%|████████▏ | 6683/8192 [01:42<00:27, 53.91it/s, est. speed input: 66559.12 toks/s, output: 65.00 toks/s]
Processed prompts:  82%|████████▏ | 6747/8192 [01:44<00:26, 53.82it/s, est. speed input: 66425.23 toks/s, output: 64.87 toks/s]
Processed prompts:  83%|████████▎ | 6811/8192 [01:45<00:25, 53.78it/s, est. speed input: 66295.21 toks/s, output: 64.74 toks/s]
Processed prompts:  84%|████████▍ | 6875/8192 [01:46<00:24, 53.75it/s, est. speed input: 66168.67 toks/s, output: 64.62 toks/s]
Processed prompts:  85%|████████▍ | 6939/8192 [01:47<00:23, 53.72it/s, est. speed input: 66044.08 toks/s, output: 64.50 toks/s]
Processed prompts:  85%|████████▌ | 7003/8192 [01:48<00:22, 53.73it/s, est. speed input: 65923.41 toks/s, output: 64.38 toks/s]
Processed prompts:  86%|████████▋ | 7067/8192 [01:49<00:20, 53.75it/s, est. speed input: 65806.11 toks/s, output: 64.26 toks/s]
Processed prompts:  87%|████████▋ | 7131/8192 [01:51<00:19, 53.92it/s, est. speed input: 65698.17 toks/s, output: 64.16 toks/s]
Processed prompts:  88%|████████▊ | 7195/8192 [01:52<00:18, 53.79it/s, est. speed input: 65581.80 toks/s, output: 64.04 toks/s]
Processed prompts:  89%|████████▊ | 7259/8192 [01:53<00:17, 53.96it/s, est. speed input: 65478.86 toks/s, output: 63.94 toks/s]
Processed prompts:  89%|████████▉ | 7323/8192 [01:54<00:16, 53.85it/s, est. speed input: 65368.57 toks/s, output: 63.84 toks/s]
Processed prompts:  90%|█████████ | 7387/8192 [01:55<00:14, 54.01it/s, est. speed input: 65270.21 toks/s, output: 63.74 toks/s]
Processed prompts:  91%|█████████ | 7451/8192 [01:57<00:13, 53.87it/s, est. speed input: 65163.95 toks/s, output: 63.64 toks/s]
Processed prompts:  92%|█████████▏| 7515/8192 [01:58<00:12, 53.78it/s, est. speed input: 65059.54 toks/s, output: 63.53 toks/s]
Processed prompts:  93%|█████████▎| 7579/8192 [01:59<00:11, 53.73it/s, est. speed input: 64958.09 toks/s, output: 63.44 toks/s]
Processed prompts:  93%|█████████▎| 7643/8192 [02:00<00:10, 53.70it/s, est. speed input: 64858.97 toks/s, output: 63.34 toks/s]
Processed prompts:  94%|█████████▍| 7707/8192 [02:01<00:09, 53.66it/s, est. speed input: 64760.82 toks/s, output: 63.24 toks/s]
Processed prompts:  95%|█████████▍| 7771/8192 [02:03<00:07, 53.60it/s, est. speed input: 64663.47 toks/s, output: 63.15 toks/s]
Processed prompts:  96%|█████████▌| 7835/8192 [02:04<00:06, 53.58it/s, est. speed input: 64568.84 toks/s, output: 63.06 toks/s]
Processed prompts:  96%|█████████▋| 7899/8192 [02:05<00:05, 53.61it/s, est. speed input: 64477.65 toks/s, output: 62.97 toks/s]
Processed prompts:  97%|█████████▋| 7963/8192 [02:06<00:04, 53.59it/s, est. speed input: 64386.49 toks/s, output: 62.88 toks/s]
Processed prompts:  98%|█████████▊| 8027/8192 [02:07<00:03, 53.55it/s, est. speed input: 64296.13 toks/s, output: 62.79 toks/s]
Processed prompts:  99%|█████████▉| 8091/8192 [02:09<00:01, 53.79it/s, est. speed input: 64217.20 toks/s, output: 62.71 toks/s]
Processed prompts: 100%|█████████▉| 8155/8192 [02:09<00:00, 61.54it/s, est. speed input: 64380.76 toks/s, output: 62.87 toks/s]
Processed prompts: 100%|██████████| 8192/8192 [02:09<00:00, 61.54it/s, est. speed input: 64672.48 toks/s, output: 63.16 toks/s]
Processed prompts: 100%|██████████| 8192/8192 [02:09<00:00, 63.16it/s, est. speed input: 64672.48 toks/s, output: 63.16 toks/s]
[rank0]:[W125 18:40:05.624212892 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=512 ==========
Time: 2026-01-25 20:02:07
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_8
Params: prompt_len=512, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_8 --dataset-name random --input-len 512 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 513 --max-num-batched-tokens 513 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-7B-INT8_M512.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 20:02:15 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=393437) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=393437) WARNING 01-25 20:11:57 [backends.py:609] Failed to read file <frozen os>
Throughput: 22.12 requests/s, 11348.92 total tokens/s, 22.12 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128

STDERR:
[2026-01-25 20:02:15] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 20:02:15] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 20:02:15] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 20:02:15] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:02:15] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:02:15] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:02:15] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:02:15] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:02:15] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 20:02:15] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 20:02:15] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 20:02:15] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 20:02:15] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 20:02:15] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 20:02:23] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 20:02:23] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 20:02:23] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 20:02:23] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:02:23] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:02:23] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:02:23] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:02:23] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:02:23] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 20:02:23] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 20:02:23] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 20:02:23] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 20:02:23] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 20:02:23] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=393437) [2026-01-25 20:02:24] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=393437) [2026-01-25 20:02:24] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=393437) [2026-01-25 20:02:24] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=393437) [2026-01-25 20:02:24] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=393437) [2026-01-25 20:02:24] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=393437) [2026-01-25 20:02:24] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=393437) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=393437) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [05:36<05:36, 336.38s/it]
(EngineCore_DP0 pid=393437) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [09:24<00:00, 272.84s/it]
(EngineCore_DP0 pid=393437) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [09:24<00:00, 282.37s/it]
(EngineCore_DP0 pid=393437) 
(EngineCore_DP0 pid=393437) [2026-01-25 20:11:49] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=393437) [2026-01-25 20:11:49] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 18579456 bytes
(EngineCore_DP0 pid=393437) [2026-01-25 20:11:49] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=393437) [2026-01-25 20:11:49] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 14450688 bytes
(EngineCore_DP0 pid=393437) [2026-01-25 20:11:49] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=393437) [2026-01-25 20:11:49] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 152764416 bytes
(EngineCore_DP0 pid=393437) [2026-01-25 20:11:49] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=393437) [2026-01-25 20:11:49] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 76382208 bytes
(EngineCore_DP0 pid=393437) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  2.48it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  2.42it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  2.43it/s]
(EngineCore_DP0 pid=393437) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00, 10.25it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  37%|███▋      | 47/128 [00:00<00:00, 464.44it/s]
Adding requests:  74%|███████▍  | 95/128 [00:00<00:00, 469.31it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 470.06it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:17,  7.22it/s, est. speed input: 3696.68 toks/s, output: 7.22 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:07, 15.84it/s, est. speed input: 7445.47 toks/s, output: 14.54 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:06, 19.40it/s, est. speed input: 8966.33 toks/s, output: 17.51 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:00<00:05, 20.75it/s, est. speed input: 9638.19 toks/s, output: 18.82 toks/s]
Processed prompts:  10%|█         | 13/128 [00:00<00:05, 21.65it/s, est. speed input: 10083.73 toks/s, output: 19.69 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:00<00:05, 22.24it/s, est. speed input: 10393.67 toks/s, output: 20.30 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:00<00:04, 22.82it/s, est. speed input: 10656.50 toks/s, output: 20.81 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:01<00:04, 23.34it/s, est. speed input: 10879.28 toks/s, output: 21.25 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:01<00:04, 23.52it/s, est. speed input: 11027.43 toks/s, output: 21.54 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:01<00:04, 23.47it/s, est. speed input: 11120.25 toks/s, output: 21.72 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:01<00:04, 23.64it/s, est. speed input: 11224.74 toks/s, output: 21.92 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:01<00:03, 23.88it/s, est. speed input: 11328.31 toks/s, output: 22.13 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:01<00:03, 24.03it/s, est. speed input: 11413.42 toks/s, output: 22.29 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:01<00:03, 23.96it/s, est. speed input: 11468.21 toks/s, output: 22.40 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:01<00:03, 24.11it/s, est. speed input: 11535.79 toks/s, output: 22.53 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:02<00:03, 24.08it/s, est. speed input: 11582.52 toks/s, output: 22.62 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:02<00:03, 23.67it/s, est. speed input: 11586.71 toks/s, output: 22.63 toks/s]
Processed prompts:  41%|████      | 52/128 [00:02<00:03, 23.30it/s, est. speed input: 11582.91 toks/s, output: 22.62 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:02<00:03, 23.53it/s, est. speed input: 11621.15 toks/s, output: 22.70 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:02<00:02, 23.80it/s, est. speed input: 11664.78 toks/s, output: 22.78 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:02<00:02, 23.88it/s, est. speed input: 11695.29 toks/s, output: 22.84 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:02<00:02, 23.58it/s, est. speed input: 11696.76 toks/s, output: 22.85 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:02<00:02, 23.82it/s, est. speed input: 11730.55 toks/s, output: 22.91 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:03<00:02, 23.94it/s, est. speed input: 11757.38 toks/s, output: 22.96 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:03<00:02, 23.79it/s, est. speed input: 11767.51 toks/s, output: 22.98 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:03<00:02, 23.22it/s, est. speed input: 11746.64 toks/s, output: 22.94 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:03<00:02, 23.30it/s, est. speed input: 11756.97 toks/s, output: 22.96 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:03<00:01, 23.09it/s, est. speed input: 11750.25 toks/s, output: 22.95 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:03<00:01, 22.81it/s, est. speed input: 11736.30 toks/s, output: 22.92 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:03<00:01, 22.79it/s, est. speed input: 11733.13 toks/s, output: 22.92 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:03<00:01, 23.33it/s, est. speed input: 11760.81 toks/s, output: 22.97 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:04<00:01, 23.67it/s, est. speed input: 11784.51 toks/s, output: 23.02 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:04<00:01, 23.55it/s, est. speed input: 11788.36 toks/s, output: 23.02 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:04<00:01, 23.73it/s, est. speed input: 11805.32 toks/s, output: 23.06 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:04<00:01, 23.52it/s, est. speed input: 11805.09 toks/s, output: 23.06 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:04<00:00, 23.27it/s, est. speed input: 11800.03 toks/s, output: 23.05 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:04<00:00, 23.56it/s, est. speed input: 11816.43 toks/s, output: 23.08 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:04<00:00, 23.79it/s, est. speed input: 11832.85 toks/s, output: 23.11 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:04<00:00, 23.84it/s, est. speed input: 11843.79 toks/s, output: 23.13 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:05<00:00, 24.01it/s, est. speed input: 11859.78 toks/s, output: 23.16 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:05<00:00, 23.76it/s, est. speed input: 11860.18 toks/s, output: 23.16 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:05<00:00, 23.89it/s, est. speed input: 11872.23 toks/s, output: 23.19 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:05<00:00, 23.99it/s, est. speed input: 11884.22 toks/s, output: 23.21 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:05<00:00, 23.99it/s, est. speed input: 11889.13 toks/s, output: 23.22 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:05<00:00, 23.22it/s, est. speed input: 11889.13 toks/s, output: 23.22 toks/s]
[rank0]:[W125 20:12:20.317901297 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=1024 ==========
Time: 2026-01-25 20:12:22
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 1025 --max-num-batched-tokens 1025 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-7B-INT8_M1024.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 20:12:31 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=402202) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=402202) WARNING 01-25 20:12:50 [backends.py:609] Failed to read file <frozen os>
Throughput: 20.71 requests/s, 21230.35 total tokens/s, 20.71 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128

STDERR:
[2026-01-25 20:12:31] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 20:12:31] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 20:12:31] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 20:12:31] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:12:31] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:12:31] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:12:31] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:12:31] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:12:31] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 20:12:31] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 20:12:31] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 20:12:31] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 20:12:31] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 20:12:31] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 20:12:38] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 20:12:38] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 20:12:38] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 20:12:38] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:12:38] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:12:38] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:12:38] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:12:38] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:12:38] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 20:12:38] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 20:12:38] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 20:12:38] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 20:12:38] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 20:12:38] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=402202) [2026-01-25 20:12:39] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=402202) [2026-01-25 20:12:39] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=402202) [2026-01-25 20:12:39] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=402202) [2026-01-25 20:12:39] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=402202) [2026-01-25 20:12:39] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=402202) [2026-01-25 20:12:39] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=402202) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=402202) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.30it/s]
(EngineCore_DP0 pid=402202) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.30it/s]
(EngineCore_DP0 pid=402202) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.30it/s]
(EngineCore_DP0 pid=402202) 
(EngineCore_DP0 pid=402202) [2026-01-25 20:12:41] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=402202) [2026-01-25 20:12:41] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 18579456 bytes
(EngineCore_DP0 pid=402202) [2026-01-25 20:12:41] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=402202) [2026-01-25 20:12:41] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 14450688 bytes
(EngineCore_DP0 pid=402202) [2026-01-25 20:12:41] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=402202) [2026-01-25 20:12:41] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 152764416 bytes
(EngineCore_DP0 pid=402202) [2026-01-25 20:12:41] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=402202) [2026-01-25 20:12:41] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 76382208 bytes
(EngineCore_DP0 pid=402202) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00, 10.65it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00, 10.64it/s]
(EngineCore_DP0 pid=402202) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  9.63it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  9.62it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  19%|█▉        | 24/128 [00:00<00:00, 237.75it/s]
Adding requests:  38%|███▊      | 49/128 [00:00<00:00, 243.03it/s]
Adding requests:  59%|█████▉    | 76/128 [00:00<00:00, 250.24it/s]
Adding requests:  80%|████████  | 103/128 [00:00<00:00, 255.43it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 255.43it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:00<00:01, 63.84it/s, est. speed input: 65388.21 toks/s, output: 63.84 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:00<00:03, 30.80it/s, est. speed input: 34385.71 toks/s, output: 33.58 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:00<00:04, 27.22it/s, est. speed input: 30815.83 toks/s, output: 30.09 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:00<00:04, 25.28it/s, est. speed input: 28901.42 toks/s, output: 28.22 toks/s]
Processed prompts:  20%|██        | 26/128 [00:00<00:04, 24.25it/s, est. speed input: 27911.26 toks/s, output: 27.26 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:01<00:04, 23.51it/s, est. speed input: 27185.09 toks/s, output: 26.55 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:01<00:04, 22.98it/s, est. speed input: 26622.16 toks/s, output: 26.00 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:01<00:04, 22.51it/s, est. speed input: 26139.54 toks/s, output: 25.53 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:01<00:04, 22.25it/s, est. speed input: 25770.71 toks/s, output: 25.17 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:01<00:03, 22.06it/s, est. speed input: 25464.35 toks/s, output: 24.87 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:01<00:03, 21.85it/s, est. speed input: 25183.84 toks/s, output: 24.59 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:01<00:03, 21.77it/s, est. speed input: 24961.54 toks/s, output: 24.38 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:02<00:03, 21.74it/s, est. speed input: 24774.24 toks/s, output: 24.19 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:02<00:03, 21.73it/s, est. speed input: 24614.82 toks/s, output: 24.04 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:02<00:03, 21.75it/s, est. speed input: 24479.35 toks/s, output: 23.91 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:02<00:03, 21.74it/s, est. speed input: 24355.26 toks/s, output: 23.78 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:02<00:03, 21.74it/s, est. speed input: 24244.44 toks/s, output: 23.68 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:02<00:02, 21.70it/s, est. speed input: 24138.22 toks/s, output: 23.57 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:02<00:02, 21.68it/s, est. speed input: 24043.79 toks/s, output: 23.48 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:03<00:02, 21.68it/s, est. speed input: 23958.71 toks/s, output: 23.40 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:03<00:02, 21.63it/s, est. speed input: 23874.59 toks/s, output: 23.31 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:03<00:02, 21.53it/s, est. speed input: 23787.31 toks/s, output: 23.23 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:03<00:02, 21.56it/s, est. speed input: 23721.50 toks/s, output: 23.17 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:03<00:02, 21.48it/s, est. speed input: 23646.15 toks/s, output: 23.09 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:03<00:01, 21.43it/s, est. speed input: 23577.88 toks/s, output: 23.03 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:03<00:01, 21.43it/s, est. speed input: 23519.25 toks/s, output: 22.97 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:04<00:01, 21.50it/s, est. speed input: 23472.48 toks/s, output: 22.92 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:04<00:01, 21.57it/s, est. speed input: 23431.99 toks/s, output: 22.88 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:04<00:01, 21.62it/s, est. speed input: 23394.20 toks/s, output: 22.85 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:04<00:01, 21.54it/s, est. speed input: 23346.21 toks/s, output: 22.80 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:04<00:01, 21.48it/s, est. speed input: 23300.19 toks/s, output: 22.75 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:04<00:00, 21.56it/s, est. speed input: 23270.17 toks/s, output: 22.72 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:04<00:00, 21.60it/s, est. speed input: 23240.05 toks/s, output: 22.70 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:04<00:00, 21.63it/s, est. speed input: 23211.33 toks/s, output: 22.67 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:05<00:00, 21.63it/s, est. speed input: 23182.89 toks/s, output: 22.64 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:05<00:00, 21.62it/s, est. speed input: 23154.67 toks/s, output: 22.61 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:05<00:00, 21.65it/s, est. speed input: 23131.51 toks/s, output: 22.59 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:05<00:00, 21.63it/s, est. speed input: 23105.94 toks/s, output: 22.56 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:05<00:00, 21.69it/s, est. speed input: 23087.02 toks/s, output: 22.55 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:05<00:00, 21.69it/s, est. speed input: 23087.02 toks/s, output: 22.55 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:05<00:00, 22.54it/s, est. speed input: 23087.02 toks/s, output: 22.55 toks/s]
[rank0]:[W125 20:13:14.546207423 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=2048 ==========
Time: 2026-01-25 20:13:16
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=256, max_num_seqs=2
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 256 --max-num-seqs 2 --max-model-len 1025 --max-num-batched-tokens 2048 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-7B-INT8_M2048.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 20:13:25 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=403198) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=403198) WARNING 01-25 20:13:44 [backends.py:609] Failed to read file <frozen os>
Throughput: 24.43 requests/s, 25038.76 total tokens/s, 24.43 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256

STDERR:
[2026-01-25 20:13:25] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 20:13:25] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 20:13:25] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 20:13:25] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:13:25] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:13:25] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:13:25] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:13:25] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:13:25] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 20:13:25] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 20:13:25] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 20:13:25] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 20:13:25] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 20:13:25] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 20:13:33] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 20:13:33] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 20:13:33] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 20:13:33] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:13:33] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:13:33] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:13:33] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:13:33] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:13:33] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 20:13:33] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 20:13:33] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 20:13:33] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 20:13:33] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 20:13:33] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=403198) [2026-01-25 20:13:34] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=403198) [2026-01-25 20:13:34] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=403198) [2026-01-25 20:13:34] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=403198) [2026-01-25 20:13:34] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=403198) [2026-01-25 20:13:34] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=403198) [2026-01-25 20:13:34] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=403198) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=403198) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.32it/s]
(EngineCore_DP0 pid=403198) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.33it/s]
(EngineCore_DP0 pid=403198) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.33it/s]
(EngineCore_DP0 pid=403198) 
(EngineCore_DP0 pid=403198) [2026-01-25 20:13:36] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=403198) [2026-01-25 20:13:36] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 18579456 bytes
(EngineCore_DP0 pid=403198) [2026-01-25 20:13:36] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=403198) [2026-01-25 20:13:36] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 14450688 bytes
(EngineCore_DP0 pid=403198) [2026-01-25 20:13:36] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=403198) [2026-01-25 20:13:36] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 152764416 bytes
(EngineCore_DP0 pid=403198) [2026-01-25 20:13:36] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=403198) [2026-01-25 20:13:36] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 76382208 bytes
(EngineCore_DP0 pid=403198) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  33%|███▎      | 1/3 [00:00<00:00,  9.83it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00, 10.14it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00, 10.10it/s]
(EngineCore_DP0 pid=403198) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00, 11.08it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00, 11.07it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  11%|█         | 28/256 [00:00<00:00, 274.10it/s]
Adding requests:  22%|██▏       | 57/256 [00:00<00:00, 277.01it/s]
Adding requests:  34%|███▍      | 87/256 [00:00<00:00, 286.43it/s]
Adding requests:  45%|████▌     | 116/256 [00:00<00:00, 285.75it/s]
Adding requests:  57%|█████▋    | 145/256 [00:00<00:00, 280.24it/s]
Adding requests:  68%|██████▊   | 175/256 [00:00<00:00, 284.68it/s]
Adding requests:  80%|████████  | 206/256 [00:00<00:00, 292.22it/s]
Adding requests:  93%|█████████▎| 237/256 [00:00<00:00, 295.71it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 288.77it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   9%|▉         | 24/256 [00:00<00:01, 150.04it/s, est. speed input: 153653.95 toks/s, output: 150.04 toks/s]
Processed prompts:  16%|█▌        | 40/256 [00:00<00:05, 42.81it/s, est. speed input: 50312.52 toks/s, output: 49.13 toks/s]   
Processed prompts:  19%|█▉        | 48/256 [00:01<00:05, 35.89it/s, est. speed input: 43100.43 toks/s, output: 42.09 toks/s]
Processed prompts:  21%|██        | 54/256 [00:01<00:06, 32.61it/s, est. speed input: 39921.41 toks/s, output: 38.99 toks/s]
Processed prompts:  23%|██▎       | 59/256 [00:01<00:06, 32.22it/s, est. speed input: 39037.72 toks/s, output: 38.12 toks/s]
Processed prompts:  25%|██▍       | 63/256 [00:01<00:06, 30.39it/s, est. speed input: 37704.83 toks/s, output: 36.82 toks/s]
Processed prompts:  26%|██▌       | 67/256 [00:01<00:06, 28.89it/s, est. speed input: 36595.46 toks/s, output: 35.74 toks/s]
Processed prompts:  28%|██▊       | 71/256 [00:02<00:06, 27.71it/s, est. speed input: 35667.12 toks/s, output: 34.83 toks/s]
Processed prompts:  29%|██▉       | 74/256 [00:02<00:07, 25.13it/s, est. speed input: 34410.95 toks/s, output: 33.60 toks/s]
Processed prompts:  30%|███       | 78/256 [00:02<00:07, 24.91it/s, est. speed input: 33751.43 toks/s, output: 32.96 toks/s]
Processed prompts:  32%|███▏      | 82/256 [00:02<00:07, 24.75it/s, est. speed input: 33180.63 toks/s, output: 32.40 toks/s]
Processed prompts:  34%|███▎      | 86/256 [00:02<00:06, 24.68it/s, est. speed input: 32689.56 toks/s, output: 31.92 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:02<00:06, 24.68it/s, est. speed input: 32270.13 toks/s, output: 31.51 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:03<00:06, 24.64it/s, est. speed input: 31884.38 toks/s, output: 31.14 toks/s]
Processed prompts:  38%|███▊      | 98/256 [00:03<00:06, 24.64it/s, est. speed input: 31544.57 toks/s, output: 30.81 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:03<00:06, 24.57it/s, est. speed input: 31223.35 toks/s, output: 30.49 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:03<00:06, 24.51it/s, est. speed input: 30929.76 toks/s, output: 30.20 toks/s]
Processed prompts:  43%|████▎     | 110/256 [00:03<00:05, 24.50it/s, est. speed input: 30668.21 toks/s, output: 29.95 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:03<00:05, 24.48it/s, est. speed input: 30428.65 toks/s, output: 29.72 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:04<00:05, 24.44it/s, est. speed input: 30201.84 toks/s, output: 29.49 toks/s]
Processed prompts:  48%|████▊     | 122/256 [00:04<00:05, 24.43it/s, est. speed input: 29996.72 toks/s, output: 29.29 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:04<00:05, 24.39it/s, est. speed input: 29803.19 toks/s, output: 29.10 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:04<00:05, 24.40it/s, est. speed input: 29628.06 toks/s, output: 28.93 toks/s]
Processed prompts:  52%|█████▏    | 134/256 [00:04<00:04, 24.42it/s, est. speed input: 29467.00 toks/s, output: 28.78 toks/s]
Processed prompts:  54%|█████▍    | 138/256 [00:04<00:04, 24.45it/s, est. speed input: 29319.41 toks/s, output: 28.63 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:04<00:04, 24.47it/s, est. speed input: 29181.03 toks/s, output: 28.50 toks/s]
Processed prompts:  57%|█████▋    | 146/256 [00:05<00:04, 24.47it/s, est. speed input: 29050.55 toks/s, output: 28.37 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:05<00:04, 24.44it/s, est. speed input: 28924.08 toks/s, output: 28.25 toks/s]
Processed prompts:  60%|██████    | 154/256 [00:05<00:04, 24.42it/s, est. speed input: 28805.50 toks/s, output: 28.13 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:05<00:04, 24.38it/s, est. speed input: 28690.25 toks/s, output: 28.02 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:05<00:03, 24.40it/s, est. speed input: 28586.89 toks/s, output: 27.92 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:05<00:03, 24.36it/s, est. speed input: 28483.91 toks/s, output: 27.82 toks/s]
Processed prompts:  66%|██████▋   | 170/256 [00:06<00:03, 24.41it/s, est. speed input: 28394.10 toks/s, output: 27.73 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:06<00:03, 24.53it/s, est. speed input: 28317.32 toks/s, output: 27.65 toks/s]
Processed prompts:  70%|██████▉   | 178/256 [00:06<00:03, 24.51it/s, est. speed input: 28234.99 toks/s, output: 27.57 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:06<00:03, 24.51it/s, est. speed input: 28157.42 toks/s, output: 27.50 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:06<00:02, 24.42it/s, est. speed input: 28075.89 toks/s, output: 27.42 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:06<00:02, 24.38it/s, est. speed input: 27999.88 toks/s, output: 27.34 toks/s]
Processed prompts:  76%|███████▌  | 194/256 [00:07<00:02, 24.35it/s, est. speed input: 27927.49 toks/s, output: 27.27 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:07<00:02, 24.40it/s, est. speed input: 27863.59 toks/s, output: 27.21 toks/s]
Processed prompts:  79%|███████▉  | 202/256 [00:07<00:02, 25.80it/s, est. speed input: 27911.32 toks/s, output: 27.26 toks/s]
Processed prompts:  80%|████████  | 206/256 [00:07<00:01, 25.41it/s, est. speed input: 27851.61 toks/s, output: 27.20 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:07<00:01, 25.06it/s, est. speed input: 27788.29 toks/s, output: 27.14 toks/s]
Processed prompts:  84%|████████▎ | 214/256 [00:07<00:01, 24.83it/s, est. speed input: 27727.72 toks/s, output: 27.08 toks/s]
Processed prompts:  85%|████████▌ | 218/256 [00:08<00:01, 24.69it/s, est. speed input: 27671.60 toks/s, output: 27.02 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:08<00:01, 24.60it/s, est. speed input: 27618.05 toks/s, output: 26.97 toks/s]
Processed prompts:  88%|████████▊ | 226/256 [00:08<00:01, 24.56it/s, est. speed input: 27568.26 toks/s, output: 26.92 toks/s]
Processed prompts:  90%|████████▉ | 230/256 [00:08<00:01, 24.54it/s, est. speed input: 27520.22 toks/s, output: 26.88 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:08<00:00, 24.45it/s, est. speed input: 27469.26 toks/s, output: 26.83 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:08<00:00, 24.38it/s, est. speed input: 27420.06 toks/s, output: 26.78 toks/s]
Processed prompts:  95%|█████████▍| 242/256 [00:09<00:00, 24.34it/s, est. speed input: 27372.84 toks/s, output: 26.73 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:09<00:00, 24.33it/s, est. speed input: 27328.64 toks/s, output: 26.69 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:09<00:00, 24.36it/s, est. speed input: 27288.22 toks/s, output: 26.65 toks/s]
Processed prompts:  99%|█████████▉| 254/256 [00:09<00:00, 24.42it/s, est. speed input: 27251.62 toks/s, output: 26.61 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:09<00:00, 24.42it/s, est. speed input: 27329.81 toks/s, output: 26.69 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:09<00:00, 26.69it/s, est. speed input: 27329.81 toks/s, output: 26.69 toks/s]
[rank0]:[W125 20:14:12.229756415 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=4096 ==========
Time: 2026-01-25 20:14:14
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=512, max_num_seqs=4
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 512 --max-num-seqs 4 --max-model-len 1025 --max-num-batched-tokens 4096 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-7B-INT8_M4096.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 20:14:26 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=404280) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=404280) WARNING 01-25 20:14:44 [backends.py:609] Failed to read file <frozen os>
Throughput: 26.02 requests/s, 26666.60 total tokens/s, 26.02 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512

STDERR:
[2026-01-25 20:14:25] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 20:14:26] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 20:14:26] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 20:14:26] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:14:26] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:14:26] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:14:26] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:14:26] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:14:26] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 20:14:26] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 20:14:26] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 20:14:26] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 20:14:26] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 20:14:26] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 20:14:33] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 20:14:33] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 20:14:33] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 20:14:33] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:14:33] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:14:33] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:14:33] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:14:33] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:14:33] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 20:14:33] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 20:14:33] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 20:14:33] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 20:14:33] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 20:14:33] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=404280) [2026-01-25 20:14:34] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=404280) [2026-01-25 20:14:34] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=404280) [2026-01-25 20:14:34] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=404280) [2026-01-25 20:14:34] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=404280) [2026-01-25 20:14:34] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=404280) [2026-01-25 20:14:34] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=404280) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=404280) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.32it/s]
(EngineCore_DP0 pid=404280) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.35it/s]
(EngineCore_DP0 pid=404280) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.34it/s]
(EngineCore_DP0 pid=404280) 
(EngineCore_DP0 pid=404280) [2026-01-25 20:14:36] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=404280) [2026-01-25 20:14:36] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 18579456 bytes
(EngineCore_DP0 pid=404280) [2026-01-25 20:14:36] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=404280) [2026-01-25 20:14:36] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 14450688 bytes
(EngineCore_DP0 pid=404280) [2026-01-25 20:14:36] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=404280) [2026-01-25 20:14:36] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 152764416 bytes
(EngineCore_DP0 pid=404280) [2026-01-25 20:14:36] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=404280) [2026-01-25 20:14:36] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 76382208 bytes
(EngineCore_DP0 pid=404280) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  25%|██▌       | 1/4 [00:00<00:00,  9.65it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  75%|███████▌  | 3/4 [00:00<00:00, 11.23it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00, 10.78it/s]
(EngineCore_DP0 pid=404280) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  33%|███▎      | 1/3 [00:00<00:00,  9.31it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00, 11.01it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00, 10.81it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   5%|▍         | 25/512 [00:00<00:01, 248.08it/s]
Adding requests:  10%|█         | 53/512 [00:00<00:01, 264.92it/s]
Adding requests:  16%|█▌        | 83/512 [00:00<00:01, 279.18it/s]
Adding requests:  22%|██▏       | 111/512 [00:00<00:01, 278.98it/s]
Adding requests:  27%|██▋       | 139/512 [00:00<00:01, 271.37it/s]
Adding requests:  33%|███▎      | 167/512 [00:00<00:01, 270.53it/s]
Adding requests:  39%|███▊      | 198/512 [00:00<00:01, 279.53it/s]
Adding requests:  45%|████▍     | 229/512 [00:00<00:00, 286.25it/s]
Adding requests:  50%|█████     | 258/512 [00:00<00:00, 286.76it/s]
Adding requests:  56%|█████▋    | 289/512 [00:01<00:00, 292.61it/s]
Adding requests:  62%|██████▏   | 319/512 [00:01<00:00, 293.38it/s]
Adding requests:  68%|██████▊   | 349/512 [00:01<00:00, 292.22it/s]
Adding requests:  74%|███████▍  | 379/512 [00:01<00:00, 292.03it/s]
Adding requests:  80%|████████  | 410/512 [00:01<00:00, 295.35it/s]
Adding requests:  86%|████████▌ | 441/512 [00:01<00:00, 297.92it/s]
Adding requests:  92%|█████████▏| 472/512 [00:01<00:00, 298.19it/s]
Adding requests:  98%|█████████▊| 504/512 [00:01<00:00, 301.77it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 289.49it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   9%|▉         | 46/512 [00:00<00:01, 298.95it/s, est. speed input: 306159.65 toks/s, output: 298.96 toks/s]
Processed prompts:  15%|█▍        | 76/512 [00:01<00:08, 52.51it/s, est. speed input: 63231.15 toks/s, output: 61.75 toks/s]   
Processed prompts:  18%|█▊        | 90/512 [00:01<00:10, 39.83it/s, est. speed input: 49915.21 toks/s, output: 48.74 toks/s]
Processed prompts:  19%|█▉        | 99/512 [00:02<00:11, 37.34it/s, est. speed input: 47051.88 toks/s, output: 45.95 toks/s]
Processed prompts:  21%|██        | 106/512 [00:02<00:12, 33.70it/s, est. speed input: 44087.71 toks/s, output: 43.05 toks/s]
Processed prompts:  22%|██▏       | 111/512 [00:02<00:11, 33.53it/s, est. speed input: 43457.34 toks/s, output: 42.44 toks/s]
Processed prompts:  23%|██▎       | 116/512 [00:02<00:11, 33.35it/s, est. speed input: 42894.42 toks/s, output: 41.89 toks/s]
Processed prompts:  23%|██▎       | 120/512 [00:02<00:12, 31.86it/s, est. speed input: 42037.23 toks/s, output: 41.05 toks/s]
Processed prompts:  24%|██▍       | 124/512 [00:03<00:12, 30.56it/s, est. speed input: 41270.87 toks/s, output: 40.30 toks/s]
Processed prompts:  25%|██▌       | 128/512 [00:03<00:13, 29.46it/s, est. speed input: 40576.33 toks/s, output: 39.63 toks/s]
Processed prompts:  26%|██▌       | 132/512 [00:03<00:13, 28.56it/s, est. speed input: 39939.79 toks/s, output: 39.00 toks/s]
Processed prompts:  26%|██▋       | 135/512 [00:03<00:14, 26.15it/s, est. speed input: 39076.72 toks/s, output: 38.16 toks/s]
Processed prompts:  27%|██▋       | 138/512 [00:03<00:15, 24.28it/s, est. speed input: 38277.07 toks/s, output: 37.38 toks/s]
Processed prompts:  28%|██▊       | 142/512 [00:03<00:14, 24.74it/s, est. speed input: 37803.04 toks/s, output: 36.92 toks/s]
Processed prompts:  29%|██▊       | 146/512 [00:03<00:14, 25.15it/s, est. speed input: 37382.72 toks/s, output: 36.51 toks/s]
Processed prompts:  29%|██▉       | 150/512 [00:04<00:14, 25.39it/s, est. speed input: 36983.13 toks/s, output: 36.12 toks/s]
Processed prompts:  30%|███       | 154/512 [00:04<00:14, 25.52it/s, est. speed input: 36604.52 toks/s, output: 35.75 toks/s]
Processed prompts:  31%|███       | 158/512 [00:04<00:13, 25.65it/s, est. speed input: 36257.47 toks/s, output: 35.41 toks/s]
Processed prompts:  32%|███▏      | 162/512 [00:04<00:13, 25.74it/s, est. speed input: 35934.99 toks/s, output: 35.09 toks/s]
Processed prompts:  32%|███▏      | 166/512 [00:04<00:13, 25.83it/s, est. speed input: 35635.70 toks/s, output: 34.80 toks/s]
Processed prompts:  33%|███▎      | 170/512 [00:04<00:13, 25.85it/s, est. speed input: 35350.80 toks/s, output: 34.52 toks/s]
Processed prompts:  34%|███▍      | 174/512 [00:05<00:13, 25.88it/s, est. speed input: 35084.12 toks/s, output: 34.26 toks/s]
Processed prompts:  35%|███▍      | 178/512 [00:05<00:12, 25.94it/s, est. speed input: 34837.91 toks/s, output: 34.02 toks/s]
Processed prompts:  36%|███▌      | 182/512 [00:05<00:12, 25.95it/s, est. speed input: 34602.84 toks/s, output: 33.79 toks/s]
Processed prompts:  36%|███▋      | 186/512 [00:05<00:12, 25.93it/s, est. speed input: 34377.44 toks/s, output: 33.57 toks/s]
Processed prompts:  37%|███▋      | 190/512 [00:05<00:12, 25.98it/s, est. speed input: 34171.06 toks/s, output: 33.37 toks/s]
Processed prompts:  38%|███▊      | 194/512 [00:05<00:12, 25.98it/s, est. speed input: 33971.85 toks/s, output: 33.18 toks/s]
Processed prompts:  39%|███▊      | 198/512 [00:06<00:12, 25.97it/s, est. speed input: 33781.42 toks/s, output: 32.99 toks/s]
Processed prompts:  39%|███▉      | 202/512 [00:06<00:11, 27.52it/s, est. speed input: 33760.41 toks/s, output: 32.97 toks/s]
Processed prompts:  40%|████      | 206/512 [00:06<00:11, 27.07it/s, est. speed input: 33587.87 toks/s, output: 32.80 toks/s]
Processed prompts:  41%|████      | 210/512 [00:06<00:11, 26.72it/s, est. speed input: 33419.30 toks/s, output: 32.64 toks/s]
Processed prompts:  42%|████▏     | 214/512 [00:06<00:11, 26.46it/s, est. speed input: 33257.25 toks/s, output: 32.48 toks/s]
Processed prompts:  43%|████▎     | 218/512 [00:06<00:11, 26.37it/s, est. speed input: 33110.02 toks/s, output: 32.33 toks/s]
Processed prompts:  43%|████▎     | 222/512 [00:06<00:11, 26.20it/s, est. speed input: 32960.05 toks/s, output: 32.19 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:07<00:10, 26.15it/s, est. speed input: 32823.17 toks/s, output: 32.05 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:07<00:10, 26.11it/s, est. speed input: 32690.73 toks/s, output: 31.92 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:07<00:10, 26.09it/s, est. speed input: 32565.00 toks/s, output: 31.80 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:07<00:10, 26.05it/s, est. speed input: 32442.39 toks/s, output: 31.68 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:07<00:10, 26.02it/s, est. speed input: 32324.31 toks/s, output: 31.57 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:07<00:10, 25.99it/s, est. speed input: 32210.41 toks/s, output: 31.46 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:07<00:10, 26.00it/s, est. speed input: 32102.74 toks/s, output: 31.35 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:08<00:09, 26.00it/s, est. speed input: 31999.03 toks/s, output: 31.25 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:08<00:09, 25.98it/s, est. speed input: 31897.99 toks/s, output: 31.15 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:08<00:09, 25.99it/s, est. speed input: 31801.71 toks/s, output: 31.06 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:08<00:09, 25.97it/s, est. speed input: 31707.54 toks/s, output: 30.96 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:08<00:09, 25.96it/s, est. speed input: 31617.10 toks/s, output: 30.88 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:08<00:09, 25.94it/s, est. speed input: 31528.17 toks/s, output: 30.79 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:09<00:09, 25.92it/s, est. speed input: 31442.00 toks/s, output: 30.71 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:09<00:08, 25.91it/s, est. speed input: 31359.61 toks/s, output: 30.62 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:09<00:08, 25.96it/s, est. speed input: 31283.17 toks/s, output: 30.55 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:09<00:08, 25.97it/s, est. speed input: 31207.42 toks/s, output: 30.48 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:09<00:08, 25.98it/s, est. speed input: 31134.69 toks/s, output: 30.40 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:09<00:08, 25.95it/s, est. speed input: 31062.03 toks/s, output: 30.33 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:09<00:08, 25.88it/s, est. speed input: 30988.04 toks/s, output: 30.26 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:10<00:07, 27.64it/s, est. speed input: 31020.37 toks/s, output: 30.29 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:10<00:07, 27.15it/s, est. speed input: 30955.45 toks/s, output: 30.23 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:10<00:07, 26.72it/s, est. speed input: 30887.63 toks/s, output: 30.16 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:10<00:07, 26.49it/s, est. speed input: 30824.80 toks/s, output: 30.10 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:10<00:07, 26.30it/s, est. speed input: 30762.22 toks/s, output: 30.04 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:10<00:07, 26.21it/s, est. speed input: 30703.93 toks/s, output: 29.98 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:11<00:06, 26.13it/s, est. speed input: 30646.07 toks/s, output: 29.93 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:11<00:06, 26.10it/s, est. speed input: 30590.92 toks/s, output: 29.87 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:11<00:06, 26.03it/s, est. speed input: 30535.16 toks/s, output: 29.82 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:11<00:06, 25.97it/s, est. speed input: 30479.85 toks/s, output: 29.77 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:11<00:06, 25.99it/s, est. speed input: 30429.53 toks/s, output: 29.72 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:11<00:06, 25.97it/s, est. speed input: 30378.62 toks/s, output: 29.67 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:11<00:06, 25.91it/s, est. speed input: 30326.78 toks/s, output: 29.62 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:12<00:05, 25.93it/s, est. speed input: 30279.47 toks/s, output: 29.57 toks/s]
Processed prompts:  71%|███████   | 362/512 [00:12<00:05, 25.94it/s, est. speed input: 30233.05 toks/s, output: 29.52 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:12<00:05, 25.93it/s, est. speed input: 30186.98 toks/s, output: 29.48 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [00:12<00:05, 25.96it/s, est. speed input: 30144.03 toks/s, output: 29.44 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [00:12<00:05, 25.94it/s, est. speed input: 30099.95 toks/s, output: 29.39 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [00:12<00:05, 25.93it/s, est. speed input: 30056.99 toks/s, output: 29.35 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [00:13<00:05, 25.91it/s, est. speed input: 30014.54 toks/s, output: 29.31 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [00:13<00:04, 25.92it/s, est. speed input: 29974.26 toks/s, output: 29.27 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [00:13<00:04, 25.89it/s, est. speed input: 29933.42 toks/s, output: 29.23 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [00:13<00:04, 25.92it/s, est. speed input: 29895.61 toks/s, output: 29.19 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [00:13<00:04, 25.92it/s, est. speed input: 29857.63 toks/s, output: 29.16 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [00:13<00:04, 25.89it/s, est. speed input: 29819.26 toks/s, output: 29.12 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [00:13<00:04, 25.87it/s, est. speed input: 29781.75 toks/s, output: 29.08 toks/s]
Processed prompts:  80%|████████  | 410/512 [00:14<00:03, 25.89it/s, est. speed input: 29746.70 toks/s, output: 29.05 toks/s]
Processed prompts:  81%|████████  | 414/512 [00:14<00:03, 25.91it/s, est. speed input: 29712.22 toks/s, output: 29.02 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [00:14<00:03, 25.90it/s, est. speed input: 29678.06 toks/s, output: 28.98 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [00:14<00:03, 25.93it/s, est. speed input: 29645.56 toks/s, output: 28.95 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [00:14<00:03, 25.89it/s, est. speed input: 29611.76 toks/s, output: 28.92 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [00:14<00:03, 25.86it/s, est. speed input: 29578.35 toks/s, output: 28.89 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [00:15<00:02, 27.56it/s, est. speed input: 29609.01 toks/s, output: 28.92 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [00:15<00:02, 27.03it/s, est. speed input: 29577.22 toks/s, output: 28.88 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [00:15<00:02, 26.71it/s, est. speed input: 29547.59 toks/s, output: 28.86 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [00:15<00:02, 26.46it/s, est. speed input: 29517.15 toks/s, output: 28.83 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [00:15<00:02, 26.31it/s, est. speed input: 29488.18 toks/s, output: 28.80 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [00:15<00:02, 26.16it/s, est. speed input: 29458.38 toks/s, output: 28.77 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [00:15<00:02, 26.06it/s, est. speed input: 29429.08 toks/s, output: 28.74 toks/s]
Processed prompts:  90%|█████████ | 462/512 [00:16<00:01, 25.99it/s, est. speed input: 29400.24 toks/s, output: 28.71 toks/s]
Processed prompts:  91%|█████████ | 466/512 [00:16<00:01, 25.98it/s, est. speed input: 29373.50 toks/s, output: 28.69 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [00:16<00:01, 25.93it/s, est. speed input: 29345.75 toks/s, output: 28.66 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [00:16<00:01, 25.95it/s, est. speed input: 29320.49 toks/s, output: 28.63 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [00:16<00:01, 25.93it/s, est. speed input: 29294.57 toks/s, output: 28.61 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [00:16<00:01, 25.91it/s, est. speed input: 29268.55 toks/s, output: 28.58 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [00:17<00:01, 25.91it/s, est. speed input: 29243.85 toks/s, output: 28.56 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [00:17<00:00, 25.89it/s, est. speed input: 29218.91 toks/s, output: 28.53 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [00:17<00:00, 25.90it/s, est. speed input: 29195.04 toks/s, output: 28.51 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [00:17<00:00, 25.88it/s, est. speed input: 29170.84 toks/s, output: 28.49 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [00:17<00:00, 25.88it/s, est. speed input: 29147.30 toks/s, output: 28.46 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [00:17<00:00, 25.89it/s, est. speed input: 29124.53 toks/s, output: 28.44 toks/s]
Processed prompts: 100%|█████████▉| 510/512 [00:17<00:00, 27.79it/s, est. speed input: 29159.34 toks/s, output: 28.48 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:17<00:00, 27.79it/s, est. speed input: 29273.39 toks/s, output: 28.59 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:17<00:00, 28.59it/s, est. speed input: 29273.39 toks/s, output: 28.59 toks/s]
[rank0]:[W125 20:15:22.291674769 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=8192 ==========
Time: 2026-01-25 20:15:24
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=1024, max_num_seqs=8
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 1024 --max-num-seqs 8 --max-model-len 1025 --max-num-batched-tokens 8192 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-7B-INT8_M8192.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 20:15:39 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=405536) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=405536) WARNING 01-25 20:15:58 [backends.py:609] Failed to read file <frozen os>
Throughput: 26.77 requests/s, 27434.81 total tokens/s, 26.77 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024

STDERR:
[2026-01-25 20:15:39] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 20:15:39] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 20:15:39] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 20:15:39] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:15:39] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:15:39] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:15:39] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:15:39] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:15:39] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 20:15:39] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 20:15:39] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 20:15:39] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 20:15:39] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 20:15:39] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 20:15:47] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 20:15:47] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 20:15:47] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 20:15:47] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:15:47] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:15:47] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:15:47] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:15:47] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:15:47] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 20:15:47] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 20:15:47] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 20:15:47] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 20:15:47] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 20:15:47] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=405536) [2026-01-25 20:15:48] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=405536) [2026-01-25 20:15:48] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=405536) [2026-01-25 20:15:48] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=405536) [2026-01-25 20:15:48] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=405536) [2026-01-25 20:15:48] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=405536) [2026-01-25 20:15:48] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=405536) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=405536) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.33it/s]
(EngineCore_DP0 pid=405536) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.33it/s]
(EngineCore_DP0 pid=405536) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.32it/s]
(EngineCore_DP0 pid=405536) 
(EngineCore_DP0 pid=405536) [2026-01-25 20:15:50] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=405536) [2026-01-25 20:15:50] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 18579456 bytes
(EngineCore_DP0 pid=405536) [2026-01-25 20:15:50] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=405536) [2026-01-25 20:15:50] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 14450688 bytes
(EngineCore_DP0 pid=405536) [2026-01-25 20:15:50] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=405536) [2026-01-25 20:15:50] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 152764416 bytes
(EngineCore_DP0 pid=405536) [2026-01-25 20:15:50] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=405536) [2026-01-25 20:15:50] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 76382208 bytes
(EngineCore_DP0 pid=405536) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  40%|████      | 2/5 [00:00<00:00, 10.87it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  80%|████████  | 4/5 [00:00<00:00, 11.63it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00, 10.94it/s]
(EngineCore_DP0 pid=405536) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:00,  9.78it/s]
Capturing CUDA graphs (decode, FULL):  75%|███████▌  | 3/4 [00:00<00:00, 11.26it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00, 11.37it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 25/1024 [00:00<00:04, 246.65it/s]
Adding requests:   5%|▌         | 52/1024 [00:00<00:03, 258.33it/s]
Adding requests:   8%|▊         | 82/1024 [00:00<00:03, 276.51it/s]
Adding requests:  11%|█         | 111/1024 [00:00<00:03, 279.63it/s]
Adding requests:  14%|█▎        | 140/1024 [00:00<00:03, 279.79it/s]
Adding requests:  17%|█▋        | 170/1024 [00:00<00:03, 282.81it/s]
Adding requests:  20%|█▉        | 202/1024 [00:00<00:02, 293.94it/s]
Adding requests:  23%|██▎       | 232/1024 [00:00<00:02, 294.01it/s]
Adding requests:  26%|██▌       | 262/1024 [00:00<00:02, 284.37it/s]
Adding requests:  28%|██▊       | 291/1024 [00:01<00:02, 284.67it/s]
Adding requests:  31%|███▏      | 322/1024 [00:01<00:02, 289.97it/s]
Adding requests:  34%|███▍      | 352/1024 [00:01<00:02, 286.99it/s]
Adding requests:  37%|███▋      | 381/1024 [00:01<00:02, 287.79it/s]
Adding requests:  40%|████      | 410/1024 [00:01<00:02, 285.98it/s]
Adding requests:  43%|████▎     | 439/1024 [00:01<00:02, 285.07it/s]
Adding requests:  46%|████▌     | 469/1024 [00:01<00:01, 287.56it/s]
Adding requests:  49%|████▉     | 501/1024 [00:01<00:01, 296.38it/s]
Adding requests:  52%|█████▏    | 532/1024 [00:01<00:01, 298.56it/s]
Adding requests:  55%|█████▍    | 562/1024 [00:01<00:01, 293.23it/s]
Adding requests:  58%|█████▊    | 592/1024 [00:02<00:01, 288.04it/s]
Adding requests:  61%|██████    | 623/1024 [00:02<00:01, 290.91it/s]
Adding requests:  64%|██████▍   | 653/1024 [00:02<00:01, 289.54it/s]
Adding requests:  67%|██████▋   | 682/1024 [00:02<00:01, 287.53it/s]
Adding requests:  70%|██████▉   | 713/1024 [00:02<00:01, 292.85it/s]
Adding requests:  73%|███████▎  | 743/1024 [00:02<00:00, 286.31it/s]
Adding requests:  75%|███████▌  | 772/1024 [00:02<00:00, 285.09it/s]
Adding requests:  78%|███████▊  | 803/1024 [00:02<00:00, 290.25it/s]
Adding requests:  82%|████████▏ | 836/1024 [00:02<00:00, 299.48it/s]
Adding requests:  85%|████████▍ | 867/1024 [00:02<00:00, 300.03it/s]
Adding requests:  88%|████████▊ | 900/1024 [00:03<00:00, 307.37it/s]
Adding requests:  91%|█████████ | 931/1024 [00:03<00:00, 295.79it/s]
Adding requests:  94%|█████████▍| 961/1024 [00:03<00:00, 294.45it/s]
Adding requests:  97%|█████████▋| 991/1024 [00:03<00:00, 294.69it/s]
Adding requests: 100%|█████████▉| 1022/1024 [00:03<00:00, 296.90it/s]
Adding requests: 100%|██████████| 1024/1024 [00:03<00:00, 290.03it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   9%|▉         | 90/1024 [00:00<00:01, 806.94it/s, est. speed input: 826460.31 toks/s, output: 806.98 toks/s]
Processed prompts:  17%|█▋        | 171/1024 [00:03<00:18, 47.11it/s, est. speed input: 56664.96 toks/s, output: 55.34 toks/s]  
Processed prompts:  20%|██        | 206/1024 [00:04<00:19, 41.12it/s, est. speed input: 49596.58 toks/s, output: 48.43 toks/s]
Processed prompts:  22%|██▏       | 227/1024 [00:05<00:22, 36.20it/s, est. speed input: 45158.94 toks/s, output: 44.10 toks/s]
Processed prompts:  24%|██▎       | 241/1024 [00:05<00:20, 37.46it/s, est. speed input: 45315.70 toks/s, output: 44.25 toks/s]
Processed prompts:  25%|██▍       | 252/1024 [00:06<00:23, 32.66it/s, est. speed input: 42694.04 toks/s, output: 41.69 toks/s]
Processed prompts:  25%|██▌       | 260/1024 [00:06<00:24, 31.79it/s, est. speed input: 41984.22 toks/s, output: 41.00 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:06<00:25, 29.71it/s, est. speed input: 41025.21 toks/s, output: 40.06 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:06<00:25, 29.10it/s, est. speed input: 40436.69 toks/s, output: 39.49 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:07<00:25, 28.59it/s, est. speed input: 39902.06 toks/s, output: 38.97 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:07<00:26, 28.16it/s, est. speed input: 39408.94 toks/s, output: 38.49 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:07<00:26, 27.80it/s, est. speed input: 38951.88 toks/s, output: 38.04 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:08<00:25, 28.32it/s, est. speed input: 38676.67 toks/s, output: 37.77 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:08<00:25, 27.96it/s, est. speed input: 38289.66 toks/s, output: 37.39 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:08<00:25, 27.62it/s, est. speed input: 37916.60 toks/s, output: 37.03 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:08<00:25, 27.33it/s, est. speed input: 37561.03 toks/s, output: 36.68 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:09<00:25, 27.18it/s, est. speed input: 37236.73 toks/s, output: 36.36 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:09<00:25, 27.07it/s, est. speed input: 36932.13 toks/s, output: 36.07 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:09<00:24, 26.95it/s, est. speed input: 36640.35 toks/s, output: 35.78 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:10<00:24, 26.90it/s, est. speed input: 36370.93 toks/s, output: 35.52 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:10<00:24, 26.88it/s, est. speed input: 36117.81 toks/s, output: 35.27 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:10<00:24, 26.84it/s, est. speed input: 35875.67 toks/s, output: 35.03 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:11<00:23, 26.79it/s, est. speed input: 35644.64 toks/s, output: 34.81 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [00:11<00:23, 26.81it/s, est. speed input: 35431.62 toks/s, output: 34.60 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:11<00:23, 26.83it/s, est. speed input: 35229.34 toks/s, output: 34.40 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:11<00:22, 26.75it/s, est. speed input: 35028.17 toks/s, output: 34.21 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:12<00:22, 26.74it/s, est. speed input: 34841.16 toks/s, output: 34.02 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:12<00:22, 26.74it/s, est. speed input: 34663.83 toks/s, output: 33.85 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:12<00:21, 27.65it/s, est. speed input: 34582.93 toks/s, output: 33.77 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:13<00:21, 27.39it/s, est. speed input: 34420.67 toks/s, output: 33.61 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:13<00:21, 27.17it/s, est. speed input: 34262.03 toks/s, output: 33.46 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:13<00:20, 27.07it/s, est. speed input: 34115.61 toks/s, output: 33.32 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:14<00:20, 26.94it/s, est. speed input: 33968.84 toks/s, output: 33.17 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:14<00:20, 26.85it/s, est. speed input: 33828.79 toks/s, output: 33.04 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:14<00:20, 26.83it/s, est. speed input: 33698.64 toks/s, output: 32.91 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:14<00:19, 26.79it/s, est. speed input: 33571.18 toks/s, output: 32.78 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:15<00:19, 26.75it/s, est. speed input: 33447.82 toks/s, output: 32.66 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:15<00:19, 26.75it/s, est. speed input: 33331.18 toks/s, output: 32.55 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:15<00:19, 26.72it/s, est. speed input: 33216.87 toks/s, output: 32.44 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:16<00:18, 26.73it/s, est. speed input: 33109.12 toks/s, output: 32.33 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:16<00:18, 26.73it/s, est. speed input: 33004.32 toks/s, output: 32.23 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:16<00:18, 26.72it/s, est. speed input: 32903.15 toks/s, output: 32.13 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:17<00:17, 26.72it/s, est. speed input: 32806.06 toks/s, output: 32.04 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:17<00:17, 26.69it/s, est. speed input: 32709.44 toks/s, output: 31.94 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:17<00:17, 26.69it/s, est. speed input: 32618.39 toks/s, output: 31.85 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:17<00:16, 26.71it/s, est. speed input: 32531.40 toks/s, output: 31.77 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:18<00:16, 26.66it/s, est. speed input: 32443.21 toks/s, output: 31.68 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:18<00:16, 26.65it/s, est. speed input: 32359.46 toks/s, output: 31.60 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:18<00:16, 26.65it/s, est. speed input: 32278.48 toks/s, output: 31.52 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:19<00:15, 26.65it/s, est. speed input: 32200.10 toks/s, output: 31.45 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:19<00:15, 26.64it/s, est. speed input: 32123.58 toks/s, output: 31.37 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:19<00:15, 26.65it/s, est. speed input: 32050.90 toks/s, output: 31.30 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:20<00:14, 26.68it/s, est. speed input: 31980.93 toks/s, output: 31.23 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:20<00:14, 26.65it/s, est. speed input: 31910.48 toks/s, output: 31.16 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:20<00:14, 26.63it/s, est. speed input: 31842.06 toks/s, output: 31.10 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:20<00:14, 26.61it/s, est. speed input: 31775.73 toks/s, output: 31.03 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:21<00:13, 26.65it/s, est. speed input: 31713.62 toks/s, output: 30.97 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:21<00:13, 26.63it/s, est. speed input: 31651.22 toks/s, output: 30.91 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:21<00:13, 26.62it/s, est. speed input: 31590.03 toks/s, output: 30.85 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:22<00:12, 26.63it/s, est. speed input: 31532.03 toks/s, output: 30.79 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:22<00:12, 26.66it/s, est. speed input: 31476.47 toks/s, output: 30.74 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:22<00:12, 26.60it/s, est. speed input: 31418.26 toks/s, output: 30.68 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:23<00:11, 26.60it/s, est. speed input: 31363.90 toks/s, output: 30.63 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:23<00:11, 26.61it/s, est. speed input: 31311.18 toks/s, output: 30.58 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:23<00:11, 26.57it/s, est. speed input: 31257.75 toks/s, output: 30.53 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:23<00:11, 26.56it/s, est. speed input: 31206.29 toks/s, output: 30.47 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:24<00:10, 26.57it/s, est. speed input: 31156.84 toks/s, output: 30.43 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:24<00:10, 26.58it/s, est. speed input: 31108.71 toks/s, output: 30.38 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:24<00:10, 26.59it/s, est. speed input: 31062.25 toks/s, output: 30.33 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:25<00:09, 26.61it/s, est. speed input: 31017.35 toks/s, output: 30.29 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:25<00:09, 26.58it/s, est. speed input: 30971.42 toks/s, output: 30.25 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:25<00:09, 26.60it/s, est. speed input: 30928.46 toks/s, output: 30.20 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:26<00:08, 27.47it/s, est. speed input: 30923.61 toks/s, output: 30.20 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:26<00:08, 27.20it/s, est. speed input: 30881.51 toks/s, output: 30.16 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:26<00:08, 27.02it/s, est. speed input: 30840.57 toks/s, output: 30.12 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:26<00:07, 26.88it/s, est. speed input: 30799.52 toks/s, output: 30.08 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:27<00:07, 26.82it/s, est. speed input: 30761.51 toks/s, output: 30.04 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:27<00:07, 26.71it/s, est. speed input: 30721.28 toks/s, output: 30.00 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:27<00:07, 26.70it/s, est. speed input: 30684.61 toks/s, output: 29.97 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [00:28<00:06, 26.64it/s, est. speed input: 30646.27 toks/s, output: 29.93 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [00:28<00:06, 26.62it/s, est. speed input: 30610.19 toks/s, output: 29.89 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:28<00:06, 26.61it/s, est. speed input: 30574.71 toks/s, output: 29.86 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [00:29<00:05, 26.64it/s, est. speed input: 30541.41 toks/s, output: 29.83 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [00:29<00:05, 26.64it/s, est. speed input: 30508.00 toks/s, output: 29.79 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [00:29<00:05, 26.62it/s, est. speed input: 30474.38 toks/s, output: 29.76 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [00:29<00:05, 26.59it/s, est. speed input: 30441.03 toks/s, output: 29.73 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [00:30<00:04, 26.60it/s, est. speed input: 30409.53 toks/s, output: 29.70 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [00:30<00:04, 26.55it/s, est. speed input: 30376.23 toks/s, output: 29.66 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [00:30<00:04, 26.53it/s, est. speed input: 30344.51 toks/s, output: 29.63 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [00:31<00:03, 26.54it/s, est. speed input: 30314.18 toks/s, output: 29.60 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [00:31<00:03, 26.51it/s, est. speed input: 30282.92 toks/s, output: 29.57 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [00:31<00:03, 26.53it/s, est. speed input: 30253.78 toks/s, output: 29.54 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [00:32<00:02, 26.56it/s, est. speed input: 30225.80 toks/s, output: 29.52 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [00:32<00:02, 26.55it/s, est. speed input: 30197.21 toks/s, output: 29.49 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [00:32<00:02, 26.50it/s, est. speed input: 30167.83 toks/s, output: 29.46 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [00:32<00:02, 26.50it/s, est. speed input: 30139.93 toks/s, output: 29.43 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [00:33<00:01, 26.54it/s, est. speed input: 30113.98 toks/s, output: 29.41 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [00:33<00:01, 26.52it/s, est. speed input: 30086.99 toks/s, output: 29.38 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [00:33<00:01, 26.54it/s, est. speed input: 30061.54 toks/s, output: 29.36 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [00:34<00:00, 26.55it/s, est. speed input: 30036.50 toks/s, output: 29.33 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [00:34<00:00, 26.59it/s, est. speed input: 30012.74 toks/s, output: 29.31 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [00:34<00:00, 27.56it/s, est. speed input: 30019.10 toks/s, output: 29.32 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:34<00:00, 27.56it/s, est. speed input: 30195.80 toks/s, output: 29.49 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:34<00:00, 29.49it/s, est. speed input: 30195.80 toks/s, output: 29.49 toks/s]
[rank0]:[W125 20:16:56.717213191 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=16384 ==========
Time: 2026-01-25 20:16:58
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=2048, max_num_seqs=16
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 2048 --max-num-seqs 16 --max-model-len 1025 --max-num-batched-tokens 16384 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-7B-INT8_M16384.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 20:17:20 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=407154) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=407154) WARNING 01-25 20:17:39 [backends.py:609] Failed to read file <frozen os>
Throughput: 27.20 requests/s, 27876.81 total tokens/s, 27.20 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048

STDERR:
[2026-01-25 20:17:20] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 20:17:20] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 20:17:20] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 20:17:20] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:17:20] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:17:20] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:17:20] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:17:20] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:17:20] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 20:17:20] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 20:17:20] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 20:17:20] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 20:17:20] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 20:17:20] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 20:17:28] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 20:17:28] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 20:17:28] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 20:17:28] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:17:28] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:17:28] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:17:28] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:17:28] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:17:28] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 20:17:28] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 20:17:28] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 20:17:28] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 20:17:28] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 20:17:28] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=407154) [2026-01-25 20:17:29] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=407154) [2026-01-25 20:17:29] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=407154) [2026-01-25 20:17:29] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=407154) [2026-01-25 20:17:29] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=407154) [2026-01-25 20:17:29] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=407154) [2026-01-25 20:17:29] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=407154) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=407154) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.30it/s]
(EngineCore_DP0 pid=407154) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.32it/s]
(EngineCore_DP0 pid=407154) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.32it/s]
(EngineCore_DP0 pid=407154) 
(EngineCore_DP0 pid=407154) [2026-01-25 20:17:31] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=407154) [2026-01-25 20:17:31] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 18579456 bytes
(EngineCore_DP0 pid=407154) [2026-01-25 20:17:31] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=407154) [2026-01-25 20:17:31] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 14450688 bytes
(EngineCore_DP0 pid=407154) [2026-01-25 20:17:31] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=407154) [2026-01-25 20:17:31] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 152764416 bytes
(EngineCore_DP0 pid=407154) [2026-01-25 20:17:31] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=407154) [2026-01-25 20:17:31] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 76382208 bytes
(EngineCore_DP0 pid=407154) [rank0]:W0125 20:17:48.383000 407154 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=407154) [rank0]:W0125 20:17:48.503000 407154 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=407154) [rank0]:W0125 20:17:50.074000 407154 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=407154) [rank0]:W0125 20:17:50.260000 407154 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=407154) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  29%|██▊       | 2/7 [00:00<00:00, 10.58it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  57%|█████▋    | 4/7 [00:00<00:00, 11.30it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  86%|████████▌ | 6/7 [00:00<00:00, 11.62it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00, 11.20it/s]
(EngineCore_DP0 pid=407154) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  40%|████      | 2/5 [00:00<00:00, 10.75it/s]
Capturing CUDA graphs (decode, FULL):  80%|████████  | 4/5 [00:00<00:00, 11.19it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00, 11.08it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   1%|▏         | 27/2048 [00:00<00:07, 259.84it/s]
Adding requests:   3%|▎         | 57/2048 [00:00<00:07, 280.59it/s]
Adding requests:   4%|▍         | 86/2048 [00:00<00:07, 274.39it/s]
Adding requests:   6%|▌         | 114/2048 [00:00<00:07, 269.01it/s]
Adding requests:   7%|▋         | 142/2048 [00:00<00:07, 270.79it/s]
Adding requests:   8%|▊         | 170/2048 [00:00<00:06, 272.58it/s]
Adding requests:  10%|▉         | 202/2048 [00:00<00:06, 284.07it/s]
Adding requests:  11%|█▏        | 231/2048 [00:00<00:06, 284.95it/s]
Adding requests:  13%|█▎        | 260/2048 [00:00<00:06, 285.42it/s]
Adding requests:  14%|█▍        | 289/2048 [00:01<00:06, 285.25it/s]
Adding requests:  16%|█▌        | 320/2048 [00:01<00:05, 290.69it/s]
Adding requests:  17%|█▋        | 350/2048 [00:01<00:05, 292.89it/s]
Adding requests:  19%|█▊        | 380/2048 [00:01<00:05, 289.61it/s]
Adding requests:  20%|██        | 410/2048 [00:01<00:05, 291.72it/s]
Adding requests:  21%|██▏       | 440/2048 [00:01<00:05, 292.18it/s]
Adding requests:  23%|██▎       | 471/2048 [00:01<00:05, 296.55it/s]
Adding requests:  25%|██▍       | 504/2048 [00:01<00:05, 304.43it/s]
Adding requests:  26%|██▌       | 537/2048 [00:01<00:04, 311.53it/s]
Adding requests:  28%|██▊       | 569/2048 [00:01<00:04, 312.53it/s]
Adding requests:  29%|██▉       | 601/2048 [00:02<00:04, 303.34it/s]
Adding requests:  31%|███       | 632/2048 [00:02<00:04, 304.19it/s]
Adding requests:  32%|███▏      | 663/2048 [00:02<00:04, 300.47it/s]
Adding requests:  34%|███▍      | 695/2048 [00:02<00:04, 303.10it/s]
Adding requests:  35%|███▌      | 726/2048 [00:02<00:04, 294.20it/s]
Adding requests:  37%|███▋      | 756/2048 [00:02<00:04, 286.72it/s]
Adding requests:  38%|███▊      | 787/2048 [00:02<00:04, 292.87it/s]
Adding requests:  40%|███▉      | 817/2048 [00:02<00:04, 293.17it/s]
Adding requests:  42%|████▏     | 850/2048 [00:02<00:03, 301.69it/s]
Adding requests:  43%|████▎     | 882/2048 [00:03<00:03, 305.89it/s]
Adding requests:  45%|████▍     | 913/2048 [00:03<00:03, 292.95it/s]
Adding requests:  46%|████▌     | 943/2048 [00:03<00:03, 282.29it/s]
Adding requests:  48%|████▊     | 974/2048 [00:03<00:03, 288.27it/s]
Adding requests:  49%|████▉     | 1003/2048 [00:03<00:03, 278.34it/s]
Adding requests:  50%|█████     | 1031/2048 [00:03<00:03, 276.71it/s]
Adding requests:  52%|█████▏    | 1060/2048 [00:03<00:03, 280.28it/s]
Adding requests:  53%|█████▎    | 1089/2048 [00:03<00:03, 282.85it/s]
Adding requests:  55%|█████▍    | 1119/2048 [00:03<00:03, 287.30it/s]
Adding requests:  56%|█████▌    | 1150/2048 [00:03<00:03, 293.05it/s]
Adding requests:  58%|█████▊    | 1181/2048 [00:04<00:02, 296.74it/s]
Adding requests:  59%|█████▉    | 1212/2048 [00:04<00:02, 299.12it/s]
Adding requests:  61%|██████    | 1242/2048 [00:04<00:02, 294.91it/s]
Adding requests:  62%|██████▏   | 1272/2048 [00:04<00:02, 291.12it/s]
Adding requests:  64%|██████▎   | 1302/2048 [00:04<00:02, 288.57it/s]
Adding requests:  65%|██████▍   | 1331/2048 [00:04<00:02, 283.17it/s]
Adding requests:  67%|██████▋   | 1363/2048 [00:04<00:02, 293.38it/s]
Adding requests:  68%|██████▊   | 1393/2048 [00:04<00:02, 292.74it/s]
Adding requests:  69%|██████▉   | 1423/2048 [00:04<00:02, 294.06it/s]
Adding requests:  71%|███████   | 1455/2048 [00:04<00:01, 301.20it/s]
Adding requests:  73%|███████▎  | 1487/2048 [00:05<00:01, 305.76it/s]
Adding requests:  74%|███████▍  | 1519/2048 [00:05<00:01, 308.41it/s]
Adding requests:  76%|███████▌  | 1550/2048 [00:05<00:01, 302.63it/s]
Adding requests:  77%|███████▋  | 1581/2048 [00:05<00:01, 296.26it/s]
Adding requests:  79%|███████▊  | 1611/2048 [00:05<00:01, 290.49it/s]
Adding requests:  80%|████████  | 1641/2048 [00:05<00:01, 282.61it/s]
Adding requests:  82%|████████▏ | 1670/2048 [00:05<00:01, 283.44it/s]
Adding requests:  83%|████████▎ | 1700/2048 [00:05<00:01, 286.53it/s]
Adding requests:  84%|████████▍ | 1730/2048 [00:05<00:01, 289.28it/s]
Adding requests:  86%|████████▌ | 1762/2048 [00:06<00:00, 296.31it/s]
Adding requests:  88%|████████▊ | 1793/2048 [00:06<00:00, 299.77it/s]
Adding requests:  89%|████████▉ | 1824/2048 [00:06<00:00, 292.83it/s]
Adding requests:  91%|█████████ | 1854/2048 [00:06<00:00, 287.75it/s]
Adding requests:  92%|█████████▏| 1886/2048 [00:06<00:00, 295.96it/s]
Adding requests:  94%|█████████▎| 1916/2048 [00:06<00:00, 290.22it/s]
Adding requests:  95%|█████████▌| 1947/2048 [00:06<00:00, 295.37it/s]
Adding requests:  97%|█████████▋| 1978/2048 [00:06<00:00, 298.72it/s]
Adding requests:  98%|█████████▊| 2008/2048 [00:06<00:00, 294.08it/s]
Adding requests: 100%|█████████▉| 2038/2048 [00:06<00:00, 289.15it/s]
Adding requests: 100%|██████████| 2048/2048 [00:07<00:00, 291.75it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   9%|▉         | 194/2048 [00:00<00:05, 310.56it/s, est. speed input: 318032.91 toks/s, output: 310.57 toks/s]
Processed prompts:  11%|█         | 226/2048 [00:01<00:17, 104.43it/s, est. speed input: 128987.30 toks/s, output: 125.96 toks/s]
Processed prompts:  12%|█▏        | 242/2048 [00:02<00:23, 77.99it/s, est. speed input: 104096.01 toks/s, output: 101.66 toks/s] 
Processed prompts:  13%|█▎        | 258/2048 [00:02<00:29, 61.36it/s, est. speed input: 89071.55 toks/s, output: 86.98 toks/s]  
Processed prompts:  13%|█▎        | 274/2048 [00:03<00:35, 50.48it/s, est. speed input: 78986.55 toks/s, output: 77.13 toks/s]
Processed prompts:  14%|█▍        | 290/2048 [00:04<00:40, 43.23it/s, est. speed input: 71771.29 toks/s, output: 70.09 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [00:04<00:44, 38.91it/s, est. speed input: 66754.09 toks/s, output: 65.19 toks/s]
Processed prompts:  16%|█▌        | 322/2048 [00:05<00:48, 35.33it/s, est. speed input: 62457.79 toks/s, output: 60.99 toks/s]
Processed prompts:  17%|█▋        | 338/2048 [00:05<00:52, 32.87it/s, est. speed input: 59014.71 toks/s, output: 57.63 toks/s]
Processed prompts:  17%|█▋        | 354/2048 [00:06<00:54, 31.19it/s, est. speed input: 56199.81 toks/s, output: 54.88 toks/s]
Processed prompts:  18%|█▊        | 370/2048 [00:07<00:55, 30.01it/s, est. speed input: 53849.43 toks/s, output: 52.59 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [00:07<00:56, 29.19it/s, est. speed input: 51857.52 toks/s, output: 50.64 toks/s]
Processed prompts:  20%|█▉        | 402/2048 [00:08<00:57, 28.60it/s, est. speed input: 50142.09 toks/s, output: 48.97 toks/s]
Processed prompts:  20%|██        | 418/2048 [00:08<00:57, 28.19it/s, est. speed input: 48658.29 toks/s, output: 47.52 toks/s]
Processed prompts:  21%|██        | 434/2048 [00:09<00:56, 28.32it/s, est. speed input: 47502.48 toks/s, output: 46.39 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [00:09<00:57, 27.98it/s, est. speed input: 46342.12 toks/s, output: 45.26 toks/s]
Processed prompts:  23%|██▎       | 466/2048 [00:10<00:56, 27.78it/s, est. speed input: 45318.25 toks/s, output: 44.26 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [00:11<00:56, 27.63it/s, est. speed input: 44401.68 toks/s, output: 43.36 toks/s]
Processed prompts:  24%|██▍       | 498/2048 [00:11<00:56, 27.50it/s, est. speed input: 43570.85 toks/s, output: 42.55 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [00:12<00:55, 27.43it/s, est. speed input: 42823.49 toks/s, output: 41.82 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [00:12<00:55, 27.36it/s, est. speed input: 42138.70 toks/s, output: 41.15 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [00:13<00:54, 27.34it/s, est. speed input: 41521.82 toks/s, output: 40.55 toks/s]
Processed prompts:  27%|██▋       | 562/2048 [00:14<00:54, 27.31it/s, est. speed input: 40951.74 toks/s, output: 39.99 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [00:14<00:53, 27.29it/s, est. speed input: 40428.75 toks/s, output: 39.48 toks/s]
Processed prompts:  29%|██▉       | 594/2048 [00:15<00:53, 27.25it/s, est. speed input: 39940.43 toks/s, output: 39.00 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [00:15<00:52, 27.23it/s, est. speed input: 39490.67 toks/s, output: 38.57 toks/s]
Processed prompts:  31%|███       | 626/2048 [00:16<00:52, 27.24it/s, est. speed input: 39076.69 toks/s, output: 38.16 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [00:16<00:51, 27.20it/s, est. speed input: 38683.43 toks/s, output: 37.78 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [00:17<00:51, 27.20it/s, est. speed input: 38321.08 toks/s, output: 37.42 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [00:18<00:50, 27.22it/s, est. speed input: 37985.18 toks/s, output: 37.09 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [00:18<00:49, 27.18it/s, est. speed input: 37662.69 toks/s, output: 36.78 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [00:19<00:49, 27.16it/s, est. speed input: 37360.69 toks/s, output: 36.48 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [00:19<00:48, 27.14it/s, est. speed input: 37076.40 toks/s, output: 36.21 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [00:20<00:48, 27.17it/s, est. speed input: 36813.18 toks/s, output: 35.95 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [00:21<00:47, 27.15it/s, est. speed input: 36559.55 toks/s, output: 35.70 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [00:21<00:47, 27.12it/s, est. speed input: 36318.98 toks/s, output: 35.47 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [00:22<00:45, 27.53it/s, est. speed input: 36139.95 toks/s, output: 35.29 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [00:22<00:45, 27.39it/s, est. speed input: 35922.21 toks/s, output: 35.08 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [00:23<00:45, 27.32it/s, est. speed input: 35718.37 toks/s, output: 34.88 toks/s]
Processed prompts:  41%|████      | 834/2048 [00:24<00:44, 27.26it/s, est. speed input: 35523.85 toks/s, output: 34.69 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [00:24<00:44, 27.20it/s, est. speed input: 35336.26 toks/s, output: 34.51 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [00:25<00:43, 27.16it/s, est. speed input: 35157.63 toks/s, output: 34.33 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [00:25<00:42, 27.17it/s, est. speed input: 34990.53 toks/s, output: 34.17 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [00:26<00:42, 27.15it/s, est. speed input: 34828.84 toks/s, output: 34.01 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [00:26<00:41, 27.09it/s, est. speed input: 34669.51 toks/s, output: 33.86 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [00:27<00:41, 27.10it/s, est. speed input: 34522.73 toks/s, output: 33.71 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [00:28<00:40, 27.08it/s, est. speed input: 34378.57 toks/s, output: 33.57 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [00:28<00:40, 27.08it/s, est. speed input: 34241.96 toks/s, output: 33.44 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [00:29<00:39, 27.05it/s, est. speed input: 34108.69 toks/s, output: 33.31 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [00:29<00:38, 27.08it/s, est. speed input: 33984.05 toks/s, output: 33.19 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [00:30<00:38, 27.00it/s, est. speed input: 33857.09 toks/s, output: 33.06 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [00:31<00:37, 27.03it/s, est. speed input: 33741.55 toks/s, output: 32.95 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [00:31<00:37, 27.03it/s, est. speed input: 33627.92 toks/s, output: 32.84 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [00:32<00:36, 27.00it/s, est. speed input: 33516.78 toks/s, output: 32.73 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [00:32<00:36, 27.01it/s, est. speed input: 33411.74 toks/s, output: 32.63 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [00:33<00:35, 27.00it/s, est. speed input: 33309.07 toks/s, output: 32.53 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [00:34<00:34, 26.99it/s, est. speed input: 33210.45 toks/s, output: 32.43 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [00:34<00:34, 26.99it/s, est. speed input: 33115.36 toks/s, output: 32.34 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [00:35<00:33, 26.97it/s, est. speed input: 33021.70 toks/s, output: 32.25 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [00:35<00:33, 26.98it/s, est. speed input: 32933.01 toks/s, output: 32.16 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [00:36<00:32, 26.95it/s, est. speed input: 32845.06 toks/s, output: 32.08 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [00:37<00:31, 26.97it/s, est. speed input: 32762.13 toks/s, output: 31.99 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [00:37<00:30, 27.44it/s, est. speed input: 32710.47 toks/s, output: 31.94 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [00:38<00:30, 27.29it/s, est. speed input: 32631.25 toks/s, output: 31.87 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [00:38<00:29, 27.60it/s, est. speed input: 32578.94 toks/s, output: 31.82 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [00:39<00:29, 27.43it/s, est. speed input: 32505.52 toks/s, output: 31.74 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [00:39<00:28, 27.25it/s, est. speed input: 32430.42 toks/s, output: 31.67 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [00:40<00:28, 27.18it/s, est. speed input: 32360.98 toks/s, output: 31.60 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [00:41<00:27, 27.07it/s, est. speed input: 32289.65 toks/s, output: 31.53 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [00:41<00:27, 27.04it/s, est. speed input: 32223.55 toks/s, output: 31.47 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [00:42<00:26, 27.40it/s, est. speed input: 32179.75 toks/s, output: 31.43 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [00:42<00:25, 27.26it/s, est. speed input: 32116.14 toks/s, output: 31.36 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [00:43<00:25, 27.13it/s, est. speed input: 32052.80 toks/s, output: 31.30 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [00:44<00:24, 27.10it/s, est. speed input: 31993.82 toks/s, output: 31.24 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [00:44<00:24, 27.00it/s, est. speed input: 31932.80 toks/s, output: 31.18 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [00:45<00:23, 26.99it/s, est. speed input: 31876.15 toks/s, output: 31.13 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [00:45<00:23, 26.98it/s, est. speed input: 31820.87 toks/s, output: 31.08 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [00:46<00:22, 26.95it/s, est. speed input: 31765.95 toks/s, output: 31.02 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [00:47<00:21, 27.38it/s, est. speed input: 31734.30 toks/s, output: 30.99 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [00:47<00:21, 27.24it/s, est. speed input: 31682.13 toks/s, output: 30.94 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [00:48<00:20, 27.14it/s, est. speed input: 31631.51 toks/s, output: 30.89 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [00:48<00:20, 27.06it/s, est. speed input: 31581.22 toks/s, output: 30.84 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [00:49<00:19, 27.49it/s, est. speed input: 31554.50 toks/s, output: 30.81 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [00:49<00:18, 27.30it/s, est. speed input: 31506.27 toks/s, output: 30.77 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [00:50<00:17, 27.62it/s, est. speed input: 31479.44 toks/s, output: 30.74 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [00:51<00:17, 27.39it/s, est. speed input: 31432.99 toks/s, output: 30.70 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [00:51<00:16, 27.23it/s, est. speed input: 31387.94 toks/s, output: 30.65 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [00:52<00:16, 27.09it/s, est. speed input: 31342.64 toks/s, output: 30.61 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [00:52<00:15, 27.44it/s, est. speed input: 31317.34 toks/s, output: 30.58 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [00:53<00:15, 27.24it/s, est. speed input: 31273.74 toks/s, output: 30.54 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [00:54<00:14, 27.09it/s, est. speed input: 31230.92 toks/s, output: 30.50 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [00:54<00:14, 27.02it/s, est. speed input: 31190.40 toks/s, output: 30.46 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [00:55<00:13, 26.94it/s, est. speed input: 31149.26 toks/s, output: 30.42 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [00:55<00:12, 26.94it/s, est. speed input: 31111.55 toks/s, output: 30.38 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [00:56<00:12, 26.88it/s, est. speed input: 31071.81 toks/s, output: 30.34 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [00:57<00:11, 27.29it/s, est. speed input: 31051.10 toks/s, output: 30.32 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [00:57<00:10, 27.60it/s, est. speed input: 31031.24 toks/s, output: 30.30 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [00:58<00:10, 27.30it/s, est. speed input: 30992.61 toks/s, output: 30.27 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [00:58<00:09, 27.19it/s, est. speed input: 30958.08 toks/s, output: 30.23 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [00:59<00:09, 27.03it/s, est. speed input: 30921.08 toks/s, output: 30.20 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [01:00<00:08, 26.98it/s, est. speed input: 30887.10 toks/s, output: 30.16 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [01:00<00:08, 26.92it/s, est. speed input: 30852.96 toks/s, output: 30.13 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [01:01<00:07, 26.86it/s, est. speed input: 30819.01 toks/s, output: 30.10 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [01:01<00:07, 26.84it/s, est. speed input: 30786.10 toks/s, output: 30.06 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [01:02<00:06, 26.82it/s, est. speed input: 30753.92 toks/s, output: 30.03 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [01:02<00:05, 27.24it/s, est. speed input: 30737.86 toks/s, output: 30.02 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [01:03<00:05, 27.06it/s, est. speed input: 30705.02 toks/s, output: 29.99 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [01:04<00:04, 27.01it/s, est. speed input: 30675.62 toks/s, output: 29.96 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [01:04<00:04, 26.92it/s, est. speed input: 30645.05 toks/s, output: 29.93 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [01:05<00:03, 26.85it/s, est. speed input: 30614.72 toks/s, output: 29.90 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [01:05<00:02, 26.82it/s, est. speed input: 30585.49 toks/s, output: 29.87 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [01:06<00:02, 27.20it/s, est. speed input: 30570.11 toks/s, output: 29.85 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [01:07<00:01, 27.05it/s, est. speed input: 30541.50 toks/s, output: 29.83 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [01:07<00:01, 26.93it/s, est. speed input: 30512.77 toks/s, output: 29.80 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [01:08<00:00, 27.44it/s, est. speed input: 30503.62 toks/s, output: 29.79 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [01:08<00:00, 27.44it/s, est. speed input: 30713.41 toks/s, output: 29.99 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [01:08<00:00, 29.99it/s, est. speed input: 30713.41 toks/s, output: 29.99 toks/s]
[rank0]:[W125 20:19:15.156829466 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=32768 ==========
Time: 2026-01-25 20:19:17
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=4096, max_num_seqs=32
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 4096 --max-num-seqs 32 --max-model-len 1025 --max-num-batched-tokens 32768 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-7B-INT8_M32768.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 20:19:54 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=409511) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=409511) WARNING 01-25 20:20:13 [backends.py:609] Failed to read file <frozen os>
Throughput: 27.07 requests/s, 27743.75 total tokens/s, 27.07 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096

STDERR:
[2026-01-25 20:19:54] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 20:19:54] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 20:19:54] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 20:19:54] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:19:54] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:19:54] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:19:54] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:19:54] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:19:54] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 20:19:54] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 20:19:54] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 20:19:54] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 20:19:54] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 20:19:54] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 20:20:02] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 20:20:02] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 20:20:02] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 20:20:02] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:20:02] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:20:02] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:20:02] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:20:02] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:20:02] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 20:20:02] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 20:20:02] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 20:20:02] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 20:20:02] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 20:20:02] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=409511) [2026-01-25 20:20:03] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=409511) [2026-01-25 20:20:03] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=409511) [2026-01-25 20:20:03] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=409511) [2026-01-25 20:20:03] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=409511) [2026-01-25 20:20:03] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=409511) [2026-01-25 20:20:03] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=409511) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=409511) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.31it/s]
(EngineCore_DP0 pid=409511) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.31it/s]
(EngineCore_DP0 pid=409511) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.31it/s]
(EngineCore_DP0 pid=409511) 
(EngineCore_DP0 pid=409511) [2026-01-25 20:20:05] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=409511) [2026-01-25 20:20:05] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 18579456 bytes
(EngineCore_DP0 pid=409511) [2026-01-25 20:20:05] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=409511) [2026-01-25 20:20:05] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 14450688 bytes
(EngineCore_DP0 pid=409511) [2026-01-25 20:20:05] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=409511) [2026-01-25 20:20:05] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 152764416 bytes
(EngineCore_DP0 pid=409511) [2026-01-25 20:20:05] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=409511) [2026-01-25 20:20:05] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 76382208 bytes
(EngineCore_DP0 pid=409511) [rank0]:W0125 20:20:21.969000 409511 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=409511) [rank0]:W0125 20:20:22.094000 409511 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=409511) [rank0]:W0125 20:20:23.475000 409511 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=409511) [rank0]:W0125 20:20:23.668000 409511 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=409511) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  18%|█▊        | 2/11 [00:00<00:00, 10.41it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  36%|███▋      | 4/11 [00:00<00:00, 10.63it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  55%|█████▍    | 6/11 [00:00<00:00, 10.98it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  73%|███████▎  | 8/11 [00:00<00:00, 11.11it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  91%|█████████ | 10/11 [00:00<00:00, 11.27it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00, 10.94it/s]
(EngineCore_DP0 pid=409511) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  14%|█▍        | 1/7 [00:00<00:00,  9.94it/s]
Capturing CUDA graphs (decode, FULL):  43%|████▎     | 3/7 [00:00<00:00, 11.15it/s]
Capturing CUDA graphs (decode, FULL):  71%|███████▏  | 5/7 [00:00<00:00, 11.45it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00, 11.55it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00, 11.41it/s]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   1%|          | 26/4096 [00:00<00:15, 259.43it/s]
Adding requests:   1%|▏         | 55/4096 [00:00<00:14, 277.17it/s]
Adding requests:   2%|▏         | 84/4096 [00:00<00:14, 281.00it/s]
Adding requests:   3%|▎         | 114/4096 [00:00<00:13, 285.43it/s]
Adding requests:   3%|▎         | 143/4096 [00:00<00:13, 286.95it/s]
Adding requests:   4%|▍         | 172/4096 [00:00<00:13, 287.32it/s]
Adding requests:   5%|▍         | 203/4096 [00:00<00:13, 293.29it/s]
Adding requests:   6%|▌         | 233/4096 [00:00<00:13, 287.45it/s]
Adding requests:   6%|▋         | 263/4096 [00:00<00:13, 289.28it/s]
Adding requests:   7%|▋         | 293/4096 [00:01<00:13, 289.50it/s]
Adding requests:   8%|▊         | 325/4096 [00:01<00:12, 295.31it/s]
Adding requests:   9%|▊         | 358/4096 [00:01<00:12, 302.85it/s]
Adding requests:  10%|▉         | 390/4096 [00:01<00:12, 306.78it/s]
Adding requests:  10%|█         | 421/4096 [00:01<00:12, 302.96it/s]
Adding requests:  11%|█         | 452/4096 [00:01<00:12, 300.42it/s]
Adding requests:  12%|█▏        | 485/4096 [00:01<00:11, 308.24it/s]
Adding requests:  13%|█▎        | 518/4096 [00:01<00:11, 313.89it/s]
Adding requests:  13%|█▎        | 550/4096 [00:01<00:11, 305.15it/s]
Adding requests:  14%|█▍        | 581/4096 [00:01<00:11, 305.87it/s]
Adding requests:  15%|█▍        | 612/4096 [00:02<00:11, 300.78it/s]
Adding requests:  16%|█▌        | 643/4096 [00:02<00:11, 302.31it/s]
Adding requests:  16%|█▋        | 674/4096 [00:02<00:11, 295.28it/s]
Adding requests:  17%|█▋        | 707/4096 [00:02<00:11, 303.42it/s]
Adding requests:  18%|█▊        | 738/4096 [00:02<00:11, 299.48it/s]
Adding requests:  19%|█▉        | 768/4096 [00:02<00:11, 296.62it/s]
Adding requests:  20%|█▉        | 800/4096 [00:02<00:10, 301.87it/s]
Adding requests:  20%|██        | 832/4096 [00:02<00:10, 306.79it/s]
Adding requests:  21%|██        | 863/4096 [00:02<00:10, 299.24it/s]
Adding requests:  22%|██▏       | 893/4096 [00:03<00:10, 296.80it/s]
Adding requests:  23%|██▎       | 923/4096 [00:03<00:11, 283.64it/s]
Adding requests:  23%|██▎       | 953/4096 [00:03<00:10, 286.25it/s]
Adding requests:  24%|██▍       | 983/4096 [00:03<00:10, 289.01it/s]
Adding requests:  25%|██▍       | 1012/4096 [00:03<00:10, 288.80it/s]
Adding requests:  25%|██▌       | 1041/4096 [00:03<00:10, 287.71it/s]
Adding requests:  26%|██▌       | 1071/4096 [00:03<00:10, 290.53it/s]
Adding requests:  27%|██▋       | 1101/4096 [00:03<00:10, 282.79it/s]
Adding requests:  28%|██▊       | 1132/4096 [00:03<00:10, 288.42it/s]
Adding requests:  28%|██▊       | 1161/4096 [00:03<00:10, 279.17it/s]
Adding requests:  29%|██▉       | 1192/4096 [00:04<00:10, 285.28it/s]
Adding requests:  30%|██▉       | 1225/4096 [00:04<00:09, 296.09it/s]
Adding requests:  31%|███       | 1256/4096 [00:04<00:09, 299.93it/s]
Adding requests:  31%|███▏      | 1287/4096 [00:04<00:09, 297.79it/s]
Adding requests:  32%|███▏      | 1318/4096 [00:04<00:09, 300.11it/s]
Adding requests:  33%|███▎      | 1350/4096 [00:04<00:08, 305.24it/s]
Adding requests:  34%|███▎      | 1381/4096 [00:04<00:08, 305.52it/s]
Adding requests:  34%|███▍      | 1412/4096 [00:04<00:09, 297.93it/s]
Adding requests:  35%|███▌      | 1443/4096 [00:04<00:08, 299.88it/s]
Adding requests:  36%|███▌      | 1474/4096 [00:04<00:09, 291.14it/s]
Adding requests:  37%|███▋      | 1505/4096 [00:05<00:08, 294.24it/s]
Adding requests:  37%|███▋      | 1535/4096 [00:05<00:08, 294.72it/s]
Adding requests:  38%|███▊      | 1565/4096 [00:05<00:08, 288.19it/s]
Adding requests:  39%|███▉      | 1594/4096 [00:05<00:08, 281.62it/s]
Adding requests:  40%|███▉      | 1623/4096 [00:05<00:08, 275.41it/s]
Adding requests:  40%|████      | 1651/4096 [00:05<00:08, 273.45it/s]
Adding requests:  41%|████      | 1679/4096 [00:05<00:08, 273.95it/s]
Adding requests:  42%|████▏     | 1711/4096 [00:05<00:08, 285.64it/s]
Adding requests:  43%|████▎     | 1741/4096 [00:05<00:08, 289.45it/s]
Adding requests:  43%|████▎     | 1772/4096 [00:06<00:07, 294.81it/s]
Adding requests:  44%|████▍     | 1802/4096 [00:06<00:07, 289.78it/s]
Adding requests:  45%|████▍     | 1832/4096 [00:06<00:07, 284.85it/s]
Adding requests:  45%|████▌     | 1861/4096 [00:06<00:07, 283.10it/s]
Adding requests:  46%|████▌     | 1891/4096 [00:06<00:07, 286.44it/s]
Adding requests:  47%|████▋     | 1923/4096 [00:06<00:07, 293.35it/s]
Adding requests:  48%|████▊     | 1956/4096 [00:06<00:07, 302.29it/s]
Adding requests:  49%|████▊     | 1987/4096 [00:06<00:06, 302.01it/s]
Adding requests:  49%|████▉     | 2018/4096 [00:06<00:07, 295.51it/s]
Adding requests:  50%|█████     | 2048/4096 [00:06<00:06, 296.51it/s]
Adding requests:  51%|█████     | 2078/4096 [00:07<00:07, 284.95it/s]
Adding requests:  51%|█████▏    | 2108/4096 [00:07<00:06, 287.14it/s]
Adding requests:  52%|█████▏    | 2137/4096 [00:07<00:06, 282.46it/s]
Adding requests:  53%|█████▎    | 2166/4096 [00:07<00:06, 282.47it/s]
Adding requests:  54%|█████▎    | 2196/4096 [00:07<00:06, 285.59it/s]
Adding requests:  54%|█████▍    | 2225/4096 [00:07<00:06, 282.22it/s]
Adding requests:  55%|█████▌    | 2254/4096 [00:07<00:06, 283.96it/s]
Adding requests:  56%|█████▌    | 2285/4096 [00:07<00:06, 289.79it/s]
Adding requests:  57%|█████▋    | 2315/4096 [00:07<00:06, 288.13it/s]
Adding requests:  57%|█████▋    | 2345/4096 [00:08<00:06, 289.06it/s]
Adding requests:  58%|█████▊    | 2376/4096 [00:08<00:05, 292.51it/s]
Adding requests:  59%|█████▉    | 2409/4096 [00:08<00:05, 302.55it/s]
Adding requests:  60%|█████▉    | 2440/4096 [00:08<00:05, 303.06it/s]
Adding requests:  60%|██████    | 2472/4096 [00:08<00:05, 307.92it/s]
Adding requests:  61%|██████    | 2504/4096 [00:08<00:05, 309.85it/s]
Adding requests:  62%|██████▏   | 2536/4096 [00:08<00:05, 311.83it/s]
Adding requests:  63%|██████▎   | 2570/4096 [00:08<00:04, 318.17it/s]
Adding requests:  64%|██████▎   | 2603/4096 [00:08<00:04, 319.63it/s]
Adding requests:  64%|██████▍   | 2635/4096 [00:08<00:04, 310.48it/s]
Adding requests:  65%|██████▌   | 2667/4096 [00:09<00:04, 297.54it/s]
Adding requests:  66%|██████▌   | 2697/4096 [00:09<00:04, 288.35it/s]
Adding requests:  67%|██████▋   | 2726/4096 [00:09<00:04, 284.08it/s]
Adding requests:  67%|██████▋   | 2755/4096 [00:09<00:04, 285.04it/s]
Adding requests:  68%|██████▊   | 2785/4096 [00:09<00:04, 288.53it/s]
Adding requests:  69%|██████▉   | 2818/4096 [00:09<00:04, 299.97it/s]
Adding requests:  70%|██████▉   | 2849/4096 [00:09<00:04, 299.56it/s]
Adding requests:  70%|███████   | 2880/4096 [00:09<00:04, 290.51it/s]
Adding requests:  71%|███████   | 2912/4096 [00:09<00:03, 296.39it/s]
Adding requests:  72%|███████▏  | 2944/4096 [00:10<00:03, 301.33it/s]
Adding requests:  73%|███████▎  | 2975/4096 [00:10<00:03, 294.79it/s]
Adding requests:  73%|███████▎  | 3007/4096 [00:10<00:03, 299.84it/s]
Adding requests:  74%|███████▍  | 3038/4096 [00:10<00:03, 302.52it/s]
Adding requests:  75%|███████▍  | 3071/4096 [00:10<00:03, 308.74it/s]
Adding requests:  76%|███████▌  | 3103/4096 [00:10<00:03, 311.21it/s]
Adding requests:  77%|███████▋  | 3137/4096 [00:10<00:03, 316.07it/s]
Adding requests:  77%|███████▋  | 3169/4096 [00:10<00:03, 305.52it/s]
Adding requests:  78%|███████▊  | 3200/4096 [00:10<00:02, 304.83it/s]
Adding requests:  79%|███████▉  | 3233/4096 [00:10<00:02, 310.63it/s]
Adding requests:  80%|███████▉  | 3265/4096 [00:11<00:02, 308.92it/s]
Adding requests:  80%|████████  | 3296/4096 [00:11<00:02, 298.13it/s]
Adding requests:  81%|████████  | 3326/4096 [00:11<00:02, 297.26it/s]
Adding requests:  82%|████████▏ | 3357/4096 [00:11<00:02, 299.59it/s]
Adding requests:  83%|████████▎ | 3388/4096 [00:11<00:02, 301.09it/s]
Adding requests:  83%|████████▎ | 3419/4096 [00:11<00:02, 298.69it/s]
Adding requests:  84%|████████▍ | 3451/4096 [00:11<00:02, 304.83it/s]
Adding requests:  85%|████████▌ | 3482/4096 [00:11<00:02, 303.60it/s]
Adding requests:  86%|████████▌ | 3513/4096 [00:11<00:01, 298.86it/s]
Adding requests:  87%|████████▋ | 3547/4096 [00:11<00:01, 308.94it/s]
Adding requests:  87%|████████▋ | 3579/4096 [00:12<00:01, 311.43it/s]
Adding requests:  88%|████████▊ | 3611/4096 [00:12<00:01, 307.50it/s]
Adding requests:  89%|████████▉ | 3642/4096 [00:12<00:01, 303.29it/s]
Adding requests:  90%|████████▉ | 3673/4096 [00:12<00:01, 284.33it/s]
Adding requests:  90%|█████████ | 3702/4096 [00:12<00:01, 281.12it/s]
Adding requests:  91%|█████████ | 3731/4096 [00:12<00:01, 280.59it/s]
Adding requests:  92%|█████████▏| 3760/4096 [00:12<00:01, 279.01it/s]
Adding requests:  92%|█████████▏| 3788/4096 [00:12<00:01, 277.01it/s]
Adding requests:  93%|█████████▎| 3817/4096 [00:12<00:01, 277.92it/s]
Adding requests:  94%|█████████▍| 3848/4096 [00:13<00:00, 287.08it/s]
Adding requests:  95%|█████████▍| 3881/4096 [00:13<00:00, 297.45it/s]
Adding requests:  95%|█████████▌| 3911/4096 [00:13<00:00, 284.85it/s]
Adding requests:  96%|█████████▌| 3942/4096 [00:13<00:00, 288.13it/s]
Adding requests:  97%|█████████▋| 3972/4096 [00:13<00:00, 290.81it/s]
Adding requests:  98%|█████████▊| 4002/4096 [00:13<00:00, 286.60it/s]
Adding requests:  98%|█████████▊| 4033/4096 [00:13<00:00, 291.31it/s]
Adding requests:  99%|█████████▉| 4063/4096 [00:13<00:00, 288.15it/s]
Adding requests: 100%|█████████▉| 4092/4096 [00:13<00:00, 280.03it/s]
Adding requests: 100%|██████████| 4096/4096 [00:13<00:00, 294.37it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   9%|▉         | 369/4096 [00:00<00:07, 508.34it/s, est. speed input: 520563.45 toks/s, output: 508.35 toks/s]
Processed prompts:  10%|█         | 420/4096 [00:01<00:19, 184.16it/s, est. speed input: 226680.45 toks/s, output: 221.37 toks/s]
Processed prompts:  11%|█         | 444/4096 [00:03<00:35, 103.69it/s, est. speed input: 149499.53 toks/s, output: 146.00 toks/s]
Processed prompts:  11%|█▏        | 465/4096 [00:04<00:53, 67.65it/s, est. speed input: 112922.73 toks/s, output: 110.28 toks/s] 
Processed prompts:  12%|█▏        | 497/4096 [00:05<01:08, 52.52it/s, est. speed input: 94415.33 toks/s, output: 92.20 toks/s]  
Processed prompts:  13%|█▎        | 529/4096 [00:06<01:21, 43.71it/s, est. speed input: 82522.31 toks/s, output: 80.59 toks/s]
Processed prompts:  14%|█▎        | 561/4096 [00:07<01:32, 38.23it/s, est. speed input: 74225.85 toks/s, output: 72.49 toks/s]
Processed prompts:  14%|█▍        | 593/4096 [00:08<01:41, 34.65it/s, est. speed input: 68087.43 toks/s, output: 66.49 toks/s]
Processed prompts:  15%|█▌        | 625/4096 [00:10<01:47, 32.29it/s, est. speed input: 63388.07 toks/s, output: 61.90 toks/s]
Processed prompts:  16%|█▌        | 657/4096 [00:11<01:51, 30.72it/s, est. speed input: 59687.28 toks/s, output: 58.29 toks/s]
Processed prompts:  17%|█▋        | 689/4096 [00:12<01:55, 29.63it/s, est. speed input: 56671.08 toks/s, output: 55.34 toks/s]
Processed prompts:  18%|█▊        | 721/4096 [00:13<01:56, 28.86it/s, est. speed input: 54169.64 toks/s, output: 52.90 toks/s]
Processed prompts:  18%|█▊        | 753/4096 [00:14<01:58, 28.32it/s, est. speed input: 52060.72 toks/s, output: 50.84 toks/s]
Processed prompts:  19%|█▉        | 785/4096 [00:15<01:57, 28.22it/s, est. speed input: 50381.68 toks/s, output: 49.20 toks/s]
Processed prompts:  20%|█▉        | 817/4096 [00:17<01:57, 27.87it/s, est. speed input: 48819.03 toks/s, output: 47.67 toks/s]
Processed prompts:  21%|██        | 849/4096 [00:18<01:57, 27.62it/s, est. speed input: 47455.34 toks/s, output: 46.34 toks/s]
Processed prompts:  22%|██▏       | 881/4096 [00:19<01:57, 27.45it/s, est. speed input: 46257.44 toks/s, output: 45.17 toks/s]
Processed prompts:  22%|██▏       | 913/4096 [00:20<01:56, 27.32it/s, est. speed input: 45194.58 toks/s, output: 44.14 toks/s]
Processed prompts:  23%|██▎       | 945/4096 [00:21<01:55, 27.24it/s, est. speed input: 44247.12 toks/s, output: 43.21 toks/s]
Processed prompts:  24%|██▍       | 977/4096 [00:23<01:54, 27.17it/s, est. speed input: 43394.82 toks/s, output: 42.38 toks/s]
Processed prompts:  25%|██▍       | 1009/4096 [00:24<01:53, 27.12it/s, est. speed input: 42624.97 toks/s, output: 41.63 toks/s]
Processed prompts:  25%|██▌       | 1041/4096 [00:25<01:52, 27.07it/s, est. speed input: 41923.69 toks/s, output: 40.94 toks/s]
Processed prompts:  26%|██▌       | 1073/4096 [00:26<01:51, 27.04it/s, est. speed input: 41285.36 toks/s, output: 40.32 toks/s]
Processed prompts:  27%|██▋       | 1105/4096 [00:27<01:50, 27.04it/s, est. speed input: 40706.48 toks/s, output: 39.75 toks/s]
Processed prompts:  28%|██▊       | 1137/4096 [00:28<01:49, 27.01it/s, est. speed input: 40168.94 toks/s, output: 39.23 toks/s]
Processed prompts:  29%|██▊       | 1169/4096 [00:30<01:48, 26.98it/s, est. speed input: 39671.53 toks/s, output: 38.74 toks/s]
Processed prompts:  29%|██▉       | 1201/4096 [00:31<01:46, 27.20it/s, est. speed input: 39255.89 toks/s, output: 38.34 toks/s]
Processed prompts:  30%|███       | 1233/4096 [00:32<01:44, 27.34it/s, est. speed input: 38866.86 toks/s, output: 37.96 toks/s]
Processed prompts:  31%|███       | 1265/4096 [00:33<01:44, 27.22it/s, est. speed input: 38469.35 toks/s, output: 37.57 toks/s]
Processed prompts:  32%|███▏      | 1297/4096 [00:34<01:43, 27.13it/s, est. speed input: 38098.12 toks/s, output: 37.21 toks/s]
Processed prompts:  32%|███▏      | 1329/4096 [00:36<01:41, 27.31it/s, est. speed input: 37787.64 toks/s, output: 36.90 toks/s]
Processed prompts:  33%|███▎      | 1361/4096 [00:37<01:40, 27.18it/s, est. speed input: 37459.02 toks/s, output: 36.58 toks/s]
Processed prompts:  34%|███▍      | 1393/4096 [00:38<01:39, 27.08it/s, est. speed input: 37150.16 toks/s, output: 36.28 toks/s]
Processed prompts:  35%|███▍      | 1425/4096 [00:39<01:38, 27.00it/s, est. speed input: 36857.23 toks/s, output: 35.99 toks/s]
Processed prompts:  36%|███▌      | 1457/4096 [00:40<01:37, 27.19it/s, est. speed input: 36614.88 toks/s, output: 35.76 toks/s]
Processed prompts:  36%|███▋      | 1489/4096 [00:41<01:36, 27.10it/s, est. speed input: 36357.38 toks/s, output: 35.51 toks/s]
Processed prompts:  37%|███▋      | 1521/4096 [00:43<01:34, 27.27it/s, est. speed input: 36142.34 toks/s, output: 35.30 toks/s]
Processed prompts:  38%|███▊      | 1553/4096 [00:44<01:32, 27.39it/s, est. speed input: 35937.69 toks/s, output: 35.10 toks/s]
Processed prompts:  39%|███▊      | 1585/4096 [00:45<01:32, 27.21it/s, est. speed input: 35715.36 toks/s, output: 34.88 toks/s]
Processed prompts:  39%|███▉      | 1617/4096 [00:46<01:30, 27.40it/s, est. speed input: 35537.59 toks/s, output: 34.70 toks/s]
Processed prompts:  40%|████      | 1649/4096 [00:47<01:29, 27.24it/s, est. speed input: 35337.70 toks/s, output: 34.51 toks/s]
Processed prompts:  41%|████      | 1681/4096 [00:48<01:29, 27.11it/s, est. speed input: 35145.92 toks/s, output: 34.32 toks/s]
Processed prompts:  42%|████▏     | 1713/4096 [00:50<01:27, 27.25it/s, est. speed input: 34986.38 toks/s, output: 34.17 toks/s]
Processed prompts:  43%|████▎     | 1745/4096 [00:51<01:25, 27.38it/s, est. speed input: 34836.45 toks/s, output: 34.02 toks/s]
Processed prompts:  43%|████▎     | 1777/4096 [00:52<01:25, 27.17it/s, est. speed input: 34665.39 toks/s, output: 33.85 toks/s]
Processed prompts:  44%|████▍     | 1809/4096 [00:53<01:24, 27.06it/s, est. speed input: 34505.15 toks/s, output: 33.70 toks/s]
Processed prompts:  45%|████▍     | 1841/4096 [00:54<01:23, 26.97it/s, est. speed input: 34350.54 toks/s, output: 33.55 toks/s]
Processed prompts:  46%|████▌     | 1873/4096 [00:56<01:21, 27.19it/s, est. speed input: 34227.47 toks/s, output: 33.43 toks/s]
Processed prompts:  47%|████▋     | 1905/4096 [00:57<01:20, 27.12it/s, est. speed input: 34090.36 toks/s, output: 33.29 toks/s]
Processed prompts:  47%|████▋     | 1937/4096 [00:58<01:19, 27.06it/s, est. speed input: 33957.22 toks/s, output: 33.16 toks/s]
Processed prompts:  48%|████▊     | 1969/4096 [00:59<01:18, 27.27it/s, est. speed input: 33850.34 toks/s, output: 33.06 toks/s]
Processed prompts:  49%|████▉     | 2001/4096 [01:00<01:17, 27.17it/s, est. speed input: 33727.97 toks/s, output: 32.94 toks/s]
Processed prompts:  50%|████▉     | 2033/4096 [01:01<01:16, 27.09it/s, est. speed input: 33609.09 toks/s, output: 32.82 toks/s]
Processed prompts:  50%|█████     | 2065/4096 [01:03<01:14, 27.30it/s, est. speed input: 33515.49 toks/s, output: 32.73 toks/s]
Processed prompts:  51%|█████     | 2097/4096 [01:04<01:13, 27.18it/s, est. speed input: 33405.33 toks/s, output: 32.62 toks/s]
Processed prompts:  52%|█████▏    | 2129/4096 [01:05<01:12, 27.09it/s, est. speed input: 33298.26 toks/s, output: 32.52 toks/s]
Processed prompts:  53%|█████▎    | 2161/4096 [01:06<01:11, 27.02it/s, est. speed input: 33194.69 toks/s, output: 32.42 toks/s]
Processed prompts:  54%|█████▎    | 2193/4096 [01:07<01:09, 27.19it/s, est. speed input: 33110.59 toks/s, output: 32.33 toks/s]
Processed prompts:  54%|█████▍    | 2225/4096 [01:09<01:09, 27.07it/s, est. speed input: 33012.52 toks/s, output: 32.24 toks/s]
Processed prompts:  55%|█████▌    | 2257/4096 [01:10<01:08, 27.00it/s, est. speed input: 32918.10 toks/s, output: 32.15 toks/s]
Processed prompts:  56%|█████▌    | 2289/4096 [01:11<01:07, 26.94it/s, est. speed input: 32826.91 toks/s, output: 32.06 toks/s]
Processed prompts:  57%|█████▋    | 2321/4096 [01:12<01:05, 26.91it/s, est. speed input: 32739.09 toks/s, output: 31.97 toks/s]
Processed prompts:  57%|█████▋    | 2353/4096 [01:13<01:04, 26.88it/s, est. speed input: 32653.88 toks/s, output: 31.89 toks/s]
Processed prompts:  58%|█████▊    | 2385/4096 [01:14<01:03, 26.87it/s, est. speed input: 32571.37 toks/s, output: 31.81 toks/s]
Processed prompts:  59%|█████▉    | 2417/4096 [01:16<01:02, 26.87it/s, est. speed input: 32492.41 toks/s, output: 31.73 toks/s]
Processed prompts:  60%|█████▉    | 2449/4096 [01:17<01:01, 26.86it/s, est. speed input: 32415.42 toks/s, output: 31.66 toks/s]
Processed prompts:  61%|██████    | 2481/4096 [01:18<01:00, 26.85it/s, est. speed input: 32340.28 toks/s, output: 31.58 toks/s]
Processed prompts:  61%|██████▏   | 2513/4096 [01:19<00:58, 26.84it/s, est. speed input: 32267.10 toks/s, output: 31.51 toks/s]
Processed prompts:  62%|██████▏   | 2545/4096 [01:20<00:57, 27.07it/s, est. speed input: 32210.20 toks/s, output: 31.46 toks/s]
Processed prompts:  63%|██████▎   | 2577/4096 [01:22<00:55, 27.22it/s, est. speed input: 32153.94 toks/s, output: 31.40 toks/s]
Processed prompts:  64%|██████▎   | 2609/4096 [01:23<00:54, 27.09it/s, est. speed input: 32086.38 toks/s, output: 31.33 toks/s]
Processed prompts:  64%|██████▍   | 2641/4096 [01:24<00:53, 27.01it/s, est. speed input: 32021.03 toks/s, output: 31.27 toks/s]
Processed prompts:  65%|██████▌   | 2673/4096 [01:25<00:52, 26.95it/s, est. speed input: 31957.55 toks/s, output: 31.21 toks/s]
Processed prompts:  66%|██████▌   | 2705/4096 [01:26<00:51, 26.91it/s, est. speed input: 31895.55 toks/s, output: 31.15 toks/s]
Processed prompts:  67%|██████▋   | 2737/4096 [01:28<00:50, 27.10it/s, est. speed input: 31846.93 toks/s, output: 31.10 toks/s]
Processed prompts:  68%|██████▊   | 2769/4096 [01:29<00:49, 26.98it/s, est. speed input: 31786.62 toks/s, output: 31.04 toks/s]
Processed prompts:  68%|██████▊   | 2801/4096 [01:30<00:48, 26.91it/s, est. speed input: 31728.41 toks/s, output: 30.98 toks/s]
Processed prompts:  69%|██████▉   | 2833/4096 [01:31<00:47, 26.85it/s, est. speed input: 31671.38 toks/s, output: 30.93 toks/s]
Processed prompts:  70%|██████▉   | 2865/4096 [01:32<00:45, 26.83it/s, est. speed input: 31616.58 toks/s, output: 30.88 toks/s]
Processed prompts:  71%|███████   | 2897/4096 [01:33<00:43, 27.50it/s, est. speed input: 31596.53 toks/s, output: 30.86 toks/s]
Processed prompts:  72%|███████▏  | 2929/4096 [01:35<00:42, 27.26it/s, est. speed input: 31543.20 toks/s, output: 30.80 toks/s]
Processed prompts:  72%|███████▏  | 2961/4096 [01:36<00:41, 27.10it/s, est. speed input: 31491.37 toks/s, output: 30.75 toks/s]
Processed prompts:  73%|███████▎  | 2993/4096 [01:37<00:40, 27.00it/s, est. speed input: 31441.39 toks/s, output: 30.70 toks/s]
Processed prompts:  74%|███████▍  | 3025/4096 [01:38<00:39, 26.91it/s, est. speed input: 31391.67 toks/s, output: 30.66 toks/s]
Processed prompts:  75%|███████▍  | 3057/4096 [01:39<00:38, 26.84it/s, est. speed input: 31342.56 toks/s, output: 30.61 toks/s]
Processed prompts:  75%|███████▌  | 3089/4096 [01:41<00:37, 26.81it/s, est. speed input: 31295.79 toks/s, output: 30.56 toks/s]
Processed prompts:  76%|███████▌  | 3121/4096 [01:42<00:36, 26.77it/s, est. speed input: 31249.18 toks/s, output: 30.52 toks/s]
Processed prompts:  77%|███████▋  | 3153/4096 [01:43<00:35, 26.75it/s, est. speed input: 31204.05 toks/s, output: 30.47 toks/s]
Processed prompts:  78%|███████▊  | 3185/4096 [01:44<00:34, 26.74it/s, est. speed input: 31160.02 toks/s, output: 30.43 toks/s]
Processed prompts:  79%|███████▊  | 3217/4096 [01:45<00:32, 26.73it/s, est. speed input: 31116.64 toks/s, output: 30.39 toks/s]
Processed prompts:  79%|███████▉  | 3249/4096 [01:47<00:31, 26.72it/s, est. speed input: 31074.52 toks/s, output: 30.35 toks/s]
Processed prompts:  80%|████████  | 3281/4096 [01:48<00:30, 26.72it/s, est. speed input: 31033.38 toks/s, output: 30.31 toks/s]
Processed prompts:  81%|████████  | 3313/4096 [01:49<00:29, 26.71it/s, est. speed input: 30992.62 toks/s, output: 30.27 toks/s]
Processed prompts:  82%|████████▏ | 3345/4096 [01:50<00:28, 26.70it/s, est. speed input: 30952.89 toks/s, output: 30.23 toks/s]
Processed prompts:  82%|████████▏ | 3377/4096 [01:51<00:26, 26.71it/s, est. speed input: 30914.54 toks/s, output: 30.19 toks/s]
Processed prompts:  83%|████████▎ | 3409/4096 [01:53<00:25, 26.71it/s, est. speed input: 30876.69 toks/s, output: 30.15 toks/s]
Processed prompts:  84%|████████▍ | 3441/4096 [01:54<00:24, 26.69it/s, est. speed input: 30839.04 toks/s, output: 30.12 toks/s]
Processed prompts:  85%|████████▍ | 3473/4096 [01:55<00:23, 26.71it/s, est. speed input: 30803.26 toks/s, output: 30.08 toks/s]
Processed prompts:  86%|████████▌ | 3505/4096 [01:56<00:22, 26.71it/s, est. speed input: 30768.03 toks/s, output: 30.05 toks/s]
Processed prompts:  86%|████████▋ | 3537/4096 [01:57<00:20, 26.96it/s, est. speed input: 30742.79 toks/s, output: 30.02 toks/s]
Processed prompts:  87%|████████▋ | 3569/4096 [01:59<00:19, 26.87it/s, est. speed input: 30708.23 toks/s, output: 29.99 toks/s]
Processed prompts:  88%|████████▊ | 3601/4096 [02:00<00:18, 26.81it/s, est. speed input: 30674.40 toks/s, output: 29.96 toks/s]
Processed prompts:  89%|████████▊ | 3633/4096 [02:01<00:17, 26.77it/s, est. speed input: 30641.05 toks/s, output: 29.92 toks/s]
Processed prompts:  89%|████████▉ | 3665/4096 [02:02<00:15, 26.97it/s, est. speed input: 30617.00 toks/s, output: 29.90 toks/s]
Processed prompts:  90%|█████████ | 3697/4096 [02:03<00:14, 26.87it/s, est. speed input: 30584.50 toks/s, output: 29.87 toks/s]
Processed prompts:  91%|█████████ | 3729/4096 [02:04<00:13, 26.81it/s, est. speed input: 30553.09 toks/s, output: 29.84 toks/s]
Processed prompts:  92%|█████████▏| 3761/4096 [02:06<00:12, 26.77it/s, est. speed input: 30522.38 toks/s, output: 29.81 toks/s]
Processed prompts:  93%|█████████▎| 3793/4096 [02:07<00:11, 26.73it/s, est. speed input: 30491.89 toks/s, output: 29.78 toks/s]
Processed prompts:  93%|█████████▎| 3825/4096 [02:08<00:10, 26.71it/s, est. speed input: 30462.05 toks/s, output: 29.75 toks/s]
Processed prompts:  94%|█████████▍| 3857/4096 [02:09<00:08, 26.69it/s, est. speed input: 30432.46 toks/s, output: 29.72 toks/s]
Processed prompts:  95%|█████████▍| 3889/4096 [02:10<00:07, 26.68it/s, est. speed input: 30403.67 toks/s, output: 29.69 toks/s]
Processed prompts:  96%|█████████▌| 3921/4096 [02:12<00:06, 27.11it/s, est. speed input: 30390.45 toks/s, output: 29.68 toks/s]
Processed prompts:  97%|█████████▋| 3953/4096 [02:13<00:05, 26.96it/s, est. speed input: 30362.15 toks/s, output: 29.65 toks/s]
Processed prompts:  97%|█████████▋| 3985/4096 [02:14<00:04, 27.12it/s, est. speed input: 30343.12 toks/s, output: 29.63 toks/s]
Processed prompts:  98%|█████████▊| 4017/4096 [02:15<00:02, 26.97it/s, est. speed input: 30315.81 toks/s, output: 29.61 toks/s]
Processed prompts:  99%|█████████▉| 4049/4096 [02:16<00:01, 27.14it/s, est. speed input: 30297.86 toks/s, output: 29.59 toks/s]
Processed prompts: 100%|█████████▉| 4081/4096 [02:17<00:00, 32.18it/s, est. speed input: 30412.19 toks/s, output: 29.70 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [02:17<00:00, 32.18it/s, est. speed input: 30523.86 toks/s, output: 29.81 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [02:17<00:00, 29.81it/s, est. speed input: 30523.86 toks/s, output: 29.81 toks/s]
[rank0]:[W125 20:23:06.748487344 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=65536 ==========
Time: 2026-01-25 20:23:08
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=8192, max_num_seqs=64
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 8192 --max-num-seqs 64 --max-model-len 1025 --max-num-batched-tokens 65536 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-7B-INT8_M65536.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 20:24:14 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=413325) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=413325) WARNING 01-25 20:24:33 [backends.py:609] Failed to read file <frozen os>
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 240, in _initialize_kv_caches
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     available_gpu_memory = self.model_executor.determine_available_memory()
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     return self.collective_rpc("determine_available_memory")
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     result = run_method(self.driver_worker, method, args, kwargs)
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/root/vllmbench/vllm/v1/serial_utils.py", line 461, in run_method
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 340, in determine_available_memory
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     self.model_runner.profile_run()
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4474, in profile_run
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     hidden_states, last_hidden_states = self._dummy_run(
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]                                         ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4198, in _dummy_run
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     outputs = self.model(
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]               ^^^^^^^^^^^
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 583, in forward
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     hidden_states = self.model(
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]                     ^^^^^^^^^^^
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/root/vllmbench/vllm/compilation/decorators.py", line 526, in __call__
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/root/vllmbench/vllm/compilation/wrapper.py", line 218, in __call__
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     return self._call_with_optional_nvtx_range(
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/root/vllmbench/vllm/compilation/wrapper.py", line 109, in _call_with_optional_nvtx_range
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     return callable_fn(*args, **kwargs)
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 832, in compile_wrapper
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     return fn(*args, **kwargs)
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 418, in forward
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     def forward(
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     return fn(*args, **kwargs)
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/root/vllmbench/vllm/compilation/caching.py", line 54, in __call__
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     return self.optimized_call(*args, **kwargs)
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 837, in call_wrapped
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     return self._wrapped_call(self, *args, **kwargs)
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 413, in __call__
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     raise e
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 400, in __call__
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     return super(self.cls, obj).__call__(*args, **kwargs)  # type: ignore[misc]
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "<eval_with_key>.58", line 325, in forward
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     submod_2 = self.submod_2(getitem_3, s72, l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_scale_, l_self_modules_layers_modules_0_modules_post_attention_layernorm_parameters_weight_, getitem_4, l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_scale_, l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_input_layernorm_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_bias_, l_positions_, l_self_modules_layers_modules_0_modules_self_attn_modules_rotary_emb_buffers_cos_sin_cache_);  getitem_3 = l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_scale_ = l_self_modules_layers_modules_0_modules_post_attention_layernorm_parameters_weight_ = getitem_4 = l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_scale_ = l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_input_layernorm_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_bias_ = None
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/root/vllmbench/vllm/compilation/piecewise_backend.py", line 178, in __call__
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     return range_entry.runnable(*args)
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/standalone_compile.py", line 63, in __call__
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     return self._compiled_fn(*args)
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     return fn(*args, **kwargs)
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/aot_autograd.py", line 1130, in forward
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     return compiled_fn(full_args)
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 353, in runtime_wrapper
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     all_outs = call_func_at_runtime_with_args(
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/utils.py", line 129, in call_func_at_runtime_with_args
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     out = normalize_as_list(f(args))
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]                             ^^^^^^^
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 724, in inner_fn
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     outs = compiled_fn(args)
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]            ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 526, in wrapper
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     return compiled_fn(runtime_args)
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/output_code.py", line 613, in __call__
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     return self.current_callable(inputs)
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/utils.py", line 2962, in run
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     out = model(new_inputs)
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]           ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/tmp/torchinductor_root/ie/ciemksipb2utubwo6wdej2lrgrjtv5bidk3nxdd4qcpvjvpboent.py", line 1093, in call
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     buf17 = torch.ops.slidesparse.quant_slide_int8.default(buf16, 'Qwen2.5-7B-INT8', 8)
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_ops.py", line 841, in __call__
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     return self._op(*args, **kwargs)
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/root/vllmbench/slidesparse/core/kernels.py", line 564, in _quant_slide_int8_impl
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     return fn(input, L)
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]            ^^^^^^^^^^^^
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/root/vllmbench/slidesparse/csrc/fused_quant_slide_triton/build/A100_cc80_py312_cu129_x86_64/quant_slide_tuned_Qwen2.5-7B.py", line 321, in quant_slide_int8_triton
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     _quant_slide_int8_kernel[(M,)](
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/triton/runtime/jit.py", line 419, in <lambda>
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/triton/runtime/jit.py", line 756, in run
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     launch_metadata = kernel.launch_metadata(grid, stream, *bound_args.values())
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 490, in launch_metadata
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     self._init_handles()
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 473, in _init_handles
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]     self.module, self.function, self.n_regs, self.n_spills, self.n_max_threads = driver.active.utils.load_binary(
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866]                                                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325) ERROR 01-25 20:24:44 [core.py:866] RuntimeError: Triton Error [CUDA]: an illegal memory access was encountered

STDERR:
[2026-01-25 20:24:14] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 20:24:14] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 20:24:14] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 20:24:14] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:24:14] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:24:14] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:24:14] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:24:14] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:24:14] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 20:24:14] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 20:24:14] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 20:24:14] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 20:24:14] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 20:24:14] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 20:24:22] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 20:24:22] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 20:24:22] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 20:24:22] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:24:22] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:24:22] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:24:22] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:24:22] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 20:24:22] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 20:24:22] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 20:24:22] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 20:24:22] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 20:24:22] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 20:24:22] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=413325) [2026-01-25 20:24:23] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=413325) [2026-01-25 20:24:23] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=413325) [2026-01-25 20:24:23] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=413325) [2026-01-25 20:24:23] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=413325) [2026-01-25 20:24:23] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=413325) [2026-01-25 20:24:23] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=413325) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=413325) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.30it/s]
(EngineCore_DP0 pid=413325) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.34it/s]
(EngineCore_DP0 pid=413325) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.33it/s]
(EngineCore_DP0 pid=413325) 
(EngineCore_DP0 pid=413325) [2026-01-25 20:24:25] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=413325) [2026-01-25 20:24:25] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 18579456 bytes
(EngineCore_DP0 pid=413325) [2026-01-25 20:24:25] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=413325) [2026-01-25 20:24:25] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 14450688 bytes
(EngineCore_DP0 pid=413325) [2026-01-25 20:24:25] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=413325) [2026-01-25 20:24:25] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 152764416 bytes
(EngineCore_DP0 pid=413325) [2026-01-25 20:24:25] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=413325) [2026-01-25 20:24:25] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 76382208 bytes
(EngineCore_DP0 pid=413325) [rank0]:W0125 20:24:41.980000 413325 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=413325) [rank0]:W0125 20:24:42.091000 413325 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=413325) [rank0]:W0125 20:24:43.509000 413325 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=413325) [rank0]:W0125 20:24:43.692000 413325 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=413325) Process EngineCore_DP0:
(EngineCore_DP0 pid=413325) Traceback (most recent call last):
(EngineCore_DP0 pid=413325)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=413325)     self.run()
(EngineCore_DP0 pid=413325)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=413325)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=413325)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=413325)     raise e
(EngineCore_DP0 pid=413325)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=413325)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=413325)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=413325)     super().__init__(
(EngineCore_DP0 pid=413325)   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=413325)     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=413325)                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325)   File "/root/vllmbench/vllm/v1/engine/core.py", line 240, in _initialize_kv_caches
(EngineCore_DP0 pid=413325)     available_gpu_memory = self.model_executor.determine_available_memory()
(EngineCore_DP0 pid=413325)                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325)   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
(EngineCore_DP0 pid=413325)     return self.collective_rpc("determine_available_memory")
(EngineCore_DP0 pid=413325)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325)   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
(EngineCore_DP0 pid=413325)     result = run_method(self.driver_worker, method, args, kwargs)
(EngineCore_DP0 pid=413325)              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325)   File "/root/vllmbench/vllm/v1/serial_utils.py", line 461, in run_method
(EngineCore_DP0 pid=413325)     return func(*args, **kwargs)
(EngineCore_DP0 pid=413325)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325)   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=413325)     return func(*args, **kwargs)
(EngineCore_DP0 pid=413325)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325)   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 340, in determine_available_memory
(EngineCore_DP0 pid=413325)     self.model_runner.profile_run()
(EngineCore_DP0 pid=413325)   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4474, in profile_run
(EngineCore_DP0 pid=413325)     hidden_states, last_hidden_states = self._dummy_run(
(EngineCore_DP0 pid=413325)                                         ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325)   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=413325)     return func(*args, **kwargs)
(EngineCore_DP0 pid=413325)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325)   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4198, in _dummy_run
(EngineCore_DP0 pid=413325)     outputs = self.model(
(EngineCore_DP0 pid=413325)               ^^^^^^^^^^^
(EngineCore_DP0 pid=413325)   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=413325)     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=413325)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=413325)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=413325)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=413325)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=413325)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 583, in forward
(EngineCore_DP0 pid=413325)     hidden_states = self.model(
(EngineCore_DP0 pid=413325)                     ^^^^^^^^^^^
(EngineCore_DP0 pid=413325)   File "/root/vllmbench/vllm/compilation/decorators.py", line 526, in __call__
(EngineCore_DP0 pid=413325)     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
(EngineCore_DP0 pid=413325)              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325)   File "/root/vllmbench/vllm/compilation/wrapper.py", line 218, in __call__
(EngineCore_DP0 pid=413325)     return self._call_with_optional_nvtx_range(
(EngineCore_DP0 pid=413325)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325)   File "/root/vllmbench/vllm/compilation/wrapper.py", line 109, in _call_with_optional_nvtx_range
(EngineCore_DP0 pid=413325)     return callable_fn(*args, **kwargs)
(EngineCore_DP0 pid=413325)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325)   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 832, in compile_wrapper
(EngineCore_DP0 pid=413325)     return fn(*args, **kwargs)
(EngineCore_DP0 pid=413325)            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 418, in forward
(EngineCore_DP0 pid=413325)     def forward(
(EngineCore_DP0 pid=413325)   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=413325)     return fn(*args, **kwargs)
(EngineCore_DP0 pid=413325)            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325)   File "/root/vllmbench/vllm/compilation/caching.py", line 54, in __call__
(EngineCore_DP0 pid=413325)     return self.optimized_call(*args, **kwargs)
(EngineCore_DP0 pid=413325)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325)   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 837, in call_wrapped
(EngineCore_DP0 pid=413325)     return self._wrapped_call(self, *args, **kwargs)
(EngineCore_DP0 pid=413325)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325)   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 413, in __call__
(EngineCore_DP0 pid=413325)     raise e
(EngineCore_DP0 pid=413325)   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 400, in __call__
(EngineCore_DP0 pid=413325)     return super(self.cls, obj).__call__(*args, **kwargs)  # type: ignore[misc]
(EngineCore_DP0 pid=413325)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=413325)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=413325)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=413325)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=413325)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325)   File "<eval_with_key>.58", line 325, in forward
(EngineCore_DP0 pid=413325)     submod_2 = self.submod_2(getitem_3, s72, l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_scale_, l_self_modules_layers_modules_0_modules_post_attention_layernorm_parameters_weight_, getitem_4, l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_scale_, l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_input_layernorm_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_bias_, l_positions_, l_self_modules_layers_modules_0_modules_self_attn_modules_rotary_emb_buffers_cos_sin_cache_);  getitem_3 = l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_scale_ = l_self_modules_layers_modules_0_modules_post_attention_layernorm_parameters_weight_ = getitem_4 = l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_scale_ = l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_input_layernorm_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_bias_ = None
(EngineCore_DP0 pid=413325)                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325)   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=413325)     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=413325)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325)   File "/root/vllmbench/vllm/compilation/piecewise_backend.py", line 178, in __call__
(EngineCore_DP0 pid=413325)     return range_entry.runnable(*args)
(EngineCore_DP0 pid=413325)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/standalone_compile.py", line 63, in __call__
(EngineCore_DP0 pid=413325)     return self._compiled_fn(*args)
(EngineCore_DP0 pid=413325)            ^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325)   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=413325)     return fn(*args, **kwargs)
(EngineCore_DP0 pid=413325)            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/aot_autograd.py", line 1130, in forward
(EngineCore_DP0 pid=413325)     return compiled_fn(full_args)
(EngineCore_DP0 pid=413325)            ^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 353, in runtime_wrapper
(EngineCore_DP0 pid=413325)     all_outs = call_func_at_runtime_with_args(
(EngineCore_DP0 pid=413325)                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/utils.py", line 129, in call_func_at_runtime_with_args
(EngineCore_DP0 pid=413325)     out = normalize_as_list(f(args))
(EngineCore_DP0 pid=413325)                             ^^^^^^^
(EngineCore_DP0 pid=413325)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 724, in inner_fn
(EngineCore_DP0 pid=413325)     outs = compiled_fn(args)
(EngineCore_DP0 pid=413325)            ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 526, in wrapper
(EngineCore_DP0 pid=413325)     return compiled_fn(runtime_args)
(EngineCore_DP0 pid=413325)            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/output_code.py", line 613, in __call__
(EngineCore_DP0 pid=413325)     return self.current_callable(inputs)
(EngineCore_DP0 pid=413325)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/utils.py", line 2962, in run
(EngineCore_DP0 pid=413325)     out = model(new_inputs)
(EngineCore_DP0 pid=413325)           ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325)   File "/tmp/torchinductor_root/ie/ciemksipb2utubwo6wdej2lrgrjtv5bidk3nxdd4qcpvjvpboent.py", line 1093, in call
(EngineCore_DP0 pid=413325)     buf17 = torch.ops.slidesparse.quant_slide_int8.default(buf16, 'Qwen2.5-7B-INT8', 8)
(EngineCore_DP0 pid=413325)             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325)   File "/usr/local/lib/python3.12/dist-packages/torch/_ops.py", line 841, in __call__
(EngineCore_DP0 pid=413325)     return self._op(*args, **kwargs)
(EngineCore_DP0 pid=413325)            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325)   File "/root/vllmbench/slidesparse/core/kernels.py", line 564, in _quant_slide_int8_impl
(EngineCore_DP0 pid=413325)     return fn(input, L)
(EngineCore_DP0 pid=413325)            ^^^^^^^^^^^^
(EngineCore_DP0 pid=413325)   File "/root/vllmbench/slidesparse/csrc/fused_quant_slide_triton/build/A100_cc80_py312_cu129_x86_64/quant_slide_tuned_Qwen2.5-7B.py", line 321, in quant_slide_int8_triton
(EngineCore_DP0 pid=413325)     _quant_slide_int8_kernel[(M,)](
(EngineCore_DP0 pid=413325)   File "/usr/local/lib/python3.12/dist-packages/triton/runtime/jit.py", line 419, in <lambda>
(EngineCore_DP0 pid=413325)     return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)
(EngineCore_DP0 pid=413325)                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325)   File "/usr/local/lib/python3.12/dist-packages/triton/runtime/jit.py", line 756, in run
(EngineCore_DP0 pid=413325)     launch_metadata = kernel.launch_metadata(grid, stream, *bound_args.values())
(EngineCore_DP0 pid=413325)                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325)   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 490, in launch_metadata
(EngineCore_DP0 pid=413325)     self._init_handles()
(EngineCore_DP0 pid=413325)   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 473, in _init_handles
(EngineCore_DP0 pid=413325)     self.module, self.function, self.n_regs, self.n_spills, self.n_max_threads = driver.active.utils.load_binary(
(EngineCore_DP0 pid=413325)                                                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=413325) RuntimeError: Triton Error [CUDA]: an illegal memory access was encountered
[rank0]:[W125 20:24:45.517863540 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

ERROR: Test failed for M=65536

========== M=512 ==========
Time: 2026-01-25 22:33:49
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_8
Params: prompt_len=512, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_8 --dataset-name random --input-len 512 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 513 --max-num-batched-tokens 513 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-14B-INT8_M512.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 22:33:57 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=530425) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=530425) WARNING 01-25 22:35:48 [backends.py:609] Failed to read file <frozen os>
Throughput: 12.65 requests/s, 6491.43 total tokens/s, 12.65 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128

STDERR:
[2026-01-25 22:33:57] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 22:33:57] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-25 22:33:57] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-25 22:33:57] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:33:57] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:33:57] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:33:57] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:33:57] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:33:57] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-25 22:33:57] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 22:33:57] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 22:33:57] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 22:33:57] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 22:33:57] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 22:34:05] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 22:34:05] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-25 22:34:05] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-25 22:34:05] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:34:05] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:34:05] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:34:05] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:34:05] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:34:05] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-25 22:34:05] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 22:34:05] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 22:34:05] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 22:34:05] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 22:34:05] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=530425) [2026-01-25 22:34:06] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=530425) [2026-01-25 22:34:06] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=530425) [2026-01-25 22:34:06] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=530425) [2026-01-25 22:34:06] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=530425) [2026-01-25 22:34:06] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=530425) [2026-01-25 22:34:06] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=530425) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=530425) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:28<01:24, 28.08s/it]
(EngineCore_DP0 pid=530425) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:34<00:30, 15.13s/it]
(EngineCore_DP0 pid=530425) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [01:02<00:21, 21.38s/it]
(EngineCore_DP0 pid=530425) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [01:28<00:00, 23.05s/it]
(EngineCore_DP0 pid=530425) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [01:28<00:00, 22.14s/it]
(EngineCore_DP0 pid=530425) 
(EngineCore_DP0 pid=530425) [2026-01-25 22:35:35] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 7680] -> 1D uint8
(EngineCore_DP0 pid=530425) [2026-01-25 22:35:35] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 41287680 bytes
(EngineCore_DP0 pid=530425) [2026-01-25 22:35:35] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 7680] -> 1D uint8
(EngineCore_DP0 pid=530425) [2026-01-25 22:35:35] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 29491200 bytes
(EngineCore_DP0 pid=530425) [2026-01-25 22:35:35] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 7680] -> 1D uint8
(EngineCore_DP0 pid=530425) [2026-01-25 22:35:35] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 159252480 bytes
(EngineCore_DP0 pid=530425) [2026-01-25 22:35:35] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 20736] -> 1D uint8
(EngineCore_DP0 pid=530425) [2026-01-25 22:35:35] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 79626240 bytes
(EngineCore_DP0 pid=530425) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  3.11it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  2.46it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  2.54it/s]
(EngineCore_DP0 pid=530425) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  5.47it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  5.47it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  38%|███▊      | 49/128 [00:00<00:00, 482.24it/s]
Adding requests:  80%|███████▉  | 102/128 [00:00<00:00, 508.84it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 501.68it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:21,  5.89it/s, est. speed input: 3015.21 toks/s, output: 5.89 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:13,  9.57it/s, est. speed input: 4613.64 toks/s, output: 9.01 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:11, 11.12it/s, est. speed input: 5274.43 toks/s, output: 10.30 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:10, 11.92it/s, est. speed input: 5629.91 toks/s, output: 11.00 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:00<00:09, 12.40it/s, est. speed input: 5852.92 toks/s, output: 11.43 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:00<00:09, 12.74it/s, est. speed input: 6015.28 toks/s, output: 11.75 toks/s]
Processed prompts:  10%|█         | 13/128 [00:01<00:09, 12.51it/s, est. speed input: 6040.22 toks/s, output: 11.80 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:01<00:08, 12.60it/s, est. speed input: 6103.19 toks/s, output: 11.92 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:01<00:08, 12.70it/s, est. speed input: 6159.46 toks/s, output: 12.03 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:01<00:08, 12.91it/s, est. speed input: 6227.12 toks/s, output: 12.16 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:01<00:08, 13.05it/s, est. speed input: 6281.82 toks/s, output: 12.27 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:01<00:07, 13.18it/s, est. speed input: 6330.46 toks/s, output: 12.36 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:02<00:07, 13.22it/s, est. speed input: 6367.51 toks/s, output: 12.44 toks/s]
Processed prompts:  21%|██        | 27/128 [00:02<00:07, 13.07it/s, est. speed input: 6378.64 toks/s, output: 12.46 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:02<00:07, 13.16it/s, est. speed input: 6408.75 toks/s, output: 12.52 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:02<00:07, 13.08it/s, est. speed input: 6420.98 toks/s, output: 12.54 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:02<00:07, 13.18it/s, est. speed input: 6446.15 toks/s, output: 12.59 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:02<00:07, 13.25it/s, est. speed input: 6468.82 toks/s, output: 12.63 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:02<00:06, 13.28it/s, est. speed input: 6487.95 toks/s, output: 12.67 toks/s]
Processed prompts:  30%|███       | 39/128 [00:03<00:06, 13.30it/s, est. speed input: 6504.34 toks/s, output: 12.70 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:03<00:06, 12.81it/s, est. speed input: 6479.92 toks/s, output: 12.66 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:03<00:06, 12.73it/s, est. speed input: 6477.58 toks/s, output: 12.65 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:03<00:06, 12.84it/s, est. speed input: 6487.32 toks/s, output: 12.67 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:03<00:06, 13.02it/s, est. speed input: 6503.83 toks/s, output: 12.70 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:03<00:06, 13.03it/s, est. speed input: 6510.93 toks/s, output: 12.72 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:04<00:05, 13.08it/s, est. speed input: 6519.94 toks/s, output: 12.73 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:04<00:05, 13.07it/s, est. speed input: 6525.77 toks/s, output: 12.75 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:04<00:05, 13.12it/s, est. speed input: 6534.91 toks/s, output: 12.76 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:04<00:05, 13.10it/s, est. speed input: 6540.14 toks/s, output: 12.77 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:04<00:05, 13.19it/s, est. speed input: 6550.44 toks/s, output: 12.79 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:04<00:05, 13.28it/s, est. speed input: 6561.58 toks/s, output: 12.82 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:04<00:04, 13.32it/s, est. speed input: 6570.86 toks/s, output: 12.83 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:05<00:04, 13.33it/s, est. speed input: 6578.78 toks/s, output: 12.85 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:05<00:04, 13.21it/s, est. speed input: 6580.01 toks/s, output: 12.85 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:05<00:04, 12.98it/s, est. speed input: 6574.16 toks/s, output: 12.84 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:05<00:04, 13.06it/s, est. speed input: 6579.83 toks/s, output: 12.85 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:05<00:04, 13.16it/s, est. speed input: 6587.53 toks/s, output: 12.87 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:05<00:04, 13.13it/s, est. speed input: 6590.06 toks/s, output: 12.87 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:05<00:03, 13.25it/s, est. speed input: 6598.67 toks/s, output: 12.89 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:06<00:03, 13.21it/s, est. speed input: 6601.29 toks/s, output: 12.89 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:06<00:03, 13.09it/s, est. speed input: 6600.49 toks/s, output: 12.89 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:06<00:03, 12.72it/s, est. speed input: 6587.88 toks/s, output: 12.87 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:06<00:03, 12.75it/s, est. speed input: 6587.07 toks/s, output: 12.87 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:06<00:03, 12.92it/s, est. speed input: 6592.67 toks/s, output: 12.88 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:06<00:02, 13.09it/s, est. speed input: 6599.57 toks/s, output: 12.89 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:07<00:02, 13.15it/s, est. speed input: 6604.04 toks/s, output: 12.90 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:07<00:02, 13.24it/s, est. speed input: 6609.76 toks/s, output: 12.91 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:07<00:02, 13.20it/s, est. speed input: 6611.73 toks/s, output: 12.91 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:07<00:02, 13.07it/s, est. speed input: 6610.41 toks/s, output: 12.91 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:07<00:02, 13.17it/s, est. speed input: 6615.41 toks/s, output: 12.92 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:07<00:02, 13.11it/s, est. speed input: 6615.75 toks/s, output: 12.92 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:07<00:01, 13.18it/s, est. speed input: 6620.05 toks/s, output: 12.93 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:08<00:01, 13.27it/s, est. speed input: 6625.17 toks/s, output: 12.94 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:08<00:01, 13.32it/s, est. speed input: 6629.78 toks/s, output: 12.95 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:08<00:01, 13.23it/s, est. speed input: 6630.42 toks/s, output: 12.95 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:08<00:01, 13.30it/s, est. speed input: 6634.94 toks/s, output: 12.96 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:08<00:01, 13.31it/s, est. speed input: 6638.28 toks/s, output: 12.97 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:08<00:00, 13.34it/s, est. speed input: 6642.10 toks/s, output: 12.97 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:09<00:00, 13.43it/s, est. speed input: 6647.80 toks/s, output: 12.98 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:09<00:00, 13.44it/s, est. speed input: 6651.84 toks/s, output: 12.99 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:09<00:00, 13.28it/s, est. speed input: 6651.12 toks/s, output: 12.99 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:09<00:00, 12.86it/s, est. speed input: 6641.99 toks/s, output: 12.97 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:09<00:00, 12.89it/s, est. speed input: 6641.76 toks/s, output: 12.97 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:09<00:00, 13.04it/s, est. speed input: 6645.25 toks/s, output: 12.98 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:09<00:00, 13.04it/s, est. speed input: 6647.36 toks/s, output: 12.98 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:09<00:00, 12.98it/s, est. speed input: 6647.36 toks/s, output: 12.98 toks/s]
[rank0]:[W125 22:36:23.099466516 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=1024 ==========
Time: 2026-01-25 22:36:25
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 1025 --max-num-batched-tokens 1025 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-14B-INT8_M1024.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 22:36:34 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=532884) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=532884) WARNING 01-25 22:36:59 [backends.py:609] Failed to read file <frozen os>
Throughput: 12.03 requests/s, 12326.05 total tokens/s, 12.03 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128

STDERR:
[2026-01-25 22:36:34] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 22:36:34] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-25 22:36:34] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-25 22:36:34] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:36:34] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:36:34] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:36:34] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:36:34] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:36:34] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-25 22:36:34] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 22:36:34] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 22:36:34] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 22:36:34] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 22:36:34] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 22:36:41] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 22:36:41] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-25 22:36:41] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-25 22:36:41] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:36:41] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:36:41] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:36:41] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:36:41] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:36:41] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-25 22:36:41] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 22:36:41] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 22:36:41] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 22:36:41] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 22:36:41] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=532884) [2026-01-25 22:36:42] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=532884) [2026-01-25 22:36:42] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=532884) [2026-01-25 22:36:42] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=532884) [2026-01-25 22:36:42] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=532884) [2026-01-25 22:36:42] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=532884) [2026-01-25 22:36:42] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=532884) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=532884) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.24it/s]
(EngineCore_DP0 pid=532884) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.77it/s]
(EngineCore_DP0 pid=532884) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.44it/s]
(EngineCore_DP0 pid=532884) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.27it/s]
(EngineCore_DP0 pid=532884) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.34it/s]
(EngineCore_DP0 pid=532884) 
(EngineCore_DP0 pid=532884) [2026-01-25 22:36:46] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 7680] -> 1D uint8
(EngineCore_DP0 pid=532884) [2026-01-25 22:36:46] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 41287680 bytes
(EngineCore_DP0 pid=532884) [2026-01-25 22:36:46] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 7680] -> 1D uint8
(EngineCore_DP0 pid=532884) [2026-01-25 22:36:46] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 29491200 bytes
(EngineCore_DP0 pid=532884) [2026-01-25 22:36:46] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 7680] -> 1D uint8
(EngineCore_DP0 pid=532884) [2026-01-25 22:36:46] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 159252480 bytes
(EngineCore_DP0 pid=532884) [2026-01-25 22:36:46] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 20736] -> 1D uint8
(EngineCore_DP0 pid=532884) [2026-01-25 22:36:46] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 79626240 bytes
(EngineCore_DP0 pid=532884) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  6.31it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  6.35it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  6.34it/s]
(EngineCore_DP0 pid=532884) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  6.10it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  6.10it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  20%|█▉        | 25/128 [00:00<00:00, 246.31it/s]
Adding requests:  41%|████      | 52/128 [00:00<00:00, 258.12it/s]
Adding requests:  63%|██████▎   | 81/128 [00:00<00:00, 271.70it/s]
Adding requests:  85%|████████▌ | 109/128 [00:00<00:00, 274.91it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 270.21it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:03, 40.19it/s, est. speed input: 41156.54 toks/s, output: 40.19 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:00<00:06, 18.51it/s, est. speed input: 20929.13 toks/s, output: 20.44 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:00<00:07, 16.01it/s, est. speed input: 18437.67 toks/s, output: 18.01 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:00<00:07, 14.95it/s, est. speed input: 17453.89 toks/s, output: 17.04 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:01<00:07, 14.19it/s, est. speed input: 16760.01 toks/s, output: 16.37 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:01<00:07, 13.57it/s, est. speed input: 16207.72 toks/s, output: 15.83 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:01<00:07, 13.15it/s, est. speed input: 15789.84 toks/s, output: 15.42 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:01<00:08, 12.85it/s, est. speed input: 15455.06 toks/s, output: 15.09 toks/s]
Processed prompts:  21%|██        | 27/128 [00:01<00:07, 12.65it/s, est. speed input: 15184.14 toks/s, output: 14.83 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:01<00:07, 12.50it/s, est. speed input: 14957.64 toks/s, output: 14.61 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:02<00:07, 12.44it/s, est. speed input: 14777.33 toks/s, output: 14.43 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:02<00:07, 12.32it/s, est. speed input: 14601.35 toks/s, output: 14.26 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:02<00:07, 12.26it/s, est. speed input: 14455.20 toks/s, output: 14.12 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:02<00:07, 12.22it/s, est. speed input: 14329.21 toks/s, output: 13.99 toks/s]
Processed prompts:  30%|███       | 39/128 [00:02<00:07, 12.19it/s, est. speed input: 14215.35 toks/s, output: 13.88 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:02<00:07, 12.17it/s, est. speed input: 14115.68 toks/s, output: 13.78 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:03<00:06, 12.16it/s, est. speed input: 14026.68 toks/s, output: 13.70 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:03<00:06, 12.16it/s, est. speed input: 13947.73 toks/s, output: 13.62 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:03<00:06, 12.11it/s, est. speed input: 13869.14 toks/s, output: 13.54 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:03<00:06, 12.11it/s, est. speed input: 13802.64 toks/s, output: 13.48 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:03<00:06, 12.13it/s, est. speed input: 13743.79 toks/s, output: 13.42 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:03<00:06, 12.14it/s, est. speed input: 13690.45 toks/s, output: 13.37 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:04<00:06, 12.13it/s, est. speed input: 13639.51 toks/s, output: 13.32 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:04<00:05, 12.15it/s, est. speed input: 13594.84 toks/s, output: 13.28 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:04<00:05, 12.13it/s, est. speed input: 13549.10 toks/s, output: 13.23 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:04<00:05, 12.11it/s, est. speed input: 13507.31 toks/s, output: 13.19 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:04<00:05, 12.12it/s, est. speed input: 13469.83 toks/s, output: 13.15 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:04<00:05, 12.11it/s, est. speed input: 13432.90 toks/s, output: 13.12 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:05<00:05, 12.08it/s, est. speed input: 13396.67 toks/s, output: 13.08 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:05<00:04, 12.07it/s, est. speed input: 13362.86 toks/s, output: 13.05 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:05<00:04, 12.05it/s, est. speed input: 13329.95 toks/s, output: 13.02 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:05<00:04, 12.06it/s, est. speed input: 13302.06 toks/s, output: 12.99 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:05<00:04, 12.05it/s, est. speed input: 13273.76 toks/s, output: 12.96 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:05<00:04, 12.05it/s, est. speed input: 13247.32 toks/s, output: 12.94 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:06<00:04, 12.08it/s, est. speed input: 13226.28 toks/s, output: 12.92 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:06<00:03, 12.12it/s, est. speed input: 13207.74 toks/s, output: 12.90 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:06<00:03, 12.12it/s, est. speed input: 13186.72 toks/s, output: 12.88 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:06<00:03, 12.10it/s, est. speed input: 13165.85 toks/s, output: 12.86 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:06<00:03, 12.08it/s, est. speed input: 13144.90 toks/s, output: 12.84 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:06<00:03, 12.05it/s, est. speed input: 13124.27 toks/s, output: 12.82 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:07<00:03, 12.06it/s, est. speed input: 13106.52 toks/s, output: 12.80 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:07<00:02, 12.07it/s, est. speed input: 13089.71 toks/s, output: 12.78 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:07<00:02, 12.06it/s, est. speed input: 13072.63 toks/s, output: 12.77 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:07<00:02, 12.06it/s, est. speed input: 13057.30 toks/s, output: 12.75 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:07<00:02, 12.05it/s, est. speed input: 13041.62 toks/s, output: 12.74 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:07<00:02, 12.05it/s, est. speed input: 13026.54 toks/s, output: 12.72 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:08<00:02, 12.10it/s, est. speed input: 13016.36 toks/s, output: 12.71 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:08<00:01, 12.15it/s, est. speed input: 13007.13 toks/s, output: 12.70 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:08<00:01, 12.10it/s, est. speed input: 12993.00 toks/s, output: 12.69 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:08<00:01, 12.10it/s, est. speed input: 12981.15 toks/s, output: 12.68 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:08<00:01, 12.07it/s, est. speed input: 12968.16 toks/s, output: 12.66 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:08<00:01, 12.08it/s, est. speed input: 12957.77 toks/s, output: 12.65 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:09<00:01, 12.12it/s, est. speed input: 12949.75 toks/s, output: 12.65 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:09<00:00, 12.09it/s, est. speed input: 12938.29 toks/s, output: 12.64 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:09<00:00, 12.08it/s, est. speed input: 12927.52 toks/s, output: 12.62 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:09<00:00, 12.07it/s, est. speed input: 12917.42 toks/s, output: 12.61 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:09<00:00, 12.11it/s, est. speed input: 12910.60 toks/s, output: 12.61 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:09<00:00, 12.10it/s, est. speed input: 12901.62 toks/s, output: 12.60 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:10<00:00, 12.11it/s, est. speed input: 12893.71 toks/s, output: 12.59 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:10<00:00, 12.11it/s, est. speed input: 12889.27 toks/s, output: 12.59 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:10<00:00, 12.59it/s, est. speed input: 12889.27 toks/s, output: 12.59 toks/s]
[rank0]:[W125 22:37:35.470037033 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=2048 ==========
Time: 2026-01-25 22:37:37
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=256, max_num_seqs=2
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 256 --max-num-seqs 2 --max-model-len 1025 --max-num-batched-tokens 2048 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-14B-INT8_M2048.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 22:37:46 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=534102) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=534102) WARNING 01-25 22:38:11 [backends.py:609] Failed to read file <frozen os>
Throughput: 13.33 requests/s, 13663.88 total tokens/s, 13.33 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256

STDERR:
[2026-01-25 22:37:46] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 22:37:46] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-25 22:37:46] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-25 22:37:46] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:37:46] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:37:46] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:37:46] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:37:46] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:37:46] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-25 22:37:46] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 22:37:46] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 22:37:46] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 22:37:46] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 22:37:46] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 22:37:54] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 22:37:54] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-25 22:37:54] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-25 22:37:54] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:37:54] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:37:54] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:37:54] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:37:54] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:37:54] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-25 22:37:54] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 22:37:54] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 22:37:54] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 22:37:54] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 22:37:54] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=534102) [2026-01-25 22:37:55] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=534102) [2026-01-25 22:37:55] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=534102) [2026-01-25 22:37:55] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=534102) [2026-01-25 22:37:55] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=534102) [2026-01-25 22:37:55] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=534102) [2026-01-25 22:37:55] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=534102) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=534102) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.24it/s]
(EngineCore_DP0 pid=534102) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.80it/s]
(EngineCore_DP0 pid=534102) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.46it/s]
(EngineCore_DP0 pid=534102) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.27it/s]
(EngineCore_DP0 pid=534102) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.35it/s]
(EngineCore_DP0 pid=534102) 
(EngineCore_DP0 pid=534102) [2026-01-25 22:37:58] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 7680] -> 1D uint8
(EngineCore_DP0 pid=534102) [2026-01-25 22:37:58] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 41287680 bytes
(EngineCore_DP0 pid=534102) [2026-01-25 22:37:58] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 7680] -> 1D uint8
(EngineCore_DP0 pid=534102) [2026-01-25 22:37:58] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 29491200 bytes
(EngineCore_DP0 pid=534102) [2026-01-25 22:37:58] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 7680] -> 1D uint8
(EngineCore_DP0 pid=534102) [2026-01-25 22:37:58] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 159252480 bytes
(EngineCore_DP0 pid=534102) [2026-01-25 22:37:58] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 20736] -> 1D uint8
(EngineCore_DP0 pid=534102) [2026-01-25 22:37:58] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 79626240 bytes
(EngineCore_DP0 pid=534102) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  33%|███▎      | 1/3 [00:00<00:00,  6.49it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  67%|██████▋   | 2/3 [00:00<00:00,  6.81it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00,  6.52it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00,  6.56it/s]
(EngineCore_DP0 pid=534102) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 1/2 [00:00<00:00,  6.32it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  6.41it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  6.39it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  10%|█         | 26/256 [00:00<00:00, 255.84it/s]
Adding requests:  21%|██        | 53/256 [00:00<00:00, 261.23it/s]
Adding requests:  32%|███▏      | 82/256 [00:00<00:00, 274.23it/s]
Adding requests:  43%|████▎     | 110/256 [00:00<00:00, 271.27it/s]
Adding requests:  54%|█████▍    | 138/256 [00:00<00:00, 267.80it/s]
Adding requests:  65%|██████▍   | 166/256 [00:00<00:00, 269.69it/s]
Adding requests:  77%|███████▋  | 196/256 [00:00<00:00, 279.21it/s]
Adding requests:  88%|████████▊ | 224/256 [00:00<00:00, 275.87it/s]
Adding requests:  99%|█████████▉| 254/256 [00:00<00:00, 280.07it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 274.44it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▌         | 14/256 [00:00<00:03, 62.95it/s, est. speed input: 64469.64 toks/s, output: 62.95 toks/s]
Processed prompts:   8%|▊         | 21/256 [00:00<00:08, 27.79it/s, est. speed input: 32038.87 toks/s, output: 31.29 toks/s]
Processed prompts:  10%|▉         | 25/256 [00:00<00:10, 21.83it/s, est. speed input: 26390.50 toks/s, output: 25.77 toks/s]
Processed prompts:  11%|█         | 28/256 [00:01<00:13, 17.43it/s, est. speed input: 22578.96 toks/s, output: 22.05 toks/s]
Processed prompts:  12%|█▏        | 30/256 [00:01<00:13, 16.60it/s, est. speed input: 21658.91 toks/s, output: 21.15 toks/s]
Processed prompts:  12%|█▎        | 32/256 [00:01<00:14, 15.87it/s, est. speed input: 20905.56 toks/s, output: 20.42 toks/s]
Processed prompts:  13%|█▎        | 34/256 [00:01<00:14, 15.23it/s, est. speed input: 20269.39 toks/s, output: 19.79 toks/s]
Processed prompts:  14%|█▍        | 36/256 [00:01<00:14, 14.72it/s, est. speed input: 19734.06 toks/s, output: 19.27 toks/s]
Processed prompts:  15%|█▍        | 38/256 [00:02<00:15, 14.35it/s, est. speed input: 19283.57 toks/s, output: 18.83 toks/s]
Processed prompts:  16%|█▌        | 40/256 [00:02<00:15, 14.03it/s, est. speed input: 18882.32 toks/s, output: 18.44 toks/s]
Processed prompts:  16%|█▋        | 42/256 [00:02<00:15, 13.88it/s, est. speed input: 18557.90 toks/s, output: 18.12 toks/s]
Processed prompts:  17%|█▋        | 44/256 [00:02<00:15, 13.75it/s, est. speed input: 18267.59 toks/s, output: 17.84 toks/s]
Processed prompts:  18%|█▊        | 46/256 [00:02<00:15, 13.62it/s, est. speed input: 18002.53 toks/s, output: 17.58 toks/s]
Processed prompts:  19%|█▉        | 48/256 [00:02<00:15, 13.55it/s, est. speed input: 17768.74 toks/s, output: 17.35 toks/s]
Processed prompts:  20%|█▉        | 50/256 [00:02<00:15, 13.49it/s, est. speed input: 17558.90 toks/s, output: 17.15 toks/s]
Processed prompts:  20%|██        | 52/256 [00:03<00:15, 13.44it/s, est. speed input: 17367.22 toks/s, output: 16.96 toks/s]
Processed prompts:  21%|██        | 54/256 [00:03<00:15, 13.42it/s, est. speed input: 17197.06 toks/s, output: 16.79 toks/s]
Processed prompts:  22%|██▏       | 56/256 [00:03<00:14, 13.40it/s, est. speed input: 17040.24 toks/s, output: 16.64 toks/s]
Processed prompts:  23%|██▎       | 58/256 [00:03<00:14, 13.37it/s, est. speed input: 16894.05 toks/s, output: 16.50 toks/s]
Processed prompts:  23%|██▎       | 60/256 [00:03<00:14, 13.38it/s, est. speed input: 16764.49 toks/s, output: 16.37 toks/s]
Processed prompts:  24%|██▍       | 62/256 [00:03<00:14, 13.38it/s, est. speed input: 16644.19 toks/s, output: 16.25 toks/s]
Processed prompts:  25%|██▌       | 64/256 [00:03<00:14, 13.35it/s, est. speed input: 16528.95 toks/s, output: 16.14 toks/s]
Processed prompts:  26%|██▌       | 66/256 [00:04<00:14, 13.36it/s, est. speed input: 16426.25 toks/s, output: 16.04 toks/s]
Processed prompts:  27%|██▋       | 68/256 [00:04<00:14, 13.35it/s, est. speed input: 16327.83 toks/s, output: 15.95 toks/s]
Processed prompts:  27%|██▋       | 70/256 [00:04<00:13, 13.35it/s, est. speed input: 16238.04 toks/s, output: 15.86 toks/s]
Processed prompts:  28%|██▊       | 72/256 [00:04<00:13, 13.35it/s, est. speed input: 16153.48 toks/s, output: 15.77 toks/s]
Processed prompts:  29%|██▉       | 74/256 [00:04<00:13, 13.35it/s, est. speed input: 16074.53 toks/s, output: 15.70 toks/s]
Processed prompts:  30%|██▉       | 76/256 [00:04<00:13, 13.34it/s, est. speed input: 15999.48 toks/s, output: 15.62 toks/s]
Processed prompts:  30%|███       | 78/256 [00:05<00:13, 13.35it/s, est. speed input: 15930.92 toks/s, output: 15.56 toks/s]
Processed prompts:  31%|███▏      | 80/256 [00:05<00:13, 13.36it/s, est. speed input: 15866.13 toks/s, output: 15.49 toks/s]
Processed prompts:  32%|███▏      | 82/256 [00:05<00:13, 13.36it/s, est. speed input: 15804.35 toks/s, output: 15.43 toks/s]
Processed prompts:  33%|███▎      | 84/256 [00:05<00:12, 13.35it/s, est. speed input: 15745.50 toks/s, output: 15.38 toks/s]
Processed prompts:  34%|███▎      | 86/256 [00:05<00:12, 13.34it/s, est. speed input: 15689.14 toks/s, output: 15.32 toks/s]
Processed prompts:  34%|███▍      | 88/256 [00:05<00:12, 13.35it/s, est. speed input: 15637.64 toks/s, output: 15.27 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:05<00:12, 13.34it/s, est. speed input: 15586.67 toks/s, output: 15.22 toks/s]
Processed prompts:  36%|███▌      | 92/256 [00:06<00:12, 13.33it/s, est. speed input: 15537.69 toks/s, output: 15.17 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:06<00:12, 13.34it/s, est. speed input: 15492.78 toks/s, output: 15.13 toks/s]
Processed prompts:  38%|███▊      | 96/256 [00:06<00:12, 13.33it/s, est. speed input: 15448.87 toks/s, output: 15.09 toks/s]
Processed prompts:  38%|███▊      | 98/256 [00:06<00:11, 13.34it/s, est. speed input: 15408.22 toks/s, output: 15.05 toks/s]
Processed prompts:  39%|███▉      | 100/256 [00:06<00:11, 13.33it/s, est. speed input: 15368.40 toks/s, output: 15.01 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:06<00:11, 13.35it/s, est. speed input: 15332.46 toks/s, output: 14.97 toks/s]
Processed prompts:  41%|████      | 104/256 [00:06<00:11, 13.37it/s, est. speed input: 15298.10 toks/s, output: 14.94 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:07<00:11, 13.33it/s, est. speed input: 15261.07 toks/s, output: 14.90 toks/s]
Processed prompts:  42%|████▏     | 108/256 [00:07<00:11, 13.33it/s, est. speed input: 15227.93 toks/s, output: 14.87 toks/s]
Processed prompts:  43%|████▎     | 110/256 [00:07<00:10, 13.33it/s, est. speed input: 15195.60 toks/s, output: 14.84 toks/s]
Processed prompts:  44%|████▍     | 112/256 [00:07<00:10, 13.33it/s, est. speed input: 15165.04 toks/s, output: 14.81 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:07<00:10, 13.34it/s, est. speed input: 15136.50 toks/s, output: 14.78 toks/s]
Processed prompts:  45%|████▌     | 116/256 [00:07<00:10, 13.34it/s, est. speed input: 15108.07 toks/s, output: 14.75 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:08<00:10, 13.32it/s, est. speed input: 15079.49 toks/s, output: 14.73 toks/s]
Processed prompts:  47%|████▋     | 120/256 [00:08<00:10, 13.32it/s, est. speed input: 15053.46 toks/s, output: 14.70 toks/s]
Processed prompts:  48%|████▊     | 122/256 [00:08<00:10, 13.33it/s, est. speed input: 15028.58 toks/s, output: 14.68 toks/s]
Processed prompts:  48%|████▊     | 124/256 [00:08<00:09, 13.32it/s, est. speed input: 15003.57 toks/s, output: 14.65 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:08<00:09, 13.32it/s, est. speed input: 14979.64 toks/s, output: 14.63 toks/s]
Processed prompts:  50%|█████     | 128/256 [00:08<00:09, 13.32it/s, est. speed input: 14956.91 toks/s, output: 14.61 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:08<00:09, 13.32it/s, est. speed input: 14934.51 toks/s, output: 14.58 toks/s]
Processed prompts:  52%|█████▏    | 132/256 [00:09<00:09, 13.33it/s, est. speed input: 14913.41 toks/s, output: 14.56 toks/s]
Processed prompts:  52%|█████▏    | 134/256 [00:09<00:09, 13.34it/s, est. speed input: 14893.76 toks/s, output: 14.54 toks/s]
Processed prompts:  53%|█████▎    | 136/256 [00:09<00:09, 13.32it/s, est. speed input: 14872.78 toks/s, output: 14.52 toks/s]
Processed prompts:  54%|█████▍    | 138/256 [00:09<00:08, 13.31it/s, est. speed input: 14852.58 toks/s, output: 14.50 toks/s]
Processed prompts:  55%|█████▍    | 140/256 [00:09<00:08, 13.33it/s, est. speed input: 14835.07 toks/s, output: 14.49 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:09<00:08, 13.32it/s, est. speed input: 14816.37 toks/s, output: 14.47 toks/s]
Processed prompts:  56%|█████▋    | 144/256 [00:09<00:08, 13.32it/s, est. speed input: 14798.58 toks/s, output: 14.45 toks/s]
Processed prompts:  57%|█████▋    | 146/256 [00:10<00:08, 13.31it/s, est. speed input: 14780.51 toks/s, output: 14.43 toks/s]
Processed prompts:  58%|█████▊    | 148/256 [00:10<00:08, 13.31it/s, est. speed input: 14763.95 toks/s, output: 14.42 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:10<00:07, 13.31it/s, est. speed input: 14747.41 toks/s, output: 14.40 toks/s]
Processed prompts:  59%|█████▉    | 152/256 [00:10<00:07, 13.32it/s, est. speed input: 14731.92 toks/s, output: 14.39 toks/s]
Processed prompts:  60%|██████    | 154/256 [00:10<00:07, 13.30it/s, est. speed input: 14715.79 toks/s, output: 14.37 toks/s]
Processed prompts:  61%|██████    | 156/256 [00:10<00:07, 13.32it/s, est. speed input: 14701.34 toks/s, output: 14.36 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:11<00:07, 13.31it/s, est. speed input: 14686.40 toks/s, output: 14.34 toks/s]
Processed prompts:  62%|██████▎   | 160/256 [00:11<00:07, 13.30it/s, est. speed input: 14671.59 toks/s, output: 14.33 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:11<00:07, 13.30it/s, est. speed input: 14657.97 toks/s, output: 14.31 toks/s]
Processed prompts:  64%|██████▍   | 164/256 [00:11<00:06, 13.32it/s, est. speed input: 14644.99 toks/s, output: 14.30 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:11<00:06, 13.32it/s, est. speed input: 14632.27 toks/s, output: 14.29 toks/s]
Processed prompts:  66%|██████▌   | 168/256 [00:11<00:06, 13.32it/s, est. speed input: 14619.62 toks/s, output: 14.28 toks/s]
Processed prompts:  66%|██████▋   | 170/256 [00:11<00:06, 13.31it/s, est. speed input: 14606.69 toks/s, output: 14.26 toks/s]
Processed prompts:  67%|██████▋   | 172/256 [00:12<00:06, 13.27it/s, est. speed input: 14592.84 toks/s, output: 14.25 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:12<00:06, 13.27it/s, est. speed input: 14580.39 toks/s, output: 14.24 toks/s]
Processed prompts:  69%|██████▉   | 176/256 [00:12<00:06, 13.27it/s, est. speed input: 14568.50 toks/s, output: 14.23 toks/s]
Processed prompts:  70%|██████▉   | 178/256 [00:12<00:05, 13.30it/s, est. speed input: 14557.79 toks/s, output: 14.22 toks/s]
Processed prompts:  70%|███████   | 180/256 [00:12<00:05, 13.30it/s, est. speed input: 14546.84 toks/s, output: 14.21 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:12<00:05, 13.30it/s, est. speed input: 14535.67 toks/s, output: 14.19 toks/s]
Processed prompts:  72%|███████▏  | 184/256 [00:12<00:05, 13.30it/s, est. speed input: 14525.09 toks/s, output: 14.18 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:13<00:05, 13.28it/s, est. speed input: 14513.87 toks/s, output: 14.17 toks/s]
Processed prompts:  73%|███████▎  | 188/256 [00:13<00:05, 13.30it/s, est. speed input: 14504.34 toks/s, output: 14.16 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:13<00:04, 13.31it/s, est. speed input: 14494.69 toks/s, output: 14.15 toks/s]
Processed prompts:  75%|███████▌  | 192/256 [00:13<00:04, 13.31it/s, est. speed input: 14485.10 toks/s, output: 14.15 toks/s]
Processed prompts:  76%|███████▌  | 194/256 [00:13<00:04, 13.31it/s, est. speed input: 14475.68 toks/s, output: 14.14 toks/s]
Processed prompts:  77%|███████▋  | 196/256 [00:13<00:04, 13.30it/s, est. speed input: 14466.21 toks/s, output: 14.13 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:14<00:04, 13.32it/s, est. speed input: 14458.05 toks/s, output: 14.12 toks/s]
Processed prompts:  78%|███████▊  | 200/256 [00:14<00:04, 13.30it/s, est. speed input: 14448.43 toks/s, output: 14.11 toks/s]
Processed prompts:  80%|███████▉  | 204/256 [00:14<00:03, 14.63it/s, est. speed input: 14490.44 toks/s, output: 14.15 toks/s]
Processed prompts:  80%|████████  | 206/256 [00:14<00:03, 14.27it/s, est. speed input: 14481.44 toks/s, output: 14.14 toks/s]
Processed prompts:  81%|████████▏ | 208/256 [00:14<00:03, 14.00it/s, est. speed input: 14472.39 toks/s, output: 14.13 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:14<00:03, 13.78it/s, est. speed input: 14463.04 toks/s, output: 14.12 toks/s]
Processed prompts:  83%|████████▎ | 212/256 [00:15<00:03, 13.64it/s, est. speed input: 14454.57 toks/s, output: 14.12 toks/s]
Processed prompts:  84%|████████▎ | 214/256 [00:15<00:03, 13.53it/s, est. speed input: 14445.65 toks/s, output: 14.11 toks/s]
Processed prompts:  84%|████████▍ | 216/256 [00:15<00:02, 13.46it/s, est. speed input: 14437.69 toks/s, output: 14.10 toks/s]
Processed prompts:  85%|████████▌ | 218/256 [00:15<00:02, 13.41it/s, est. speed input: 14429.57 toks/s, output: 14.09 toks/s]
Processed prompts:  86%|████████▌ | 220/256 [00:15<00:02, 13.38it/s, est. speed input: 14421.97 toks/s, output: 14.08 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:15<00:02, 13.35it/s, est. speed input: 14414.07 toks/s, output: 14.08 toks/s]
Processed prompts:  88%|████████▊ | 224/256 [00:15<00:02, 13.32it/s, est. speed input: 14406.08 toks/s, output: 14.07 toks/s]
Processed prompts:  88%|████████▊ | 226/256 [00:16<00:02, 13.29it/s, est. speed input: 14397.81 toks/s, output: 14.06 toks/s]
Processed prompts:  89%|████████▉ | 228/256 [00:16<00:02, 13.29it/s, est. speed input: 14390.41 toks/s, output: 14.05 toks/s]
Processed prompts:  90%|████████▉ | 230/256 [00:16<00:01, 13.28it/s, est. speed input: 14383.07 toks/s, output: 14.05 toks/s]
Processed prompts:  91%|█████████ | 232/256 [00:16<00:01, 13.30it/s, est. speed input: 14376.64 toks/s, output: 14.04 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:16<00:01, 13.30it/s, est. speed input: 14369.61 toks/s, output: 14.03 toks/s]
Processed prompts:  92%|█████████▏| 236/256 [00:16<00:01, 13.27it/s, est. speed input: 14361.87 toks/s, output: 14.03 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:16<00:01, 13.30it/s, est. speed input: 14355.92 toks/s, output: 14.02 toks/s]
Processed prompts:  94%|█████████▍| 240/256 [00:17<00:01, 13.26it/s, est. speed input: 14348.38 toks/s, output: 14.01 toks/s]
Processed prompts:  95%|█████████▍| 242/256 [00:17<00:01, 13.29it/s, est. speed input: 14342.47 toks/s, output: 14.01 toks/s]
Processed prompts:  95%|█████████▌| 244/256 [00:17<00:00, 13.28it/s, est. speed input: 14335.81 toks/s, output: 14.00 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:17<00:00, 13.25it/s, est. speed input: 14328.47 toks/s, output: 13.99 toks/s]
Processed prompts:  97%|█████████▋| 248/256 [00:17<00:00, 13.26it/s, est. speed input: 14322.46 toks/s, output: 13.99 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:17<00:00, 13.26it/s, est. speed input: 14316.07 toks/s, output: 13.98 toks/s]
Processed prompts:  98%|█████████▊| 252/256 [00:18<00:00, 13.25it/s, est. speed input: 14309.53 toks/s, output: 13.97 toks/s]
Processed prompts:  99%|█████████▉| 254/256 [00:18<00:00, 13.22it/s, est. speed input: 14302.58 toks/s, output: 13.97 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:18<00:00, 13.22it/s, est. speed input: 14348.60 toks/s, output: 14.01 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:18<00:00, 14.01it/s, est. speed input: 14348.60 toks/s, output: 14.01 toks/s]
[rank0]:[W125 22:38:56.021243599 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=4096 ==========
Time: 2026-01-25 22:38:58
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=512, max_num_seqs=4
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 512 --max-num-seqs 4 --max-model-len 1025 --max-num-batched-tokens 4096 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-14B-INT8_M4096.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 22:39:09 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=535492) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=535492) WARNING 01-25 22:39:35 [backends.py:609] Failed to read file <frozen os>
Throughput: 13.73 requests/s, 14072.92 total tokens/s, 13.73 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512

STDERR:
[2026-01-25 22:39:09] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 22:39:09] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-25 22:39:09] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-25 22:39:09] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:39:09] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:39:09] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:39:09] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:39:09] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:39:09] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-25 22:39:09] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 22:39:09] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 22:39:09] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 22:39:09] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 22:39:09] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 22:39:17] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 22:39:17] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-25 22:39:17] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-25 22:39:17] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:39:17] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:39:17] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:39:17] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:39:17] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:39:17] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-25 22:39:17] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 22:39:17] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 22:39:17] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 22:39:17] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 22:39:17] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=535492) [2026-01-25 22:39:18] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=535492) [2026-01-25 22:39:18] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=535492) [2026-01-25 22:39:18] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=535492) [2026-01-25 22:39:18] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=535492) [2026-01-25 22:39:18] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=535492) [2026-01-25 22:39:18] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=535492) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=535492) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.25it/s]
(EngineCore_DP0 pid=535492) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.81it/s]
(EngineCore_DP0 pid=535492) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.47it/s]
(EngineCore_DP0 pid=535492) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.28it/s]
(EngineCore_DP0 pid=535492) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.36it/s]
(EngineCore_DP0 pid=535492) 
(EngineCore_DP0 pid=535492) [2026-01-25 22:39:21] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 7680] -> 1D uint8
(EngineCore_DP0 pid=535492) [2026-01-25 22:39:21] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 41287680 bytes
(EngineCore_DP0 pid=535492) [2026-01-25 22:39:21] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 7680] -> 1D uint8
(EngineCore_DP0 pid=535492) [2026-01-25 22:39:21] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 29491200 bytes
(EngineCore_DP0 pid=535492) [2026-01-25 22:39:22] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 7680] -> 1D uint8
(EngineCore_DP0 pid=535492) [2026-01-25 22:39:22] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 159252480 bytes
(EngineCore_DP0 pid=535492) [2026-01-25 22:39:22] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 20736] -> 1D uint8
(EngineCore_DP0 pid=535492) [2026-01-25 22:39:22] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 79626240 bytes
(EngineCore_DP0 pid=535492) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  25%|██▌       | 1/4 [00:00<00:00,  6.53it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 2/4 [00:00<00:00,  6.88it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  75%|███████▌  | 3/4 [00:00<00:00,  6.84it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  6.55it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  6.64it/s]
(EngineCore_DP0 pid=535492) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  33%|███▎      | 1/3 [00:00<00:00,  6.21it/s]
Capturing CUDA graphs (decode, FULL):  67%|██████▋   | 2/3 [00:00<00:00,  6.53it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  6.77it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  6.66it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   5%|▌         | 27/512 [00:00<00:01, 265.39it/s]
Adding requests:  11%|█         | 57/512 [00:00<00:01, 282.30it/s]
Adding requests:  17%|█▋        | 86/512 [00:00<00:01, 283.26it/s]
Adding requests:  22%|██▏       | 115/512 [00:00<00:01, 276.35it/s]
Adding requests:  28%|██▊       | 144/512 [00:00<00:01, 277.90it/s]
Adding requests:  34%|███▎      | 172/512 [00:00<00:01, 278.21it/s]
Adding requests:  39%|███▉      | 202/512 [00:00<00:01, 284.78it/s]
Adding requests:  46%|████▌     | 233/512 [00:00<00:00, 291.37it/s]
Adding requests:  51%|█████▏    | 263/512 [00:00<00:00, 290.97it/s]
Adding requests:  57%|█████▋    | 293/512 [00:01<00:00, 292.71it/s]
Adding requests:  63%|██████▎   | 323/512 [00:01<00:00, 293.98it/s]
Adding requests:  69%|██████▉   | 353/512 [00:01<00:00, 290.41it/s]
Adding requests:  75%|███████▍  | 383/512 [00:01<00:00, 287.65it/s]
Adding requests:  81%|████████  | 413/512 [00:01<00:00, 290.53it/s]
Adding requests:  87%|████████▋ | 443/512 [00:01<00:00, 289.97it/s]
Adding requests:  92%|█████████▏| 473/512 [00:01<00:00, 288.16it/s]
Adding requests:  99%|█████████▊| 505/512 [00:01<00:00, 297.42it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 289.01it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▌         | 26/512 [00:00<00:06, 73.58it/s, est. speed input: 75346.74 toks/s, output: 73.58 toks/s]
Processed prompts:   7%|▋         | 34/512 [00:00<00:15, 31.74it/s, est. speed input: 37379.13 toks/s, output: 36.50 toks/s]
Processed prompts:   7%|▋         | 38/512 [00:01<00:18, 25.79it/s, est. speed input: 31895.24 toks/s, output: 31.15 toks/s]
Processed prompts:   8%|▊         | 42/512 [00:01<00:21, 21.88it/s, est. speed input: 28463.19 toks/s, output: 27.80 toks/s]
Processed prompts:   9%|▉         | 46/512 [00:01<00:24, 19.34it/s, est. speed input: 26165.65 toks/s, output: 25.55 toks/s]
Processed prompts:  10%|▉         | 50/512 [00:02<00:26, 17.63it/s, est. speed input: 24500.54 toks/s, output: 23.93 toks/s]
Processed prompts:  11%|█         | 54/512 [00:02<00:27, 16.45it/s, est. speed input: 23236.58 toks/s, output: 22.69 toks/s]
Processed prompts:  11%|█▏        | 58/512 [00:02<00:29, 15.65it/s, est. speed input: 22254.64 toks/s, output: 21.73 toks/s]
Processed prompts:  12%|█▏        | 62/512 [00:02<00:29, 15.10it/s, est. speed input: 21465.45 toks/s, output: 20.96 toks/s]
Processed prompts:  13%|█▎        | 66/512 [00:03<00:30, 14.69it/s, est. speed input: 20803.57 toks/s, output: 20.32 toks/s]
Processed prompts:  14%|█▎        | 70/512 [00:03<00:30, 14.43it/s, est. speed input: 20258.80 toks/s, output: 19.78 toks/s]
Processed prompts:  14%|█▍        | 74/512 [00:03<00:30, 14.24it/s, est. speed input: 19794.00 toks/s, output: 19.33 toks/s]
Processed prompts:  15%|█▌        | 78/512 [00:04<00:30, 14.08it/s, est. speed input: 19388.97 toks/s, output: 18.93 toks/s]
Processed prompts:  16%|█▌        | 82/512 [00:04<00:30, 14.00it/s, est. speed input: 19042.86 toks/s, output: 18.60 toks/s]
Processed prompts:  17%|█▋        | 86/512 [00:04<00:30, 13.94it/s, est. speed input: 18741.19 toks/s, output: 18.30 toks/s]
Processed prompts:  18%|█▊        | 90/512 [00:04<00:30, 13.90it/s, est. speed input: 18472.59 toks/s, output: 18.04 toks/s]
Processed prompts:  18%|█▊        | 94/512 [00:05<00:30, 13.85it/s, est. speed input: 18229.35 toks/s, output: 17.80 toks/s]
Processed prompts:  19%|█▉        | 98/512 [00:05<00:29, 13.83it/s, est. speed input: 18015.45 toks/s, output: 17.59 toks/s]
Processed prompts:  20%|█▉        | 102/512 [00:05<00:29, 13.82it/s, est. speed input: 17823.26 toks/s, output: 17.41 toks/s]
Processed prompts:  21%|██        | 106/512 [00:06<00:29, 13.81it/s, est. speed input: 17648.37 toks/s, output: 17.23 toks/s]
Processed prompts:  21%|██▏       | 110/512 [00:06<00:29, 13.80it/s, est. speed input: 17488.91 toks/s, output: 17.08 toks/s]
Processed prompts:  22%|██▏       | 114/512 [00:06<00:28, 13.80it/s, est. speed input: 17344.78 toks/s, output: 16.94 toks/s]
Processed prompts:  23%|██▎       | 118/512 [00:07<00:28, 13.78it/s, est. speed input: 17208.38 toks/s, output: 16.80 toks/s]
Processed prompts:  24%|██▍       | 122/512 [00:07<00:28, 13.78it/s, est. speed input: 17084.87 toks/s, output: 16.68 toks/s]
Processed prompts:  25%|██▍       | 126/512 [00:07<00:28, 13.77it/s, est. speed input: 16969.62 toks/s, output: 16.57 toks/s]
Processed prompts:  25%|██▌       | 130/512 [00:07<00:27, 13.77it/s, est. speed input: 16864.96 toks/s, output: 16.47 toks/s]
Processed prompts:  26%|██▌       | 134/512 [00:08<00:27, 13.78it/s, est. speed input: 16767.69 toks/s, output: 16.37 toks/s]
Processed prompts:  27%|██▋       | 138/512 [00:08<00:27, 13.76it/s, est. speed input: 16673.78 toks/s, output: 16.28 toks/s]
Processed prompts:  28%|██▊       | 142/512 [00:08<00:26, 13.75it/s, est. speed input: 16587.40 toks/s, output: 16.20 toks/s]
Processed prompts:  29%|██▊       | 146/512 [00:09<00:26, 13.76it/s, est. speed input: 16507.66 toks/s, output: 16.12 toks/s]
Processed prompts:  29%|██▉       | 150/512 [00:09<00:26, 13.78it/s, est. speed input: 16434.91 toks/s, output: 16.05 toks/s]
Processed prompts:  30%|███       | 154/512 [00:09<00:26, 13.77it/s, est. speed input: 16363.34 toks/s, output: 15.98 toks/s]
Processed prompts:  31%|███       | 158/512 [00:09<00:25, 13.76it/s, est. speed input: 16296.39 toks/s, output: 15.91 toks/s]
Processed prompts:  32%|███▏      | 162/512 [00:10<00:25, 13.76it/s, est. speed input: 16233.04 toks/s, output: 15.85 toks/s]
Processed prompts:  32%|███▏      | 166/512 [00:10<00:25, 13.77it/s, est. speed input: 16175.50 toks/s, output: 15.80 toks/s]
Processed prompts:  33%|███▎      | 170/512 [00:10<00:24, 13.75it/s, est. speed input: 16117.62 toks/s, output: 15.74 toks/s]
Processed prompts:  34%|███▍      | 174/512 [00:11<00:24, 13.76it/s, est. speed input: 16065.16 toks/s, output: 15.69 toks/s]
Processed prompts:  35%|███▍      | 178/512 [00:11<00:24, 13.77it/s, est. speed input: 16015.36 toks/s, output: 15.64 toks/s]
Processed prompts:  36%|███▌      | 182/512 [00:11<00:23, 13.76it/s, est. speed input: 15966.90 toks/s, output: 15.59 toks/s]
Processed prompts:  36%|███▋      | 186/512 [00:11<00:23, 13.76it/s, est. speed input: 15920.97 toks/s, output: 15.55 toks/s]
Processed prompts:  37%|███▋      | 190/512 [00:12<00:23, 13.75it/s, est. speed input: 15876.95 toks/s, output: 15.50 toks/s]
Processed prompts:  38%|███▊      | 194/512 [00:12<00:23, 13.75it/s, est. speed input: 15835.26 toks/s, output: 15.46 toks/s]
Processed prompts:  39%|███▊      | 198/512 [00:12<00:22, 13.75it/s, est. speed input: 15795.45 toks/s, output: 15.43 toks/s]
Processed prompts:  39%|███▉      | 202/512 [00:13<00:21, 14.66it/s, est. speed input: 15829.84 toks/s, output: 15.46 toks/s]
Processed prompts:  40%|████      | 206/512 [00:13<00:21, 14.36it/s, est. speed input: 15791.05 toks/s, output: 15.42 toks/s]
Processed prompts:  41%|████      | 210/512 [00:13<00:21, 14.17it/s, est. speed input: 15754.13 toks/s, output: 15.38 toks/s]
Processed prompts:  42%|████▏     | 214/512 [00:13<00:21, 14.03it/s, est. speed input: 15718.17 toks/s, output: 15.35 toks/s]
Processed prompts:  43%|████▎     | 218/512 [00:14<00:21, 13.94it/s, est. speed input: 15684.57 toks/s, output: 15.32 toks/s]
Processed prompts:  43%|████▎     | 222/512 [00:14<00:20, 13.87it/s, est. speed input: 15651.11 toks/s, output: 15.28 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:14<00:20, 13.82it/s, est. speed input: 15619.82 toks/s, output: 15.25 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:15<00:20, 13.80it/s, est. speed input: 15590.34 toks/s, output: 15.22 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:15<00:20, 13.78it/s, est. speed input: 15561.36 toks/s, output: 15.20 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:15<00:19, 13.75it/s, est. speed input: 15532.62 toks/s, output: 15.17 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:15<00:19, 13.74it/s, est. speed input: 15505.10 toks/s, output: 15.14 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:16<00:19, 13.73it/s, est. speed input: 15478.77 toks/s, output: 15.12 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:16<00:19, 13.74it/s, est. speed input: 15454.28 toks/s, output: 15.09 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:16<00:18, 13.71it/s, est. speed input: 15428.65 toks/s, output: 15.07 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:17<00:18, 13.71it/s, est. speed input: 15405.18 toks/s, output: 15.04 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:17<00:18, 13.72it/s, est. speed input: 15382.79 toks/s, output: 15.02 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:17<00:17, 13.71it/s, est. speed input: 15360.50 toks/s, output: 15.00 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:18<00:17, 13.71it/s, est. speed input: 15339.11 toks/s, output: 14.98 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:18<00:17, 13.71it/s, est. speed input: 15318.34 toks/s, output: 14.96 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:18<00:17, 13.73it/s, est. speed input: 15299.27 toks/s, output: 14.94 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:18<00:16, 13.70it/s, est. speed input: 15278.75 toks/s, output: 14.92 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:19<00:16, 13.70it/s, est. speed input: 15259.73 toks/s, output: 14.90 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:19<00:16, 13.70it/s, est. speed input: 15241.05 toks/s, output: 14.88 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:19<00:15, 13.71it/s, est. speed input: 15223.70 toks/s, output: 14.87 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:20<00:15, 13.70it/s, est. speed input: 15206.08 toks/s, output: 14.85 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:20<00:15, 13.70it/s, est. speed input: 15189.02 toks/s, output: 14.83 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:20<00:15, 13.71it/s, est. speed input: 15173.04 toks/s, output: 14.82 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:20<00:14, 13.69it/s, est. speed input: 15156.32 toks/s, output: 14.80 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:21<00:14, 13.69it/s, est. speed input: 15140.47 toks/s, output: 14.79 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:21<00:14, 13.69it/s, est. speed input: 15125.56 toks/s, output: 14.77 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:21<00:13, 13.68it/s, est. speed input: 15110.28 toks/s, output: 14.76 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:22<00:13, 13.69it/s, est. speed input: 15096.13 toks/s, output: 14.74 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:22<00:13, 13.69it/s, est. speed input: 15082.23 toks/s, output: 14.73 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:22<00:13, 13.69it/s, est. speed input: 15068.48 toks/s, output: 14.72 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:22<00:12, 13.70it/s, est. speed input: 15055.53 toks/s, output: 14.70 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:23<00:12, 13.69it/s, est. speed input: 15042.32 toks/s, output: 14.69 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:23<00:12, 13.70it/s, est. speed input: 15029.88 toks/s, output: 14.68 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:23<00:11, 13.68it/s, est. speed input: 15017.01 toks/s, output: 14.67 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:24<00:11, 13.70it/s, est. speed input: 15005.41 toks/s, output: 14.65 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:24<00:11, 13.70it/s, est. speed input: 14993.75 toks/s, output: 14.64 toks/s]
Processed prompts:  71%|███████   | 362/512 [00:24<00:10, 13.68it/s, est. speed input: 14981.72 toks/s, output: 14.63 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:25<00:10, 13.69it/s, est. speed input: 14970.56 toks/s, output: 14.62 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [00:25<00:10, 13.69it/s, est. speed input: 14959.52 toks/s, output: 14.61 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [00:25<00:10, 13.67it/s, est. speed input: 14948.14 toks/s, output: 14.60 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [00:25<00:09, 13.67it/s, est. speed input: 14937.51 toks/s, output: 14.59 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [00:26<00:09, 13.68it/s, est. speed input: 14927.19 toks/s, output: 14.58 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [00:26<00:09, 13.69it/s, est. speed input: 14917.44 toks/s, output: 14.57 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [00:26<00:08, 13.67it/s, est. speed input: 14907.02 toks/s, output: 14.56 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [00:27<00:08, 13.68it/s, est. speed input: 14897.59 toks/s, output: 14.55 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [00:27<00:08, 13.68it/s, est. speed input: 14887.99 toks/s, output: 14.54 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [00:27<00:08, 13.67it/s, est. speed input: 14878.37 toks/s, output: 14.53 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [00:27<00:07, 13.66it/s, est. speed input: 14868.68 toks/s, output: 14.52 toks/s]
Processed prompts:  80%|████████  | 410/512 [00:28<00:07, 13.69it/s, est. speed input: 14860.62 toks/s, output: 14.51 toks/s]
Processed prompts:  81%|████████  | 414/512 [00:28<00:07, 13.67it/s, est. speed input: 14851.19 toks/s, output: 14.50 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [00:28<00:06, 13.65it/s, est. speed input: 14841.94 toks/s, output: 14.49 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [00:29<00:06, 13.66it/s, est. speed input: 14833.57 toks/s, output: 14.49 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [00:29<00:06, 13.66it/s, est. speed input: 14825.22 toks/s, output: 14.48 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [00:29<00:06, 13.64it/s, est. speed input: 14816.39 toks/s, output: 14.47 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [00:30<00:05, 13.65it/s, est. speed input: 14808.26 toks/s, output: 14.46 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [00:30<00:05, 13.65it/s, est. speed input: 14800.10 toks/s, output: 14.45 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [00:30<00:05, 13.66it/s, est. speed input: 14792.78 toks/s, output: 14.45 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [00:30<00:04, 13.63it/s, est. speed input: 14784.14 toks/s, output: 14.44 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [00:31<00:04, 13.64it/s, est. speed input: 14776.52 toks/s, output: 14.43 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [00:31<00:04, 13.64it/s, est. speed input: 14768.97 toks/s, output: 14.42 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [00:31<00:03, 13.64it/s, est. speed input: 14761.49 toks/s, output: 14.42 toks/s]
Processed prompts:  90%|█████████ | 462/512 [00:32<00:03, 13.63it/s, est. speed input: 14753.88 toks/s, output: 14.41 toks/s]
Processed prompts:  91%|█████████ | 466/512 [00:32<00:03, 13.64it/s, est. speed input: 14746.92 toks/s, output: 14.40 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [00:32<00:03, 13.65it/s, est. speed input: 14740.39 toks/s, output: 14.39 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [00:32<00:02, 13.64it/s, est. speed input: 14733.12 toks/s, output: 14.39 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [00:33<00:02, 13.64it/s, est. speed input: 14726.42 toks/s, output: 14.38 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [00:33<00:02, 13.64it/s, est. speed input: 14719.79 toks/s, output: 14.37 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [00:33<00:01, 13.65it/s, est. speed input: 14713.52 toks/s, output: 14.37 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [00:34<00:01, 13.63it/s, est. speed input: 14706.50 toks/s, output: 14.36 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [00:34<00:01, 13.64it/s, est. speed input: 14700.35 toks/s, output: 14.36 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [00:34<00:01, 13.62it/s, est. speed input: 14693.73 toks/s, output: 14.35 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [00:34<00:00, 13.62it/s, est. speed input: 14687.37 toks/s, output: 14.34 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [00:35<00:00, 13.63it/s, est. speed input: 14681.61 toks/s, output: 14.34 toks/s]
Processed prompts: 100%|█████████▉| 510/512 [00:35<00:00, 14.64it/s, est. speed input: 14703.46 toks/s, output: 14.36 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:35<00:00, 14.64it/s, est. speed input: 14761.04 toks/s, output: 14.42 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:35<00:00, 14.42it/s, est. speed input: 14761.04 toks/s, output: 14.42 toks/s]
[rank0]:[W125 22:40:40.676685207 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=8192 ==========
Time: 2026-01-25 22:40:42
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=1024, max_num_seqs=8
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 1024 --max-num-seqs 8 --max-model-len 1025 --max-num-batched-tokens 8192 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-14B-INT8_M8192.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 22:40:56 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=537194) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=537194) WARNING 01-25 22:41:22 [backends.py:609] Failed to read file <frozen os>
Throughput: 13.84 requests/s, 14188.78 total tokens/s, 13.84 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024

STDERR:
[2026-01-25 22:40:56] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 22:40:56] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-25 22:40:56] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-25 22:40:56] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:40:56] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:40:56] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:40:56] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:40:56] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:40:56] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-25 22:40:56] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 22:40:56] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 22:40:56] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 22:40:56] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 22:40:56] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 22:41:04] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 22:41:04] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-25 22:41:04] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-25 22:41:04] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:41:04] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:41:04] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:41:04] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:41:04] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:41:04] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-25 22:41:04] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 22:41:04] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 22:41:04] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 22:41:04] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 22:41:04] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=537194) [2026-01-25 22:41:05] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=537194) [2026-01-25 22:41:05] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=537194) [2026-01-25 22:41:05] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=537194) [2026-01-25 22:41:05] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=537194) [2026-01-25 22:41:05] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=537194) [2026-01-25 22:41:05] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=537194) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=537194) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.26it/s]
(EngineCore_DP0 pid=537194) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.81it/s]
(EngineCore_DP0 pid=537194) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:01<00:00,  1.48it/s]
(EngineCore_DP0 pid=537194) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.30it/s]
(EngineCore_DP0 pid=537194) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.37it/s]
(EngineCore_DP0 pid=537194) 
(EngineCore_DP0 pid=537194) [2026-01-25 22:41:09] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 7680] -> 1D uint8
(EngineCore_DP0 pid=537194) [2026-01-25 22:41:09] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 41287680 bytes
(EngineCore_DP0 pid=537194) [2026-01-25 22:41:09] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 7680] -> 1D uint8
(EngineCore_DP0 pid=537194) [2026-01-25 22:41:09] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 29491200 bytes
(EngineCore_DP0 pid=537194) [2026-01-25 22:41:09] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 7680] -> 1D uint8
(EngineCore_DP0 pid=537194) [2026-01-25 22:41:09] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 159252480 bytes
(EngineCore_DP0 pid=537194) [2026-01-25 22:41:09] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 20736] -> 1D uint8
(EngineCore_DP0 pid=537194) [2026-01-25 22:41:09] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 79626240 bytes
(EngineCore_DP0 pid=537194) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:00,  6.18it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  40%|████      | 2/5 [00:00<00:00,  6.57it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  60%|██████    | 3/5 [00:00<00:00,  6.77it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  80%|████████  | 4/5 [00:00<00:00,  6.95it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00,  6.55it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00,  6.61it/s]
(EngineCore_DP0 pid=537194) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:00,  5.45it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 2/4 [00:00<00:00,  5.96it/s]
Capturing CUDA graphs (decode, FULL):  75%|███████▌  | 3/4 [00:00<00:00,  6.19it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  6.33it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  6.18it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   3%|▎         | 27/1024 [00:00<00:03, 267.71it/s]
Adding requests:   6%|▌         | 58/1024 [00:00<00:03, 289.23it/s]
Adding requests:   9%|▊         | 88/1024 [00:00<00:03, 290.65it/s]
Adding requests:  12%|█▏        | 118/1024 [00:00<00:03, 281.43it/s]
Adding requests:  14%|█▍        | 147/1024 [00:00<00:03, 283.27it/s]
Adding requests:  17%|█▋        | 178/1024 [00:00<00:02, 291.44it/s]
Adding requests:  21%|██        | 211/1024 [00:00<00:02, 302.73it/s]
Adding requests:  24%|██▎       | 242/1024 [00:00<00:02, 297.48it/s]
Adding requests:  27%|██▋       | 272/1024 [00:00<00:02, 290.75it/s]
Adding requests:  30%|██▉       | 303/1024 [00:01<00:02, 294.90it/s]
Adding requests:  33%|███▎      | 333/1024 [00:01<00:02, 294.19it/s]
Adding requests:  35%|███▌      | 363/1024 [00:01<00:02, 295.83it/s]
Adding requests:  38%|███▊      | 393/1024 [00:01<00:02, 291.62it/s]
Adding requests:  41%|████▏     | 424/1024 [00:01<00:02, 296.58it/s]
Adding requests:  44%|████▍     | 454/1024 [00:01<00:01, 288.09it/s]
Adding requests:  48%|████▊     | 488/1024 [00:01<00:01, 302.63it/s]
Adding requests:  51%|█████     | 523/1024 [00:01<00:01, 315.97it/s]
Adding requests:  54%|█████▍    | 555/1024 [00:01<00:01, 310.01it/s]
Adding requests:  57%|█████▋    | 587/1024 [00:01<00:01, 299.21it/s]
Adding requests:  60%|██████    | 618/1024 [00:02<00:01, 301.73it/s]
Adding requests:  63%|██████▎   | 649/1024 [00:02<00:01, 286.59it/s]
Adding requests:  66%|██████▋   | 680/1024 [00:02<00:01, 291.49it/s]
Adding requests:  69%|██████▉   | 711/1024 [00:02<00:01, 295.93it/s]
Adding requests:  72%|███████▏  | 741/1024 [00:02<00:00, 288.55it/s]
Adding requests:  75%|███████▌  | 771/1024 [00:02<00:00, 290.98it/s]
Adding requests:  78%|███████▊  | 802/1024 [00:02<00:00, 295.98it/s]
Adding requests:  82%|████████▏ | 836/1024 [00:02<00:00, 306.40it/s]
Adding requests:  85%|████████▍ | 867/1024 [00:02<00:00, 302.92it/s]
Adding requests:  88%|████████▊ | 898/1024 [00:03<00:00, 302.11it/s]
Adding requests:  91%|█████████ | 929/1024 [00:03<00:00, 295.77it/s]
Adding requests:  94%|█████████▍| 961/1024 [00:03<00:00, 301.92it/s]
Adding requests:  97%|█████████▋| 992/1024 [00:03<00:00, 301.47it/s]
Adding requests: 100%|█████████▉| 1023/1024 [00:03<00:00, 303.78it/s]
Adding requests: 100%|██████████| 1024/1024 [00:03<00:00, 296.80it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▍         | 50/1024 [00:00<00:12, 77.03it/s, est. speed input: 78880.06 toks/s, output: 77.03 toks/s]
Processed prompts:   6%|▌         | 58/1024 [00:01<00:23, 41.93it/s, est. speed input: 48676.73 toks/s, output: 47.53 toks/s]
Processed prompts:   6%|▋         | 66/1024 [00:01<00:32, 29.56it/s, est. speed input: 37729.00 toks/s, output: 36.84 toks/s]
Processed prompts:   7%|▋         | 74/1024 [00:02<00:40, 23.51it/s, est. speed input: 32054.47 toks/s, output: 31.30 toks/s]
Processed prompts:   8%|▊         | 82/1024 [00:02<00:46, 20.12it/s, est. speed input: 28605.84 toks/s, output: 27.94 toks/s]
Processed prompts:   9%|▉         | 90/1024 [00:03<00:51, 18.04it/s, est. speed input: 26272.40 toks/s, output: 25.66 toks/s]
Processed prompts:  10%|▉         | 98/1024 [00:04<00:55, 16.72it/s, est. speed input: 24592.61 toks/s, output: 24.02 toks/s]
Processed prompts:  10%|█         | 106/1024 [00:04<00:57, 15.85it/s, est. speed input: 23327.70 toks/s, output: 22.78 toks/s]
Processed prompts:  11%|█         | 114/1024 [00:05<00:59, 15.25it/s, est. speed input: 22335.38 toks/s, output: 21.81 toks/s]
Processed prompts:  12%|█▏        | 122/1024 [00:05<01:00, 14.86it/s, est. speed input: 21544.08 toks/s, output: 21.04 toks/s]
Processed prompts:  13%|█▎        | 130/1024 [00:06<01:01, 14.59it/s, est. speed input: 20891.61 toks/s, output: 20.40 toks/s]
Processed prompts:  13%|█▎        | 138/1024 [00:06<01:01, 14.40it/s, est. speed input: 20350.34 toks/s, output: 19.87 toks/s]
Processed prompts:  14%|█▍        | 146/1024 [00:07<01:01, 14.27it/s, est. speed input: 19888.58 toks/s, output: 19.42 toks/s]
Processed prompts:  15%|█▌        | 154/1024 [00:08<01:01, 14.17it/s, est. speed input: 19492.17 toks/s, output: 19.04 toks/s]
Processed prompts:  16%|█▌        | 162/1024 [00:08<01:01, 14.12it/s, est. speed input: 19150.06 toks/s, output: 18.70 toks/s]
Processed prompts:  17%|█▋        | 170/1024 [00:09<01:00, 14.05it/s, est. speed input: 18844.16 toks/s, output: 18.40 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [00:09<01:00, 14.03it/s, est. speed input: 18580.75 toks/s, output: 18.15 toks/s]
Processed prompts:  18%|█▊        | 186/1024 [00:10<00:59, 14.00it/s, est. speed input: 18341.15 toks/s, output: 17.91 toks/s]
Processed prompts:  19%|█▉        | 194/1024 [00:10<00:59, 13.98it/s, est. speed input: 18127.00 toks/s, output: 17.70 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [00:11<00:57, 14.41it/s, est. speed input: 18027.96 toks/s, output: 17.61 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:12<00:57, 14.26it/s, est. speed input: 17848.01 toks/s, output: 17.43 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [00:12<00:56, 14.16it/s, est. speed input: 17685.02 toks/s, output: 17.27 toks/s]
Processed prompts:  22%|██▏       | 226/1024 [00:13<00:56, 14.09it/s, est. speed input: 17536.29 toks/s, output: 17.13 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:13<00:56, 14.04it/s, est. speed input: 17400.18 toks/s, output: 16.99 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:14<00:55, 14.00it/s, est. speed input: 17272.97 toks/s, output: 16.87 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:14<00:55, 13.98it/s, est. speed input: 17156.75 toks/s, output: 16.75 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:15<00:54, 13.94it/s, est. speed input: 17046.10 toks/s, output: 16.65 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:16<00:54, 13.93it/s, est. speed input: 16946.36 toks/s, output: 16.55 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:16<00:53, 13.93it/s, est. speed input: 16852.97 toks/s, output: 16.46 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:17<00:53, 13.92it/s, est. speed input: 16765.85 toks/s, output: 16.37 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:17<00:52, 13.91it/s, est. speed input: 16682.86 toks/s, output: 16.29 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:18<00:52, 13.90it/s, est. speed input: 16606.04 toks/s, output: 16.22 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:18<00:51, 13.89it/s, est. speed input: 16532.04 toks/s, output: 16.14 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:19<00:51, 13.90it/s, est. speed input: 16465.37 toks/s, output: 16.08 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:20<00:50, 13.90it/s, est. speed input: 16400.98 toks/s, output: 16.02 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:20<00:49, 13.89it/s, est. speed input: 16339.88 toks/s, output: 15.96 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:21<00:49, 13.88it/s, est. speed input: 16281.18 toks/s, output: 15.90 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:21<00:48, 13.89it/s, est. speed input: 16227.65 toks/s, output: 15.85 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:22<00:48, 13.86it/s, est. speed input: 16173.38 toks/s, output: 15.79 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:22<00:47, 13.88it/s, est. speed input: 16125.55 toks/s, output: 15.75 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:23<00:47, 13.85it/s, est. speed input: 16076.08 toks/s, output: 15.70 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:24<00:46, 13.87it/s, est. speed input: 16032.43 toks/s, output: 15.66 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:24<00:46, 13.87it/s, est. speed input: 15989.64 toks/s, output: 15.61 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [00:25<00:45, 13.87it/s, est. speed input: 15948.87 toks/s, output: 15.58 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:25<00:44, 13.86it/s, est. speed input: 15909.50 toks/s, output: 15.54 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:26<00:44, 13.86it/s, est. speed input: 15871.49 toks/s, output: 15.50 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:27<00:43, 13.86it/s, est. speed input: 15835.80 toks/s, output: 15.46 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:27<00:43, 13.85it/s, est. speed input: 15800.77 toks/s, output: 15.43 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:28<00:42, 13.86it/s, est. speed input: 15768.04 toks/s, output: 15.40 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:28<00:42, 13.84it/s, est. speed input: 15735.10 toks/s, output: 15.37 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:29<00:41, 13.84it/s, est. speed input: 15704.67 toks/s, output: 15.34 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:29<00:40, 13.84it/s, est. speed input: 15674.83 toks/s, output: 15.31 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:30<00:40, 13.85it/s, est. speed input: 15646.80 toks/s, output: 15.28 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:31<00:39, 13.84it/s, est. speed input: 15619.05 toks/s, output: 15.25 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:31<00:39, 13.85it/s, est. speed input: 15593.04 toks/s, output: 15.23 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:32<00:38, 13.83it/s, est. speed input: 15566.73 toks/s, output: 15.20 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:32<00:38, 13.83it/s, est. speed input: 15541.66 toks/s, output: 15.18 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:33<00:37, 13.83it/s, est. speed input: 15518.21 toks/s, output: 15.15 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:33<00:36, 13.83it/s, est. speed input: 15495.08 toks/s, output: 15.13 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:34<00:36, 13.82it/s, est. speed input: 15471.95 toks/s, output: 15.11 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:35<00:35, 13.82it/s, est. speed input: 15450.26 toks/s, output: 15.09 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:35<00:35, 13.81it/s, est. speed input: 15428.88 toks/s, output: 15.07 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:36<00:34, 13.82it/s, est. speed input: 15408.49 toks/s, output: 15.05 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:36<00:34, 13.81it/s, est. speed input: 15388.13 toks/s, output: 15.03 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:37<00:33, 13.82it/s, est. speed input: 15369.68 toks/s, output: 15.01 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:38<00:32, 13.81it/s, est. speed input: 15350.55 toks/s, output: 14.99 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:38<00:32, 13.80it/s, est. speed input: 15332.01 toks/s, output: 14.97 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:39<00:31, 13.79it/s, est. speed input: 15313.72 toks/s, output: 14.95 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:39<00:31, 13.80it/s, est. speed input: 15296.69 toks/s, output: 14.94 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:40<00:30, 13.79it/s, est. speed input: 15279.43 toks/s, output: 14.92 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:40<00:30, 13.79it/s, est. speed input: 15262.89 toks/s, output: 14.91 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:41<00:29, 13.78it/s, est. speed input: 15246.25 toks/s, output: 14.89 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:42<00:28, 13.79it/s, est. speed input: 15231.03 toks/s, output: 14.87 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:42<00:28, 13.79it/s, est. speed input: 15215.98 toks/s, output: 14.86 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:43<00:27, 13.78it/s, est. speed input: 15200.88 toks/s, output: 14.84 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:43<00:27, 13.78it/s, est. speed input: 15186.54 toks/s, output: 14.83 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:44<00:26, 13.78it/s, est. speed input: 15172.26 toks/s, output: 14.82 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:44<00:25, 13.79it/s, est. speed input: 15158.95 toks/s, output: 14.80 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:45<00:25, 13.78it/s, est. speed input: 15145.22 toks/s, output: 14.79 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:46<00:24, 13.78it/s, est. speed input: 15132.12 toks/s, output: 14.78 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:46<00:24, 13.77it/s, est. speed input: 15118.89 toks/s, output: 14.76 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:47<00:23, 13.76it/s, est. speed input: 15106.28 toks/s, output: 14.75 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:47<00:23, 13.76it/s, est. speed input: 15093.99 toks/s, output: 14.74 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:48<00:22, 13.76it/s, est. speed input: 15081.90 toks/s, output: 14.73 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:49<00:21, 13.76it/s, est. speed input: 15070.13 toks/s, output: 14.72 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:49<00:21, 13.75it/s, est. speed input: 15058.26 toks/s, output: 14.71 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:50<00:20, 13.74it/s, est. speed input: 15046.64 toks/s, output: 14.69 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:50<00:20, 13.75it/s, est. speed input: 15035.55 toks/s, output: 14.68 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:51<00:19, 13.75it/s, est. speed input: 15024.84 toks/s, output: 14.67 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:51<00:19, 13.75it/s, est. speed input: 15014.37 toks/s, output: 14.66 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:52<00:18, 13.75it/s, est. speed input: 15004.01 toks/s, output: 14.65 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:53<00:17, 13.74it/s, est. speed input: 14993.37 toks/s, output: 14.64 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:53<00:16, 14.18it/s, est. speed input: 15000.31 toks/s, output: 14.65 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:54<00:16, 14.05it/s, est. speed input: 14990.44 toks/s, output: 14.64 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:54<00:15, 13.94it/s, est. speed input: 14980.27 toks/s, output: 14.63 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:55<00:15, 13.89it/s, est. speed input: 14971.02 toks/s, output: 14.62 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:55<00:14, 13.83it/s, est. speed input: 14960.98 toks/s, output: 14.61 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:56<00:14, 13.81it/s, est. speed input: 14952.08 toks/s, output: 14.60 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:57<00:13, 13.77it/s, est. speed input: 14942.52 toks/s, output: 14.59 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [00:57<00:13, 13.76it/s, est. speed input: 14933.52 toks/s, output: 14.58 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [00:58<00:12, 13.74it/s, est. speed input: 14924.46 toks/s, output: 14.57 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:58<00:12, 13.73it/s, est. speed input: 14915.82 toks/s, output: 14.57 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [00:59<00:11, 13.75it/s, est. speed input: 14907.97 toks/s, output: 14.56 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [01:00<00:10, 13.73it/s, est. speed input: 14899.20 toks/s, output: 14.55 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [01:00<00:10, 13.73it/s, est. speed input: 14891.13 toks/s, output: 14.54 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [01:01<00:09, 13.72it/s, est. speed input: 14883.04 toks/s, output: 14.53 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [01:01<00:09, 13.72it/s, est. speed input: 14875.22 toks/s, output: 14.53 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [01:02<00:08, 13.71it/s, est. speed input: 14867.17 toks/s, output: 14.52 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [01:02<00:08, 13.71it/s, est. speed input: 14859.32 toks/s, output: 14.51 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [01:03<00:07, 13.71it/s, est. speed input: 14851.76 toks/s, output: 14.50 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [01:04<00:06, 13.70it/s, est. speed input: 14843.99 toks/s, output: 14.50 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [01:04<00:06, 13.69it/s, est. speed input: 14836.46 toks/s, output: 14.49 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [01:05<00:05, 13.68it/s, est. speed input: 14828.86 toks/s, output: 14.48 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [01:05<00:05, 13.68it/s, est. speed input: 14821.44 toks/s, output: 14.47 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [01:06<00:04, 13.67it/s, est. speed input: 14814.14 toks/s, output: 14.47 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [01:07<00:03, 13.67it/s, est. speed input: 14806.94 toks/s, output: 14.46 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [01:07<00:03, 13.68it/s, est. speed input: 14800.17 toks/s, output: 14.45 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [01:08<00:02, 13.68it/s, est. speed input: 14793.48 toks/s, output: 14.45 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [01:08<00:02, 13.68it/s, est. speed input: 14786.74 toks/s, output: 14.44 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [01:09<00:01, 13.68it/s, est. speed input: 14780.18 toks/s, output: 14.43 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [01:10<00:01, 13.68it/s, est. speed input: 14773.63 toks/s, output: 14.43 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [01:10<00:00, 14.17it/s, est. speed input: 14781.62 toks/s, output: 14.44 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [01:10<00:00, 14.17it/s, est. speed input: 14868.70 toks/s, output: 14.52 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [01:10<00:00, 14.52it/s, est. speed input: 14868.70 toks/s, output: 14.52 toks/s]
[rank0]:[W125 22:43:06.418775063 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=16384 ==========
Time: 2026-01-25 22:43:09
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=2048, max_num_seqs=16
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 2048 --max-num-seqs 16 --max-model-len 1025 --max-num-batched-tokens 16384 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-14B-INT8_M16384.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 22:43:31 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=539558) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=539558) WARNING 01-25 22:43:56 [backends.py:609] Failed to read file <frozen os>
Throughput: 13.87 requests/s, 14215.94 total tokens/s, 13.87 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048

STDERR:
[2026-01-25 22:43:30] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 22:43:31] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-25 22:43:31] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-25 22:43:31] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:43:31] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:43:31] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:43:31] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:43:31] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:43:31] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-25 22:43:31] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 22:43:31] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 22:43:31] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 22:43:31] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 22:43:31] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 22:43:38] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 22:43:38] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-25 22:43:38] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-25 22:43:38] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:43:38] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:43:38] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:43:38] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:43:38] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:43:38] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-25 22:43:38] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 22:43:38] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 22:43:38] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 22:43:38] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 22:43:38] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=539558) [2026-01-25 22:43:39] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=539558) [2026-01-25 22:43:39] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=539558) [2026-01-25 22:43:39] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=539558) [2026-01-25 22:43:39] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=539558) [2026-01-25 22:43:39] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=539558) [2026-01-25 22:43:39] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=539558) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=539558) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.21it/s]
(EngineCore_DP0 pid=539558) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.75it/s]
(EngineCore_DP0 pid=539558) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.44it/s]
(EngineCore_DP0 pid=539558) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.26it/s]
(EngineCore_DP0 pid=539558) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.33it/s]
(EngineCore_DP0 pid=539558) 
(EngineCore_DP0 pid=539558) [2026-01-25 22:43:43] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 7680] -> 1D uint8
(EngineCore_DP0 pid=539558) [2026-01-25 22:43:43] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 41287680 bytes
(EngineCore_DP0 pid=539558) [2026-01-25 22:43:43] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 7680] -> 1D uint8
(EngineCore_DP0 pid=539558) [2026-01-25 22:43:43] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 29491200 bytes
(EngineCore_DP0 pid=539558) [2026-01-25 22:43:43] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 7680] -> 1D uint8
(EngineCore_DP0 pid=539558) [2026-01-25 22:43:43] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 159252480 bytes
(EngineCore_DP0 pid=539558) [2026-01-25 22:43:43] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 20736] -> 1D uint8
(EngineCore_DP0 pid=539558) [2026-01-25 22:43:43] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 79626240 bytes
(EngineCore_DP0 pid=539558) [rank0]:W0125 22:44:10.023000 539558 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=539558) [rank0]:W0125 22:44:10.106000 539558 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=539558) [rank0]:W0125 22:44:11.013000 539558 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=539558) [rank0]:W0125 22:44:11.140000 539558 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=539558) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  14%|█▍        | 1/7 [00:00<00:01,  5.60it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  29%|██▊       | 2/7 [00:00<00:00,  5.95it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  43%|████▎     | 3/7 [00:00<00:00,  6.06it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  57%|█████▋    | 4/7 [00:00<00:00,  6.33it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  71%|███████▏  | 5/7 [00:00<00:00,  6.49it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  86%|████████▌ | 6/7 [00:00<00:00,  6.42it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:01<00:00,  6.20it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:01<00:00,  6.21it/s]
(EngineCore_DP0 pid=539558) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  20%|██        | 1/5 [00:00<00:00,  6.06it/s]
Capturing CUDA graphs (decode, FULL):  40%|████      | 2/5 [00:00<00:00,  6.53it/s]
Capturing CUDA graphs (decode, FULL):  60%|██████    | 3/5 [00:00<00:00,  6.51it/s]
Capturing CUDA graphs (decode, FULL):  80%|████████  | 4/5 [00:00<00:00,  6.53it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00,  6.60it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00,  6.53it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   1%|▏         | 28/2048 [00:00<00:07, 276.87it/s]
Adding requests:   3%|▎         | 58/2048 [00:00<00:06, 289.48it/s]
Adding requests:   4%|▍         | 87/2048 [00:00<00:06, 288.22it/s]
Adding requests:   6%|▌         | 118/2048 [00:00<00:06, 292.60it/s]
Adding requests:   7%|▋         | 149/2048 [00:00<00:06, 295.90it/s]
Adding requests:   9%|▉         | 180/2048 [00:00<00:06, 300.51it/s]
Adding requests:  10%|█         | 213/2048 [00:00<00:05, 309.57it/s]
Adding requests:  12%|█▏        | 244/2048 [00:00<00:05, 301.84it/s]
Adding requests:  13%|█▎        | 275/2048 [00:00<00:05, 297.80it/s]
Adding requests:  15%|█▍        | 306/2048 [00:01<00:05, 298.78it/s]
Adding requests:  17%|█▋        | 339/2048 [00:01<00:05, 304.62it/s]
Adding requests:  18%|█▊        | 370/2048 [00:01<00:05, 298.61it/s]
Adding requests:  20%|█▉        | 400/2048 [00:01<00:05, 296.38it/s]
Adding requests:  21%|██        | 431/2048 [00:01<00:05, 299.16it/s]
Adding requests:  23%|██▎       | 461/2048 [00:01<00:05, 298.06it/s]
Adding requests:  24%|██▍       | 493/2048 [00:01<00:05, 302.50it/s]
Adding requests:  26%|██▌       | 528/2048 [00:01<00:04, 315.34it/s]
Adding requests:  27%|██▋       | 560/2048 [00:01<00:04, 310.46it/s]
Adding requests:  29%|██▉       | 592/2048 [00:01<00:04, 298.09it/s]
Adding requests:  30%|███       | 623/2048 [00:02<00:04, 301.20it/s]
Adding requests:  32%|███▏      | 654/2048 [00:02<00:04, 296.82it/s]
Adding requests:  33%|███▎      | 684/2048 [00:02<00:04, 297.20it/s]
Adding requests:  35%|███▍      | 716/2048 [00:02<00:04, 302.99it/s]
Adding requests:  36%|███▋      | 747/2048 [00:02<00:04, 298.01it/s]
Adding requests:  38%|███▊      | 779/2048 [00:02<00:04, 302.31it/s]
Adding requests:  40%|███▉      | 810/2048 [00:02<00:04, 299.39it/s]
Adding requests:  41%|████      | 844/2048 [00:02<00:03, 309.48it/s]
Adding requests:  43%|████▎     | 875/2048 [00:02<00:03, 301.04it/s]
Adding requests:  44%|████▍     | 907/2048 [00:03<00:03, 305.30it/s]
Adding requests:  46%|████▌     | 938/2048 [00:03<00:03, 301.81it/s]
Adding requests:  47%|████▋     | 970/2048 [00:03<00:03, 303.95it/s]
Adding requests:  49%|████▉     | 1001/2048 [00:03<00:03, 301.58it/s]
Adding requests:  50%|█████     | 1032/2048 [00:03<00:03, 302.27it/s]
Adding requests:  52%|█████▏    | 1063/2048 [00:03<00:03, 302.37it/s]
Adding requests:  53%|█████▎    | 1094/2048 [00:03<00:03, 299.29it/s]
Adding requests:  55%|█████▍    | 1124/2048 [00:03<00:03, 299.43it/s]
Adding requests:  56%|█████▋    | 1154/2048 [00:03<00:02, 298.40it/s]
Adding requests:  58%|█████▊    | 1184/2048 [00:03<00:02, 298.40it/s]
Adding requests:  59%|█████▉    | 1217/2048 [00:04<00:02, 307.27it/s]
Adding requests:  61%|██████    | 1248/2048 [00:04<00:02, 306.85it/s]
Adding requests:  62%|██████▏   | 1279/2048 [00:04<00:02, 295.49it/s]
Adding requests:  64%|██████▍   | 1309/2048 [00:04<00:02, 290.01it/s]
Adding requests:  65%|██████▌   | 1340/2048 [00:04<00:02, 292.81it/s]
Adding requests:  67%|██████▋   | 1373/2048 [00:04<00:02, 302.97it/s]
Adding requests:  69%|██████▊   | 1404/2048 [00:04<00:02, 304.65it/s]
Adding requests:  70%|███████   | 1435/2048 [00:04<00:02, 303.18it/s]
Adding requests:  72%|███████▏  | 1467/2048 [00:04<00:01, 306.95it/s]
Adding requests:  73%|███████▎  | 1498/2048 [00:04<00:01, 305.15it/s]
Adding requests:  75%|███████▍  | 1529/2048 [00:05<00:01, 305.77it/s]
Adding requests:  76%|███████▌  | 1560/2048 [00:05<00:01, 293.73it/s]
Adding requests:  78%|███████▊  | 1590/2048 [00:05<00:01, 291.08it/s]
Adding requests:  79%|███████▉  | 1620/2048 [00:05<00:01, 291.17it/s]
Adding requests:  81%|████████  | 1650/2048 [00:05<00:01, 292.86it/s]
Adding requests:  82%|████████▏ | 1680/2048 [00:05<00:01, 293.59it/s]
Adding requests:  84%|████████▎ | 1712/2048 [00:05<00:01, 300.68it/s]
Adding requests:  85%|████████▌ | 1743/2048 [00:05<00:01, 290.90it/s]
Adding requests:  87%|████████▋ | 1776/2048 [00:05<00:00, 299.41it/s]
Adding requests:  88%|████████▊ | 1807/2048 [00:06<00:00, 290.92it/s]
Adding requests:  90%|████████▉ | 1837/2048 [00:06<00:00, 288.58it/s]
Adding requests:  91%|█████████ | 1867/2048 [00:06<00:00, 288.59it/s]
Adding requests:  93%|█████████▎| 1899/2048 [00:06<00:00, 295.72it/s]
Adding requests:  94%|█████████▍| 1933/2048 [00:06<00:00, 305.31it/s]
Adding requests:  96%|█████████▌| 1965/2048 [00:06<00:00, 306.17it/s]
Adding requests:  97%|█████████▋| 1996/2048 [00:06<00:00, 300.26it/s]
Adding requests:  99%|█████████▉| 2027/2048 [00:06<00:00, 297.82it/s]
Adding requests: 100%|██████████| 2048/2048 [00:06<00:00, 299.16it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▍         | 98/2048 [00:01<00:24, 79.48it/s, est. speed input: 81385.81 toks/s, output: 79.48 toks/s]
Processed prompts:   6%|▌         | 114/2048 [00:02<00:45, 42.21it/s, est. speed input: 49165.52 toks/s, output: 48.01 toks/s]
Processed prompts:   6%|▋         | 130/2048 [00:03<01:04, 29.56it/s, est. speed input: 37865.30 toks/s, output: 36.98 toks/s]
Processed prompts:   7%|▋         | 146/2048 [00:04<01:20, 23.51it/s, est. speed input: 32115.78 toks/s, output: 31.36 toks/s]
Processed prompts:   8%|▊         | 162/2048 [00:05<01:33, 20.10it/s, est. speed input: 28609.79 toks/s, output: 27.94 toks/s]
Processed prompts:   9%|▊         | 178/2048 [00:06<01:43, 18.03it/s, est. speed input: 26261.43 toks/s, output: 25.65 toks/s]
Processed prompts:   9%|▉         | 194/2048 [00:08<01:48, 17.02it/s, est. speed input: 24765.38 toks/s, output: 24.18 toks/s]
Processed prompts:  10%|█         | 210/2048 [00:09<01:54, 16.04it/s, est. speed input: 23462.35 toks/s, output: 22.91 toks/s]
Processed prompts:  11%|█         | 226/2048 [00:10<01:58, 15.40it/s, est. speed input: 22450.96 toks/s, output: 21.92 toks/s]
Processed prompts:  12%|█▏        | 242/2048 [00:11<02:00, 14.96it/s, est. speed input: 21635.82 toks/s, output: 21.13 toks/s]
Processed prompts:  13%|█▎        | 258/2048 [00:12<02:02, 14.65it/s, est. speed input: 20968.00 toks/s, output: 20.48 toks/s]
Processed prompts:  13%|█▎        | 274/2048 [00:13<02:02, 14.44it/s, est. speed input: 20413.54 toks/s, output: 19.94 toks/s]
Processed prompts:  14%|█▍        | 290/2048 [00:14<02:02, 14.30it/s, est. speed input: 19942.41 toks/s, output: 19.47 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [00:16<02:02, 14.19it/s, est. speed input: 19536.85 toks/s, output: 19.08 toks/s]
Processed prompts:  16%|█▌        | 322/2048 [00:17<02:02, 14.11it/s, est. speed input: 19185.30 toks/s, output: 18.74 toks/s]
Processed prompts:  17%|█▋        | 338/2048 [00:18<02:01, 14.06it/s, est. speed input: 18877.32 toks/s, output: 18.43 toks/s]
Processed prompts:  17%|█▋        | 354/2048 [00:19<02:00, 14.02it/s, est. speed input: 18606.37 toks/s, output: 18.17 toks/s]
Processed prompts:  18%|█▊        | 370/2048 [00:20<01:59, 14.00it/s, est. speed input: 18365.66 toks/s, output: 17.94 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [00:21<01:58, 13.97it/s, est. speed input: 18148.33 toks/s, output: 17.72 toks/s]
Processed prompts:  20%|█▉        | 402/2048 [00:22<01:57, 13.96it/s, est. speed input: 17952.62 toks/s, output: 17.53 toks/s]
Processed prompts:  20%|██        | 418/2048 [00:24<01:56, 13.94it/s, est. speed input: 17774.13 toks/s, output: 17.36 toks/s]
Processed prompts:  21%|██        | 434/2048 [00:25<01:55, 13.92it/s, est. speed input: 17612.23 toks/s, output: 17.20 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [00:26<01:54, 13.91it/s, est. speed input: 17464.03 toks/s, output: 17.05 toks/s]
Processed prompts:  23%|██▎       | 466/2048 [00:27<01:53, 13.91it/s, est. speed input: 17328.92 toks/s, output: 16.92 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [00:28<01:52, 13.90it/s, est. speed input: 17204.28 toks/s, output: 16.80 toks/s]
Processed prompts:  24%|██▍       | 498/2048 [00:29<01:51, 13.90it/s, est. speed input: 17089.17 toks/s, output: 16.69 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [00:30<01:50, 13.89it/s, est. speed input: 16982.49 toks/s, output: 16.58 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [00:32<01:49, 13.89it/s, est. speed input: 16883.66 toks/s, output: 16.49 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [00:33<01:48, 13.89it/s, est. speed input: 16791.69 toks/s, output: 16.40 toks/s]
Processed prompts:  27%|██▋       | 562/2048 [00:34<01:47, 13.88it/s, est. speed input: 16704.30 toks/s, output: 16.31 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [00:35<01:45, 13.88it/s, est. speed input: 16623.53 toks/s, output: 16.23 toks/s]
Processed prompts:  29%|██▉       | 594/2048 [00:36<01:44, 13.87it/s, est. speed input: 16547.29 toks/s, output: 16.16 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [00:37<01:43, 13.87it/s, est. speed input: 16475.50 toks/s, output: 16.09 toks/s]
Processed prompts:  31%|███       | 626/2048 [00:39<01:42, 13.87it/s, est. speed input: 16408.01 toks/s, output: 16.02 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [00:40<01:41, 13.86it/s, est. speed input: 16343.92 toks/s, output: 15.96 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [00:41<01:40, 13.86it/s, est. speed input: 16283.59 toks/s, output: 15.90 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [00:42<01:39, 13.86it/s, est. speed input: 16226.66 toks/s, output: 15.85 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [00:43<01:38, 13.85it/s, est. speed input: 16172.22 toks/s, output: 15.79 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [00:44<01:36, 13.84it/s, est. speed input: 16120.10 toks/s, output: 15.74 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [00:46<01:35, 13.84it/s, est. speed input: 16070.80 toks/s, output: 15.69 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [00:47<01:34, 13.83it/s, est. speed input: 16023.40 toks/s, output: 15.65 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [00:48<01:33, 13.83it/s, est. speed input: 15978.51 toks/s, output: 15.60 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [00:49<01:32, 13.85it/s, est. speed input: 15937.91 toks/s, output: 15.56 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [00:50<01:29, 14.09it/s, est. speed input: 15918.44 toks/s, output: 15.55 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [00:51<01:28, 14.03it/s, est. speed input: 15880.67 toks/s, output: 15.51 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [00:52<01:27, 13.99it/s, est. speed input: 15844.92 toks/s, output: 15.47 toks/s]
Processed prompts:  41%|████      | 834/2048 [00:54<01:26, 13.96it/s, est. speed input: 15810.47 toks/s, output: 15.44 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [00:55<01:25, 13.94it/s, est. speed input: 15777.14 toks/s, output: 15.41 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [00:56<01:24, 13.93it/s, est. speed input: 15745.57 toks/s, output: 15.38 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [00:57<01:23, 13.92it/s, est. speed input: 15715.10 toks/s, output: 15.35 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [00:58<01:22, 13.90it/s, est. speed input: 15685.25 toks/s, output: 15.32 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [00:59<01:21, 13.89it/s, est. speed input: 15656.57 toks/s, output: 15.29 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [01:00<01:20, 13.88it/s, est. speed input: 15628.97 toks/s, output: 15.26 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [01:02<01:19, 13.88it/s, est. speed input: 15602.44 toks/s, output: 15.24 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [01:03<01:18, 13.87it/s, est. speed input: 15576.70 toks/s, output: 15.21 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [01:04<01:17, 13.87it/s, est. speed input: 15551.80 toks/s, output: 15.19 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [01:05<01:16, 13.87it/s, est. speed input: 15528.04 toks/s, output: 15.16 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [01:06<01:14, 13.86it/s, est. speed input: 15504.73 toks/s, output: 15.14 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [01:07<01:13, 13.86it/s, est. speed input: 15482.38 toks/s, output: 15.12 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [01:09<01:12, 13.86it/s, est. speed input: 15460.48 toks/s, output: 15.10 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [01:10<01:11, 13.85it/s, est. speed input: 15439.13 toks/s, output: 15.08 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [01:11<01:10, 13.85it/s, est. speed input: 15418.66 toks/s, output: 15.06 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [01:12<01:09, 13.84it/s, est. speed input: 15398.52 toks/s, output: 15.04 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [01:13<01:08, 13.84it/s, est. speed input: 15378.98 toks/s, output: 15.02 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [01:14<01:06, 13.83it/s, est. speed input: 15360.13 toks/s, output: 15.00 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [01:15<01:05, 13.84it/s, est. speed input: 15342.10 toks/s, output: 14.98 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [01:17<01:04, 13.83it/s, est. speed input: 15324.15 toks/s, output: 14.96 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [01:18<01:03, 13.82it/s, est. speed input: 15306.64 toks/s, output: 14.95 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [01:19<01:02, 13.83it/s, est. speed input: 15290.13 toks/s, output: 14.93 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [01:20<01:01, 13.83it/s, est. speed input: 15273.81 toks/s, output: 14.92 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [01:21<01:00, 13.82it/s, est. speed input: 15257.85 toks/s, output: 14.90 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [01:22<00:58, 13.82it/s, est. speed input: 15242.42 toks/s, output: 14.89 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [01:24<00:57, 13.82it/s, est. speed input: 15227.23 toks/s, output: 14.87 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [01:25<00:56, 13.81it/s, est. speed input: 15212.40 toks/s, output: 14.86 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [01:26<00:55, 13.81it/s, est. speed input: 15198.01 toks/s, output: 14.84 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [01:27<00:54, 13.81it/s, est. speed input: 15183.86 toks/s, output: 14.83 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [01:28<00:53, 13.81it/s, est. speed input: 15170.19 toks/s, output: 14.81 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [01:29<00:52, 13.81it/s, est. speed input: 15156.88 toks/s, output: 14.80 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [01:31<00:50, 13.80it/s, est. speed input: 15143.75 toks/s, output: 14.79 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [01:32<00:49, 13.80it/s, est. speed input: 15130.90 toks/s, output: 14.78 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [01:33<00:48, 13.80it/s, est. speed input: 15118.55 toks/s, output: 14.76 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [01:34<00:47, 13.80it/s, est. speed input: 15106.34 toks/s, output: 14.75 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [01:35<00:46, 13.80it/s, est. speed input: 15094.52 toks/s, output: 14.74 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [01:36<00:45, 13.79it/s, est. speed input: 15082.67 toks/s, output: 14.73 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [01:37<00:43, 13.79it/s, est. speed input: 15071.13 toks/s, output: 14.72 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [01:39<00:42, 13.79it/s, est. speed input: 15059.92 toks/s, output: 14.71 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [01:40<00:41, 13.79it/s, est. speed input: 15048.95 toks/s, output: 14.70 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [01:41<00:40, 13.79it/s, est. speed input: 15038.31 toks/s, output: 14.69 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [01:42<00:39, 13.78it/s, est. speed input: 15027.84 toks/s, output: 14.68 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [01:43<00:38, 13.77it/s, est. speed input: 15017.19 toks/s, output: 14.67 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [01:44<00:37, 13.77it/s, est. speed input: 15007.03 toks/s, output: 14.66 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [01:46<00:35, 13.99it/s, est. speed input: 15005.79 toks/s, output: 14.65 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [01:47<00:34, 13.92it/s, est. speed input: 14995.87 toks/s, output: 14.64 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [01:48<00:33, 13.88it/s, est. speed input: 14986.24 toks/s, output: 14.63 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [01:49<00:32, 13.84it/s, est. speed input: 14976.59 toks/s, output: 14.63 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [01:50<00:30, 14.04it/s, est. speed input: 14975.67 toks/s, output: 14.62 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [01:51<00:29, 13.95it/s, est. speed input: 14966.34 toks/s, output: 14.62 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [01:52<00:28, 13.90it/s, est. speed input: 14957.39 toks/s, output: 14.61 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [01:54<00:27, 13.86it/s, est. speed input: 14948.74 toks/s, output: 14.60 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [01:55<00:26, 13.83it/s, est. speed input: 14940.13 toks/s, output: 14.59 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [01:56<00:25, 13.80it/s, est. speed input: 14931.37 toks/s, output: 14.58 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [01:57<00:24, 13.79it/s, est. speed input: 14923.23 toks/s, output: 14.57 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [01:58<00:23, 13.79it/s, est. speed input: 14915.26 toks/s, output: 14.57 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [01:59<00:21, 13.77it/s, est. speed input: 14906.99 toks/s, output: 14.56 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [02:01<00:20, 13.77it/s, est. speed input: 14899.09 toks/s, output: 14.55 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [02:02<00:19, 13.76it/s, est. speed input: 14891.19 toks/s, output: 14.54 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [02:03<00:18, 13.75it/s, est. speed input: 14883.46 toks/s, output: 14.53 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [02:04<00:17, 13.75it/s, est. speed input: 14876.01 toks/s, output: 14.53 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [02:05<00:16, 13.75it/s, est. speed input: 14868.60 toks/s, output: 14.52 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [02:06<00:14, 13.76it/s, est. speed input: 14861.51 toks/s, output: 14.51 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [02:08<00:13, 13.75it/s, est. speed input: 14854.34 toks/s, output: 14.51 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [02:09<00:12, 13.75it/s, est. speed input: 14847.44 toks/s, output: 14.50 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [02:10<00:11, 13.75it/s, est. speed input: 14840.38 toks/s, output: 14.49 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [02:11<00:10, 13.75it/s, est. speed input: 14833.82 toks/s, output: 14.49 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [02:12<00:09, 13.75it/s, est. speed input: 14827.06 toks/s, output: 14.48 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [02:13<00:08, 13.75it/s, est. speed input: 14820.52 toks/s, output: 14.47 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [02:15<00:06, 13.74it/s, est. speed input: 14813.90 toks/s, output: 14.47 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [02:16<00:05, 13.74it/s, est. speed input: 14807.57 toks/s, output: 14.46 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [02:17<00:04, 13.75it/s, est. speed input: 14801.54 toks/s, output: 14.45 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [02:18<00:03, 13.74it/s, est. speed input: 14795.30 toks/s, output: 14.45 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [02:19<00:02, 13.74it/s, est. speed input: 14789.20 toks/s, output: 14.44 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [02:20<00:00, 14.00it/s, est. speed input: 14790.91 toks/s, output: 14.44 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [02:20<00:00, 14.00it/s, est. speed input: 14892.68 toks/s, output: 14.54 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [02:20<00:00, 14.54it/s, est. speed input: 14892.68 toks/s, output: 14.54 toks/s]
[rank0]:[W125 22:46:56.074523657 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=32768 ==========
Time: 2026-01-25 22:46:58
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=4096, max_num_seqs=32
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 4096 --max-num-seqs 32 --max-model-len 1025 --max-num-batched-tokens 32768 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-14B-INT8_M32768.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 22:47:35 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=543225) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=543225) WARNING 01-25 22:48:00 [backends.py:609] Failed to read file <frozen os>
Throughput: 13.82 requests/s, 14160.39 total tokens/s, 13.82 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096

STDERR:
[2026-01-25 22:47:35] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 22:47:35] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-25 22:47:35] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-25 22:47:35] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:47:35] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:47:35] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:47:35] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:47:35] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:47:35] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-25 22:47:35] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 22:47:35] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 22:47:35] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 22:47:35] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 22:47:35] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 22:47:43] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 22:47:43] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-25 22:47:43] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-25 22:47:43] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:47:43] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:47:43] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:47:43] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:47:43] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:47:43] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-25 22:47:43] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 22:47:43] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 22:47:43] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 22:47:43] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 22:47:43] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=543225) [2026-01-25 22:47:44] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=543225) [2026-01-25 22:47:44] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=543225) [2026-01-25 22:47:44] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=543225) [2026-01-25 22:47:44] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=543225) [2026-01-25 22:47:44] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=543225) [2026-01-25 22:47:44] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=543225) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=543225) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.23it/s]
(EngineCore_DP0 pid=543225) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.80it/s]
(EngineCore_DP0 pid=543225) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.47it/s]
(EngineCore_DP0 pid=543225) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.29it/s]
(EngineCore_DP0 pid=543225) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.36it/s]
(EngineCore_DP0 pid=543225) 
(EngineCore_DP0 pid=543225) [2026-01-25 22:47:47] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 7680] -> 1D uint8
(EngineCore_DP0 pid=543225) [2026-01-25 22:47:47] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 41287680 bytes
(EngineCore_DP0 pid=543225) [2026-01-25 22:47:47] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 7680] -> 1D uint8
(EngineCore_DP0 pid=543225) [2026-01-25 22:47:47] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 29491200 bytes
(EngineCore_DP0 pid=543225) [2026-01-25 22:47:47] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 7680] -> 1D uint8
(EngineCore_DP0 pid=543225) [2026-01-25 22:47:47] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 159252480 bytes
(EngineCore_DP0 pid=543225) [2026-01-25 22:47:47] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 20736] -> 1D uint8
(EngineCore_DP0 pid=543225) [2026-01-25 22:47:47] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 79626240 bytes
(EngineCore_DP0 pid=543225) [rank0]:W0125 22:48:14.538000 543225 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=543225) [rank0]:W0125 22:48:14.623000 543225 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=543225) [rank0]:W0125 22:48:15.535000 543225 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=543225) [rank0]:W0125 22:48:15.656000 543225 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=543225) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   9%|▉         | 1/11 [00:00<00:01,  6.34it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  18%|█▊        | 2/11 [00:00<00:01,  6.26it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  27%|██▋       | 3/11 [00:00<00:01,  6.37it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  36%|███▋      | 4/11 [00:00<00:01,  6.56it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  45%|████▌     | 5/11 [00:00<00:00,  6.61it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  55%|█████▍    | 6/11 [00:00<00:00,  6.61it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  64%|██████▎   | 7/11 [00:01<00:00,  6.59it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  73%|███████▎  | 8/11 [00:01<00:00,  6.64it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  82%|████████▏ | 9/11 [00:01<00:00,  6.73it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  91%|█████████ | 10/11 [00:01<00:00,  6.82it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00,  6.43it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00,  6.54it/s]
(EngineCore_DP0 pid=543225) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  14%|█▍        | 1/7 [00:00<00:01,  5.69it/s]
Capturing CUDA graphs (decode, FULL):  29%|██▊       | 2/7 [00:00<00:00,  6.08it/s]
Capturing CUDA graphs (decode, FULL):  43%|████▎     | 3/7 [00:00<00:00,  6.35it/s]
Capturing CUDA graphs (decode, FULL):  57%|█████▋    | 4/7 [00:00<00:00,  6.52it/s]
Capturing CUDA graphs (decode, FULL):  71%|███████▏  | 5/7 [00:00<00:00,  6.53it/s]
Capturing CUDA graphs (decode, FULL):  86%|████████▌ | 6/7 [00:00<00:00,  6.62it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:01<00:00,  6.73it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:01<00:00,  6.53it/s]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   1%|          | 27/4096 [00:00<00:15, 261.76it/s]
Adding requests:   1%|▏         | 54/4096 [00:00<00:15, 254.11it/s]
Adding requests:   2%|▏         | 84/4096 [00:00<00:14, 274.09it/s]
Adding requests:   3%|▎         | 112/4096 [00:00<00:14, 272.77it/s]
Adding requests:   3%|▎         | 140/4096 [00:00<00:14, 269.59it/s]
Adding requests:   4%|▍         | 168/4096 [00:00<00:14, 272.75it/s]
Adding requests:   5%|▍         | 198/4096 [00:00<00:13, 280.08it/s]
Adding requests:   6%|▌         | 229/4096 [00:00<00:13, 286.45it/s]
Adding requests:   6%|▋         | 258/4096 [00:00<00:13, 286.18it/s]
Adding requests:   7%|▋         | 290/4096 [00:01<00:12, 292.95it/s]
Adding requests:   8%|▊         | 321/4096 [00:01<00:12, 297.30it/s]
Adding requests:   9%|▊         | 351/4096 [00:01<00:12, 295.60it/s]
Adding requests:   9%|▉         | 384/4096 [00:01<00:12, 304.66it/s]
Adding requests:  10%|█         | 417/4096 [00:01<00:11, 311.61it/s]
Adding requests:  11%|█         | 449/4096 [00:01<00:11, 304.61it/s]
Adding requests:  12%|█▏        | 482/4096 [00:01<00:11, 311.87it/s]
Adding requests:  13%|█▎        | 514/4096 [00:01<00:11, 307.49it/s]
Adding requests:  13%|█▎        | 545/4096 [00:01<00:11, 305.16it/s]
Adding requests:  14%|█▍        | 577/4096 [00:01<00:11, 305.77it/s]
Adding requests:  15%|█▍        | 608/4096 [00:02<00:11, 294.14it/s]
Adding requests:  16%|█▌        | 638/4096 [00:02<00:12, 287.99it/s]
Adding requests:  16%|█▋        | 667/4096 [00:02<00:12, 279.47it/s]
Adding requests:  17%|█▋        | 698/4096 [00:02<00:11, 287.74it/s]
Adding requests:  18%|█▊        | 727/4096 [00:02<00:11, 285.74it/s]
Adding requests:  18%|█▊        | 756/4096 [00:02<00:11, 284.28it/s]
Adding requests:  19%|█▉        | 785/4096 [00:02<00:11, 285.89it/s]
Adding requests:  20%|█▉        | 814/4096 [00:02<00:11, 281.11it/s]
Adding requests:  21%|██        | 844/4096 [00:02<00:11, 283.75it/s]
Adding requests:  21%|██▏       | 873/4096 [00:03<00:11, 285.52it/s]
Adding requests:  22%|██▏       | 905/4096 [00:03<00:10, 294.78it/s]
Adding requests:  23%|██▎       | 935/4096 [00:03<00:10, 291.53it/s]
Adding requests:  24%|██▎       | 966/4096 [00:03<00:10, 296.33it/s]
Adding requests:  24%|██▍       | 996/4096 [00:03<00:10, 294.12it/s]
Adding requests:  25%|██▌       | 1026/4096 [00:03<00:10, 285.86it/s]
Adding requests:  26%|██▌       | 1055/4096 [00:03<00:10, 281.14it/s]
Adding requests:  26%|██▋       | 1084/4096 [00:03<00:10, 280.48it/s]
Adding requests:  27%|██▋       | 1113/4096 [00:03<00:10, 277.37it/s]
Adding requests:  28%|██▊       | 1143/4096 [00:03<00:10, 282.43it/s]
Adding requests:  29%|██▊       | 1174/4096 [00:04<00:10, 287.93it/s]
Adding requests:  29%|██▉       | 1205/4096 [00:04<00:09, 293.34it/s]
Adding requests:  30%|███       | 1237/4096 [00:04<00:09, 299.77it/s]
Adding requests:  31%|███       | 1268/4096 [00:04<00:09, 289.69it/s]
Adding requests:  32%|███▏      | 1298/4096 [00:04<00:09, 287.51it/s]
Adding requests:  32%|███▏      | 1327/4096 [00:04<00:09, 285.19it/s]
Adding requests:  33%|███▎      | 1356/4096 [00:04<00:09, 286.03it/s]
Adding requests:  34%|███▍      | 1385/4096 [00:04<00:09, 285.04it/s]
Adding requests:  35%|███▍      | 1414/4096 [00:04<00:09, 282.58it/s]
Adding requests:  35%|███▌      | 1444/4096 [00:04<00:09, 287.33it/s]
Adding requests:  36%|███▌      | 1474/4096 [00:05<00:09, 288.88it/s]
Adding requests:  37%|███▋      | 1507/4096 [00:05<00:08, 298.58it/s]
Adding requests:  38%|███▊      | 1537/4096 [00:05<00:08, 298.09it/s]
Adding requests:  38%|███▊      | 1567/4096 [00:05<00:08, 295.72it/s]
Adding requests:  39%|███▉      | 1597/4096 [00:05<00:08, 295.37it/s]
Adding requests:  40%|███▉      | 1627/4096 [00:05<00:08, 288.92it/s]
Adding requests:  40%|████      | 1656/4096 [00:05<00:08, 278.35it/s]
Adding requests:  41%|████      | 1684/4096 [00:05<00:08, 276.61it/s]
Adding requests:  42%|████▏     | 1713/4096 [00:05<00:08, 279.80it/s]
Adding requests:  43%|████▎     | 1742/4096 [00:06<00:08, 279.98it/s]
Adding requests:  43%|████▎     | 1772/4096 [00:06<00:08, 285.75it/s]
Adding requests:  44%|████▍     | 1801/4096 [00:06<00:08, 279.81it/s]
Adding requests:  45%|████▍     | 1831/4096 [00:06<00:07, 285.33it/s]
Adding requests:  45%|████▌     | 1860/4096 [00:06<00:07, 280.89it/s]
Adding requests:  46%|████▌     | 1891/4096 [00:06<00:07, 289.21it/s]
Adding requests:  47%|████▋     | 1921/4096 [00:06<00:07, 289.93it/s]
Adding requests:  48%|████▊     | 1951/4096 [00:06<00:07, 292.56it/s]
Adding requests:  48%|████▊     | 1981/4096 [00:06<00:07, 292.64it/s]
Adding requests:  49%|████▉     | 2011/4096 [00:06<00:07, 289.18it/s]
Adding requests:  50%|████▉     | 2040/4096 [00:07<00:07, 286.12it/s]
Adding requests:  51%|█████     | 2069/4096 [00:07<00:07, 285.15it/s]
Adding requests:  51%|█████▏    | 2100/4096 [00:07<00:06, 290.64it/s]
Adding requests:  52%|█████▏    | 2130/4096 [00:07<00:06, 293.10it/s]
Adding requests:  53%|█████▎    | 2160/4096 [00:07<00:06, 289.42it/s]
Adding requests:  53%|█████▎    | 2189/4096 [00:07<00:06, 283.84it/s]
Adding requests:  54%|█████▍    | 2218/4096 [00:07<00:06, 281.25it/s]
Adding requests:  55%|█████▍    | 2248/4096 [00:07<00:06, 286.55it/s]
Adding requests:  56%|█████▌    | 2281/4096 [00:07<00:06, 296.46it/s]
Adding requests:  56%|█████▋    | 2312/4096 [00:08<00:05, 298.60it/s]
Adding requests:  57%|█████▋    | 2342/4096 [00:08<00:06, 291.45it/s]
Adding requests:  58%|█████▊    | 2373/4096 [00:08<00:05, 294.94it/s]
Adding requests:  59%|█████▊    | 2405/4096 [00:08<00:05, 300.23it/s]
Adding requests:  60%|█████▉    | 2438/4096 [00:08<00:05, 307.46it/s]
Adding requests:  60%|██████    | 2469/4096 [00:08<00:05, 292.94it/s]
Adding requests:  61%|██████    | 2501/4096 [00:08<00:05, 300.14it/s]
Adding requests:  62%|██████▏   | 2532/4096 [00:08<00:05, 298.67it/s]
Adding requests:  63%|██████▎   | 2565/4096 [00:08<00:04, 307.68it/s]
Adding requests:  63%|██████▎   | 2596/4096 [00:08<00:04, 306.17it/s]
Adding requests:  64%|██████▍   | 2627/4096 [00:09<00:04, 300.62it/s]
Adding requests:  65%|██████▍   | 2658/4096 [00:09<00:04, 296.84it/s]
Adding requests:  66%|██████▌   | 2689/4096 [00:09<00:04, 297.62it/s]
Adding requests:  66%|██████▋   | 2719/4096 [00:09<00:04, 293.98it/s]
Adding requests:  67%|██████▋   | 2750/4096 [00:09<00:04, 295.87it/s]
Adding requests:  68%|██████▊   | 2782/4096 [00:09<00:04, 300.26it/s]
Adding requests:  69%|██████▊   | 2813/4096 [00:09<00:04, 302.81it/s]
Adding requests:  69%|██████▉   | 2844/4096 [00:09<00:04, 299.10it/s]
Adding requests:  70%|███████   | 2874/4096 [00:09<00:04, 297.94it/s]
Adding requests:  71%|███████   | 2905/4096 [00:09<00:03, 298.21it/s]
Adding requests:  72%|███████▏  | 2936/4096 [00:10<00:03, 300.53it/s]
Adding requests:  72%|███████▏  | 2967/4096 [00:10<00:03, 294.02it/s]
Adding requests:  73%|███████▎  | 2999/4096 [00:10<00:03, 301.02it/s]
Adding requests:  74%|███████▍  | 3030/4096 [00:10<00:03, 302.10it/s]
Adding requests:  75%|███████▍  | 3062/4096 [00:10<00:03, 305.50it/s]
Adding requests:  76%|███████▌  | 3093/4096 [00:10<00:03, 302.86it/s]
Adding requests:  76%|███████▋  | 3125/4096 [00:10<00:03, 306.64it/s]
Adding requests:  77%|███████▋  | 3156/4096 [00:10<00:03, 304.84it/s]
Adding requests:  78%|███████▊  | 3187/4096 [00:10<00:02, 305.84it/s]
Adding requests:  79%|███████▊  | 3219/4096 [00:11<00:02, 306.52it/s]
Adding requests:  79%|███████▉  | 3250/4096 [00:11<00:02, 305.08it/s]
Adding requests:  80%|████████  | 3281/4096 [00:11<00:02, 293.06it/s]
Adding requests:  81%|████████  | 3311/4096 [00:11<00:02, 289.11it/s]
Adding requests:  82%|████████▏ | 3343/4096 [00:11<00:02, 296.85it/s]
Adding requests:  82%|████████▏ | 3373/4096 [00:11<00:02, 297.47it/s]
Adding requests:  83%|████████▎ | 3403/4096 [00:11<00:02, 295.90it/s]
Adding requests:  84%|████████▍ | 3433/4096 [00:11<00:02, 294.73it/s]
Adding requests:  85%|████████▍ | 3464/4096 [00:11<00:02, 298.91it/s]
Adding requests:  85%|████████▌ | 3494/4096 [00:11<00:02, 298.76it/s]
Adding requests:  86%|████████▌ | 3529/4096 [00:12<00:01, 310.73it/s]
Adding requests:  87%|████████▋ | 3563/4096 [00:12<00:01, 318.83it/s]
Adding requests:  88%|████████▊ | 3595/4096 [00:12<00:01, 310.65it/s]
Adding requests:  89%|████████▊ | 3627/4096 [00:12<00:01, 311.85it/s]
Adding requests:  89%|████████▉ | 3659/4096 [00:12<00:01, 308.36it/s]
Adding requests:  90%|█████████ | 3690/4096 [00:12<00:01, 304.94it/s]
Adding requests:  91%|█████████ | 3721/4096 [00:12<00:01, 294.13it/s]
Adding requests:  92%|█████████▏| 3751/4096 [00:12<00:01, 288.80it/s]
Adding requests:  92%|█████████▏| 3780/4096 [00:12<00:01, 279.30it/s]
Adding requests:  93%|█████████▎| 3809/4096 [00:13<00:01, 275.79it/s]
Adding requests:  94%|█████████▍| 3841/4096 [00:13<00:00, 286.42it/s]
Adding requests:  94%|█████████▍| 3870/4096 [00:13<00:00, 287.36it/s]
Adding requests:  95%|█████████▌| 3900/4096 [00:13<00:00, 287.91it/s]
Adding requests:  96%|█████████▌| 3929/4096 [00:13<00:00, 285.73it/s]
Adding requests:  97%|█████████▋| 3961/4096 [00:13<00:00, 293.59it/s]
Adding requests:  97%|█████████▋| 3991/4096 [00:13<00:00, 291.80it/s]
Adding requests:  98%|█████████▊| 4021/4096 [00:13<00:00, 289.51it/s]
Adding requests:  99%|█████████▉| 4050/4096 [00:13<00:00, 289.04it/s]
Adding requests: 100%|█████████▉| 4081/4096 [00:13<00:00, 293.82it/s]
Adding requests: 100%|██████████| 4096/4096 [00:13<00:00, 292.60it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▍         | 188/4096 [00:01<00:32, 119.12it/s, est. speed input: 121978.02 toks/s, output: 119.12 toks/s]
Processed prompts:   5%|▌         | 220/4096 [00:03<01:20, 48.23it/s, est. speed input: 58274.30 toks/s, output: 56.91 toks/s]   
Processed prompts:   6%|▌         | 252/4096 [00:06<02:02, 31.40it/s, est. speed input: 41911.88 toks/s, output: 40.93 toks/s]
Processed prompts:   7%|▋         | 284/4096 [00:08<02:37, 24.21it/s, est. speed input: 34415.66 toks/s, output: 33.61 toks/s]
Processed prompts:   8%|▊         | 316/4096 [00:10<03:05, 20.40it/s, est. speed input: 30113.94 toks/s, output: 29.41 toks/s]
Processed prompts:   8%|▊         | 348/4096 [00:13<03:26, 18.16it/s, est. speed input: 27326.62 toks/s, output: 26.69 toks/s]
Processed prompts:   9%|▉         | 380/4096 [00:15<03:41, 16.76it/s, est. speed input: 25372.42 toks/s, output: 24.78 toks/s]
Processed prompts:  10%|█         | 412/4096 [00:17<03:52, 15.85it/s, est. speed input: 23920.96 toks/s, output: 23.36 toks/s]
Processed prompts:  11%|█         | 444/4096 [00:19<03:59, 15.24it/s, est. speed input: 22804.16 toks/s, output: 22.27 toks/s]
Processed prompts:  12%|█▏        | 476/4096 [00:22<04:04, 14.82it/s, est. speed input: 21916.77 toks/s, output: 21.40 toks/s]
Processed prompts:  12%|█▏        | 508/4096 [00:24<04:06, 14.54it/s, est. speed input: 21195.62 toks/s, output: 20.70 toks/s]
Processed prompts:  13%|█▎        | 540/4096 [00:26<04:08, 14.34it/s, est. speed input: 20595.81 toks/s, output: 20.11 toks/s]
Processed prompts:  14%|█▍        | 572/4096 [00:29<04:08, 14.19it/s, est. speed input: 20089.06 toks/s, output: 19.62 toks/s]
Processed prompts:  15%|█▍        | 604/4096 [00:31<04:07, 14.10it/s, est. speed input: 19658.21 toks/s, output: 19.20 toks/s]
Processed prompts:  16%|█▌        | 636/4096 [00:33<04:06, 14.02it/s, est. speed input: 19284.42 toks/s, output: 18.83 toks/s]
Processed prompts:  16%|█▋        | 668/4096 [00:36<04:05, 13.97it/s, est. speed input: 18957.02 toks/s, output: 18.51 toks/s]
Processed prompts:  17%|█▋        | 700/4096 [00:38<04:03, 13.93it/s, est. speed input: 18668.38 toks/s, output: 18.23 toks/s]
Processed prompts:  18%|█▊        | 732/4096 [00:40<04:01, 13.90it/s, est. speed input: 18413.07 toks/s, output: 17.98 toks/s]
Processed prompts:  19%|█▊        | 764/4096 [00:42<03:58, 14.00it/s, est. speed input: 18211.32 toks/s, output: 17.78 toks/s]
Processed prompts:  19%|█▉        | 796/4096 [00:45<03:56, 13.94it/s, est. speed input: 18003.33 toks/s, output: 17.58 toks/s]
Processed prompts:  20%|██        | 828/4096 [00:47<03:55, 13.91it/s, est. speed input: 17816.14 toks/s, output: 17.40 toks/s]
Processed prompts:  21%|██        | 860/4096 [00:49<03:53, 13.88it/s, est. speed input: 17645.61 toks/s, output: 17.23 toks/s]
Processed prompts:  22%|██▏       | 892/4096 [00:52<03:51, 13.85it/s, est. speed input: 17488.45 toks/s, output: 17.08 toks/s]
Processed prompts:  23%|██▎       | 924/4096 [00:54<03:49, 13.83it/s, est. speed input: 17345.38 toks/s, output: 16.94 toks/s]
Processed prompts:  23%|██▎       | 956/4096 [00:56<03:47, 13.82it/s, est. speed input: 17213.31 toks/s, output: 16.81 toks/s]
Processed prompts:  24%|██▍       | 988/4096 [00:59<03:45, 13.80it/s, est. speed input: 17090.99 toks/s, output: 16.69 toks/s]
Processed prompts:  25%|██▍       | 1020/4096 [01:01<03:43, 13.79it/s, est. speed input: 16977.80 toks/s, output: 16.58 toks/s]
Processed prompts:  26%|██▌       | 1052/4096 [01:03<03:40, 13.78it/s, est. speed input: 16872.59 toks/s, output: 16.48 toks/s]
Processed prompts:  26%|██▋       | 1084/4096 [01:06<03:38, 13.77it/s, est. speed input: 16774.55 toks/s, output: 16.38 toks/s]
Processed prompts:  27%|██▋       | 1116/4096 [01:08<03:36, 13.77it/s, est. speed input: 16683.69 toks/s, output: 16.29 toks/s]
Processed prompts:  28%|██▊       | 1148/4096 [01:10<03:34, 13.77it/s, est. speed input: 16598.38 toks/s, output: 16.21 toks/s]
Processed prompts:  29%|██▉       | 1180/4096 [01:13<03:31, 13.76it/s, est. speed input: 16518.35 toks/s, output: 16.13 toks/s]
Processed prompts:  30%|██▉       | 1212/4096 [01:15<03:29, 13.76it/s, est. speed input: 16442.80 toks/s, output: 16.06 toks/s]
Processed prompts:  30%|███       | 1244/4096 [01:17<03:27, 13.75it/s, est. speed input: 16371.66 toks/s, output: 15.99 toks/s]
Processed prompts:  31%|███       | 1276/4096 [01:20<03:25, 13.74it/s, est. speed input: 16304.13 toks/s, output: 15.92 toks/s]
Processed prompts:  32%|███▏      | 1308/4096 [01:22<03:23, 13.73it/s, est. speed input: 16240.19 toks/s, output: 15.86 toks/s]
Processed prompts:  33%|███▎      | 1340/4096 [01:24<03:20, 13.73it/s, est. speed input: 16180.42 toks/s, output: 15.80 toks/s]
Processed prompts:  33%|███▎      | 1372/4096 [01:27<03:18, 13.73it/s, est. speed input: 16123.25 toks/s, output: 15.75 toks/s]
Processed prompts:  34%|███▍      | 1404/4096 [01:29<03:15, 13.75it/s, est. speed input: 16071.55 toks/s, output: 15.69 toks/s]
Processed prompts:  35%|███▌      | 1436/4096 [01:31<03:13, 13.77it/s, est. speed input: 16023.00 toks/s, output: 15.65 toks/s]
Processed prompts:  36%|███▌      | 1468/4096 [01:34<03:10, 13.78it/s, est. speed input: 15976.56 toks/s, output: 15.60 toks/s]
Processed prompts:  37%|███▋      | 1500/4096 [01:36<03:08, 13.78it/s, est. speed input: 15931.96 toks/s, output: 15.56 toks/s]
Processed prompts:  37%|███▋      | 1532/4096 [01:38<03:05, 13.79it/s, est. speed input: 15889.38 toks/s, output: 15.52 toks/s]
Processed prompts:  38%|███▊      | 1564/4096 [01:41<03:03, 13.80it/s, est. speed input: 15850.21 toks/s, output: 15.48 toks/s]
Processed prompts:  39%|███▉      | 1596/4096 [01:43<03:01, 13.80it/s, est. speed input: 15811.30 toks/s, output: 15.44 toks/s]
Processed prompts:  40%|███▉      | 1628/4096 [01:45<02:57, 13.91it/s, est. speed input: 15783.64 toks/s, output: 15.41 toks/s]
Processed prompts:  41%|████      | 1660/4096 [01:47<02:55, 13.87it/s, est. speed input: 15747.77 toks/s, output: 15.38 toks/s]
Processed prompts:  41%|████▏     | 1692/4096 [01:50<02:53, 13.85it/s, est. speed input: 15713.70 toks/s, output: 15.35 toks/s]
Processed prompts:  42%|████▏     | 1724/4096 [01:52<02:51, 13.82it/s, est. speed input: 15680.35 toks/s, output: 15.31 toks/s]
Processed prompts:  43%|████▎     | 1756/4096 [01:54<02:49, 13.81it/s, est. speed input: 15648.59 toks/s, output: 15.28 toks/s]
Processed prompts:  44%|████▎     | 1788/4096 [01:57<02:47, 13.80it/s, est. speed input: 15618.16 toks/s, output: 15.25 toks/s]
Processed prompts:  44%|████▍     | 1820/4096 [01:59<02:44, 13.80it/s, est. speed input: 15588.97 toks/s, output: 15.22 toks/s]
Processed prompts:  45%|████▌     | 1852/4096 [02:01<02:42, 13.78it/s, est. speed input: 15560.28 toks/s, output: 15.20 toks/s]
Processed prompts:  46%|████▌     | 1884/4096 [02:04<02:40, 13.78it/s, est. speed input: 15533.21 toks/s, output: 15.17 toks/s]
Processed prompts:  47%|████▋     | 1916/4096 [02:06<02:38, 13.78it/s, est. speed input: 15506.83 toks/s, output: 15.14 toks/s]
Processed prompts:  48%|████▊     | 1948/4096 [02:08<02:35, 13.77it/s, est. speed input: 15481.39 toks/s, output: 15.12 toks/s]
Processed prompts:  48%|████▊     | 1980/4096 [02:11<02:33, 13.78it/s, est. speed input: 15457.04 toks/s, output: 15.09 toks/s]
Processed prompts:  49%|████▉     | 2012/4096 [02:13<02:31, 13.77it/s, est. speed input: 15433.34 toks/s, output: 15.07 toks/s]
Processed prompts:  50%|████▉     | 2044/4096 [02:15<02:29, 13.77it/s, est. speed input: 15410.45 toks/s, output: 15.05 toks/s]
Processed prompts:  51%|█████     | 2076/4096 [02:18<02:26, 13.77it/s, est. speed input: 15388.41 toks/s, output: 15.03 toks/s]
Processed prompts:  51%|█████▏    | 2108/4096 [02:20<02:24, 13.77it/s, est. speed input: 15366.93 toks/s, output: 15.01 toks/s]
Processed prompts:  52%|█████▏    | 2140/4096 [02:22<02:22, 13.76it/s, est. speed input: 15345.89 toks/s, output: 14.99 toks/s]
Processed prompts:  53%|█████▎    | 2172/4096 [02:25<02:18, 13.88it/s, est. speed input: 15332.64 toks/s, output: 14.97 toks/s]
Processed prompts:  54%|█████▍    | 2204/4096 [02:27<02:16, 13.84it/s, est. speed input: 15313.20 toks/s, output: 14.95 toks/s]
Processed prompts:  55%|█████▍    | 2236/4096 [02:29<02:14, 13.82it/s, est. speed input: 15294.19 toks/s, output: 14.94 toks/s]
Processed prompts:  55%|█████▌    | 2268/4096 [02:32<02:12, 13.80it/s, est. speed input: 15275.79 toks/s, output: 14.92 toks/s]
Processed prompts:  56%|█████▌    | 2300/4096 [02:34<02:10, 13.79it/s, est. speed input: 15258.16 toks/s, output: 14.90 toks/s]
Processed prompts:  57%|█████▋    | 2332/4096 [02:36<02:08, 13.78it/s, est. speed input: 15240.67 toks/s, output: 14.88 toks/s]
Processed prompts:  58%|█████▊    | 2364/4096 [02:39<02:05, 13.77it/s, est. speed input: 15223.59 toks/s, output: 14.87 toks/s]
Processed prompts:  58%|█████▊    | 2396/4096 [02:41<02:03, 13.76it/s, est. speed input: 15207.09 toks/s, output: 14.85 toks/s]
Processed prompts:  59%|█████▉    | 2428/4096 [02:43<02:01, 13.76it/s, est. speed input: 15191.27 toks/s, output: 14.84 toks/s]
Processed prompts:  60%|██████    | 2460/4096 [02:45<01:58, 13.76it/s, est. speed input: 15175.94 toks/s, output: 14.82 toks/s]
Processed prompts:  61%|██████    | 2492/4096 [02:48<01:56, 13.76it/s, est. speed input: 15160.84 toks/s, output: 14.81 toks/s]
Processed prompts:  62%|██████▏   | 2524/4096 [02:50<01:54, 13.76it/s, est. speed input: 15146.17 toks/s, output: 14.79 toks/s]
Processed prompts:  62%|██████▏   | 2556/4096 [02:52<01:51, 13.76it/s, est. speed input: 15131.92 toks/s, output: 14.78 toks/s]
Processed prompts:  63%|██████▎   | 2588/4096 [02:55<01:49, 13.76it/s, est. speed input: 15117.96 toks/s, output: 14.76 toks/s]
Processed prompts:  64%|██████▍   | 2620/4096 [02:57<01:47, 13.76it/s, est. speed input: 15104.49 toks/s, output: 14.75 toks/s]
Processed prompts:  65%|██████▍   | 2652/4096 [02:59<01:44, 13.76it/s, est. speed input: 15091.35 toks/s, output: 14.74 toks/s]
Processed prompts:  66%|██████▌   | 2684/4096 [03:02<01:42, 13.76it/s, est. speed input: 15078.48 toks/s, output: 14.73 toks/s]
Processed prompts:  66%|██████▋   | 2716/4096 [03:04<01:40, 13.76it/s, est. speed input: 15066.06 toks/s, output: 14.71 toks/s]
Processed prompts:  67%|██████▋   | 2748/4096 [03:06<01:37, 13.76it/s, est. speed input: 15053.84 toks/s, output: 14.70 toks/s]
Processed prompts:  68%|██████▊   | 2780/4096 [03:09<01:35, 13.76it/s, est. speed input: 15041.98 toks/s, output: 14.69 toks/s]
Processed prompts:  69%|██████▊   | 2812/4096 [03:11<01:33, 13.76it/s, est. speed input: 15030.43 toks/s, output: 14.68 toks/s]
Processed prompts:  69%|██████▉   | 2844/4096 [03:13<01:30, 13.76it/s, est. speed input: 15019.18 toks/s, output: 14.67 toks/s]
Processed prompts:  70%|███████   | 2876/4096 [03:16<01:28, 13.76it/s, est. speed input: 15008.22 toks/s, output: 14.66 toks/s]
Processed prompts:  71%|███████   | 2908/4096 [03:18<01:25, 13.87it/s, est. speed input: 15002.16 toks/s, output: 14.65 toks/s]
Processed prompts:  72%|███████▏  | 2940/4096 [03:20<01:23, 13.84it/s, est. speed input: 14991.51 toks/s, output: 14.64 toks/s]
Processed prompts:  73%|███████▎  | 2972/4096 [03:23<01:21, 13.81it/s, est. speed input: 14981.13 toks/s, output: 14.63 toks/s]
Processed prompts:  73%|███████▎  | 3004/4096 [03:25<01:19, 13.79it/s, est. speed input: 14970.95 toks/s, output: 14.62 toks/s]
Processed prompts:  74%|███████▍  | 3036/4096 [03:27<01:16, 13.78it/s, est. speed input: 14961.13 toks/s, output: 14.61 toks/s]
Processed prompts:  75%|███████▍  | 3068/4096 [03:30<01:14, 13.78it/s, est. speed input: 14951.50 toks/s, output: 14.60 toks/s]
Processed prompts:  76%|███████▌  | 3100/4096 [03:32<01:12, 13.77it/s, est. speed input: 14941.96 toks/s, output: 14.59 toks/s]
Processed prompts:  76%|███████▋  | 3132/4096 [03:34<01:10, 13.77it/s, est. speed input: 14932.70 toks/s, output: 14.58 toks/s]
Processed prompts:  77%|███████▋  | 3164/4096 [03:37<01:07, 13.77it/s, est. speed input: 14923.77 toks/s, output: 14.57 toks/s]
Processed prompts:  78%|███████▊  | 3196/4096 [03:39<01:05, 13.76it/s, est. speed input: 14914.82 toks/s, output: 14.57 toks/s]
Processed prompts:  79%|███████▉  | 3228/4096 [03:41<01:03, 13.76it/s, est. speed input: 14906.01 toks/s, output: 14.56 toks/s]
Processed prompts:  80%|███████▉  | 3260/4096 [03:44<01:00, 13.75it/s, est. speed input: 14897.33 toks/s, output: 14.55 toks/s]
Processed prompts:  80%|████████  | 3292/4096 [03:46<00:58, 13.75it/s, est. speed input: 14889.00 toks/s, output: 14.54 toks/s]
Processed prompts:  81%|████████  | 3324/4096 [03:48<00:56, 13.76it/s, est. speed input: 14880.90 toks/s, output: 14.53 toks/s]
Processed prompts:  82%|████████▏ | 3356/4096 [03:51<00:53, 13.76it/s, est. speed input: 14873.00 toks/s, output: 14.52 toks/s]
Processed prompts:  83%|████████▎ | 3388/4096 [03:53<00:51, 13.76it/s, est. speed input: 14865.21 toks/s, output: 14.52 toks/s]
Processed prompts:  83%|████████▎ | 3420/4096 [03:55<00:49, 13.76it/s, est. speed input: 14857.50 toks/s, output: 14.51 toks/s]
Processed prompts:  84%|████████▍ | 3452/4096 [03:58<00:46, 13.76it/s, est. speed input: 14850.11 toks/s, output: 14.50 toks/s]
Processed prompts:  85%|████████▌ | 3484/4096 [04:00<00:44, 13.76it/s, est. speed input: 14842.80 toks/s, output: 14.49 toks/s]
Processed prompts:  86%|████████▌ | 3516/4096 [04:02<00:42, 13.76it/s, est. speed input: 14835.62 toks/s, output: 14.49 toks/s]
Processed prompts:  87%|████████▋ | 3548/4096 [04:05<00:39, 13.76it/s, est. speed input: 14828.50 toks/s, output: 14.48 toks/s]
Processed prompts:  87%|████████▋ | 3580/4096 [04:07<00:37, 13.76it/s, est. speed input: 14821.64 toks/s, output: 14.47 toks/s]
Processed prompts:  88%|████████▊ | 3612/4096 [04:09<00:35, 13.76it/s, est. speed input: 14814.86 toks/s, output: 14.47 toks/s]
Processed prompts:  89%|████████▉ | 3644/4096 [04:11<00:32, 13.76it/s, est. speed input: 14808.03 toks/s, output: 14.46 toks/s]
Processed prompts:  90%|████████▉ | 3676/4096 [04:14<00:30, 13.87it/s, est. speed input: 14804.96 toks/s, output: 14.46 toks/s]
Processed prompts:  91%|█████████ | 3708/4096 [04:16<00:28, 13.83it/s, est. speed input: 14798.45 toks/s, output: 14.45 toks/s]
Processed prompts:  91%|█████████▏| 3740/4096 [04:18<00:25, 13.81it/s, est. speed input: 14792.09 toks/s, output: 14.45 toks/s]
Processed prompts:  92%|█████████▏| 3772/4096 [04:21<00:23, 13.79it/s, est. speed input: 14785.80 toks/s, output: 14.44 toks/s]
Processed prompts:  93%|█████████▎| 3804/4096 [04:23<00:21, 13.79it/s, est. speed input: 14779.73 toks/s, output: 14.43 toks/s]
Processed prompts:  94%|█████████▎| 3836/4096 [04:25<00:18, 13.78it/s, est. speed input: 14773.79 toks/s, output: 14.43 toks/s]
Processed prompts:  94%|█████████▍| 3868/4096 [04:28<00:16, 13.77it/s, est. speed input: 14767.77 toks/s, output: 14.42 toks/s]
Processed prompts:  95%|█████████▌| 3900/4096 [04:30<00:14, 13.76it/s, est. speed input: 14761.75 toks/s, output: 14.42 toks/s]
Processed prompts:  96%|█████████▌| 3932/4096 [04:32<00:11, 13.87it/s, est. speed input: 14759.33 toks/s, output: 14.41 toks/s]
Processed prompts:  97%|█████████▋| 3964/4096 [04:35<00:09, 13.83it/s, est. speed input: 14753.61 toks/s, output: 14.41 toks/s]
Processed prompts:  98%|█████████▊| 3996/4096 [04:37<00:07, 13.81it/s, est. speed input: 14747.89 toks/s, output: 14.40 toks/s]
Processed prompts:  98%|█████████▊| 4028/4096 [04:39<00:04, 13.78it/s, est. speed input: 14742.16 toks/s, output: 14.40 toks/s]
Processed prompts:  99%|█████████▉| 4060/4096 [04:42<00:02, 13.78it/s, est. speed input: 14736.87 toks/s, output: 14.39 toks/s]
Processed prompts: 100%|█████████▉| 4092/4096 [04:42<00:00, 18.41it/s, est. speed input: 14833.25 toks/s, output: 14.49 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [04:42<00:00, 18.41it/s, est. speed input: 14847.74 toks/s, output: 14.50 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [04:42<00:00, 14.50it/s, est. speed input: 14847.74 toks/s, output: 14.50 toks/s]
[rank0]:[W125 22:53:32.479163820 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=65536 ==========
Time: 2026-01-25 22:53:34
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=8192, max_num_seqs=64
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 8192 --max-num-seqs 64 --max-model-len 1025 --max-num-batched-tokens 65536 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-14B-INT8_M65536.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 22:54:40 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=549332) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=549332) WARNING 01-25 22:55:06 [backends.py:609] Failed to read file <frozen os>
Throughput: 13.76 requests/s, 14106.14 total tokens/s, 13.76 output tokens/s
Total num prompt tokens:  8388608
Total num output tokens:  8192

STDERR:
[2026-01-25 22:54:40] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 22:54:40] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-25 22:54:40] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-25 22:54:40] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:54:40] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:54:40] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:54:40] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:54:40] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:54:40] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-25 22:54:40] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 22:54:40] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 22:54:40] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 22:54:40] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 22:54:40] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 22:54:47] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 22:54:47] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-25 22:54:47] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-25 22:54:47] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:54:47] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:54:47] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:54:47] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:54:47] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 22:54:47] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-25 22:54:47] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 22:54:47] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 22:54:47] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 22:54:47] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 22:54:47] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=549332) [2026-01-25 22:54:49] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=549332) [2026-01-25 22:54:49] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=549332) [2026-01-25 22:54:49] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=549332) [2026-01-25 22:54:49] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=549332) [2026-01-25 22:54:49] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=549332) [2026-01-25 22:54:49] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=549332) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=549332) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.21it/s]
(EngineCore_DP0 pid=549332) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.75it/s]
(EngineCore_DP0 pid=549332) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.44it/s]
(EngineCore_DP0 pid=549332) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.26it/s]
(EngineCore_DP0 pid=549332) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.33it/s]
(EngineCore_DP0 pid=549332) 
(EngineCore_DP0 pid=549332) [2026-01-25 22:54:53] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 7680] -> 1D uint8
(EngineCore_DP0 pid=549332) [2026-01-25 22:54:53] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 41287680 bytes
(EngineCore_DP0 pid=549332) [2026-01-25 22:54:53] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 7680] -> 1D uint8
(EngineCore_DP0 pid=549332) [2026-01-25 22:54:53] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 29491200 bytes
(EngineCore_DP0 pid=549332) [2026-01-25 22:54:53] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 7680] -> 1D uint8
(EngineCore_DP0 pid=549332) [2026-01-25 22:54:53] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 159252480 bytes
(EngineCore_DP0 pid=549332) [2026-01-25 22:54:53] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 20736] -> 1D uint8
(EngineCore_DP0 pid=549332) [2026-01-25 22:54:53] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 79626240 bytes
(EngineCore_DP0 pid=549332) [rank0]:W0125 22:55:20.170000 549332 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=549332) [rank0]:W0125 22:55:20.252000 549332 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=549332) [rank0]:W0125 22:55:21.145000 549332 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=549332) [rank0]:W0125 22:55:21.273000 549332 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=549332) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/19 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   5%|▌         | 1/19 [00:00<00:05,  3.10it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  11%|█         | 2/19 [00:00<00:05,  3.10it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  16%|█▌        | 3/19 [00:00<00:03,  4.02it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  21%|██        | 4/19 [00:00<00:03,  4.77it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  26%|██▋       | 5/19 [00:01<00:02,  5.33it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  32%|███▏      | 6/19 [00:01<00:02,  5.72it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  37%|███▋      | 7/19 [00:01<00:02,  5.92it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  42%|████▏     | 8/19 [00:01<00:01,  6.09it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  47%|████▋     | 9/19 [00:01<00:01,  6.15it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  53%|█████▎    | 10/19 [00:01<00:01,  6.23it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  58%|█████▊    | 11/19 [00:02<00:01,  6.31it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  63%|██████▎   | 12/19 [00:02<00:01,  6.48it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  68%|██████▊   | 13/19 [00:02<00:00,  6.58it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  74%|███████▎  | 14/19 [00:02<00:00,  6.56it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  79%|███████▉  | 15/19 [00:02<00:00,  6.52it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  84%|████████▍ | 16/19 [00:02<00:00,  6.45it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  89%|████████▉ | 17/19 [00:02<00:00,  6.52it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  95%|█████████▍| 18/19 [00:03<00:00,  6.62it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 19/19 [00:03<00:00,  6.41it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 19/19 [00:03<00:00,  5.83it/s]
(EngineCore_DP0 pid=549332) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):   9%|▉         | 1/11 [00:00<00:01,  5.64it/s]
Capturing CUDA graphs (decode, FULL):  18%|█▊        | 2/11 [00:00<00:01,  6.06it/s]
Capturing CUDA graphs (decode, FULL):  27%|██▋       | 3/11 [00:00<00:01,  6.27it/s]
Capturing CUDA graphs (decode, FULL):  36%|███▋      | 4/11 [00:00<00:01,  6.41it/s]
Capturing CUDA graphs (decode, FULL):  45%|████▌     | 5/11 [00:00<00:00,  6.60it/s]
Capturing CUDA graphs (decode, FULL):  55%|█████▍    | 6/11 [00:00<00:00,  6.71it/s]
Capturing CUDA graphs (decode, FULL):  64%|██████▎   | 7/11 [00:01<00:00,  6.79it/s]
Capturing CUDA graphs (decode, FULL):  73%|███████▎  | 8/11 [00:01<00:00,  6.82it/s]
Capturing CUDA graphs (decode, FULL):  82%|████████▏ | 9/11 [00:01<00:00,  6.82it/s]
Capturing CUDA graphs (decode, FULL):  91%|█████████ | 10/11 [00:01<00:00,  6.63it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 11/11 [00:01<00:00,  6.70it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 11/11 [00:01<00:00,  6.60it/s]

Adding requests:   0%|          | 0/8192 [00:00<?, ?it/s]
Adding requests:   0%|          | 26/8192 [00:00<00:32, 252.43it/s]
Adding requests:   1%|          | 53/8192 [00:00<00:31, 262.42it/s]
Adding requests:   1%|          | 80/8192 [00:00<00:31, 257.52it/s]
Adding requests:   1%|▏         | 106/8192 [00:00<00:31, 254.65it/s]
Adding requests:   2%|▏         | 132/8192 [00:00<00:32, 251.59it/s]
Adding requests:   2%|▏         | 160/8192 [00:00<00:30, 259.35it/s]
Adding requests:   2%|▏         | 191/8192 [00:00<00:29, 273.93it/s]
Adding requests:   3%|▎         | 220/8192 [00:00<00:28, 277.54it/s]
Adding requests:   3%|▎         | 248/8192 [00:00<00:28, 275.29it/s]
Adding requests:   3%|▎         | 276/8192 [00:01<00:28, 275.71it/s]
Adding requests:   4%|▎         | 306/8192 [00:01<00:28, 281.34it/s]
Adding requests:   4%|▍         | 335/8192 [00:01<00:27, 282.68it/s]
Adding requests:   4%|▍         | 364/8192 [00:01<00:27, 280.01it/s]
Adding requests:   5%|▍         | 393/8192 [00:01<00:28, 276.78it/s]
Adding requests:   5%|▌         | 423/8192 [00:01<00:27, 282.02it/s]
Adding requests:   6%|▌         | 452/8192 [00:01<00:27, 281.73it/s]
Adding requests:   6%|▌         | 485/8192 [00:01<00:26, 294.51it/s]
Adding requests:   6%|▋         | 517/8192 [00:01<00:25, 301.41it/s]
Adding requests:   7%|▋         | 548/8192 [00:01<00:25, 299.14it/s]
Adding requests:   7%|▋         | 578/8192 [00:02<00:25, 298.29it/s]
Adding requests:   7%|▋         | 608/8192 [00:02<00:26, 286.39it/s]
Adding requests:   8%|▊         | 637/8192 [00:02<00:27, 278.93it/s]
Adding requests:   8%|▊         | 665/8192 [00:02<00:27, 269.51it/s]
Adding requests:   8%|▊         | 694/8192 [00:02<00:27, 274.90it/s]
Adding requests:   9%|▉         | 724/8192 [00:02<00:26, 279.45it/s]
Adding requests:   9%|▉         | 755/8192 [00:02<00:26, 285.76it/s]
Adding requests:  10%|▉         | 787/8192 [00:02<00:25, 293.19it/s]
Adding requests:  10%|▉         | 817/8192 [00:02<00:25, 292.94it/s]
Adding requests:  10%|█         | 850/8192 [00:03<00:24, 301.48it/s]
Adding requests:  11%|█         | 883/8192 [00:03<00:23, 307.04it/s]
Adding requests:  11%|█         | 914/8192 [00:03<00:24, 296.37it/s]
Adding requests:  12%|█▏        | 944/8192 [00:03<00:24, 294.16it/s]
Adding requests:  12%|█▏        | 975/8192 [00:03<00:24, 296.60it/s]
Adding requests:  12%|█▏        | 1005/8192 [00:03<00:24, 291.98it/s]
Adding requests:  13%|█▎        | 1035/8192 [00:03<00:24, 293.84it/s]
Adding requests:  13%|█▎        | 1065/8192 [00:03<00:24, 293.73it/s]
Adding requests:  13%|█▎        | 1095/8192 [00:03<00:24, 292.19it/s]
Adding requests:  14%|█▎        | 1125/8192 [00:03<00:24, 289.42it/s]
Adding requests:  14%|█▍        | 1155/8192 [00:04<00:24, 291.77it/s]
Adding requests:  14%|█▍        | 1186/8192 [00:04<00:23, 295.60it/s]
Adding requests:  15%|█▍        | 1216/8192 [00:04<00:23, 294.72it/s]
Adding requests:  15%|█▌        | 1246/8192 [00:04<00:23, 295.54it/s]
Adding requests:  16%|█▌        | 1276/8192 [00:04<00:23, 290.42it/s]
Adding requests:  16%|█▌        | 1306/8192 [00:04<00:24, 285.79it/s]
Adding requests:  16%|█▋        | 1336/8192 [00:04<00:23, 289.34it/s]
Adding requests:  17%|█▋        | 1369/8192 [00:04<00:22, 299.56it/s]
Adding requests:  17%|█▋        | 1399/8192 [00:04<00:22, 298.66it/s]
Adding requests:  17%|█▋        | 1429/8192 [00:04<00:23, 292.93it/s]
Adding requests:  18%|█▊        | 1460/8192 [00:05<00:22, 296.25it/s]
Adding requests:  18%|█▊        | 1493/8192 [00:05<00:21, 305.46it/s]
Adding requests:  19%|█▊        | 1524/8192 [00:05<00:22, 295.47it/s]
Adding requests:  19%|█▉        | 1554/8192 [00:05<00:22, 289.14it/s]
Adding requests:  19%|█▉        | 1583/8192 [00:05<00:22, 287.52it/s]
Adding requests:  20%|█▉        | 1613/8192 [00:05<00:22, 288.31it/s]
Adding requests:  20%|██        | 1642/8192 [00:05<00:23, 282.33it/s]
Adding requests:  20%|██        | 1671/8192 [00:05<00:23, 282.10it/s]
Adding requests:  21%|██        | 1702/8192 [00:05<00:22, 288.94it/s]
Adding requests:  21%|██        | 1734/8192 [00:06<00:21, 295.58it/s]
Adding requests:  22%|██▏       | 1768/8192 [00:06<00:20, 307.00it/s]
Adding requests:  22%|██▏       | 1799/8192 [00:06<00:21, 294.95it/s]
Adding requests:  22%|██▏       | 1829/8192 [00:06<00:21, 290.30it/s]
Adding requests:  23%|██▎       | 1859/8192 [00:06<00:22, 287.06it/s]
Adding requests:  23%|██▎       | 1890/8192 [00:06<00:21, 290.98it/s]
Adding requests:  23%|██▎       | 1920/8192 [00:06<00:21, 288.48it/s]
Adding requests:  24%|██▍       | 1952/8192 [00:06<00:21, 296.87it/s]
Adding requests:  24%|██▍       | 1982/8192 [00:06<00:20, 296.51it/s]
Adding requests:  25%|██▍       | 2012/8192 [00:06<00:21, 293.52it/s]
Adding requests:  25%|██▍       | 2042/8192 [00:07<00:20, 293.89it/s]
Adding requests:  25%|██▌       | 2072/8192 [00:07<00:21, 286.14it/s]
Adding requests:  26%|██▌       | 2102/8192 [00:07<00:21, 288.34it/s]
Adding requests:  26%|██▌       | 2131/8192 [00:07<00:21, 288.06it/s]
Adding requests:  26%|██▋       | 2161/8192 [00:07<00:20, 289.32it/s]
Adding requests:  27%|██▋       | 2190/8192 [00:07<00:20, 287.67it/s]
Adding requests:  27%|██▋       | 2220/8192 [00:07<00:20, 290.65it/s]
Adding requests:  27%|██▋       | 2250/8192 [00:07<00:20, 293.31it/s]
Adding requests:  28%|██▊       | 2283/8192 [00:07<00:19, 302.51it/s]
Adding requests:  28%|██▊       | 2315/8192 [00:08<00:19, 306.36it/s]
Adding requests:  29%|██▊       | 2348/8192 [00:08<00:18, 311.29it/s]
Adding requests:  29%|██▉       | 2380/8192 [00:08<00:18, 306.94it/s]
Adding requests:  29%|██▉       | 2412/8192 [00:08<00:18, 310.18it/s]
Adding requests:  30%|██▉       | 2444/8192 [00:08<00:19, 300.85it/s]
Adding requests:  30%|███       | 2475/8192 [00:08<00:19, 300.53it/s]
Adding requests:  31%|███       | 2508/8192 [00:08<00:18, 306.08it/s]
Adding requests:  31%|███       | 2539/8192 [00:08<00:18, 299.94it/s]
Adding requests:  31%|███▏      | 2570/8192 [00:08<00:18, 302.04it/s]
Adding requests:  32%|███▏      | 2601/8192 [00:08<00:18, 301.83it/s]
Adding requests:  32%|███▏      | 2632/8192 [00:09<00:19, 292.63it/s]
Adding requests:  32%|███▏      | 2662/8192 [00:09<00:19, 289.81it/s]
Adding requests:  33%|███▎      | 2692/8192 [00:09<00:19, 286.56it/s]
Adding requests:  33%|███▎      | 2721/8192 [00:09<00:19, 280.21it/s]
Adding requests:  34%|███▎      | 2750/8192 [00:09<00:19, 282.88it/s]
Adding requests:  34%|███▍      | 2783/8192 [00:09<00:18, 295.34it/s]
Adding requests:  34%|███▍      | 2816/8192 [00:09<00:17, 304.57it/s]
Adding requests:  35%|███▍      | 2847/8192 [00:09<00:17, 302.17it/s]
Adding requests:  35%|███▌      | 2878/8192 [00:09<00:18, 295.10it/s]
Adding requests:  35%|███▌      | 2908/8192 [00:10<00:17, 294.48it/s]
Adding requests:  36%|███▌      | 2941/8192 [00:10<00:17, 302.95it/s]
Adding requests:  36%|███▋      | 2972/8192 [00:10<00:17, 302.99it/s]
Adding requests:  37%|███▋      | 3006/8192 [00:10<00:16, 311.73it/s]
Adding requests:  37%|███▋      | 3038/8192 [00:10<00:16, 313.31it/s]
Adding requests:  37%|███▋      | 3070/8192 [00:10<00:16, 310.21it/s]
Adding requests:  38%|███▊      | 3102/8192 [00:10<00:16, 310.83it/s]
Adding requests:  38%|███▊      | 3134/8192 [00:10<00:16, 308.38it/s]
Adding requests:  39%|███▊      | 3165/8192 [00:10<00:16, 297.58it/s]
Adding requests:  39%|███▉      | 3195/8192 [00:10<00:16, 295.81it/s]
Adding requests:  39%|███▉      | 3228/8192 [00:11<00:16, 304.45it/s]
Adding requests:  40%|███▉      | 3260/8192 [00:11<00:16, 306.39it/s]
Adding requests:  40%|████      | 3291/8192 [00:11<00:16, 293.15it/s]
Adding requests:  41%|████      | 3321/8192 [00:11<00:16, 289.47it/s]
Adding requests:  41%|████      | 3351/8192 [00:11<00:16, 289.15it/s]
Adding requests:  41%|████▏     | 3380/8192 [00:11<00:16, 287.25it/s]
Adding requests:  42%|████▏     | 3411/8192 [00:11<00:16, 293.76it/s]
Adding requests:  42%|████▏     | 3443/8192 [00:11<00:15, 301.34it/s]
Adding requests:  42%|████▏     | 3474/8192 [00:11<00:15, 299.94it/s]
Adding requests:  43%|████▎     | 3505/8192 [00:11<00:15, 294.47it/s]
Adding requests:  43%|████▎     | 3538/8192 [00:12<00:15, 303.58it/s]
Adding requests:  44%|████▎     | 3569/8192 [00:12<00:15, 304.25it/s]
Adding requests:  44%|████▍     | 3600/8192 [00:12<00:15, 296.74it/s]
Adding requests:  44%|████▍     | 3630/8192 [00:12<00:15, 296.88it/s]
Adding requests:  45%|████▍     | 3660/8192 [00:12<00:15, 295.58it/s]
Adding requests:  45%|████▌     | 3690/8192 [00:12<00:15, 293.82it/s]
Adding requests:  45%|████▌     | 3722/8192 [00:12<00:14, 300.74it/s]
Adding requests:  46%|████▌     | 3753/8192 [00:12<00:15, 289.38it/s]
Adding requests:  46%|████▌     | 3783/8192 [00:12<00:15, 279.36it/s]
Adding requests:  47%|████▋     | 3812/8192 [00:13<00:16, 271.68it/s]
Adding requests:  47%|████▋     | 3843/8192 [00:13<00:15, 282.17it/s]
Adding requests:  47%|████▋     | 3872/8192 [00:13<00:15, 284.08it/s]
Adding requests:  48%|████▊     | 3901/8192 [00:13<00:15, 285.78it/s]
Adding requests:  48%|████▊     | 3930/8192 [00:13<00:14, 286.20it/s]
Adding requests:  48%|████▊     | 3961/8192 [00:13<00:14, 291.37it/s]
Adding requests:  49%|████▊     | 3991/8192 [00:13<00:14, 291.49it/s]
Adding requests:  49%|████▉     | 4022/8192 [00:13<00:14, 295.45it/s]
Adding requests:  49%|████▉     | 4052/8192 [00:13<00:14, 294.82it/s]
Adding requests:  50%|████▉     | 4082/8192 [00:13<00:13, 296.19it/s]
Adding requests:  50%|█████     | 4114/8192 [00:14<00:13, 301.64it/s]
Adding requests:  51%|█████     | 4145/8192 [00:14<00:13, 300.50it/s]
Adding requests:  51%|█████     | 4177/8192 [00:14<00:13, 304.46it/s]
Adding requests:  51%|█████▏    | 4208/8192 [00:14<00:13, 300.50it/s]
Adding requests:  52%|█████▏    | 4240/8192 [00:14<00:12, 305.07it/s]
Adding requests:  52%|█████▏    | 4271/8192 [00:14<00:13, 295.44it/s]
Adding requests:  53%|█████▎    | 4301/8192 [00:14<00:13, 289.17it/s]
Adding requests:  53%|█████▎    | 4331/8192 [00:14<00:13, 290.18it/s]
Adding requests:  53%|█████▎    | 4361/8192 [00:14<00:13, 291.34it/s]
Adding requests:  54%|█████▎    | 4391/8192 [00:15<00:13, 286.17it/s]
Adding requests:  54%|█████▍    | 4423/8192 [00:15<00:12, 294.65it/s]
Adding requests:  54%|█████▍    | 4454/8192 [00:15<00:12, 297.02it/s]
Adding requests:  55%|█████▍    | 4486/8192 [00:15<00:12, 302.92it/s]
Adding requests:  55%|█████▌    | 4517/8192 [00:15<00:12, 293.94it/s]
Adding requests:  56%|█████▌    | 4549/8192 [00:15<00:12, 298.70it/s]
Adding requests:  56%|█████▌    | 4579/8192 [00:15<00:12, 297.17it/s]
Adding requests:  56%|█████▋    | 4609/8192 [00:15<00:12, 295.10it/s]
Adding requests:  57%|█████▋    | 4639/8192 [00:15<00:12, 295.16it/s]
Adding requests:  57%|█████▋    | 4669/8192 [00:15<00:12, 293.38it/s]
Adding requests:  57%|█████▋    | 4699/8192 [00:16<00:12, 290.04it/s]
Adding requests:  58%|█████▊    | 4732/8192 [00:16<00:11, 300.18it/s]
Adding requests:  58%|█████▊    | 4765/8192 [00:16<00:11, 307.92it/s]
Adding requests:  59%|█████▊    | 4796/8192 [00:16<00:11, 295.47it/s]
Adding requests:  59%|█████▉    | 4826/8192 [00:16<00:11, 296.52it/s]
Adding requests:  59%|█████▉    | 4856/8192 [00:16<00:11, 297.43it/s]
Adding requests:  60%|█████▉    | 4886/8192 [00:16<00:11, 293.26it/s]
Adding requests:  60%|██████    | 4917/8192 [00:16<00:11, 296.10it/s]
Adding requests:  60%|██████    | 4949/8192 [00:16<00:10, 300.74it/s]
Adding requests:  61%|██████    | 4980/8192 [00:16<00:10, 303.41it/s]
Adding requests:  61%|██████    | 5011/8192 [00:17<00:10, 299.05it/s]
Adding requests:  62%|██████▏   | 5043/8192 [00:17<00:10, 304.64it/s]
Adding requests:  62%|██████▏   | 5074/8192 [00:17<00:10, 297.63it/s]
Adding requests:  62%|██████▏   | 5104/8192 [00:17<00:10, 291.05it/s]
Adding requests:  63%|██████▎   | 5136/8192 [00:17<00:10, 297.73it/s]
Adding requests:  63%|██████▎   | 5167/8192 [00:17<00:10, 300.85it/s]
Adding requests:  63%|██████▎   | 5198/8192 [00:17<00:10, 290.16it/s]
Adding requests:  64%|██████▍   | 5228/8192 [00:17<00:10, 287.82it/s]
Adding requests:  64%|██████▍   | 5257/8192 [00:17<00:10, 286.84it/s]
Adding requests:  65%|██████▍   | 5290/8192 [00:18<00:09, 296.40it/s]
Adding requests:  65%|██████▍   | 5321/8192 [00:18<00:09, 298.60it/s]
Adding requests:  65%|██████▌   | 5351/8192 [00:18<00:09, 297.74it/s]
Adding requests:  66%|██████▌   | 5381/8192 [00:18<00:09, 294.71it/s]
Adding requests:  66%|██████▌   | 5411/8192 [00:18<00:09, 287.04it/s]
Adding requests:  66%|██████▋   | 5443/8192 [00:18<00:09, 294.54it/s]
Adding requests:  67%|██████▋   | 5475/8192 [00:18<00:09, 301.00it/s]
Adding requests:  67%|██████▋   | 5506/8192 [00:18<00:08, 298.90it/s]
Adding requests:  68%|██████▊   | 5536/8192 [00:18<00:09, 289.38it/s]
Adding requests:  68%|██████▊   | 5566/8192 [00:18<00:09, 288.17it/s]
Adding requests:  68%|██████▊   | 5597/8192 [00:19<00:08, 291.78it/s]
Adding requests:  69%|██████▊   | 5627/8192 [00:19<00:08, 291.38it/s]
Adding requests:  69%|██████▉   | 5657/8192 [00:19<00:08, 293.53it/s]
Adding requests:  69%|██████▉   | 5687/8192 [00:19<00:08, 293.04it/s]
Adding requests:  70%|██████▉   | 5719/8192 [00:19<00:08, 300.33it/s]
Adding requests:  70%|███████   | 5750/8192 [00:19<00:08, 301.62it/s]
Adding requests:  71%|███████   | 5781/8192 [00:19<00:07, 303.83it/s]
Adding requests:  71%|███████   | 5813/8192 [00:19<00:07, 307.71it/s]
Adding requests:  71%|███████▏  | 5844/8192 [00:19<00:07, 301.51it/s]
Adding requests:  72%|███████▏  | 5875/8192 [00:20<00:07, 294.99it/s]
Adding requests:  72%|███████▏  | 5906/8192 [00:20<00:07, 298.18it/s]
Adding requests:  72%|███████▏  | 5939/8192 [00:20<00:07, 306.41it/s]
Adding requests:  73%|███████▎  | 5971/8192 [00:20<00:07, 310.19it/s]
Adding requests:  73%|███████▎  | 6003/8192 [00:20<00:07, 306.33it/s]
Adding requests:  74%|███████▎  | 6034/8192 [00:20<00:07, 306.38it/s]
Adding requests:  74%|███████▍  | 6066/8192 [00:20<00:06, 307.61it/s]
Adding requests:  74%|███████▍  | 6097/8192 [00:20<00:06, 304.65it/s]
Adding requests:  75%|███████▍  | 6128/8192 [00:20<00:06, 301.52it/s]
Adding requests:  75%|███████▌  | 6159/8192 [00:20<00:06, 300.19it/s]
Adding requests:  76%|███████▌  | 6190/8192 [00:21<00:06, 292.23it/s]
Adding requests:  76%|███████▌  | 6220/8192 [00:21<00:06, 290.62it/s]
Adding requests:  76%|███████▋  | 6250/8192 [00:21<00:06, 288.78it/s]
Adding requests:  77%|███████▋  | 6280/8192 [00:21<00:06, 289.12it/s]
Adding requests:  77%|███████▋  | 6311/8192 [00:21<00:06, 293.84it/s]
Adding requests:  77%|███████▋  | 6345/8192 [00:21<00:06, 305.14it/s]
Adding requests:  78%|███████▊  | 6377/8192 [00:21<00:05, 308.34it/s]
Adding requests:  78%|███████▊  | 6408/8192 [00:21<00:05, 302.87it/s]
Adding requests:  79%|███████▊  | 6439/8192 [00:21<00:06, 291.67it/s]
Adding requests:  79%|███████▉  | 6469/8192 [00:22<00:05, 293.44it/s]
Adding requests:  79%|███████▉  | 6499/8192 [00:22<00:05, 295.00it/s]
Adding requests:  80%|███████▉  | 6532/8192 [00:22<00:05, 303.18it/s]
Adding requests:  80%|████████  | 6563/8192 [00:22<00:05, 303.26it/s]
Adding requests:  80%|████████  | 6594/8192 [00:22<00:05, 298.10it/s]
Adding requests:  81%|████████  | 6626/8192 [00:22<00:05, 302.66it/s]
Adding requests:  81%|████████▏ | 6659/8192 [00:22<00:04, 308.43it/s]
Adding requests:  82%|████████▏ | 6690/8192 [00:22<00:04, 305.76it/s]
Adding requests:  82%|████████▏ | 6722/8192 [00:22<00:04, 308.64it/s]
Adding requests:  82%|████████▏ | 6753/8192 [00:22<00:04, 303.79it/s]
Adding requests:  83%|████████▎ | 6785/8192 [00:23<00:04, 307.29it/s]
Adding requests:  83%|████████▎ | 6816/8192 [00:23<00:04, 302.22it/s]
Adding requests:  84%|████████▎ | 6847/8192 [00:23<00:04, 297.74it/s]
Adding requests:  84%|████████▍ | 6877/8192 [00:23<00:04, 295.36it/s]
Adding requests:  84%|████████▍ | 6907/8192 [00:23<00:04, 293.04it/s]
Adding requests:  85%|████████▍ | 6940/8192 [00:23<00:04, 302.47it/s]
Adding requests:  85%|████████▌ | 6971/8192 [00:23<00:04, 295.67it/s]
Adding requests:  85%|████████▌ | 7002/8192 [00:23<00:03, 299.69it/s]
Adding requests:  86%|████████▌ | 7033/8192 [00:23<00:03, 299.91it/s]
Adding requests:  86%|████████▌ | 7064/8192 [00:23<00:03, 288.76it/s]
Adding requests:  87%|████████▋ | 7093/8192 [00:24<00:03, 286.49it/s]
Adding requests:  87%|████████▋ | 7123/8192 [00:24<00:03, 287.68it/s]
Adding requests:  87%|████████▋ | 7152/8192 [00:24<00:03, 288.20it/s]
Adding requests:  88%|████████▊ | 7185/8192 [00:24<00:03, 297.02it/s]
Adding requests:  88%|████████▊ | 7219/8192 [00:24<00:03, 306.46it/s]
Adding requests:  89%|████████▊ | 7250/8192 [00:24<00:03, 299.03it/s]
Adding requests:  89%|████████▉ | 7283/8192 [00:24<00:02, 305.63it/s]
Adding requests:  89%|████████▉ | 7314/8192 [00:24<00:02, 304.57it/s]
Adding requests:  90%|████████▉ | 7345/8192 [00:24<00:02, 301.54it/s]
Adding requests:  90%|█████████ | 7376/8192 [00:25<00:02, 297.28it/s]
Adding requests:  90%|█████████ | 7406/8192 [00:25<00:02, 296.83it/s]
Adding requests:  91%|█████████ | 7436/8192 [00:25<00:02, 296.57it/s]
Adding requests:  91%|█████████ | 7466/8192 [00:25<00:02, 293.20it/s]
Adding requests:  92%|█████████▏| 7496/8192 [00:25<00:02, 288.92it/s]
Adding requests:  92%|█████████▏| 7526/8192 [00:25<00:02, 289.75it/s]
Adding requests:  92%|█████████▏| 7557/8192 [00:25<00:02, 295.58it/s]
Adding requests:  93%|█████████▎| 7587/8192 [00:25<00:02, 291.03it/s]
Adding requests:  93%|█████████▎| 7618/8192 [00:25<00:01, 296.46it/s]
Adding requests:  93%|█████████▎| 7649/8192 [00:25<00:01, 297.70it/s]
Adding requests:  94%|█████████▍| 7682/8192 [00:26<00:01, 304.85it/s]
Adding requests:  94%|█████████▍| 7714/8192 [00:26<00:01, 307.02it/s]
Adding requests:  95%|█████████▍| 7745/8192 [00:26<00:01, 306.64it/s]
Adding requests:  95%|█████████▍| 7776/8192 [00:26<00:01, 306.18it/s]
Adding requests:  95%|█████████▌| 7807/8192 [00:26<00:01, 305.41it/s]
Adding requests:  96%|█████████▌| 7838/8192 [00:26<00:01, 302.38it/s]
Adding requests:  96%|█████████▌| 7869/8192 [00:26<00:01, 301.97it/s]
Adding requests:  96%|█████████▋| 7900/8192 [00:26<00:00, 303.81it/s]
Adding requests:  97%|█████████▋| 7932/8192 [00:26<00:00, 308.19it/s]
Adding requests:  97%|█████████▋| 7963/8192 [00:26<00:00, 305.03it/s]
Adding requests:  98%|█████████▊| 7994/8192 [00:27<00:00, 300.33it/s]
Adding requests:  98%|█████████▊| 8025/8192 [00:27<00:00, 291.23it/s]
Adding requests:  98%|█████████▊| 8055/8192 [00:27<00:00, 291.11it/s]
Adding requests:  99%|█████████▊| 8088/8192 [00:27<00:00, 299.65it/s]
Adding requests:  99%|█████████▉| 8119/8192 [00:27<00:00, 286.91it/s]
Adding requests:  99%|█████████▉| 8148/8192 [00:27<00:00, 283.21it/s]
Adding requests: 100%|█████████▉| 8177/8192 [00:27<00:00, 284.25it/s]
Adding requests: 100%|██████████| 8192/8192 [00:27<00:00, 294.83it/s]

Processed prompts:   0%|          | 0/8192 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   4%|▍         | 347/8192 [00:01<00:33, 232.08it/s, est. speed input: 237653.51 toks/s, output: 232.08 toks/s]
Processed prompts:   5%|▌         | 411/8192 [00:06<02:23, 54.30it/s, est. speed input: 68990.34 toks/s, output: 67.37 toks/s]   
Processed prompts:   6%|▌         | 475/8192 [00:10<03:56, 32.57it/s, est. speed input: 45433.18 toks/s, output: 44.37 toks/s]
Processed prompts:   7%|▋         | 539/8192 [00:15<05:13, 24.43it/s, est. speed input: 36019.62 toks/s, output: 35.18 toks/s]
Processed prompts:   7%|▋         | 603/8192 [00:19<06:12, 20.37it/s, est. speed input: 30960.12 toks/s, output: 30.23 toks/s]
Processed prompts:   8%|▊         | 667/8192 [00:24<06:56, 18.06it/s, est. speed input: 27802.84 toks/s, output: 27.15 toks/s]
Processed prompts:   9%|▉         | 731/8192 [00:29<07:26, 16.72it/s, est. speed input: 25696.41 toks/s, output: 25.09 toks/s]
Processed prompts:  10%|▉         | 795/8192 [00:33<07:49, 15.76it/s, est. speed input: 24107.49 toks/s, output: 23.54 toks/s]
Processed prompts:  10%|█         | 859/8192 [00:38<08:04, 15.13it/s, est. speed input: 22899.06 toks/s, output: 22.36 toks/s]
Processed prompts:  11%|█▏        | 923/8192 [00:43<08:13, 14.72it/s, est. speed input: 21957.87 toks/s, output: 21.44 toks/s]
Processed prompts:  12%|█▏        | 987/8192 [00:47<08:18, 14.45it/s, est. speed input: 21203.10 toks/s, output: 20.71 toks/s]
Processed prompts:  13%|█▎        | 1051/8192 [00:52<08:20, 14.26it/s, est. speed input: 20578.98 toks/s, output: 20.10 toks/s]
Processed prompts:  14%|█▎        | 1115/8192 [00:56<08:20, 14.13it/s, est. speed input: 20056.72 toks/s, output: 19.59 toks/s]
Processed prompts:  14%|█▍        | 1179/8192 [01:01<08:19, 14.03it/s, est. speed input: 19610.79 toks/s, output: 19.15 toks/s]
Processed prompts:  15%|█▌        | 1243/8192 [01:06<08:17, 13.96it/s, est. speed input: 19226.77 toks/s, output: 18.78 toks/s]
Processed prompts:  16%|█▌        | 1307/8192 [01:10<08:14, 13.91it/s, est. speed input: 18892.55 toks/s, output: 18.45 toks/s]
Processed prompts:  17%|█▋        | 1371/8192 [01:15<08:11, 13.88it/s, est. speed input: 18600.09 toks/s, output: 18.16 toks/s]
Processed prompts:  18%|█▊        | 1435/8192 [01:20<08:07, 13.85it/s, est. speed input: 18339.81 toks/s, output: 17.91 toks/s]
Processed prompts:  18%|█▊        | 1499/8192 [01:24<08:04, 13.82it/s, est. speed input: 18106.94 toks/s, output: 17.68 toks/s]
Processed prompts:  19%|█▉        | 1563/8192 [01:29<08:00, 13.81it/s, est. speed input: 17898.45 toks/s, output: 17.48 toks/s]
Processed prompts:  20%|█▉        | 1627/8192 [01:34<07:54, 13.85it/s, est. speed input: 17721.91 toks/s, output: 17.31 toks/s]
Processed prompts:  21%|██        | 1691/8192 [01:38<07:50, 13.82it/s, est. speed input: 17550.10 toks/s, output: 17.14 toks/s]
Processed prompts:  21%|██▏       | 1755/8192 [01:43<07:46, 13.79it/s, est. speed input: 17392.08 toks/s, output: 16.98 toks/s]
Processed prompts:  22%|██▏       | 1819/8192 [01:47<07:42, 13.78it/s, est. speed input: 17249.37 toks/s, output: 16.85 toks/s]
Processed prompts:  23%|██▎       | 1883/8192 [01:52<07:38, 13.76it/s, est. speed input: 17117.39 toks/s, output: 16.72 toks/s]
Processed prompts:  24%|██▍       | 1947/8192 [01:57<07:33, 13.76it/s, est. speed input: 16996.27 toks/s, output: 16.60 toks/s]
Processed prompts:  25%|██▍       | 2011/8192 [02:01<07:29, 13.74it/s, est. speed input: 16883.32 toks/s, output: 16.49 toks/s]
Processed prompts:  25%|██▌       | 2075/8192 [02:06<07:25, 13.74it/s, est. speed input: 16778.88 toks/s, output: 16.39 toks/s]
Processed prompts:  26%|██▌       | 2139/8192 [02:11<07:19, 13.79it/s, est. speed input: 16689.89 toks/s, output: 16.30 toks/s]
Processed prompts:  27%|██▋       | 2203/8192 [02:15<07:14, 13.77it/s, est. speed input: 16599.98 toks/s, output: 16.21 toks/s]
Processed prompts:  28%|██▊       | 2267/8192 [02:20<07:10, 13.76it/s, est. speed input: 16515.60 toks/s, output: 16.13 toks/s]
Processed prompts:  28%|██▊       | 2331/8192 [02:25<07:06, 13.74it/s, est. speed input: 16435.94 toks/s, output: 16.05 toks/s]
Processed prompts:  29%|██▉       | 2395/8192 [02:29<07:02, 13.73it/s, est. speed input: 16361.25 toks/s, output: 15.98 toks/s]
Processed prompts:  30%|███       | 2459/8192 [02:34<06:57, 13.72it/s, est. speed input: 16290.70 toks/s, output: 15.91 toks/s]
Processed prompts:  31%|███       | 2523/8192 [02:39<06:53, 13.72it/s, est. speed input: 16224.59 toks/s, output: 15.84 toks/s]
Processed prompts:  32%|███▏      | 2587/8192 [02:43<06:48, 13.71it/s, est. speed input: 16162.05 toks/s, output: 15.78 toks/s]
Processed prompts:  32%|███▏      | 2651/8192 [02:48<06:44, 13.71it/s, est. speed input: 16102.95 toks/s, output: 15.73 toks/s]
Processed prompts:  33%|███▎      | 2715/8192 [02:53<06:39, 13.70it/s, est. speed input: 16046.82 toks/s, output: 15.67 toks/s]
Processed prompts:  34%|███▍      | 2779/8192 [02:57<06:34, 13.71it/s, est. speed input: 15994.28 toks/s, output: 15.62 toks/s]
Processed prompts:  35%|███▍      | 2843/8192 [03:02<06:30, 13.71it/s, est. speed input: 15944.24 toks/s, output: 15.57 toks/s]
Processed prompts:  35%|███▌      | 2907/8192 [03:07<06:23, 13.76it/s, est. speed input: 15902.00 toks/s, output: 15.53 toks/s]
Processed prompts:  36%|███▋      | 2971/8192 [03:11<06:19, 13.74it/s, est. speed input: 15856.41 toks/s, output: 15.48 toks/s]
Processed prompts:  37%|███▋      | 3035/8192 [03:16<06:15, 13.73it/s, est. speed input: 15813.01 toks/s, output: 15.44 toks/s]
Processed prompts:  38%|███▊      | 3099/8192 [03:21<06:11, 13.72it/s, est. speed input: 15771.76 toks/s, output: 15.40 toks/s]
Processed prompts:  39%|███▊      | 3163/8192 [03:25<06:06, 13.72it/s, est. speed input: 15732.43 toks/s, output: 15.36 toks/s]
Processed prompts:  39%|███▉      | 3227/8192 [03:30<06:02, 13.71it/s, est. speed input: 15694.66 toks/s, output: 15.33 toks/s]
Processed prompts:  40%|████      | 3291/8192 [03:35<05:57, 13.71it/s, est. speed input: 15658.37 toks/s, output: 15.29 toks/s]
Processed prompts:  41%|████      | 3355/8192 [03:39<05:52, 13.71it/s, est. speed input: 15624.12 toks/s, output: 15.26 toks/s]
Processed prompts:  42%|████▏     | 3419/8192 [03:44<05:48, 13.71it/s, est. speed input: 15591.46 toks/s, output: 15.23 toks/s]
Processed prompts:  43%|████▎     | 3483/8192 [03:49<05:43, 13.72it/s, est. speed input: 15560.06 toks/s, output: 15.20 toks/s]
Processed prompts:  43%|████▎     | 3547/8192 [03:53<05:38, 13.71it/s, est. speed input: 15529.76 toks/s, output: 15.17 toks/s]
Processed prompts:  44%|████▍     | 3611/8192 [03:58<05:34, 13.71it/s, est. speed input: 15500.60 toks/s, output: 15.14 toks/s]
Processed prompts:  45%|████▍     | 3675/8192 [04:03<05:27, 13.77it/s, est. speed input: 15476.99 toks/s, output: 15.11 toks/s]
Processed prompts:  46%|████▌     | 3739/8192 [04:07<05:23, 13.76it/s, est. speed input: 15449.92 toks/s, output: 15.09 toks/s]
Processed prompts:  46%|████▋     | 3803/8192 [04:12<05:19, 13.74it/s, est. speed input: 15423.68 toks/s, output: 15.06 toks/s]
Processed prompts:  47%|████▋     | 3867/8192 [04:17<05:15, 13.73it/s, est. speed input: 15398.43 toks/s, output: 15.04 toks/s]
Processed prompts:  48%|████▊     | 3931/8192 [04:21<05:09, 13.78it/s, est. speed input: 15377.98 toks/s, output: 15.02 toks/s]
Processed prompts:  49%|████▉     | 3995/8192 [04:26<05:05, 13.76it/s, est. speed input: 15354.51 toks/s, output: 14.99 toks/s]
Processed prompts:  50%|████▉     | 4059/8192 [04:31<04:59, 13.80it/s, est. speed input: 15335.43 toks/s, output: 14.98 toks/s]
Processed prompts:  50%|█████     | 4123/8192 [04:35<04:55, 13.78it/s, est. speed input: 15313.65 toks/s, output: 14.95 toks/s]
Processed prompts:  51%|█████     | 4187/8192 [04:40<04:51, 13.76it/s, est. speed input: 15292.46 toks/s, output: 14.93 toks/s]
Processed prompts:  52%|█████▏    | 4251/8192 [04:45<04:46, 13.75it/s, est. speed input: 15272.25 toks/s, output: 14.91 toks/s]
Processed prompts:  53%|█████▎    | 4315/8192 [04:49<04:42, 13.74it/s, est. speed input: 15252.62 toks/s, output: 14.90 toks/s]
Processed prompts:  53%|█████▎    | 4379/8192 [04:54<04:37, 13.73it/s, est. speed input: 15233.40 toks/s, output: 14.88 toks/s]
Processed prompts:  54%|█████▍    | 4443/8192 [04:59<04:33, 13.72it/s, est. speed input: 15214.60 toks/s, output: 14.86 toks/s]
Processed prompts:  55%|█████▌    | 4507/8192 [05:03<04:28, 13.72it/s, est. speed input: 15196.64 toks/s, output: 14.84 toks/s]
Processed prompts:  56%|█████▌    | 4571/8192 [05:08<04:23, 13.72it/s, est. speed input: 15179.23 toks/s, output: 14.82 toks/s]
Processed prompts:  57%|█████▋    | 4635/8192 [05:13<04:19, 13.72it/s, est. speed input: 15162.14 toks/s, output: 14.81 toks/s]
Processed prompts:  57%|█████▋    | 4699/8192 [05:17<04:14, 13.72it/s, est. speed input: 15145.72 toks/s, output: 14.79 toks/s]
Processed prompts:  58%|█████▊    | 4763/8192 [05:22<04:10, 13.72it/s, est. speed input: 15129.81 toks/s, output: 14.78 toks/s]
Processed prompts:  59%|█████▉    | 4827/8192 [05:27<04:05, 13.71it/s, est. speed input: 15114.16 toks/s, output: 14.76 toks/s]
Processed prompts:  60%|█████▉    | 4891/8192 [05:31<04:00, 13.71it/s, est. speed input: 15099.12 toks/s, output: 14.75 toks/s]
Processed prompts:  60%|██████    | 4955/8192 [05:36<03:55, 13.77it/s, est. speed input: 15087.32 toks/s, output: 14.73 toks/s]
Processed prompts:  61%|██████▏   | 5019/8192 [05:40<03:50, 13.76it/s, est. speed input: 15073.13 toks/s, output: 14.72 toks/s]
Processed prompts:  62%|██████▏   | 5083/8192 [05:45<03:46, 13.74it/s, est. speed input: 15059.28 toks/s, output: 14.71 toks/s]
Processed prompts:  63%|██████▎   | 5147/8192 [05:50<03:41, 13.74it/s, est. speed input: 15045.86 toks/s, output: 14.69 toks/s]
Processed prompts:  64%|██████▎   | 5211/8192 [05:54<03:37, 13.73it/s, est. speed input: 15032.65 toks/s, output: 14.68 toks/s]
Processed prompts:  64%|██████▍   | 5275/8192 [05:59<03:32, 13.72it/s, est. speed input: 15019.80 toks/s, output: 14.67 toks/s]
Processed prompts:  65%|██████▌   | 5339/8192 [06:04<03:27, 13.72it/s, est. speed input: 15007.43 toks/s, output: 14.66 toks/s]
Processed prompts:  66%|██████▌   | 5403/8192 [06:08<03:23, 13.72it/s, est. speed input: 14995.35 toks/s, output: 14.64 toks/s]
Processed prompts:  67%|██████▋   | 5467/8192 [06:13<03:18, 13.72it/s, est. speed input: 14983.32 toks/s, output: 14.63 toks/s]
Processed prompts:  68%|██████▊   | 5531/8192 [06:18<03:13, 13.72it/s, est. speed input: 14971.95 toks/s, output: 14.62 toks/s]
Processed prompts:  68%|██████▊   | 5595/8192 [06:22<03:09, 13.72it/s, est. speed input: 14960.79 toks/s, output: 14.61 toks/s]
Processed prompts:  69%|██████▉   | 5659/8192 [06:27<03:04, 13.72it/s, est. speed input: 14949.70 toks/s, output: 14.60 toks/s]
Processed prompts:  70%|██████▉   | 5723/8192 [06:32<02:59, 13.72it/s, est. speed input: 14939.05 toks/s, output: 14.59 toks/s]
Processed prompts:  71%|███████   | 5787/8192 [06:36<02:55, 13.72it/s, est. speed input: 14928.65 toks/s, output: 14.58 toks/s]
Processed prompts:  71%|███████▏  | 5851/8192 [06:41<02:50, 13.72it/s, est. speed input: 14918.41 toks/s, output: 14.57 toks/s]
Processed prompts:  72%|███████▏  | 5915/8192 [06:46<02:45, 13.78it/s, est. speed input: 14910.81 toks/s, output: 14.56 toks/s]
Processed prompts:  73%|███████▎  | 5979/8192 [06:50<02:40, 13.82it/s, est. speed input: 14903.37 toks/s, output: 14.55 toks/s]
Processed prompts:  74%|███████▍  | 6043/8192 [06:55<02:35, 13.79it/s, est. speed input: 14893.92 toks/s, output: 14.54 toks/s]
Processed prompts:  75%|███████▍  | 6107/8192 [07:00<02:31, 13.77it/s, est. speed input: 14884.52 toks/s, output: 14.54 toks/s]
Processed prompts:  75%|███████▌  | 6171/8192 [07:04<02:26, 13.76it/s, est. speed input: 14875.59 toks/s, output: 14.53 toks/s]
Processed prompts:  76%|███████▌  | 6235/8192 [07:09<02:22, 13.75it/s, est. speed input: 14866.64 toks/s, output: 14.52 toks/s]
Processed prompts:  77%|███████▋  | 6299/8192 [07:14<02:17, 13.74it/s, est. speed input: 14857.99 toks/s, output: 14.51 toks/s]
Processed prompts:  78%|███████▊  | 6363/8192 [07:18<02:13, 13.73it/s, est. speed input: 14849.24 toks/s, output: 14.50 toks/s]
Processed prompts:  78%|███████▊  | 6427/8192 [07:23<02:08, 13.73it/s, est. speed input: 14840.90 toks/s, output: 14.49 toks/s]
Processed prompts:  79%|███████▉  | 6491/8192 [07:28<02:03, 13.73it/s, est. speed input: 14832.61 toks/s, output: 14.48 toks/s]
Processed prompts:  80%|████████  | 6555/8192 [07:32<01:59, 13.72it/s, est. speed input: 14824.46 toks/s, output: 14.48 toks/s]
Processed prompts:  81%|████████  | 6619/8192 [07:37<01:54, 13.72it/s, est. speed input: 14816.59 toks/s, output: 14.47 toks/s]
Processed prompts:  82%|████████▏ | 6683/8192 [07:42<01:49, 13.73it/s, est. speed input: 14809.02 toks/s, output: 14.46 toks/s]
Processed prompts:  82%|████████▏ | 6747/8192 [07:46<01:45, 13.73it/s, est. speed input: 14801.46 toks/s, output: 14.45 toks/s]
Processed prompts:  83%|████████▎ | 6811/8192 [07:51<01:40, 13.73it/s, est. speed input: 14794.14 toks/s, output: 14.45 toks/s]
Processed prompts:  84%|████████▍ | 6875/8192 [07:56<01:35, 13.73it/s, est. speed input: 14786.89 toks/s, output: 14.44 toks/s]
Processed prompts:  85%|████████▍ | 6939/8192 [08:00<01:31, 13.72it/s, est. speed input: 14779.69 toks/s, output: 14.43 toks/s]
Processed prompts:  85%|████████▌ | 7003/8192 [08:05<01:26, 13.72it/s, est. speed input: 14772.66 toks/s, output: 14.43 toks/s]
Processed prompts:  86%|████████▋ | 7067/8192 [08:10<01:21, 13.72it/s, est. speed input: 14765.81 toks/s, output: 14.42 toks/s]
Processed prompts:  87%|████████▋ | 7131/8192 [08:14<01:17, 13.72it/s, est. speed input: 14758.94 toks/s, output: 14.41 toks/s]
Processed prompts:  88%|████████▊ | 7195/8192 [08:19<01:12, 13.72it/s, est. speed input: 14752.41 toks/s, output: 14.41 toks/s]
Processed prompts:  89%|████████▊ | 7259/8192 [08:24<01:08, 13.72it/s, est. speed input: 14745.87 toks/s, output: 14.40 toks/s]
Processed prompts:  89%|████████▉ | 7323/8192 [08:28<01:03, 13.72it/s, est. speed input: 14739.49 toks/s, output: 14.39 toks/s]
Processed prompts:  90%|█████████ | 7387/8192 [08:33<00:58, 13.72it/s, est. speed input: 14733.22 toks/s, output: 14.39 toks/s]
Processed prompts:  91%|█████████ | 7451/8192 [08:38<00:53, 13.72it/s, est. speed input: 14727.17 toks/s, output: 14.38 toks/s]
Processed prompts:  92%|█████████▏| 7515/8192 [08:42<00:49, 13.72it/s, est. speed input: 14721.15 toks/s, output: 14.38 toks/s]
Processed prompts:  93%|█████████▎| 7579/8192 [08:47<00:44, 13.72it/s, est. speed input: 14715.29 toks/s, output: 14.37 toks/s]
Processed prompts:  93%|█████████▎| 7643/8192 [08:52<00:39, 13.73it/s, est. speed input: 14709.53 toks/s, output: 14.36 toks/s]
Processed prompts:  94%|█████████▍| 7707/8192 [08:56<00:35, 13.72it/s, est. speed input: 14703.68 toks/s, output: 14.36 toks/s]
Processed prompts:  95%|█████████▍| 7771/8192 [09:01<00:30, 13.72it/s, est. speed input: 14698.13 toks/s, output: 14.35 toks/s]
Processed prompts:  96%|█████████▌| 7835/8192 [09:06<00:26, 13.72it/s, est. speed input: 14692.65 toks/s, output: 14.35 toks/s]
Processed prompts:  96%|█████████▋| 7899/8192 [09:10<00:21, 13.72it/s, est. speed input: 14687.23 toks/s, output: 14.34 toks/s]
Processed prompts:  97%|█████████▋| 7963/8192 [09:15<00:16, 13.73it/s, est. speed input: 14681.98 toks/s, output: 14.34 toks/s]
Processed prompts:  98%|█████████▊| 8027/8192 [09:20<00:12, 13.73it/s, est. speed input: 14676.76 toks/s, output: 14.33 toks/s]
Processed prompts:  99%|█████████▉| 8091/8192 [09:24<00:07, 13.72it/s, est. speed input: 14671.53 toks/s, output: 14.33 toks/s]
Processed prompts: 100%|█████████▉| 8155/8192 [09:27<00:02, 15.64it/s, est. speed input: 14715.75 toks/s, output: 14.37 toks/s]
Processed prompts: 100%|██████████| 8192/8192 [09:27<00:00, 15.64it/s, est. speed input: 14782.50 toks/s, output: 14.44 toks/s]
Processed prompts: 100%|██████████| 8192/8192 [09:27<00:00, 14.44it/s, est. speed input: 14782.50 toks/s, output: 14.44 toks/s]
[rank0]:[W125 23:05:41.863400930 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=65536 ==========
Time: 2026-01-26 02:49:51
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=8192, max_num_seqs=64
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 8192 --max-num-seqs 64 --max-model-len 1025 --max-num-batched-tokens 65536 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-7B-INT8_M65536.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 02:50:59 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=752887) ERROR 01-26 02:51:07 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=752887) ERROR 01-26 02:51:07 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=752887) ERROR 01-26 02:51:07 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=752887) ERROR 01-26 02:51:07 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=752887) ERROR 01-26 02:51:07 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=752887) ERROR 01-26 02:51:07 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=752887) ERROR 01-26 02:51:07 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=752887) ERROR 01-26 02:51:07 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 102, in __init__
(EngineCore_DP0 pid=752887) ERROR 01-26 02:51:07 [core.py:866]     self.model_executor = executor_class(vllm_config)
(EngineCore_DP0 pid=752887) ERROR 01-26 02:51:07 [core.py:866]                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=752887) ERROR 01-26 02:51:07 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 101, in __init__
(EngineCore_DP0 pid=752887) ERROR 01-26 02:51:07 [core.py:866]     self._init_executor()
(EngineCore_DP0 pid=752887) ERROR 01-26 02:51:07 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 47, in _init_executor
(EngineCore_DP0 pid=752887) ERROR 01-26 02:51:07 [core.py:866]     self.driver_worker.init_device()
(EngineCore_DP0 pid=752887) ERROR 01-26 02:51:07 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/worker_base.py", line 326, in init_device
(EngineCore_DP0 pid=752887) ERROR 01-26 02:51:07 [core.py:866]     self.worker.init_device()  # type: ignore
(EngineCore_DP0 pid=752887) ERROR 01-26 02:51:07 [core.py:866]     ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=752887) ERROR 01-26 02:51:07 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 247, in init_device
(EngineCore_DP0 pid=752887) ERROR 01-26 02:51:07 [core.py:866]     raise ValueError(
(EngineCore_DP0 pid=752887) ERROR 01-26 02:51:07 [core.py:866] ValueError: Free memory on device (11.35/79.25 GiB) on startup is less than desired GPU memory utilization (0.8, 63.4 GiB). Decrease GPU memory utilization or reduce GPU memory used by other processes.

STDERR:
[2026-01-26 02:50:59] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 02:50:59] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:50:59] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 02:50:59] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:50:59] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:50:59] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:50:59] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:50:59] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:50:59] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:50:59] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 02:50:59] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 02:50:59] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 02:50:59] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 02:50:59] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 02:51:06] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 02:51:06] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:51:06] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 02:51:06] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:51:06] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:51:06] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:51:06] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:51:06] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:51:06] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:51:06] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 02:51:06] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 02:51:06] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 02:51:06] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 02:51:06] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=752887) Process EngineCore_DP0:
(EngineCore_DP0 pid=752887) Traceback (most recent call last):
(EngineCore_DP0 pid=752887)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=752887)     self.run()
(EngineCore_DP0 pid=752887)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=752887)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=752887)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=752887)     raise e
(EngineCore_DP0 pid=752887)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=752887)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=752887)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=752887)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=752887)     super().__init__(
(EngineCore_DP0 pid=752887)   File "/root/vllmbench/vllm/v1/engine/core.py", line 102, in __init__
(EngineCore_DP0 pid=752887)     self.model_executor = executor_class(vllm_config)
(EngineCore_DP0 pid=752887)                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=752887)   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 101, in __init__
(EngineCore_DP0 pid=752887)     self._init_executor()
(EngineCore_DP0 pid=752887)   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 47, in _init_executor
(EngineCore_DP0 pid=752887)     self.driver_worker.init_device()
(EngineCore_DP0 pid=752887)   File "/root/vllmbench/vllm/v1/worker/worker_base.py", line 326, in init_device
(EngineCore_DP0 pid=752887)     self.worker.init_device()  # type: ignore
(EngineCore_DP0 pid=752887)     ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=752887)   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 247, in init_device
(EngineCore_DP0 pid=752887)     raise ValueError(
(EngineCore_DP0 pid=752887) ValueError: Free memory on device (11.35/79.25 GiB) on startup is less than desired GPU memory utilization (0.8, 63.4 GiB). Decrease GPU memory utilization or reduce GPU memory used by other processes.
[rank0]:[W126 02:51:07.403609191 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

ERROR: Test failed for M=65536

========== M=65536 ==========
Time: 2026-01-26 02:51:27
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=8192, max_num_seqs=64
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 8192 --max-num-seqs 64 --max-model-len 1025 --max-num-batched-tokens 65536 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-7B-INT8_M65536.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 02:52:33 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=753559) ERROR 01-26 02:52:41 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=753559) ERROR 01-26 02:52:41 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=753559) ERROR 01-26 02:52:41 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=753559) ERROR 01-26 02:52:41 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=753559) ERROR 01-26 02:52:41 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=753559) ERROR 01-26 02:52:41 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=753559) ERROR 01-26 02:52:41 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=753559) ERROR 01-26 02:52:41 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 102, in __init__
(EngineCore_DP0 pid=753559) ERROR 01-26 02:52:41 [core.py:866]     self.model_executor = executor_class(vllm_config)
(EngineCore_DP0 pid=753559) ERROR 01-26 02:52:41 [core.py:866]                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=753559) ERROR 01-26 02:52:41 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 101, in __init__
(EngineCore_DP0 pid=753559) ERROR 01-26 02:52:41 [core.py:866]     self._init_executor()
(EngineCore_DP0 pid=753559) ERROR 01-26 02:52:41 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 47, in _init_executor
(EngineCore_DP0 pid=753559) ERROR 01-26 02:52:41 [core.py:866]     self.driver_worker.init_device()
(EngineCore_DP0 pid=753559) ERROR 01-26 02:52:41 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/worker_base.py", line 326, in init_device
(EngineCore_DP0 pid=753559) ERROR 01-26 02:52:41 [core.py:866]     self.worker.init_device()  # type: ignore
(EngineCore_DP0 pid=753559) ERROR 01-26 02:52:41 [core.py:866]     ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=753559) ERROR 01-26 02:52:41 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 247, in init_device
(EngineCore_DP0 pid=753559) ERROR 01-26 02:52:41 [core.py:866]     raise ValueError(
(EngineCore_DP0 pid=753559) ERROR 01-26 02:52:41 [core.py:866] ValueError: Free memory on device (11.35/79.25 GiB) on startup is less than desired GPU memory utilization (0.8, 63.4 GiB). Decrease GPU memory utilization or reduce GPU memory used by other processes.

STDERR:
[2026-01-26 02:52:33] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 02:52:33] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:52:33] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 02:52:33] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:52:33] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:52:33] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:52:33] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:52:33] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:52:33] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:52:33] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 02:52:33] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 02:52:33] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 02:52:33] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 02:52:33] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 02:52:40] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 02:52:40] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:52:40] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 02:52:40] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:52:40] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:52:40] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:52:40] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:52:40] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:52:40] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:52:40] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 02:52:40] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 02:52:40] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 02:52:40] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 02:52:40] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=753559) Process EngineCore_DP0:
(EngineCore_DP0 pid=753559) Traceback (most recent call last):
(EngineCore_DP0 pid=753559)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=753559)     self.run()
(EngineCore_DP0 pid=753559)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=753559)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=753559)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=753559)     raise e
(EngineCore_DP0 pid=753559)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=753559)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=753559)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=753559)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=753559)     super().__init__(
(EngineCore_DP0 pid=753559)   File "/root/vllmbench/vllm/v1/engine/core.py", line 102, in __init__
(EngineCore_DP0 pid=753559)     self.model_executor = executor_class(vllm_config)
(EngineCore_DP0 pid=753559)                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=753559)   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 101, in __init__
(EngineCore_DP0 pid=753559)     self._init_executor()
(EngineCore_DP0 pid=753559)   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 47, in _init_executor
(EngineCore_DP0 pid=753559)     self.driver_worker.init_device()
(EngineCore_DP0 pid=753559)   File "/root/vllmbench/vllm/v1/worker/worker_base.py", line 326, in init_device
(EngineCore_DP0 pid=753559)     self.worker.init_device()  # type: ignore
(EngineCore_DP0 pid=753559)     ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=753559)   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 247, in init_device
(EngineCore_DP0 pid=753559)     raise ValueError(
(EngineCore_DP0 pid=753559) ValueError: Free memory on device (11.35/79.25 GiB) on startup is less than desired GPU memory utilization (0.8, 63.4 GiB). Decrease GPU memory utilization or reduce GPU memory used by other processes.
[rank0]:[W126 02:52:42.521461913 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

ERROR: Test failed for M=65536

========== M=65536 ==========
Time: 2026-01-26 02:53:01
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=8192, max_num_seqs=64
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 8192 --max-num-seqs 64 --max-model-len 1025 --max-num-batched-tokens 65536 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_8/json/Qwen2.5-7B-INT8_M65536.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 02:54:08 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=754239) ERROR 01-26 02:54:17 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=754239) ERROR 01-26 02:54:17 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=754239) ERROR 01-26 02:54:17 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=754239) ERROR 01-26 02:54:17 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=754239) ERROR 01-26 02:54:17 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=754239) ERROR 01-26 02:54:17 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=754239) ERROR 01-26 02:54:17 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=754239) ERROR 01-26 02:54:17 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 102, in __init__
(EngineCore_DP0 pid=754239) ERROR 01-26 02:54:17 [core.py:866]     self.model_executor = executor_class(vllm_config)
(EngineCore_DP0 pid=754239) ERROR 01-26 02:54:17 [core.py:866]                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=754239) ERROR 01-26 02:54:17 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 101, in __init__
(EngineCore_DP0 pid=754239) ERROR 01-26 02:54:17 [core.py:866]     self._init_executor()
(EngineCore_DP0 pid=754239) ERROR 01-26 02:54:17 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 47, in _init_executor
(EngineCore_DP0 pid=754239) ERROR 01-26 02:54:17 [core.py:866]     self.driver_worker.init_device()
(EngineCore_DP0 pid=754239) ERROR 01-26 02:54:17 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/worker_base.py", line 326, in init_device
(EngineCore_DP0 pid=754239) ERROR 01-26 02:54:17 [core.py:866]     self.worker.init_device()  # type: ignore
(EngineCore_DP0 pid=754239) ERROR 01-26 02:54:17 [core.py:866]     ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=754239) ERROR 01-26 02:54:17 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 247, in init_device
(EngineCore_DP0 pid=754239) ERROR 01-26 02:54:17 [core.py:866]     raise ValueError(
(EngineCore_DP0 pid=754239) ERROR 01-26 02:54:17 [core.py:866] ValueError: Free memory on device (11.35/79.25 GiB) on startup is less than desired GPU memory utilization (0.8, 63.4 GiB). Decrease GPU memory utilization or reduce GPU memory used by other processes.

STDERR:
[2026-01-26 02:54:08] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 02:54:08] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:54:08] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 02:54:08] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:54:08] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:54:08] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:54:08] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:54:08] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:54:08] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:54:08] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 02:54:08] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 02:54:08] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 02:54:08] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 02:54:08] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 02:54:16] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 02:54:16] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:54:16] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 02:54:16] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:54:16] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:54:16] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:54:16] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:54:16] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:54:16] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:54:16] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 02:54:16] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 02:54:16] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 02:54:16] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 02:54:16] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=754239) Process EngineCore_DP0:
(EngineCore_DP0 pid=754239) Traceback (most recent call last):
(EngineCore_DP0 pid=754239)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=754239)     self.run()
(EngineCore_DP0 pid=754239)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=754239)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=754239)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=754239)     raise e
(EngineCore_DP0 pid=754239)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=754239)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=754239)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=754239)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=754239)     super().__init__(
(EngineCore_DP0 pid=754239)   File "/root/vllmbench/vllm/v1/engine/core.py", line 102, in __init__
(EngineCore_DP0 pid=754239)     self.model_executor = executor_class(vllm_config)
(EngineCore_DP0 pid=754239)                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=754239)   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 101, in __init__
(EngineCore_DP0 pid=754239)     self._init_executor()
(EngineCore_DP0 pid=754239)   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 47, in _init_executor
(EngineCore_DP0 pid=754239)     self.driver_worker.init_device()
(EngineCore_DP0 pid=754239)   File "/root/vllmbench/vllm/v1/worker/worker_base.py", line 326, in init_device
(EngineCore_DP0 pid=754239)     self.worker.init_device()  # type: ignore
(EngineCore_DP0 pid=754239)     ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=754239)   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 247, in init_device
(EngineCore_DP0 pid=754239)     raise ValueError(
(EngineCore_DP0 pid=754239) ValueError: Free memory on device (11.35/79.25 GiB) on startup is less than desired GPU memory utilization (0.8, 63.4 GiB). Decrease GPU memory utilization or reduce GPU memory used by other processes.
[rank0]:[W126 02:54:17.174476149 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

ERROR: Test failed for M=65536

========== M=512 ==========
Time: 2026-01-28 00:20:37
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_8
Params: prompt_len=512, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_8 --dataset-name random --input-len 512 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 513 --max-num-batched-tokens 513 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_8/json/BitNet-2B-INT8_M512.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:20:44 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=2234016) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=2234016) WARNING 01-28 00:21:03 [backends.py:609] Failed to read file <frozen os>
Throughput: 19.44 requests/s, 9970.17 total tokens/s, 19.44 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128

STDERR:
[2026-01-28 00:20:44] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:20:44] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:20:44] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:20:44] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:20:44] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:20:44] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:20:44] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:20:44] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:20:44] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:20:44] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:20:44] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:20:44] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:20:44] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:20:44] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:20:52] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:20:52] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:20:52] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:20:52] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:20:52] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:20:52] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:20:52] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:20:52] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:20:52] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:20:52] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:20:52] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:20:52] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:20:52] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:20:52] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=2234016) [2026-01-28 00:20:53] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=2234016) [2026-01-28 00:20:53] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=2234016) [2026-01-28 00:20:53] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=2234016) [2026-01-28 00:20:53] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=2234016) [2026-01-28 00:20:53] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=2234016) [2026-01-28 00:20:53] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=2234016) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=2234016) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.26it/s]
(EngineCore_DP0 pid=2234016) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.25it/s]
(EngineCore_DP0 pid=2234016) 
(EngineCore_DP0 pid=2234016) [2026-01-28 00:20:54] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 3840] -> 1D uint8
(EngineCore_DP0 pid=2234016) [2026-01-28 00:20:54] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 11059200 bytes
(EngineCore_DP0 pid=2234016) [2026-01-28 00:20:54] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 3840] -> 1D uint8
(EngineCore_DP0 pid=2234016) [2026-01-28 00:20:54] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7372800 bytes
(EngineCore_DP0 pid=2234016) [2026-01-28 00:20:54] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 3840] -> 1D uint8
(EngineCore_DP0 pid=2234016) [2026-01-28 00:20:54] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 39813120 bytes
(EngineCore_DP0 pid=2234016) [2026-01-28 00:20:54] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 10368] -> 1D uint8
(EngineCore_DP0 pid=2234016) [2026-01-28 00:20:54] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 19906560 bytes
(EngineCore_DP0 pid=2234016) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  3.53it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  3.56it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  3.55it/s]
(EngineCore_DP0 pid=2234016) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  8.38it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  8.36it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  50%|█████     | 64/128 [00:00<00:00, 636.41it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 660.14it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 2/128 [00:00<00:08, 15.16it/s, est. speed input: 7760.93 toks/s, output: 15.16 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:06, 18.34it/s, est. speed input: 9159.63 toks/s, output: 17.89 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:00<00:06, 19.35it/s, est. speed input: 9619.44 toks/s, output: 18.79 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:00<00:06, 19.39it/s, est. speed input: 9688.11 toks/s, output: 18.92 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:00<00:06, 19.13it/s, est. speed input: 9658.13 toks/s, output: 18.86 toks/s]
Processed prompts:  11%|█         | 14/128 [00:00<00:05, 19.07it/s, est. speed input: 9664.41 toks/s, output: 18.88 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:00<00:05, 19.03it/s, est. speed input: 9669.20 toks/s, output: 18.88 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:00<00:05, 19.25it/s, est. speed input: 9717.24 toks/s, output: 18.98 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:01<00:05, 19.77it/s, est. speed input: 9828.43 toks/s, output: 19.20 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:01<00:05, 20.06it/s, est. speed input: 9913.77 toks/s, output: 19.36 toks/s]
Processed prompts:  20%|██        | 26/128 [00:01<00:05, 19.63it/s, est. speed input: 9877.23 toks/s, output: 19.29 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:01<00:05, 19.72it/s, est. speed input: 9908.01 toks/s, output: 19.35 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:01<00:04, 19.86it/s, est. speed input: 9945.03 toks/s, output: 19.42 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:01<00:04, 19.98it/s, est. speed input: 9979.33 toks/s, output: 19.49 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:01<00:04, 20.14it/s, est. speed input: 10018.19 toks/s, output: 19.57 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:02<00:04, 20.27it/s, est. speed input: 10053.97 toks/s, output: 19.64 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:02<00:04, 20.35it/s, est. speed input: 10083.95 toks/s, output: 19.70 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:02<00:04, 20.23it/s, est. speed input: 10092.44 toks/s, output: 19.71 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:02<00:03, 20.27it/s, est. speed input: 10111.57 toks/s, output: 19.75 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:02<00:03, 20.29it/s, est. speed input: 10128.61 toks/s, output: 19.78 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:02<00:03, 20.35it/s, est. speed input: 10147.57 toks/s, output: 19.82 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:02<00:03, 20.02it/s, est. speed input: 10132.92 toks/s, output: 19.79 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:03<00:03, 20.20it/s, est. speed input: 10153.46 toks/s, output: 19.83 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:03<00:03, 20.35it/s, est. speed input: 10173.04 toks/s, output: 19.87 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:03<00:02, 20.43it/s, est. speed input: 10189.36 toks/s, output: 19.90 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:03<00:02, 20.29it/s, est. speed input: 10191.20 toks/s, output: 19.90 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:03<00:02, 20.26it/s, est. speed input: 10196.78 toks/s, output: 19.92 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:03<00:02, 19.69it/s, est. speed input: 10165.73 toks/s, output: 19.85 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:04<00:02, 19.92it/s, est. speed input: 10177.49 toks/s, output: 19.88 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:04<00:02, 20.19it/s, est. speed input: 10194.67 toks/s, output: 19.91 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:04<00:02, 20.12it/s, est. speed input: 10195.41 toks/s, output: 19.91 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:04<00:01, 20.28it/s, est. speed input: 10208.13 toks/s, output: 19.94 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:04<00:01, 20.23it/s, est. speed input: 10210.80 toks/s, output: 19.94 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:04<00:01, 20.26it/s, est. speed input: 10217.02 toks/s, output: 19.96 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:04<00:01, 19.96it/s, est. speed input: 10206.38 toks/s, output: 19.93 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:05<00:01, 19.91it/s, est. speed input: 10204.18 toks/s, output: 19.93 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:05<00:01, 19.73it/s, est. speed input: 10196.41 toks/s, output: 19.91 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:05<00:01, 20.00it/s, est. speed input: 10205.29 toks/s, output: 19.93 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:05<00:00, 20.24it/s, est. speed input: 10216.40 toks/s, output: 19.95 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:05<00:00, 20.11it/s, est. speed input: 10214.74 toks/s, output: 19.95 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:05<00:00, 20.32it/s, est. speed input: 10225.81 toks/s, output: 19.97 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:05<00:00, 20.12it/s, est. speed input: 10222.10 toks/s, output: 19.96 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:06<00:00, 20.23it/s, est. speed input: 10228.46 toks/s, output: 19.98 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:06<00:00, 20.37it/s, est. speed input: 10237.32 toks/s, output: 19.99 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:06<00:00, 20.55it/s, est. speed input: 10248.52 toks/s, output: 20.02 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:06<00:00, 20.55it/s, est. speed input: 10254.67 toks/s, output: 20.03 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:06<00:00, 20.03it/s, est. speed input: 10254.67 toks/s, output: 20.03 toks/s]
[rank0]:[W128 00:21:27.429137794 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=1024 ==========
Time: 2026-01-28 00:21:29
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 1025 --max-num-batched-tokens 1025 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_8/json/BitNet-2B-INT8_M1024.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:21:38 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=2235038) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=2235038) WARNING 01-28 00:21:56 [backends.py:609] Failed to read file <frozen os>
Throughput: 20.18 requests/s, 20683.97 total tokens/s, 20.18 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128

STDERR:
[2026-01-28 00:21:38] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:21:38] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:21:38] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:21:38] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:21:38] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:21:38] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:21:38] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:21:38] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:21:38] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:21:38] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:21:38] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:21:38] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:21:38] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:21:38] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:21:45] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:21:45] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:21:45] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:21:45] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:21:45] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:21:45] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:21:45] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:21:45] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:21:45] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:21:45] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:21:45] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:21:45] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:21:45] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:21:45] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=2235038) [2026-01-28 00:21:46] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=2235038) [2026-01-28 00:21:46] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=2235038) [2026-01-28 00:21:46] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=2235038) [2026-01-28 00:21:46] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=2235038) [2026-01-28 00:21:46] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=2235038) [2026-01-28 00:21:46] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=2235038) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=2235038) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.22it/s]
(EngineCore_DP0 pid=2235038) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.22it/s]
(EngineCore_DP0 pid=2235038) 
(EngineCore_DP0 pid=2235038) [2026-01-28 00:21:47] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 3840] -> 1D uint8
(EngineCore_DP0 pid=2235038) [2026-01-28 00:21:47] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 11059200 bytes
(EngineCore_DP0 pid=2235038) [2026-01-28 00:21:47] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 3840] -> 1D uint8
(EngineCore_DP0 pid=2235038) [2026-01-28 00:21:47] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7372800 bytes
(EngineCore_DP0 pid=2235038) [2026-01-28 00:21:47] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 3840] -> 1D uint8
(EngineCore_DP0 pid=2235038) [2026-01-28 00:21:47] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 39813120 bytes
(EngineCore_DP0 pid=2235038) [2026-01-28 00:21:47] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 10368] -> 1D uint8
(EngineCore_DP0 pid=2235038) [2026-01-28 00:21:47] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 19906560 bytes
(EngineCore_DP0 pid=2235038) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  9.55it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  9.27it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  9.30it/s]
(EngineCore_DP0 pid=2235038) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  9.04it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  9.03it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  29%|██▉       | 37/128 [00:00<00:00, 367.37it/s]
Adding requests:  59%|█████▉    | 76/128 [00:00<00:00, 377.56it/s]
Adding requests:  91%|█████████▏| 117/128 [00:00<00:00, 387.77it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 384.31it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:01, 62.64it/s, est. speed input: 64149.26 toks/s, output: 62.64 toks/s]
Processed prompts:  11%|█         | 14/128 [00:00<00:03, 28.53it/s, est. speed input: 31813.04 toks/s, output: 31.07 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:00<00:04, 24.86it/s, est. speed input: 28152.99 toks/s, output: 27.49 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:00<00:04, 23.40it/s, est. speed input: 26729.03 toks/s, output: 26.10 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:00<00:04, 22.59it/s, est. speed input: 25874.15 toks/s, output: 25.27 toks/s]
Processed prompts:  21%|██        | 27/128 [00:01<00:04, 22.01it/s, est. speed input: 25244.00 toks/s, output: 24.65 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:01<00:04, 21.59it/s, est. speed input: 24757.39 toks/s, output: 24.18 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:01<00:04, 20.65it/s, est. speed input: 24107.31 toks/s, output: 23.54 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:01<00:04, 20.55it/s, est. speed input: 23792.77 toks/s, output: 23.23 toks/s]
Processed prompts:  30%|███       | 39/128 [00:01<00:04, 20.43it/s, est. speed input: 23514.13 toks/s, output: 22.96 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:01<00:04, 20.24it/s, est. speed input: 23251.07 toks/s, output: 22.71 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:01<00:04, 20.40it/s, est. speed input: 23109.28 toks/s, output: 22.57 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:02<00:03, 20.52it/s, est. speed input: 22987.61 toks/s, output: 22.45 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:02<00:03, 20.64it/s, est. speed input: 22890.22 toks/s, output: 22.35 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:02<00:03, 20.74it/s, est. speed input: 22807.55 toks/s, output: 22.27 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:02<00:03, 20.28it/s, est. speed input: 22622.91 toks/s, output: 22.09 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:02<00:03, 20.09it/s, est. speed input: 22482.45 toks/s, output: 21.96 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:02<00:03, 19.79it/s, est. speed input: 22325.43 toks/s, output: 21.80 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:03<00:03, 19.94it/s, est. speed input: 22250.61 toks/s, output: 21.73 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:03<00:02, 20.29it/s, est. speed input: 22224.91 toks/s, output: 21.70 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:03<00:02, 20.53it/s, est. speed input: 22198.39 toks/s, output: 21.68 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:03<00:02, 20.70it/s, est. speed input: 22174.82 toks/s, output: 21.65 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:03<00:02, 20.70it/s, est. speed input: 22134.74 toks/s, output: 21.62 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:03<00:02, 20.43it/s, est. speed input: 22060.90 toks/s, output: 21.54 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:03<00:02, 20.70it/s, est. speed input: 22055.02 toks/s, output: 21.54 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:04<00:01, 20.88it/s, est. speed input: 22047.06 toks/s, output: 21.53 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:04<00:01, 21.06it/s, est. speed input: 22045.12 toks/s, output: 21.53 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:04<00:01, 20.98it/s, est. speed input: 22020.85 toks/s, output: 21.50 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:04<00:01, 20.57it/s, est. speed input: 21956.36 toks/s, output: 21.44 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:04<00:01, 20.68it/s, est. speed input: 21941.04 toks/s, output: 21.43 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:04<00:01, 20.79it/s, est. speed input: 21928.80 toks/s, output: 21.41 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:04<00:01, 20.46it/s, est. speed input: 21875.81 toks/s, output: 21.36 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:05<00:00, 20.73it/s, est. speed input: 21876.34 toks/s, output: 21.36 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:05<00:00, 20.92it/s, est. speed input: 21876.99 toks/s, output: 21.36 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:05<00:00, 21.09it/s, est. speed input: 21880.16 toks/s, output: 21.37 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:05<00:00, 20.98it/s, est. speed input: 21863.31 toks/s, output: 21.35 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:05<00:00, 20.68it/s, est. speed input: 21826.39 toks/s, output: 21.31 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:05<00:00, 20.69it/s, est. speed input: 21810.81 toks/s, output: 21.30 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:05<00:00, 20.87it/s, est. speed input: 21811.01 toks/s, output: 21.30 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:06<00:00, 20.87it/s, est. speed input: 21813.91 toks/s, output: 21.30 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:06<00:00, 21.30it/s, est. speed input: 21813.91 toks/s, output: 21.30 toks/s]
[rank0]:[W128 00:22:20.036763090 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=2048 ==========
Time: 2026-01-28 00:22:22
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=256, max_num_seqs=2
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 256 --max-num-seqs 2 --max-model-len 1025 --max-num-batched-tokens 2048 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_8/json/BitNet-2B-INT8_M2048.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:22:31 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=2236015) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=2236015) WARNING 01-28 00:22:49 [backends.py:609] Failed to read file <frozen os>
Throughput: 39.46 requests/s, 40450.71 total tokens/s, 39.46 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256

STDERR:
[2026-01-28 00:22:31] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:22:31] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:22:31] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:22:31] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:22:31] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:22:31] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:22:31] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:22:31] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:22:31] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:22:31] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:22:31] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:22:31] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:22:31] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:22:31] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:22:39] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:22:39] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:22:39] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:22:39] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:22:39] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:22:39] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:22:39] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:22:39] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:22:39] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:22:39] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:22:39] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:22:39] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:22:39] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:22:39] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=2236015) [2026-01-28 00:22:40] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=2236015) [2026-01-28 00:22:40] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=2236015) [2026-01-28 00:22:40] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=2236015) [2026-01-28 00:22:40] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=2236015) [2026-01-28 00:22:40] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=2236015) [2026-01-28 00:22:40] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=2236015) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=2236015) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.23it/s]
(EngineCore_DP0 pid=2236015) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.23it/s]
(EngineCore_DP0 pid=2236015) 
(EngineCore_DP0 pid=2236015) [2026-01-28 00:22:40] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 3840] -> 1D uint8
(EngineCore_DP0 pid=2236015) [2026-01-28 00:22:41] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 11059200 bytes
(EngineCore_DP0 pid=2236015) [2026-01-28 00:22:41] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 3840] -> 1D uint8
(EngineCore_DP0 pid=2236015) [2026-01-28 00:22:41] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7372800 bytes
(EngineCore_DP0 pid=2236015) [2026-01-28 00:22:41] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 3840] -> 1D uint8
(EngineCore_DP0 pid=2236015) [2026-01-28 00:22:41] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 39813120 bytes
(EngineCore_DP0 pid=2236015) [2026-01-28 00:22:41] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 10368] -> 1D uint8
(EngineCore_DP0 pid=2236015) [2026-01-28 00:22:41] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 19906560 bytes
(EngineCore_DP0 pid=2236015) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  33%|███▎      | 1/3 [00:00<00:00,  9.32it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00,  9.30it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00,  9.29it/s]
(EngineCore_DP0 pid=2236015) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 1/2 [00:00<00:00,  8.55it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  9.32it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  14%|█▎        | 35/256 [00:00<00:00, 348.23it/s]
Adding requests:  29%|██▊       | 73/256 [00:00<00:00, 365.13it/s]
Adding requests:  44%|████▍     | 112/256 [00:00<00:00, 373.58it/s]
Adding requests:  59%|█████▊    | 150/256 [00:00<00:00, 370.24it/s]
Adding requests:  73%|███████▎  | 188/256 [00:00<00:00, 363.18it/s]
Adding requests:  88%|████████▊ | 226/256 [00:00<00:00, 366.26it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 366.74it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  10%|█         | 26/256 [00:00<00:01, 177.17it/s, est. speed input: 181443.97 toks/s, output: 177.17 toks/s]
Processed prompts:  17%|█▋        | 44/256 [00:00<00:03, 67.78it/s, est. speed input: 77944.96 toks/s, output: 76.11 toks/s]   
Processed prompts:  21%|██        | 54/256 [00:00<00:03, 57.80it/s, est. speed input: 67791.23 toks/s, output: 66.20 toks/s]
Processed prompts:  24%|██▍       | 62/256 [00:01<00:03, 51.24it/s, est. speed input: 61841.45 toks/s, output: 60.39 toks/s]
Processed prompts:  27%|██▋       | 68/256 [00:01<00:03, 48.77it/s, est. speed input: 59397.98 toks/s, output: 58.00 toks/s]
Processed prompts:  29%|██▉       | 74/256 [00:01<00:03, 47.03it/s, est. speed input: 57616.06 toks/s, output: 56.26 toks/s]
Processed prompts:  31%|███       | 79/256 [00:01<00:03, 47.62it/s, est. speed input: 57153.94 toks/s, output: 55.81 toks/s]
Processed prompts:  33%|███▎      | 84/256 [00:01<00:03, 43.53it/s, est. speed input: 55050.13 toks/s, output: 53.76 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:01<00:03, 43.08it/s, est. speed input: 54041.11 toks/s, output: 52.77 toks/s]
Processed prompts:  38%|███▊      | 96/256 [00:01<00:03, 42.69it/s, est. speed input: 53166.17 toks/s, output: 51.92 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:01<00:03, 42.42it/s, est. speed input: 52417.34 toks/s, output: 51.19 toks/s]
Processed prompts:  42%|████▏     | 107/256 [00:02<00:03, 43.96it/s, est. speed input: 52312.10 toks/s, output: 51.09 toks/s]
Processed prompts:  44%|████▍     | 112/256 [00:02<00:03, 40.91it/s, est. speed input: 51207.95 toks/s, output: 50.01 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:02<00:03, 41.01it/s, est. speed input: 50659.77 toks/s, output: 49.47 toks/s]
Processed prompts:  48%|████▊     | 124/256 [00:02<00:03, 41.29it/s, est. speed input: 50221.66 toks/s, output: 49.04 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:02<00:03, 41.17it/s, est. speed input: 49764.63 toks/s, output: 48.60 toks/s]
Processed prompts:  53%|█████▎    | 136/256 [00:02<00:02, 40.99it/s, est. speed input: 49335.56 toks/s, output: 48.18 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:02<00:02, 40.98it/s, est. speed input: 48969.96 toks/s, output: 47.82 toks/s]
Processed prompts:  58%|█████▊    | 148/256 [00:03<00:02, 40.73it/s, est. speed input: 48594.36 toks/s, output: 47.46 toks/s]
Processed prompts:  60%|██████    | 154/256 [00:03<00:02, 40.76it/s, est. speed input: 48289.44 toks/s, output: 47.16 toks/s]
Processed prompts:  62%|██████▎   | 160/256 [00:03<00:02, 40.64it/s, est. speed input: 47986.59 toks/s, output: 46.86 toks/s]
Processed prompts:  64%|██████▍   | 165/256 [00:03<00:02, 42.56it/s, est. speed input: 48050.37 toks/s, output: 46.92 toks/s]
Processed prompts:  66%|██████▋   | 170/256 [00:03<00:02, 39.23it/s, est. speed input: 47431.33 toks/s, output: 46.32 toks/s]
Processed prompts:  69%|██████▉   | 176/256 [00:03<00:02, 39.68it/s, est. speed input: 47206.70 toks/s, output: 46.10 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:03<00:01, 40.41it/s, est. speed input: 47059.50 toks/s, output: 45.96 toks/s]
Processed prompts:  73%|███████▎  | 187/256 [00:04<00:01, 41.85it/s, est. speed input: 47067.91 toks/s, output: 45.96 toks/s]
Processed prompts:  75%|███████▌  | 192/256 [00:04<00:01, 38.22it/s, est. speed input: 46497.53 toks/s, output: 45.41 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:04<00:01, 39.12it/s, est. speed input: 46352.45 toks/s, output: 45.27 toks/s]
Processed prompts:  79%|███████▉  | 202/256 [00:04<00:01, 38.97it/s, est. speed input: 46191.22 toks/s, output: 45.11 toks/s]
Processed prompts:  81%|████████▏ | 208/256 [00:04<00:01, 39.90it/s, est. speed input: 46088.53 toks/s, output: 45.01 toks/s]
Processed prompts:  84%|████████▎ | 214/256 [00:04<00:01, 40.65it/s, est. speed input: 46006.13 toks/s, output: 44.93 toks/s]
Processed prompts:  86%|████████▌ | 220/256 [00:04<00:00, 41.02it/s, est. speed input: 45913.62 toks/s, output: 44.84 toks/s]
Processed prompts:  88%|████████▊ | 226/256 [00:05<00:00, 40.99it/s, est. speed input: 45797.71 toks/s, output: 44.72 toks/s]
Processed prompts:  91%|█████████ | 232/256 [00:05<00:00, 40.74it/s, est. speed input: 45664.36 toks/s, output: 44.59 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:05<00:00, 40.87it/s, est. speed input: 45568.60 toks/s, output: 44.50 toks/s]
Processed prompts:  95%|█████████▌| 244/256 [00:05<00:00, 41.19it/s, est. speed input: 45500.53 toks/s, output: 44.43 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:05<00:00, 40.64it/s, est. speed input: 45362.47 toks/s, output: 44.30 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:05<00:00, 40.96it/s, est. speed input: 45296.54 toks/s, output: 44.23 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:05<00:00, 40.96it/s, est. speed input: 45296.54 toks/s, output: 44.23 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:05<00:00, 44.23it/s, est. speed input: 45296.54 toks/s, output: 44.23 toks/s]
[rank0]:[W128 00:23:14.926190132 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=4096 ==========
Time: 2026-01-28 00:23:16
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=512, max_num_seqs=4
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 512 --max-num-seqs 4 --max-model-len 1025 --max-num-batched-tokens 4096 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_8/json/BitNet-2B-INT8_M4096.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:23:26 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=2237017) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=2237017) WARNING 01-28 00:23:44 [backends.py:609] Failed to read file <frozen os>
Throughput: 62.64 requests/s, 64203.60 total tokens/s, 62.64 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512

STDERR:
[2026-01-28 00:23:26] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:23:26] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:23:26] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:23:26] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:23:26] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:23:26] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:23:26] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:23:26] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:23:26] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:23:26] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:23:26] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:23:26] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:23:26] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:23:26] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:23:34] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:23:34] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:23:34] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:23:34] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:23:34] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:23:34] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:23:34] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:23:34] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:23:34] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:23:34] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:23:34] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:23:34] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:23:34] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:23:34] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=2237017) [2026-01-28 00:23:35] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=2237017) [2026-01-28 00:23:35] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=2237017) [2026-01-28 00:23:35] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=2237017) [2026-01-28 00:23:35] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=2237017) [2026-01-28 00:23:35] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=2237017) [2026-01-28 00:23:35] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=2237017) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=2237017) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.26it/s]
(EngineCore_DP0 pid=2237017) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.26it/s]
(EngineCore_DP0 pid=2237017) 
(EngineCore_DP0 pid=2237017) [2026-01-28 00:23:36] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 3840] -> 1D uint8
(EngineCore_DP0 pid=2237017) [2026-01-28 00:23:36] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 11059200 bytes
(EngineCore_DP0 pid=2237017) [2026-01-28 00:23:36] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 3840] -> 1D uint8
(EngineCore_DP0 pid=2237017) [2026-01-28 00:23:36] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7372800 bytes
(EngineCore_DP0 pid=2237017) [2026-01-28 00:23:36] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 3840] -> 1D uint8
(EngineCore_DP0 pid=2237017) [2026-01-28 00:23:36] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 39813120 bytes
(EngineCore_DP0 pid=2237017) [2026-01-28 00:23:36] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 10368] -> 1D uint8
(EngineCore_DP0 pid=2237017) [2026-01-28 00:23:36] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 19906560 bytes
(EngineCore_DP0 pid=2237017) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  25%|██▌       | 1/4 [00:00<00:00,  8.85it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 2/4 [00:00<00:00,  9.42it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  9.49it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  9.43it/s]
(EngineCore_DP0 pid=2237017) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  33%|███▎      | 1/3 [00:00<00:00,  8.24it/s]
Capturing CUDA graphs (decode, FULL):  67%|██████▋   | 2/3 [00:00<00:00,  8.77it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  9.14it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  8.98it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   7%|▋         | 37/512 [00:00<00:01, 366.35it/s]
Adding requests:  15%|█▍        | 75/512 [00:00<00:01, 369.95it/s]
Adding requests:  22%|██▏       | 114/512 [00:00<00:01, 378.31it/s]
Adding requests:  30%|██▉       | 153/512 [00:00<00:00, 380.54it/s]
Adding requests:  38%|███▊      | 193/512 [00:00<00:00, 383.93it/s]
Adding requests:  45%|████▌     | 232/512 [00:00<00:00, 375.70it/s]
Adding requests:  53%|█████▎    | 271/512 [00:00<00:00, 378.66it/s]
Adding requests:  60%|██████    | 309/512 [00:00<00:00, 373.75it/s]
Adding requests:  68%|██████▊   | 349/512 [00:00<00:00, 380.87it/s]
Adding requests:  76%|███████▌  | 388/512 [00:01<00:00, 383.61it/s]
Adding requests:  83%|████████▎ | 427/512 [00:01<00:00, 383.95it/s]
Adding requests:  91%|█████████ | 466/512 [00:01<00:00, 379.81it/s]
Adding requests:  99%|█████████▊| 505/512 [00:01<00:00, 370.84it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 376.62it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  17%|█▋        | 86/512 [00:00<00:00, 687.42it/s, est. speed input: 703982.96 toks/s, output: 687.43 toks/s]
Processed prompts:  30%|███       | 155/512 [00:01<00:03, 111.09it/s, est. speed input: 132210.29 toks/s, output: 129.11 toks/s]
Processed prompts:  37%|███▋      | 188/512 [00:01<00:03, 93.42it/s, est. speed input: 112723.86 toks/s, output: 110.08 toks/s] 
Processed prompts:  41%|████      | 209/512 [00:02<00:03, 86.54it/s, est. speed input: 105738.65 toks/s, output: 103.26 toks/s]
Processed prompts:  44%|████▍     | 224/512 [00:02<00:03, 80.37it/s, est. speed input: 100719.13 toks/s, output: 98.36 toks/s] 
Processed prompts:  46%|████▌     | 236/512 [00:02<00:03, 77.01it/s, est. speed input: 97941.39 toks/s, output: 95.65 toks/s] 
Processed prompts:  48%|████▊     | 246/512 [00:02<00:03, 71.70it/s, est. speed input: 94792.05 toks/s, output: 92.57 toks/s]
Processed prompts:  50%|████▉     | 255/512 [00:02<00:03, 71.58it/s, est. speed input: 93784.23 toks/s, output: 91.59 toks/s]
Processed prompts:  51%|█████▏    | 263/512 [00:02<00:03, 69.94it/s, est. speed input: 92522.39 toks/s, output: 90.35 toks/s]
Processed prompts:  53%|█████▎    | 271/512 [00:03<00:03, 68.32it/s, est. speed input: 91328.71 toks/s, output: 89.19 toks/s]
Processed prompts:  54%|█████▍    | 279/512 [00:03<00:03, 67.14it/s, est. speed input: 90274.57 toks/s, output: 88.16 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:03<00:03, 64.08it/s, est. speed input: 88969.60 toks/s, output: 86.88 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:03<00:03, 63.82it/s, est. speed input: 88066.10 toks/s, output: 86.00 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:03<00:03, 63.66it/s, est. speed input: 87234.44 toks/s, output: 85.19 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:03<00:03, 63.59it/s, est. speed input: 86468.28 toks/s, output: 84.44 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:03<00:03, 63.58it/s, est. speed input: 85759.46 toks/s, output: 83.75 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:03<00:02, 63.46it/s, est. speed input: 85078.48 toks/s, output: 83.08 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:04<00:02, 63.25it/s, est. speed input: 84424.03 toks/s, output: 82.45 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:04<00:02, 64.30it/s, est. speed input: 83969.32 toks/s, output: 82.00 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:04<00:02, 63.99it/s, est. speed input: 83404.33 toks/s, output: 81.45 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:04<00:02, 63.77it/s, est. speed input: 82872.29 toks/s, output: 80.93 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:04<00:02, 63.49it/s, est. speed input: 82353.51 toks/s, output: 80.42 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [00:04<00:02, 63.41it/s, est. speed input: 81876.65 toks/s, output: 79.96 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [00:04<00:02, 63.37it/s, est. speed input: 81427.97 toks/s, output: 79.52 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [00:04<00:01, 63.33it/s, est. speed input: 81000.69 toks/s, output: 79.10 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [00:05<00:01, 63.29it/s, est. speed input: 80592.59 toks/s, output: 78.70 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [00:05<00:01, 63.10it/s, est. speed input: 80188.07 toks/s, output: 78.31 toks/s]
Processed prompts:  81%|████████  | 414/512 [00:05<00:01, 63.14it/s, est. speed input: 79820.63 toks/s, output: 77.95 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [00:05<00:01, 63.16it/s, est. speed input: 79469.05 toks/s, output: 77.61 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [00:05<00:01, 63.20it/s, est. speed input: 79136.34 toks/s, output: 77.28 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [00:05<00:01, 63.18it/s, est. speed input: 78813.10 toks/s, output: 76.97 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [00:05<00:01, 63.25it/s, est. speed input: 78511.94 toks/s, output: 76.67 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [00:05<00:00, 64.71it/s, est. speed input: 78345.15 toks/s, output: 76.51 toks/s]
Processed prompts:  90%|█████████ | 462/512 [00:06<00:00, 64.27it/s, est. speed input: 78062.03 toks/s, output: 76.23 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [00:06<00:00, 63.94it/s, est. speed input: 77788.69 toks/s, output: 75.97 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [00:06<00:00, 63.47it/s, est. speed input: 77506.32 toks/s, output: 75.69 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [00:06<00:00, 63.29it/s, est. speed input: 77247.68 toks/s, output: 75.44 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [00:06<00:00, 63.32it/s, est. speed input: 77010.44 toks/s, output: 75.21 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [00:06<00:00, 63.24it/s, est. speed input: 76774.53 toks/s, output: 74.97 toks/s]
Processed prompts: 100%|█████████▉| 510/512 [00:06<00:00, 64.73it/s, est. speed input: 76661.05 toks/s, output: 74.86 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:06<00:00, 64.73it/s, est. speed input: 76959.22 toks/s, output: 75.16 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:06<00:00, 75.15it/s, est. speed input: 76959.22 toks/s, output: 75.16 toks/s]
[rank0]:[W128 00:24:11.355441579 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=8192 ==========
Time: 2026-01-28 00:24:13
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=1024, max_num_seqs=8
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 1024 --max-num-seqs 8 --max-model-len 1025 --max-num-batched-tokens 8192 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_8/json/BitNet-2B-INT8_M8192.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:24:26 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=2238075) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=2238075) WARNING 01-28 00:24:44 [backends.py:609] Failed to read file <frozen os>
Throughput: 65.41 requests/s, 67048.78 total tokens/s, 65.41 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024

STDERR:
[2026-01-28 00:24:26] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:24:26] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:24:26] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:24:26] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:24:26] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:24:26] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:24:26] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:24:26] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:24:26] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:24:26] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:24:26] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:24:26] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:24:26] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:24:26] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:24:34] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:24:34] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:24:34] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:24:34] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:24:34] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:24:34] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:24:34] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:24:34] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:24:34] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:24:34] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:24:34] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:24:34] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:24:34] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:24:34] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=2238075) [2026-01-28 00:24:35] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=2238075) [2026-01-28 00:24:35] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=2238075) [2026-01-28 00:24:35] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=2238075) [2026-01-28 00:24:35] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=2238075) [2026-01-28 00:24:35] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=2238075) [2026-01-28 00:24:35] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=2238075) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=2238075) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.30it/s]
(EngineCore_DP0 pid=2238075) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.29it/s]
(EngineCore_DP0 pid=2238075) 
(EngineCore_DP0 pid=2238075) [2026-01-28 00:24:36] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 3840] -> 1D uint8
(EngineCore_DP0 pid=2238075) [2026-01-28 00:24:36] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 11059200 bytes
(EngineCore_DP0 pid=2238075) [2026-01-28 00:24:36] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 3840] -> 1D uint8
(EngineCore_DP0 pid=2238075) [2026-01-28 00:24:36] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7372800 bytes
(EngineCore_DP0 pid=2238075) [2026-01-28 00:24:36] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 3840] -> 1D uint8
(EngineCore_DP0 pid=2238075) [2026-01-28 00:24:36] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 39813120 bytes
(EngineCore_DP0 pid=2238075) [2026-01-28 00:24:36] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 10368] -> 1D uint8
(EngineCore_DP0 pid=2238075) [2026-01-28 00:24:36] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 19906560 bytes
(EngineCore_DP0 pid=2238075) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:00,  8.81it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  40%|████      | 2/5 [00:00<00:00,  9.26it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  80%|████████  | 4/5 [00:00<00:00,  9.92it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00,  9.66it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00,  9.61it/s]
(EngineCore_DP0 pid=2238075) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:00,  8.63it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 2/4 [00:00<00:00,  9.21it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  9.83it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  9.64it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   4%|▎         | 36/1024 [00:00<00:02, 356.83it/s]
Adding requests:   7%|▋         | 76/1024 [00:00<00:02, 379.52it/s]
Adding requests:  11%|█▏        | 116/1024 [00:00<00:02, 388.04it/s]
Adding requests:  15%|█▌        | 155/1024 [00:00<00:02, 382.46it/s]
Adding requests:  19%|█▉        | 194/1024 [00:00<00:02, 369.16it/s]
Adding requests:  23%|██▎       | 233/1024 [00:00<00:02, 373.50it/s]
Adding requests:  26%|██▋       | 271/1024 [00:00<00:02, 375.30it/s]
Adding requests:  30%|███       | 309/1024 [00:00<00:01, 374.88it/s]
Adding requests:  34%|███▍      | 349/1024 [00:00<00:01, 382.34it/s]
Adding requests:  38%|███▊      | 390/1024 [00:01<00:01, 388.92it/s]
Adding requests:  42%|████▏     | 431/1024 [00:01<00:01, 393.83it/s]
Adding requests:  46%|████▌     | 471/1024 [00:01<00:01, 395.60it/s]
Adding requests:  50%|████▉     | 511/1024 [00:01<00:01, 394.09it/s]
Adding requests:  54%|█████▍    | 551/1024 [00:01<00:01, 384.59it/s]
Adding requests:  58%|█████▊    | 591/1024 [00:01<00:01, 386.39it/s]
Adding requests:  62%|██████▏   | 630/1024 [00:01<00:01, 382.04it/s]
Adding requests:  66%|██████▌   | 671/1024 [00:01<00:00, 388.09it/s]
Adding requests:  69%|██████▉   | 710/1024 [00:01<00:00, 385.32it/s]
Adding requests:  73%|███████▎  | 749/1024 [00:01<00:00, 377.04it/s]
Adding requests:  77%|███████▋  | 787/1024 [00:02<00:00, 376.75it/s]
Adding requests:  81%|████████  | 825/1024 [00:02<00:00, 371.54it/s]
Adding requests:  84%|████████▍ | 865/1024 [00:02<00:00, 379.12it/s]
Adding requests:  88%|████████▊ | 906/1024 [00:02<00:00, 386.94it/s]
Adding requests:  92%|█████████▏| 945/1024 [00:02<00:00, 381.79it/s]
Adding requests:  96%|█████████▌| 985/1024 [00:02<00:00, 384.82it/s]
Adding requests: 100%|██████████| 1024/1024 [00:02<00:00, 382.87it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [00:00<00:01, 827.91it/s, est. speed input: 847847.60 toks/s, output: 827.93 toks/s]
Processed prompts:  25%|██▌       | 261/1024 [00:01<00:05, 151.57it/s, est. speed input: 186356.80 toks/s, output: 181.99 toks/s]
Processed prompts:  29%|██▉       | 300/1024 [00:02<00:06, 117.61it/s, est. speed input: 150400.93 toks/s, output: 146.88 toks/s]
Processed prompts:  32%|███▏      | 324/1024 [00:02<00:06, 104.68it/s, est. speed input: 137818.39 toks/s, output: 134.59 toks/s]
Processed prompts:  33%|███▎      | 341/1024 [00:02<00:06, 98.63it/s, est. speed input: 132139.15 toks/s, output: 129.04 toks/s] 
Processed prompts:  35%|███▍      | 355/1024 [00:02<00:07, 89.67it/s, est. speed input: 125929.49 toks/s, output: 122.98 toks/s]
Processed prompts:  36%|███▌      | 366/1024 [00:03<00:07, 89.71it/s, est. speed input: 124556.05 toks/s, output: 121.64 toks/s]
Processed prompts:  37%|███▋      | 377/1024 [00:03<00:07, 89.84it/s, est. speed input: 123318.94 toks/s, output: 120.43 toks/s]
Processed prompts:  38%|███▊      | 387/1024 [00:03<00:08, 74.49it/s, est. speed input: 117450.51 toks/s, output: 114.70 toks/s]
Processed prompts:  39%|███▊      | 396/1024 [00:03<00:08, 74.31it/s, est. speed input: 115972.20 toks/s, output: 113.25 toks/s]
Processed prompts:  39%|███▉      | 404/1024 [00:03<00:08, 72.52it/s, est. speed input: 114332.68 toks/s, output: 111.65 toks/s]
Processed prompts:  40%|████      | 412/1024 [00:03<00:08, 71.08it/s, est. speed input: 112827.21 toks/s, output: 110.18 toks/s]
Processed prompts:  41%|████      | 420/1024 [00:03<00:08, 69.78it/s, est. speed input: 111395.96 toks/s, output: 108.78 toks/s]
Processed prompts:  42%|████▏     | 428/1024 [00:03<00:08, 68.79it/s, est. speed input: 110061.38 toks/s, output: 107.48 toks/s]
Processed prompts:  42%|████▏     | 435/1024 [00:04<00:08, 65.72it/s, est. speed input: 108542.40 toks/s, output: 106.00 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:04<00:09, 63.45it/s, est. speed input: 107115.35 toks/s, output: 104.60 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:04<00:08, 65.71it/s, est. speed input: 106257.31 toks/s, output: 103.77 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:04<00:08, 65.56it/s, est. speed input: 105169.99 toks/s, output: 102.70 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:04<00:08, 65.47it/s, est. speed input: 104144.83 toks/s, output: 101.70 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:04<00:08, 65.57it/s, est. speed input: 103194.00 toks/s, output: 100.78 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:04<00:08, 65.60it/s, est. speed input: 102287.20 toks/s, output: 99.89 toks/s] 
Processed prompts:  48%|████▊     | 490/1024 [00:04<00:08, 65.64it/s, est. speed input: 101426.17 toks/s, output: 99.05 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:05<00:08, 65.57it/s, est. speed input: 100595.48 toks/s, output: 98.24 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:05<00:07, 65.54it/s, est. speed input: 99804.80 toks/s, output: 97.47 toks/s] 
Processed prompts:  50%|█████     | 514/1024 [00:05<00:07, 65.51it/s, est. speed input: 99050.32 toks/s, output: 96.73 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:05<00:07, 65.48it/s, est. speed input: 98329.19 toks/s, output: 96.02 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:05<00:07, 65.39it/s, est. speed input: 97631.31 toks/s, output: 95.34 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:05<00:07, 65.44it/s, est. speed input: 96976.61 toks/s, output: 94.70 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:05<00:07, 65.48it/s, est. speed input: 96349.81 toks/s, output: 94.09 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:05<00:07, 65.54it/s, est. speed input: 95751.70 toks/s, output: 93.51 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:06<00:07, 65.51it/s, est. speed input: 95170.54 toks/s, output: 92.94 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:06<00:06, 65.60it/s, est. speed input: 94623.08 toks/s, output: 92.41 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:06<00:06, 65.79it/s, est. speed input: 94108.43 toks/s, output: 91.90 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:06<00:06, 65.77it/s, est. speed input: 93599.67 toks/s, output: 91.41 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:06<00:06, 65.64it/s, est. speed input: 93099.32 toks/s, output: 90.92 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:06<00:06, 65.65it/s, est. speed input: 92625.91 toks/s, output: 90.45 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:06<00:06, 65.60it/s, est. speed input: 92164.88 toks/s, output: 90.00 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:06<00:06, 65.71it/s, est. speed input: 91732.55 toks/s, output: 89.58 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:07<00:06, 65.63it/s, est. speed input: 91302.24 toks/s, output: 89.16 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:07<00:05, 65.61it/s, est. speed input: 90889.12 toks/s, output: 88.76 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:07<00:05, 65.54it/s, est. speed input: 90486.20 toks/s, output: 88.37 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:07<00:05, 65.49it/s, est. speed input: 90096.30 toks/s, output: 87.98 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:07<00:05, 65.38it/s, est. speed input: 89713.50 toks/s, output: 87.61 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:07<00:05, 65.36it/s, est. speed input: 89347.01 toks/s, output: 87.25 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:07<00:05, 65.19it/s, est. speed input: 88980.83 toks/s, output: 86.90 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:07<00:05, 65.34it/s, est. speed input: 88645.51 toks/s, output: 86.57 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:08<00:05, 65.38it/s, est. speed input: 88315.09 toks/s, output: 86.25 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:08<00:04, 65.37it/s, est. speed input: 87992.56 toks/s, output: 85.93 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:08<00:04, 65.52it/s, est. speed input: 87689.90 toks/s, output: 85.63 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:08<00:04, 65.58it/s, est. speed input: 87393.32 toks/s, output: 85.34 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:08<00:04, 65.59it/s, est. speed input: 87103.02 toks/s, output: 85.06 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:08<00:04, 65.53it/s, est. speed input: 86816.70 toks/s, output: 84.78 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:08<00:04, 65.41it/s, est. speed input: 86533.99 toks/s, output: 84.51 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:08<00:04, 65.51it/s, est. speed input: 86269.90 toks/s, output: 84.25 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:08<00:04, 65.49it/s, est. speed input: 86007.66 toks/s, output: 83.99 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:09<00:03, 65.55it/s, est. speed input: 85756.90 toks/s, output: 83.75 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:09<00:03, 65.69it/s, est. speed input: 85518.25 toks/s, output: 83.51 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:09<00:03, 65.68it/s, est. speed input: 85279.63 toks/s, output: 83.28 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:09<00:03, 65.69it/s, est. speed input: 85048.19 toks/s, output: 83.05 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:09<00:03, 65.69it/s, est. speed input: 84822.07 toks/s, output: 82.83 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:09<00:03, 65.52it/s, est. speed input: 84593.00 toks/s, output: 82.61 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:09<00:03, 65.59it/s, est. speed input: 84379.19 toks/s, output: 82.40 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:09<00:03, 65.60it/s, est. speed input: 84168.58 toks/s, output: 82.20 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:10<00:03, 65.52it/s, est. speed input: 83958.89 toks/s, output: 81.99 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:10<00:02, 65.37it/s, est. speed input: 83749.24 toks/s, output: 81.79 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [00:10<00:02, 65.28it/s, est. speed input: 83545.20 toks/s, output: 81.59 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [00:10<00:02, 65.39it/s, est. speed input: 83354.84 toks/s, output: 81.40 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:10<00:02, 65.41it/s, est. speed input: 83165.71 toks/s, output: 81.22 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [00:10<00:02, 65.44it/s, est. speed input: 82982.25 toks/s, output: 81.04 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [00:10<00:02, 65.46it/s, est. speed input: 82802.48 toks/s, output: 80.86 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [00:10<00:02, 65.42it/s, est. speed input: 82624.42 toks/s, output: 80.69 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [00:11<00:02, 65.24it/s, est. speed input: 82442.74 toks/s, output: 80.51 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [00:11<00:01, 65.23it/s, est. speed input: 82270.64 toks/s, output: 80.34 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [00:11<00:01, 65.27it/s, est. speed input: 82104.72 toks/s, output: 80.18 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [00:11<00:01, 65.31it/s, est. speed input: 81942.66 toks/s, output: 80.02 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [00:11<00:01, 65.40it/s, est. speed input: 81786.85 toks/s, output: 79.87 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [00:11<00:01, 65.36it/s, est. speed input: 81629.45 toks/s, output: 79.72 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [00:11<00:01, 67.28it/s, est. speed input: 81557.63 toks/s, output: 79.65 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [00:11<00:01, 66.63it/s, est. speed input: 81404.59 toks/s, output: 79.50 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [00:12<00:01, 66.17it/s, est. speed input: 81254.40 toks/s, output: 79.35 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [00:12<00:00, 66.02it/s, est. speed input: 81113.75 toks/s, output: 79.21 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [00:12<00:00, 65.77it/s, est. speed input: 80970.16 toks/s, output: 79.07 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [00:12<00:00, 65.58it/s, est. speed input: 80828.55 toks/s, output: 78.93 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [00:12<00:00, 67.44it/s, est. speed input: 80767.87 toks/s, output: 78.87 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [00:12<00:00, 66.70it/s, est. speed input: 80629.58 toks/s, output: 78.74 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [00:12<00:00, 66.26it/s, est. speed input: 80496.74 toks/s, output: 78.61 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [00:12<00:00, 66.09it/s, est. speed input: 80371.60 toks/s, output: 78.49 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [00:12<00:00, 68.01it/s, est. speed input: 80323.90 toks/s, output: 78.44 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:12<00:00, 68.01it/s, est. speed input: 80795.73 toks/s, output: 78.90 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:12<00:00, 78.90it/s, est. speed input: 80795.73 toks/s, output: 78.90 toks/s]
[rank0]:[W128 00:25:20.523834085 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=16384 ==========
Time: 2026-01-28 00:25:22
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=2048, max_num_seqs=16
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 2048 --max-num-seqs 16 --max-model-len 1025 --max-num-batched-tokens 16384 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_8/json/BitNet-2B-INT8_M16384.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:25:40 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=2239306) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=2239306) WARNING 01-28 00:25:58 [backends.py:609] Failed to read file <frozen os>
Throughput: 66.73 requests/s, 68402.88 total tokens/s, 66.73 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048

STDERR:
[2026-01-28 00:25:40] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:25:40] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:25:40] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:25:40] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:25:40] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:25:40] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:25:40] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:25:40] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:25:40] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:25:40] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:25:40] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:25:40] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:25:40] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:25:40] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:25:48] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:25:48] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:25:48] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:25:48] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:25:48] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:25:48] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:25:48] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:25:48] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:25:48] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:25:48] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:25:48] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:25:48] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:25:48] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:25:48] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=2239306) [2026-01-28 00:25:49] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=2239306) [2026-01-28 00:25:49] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=2239306) [2026-01-28 00:25:49] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=2239306) [2026-01-28 00:25:49] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=2239306) [2026-01-28 00:25:49] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=2239306) [2026-01-28 00:25:49] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=2239306) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=2239306) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.30it/s]
(EngineCore_DP0 pid=2239306) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.30it/s]
(EngineCore_DP0 pid=2239306) 
(EngineCore_DP0 pid=2239306) [2026-01-28 00:25:50] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 3840] -> 1D uint8
(EngineCore_DP0 pid=2239306) [2026-01-28 00:25:50] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 11059200 bytes
(EngineCore_DP0 pid=2239306) [2026-01-28 00:25:50] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 3840] -> 1D uint8
(EngineCore_DP0 pid=2239306) [2026-01-28 00:25:50] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7372800 bytes
(EngineCore_DP0 pid=2239306) [2026-01-28 00:25:50] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 3840] -> 1D uint8
(EngineCore_DP0 pid=2239306) [2026-01-28 00:25:50] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 39813120 bytes
(EngineCore_DP0 pid=2239306) [2026-01-28 00:25:50] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 10368] -> 1D uint8
(EngineCore_DP0 pid=2239306) [2026-01-28 00:25:50] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 19906560 bytes
(EngineCore_DP0 pid=2239306) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  14%|█▍        | 1/7 [00:00<00:00,  8.70it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  29%|██▊       | 2/7 [00:00<00:00,  9.00it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  57%|█████▋    | 4/7 [00:00<00:00,  9.75it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  86%|████████▌ | 6/7 [00:00<00:00, 10.14it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00,  9.83it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00,  9.75it/s]
(EngineCore_DP0 pid=2239306) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  20%|██        | 1/5 [00:00<00:00,  8.17it/s]
Capturing CUDA graphs (decode, FULL):  60%|██████    | 3/5 [00:00<00:00,  9.49it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00,  9.81it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00,  9.64it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 36/2048 [00:00<00:05, 354.35it/s]
Adding requests:   4%|▎         | 74/2048 [00:00<00:05, 364.93it/s]
Adding requests:   5%|▌         | 111/2048 [00:00<00:05, 362.46it/s]
Adding requests:   7%|▋         | 149/2048 [00:00<00:05, 367.16it/s]
Adding requests:   9%|▉         | 187/2048 [00:00<00:05, 368.51it/s]
Adding requests:  11%|█         | 225/2048 [00:00<00:04, 368.92it/s]
Adding requests:  13%|█▎        | 262/2048 [00:00<00:04, 369.20it/s]
Adding requests:  15%|█▍        | 300/2048 [00:00<00:04, 369.77it/s]
Adding requests:  17%|█▋        | 339/2048 [00:00<00:04, 374.42it/s]
Adding requests:  18%|█▊        | 377/2048 [00:01<00:04, 373.95it/s]
Adding requests:  20%|██        | 415/2048 [00:01<00:04, 369.93it/s]
Adding requests:  22%|██▏       | 454/2048 [00:01<00:04, 375.80it/s]
Adding requests:  24%|██▍       | 492/2048 [00:01<00:04, 374.05it/s]
Adding requests:  26%|██▌       | 530/2048 [00:01<00:04, 367.19it/s]
Adding requests:  28%|██▊       | 571/2048 [00:01<00:03, 379.57it/s]
Adding requests:  30%|██▉       | 611/2048 [00:01<00:03, 384.99it/s]
Adding requests:  32%|███▏      | 650/2048 [00:01<00:03, 378.41it/s]
Adding requests:  34%|███▍      | 692/2048 [00:01<00:03, 389.28it/s]
Adding requests:  36%|███▌      | 734/2048 [00:01<00:03, 395.57it/s]
Adding requests:  38%|███▊      | 774/2048 [00:02<00:03, 384.12it/s]
Adding requests:  40%|███▉      | 813/2048 [00:02<00:03, 381.06it/s]
Adding requests:  42%|████▏     | 852/2048 [00:02<00:03, 372.54it/s]
Adding requests:  43%|████▎     | 890/2048 [00:02<00:03, 372.31it/s]
Adding requests:  45%|████▌     | 929/2048 [00:02<00:02, 376.73it/s]
Adding requests:  47%|████▋     | 971/2048 [00:02<00:02, 386.83it/s]
Adding requests:  49%|████▉     | 1013/2048 [00:02<00:02, 394.24it/s]
Adding requests:  51%|█████▏    | 1053/2048 [00:02<00:02, 386.17it/s]
Adding requests:  53%|█████▎    | 1093/2048 [00:02<00:02, 389.10it/s]
Adding requests:  55%|█████▌    | 1133/2048 [00:02<00:02, 390.84it/s]
Adding requests:  57%|█████▋    | 1176/2048 [00:03<00:02, 402.10it/s]
Adding requests:  60%|█████▉    | 1220/2048 [00:03<00:02, 411.43it/s]
Adding requests:  62%|██████▏   | 1262/2048 [00:03<00:01, 405.11it/s]
Adding requests:  64%|██████▎   | 1303/2048 [00:03<00:01, 403.61it/s]
Adding requests:  66%|██████▌   | 1345/2048 [00:03<00:01, 406.76it/s]
Adding requests:  68%|██████▊   | 1386/2048 [00:03<00:01, 401.71it/s]
Adding requests:  70%|██████▉   | 1427/2048 [00:03<00:01, 403.55it/s]
Adding requests:  72%|███████▏  | 1468/2048 [00:03<00:01, 396.03it/s]
Adding requests:  74%|███████▎  | 1510/2048 [00:03<00:01, 402.02it/s]
Adding requests:  76%|███████▌  | 1551/2048 [00:04<00:01, 391.30it/s]
Adding requests:  78%|███████▊  | 1591/2048 [00:04<00:01, 388.66it/s]
Adding requests:  80%|███████▉  | 1632/2048 [00:04<00:01, 393.43it/s]
Adding requests:  82%|████████▏ | 1672/2048 [00:04<00:00, 385.71it/s]
Adding requests:  84%|████████▎ | 1711/2048 [00:04<00:00, 382.22it/s]
Adding requests:  85%|████████▌ | 1750/2048 [00:04<00:00, 379.24it/s]
Adding requests:  87%|████████▋ | 1788/2048 [00:04<00:00, 372.75it/s]
Adding requests:  89%|████████▉ | 1827/2048 [00:04<00:00, 375.38it/s]
Adding requests:  91%|█████████ | 1865/2048 [00:04<00:00, 375.07it/s]
Adding requests:  93%|█████████▎| 1903/2048 [00:04<00:00, 374.55it/s]
Adding requests:  95%|█████████▍| 1944/2048 [00:05<00:00, 383.79it/s]
Adding requests:  97%|█████████▋| 1987/2048 [00:05<00:00, 394.75it/s]
Adding requests:  99%|█████████▉| 2029/2048 [00:05<00:00, 401.21it/s]
Adding requests: 100%|██████████| 2048/2048 [00:05<00:00, 384.99it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  17%|█▋        | 354/2048 [00:00<00:01, 1336.84it/s, est. speed input: 1369060.56 toks/s, output: 1336.87 toks/s]
Processed prompts:  24%|██▍       | 488/2048 [00:02<00:08, 182.68it/s, est. speed input: 230340.94 toks/s, output: 224.94 toks/s]   
Processed prompts:  27%|██▋       | 548/2048 [00:03<00:11, 135.28it/s, est. speed input: 179534.34 toks/s, output: 175.33 toks/s]
Processed prompts:  29%|██▊       | 584/2048 [00:03<00:12, 121.82it/s, est. speed input: 165739.88 toks/s, output: 161.86 toks/s]
Processed prompts:  30%|██▉       | 609/2048 [00:03<00:12, 119.41it/s, est. speed input: 162050.90 toks/s, output: 158.25 toks/s]
Processed prompts:  31%|███       | 629/2048 [00:04<00:14, 97.66it/s, est. speed input: 148823.77 toks/s, output: 145.34 toks/s] 
Processed prompts:  31%|███▏      | 644/2048 [00:04<00:15, 91.96it/s, est. speed input: 144444.40 toks/s, output: 141.06 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [00:04<00:16, 85.48it/s, est. speed input: 140212.39 toks/s, output: 136.93 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [00:05<00:16, 81.47it/s, est. speed input: 136809.56 toks/s, output: 133.60 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [00:05<00:17, 78.00it/s, est. speed input: 133704.40 toks/s, output: 130.57 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [00:05<00:17, 75.15it/s, est. speed input: 130861.14 toks/s, output: 127.79 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [00:05<00:18, 72.95it/s, est. speed input: 128268.45 toks/s, output: 125.26 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [00:06<00:18, 71.32it/s, est. speed input: 125893.05 toks/s, output: 122.94 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [00:06<00:18, 70.03it/s, est. speed input: 123684.47 toks/s, output: 120.79 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [00:06<00:18, 69.09it/s, est. speed input: 121638.57 toks/s, output: 118.79 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [00:06<00:18, 68.45it/s, est. speed input: 119747.10 toks/s, output: 116.94 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [00:06<00:18, 67.93it/s, est. speed input: 117972.39 toks/s, output: 115.21 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [00:07<00:18, 67.54it/s, est. speed input: 116313.03 toks/s, output: 113.59 toks/s]
Processed prompts:  41%|████      | 834/2048 [00:07<00:18, 67.26it/s, est. speed input: 114759.05 toks/s, output: 112.07 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [00:07<00:17, 67.22it/s, est. speed input: 113330.87 toks/s, output: 110.67 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [00:07<00:17, 67.13it/s, est. speed input: 111978.26 toks/s, output: 109.35 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [00:08<00:17, 67.07it/s, est. speed input: 110705.23 toks/s, output: 108.11 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [00:08<00:17, 66.96it/s, est. speed input: 109494.60 toks/s, output: 106.93 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [00:08<00:16, 66.96it/s, est. speed input: 108361.83 toks/s, output: 105.82 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [00:08<00:16, 67.93it/s, est. speed input: 107429.12 toks/s, output: 104.91 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [00:09<00:16, 67.58it/s, est. speed input: 106400.89 toks/s, output: 103.91 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [00:09<00:16, 67.31it/s, est. speed input: 105422.10 toks/s, output: 102.95 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [00:09<00:15, 68.04it/s, est. speed input: 104610.22 toks/s, output: 102.16 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [00:09<00:15, 67.78it/s, est. speed input: 103740.25 toks/s, output: 101.31 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [00:10<00:15, 67.47it/s, est. speed input: 102896.31 toks/s, output: 100.48 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [00:10<00:15, 67.17it/s, est. speed input: 102082.65 toks/s, output: 99.69 toks/s] 
Processed prompts:  51%|█████     | 1042/2048 [00:10<00:15, 67.03it/s, est. speed input: 101312.96 toks/s, output: 98.94 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [00:10<00:14, 66.88it/s, est. speed input: 100572.31 toks/s, output: 98.21 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [00:11<00:14, 66.84it/s, est. speed input: 99870.37 toks/s, output: 97.53 toks/s] 
Processed prompts:  53%|█████▎    | 1090/2048 [00:11<00:14, 66.89it/s, est. speed input: 99207.00 toks/s, output: 96.88 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [00:11<00:14, 66.86it/s, est. speed input: 98564.47 toks/s, output: 96.25 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [00:11<00:13, 66.79it/s, est. speed input: 97943.44 toks/s, output: 95.65 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [00:11<00:13, 66.75it/s, est. speed input: 97348.07 toks/s, output: 95.07 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [00:12<00:13, 67.73it/s, est. speed input: 96870.69 toks/s, output: 94.60 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [00:12<00:13, 67.50it/s, est. speed input: 96326.82 toks/s, output: 94.07 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [00:12<00:12, 67.29it/s, est. speed input: 95799.81 toks/s, output: 93.55 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [00:12<00:12, 67.04it/s, est. speed input: 95282.31 toks/s, output: 93.05 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [00:13<00:12, 66.94it/s, est. speed input: 94791.19 toks/s, output: 92.57 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [00:13<00:12, 66.86it/s, est. speed input: 94316.01 toks/s, output: 92.11 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [00:13<00:11, 66.86it/s, est. speed input: 93861.98 toks/s, output: 91.66 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [00:13<00:11, 67.71it/s, est. speed input: 93492.04 toks/s, output: 91.30 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [00:14<00:11, 67.35it/s, est. speed input: 93059.40 toks/s, output: 90.88 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [00:14<00:11, 67.21it/s, est. speed input: 92649.64 toks/s, output: 90.48 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [00:14<00:10, 67.04it/s, est. speed input: 92247.77 toks/s, output: 90.09 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [00:14<00:10, 66.90it/s, est. speed input: 91857.51 toks/s, output: 89.70 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [00:15<00:10, 66.72it/s, est. speed input: 91474.00 toks/s, output: 89.33 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [00:15<00:10, 66.73it/s, est. speed input: 91112.08 toks/s, output: 88.98 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [00:15<00:10, 66.67it/s, est. speed input: 90756.47 toks/s, output: 88.63 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [00:15<00:09, 66.63it/s, est. speed input: 90411.71 toks/s, output: 88.29 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [00:16<00:09, 66.70it/s, est. speed input: 90084.14 toks/s, output: 87.97 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [00:16<00:09, 66.67it/s, est. speed input: 89760.99 toks/s, output: 87.66 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [00:16<00:09, 66.66it/s, est. speed input: 89447.63 toks/s, output: 87.35 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [00:16<00:08, 66.66it/s, est. speed input: 89143.91 toks/s, output: 87.05 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [00:16<00:08, 66.60it/s, est. speed input: 88845.36 toks/s, output: 86.76 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [00:17<00:08, 66.58it/s, est. speed input: 88556.39 toks/s, output: 86.48 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [00:17<00:08, 66.64it/s, est. speed input: 88279.36 toks/s, output: 86.21 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [00:17<00:07, 66.60it/s, est. speed input: 88005.45 toks/s, output: 85.94 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [00:17<00:07, 66.50it/s, est. speed input: 87734.21 toks/s, output: 85.68 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [00:18<00:07, 66.53it/s, est. speed input: 87476.22 toks/s, output: 85.43 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [00:18<00:07, 66.56it/s, est. speed input: 87225.51 toks/s, output: 85.18 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [00:18<00:06, 67.65it/s, est. speed input: 87040.10 toks/s, output: 85.00 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [00:18<00:06, 67.31it/s, est. speed input: 86799.29 toks/s, output: 84.76 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [00:19<00:06, 67.00it/s, est. speed input: 86561.03 toks/s, output: 84.53 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [00:19<00:06, 66.85it/s, est. speed input: 86331.96 toks/s, output: 84.31 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [00:19<00:05, 66.80it/s, est. speed input: 86111.14 toks/s, output: 84.09 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [00:19<00:05, 66.77it/s, est. speed input: 85895.82 toks/s, output: 83.88 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [00:20<00:05, 66.61it/s, est. speed input: 85678.86 toks/s, output: 83.67 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [00:20<00:05, 66.71it/s, est. speed input: 85477.41 toks/s, output: 83.47 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [00:20<00:05, 66.59it/s, est. speed input: 85271.29 toks/s, output: 83.27 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [00:20<00:04, 66.66it/s, est. speed input: 85077.80 toks/s, output: 83.08 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [00:21<00:04, 66.60it/s, est. speed input: 84883.20 toks/s, output: 82.89 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [00:21<00:04, 66.51it/s, est. speed input: 84690.86 toks/s, output: 82.71 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [00:21<00:04, 66.53it/s, est. speed input: 84506.76 toks/s, output: 82.53 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [00:21<00:03, 66.51it/s, est. speed input: 84324.74 toks/s, output: 82.35 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [00:22<00:03, 66.43it/s, est. speed input: 84144.16 toks/s, output: 82.17 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [00:22<00:03, 66.38it/s, est. speed input: 83967.39 toks/s, output: 82.00 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [00:22<00:03, 66.39it/s, est. speed input: 83796.55 toks/s, output: 81.83 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [00:22<00:02, 66.37it/s, est. speed input: 83628.05 toks/s, output: 81.67 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [00:22<00:02, 67.30it/s, est. speed input: 83504.08 toks/s, output: 81.55 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [00:23<00:02, 67.12it/s, est. speed input: 83347.32 toks/s, output: 81.39 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [00:23<00:02, 66.93it/s, est. speed input: 83190.62 toks/s, output: 81.24 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [00:23<00:01, 66.73it/s, est. speed input: 83034.33 toks/s, output: 81.09 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [00:23<00:01, 66.53it/s, est. speed input: 82878.92 toks/s, output: 80.94 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [00:24<00:01, 67.57it/s, est. speed input: 82774.53 toks/s, output: 80.83 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [00:24<00:01, 67.13it/s, est. speed input: 82625.36 toks/s, output: 80.69 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [00:24<00:00, 66.89it/s, est. speed input: 82481.46 toks/s, output: 80.55 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [00:24<00:00, 66.67it/s, est. speed input: 82338.20 toks/s, output: 80.41 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [00:25<00:00, 66.49it/s, est. speed input: 82196.80 toks/s, output: 80.27 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [00:25<00:00, 67.66it/s, est. speed input: 82107.89 toks/s, output: 80.18 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:25<00:00, 67.66it/s, est. speed input: 82671.97 toks/s, output: 80.73 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:25<00:00, 80.73it/s, est. speed input: 82671.97 toks/s, output: 80.73 toks/s]
[rank0]:[W128 00:26:50.910777330 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=32768 ==========
Time: 2026-01-28 00:26:52
Backend: cuSPARSELt (2:8)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_8
Params: prompt_len=1024, output_len=1, num_prompts=4096, max_num_seqs=32
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_8 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 4096 --max-num-seqs 32 --max-model-len 1025 --max-num-batched-tokens 32768 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_8/json/BitNet-2B-INT8_M32768.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:27:22 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=2241009) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=2241009) WARNING 01-28 00:27:40 [backends.py:609] Failed to read file <frozen os>
Throughput: 67.18 requests/s, 68855.75 total tokens/s, 67.18 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096

STDERR:
[2026-01-28 00:27:22] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:27:22] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:27:22] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:27:22] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:27:22] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:27:22] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:27:22] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:27:22] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:27:22] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:27:22] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:27:22] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:27:22] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:27:22] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:27:22] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:27:30] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:27:30] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:27:30] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:27:30] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:27:30] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:27:30] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:27:30] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:27:30] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:27:30] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:27:30] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:27:30] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:27:30] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:27:30] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:27:30] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=2241009) [2026-01-28 00:27:31] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=2241009) [2026-01-28 00:27:31] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=2241009) [2026-01-28 00:27:31] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=2241009) [2026-01-28 00:27:31] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=2241009) [2026-01-28 00:27:31] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=2241009) [2026-01-28 00:27:31] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=2241009) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=2241009) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.27it/s]
(EngineCore_DP0 pid=2241009) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.27it/s]
(EngineCore_DP0 pid=2241009) 
(EngineCore_DP0 pid=2241009) [2026-01-28 00:27:32] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 3840] -> 1D uint8
(EngineCore_DP0 pid=2241009) [2026-01-28 00:27:32] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 11059200 bytes
(EngineCore_DP0 pid=2241009) [2026-01-28 00:27:32] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 3840] -> 1D uint8
(EngineCore_DP0 pid=2241009) [2026-01-28 00:27:32] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7372800 bytes
(EngineCore_DP0 pid=2241009) [2026-01-28 00:27:32] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 3840] -> 1D uint8
(EngineCore_DP0 pid=2241009) [2026-01-28 00:27:32] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 39813120 bytes
(EngineCore_DP0 pid=2241009) [2026-01-28 00:27:32] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 10368] -> 1D uint8
(EngineCore_DP0 pid=2241009) [2026-01-28 00:27:32] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 19906560 bytes
(EngineCore_DP0 pid=2241009) [rank0]:W0128 00:27:49.885000 2241009 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=2241009) [rank0]:W0128 00:27:50.005000 2241009 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=2241009) [rank0]:W0128 00:27:51.423000 2241009 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=2241009) [rank0]:W0128 00:27:51.610000 2241009 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=2241009) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   9%|▉         | 1/11 [00:00<00:01,  8.55it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  18%|█▊        | 2/11 [00:00<00:01,  8.95it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  36%|███▋      | 4/11 [00:00<00:00,  9.83it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  45%|████▌     | 5/11 [00:00<00:00,  9.73it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  64%|██████▎   | 7/11 [00:00<00:00,  9.81it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  82%|████████▏ | 9/11 [00:00<00:00, 10.05it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00,  9.92it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00,  9.80it/s]
(EngineCore_DP0 pid=2241009) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  14%|█▍        | 1/7 [00:00<00:00,  8.89it/s]
Capturing CUDA graphs (decode, FULL):  43%|████▎     | 3/7 [00:00<00:00, 10.06it/s]
Capturing CUDA graphs (decode, FULL):  57%|█████▋    | 4/7 [00:00<00:00,  9.92it/s]
Capturing CUDA graphs (decode, FULL):  71%|███████▏  | 5/7 [00:00<00:00,  9.91it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00, 10.02it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00,  9.94it/s]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   1%|          | 38/4096 [00:00<00:10, 372.90it/s]
Adding requests:   2%|▏         | 79/4096 [00:00<00:10, 389.89it/s]
Adding requests:   3%|▎         | 119/4096 [00:00<00:10, 390.93it/s]
Adding requests:   4%|▍         | 159/4096 [00:00<00:10, 381.41it/s]
Adding requests:   5%|▍         | 198/4096 [00:00<00:10, 371.97it/s]
Adding requests:   6%|▌         | 237/4096 [00:00<00:10, 375.62it/s]
Adding requests:   7%|▋         | 276/4096 [00:00<00:10, 379.95it/s]
Adding requests:   8%|▊         | 315/4096 [00:00<00:09, 380.48it/s]
Adding requests:   9%|▊         | 356/4096 [00:00<00:09, 388.05it/s]
Adding requests:  10%|▉         | 397/4096 [00:01<00:09, 392.06it/s]
Adding requests:  11%|█         | 437/4096 [00:01<00:09, 385.89it/s]
Adding requests:  12%|█▏        | 477/4096 [00:01<00:09, 388.82it/s]
Adding requests:  13%|█▎        | 516/4096 [00:01<00:09, 385.18it/s]
Adding requests:  14%|█▎        | 555/4096 [00:01<00:09, 381.98it/s]
Adding requests:  15%|█▍        | 595/4096 [00:01<00:09, 386.93it/s]
Adding requests:  15%|█▌        | 634/4096 [00:01<00:09, 383.44it/s]
Adding requests:  16%|█▋        | 675/4096 [00:01<00:08, 390.83it/s]
Adding requests:  18%|█▊        | 718/4096 [00:01<00:08, 401.35it/s]
Adding requests:  19%|█▊        | 759/4096 [00:01<00:08, 403.73it/s]
Adding requests:  20%|█▉        | 800/4096 [00:02<00:08, 399.85it/s]
Adding requests:  21%|██        | 841/4096 [00:02<00:08, 393.30it/s]
Adding requests:  22%|██▏       | 882/4096 [00:02<00:08, 397.07it/s]
Adding requests:  23%|██▎       | 923/4096 [00:02<00:07, 400.60it/s]
Adding requests:  24%|██▎       | 964/4096 [00:02<00:07, 394.03it/s]
Adding requests:  25%|██▍       | 1004/4096 [00:02<00:07, 390.34it/s]
Adding requests:  26%|██▌       | 1046/4096 [00:02<00:07, 396.73it/s]
Adding requests:  27%|██▋       | 1086/4096 [00:02<00:07, 389.11it/s]
Adding requests:  27%|██▋       | 1125/4096 [00:02<00:07, 382.71it/s]
Adding requests:  28%|██▊       | 1164/4096 [00:02<00:07, 383.90it/s]
Adding requests:  29%|██▉       | 1203/4096 [00:03<00:07, 385.27it/s]
Adding requests:  30%|███       | 1242/4096 [00:03<00:07, 382.41it/s]
Adding requests:  31%|███▏      | 1281/4096 [00:03<00:07, 378.47it/s]
Adding requests:  32%|███▏      | 1321/4096 [00:03<00:07, 384.51it/s]
Adding requests:  33%|███▎      | 1361/4096 [00:03<00:07, 388.28it/s]
Adding requests:  34%|███▍      | 1404/4096 [00:03<00:06, 399.72it/s]
Adding requests:  35%|███▌      | 1445/4096 [00:03<00:06, 393.68it/s]
Adding requests:  36%|███▋      | 1486/4096 [00:03<00:06, 396.55it/s]
Adding requests:  37%|███▋      | 1528/4096 [00:03<00:06, 401.32it/s]
Adding requests:  38%|███▊      | 1570/4096 [00:04<00:06, 406.74it/s]
Adding requests:  39%|███▉      | 1614/4096 [00:04<00:05, 415.03it/s]
Adding requests:  40%|████      | 1657/4096 [00:04<00:05, 417.12it/s]
Adding requests:  41%|████▏     | 1699/4096 [00:04<00:05, 415.12it/s]
Adding requests:  43%|████▎     | 1741/4096 [00:04<00:05, 409.68it/s]
Adding requests:  44%|████▎     | 1782/4096 [00:04<00:05, 401.24it/s]
Adding requests:  45%|████▍     | 1823/4096 [00:04<00:05, 396.50it/s]
Adding requests:  45%|████▌     | 1863/4096 [00:04<00:05, 386.62it/s]
Adding requests:  46%|████▋     | 1902/4096 [00:04<00:05, 386.38it/s]
Adding requests:  47%|████▋     | 1941/4096 [00:04<00:05, 384.01it/s]
Adding requests:  48%|████▊     | 1980/4096 [00:05<00:05, 382.61it/s]
Adding requests:  49%|████▉     | 2021/4096 [00:05<00:05, 390.39it/s]
Adding requests:  50%|█████     | 2062/4096 [00:05<00:05, 395.05it/s]
Adding requests:  51%|█████▏    | 2103/4096 [00:05<00:05, 396.95it/s]
Adding requests:  52%|█████▏    | 2143/4096 [00:05<00:05, 379.73it/s]
Adding requests:  53%|█████▎    | 2182/4096 [00:05<00:05, 378.03it/s]
Adding requests:  54%|█████▍    | 2224/4096 [00:05<00:04, 387.68it/s]
Adding requests:  55%|█████▌    | 2263/4096 [00:05<00:04, 381.92it/s]
Adding requests:  56%|█████▌    | 2302/4096 [00:05<00:04, 376.21it/s]
Adding requests:  57%|█████▋    | 2342/4096 [00:06<00:04, 381.47it/s]
Adding requests:  58%|█████▊    | 2383/4096 [00:06<00:04, 389.69it/s]
Adding requests:  59%|█████▉    | 2423/4096 [00:06<00:04, 383.99it/s]
Adding requests:  60%|██████    | 2462/4096 [00:06<00:04, 384.55it/s]
Adding requests:  61%|██████    | 2501/4096 [00:06<00:04, 383.24it/s]
Adding requests:  62%|██████▏   | 2541/4096 [00:06<00:04, 385.36it/s]
Adding requests:  63%|██████▎   | 2580/4096 [00:06<00:03, 386.31it/s]
Adding requests:  64%|██████▍   | 2619/4096 [00:06<00:03, 379.28it/s]
Adding requests:  65%|██████▍   | 2659/4096 [00:06<00:03, 383.92it/s]
Adding requests:  66%|██████▌   | 2698/4096 [00:06<00:03, 383.09it/s]
Adding requests:  67%|██████▋   | 2739/4096 [00:07<00:03, 389.04it/s]
Adding requests:  68%|██████▊   | 2780/4096 [00:07<00:03, 393.23it/s]
Adding requests:  69%|██████▉   | 2820/4096 [00:07<00:03, 389.62it/s]
Adding requests:  70%|██████▉   | 2860/4096 [00:07<00:03, 391.60it/s]
Adding requests:  71%|███████   | 2900/4096 [00:07<00:03, 393.94it/s]
Adding requests:  72%|███████▏  | 2940/4096 [00:07<00:02, 391.48it/s]
Adding requests:  73%|███████▎  | 2982/4096 [00:07<00:02, 397.34it/s]
Adding requests:  74%|███████▍  | 3024/4096 [00:07<00:02, 403.21it/s]
Adding requests:  75%|███████▍  | 3065/4096 [00:07<00:02, 394.03it/s]
Adding requests:  76%|███████▌  | 3105/4096 [00:07<00:02, 388.63it/s]
Adding requests:  77%|███████▋  | 3146/4096 [00:08<00:02, 392.41it/s]
Adding requests:  78%|███████▊  | 3187/4096 [00:08<00:02, 396.99it/s]
Adding requests:  79%|███████▉  | 3227/4096 [00:08<00:02, 397.29it/s]
Adding requests:  80%|███████▉  | 3269/4096 [00:08<00:02, 401.09it/s]
Adding requests:  81%|████████  | 3310/4096 [00:08<00:01, 399.94it/s]
Adding requests:  82%|████████▏ | 3351/4096 [00:08<00:01, 397.82it/s]
Adding requests:  83%|████████▎ | 3391/4096 [00:08<00:01, 391.11it/s]
Adding requests:  84%|████████▍ | 3431/4096 [00:08<00:01, 387.07it/s]
Adding requests:  85%|████████▍ | 3470/4096 [00:08<00:01, 372.80it/s]
Adding requests:  86%|████████▌ | 3508/4096 [00:09<00:01, 372.20it/s]
Adding requests:  87%|████████▋ | 3547/4096 [00:09<00:01, 376.75it/s]
Adding requests:  88%|████████▊ | 3587/4096 [00:09<00:01, 381.41it/s]
Adding requests:  89%|████████▊ | 3626/4096 [00:09<00:01, 366.44it/s]
Adding requests:  89%|████████▉ | 3663/4096 [00:09<00:01, 362.57it/s]
Adding requests:  90%|█████████ | 3702/4096 [00:09<00:01, 370.41it/s]
Adding requests:  91%|█████████▏| 3741/4096 [00:09<00:00, 375.40it/s]
Adding requests:  92%|█████████▏| 3782/4096 [00:09<00:00, 383.86it/s]
Adding requests:  93%|█████████▎| 3822/4096 [00:09<00:00, 388.24it/s]
Adding requests:  94%|█████████▍| 3862/4096 [00:09<00:00, 391.22it/s]
Adding requests:  95%|█████████▌| 3902/4096 [00:10<00:00, 381.87it/s]
Adding requests:  96%|█████████▌| 3941/4096 [00:10<00:00, 382.77it/s]
Adding requests:  97%|█████████▋| 3980/4096 [00:10<00:00, 379.35it/s]
Adding requests:  98%|█████████▊| 4022/4096 [00:10<00:00, 388.43it/s]
Adding requests:  99%|█████████▉| 4061/4096 [00:10<00:00, 374.19it/s]
Adding requests: 100%|██████████| 4096/4096 [00:10<00:00, 388.29it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  17%|█▋        | 699/4096 [00:00<00:01, 2034.22it/s, est. speed input: 2083199.51 toks/s, output: 2034.26 toks/s]
Processed prompts:  22%|██▏       | 903/4096 [00:03<00:14, 224.28it/s, est. speed input: 289478.46 toks/s, output: 282.69 toks/s]   
Processed prompts:  24%|██▍       | 991/4096 [00:04<00:19, 160.51it/s, est. speed input: 220497.03 toks/s, output: 215.33 toks/s]
Processed prompts:  25%|██▌       | 1042/4096 [00:05<00:20, 151.97it/s, est. speed input: 210113.42 toks/s, output: 205.19 toks/s]
Processed prompts:  26%|██▋       | 1077/4096 [00:05<00:21, 137.45it/s, est. speed input: 198600.28 toks/s, output: 193.95 toks/s]
Processed prompts:  27%|██▋       | 1102/4096 [00:06<00:25, 119.66it/s, est. speed input: 187192.26 toks/s, output: 182.80 toks/s]
Processed prompts:  27%|██▋       | 1121/4096 [00:06<00:29, 101.28it/s, est. speed input: 176498.17 toks/s, output: 172.36 toks/s]
Processed prompts:  28%|██▊       | 1147/4096 [00:06<00:32, 90.23it/s, est. speed input: 168546.45 toks/s, output: 164.60 toks/s] 
Processed prompts:  29%|██▉       | 1179/4096 [00:07<00:34, 84.17it/s, est. speed input: 162162.56 toks/s, output: 158.36 toks/s]
Processed prompts:  30%|██▉       | 1211/4096 [00:07<00:36, 79.53it/s, est. speed input: 156546.50 toks/s, output: 152.88 toks/s]
Processed prompts:  30%|███       | 1243/4096 [00:08<00:37, 76.58it/s, est. speed input: 151774.80 toks/s, output: 148.22 toks/s]
Processed prompts:  31%|███       | 1275/4096 [00:08<00:38, 73.86it/s, est. speed input: 147310.03 toks/s, output: 143.86 toks/s]
Processed prompts:  32%|███▏      | 1307/4096 [00:09<00:38, 71.98it/s, est. speed input: 143328.28 toks/s, output: 139.97 toks/s]
Processed prompts:  33%|███▎      | 1339/4096 [00:09<00:39, 70.51it/s, est. speed input: 139692.17 toks/s, output: 136.42 toks/s]
Processed prompts:  33%|███▎      | 1371/4096 [00:10<00:39, 69.51it/s, est. speed input: 136404.70 toks/s, output: 133.21 toks/s]
Processed prompts:  34%|███▍      | 1403/4096 [00:10<00:39, 68.80it/s, est. speed input: 133410.22 toks/s, output: 130.28 toks/s]
Processed prompts:  35%|███▌      | 1435/4096 [00:11<00:38, 68.29it/s, est. speed input: 130664.93 toks/s, output: 127.60 toks/s]
Processed prompts:  36%|███▌      | 1467/4096 [00:11<00:38, 67.93it/s, est. speed input: 128142.62 toks/s, output: 125.14 toks/s]
Processed prompts:  37%|███▋      | 1499/4096 [00:12<00:38, 67.72it/s, est. speed input: 125829.87 toks/s, output: 122.88 toks/s]
Processed prompts:  37%|███▋      | 1531/4096 [00:12<00:38, 67.50it/s, est. speed input: 123672.07 toks/s, output: 120.77 toks/s]
Processed prompts:  38%|███▊      | 1563/4096 [00:13<00:37, 67.47it/s, est. speed input: 121698.24 toks/s, output: 118.85 toks/s]
Processed prompts:  39%|███▉      | 1595/4096 [00:13<00:36, 67.88it/s, est. speed input: 119952.27 toks/s, output: 117.14 toks/s]
Processed prompts:  40%|███▉      | 1627/4096 [00:14<00:36, 67.66it/s, est. speed input: 118220.52 toks/s, output: 115.45 toks/s]
Processed prompts:  41%|████      | 1659/4096 [00:14<00:36, 67.42it/s, est. speed input: 116587.54 toks/s, output: 113.85 toks/s]
Processed prompts:  41%|████▏     | 1691/4096 [00:15<00:35, 67.35it/s, est. speed input: 115074.78 toks/s, output: 112.38 toks/s]
Processed prompts:  42%|████▏     | 1723/4096 [00:15<00:35, 67.26it/s, est. speed input: 113647.88 toks/s, output: 110.98 toks/s]
Processed prompts:  43%|████▎     | 1755/4096 [00:16<00:34, 67.15it/s, est. speed input: 112298.57 toks/s, output: 109.67 toks/s]
Processed prompts:  44%|████▎     | 1787/4096 [00:16<00:34, 67.14it/s, est. speed input: 111037.40 toks/s, output: 108.43 toks/s]
Processed prompts:  44%|████▍     | 1819/4096 [00:16<00:33, 67.03it/s, est. speed input: 109831.59 toks/s, output: 107.26 toks/s]
Processed prompts:  45%|████▌     | 1851/4096 [00:17<00:33, 67.54it/s, est. speed input: 108779.46 toks/s, output: 106.23 toks/s]
Processed prompts:  46%|████▌     | 1883/4096 [00:17<00:32, 67.30it/s, est. speed input: 107697.16 toks/s, output: 105.17 toks/s]
Processed prompts:  47%|████▋     | 1915/4096 [00:18<00:32, 67.21it/s, est. speed input: 106680.63 toks/s, output: 104.18 toks/s]
Processed prompts:  48%|████▊     | 1947/4096 [00:18<00:31, 67.63it/s, est. speed input: 105780.79 toks/s, output: 103.30 toks/s]
Processed prompts:  48%|████▊     | 1979/4096 [00:19<00:31, 67.42it/s, est. speed input: 104858.89 toks/s, output: 102.40 toks/s]
Processed prompts:  49%|████▉     | 2011/4096 [00:19<00:31, 67.25it/s, est. speed input: 103979.33 toks/s, output: 101.54 toks/s]
Processed prompts:  50%|████▉     | 2043/4096 [00:20<00:30, 67.09it/s, est. speed input: 103136.71 toks/s, output: 100.72 toks/s]
Processed prompts:  51%|█████     | 2075/4096 [00:20<00:30, 67.01it/s, est. speed input: 102336.10 toks/s, output: 99.94 toks/s] 
Processed prompts:  51%|█████▏    | 2107/4096 [00:21<00:29, 67.03it/s, est. speed input: 101579.85 toks/s, output: 99.20 toks/s]
Processed prompts:  52%|█████▏    | 2139/4096 [00:21<00:29, 66.97it/s, est. speed input: 100849.43 toks/s, output: 98.49 toks/s]
Processed prompts:  53%|█████▎    | 2171/4096 [00:22<00:28, 66.95it/s, est. speed input: 100152.96 toks/s, output: 97.81 toks/s]
Processed prompts:  54%|█████▍    | 2203/4096 [00:22<00:28, 66.94it/s, est. speed input: 99485.84 toks/s, output: 97.15 toks/s] 
Processed prompts:  55%|█████▍    | 2235/4096 [00:23<00:27, 68.07it/s, est. speed input: 98960.26 toks/s, output: 96.64 toks/s]
Processed prompts:  55%|█████▌    | 2267/4096 [00:23<00:27, 67.67it/s, est. speed input: 98338.99 toks/s, output: 96.03 toks/s]
Processed prompts:  56%|█████▌    | 2299/4096 [00:24<00:26, 67.99it/s, est. speed input: 97798.48 toks/s, output: 95.51 toks/s]
Processed prompts:  57%|█████▋    | 2331/4096 [00:24<00:25, 68.19it/s, est. speed input: 97276.11 toks/s, output: 95.00 toks/s]
Processed prompts:  58%|█████▊    | 2363/4096 [00:24<00:25, 68.97it/s, est. speed input: 96829.85 toks/s, output: 94.56 toks/s]
Processed prompts:  58%|█████▊    | 2395/4096 [00:25<00:24, 68.23it/s, est. speed input: 96288.40 toks/s, output: 94.03 toks/s]
Processed prompts:  59%|█████▉    | 2427/4096 [00:25<00:24, 67.77it/s, est. speed input: 95771.96 toks/s, output: 93.53 toks/s]
Processed prompts:  60%|██████    | 2459/4096 [00:26<00:24, 67.50it/s, est. speed input: 95277.32 toks/s, output: 93.04 toks/s]
Processed prompts:  61%|██████    | 2491/4096 [00:26<00:23, 67.75it/s, est. speed input: 94837.33 toks/s, output: 92.61 toks/s]
Processed prompts:  62%|██████▏   | 2523/4096 [00:27<00:23, 67.48it/s, est. speed input: 94375.82 toks/s, output: 92.16 toks/s]
Processed prompts:  62%|██████▏   | 2555/4096 [00:27<00:22, 67.23it/s, est. speed input: 93925.48 toks/s, output: 91.72 toks/s]
Processed prompts:  63%|██████▎   | 2587/4096 [00:28<00:22, 67.58it/s, est. speed input: 93531.55 toks/s, output: 91.34 toks/s]
Processed prompts:  64%|██████▍   | 2619/4096 [00:28<00:21, 67.38it/s, est. speed input: 93115.97 toks/s, output: 90.93 toks/s]
Processed prompts:  65%|██████▍   | 2651/4096 [00:29<00:21, 67.20it/s, est. speed input: 92711.48 toks/s, output: 90.54 toks/s]
Processed prompts:  66%|██████▌   | 2683/4096 [00:29<00:21, 67.08it/s, est. speed input: 92319.90 toks/s, output: 90.16 toks/s]
Processed prompts:  66%|██████▋   | 2715/4096 [00:30<00:20, 66.97it/s, est. speed input: 91939.50 toks/s, output: 89.78 toks/s]
Processed prompts:  67%|██████▋   | 2747/4096 [00:30<00:20, 66.91it/s, est. speed input: 91571.75 toks/s, output: 89.43 toks/s]
Processed prompts:  68%|██████▊   | 2779/4096 [00:31<00:19, 66.88it/s, est. speed input: 91216.14 toks/s, output: 89.08 toks/s]
Processed prompts:  69%|██████▊   | 2811/4096 [00:31<00:19, 66.82it/s, est. speed input: 90868.43 toks/s, output: 88.74 toks/s]
Processed prompts:  69%|██████▉   | 2843/4096 [00:32<00:18, 66.84it/s, est. speed input: 90535.62 toks/s, output: 88.41 toks/s]
Processed prompts:  70%|███████   | 2875/4096 [00:32<00:18, 66.84it/s, est. speed input: 90211.72 toks/s, output: 88.10 toks/s]
Processed prompts:  71%|███████   | 2907/4096 [00:33<00:17, 66.81it/s, est. speed input: 89895.18 toks/s, output: 87.79 toks/s]
Processed prompts:  72%|███████▏  | 2939/4096 [00:33<00:17, 66.74it/s, est. speed input: 89584.47 toks/s, output: 87.48 toks/s]
Processed prompts:  73%|███████▎  | 2971/4096 [00:34<00:16, 66.72it/s, est. speed input: 89284.47 toks/s, output: 87.19 toks/s]
Processed prompts:  73%|███████▎  | 3003/4096 [00:34<00:16, 66.77it/s, est. speed input: 88996.23 toks/s, output: 86.91 toks/s]
Processed prompts:  74%|███████▍  | 3035/4096 [00:35<00:15, 66.79it/s, est. speed input: 88715.55 toks/s, output: 86.64 toks/s]
Processed prompts:  75%|███████▍  | 3067/4096 [00:35<00:15, 66.82it/s, est. speed input: 88443.06 toks/s, output: 86.37 toks/s]
Processed prompts:  76%|███████▌  | 3099/4096 [00:35<00:14, 66.73it/s, est. speed input: 88171.62 toks/s, output: 86.11 toks/s]
Processed prompts:  76%|███████▋  | 3131/4096 [00:36<00:14, 67.19it/s, est. speed input: 87937.12 toks/s, output: 85.88 toks/s]
Processed prompts:  77%|███████▋  | 3163/4096 [00:36<00:13, 67.06it/s, est. speed input: 87683.09 toks/s, output: 85.63 toks/s]
Processed prompts:  78%|███████▊  | 3195/4096 [00:37<00:13, 66.93it/s, est. speed input: 87433.54 toks/s, output: 85.38 toks/s]
Processed prompts:  79%|███████▉  | 3227/4096 [00:37<00:12, 66.87it/s, est. speed input: 87191.69 toks/s, output: 85.15 toks/s]
Processed prompts:  80%|███████▉  | 3259/4096 [00:38<00:12, 66.78it/s, est. speed input: 86953.61 toks/s, output: 84.92 toks/s]
Processed prompts:  80%|████████  | 3291/4096 [00:38<00:12, 66.74it/s, est. speed input: 86722.47 toks/s, output: 84.69 toks/s]
Processed prompts:  81%|████████  | 3323/4096 [00:39<00:11, 66.75it/s, est. speed input: 86498.64 toks/s, output: 84.47 toks/s]
Processed prompts:  82%|████████▏ | 3355/4096 [00:39<00:11, 66.64it/s, est. speed input: 86274.50 toks/s, output: 84.25 toks/s]
Processed prompts:  83%|████████▎ | 3387/4096 [00:40<00:10, 66.68it/s, est. speed input: 86061.48 toks/s, output: 84.04 toks/s]
Processed prompts:  83%|████████▎ | 3419/4096 [00:40<00:10, 66.65it/s, est. speed input: 85850.81 toks/s, output: 83.84 toks/s]
Processed prompts:  84%|████████▍ | 3451/4096 [00:41<00:09, 66.69it/s, est. speed input: 85648.14 toks/s, output: 83.64 toks/s]
Processed prompts:  85%|████████▌ | 3483/4096 [00:41<00:09, 67.82it/s, est. speed input: 85503.14 toks/s, output: 83.50 toks/s]
Processed prompts:  86%|████████▌ | 3515/4096 [00:42<00:08, 67.44it/s, est. speed input: 85305.63 toks/s, output: 83.31 toks/s]
Processed prompts:  87%|████████▋ | 3547/4096 [00:42<00:08, 67.19it/s, est. speed input: 85113.08 toks/s, output: 83.12 toks/s]
Processed prompts:  87%|████████▋ | 3579/4096 [00:43<00:07, 66.99it/s, est. speed input: 84923.94 toks/s, output: 82.93 toks/s]
Processed prompts:  88%|████████▊ | 3611/4096 [00:43<00:07, 66.94it/s, est. speed input: 84742.64 toks/s, output: 82.76 toks/s]
Processed prompts:  89%|████████▉ | 3643/4096 [00:44<00:06, 66.85it/s, est. speed input: 84562.91 toks/s, output: 82.58 toks/s]
Processed prompts:  90%|████████▉ | 3675/4096 [00:44<00:06, 66.79it/s, est. speed input: 84387.21 toks/s, output: 82.41 toks/s]
Processed prompts:  91%|█████████ | 3707/4096 [00:45<00:05, 66.72it/s, est. speed input: 84214.12 toks/s, output: 82.24 toks/s]
Processed prompts:  91%|█████████▏| 3739/4096 [00:45<00:05, 67.26it/s, est. speed input: 84070.53 toks/s, output: 82.10 toks/s]
Processed prompts:  92%|█████████▏| 3771/4096 [00:46<00:04, 66.97it/s, est. speed input: 83900.94 toks/s, output: 81.93 toks/s]
Processed prompts:  93%|█████████▎| 3803/4096 [00:46<00:04, 66.88it/s, est. speed input: 83739.57 toks/s, output: 81.78 toks/s]
Processed prompts:  94%|█████████▎| 3835/4096 [00:46<00:03, 67.33it/s, est. speed input: 83603.13 toks/s, output: 81.64 toks/s]
Processed prompts:  94%|█████████▍| 3867/4096 [00:47<00:03, 67.10it/s, est. speed input: 83446.62 toks/s, output: 81.49 toks/s]
Processed prompts:  95%|█████████▌| 3899/4096 [00:47<00:02, 67.01it/s, est. speed input: 83296.53 toks/s, output: 81.34 toks/s]
Processed prompts:  96%|█████████▌| 3931/4096 [00:48<00:02, 66.83it/s, est. speed input: 83144.21 toks/s, output: 81.20 toks/s]
Processed prompts:  97%|█████████▋| 3963/4096 [00:48<00:01, 66.68it/s, est. speed input: 82994.05 toks/s, output: 81.05 toks/s]
Processed prompts:  98%|█████████▊| 3995/4096 [00:49<00:01, 66.62it/s, est. speed input: 82848.46 toks/s, output: 80.91 toks/s]
Processed prompts:  98%|█████████▊| 4027/4096 [00:49<00:01, 67.03it/s, est. speed input: 82724.12 toks/s, output: 80.79 toks/s]
Processed prompts:  99%|█████████▉| 4059/4096 [00:50<00:00, 67.04it/s, est. speed input: 82590.60 toks/s, output: 80.65 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [00:50<00:00, 67.04it/s, est. speed input: 83183.14 toks/s, output: 81.23 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [00:50<00:00, 81.23it/s, est. speed input: 83183.14 toks/s, output: 81.23 toks/s]
[rank0]:[W128 00:29:03.233831014 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

