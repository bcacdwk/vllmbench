
========== M=16 ==========
Time: 2026-01-25 16:32:43
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_4
Params: prompt_len=16, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_4 --dataset-name random --input-len 16 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 17 --max-num-batched-tokens 17 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/Llama3.2-1B-INT8_M16.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 16:32:50 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=188802) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=188802) WARNING 01-25 16:34:29 [backends.py:609] Failed to read file <frozen os>
Throughput: 19.85 requests/s, 337.49 total tokens/s, 19.85 output tokens/s
Total num prompt tokens:  2048
Total num output tokens:  128

STDERR:
[2026-01-25 16:32:50] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 16:32:50] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 16:32:50] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 16:32:50] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:32:50] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:32:50] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:32:50] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:32:50] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:32:50] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 16:32:50] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 16:32:50] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 16:32:50] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 16:32:50] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 16:32:50] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 16:32:58] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 16:32:58] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 16:32:58] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 16:32:58] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:32:58] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:32:58] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:32:58] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:32:58] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:32:58] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 16:32:58] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 16:32:58] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 16:32:58] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 16:32:58] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 16:32:58] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=188802) [2026-01-25 16:32:59] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=188802) [2026-01-25 16:32:59] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=188802) [2026-01-25 16:32:59] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=188802) [2026-01-25 16:32:59] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=188802) [2026-01-25 16:32:59] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-1B-INT8
(EngineCore_DP0 pid=188802) [2026-01-25 16:32:59] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=188802) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=188802) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [01:24<00:00, 84.98s/it]
(EngineCore_DP0 pid=188802) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [01:24<00:00, 84.98s/it]
(EngineCore_DP0 pid=188802) 
(EngineCore_DP0 pid=188802) [2026-01-25 16:34:24] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 2048] -> 1D uint8
(EngineCore_DP0 pid=188802) [2026-01-25 16:34:24] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4718592 bytes
(EngineCore_DP0 pid=188802) [2026-01-25 16:34:24] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 2048] -> 1D uint8
(EngineCore_DP0 pid=188802) [2026-01-25 16:34:24] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 3145728 bytes
(EngineCore_DP0 pid=188802) [2026-01-25 16:34:24] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 2048] -> 1D uint8
(EngineCore_DP0 pid=188802) [2026-01-25 16:34:24] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 25165824 bytes
(EngineCore_DP0 pid=188802) [2026-01-25 16:34:24] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 8192] -> 1D uint8
(EngineCore_DP0 pid=188802) [2026-01-25 16:34:24] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12582912 bytes
(EngineCore_DP0 pid=188802) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  2.86it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  2.86it/s]
(EngineCore_DP0 pid=188802) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  9.74it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  9.72it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 4116.98it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:51,  2.46it/s, est. speed input: 39.36 toks/s, output: 2.46 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:18,  6.93it/s, est. speed input: 93.84 toks/s, output: 5.86 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:11, 10.33it/s, est. speed input: 129.97 toks/s, output: 8.12 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:00<00:08, 14.16it/s, est. speed input: 169.34 toks/s, output: 10.58 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:00<00:07, 16.55it/s, est. speed input: 196.35 toks/s, output: 12.27 toks/s]
Processed prompts:  11%|█         | 14/128 [00:01<00:06, 18.34it/s, est. speed input: 217.26 toks/s, output: 13.58 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:01<00:05, 19.23it/s, est. speed input: 231.87 toks/s, output: 14.49 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:01<00:05, 20.26it/s, est. speed input: 245.14 toks/s, output: 15.32 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:01<00:05, 19.93it/s, est. speed input: 251.88 toks/s, output: 15.74 toks/s]
Processed prompts:  20%|██        | 26/128 [00:01<00:05, 20.26it/s, est. speed input: 259.38 toks/s, output: 16.21 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:01<00:04, 20.61it/s, est. speed input: 266.08 toks/s, output: 16.63 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:01<00:04, 20.98it/s, est. speed input: 272.19 toks/s, output: 17.01 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:02<00:04, 21.12it/s, est. speed input: 277.10 toks/s, output: 17.32 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:02<00:04, 20.90it/s, est. speed input: 280.47 toks/s, output: 17.53 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:02<00:04, 21.00it/s, est. speed input: 284.09 toks/s, output: 17.76 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:02<00:03, 21.11it/s, est. speed input: 287.39 toks/s, output: 17.96 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:02<00:03, 21.07it/s, est. speed input: 290.06 toks/s, output: 18.13 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:02<00:03, 21.32it/s, est. speed input: 293.09 toks/s, output: 18.32 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:02<00:03, 21.27it/s, est. speed input: 295.35 toks/s, output: 18.46 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:03<00:03, 21.60it/s, est. speed input: 298.15 toks/s, output: 18.63 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:03<00:03, 21.53it/s, est. speed input: 300.11 toks/s, output: 18.76 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:03<00:03, 21.13it/s, est. speed input: 301.18 toks/s, output: 18.82 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:03<00:03, 20.42it/s, est. speed input: 301.27 toks/s, output: 18.83 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:03<00:02, 20.08it/s, est. speed input: 301.60 toks/s, output: 18.85 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:03<00:02, 20.60it/s, est. speed input: 303.41 toks/s, output: 18.96 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:03<00:02, 21.00it/s, est. speed input: 305.12 toks/s, output: 19.07 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:04<00:02, 21.33it/s, est. speed input: 306.78 toks/s, output: 19.17 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:04<00:02, 21.46it/s, est. speed input: 308.14 toks/s, output: 19.26 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:04<00:02, 21.36it/s, est. speed input: 309.14 toks/s, output: 19.32 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:04<00:01, 21.06it/s, est. speed input: 309.71 toks/s, output: 19.36 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:04<00:01, 20.92it/s, est. speed input: 310.34 toks/s, output: 19.40 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:04<00:01, 21.24it/s, est. speed input: 311.55 toks/s, output: 19.47 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:04<00:01, 21.46it/s, est. speed input: 312.69 toks/s, output: 19.54 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:05<00:01, 21.08it/s, est. speed input: 313.01 toks/s, output: 19.56 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:05<00:01, 21.35it/s, est. speed input: 314.04 toks/s, output: 19.63 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:05<00:01, 21.57it/s, est. speed input: 315.07 toks/s, output: 19.69 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:05<00:00, 21.58it/s, est. speed input: 315.84 toks/s, output: 19.74 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:05<00:00, 21.56it/s, est. speed input: 316.56 toks/s, output: 19.79 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:05<00:00, 20.88it/s, est. speed input: 316.41 toks/s, output: 19.78 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:05<00:00, 20.83it/s, est. speed input: 316.79 toks/s, output: 19.80 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:06<00:00, 20.91it/s, est. speed input: 317.28 toks/s, output: 19.83 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:06<00:00, 20.95it/s, est. speed input: 317.73 toks/s, output: 19.86 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:06<00:00, 21.28it/s, est. speed input: 318.50 toks/s, output: 19.91 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:06<00:00, 21.52it/s, est. speed input: 319.25 toks/s, output: 19.95 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:06<00:00, 21.52it/s, est. speed input: 319.25 toks/s, output: 19.95 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:06<00:00, 19.95it/s, est. speed input: 319.25 toks/s, output: 19.95 toks/s]
[rank0]:[W125 16:34:48.403095510 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=128 ==========
Time: 2026-01-25 16:34:50
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_4
Params: prompt_len=128, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_4 --dataset-name random --input-len 128 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 129 --max-num-batched-tokens 129 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/Llama3.2-1B-INT8_M128.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 16:34:58 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=190902) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=190902) WARNING 01-25 16:35:12 [backends.py:609] Failed to read file <frozen os>
Throughput: 19.42 requests/s, 2504.57 total tokens/s, 19.42 output tokens/s
Total num prompt tokens:  16384
Total num output tokens:  128

STDERR:
[2026-01-25 16:34:58] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 16:34:58] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 16:34:58] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 16:34:58] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:34:58] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:34:58] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:34:58] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:34:58] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:34:58] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 16:34:58] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 16:34:58] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 16:34:58] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 16:34:58] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 16:34:58] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 16:35:05] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 16:35:05] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 16:35:05] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 16:35:05] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:35:05] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:35:05] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:35:05] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:35:05] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:35:05] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 16:35:05] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 16:35:05] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 16:35:05] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 16:35:05] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 16:35:05] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=190902) [2026-01-25 16:35:06] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=190902) [2026-01-25 16:35:06] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=190902) [2026-01-25 16:35:06] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=190902) [2026-01-25 16:35:06] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=190902) [2026-01-25 16:35:06] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-1B-INT8
(EngineCore_DP0 pid=190902) [2026-01-25 16:35:06] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=190902) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=190902) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  5.38it/s]
(EngineCore_DP0 pid=190902) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  5.38it/s]
(EngineCore_DP0 pid=190902) 
(EngineCore_DP0 pid=190902) [2026-01-25 16:35:07] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 2048] -> 1D uint8
(EngineCore_DP0 pid=190902) [2026-01-25 16:35:07] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4718592 bytes
(EngineCore_DP0 pid=190902) [2026-01-25 16:35:07] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 2048] -> 1D uint8
(EngineCore_DP0 pid=190902) [2026-01-25 16:35:07] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 3145728 bytes
(EngineCore_DP0 pid=190902) [2026-01-25 16:35:07] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 2048] -> 1D uint8
(EngineCore_DP0 pid=190902) [2026-01-25 16:35:07] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 25165824 bytes
(EngineCore_DP0 pid=190902) [2026-01-25 16:35:07] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 8192] -> 1D uint8
(EngineCore_DP0 pid=190902) [2026-01-25 16:35:07] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12582912 bytes
(EngineCore_DP0 pid=190902) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00, 10.96it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00, 10.95it/s]
(EngineCore_DP0 pid=190902) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00, 10.97it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 1709.50it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:48,  2.60it/s, est. speed input: 332.36 toks/s, output: 2.60 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:17,  7.30it/s, est. speed input: 791.15 toks/s, output: 6.18 toks/s]
Processed prompts:   5%|▍         | 6/128 [00:00<00:10, 12.09it/s, est. speed input: 1217.25 toks/s, output: 9.51 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:00<00:07, 15.16it/s, est. speed input: 1493.46 toks/s, output: 11.67 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:00<00:06, 17.05it/s, est. speed input: 1679.53 toks/s, output: 13.12 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:01<00:06, 18.51it/s, est. speed input: 1824.62 toks/s, output: 14.25 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:01<00:05, 19.62it/s, est. speed input: 1939.93 toks/s, output: 15.16 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:01<00:05, 19.89it/s, est. speed input: 2014.77 toks/s, output: 15.74 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:01<00:05, 20.02it/s, est. speed input: 2072.96 toks/s, output: 16.19 toks/s]
Processed prompts:  21%|██        | 27/128 [00:01<00:05, 19.74it/s, est. speed input: 2108.99 toks/s, output: 16.48 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:01<00:04, 19.93it/s, est. speed input: 2150.22 toks/s, output: 16.80 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:01<00:04, 20.51it/s, est. speed input: 2197.04 toks/s, output: 17.16 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:02<00:04, 21.01it/s, est. speed input: 2239.62 toks/s, output: 17.50 toks/s]
Processed prompts:  30%|███       | 39/128 [00:02<00:04, 20.89it/s, est. speed input: 2266.04 toks/s, output: 17.70 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:02<00:04, 20.28it/s, est. speed input: 2277.22 toks/s, output: 17.79 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:02<00:04, 20.06it/s, est. speed input: 2291.05 toks/s, output: 17.90 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:02<00:04, 19.91it/s, est. speed input: 2303.28 toks/s, output: 17.99 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:02<00:03, 20.10it/s, est. speed input: 2320.25 toks/s, output: 18.13 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:02<00:03, 20.60it/s, est. speed input: 2342.65 toks/s, output: 18.30 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:03<00:03, 20.86it/s, est. speed input: 2361.07 toks/s, output: 18.45 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:03<00:03, 21.25it/s, est. speed input: 2381.33 toks/s, output: 18.60 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:03<00:03, 21.10it/s, est. speed input: 2393.05 toks/s, output: 18.70 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:03<00:02, 20.87it/s, est. speed input: 2402.04 toks/s, output: 18.77 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:03<00:02, 21.06it/s, est. speed input: 2415.38 toks/s, output: 18.87 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:03<00:02, 21.10it/s, est. speed input: 2426.53 toks/s, output: 18.96 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:03<00:02, 21.38it/s, est. speed input: 2440.26 toks/s, output: 19.06 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:04<00:02, 21.56it/s, est. speed input: 2452.77 toks/s, output: 19.16 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:04<00:02, 21.75it/s, est. speed input: 2465.33 toks/s, output: 19.26 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:04<00:02, 21.60it/s, est. speed input: 2473.58 toks/s, output: 19.32 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:04<00:01, 20.89it/s, est. speed input: 2473.92 toks/s, output: 19.33 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:04<00:01, 20.58it/s, est. speed input: 2476.24 toks/s, output: 19.35 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:04<00:01, 20.50it/s, est. speed input: 2480.10 toks/s, output: 19.38 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:04<00:01, 19.95it/s, est. speed input: 2477.57 toks/s, output: 19.36 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:05<00:01, 20.34it/s, est. speed input: 2484.53 toks/s, output: 19.41 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:05<00:01, 20.66it/s, est. speed input: 2491.49 toks/s, output: 19.46 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:05<00:01, 20.66it/s, est. speed input: 2495.56 toks/s, output: 19.50 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:05<00:00, 20.36it/s, est. speed input: 2496.27 toks/s, output: 19.50 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:05<00:00, 20.69it/s, est. speed input: 2502.55 toks/s, output: 19.55 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:05<00:00, 20.73it/s, est. speed input: 2506.55 toks/s, output: 19.58 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:05<00:00, 20.54it/s, est. speed input: 2508.29 toks/s, output: 19.60 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:06<00:00, 20.42it/s, est. speed input: 2510.02 toks/s, output: 19.61 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:06<00:00, 20.77it/s, est. speed input: 2515.73 toks/s, output: 19.65 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:06<00:00, 20.48it/s, est. speed input: 2516.25 toks/s, output: 19.66 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:06<00:00, 20.48it/s, est. speed input: 2514.20 toks/s, output: 19.64 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:06<00:00, 19.64it/s, est. speed input: 2514.20 toks/s, output: 19.64 toks/s]
[rank0]:[W125 16:35:30.720328183 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=256 ==========
Time: 2026-01-25 16:35:32
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_4
Params: prompt_len=256, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_4 --dataset-name random --input-len 256 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 257 --max-num-batched-tokens 257 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/Llama3.2-1B-INT8_M256.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 16:35:39 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=191749) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=191749) WARNING 01-25 16:35:53 [backends.py:609] Failed to read file <frozen os>
Throughput: 19.75 requests/s, 5075.27 total tokens/s, 19.75 output tokens/s
Total num prompt tokens:  32768
Total num output tokens:  128

STDERR:
[2026-01-25 16:35:39] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 16:35:39] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 16:35:39] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 16:35:39] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:35:39] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:35:39] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:35:39] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:35:39] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:35:39] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 16:35:39] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 16:35:39] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 16:35:39] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 16:35:39] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 16:35:39] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 16:35:47] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 16:35:47] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 16:35:47] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 16:35:47] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:35:47] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:35:47] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:35:47] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:35:47] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:35:47] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 16:35:47] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 16:35:47] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 16:35:47] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 16:35:47] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 16:35:47] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=191749) [2026-01-25 16:35:48] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=191749) [2026-01-25 16:35:48] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=191749) [2026-01-25 16:35:48] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=191749) [2026-01-25 16:35:48] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=191749) [2026-01-25 16:35:48] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-1B-INT8
(EngineCore_DP0 pid=191749) [2026-01-25 16:35:48] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=191749) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=191749) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  5.30it/s]
(EngineCore_DP0 pid=191749) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  5.29it/s]
(EngineCore_DP0 pid=191749) 
(EngineCore_DP0 pid=191749) [2026-01-25 16:35:48] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 2048] -> 1D uint8
(EngineCore_DP0 pid=191749) [2026-01-25 16:35:48] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4718592 bytes
(EngineCore_DP0 pid=191749) [2026-01-25 16:35:48] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 2048] -> 1D uint8
(EngineCore_DP0 pid=191749) [2026-01-25 16:35:48] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 3145728 bytes
(EngineCore_DP0 pid=191749) [2026-01-25 16:35:48] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 2048] -> 1D uint8
(EngineCore_DP0 pid=191749) [2026-01-25 16:35:48] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 25165824 bytes
(EngineCore_DP0 pid=191749) [2026-01-25 16:35:48] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 8192] -> 1D uint8
(EngineCore_DP0 pid=191749) [2026-01-25 16:35:48] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12582912 bytes
(EngineCore_DP0 pid=191749) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00, 11.16it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00, 11.15it/s]
(EngineCore_DP0 pid=191749) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00, 10.57it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  87%|████████▋ | 111/128 [00:00<00:00, 1109.49it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 1115.51it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:35,  3.61it/s, est. speed input: 923.96 toks/s, output: 3.61 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:11, 11.12it/s, est. speed input: 2461.86 toks/s, output: 9.62 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:08, 14.68it/s, est. speed input: 3179.01 toks/s, output: 12.42 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:00<00:07, 16.70it/s, est. speed input: 3600.37 toks/s, output: 14.06 toks/s]
Processed prompts:  10%|█         | 13/128 [00:00<00:06, 18.16it/s, est. speed input: 3901.18 toks/s, output: 15.24 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:00<00:05, 19.33it/s, est. speed input: 4137.33 toks/s, output: 16.16 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:01<00:05, 20.21it/s, est. speed input: 4323.45 toks/s, output: 16.89 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:01<00:05, 20.19it/s, est. speed input: 4421.20 toks/s, output: 17.27 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:01<00:05, 20.46it/s, est. speed input: 4519.19 toks/s, output: 17.65 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:01<00:04, 21.08it/s, est. speed input: 4627.43 toks/s, output: 18.08 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:01<00:04, 21.22it/s, est. speed input: 4700.59 toks/s, output: 18.36 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:01<00:04, 21.46it/s, est. speed input: 4770.88 toks/s, output: 18.64 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:01<00:04, 21.40it/s, est. speed input: 4818.84 toks/s, output: 18.82 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:02<00:04, 21.10it/s, est. speed input: 4847.70 toks/s, output: 18.94 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:02<00:04, 20.52it/s, est. speed input: 4854.09 toks/s, output: 18.96 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:02<00:04, 20.46it/s, est. speed input: 4875.30 toks/s, output: 19.04 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:02<00:03, 20.74it/s, est. speed input: 4908.71 toks/s, output: 19.17 toks/s]
Processed prompts:  41%|████      | 52/128 [00:02<00:03, 20.63it/s, est. speed input: 4925.40 toks/s, output: 19.24 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:02<00:03, 20.67it/s, est. speed input: 4945.22 toks/s, output: 19.32 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:02<00:03, 20.78it/s, est. speed input: 4966.34 toks/s, output: 19.40 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:03<00:03, 20.94it/s, est. speed input: 4988.58 toks/s, output: 19.49 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:03<00:03, 20.85it/s, est. speed input: 5001.54 toks/s, output: 19.54 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:03<00:02, 20.72it/s, est. speed input: 5011.47 toks/s, output: 19.58 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:03<00:02, 21.16it/s, est. speed input: 5037.39 toks/s, output: 19.68 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:03<00:02, 21.12it/s, est. speed input: 5050.85 toks/s, output: 19.73 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:03<00:02, 20.92it/s, est. speed input: 5058.05 toks/s, output: 19.76 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:03<00:02, 21.09it/s, est. speed input: 5073.64 toks/s, output: 19.82 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:04<00:02, 21.36it/s, est. speed input: 5092.33 toks/s, output: 19.89 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:04<00:02, 20.99it/s, est. speed input: 5094.69 toks/s, output: 19.90 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:04<00:01, 20.47it/s, est. speed input: 5089.71 toks/s, output: 19.88 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:04<00:01, 20.50it/s, est. speed input: 5095.43 toks/s, output: 19.90 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:04<00:01, 20.40it/s, est. speed input: 5097.54 toks/s, output: 19.91 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:04<00:01, 20.70it/s, est. speed input: 5108.72 toks/s, output: 19.96 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:05<00:01, 20.83it/s, est. speed input: 5117.25 toks/s, output: 19.99 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:05<00:01, 21.04it/s, est. speed input: 5128.17 toks/s, output: 20.03 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:05<00:01, 21.01it/s, est. speed input: 5134.40 toks/s, output: 20.06 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:05<00:00, 20.37it/s, est. speed input: 5126.77 toks/s, output: 20.03 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:05<00:00, 20.64it/s, est. speed input: 5135.00 toks/s, output: 20.06 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:05<00:00, 20.91it/s, est. speed input: 5144.30 toks/s, output: 20.09 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:05<00:00, 20.60it/s, est. speed input: 5143.10 toks/s, output: 20.09 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:06<00:00, 20.29it/s, est. speed input: 5140.02 toks/s, output: 20.08 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:06<00:00, 20.25it/s, est. speed input: 5140.56 toks/s, output: 20.08 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:06<00:00, 20.40it/s, est. speed input: 5144.50 toks/s, output: 20.10 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:06<00:00, 20.40it/s, est. speed input: 5147.66 toks/s, output: 20.11 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:06<00:00, 20.11it/s, est. speed input: 5147.66 toks/s, output: 20.11 toks/s]
[rank0]:[W125 16:36:12.680160931 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=512 ==========
Time: 2026-01-25 16:58:53
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_4
Params: prompt_len=512, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_4 --dataset-name random --input-len 512 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 513 --max-num-batched-tokens 513 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/Llama3.2-1B-INT8_M512.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 16:59:01 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=217284) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=217284) WARNING 01-25 16:59:15 [backends.py:609] Failed to read file <frozen os>
Throughput: 20.56 requests/s, 10545.16 total tokens/s, 20.56 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128

STDERR:
[2026-01-25 16:59:01] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 16:59:01] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 16:59:01] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 16:59:01] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:59:01] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:59:01] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:59:01] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:59:01] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:59:01] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 16:59:01] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 16:59:01] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 16:59:01] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 16:59:01] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 16:59:01] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 16:59:08] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 16:59:08] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 16:59:08] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 16:59:08] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:59:08] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:59:08] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:59:08] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:59:08] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:59:08] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 16:59:08] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 16:59:08] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 16:59:08] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 16:59:08] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 16:59:08] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=217284) [2026-01-25 16:59:09] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=217284) [2026-01-25 16:59:09] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=217284) [2026-01-25 16:59:09] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=217284) [2026-01-25 16:59:09] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=217284) [2026-01-25 16:59:09] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-1B-INT8
(EngineCore_DP0 pid=217284) [2026-01-25 16:59:09] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=217284) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=217284) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  5.15it/s]
(EngineCore_DP0 pid=217284) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  5.15it/s]
(EngineCore_DP0 pid=217284) 
(EngineCore_DP0 pid=217284) [2026-01-25 16:59:10] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 2048] -> 1D uint8
(EngineCore_DP0 pid=217284) [2026-01-25 16:59:10] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4718592 bytes
(EngineCore_DP0 pid=217284) [2026-01-25 16:59:10] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 2048] -> 1D uint8
(EngineCore_DP0 pid=217284) [2026-01-25 16:59:10] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 3145728 bytes
(EngineCore_DP0 pid=217284) [2026-01-25 16:59:10] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 2048] -> 1D uint8
(EngineCore_DP0 pid=217284) [2026-01-25 16:59:10] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 25165824 bytes
(EngineCore_DP0 pid=217284) [2026-01-25 16:59:10] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 8192] -> 1D uint8
(EngineCore_DP0 pid=217284) [2026-01-25 16:59:10] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12582912 bytes
(EngineCore_DP0 pid=217284) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00, 11.68it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00, 11.67it/s]
(EngineCore_DP0 pid=217284) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00, 11.05it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  53%|█████▎    | 68/128 [00:00<00:00, 674.94it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 668.34it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:04, 27.55it/s, est. speed input: 14109.36 toks/s, output: 27.56 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:05, 23.29it/s, est. speed input: 12250.43 toks/s, output: 23.93 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:00<00:05, 22.40it/s, est. speed input: 11814.42 toks/s, output: 23.07 toks/s]
Processed prompts:  10%|█         | 13/128 [00:00<00:05, 22.30it/s, est. speed input: 11698.36 toks/s, output: 22.85 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:00<00:05, 22.17it/s, est. speed input: 11608.58 toks/s, output: 22.67 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:00<00:04, 22.16it/s, est. speed input: 11565.12 toks/s, output: 22.59 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:00<00:04, 21.98it/s, est. speed input: 11494.92 toks/s, output: 22.45 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:01<00:04, 21.35it/s, est. speed input: 11334.31 toks/s, output: 22.14 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:01<00:04, 20.87it/s, est. speed input: 11197.84 toks/s, output: 21.87 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:01<00:04, 21.10it/s, est. speed input: 11187.32 toks/s, output: 21.85 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:01<00:04, 21.24it/s, est. speed input: 11173.98 toks/s, output: 21.82 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:01<00:04, 21.19it/s, est. speed input: 11141.46 toks/s, output: 21.76 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:01<00:04, 21.53it/s, est. speed input: 11164.50 toks/s, output: 21.81 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:01<00:03, 21.63it/s, est. speed input: 11165.79 toks/s, output: 21.81 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:02<00:03, 20.84it/s, est. speed input: 11068.77 toks/s, output: 21.62 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:02<00:03, 20.65it/s, est. speed input: 11021.96 toks/s, output: 21.53 toks/s]
Processed prompts:  41%|████      | 52/128 [00:02<00:03, 20.61it/s, est. speed input: 10990.69 toks/s, output: 21.47 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:02<00:03, 20.28it/s, est. speed input: 10932.65 toks/s, output: 21.35 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:02<00:03, 20.22it/s, est. speed input: 10896.75 toks/s, output: 21.28 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:02<00:03, 20.50it/s, est. speed input: 10893.88 toks/s, output: 21.28 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:03<00:03, 20.83it/s, est. speed input: 10903.05 toks/s, output: 21.29 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:03<00:02, 20.52it/s, est. speed input: 10866.70 toks/s, output: 21.22 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:03<00:02, 20.50it/s, est. speed input: 10849.63 toks/s, output: 21.19 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:03<00:02, 20.72it/s, est. speed input: 10851.08 toks/s, output: 21.19 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:03<00:02, 21.09it/s, est. speed input: 10866.95 toks/s, output: 21.22 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:03<00:02, 21.38it/s, est. speed input: 10882.80 toks/s, output: 21.26 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:03<00:02, 20.96it/s, est. speed input: 10859.08 toks/s, output: 21.21 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:04<00:02, 21.21it/s, est. speed input: 10869.44 toks/s, output: 21.23 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:04<00:01, 20.63it/s, est. speed input: 10834.81 toks/s, output: 21.16 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:04<00:01, 20.60it/s, est. speed input: 10823.89 toks/s, output: 21.14 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:04<00:01, 20.94it/s, est. speed input: 10834.12 toks/s, output: 21.16 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:04<00:01, 21.06it/s, est. speed input: 10836.92 toks/s, output: 21.17 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:04<00:01, 21.25it/s, est. speed input: 10845.18 toks/s, output: 21.18 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:04<00:01, 21.59it/s, est. speed input: 10862.68 toks/s, output: 21.22 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:04<00:01, 21.70it/s, est. speed input: 10873.27 toks/s, output: 21.24 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:05<00:00, 21.42it/s, est. speed input: 10866.84 toks/s, output: 21.22 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:05<00:00, 21.29it/s, est. speed input: 10863.49 toks/s, output: 21.22 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:05<00:00, 21.41it/s, est. speed input: 10869.69 toks/s, output: 21.23 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:05<00:00, 21.40it/s, est. speed input: 10871.80 toks/s, output: 21.23 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:05<00:00, 21.47it/s, est. speed input: 10876.61 toks/s, output: 21.24 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:05<00:00, 20.83it/s, est. speed input: 10852.67 toks/s, output: 21.20 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:05<00:00, 21.09it/s, est. speed input: 10859.17 toks/s, output: 21.21 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:06<00:00, 21.09it/s, est. speed input: 10860.89 toks/s, output: 21.21 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:06<00:00, 21.21it/s, est. speed input: 10860.89 toks/s, output: 21.21 toks/s]
[rank0]:[W125 16:59:33.505586117 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=1024 ==========
Time: 2026-01-25 16:59:34
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 1025 --max-num-batched-tokens 1025 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/Llama3.2-1B-INT8_M1024.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 16:59:42 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=218095) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=218095) WARNING 01-25 16:59:56 [backends.py:609] Failed to read file <frozen os>
Throughput: 20.40 requests/s, 20910.75 total tokens/s, 20.40 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128

STDERR:
[2026-01-25 16:59:42] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 16:59:42] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 16:59:42] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 16:59:42] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:59:42] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:59:42] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:59:42] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:59:42] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:59:42] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 16:59:42] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 16:59:42] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 16:59:42] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 16:59:42] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 16:59:42] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 16:59:50] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 16:59:50] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 16:59:50] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 16:59:50] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:59:50] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:59:50] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:59:50] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:59:50] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 16:59:50] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 16:59:50] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 16:59:50] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 16:59:50] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 16:59:50] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 16:59:50] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=218095) [2026-01-25 16:59:51] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=218095) [2026-01-25 16:59:51] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=218095) [2026-01-25 16:59:51] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=218095) [2026-01-25 16:59:51] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=218095) [2026-01-25 16:59:51] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-1B-INT8
(EngineCore_DP0 pid=218095) [2026-01-25 16:59:51] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=218095) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=218095) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  5.38it/s]
(EngineCore_DP0 pid=218095) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  5.38it/s]
(EngineCore_DP0 pid=218095) 
(EngineCore_DP0 pid=218095) [2026-01-25 16:59:51] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 2048] -> 1D uint8
(EngineCore_DP0 pid=218095) [2026-01-25 16:59:51] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4718592 bytes
(EngineCore_DP0 pid=218095) [2026-01-25 16:59:51] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 2048] -> 1D uint8
(EngineCore_DP0 pid=218095) [2026-01-25 16:59:51] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 3145728 bytes
(EngineCore_DP0 pid=218095) [2026-01-25 16:59:51] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 2048] -> 1D uint8
(EngineCore_DP0 pid=218095) [2026-01-25 16:59:51] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 25165824 bytes
(EngineCore_DP0 pid=218095) [2026-01-25 16:59:51] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 8192] -> 1D uint8
(EngineCore_DP0 pid=218095) [2026-01-25 16:59:51] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12582912 bytes
(EngineCore_DP0 pid=218095) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00, 12.23it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00, 12.22it/s]
(EngineCore_DP0 pid=218095) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00, 10.78it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  30%|███       | 39/128 [00:00<00:00, 382.93it/s]
Adding requests:  61%|██████    | 78/128 [00:00<00:00, 381.55it/s]
Adding requests:  91%|█████████▏| 117/128 [00:00<00:00, 370.62it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 372.59it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:04, 30.40it/s, est. speed input: 31137.28 toks/s, output: 30.40 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:00<00:05, 22.75it/s, est. speed input: 24213.90 toks/s, output: 23.65 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:00<00:05, 21.26it/s, est. speed input: 22793.07 toks/s, output: 22.26 toks/s]
Processed prompts:  11%|█         | 14/128 [00:00<00:05, 21.32it/s, est. speed input: 22608.26 toks/s, output: 22.08 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:00<00:05, 21.02it/s, est. speed input: 22297.04 toks/s, output: 21.77 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:00<00:05, 20.66it/s, est. speed input: 21994.98 toks/s, output: 21.48 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:01<00:05, 20.40it/s, est. speed input: 21764.51 toks/s, output: 21.25 toks/s]
Processed prompts:  20%|██        | 26/128 [00:01<00:04, 20.91it/s, est. speed input: 21863.02 toks/s, output: 21.35 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:01<00:04, 21.13it/s, est. speed input: 21893.62 toks/s, output: 21.38 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:01<00:04, 21.33it/s, est. speed input: 21932.59 toks/s, output: 21.42 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:01<00:04, 21.58it/s, est. speed input: 21997.40 toks/s, output: 21.48 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:01<00:04, 21.74it/s, est. speed input: 22047.19 toks/s, output: 21.53 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:01<00:04, 21.38it/s, est. speed input: 21975.14 toks/s, output: 21.46 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:02<00:03, 21.41it/s, est. speed input: 21975.48 toks/s, output: 21.46 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:02<00:03, 21.62it/s, est. speed input: 22018.46 toks/s, output: 21.50 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:02<00:03, 21.72it/s, est. speed input: 22044.60 toks/s, output: 21.53 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:02<00:03, 21.79it/s, est. speed input: 22070.25 toks/s, output: 21.55 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:02<00:03, 21.96it/s, est. speed input: 22113.56 toks/s, output: 21.60 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:02<00:03, 22.00it/s, est. speed input: 22138.28 toks/s, output: 21.62 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:02<00:03, 21.50it/s, est. speed input: 22075.73 toks/s, output: 21.56 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:03<00:02, 21.08it/s, est. speed input: 22005.54 toks/s, output: 21.49 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:03<00:02, 21.31it/s, est. speed input: 22022.35 toks/s, output: 21.51 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:03<00:02, 21.54it/s, est. speed input: 22046.86 toks/s, output: 21.53 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:03<00:02, 21.72it/s, est. speed input: 22072.08 toks/s, output: 21.55 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:03<00:02, 21.69it/s, est. speed input: 22074.60 toks/s, output: 21.56 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:03<00:02, 20.87it/s, est. speed input: 21972.93 toks/s, output: 21.46 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:03<00:02, 21.13it/s, est. speed input: 21983.21 toks/s, output: 21.47 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:04<00:01, 21.32it/s, est. speed input: 21994.11 toks/s, output: 21.48 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:04<00:01, 21.56it/s, est. speed input: 22016.58 toks/s, output: 21.50 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:04<00:01, 21.79it/s, est. speed input: 22043.38 toks/s, output: 21.53 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:04<00:01, 21.89it/s, est. speed input: 22062.29 toks/s, output: 21.55 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:04<00:01, 22.06it/s, est. speed input: 22090.22 toks/s, output: 21.57 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:04<00:01, 22.24it/s, est. speed input: 22121.85 toks/s, output: 21.60 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:04<00:01, 22.23it/s, est. speed input: 22139.51 toks/s, output: 21.62 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:04<00:00, 21.42it/s, est. speed input: 22080.14 toks/s, output: 21.56 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:05<00:00, 21.18it/s, est. speed input: 22053.82 toks/s, output: 21.54 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:05<00:00, 21.32it/s, est. speed input: 22056.96 toks/s, output: 21.54 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:05<00:00, 21.17it/s, est. speed input: 22037.20 toks/s, output: 21.52 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:05<00:00, 21.36it/s, est. speed input: 22045.13 toks/s, output: 21.53 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:05<00:00, 21.62it/s, est. speed input: 22062.48 toks/s, output: 21.55 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:05<00:00, 21.95it/s, est. speed input: 22090.49 toks/s, output: 21.57 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:05<00:00, 22.02it/s, est. speed input: 22104.99 toks/s, output: 21.59 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:05<00:00, 22.02it/s, est. speed input: 22104.99 toks/s, output: 21.59 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:05<00:00, 21.59it/s, est. speed input: 22104.99 toks/s, output: 21.59 toks/s]
[rank0]:[W125 17:00:14.674289573 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=2048 ==========
Time: 2026-01-25 17:00:16
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=256, max_num_seqs=2
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 256 --max-num-seqs 2 --max-model-len 1025 --max-num-batched-tokens 2048 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/Llama3.2-1B-INT8_M2048.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 17:00:24 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=218947) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=218947) WARNING 01-25 17:00:38 [backends.py:609] Failed to read file <frozen os>
Throughput: 40.20 requests/s, 41208.23 total tokens/s, 40.20 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256

STDERR:
[2026-01-25 17:00:24] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:00:24] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 17:00:24] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 17:00:24] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:00:24] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:00:24] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:00:24] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:00:24] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:00:24] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 17:00:24] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:00:24] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:00:24] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:00:24] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:00:24] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 17:00:32] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:00:32] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 17:00:32] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 17:00:32] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:00:32] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:00:32] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:00:32] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:00:32] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:00:32] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 17:00:32] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:00:32] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:00:32] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:00:32] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:00:32] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=218947) [2026-01-25 17:00:33] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=218947) [2026-01-25 17:00:33] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=218947) [2026-01-25 17:00:33] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=218947) [2026-01-25 17:00:33] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=218947) [2026-01-25 17:00:33] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-1B-INT8
(EngineCore_DP0 pid=218947) [2026-01-25 17:00:33] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=218947) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=218947) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  5.34it/s]
(EngineCore_DP0 pid=218947) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  5.33it/s]
(EngineCore_DP0 pid=218947) 
(EngineCore_DP0 pid=218947) [2026-01-25 17:00:33] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 2048] -> 1D uint8
(EngineCore_DP0 pid=218947) [2026-01-25 17:00:33] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4718592 bytes
(EngineCore_DP0 pid=218947) [2026-01-25 17:00:33] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 2048] -> 1D uint8
(EngineCore_DP0 pid=218947) [2026-01-25 17:00:33] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 3145728 bytes
(EngineCore_DP0 pid=218947) [2026-01-25 17:00:33] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 2048] -> 1D uint8
(EngineCore_DP0 pid=218947) [2026-01-25 17:00:33] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 25165824 bytes
(EngineCore_DP0 pid=218947) [2026-01-25 17:00:33] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 8192] -> 1D uint8
(EngineCore_DP0 pid=218947) [2026-01-25 17:00:33] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12582912 bytes
(EngineCore_DP0 pid=218947) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  67%|██████▋   | 2/3 [00:00<00:00, 11.92it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00, 11.26it/s]
(EngineCore_DP0 pid=218947) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 1/2 [00:00<00:00,  9.94it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00, 10.56it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  13%|█▎        | 34/256 [00:00<00:00, 336.16it/s]
Adding requests:  28%|██▊       | 71/256 [00:00<00:00, 351.92it/s]
Adding requests:  42%|████▏     | 107/256 [00:00<00:00, 352.85it/s]
Adding requests:  56%|█████▌    | 143/256 [00:00<00:00, 353.94it/s]
Adding requests:  70%|██████▉   | 179/256 [00:00<00:00, 350.79it/s]
Adding requests:  84%|████████▍ | 215/256 [00:00<00:00, 352.54it/s]
Adding requests:  99%|█████████▉| 253/256 [00:00<00:00, 359.45it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 354.49it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  10%|█         | 26/256 [00:00<00:01, 189.81it/s, est. speed input: 194390.45 toks/s, output: 189.82 toks/s]
Processed prompts:  18%|█▊        | 45/256 [00:00<00:02, 71.65it/s, est. speed input: 82241.64 toks/s, output: 80.31 toks/s]   
Processed prompts:  22%|██▏       | 56/256 [00:00<00:03, 58.12it/s, est. speed input: 68746.88 toks/s, output: 67.13 toks/s]
Processed prompts:  25%|██▌       | 64/256 [00:01<00:03, 52.96it/s, est. speed input: 63713.20 toks/s, output: 62.22 toks/s]
Processed prompts:  28%|██▊       | 71/256 [00:01<00:03, 52.10it/s, est. speed input: 62118.94 toks/s, output: 60.66 toks/s]
Processed prompts:  30%|███       | 77/256 [00:01<00:03, 49.05it/s, est. speed input: 59804.01 toks/s, output: 58.40 toks/s]
Processed prompts:  32%|███▏      | 83/256 [00:01<00:03, 47.10it/s, est. speed input: 58129.33 toks/s, output: 56.77 toks/s]
Processed prompts:  34%|███▍      | 88/256 [00:01<00:03, 43.13it/s, est. speed input: 55880.49 toks/s, output: 54.57 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:01<00:03, 43.19it/s, est. speed input: 54972.92 toks/s, output: 53.68 toks/s]
Processed prompts:  39%|███▉      | 100/256 [00:01<00:03, 43.33it/s, est. speed input: 54228.69 toks/s, output: 52.96 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:02<00:03, 42.81it/s, est. speed input: 53399.54 toks/s, output: 52.15 toks/s]
Processed prompts:  43%|████▎     | 111/256 [00:02<00:03, 44.11it/s, est. speed input: 53214.00 toks/s, output: 51.97 toks/s]
Processed prompts:  45%|████▌     | 116/256 [00:02<00:03, 41.01it/s, est. speed input: 52064.84 toks/s, output: 50.84 toks/s]
Processed prompts:  48%|████▊     | 122/256 [00:02<00:03, 40.97it/s, est. speed input: 51448.46 toks/s, output: 50.24 toks/s]
Processed prompts:  50%|█████     | 128/256 [00:02<00:03, 40.67it/s, est. speed input: 50840.65 toks/s, output: 49.65 toks/s]
Processed prompts:  52%|█████▏    | 134/256 [00:02<00:02, 41.06it/s, est. speed input: 50426.33 toks/s, output: 49.24 toks/s]
Processed prompts:  55%|█████▍    | 140/256 [00:02<00:02, 41.94it/s, est. speed input: 50176.69 toks/s, output: 49.00 toks/s]
Processed prompts:  57%|█████▋    | 145/256 [00:02<00:02, 43.67it/s, est. speed input: 50185.44 toks/s, output: 49.01 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:03<00:02, 39.57it/s, est. speed input: 49291.30 toks/s, output: 48.14 toks/s]
Processed prompts:  61%|██████    | 156/256 [00:03<00:02, 40.82it/s, est. speed input: 49102.48 toks/s, output: 47.95 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:03<00:02, 40.79it/s, est. speed input: 48780.62 toks/s, output: 47.64 toks/s]
Processed prompts:  66%|██████▌   | 168/256 [00:03<00:02, 41.34it/s, est. speed input: 48576.12 toks/s, output: 47.44 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:03<00:01, 42.35it/s, est. speed input: 48479.02 toks/s, output: 47.34 toks/s]
Processed prompts:  70%|███████   | 180/256 [00:03<00:01, 42.39it/s, est. speed input: 48294.44 toks/s, output: 47.16 toks/s]
Processed prompts:  72%|███████▏  | 185/256 [00:03<00:01, 44.13it/s, est. speed input: 48362.17 toks/s, output: 47.23 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:04<00:01, 40.98it/s, est. speed input: 47897.86 toks/s, output: 46.78 toks/s]
Processed prompts:  76%|███████▌  | 195/256 [00:04<00:01, 43.03it/s, est. speed input: 47960.87 toks/s, output: 46.84 toks/s]
Processed prompts:  78%|███████▊  | 200/256 [00:04<00:01, 39.98it/s, est. speed input: 47513.22 toks/s, output: 46.40 toks/s]
Processed prompts:  80%|████████  | 205/256 [00:04<00:01, 42.39it/s, est. speed input: 47589.74 toks/s, output: 46.47 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:04<00:01, 39.81it/s, est. speed input: 47209.91 toks/s, output: 46.10 toks/s]
Processed prompts:  84%|████████▍ | 216/256 [00:04<00:01, 39.86it/s, est. speed input: 47009.16 toks/s, output: 45.91 toks/s]
Processed prompts:  86%|████████▋ | 221/256 [00:04<00:00, 42.28it/s, est. speed input: 47093.50 toks/s, output: 45.99 toks/s]
Processed prompts:  88%|████████▊ | 226/256 [00:04<00:00, 39.63it/s, est. speed input: 46743.37 toks/s, output: 45.65 toks/s]
Processed prompts:  91%|█████████ | 232/256 [00:05<00:00, 41.04it/s, est. speed input: 46704.30 toks/s, output: 45.61 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:05<00:00, 41.87it/s, est. speed input: 46653.26 toks/s, output: 45.56 toks/s]
Processed prompts:  95%|█████████▌| 244/256 [00:05<00:00, 42.43it/s, est. speed input: 46604.40 toks/s, output: 45.51 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:05<00:00, 42.71it/s, est. speed input: 46548.39 toks/s, output: 45.46 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:05<00:00, 42.34it/s, est. speed input: 46445.96 toks/s, output: 45.36 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:05<00:00, 42.34it/s, est. speed input: 46445.96 toks/s, output: 45.36 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:05<00:00, 45.36it/s, est. speed input: 46445.96 toks/s, output: 45.36 toks/s]
[rank0]:[W125 17:00:56.359882030 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=4096 ==========
Time: 2026-01-25 17:00:58
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=512, max_num_seqs=4
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 512 --max-num-seqs 4 --max-model-len 1025 --max-num-batched-tokens 4096 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/Llama3.2-1B-INT8_M4096.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 17:01:09 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=219810) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=219810) WARNING 01-25 17:01:24 [backends.py:609] Failed to read file <frozen os>
Throughput: 77.80 requests/s, 79741.64 total tokens/s, 77.80 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512

STDERR:
[2026-01-25 17:01:09] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:01:09] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 17:01:09] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 17:01:09] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:01:09] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:01:09] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:01:09] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:01:09] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:01:09] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 17:01:09] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:01:09] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:01:09] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:01:09] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:01:09] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 17:01:17] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:01:17] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 17:01:17] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 17:01:17] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:01:17] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:01:17] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:01:17] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:01:17] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:01:17] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 17:01:17] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:01:17] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:01:17] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:01:17] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:01:17] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=219810) [2026-01-25 17:01:18] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=219810) [2026-01-25 17:01:18] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=219810) [2026-01-25 17:01:18] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=219810) [2026-01-25 17:01:18] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=219810) [2026-01-25 17:01:18] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-1B-INT8
(EngineCore_DP0 pid=219810) [2026-01-25 17:01:18] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=219810) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=219810) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.99it/s]
(EngineCore_DP0 pid=219810) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.99it/s]
(EngineCore_DP0 pid=219810) 
(EngineCore_DP0 pid=219810) [2026-01-25 17:01:18] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 2048] -> 1D uint8
(EngineCore_DP0 pid=219810) [2026-01-25 17:01:18] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4718592 bytes
(EngineCore_DP0 pid=219810) [2026-01-25 17:01:18] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 2048] -> 1D uint8
(EngineCore_DP0 pid=219810) [2026-01-25 17:01:18] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 3145728 bytes
(EngineCore_DP0 pid=219810) [2026-01-25 17:01:18] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 2048] -> 1D uint8
(EngineCore_DP0 pid=219810) [2026-01-25 17:01:18] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 25165824 bytes
(EngineCore_DP0 pid=219810) [2026-01-25 17:01:18] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 8192] -> 1D uint8
(EngineCore_DP0 pid=219810) [2026-01-25 17:01:18] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12582912 bytes
(EngineCore_DP0 pid=219810) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 2/4 [00:00<00:00, 12.40it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00, 12.27it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00, 12.29it/s]
(EngineCore_DP0 pid=219810) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  67%|██████▋   | 2/3 [00:00<00:00, 12.04it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00, 12.38it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   7%|▋         | 34/512 [00:00<00:01, 337.87it/s]
Adding requests:  14%|█▎        | 70/512 [00:00<00:01, 345.96it/s]
Adding requests:  21%|██        | 105/512 [00:00<00:01, 344.21it/s]
Adding requests:  27%|██▋       | 140/512 [00:00<00:01, 345.10it/s]
Adding requests:  34%|███▍      | 175/512 [00:00<00:00, 341.38it/s]
Adding requests:  41%|████      | 211/512 [00:00<00:00, 344.70it/s]
Adding requests:  48%|████▊     | 248/512 [00:00<00:00, 349.74it/s]
Adding requests:  55%|█████▌    | 283/512 [00:00<00:00, 348.57it/s]
Adding requests:  62%|██████▏   | 318/512 [00:00<00:00, 345.54it/s]
Adding requests:  69%|██████▉   | 355/512 [00:01<00:00, 352.25it/s]
Adding requests:  77%|███████▋  | 392/512 [00:01<00:00, 355.56it/s]
Adding requests:  84%|████████▎ | 428/512 [00:01<00:00, 354.56it/s]
Adding requests:  91%|█████████ | 465/512 [00:01<00:00, 356.81it/s]
Adding requests:  98%|█████████▊| 502/512 [00:01<00:00, 359.47it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 351.61it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  19%|█▉        | 98/512 [00:00<00:00, 735.02it/s, est. speed input: 752756.48 toks/s, output: 735.04 toks/s]
Processed prompts:  34%|███▎      | 172/512 [00:00<00:02, 151.31it/s, est. speed input: 179283.18 toks/s, output: 175.08 toks/s]
Processed prompts:  41%|████      | 208/512 [00:01<00:02, 125.00it/s, est. speed input: 151132.44 toks/s, output: 147.59 toks/s]
Processed prompts:  45%|████▌     | 232/512 [00:01<00:02, 113.42it/s, est. speed input: 139868.91 toks/s, output: 136.59 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:01<00:02, 102.97it/s, est. speed input: 131421.33 toks/s, output: 128.34 toks/s]
Processed prompts:  52%|█████▏    | 264/512 [00:02<00:02, 99.83it/s, est. speed input: 128129.98 toks/s, output: 125.13 toks/s] 
Processed prompts:  54%|█████▍    | 276/512 [00:02<00:02, 95.87it/s, est. speed input: 125077.71 toks/s, output: 122.14 toks/s]
Processed prompts:  56%|█████▌    | 287/512 [00:02<00:02, 91.22it/s, est. speed input: 122107.84 toks/s, output: 119.25 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:02<00:02, 87.31it/s, est. speed input: 119490.44 toks/s, output: 116.69 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:02<00:02, 85.88it/s, est. speed input: 117542.59 toks/s, output: 114.79 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:02<00:02, 86.05it/s, est. speed input: 116129.54 toks/s, output: 113.41 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:02<00:02, 86.48it/s, est. speed input: 114916.59 toks/s, output: 112.22 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:03<00:01, 85.76it/s, est. speed input: 113590.42 toks/s, output: 110.93 toks/s]
Processed prompts:  69%|██████▉   | 355/512 [00:03<00:01, 86.08it/s, est. speed input: 112809.83 toks/s, output: 110.17 toks/s]
Processed prompts:  71%|███████   | 364/512 [00:03<00:01, 85.79it/s, est. speed input: 111986.00 toks/s, output: 109.36 toks/s]
Processed prompts:  73%|███████▎  | 373/512 [00:03<00:01, 86.16it/s, est. speed input: 111305.57 toks/s, output: 108.70 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [00:03<00:01, 78.64it/s, est. speed input: 109483.06 toks/s, output: 106.92 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [00:03<00:01, 79.85it/s, est. speed input: 108494.73 toks/s, output: 105.95 toks/s]
Processed prompts:  79%|███████▊  | 403/512 [00:03<00:01, 81.89it/s, est. speed input: 108003.73 toks/s, output: 105.47 toks/s]
Processed prompts:  80%|████████  | 412/512 [00:03<00:01, 82.85it/s, est. speed input: 107454.96 toks/s, output: 104.94 toks/s]
Processed prompts:  82%|████████▏ | 421/512 [00:04<00:01, 83.91it/s, est. speed input: 106974.69 toks/s, output: 104.47 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [00:04<00:01, 76.68it/s, est. speed input: 105532.78 toks/s, output: 103.06 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [00:04<00:00, 80.46it/s, est. speed input: 105059.88 toks/s, output: 102.60 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [00:04<00:00, 81.10it/s, est. speed input: 104383.43 toks/s, output: 101.94 toks/s]
Processed prompts:  91%|█████████ | 466/512 [00:04<00:00, 82.48it/s, est. speed input: 103870.10 toks/s, output: 101.44 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [00:04<00:00, 82.79it/s, est. speed input: 103311.43 toks/s, output: 100.89 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [00:04<00:00, 83.20it/s, est. speed input: 102809.95 toks/s, output: 100.40 toks/s]
Processed prompts:  97%|█████████▋| 499/512 [00:04<00:00, 84.63it/s, est. speed input: 102578.01 toks/s, output: 100.17 toks/s]
Processed prompts: 100%|█████████▉| 510/512 [00:05<00:00, 82.27it/s, est. speed input: 101929.24 toks/s, output: 99.54 toks/s] 
Processed prompts: 100%|██████████| 512/512 [00:05<00:00, 82.27it/s, est. speed input: 102324.81 toks/s, output: 99.93 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:05<00:00, 99.92it/s, est. speed input: 102324.81 toks/s, output: 99.93 toks/s]
[rank0]:[W125 17:01:42.420714309 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=8192 ==========
Time: 2026-01-25 17:01:44
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=1024, max_num_seqs=8
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 1024 --max-num-seqs 8 --max-model-len 1025 --max-num-batched-tokens 8192 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/Llama3.2-1B-INT8_M8192.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 17:01:57 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=220707) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=220707) WARNING 01-25 17:02:11 [backends.py:609] Failed to read file <frozen os>
Throughput: 136.85 requests/s, 140268.53 total tokens/s, 136.85 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024

STDERR:
[2026-01-25 17:01:57] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:01:57] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 17:01:57] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 17:01:57] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:01:57] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:01:57] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:01:57] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:01:57] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:01:57] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 17:01:57] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:01:57] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:01:57] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:01:57] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:01:57] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 17:02:04] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:02:04] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 17:02:04] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 17:02:04] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:02:04] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:02:04] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:02:04] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:02:04] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:02:04] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 17:02:04] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:02:04] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:02:04] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:02:04] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:02:04] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=220707) [2026-01-25 17:02:05] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=220707) [2026-01-25 17:02:05] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=220707) [2026-01-25 17:02:05] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=220707) [2026-01-25 17:02:05] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=220707) [2026-01-25 17:02:05] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-1B-INT8
(EngineCore_DP0 pid=220707) [2026-01-25 17:02:05] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=220707) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=220707) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  5.33it/s]
(EngineCore_DP0 pid=220707) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  5.32it/s]
(EngineCore_DP0 pid=220707) 
(EngineCore_DP0 pid=220707) [2026-01-25 17:02:06] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 2048] -> 1D uint8
(EngineCore_DP0 pid=220707) [2026-01-25 17:02:06] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4718592 bytes
(EngineCore_DP0 pid=220707) [2026-01-25 17:02:06] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 2048] -> 1D uint8
(EngineCore_DP0 pid=220707) [2026-01-25 17:02:06] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 3145728 bytes
(EngineCore_DP0 pid=220707) [2026-01-25 17:02:06] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 2048] -> 1D uint8
(EngineCore_DP0 pid=220707) [2026-01-25 17:02:06] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 25165824 bytes
(EngineCore_DP0 pid=220707) [2026-01-25 17:02:06] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 8192] -> 1D uint8
(EngineCore_DP0 pid=220707) [2026-01-25 17:02:06] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12582912 bytes
(EngineCore_DP0 pid=220707) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  40%|████      | 2/5 [00:00<00:00, 12.16it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  80%|████████  | 4/5 [00:00<00:00, 12.81it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00, 12.36it/s]
(EngineCore_DP0 pid=220707) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 2/4 [00:00<00:00, 11.81it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00, 12.23it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00, 12.16it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   3%|▎         | 35/1024 [00:00<00:02, 349.18it/s]
Adding requests:   7%|▋         | 72/1024 [00:00<00:02, 358.08it/s]
Adding requests:  11%|█         | 109/1024 [00:00<00:02, 360.78it/s]
Adding requests:  14%|█▍        | 146/1024 [00:00<00:02, 357.74it/s]
Adding requests:  18%|█▊        | 182/1024 [00:00<00:02, 355.48it/s]
Adding requests:  21%|██▏       | 218/1024 [00:00<00:02, 356.82it/s]
Adding requests:  25%|██▍       | 254/1024 [00:00<00:02, 357.17it/s]
Adding requests:  28%|██▊       | 290/1024 [00:00<00:02, 353.77it/s]
Adding requests:  32%|███▏      | 326/1024 [00:00<00:01, 350.84it/s]
Adding requests:  36%|███▌      | 364/1024 [00:01<00:01, 358.46it/s]
Adding requests:  39%|███▉      | 401/1024 [00:01<00:01, 359.81it/s]
Adding requests:  43%|████▎     | 438/1024 [00:01<00:01, 361.37it/s]
Adding requests:  47%|████▋     | 477/1024 [00:01<00:01, 367.97it/s]
Adding requests:  50%|█████     | 514/1024 [00:01<00:01, 356.81it/s]
Adding requests:  54%|█████▎    | 550/1024 [00:01<00:01, 351.95it/s]
Adding requests:  58%|█████▊    | 589/1024 [00:01<00:01, 362.22it/s]
Adding requests:  61%|██████    | 626/1024 [00:01<00:01, 361.81it/s]
Adding requests:  65%|██████▍   | 664/1024 [00:01<00:00, 365.47it/s]
Adding requests:  69%|██████▊   | 702/1024 [00:01<00:00, 368.23it/s]
Adding requests:  72%|███████▏  | 739/1024 [00:02<00:00, 367.81it/s]
Adding requests:  76%|███████▌  | 776/1024 [00:02<00:00, 362.09it/s]
Adding requests:  79%|███████▉  | 813/1024 [00:02<00:00, 356.30it/s]
Adding requests:  83%|████████▎ | 849/1024 [00:02<00:00, 353.48it/s]
Adding requests:  87%|████████▋ | 886/1024 [00:02<00:00, 357.64it/s]
Adding requests:  90%|█████████ | 924/1024 [00:02<00:00, 362.34it/s]
Adding requests:  94%|█████████▍| 962/1024 [00:02<00:00, 364.62it/s]
Adding requests:  98%|█████████▊| 999/1024 [00:02<00:00, 362.03it/s]
Adding requests: 100%|██████████| 1024/1024 [00:02<00:00, 360.31it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:00<00:00, 2535.79it/s, est. speed input: 2597247.71 toks/s, output: 2535.88 toks/s]
Processed prompts:  59%|█████▉    | 608/1024 [00:01<00:01, 282.18it/s, est. speed input: 342054.90 toks/s, output: 334.04 toks/s]   
Processed prompts:  71%|███████   | 722/1024 [00:02<00:01, 225.58it/s, est. speed input: 280273.37 toks/s, output: 273.70 toks/s]
Processed prompts:  77%|███████▋  | 790/1024 [00:03<00:01, 209.42it/s, est. speed input: 263161.59 toks/s, output: 256.99 toks/s]
Processed prompts:  82%|████████▏ | 838/1024 [00:03<00:00, 197.29it/s, est. speed input: 252519.90 toks/s, output: 246.60 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [00:03<00:00, 185.09it/s, est. speed input: 243972.74 toks/s, output: 238.25 toks/s]
Processed prompts:  88%|████████▊ | 903/1024 [00:03<00:00, 184.19it/s, est. speed input: 241387.51 toks/s, output: 235.73 toks/s]
Processed prompts:  91%|█████████ | 928/1024 [00:03<00:00, 179.10it/s, est. speed input: 237972.08 toks/s, output: 232.39 toks/s]
Processed prompts:  93%|█████████▎| 950/1024 [00:04<00:00, 170.22it/s, est. speed input: 233962.34 toks/s, output: 228.48 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [00:04<00:00, 159.98it/s, est. speed input: 229884.80 toks/s, output: 224.50 toks/s]
Processed prompts:  96%|█████████▋| 988/1024 [00:04<00:00, 161.96it/s, est. speed input: 228610.22 toks/s, output: 223.25 toks/s]
Processed prompts:  98%|█████████▊| 1006/1024 [00:04<00:00, 162.74it/s, est. speed input: 227205.78 toks/s, output: 221.88 toks/s]
Processed prompts: 100%|█████████▉| 1023/1024 [00:04<00:00, 162.51it/s, est. speed input: 225808.99 toks/s, output: 220.52 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:04<00:00, 162.51it/s, est. speed input: 226023.15 toks/s, output: 220.73 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:04<00:00, 220.72it/s, est. speed input: 226023.15 toks/s, output: 220.73 toks/s]
[rank0]:[W125 17:02:30.206974143 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=16384 ==========
Time: 2026-01-25 17:02:32
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=2048, max_num_seqs=16
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 2048 --max-num-seqs 16 --max-model-len 1025 --max-num-batched-tokens 16384 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/Llama3.2-1B-INT8_M16384.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 17:02:50 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=221682) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=221682) WARNING 01-25 17:03:04 [backends.py:609] Failed to read file <frozen os>
Throughput: 152.46 requests/s, 156273.37 total tokens/s, 152.46 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048

STDERR:
[2026-01-25 17:02:50] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:02:50] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 17:02:50] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 17:02:50] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:02:50] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:02:50] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:02:50] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:02:50] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:02:50] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 17:02:50] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:02:50] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:02:50] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:02:50] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:02:50] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 17:02:57] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:02:57] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 17:02:57] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 17:02:57] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:02:57] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:02:57] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:02:57] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:02:57] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:02:57] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 17:02:57] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:02:57] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:02:57] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:02:57] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:02:57] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=221682) [2026-01-25 17:02:58] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=221682) [2026-01-25 17:02:58] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=221682) [2026-01-25 17:02:58] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=221682) [2026-01-25 17:02:58] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=221682) [2026-01-25 17:02:58] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-1B-INT8
(EngineCore_DP0 pid=221682) [2026-01-25 17:02:58] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=221682) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=221682) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  5.39it/s]
(EngineCore_DP0 pid=221682) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  5.38it/s]
(EngineCore_DP0 pid=221682) 
(EngineCore_DP0 pid=221682) [2026-01-25 17:02:59] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 2048] -> 1D uint8
(EngineCore_DP0 pid=221682) [2026-01-25 17:02:59] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4718592 bytes
(EngineCore_DP0 pid=221682) [2026-01-25 17:02:59] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 2048] -> 1D uint8
(EngineCore_DP0 pid=221682) [2026-01-25 17:02:59] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 3145728 bytes
(EngineCore_DP0 pid=221682) [2026-01-25 17:02:59] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 2048] -> 1D uint8
(EngineCore_DP0 pid=221682) [2026-01-25 17:02:59] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 25165824 bytes
(EngineCore_DP0 pid=221682) [2026-01-25 17:02:59] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 8192] -> 1D uint8
(EngineCore_DP0 pid=221682) [2026-01-25 17:02:59] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12582912 bytes
(EngineCore_DP0 pid=221682) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  29%|██▊       | 2/7 [00:00<00:00, 11.73it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  57%|█████▋    | 4/7 [00:00<00:00, 11.21it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  86%|████████▌ | 6/7 [00:00<00:00, 11.72it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00, 11.52it/s]
(EngineCore_DP0 pid=221682) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  40%|████      | 2/5 [00:00<00:00, 11.59it/s]
Capturing CUDA graphs (decode, FULL):  80%|████████  | 4/5 [00:00<00:00, 12.42it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00, 12.43it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 35/2048 [00:00<00:05, 345.02it/s]
Adding requests:   4%|▎         | 72/2048 [00:00<00:05, 357.80it/s]
Adding requests:   5%|▌         | 111/2048 [00:00<00:05, 370.91it/s]
Adding requests:   7%|▋         | 150/2048 [00:00<00:05, 376.24it/s]
Adding requests:   9%|▉         | 188/2048 [00:00<00:05, 369.50it/s]
Adding requests:  11%|█         | 226/2048 [00:00<00:04, 372.19it/s]
Adding requests:  13%|█▎        | 267/2048 [00:00<00:04, 382.60it/s]
Adding requests:  15%|█▍        | 306/2048 [00:00<00:04, 374.13it/s]
Adding requests:  17%|█▋        | 345/2048 [00:00<00:04, 377.41it/s]
Adding requests:  19%|█▊        | 383/2048 [00:01<00:04, 376.05it/s]
Adding requests:  21%|██        | 421/2048 [00:01<00:04, 374.55it/s]
Adding requests:  22%|██▏       | 459/2048 [00:01<00:04, 368.27it/s]
Adding requests:  24%|██▍       | 496/2048 [00:01<00:04, 366.79it/s]
Adding requests:  26%|██▌       | 533/2048 [00:01<00:04, 363.51it/s]
Adding requests:  28%|██▊       | 575/2048 [00:01<00:03, 378.69it/s]
Adding requests:  30%|██▉       | 613/2048 [00:01<00:03, 378.84it/s]
Adding requests:  32%|███▏      | 653/2048 [00:01<00:03, 383.36it/s]
Adding requests:  34%|███▍      | 694/2048 [00:01<00:03, 390.39it/s]
Adding requests:  36%|███▌      | 734/2048 [00:01<00:03, 384.76it/s]
Adding requests:  38%|███▊      | 773/2048 [00:02<00:03, 374.37it/s]
Adding requests:  40%|███▉      | 811/2048 [00:02<00:03, 368.61it/s]
Adding requests:  41%|████▏     | 848/2048 [00:02<00:03, 365.31it/s]
Adding requests:  43%|████▎     | 887/2048 [00:02<00:03, 371.61it/s]
Adding requests:  45%|████▌     | 928/2048 [00:02<00:02, 382.42it/s]
Adding requests:  47%|████▋     | 969/2048 [00:02<00:02, 389.88it/s]
Adding requests:  49%|████▉     | 1010/2048 [00:02<00:02, 395.64it/s]
Adding requests:  51%|█████▏    | 1051/2048 [00:02<00:02, 397.93it/s]
Adding requests:  53%|█████▎    | 1091/2048 [00:02<00:02, 392.41it/s]
Adding requests:  55%|█████▌    | 1131/2048 [00:02<00:02, 390.81it/s]
Adding requests:  57%|█████▋    | 1172/2048 [00:03<00:02, 395.32it/s]
Adding requests:  59%|█████▉    | 1212/2048 [00:03<00:02, 396.69it/s]
Adding requests:  61%|██████    | 1252/2048 [00:03<00:02, 388.25it/s]
Adding requests:  63%|██████▎   | 1291/2048 [00:03<00:01, 386.00it/s]
Adding requests:  65%|██████▌   | 1333/2048 [00:03<00:01, 394.24it/s]
Adding requests:  67%|██████▋   | 1373/2048 [00:03<00:01, 395.12it/s]
Adding requests:  69%|██████▉   | 1415/2048 [00:03<00:01, 400.64it/s]
Adding requests:  71%|███████   | 1456/2048 [00:03<00:01, 402.56it/s]
Adding requests:  73%|███████▎  | 1497/2048 [00:03<00:01, 403.67it/s]
Adding requests:  75%|███████▌  | 1539/2048 [00:04<00:01, 406.05it/s]
Adding requests:  77%|███████▋  | 1580/2048 [00:04<00:01, 401.18it/s]
Adding requests:  79%|███████▉  | 1621/2048 [00:04<00:01, 395.43it/s]
Adding requests:  81%|████████  | 1661/2048 [00:04<00:00, 388.26it/s]
Adding requests:  83%|████████▎ | 1700/2048 [00:04<00:00, 381.65it/s]
Adding requests:  85%|████████▍ | 1739/2048 [00:04<00:00, 381.89it/s]
Adding requests:  87%|████████▋ | 1778/2048 [00:04<00:00, 377.96it/s]
Adding requests:  89%|████████▉ | 1820/2048 [00:04<00:00, 388.26it/s]
Adding requests:  91%|█████████ | 1859/2048 [00:04<00:00, 381.07it/s]
Adding requests:  93%|█████████▎| 1900/2048 [00:04<00:00, 389.04it/s]
Adding requests:  95%|█████████▍| 1940/2048 [00:05<00:00, 391.42it/s]
Adding requests:  97%|█████████▋| 1980/2048 [00:05<00:00, 391.11it/s]
Adding requests:  99%|█████████▊| 2022/2048 [00:05<00:00, 398.70it/s]
Adding requests: 100%|██████████| 2048/2048 [00:05<00:00, 384.97it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [00:00<00:00, 6090.15it/s, est. speed input: 6237010.66 toks/s, output: 6090.31 toks/s]
Processed prompts:  69%|██████▉   | 1412/2048 [00:04<00:02, 290.24it/s, est. speed input: 354784.14 toks/s, output: 346.47 toks/s]  
Processed prompts:  82%|████████▏ | 1672/2048 [00:05<00:01, 240.57it/s, est. speed input: 298302.83 toks/s, output: 291.31 toks/s]
Processed prompts:  89%|████████▉ | 1821/2048 [00:06<00:01, 221.55it/s, est. speed input: 279073.32 toks/s, output: 272.53 toks/s]
Processed prompts:  94%|█████████▎| 1918/2048 [00:07<00:00, 209.76it/s, est. speed input: 268859.68 toks/s, output: 262.56 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [00:07<00:00, 196.55it/s, est. speed input: 260233.33 toks/s, output: 254.13 toks/s]
Processed prompts:  99%|█████████▉| 2035/2048 [00:08<00:00, 192.64it/s, est. speed input: 256915.68 toks/s, output: 250.89 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:08<00:00, 192.64it/s, est. speed input: 258544.14 toks/s, output: 252.48 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:08<00:00, 252.48it/s, est. speed input: 258544.14 toks/s, output: 252.48 toks/s]
[rank0]:[W125 17:03:29.237255470 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=32768 ==========
Time: 2026-01-25 17:03:31
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=4096, max_num_seqs=32
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 4096 --max-num-seqs 32 --max-model-len 1025 --max-num-batched-tokens 32768 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/Llama3.2-1B-INT8_M32768.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 17:03:59 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=222882) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=222882) WARNING 01-25 17:04:13 [backends.py:609] Failed to read file <frozen os>
Throughput: 155.77 requests/s, 159667.16 total tokens/s, 155.77 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096

STDERR:
[2026-01-25 17:03:59] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:03:59] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 17:03:59] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 17:03:59] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:03:59] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:03:59] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:03:59] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:03:59] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:03:59] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 17:03:59] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:03:59] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:03:59] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:03:59] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:03:59] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 17:04:07] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:04:07] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 17:04:07] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 17:04:07] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:04:07] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:04:07] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:04:07] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:04:07] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:04:07] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 17:04:07] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:04:07] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:04:07] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:04:07] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:04:07] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=222882) [2026-01-25 17:04:08] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=222882) [2026-01-25 17:04:08] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=222882) [2026-01-25 17:04:08] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=222882) [2026-01-25 17:04:08] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=222882) [2026-01-25 17:04:08] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-1B-INT8
(EngineCore_DP0 pid=222882) [2026-01-25 17:04:08] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=222882) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=222882) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  5.26it/s]
(EngineCore_DP0 pid=222882) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  5.25it/s]
(EngineCore_DP0 pid=222882) 
(EngineCore_DP0 pid=222882) [2026-01-25 17:04:08] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 2048] -> 1D uint8
(EngineCore_DP0 pid=222882) [2026-01-25 17:04:08] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4718592 bytes
(EngineCore_DP0 pid=222882) [2026-01-25 17:04:08] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 2048] -> 1D uint8
(EngineCore_DP0 pid=222882) [2026-01-25 17:04:08] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 3145728 bytes
(EngineCore_DP0 pid=222882) [2026-01-25 17:04:08] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 2048] -> 1D uint8
(EngineCore_DP0 pid=222882) [2026-01-25 17:04:08] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 25165824 bytes
(EngineCore_DP0 pid=222882) [2026-01-25 17:04:08] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 8192] -> 1D uint8
(EngineCore_DP0 pid=222882) [2026-01-25 17:04:08] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12582912 bytes
(EngineCore_DP0 pid=222882) [rank0]:W0125 17:04:19.031000 222882 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=222882) [rank0]:W0125 17:04:19.114000 222882 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=222882) [rank0]:W0125 17:04:20.029000 222882 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=222882) [rank0]:W0125 17:04:20.134000 222882 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=222882) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  18%|█▊        | 2/11 [00:00<00:00, 10.86it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  36%|███▋      | 4/11 [00:00<00:00, 11.17it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  55%|█████▍    | 6/11 [00:00<00:00, 11.29it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  73%|███████▎  | 8/11 [00:00<00:00, 11.84it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  91%|█████████ | 10/11 [00:00<00:00, 12.09it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:00<00:00, 11.66it/s]
(EngineCore_DP0 pid=222882) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  29%|██▊       | 2/7 [00:00<00:00, 10.99it/s]
Capturing CUDA graphs (decode, FULL):  57%|█████▋    | 4/7 [00:00<00:00, 11.18it/s]
Capturing CUDA graphs (decode, FULL):  86%|████████▌ | 6/7 [00:00<00:00, 11.69it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00, 11.54it/s]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   1%|          | 35/4096 [00:00<00:11, 342.06it/s]
Adding requests:   2%|▏         | 73/4096 [00:00<00:11, 360.47it/s]
Adding requests:   3%|▎         | 113/4096 [00:00<00:10, 377.04it/s]
Adding requests:   4%|▎         | 152/4096 [00:00<00:10, 380.81it/s]
Adding requests:   5%|▍         | 191/4096 [00:00<00:10, 373.45it/s]
Adding requests:   6%|▌         | 231/4096 [00:00<00:10, 381.65it/s]
Adding requests:   7%|▋         | 270/4096 [00:00<00:10, 379.57it/s]
Adding requests:   8%|▊         | 308/4096 [00:00<00:10, 375.96it/s]
Adding requests:   8%|▊         | 346/4096 [00:00<00:09, 376.19it/s]
Adding requests:   9%|▉         | 384/4096 [00:01<00:09, 374.11it/s]
Adding requests:  10%|█         | 422/4096 [00:01<00:09, 371.52it/s]
Adding requests:  11%|█▏        | 462/4096 [00:01<00:09, 377.28it/s]
Adding requests:  12%|█▏        | 501/4096 [00:01<00:09, 378.63it/s]
Adding requests:  13%|█▎        | 539/4096 [00:01<00:09, 374.82it/s]
Adding requests:  14%|█▍        | 578/4096 [00:01<00:09, 376.70it/s]
Adding requests:  15%|█▌        | 616/4096 [00:01<00:09, 376.69it/s]
Adding requests:  16%|█▌        | 654/4096 [00:01<00:09, 377.49it/s]
Adding requests:  17%|█▋        | 694/4096 [00:01<00:08, 381.97it/s]
Adding requests:  18%|█▊        | 735/4096 [00:01<00:08, 387.78it/s]
Adding requests:  19%|█▉        | 774/4096 [00:02<00:08, 385.20it/s]
Adding requests:  20%|█▉        | 813/4096 [00:02<00:08, 381.42it/s]
Adding requests:  21%|██        | 852/4096 [00:02<00:08, 381.23it/s]
Adding requests:  22%|██▏       | 891/4096 [00:02<00:08, 381.94it/s]
Adding requests:  23%|██▎       | 930/4096 [00:02<00:08, 381.36it/s]
Adding requests:  24%|██▎       | 969/4096 [00:02<00:08, 378.91it/s]
Adding requests:  25%|██▍       | 1010/4096 [00:02<00:07, 386.21it/s]
Adding requests:  26%|██▌       | 1049/4096 [00:02<00:08, 380.15it/s]
Adding requests:  27%|██▋       | 1088/4096 [00:02<00:07, 378.99it/s]
Adding requests:  28%|██▊       | 1127/4096 [00:02<00:07, 381.22it/s]
Adding requests:  28%|██▊       | 1167/4096 [00:03<00:07, 385.93it/s]
Adding requests:  29%|██▉       | 1206/4096 [00:03<00:07, 385.51it/s]
Adding requests:  30%|███       | 1245/4096 [00:03<00:07, 384.56it/s]
Adding requests:  31%|███▏      | 1284/4096 [00:03<00:07, 379.97it/s]
Adding requests:  32%|███▏      | 1323/4096 [00:03<00:07, 380.65it/s]
Adding requests:  33%|███▎      | 1362/4096 [00:03<00:07, 377.03it/s]
Adding requests:  34%|███▍      | 1403/4096 [00:03<00:06, 385.09it/s]
Adding requests:  35%|███▌      | 1442/4096 [00:03<00:06, 382.66it/s]
Adding requests:  36%|███▌      | 1484/4096 [00:03<00:06, 392.15it/s]
Adding requests:  37%|███▋      | 1525/4096 [00:04<00:06, 394.57it/s]
Adding requests:  38%|███▊      | 1565/4096 [00:04<00:06, 394.91it/s]
Adding requests:  39%|███▉      | 1607/4096 [00:04<00:06, 399.62it/s]
Adding requests:  40%|████      | 1647/4096 [00:04<00:06, 395.51it/s]
Adding requests:  41%|████      | 1687/4096 [00:04<00:06, 388.25it/s]
Adding requests:  42%|████▏     | 1728/4096 [00:04<00:06, 392.44it/s]
Adding requests:  43%|████▎     | 1768/4096 [00:04<00:06, 383.58it/s]
Adding requests:  44%|████▍     | 1807/4096 [00:04<00:05, 385.15it/s]
Adding requests:  45%|████▌     | 1848/4096 [00:04<00:05, 391.65it/s]
Adding requests:  46%|████▌     | 1889/4096 [00:04<00:05, 396.06it/s]
Adding requests:  47%|████▋     | 1930/4096 [00:05<00:05, 397.23it/s]
Adding requests:  48%|████▊     | 1970/4096 [00:05<00:05, 388.27it/s]
Adding requests:  49%|████▉     | 2009/4096 [00:05<00:05, 384.75it/s]
Adding requests:  50%|█████     | 2051/4096 [00:05<00:05, 393.09it/s]
Adding requests:  51%|█████     | 2093/4096 [00:05<00:04, 400.60it/s]
Adding requests:  52%|█████▏    | 2134/4096 [00:05<00:05, 390.19it/s]
Adding requests:  53%|█████▎    | 2174/4096 [00:05<00:05, 380.15it/s]
Adding requests:  54%|█████▍    | 2213/4096 [00:05<00:05, 365.10it/s]
Adding requests:  55%|█████▍    | 2251/4096 [00:05<00:05, 366.57it/s]
Adding requests:  56%|█████▌    | 2289/4096 [00:05<00:04, 370.14it/s]
Adding requests:  57%|█████▋    | 2329/4096 [00:06<00:04, 377.29it/s]
Adding requests:  58%|█████▊    | 2371/4096 [00:06<00:04, 386.61it/s]
Adding requests:  59%|█████▉    | 2412/4096 [00:06<00:04, 391.31it/s]
Adding requests:  60%|█████▉    | 2455/4096 [00:06<00:04, 400.66it/s]
Adding requests:  61%|██████    | 2496/4096 [00:06<00:03, 403.01it/s]
Adding requests:  62%|██████▏   | 2537/4096 [00:06<00:03, 403.11it/s]
Adding requests:  63%|██████▎   | 2578/4096 [00:06<00:03, 393.45it/s]
Adding requests:  64%|██████▍   | 2618/4096 [00:06<00:03, 394.25it/s]
Adding requests:  65%|██████▍   | 2658/4096 [00:06<00:03, 393.71it/s]
Adding requests:  66%|██████▌   | 2698/4096 [00:07<00:03, 395.18it/s]
Adding requests:  67%|██████▋   | 2738/4096 [00:07<00:03, 392.02it/s]
Adding requests:  68%|██████▊   | 2778/4096 [00:07<00:03, 386.95it/s]
Adding requests:  69%|██████▉   | 2817/4096 [00:07<00:03, 380.93it/s]
Adding requests:  70%|██████▉   | 2858/4096 [00:07<00:03, 388.17it/s]
Adding requests:  71%|███████   | 2898/4096 [00:07<00:03, 389.09it/s]
Adding requests:  72%|███████▏  | 2937/4096 [00:07<00:03, 384.43it/s]
Adding requests:  73%|███████▎  | 2976/4096 [00:07<00:02, 379.92it/s]
Adding requests:  74%|███████▎  | 3017/4096 [00:07<00:02, 385.75it/s]
Adding requests:  75%|███████▍  | 3056/4096 [00:07<00:02, 381.96it/s]
Adding requests:  76%|███████▌  | 3097/4096 [00:08<00:02, 388.48it/s]
Adding requests:  77%|███████▋  | 3136/4096 [00:08<00:02, 387.20it/s]
Adding requests:  78%|███████▊  | 3175/4096 [00:08<00:02, 385.33it/s]
Adding requests:  78%|███████▊  | 3215/4096 [00:08<00:02, 388.42it/s]
Adding requests:  80%|███████▉  | 3258/4096 [00:08<00:02, 398.33it/s]
Adding requests:  81%|████████  | 3298/4096 [00:08<00:02, 396.98it/s]
Adding requests:  82%|████████▏ | 3339/4096 [00:08<00:01, 397.64it/s]
Adding requests:  82%|████████▏ | 3379/4096 [00:08<00:01, 387.28it/s]
Adding requests:  83%|████████▎ | 3418/4096 [00:08<00:01, 383.97it/s]
Adding requests:  84%|████████▍ | 3457/4096 [00:08<00:01, 373.27it/s]
Adding requests:  85%|████████▌ | 3495/4096 [00:09<00:01, 361.04it/s]
Adding requests:  86%|████████▌ | 3532/4096 [00:09<00:01, 360.13it/s]
Adding requests:  87%|████████▋ | 3571/4096 [00:09<00:01, 367.96it/s]
Adding requests:  88%|████████▊ | 3608/4096 [00:09<00:01, 363.43it/s]
Adding requests:  89%|████████▉ | 3648/4096 [00:09<00:01, 373.36it/s]
Adding requests:  90%|█████████ | 3688/4096 [00:09<00:01, 380.34it/s]
Adding requests:  91%|█████████ | 3727/4096 [00:09<00:00, 381.27it/s]
Adding requests:  92%|█████████▏| 3766/4096 [00:09<00:00, 378.46it/s]
Adding requests:  93%|█████████▎| 3809/4096 [00:09<00:00, 391.32it/s]
Adding requests:  94%|█████████▍| 3849/4096 [00:10<00:00, 393.84it/s]
Adding requests:  95%|█████████▍| 3889/4096 [00:10<00:00, 391.71it/s]
Adding requests:  96%|█████████▌| 3929/4096 [00:10<00:00, 386.21it/s]
Adding requests:  97%|█████████▋| 3971/4096 [00:10<00:00, 394.65it/s]
Adding requests:  98%|█████████▊| 4011/4096 [00:10<00:00, 391.57it/s]
Adding requests:  99%|█████████▉| 4052/4096 [00:10<00:00, 393.85it/s]
Adding requests: 100%|█████████▉| 4092/4096 [00:10<00:00, 385.41it/s]
Adding requests: 100%|██████████| 4096/4096 [00:10<00:00, 384.31it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  40%|███▉      | 1627/4096 [00:00<00:00, 15086.56it/s, est. speed input: 15451538.19 toks/s, output: 15087.32 toks/s]
Processed prompts:  77%|███████▋  | 3136/4096 [00:09<00:03, 275.34it/s, est. speed input: 332803.87 toks/s, output: 325.00 toks/s]      
Processed prompts:  92%|█████████▏| 3767/4096 [00:13<00:01, 233.92it/s, est. speed input: 284917.27 toks/s, output: 278.24 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [00:15<00:00, 233.92it/s, est. speed input: 268273.73 toks/s, output: 261.99 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [00:15<00:00, 261.98it/s, est. speed input: 268273.73 toks/s, output: 261.99 toks/s]
[rank0]:[W125 17:04:52.298057626 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=65536 ==========
Time: 2026-01-25 17:04:54
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=8192, max_num_seqs=64
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 8192 --max-num-seqs 64 --max-model-len 1025 --max-num-batched-tokens 65536 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/Llama3.2-1B-INT8_M65536.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 17:05:45 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=224560) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=224560) WARNING 01-25 17:05:59 [backends.py:609] Failed to read file <frozen os>
Throughput: 156.41 requests/s, 160323.99 total tokens/s, 156.41 output tokens/s
Total num prompt tokens:  8388608
Total num output tokens:  8192

STDERR:
[2026-01-25 17:05:45] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:05:45] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 17:05:45] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 17:05:45] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:05:45] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:05:45] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:05:45] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:05:45] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:05:45] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 17:05:45] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:05:45] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:05:45] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:05:45] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:05:45] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 17:05:52] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:05:52] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-25 17:05:52] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-25 17:05:52] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:05:52] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:05:52] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:05:52] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:05:52] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-25 17:05:52] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-25 17:05:52] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:05:52] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:05:52] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:05:52] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:05:52] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=224560) [2026-01-25 17:05:53] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=224560) [2026-01-25 17:05:53] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=224560) [2026-01-25 17:05:53] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=224560) [2026-01-25 17:05:53] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=224560) [2026-01-25 17:05:53] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-1B-INT8
(EngineCore_DP0 pid=224560) [2026-01-25 17:05:53] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=224560) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=224560) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  5.41it/s]
(EngineCore_DP0 pid=224560) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  5.40it/s]
(EngineCore_DP0 pid=224560) 
(EngineCore_DP0 pid=224560) [2026-01-25 17:05:54] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 2048] -> 1D uint8
(EngineCore_DP0 pid=224560) [2026-01-25 17:05:54] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4718592 bytes
(EngineCore_DP0 pid=224560) [2026-01-25 17:05:54] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 2048] -> 1D uint8
(EngineCore_DP0 pid=224560) [2026-01-25 17:05:54] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 3145728 bytes
(EngineCore_DP0 pid=224560) [2026-01-25 17:05:54] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 2048] -> 1D uint8
(EngineCore_DP0 pid=224560) [2026-01-25 17:05:54] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 25165824 bytes
(EngineCore_DP0 pid=224560) [2026-01-25 17:05:54] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 8192] -> 1D uint8
(EngineCore_DP0 pid=224560) [2026-01-25 17:05:54] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12582912 bytes
(EngineCore_DP0 pid=224560) [rank0]:W0125 17:06:04.490000 224560 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=224560) [rank0]:W0125 17:06:04.564000 224560 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=224560) [rank0]:W0125 17:06:05.462000 224560 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=224560) [rank0]:W0125 17:06:05.567000 224560 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=224560) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/19 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   5%|▌         | 1/19 [00:00<00:01,  9.83it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  16%|█▌        | 3/19 [00:00<00:01, 10.99it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  26%|██▋       | 5/19 [00:00<00:01, 11.68it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  37%|███▋      | 7/19 [00:00<00:01, 11.44it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  47%|████▋     | 9/19 [00:00<00:00, 11.34it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  58%|█████▊    | 11/19 [00:00<00:00, 11.66it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  68%|██████▊   | 13/19 [00:01<00:00, 11.79it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  79%|███████▉  | 15/19 [00:01<00:00, 11.82it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  89%|████████▉ | 17/19 [00:01<00:00, 11.95it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 19/19 [00:01<00:00, 11.80it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 19/19 [00:01<00:00, 11.65it/s]
(EngineCore_DP0 pid=224560) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):   9%|▉         | 1/11 [00:00<00:01,  9.86it/s]
Capturing CUDA graphs (decode, FULL):  27%|██▋       | 3/11 [00:00<00:00, 11.41it/s]
Capturing CUDA graphs (decode, FULL):  45%|████▌     | 5/11 [00:00<00:00, 11.39it/s]
Capturing CUDA graphs (decode, FULL):  64%|██████▎   | 7/11 [00:00<00:00, 11.53it/s]
Capturing CUDA graphs (decode, FULL):  82%|████████▏ | 9/11 [00:00<00:00, 11.70it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 11/11 [00:00<00:00, 11.70it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 11/11 [00:00<00:00, 11.56it/s]

Adding requests:   0%|          | 0/8192 [00:00<?, ?it/s]
Adding requests:   0%|          | 35/8192 [00:00<00:23, 346.68it/s]
Adding requests:   1%|          | 73/8192 [00:00<00:22, 364.15it/s]
Adding requests:   1%|▏         | 112/8192 [00:00<00:21, 375.07it/s]
Adding requests:   2%|▏         | 152/8192 [00:00<00:21, 381.39it/s]
Adding requests:   2%|▏         | 193/8192 [00:00<00:20, 390.64it/s]
Adding requests:   3%|▎         | 233/8192 [00:00<00:20, 393.52it/s]
Adding requests:   3%|▎         | 273/8192 [00:00<00:20, 389.82it/s]
Adding requests:   4%|▍         | 312/8192 [00:00<00:20, 384.55it/s]
Adding requests:   4%|▍         | 351/8192 [00:00<00:20, 385.29it/s]
Adding requests:   5%|▍         | 393/8192 [00:01<00:19, 394.38it/s]
Adding requests:   5%|▌         | 434/8192 [00:01<00:19, 395.49it/s]
Adding requests:   6%|▌         | 476/8192 [00:01<00:19, 400.35it/s]
Adding requests:   6%|▋         | 517/8192 [00:01<00:19, 392.37it/s]
Adding requests:   7%|▋         | 557/8192 [00:01<00:19, 388.00it/s]
Adding requests:   7%|▋         | 596/8192 [00:01<00:19, 383.25it/s]
Adding requests:   8%|▊         | 636/8192 [00:01<00:19, 385.67it/s]
Adding requests:   8%|▊         | 679/8192 [00:01<00:18, 396.09it/s]
Adding requests:   9%|▉         | 723/8192 [00:01<00:18, 408.62it/s]
Adding requests:   9%|▉         | 764/8192 [00:01<00:18, 401.59it/s]
Adding requests:  10%|▉         | 805/8192 [00:02<00:18, 403.13it/s]
Adding requests:  10%|█         | 847/8192 [00:02<00:18, 405.33it/s]
Adding requests:  11%|█         | 891/8192 [00:02<00:17, 414.12it/s]
Adding requests:  11%|█▏        | 933/8192 [00:02<00:17, 409.84it/s]
Adding requests:  12%|█▏        | 975/8192 [00:02<00:17, 412.78it/s]
Adding requests:  12%|█▏        | 1017/8192 [00:02<00:17, 406.70it/s]
Adding requests:  13%|█▎        | 1058/8192 [00:02<00:17, 400.30it/s]
Adding requests:  13%|█▎        | 1099/8192 [00:02<00:17, 394.64it/s]
Adding requests:  14%|█▍        | 1139/8192 [00:02<00:18, 388.70it/s]
Adding requests:  14%|█▍        | 1183/8192 [00:02<00:17, 401.08it/s]
Adding requests:  15%|█▍        | 1225/8192 [00:03<00:17, 405.64it/s]
Adding requests:  15%|█▌        | 1266/8192 [00:03<00:17, 404.85it/s]
Adding requests:  16%|█▌        | 1308/8192 [00:03<00:16, 408.95it/s]
Adding requests:  16%|█▋        | 1350/8192 [00:03<00:16, 411.66it/s]
Adding requests:  17%|█▋        | 1394/8192 [00:03<00:16, 417.38it/s]
Adding requests:  18%|█▊        | 1436/8192 [00:03<00:16, 412.96it/s]
Adding requests:  18%|█▊        | 1479/8192 [00:03<00:16, 414.93it/s]
Adding requests:  19%|█▊        | 1521/8192 [00:03<00:16, 409.17it/s]
Adding requests:  19%|█▉        | 1565/8192 [00:03<00:15, 416.43it/s]
Adding requests:  20%|█▉        | 1609/8192 [00:04<00:15, 421.24it/s]
Adding requests:  20%|██        | 1652/8192 [00:04<00:15, 416.12it/s]
Adding requests:  21%|██        | 1694/8192 [00:04<00:15, 416.06it/s]
Adding requests:  21%|██        | 1736/8192 [00:04<00:15, 406.59it/s]
Adding requests:  22%|██▏       | 1777/8192 [00:04<00:16, 395.59it/s]
Adding requests:  22%|██▏       | 1819/8192 [00:04<00:15, 402.46it/s]
Adding requests:  23%|██▎       | 1862/8192 [00:04<00:15, 409.48it/s]
Adding requests:  23%|██▎       | 1906/8192 [00:04<00:15, 415.76it/s]
Adding requests:  24%|██▍       | 1948/8192 [00:04<00:15, 410.56it/s]
Adding requests:  24%|██▍       | 1990/8192 [00:04<00:15, 403.81it/s]
Adding requests:  25%|██▍       | 2031/8192 [00:05<00:15, 401.99it/s]
Adding requests:  25%|██▌       | 2073/8192 [00:05<00:15, 405.64it/s]
Adding requests:  26%|██▌       | 2114/8192 [00:05<00:14, 406.80it/s]
Adding requests:  26%|██▋       | 2155/8192 [00:05<00:15, 402.31it/s]
Adding requests:  27%|██▋       | 2197/8192 [00:05<00:14, 406.99it/s]
Adding requests:  27%|██▋       | 2239/8192 [00:05<00:14, 408.65it/s]
Adding requests:  28%|██▊       | 2280/8192 [00:05<00:14, 396.33it/s]
Adding requests:  28%|██▊       | 2320/8192 [00:05<00:14, 392.36it/s]
Adding requests:  29%|██▉       | 2360/8192 [00:05<00:14, 390.39it/s]
Adding requests:  29%|██▉       | 2402/8192 [00:05<00:14, 397.01it/s]
Adding requests:  30%|██▉       | 2442/8192 [00:06<00:14, 391.29it/s]
Adding requests:  30%|███       | 2485/8192 [00:06<00:14, 400.36it/s]
Adding requests:  31%|███       | 2526/8192 [00:06<00:14, 397.46it/s]
Adding requests:  31%|███▏      | 2569/8192 [00:06<00:13, 405.55it/s]
Adding requests:  32%|███▏      | 2610/8192 [00:06<00:14, 398.58it/s]
Adding requests:  32%|███▏      | 2651/8192 [00:06<00:13, 400.38it/s]
Adding requests:  33%|███▎      | 2692/8192 [00:06<00:13, 399.19it/s]
Adding requests:  33%|███▎      | 2733/8192 [00:06<00:13, 401.26it/s]
Adding requests:  34%|███▍      | 2774/8192 [00:06<00:13, 397.98it/s]
Adding requests:  34%|███▍      | 2815/8192 [00:07<00:13, 400.10it/s]
Adding requests:  35%|███▍      | 2856/8192 [00:07<00:13, 403.01it/s]
Adding requests:  35%|███▌      | 2897/8192 [00:07<00:13, 400.84it/s]
Adding requests:  36%|███▌      | 2938/8192 [00:07<00:13, 391.84it/s]
Adding requests:  36%|███▋      | 2978/8192 [00:07<00:13, 383.68it/s]
Adding requests:  37%|███▋      | 3018/8192 [00:07<00:13, 388.05it/s]
Adding requests:  37%|███▋      | 3059/8192 [00:07<00:13, 393.79it/s]
Adding requests:  38%|███▊      | 3099/8192 [00:07<00:12, 392.32it/s]
Adding requests:  38%|███▊      | 3140/8192 [00:07<00:12, 395.02it/s]
Adding requests:  39%|███▉      | 3183/8192 [00:07<00:12, 402.89it/s]
Adding requests:  39%|███▉      | 3225/8192 [00:08<00:12, 407.90it/s]
Adding requests:  40%|███▉      | 3266/8192 [00:08<00:12, 402.53it/s]
Adding requests:  40%|████      | 3307/8192 [00:08<00:12, 399.23it/s]
Adding requests:  41%|████      | 3347/8192 [00:08<00:12, 394.58it/s]
Adding requests:  41%|████▏     | 3387/8192 [00:08<00:12, 388.99it/s]
Adding requests:  42%|████▏     | 3426/8192 [00:08<00:12, 386.93it/s]
Adding requests:  42%|████▏     | 3465/8192 [00:08<00:12, 378.08it/s]
Adding requests:  43%|████▎     | 3503/8192 [00:08<00:12, 376.74it/s]
Adding requests:  43%|████▎     | 3542/8192 [00:08<00:12, 379.13it/s]
Adding requests:  44%|████▎     | 3580/8192 [00:08<00:12, 373.94it/s]
Adding requests:  44%|████▍     | 3618/8192 [00:09<00:12, 374.25it/s]
Adding requests:  45%|████▍     | 3656/8192 [00:09<00:12, 374.13it/s]
Adding requests:  45%|████▌     | 3694/8192 [00:09<00:12, 370.21it/s]
Adding requests:  46%|████▌     | 3732/8192 [00:09<00:12, 366.72it/s]
Adding requests:  46%|████▌     | 3772/8192 [00:09<00:11, 374.63it/s]
Adding requests:  47%|████▋     | 3812/8192 [00:09<00:11, 381.56it/s]
Adding requests:  47%|████▋     | 3852/8192 [00:09<00:11, 385.95it/s]
Adding requests:  47%|████▋     | 3891/8192 [00:09<00:11, 383.57it/s]
Adding requests:  48%|████▊     | 3933/8192 [00:09<00:10, 392.29it/s]
Adding requests:  49%|████▊     | 3974/8192 [00:10<00:10, 395.28it/s]
Adding requests:  49%|████▉     | 4014/8192 [00:10<00:10, 384.37it/s]
Adding requests:  49%|████▉     | 4053/8192 [00:10<00:11, 375.43it/s]
Adding requests:  50%|████▉     | 4091/8192 [00:10<00:10, 375.83it/s]
Adding requests:  50%|█████     | 4132/8192 [00:10<00:10, 383.99it/s]
Adding requests:  51%|█████     | 4171/8192 [00:10<00:10, 384.87it/s]
Adding requests:  51%|█████▏    | 4210/8192 [00:10<00:10, 382.54it/s]
Adding requests:  52%|█████▏    | 4249/8192 [00:10<00:10, 376.37it/s]
Adding requests:  52%|█████▏    | 4287/8192 [00:10<00:10, 374.67it/s]
Adding requests:  53%|█████▎    | 4326/8192 [00:10<00:10, 378.23it/s]
Adding requests:  53%|█████▎    | 4366/8192 [00:11<00:09, 382.83it/s]
Adding requests:  54%|█████▍    | 4409/8192 [00:11<00:09, 395.96it/s]
Adding requests:  54%|█████▍    | 4450/8192 [00:11<00:09, 399.78it/s]
Adding requests:  55%|█████▍    | 4491/8192 [00:11<00:09, 384.52it/s]
Adding requests:  55%|█████▌    | 4530/8192 [00:11<00:09, 379.95it/s]
Adding requests:  56%|█████▌    | 4569/8192 [00:11<00:09, 381.40it/s]
Adding requests:  56%|█████▋    | 4609/8192 [00:11<00:09, 382.04it/s]
Adding requests:  57%|█████▋    | 4648/8192 [00:11<00:09, 379.93it/s]
Adding requests:  57%|█████▋    | 4687/8192 [00:11<00:09, 376.32it/s]
Adding requests:  58%|█████▊    | 4730/8192 [00:11<00:08, 391.53it/s]
Adding requests:  58%|█████▊    | 4770/8192 [00:12<00:08, 388.20it/s]
Adding requests:  59%|█████▊    | 4809/8192 [00:12<00:08, 378.32it/s]
Adding requests:  59%|█████▉    | 4847/8192 [00:12<00:08, 377.80it/s]
Adding requests:  60%|█████▉    | 4885/8192 [00:12<00:08, 377.13it/s]
Adding requests:  60%|██████    | 4924/8192 [00:12<00:08, 380.40it/s]
Adding requests:  61%|██████    | 4963/8192 [00:12<00:08, 378.11it/s]
Adding requests:  61%|██████    | 5001/8192 [00:12<00:08, 378.06it/s]
Adding requests:  62%|██████▏   | 5040/8192 [00:12<00:08, 380.70it/s]
Adding requests:  62%|██████▏   | 5080/8192 [00:12<00:08, 384.17it/s]
Adding requests:  62%|██████▏   | 5119/8192 [00:13<00:08, 383.24it/s]
Adding requests:  63%|██████▎   | 5158/8192 [00:13<00:07, 381.83it/s]
Adding requests:  63%|██████▎   | 5199/8192 [00:13<00:07, 389.62it/s]
Adding requests:  64%|██████▍   | 5239/8192 [00:13<00:07, 392.31it/s]
Adding requests:  64%|██████▍   | 5279/8192 [00:13<00:07, 383.29it/s]
Adding requests:  65%|██████▍   | 5319/8192 [00:13<00:07, 386.89it/s]
Adding requests:  65%|██████▌   | 5360/8192 [00:13<00:07, 392.33it/s]
Adding requests:  66%|██████▌   | 5400/8192 [00:13<00:07, 388.22it/s]
Adding requests:  66%|██████▋   | 5439/8192 [00:13<00:07, 386.41it/s]
Adding requests:  67%|██████▋   | 5479/8192 [00:13<00:06, 390.02it/s]
Adding requests:  67%|██████▋   | 5520/8192 [00:14<00:06, 393.08it/s]
Adding requests:  68%|██████▊   | 5560/8192 [00:14<00:06, 390.92it/s]
Adding requests:  68%|██████▊   | 5600/8192 [00:14<00:06, 388.65it/s]
Adding requests:  69%|██████▉   | 5641/8192 [00:14<00:06, 394.24it/s]
Adding requests:  69%|██████▉   | 5681/8192 [00:14<00:06, 394.43it/s]
Adding requests:  70%|██████▉   | 5721/8192 [00:14<00:06, 395.67it/s]
Adding requests:  70%|███████   | 5761/8192 [00:14<00:06, 393.71it/s]
Adding requests:  71%|███████   | 5801/8192 [00:14<00:06, 388.56it/s]
Adding requests:  71%|███████▏  | 5841/8192 [00:14<00:06, 391.01it/s]
Adding requests:  72%|███████▏  | 5883/8192 [00:14<00:05, 396.80it/s]
Adding requests:  72%|███████▏  | 5923/8192 [00:15<00:05, 391.06it/s]
Adding requests:  73%|███████▎  | 5963/8192 [00:15<00:05, 387.42it/s]
Adding requests:  73%|███████▎  | 6002/8192 [00:15<00:05, 387.22it/s]
Adding requests:  74%|███████▍  | 6042/8192 [00:15<00:05, 388.93it/s]
Adding requests:  74%|███████▍  | 6081/8192 [00:15<00:05, 379.77it/s]
Adding requests:  75%|███████▍  | 6120/8192 [00:15<00:05, 378.22it/s]
Adding requests:  75%|███████▌  | 6158/8192 [00:15<00:05, 377.62it/s]
Adding requests:  76%|███████▌  | 6197/8192 [00:15<00:05, 379.09it/s]
Adding requests:  76%|███████▌  | 6236/8192 [00:15<00:05, 380.43it/s]
Adding requests:  77%|███████▋  | 6278/8192 [00:16<00:04, 391.33it/s]
Adding requests:  77%|███████▋  | 6318/8192 [00:16<00:04, 393.14it/s]
Adding requests:  78%|███████▊  | 6359/8192 [00:16<00:04, 395.14it/s]
Adding requests:  78%|███████▊  | 6399/8192 [00:16<00:04, 390.68it/s]
Adding requests:  79%|███████▊  | 6443/8192 [00:16<00:04, 403.36it/s]
Adding requests:  79%|███████▉  | 6485/8192 [00:16<00:04, 405.86it/s]
Adding requests:  80%|███████▉  | 6527/8192 [00:16<00:04, 409.67it/s]
Adding requests:  80%|████████  | 6568/8192 [00:16<00:03, 406.47it/s]
Adding requests:  81%|████████  | 6609/8192 [00:16<00:03, 397.73it/s]
Adding requests:  81%|████████  | 6650/8192 [00:16<00:03, 399.82it/s]
Adding requests:  82%|████████▏ | 6691/8192 [00:17<00:03, 399.24it/s]
Adding requests:  82%|████████▏ | 6731/8192 [00:17<00:03, 394.36it/s]
Adding requests:  83%|████████▎ | 6773/8192 [00:17<00:03, 400.81it/s]
Adding requests:  83%|████████▎ | 6814/8192 [00:17<00:03, 403.24it/s]
Adding requests:  84%|████████▎ | 6855/8192 [00:17<00:03, 399.64it/s]
Adding requests:  84%|████████▍ | 6897/8192 [00:17<00:03, 402.26it/s]
Adding requests:  85%|████████▍ | 6938/8192 [00:17<00:03, 402.29it/s]
Adding requests:  85%|████████▌ | 6979/8192 [00:17<00:03, 403.45it/s]
Adding requests:  86%|████████▌ | 7020/8192 [00:17<00:02, 396.23it/s]
Adding requests:  86%|████████▌ | 7061/8192 [00:17<00:02, 398.18it/s]
Adding requests:  87%|████████▋ | 7101/8192 [00:18<00:02, 395.21it/s]
Adding requests:  87%|████████▋ | 7142/8192 [00:18<00:02, 397.29it/s]
Adding requests:  88%|████████▊ | 7183/8192 [00:18<00:02, 399.78it/s]
Adding requests:  88%|████████▊ | 7225/8192 [00:18<00:02, 404.74it/s]
Adding requests:  89%|████████▊ | 7267/8192 [00:18<00:02, 405.81it/s]
Adding requests:  89%|████████▉ | 7309/8192 [00:18<00:02, 409.05it/s]
Adding requests:  90%|████████▉ | 7350/8192 [00:18<00:02, 396.27it/s]
Adding requests:  90%|█████████ | 7390/8192 [00:18<00:02, 391.50it/s]
Adding requests:  91%|█████████ | 7430/8192 [00:18<00:01, 393.72it/s]
Adding requests:  91%|█████████ | 7472/8192 [00:18<00:01, 399.25it/s]
Adding requests:  92%|█████████▏| 7512/8192 [00:19<00:01, 395.66it/s]
Adding requests:  92%|█████████▏| 7553/8192 [00:19<00:01, 396.84it/s]
Adding requests:  93%|█████████▎| 7596/8192 [00:19<00:01, 403.16it/s]
Adding requests:  93%|█████████▎| 7638/8192 [00:19<00:01, 406.91it/s]
Adding requests:  94%|█████████▍| 7680/8192 [00:19<00:01, 408.84it/s]
Adding requests:  94%|█████████▍| 7721/8192 [00:19<00:01, 405.97it/s]
Adding requests:  95%|█████████▍| 7762/8192 [00:19<00:01, 395.17it/s]
Adding requests:  95%|█████████▌| 7803/8192 [00:19<00:00, 398.98it/s]
Adding requests:  96%|█████████▌| 7843/8192 [00:19<00:00, 396.71it/s]
Adding requests:  96%|█████████▌| 7883/8192 [00:20<00:00, 392.86it/s]
Adding requests:  97%|█████████▋| 7923/8192 [00:20<00:00, 392.82it/s]
Adding requests:  97%|█████████▋| 7965/8192 [00:20<00:00, 398.86it/s]
Adding requests:  98%|█████████▊| 8006/8192 [00:20<00:00, 398.54it/s]
Adding requests:  98%|█████████▊| 8047/8192 [00:20<00:00, 400.34it/s]
Adding requests:  99%|█████████▊| 8089/8192 [00:20<00:00, 405.68it/s]
Adding requests:  99%|█████████▉| 8130/8192 [00:20<00:00, 400.43it/s]
Adding requests: 100%|█████████▉| 8171/8192 [00:20<00:00, 393.72it/s]
Adding requests: 100%|██████████| 8192/8192 [00:20<00:00, 394.11it/s]

Processed prompts:   0%|          | 0/8192 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  39%|███▉      | 3226/8192 [00:00<00:00, 11038.70it/s, est. speed input: 11305994.83 toks/s, output: 11038.95 toks/s]
Processed prompts:  53%|█████▎    | 4330/8192 [00:07<00:08, 471.73it/s, est. speed input: 614544.17 toks/s, output: 600.14 toks/s]      
Processed prompts:  59%|█████▊    | 4794/8192 [00:10<00:09, 358.54it/s, est. speed input: 486801.63 toks/s, output: 475.39 toks/s]
Processed prompts:  62%|██████▏   | 5054/8192 [00:11<00:10, 312.75it/s, est. speed input: 441543.36 toks/s, output: 431.19 toks/s]
Processed prompts:  64%|██████▎   | 5218/8192 [00:12<00:10, 278.43it/s, est. speed input: 413379.40 toks/s, output: 403.69 toks/s]
Processed prompts:  65%|██████▌   | 5328/8192 [00:13<00:10, 277.69it/s, est. speed input: 409187.93 toks/s, output: 399.60 toks/s]
Processed prompts:  66%|██████▌   | 5410/8192 [00:14<00:11, 242.76it/s, est. speed input: 391523.50 toks/s, output: 382.35 toks/s]
Processed prompts:  67%|██████▋   | 5469/8192 [00:14<00:11, 231.14it/s, est. speed input: 384886.71 toks/s, output: 375.87 toks/s]
Processed prompts:  68%|██████▊   | 5530/8192 [00:14<00:12, 218.88it/s, est. speed input: 378562.42 toks/s, output: 369.69 toks/s]
Processed prompts:  68%|██████▊   | 5594/8192 [00:15<00:12, 207.95it/s, est. speed input: 372783.57 toks/s, output: 364.05 toks/s]
Processed prompts:  69%|██████▉   | 5658/8192 [00:15<00:12, 198.36it/s, est. speed input: 367463.68 toks/s, output: 358.85 toks/s]
Processed prompts:  70%|██████▉   | 5722/8192 [00:16<00:13, 188.48it/s, est. speed input: 362120.68 toks/s, output: 353.63 toks/s]
Processed prompts:  71%|███████   | 5786/8192 [00:16<00:13, 180.21it/s, est. speed input: 357039.84 toks/s, output: 348.67 toks/s]
Processed prompts:  71%|███████▏  | 5850/8192 [00:17<00:13, 173.58it/s, est. speed input: 352203.44 toks/s, output: 343.95 toks/s]
Processed prompts:  72%|███████▏  | 5914/8192 [00:17<00:13, 169.81it/s, est. speed input: 347840.66 toks/s, output: 339.69 toks/s]
Processed prompts:  73%|███████▎  | 5978/8192 [00:17<00:13, 165.47it/s, est. speed input: 343425.51 toks/s, output: 335.38 toks/s]
Processed prompts:  74%|███████▍  | 6042/8192 [00:18<00:13, 163.08it/s, est. speed input: 339342.02 toks/s, output: 331.39 toks/s]
Processed prompts:  75%|███████▍  | 6106/8192 [00:18<00:12, 160.54it/s, est. speed input: 335311.49 toks/s, output: 327.45 toks/s]
Processed prompts:  75%|███████▌  | 6170/8192 [00:19<00:12, 160.16it/s, est. speed input: 331675.48 toks/s, output: 323.90 toks/s]
Processed prompts:  76%|███████▌  | 6234/8192 [00:19<00:12, 159.00it/s, est. speed input: 328061.16 toks/s, output: 320.37 toks/s]
Processed prompts:  77%|███████▋  | 6298/8192 [00:19<00:12, 157.62it/s, est. speed input: 324515.19 toks/s, output: 316.91 toks/s]
Processed prompts:  78%|███████▊  | 6362/8192 [00:20<00:11, 157.90it/s, est. speed input: 321287.96 toks/s, output: 313.76 toks/s]
Processed prompts:  78%|███████▊  | 6426/8192 [00:20<00:11, 156.05it/s, est. speed input: 317911.60 toks/s, output: 310.46 toks/s]
Processed prompts:  79%|███████▉  | 6490/8192 [00:21<00:10, 156.05it/s, est. speed input: 314839.03 toks/s, output: 307.46 toks/s]
Processed prompts:  80%|████████  | 6554/8192 [00:21<00:10, 156.92it/s, est. speed input: 311994.62 toks/s, output: 304.68 toks/s]
Processed prompts:  81%|████████  | 6618/8192 [00:21<00:10, 156.11it/s, est. speed input: 309079.57 toks/s, output: 301.84 toks/s]
Processed prompts:  82%|████████▏ | 6682/8192 [00:22<00:09, 156.27it/s, est. speed input: 306359.49 toks/s, output: 299.18 toks/s]
Processed prompts:  82%|████████▏ | 6746/8192 [00:22<00:09, 155.82it/s, est. speed input: 303671.20 toks/s, output: 296.55 toks/s]
Processed prompts:  83%|████████▎ | 6810/8192 [00:23<00:08, 156.22it/s, est. speed input: 301161.60 toks/s, output: 294.10 toks/s]
Processed prompts:  84%|████████▍ | 6874/8192 [00:23<00:08, 156.28it/s, est. speed input: 298713.05 toks/s, output: 291.71 toks/s]
Processed prompts:  85%|████████▍ | 6938/8192 [00:23<00:08, 155.80it/s, est. speed input: 296292.07 toks/s, output: 289.35 toks/s]
Processed prompts:  85%|████████▌ | 7002/8192 [00:24<00:07, 156.02it/s, est. speed input: 294012.06 toks/s, output: 287.12 toks/s]
Processed prompts:  86%|████████▋ | 7066/8192 [00:24<00:07, 156.82it/s, est. speed input: 291873.65 toks/s, output: 285.03 toks/s]
Processed prompts:  87%|████████▋ | 7130/8192 [00:25<00:06, 157.31it/s, est. speed input: 289795.48 toks/s, output: 283.00 toks/s]
Processed prompts:  88%|████████▊ | 7194/8192 [00:25<00:06, 156.22it/s, est. speed input: 287644.43 toks/s, output: 280.90 toks/s]
Processed prompts:  89%|████████▊ | 7258/8192 [00:26<00:05, 156.86it/s, est. speed input: 285695.11 toks/s, output: 279.00 toks/s]
Processed prompts:  89%|████████▉ | 7322/8192 [00:26<00:05, 156.72it/s, est. speed input: 283751.00 toks/s, output: 277.10 toks/s]
Processed prompts:  90%|█████████ | 7386/8192 [00:26<00:05, 157.52it/s, est. speed input: 281947.71 toks/s, output: 275.34 toks/s]
Processed prompts:  91%|█████████ | 7450/8192 [00:27<00:04, 156.54it/s, est. speed input: 280060.41 toks/s, output: 273.50 toks/s]
Processed prompts:  92%|█████████▏| 7514/8192 [00:27<00:04, 156.46it/s, est. speed input: 278282.55 toks/s, output: 271.76 toks/s]
Processed prompts:  93%|█████████▎| 7578/8192 [00:28<00:03, 158.01it/s, est. speed input: 276693.16 toks/s, output: 270.21 toks/s]
Processed prompts:  93%|█████████▎| 7642/8192 [00:28<00:03, 156.64it/s, est. speed input: 274943.37 toks/s, output: 268.50 toks/s]
Processed prompts:  94%|█████████▍| 7706/8192 [00:28<00:03, 156.56it/s, est. speed input: 273316.10 toks/s, output: 266.91 toks/s]
Processed prompts:  95%|█████████▍| 7770/8192 [00:29<00:02, 155.82it/s, est. speed input: 271677.85 toks/s, output: 265.31 toks/s]
Processed prompts:  96%|█████████▌| 7834/8192 [00:29<00:02, 155.27it/s, est. speed input: 270083.62 toks/s, output: 263.75 toks/s]
Processed prompts:  96%|█████████▋| 7898/8192 [00:30<00:01, 155.60it/s, est. speed input: 268588.79 toks/s, output: 262.29 toks/s]
Processed prompts:  97%|█████████▋| 7962/8192 [00:30<00:01, 155.17it/s, est. speed input: 267082.95 toks/s, output: 260.82 toks/s]
Processed prompts:  98%|█████████▊| 8026/8192 [00:30<00:01, 155.52it/s, est. speed input: 265667.20 toks/s, output: 259.44 toks/s]
Processed prompts:  99%|█████████▉| 8090/8192 [00:31<00:00, 156.36it/s, est. speed input: 264332.85 toks/s, output: 258.14 toks/s]
Processed prompts: 100%|█████████▉| 8154/8192 [00:31<00:00, 177.90it/s, est. speed input: 264364.45 toks/s, output: 258.17 toks/s]
Processed prompts: 100%|██████████| 8192/8192 [00:31<00:00, 177.90it/s, est. speed input: 265591.10 toks/s, output: 259.37 toks/s]
Processed prompts: 100%|██████████| 8192/8192 [00:31<00:00, 259.37it/s, est. speed input: 265591.10 toks/s, output: 259.37 toks/s]
[rank0]:[W125 17:07:05.103226625 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=512 ==========
Time: 2026-01-25 17:52:26
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_4
Params: prompt_len=512, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_4 --dataset-name random --input-len 512 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 513 --max-num-batched-tokens 513 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/Llama3.2-3B-INT8_M512.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 17:52:34 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=271672) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=271672) WARNING 01-25 17:55:48 [backends.py:609] Failed to read file <frozen os>
Throughput: 20.68 requests/s, 10607.98 total tokens/s, 20.68 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128

STDERR:
[2026-01-25 17:52:34] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:52:34] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 17:52:34] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 17:52:34] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:52:34] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:52:34] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:52:34] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:52:34] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:52:34] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 17:52:34] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:52:34] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:52:34] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:52:34] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:52:34] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 17:52:41] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:52:41] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 17:52:41] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 17:52:41] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:52:41] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:52:41] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:52:41] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:52:41] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:52:41] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 17:52:41] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:52:41] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:52:41] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:52:41] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:52:41] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=271672) [2026-01-25 17:52:42] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=271672) [2026-01-25 17:52:42] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=271672) [2026-01-25 17:52:42] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=271672) [2026-01-25 17:52:42] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=271672) [2026-01-25 17:52:42] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-3B-INT8
(EngineCore_DP0 pid=271672) [2026-01-25 17:52:42] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=271672) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=271672) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [02:57<00:00, 177.46s/it]
(EngineCore_DP0 pid=271672) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [02:57<00:00, 177.46s/it]
(EngineCore_DP0 pid=271672) 
(EngineCore_DP0 pid=271672) [2026-01-25 17:55:40] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 3072] -> 1D uint8
(EngineCore_DP0 pid=271672) [2026-01-25 17:55:40] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 11796480 bytes
(EngineCore_DP0 pid=271672) [2026-01-25 17:55:40] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 3072] -> 1D uint8
(EngineCore_DP0 pid=271672) [2026-01-25 17:55:40] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7077888 bytes
(EngineCore_DP0 pid=271672) [2026-01-25 17:55:40] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 3072] -> 1D uint8
(EngineCore_DP0 pid=271672) [2026-01-25 17:55:40] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 37748736 bytes
(EngineCore_DP0 pid=271672) [2026-01-25 17:55:40] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 8192] -> 1D uint8
(EngineCore_DP0 pid=271672) [2026-01-25 17:55:40] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 18874368 bytes
(EngineCore_DP0 pid=271672) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  1.95it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:01<00:00,  1.78it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:01<00:00,  1.80it/s]
(EngineCore_DP0 pid=271672) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  9.96it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  9.94it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  53%|█████▎    | 68/128 [00:00<00:00, 675.06it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 682.90it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:31,  4.05it/s, est. speed input: 2072.69 toks/s, output: 4.05 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:10, 11.76it/s, est. speed input: 5267.71 toks/s, output: 10.29 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:07, 15.60it/s, est. speed input: 6803.99 toks/s, output: 13.29 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:00<00:06, 17.81it/s, est. speed input: 7708.78 toks/s, output: 15.06 toks/s]
Processed prompts:  10%|█         | 13/128 [00:00<00:05, 19.31it/s, est. speed input: 8336.72 toks/s, output: 16.28 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:00<00:05, 20.22it/s, est. speed input: 8771.58 toks/s, output: 17.13 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:01<00:05, 20.95it/s, est. speed input: 9117.32 toks/s, output: 17.81 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:01<00:05, 20.80it/s, est. speed input: 9284.39 toks/s, output: 18.13 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:01<00:04, 21.16it/s, est. speed input: 9482.51 toks/s, output: 18.52 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:01<00:04, 21.62it/s, est. speed input: 9674.43 toks/s, output: 18.90 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:01<00:04, 21.79it/s, est. speed input: 9815.00 toks/s, output: 19.17 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:01<00:04, 21.84it/s, est. speed input: 9926.64 toks/s, output: 19.39 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:01<00:04, 22.07it/s, est. speed input: 10042.69 toks/s, output: 19.61 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:02<00:04, 21.94it/s, est. speed input: 10113.91 toks/s, output: 19.75 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:02<00:03, 22.07it/s, est. speed input: 10197.59 toks/s, output: 19.92 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:02<00:03, 22.10it/s, est. speed input: 10264.94 toks/s, output: 20.05 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:02<00:03, 22.31it/s, est. speed input: 10342.33 toks/s, output: 20.20 toks/s]
Processed prompts:  41%|████      | 52/128 [00:02<00:03, 22.21it/s, est. speed input: 10390.87 toks/s, output: 20.29 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:02<00:03, 21.69it/s, est. speed input: 10398.40 toks/s, output: 20.31 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:02<00:03, 21.96it/s, est. speed input: 10453.30 toks/s, output: 20.42 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:02<00:03, 21.95it/s, est. speed input: 10488.91 toks/s, output: 20.49 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:03<00:02, 22.23it/s, est. speed input: 10540.91 toks/s, output: 20.59 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:03<00:02, 22.03it/s, est. speed input: 10562.56 toks/s, output: 20.63 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:03<00:02, 22.21it/s, est. speed input: 10603.11 toks/s, output: 20.71 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:03<00:02, 22.17it/s, est. speed input: 10630.28 toks/s, output: 20.76 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:03<00:02, 22.13it/s, est. speed input: 10654.71 toks/s, output: 20.81 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:03<00:02, 22.25it/s, est. speed input: 10685.69 toks/s, output: 20.87 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:03<00:02, 21.97it/s, est. speed input: 10694.30 toks/s, output: 20.89 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:04<00:01, 22.12it/s, est. speed input: 10721.33 toks/s, output: 20.94 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:04<00:01, 22.20it/s, est. speed input: 10744.93 toks/s, output: 20.99 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:04<00:01, 22.27it/s, est. speed input: 10767.71 toks/s, output: 21.03 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:04<00:01, 22.29it/s, est. speed input: 10787.72 toks/s, output: 21.07 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:04<00:01, 22.31it/s, est. speed input: 10807.26 toks/s, output: 21.11 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:04<00:01, 22.36it/s, est. speed input: 10826.97 toks/s, output: 21.15 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:04<00:01, 22.43it/s, est. speed input: 10847.12 toks/s, output: 21.19 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:04<00:00, 22.54it/s, est. speed input: 10868.99 toks/s, output: 21.23 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:05<00:00, 22.65it/s, est. speed input: 10890.91 toks/s, output: 21.27 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:05<00:00, 22.37it/s, est. speed input: 10897.50 toks/s, output: 21.28 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:05<00:00, 21.99it/s, est. speed input: 10895.68 toks/s, output: 21.28 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:05<00:00, 22.05it/s, est. speed input: 10907.10 toks/s, output: 21.30 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:05<00:00, 22.19it/s, est. speed input: 10921.87 toks/s, output: 21.33 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:05<00:00, 21.93it/s, est. speed input: 10921.93 toks/s, output: 21.33 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:05<00:00, 21.65it/s, est. speed input: 10918.24 toks/s, output: 21.32 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:06<00:00, 21.65it/s, est. speed input: 10920.22 toks/s, output: 21.33 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:06<00:00, 21.33it/s, est. speed input: 10920.22 toks/s, output: 21.33 toks/s]
[rank0]:[W125 17:56:13.968858455 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=1024 ==========
Time: 2026-01-25 17:56:15
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 1025 --max-num-batched-tokens 1025 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/Llama3.2-3B-INT8_M1024.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 17:56:23 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=275182) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=275182) WARNING 01-25 17:56:41 [backends.py:609] Failed to read file <frozen os>
Throughput: 20.47 requests/s, 20980.87 total tokens/s, 20.47 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128

STDERR:
[2026-01-25 17:56:23] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:56:23] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 17:56:23] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 17:56:23] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:56:23] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:56:23] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:56:23] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:56:23] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:56:23] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 17:56:23] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:56:23] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:56:23] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:56:23] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:56:23] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 17:56:31] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:56:31] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 17:56:31] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 17:56:31] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:56:31] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:56:31] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:56:31] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:56:31] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:56:31] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 17:56:31] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:56:31] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:56:31] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:56:31] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:56:31] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=275182) [2026-01-25 17:56:32] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=275182) [2026-01-25 17:56:32] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=275182) [2026-01-25 17:56:32] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=275182) [2026-01-25 17:56:32] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=275182) [2026-01-25 17:56:32] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-3B-INT8
(EngineCore_DP0 pid=275182) [2026-01-25 17:56:32] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=275182) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=275182) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.30it/s]
(EngineCore_DP0 pid=275182) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.30it/s]
(EngineCore_DP0 pid=275182) 
(EngineCore_DP0 pid=275182) [2026-01-25 17:56:33] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 3072] -> 1D uint8
(EngineCore_DP0 pid=275182) [2026-01-25 17:56:33] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 11796480 bytes
(EngineCore_DP0 pid=275182) [2026-01-25 17:56:33] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 3072] -> 1D uint8
(EngineCore_DP0 pid=275182) [2026-01-25 17:56:33] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7077888 bytes
(EngineCore_DP0 pid=275182) [2026-01-25 17:56:33] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 3072] -> 1D uint8
(EngineCore_DP0 pid=275182) [2026-01-25 17:56:33] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 37748736 bytes
(EngineCore_DP0 pid=275182) [2026-01-25 17:56:33] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 8192] -> 1D uint8
(EngineCore_DP0 pid=275182) [2026-01-25 17:56:33] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 18874368 bytes
(EngineCore_DP0 pid=275182) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00, 10.78it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00, 10.78it/s]
(EngineCore_DP0 pid=275182) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00, 10.23it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  29%|██▉       | 37/128 [00:00<00:00, 365.28it/s]
Adding requests:  59%|█████▉    | 76/128 [00:00<00:00, 374.01it/s]
Adding requests:  89%|████████▉ | 114/128 [00:00<00:00, 372.63it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 372.38it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:03, 40.89it/s, est. speed input: 41879.81 toks/s, output: 40.89 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:00<00:04, 25.53it/s, est. speed input: 27709.97 toks/s, output: 27.06 toks/s]
Processed prompts:  10%|█         | 13/128 [00:00<00:04, 23.60it/s, est. speed input: 25808.74 toks/s, output: 25.20 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:00<00:05, 22.10it/s, est. speed input: 24470.58 toks/s, output: 23.90 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:00<00:05, 21.76it/s, est. speed input: 23958.28 toks/s, output: 23.40 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:00<00:04, 21.58it/s, est. speed input: 23624.17 toks/s, output: 23.07 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:01<00:04, 21.57it/s, est. speed input: 23427.25 toks/s, output: 22.88 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:01<00:04, 21.39it/s, est. speed input: 23202.30 toks/s, output: 22.66 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:01<00:04, 21.51it/s, est. speed input: 23114.51 toks/s, output: 22.57 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:01<00:04, 21.63it/s, est. speed input: 23053.90 toks/s, output: 22.51 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:01<00:04, 21.64it/s, est. speed input: 22978.37 toks/s, output: 22.44 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:01<00:04, 21.60it/s, est. speed input: 22905.35 toks/s, output: 22.37 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:01<00:03, 21.46it/s, est. speed input: 22813.08 toks/s, output: 22.28 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:02<00:03, 21.54it/s, est. speed input: 22774.60 toks/s, output: 22.24 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:02<00:03, 21.55it/s, est. speed input: 22731.40 toks/s, output: 22.20 toks/s]
Processed prompts:  41%|████      | 52/128 [00:02<00:03, 21.60it/s, est. speed input: 22703.18 toks/s, output: 22.17 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:02<00:03, 21.75it/s, est. speed input: 22698.66 toks/s, output: 22.17 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:02<00:03, 21.51it/s, est. speed input: 22631.74 toks/s, output: 22.10 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:02<00:03, 21.24it/s, est. speed input: 22553.59 toks/s, output: 22.02 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:02<00:02, 21.34it/s, est. speed input: 22530.90 toks/s, output: 22.00 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:03<00:02, 21.14it/s, est. speed input: 22466.89 toks/s, output: 21.94 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:03<00:02, 21.09it/s, est. speed input: 22423.39 toks/s, output: 21.90 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:03<00:02, 21.27it/s, est. speed input: 22414.29 toks/s, output: 21.89 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:03<00:02, 21.43it/s, est. speed input: 22412.04 toks/s, output: 21.89 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:03<00:02, 21.40it/s, est. speed input: 22389.96 toks/s, output: 21.87 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:03<00:02, 21.21it/s, est. speed input: 22347.08 toks/s, output: 21.82 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:03<00:02, 21.38it/s, est. speed input: 22346.05 toks/s, output: 21.82 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:04<00:01, 21.40it/s, est. speed input: 22332.85 toks/s, output: 21.81 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:04<00:01, 21.47it/s, est. speed input: 22326.78 toks/s, output: 21.80 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:04<00:01, 21.55it/s, est. speed input: 22324.21 toks/s, output: 21.80 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:04<00:01, 21.63it/s, est. speed input: 22325.12 toks/s, output: 21.80 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:04<00:01, 21.72it/s, est. speed input: 22328.55 toks/s, output: 21.81 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:04<00:01, 21.37it/s, est. speed input: 22290.47 toks/s, output: 21.77 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:04<00:01, 21.02it/s, est. speed input: 22243.02 toks/s, output: 21.72 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:05<00:00, 21.15it/s, est. speed input: 22235.75 toks/s, output: 21.71 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:05<00:00, 21.41it/s, est. speed input: 22245.07 toks/s, output: 21.72 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:05<00:00, 20.83it/s, est. speed input: 22181.56 toks/s, output: 21.66 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:05<00:00, 21.15it/s, est. speed input: 22188.89 toks/s, output: 21.67 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:05<00:00, 21.40it/s, est. speed input: 22196.99 toks/s, output: 21.68 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:05<00:00, 21.53it/s, est. speed input: 22201.42 toks/s, output: 21.68 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:05<00:00, 21.55it/s, est. speed input: 22199.30 toks/s, output: 21.68 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:05<00:00, 21.55it/s, est. speed input: 22184.11 toks/s, output: 21.66 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:05<00:00, 21.66it/s, est. speed input: 22184.11 toks/s, output: 21.66 toks/s]
[rank0]:[W125 17:57:04.895247236 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=2048 ==========
Time: 2026-01-25 17:57:06
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=256, max_num_seqs=2
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 256 --max-num-seqs 2 --max-model-len 1025 --max-num-batched-tokens 2048 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/Llama3.2-3B-INT8_M2048.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 17:57:15 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=276150) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=276150) WARNING 01-25 17:57:32 [backends.py:609] Failed to read file <frozen os>
Throughput: 41.70 requests/s, 42737.38 total tokens/s, 41.70 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256

STDERR:
[2026-01-25 17:57:15] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:57:15] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 17:57:15] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 17:57:15] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:57:15] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:57:15] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:57:15] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:57:15] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:57:15] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 17:57:15] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:57:15] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:57:15] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:57:15] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:57:15] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 17:57:22] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:57:22] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 17:57:22] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 17:57:22] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:57:22] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:57:22] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:57:22] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:57:22] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:57:22] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 17:57:22] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:57:22] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:57:22] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:57:22] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:57:22] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=276150) [2026-01-25 17:57:23] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=276150) [2026-01-25 17:57:23] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=276150) [2026-01-25 17:57:23] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=276150) [2026-01-25 17:57:23] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=276150) [2026-01-25 17:57:23] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-3B-INT8
(EngineCore_DP0 pid=276150) [2026-01-25 17:57:23] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=276150) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=276150) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.27it/s]
(EngineCore_DP0 pid=276150) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.27it/s]
(EngineCore_DP0 pid=276150) 
(EngineCore_DP0 pid=276150) [2026-01-25 17:57:24] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 3072] -> 1D uint8
(EngineCore_DP0 pid=276150) [2026-01-25 17:57:24] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 11796480 bytes
(EngineCore_DP0 pid=276150) [2026-01-25 17:57:24] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 3072] -> 1D uint8
(EngineCore_DP0 pid=276150) [2026-01-25 17:57:24] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7077888 bytes
(EngineCore_DP0 pid=276150) [2026-01-25 17:57:24] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 3072] -> 1D uint8
(EngineCore_DP0 pid=276150) [2026-01-25 17:57:24] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 37748736 bytes
(EngineCore_DP0 pid=276150) [2026-01-25 17:57:24] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 8192] -> 1D uint8
(EngineCore_DP0 pid=276150) [2026-01-25 17:57:24] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 18874368 bytes
(EngineCore_DP0 pid=276150) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  67%|██████▋   | 2/3 [00:00<00:00, 10.58it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00, 10.35it/s]
(EngineCore_DP0 pid=276150) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 1/2 [00:00<00:00,  9.23it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00, 10.37it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  16%|█▌        | 40/256 [00:00<00:00, 393.37it/s]
Adding requests:  32%|███▏      | 82/256 [00:00<00:00, 404.68it/s]
Adding requests:  48%|████▊     | 123/256 [00:00<00:00, 388.15it/s]
Adding requests:  63%|██████▎   | 162/256 [00:00<00:00, 378.29it/s]
Adding requests:  78%|███████▊  | 200/256 [00:00<00:00, 368.30it/s]
Adding requests:  93%|█████████▎| 239/256 [00:00<00:00, 375.20it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 379.91it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  10%|█         | 26/256 [00:00<00:01, 212.32it/s, est. speed input: 217447.22 toks/s, output: 212.33 toks/s]
Processed prompts:  19%|█▉        | 48/256 [00:00<00:03, 67.83it/s, est. speed input: 78102.06 toks/s, output: 76.27 toks/s]   
Processed prompts:  23%|██▎       | 60/256 [00:00<00:03, 57.49it/s, est. speed input: 67319.25 toks/s, output: 65.74 toks/s]
Processed prompts:  27%|██▋       | 69/256 [00:01<00:03, 55.21it/s, est. speed input: 64469.85 toks/s, output: 62.96 toks/s]
Processed prompts:  30%|██▉       | 76/256 [00:01<00:03, 50.56it/s, est. speed input: 60911.21 toks/s, output: 59.48 toks/s]
Processed prompts:  32%|███▏      | 82/256 [00:01<00:03, 48.69it/s, est. speed input: 59197.35 toks/s, output: 57.81 toks/s]
Processed prompts:  34%|███▍      | 88/256 [00:01<00:03, 47.54it/s, est. speed input: 57960.53 toks/s, output: 56.60 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:01<00:03, 46.62it/s, est. speed input: 56920.19 toks/s, output: 55.59 toks/s]
Processed prompts:  39%|███▉      | 100/256 [00:01<00:03, 45.76it/s, est. speed input: 55984.61 toks/s, output: 54.67 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:01<00:03, 44.92it/s, est. speed input: 55119.40 toks/s, output: 53.83 toks/s]
Processed prompts:  44%|████▍     | 112/256 [00:02<00:03, 44.51it/s, est. speed input: 54424.49 toks/s, output: 53.15 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:02<00:03, 43.37it/s, est. speed input: 53594.95 toks/s, output: 52.34 toks/s]
Processed prompts:  48%|████▊     | 124/256 [00:02<00:03, 43.29it/s, est. speed input: 53044.87 toks/s, output: 51.80 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:02<00:02, 43.44it/s, est. speed input: 52602.81 toks/s, output: 51.37 toks/s]
Processed prompts:  53%|█████▎    | 136/256 [00:02<00:02, 43.52it/s, est. speed input: 52198.45 toks/s, output: 50.97 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:02<00:02, 43.63it/s, est. speed input: 51845.45 toks/s, output: 50.63 toks/s]
Processed prompts:  57%|█████▋    | 147/256 [00:02<00:02, 44.96it/s, est. speed input: 51794.53 toks/s, output: 50.58 toks/s]
Processed prompts:  59%|█████▉    | 152/256 [00:03<00:02, 42.10it/s, est. speed input: 51111.32 toks/s, output: 49.91 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:03<00:02, 42.68it/s, est. speed input: 50850.06 toks/s, output: 49.66 toks/s]
Processed prompts:  64%|██████▍   | 164/256 [00:03<00:02, 42.83it/s, est. speed input: 50572.26 toks/s, output: 49.39 toks/s]
Processed prompts:  66%|██████▋   | 170/256 [00:03<00:01, 43.28it/s, est. speed input: 50370.29 toks/s, output: 49.19 toks/s]
Processed prompts:  69%|██████▉   | 176/256 [00:03<00:01, 43.28it/s, est. speed input: 50135.61 toks/s, output: 48.96 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:03<00:01, 43.14it/s, est. speed input: 49900.26 toks/s, output: 48.73 toks/s]
Processed prompts:  73%|███████▎  | 188/256 [00:03<00:01, 43.00it/s, est. speed input: 49675.07 toks/s, output: 48.51 toks/s]
Processed prompts:  76%|███████▌  | 194/256 [00:04<00:01, 42.83it/s, est. speed input: 49457.04 toks/s, output: 48.30 toks/s]
Processed prompts:  78%|███████▊  | 200/256 [00:04<00:01, 43.15it/s, est. speed input: 49308.69 toks/s, output: 48.15 toks/s]
Processed prompts:  80%|████████  | 206/256 [00:04<00:01, 43.30it/s, est. speed input: 49160.78 toks/s, output: 48.01 toks/s]
Processed prompts:  83%|████████▎ | 212/256 [00:04<00:01, 43.46it/s, est. speed input: 49028.98 toks/s, output: 47.88 toks/s]
Processed prompts:  85%|████████▌ | 218/256 [00:04<00:00, 43.52it/s, est. speed input: 48898.48 toks/s, output: 47.75 toks/s]
Processed prompts:  88%|████████▊ | 224/256 [00:04<00:00, 42.86it/s, est. speed input: 48698.16 toks/s, output: 47.56 toks/s]
Processed prompts:  90%|████████▉ | 230/256 [00:04<00:00, 43.25it/s, est. speed input: 48602.15 toks/s, output: 47.46 toks/s]
Processed prompts:  92%|█████████▏| 236/256 [00:04<00:00, 42.40it/s, est. speed input: 48391.55 toks/s, output: 47.26 toks/s]
Processed prompts:  95%|█████████▍| 242/256 [00:05<00:00, 42.50it/s, est. speed input: 48265.04 toks/s, output: 47.13 toks/s]
Processed prompts:  97%|█████████▋| 248/256 [00:05<00:00, 42.94it/s, est. speed input: 48181.77 toks/s, output: 47.05 toks/s]
Processed prompts:  99%|█████████▉| 254/256 [00:05<00:00, 42.33it/s, est. speed input: 48013.69 toks/s, output: 46.89 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:05<00:00, 42.33it/s, est. speed input: 47970.66 toks/s, output: 46.85 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:05<00:00, 46.84it/s, est. speed input: 47970.66 toks/s, output: 46.85 toks/s]
[rank0]:[W125 17:57:56.749687421 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=4096 ==========
Time: 2026-01-25 17:57:58
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=512, max_num_seqs=4
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 512 --max-num-seqs 4 --max-model-len 1025 --max-num-batched-tokens 4096 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/Llama3.2-3B-INT8_M4096.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 17:58:08 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=277121) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=277121) WARNING 01-25 17:58:25 [backends.py:609] Failed to read file <frozen os>
Throughput: 63.54 requests/s, 65128.30 total tokens/s, 63.54 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512

STDERR:
[2026-01-25 17:58:08] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:58:08] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 17:58:08] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 17:58:08] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:58:08] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:58:08] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:58:08] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:58:08] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:58:08] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 17:58:08] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:58:08] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:58:08] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:58:08] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:58:08] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 17:58:15] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:58:15] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 17:58:15] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 17:58:15] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:58:15] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:58:15] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:58:15] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:58:15] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:58:15] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 17:58:15] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:58:15] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:58:15] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:58:15] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:58:15] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=277121) [2026-01-25 17:58:16] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=277121) [2026-01-25 17:58:16] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=277121) [2026-01-25 17:58:16] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=277121) [2026-01-25 17:58:16] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=277121) [2026-01-25 17:58:16] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-3B-INT8
(EngineCore_DP0 pid=277121) [2026-01-25 17:58:16] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=277121) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=277121) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.37it/s]
(EngineCore_DP0 pid=277121) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.37it/s]
(EngineCore_DP0 pid=277121) 
(EngineCore_DP0 pid=277121) [2026-01-25 17:58:17] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 3072] -> 1D uint8
(EngineCore_DP0 pid=277121) [2026-01-25 17:58:17] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 11796480 bytes
(EngineCore_DP0 pid=277121) [2026-01-25 17:58:17] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 3072] -> 1D uint8
(EngineCore_DP0 pid=277121) [2026-01-25 17:58:17] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7077888 bytes
(EngineCore_DP0 pid=277121) [2026-01-25 17:58:17] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 3072] -> 1D uint8
(EngineCore_DP0 pid=277121) [2026-01-25 17:58:17] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 37748736 bytes
(EngineCore_DP0 pid=277121) [2026-01-25 17:58:17] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 8192] -> 1D uint8
(EngineCore_DP0 pid=277121) [2026-01-25 17:58:17] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 18874368 bytes
(EngineCore_DP0 pid=277121) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 2/4 [00:00<00:00, 10.87it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00, 10.47it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00, 10.52it/s]
(EngineCore_DP0 pid=277121) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  67%|██████▋   | 2/3 [00:00<00:00, 11.03it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00, 11.33it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   7%|▋         | 37/512 [00:00<00:01, 368.45it/s]
Adding requests:  15%|█▌        | 77/512 [00:00<00:01, 383.68it/s]
Adding requests:  23%|██▎       | 116/512 [00:00<00:01, 379.52it/s]
Adding requests:  30%|███       | 154/512 [00:00<00:00, 378.02it/s]
Adding requests:  38%|███▊      | 192/512 [00:00<00:00, 373.66it/s]
Adding requests:  46%|████▌     | 233/512 [00:00<00:00, 384.26it/s]
Adding requests:  53%|█████▎    | 272/512 [00:00<00:00, 380.99it/s]
Adding requests:  61%|██████    | 311/512 [00:00<00:00, 372.62it/s]
Adding requests:  68%|██████▊   | 350/512 [00:00<00:00, 375.51it/s]
Adding requests:  76%|███████▌  | 389/512 [00:01<00:00, 378.79it/s]
Adding requests:  83%|████████▎ | 427/512 [00:01<00:00, 377.79it/s]
Adding requests:  91%|█████████ | 465/512 [00:01<00:00, 377.48it/s]
Adding requests:  99%|█████████▊| 505/512 [00:01<00:00, 381.50it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 379.07it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  17%|█▋        | 86/512 [00:00<00:00, 752.85it/s, est. speed input: 771187.49 toks/s, output: 752.88 toks/s]
Processed prompts:  32%|███▏      | 162/512 [00:01<00:03, 107.62it/s, est. speed input: 127621.84 toks/s, output: 124.63 toks/s]
Processed prompts:  38%|███▊      | 197/512 [00:01<00:03, 94.03it/s, est. speed input: 112063.60 toks/s, output: 109.44 toks/s] 
Processed prompts:  43%|████▎     | 220/512 [00:02<00:03, 84.91it/s, est. speed input: 103564.83 toks/s, output: 101.14 toks/s]
Processed prompts:  46%|████▌     | 236/512 [00:02<00:03, 80.52it/s, est. speed input: 99641.75 toks/s, output: 97.31 toks/s]  
Processed prompts:  49%|████▊     | 249/512 [00:02<00:03, 78.46it/s, est. speed input: 97586.13 toks/s, output: 95.30 toks/s]
Processed prompts:  51%|█████     | 260/512 [00:02<00:03, 74.37it/s, est. speed input: 95080.14 toks/s, output: 92.85 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:02<00:03, 69.62it/s, est. speed input: 92566.71 toks/s, output: 90.40 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:03<00:03, 68.70it/s, est. speed input: 91507.34 toks/s, output: 89.36 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:03<00:03, 67.87it/s, est. speed input: 90534.67 toks/s, output: 88.41 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:03<00:03, 66.91it/s, est. speed input: 89586.95 toks/s, output: 87.49 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:03<00:03, 66.17it/s, est. speed input: 88716.92 toks/s, output: 86.64 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:03<00:03, 65.61it/s, est. speed input: 87915.90 toks/s, output: 85.85 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:03<00:02, 65.19it/s, est. speed input: 87169.49 toks/s, output: 85.13 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:03<00:02, 64.84it/s, est. speed input: 86465.67 toks/s, output: 84.44 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:03<00:02, 64.54it/s, est. speed input: 85799.81 toks/s, output: 83.79 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:04<00:02, 65.63it/s, est. speed input: 85355.10 toks/s, output: 83.35 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:04<00:02, 65.25it/s, est. speed input: 84782.26 toks/s, output: 82.79 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:04<00:02, 64.87it/s, est. speed input: 84228.29 toks/s, output: 82.25 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:04<00:02, 64.56it/s, est. speed input: 83699.97 toks/s, output: 81.74 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [00:04<00:02, 64.32it/s, est. speed input: 83198.30 toks/s, output: 81.25 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [00:04<00:02, 64.22it/s, est. speed input: 82731.27 toks/s, output: 80.79 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [00:04<00:01, 64.17it/s, est. speed input: 82289.37 toks/s, output: 80.36 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [00:04<00:01, 64.15it/s, est. speed input: 81872.20 toks/s, output: 79.95 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [00:05<00:01, 64.02it/s, est. speed input: 81463.56 toks/s, output: 79.55 toks/s]
Processed prompts:  81%|████████  | 414/512 [00:05<00:01, 64.17it/s, est. speed input: 81098.53 toks/s, output: 79.20 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [00:05<00:01, 64.22it/s, est. speed input: 80744.83 toks/s, output: 78.85 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [00:05<00:01, 64.21it/s, est. speed input: 80403.13 toks/s, output: 78.52 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [00:05<00:01, 64.10it/s, est. speed input: 80067.18 toks/s, output: 78.19 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [00:05<00:01, 63.82it/s, est. speed input: 79726.84 toks/s, output: 77.86 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [00:05<00:00, 65.63it/s, est. speed input: 79576.19 toks/s, output: 77.71 toks/s]
Processed prompts:  90%|█████████ | 462/512 [00:05<00:00, 64.88it/s, est. speed input: 79260.45 toks/s, output: 77.40 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [00:06<00:00, 64.59it/s, est. speed input: 78977.52 toks/s, output: 77.13 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [00:06<00:00, 64.46it/s, est. speed input: 78711.29 toks/s, output: 76.87 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [00:06<00:00, 64.41it/s, est. speed input: 78458.68 toks/s, output: 76.62 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [00:06<00:00, 64.34it/s, est. speed input: 78212.92 toks/s, output: 76.38 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [00:06<00:00, 64.17it/s, est. speed input: 77967.49 toks/s, output: 76.14 toks/s]
Processed prompts: 100%|█████████▉| 510/512 [00:06<00:00, 66.06it/s, est. speed input: 77878.00 toks/s, output: 76.05 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:06<00:00, 66.06it/s, est. speed input: 78181.71 toks/s, output: 76.35 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:06<00:00, 76.35it/s, est. speed input: 78181.71 toks/s, output: 76.35 toks/s]
[rank0]:[W125 17:58:51.215606878 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=8192 ==========
Time: 2026-01-25 17:58:53
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=1024, max_num_seqs=8
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 1024 --max-num-seqs 8 --max-model-len 1025 --max-num-batched-tokens 8192 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/Llama3.2-3B-INT8_M8192.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 17:59:06 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=278155) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=278155) WARNING 01-25 17:59:23 [backends.py:609] Failed to read file <frozen os>
Throughput: 65.39 requests/s, 67025.31 total tokens/s, 65.39 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024

STDERR:
[2026-01-25 17:59:06] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:59:06] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 17:59:06] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 17:59:06] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:59:06] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:59:06] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:59:06] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:59:06] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:59:06] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 17:59:06] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:59:06] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:59:06] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:59:06] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:59:06] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 17:59:13] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 17:59:13] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 17:59:13] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 17:59:13] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:59:13] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:59:13] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:59:13] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:59:13] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 17:59:13] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 17:59:13] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 17:59:13] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 17:59:13] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 17:59:13] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 17:59:13] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=278155) [2026-01-25 17:59:14] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=278155) [2026-01-25 17:59:14] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=278155) [2026-01-25 17:59:14] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=278155) [2026-01-25 17:59:14] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=278155) [2026-01-25 17:59:14] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-3B-INT8
(EngineCore_DP0 pid=278155) [2026-01-25 17:59:14] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=278155) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=278155) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.29it/s]
(EngineCore_DP0 pid=278155) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.29it/s]
(EngineCore_DP0 pid=278155) 
(EngineCore_DP0 pid=278155) [2026-01-25 17:59:15] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 3072] -> 1D uint8
(EngineCore_DP0 pid=278155) [2026-01-25 17:59:15] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 11796480 bytes
(EngineCore_DP0 pid=278155) [2026-01-25 17:59:15] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 3072] -> 1D uint8
(EngineCore_DP0 pid=278155) [2026-01-25 17:59:15] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7077888 bytes
(EngineCore_DP0 pid=278155) [2026-01-25 17:59:15] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 3072] -> 1D uint8
(EngineCore_DP0 pid=278155) [2026-01-25 17:59:15] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 37748736 bytes
(EngineCore_DP0 pid=278155) [2026-01-25 17:59:15] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 8192] -> 1D uint8
(EngineCore_DP0 pid=278155) [2026-01-25 17:59:15] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 18874368 bytes
(EngineCore_DP0 pid=278155) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:00,  5.36it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  60%|██████    | 3/5 [00:00<00:00,  8.44it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00,  9.38it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00,  8.82it/s]
(EngineCore_DP0 pid=278155) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:00,  9.72it/s]
Capturing CUDA graphs (decode, FULL):  75%|███████▌  | 3/4 [00:00<00:00, 11.24it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00, 11.28it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   3%|▎         | 35/1024 [00:00<00:02, 347.21it/s]
Adding requests:   7%|▋         | 74/1024 [00:00<00:02, 370.91it/s]
Adding requests:  11%|█         | 112/1024 [00:00<00:02, 371.73it/s]
Adding requests:  15%|█▍        | 150/1024 [00:00<00:02, 361.61it/s]
Adding requests:  18%|█▊        | 187/1024 [00:00<00:02, 364.00it/s]
Adding requests:  22%|██▏       | 225/1024 [00:00<00:02, 368.64it/s]
Adding requests:  26%|██▌       | 263/1024 [00:00<00:02, 370.99it/s]
Adding requests:  29%|██▉       | 301/1024 [00:00<00:01, 369.18it/s]
Adding requests:  33%|███▎      | 341/1024 [00:00<00:01, 378.28it/s]
Adding requests:  37%|███▋      | 383/1024 [00:01<00:01, 387.56it/s]
Adding requests:  42%|████▏     | 425/1024 [00:01<00:01, 395.46it/s]
Adding requests:  46%|████▌     | 466/1024 [00:01<00:01, 398.71it/s]
Adding requests:  49%|████▉     | 506/1024 [00:01<00:01, 396.26it/s]
Adding requests:  53%|█████▎    | 546/1024 [00:01<00:01, 379.06it/s]
Adding requests:  57%|█████▋    | 585/1024 [00:01<00:01, 381.49it/s]
Adding requests:  61%|██████    | 624/1024 [00:01<00:01, 383.89it/s]
Adding requests:  65%|██████▍   | 663/1024 [00:01<00:00, 382.94it/s]
Adding requests:  69%|██████▊   | 703/1024 [00:01<00:00, 385.49it/s]
Adding requests:  72%|███████▏  | 742/1024 [00:01<00:00, 380.08it/s]
Adding requests:  76%|███████▋  | 781/1024 [00:02<00:00, 382.63it/s]
Adding requests:  80%|████████  | 821/1024 [00:02<00:00, 386.27it/s]
Adding requests:  84%|████████▍ | 862/1024 [00:02<00:00, 390.75it/s]
Adding requests:  88%|████████▊ | 902/1024 [00:02<00:00, 389.85it/s]
Adding requests:  92%|█████████▏| 941/1024 [00:02<00:00, 386.42it/s]
Adding requests:  96%|█████████▌| 980/1024 [00:02<00:00, 387.21it/s]
Adding requests: 100%|█████████▉| 1019/1024 [00:02<00:00, 387.57it/s]
Adding requests: 100%|██████████| 1024/1024 [00:02<00:00, 382.37it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [00:00<00:00, 848.81it/s, est. speed input: 869253.58 toks/s, output: 848.82 toks/s]
Processed prompts:  26%|██▌       | 263/1024 [00:01<00:04, 153.35it/s, est. speed input: 188365.52 toks/s, output: 183.95 toks/s]
Processed prompts:  30%|██▉       | 303/1024 [00:02<00:06, 119.22it/s, est. speed input: 152160.17 toks/s, output: 148.59 toks/s]
Processed prompts:  32%|███▏      | 328/1024 [00:02<00:06, 106.50it/s, est. speed input: 139666.48 toks/s, output: 136.39 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:02<00:07, 91.98it/s, est. speed input: 128273.67 toks/s, output: 125.27 toks/s] 
Processed prompts:  35%|███▌      | 359/1024 [00:02<00:07, 93.66it/s, est. speed input: 127485.88 toks/s, output: 124.50 toks/s]
Processed prompts:  36%|███▋      | 372/1024 [00:03<00:07, 83.80it/s, est. speed input: 121770.87 toks/s, output: 118.92 toks/s]
Processed prompts:  37%|███▋      | 382/1024 [00:03<00:07, 83.52it/s, est. speed input: 120347.18 toks/s, output: 117.53 toks/s]
Processed prompts:  38%|███▊      | 392/1024 [00:03<00:07, 83.31it/s, est. speed input: 119047.83 toks/s, output: 116.26 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:03<00:08, 69.22it/s, est. speed input: 113839.12 toks/s, output: 111.17 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:03<00:08, 68.56it/s, est. speed input: 112327.09 toks/s, output: 109.69 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:03<00:08, 68.01it/s, est. speed input: 110920.01 toks/s, output: 108.32 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:03<00:08, 67.40it/s, est. speed input: 109570.45 toks/s, output: 107.00 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:04<00:08, 67.04it/s, est. speed input: 108328.35 toks/s, output: 105.79 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:04<00:08, 66.73it/s, est. speed input: 107153.54 toks/s, output: 104.64 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:04<00:08, 68.37it/s, est. speed input: 106340.62 toks/s, output: 103.85 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:04<00:08, 67.40it/s, est. speed input: 105242.97 toks/s, output: 102.78 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:04<00:08, 66.76it/s, est. speed input: 104211.87 toks/s, output: 101.77 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:04<00:08, 66.42it/s, est. speed input: 103252.21 toks/s, output: 100.83 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:04<00:08, 66.22it/s, est. speed input: 102344.72 toks/s, output: 99.95 toks/s] 
Processed prompts:  48%|████▊     | 490/1024 [00:04<00:08, 66.02it/s, est. speed input: 101475.97 toks/s, output: 99.10 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:05<00:07, 65.86it/s, est. speed input: 100645.66 toks/s, output: 98.29 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:05<00:07, 65.77it/s, est. speed input: 99857.46 toks/s, output: 97.52 toks/s] 
Processed prompts:  50%|█████     | 514/1024 [00:05<00:07, 65.68it/s, est. speed input: 99102.57 toks/s, output: 96.78 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:05<00:07, 65.48it/s, est. speed input: 98365.37 toks/s, output: 96.06 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:05<00:07, 65.68it/s, est. speed input: 97698.84 toks/s, output: 95.41 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:05<00:07, 65.78it/s, est. speed input: 97056.78 toks/s, output: 94.78 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:05<00:07, 65.76it/s, est. speed input: 96431.47 toks/s, output: 94.17 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:05<00:07, 65.74it/s, est. speed input: 95831.44 toks/s, output: 93.59 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:06<00:07, 65.54it/s, est. speed input: 95237.64 toks/s, output: 93.01 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:06<00:06, 65.41it/s, est. speed input: 94668.17 toks/s, output: 92.45 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:06<00:06, 65.27it/s, est. speed input: 94116.95 toks/s, output: 91.91 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:06<00:06, 65.25it/s, est. speed input: 93593.36 toks/s, output: 91.40 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:06<00:06, 65.28it/s, est. speed input: 93093.54 toks/s, output: 90.91 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:06<00:06, 65.40it/s, est. speed input: 92620.60 toks/s, output: 90.45 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:06<00:06, 65.36it/s, est. speed input: 92154.78 toks/s, output: 89.99 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:06<00:06, 65.38it/s, est. speed input: 91709.02 toks/s, output: 89.56 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:07<00:06, 65.36it/s, est. speed input: 91275.81 toks/s, output: 89.14 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:07<00:05, 65.37it/s, est. speed input: 90859.93 toks/s, output: 88.73 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:07<00:05, 65.28it/s, est. speed input: 90449.93 toks/s, output: 88.33 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:07<00:05, 65.32it/s, est. speed input: 90061.92 toks/s, output: 87.95 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:07<00:05, 65.46it/s, est. speed input: 89694.75 toks/s, output: 87.59 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:07<00:05, 65.63it/s, est. speed input: 89344.02 toks/s, output: 87.25 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:07<00:05, 65.45it/s, est. speed input: 88983.31 toks/s, output: 86.90 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:07<00:05, 65.51it/s, est. speed input: 88646.96 toks/s, output: 86.57 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:08<00:05, 65.54it/s, est. speed input: 88319.45 toks/s, output: 86.25 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:08<00:04, 65.48it/s, est. speed input: 87996.78 toks/s, output: 85.93 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:08<00:04, 65.25it/s, est. speed input: 87671.28 toks/s, output: 85.62 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:08<00:04, 65.19it/s, est. speed input: 87361.72 toks/s, output: 85.31 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:08<00:04, 65.27it/s, est. speed input: 87068.86 toks/s, output: 85.03 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:08<00:04, 65.30it/s, est. speed input: 86782.70 toks/s, output: 84.75 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:08<00:04, 65.24it/s, est. speed input: 86500.21 toks/s, output: 84.47 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:08<00:04, 65.33it/s, est. speed input: 86232.68 toks/s, output: 84.21 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:08<00:04, 65.29it/s, est. speed input: 85967.00 toks/s, output: 83.95 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:09<00:04, 65.27it/s, est. speed input: 85708.69 toks/s, output: 83.70 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:09<00:03, 65.30it/s, est. speed input: 85459.57 toks/s, output: 83.46 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:09<00:03, 65.21it/s, est. speed input: 85210.90 toks/s, output: 83.21 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:09<00:03, 65.21it/s, est. speed input: 84972.17 toks/s, output: 82.98 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:09<00:03, 65.32it/s, est. speed input: 84745.60 toks/s, output: 82.76 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:09<00:03, 65.40it/s, est. speed input: 84524.71 toks/s, output: 82.54 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:09<00:03, 65.48it/s, est. speed input: 84310.67 toks/s, output: 82.33 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:09<00:03, 65.46it/s, est. speed input: 84097.78 toks/s, output: 82.13 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:10<00:03, 65.57it/s, est. speed input: 83896.79 toks/s, output: 81.93 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:10<00:02, 65.43it/s, est. speed input: 83689.51 toks/s, output: 81.73 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [00:10<00:02, 65.44it/s, est. speed input: 83492.19 toks/s, output: 81.54 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [00:10<00:02, 65.36it/s, est. speed input: 83295.32 toks/s, output: 81.34 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:10<00:02, 65.33it/s, est. speed input: 83104.55 toks/s, output: 81.16 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [00:10<00:02, 65.19it/s, est. speed input: 82912.15 toks/s, output: 80.97 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [00:10<00:02, 65.23it/s, est. speed input: 82730.54 toks/s, output: 80.79 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [00:10<00:02, 65.24it/s, est. speed input: 82552.50 toks/s, output: 80.62 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [00:11<00:02, 65.40it/s, est. speed input: 82385.18 toks/s, output: 80.45 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [00:11<00:01, 65.45it/s, est. speed input: 82218.95 toks/s, output: 80.29 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [00:11<00:01, 65.51it/s, est. speed input: 82057.35 toks/s, output: 80.13 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [00:11<00:01, 65.43it/s, est. speed input: 81893.97 toks/s, output: 79.97 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [00:11<00:01, 65.36it/s, est. speed input: 81733.22 toks/s, output: 79.82 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [00:11<00:01, 65.28it/s, est. speed input: 81574.22 toks/s, output: 79.66 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [00:11<00:01, 67.66it/s, est. speed input: 81520.75 toks/s, output: 79.61 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [00:11<00:01, 66.89it/s, est. speed input: 81368.07 toks/s, output: 79.46 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [00:12<00:01, 66.39it/s, est. speed input: 81220.11 toks/s, output: 79.32 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [00:12<00:00, 65.95it/s, est. speed input: 81070.68 toks/s, output: 79.17 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [00:12<00:00, 65.84it/s, est. speed input: 80932.24 toks/s, output: 79.04 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [00:12<00:00, 65.65it/s, est. speed input: 80792.19 toks/s, output: 78.90 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [00:12<00:00, 67.64it/s, est. speed input: 80737.29 toks/s, output: 78.84 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [00:12<00:00, 66.89it/s, est. speed input: 80601.52 toks/s, output: 78.71 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [00:12<00:00, 66.50it/s, est. speed input: 80473.08 toks/s, output: 78.59 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [00:12<00:00, 66.25it/s, est. speed input: 80348.01 toks/s, output: 78.46 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [00:12<00:00, 68.40it/s, est. speed input: 80309.91 toks/s, output: 78.43 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:12<00:00, 68.40it/s, est. speed input: 80782.17 toks/s, output: 78.89 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:12<00:00, 78.89it/s, est. speed input: 80782.17 toks/s, output: 78.89 toks/s]
[rank0]:[W125 17:59:58.247230463 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=16384 ==========
Time: 2026-01-25 18:00:00
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=2048, max_num_seqs=16
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 2048 --max-num-seqs 16 --max-model-len 1025 --max-num-batched-tokens 16384 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/Llama3.2-3B-INT8_M16384.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 18:00:18 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=279400) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=279400) WARNING 01-25 18:00:36 [backends.py:609] Failed to read file <frozen os>
Throughput: 67.13 requests/s, 68805.49 total tokens/s, 67.13 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048

STDERR:
[2026-01-25 18:00:18] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:00:18] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 18:00:18] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 18:00:18] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:00:18] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:00:18] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:00:18] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:00:18] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:00:18] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 18:00:18] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:00:18] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:00:18] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:00:18] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:00:18] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 18:00:26] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:00:26] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 18:00:26] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 18:00:26] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:00:26] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:00:26] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:00:26] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:00:26] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:00:26] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 18:00:26] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:00:26] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:00:26] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:00:26] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:00:26] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=279400) [2026-01-25 18:00:27] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=279400) [2026-01-25 18:00:27] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=279400) [2026-01-25 18:00:27] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=279400) [2026-01-25 18:00:27] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=279400) [2026-01-25 18:00:27] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-3B-INT8
(EngineCore_DP0 pid=279400) [2026-01-25 18:00:27] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=279400) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=279400) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.35it/s]
(EngineCore_DP0 pid=279400) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.35it/s]
(EngineCore_DP0 pid=279400) 
(EngineCore_DP0 pid=279400) [2026-01-25 18:00:28] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 3072] -> 1D uint8
(EngineCore_DP0 pid=279400) [2026-01-25 18:00:28] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 11796480 bytes
(EngineCore_DP0 pid=279400) [2026-01-25 18:00:28] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 3072] -> 1D uint8
(EngineCore_DP0 pid=279400) [2026-01-25 18:00:28] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7077888 bytes
(EngineCore_DP0 pid=279400) [2026-01-25 18:00:28] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 3072] -> 1D uint8
(EngineCore_DP0 pid=279400) [2026-01-25 18:00:28] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 37748736 bytes
(EngineCore_DP0 pid=279400) [2026-01-25 18:00:28] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 8192] -> 1D uint8
(EngineCore_DP0 pid=279400) [2026-01-25 18:00:28] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 18874368 bytes
(EngineCore_DP0 pid=279400) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  14%|█▍        | 1/7 [00:00<00:00,  9.38it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  29%|██▊       | 2/7 [00:00<00:00,  9.65it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  57%|█████▋    | 4/7 [00:00<00:00, 10.49it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  86%|████████▌ | 6/7 [00:00<00:00, 10.78it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00, 10.34it/s]
(EngineCore_DP0 pid=279400) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  20%|██        | 1/5 [00:00<00:00,  8.91it/s]
Capturing CUDA graphs (decode, FULL):  60%|██████    | 3/5 [00:00<00:00,  9.86it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00, 10.14it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00, 10.01it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 35/2048 [00:00<00:05, 347.15it/s]
Adding requests:   4%|▎         | 72/2048 [00:00<00:05, 360.13it/s]
Adding requests:   5%|▌         | 110/2048 [00:00<00:05, 368.56it/s]
Adding requests:   7%|▋         | 147/2048 [00:00<00:05, 362.57it/s]
Adding requests:   9%|▉         | 184/2048 [00:00<00:05, 360.25it/s]
Adding requests:  11%|█         | 221/2048 [00:00<00:05, 361.49it/s]
Adding requests:  13%|█▎        | 259/2048 [00:00<00:04, 367.17it/s]
Adding requests:  14%|█▍        | 296/2048 [00:00<00:04, 365.08it/s]
Adding requests:  16%|█▋        | 334/2048 [00:00<00:04, 367.45it/s]
Adding requests:  18%|█▊        | 374/2048 [00:01<00:04, 375.10it/s]
Adding requests:  20%|██        | 412/2048 [00:01<00:04, 372.08it/s]
Adding requests:  22%|██▏       | 450/2048 [00:01<00:04, 374.14it/s]
Adding requests:  24%|██▍       | 488/2048 [00:01<00:04, 373.59it/s]
Adding requests:  26%|██▌       | 526/2048 [00:01<00:04, 362.58it/s]
Adding requests:  28%|██▊       | 564/2048 [00:01<00:04, 366.42it/s]
Adding requests:  29%|██▉       | 601/2048 [00:01<00:03, 365.54it/s]
Adding requests:  31%|███▏      | 641/2048 [00:01<00:03, 375.16it/s]
Adding requests:  33%|███▎      | 680/2048 [00:01<00:03, 377.11it/s]
Adding requests:  35%|███▌      | 719/2048 [00:01<00:03, 379.95it/s]
Adding requests:  37%|███▋      | 758/2048 [00:02<00:03, 369.48it/s]
Adding requests:  39%|███▉      | 796/2048 [00:02<00:03, 366.72it/s]
Adding requests:  41%|████      | 833/2048 [00:02<00:03, 362.98it/s]
Adding requests:  43%|████▎     | 871/2048 [00:02<00:03, 367.09it/s]
Adding requests:  44%|████▍     | 910/2048 [00:02<00:03, 373.48it/s]
Adding requests:  46%|████▋     | 948/2048 [00:02<00:02, 374.52it/s]
Adding requests:  48%|████▊     | 987/2048 [00:02<00:02, 376.75it/s]
Adding requests:  50%|█████     | 1026/2048 [00:02<00:02, 379.83it/s]
Adding requests:  52%|█████▏    | 1065/2048 [00:02<00:02, 381.83it/s]
Adding requests:  54%|█████▍    | 1104/2048 [00:02<00:02, 377.19it/s]
Adding requests:  56%|█████▌    | 1143/2048 [00:03<00:02, 379.04it/s]
Adding requests:  58%|█████▊    | 1184/2048 [00:03<00:02, 386.50it/s]
Adding requests:  60%|█████▉    | 1224/2048 [00:03<00:02, 389.27it/s]
Adding requests:  62%|██████▏   | 1263/2048 [00:03<00:02, 389.18it/s]
Adding requests:  64%|██████▎   | 1303/2048 [00:03<00:01, 390.56it/s]
Adding requests:  66%|██████▌   | 1343/2048 [00:03<00:01, 390.57it/s]
Adding requests:  68%|██████▊   | 1383/2048 [00:03<00:01, 390.09it/s]
Adding requests:  70%|██████▉   | 1424/2048 [00:03<00:01, 395.83it/s]
Adding requests:  72%|███████▏  | 1465/2048 [00:03<00:01, 397.26it/s]
Adding requests:  74%|███████▎  | 1506/2048 [00:03<00:01, 398.55it/s]
Adding requests:  75%|███████▌  | 1546/2048 [00:04<00:01, 396.31it/s]
Adding requests:  77%|███████▋  | 1586/2048 [00:04<00:01, 395.30it/s]
Adding requests:  79%|███████▉  | 1626/2048 [00:04<00:01, 395.62it/s]
Adding requests:  81%|████████▏ | 1666/2048 [00:04<00:00, 390.46it/s]
Adding requests:  83%|████████▎ | 1707/2048 [00:04<00:00, 393.79it/s]
Adding requests:  85%|████████▌ | 1747/2048 [00:04<00:00, 392.02it/s]
Adding requests:  87%|████████▋ | 1787/2048 [00:04<00:00, 388.13it/s]
Adding requests:  89%|████████▉ | 1826/2048 [00:04<00:00, 387.32it/s]
Adding requests:  91%|█████████ | 1865/2048 [00:04<00:00, 384.24it/s]
Adding requests:  93%|█████████▎| 1904/2048 [00:05<00:00, 374.99it/s]
Adding requests:  95%|█████████▍| 1942/2048 [00:05<00:00, 375.07it/s]
Adding requests:  97%|█████████▋| 1980/2048 [00:05<00:00, 375.23it/s]
Adding requests:  99%|█████████▊| 2019/2048 [00:05<00:00, 377.23it/s]
Adding requests: 100%|██████████| 2048/2048 [00:05<00:00, 378.64it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  17%|█▋        | 354/2048 [00:00<00:00, 2463.38it/s, est. speed input: 2522854.46 toks/s, output: 2463.47 toks/s]
Processed prompts:  29%|██▉       | 601/2048 [00:03<00:10, 135.21it/s, est. speed input: 166215.65 toks/s, output: 162.32 toks/s]   
Processed prompts:  35%|███▍      | 707/2048 [00:05<00:12, 107.00it/s, est. speed input: 134849.04 toks/s, output: 131.69 toks/s]
Processed prompts:  38%|███▊      | 768/2048 [00:06<00:12, 102.86it/s, est. speed input: 129329.86 toks/s, output: 126.30 toks/s]
Processed prompts:  39%|███▉      | 808/2048 [00:06<00:13, 92.60it/s, est. speed input: 121717.90 toks/s, output: 118.86 toks/s] 
Processed prompts:  41%|████      | 836/2048 [00:07<00:13, 86.89it/s, est. speed input: 117736.56 toks/s, output: 114.98 toks/s]
Processed prompts:  42%|████▏     | 857/2048 [00:07<00:13, 87.01it/s, est. speed input: 116857.98 toks/s, output: 114.12 toks/s]
Processed prompts:  43%|████▎     | 874/2048 [00:07<00:13, 84.84it/s, est. speed input: 115493.15 toks/s, output: 112.79 toks/s]
Processed prompts:  43%|████▎     | 888/2048 [00:07<00:14, 80.62it/s, est. speed input: 113842.07 toks/s, output: 111.17 toks/s]
Processed prompts:  44%|████▍     | 900/2048 [00:08<00:15, 74.96it/s, est. speed input: 112042.83 toks/s, output: 109.42 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [00:08<00:15, 71.57it/s, est. speed input: 110589.04 toks/s, output: 108.00 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [00:08<00:15, 71.50it/s, est. speed input: 109616.60 toks/s, output: 107.05 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [00:08<00:15, 70.38it/s, est. speed input: 108522.28 toks/s, output: 105.98 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [00:09<00:15, 69.53it/s, est. speed input: 107489.04 toks/s, output: 104.97 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [00:09<00:15, 69.91it/s, est. speed input: 106653.03 toks/s, output: 104.15 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [00:09<00:15, 69.12it/s, est. speed input: 105715.11 toks/s, output: 103.24 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [00:09<00:15, 68.52it/s, est. speed input: 104818.54 toks/s, output: 102.36 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [00:10<00:14, 68.14it/s, est. speed input: 103971.21 toks/s, output: 101.53 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [00:10<00:14, 67.92it/s, est. speed input: 103168.41 toks/s, output: 100.75 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [00:10<00:14, 67.68it/s, est. speed input: 102392.34 toks/s, output: 99.99 toks/s] 
Processed prompts:  52%|█████▏    | 1074/2048 [00:10<00:14, 67.54it/s, est. speed input: 101653.61 toks/s, output: 99.27 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [00:11<00:14, 67.32it/s, est. speed input: 100933.94 toks/s, output: 98.57 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [00:11<00:13, 67.31it/s, est. speed input: 100259.02 toks/s, output: 97.91 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [00:11<00:13, 67.31it/s, est. speed input: 99613.84 toks/s, output: 97.28 toks/s] 
Processed prompts:  56%|█████▌    | 1138/2048 [00:11<00:13, 67.20it/s, est. speed input: 98982.78 toks/s, output: 96.66 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [00:11<00:13, 68.37it/s, est. speed input: 98496.13 toks/s, output: 96.19 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [00:12<00:12, 67.93it/s, est. speed input: 97911.25 toks/s, output: 95.62 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [00:12<00:12, 67.59it/s, est. speed input: 97344.34 toks/s, output: 95.06 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [00:12<00:12, 67.45it/s, est. speed input: 96807.83 toks/s, output: 94.54 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [00:12<00:12, 67.38it/s, est. speed input: 96294.24 toks/s, output: 94.04 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [00:13<00:12, 67.26it/s, est. speed input: 95791.96 toks/s, output: 93.55 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [00:13<00:11, 67.10it/s, est. speed input: 95302.26 toks/s, output: 93.07 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [00:13<00:11, 67.08it/s, est. speed input: 94836.44 toks/s, output: 92.61 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [00:13<00:11, 67.01it/s, est. speed input: 94382.46 toks/s, output: 92.17 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [00:14<00:11, 67.00it/s, est. speed input: 93946.50 toks/s, output: 91.74 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [00:14<00:10, 66.99it/s, est. speed input: 93525.03 toks/s, output: 91.33 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [00:14<00:10, 66.94it/s, est. speed input: 93114.11 toks/s, output: 90.93 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [00:14<00:10, 67.03it/s, est. speed input: 92726.22 toks/s, output: 90.55 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [00:15<00:10, 66.99it/s, est. speed input: 92342.51 toks/s, output: 90.18 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [00:15<00:09, 67.08it/s, est. speed input: 91979.33 toks/s, output: 89.82 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [00:15<00:09, 67.11it/s, est. speed input: 91624.70 toks/s, output: 89.48 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [00:15<00:09, 67.02it/s, est. speed input: 91273.44 toks/s, output: 89.13 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [00:16<00:09, 67.03it/s, est. speed input: 90937.05 toks/s, output: 88.81 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [00:16<00:09, 66.94it/s, est. speed input: 90604.82 toks/s, output: 88.48 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [00:16<00:08, 66.93it/s, est. speed input: 90285.39 toks/s, output: 88.17 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [00:16<00:08, 66.98it/s, est. speed input: 89978.43 toks/s, output: 87.87 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [00:17<00:08, 66.86it/s, est. speed input: 89670.70 toks/s, output: 87.57 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [00:17<00:08, 66.93it/s, est. speed input: 89380.87 toks/s, output: 87.29 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [00:17<00:07, 66.96it/s, est. speed input: 89097.69 toks/s, output: 87.01 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [00:17<00:07, 66.89it/s, est. speed input: 88816.65 toks/s, output: 86.73 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [00:17<00:07, 66.90it/s, est. speed input: 88547.26 toks/s, output: 86.47 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [00:18<00:07, 66.94it/s, est. speed input: 88285.94 toks/s, output: 86.22 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [00:18<00:06, 68.06it/s, est. speed input: 88093.14 toks/s, output: 86.03 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [00:18<00:06, 67.80it/s, est. speed input: 87847.05 toks/s, output: 85.79 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [00:18<00:06, 67.51it/s, est. speed input: 87601.87 toks/s, output: 85.55 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [00:19<00:06, 67.30it/s, est. speed input: 87362.00 toks/s, output: 85.31 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [00:19<00:05, 67.11it/s, est. speed input: 87125.63 toks/s, output: 85.08 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [00:19<00:05, 67.03it/s, est. speed input: 86897.81 toks/s, output: 84.86 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [00:19<00:05, 67.00it/s, est. speed input: 86676.96 toks/s, output: 84.65 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [00:20<00:05, 66.89it/s, est. speed input: 86456.63 toks/s, output: 84.43 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [00:20<00:04, 66.90it/s, est. speed input: 86246.26 toks/s, output: 84.22 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [00:20<00:04, 66.86it/s, est. speed input: 86037.97 toks/s, output: 84.02 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [00:20<00:04, 66.76it/s, est. speed input: 85831.12 toks/s, output: 83.82 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [00:21<00:04, 66.79it/s, est. speed input: 85634.06 toks/s, output: 83.63 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [00:21<00:04, 66.79it/s, est. speed input: 85440.13 toks/s, output: 83.44 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [00:21<00:03, 66.86it/s, est. speed input: 85253.97 toks/s, output: 83.26 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [00:21<00:03, 66.90it/s, est. speed input: 85071.44 toks/s, output: 83.08 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [00:22<00:03, 66.93it/s, est. speed input: 84892.77 toks/s, output: 82.90 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [00:22<00:03, 66.88it/s, est. speed input: 84714.82 toks/s, output: 82.73 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [00:22<00:02, 66.82it/s, est. speed input: 84539.69 toks/s, output: 82.56 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [00:22<00:02, 67.90it/s, est. speed input: 84417.17 toks/s, output: 82.44 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [00:22<00:02, 67.56it/s, est. speed input: 84250.24 toks/s, output: 82.28 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [00:23<00:02, 67.27it/s, est. speed input: 84084.06 toks/s, output: 82.11 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [00:23<00:01, 67.12it/s, est. speed input: 83923.56 toks/s, output: 81.96 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [00:23<00:01, 67.00it/s, est. speed input: 83765.63 toks/s, output: 81.80 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [00:23<00:01, 68.14it/s, est. speed input: 83660.95 toks/s, output: 81.70 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [00:24<00:01, 67.73it/s, est. speed input: 83509.39 toks/s, output: 81.55 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [00:24<00:00, 67.46it/s, est. speed input: 83361.81 toks/s, output: 81.41 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [00:24<00:00, 67.27it/s, est. speed input: 83216.47 toks/s, output: 81.27 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [00:24<00:00, 67.21it/s, est. speed input: 83077.23 toks/s, output: 81.13 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [00:25<00:00, 68.38it/s, est. speed input: 82986.88 toks/s, output: 81.04 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:25<00:00, 68.38it/s, est. speed input: 83556.80 toks/s, output: 81.60 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:25<00:00, 81.60it/s, est. speed input: 83556.80 toks/s, output: 81.60 toks/s]
[rank0]:[W125 18:01:27.844138124 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=32768 ==========
Time: 2026-01-25 18:01:29
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=4096, max_num_seqs=32
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 4096 --max-num-seqs 32 --max-model-len 1025 --max-num-batched-tokens 32768 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/Llama3.2-3B-INT8_M32768.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 18:01:59 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=281008) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=281008) WARNING 01-25 18:02:16 [backends.py:609] Failed to read file <frozen os>
Throughput: 67.83 requests/s, 69526.94 total tokens/s, 67.83 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096

STDERR:
[2026-01-25 18:01:58] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:01:58] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 18:01:58] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 18:01:58] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:01:58] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:01:58] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:01:58] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:01:58] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:01:58] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 18:01:58] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:01:58] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:01:58] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:01:58] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:01:58] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 18:02:06] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:02:06] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 18:02:06] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 18:02:06] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:02:06] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:02:06] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:02:06] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:02:06] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:02:06] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 18:02:06] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:02:06] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:02:06] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:02:06] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:02:06] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=281008) [2026-01-25 18:02:08] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=281008) [2026-01-25 18:02:08] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=281008) [2026-01-25 18:02:08] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=281008) [2026-01-25 18:02:08] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=281008) [2026-01-25 18:02:08] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-3B-INT8
(EngineCore_DP0 pid=281008) [2026-01-25 18:02:08] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=281008) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=281008) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.25it/s]
(EngineCore_DP0 pid=281008) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.25it/s]
(EngineCore_DP0 pid=281008) 
(EngineCore_DP0 pid=281008) [2026-01-25 18:02:08] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 3072] -> 1D uint8
(EngineCore_DP0 pid=281008) [2026-01-25 18:02:08] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 11796480 bytes
(EngineCore_DP0 pid=281008) [2026-01-25 18:02:08] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 3072] -> 1D uint8
(EngineCore_DP0 pid=281008) [2026-01-25 18:02:08] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7077888 bytes
(EngineCore_DP0 pid=281008) [2026-01-25 18:02:08] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 3072] -> 1D uint8
(EngineCore_DP0 pid=281008) [2026-01-25 18:02:08] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 37748736 bytes
(EngineCore_DP0 pid=281008) [2026-01-25 18:02:08] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 8192] -> 1D uint8
(EngineCore_DP0 pid=281008) [2026-01-25 18:02:08] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 18874368 bytes
(EngineCore_DP0 pid=281008) [rank0]:W0125 18:02:25.493000 281008 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=281008) [rank0]:W0125 18:02:25.616000 281008 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=281008) [rank0]:W0125 18:02:27.079000 281008 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=281008) [rank0]:W0125 18:02:27.273000 281008 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=281008) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  18%|█▊        | 2/11 [00:00<00:00, 10.54it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  36%|███▋      | 4/11 [00:00<00:00, 11.14it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  55%|█████▍    | 6/11 [00:00<00:00, 11.13it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  73%|███████▎  | 8/11 [00:00<00:00, 11.03it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  91%|█████████ | 10/11 [00:00<00:00, 11.22it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00, 10.90it/s]
(EngineCore_DP0 pid=281008) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  14%|█▍        | 1/7 [00:00<00:00,  9.32it/s]
Capturing CUDA graphs (decode, FULL):  43%|████▎     | 3/7 [00:00<00:00, 10.97it/s]
Capturing CUDA graphs (decode, FULL):  71%|███████▏  | 5/7 [00:00<00:00, 11.39it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00, 11.58it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00, 11.36it/s]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   1%|          | 37/4096 [00:00<00:11, 364.50it/s]
Adding requests:   2%|▏         | 76/4096 [00:00<00:10, 374.40it/s]
Adding requests:   3%|▎         | 115/4096 [00:00<00:10, 378.05it/s]
Adding requests:   4%|▍         | 155/4096 [00:00<00:10, 384.12it/s]
Adding requests:   5%|▍         | 196/4096 [00:00<00:09, 390.14it/s]
Adding requests:   6%|▌         | 238/4096 [00:00<00:09, 397.35it/s]
Adding requests:   7%|▋         | 278/4096 [00:00<00:09, 394.84it/s]
Adding requests:   8%|▊         | 318/4096 [00:00<00:09, 381.74it/s]
Adding requests:   9%|▊         | 357/4096 [00:00<00:09, 382.46it/s]
Adding requests:  10%|▉         | 396/4096 [00:01<00:09, 381.34it/s]
Adding requests:  11%|█         | 435/4096 [00:01<00:09, 375.55it/s]
Adding requests:  12%|█▏        | 477/4096 [00:01<00:09, 387.00it/s]
Adding requests:  13%|█▎        | 518/4096 [00:01<00:09, 389.44it/s]
Adding requests:  14%|█▎        | 559/4096 [00:01<00:08, 393.27it/s]
Adding requests:  15%|█▍        | 599/4096 [00:01<00:08, 392.08it/s]
Adding requests:  16%|█▌        | 640/4096 [00:01<00:08, 395.42it/s]
Adding requests:  17%|█▋        | 682/4096 [00:01<00:08, 402.31it/s]
Adding requests:  18%|█▊        | 723/4096 [00:01<00:08, 401.50it/s]
Adding requests:  19%|█▊        | 764/4096 [00:01<00:08, 395.74it/s]
Adding requests:  20%|█▉        | 804/4096 [00:02<00:08, 387.22it/s]
Adding requests:  21%|██        | 843/4096 [00:02<00:08, 385.20it/s]
Adding requests:  22%|██▏       | 887/4096 [00:02<00:08, 398.55it/s]
Adding requests:  23%|██▎       | 928/4096 [00:02<00:07, 401.50it/s]
Adding requests:  24%|██▎       | 971/4096 [00:02<00:07, 408.14it/s]
Adding requests:  25%|██▍       | 1013/4096 [00:02<00:07, 409.75it/s]
Adding requests:  26%|██▌       | 1055/4096 [00:02<00:07, 408.99it/s]
Adding requests:  27%|██▋       | 1096/4096 [00:02<00:07, 397.71it/s]
Adding requests:  28%|██▊       | 1136/4096 [00:02<00:07, 395.53it/s]
Adding requests:  29%|██▉       | 1178/4096 [00:02<00:07, 400.40it/s]
Adding requests:  30%|██▉       | 1222/4096 [00:03<00:07, 408.36it/s]
Adding requests:  31%|███       | 1263/4096 [00:03<00:07, 395.37it/s]
Adding requests:  32%|███▏      | 1303/4096 [00:03<00:07, 390.14it/s]
Adding requests:  33%|███▎      | 1343/4096 [00:03<00:07, 390.65it/s]
Adding requests:  34%|███▍      | 1383/4096 [00:03<00:06, 389.02it/s]
Adding requests:  35%|███▍      | 1425/4096 [00:03<00:06, 395.35it/s]
Adding requests:  36%|███▌      | 1468/4096 [00:03<00:06, 404.49it/s]
Adding requests:  37%|███▋      | 1510/4096 [00:03<00:06, 408.43it/s]
Adding requests:  38%|███▊      | 1551/4096 [00:03<00:06, 404.95it/s]
Adding requests:  39%|███▉      | 1592/4096 [00:04<00:06, 400.22it/s]
Adding requests:  40%|███▉      | 1633/4096 [00:04<00:06, 397.72it/s]
Adding requests:  41%|████      | 1674/4096 [00:04<00:06, 399.06it/s]
Adding requests:  42%|████▏     | 1716/4096 [00:04<00:05, 402.28it/s]
Adding requests:  43%|████▎     | 1757/4096 [00:04<00:05, 400.94it/s]
Adding requests:  44%|████▍     | 1799/4096 [00:04<00:05, 405.74it/s]
Adding requests:  45%|████▍     | 1841/4096 [00:04<00:05, 408.71it/s]
Adding requests:  46%|████▌     | 1882/4096 [00:04<00:05, 407.55it/s]
Adding requests:  47%|████▋     | 1923/4096 [00:04<00:05, 404.98it/s]
Adding requests:  48%|████▊     | 1964/4096 [00:04<00:05, 398.52it/s]
Adding requests:  49%|████▉     | 2004/4096 [00:05<00:05, 396.19it/s]
Adding requests:  50%|████▉     | 2045/4096 [00:05<00:05, 399.30it/s]
Adding requests:  51%|█████     | 2085/4096 [00:05<00:05, 398.12it/s]
Adding requests:  52%|█████▏    | 2125/4096 [00:05<00:05, 390.12it/s]
Adding requests:  53%|█████▎    | 2166/4096 [00:05<00:04, 395.02it/s]
Adding requests:  54%|█████▍    | 2206/4096 [00:05<00:04, 395.93it/s]
Adding requests:  55%|█████▍    | 2249/4096 [00:05<00:04, 405.86it/s]
Adding requests:  56%|█████▌    | 2290/4096 [00:05<00:04, 397.56it/s]
Adding requests:  57%|█████▋    | 2332/4096 [00:05<00:04, 403.67it/s]
Adding requests:  58%|█████▊    | 2373/4096 [00:05<00:04, 405.20it/s]
Adding requests:  59%|█████▉    | 2414/4096 [00:06<00:04, 402.02it/s]
Adding requests:  60%|█████▉    | 2455/4096 [00:06<00:04, 398.69it/s]
Adding requests:  61%|██████    | 2495/4096 [00:06<00:04, 397.84it/s]
Adding requests:  62%|██████▏   | 2537/4096 [00:06<00:03, 401.93it/s]
Adding requests:  63%|██████▎   | 2580/4096 [00:06<00:03, 409.64it/s]
Adding requests:  64%|██████▍   | 2621/4096 [00:06<00:03, 403.34it/s]
Adding requests:  65%|██████▌   | 2663/4096 [00:06<00:03, 405.63it/s]
Adding requests:  66%|██████▌   | 2704/4096 [00:06<00:03, 406.48it/s]
Adding requests:  67%|██████▋   | 2747/4096 [00:06<00:03, 410.51it/s]
Adding requests:  68%|██████▊   | 2789/4096 [00:07<00:03, 404.30it/s]
Adding requests:  69%|██████▉   | 2830/4096 [00:07<00:03, 391.70it/s]
Adding requests:  70%|███████   | 2870/4096 [00:07<00:03, 389.29it/s]
Adding requests:  71%|███████   | 2909/4096 [00:07<00:03, 388.74it/s]
Adding requests:  72%|███████▏  | 2948/4096 [00:07<00:02, 382.96it/s]
Adding requests:  73%|███████▎  | 2990/4096 [00:07<00:02, 391.90it/s]
Adding requests:  74%|███████▍  | 3030/4096 [00:07<00:02, 389.01it/s]
Adding requests:  75%|███████▍  | 3069/4096 [00:07<00:02, 388.59it/s]
Adding requests:  76%|███████▌  | 3111/4096 [00:07<00:02, 394.77it/s]
Adding requests:  77%|███████▋  | 3152/4096 [00:07<00:02, 398.42it/s]
Adding requests:  78%|███████▊  | 3194/4096 [00:08<00:02, 402.32it/s]
Adding requests:  79%|███████▉  | 3235/4096 [00:08<00:02, 401.20it/s]
Adding requests:  80%|███████▉  | 3276/4096 [00:08<00:02, 399.20it/s]
Adding requests:  81%|████████  | 3317/4096 [00:08<00:01, 400.36it/s]
Adding requests:  82%|████████▏ | 3359/4096 [00:08<00:01, 405.29it/s]
Adding requests:  83%|████████▎ | 3400/4096 [00:08<00:01, 403.32it/s]
Adding requests:  84%|████████▍ | 3443/4096 [00:08<00:01, 408.46it/s]
Adding requests:  85%|████████▌ | 3484/4096 [00:08<00:01, 405.30it/s]
Adding requests:  86%|████████▌ | 3526/4096 [00:08<00:01, 407.21it/s]
Adding requests:  87%|████████▋ | 3567/4096 [00:08<00:01, 403.85it/s]
Adding requests:  88%|████████▊ | 3608/4096 [00:09<00:01, 404.99it/s]
Adding requests:  89%|████████▉ | 3649/4096 [00:09<00:01, 385.92it/s]
Adding requests:  90%|█████████ | 3690/4096 [00:09<00:01, 391.66it/s]
Adding requests:  91%|█████████ | 3730/4096 [00:09<00:00, 392.93it/s]
Adding requests:  92%|█████████▏| 3770/4096 [00:09<00:00, 387.11it/s]
Adding requests:  93%|█████████▎| 3812/4096 [00:09<00:00, 394.34it/s]
Adding requests:  94%|█████████▍| 3855/4096 [00:09<00:00, 402.69it/s]
Adding requests:  95%|█████████▌| 3897/4096 [00:09<00:00, 405.81it/s]
Adding requests:  96%|█████████▌| 3938/4096 [00:09<00:00, 406.82it/s]
Adding requests:  97%|█████████▋| 3979/4096 [00:10<00:00, 399.49it/s]
Adding requests:  98%|█████████▊| 4020/4096 [00:10<00:00, 402.18it/s]
Adding requests:  99%|█████████▉| 4061/4096 [00:10<00:00, 391.43it/s]
Adding requests: 100%|██████████| 4096/4096 [00:10<00:00, 397.29it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  17%|█▋        | 700/4096 [00:00<00:02, 1445.95it/s, est. speed input: 1480715.39 toks/s, output: 1445.96 toks/s]
Processed prompts:  21%|██        | 845/4096 [00:02<00:11, 286.27it/s, est. speed input: 366120.90 toks/s, output: 357.54 toks/s]   
Processed prompts:  22%|██▏       | 910/4096 [00:03<00:15, 204.41it/s, est. speed input: 282101.27 toks/s, output: 275.49 toks/s]
Processed prompts:  23%|██▎       | 948/4096 [00:03<00:17, 179.22it/s, est. speed input: 258143.22 toks/s, output: 252.09 toks/s]
Processed prompts:  24%|██▍       | 975/4096 [00:04<00:20, 151.82it/s, est. speed input: 236783.85 toks/s, output: 231.23 toks/s]
Processed prompts:  24%|██▍       | 994/4096 [00:04<00:25, 123.85it/s, est. speed input: 217224.44 toks/s, output: 212.13 toks/s]
Processed prompts:  25%|██▍       | 1020/4096 [00:05<00:29, 105.68it/s, est. speed input: 202555.32 toks/s, output: 197.81 toks/s]
Processed prompts:  26%|██▌       | 1052/4096 [00:05<00:31, 95.41it/s, est. speed input: 191482.67 toks/s, output: 186.99 toks/s] 
Processed prompts:  26%|██▋       | 1084/4096 [00:06<00:34, 87.77it/s, est. speed input: 182123.57 toks/s, output: 177.85 toks/s]
Processed prompts:  27%|██▋       | 1116/4096 [00:06<00:36, 82.08it/s, est. speed input: 174053.58 toks/s, output: 169.97 toks/s]
Processed prompts:  28%|██▊       | 1148/4096 [00:07<00:37, 78.70it/s, est. speed input: 167421.22 toks/s, output: 163.50 toks/s]
Processed prompts:  29%|██▉       | 1180/4096 [00:07<00:38, 75.54it/s, est. speed input: 161276.79 toks/s, output: 157.50 toks/s]
Processed prompts:  30%|██▉       | 1212/4096 [00:07<00:39, 73.34it/s, est. speed input: 155876.17 toks/s, output: 152.22 toks/s]
Processed prompts:  30%|███       | 1244/4096 [00:08<00:39, 71.80it/s, est. speed input: 151084.67 toks/s, output: 147.54 toks/s]
Processed prompts:  31%|███       | 1276/4096 [00:08<00:39, 70.64it/s, est. speed input: 146770.42 toks/s, output: 143.33 toks/s]
Processed prompts:  32%|███▏      | 1308/4096 [00:09<00:39, 69.79it/s, est. speed input: 142874.44 toks/s, output: 139.53 toks/s]
Processed prompts:  33%|███▎      | 1340/4096 [00:09<00:39, 69.22it/s, est. speed input: 139364.13 toks/s, output: 136.10 toks/s]
Processed prompts:  33%|███▎      | 1372/4096 [00:10<00:39, 68.79it/s, est. speed input: 136162.02 toks/s, output: 132.97 toks/s]
Processed prompts:  34%|███▍      | 1404/4096 [00:10<00:39, 68.48it/s, est. speed input: 133241.22 toks/s, output: 130.12 toks/s]
Processed prompts:  35%|███▌      | 1436/4096 [00:11<00:38, 68.28it/s, est. speed input: 130566.36 toks/s, output: 127.51 toks/s]
Processed prompts:  36%|███▌      | 1468/4096 [00:11<00:38, 68.06it/s, est. speed input: 128089.04 toks/s, output: 125.09 toks/s]
Processed prompts:  37%|███▋      | 1500/4096 [00:12<00:38, 67.99it/s, est. speed input: 125821.91 toks/s, output: 122.87 toks/s]
Processed prompts:  37%|███▋      | 1532/4096 [00:12<00:37, 67.93it/s, est. speed input: 123723.06 toks/s, output: 120.82 toks/s]
Processed prompts:  38%|███▊      | 1564/4096 [00:13<00:37, 67.89it/s, est. speed input: 121773.98 toks/s, output: 118.92 toks/s]
Processed prompts:  39%|███▉      | 1596/4096 [00:13<00:36, 67.84it/s, est. speed input: 119955.21 toks/s, output: 117.14 toks/s]
Processed prompts:  40%|███▉      | 1628/4096 [00:14<00:36, 67.80it/s, est. speed input: 118258.14 toks/s, output: 115.49 toks/s]
Processed prompts:  41%|████      | 1660/4096 [00:14<00:35, 67.79it/s, est. speed input: 116674.91 toks/s, output: 113.94 toks/s]
Processed prompts:  41%|████▏     | 1692/4096 [00:15<00:35, 67.75it/s, est. speed input: 115185.15 toks/s, output: 112.49 toks/s]
Processed prompts:  42%|████▏     | 1724/4096 [00:15<00:35, 67.69it/s, est. speed input: 113778.90 toks/s, output: 111.11 toks/s]
Processed prompts:  43%|████▎     | 1756/4096 [00:15<00:34, 67.59it/s, est. speed input: 112449.06 toks/s, output: 109.81 toks/s]
Processed prompts:  44%|████▎     | 1788/4096 [00:16<00:34, 67.62it/s, est. speed input: 111209.55 toks/s, output: 108.60 toks/s]
Processed prompts:  44%|████▍     | 1820/4096 [00:16<00:33, 67.64it/s, est. speed input: 110040.45 toks/s, output: 107.46 toks/s]
Processed prompts:  45%|████▌     | 1852/4096 [00:17<00:32, 68.30it/s, est. speed input: 109027.60 toks/s, output: 106.47 toks/s]
Processed prompts:  46%|████▌     | 1884/4096 [00:17<00:32, 68.12it/s, est. speed input: 107977.54 toks/s, output: 105.45 toks/s]
Processed prompts:  47%|████▋     | 1916/4096 [00:18<00:32, 67.99it/s, est. speed input: 106981.20 toks/s, output: 104.47 toks/s]
Processed prompts:  48%|████▊     | 1948/4096 [00:18<00:31, 68.46it/s, est. speed input: 106107.40 toks/s, output: 103.62 toks/s]
Processed prompts:  48%|████▊     | 1980/4096 [00:19<00:31, 68.21it/s, est. speed input: 105202.50 toks/s, output: 102.74 toks/s]
Processed prompts:  49%|████▉     | 2012/4096 [00:19<00:30, 68.05it/s, est. speed input: 104342.91 toks/s, output: 101.90 toks/s]
Processed prompts:  50%|████▉     | 2044/4096 [00:20<00:30, 67.89it/s, est. speed input: 103517.23 toks/s, output: 101.09 toks/s]
Processed prompts:  51%|█████     | 2076/4096 [00:20<00:29, 67.81it/s, est. speed input: 102734.36 toks/s, output: 100.33 toks/s]
Processed prompts:  51%|█████▏    | 2108/4096 [00:21<00:29, 67.74it/s, est. speed input: 101983.92 toks/s, output: 99.59 toks/s] 
Processed prompts:  52%|█████▏    | 2140/4096 [00:21<00:28, 67.71it/s, est. speed input: 101268.51 toks/s, output: 98.89 toks/s]
Processed prompts:  53%|█████▎    | 2172/4096 [00:22<00:28, 67.66it/s, est. speed input: 100580.22 toks/s, output: 98.22 toks/s]
Processed prompts:  54%|█████▍    | 2204/4096 [00:22<00:27, 67.64it/s, est. speed input: 99922.88 toks/s, output: 97.58 toks/s] 
Processed prompts:  55%|█████▍    | 2236/4096 [00:23<00:27, 68.80it/s, est. speed input: 99408.33 toks/s, output: 97.08 toks/s]
Processed prompts:  55%|█████▌    | 2268/4096 [00:23<00:26, 68.44it/s, est. speed input: 98800.62 toks/s, output: 96.48 toks/s]
Processed prompts:  56%|█████▌    | 2300/4096 [00:23<00:26, 68.77it/s, est. speed input: 98271.41 toks/s, output: 95.97 toks/s]
Processed prompts:  57%|█████▋    | 2332/4096 [00:24<00:25, 69.00it/s, est. speed input: 97761.37 toks/s, output: 95.47 toks/s]
Processed prompts:  58%|█████▊    | 2364/4096 [00:24<00:25, 68.63it/s, est. speed input: 97223.67 toks/s, output: 94.94 toks/s]
Processed prompts:  58%|█████▊    | 2396/4096 [00:25<00:24, 68.29it/s, est. speed input: 96699.02 toks/s, output: 94.43 toks/s]
Processed prompts:  59%|█████▉    | 2428/4096 [00:25<00:24, 68.11it/s, est. speed input: 96198.53 toks/s, output: 93.94 toks/s]
Processed prompts:  60%|██████    | 2460/4096 [00:26<00:24, 67.94it/s, est. speed input: 95712.16 toks/s, output: 93.47 toks/s]
Processed prompts:  61%|██████    | 2492/4096 [00:26<00:23, 68.47it/s, est. speed input: 95295.11 toks/s, output: 93.06 toks/s]
Processed prompts:  62%|██████▏   | 2524/4096 [00:27<00:23, 68.19it/s, est. speed input: 94841.01 toks/s, output: 92.62 toks/s]
Processed prompts:  62%|██████▏   | 2556/4096 [00:27<00:22, 68.02it/s, est. speed input: 94404.15 toks/s, output: 92.19 toks/s]
Processed prompts:  63%|██████▎   | 2588/4096 [00:28<00:22, 68.49it/s, est. speed input: 94027.43 toks/s, output: 91.82 toks/s]
Processed prompts:  64%|██████▍   | 2620/4096 [00:28<00:21, 68.22it/s, est. speed input: 93617.28 toks/s, output: 91.42 toks/s]
Processed prompts:  65%|██████▍   | 2652/4096 [00:29<00:21, 68.06it/s, est. speed input: 93223.09 toks/s, output: 91.04 toks/s]
Processed prompts:  66%|██████▌   | 2684/4096 [00:29<00:20, 67.93it/s, est. speed input: 92840.17 toks/s, output: 90.66 toks/s]
Processed prompts:  66%|██████▋   | 2716/4096 [00:30<00:20, 67.85it/s, est. speed input: 92469.84 toks/s, output: 90.30 toks/s]
Processed prompts:  67%|██████▋   | 2748/4096 [00:30<00:19, 67.68it/s, est. speed input: 92102.52 toks/s, output: 89.94 toks/s]
Processed prompts:  68%|██████▊   | 2780/4096 [00:31<00:19, 67.69it/s, est. speed input: 91756.10 toks/s, output: 89.61 toks/s]
Processed prompts:  69%|██████▊   | 2812/4096 [00:31<00:19, 67.55it/s, est. speed input: 91409.72 toks/s, output: 89.27 toks/s]
Processed prompts:  69%|██████▉   | 2844/4096 [00:31<00:18, 67.53it/s, est. speed input: 91079.22 toks/s, output: 88.94 toks/s]
Processed prompts:  70%|███████   | 2876/4096 [00:32<00:18, 67.51it/s, est. speed input: 90757.43 toks/s, output: 88.63 toks/s]
Processed prompts:  71%|███████   | 2908/4096 [00:32<00:17, 67.53it/s, est. speed input: 90447.22 toks/s, output: 88.33 toks/s]
Processed prompts:  72%|███████▏  | 2940/4096 [00:33<00:17, 67.52it/s, est. speed input: 90144.49 toks/s, output: 88.03 toks/s]
Processed prompts:  73%|███████▎  | 2972/4096 [00:33<00:16, 67.52it/s, est. speed input: 89850.38 toks/s, output: 87.74 toks/s]
Processed prompts:  73%|███████▎  | 3004/4096 [00:34<00:16, 67.49it/s, est. speed input: 89562.92 toks/s, output: 87.46 toks/s]
Processed prompts:  74%|███████▍  | 3036/4096 [00:34<00:15, 67.51it/s, est. speed input: 89285.82 toks/s, output: 87.19 toks/s]
Processed prompts:  75%|███████▍  | 3068/4096 [00:35<00:15, 67.44it/s, est. speed input: 89010.88 toks/s, output: 86.92 toks/s]
Processed prompts:  76%|███████▌  | 3100/4096 [00:35<00:14, 67.51it/s, est. speed input: 88750.31 toks/s, output: 86.67 toks/s]
Processed prompts:  76%|███████▋  | 3132/4096 [00:36<00:14, 68.04it/s, est. speed input: 88523.63 toks/s, output: 86.45 toks/s]
Processed prompts:  77%|███████▋  | 3164/4096 [00:36<00:13, 67.81it/s, est. speed input: 88269.45 toks/s, output: 86.20 toks/s]
Processed prompts:  78%|███████▊  | 3196/4096 [00:37<00:13, 67.70it/s, est. speed input: 88024.15 toks/s, output: 85.96 toks/s]
Processed prompts:  79%|███████▉  | 3228/4096 [00:37<00:12, 67.62it/s, est. speed input: 87785.05 toks/s, output: 85.73 toks/s]
Processed prompts:  80%|███████▉  | 3260/4096 [00:38<00:12, 67.60it/s, est. speed input: 87553.78 toks/s, output: 85.50 toks/s]
Processed prompts:  80%|████████  | 3292/4096 [00:38<00:11, 67.46it/s, est. speed input: 87321.50 toks/s, output: 85.27 toks/s]
Processed prompts:  81%|████████  | 3324/4096 [00:39<00:11, 67.50it/s, est. speed input: 87102.13 toks/s, output: 85.06 toks/s]
Processed prompts:  82%|████████▏ | 3356/4096 [00:39<00:10, 67.42it/s, est. speed input: 86882.57 toks/s, output: 84.85 toks/s]
Processed prompts:  83%|████████▎ | 3388/4096 [00:40<00:10, 67.38it/s, est. speed input: 86669.03 toks/s, output: 84.64 toks/s]
Processed prompts:  83%|████████▎ | 3420/4096 [00:40<00:10, 67.37it/s, est. speed input: 86461.05 toks/s, output: 84.43 toks/s]
Processed prompts:  84%|████████▍ | 3452/4096 [00:40<00:09, 67.35it/s, est. speed input: 86257.91 toks/s, output: 84.24 toks/s]
Processed prompts:  85%|████████▌ | 3484/4096 [00:41<00:09, 67.35it/s, est. speed input: 86059.69 toks/s, output: 84.04 toks/s]
Processed prompts:  86%|████████▌ | 3516/4096 [00:41<00:08, 67.37it/s, est. speed input: 85867.08 toks/s, output: 83.85 toks/s]
Processed prompts:  87%|████████▋ | 3548/4096 [00:42<00:08, 67.32it/s, est. speed input: 85675.48 toks/s, output: 83.67 toks/s]
Processed prompts:  87%|████████▋ | 3580/4096 [00:42<00:07, 67.35it/s, est. speed input: 85491.45 toks/s, output: 83.49 toks/s]
Processed prompts:  88%|████████▊ | 3612/4096 [00:43<00:07, 67.31it/s, est. speed input: 85308.52 toks/s, output: 83.31 toks/s]
Processed prompts:  89%|████████▉ | 3644/4096 [00:43<00:06, 67.30it/s, est. speed input: 85130.22 toks/s, output: 83.13 toks/s]
Processed prompts:  90%|████████▉ | 3676/4096 [00:44<00:06, 67.28it/s, est. speed input: 84955.51 toks/s, output: 82.96 toks/s]
Processed prompts:  91%|█████████ | 3708/4096 [00:44<00:05, 67.31it/s, est. speed input: 84786.19 toks/s, output: 82.80 toks/s]
Processed prompts:  91%|█████████▏| 3740/4096 [00:45<00:05, 67.88it/s, est. speed input: 84644.24 toks/s, output: 82.66 toks/s]
Processed prompts:  92%|█████████▏| 3772/4096 [00:45<00:04, 67.67it/s, est. speed input: 84479.32 toks/s, output: 82.50 toks/s]
Processed prompts:  93%|█████████▎| 3804/4096 [00:46<00:04, 67.60it/s, est. speed input: 84320.93 toks/s, output: 82.34 toks/s]
Processed prompts:  94%|█████████▎| 3836/4096 [00:46<00:03, 67.47it/s, est. speed input: 84162.13 toks/s, output: 82.19 toks/s]
Processed prompts:  94%|█████████▍| 3868/4096 [00:47<00:03, 67.37it/s, est. speed input: 84006.51 toks/s, output: 82.04 toks/s]
Processed prompts:  95%|█████████▌| 3900/4096 [00:47<00:02, 67.31it/s, est. speed input: 83854.07 toks/s, output: 81.89 toks/s]
Processed prompts:  96%|█████████▌| 3932/4096 [00:48<00:02, 67.24it/s, est. speed input: 83703.73 toks/s, output: 81.74 toks/s]
Processed prompts:  97%|█████████▋| 3964/4096 [00:48<00:01, 67.27it/s, est. speed input: 83559.30 toks/s, output: 81.60 toks/s]
Processed prompts:  98%|█████████▊| 3996/4096 [00:49<00:01, 67.18it/s, est. speed input: 83413.40 toks/s, output: 81.46 toks/s]
Processed prompts:  98%|█████████▊| 4028/4096 [00:49<00:01, 67.82it/s, est. speed input: 83297.89 toks/s, output: 81.35 toks/s]
Processed prompts:  99%|█████████▉| 4060/4096 [00:49<00:00, 67.80it/s, est. speed input: 83166.38 toks/s, output: 81.22 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [00:50<00:00, 67.80it/s, est. speed input: 83763.98 toks/s, output: 81.80 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [00:50<00:00, 81.80it/s, est. speed input: 83763.98 toks/s, output: 81.80 toks/s]
[rank0]:[W125 18:03:38.704856204 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=65536 ==========
Time: 2026-01-25 18:03:40
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=8192, max_num_seqs=64
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Llama3.2-3B-INT8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 8192 --max-num-seqs 64 --max-model-len 1025 --max-num-batched-tokens 65536 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/Llama3.2-3B-INT8_M65536.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 18:04:31 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=283335) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=283335) WARNING 01-25 18:04:50 [backends.py:609] Failed to read file <frozen os>
Throughput: 67.81 requests/s, 69508.40 total tokens/s, 67.81 output tokens/s
Total num prompt tokens:  8388608
Total num output tokens:  8192

STDERR:
[2026-01-25 18:04:31] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:04:31] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 18:04:31] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 18:04:31] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:04:31] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:04:31] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:04:31] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:04:31] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:04:31] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 18:04:31] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:04:31] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:04:31] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:04:31] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:04:31] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 18:04:39] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 18:04:39] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-3B-INT8'
[2026-01-25 18:04:39] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-3B-INT8
[2026-01-25 18:04:39] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:04:39] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:04:39] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:04:39] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:04:39] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-3B-INT8
[2026-01-25 18:04:39] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-3B-INT8'
[2026-01-25 18:04:39] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 18:04:39] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 18:04:39] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 18:04:39] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 18:04:39] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=283335) [2026-01-25 18:04:41] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=283335) [2026-01-25 18:04:41] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=283335) [2026-01-25 18:04:41] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=283335) [2026-01-25 18:04:41] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=283335) [2026-01-25 18:04:41] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-3B-INT8
(EngineCore_DP0 pid=283335) [2026-01-25 18:04:41] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=283335) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=283335) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.33it/s]
(EngineCore_DP0 pid=283335) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.33it/s]
(EngineCore_DP0 pid=283335) 
(EngineCore_DP0 pid=283335) [2026-01-25 18:04:41] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 3072] -> 1D uint8
(EngineCore_DP0 pid=283335) [2026-01-25 18:04:41] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 11796480 bytes
(EngineCore_DP0 pid=283335) [2026-01-25 18:04:41] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 3072] -> 1D uint8
(EngineCore_DP0 pid=283335) [2026-01-25 18:04:41] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7077888 bytes
(EngineCore_DP0 pid=283335) [2026-01-25 18:04:41] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 3072] -> 1D uint8
(EngineCore_DP0 pid=283335) [2026-01-25 18:04:41] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 37748736 bytes
(EngineCore_DP0 pid=283335) [2026-01-25 18:04:41] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 8192] -> 1D uint8
(EngineCore_DP0 pid=283335) [2026-01-25 18:04:41] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 18874368 bytes
(EngineCore_DP0 pid=283335) [rank0]:W0125 18:04:59.813000 283335 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=283335) [rank0]:W0125 18:04:59.950000 283335 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=283335) [rank0]:W0125 18:05:01.321000 283335 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=283335) [rank0]:W0125 18:05:01.533000 283335 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=283335) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/19 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   5%|▌         | 1/19 [00:00<00:05,  3.32it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  11%|█         | 2/19 [00:00<00:06,  2.55it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  16%|█▌        | 3/19 [00:00<00:04,  3.86it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  26%|██▋       | 5/19 [00:01<00:02,  5.99it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  37%|███▋      | 7/19 [00:01<00:01,  7.56it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  47%|████▋     | 9/19 [00:01<00:01,  8.62it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  58%|█████▊    | 11/19 [00:01<00:00,  9.30it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  68%|██████▊   | 13/19 [00:01<00:00,  9.71it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  79%|███████▉  | 15/19 [00:01<00:00,  9.91it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  89%|████████▉ | 17/19 [00:02<00:00, 10.26it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 19/19 [00:02<00:00, 10.10it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 19/19 [00:02<00:00,  8.04it/s]
(EngineCore_DP0 pid=283335) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):   9%|▉         | 1/11 [00:00<00:01,  9.09it/s]
Capturing CUDA graphs (decode, FULL):  27%|██▋       | 3/11 [00:00<00:00, 10.50it/s]
Capturing CUDA graphs (decode, FULL):  45%|████▌     | 5/11 [00:00<00:00, 10.83it/s]
Capturing CUDA graphs (decode, FULL):  64%|██████▎   | 7/11 [00:00<00:00, 10.89it/s]
Capturing CUDA graphs (decode, FULL):  82%|████████▏ | 9/11 [00:00<00:00, 10.84it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 11/11 [00:01<00:00, 10.92it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 11/11 [00:01<00:00, 10.80it/s]

Adding requests:   0%|          | 0/8192 [00:00<?, ?it/s]
Adding requests:   0%|          | 35/8192 [00:00<00:23, 347.84it/s]
Adding requests:   1%|          | 73/8192 [00:00<00:22, 361.76it/s]
Adding requests:   1%|▏         | 110/8192 [00:00<00:22, 360.92it/s]
Adding requests:   2%|▏         | 147/8192 [00:00<00:22, 355.99it/s]
Adding requests:   2%|▏         | 183/8192 [00:00<00:22, 357.32it/s]
Adding requests:   3%|▎         | 220/8192 [00:00<00:22, 360.66it/s]
Adding requests:   3%|▎         | 258/8192 [00:00<00:21, 364.46it/s]
Adding requests:   4%|▎         | 295/8192 [00:00<00:21, 362.14it/s]
Adding requests:   4%|▍         | 332/8192 [00:00<00:21, 360.24it/s]
Adding requests:   5%|▍         | 369/8192 [00:01<00:21, 361.53it/s]
Adding requests:   5%|▍         | 406/8192 [00:01<00:21, 361.67it/s]
Adding requests:   5%|▌         | 443/8192 [00:01<00:21, 361.83it/s]
Adding requests:   6%|▌         | 480/8192 [00:01<00:21, 363.52it/s]
Adding requests:   6%|▋         | 518/8192 [00:01<00:21, 363.67it/s]
Adding requests:   7%|▋         | 555/8192 [00:01<00:21, 362.16it/s]
Adding requests:   7%|▋         | 594/8192 [00:01<00:20, 367.73it/s]
Adding requests:   8%|▊         | 633/8192 [00:01<00:20, 373.12it/s]
Adding requests:   8%|▊         | 672/8192 [00:01<00:19, 377.49it/s]
Adding requests:   9%|▊         | 712/8192 [00:01<00:19, 381.65it/s]
Adding requests:   9%|▉         | 751/8192 [00:02<00:19, 382.22it/s]
Adding requests:  10%|▉         | 790/8192 [00:02<00:19, 374.05it/s]
Adding requests:  10%|█         | 828/8192 [00:02<00:20, 367.51it/s]
Adding requests:  11%|█         | 867/8192 [00:02<00:19, 372.67it/s]
Adding requests:  11%|█         | 907/8192 [00:02<00:19, 377.35it/s]
Adding requests:  12%|█▏        | 945/8192 [00:02<00:19, 378.02it/s]
Adding requests:  12%|█▏        | 984/8192 [00:02<00:18, 379.95it/s]
Adding requests:  13%|█▎        | 1025/8192 [00:02<00:18, 387.69it/s]
Adding requests:  13%|█▎        | 1064/8192 [00:02<00:18, 385.08it/s]
Adding requests:  13%|█▎        | 1103/8192 [00:02<00:18, 383.99it/s]
Adding requests:  14%|█▍        | 1142/8192 [00:03<00:18, 377.80it/s]
Adding requests:  14%|█▍        | 1182/8192 [00:03<00:18, 382.78it/s]
Adding requests:  15%|█▍        | 1222/8192 [00:03<00:18, 386.85it/s]
Adding requests:  15%|█▌        | 1261/8192 [00:03<00:18, 378.92it/s]
Adding requests:  16%|█▌        | 1299/8192 [00:03<00:18, 378.01it/s]
Adding requests:  16%|█▋        | 1339/8192 [00:03<00:17, 382.57it/s]
Adding requests:  17%|█▋        | 1379/8192 [00:03<00:17, 386.94it/s]
Adding requests:  17%|█▋        | 1418/8192 [00:03<00:17, 384.95it/s]
Adding requests:  18%|█▊        | 1457/8192 [00:03<00:17, 383.05it/s]
Adding requests:  18%|█▊        | 1496/8192 [00:04<00:17, 381.45it/s]
Adding requests:  19%|█▊        | 1535/8192 [00:04<00:17, 383.09it/s]
Adding requests:  19%|█▉        | 1574/8192 [00:04<00:17, 381.29it/s]
Adding requests:  20%|█▉        | 1613/8192 [00:04<00:17, 383.73it/s]
Adding requests:  20%|██        | 1654/8192 [00:04<00:16, 389.27it/s]
Adding requests:  21%|██        | 1693/8192 [00:04<00:16, 385.49it/s]
Adding requests:  21%|██        | 1734/8192 [00:04<00:16, 391.16it/s]
Adding requests:  22%|██▏       | 1774/8192 [00:04<00:16, 383.77it/s]
Adding requests:  22%|██▏       | 1813/8192 [00:04<00:16, 382.17it/s]
Adding requests:  23%|██▎       | 1852/8192 [00:04<00:16, 382.54it/s]
Adding requests:  23%|██▎       | 1891/8192 [00:05<00:16, 381.12it/s]
Adding requests:  24%|██▎       | 1930/8192 [00:05<00:16, 378.19it/s]
Adding requests:  24%|██▍       | 1968/8192 [00:05<00:16, 375.22it/s]
Adding requests:  25%|██▍       | 2008/8192 [00:05<00:16, 380.84it/s]
Adding requests:  25%|██▍       | 2047/8192 [00:05<00:16, 376.97it/s]
Adding requests:  25%|██▌       | 2085/8192 [00:05<00:16, 376.28it/s]
Adding requests:  26%|██▌       | 2123/8192 [00:05<00:16, 373.08it/s]
Adding requests:  26%|██▋       | 2161/8192 [00:05<00:16, 367.35it/s]
Adding requests:  27%|██▋       | 2199/8192 [00:05<00:16, 368.64it/s]
Adding requests:  27%|██▋       | 2239/8192 [00:05<00:15, 375.30it/s]
Adding requests:  28%|██▊       | 2277/8192 [00:06<00:15, 372.13it/s]
Adding requests:  28%|██▊       | 2315/8192 [00:06<00:15, 373.62it/s]
Adding requests:  29%|██▊       | 2353/8192 [00:06<00:15, 371.25it/s]
Adding requests:  29%|██▉       | 2391/8192 [00:06<00:15, 371.06it/s]
Adding requests:  30%|██▉       | 2429/8192 [00:06<00:15, 371.79it/s]
Adding requests:  30%|███       | 2467/8192 [00:06<00:15, 368.79it/s]
Adding requests:  31%|███       | 2505/8192 [00:06<00:15, 371.44it/s]
Adding requests:  31%|███       | 2544/8192 [00:06<00:15, 375.08it/s]
Adding requests:  32%|███▏      | 2583/8192 [00:06<00:14, 378.25it/s]
Adding requests:  32%|███▏      | 2621/8192 [00:06<00:14, 377.64it/s]
Adding requests:  32%|███▏      | 2659/8192 [00:07<00:14, 377.27it/s]
Adding requests:  33%|███▎      | 2697/8192 [00:07<00:14, 368.29it/s]
Adding requests:  33%|███▎      | 2734/8192 [00:07<00:14, 364.78it/s]
Adding requests:  34%|███▍      | 2773/8192 [00:07<00:14, 369.62it/s]
Adding requests:  34%|███▍      | 2810/8192 [00:07<00:14, 368.86it/s]
Adding requests:  35%|███▍      | 2848/8192 [00:07<00:14, 370.25it/s]
Adding requests:  35%|███▌      | 2887/8192 [00:07<00:14, 374.56it/s]
Adding requests:  36%|███▌      | 2925/8192 [00:07<00:14, 367.70it/s]
Adding requests:  36%|███▌      | 2962/8192 [00:07<00:14, 367.61it/s]
Adding requests:  37%|███▋      | 3000/8192 [00:08<00:14, 369.79it/s]
Adding requests:  37%|███▋      | 3039/8192 [00:08<00:13, 374.10it/s]
Adding requests:  38%|███▊      | 3077/8192 [00:08<00:14, 358.31it/s]
Adding requests:  38%|███▊      | 3116/8192 [00:08<00:13, 365.36it/s]
Adding requests:  38%|███▊      | 3153/8192 [00:08<00:13, 364.60it/s]
Adding requests:  39%|███▉      | 3190/8192 [00:08<00:13, 363.13it/s]
Adding requests:  39%|███▉      | 3227/8192 [00:08<00:13, 364.41it/s]
Adding requests:  40%|███▉      | 3266/8192 [00:08<00:13, 369.76it/s]
Adding requests:  40%|████      | 3304/8192 [00:08<00:13, 370.26it/s]
Adding requests:  41%|████      | 3344/8192 [00:08<00:12, 377.32it/s]
Adding requests:  41%|████▏     | 3382/8192 [00:09<00:12, 376.22it/s]
Adding requests:  42%|████▏     | 3420/8192 [00:09<00:12, 376.50it/s]
Adding requests:  42%|████▏     | 3458/8192 [00:09<00:12, 366.73it/s]
Adding requests:  43%|████▎     | 3495/8192 [00:09<00:12, 365.20it/s]
Adding requests:  43%|████▎     | 3532/8192 [00:09<00:12, 364.01it/s]
Adding requests:  44%|████▎     | 3569/8192 [00:09<00:12, 362.89it/s]
Adding requests:  44%|████▍     | 3606/8192 [00:09<00:12, 364.39it/s]
Adding requests:  44%|████▍     | 3643/8192 [00:09<00:12, 364.58it/s]
Adding requests:  45%|████▍     | 3680/8192 [00:09<00:12, 366.12it/s]
Adding requests:  45%|████▌     | 3717/8192 [00:09<00:12, 365.64it/s]
Adding requests:  46%|████▌     | 3754/8192 [00:10<00:12, 366.49it/s]
Adding requests:  46%|████▋     | 3793/8192 [00:10<00:11, 371.27it/s]
Adding requests:  47%|████▋     | 3831/8192 [00:10<00:11, 369.50it/s]
Adding requests:  47%|████▋     | 3869/8192 [00:10<00:11, 371.93it/s]
Adding requests:  48%|████▊     | 3907/8192 [00:10<00:11, 369.88it/s]
Adding requests:  48%|████▊     | 3945/8192 [00:10<00:11, 370.17it/s]
Adding requests:  49%|████▊     | 3983/8192 [00:10<00:11, 368.80it/s]
Adding requests:  49%|████▉     | 4021/8192 [00:10<00:11, 370.84it/s]
Adding requests:  50%|████▉     | 4059/8192 [00:10<00:11, 366.11it/s]
Adding requests:  50%|█████     | 4098/8192 [00:10<00:11, 371.10it/s]
Adding requests:  51%|█████     | 4138/8192 [00:11<00:10, 378.71it/s]
Adding requests:  51%|█████     | 4177/8192 [00:11<00:10, 380.50it/s]
Adding requests:  51%|█████▏    | 4216/8192 [00:11<00:10, 376.55it/s]
Adding requests:  52%|█████▏    | 4256/8192 [00:11<00:10, 380.41it/s]
Adding requests:  52%|█████▏    | 4295/8192 [00:11<00:10, 372.93it/s]
Adding requests:  53%|█████▎    | 4334/8192 [00:11<00:10, 376.97it/s]
Adding requests:  53%|█████▎    | 4372/8192 [00:11<00:10, 376.93it/s]
Adding requests:  54%|█████▍    | 4410/8192 [00:11<00:10, 364.29it/s]
Adding requests:  54%|█████▍    | 4447/8192 [00:11<00:10, 364.19it/s]
Adding requests:  55%|█████▍    | 4484/8192 [00:12<00:10, 362.80it/s]
Adding requests:  55%|█████▌    | 4523/8192 [00:12<00:09, 370.04it/s]
Adding requests:  56%|█████▌    | 4562/8192 [00:12<00:09, 375.15it/s]
Adding requests:  56%|█████▌    | 4600/8192 [00:12<00:09, 375.38it/s]
Adding requests:  57%|█████▋    | 4638/8192 [00:12<00:09, 373.00it/s]
Adding requests:  57%|█████▋    | 4676/8192 [00:12<00:09, 369.31it/s]
Adding requests:  58%|█████▊    | 4714/8192 [00:12<00:09, 369.28it/s]
Adding requests:  58%|█████▊    | 4751/8192 [00:12<00:09, 369.40it/s]
Adding requests:  58%|█████▊    | 4790/8192 [00:12<00:09, 374.67it/s]
Adding requests:  59%|█████▉    | 4828/8192 [00:12<00:09, 372.82it/s]
Adding requests:  59%|█████▉    | 4866/8192 [00:13<00:08, 373.95it/s]
Adding requests:  60%|█████▉    | 4904/8192 [00:13<00:08, 373.08it/s]
Adding requests:  60%|██████    | 4944/8192 [00:13<00:08, 379.02it/s]
Adding requests:  61%|██████    | 4982/8192 [00:13<00:08, 377.76it/s]
Adding requests:  61%|██████▏   | 5020/8192 [00:13<00:08, 377.78it/s]
Adding requests:  62%|██████▏   | 5058/8192 [00:13<00:08, 371.99it/s]
Adding requests:  62%|██████▏   | 5096/8192 [00:13<00:08, 374.15it/s]
Adding requests:  63%|██████▎   | 5134/8192 [00:13<00:08, 374.49it/s]
Adding requests:  63%|██████▎   | 5172/8192 [00:13<00:08, 374.60it/s]
Adding requests:  64%|██████▎   | 5211/8192 [00:13<00:07, 375.71it/s]
Adding requests:  64%|██████▍   | 5249/8192 [00:14<00:07, 373.38it/s]
Adding requests:  65%|██████▍   | 5287/8192 [00:14<00:07, 373.60it/s]
Adding requests:  65%|██████▌   | 5327/8192 [00:14<00:07, 379.84it/s]
Adding requests:  66%|██████▌   | 5366/8192 [00:14<00:07, 380.86it/s]
Adding requests:  66%|██████▌   | 5405/8192 [00:14<00:07, 375.99it/s]
Adding requests:  66%|██████▋   | 5443/8192 [00:14<00:07, 373.83it/s]
Adding requests:  67%|██████▋   | 5481/8192 [00:14<00:07, 375.39it/s]
Adding requests:  67%|██████▋   | 5519/8192 [00:14<00:07, 370.18it/s]
Adding requests:  68%|██████▊   | 5557/8192 [00:14<00:07, 372.76it/s]
Adding requests:  68%|██████▊   | 5595/8192 [00:14<00:06, 374.63it/s]
Adding requests:  69%|██████▉   | 5633/8192 [00:15<00:06, 372.77it/s]
Adding requests:  69%|██████▉   | 5671/8192 [00:15<00:06, 368.10it/s]
Adding requests:  70%|██████▉   | 5711/8192 [00:15<00:06, 376.69it/s]
Adding requests:  70%|███████   | 5749/8192 [00:15<00:06, 368.63it/s]
Adding requests:  71%|███████   | 5786/8192 [00:15<00:06, 368.25it/s]
Adding requests:  71%|███████   | 5823/8192 [00:15<00:06, 364.86it/s]
Adding requests:  72%|███████▏  | 5861/8192 [00:15<00:06, 367.64it/s]
Adding requests:  72%|███████▏  | 5901/8192 [00:15<00:06, 374.78it/s]
Adding requests:  72%|███████▏  | 5939/8192 [00:15<00:06, 374.56it/s]
Adding requests:  73%|███████▎  | 5977/8192 [00:16<00:05, 372.24it/s]
Adding requests:  73%|███████▎  | 6017/8192 [00:16<00:05, 375.35it/s]
Adding requests:  74%|███████▍  | 6058/8192 [00:16<00:05, 382.52it/s]
Adding requests:  74%|███████▍  | 6097/8192 [00:16<00:05, 375.66it/s]
Adding requests:  75%|███████▍  | 6135/8192 [00:16<00:05, 375.37it/s]
Adding requests:  75%|███████▌  | 6173/8192 [00:16<00:05, 372.96it/s]
Adding requests:  76%|███████▌  | 6212/8192 [00:16<00:05, 375.52it/s]
Adding requests:  76%|███████▋  | 6251/8192 [00:16<00:05, 376.51it/s]
Adding requests:  77%|███████▋  | 6290/8192 [00:16<00:05, 378.19it/s]
Adding requests:  77%|███████▋  | 6329/8192 [00:16<00:04, 379.62it/s]
Adding requests:  78%|███████▊  | 6369/8192 [00:17<00:04, 383.46it/s]
Adding requests:  78%|███████▊  | 6408/8192 [00:17<00:04, 382.02it/s]
Adding requests:  79%|███████▊  | 6450/8192 [00:17<00:04, 390.86it/s]
Adding requests:  79%|███████▉  | 6490/8192 [00:17<00:04, 392.08it/s]
Adding requests:  80%|███████▉  | 6531/8192 [00:17<00:04, 397.07it/s]
Adding requests:  80%|████████  | 6571/8192 [00:17<00:04, 392.89it/s]
Adding requests:  81%|████████  | 6611/8192 [00:17<00:04, 383.45it/s]
Adding requests:  81%|████████  | 6650/8192 [00:17<00:04, 379.66it/s]
Adding requests:  82%|████████▏ | 6689/8192 [00:17<00:04, 375.50it/s]
Adding requests:  82%|████████▏ | 6728/8192 [00:17<00:03, 377.18it/s]
Adding requests:  83%|████████▎ | 6766/8192 [00:18<00:03, 374.73it/s]
Adding requests:  83%|████████▎ | 6805/8192 [00:18<00:03, 377.94it/s]
Adding requests:  84%|████████▎ | 6843/8192 [00:18<00:03, 378.45it/s]
Adding requests:  84%|████████▍ | 6882/8192 [00:18<00:03, 381.43it/s]
Adding requests:  84%|████████▍ | 6922/8192 [00:18<00:03, 384.15it/s]
Adding requests:  85%|████████▍ | 6961/8192 [00:18<00:03, 382.86it/s]
Adding requests:  85%|████████▌ | 7000/8192 [00:18<00:03, 379.59it/s]
Adding requests:  86%|████████▌ | 7038/8192 [00:18<00:03, 377.10it/s]
Adding requests:  86%|████████▋ | 7076/8192 [00:18<00:03, 364.72it/s]
Adding requests:  87%|████████▋ | 7114/8192 [00:19<00:02, 367.45it/s]
Adding requests:  87%|████████▋ | 7151/8192 [00:19<00:02, 368.04it/s]
Adding requests:  88%|████████▊ | 7188/8192 [00:19<00:02, 367.76it/s]
Adding requests:  88%|████████▊ | 7226/8192 [00:19<00:02, 370.79it/s]
Adding requests:  89%|████████▊ | 7264/8192 [00:19<00:02, 372.55it/s]
Adding requests:  89%|████████▉ | 7302/8192 [00:19<00:02, 373.07it/s]
Adding requests:  90%|████████▉ | 7341/8192 [00:19<00:02, 377.54it/s]
Adding requests:  90%|█████████ | 7381/8192 [00:19<00:02, 383.93it/s]
Adding requests:  91%|█████████ | 7420/8192 [00:19<00:02, 381.26it/s]
Adding requests:  91%|█████████ | 7459/8192 [00:19<00:01, 380.07it/s]
Adding requests:  92%|█████████▏| 7498/8192 [00:20<00:01, 377.22it/s]
Adding requests:  92%|█████████▏| 7536/8192 [00:20<00:01, 374.49it/s]
Adding requests:  92%|█████████▏| 7574/8192 [00:20<00:01, 373.70it/s]
Adding requests:  93%|█████████▎| 7612/8192 [00:20<00:01, 371.84it/s]
Adding requests:  93%|█████████▎| 7651/8192 [00:20<00:01, 376.41it/s]
Adding requests:  94%|█████████▍| 7689/8192 [00:20<00:01, 377.02it/s]
Adding requests:  94%|█████████▍| 7727/8192 [00:20<00:01, 376.18it/s]
Adding requests:  95%|█████████▍| 7765/8192 [00:20<00:01, 372.58it/s]
Adding requests:  95%|█████████▌| 7803/8192 [00:20<00:01, 368.36it/s]
Adding requests:  96%|█████████▌| 7842/8192 [00:20<00:00, 372.35it/s]
Adding requests:  96%|█████████▌| 7880/8192 [00:21<00:00, 367.63it/s]
Adding requests:  97%|█████████▋| 7917/8192 [00:21<00:00, 364.39it/s]
Adding requests:  97%|█████████▋| 7955/8192 [00:21<00:00, 366.88it/s]
Adding requests:  98%|█████████▊| 7994/8192 [00:21<00:00, 371.83it/s]
Adding requests:  98%|█████████▊| 8032/8192 [00:21<00:00, 370.26it/s]
Adding requests:  99%|█████████▊| 8071/8192 [00:21<00:00, 374.52it/s]
Adding requests:  99%|█████████▉| 8111/8192 [00:21<00:00, 380.31it/s]
Adding requests:  99%|█████████▉| 8150/8192 [00:21<00:00, 381.07it/s]
Adding requests: 100%|█████████▉| 8189/8192 [00:21<00:00, 379.10it/s]
Adding requests: 100%|██████████| 8192/8192 [00:21<00:00, 374.02it/s]

Processed prompts:   0%|          | 0/8192 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  18%|█▊        | 1498/8192 [00:00<00:04, 1553.51it/s, est. speed input: 1590839.55 toks/s, output: 1553.52 toks/s]
Processed prompts:  20%|██        | 1654/8192 [00:02<00:13, 472.03it/s, est. speed input: 596108.47 toks/s, output: 582.14 toks/s]   
Processed prompts:  21%|██        | 1723/8192 [00:03<00:19, 334.59it/s, est. speed input: 466608.55 toks/s, output: 455.67 toks/s]
Processed prompts:  22%|██▏       | 1764/8192 [00:04<00:26, 238.70it/s, est. speed input: 382723.03 toks/s, output: 373.75 toks/s]
Processed prompts:  22%|██▏       | 1818/8192 [00:05<00:35, 181.42it/s, est. speed input: 329697.25 toks/s, output: 321.97 toks/s]
Processed prompts:  23%|██▎       | 1882/8192 [00:06<00:43, 145.76it/s, est. speed input: 292637.33 toks/s, output: 285.78 toks/s]
Processed prompts:  24%|██▍       | 1946/8192 [00:07<00:51, 122.18it/s, est. speed input: 265253.13 toks/s, output: 259.04 toks/s]
Processed prompts:  25%|██▍       | 2010/8192 [00:08<00:58, 105.49it/s, est. speed input: 243493.82 toks/s, output: 237.79 toks/s]
Processed prompts:  25%|██▌       | 2074/8192 [00:09<01:05, 94.04it/s, est. speed input: 226090.30 toks/s, output: 220.79 toks/s] 
Processed prompts:  26%|██▌       | 2138/8192 [00:10<01:10, 86.17it/s, est. speed input: 211873.90 toks/s, output: 206.91 toks/s]
Processed prompts:  27%|██▋       | 2202/8192 [00:11<01:13, 81.37it/s, est. speed input: 200477.61 toks/s, output: 195.78 toks/s]
Processed prompts:  28%|██▊       | 2266/8192 [00:12<01:16, 77.61it/s, est. speed input: 190562.12 toks/s, output: 186.10 toks/s]
Processed prompts:  28%|██▊       | 2330/8192 [00:13<01:18, 74.96it/s, est. speed input: 182042.59 toks/s, output: 177.78 toks/s]
Processed prompts:  29%|██▉       | 2394/8192 [00:14<01:19, 72.84it/s, est. speed input: 174506.46 toks/s, output: 170.42 toks/s]
Processed prompts:  30%|███       | 2458/8192 [00:14<01:19, 71.68it/s, est. speed input: 168067.80 toks/s, output: 164.13 toks/s]
Processed prompts:  31%|███       | 2522/8192 [00:15<01:20, 70.54it/s, est. speed input: 162236.19 toks/s, output: 158.43 toks/s]
Processed prompts:  32%|███▏      | 2586/8192 [00:16<01:20, 70.04it/s, est. speed input: 157177.78 toks/s, output: 153.49 toks/s]
Processed prompts:  32%|███▏      | 2650/8192 [00:17<01:19, 69.37it/s, est. speed input: 152523.95 toks/s, output: 148.95 toks/s]
Processed prompts:  33%|███▎      | 2714/8192 [00:18<01:19, 68.95it/s, est. speed input: 148355.91 toks/s, output: 144.88 toks/s]
Processed prompts:  34%|███▍      | 2778/8192 [00:19<01:18, 68.61it/s, est. speed input: 144572.70 toks/s, output: 141.18 toks/s]
Processed prompts:  35%|███▍      | 2842/8192 [00:20<01:18, 68.37it/s, est. speed input: 141133.16 toks/s, output: 137.83 toks/s]
Processed prompts:  35%|███▌      | 2906/8192 [00:21<01:17, 68.16it/s, est. speed input: 137984.04 toks/s, output: 134.75 toks/s]
Processed prompts:  36%|███▋      | 2970/8192 [00:22<01:16, 68.07it/s, est. speed input: 135112.33 toks/s, output: 131.95 toks/s]
Processed prompts:  37%|███▋      | 3034/8192 [00:23<01:15, 67.98it/s, est. speed input: 132468.06 toks/s, output: 129.36 toks/s]
Processed prompts:  38%|███▊      | 3098/8192 [00:24<01:14, 68.18it/s, est. speed input: 130091.83 toks/s, output: 127.04 toks/s]
Processed prompts:  39%|███▊      | 3162/8192 [00:25<01:13, 68.02it/s, est. speed input: 127820.68 toks/s, output: 124.82 toks/s]
Processed prompts:  39%|███▉      | 3226/8192 [00:26<01:13, 67.92it/s, est. speed input: 125715.07 toks/s, output: 122.77 toks/s]
Processed prompts:  40%|████      | 3290/8192 [00:27<01:12, 67.87it/s, est. speed input: 123760.25 toks/s, output: 120.86 toks/s]
Processed prompts:  41%|████      | 3354/8192 [00:28<01:11, 67.85it/s, est. speed input: 121939.55 toks/s, output: 119.08 toks/s]
Processed prompts:  42%|████▏     | 3418/8192 [00:29<01:10, 67.83it/s, est. speed input: 120236.40 toks/s, output: 117.42 toks/s]
Processed prompts:  43%|████▎     | 3482/8192 [00:30<01:09, 67.83it/s, est. speed input: 118642.18 toks/s, output: 115.86 toks/s]
Processed prompts:  43%|████▎     | 3546/8192 [00:30<01:08, 67.79it/s, est. speed input: 117137.13 toks/s, output: 114.39 toks/s]
Processed prompts:  44%|████▍     | 3610/8192 [00:31<01:07, 67.74it/s, est. speed input: 115717.80 toks/s, output: 113.01 toks/s]
Processed prompts:  45%|████▍     | 3674/8192 [00:32<01:06, 67.73it/s, est. speed input: 114385.68 toks/s, output: 111.70 toks/s]
Processed prompts:  46%|████▌     | 3738/8192 [00:33<01:05, 67.99it/s, est. speed input: 113168.63 toks/s, output: 110.52 toks/s]
Processed prompts:  46%|████▋     | 3802/8192 [00:34<01:04, 67.88it/s, est. speed input: 111973.42 toks/s, output: 109.35 toks/s]
Processed prompts:  47%|████▋     | 3866/8192 [00:35<01:03, 67.80it/s, est. speed input: 110840.71 toks/s, output: 108.24 toks/s]
Processed prompts:  48%|████▊     | 3930/8192 [00:36<01:02, 67.75it/s, est. speed input: 109767.62 toks/s, output: 107.19 toks/s]
Processed prompts:  49%|████▉     | 3994/8192 [00:37<01:01, 67.96it/s, est. speed input: 108780.79 toks/s, output: 106.23 toks/s]
Processed prompts:  50%|████▉     | 4058/8192 [00:38<01:00, 67.85it/s, est. speed input: 107809.27 toks/s, output: 105.28 toks/s]
Processed prompts:  50%|█████     | 4122/8192 [00:39<01:00, 67.75it/s, est. speed input: 106880.91 toks/s, output: 104.38 toks/s]
Processed prompts:  51%|█████     | 4186/8192 [00:40<00:58, 67.93it/s, est. speed input: 106027.19 toks/s, output: 103.54 toks/s]
Processed prompts:  52%|█████▏    | 4250/8192 [00:41<00:57, 68.11it/s, est. speed input: 105217.32 toks/s, output: 102.75 toks/s]
Processed prompts:  53%|█████▎    | 4314/8192 [00:42<00:56, 68.19it/s, est. speed input: 104438.78 toks/s, output: 101.99 toks/s]
Processed prompts:  53%|█████▎    | 4378/8192 [00:43<00:56, 68.00it/s, est. speed input: 103666.52 toks/s, output: 101.24 toks/s]
Processed prompts:  54%|█████▍    | 4442/8192 [00:44<00:55, 67.87it/s, est. speed input: 102927.55 toks/s, output: 100.52 toks/s]
Processed prompts:  55%|█████▌    | 4506/8192 [00:45<00:54, 67.81it/s, est. speed input: 102222.96 toks/s, output: 99.83 toks/s] 
Processed prompts:  56%|█████▌    | 4570/8192 [00:46<00:53, 67.70it/s, est. speed input: 101539.99 toks/s, output: 99.16 toks/s]
Processed prompts:  57%|█████▋    | 4634/8192 [00:47<00:52, 67.64it/s, est. speed input: 100886.79 toks/s, output: 98.52 toks/s]
Processed prompts:  57%|█████▋    | 4698/8192 [00:47<00:51, 67.62it/s, est. speed input: 100260.91 toks/s, output: 97.91 toks/s]
Processed prompts:  58%|█████▊    | 4762/8192 [00:48<00:50, 67.85it/s, est. speed input: 99682.94 toks/s, output: 97.35 toks/s] 
Processed prompts:  59%|█████▉    | 4826/8192 [00:49<00:49, 68.01it/s, est. speed input: 99125.98 toks/s, output: 96.80 toks/s]
Processed prompts:  60%|█████▉    | 4890/8192 [00:50<00:48, 67.84it/s, est. speed input: 98564.85 toks/s, output: 96.25 toks/s]
Processed prompts:  60%|██████    | 4954/8192 [00:51<00:47, 67.99it/s, est. speed input: 98047.76 toks/s, output: 95.75 toks/s]
Processed prompts:  61%|██████▏   | 5018/8192 [00:52<00:46, 67.80it/s, est. speed input: 97523.41 toks/s, output: 95.24 toks/s]
Processed prompts:  62%|██████▏   | 5082/8192 [00:53<00:45, 67.69it/s, est. speed input: 97019.60 toks/s, output: 94.75 toks/s]
Processed prompts:  63%|██████▎   | 5146/8192 [00:54<00:45, 67.59it/s, est. speed input: 96531.32 toks/s, output: 94.27 toks/s]
Processed prompts:  64%|██████▎   | 5210/8192 [00:55<00:44, 67.54it/s, est. speed input: 96061.18 toks/s, output: 93.81 toks/s]
Processed prompts:  64%|██████▍   | 5274/8192 [00:56<00:43, 67.50it/s, est. speed input: 95606.91 toks/s, output: 93.37 toks/s]
Processed prompts:  65%|██████▌   | 5338/8192 [00:57<00:42, 67.40it/s, est. speed input: 95162.01 toks/s, output: 92.93 toks/s]
Processed prompts:  66%|██████▌   | 5402/8192 [00:58<00:41, 67.48it/s, est. speed input: 94742.78 toks/s, output: 92.52 toks/s]
Processed prompts:  67%|██████▋   | 5466/8192 [00:59<00:40, 67.40it/s, est. speed input: 94326.99 toks/s, output: 92.12 toks/s]
Processed prompts:  68%|██████▊   | 5530/8192 [01:00<00:39, 67.55it/s, est. speed input: 93939.47 toks/s, output: 91.74 toks/s]
Processed prompts:  68%|██████▊   | 5594/8192 [01:01<00:38, 67.56it/s, est. speed input: 93556.65 toks/s, output: 91.36 toks/s]
Processed prompts:  69%|██████▉   | 5658/8192 [01:02<00:37, 67.49it/s, est. speed input: 93180.23 toks/s, output: 91.00 toks/s]
Processed prompts:  70%|██████▉   | 5722/8192 [01:03<00:36, 67.43it/s, est. speed input: 92814.40 toks/s, output: 90.64 toks/s]
Processed prompts:  71%|███████   | 5786/8192 [01:04<00:35, 67.38it/s, est. speed input: 92459.08 toks/s, output: 90.29 toks/s]
Processed prompts:  71%|███████▏  | 5850/8192 [01:05<00:34, 67.33it/s, est. speed input: 92113.17 toks/s, output: 89.95 toks/s]
Processed prompts:  72%|███████▏  | 5914/8192 [01:05<00:33, 67.27it/s, est. speed input: 91775.31 toks/s, output: 89.62 toks/s]
Processed prompts:  73%|███████▎  | 5978/8192 [01:06<00:32, 67.27it/s, est. speed input: 91449.90 toks/s, output: 89.31 toks/s]
Processed prompts:  74%|███████▍  | 6042/8192 [01:07<00:31, 67.26it/s, est. speed input: 91132.96 toks/s, output: 89.00 toks/s]
Processed prompts:  75%|███████▍  | 6106/8192 [01:08<00:31, 67.22it/s, est. speed input: 90823.11 toks/s, output: 88.69 toks/s]
Processed prompts:  75%|███████▌  | 6170/8192 [01:09<00:30, 67.22it/s, est. speed input: 90523.08 toks/s, output: 88.40 toks/s]
Processed prompts:  76%|███████▌  | 6234/8192 [01:10<00:29, 67.17it/s, est. speed input: 90228.36 toks/s, output: 88.11 toks/s]
Processed prompts:  77%|███████▋  | 6298/8192 [01:11<00:28, 67.21it/s, est. speed input: 89945.81 toks/s, output: 87.84 toks/s]
Processed prompts:  78%|███████▊  | 6362/8192 [01:12<00:27, 67.22it/s, est. speed input: 89669.29 toks/s, output: 87.57 toks/s]
Processed prompts:  78%|███████▊  | 6426/8192 [01:13<00:26, 67.21it/s, est. speed input: 89399.42 toks/s, output: 87.30 toks/s]
Processed prompts:  79%|███████▉  | 6490/8192 [01:14<00:25, 67.21it/s, est. speed input: 89136.35 toks/s, output: 87.05 toks/s]
Processed prompts:  80%|████████  | 6554/8192 [01:15<00:24, 67.44it/s, est. speed input: 88892.86 toks/s, output: 86.81 toks/s]
Processed prompts:  81%|████████  | 6618/8192 [01:16<00:23, 67.29it/s, est. speed input: 88638.67 toks/s, output: 86.56 toks/s]
Processed prompts:  82%|████████▏ | 6682/8192 [01:17<00:22, 67.50it/s, est. speed input: 88407.22 toks/s, output: 86.34 toks/s]
Processed prompts:  82%|████████▏ | 6746/8192 [01:18<00:21, 67.35it/s, est. speed input: 88166.15 toks/s, output: 86.10 toks/s]
Processed prompts:  83%|████████▎ | 6810/8192 [01:19<00:20, 67.37it/s, est. speed input: 87937.25 toks/s, output: 85.88 toks/s]
Processed prompts:  84%|████████▍ | 6874/8192 [01:20<00:19, 67.26it/s, est. speed input: 87707.03 toks/s, output: 85.65 toks/s]
Processed prompts:  85%|████████▍ | 6938/8192 [01:21<00:18, 67.23it/s, est. speed input: 87484.70 toks/s, output: 85.43 toks/s]
Processed prompts:  85%|████████▌ | 7002/8192 [01:22<00:17, 67.18it/s, est. speed input: 87266.46 toks/s, output: 85.22 toks/s]
Processed prompts:  86%|████████▋ | 7066/8192 [01:23<00:16, 67.13it/s, est. speed input: 87051.90 toks/s, output: 85.01 toks/s]
Processed prompts:  87%|████████▋ | 7130/8192 [01:24<00:15, 67.36it/s, est. speed input: 86855.85 toks/s, output: 84.82 toks/s]
Processed prompts:  88%|████████▊ | 7194/8192 [01:25<00:14, 67.23it/s, est. speed input: 86649.82 toks/s, output: 84.62 toks/s]
Processed prompts:  89%|████████▊ | 7258/8192 [01:25<00:13, 67.45it/s, est. speed input: 86462.88 toks/s, output: 84.44 toks/s]
Processed prompts:  89%|████████▉ | 7322/8192 [01:26<00:12, 67.34it/s, est. speed input: 86267.78 toks/s, output: 84.25 toks/s]
Processed prompts:  90%|█████████ | 7386/8192 [01:27<00:11, 67.54it/s, est. speed input: 86089.59 toks/s, output: 84.07 toks/s]
Processed prompts:  91%|█████████ | 7450/8192 [01:28<00:11, 67.40it/s, est. speed input: 85902.51 toks/s, output: 83.89 toks/s]
Processed prompts:  92%|█████████▏| 7514/8192 [01:29<00:10, 67.29it/s, est. speed input: 85718.98 toks/s, output: 83.71 toks/s]
Processed prompts:  93%|█████████▎| 7578/8192 [01:30<00:09, 67.28it/s, est. speed input: 85542.11 toks/s, output: 83.54 toks/s]
Processed prompts:  93%|█████████▎| 7642/8192 [01:31<00:08, 67.20it/s, est. speed input: 85365.83 toks/s, output: 83.37 toks/s]
Processed prompts:  94%|█████████▍| 7706/8192 [01:32<00:07, 67.16it/s, est. speed input: 85194.16 toks/s, output: 83.20 toks/s]
Processed prompts:  95%|█████████▍| 7770/8192 [01:33<00:06, 67.12it/s, est. speed input: 85025.25 toks/s, output: 83.03 toks/s]
Processed prompts:  96%|█████████▌| 7834/8192 [01:34<00:05, 67.07it/s, est. speed input: 84858.63 toks/s, output: 82.87 toks/s]
Processed prompts:  96%|█████████▋| 7898/8192 [01:35<00:04, 67.11it/s, est. speed input: 84698.59 toks/s, output: 82.71 toks/s]
Processed prompts:  97%|█████████▋| 7962/8192 [01:36<00:03, 67.10it/s, est. speed input: 84540.02 toks/s, output: 82.56 toks/s]
Processed prompts:  98%|█████████▊| 8026/8192 [01:37<00:02, 67.12it/s, est. speed input: 84386.04 toks/s, output: 82.41 toks/s]
Processed prompts:  99%|█████████▉| 8090/8192 [01:38<00:01, 67.37it/s, est. speed input: 84244.35 toks/s, output: 82.27 toks/s]
Processed prompts: 100%|█████████▉| 8154/8192 [01:38<00:00, 76.81it/s, est. speed input: 84429.20 toks/s, output: 82.45 toks/s]
Processed prompts: 100%|██████████| 8192/8192 [01:38<00:00, 76.81it/s, est. speed input: 84822.01 toks/s, output: 82.83 toks/s]
Processed prompts: 100%|██████████| 8192/8192 [01:38<00:00, 82.83it/s, est. speed input: 84822.01 toks/s, output: 82.83 toks/s]
[rank0]:[W125 18:07:15.118325974 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=512 ==========
Time: 2026-01-25 19:21:04
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_4
Params: prompt_len=512, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_4 --dataset-name random --input-len 512 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 513 --max-num-batched-tokens 513 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/Qwen2.5-7B-INT8_M512.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 19:21:12 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=355439) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=355439) WARNING 01-25 19:28:51 [backends.py:609] Failed to read file <frozen os>
Throughput: 20.77 requests/s, 10657.22 total tokens/s, 20.77 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128

STDERR:
[2026-01-25 19:21:12] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 19:21:12] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 19:21:12] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 19:21:12] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:21:12] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:21:12] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:21:12] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:21:12] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:21:12] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 19:21:12] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 19:21:12] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 19:21:12] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 19:21:12] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 19:21:12] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 19:21:19] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 19:21:19] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 19:21:19] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 19:21:19] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:21:19] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:21:19] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:21:19] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:21:19] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:21:19] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 19:21:19] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 19:21:19] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 19:21:19] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 19:21:19] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 19:21:19] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=355439) [2026-01-25 19:21:20] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=355439) [2026-01-25 19:21:20] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=355439) [2026-01-25 19:21:20] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=355439) [2026-01-25 19:21:20] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=355439) [2026-01-25 19:21:20] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=355439) [2026-01-25 19:21:20] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=355439) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=355439) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [04:05<04:05, 245.05s/it]
(EngineCore_DP0 pid=355439) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [07:22<00:00, 216.88s/it]
(EngineCore_DP0 pid=355439) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [07:22<00:00, 221.10s/it]
(EngineCore_DP0 pid=355439) 
(EngineCore_DP0 pid=355439) [2026-01-25 19:28:43] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 3584] -> 1D uint8
(EngineCore_DP0 pid=355439) [2026-01-25 19:28:43] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12386304 bytes
(EngineCore_DP0 pid=355439) [2026-01-25 19:28:43] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 3584] -> 1D uint8
(EngineCore_DP0 pid=355439) [2026-01-25 19:28:43] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9633792 bytes
(EngineCore_DP0 pid=355439) [2026-01-25 19:28:43] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 3584] -> 1D uint8
(EngineCore_DP0 pid=355439) [2026-01-25 19:28:43] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 101842944 bytes
(EngineCore_DP0 pid=355439) [2026-01-25 19:28:43] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 18944] -> 1D uint8
(EngineCore_DP0 pid=355439) [2026-01-25 19:28:43] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 50921472 bytes
(EngineCore_DP0 pid=355439) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  1.64it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:01<00:00,  1.48it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:01<00:00,  1.51it/s]
(EngineCore_DP0 pid=355439) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00, 10.09it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  35%|███▌      | 45/128 [00:00<00:00, 449.70it/s]
Adding requests:  73%|███████▎  | 93/128 [00:00<00:00, 466.57it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 467.85it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:58,  2.16it/s, est. speed input: 1107.63 toks/s, output: 2.16 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:15,  8.03it/s, est. speed input: 3416.83 toks/s, output: 6.67 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:09, 12.29it/s, est. speed input: 4897.89 toks/s, output: 9.57 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:00<00:07, 15.31it/s, est. speed input: 5920.87 toks/s, output: 11.56 toks/s]
Processed prompts:  10%|█         | 13/128 [00:00<00:06, 17.61it/s, est. speed input: 6697.60 toks/s, output: 13.08 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:01<00:05, 19.37it/s, est. speed input: 7311.36 toks/s, output: 14.28 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:01<00:05, 20.61it/s, est. speed input: 7798.09 toks/s, output: 15.23 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:01<00:04, 21.55it/s, est. speed input: 8201.21 toks/s, output: 16.02 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:01<00:04, 22.21it/s, est. speed input: 8536.17 toks/s, output: 16.67 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:01<00:04, 22.75it/s, est. speed input: 8825.11 toks/s, output: 17.24 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:01<00:04, 23.06it/s, est. speed input: 9067.57 toks/s, output: 17.71 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:01<00:04, 22.62it/s, est. speed input: 9216.51 toks/s, output: 18.00 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:02<00:03, 22.79it/s, est. speed input: 9386.86 toks/s, output: 18.33 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:02<00:03, 22.67it/s, est. speed input: 9515.84 toks/s, output: 18.59 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:02<00:03, 22.94it/s, est. speed input: 9658.71 toks/s, output: 18.86 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:02<00:03, 23.13it/s, est. speed input: 9786.54 toks/s, output: 19.11 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:02<00:03, 23.32it/s, est. speed input: 9905.48 toks/s, output: 19.35 toks/s]
Processed prompts:  41%|████      | 52/128 [00:02<00:03, 23.49it/s, est. speed input: 10015.31 toks/s, output: 19.56 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:02<00:03, 23.34it/s, est. speed input: 10097.71 toks/s, output: 19.72 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:02<00:02, 23.38it/s, est. speed input: 10181.79 toks/s, output: 19.89 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:03<00:02, 23.41it/s, est. speed input: 10259.10 toks/s, output: 20.04 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:03<00:02, 23.31it/s, est. speed input: 10322.59 toks/s, output: 20.16 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:03<00:02, 23.44it/s, est. speed input: 10393.11 toks/s, output: 20.30 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:03<00:02, 23.51it/s, est. speed input: 10457.12 toks/s, output: 20.42 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:03<00:02, 23.65it/s, est. speed input: 10521.31 toks/s, output: 20.55 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:03<00:02, 23.61it/s, est. speed input: 10574.05 toks/s, output: 20.65 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:03<00:02, 23.52it/s, est. speed input: 10619.88 toks/s, output: 20.74 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:03<00:01, 23.21it/s, est. speed input: 10650.63 toks/s, output: 20.80 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:04<00:01, 23.29it/s, est. speed input: 10693.51 toks/s, output: 20.89 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:04<00:01, 23.47it/s, est. speed input: 10739.72 toks/s, output: 20.98 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:04<00:01, 23.54it/s, est. speed input: 10780.55 toks/s, output: 21.06 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:04<00:01, 23.64it/s, est. speed input: 10821.55 toks/s, output: 21.14 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:04<00:01, 23.88it/s, est. speed input: 10867.22 toks/s, output: 21.22 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:04<00:01, 23.97it/s, est. speed input: 10907.08 toks/s, output: 21.30 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:04<00:01, 24.01it/s, est. speed input: 10944.03 toks/s, output: 21.37 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:04<00:00, 23.80it/s, est. speed input: 10970.17 toks/s, output: 21.43 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:05<00:00, 23.13it/s, est. speed input: 10974.11 toks/s, output: 21.43 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:05<00:00, 23.16it/s, est. speed input: 10997.01 toks/s, output: 21.48 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:05<00:00, 23.27it/s, est. speed input: 11021.88 toks/s, output: 21.53 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:05<00:00, 23.37it/s, est. speed input: 11046.57 toks/s, output: 21.58 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:05<00:00, 23.57it/s, est. speed input: 11074.87 toks/s, output: 21.63 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:05<00:00, 23.70it/s, est. speed input: 11101.54 toks/s, output: 21.68 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:05<00:00, 23.71it/s, est. speed input: 11124.09 toks/s, output: 21.73 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:05<00:00, 23.71it/s, est. speed input: 11133.14 toks/s, output: 21.74 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:05<00:00, 21.74it/s, est. speed input: 11133.14 toks/s, output: 21.74 toks/s]
[rank0]:[W125 19:29:17.101114947 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=1024 ==========
Time: 2026-01-25 19:29:19
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 1025 --max-num-batched-tokens 1025 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/Qwen2.5-7B-INT8_M1024.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 19:29:28 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=362691) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=362691) WARNING 01-25 19:29:46 [backends.py:609] Failed to read file <frozen os>
Throughput: 21.79 requests/s, 22329.88 total tokens/s, 21.79 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128

STDERR:
[2026-01-25 19:29:28] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 19:29:28] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 19:29:28] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 19:29:28] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:29:28] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:29:28] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:29:28] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:29:28] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:29:28] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 19:29:28] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 19:29:28] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 19:29:28] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 19:29:28] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 19:29:28] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 19:29:35] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 19:29:35] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 19:29:35] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 19:29:35] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:29:35] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:29:35] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:29:35] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:29:35] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:29:35] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 19:29:35] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 19:29:35] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 19:29:35] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 19:29:35] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 19:29:35] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=362691) [2026-01-25 19:29:36] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=362691) [2026-01-25 19:29:36] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=362691) [2026-01-25 19:29:36] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=362691) [2026-01-25 19:29:36] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=362691) [2026-01-25 19:29:36] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=362691) [2026-01-25 19:29:36] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=362691) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=362691) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.81it/s]
(EngineCore_DP0 pid=362691) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.80it/s]
(EngineCore_DP0 pid=362691) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.80it/s]
(EngineCore_DP0 pid=362691) 
(EngineCore_DP0 pid=362691) [2026-01-25 19:29:38] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 3584] -> 1D uint8
(EngineCore_DP0 pid=362691) [2026-01-25 19:29:38] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12386304 bytes
(EngineCore_DP0 pid=362691) [2026-01-25 19:29:38] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 3584] -> 1D uint8
(EngineCore_DP0 pid=362691) [2026-01-25 19:29:38] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9633792 bytes
(EngineCore_DP0 pid=362691) [2026-01-25 19:29:38] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 3584] -> 1D uint8
(EngineCore_DP0 pid=362691) [2026-01-25 19:29:38] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 101842944 bytes
(EngineCore_DP0 pid=362691) [2026-01-25 19:29:38] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 18944] -> 1D uint8
(EngineCore_DP0 pid=362691) [2026-01-25 19:29:38] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 50921472 bytes
(EngineCore_DP0 pid=362691) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00, 10.75it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00, 10.74it/s]
(EngineCore_DP0 pid=362691) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00, 10.19it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  20%|██        | 26/128 [00:00<00:00, 255.20it/s]
Adding requests:  41%|████▏     | 53/128 [00:00<00:00, 259.28it/s]
Adding requests:  63%|██████▎   | 81/128 [00:00<00:00, 266.15it/s]
Adding requests:  84%|████████▍ | 108/128 [00:00<00:00, 261.43it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 263.08it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:02, 49.67it/s, est. speed input: 50873.53 toks/s, output: 49.68 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:00<00:04, 28.94it/s, est. speed input: 31619.59 toks/s, output: 30.88 toks/s]
Processed prompts:  11%|█         | 14/128 [00:00<00:04, 25.82it/s, est. speed input: 28465.05 toks/s, output: 27.80 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:00<00:04, 25.08it/s, est. speed input: 27579.99 toks/s, output: 26.93 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:00<00:04, 24.61it/s, est. speed input: 27004.81 toks/s, output: 26.37 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:00<00:04, 24.18it/s, est. speed input: 26537.48 toks/s, output: 25.92 toks/s]
Processed prompts:  20%|██        | 26/128 [00:01<00:04, 24.07it/s, est. speed input: 26271.14 toks/s, output: 25.65 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:01<00:04, 23.38it/s, est. speed input: 25815.47 toks/s, output: 25.21 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:01<00:04, 23.56it/s, est. speed input: 25693.40 toks/s, output: 25.09 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:01<00:03, 23.39it/s, est. speed input: 25494.06 toks/s, output: 24.90 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:01<00:03, 22.90it/s, est. speed input: 25213.56 toks/s, output: 24.62 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:01<00:03, 23.12it/s, est. speed input: 25139.46 toks/s, output: 24.55 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:01<00:03, 23.38it/s, est. speed input: 25099.30 toks/s, output: 24.51 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:01<00:03, 23.61it/s, est. speed input: 25077.15 toks/s, output: 24.49 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:02<00:03, 23.80it/s, est. speed input: 25063.00 toks/s, output: 24.48 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:02<00:03, 23.82it/s, est. speed input: 25025.66 toks/s, output: 24.44 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:02<00:03, 23.85it/s, est. speed input: 24997.78 toks/s, output: 24.41 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:02<00:02, 23.84it/s, est. speed input: 24966.54 toks/s, output: 24.38 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:02<00:02, 23.25it/s, est. speed input: 24835.31 toks/s, output: 24.25 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:02<00:02, 23.41it/s, est. speed input: 24813.12 toks/s, output: 24.23 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:02<00:02, 23.44it/s, est. speed input: 24778.55 toks/s, output: 24.20 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:02<00:02, 23.03it/s, est. speed input: 24680.79 toks/s, output: 24.10 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:03<00:02, 22.77it/s, est. speed input: 24595.41 toks/s, output: 24.02 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:03<00:02, 23.03it/s, est. speed input: 24580.09 toks/s, output: 24.00 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:03<00:02, 23.32it/s, est. speed input: 24581.80 toks/s, output: 24.01 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:03<00:01, 23.39it/s, est. speed input: 24564.09 toks/s, output: 23.99 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:03<00:01, 22.98it/s, est. speed input: 24490.57 toks/s, output: 23.92 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:03<00:01, 23.15it/s, est. speed input: 24477.72 toks/s, output: 23.90 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:03<00:01, 23.27it/s, est. speed input: 24466.10 toks/s, output: 23.89 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:03<00:01, 23.44it/s, est. speed input: 24464.13 toks/s, output: 23.89 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:04<00:01, 23.52it/s, est. speed input: 24458.89 toks/s, output: 23.89 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:04<00:01, 23.20it/s, est. speed input: 24413.95 toks/s, output: 23.84 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:04<00:01, 23.51it/s, est. speed input: 24425.72 toks/s, output: 23.85 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:04<00:00, 23.47it/s, est. speed input: 24412.38 toks/s, output: 23.84 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:04<00:00, 23.08it/s, est. speed input: 24363.45 toks/s, output: 23.79 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:04<00:00, 23.14it/s, est. speed input: 24349.89 toks/s, output: 23.78 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:04<00:00, 23.04it/s, est. speed input: 24322.94 toks/s, output: 23.75 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:05<00:00, 23.30it/s, est. speed input: 24327.14 toks/s, output: 23.76 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:05<00:00, 23.53it/s, est. speed input: 24335.05 toks/s, output: 23.76 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:05<00:00, 23.42it/s, est. speed input: 24319.98 toks/s, output: 23.75 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:05<00:00, 23.62it/s, est. speed input: 24328.35 toks/s, output: 23.76 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:05<00:00, 23.62it/s, est. speed input: 24328.35 toks/s, output: 23.76 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:05<00:00, 23.76it/s, est. speed input: 24328.35 toks/s, output: 23.76 toks/s]
[rank0]:[W125 19:30:10.492431160 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=2048 ==========
Time: 2026-01-25 19:30:12
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=256, max_num_seqs=2
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 256 --max-num-seqs 2 --max-model-len 1025 --max-num-batched-tokens 2048 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/Qwen2.5-7B-INT8_M2048.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 19:30:21 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=363683) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=363683) WARNING 01-25 19:30:39 [backends.py:609] Failed to read file <frozen os>
Throughput: 31.57 requests/s, 32364.24 total tokens/s, 31.57 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256

STDERR:
[2026-01-25 19:30:21] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 19:30:21] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 19:30:21] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 19:30:21] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:30:21] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:30:21] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:30:21] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:30:21] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:30:21] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 19:30:21] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 19:30:21] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 19:30:21] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 19:30:21] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 19:30:21] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 19:30:29] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 19:30:29] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 19:30:29] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 19:30:29] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:30:29] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:30:29] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:30:29] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:30:29] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:30:29] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 19:30:29] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 19:30:29] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 19:30:29] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 19:30:29] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 19:30:29] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=363683) [2026-01-25 19:30:30] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=363683) [2026-01-25 19:30:30] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=363683) [2026-01-25 19:30:30] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=363683) [2026-01-25 19:30:30] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=363683) [2026-01-25 19:30:30] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=363683) [2026-01-25 19:30:30] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=363683) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=363683) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.75it/s]
(EngineCore_DP0 pid=363683) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.74it/s]
(EngineCore_DP0 pid=363683) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.74it/s]
(EngineCore_DP0 pid=363683) 
(EngineCore_DP0 pid=363683) [2026-01-25 19:30:31] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 3584] -> 1D uint8
(EngineCore_DP0 pid=363683) [2026-01-25 19:30:31] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12386304 bytes
(EngineCore_DP0 pid=363683) [2026-01-25 19:30:31] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 3584] -> 1D uint8
(EngineCore_DP0 pid=363683) [2026-01-25 19:30:31] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9633792 bytes
(EngineCore_DP0 pid=363683) [2026-01-25 19:30:31] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 3584] -> 1D uint8
(EngineCore_DP0 pid=363683) [2026-01-25 19:30:31] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 101842944 bytes
(EngineCore_DP0 pid=363683) [2026-01-25 19:30:31] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 18944] -> 1D uint8
(EngineCore_DP0 pid=363683) [2026-01-25 19:30:31] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 50921472 bytes
(EngineCore_DP0 pid=363683) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  67%|██████▋   | 2/3 [00:00<00:00, 10.76it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00, 10.19it/s]
(EngineCore_DP0 pid=363683) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 1/2 [00:00<00:00,  9.39it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00, 10.52it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  10%|▉         | 25/256 [00:00<00:00, 246.38it/s]
Adding requests:  20%|██        | 52/256 [00:00<00:00, 254.79it/s]
Adding requests:  32%|███▏      | 82/256 [00:00<00:00, 272.71it/s]
Adding requests:  43%|████▎     | 111/256 [00:00<00:00, 278.70it/s]
Adding requests:  54%|█████▍    | 139/256 [00:00<00:00, 273.08it/s]
Adding requests:  65%|██████▌   | 167/256 [00:00<00:00, 270.48it/s]
Adding requests:  77%|███████▋  | 198/256 [00:00<00:00, 280.72it/s]
Adding requests:  89%|████████▊ | 227/256 [00:00<00:00, 281.01it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 282.71it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 276.34it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  12%|█▎        | 32/256 [00:00<00:01, 201.88it/s, est. speed input: 206741.03 toks/s, output: 201.88 toks/s]
Processed prompts:  21%|██        | 53/256 [00:00<00:03, 58.70it/s, est. speed input: 68973.11 toks/s, output: 67.36 toks/s]   
Processed prompts:  25%|██▌       | 64/256 [00:01<00:04, 46.20it/s, est. speed input: 56255.33 toks/s, output: 54.94 toks/s]
Processed prompts:  28%|██▊       | 71/256 [00:01<00:04, 44.02it/s, est. speed input: 53649.69 toks/s, output: 52.39 toks/s]
Processed prompts:  30%|███       | 77/256 [00:01<00:04, 41.07it/s, est. speed input: 51122.00 toks/s, output: 49.92 toks/s]
Processed prompts:  32%|███▏      | 82/256 [00:01<00:04, 37.21it/s, est. speed input: 48486.17 toks/s, output: 47.35 toks/s]
Processed prompts:  34%|███▍      | 87/256 [00:01<00:04, 37.68it/s, est. speed input: 47941.32 toks/s, output: 46.82 toks/s]
Processed prompts:  36%|███▌      | 92/256 [00:02<00:04, 34.32it/s, est. speed input: 46019.76 toks/s, output: 44.94 toks/s]
Processed prompts:  38%|███▊      | 96/256 [00:02<00:04, 33.71it/s, est. speed input: 45223.82 toks/s, output: 44.16 toks/s]
Processed prompts:  39%|███▉      | 100/256 [00:02<00:04, 33.25it/s, est. speed input: 44529.07 toks/s, output: 43.48 toks/s]
Processed prompts:  41%|████      | 104/256 [00:02<00:04, 32.85it/s, est. speed input: 43900.65 toks/s, output: 42.87 toks/s]
Processed prompts:  42%|████▏     | 108/256 [00:02<00:04, 32.62it/s, est. speed input: 43355.72 toks/s, output: 42.34 toks/s]
Processed prompts:  44%|████▍     | 112/256 [00:02<00:04, 32.43it/s, est. speed input: 42856.98 toks/s, output: 41.85 toks/s]
Processed prompts:  45%|████▌     | 116/256 [00:02<00:04, 32.17it/s, est. speed input: 42377.66 toks/s, output: 41.38 toks/s]
Processed prompts:  47%|████▋     | 120/256 [00:02<00:04, 31.99it/s, est. speed input: 41941.99 toks/s, output: 40.96 toks/s]
Processed prompts:  48%|████▊     | 124/256 [00:03<00:04, 32.03it/s, est. speed input: 41573.86 toks/s, output: 40.60 toks/s]
Processed prompts:  50%|█████     | 128/256 [00:03<00:04, 31.99it/s, est. speed input: 41222.33 toks/s, output: 40.26 toks/s]
Processed prompts:  52%|█████▏    | 132/256 [00:03<00:03, 31.84it/s, est. speed input: 40876.46 toks/s, output: 39.92 toks/s]
Processed prompts:  53%|█████▎    | 136/256 [00:03<00:03, 31.76it/s, est. speed input: 40560.93 toks/s, output: 39.61 toks/s]
Processed prompts:  55%|█████▍    | 140/256 [00:03<00:03, 31.80it/s, est. speed input: 40282.45 toks/s, output: 39.34 toks/s]
Processed prompts:  56%|█████▋    | 144/256 [00:03<00:03, 31.83it/s, est. speed input: 40023.42 toks/s, output: 39.09 toks/s]
Processed prompts:  58%|█████▊    | 148/256 [00:03<00:03, 31.74it/s, est. speed input: 39765.31 toks/s, output: 38.83 toks/s]
Processed prompts:  59%|█████▉    | 152/256 [00:03<00:03, 31.69it/s, est. speed input: 39526.64 toks/s, output: 38.60 toks/s]
Processed prompts:  61%|██████    | 156/256 [00:04<00:03, 31.78it/s, est. speed input: 39318.22 toks/s, output: 38.40 toks/s]
Processed prompts:  62%|██████▎   | 160/256 [00:04<00:03, 31.82it/s, est. speed input: 39119.51 toks/s, output: 38.20 toks/s]
Processed prompts:  64%|██████▍   | 164/256 [00:04<00:02, 31.73it/s, est. speed input: 38918.96 toks/s, output: 38.01 toks/s]
Processed prompts:  66%|██████▌   | 168/256 [00:04<00:02, 31.66it/s, est. speed input: 38728.07 toks/s, output: 37.82 toks/s]
Processed prompts:  67%|██████▋   | 172/256 [00:04<00:02, 31.73it/s, est. speed input: 38561.30 toks/s, output: 37.66 toks/s]
Processed prompts:  69%|██████▉   | 176/256 [00:04<00:02, 31.78it/s, est. speed input: 38403.16 toks/s, output: 37.50 toks/s]
Processed prompts:  70%|███████   | 180/256 [00:04<00:02, 31.74it/s, est. speed input: 38245.81 toks/s, output: 37.35 toks/s]
Processed prompts:  72%|███████▏  | 184/256 [00:04<00:02, 31.70it/s, est. speed input: 38095.95 toks/s, output: 37.20 toks/s]
Processed prompts:  73%|███████▎  | 188/256 [00:05<00:02, 31.74it/s, est. speed input: 37959.09 toks/s, output: 37.07 toks/s]
Processed prompts:  75%|███████▌  | 192/256 [00:05<00:02, 31.73it/s, est. speed input: 37826.29 toks/s, output: 36.94 toks/s]
Processed prompts:  77%|███████▋  | 196/256 [00:05<00:01, 31.71it/s, est. speed input: 37698.24 toks/s, output: 36.81 toks/s]
Processed prompts:  78%|███████▊  | 200/256 [00:05<00:01, 31.71it/s, est. speed input: 37577.38 toks/s, output: 36.70 toks/s]
Processed prompts:  80%|███████▉  | 204/256 [00:05<00:01, 33.18it/s, est. speed input: 37587.12 toks/s, output: 36.71 toks/s]
Processed prompts:  81%|████████▏ | 208/256 [00:05<00:01, 32.74it/s, est. speed input: 37475.04 toks/s, output: 36.60 toks/s]
Processed prompts:  83%|████████▎ | 212/256 [00:05<00:01, 32.38it/s, est. speed input: 37362.24 toks/s, output: 36.49 toks/s]
Processed prompts:  84%|████████▍ | 216/256 [00:05<00:01, 32.05it/s, est. speed input: 37248.09 toks/s, output: 36.37 toks/s]
Processed prompts:  86%|████████▌ | 220/256 [00:06<00:01, 31.95it/s, est. speed input: 37149.02 toks/s, output: 36.28 toks/s]
Processed prompts:  88%|████████▊ | 224/256 [00:06<00:01, 31.91it/s, est. speed input: 37056.58 toks/s, output: 36.19 toks/s]
Processed prompts:  89%|████████▉ | 228/256 [00:06<00:00, 31.91it/s, est. speed input: 36969.67 toks/s, output: 36.10 toks/s]
Processed prompts:  91%|█████████ | 232/256 [00:06<00:00, 31.78it/s, est. speed input: 36875.84 toks/s, output: 36.01 toks/s]
Processed prompts:  92%|█████████▏| 236/256 [00:06<00:00, 31.73it/s, est. speed input: 36789.01 toks/s, output: 35.93 toks/s]
Processed prompts:  94%|█████████▍| 240/256 [00:06<00:00, 31.74it/s, est. speed input: 36709.23 toks/s, output: 35.85 toks/s]
Processed prompts:  95%|█████████▌| 244/256 [00:06<00:00, 31.75it/s, est. speed input: 36631.91 toks/s, output: 35.77 toks/s]
Processed prompts:  97%|█████████▋| 248/256 [00:06<00:00, 31.73it/s, est. speed input: 36556.13 toks/s, output: 35.70 toks/s]
Processed prompts:  98%|█████████▊| 252/256 [00:07<00:00, 31.73it/s, est. speed input: 36483.68 toks/s, output: 35.63 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:07<00:00, 33.25it/s, est. speed input: 36511.19 toks/s, output: 35.66 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:07<00:00, 33.25it/s, est. speed input: 36511.19 toks/s, output: 35.66 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:07<00:00, 35.65it/s, est. speed input: 36511.19 toks/s, output: 35.66 toks/s]
[rank0]:[W125 19:31:06.594451596 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=4096 ==========
Time: 2026-01-25 19:31:08
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=512, max_num_seqs=4
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 512 --max-num-seqs 4 --max-model-len 1025 --max-num-batched-tokens 4096 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/Qwen2.5-7B-INT8_M4096.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 19:31:19 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=364741) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=364741) WARNING 01-25 19:31:37 [backends.py:609] Failed to read file <frozen os>
Throughput: 33.89 requests/s, 34736.60 total tokens/s, 33.89 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512

STDERR:
[2026-01-25 19:31:19] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 19:31:19] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 19:31:19] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 19:31:19] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:31:19] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:31:19] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:31:19] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:31:19] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:31:19] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 19:31:19] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 19:31:19] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 19:31:19] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 19:31:19] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 19:31:19] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 19:31:26] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 19:31:27] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 19:31:27] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 19:31:27] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:31:27] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:31:27] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:31:27] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:31:27] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:31:27] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 19:31:27] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 19:31:27] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 19:31:27] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 19:31:27] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 19:31:27] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=364741) [2026-01-25 19:31:27] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=364741) [2026-01-25 19:31:28] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=364741) [2026-01-25 19:31:28] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=364741) [2026-01-25 19:31:28] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=364741) [2026-01-25 19:31:28] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=364741) [2026-01-25 19:31:28] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=364741) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=364741) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.81it/s]
(EngineCore_DP0 pid=364741) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.80it/s]
(EngineCore_DP0 pid=364741) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.80it/s]
(EngineCore_DP0 pid=364741) 
(EngineCore_DP0 pid=364741) [2026-01-25 19:31:29] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 3584] -> 1D uint8
(EngineCore_DP0 pid=364741) [2026-01-25 19:31:29] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12386304 bytes
(EngineCore_DP0 pid=364741) [2026-01-25 19:31:29] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 3584] -> 1D uint8
(EngineCore_DP0 pid=364741) [2026-01-25 19:31:29] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9633792 bytes
(EngineCore_DP0 pid=364741) [2026-01-25 19:31:29] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 3584] -> 1D uint8
(EngineCore_DP0 pid=364741) [2026-01-25 19:31:29] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 101842944 bytes
(EngineCore_DP0 pid=364741) [2026-01-25 19:31:29] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 18944] -> 1D uint8
(EngineCore_DP0 pid=364741) [2026-01-25 19:31:29] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 50921472 bytes
(EngineCore_DP0 pid=364741) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 2/4 [00:00<00:00, 10.69it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00, 10.87it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00, 10.84it/s]
(EngineCore_DP0 pid=364741) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  67%|██████▋   | 2/3 [00:00<00:00, 10.63it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00, 10.77it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   5%|▌         | 27/512 [00:00<00:01, 266.59it/s]
Adding requests:  11%|█         | 54/512 [00:00<00:01, 267.31it/s]
Adding requests:  17%|█▋        | 85/512 [00:00<00:01, 284.36it/s]
Adding requests:  22%|██▏       | 114/512 [00:00<00:01, 281.46it/s]
Adding requests:  28%|██▊       | 144/512 [00:00<00:01, 286.04it/s]
Adding requests:  34%|███▍      | 174/512 [00:00<00:01, 289.80it/s]
Adding requests:  40%|███▉      | 203/512 [00:00<00:01, 284.75it/s]
Adding requests:  46%|████▌     | 235/512 [00:00<00:00, 294.23it/s]
Adding requests:  52%|█████▏    | 265/512 [00:00<00:00, 294.87it/s]
Adding requests:  58%|█████▊    | 296/512 [00:01<00:00, 297.57it/s]
Adding requests:  64%|██████▍   | 328/512 [00:01<00:00, 302.99it/s]
Adding requests:  71%|███████   | 361/512 [00:01<00:00, 309.31it/s]
Adding requests:  77%|███████▋  | 392/512 [00:01<00:00, 309.11it/s]
Adding requests:  83%|████████▎ | 424/512 [00:01<00:00, 310.57it/s]
Adding requests:  89%|████████▉ | 456/512 [00:01<00:00, 301.02it/s]
Adding requests:  96%|█████████▌| 489/512 [00:01<00:00, 308.91it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 297.42it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  11%|█▏        | 58/512 [00:00<00:00, 472.56it/s, est. speed input: 483961.60 toks/s, output: 472.57 toks/s]
Processed prompts:  21%|██        | 106/512 [00:01<00:06, 59.04it/s, est. speed input: 70603.52 toks/s, output: 68.95 toks/s]  
Processed prompts:  25%|██▌       | 128/512 [00:02<00:07, 51.20it/s, est. speed input: 61593.76 toks/s, output: 60.15 toks/s]
Processed prompts:  28%|██▊       | 142/512 [00:02<00:08, 44.91it/s, est. speed input: 55916.67 toks/s, output: 54.61 toks/s]
Processed prompts:  30%|██▉       | 152/512 [00:02<00:08, 44.49it/s, est. speed input: 54882.40 toks/s, output: 53.60 toks/s]
Processed prompts:  31%|███▏      | 160/512 [00:03<00:08, 42.37it/s, est. speed input: 53318.46 toks/s, output: 52.07 toks/s]
Processed prompts:  33%|███▎      | 167/512 [00:03<00:08, 39.57it/s, est. speed input: 51678.88 toks/s, output: 50.47 toks/s]
Processed prompts:  34%|███▍      | 173/512 [00:03<00:08, 41.10it/s, est. speed input: 51693.47 toks/s, output: 50.48 toks/s]
Processed prompts:  35%|███▍      | 179/512 [00:03<00:09, 36.74it/s, est. speed input: 50047.40 toks/s, output: 48.87 toks/s]
Processed prompts:  36%|███▌      | 184/512 [00:03<00:08, 37.72it/s, est. speed input: 49850.01 toks/s, output: 48.68 toks/s]
Processed prompts:  37%|███▋      | 189/512 [00:03<00:08, 38.59it/s, est. speed input: 49648.43 toks/s, output: 48.48 toks/s]
Processed prompts:  38%|███▊      | 194/512 [00:04<00:09, 32.43it/s, est. speed input: 48054.15 toks/s, output: 46.93 toks/s]
Processed prompts:  39%|███▊      | 198/512 [00:04<00:09, 32.75it/s, est. speed input: 47690.08 toks/s, output: 46.57 toks/s]
Processed prompts:  40%|████      | 206/512 [00:04<00:08, 34.29it/s, est. speed input: 47228.41 toks/s, output: 46.12 toks/s]
Processed prompts:  41%|████      | 210/512 [00:04<00:08, 34.18it/s, est. speed input: 46901.68 toks/s, output: 45.80 toks/s]
Processed prompts:  42%|████▏     | 214/512 [00:04<00:08, 34.06it/s, est. speed input: 46587.18 toks/s, output: 45.50 toks/s]
Processed prompts:  43%|████▎     | 218/512 [00:04<00:08, 34.08it/s, est. speed input: 46305.32 toks/s, output: 45.22 toks/s]
Processed prompts:  43%|████▎     | 222/512 [00:04<00:08, 34.08it/s, est. speed input: 46034.26 toks/s, output: 44.96 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:05<00:08, 34.01it/s, est. speed input: 45767.89 toks/s, output: 44.70 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:05<00:08, 33.93it/s, est. speed input: 45509.98 toks/s, output: 44.44 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:05<00:08, 33.87it/s, est. speed input: 45264.32 toks/s, output: 44.20 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:05<00:08, 33.94it/s, est. speed input: 45040.65 toks/s, output: 43.98 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:05<00:07, 33.80it/s, est. speed input: 44807.71 toks/s, output: 43.76 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:05<00:07, 33.87it/s, est. speed input: 44600.80 toks/s, output: 43.56 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:05<00:07, 33.91it/s, est. speed input: 44400.68 toks/s, output: 43.36 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:05<00:07, 33.93it/s, est. speed input: 44208.50 toks/s, output: 43.17 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:06<00:07, 33.84it/s, est. speed input: 44015.39 toks/s, output: 42.98 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:06<00:07, 33.91it/s, est. speed input: 43840.08 toks/s, output: 42.81 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:06<00:07, 33.88it/s, est. speed input: 43665.01 toks/s, output: 42.64 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:06<00:07, 33.90it/s, est. speed input: 43500.29 toks/s, output: 42.48 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:06<00:07, 33.84it/s, est. speed input: 43335.45 toks/s, output: 42.32 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:06<00:06, 33.83it/s, est. speed input: 43178.86 toks/s, output: 42.17 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:06<00:06, 33.89it/s, est. speed input: 43032.67 toks/s, output: 42.02 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:06<00:06, 33.91it/s, est. speed input: 42890.04 toks/s, output: 41.88 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:06<00:06, 33.84it/s, est. speed input: 42746.72 toks/s, output: 41.74 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:07<00:06, 33.82it/s, est. speed input: 42609.84 toks/s, output: 41.61 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:07<00:06, 33.81it/s, est. speed input: 42477.46 toks/s, output: 41.48 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:07<00:06, 33.85it/s, est. speed input: 42353.32 toks/s, output: 41.36 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:07<00:05, 35.47it/s, est. speed input: 42243.29 toks/s, output: 41.25 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:07<00:05, 34.98it/s, est. speed input: 42120.12 toks/s, output: 41.13 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:07<00:05, 34.63it/s, est. speed input: 42003.52 toks/s, output: 41.02 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:07<00:05, 34.50it/s, est. speed input: 41899.04 toks/s, output: 40.92 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:07<00:05, 34.41it/s, est. speed input: 41797.91 toks/s, output: 40.82 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:08<00:05, 34.26it/s, est. speed input: 41694.51 toks/s, output: 40.72 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:08<00:05, 34.11it/s, est. speed input: 41591.41 toks/s, output: 40.62 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:08<00:05, 33.93it/s, est. speed input: 41487.56 toks/s, output: 40.52 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:08<00:05, 33.96it/s, est. speed input: 41394.89 toks/s, output: 40.42 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:08<00:04, 33.86it/s, est. speed input: 41298.78 toks/s, output: 40.33 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:08<00:04, 33.86it/s, est. speed input: 41208.49 toks/s, output: 40.24 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:08<00:04, 33.86it/s, est. speed input: 41120.68 toks/s, output: 40.16 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:08<00:04, 33.79it/s, est. speed input: 41031.65 toks/s, output: 40.07 toks/s]
Processed prompts:  71%|███████   | 362/512 [00:09<00:04, 33.82it/s, est. speed input: 40949.49 toks/s, output: 39.99 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:09<00:04, 33.83it/s, est. speed input: 40868.35 toks/s, output: 39.91 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [00:09<00:04, 33.78it/s, est. speed input: 40786.71 toks/s, output: 39.83 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [00:09<00:04, 33.73it/s, est. speed input: 40706.23 toks/s, output: 39.75 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [00:09<00:03, 33.70it/s, est. speed input: 40627.82 toks/s, output: 39.68 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [00:09<00:03, 33.76it/s, est. speed input: 40555.73 toks/s, output: 39.61 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [00:09<00:03, 33.81it/s, est. speed input: 40485.57 toks/s, output: 39.54 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [00:09<00:03, 33.80it/s, est. speed input: 40414.64 toks/s, output: 39.47 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [00:10<00:03, 33.77it/s, est. speed input: 40344.81 toks/s, output: 39.40 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [00:10<00:03, 33.77it/s, est. speed input: 40277.03 toks/s, output: 39.33 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [00:10<00:03, 33.77it/s, est. speed input: 40211.50 toks/s, output: 39.27 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [00:10<00:03, 33.83it/s, est. speed input: 40149.55 toks/s, output: 39.21 toks/s]
Processed prompts:  80%|████████  | 410/512 [00:10<00:03, 33.76it/s, est. speed input: 40084.27 toks/s, output: 39.14 toks/s]
Processed prompts:  81%|████████  | 414/512 [00:10<00:02, 33.72it/s, est. speed input: 40020.96 toks/s, output: 39.08 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [00:10<00:02, 33.81it/s, est. speed input: 39964.10 toks/s, output: 39.03 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [00:10<00:02, 33.83it/s, est. speed input: 39906.47 toks/s, output: 38.97 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [00:10<00:02, 33.84it/s, est. speed input: 39850.18 toks/s, output: 38.92 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [00:11<00:02, 33.84it/s, est. speed input: 39794.63 toks/s, output: 38.86 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [00:11<00:02, 35.51it/s, est. speed input: 39771.64 toks/s, output: 38.84 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [00:11<00:01, 35.11it/s, est. speed input: 39719.97 toks/s, output: 38.79 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [00:11<00:01, 34.64it/s, est. speed input: 39662.30 toks/s, output: 38.73 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [00:11<00:01, 34.36it/s, est. speed input: 39608.85 toks/s, output: 38.68 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [00:11<00:01, 34.19it/s, est. speed input: 39558.16 toks/s, output: 38.63 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [00:11<00:01, 34.06it/s, est. speed input: 39508.15 toks/s, output: 38.58 toks/s]
Processed prompts:  90%|█████████ | 462/512 [00:11<00:01, 33.93it/s, est. speed input: 39457.83 toks/s, output: 38.53 toks/s]
Processed prompts:  91%|█████████ | 466/512 [00:12<00:01, 33.91it/s, est. speed input: 39411.10 toks/s, output: 38.49 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [00:12<00:01, 33.95it/s, est. speed input: 39367.49 toks/s, output: 38.44 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [00:12<00:01, 34.00it/s, est. speed input: 39325.18 toks/s, output: 38.40 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [00:12<00:01, 33.86it/s, est. speed input: 39277.56 toks/s, output: 38.36 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [00:12<00:00, 33.75it/s, est. speed input: 39230.20 toks/s, output: 38.31 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [00:12<00:00, 33.70it/s, est. speed input: 39184.84 toks/s, output: 38.27 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [00:12<00:00, 33.67it/s, est. speed input: 39140.43 toks/s, output: 38.22 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [00:12<00:00, 33.63it/s, est. speed input: 39096.28 toks/s, output: 38.18 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [00:13<00:00, 33.69it/s, est. speed input: 39056.07 toks/s, output: 38.14 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [00:13<00:00, 33.79it/s, est. speed input: 39018.53 toks/s, output: 38.10 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [00:13<00:00, 33.80it/s, est. speed input: 38979.31 toks/s, output: 38.07 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:13<00:00, 33.80it/s, est. speed input: 39169.57 toks/s, output: 38.25 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:13<00:00, 38.25it/s, est. speed input: 39169.57 toks/s, output: 38.25 toks/s]
[rank0]:[W125 19:32:11.260214250 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=8192 ==========
Time: 2026-01-25 19:32:13
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=1024, max_num_seqs=8
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 1024 --max-num-seqs 8 --max-model-len 1025 --max-num-batched-tokens 8192 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/Qwen2.5-7B-INT8_M8192.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 19:32:28 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=365948) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=365948) WARNING 01-25 19:32:47 [backends.py:609] Failed to read file <frozen os>
Throughput: 34.98 requests/s, 35857.76 total tokens/s, 34.98 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024

STDERR:
[2026-01-25 19:32:28] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 19:32:28] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 19:32:28] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 19:32:28] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:32:28] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:32:28] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:32:28] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:32:28] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:32:28] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 19:32:28] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 19:32:28] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 19:32:28] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 19:32:28] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 19:32:28] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 19:32:36] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 19:32:36] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 19:32:36] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 19:32:36] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:32:36] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:32:36] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:32:36] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:32:36] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:32:36] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 19:32:36] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 19:32:36] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 19:32:36] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 19:32:36] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 19:32:36] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=365948) [2026-01-25 19:32:37] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=365948) [2026-01-25 19:32:37] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=365948) [2026-01-25 19:32:37] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=365948) [2026-01-25 19:32:37] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=365948) [2026-01-25 19:32:37] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=365948) [2026-01-25 19:32:37] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=365948) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=365948) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.80it/s]
(EngineCore_DP0 pid=365948) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.78it/s]
(EngineCore_DP0 pid=365948) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.78it/s]
(EngineCore_DP0 pid=365948) 
(EngineCore_DP0 pid=365948) [2026-01-25 19:32:39] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 3584] -> 1D uint8
(EngineCore_DP0 pid=365948) [2026-01-25 19:32:39] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12386304 bytes
(EngineCore_DP0 pid=365948) [2026-01-25 19:32:39] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 3584] -> 1D uint8
(EngineCore_DP0 pid=365948) [2026-01-25 19:32:39] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9633792 bytes
(EngineCore_DP0 pid=365948) [2026-01-25 19:32:39] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 3584] -> 1D uint8
(EngineCore_DP0 pid=365948) [2026-01-25 19:32:39] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 101842944 bytes
(EngineCore_DP0 pid=365948) [2026-01-25 19:32:39] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 18944] -> 1D uint8
(EngineCore_DP0 pid=365948) [2026-01-25 19:32:39] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 50921472 bytes
(EngineCore_DP0 pid=365948) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:01,  3.33it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  60%|██████    | 3/5 [00:00<00:00,  6.88it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00,  8.42it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00,  7.46it/s]
(EngineCore_DP0 pid=365948) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:00,  9.11it/s]
Capturing CUDA graphs (decode, FULL):  75%|███████▌  | 3/4 [00:00<00:00, 11.14it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00, 11.13it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   3%|▎         | 27/1024 [00:00<00:03, 262.93it/s]
Adding requests:   6%|▌         | 57/1024 [00:00<00:03, 279.38it/s]
Adding requests:   8%|▊         | 86/1024 [00:00<00:03, 280.67it/s]
Adding requests:  11%|█         | 115/1024 [00:00<00:03, 283.81it/s]
Adding requests:  14%|█▍        | 146/1024 [00:00<00:03, 289.00it/s]
Adding requests:  17%|█▋        | 176/1024 [00:00<00:02, 289.09it/s]
Adding requests:  20%|██        | 208/1024 [00:00<00:02, 298.17it/s]
Adding requests:  23%|██▎       | 240/1024 [00:00<00:02, 301.76it/s]
Adding requests:  26%|██▋       | 271/1024 [00:00<00:02, 299.02it/s]
Adding requests:  29%|██▉       | 302/1024 [00:01<00:02, 302.13it/s]
Adding requests:  33%|███▎      | 333/1024 [00:01<00:02, 303.90it/s]
Adding requests:  36%|███▌      | 364/1024 [00:01<00:02, 299.27it/s]
Adding requests:  38%|███▊      | 394/1024 [00:01<00:02, 295.53it/s]
Adding requests:  41%|████▏     | 424/1024 [00:01<00:02, 295.53it/s]
Adding requests:  44%|████▍     | 454/1024 [00:01<00:01, 286.86it/s]
Adding requests:  48%|████▊     | 487/1024 [00:01<00:01, 298.43it/s]
Adding requests:  51%|█████     | 521/1024 [00:01<00:01, 310.48it/s]
Adding requests:  54%|█████▍    | 553/1024 [00:01<00:01, 301.85it/s]
Adding requests:  57%|█████▋    | 584/1024 [00:01<00:01, 300.85it/s]
Adding requests:  60%|██████    | 615/1024 [00:02<00:01, 295.42it/s]
Adding requests:  63%|██████▎   | 645/1024 [00:02<00:01, 288.11it/s]
Adding requests:  66%|██████▌   | 674/1024 [00:02<00:01, 282.02it/s]
Adding requests:  69%|██████▉   | 704/1024 [00:02<00:01, 284.96it/s]
Adding requests:  72%|███████▏  | 733/1024 [00:02<00:01, 281.03it/s]
Adding requests:  74%|███████▍  | 762/1024 [00:02<00:00, 279.41it/s]
Adding requests:  78%|███████▊  | 794/1024 [00:02<00:00, 289.30it/s]
Adding requests:  81%|████████  | 826/1024 [00:02<00:00, 297.93it/s]
Adding requests:  84%|████████▎ | 857/1024 [00:02<00:00, 299.92it/s]
Adding requests:  87%|████████▋ | 889/1024 [00:03<00:00, 304.49it/s]
Adding requests:  90%|████████▉ | 920/1024 [00:03<00:00, 302.02it/s]
Adding requests:  93%|█████████▎| 951/1024 [00:03<00:00, 298.37it/s]
Adding requests:  96%|█████████▌| 981/1024 [00:03<00:00, 298.45it/s]
Adding requests:  99%|█████████▊| 1011/1024 [00:03<00:00, 287.73it/s]
Adding requests: 100%|██████████| 1024/1024 [00:03<00:00, 293.33it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  12%|█▏        | 122/1024 [00:00<00:01, 524.63it/s, est. speed input: 537273.32 toks/s, output: 524.64 toks/s]
Processed prompts:  17%|█▋        | 175/1024 [00:01<00:09, 90.13it/s, est. speed input: 111629.43 toks/s, output: 109.01 toks/s] 
Processed prompts:  19%|█▉        | 199/1024 [00:02<00:12, 68.66it/s, est. speed input: 88949.03 toks/s, output: 86.86 toks/s]  
Processed prompts:  21%|██        | 214/1024 [00:02<00:13, 59.75it/s, est. speed input: 80390.41 toks/s, output: 78.51 toks/s]
Processed prompts:  22%|██▏       | 225/1024 [00:02<00:13, 57.84it/s, est. speed input: 77982.51 toks/s, output: 76.15 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:03<00:17, 45.66it/s, est. speed input: 70224.14 toks/s, output: 68.58 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:03<00:17, 43.70it/s, est. speed input: 68071.64 toks/s, output: 66.48 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:03<00:18, 41.84it/s, est. speed input: 66153.06 toks/s, output: 64.60 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:04<00:19, 40.29it/s, est. speed input: 64469.92 toks/s, output: 62.96 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:04<00:19, 38.95it/s, est. speed input: 62948.51 toks/s, output: 61.47 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:04<00:19, 37.90it/s, est. speed input: 61580.37 toks/s, output: 60.14 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:04<00:20, 37.08it/s, est. speed input: 60342.11 toks/s, output: 58.93 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:05<00:20, 36.56it/s, est. speed input: 59242.10 toks/s, output: 57.85 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:05<00:20, 36.13it/s, est. speed input: 58225.49 toks/s, output: 56.86 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:05<00:19, 36.90it/s, est. speed input: 57536.25 toks/s, output: 56.19 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:05<00:19, 36.32it/s, est. speed input: 56660.56 toks/s, output: 55.33 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:05<00:19, 35.94it/s, est. speed input: 55856.99 toks/s, output: 54.55 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:06<00:19, 35.66it/s, est. speed input: 55111.51 toks/s, output: 53.82 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:06<00:19, 35.40it/s, est. speed input: 54407.99 toks/s, output: 53.13 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:06<00:19, 35.26it/s, est. speed input: 53759.42 toks/s, output: 52.50 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:06<00:19, 35.08it/s, est. speed input: 53141.60 toks/s, output: 51.90 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:07<00:18, 35.03it/s, est. speed input: 52576.59 toks/s, output: 51.34 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:07<00:18, 35.06it/s, est. speed input: 52057.74 toks/s, output: 50.84 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:07<00:18, 34.99it/s, est. speed input: 51554.95 toks/s, output: 50.35 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:07<00:18, 34.97it/s, est. speed input: 51088.09 toks/s, output: 49.89 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [00:07<00:18, 34.97it/s, est. speed input: 50649.72 toks/s, output: 49.46 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:08<00:17, 34.99it/s, est. speed input: 50237.81 toks/s, output: 49.06 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:08<00:17, 34.96it/s, est. speed input: 49843.33 toks/s, output: 48.68 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:08<00:17, 35.00it/s, est. speed input: 49475.83 toks/s, output: 48.32 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:08<00:17, 34.98it/s, est. speed input: 49123.21 toks/s, output: 47.97 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:09<00:16, 36.15it/s, est. speed input: 48921.57 toks/s, output: 47.77 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:09<00:16, 35.74it/s, est. speed input: 48594.34 toks/s, output: 47.46 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:09<00:16, 35.50it/s, est. speed input: 48287.67 toks/s, output: 47.16 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:09<00:16, 35.34it/s, est. speed input: 47995.05 toks/s, output: 46.87 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:10<00:15, 35.16it/s, est. speed input: 47709.95 toks/s, output: 46.59 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:10<00:15, 35.05it/s, est. speed input: 47437.91 toks/s, output: 46.33 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:10<00:15, 35.01it/s, est. speed input: 47181.72 toks/s, output: 46.08 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:10<00:15, 35.04it/s, est. speed input: 46942.24 toks/s, output: 45.84 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:10<00:15, 35.02it/s, est. speed input: 46709.14 toks/s, output: 45.61 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:11<00:14, 35.00it/s, est. speed input: 46485.48 toks/s, output: 45.40 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:11<00:14, 34.97it/s, est. speed input: 46268.42 toks/s, output: 45.18 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:11<00:14, 34.99it/s, est. speed input: 46064.10 toks/s, output: 44.98 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:11<00:14, 34.98it/s, est. speed input: 45865.75 toks/s, output: 44.79 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:12<00:13, 34.94it/s, est. speed input: 45671.97 toks/s, output: 44.60 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:12<00:13, 34.93it/s, est. speed input: 45486.43 toks/s, output: 44.42 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:12<00:13, 34.98it/s, est. speed input: 45312.92 toks/s, output: 44.25 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:12<00:13, 34.95it/s, est. speed input: 45140.17 toks/s, output: 44.08 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:12<00:12, 34.94it/s, est. speed input: 44974.40 toks/s, output: 43.92 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:13<00:12, 34.91it/s, est. speed input: 44812.68 toks/s, output: 43.76 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:13<00:12, 34.99it/s, est. speed input: 44664.28 toks/s, output: 43.62 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:13<00:12, 34.97it/s, est. speed input: 44514.61 toks/s, output: 43.47 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:13<00:12, 34.92it/s, est. speed input: 44368.28 toks/s, output: 43.33 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:14<00:11, 34.94it/s, est. speed input: 44229.51 toks/s, output: 43.19 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:14<00:11, 34.95it/s, est. speed input: 44095.48 toks/s, output: 43.06 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:14<00:11, 34.96it/s, est. speed input: 43965.55 toks/s, output: 42.94 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:14<00:11, 34.97it/s, est. speed input: 43840.28 toks/s, output: 42.81 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:15<00:10, 34.97it/s, est. speed input: 43718.24 toks/s, output: 42.69 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:15<00:10, 34.93it/s, est. speed input: 43596.87 toks/s, output: 42.58 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:15<00:10, 34.91it/s, est. speed input: 43480.36 toks/s, output: 42.46 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:15<00:10, 34.89it/s, est. speed input: 43366.17 toks/s, output: 42.35 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:15<00:10, 34.93it/s, est. speed input: 43259.02 toks/s, output: 42.25 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:16<00:09, 34.93it/s, est. speed input: 43153.08 toks/s, output: 42.14 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:16<00:09, 34.91it/s, est. speed input: 43048.84 toks/s, output: 42.04 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:16<00:09, 34.89it/s, est. speed input: 42947.15 toks/s, output: 41.94 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:16<00:09, 34.88it/s, est. speed input: 42848.68 toks/s, output: 41.84 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:17<00:08, 34.93it/s, est. speed input: 42755.41 toks/s, output: 41.75 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:17<00:08, 34.92it/s, est. speed input: 42662.77 toks/s, output: 41.66 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:17<00:08, 34.87it/s, est. speed input: 42570.00 toks/s, output: 41.57 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:17<00:08, 34.82it/s, est. speed input: 42479.02 toks/s, output: 41.48 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:18<00:07, 34.83it/s, est. speed input: 42392.20 toks/s, output: 41.40 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:18<00:07, 34.86it/s, est. speed input: 42309.47 toks/s, output: 41.32 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:18<00:07, 34.90it/s, est. speed input: 42229.35 toks/s, output: 41.24 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:18<00:07, 34.91it/s, est. speed input: 42150.21 toks/s, output: 41.16 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:18<00:07, 34.88it/s, est. speed input: 42071.23 toks/s, output: 41.09 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:19<00:06, 36.07it/s, est. speed input: 42050.47 toks/s, output: 41.06 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:19<00:06, 35.77it/s, est. speed input: 41978.44 toks/s, output: 40.99 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:19<00:06, 35.50it/s, est. speed input: 41905.18 toks/s, output: 40.92 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:19<00:06, 35.29it/s, est. speed input: 41832.86 toks/s, output: 40.85 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:20<00:05, 35.14it/s, est. speed input: 41761.59 toks/s, output: 40.78 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:20<00:05, 35.09it/s, est. speed input: 41694.58 toks/s, output: 40.72 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:20<00:05, 35.01it/s, est. speed input: 41626.93 toks/s, output: 40.65 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [00:20<00:05, 34.92it/s, est. speed input: 41559.30 toks/s, output: 40.59 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [00:20<00:04, 34.89it/s, est. speed input: 41494.49 toks/s, output: 40.52 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:21<00:04, 34.89it/s, est. speed input: 41432.48 toks/s, output: 40.46 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [00:21<00:04, 34.92it/s, est. speed input: 41372.70 toks/s, output: 40.40 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [00:21<00:04, 34.87it/s, est. speed input: 41311.17 toks/s, output: 40.34 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [00:21<00:04, 34.86it/s, est. speed input: 41252.17 toks/s, output: 40.29 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [00:22<00:03, 34.85it/s, est. speed input: 41193.82 toks/s, output: 40.23 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [00:22<00:03, 34.87it/s, est. speed input: 41138.15 toks/s, output: 40.17 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [00:22<00:03, 34.83it/s, est. speed input: 41081.40 toks/s, output: 40.12 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [00:22<00:03, 34.80it/s, est. speed input: 41025.88 toks/s, output: 40.06 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [00:23<00:02, 34.83it/s, est. speed input: 40973.09 toks/s, output: 40.01 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [00:23<00:02, 34.79it/s, est. speed input: 40919.01 toks/s, output: 39.96 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [00:23<00:02, 34.78it/s, est. speed input: 40866.99 toks/s, output: 39.91 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [00:23<00:02, 34.80it/s, est. speed input: 40816.71 toks/s, output: 39.86 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [00:23<00:02, 34.74it/s, est. speed input: 40764.72 toks/s, output: 39.81 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [00:24<00:01, 34.73it/s, est. speed input: 40715.04 toks/s, output: 39.76 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [00:24<00:01, 34.75it/s, est. speed input: 40667.26 toks/s, output: 39.71 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [00:24<00:01, 34.75it/s, est. speed input: 40619.78 toks/s, output: 39.67 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [00:24<00:01, 34.80it/s, est. speed input: 40575.12 toks/s, output: 39.62 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [00:25<00:00, 34.72it/s, est. speed input: 40527.05 toks/s, output: 39.58 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [00:25<00:00, 34.74it/s, est. speed input: 40482.35 toks/s, output: 39.53 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [00:25<00:00, 34.74it/s, est. speed input: 40438.12 toks/s, output: 39.49 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [00:25<00:00, 36.03it/s, est. speed input: 40437.81 toks/s, output: 39.49 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:25<00:00, 36.03it/s, est. speed input: 40675.74 toks/s, output: 39.72 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:25<00:00, 39.72it/s, est. speed input: 40675.74 toks/s, output: 39.72 toks/s]
[rank0]:[W125 19:33:36.026940926 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=16384 ==========
Time: 2026-01-25 19:33:38
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=2048, max_num_seqs=16
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 2048 --max-num-seqs 16 --max-model-len 1025 --max-num-batched-tokens 16384 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/Qwen2.5-7B-INT8_M16384.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 19:34:00 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=367454) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=367454) WARNING 01-25 19:34:19 [backends.py:609] Failed to read file <frozen os>
Throughput: 35.62 requests/s, 36505.97 total tokens/s, 35.62 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048

STDERR:
[2026-01-25 19:34:00] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 19:34:00] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 19:34:00] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 19:34:00] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:34:00] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:34:00] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:34:00] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:34:00] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:34:00] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 19:34:00] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 19:34:00] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 19:34:00] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 19:34:00] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 19:34:00] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 19:34:08] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 19:34:08] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 19:34:08] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 19:34:08] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:34:08] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:34:08] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:34:08] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:34:08] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:34:08] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 19:34:08] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 19:34:08] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 19:34:08] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 19:34:08] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 19:34:08] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=367454) [2026-01-25 19:34:09] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=367454) [2026-01-25 19:34:09] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=367454) [2026-01-25 19:34:09] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=367454) [2026-01-25 19:34:09] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=367454) [2026-01-25 19:34:09] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=367454) [2026-01-25 19:34:09] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=367454) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=367454) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.84it/s]
(EngineCore_DP0 pid=367454) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.81it/s]
(EngineCore_DP0 pid=367454) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.81it/s]
(EngineCore_DP0 pid=367454) 
(EngineCore_DP0 pid=367454) [2026-01-25 19:34:10] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 3584] -> 1D uint8
(EngineCore_DP0 pid=367454) [2026-01-25 19:34:10] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12386304 bytes
(EngineCore_DP0 pid=367454) [2026-01-25 19:34:10] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 3584] -> 1D uint8
(EngineCore_DP0 pid=367454) [2026-01-25 19:34:10] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9633792 bytes
(EngineCore_DP0 pid=367454) [2026-01-25 19:34:10] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 3584] -> 1D uint8
(EngineCore_DP0 pid=367454) [2026-01-25 19:34:11] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 101842944 bytes
(EngineCore_DP0 pid=367454) [2026-01-25 19:34:11] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 18944] -> 1D uint8
(EngineCore_DP0 pid=367454) [2026-01-25 19:34:11] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 50921472 bytes
(EngineCore_DP0 pid=367454) [rank0]:W0125 19:34:27.724000 367454 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=367454) [rank0]:W0125 19:34:27.847000 367454 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=367454) [rank0]:W0125 19:34:29.552000 367454 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=367454) [rank0]:W0125 19:34:29.751000 367454 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=367454) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  29%|██▊       | 2/7 [00:00<00:00, 10.37it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  57%|█████▋    | 4/7 [00:00<00:00, 10.91it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  86%|████████▌ | 6/7 [00:00<00:00, 11.19it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00, 10.83it/s]
(EngineCore_DP0 pid=367454) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  20%|██        | 1/5 [00:00<00:00,  9.82it/s]
Capturing CUDA graphs (decode, FULL):  60%|██████    | 3/5 [00:00<00:00, 10.75it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00, 11.14it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00, 10.98it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   1%|▏         | 28/2048 [00:00<00:07, 273.34it/s]
Adding requests:   3%|▎         | 59/2048 [00:00<00:06, 293.30it/s]
Adding requests:   4%|▍         | 89/2048 [00:00<00:06, 287.57it/s]
Adding requests:   6%|▌         | 118/2048 [00:00<00:06, 278.75it/s]
Adding requests:   7%|▋         | 146/2048 [00:00<00:06, 276.38it/s]
Adding requests:   9%|▊         | 177/2048 [00:00<00:06, 287.38it/s]
Adding requests:  10%|█         | 208/2048 [00:00<00:06, 293.13it/s]
Adding requests:  12%|█▏        | 238/2048 [00:00<00:06, 291.44it/s]
Adding requests:  13%|█▎        | 268/2048 [00:00<00:06, 286.26it/s]
Adding requests:  15%|█▍        | 298/2048 [00:01<00:06, 288.68it/s]
Adding requests:  16%|█▌        | 329/2048 [00:01<00:05, 294.67it/s]
Adding requests:  18%|█▊        | 360/2048 [00:01<00:05, 298.84it/s]
Adding requests:  19%|█▉        | 392/2048 [00:01<00:05, 302.65it/s]
Adding requests:  21%|██        | 424/2048 [00:01<00:05, 305.66it/s]
Adding requests:  22%|██▏       | 455/2048 [00:01<00:05, 305.50it/s]
Adding requests:  24%|██▍       | 489/2048 [00:01<00:04, 312.94it/s]
Adding requests:  26%|██▌       | 524/2048 [00:01<00:04, 323.41it/s]
Adding requests:  27%|██▋       | 557/2048 [00:01<00:04, 320.08it/s]
Adding requests:  29%|██▉       | 590/2048 [00:01<00:04, 313.58it/s]
Adding requests:  30%|███       | 622/2048 [00:02<00:04, 304.26it/s]
Adding requests:  32%|███▏      | 653/2048 [00:02<00:04, 300.22it/s]
Adding requests:  33%|███▎      | 685/2048 [00:02<00:04, 304.79it/s]
Adding requests:  35%|███▌      | 717/2048 [00:02<00:04, 308.16it/s]
Adding requests:  37%|███▋      | 748/2048 [00:02<00:04, 299.24it/s]
Adding requests:  38%|███▊      | 778/2048 [00:02<00:04, 294.03it/s]
Adding requests:  40%|███▉      | 809/2048 [00:02<00:04, 295.80it/s]
Adding requests:  41%|████      | 840/2048 [00:02<00:04, 299.90it/s]
Adding requests:  43%|████▎     | 873/2048 [00:02<00:03, 306.11it/s]
Adding requests:  44%|████▍     | 905/2048 [00:03<00:03, 307.77it/s]
Adding requests:  46%|████▌     | 936/2048 [00:03<00:03, 290.89it/s]
Adding requests:  47%|████▋     | 967/2048 [00:03<00:03, 296.10it/s]
Adding requests:  49%|████▊     | 997/2048 [00:03<00:03, 293.19it/s]
Adding requests:  50%|█████     | 1027/2048 [00:03<00:03, 293.63it/s]
Adding requests:  52%|█████▏    | 1057/2048 [00:03<00:03, 287.45it/s]
Adding requests:  53%|█████▎    | 1087/2048 [00:03<00:03, 289.55it/s]
Adding requests:  55%|█████▍    | 1119/2048 [00:03<00:03, 295.27it/s]
Adding requests:  56%|█████▋    | 1152/2048 [00:03<00:02, 302.37it/s]
Adding requests:  58%|█████▊    | 1184/2048 [00:03<00:02, 305.79it/s]
Adding requests:  59%|█████▉    | 1216/2048 [00:04<00:02, 308.88it/s]
Adding requests:  61%|██████    | 1247/2048 [00:04<00:02, 301.78it/s]
Adding requests:  62%|██████▏   | 1278/2048 [00:04<00:02, 296.45it/s]
Adding requests:  64%|██████▍   | 1309/2048 [00:04<00:02, 299.16it/s]
Adding requests:  65%|██████▌   | 1340/2048 [00:04<00:02, 301.40it/s]
Adding requests:  67%|██████▋   | 1371/2048 [00:04<00:02, 299.60it/s]
Adding requests:  68%|██████▊   | 1401/2048 [00:04<00:02, 293.68it/s]
Adding requests:  70%|██████▉   | 1432/2048 [00:04<00:02, 296.51it/s]
Adding requests:  71%|███████▏  | 1463/2048 [00:04<00:01, 300.33it/s]
Adding requests:  73%|███████▎  | 1496/2048 [00:04<00:01, 308.71it/s]
Adding requests:  75%|███████▍  | 1527/2048 [00:05<00:01, 303.75it/s]
Adding requests:  76%|███████▌  | 1558/2048 [00:05<00:01, 303.31it/s]
Adding requests:  78%|███████▊  | 1589/2048 [00:05<00:01, 300.90it/s]
Adding requests:  79%|███████▉  | 1620/2048 [00:05<00:01, 298.43it/s]
Adding requests:  81%|████████  | 1650/2048 [00:05<00:01, 296.83it/s]
Adding requests:  82%|████████▏ | 1680/2048 [00:05<00:01, 289.22it/s]
Adding requests:  84%|████████▎ | 1711/2048 [00:05<00:01, 295.08it/s]
Adding requests:  85%|████████▌ | 1741/2048 [00:05<00:01, 296.38it/s]
Adding requests:  87%|████████▋ | 1774/2048 [00:05<00:00, 304.77it/s]
Adding requests:  88%|████████▊ | 1805/2048 [00:06<00:00, 304.58it/s]
Adding requests:  90%|████████▉ | 1836/2048 [00:06<00:00, 294.70it/s]
Adding requests:  91%|█████████ | 1866/2048 [00:06<00:00, 294.53it/s]
Adding requests:  93%|█████████▎| 1897/2048 [00:06<00:00, 296.93it/s]
Adding requests:  94%|█████████▍| 1929/2048 [00:06<00:00, 302.38it/s]
Adding requests:  96%|█████████▌| 1962/2048 [00:06<00:00, 308.28it/s]
Adding requests:  97%|█████████▋| 1993/2048 [00:06<00:00, 304.96it/s]
Adding requests:  99%|█████████▉| 2024/2048 [00:06<00:00, 281.44it/s]
Adding requests: 100%|██████████| 2048/2048 [00:06<00:00, 298.17it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  12%|█▏        | 242/2048 [00:00<00:02, 673.42it/s, est. speed input: 689631.39 toks/s, output: 673.43 toks/s]
Processed prompts:  15%|█▌        | 310/2048 [00:02<00:14, 117.56it/s, est. speed input: 149228.34 toks/s, output: 145.73 toks/s]
Processed prompts:  17%|█▋        | 340/2048 [00:03<00:20, 84.93it/s, est. speed input: 115154.31 toks/s, output: 112.46 toks/s] 
Processed prompts:  17%|█▋        | 358/2048 [00:03<00:22, 75.21it/s, est. speed input: 105595.33 toks/s, output: 103.12 toks/s]
Processed prompts:  18%|█▊        | 371/2048 [00:03<00:26, 64.25it/s, est. speed input: 96897.65 toks/s, output: 94.63 toks/s]  
Processed prompts:  19%|█▉        | 386/2048 [00:04<00:29, 56.45it/s, est. speed input: 90457.62 toks/s, output: 88.34 toks/s]
Processed prompts:  20%|█▉        | 402/2048 [00:04<00:32, 50.96it/s, est. speed input: 85447.09 toks/s, output: 83.44 toks/s]
Processed prompts:  20%|██        | 418/2048 [00:05<00:34, 46.76it/s, est. speed input: 81284.56 toks/s, output: 79.38 toks/s]
Processed prompts:  21%|██        | 434/2048 [00:05<00:36, 44.28it/s, est. speed input: 78085.94 toks/s, output: 76.26 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [00:06<00:38, 41.69it/s, est. speed input: 75010.87 toks/s, output: 73.25 toks/s]
Processed prompts:  23%|██▎       | 466/2048 [00:06<00:39, 39.90it/s, est. speed input: 72380.67 toks/s, output: 70.68 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [00:07<00:40, 38.66it/s, est. speed input: 70097.13 toks/s, output: 68.45 toks/s]
Processed prompts:  24%|██▍       | 498/2048 [00:07<00:41, 37.76it/s, est. speed input: 68080.41 toks/s, output: 66.48 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [00:07<00:41, 37.12it/s, est. speed input: 66292.88 toks/s, output: 64.74 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [00:08<00:41, 36.71it/s, est. speed input: 64706.49 toks/s, output: 63.19 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [00:08<00:41, 36.38it/s, est. speed input: 63270.88 toks/s, output: 61.79 toks/s]
Processed prompts:  27%|██▋       | 562/2048 [00:09<00:41, 36.14it/s, est. speed input: 61970.58 toks/s, output: 60.52 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [00:09<00:40, 35.98it/s, est. speed input: 60793.99 toks/s, output: 59.37 toks/s]
Processed prompts:  29%|██▉       | 594/2048 [00:10<00:40, 35.87it/s, est. speed input: 59720.39 toks/s, output: 58.32 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [00:10<00:40, 35.77it/s, est. speed input: 58733.18 toks/s, output: 57.36 toks/s]
Processed prompts:  31%|███       | 626/2048 [00:11<00:39, 35.71it/s, est. speed input: 57827.31 toks/s, output: 56.47 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [00:11<00:39, 35.66it/s, est. speed input: 56991.20 toks/s, output: 55.66 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [00:11<00:39, 35.61it/s, est. speed input: 56214.83 toks/s, output: 54.90 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [00:12<00:38, 35.60it/s, est. speed input: 55498.71 toks/s, output: 54.20 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [00:12<00:38, 35.58it/s, est. speed input: 54831.95 toks/s, output: 53.55 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [00:13<00:37, 35.56it/s, est. speed input: 54207.66 toks/s, output: 52.94 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [00:13<00:37, 35.54it/s, est. speed input: 53623.10 toks/s, output: 52.37 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [00:14<00:36, 35.56it/s, est. speed input: 53081.70 toks/s, output: 51.84 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [00:14<00:36, 35.54it/s, est. speed input: 52568.22 toks/s, output: 51.34 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [00:15<00:35, 35.54it/s, est. speed input: 52086.34 toks/s, output: 50.87 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [00:15<00:34, 36.07it/s, est. speed input: 51706.62 toks/s, output: 50.49 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [00:16<00:34, 35.91it/s, est. speed input: 51276.08 toks/s, output: 50.07 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [00:16<00:34, 35.76it/s, est. speed input: 50864.40 toks/s, output: 49.67 toks/s]
Processed prompts:  41%|████      | 834/2048 [00:16<00:34, 35.66it/s, est. speed input: 50474.67 toks/s, output: 49.29 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [00:17<00:33, 35.61it/s, est. speed input: 50108.72 toks/s, output: 48.93 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [00:17<00:33, 35.59it/s, est. speed input: 49762.16 toks/s, output: 48.60 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [00:18<00:32, 35.53it/s, est. speed input: 49427.24 toks/s, output: 48.27 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [00:18<00:32, 35.51it/s, est. speed input: 49111.47 toks/s, output: 47.96 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [00:19<00:31, 35.49it/s, est. speed input: 48809.84 toks/s, output: 47.67 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [00:19<00:31, 35.50it/s, est. speed input: 48524.13 toks/s, output: 47.39 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [00:20<00:31, 35.49it/s, est. speed input: 48249.87 toks/s, output: 47.12 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [00:20<00:30, 35.46it/s, est. speed input: 47985.26 toks/s, output: 46.86 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [00:20<00:30, 35.45it/s, est. speed input: 47733.17 toks/s, output: 46.61 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [00:21<00:29, 35.42it/s, est. speed input: 47489.74 toks/s, output: 46.38 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [00:21<00:29, 35.41it/s, est. speed input: 47257.25 toks/s, output: 46.15 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [00:22<00:28, 35.40it/s, est. speed input: 47033.68 toks/s, output: 45.93 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [00:22<00:28, 35.37it/s, est. speed input: 46817.04 toks/s, output: 45.72 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [00:23<00:27, 35.39it/s, est. speed input: 46612.67 toks/s, output: 45.52 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [00:23<00:27, 35.38it/s, est. speed input: 46413.85 toks/s, output: 45.33 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [00:24<00:27, 35.39it/s, est. speed input: 46223.86 toks/s, output: 45.14 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [00:24<00:26, 35.37it/s, est. speed input: 46038.93 toks/s, output: 44.96 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [00:25<00:26, 35.39it/s, est. speed input: 45862.95 toks/s, output: 44.79 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [00:25<00:25, 35.37it/s, est. speed input: 45691.31 toks/s, output: 44.62 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [00:25<00:25, 35.36it/s, est. speed input: 45525.24 toks/s, output: 44.46 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [00:26<00:24, 35.35it/s, est. speed input: 45364.77 toks/s, output: 44.30 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [00:26<00:24, 35.37it/s, est. speed input: 45212.04 toks/s, output: 44.15 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [00:27<00:23, 35.92it/s, est. speed input: 45100.84 toks/s, output: 44.04 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [00:27<00:23, 35.76it/s, est. speed input: 44956.84 toks/s, output: 43.90 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [00:28<00:22, 36.23it/s, est. speed input: 44855.09 toks/s, output: 43.80 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [00:28<00:22, 35.97it/s, est. speed input: 44718.79 toks/s, output: 43.67 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [00:29<00:21, 35.77it/s, est. speed input: 44585.16 toks/s, output: 43.54 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [00:29<00:21, 35.65it/s, est. speed input: 44457.10 toks/s, output: 43.42 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [00:29<00:21, 35.54it/s, est. speed input: 44331.43 toks/s, output: 43.29 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [00:30<00:20, 35.48it/s, est. speed input: 44210.52 toks/s, output: 43.17 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [00:30<00:19, 36.04it/s, est. speed input: 44128.71 toks/s, output: 43.09 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [00:31<00:19, 35.78it/s, est. speed input: 44010.87 toks/s, output: 42.98 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [00:31<00:19, 35.64it/s, est. speed input: 43899.08 toks/s, output: 42.87 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [00:32<00:18, 35.55it/s, est. speed input: 43790.56 toks/s, output: 42.76 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [00:32<00:18, 35.46it/s, est. speed input: 43683.73 toks/s, output: 42.66 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [00:33<00:18, 35.43it/s, est. speed input: 43581.93 toks/s, output: 42.56 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [00:33<00:17, 35.36it/s, est. speed input: 43479.87 toks/s, output: 42.46 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [00:34<00:17, 35.37it/s, est. speed input: 43383.41 toks/s, output: 42.37 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [00:34<00:16, 35.92it/s, est. speed input: 43318.47 toks/s, output: 42.30 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [00:34<00:16, 35.73it/s, est. speed input: 43225.20 toks/s, output: 42.21 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [00:35<00:15, 35.60it/s, est. speed input: 43134.60 toks/s, output: 42.12 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [00:35<00:15, 35.47it/s, est. speed input: 43043.98 toks/s, output: 42.04 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [00:36<00:14, 36.00it/s, est. speed input: 42986.70 toks/s, output: 41.98 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [00:36<00:14, 35.76it/s, est. speed input: 42900.87 toks/s, output: 41.90 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [00:37<00:13, 36.21it/s, est. speed input: 42846.47 toks/s, output: 41.84 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [00:37<00:13, 35.92it/s, est. speed input: 42765.13 toks/s, output: 41.76 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [00:38<00:12, 35.68it/s, est. speed input: 42684.16 toks/s, output: 41.68 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [00:38<00:12, 35.54it/s, est. speed input: 42605.73 toks/s, output: 41.61 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [00:38<00:11, 36.06it/s, est. speed input: 42557.84 toks/s, output: 41.56 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [00:39<00:11, 35.80it/s, est. speed input: 42482.62 toks/s, output: 41.49 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [00:39<00:11, 35.61it/s, est. speed input: 42408.93 toks/s, output: 41.41 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [00:40<00:10, 35.52it/s, est. speed input: 42338.68 toks/s, output: 41.35 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [00:40<00:10, 35.41it/s, est. speed input: 42267.63 toks/s, output: 41.28 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [00:41<00:09, 35.38it/s, est. speed input: 42200.62 toks/s, output: 41.21 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [00:41<00:09, 35.30it/s, est. speed input: 42132.28 toks/s, output: 41.14 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [00:42<00:08, 35.89it/s, est. speed input: 42092.82 toks/s, output: 41.11 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [00:42<00:08, 36.31it/s, est. speed input: 42053.82 toks/s, output: 41.07 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [00:42<00:07, 35.95it/s, est. speed input: 41989.53 toks/s, output: 41.01 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [00:43<00:07, 35.71it/s, est. speed input: 41926.59 toks/s, output: 40.94 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [00:43<00:07, 35.53it/s, est. speed input: 41864.58 toks/s, output: 40.88 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [00:44<00:06, 35.42it/s, est. speed input: 41804.63 toks/s, output: 40.82 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [00:44<00:06, 35.34it/s, est. speed input: 41745.60 toks/s, output: 40.77 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [00:45<00:05, 35.27it/s, est. speed input: 41687.21 toks/s, output: 40.71 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [00:45<00:05, 35.23it/s, est. speed input: 41630.42 toks/s, output: 40.65 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [00:46<00:04, 35.18it/s, est. speed input: 41573.79 toks/s, output: 40.60 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [00:46<00:04, 35.78it/s, est. speed input: 41542.47 toks/s, output: 40.57 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [00:47<00:03, 35.60it/s, est. speed input: 41488.97 toks/s, output: 40.52 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [00:47<00:03, 35.46it/s, est. speed input: 41436.31 toks/s, output: 40.47 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [00:47<00:03, 35.33it/s, est. speed input: 41383.42 toks/s, output: 40.41 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [00:48<00:02, 35.31it/s, est. speed input: 41333.77 toks/s, output: 40.36 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [00:48<00:02, 35.23it/s, est. speed input: 41282.88 toks/s, output: 40.32 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [00:49<00:01, 35.79it/s, est. speed input: 41254.66 toks/s, output: 40.29 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [00:49<00:01, 35.61it/s, est. speed input: 41207.22 toks/s, output: 40.24 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [00:50<00:00, 35.47it/s, est. speed input: 41159.80 toks/s, output: 40.20 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [00:50<00:00, 36.04it/s, est. speed input: 41136.14 toks/s, output: 40.17 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:50<00:00, 36.04it/s, est. speed input: 41418.91 toks/s, output: 40.45 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:50<00:00, 40.45it/s, est. speed input: 41418.91 toks/s, output: 40.45 toks/s]
[rank0]:[W125 19:35:37.328737999 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=32768 ==========
Time: 2026-01-25 19:35:39
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=4096, max_num_seqs=32
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 4096 --max-num-seqs 32 --max-model-len 1025 --max-num-batched-tokens 32768 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/Qwen2.5-7B-INT8_M32768.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 19:36:17 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=369570) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=369570) WARNING 01-25 19:36:36 [backends.py:609] Failed to read file <frozen os>
Throughput: 35.43 requests/s, 36319.20 total tokens/s, 35.43 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096

STDERR:
[2026-01-25 19:36:17] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 19:36:17] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 19:36:17] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 19:36:17] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:36:17] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:36:17] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:36:17] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:36:17] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:36:17] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 19:36:17] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 19:36:17] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 19:36:17] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 19:36:17] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 19:36:17] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 19:36:25] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 19:36:25] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 19:36:25] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 19:36:25] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:36:25] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:36:25] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:36:25] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:36:25] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:36:25] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 19:36:25] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 19:36:25] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 19:36:25] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 19:36:25] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 19:36:25] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=369570) [2026-01-25 19:36:26] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=369570) [2026-01-25 19:36:26] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=369570) [2026-01-25 19:36:26] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=369570) [2026-01-25 19:36:26] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=369570) [2026-01-25 19:36:26] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=369570) [2026-01-25 19:36:26] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=369570) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=369570) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.73it/s]
(EngineCore_DP0 pid=369570) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.74it/s]
(EngineCore_DP0 pid=369570) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.74it/s]
(EngineCore_DP0 pid=369570) 
(EngineCore_DP0 pid=369570) [2026-01-25 19:36:27] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 3584] -> 1D uint8
(EngineCore_DP0 pid=369570) [2026-01-25 19:36:27] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12386304 bytes
(EngineCore_DP0 pid=369570) [2026-01-25 19:36:27] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 3584] -> 1D uint8
(EngineCore_DP0 pid=369570) [2026-01-25 19:36:27] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9633792 bytes
(EngineCore_DP0 pid=369570) [2026-01-25 19:36:27] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 3584] -> 1D uint8
(EngineCore_DP0 pid=369570) [2026-01-25 19:36:27] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 101842944 bytes
(EngineCore_DP0 pid=369570) [2026-01-25 19:36:27] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 18944] -> 1D uint8
(EngineCore_DP0 pid=369570) [2026-01-25 19:36:27] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 50921472 bytes
(EngineCore_DP0 pid=369570) [rank0]:W0125 19:36:44.851000 369570 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=369570) [rank0]:W0125 19:36:44.970000 369570 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=369570) [rank0]:W0125 19:36:46.377000 369570 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=369570) [rank0]:W0125 19:36:46.567000 369570 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=369570) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   9%|▉         | 1/11 [00:00<00:01,  9.45it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  27%|██▋       | 3/11 [00:00<00:00, 10.36it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  45%|████▌     | 5/11 [00:00<00:00, 10.69it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  64%|██████▎   | 7/11 [00:00<00:00, 10.96it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  82%|████████▏ | 9/11 [00:00<00:00, 11.06it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00, 10.79it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00, 10.77it/s]
(EngineCore_DP0 pid=369570) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  14%|█▍        | 1/7 [00:00<00:00,  9.18it/s]
Capturing CUDA graphs (decode, FULL):  43%|████▎     | 3/7 [00:00<00:00, 10.60it/s]
Capturing CUDA graphs (decode, FULL):  71%|███████▏  | 5/7 [00:00<00:00, 11.02it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00, 10.78it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00, 10.71it/s]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   1%|          | 25/4096 [00:00<00:16, 242.26it/s]
Adding requests:   1%|▏         | 53/4096 [00:00<00:15, 261.43it/s]
Adding requests:   2%|▏         | 82/4096 [00:00<00:14, 270.17it/s]
Adding requests:   3%|▎         | 110/4096 [00:00<00:14, 266.44it/s]
Adding requests:   3%|▎         | 137/4096 [00:00<00:15, 260.58it/s]
Adding requests:   4%|▍         | 164/4096 [00:00<00:14, 262.37it/s]
Adding requests:   5%|▍         | 193/4096 [00:00<00:14, 270.76it/s]
Adding requests:   5%|▌         | 222/4096 [00:00<00:14, 274.97it/s]
Adding requests:   6%|▌         | 250/4096 [00:00<00:14, 273.30it/s]
Adding requests:   7%|▋         | 279/4096 [00:01<00:13, 276.77it/s]
Adding requests:   8%|▊         | 308/4096 [00:01<00:13, 279.53it/s]
Adding requests:   8%|▊         | 337/4096 [00:01<00:13, 280.71it/s]
Adding requests:   9%|▉         | 366/4096 [00:01<00:13, 279.96it/s]
Adding requests:  10%|▉         | 397/4096 [00:01<00:12, 288.14it/s]
Adding requests:  10%|█         | 428/4096 [00:01<00:12, 294.30it/s]
Adding requests:  11%|█         | 458/4096 [00:01<00:12, 287.53it/s]
Adding requests:  12%|█▏        | 488/4096 [00:01<00:12, 290.52it/s]
Adding requests:  13%|█▎        | 518/4096 [00:01<00:12, 292.02it/s]
Adding requests:  13%|█▎        | 549/4096 [00:01<00:11, 295.87it/s]
Adding requests:  14%|█▍        | 580/4096 [00:02<00:11, 298.03it/s]
Adding requests:  15%|█▍        | 610/4096 [00:02<00:12, 287.08it/s]
Adding requests:  16%|█▌        | 640/4096 [00:02<00:11, 289.25it/s]
Adding requests:  16%|█▋        | 669/4096 [00:02<00:12, 279.61it/s]
Adding requests:  17%|█▋        | 702/4096 [00:02<00:11, 293.01it/s]
Adding requests:  18%|█▊        | 732/4096 [00:02<00:11, 292.75it/s]
Adding requests:  19%|█▊        | 762/4096 [00:02<00:11, 285.66it/s]
Adding requests:  19%|█▉        | 791/4096 [00:02<00:11, 285.17it/s]
Adding requests:  20%|██        | 820/4096 [00:02<00:11, 277.81it/s]
Adding requests:  21%|██        | 853/4096 [00:03<00:11, 292.21it/s]
Adding requests:  22%|██▏       | 885/4096 [00:03<00:10, 296.59it/s]
Adding requests:  22%|██▏       | 915/4096 [00:03<00:10, 295.79it/s]
Adding requests:  23%|██▎       | 945/4096 [00:03<00:10, 296.32it/s]
Adding requests:  24%|██▍       | 976/4096 [00:03<00:10, 299.13it/s]
Adding requests:  25%|██▍       | 1006/4096 [00:03<00:10, 292.98it/s]
Adding requests:  25%|██▌       | 1037/4096 [00:03<00:10, 297.24it/s]
Adding requests:  26%|██▌       | 1067/4096 [00:03<00:10, 293.40it/s]
Adding requests:  27%|██▋       | 1097/4096 [00:03<00:10, 288.84it/s]
Adding requests:  27%|██▋       | 1126/4096 [00:03<00:10, 285.19it/s]
Adding requests:  28%|██▊       | 1155/4096 [00:04<00:10, 280.16it/s]
Adding requests:  29%|██▉       | 1185/4096 [00:04<00:10, 283.55it/s]
Adding requests:  30%|██▉       | 1217/4096 [00:04<00:09, 292.78it/s]
Adding requests:  30%|███       | 1247/4096 [00:04<00:09, 292.21it/s]
Adding requests:  31%|███       | 1278/4096 [00:04<00:09, 294.23it/s]
Adding requests:  32%|███▏      | 1309/4096 [00:04<00:09, 297.92it/s]
Adding requests:  33%|███▎      | 1339/4096 [00:04<00:09, 294.57it/s]
Adding requests:  33%|███▎      | 1369/4096 [00:04<00:09, 292.77it/s]
Adding requests:  34%|███▍      | 1399/4096 [00:04<00:09, 287.02it/s]
Adding requests:  35%|███▍      | 1428/4096 [00:04<00:09, 282.23it/s]
Adding requests:  36%|███▌      | 1458/4096 [00:05<00:09, 287.14it/s]
Adding requests:  36%|███▋      | 1488/4096 [00:05<00:09, 288.09it/s]
Adding requests:  37%|███▋      | 1518/4096 [00:05<00:08, 290.32it/s]
Adding requests:  38%|███▊      | 1548/4096 [00:05<00:08, 292.79it/s]
Adding requests:  39%|███▊      | 1578/4096 [00:05<00:08, 288.89it/s]
Adding requests:  39%|███▉      | 1607/4096 [00:05<00:08, 285.91it/s]
Adding requests:  40%|███▉      | 1636/4096 [00:05<00:08, 285.30it/s]
Adding requests:  41%|████      | 1665/4096 [00:05<00:08, 281.34it/s]
Adding requests:  41%|████▏     | 1695/4096 [00:05<00:08, 285.02it/s]
Adding requests:  42%|████▏     | 1729/4096 [00:06<00:07, 297.87it/s]
Adding requests:  43%|████▎     | 1760/4096 [00:06<00:07, 300.40it/s]
Adding requests:  44%|████▍     | 1792/4096 [00:06<00:07, 303.31it/s]
Adding requests:  45%|████▍     | 1823/4096 [00:06<00:07, 296.00it/s]
Adding requests:  45%|████▌     | 1854/4096 [00:06<00:07, 299.17it/s]
Adding requests:  46%|████▌     | 1884/4096 [00:06<00:07, 299.36it/s]
Adding requests:  47%|████▋     | 1915/4096 [00:06<00:07, 300.63it/s]
Adding requests:  48%|████▊     | 1949/4096 [00:06<00:06, 309.89it/s]
Adding requests:  48%|████▊     | 1981/4096 [00:06<00:06, 305.51it/s]
Adding requests:  49%|████▉     | 2012/4096 [00:06<00:07, 293.43it/s]
Adding requests:  50%|████▉     | 2042/4096 [00:07<00:07, 290.15it/s]
Adding requests:  51%|█████     | 2072/4096 [00:07<00:07, 287.78it/s]
Adding requests:  51%|█████▏    | 2101/4096 [00:07<00:06, 287.93it/s]
Adding requests:  52%|█████▏    | 2131/4096 [00:07<00:06, 290.82it/s]
Adding requests:  53%|█████▎    | 2161/4096 [00:07<00:06, 292.43it/s]
Adding requests:  53%|█████▎    | 2191/4096 [00:07<00:06, 287.20it/s]
Adding requests:  54%|█████▍    | 2220/4096 [00:07<00:06, 281.83it/s]
Adding requests:  55%|█████▍    | 2251/4096 [00:07<00:06, 289.16it/s]
Adding requests:  56%|█████▌    | 2282/4096 [00:07<00:06, 294.91it/s]
Adding requests:  56%|█████▋    | 2312/4096 [00:08<00:06, 283.08it/s]
Adding requests:  57%|█████▋    | 2341/4096 [00:08<00:06, 283.46it/s]
Adding requests:  58%|█████▊    | 2370/4096 [00:08<00:06, 279.26it/s]
Adding requests:  59%|█████▊    | 2400/4096 [00:08<00:05, 282.82it/s]
Adding requests:  59%|█████▉    | 2430/4096 [00:08<00:05, 285.07it/s]
Adding requests:  60%|██████    | 2459/4096 [00:08<00:05, 280.85it/s]
Adding requests:  61%|██████    | 2490/4096 [00:08<00:05, 288.52it/s]
Adding requests:  62%|██████▏   | 2522/4096 [00:08<00:05, 295.28it/s]
Adding requests:  62%|██████▏   | 2554/4096 [00:08<00:05, 299.77it/s]
Adding requests:  63%|██████▎   | 2585/4096 [00:08<00:05, 298.79it/s]
Adding requests:  64%|██████▍   | 2615/4096 [00:09<00:05, 295.41it/s]
Adding requests:  65%|██████▍   | 2645/4096 [00:09<00:04, 294.24it/s]
Adding requests:  65%|██████▌   | 2676/4096 [00:09<00:04, 298.01it/s]
Adding requests:  66%|██████▌   | 2706/4096 [00:09<00:04, 293.40it/s]
Adding requests:  67%|██████▋   | 2736/4096 [00:09<00:04, 289.50it/s]
Adding requests:  68%|██████▊   | 2767/4096 [00:09<00:04, 293.47it/s]
Adding requests:  68%|██████▊   | 2798/4096 [00:09<00:04, 296.05it/s]
Adding requests:  69%|██████▉   | 2828/4096 [00:09<00:04, 293.76it/s]
Adding requests:  70%|██████▉   | 2859/4096 [00:09<00:04, 297.99it/s]
Adding requests:  71%|███████   | 2890/4096 [00:09<00:04, 300.11it/s]
Adding requests:  71%|███████▏  | 2921/4096 [00:10<00:03, 300.34it/s]
Adding requests:  72%|███████▏  | 2953/4096 [00:10<00:03, 305.18it/s]
Adding requests:  73%|███████▎  | 2984/4096 [00:10<00:03, 299.61it/s]
Adding requests:  74%|███████▎  | 3016/4096 [00:10<00:03, 302.28it/s]
Adding requests:  74%|███████▍  | 3048/4096 [00:10<00:03, 303.49it/s]
Adding requests:  75%|███████▌  | 3079/4096 [00:10<00:03, 303.98it/s]
Adding requests:  76%|███████▌  | 3110/4096 [00:10<00:03, 300.07it/s]
Adding requests:  77%|███████▋  | 3143/4096 [00:10<00:03, 307.19it/s]
Adding requests:  77%|███████▋  | 3174/4096 [00:10<00:03, 300.05it/s]
Adding requests:  78%|███████▊  | 3205/4096 [00:11<00:03, 294.81it/s]
Adding requests:  79%|███████▉  | 3235/4096 [00:11<00:02, 295.91it/s]
Adding requests:  80%|███████▉  | 3265/4096 [00:11<00:02, 287.82it/s]
Adding requests:  80%|████████  | 3294/4096 [00:11<00:02, 278.89it/s]
Adding requests:  81%|████████  | 3322/4096 [00:11<00:02, 276.06it/s]
Adding requests:  82%|████████▏ | 3352/4096 [00:11<00:02, 281.11it/s]
Adding requests:  83%|████████▎ | 3383/4096 [00:11<00:02, 287.99it/s]
Adding requests:  83%|████████▎ | 3414/4096 [00:11<00:02, 293.50it/s]
Adding requests:  84%|████████▍ | 3444/4096 [00:11<00:02, 292.14it/s]
Adding requests:  85%|████████▍ | 3476/4096 [00:11<00:02, 299.17it/s]
Adding requests:  86%|████████▌ | 3508/4096 [00:12<00:01, 303.77it/s]
Adding requests:  86%|████████▋ | 3542/4096 [00:12<00:01, 314.33it/s]
Adding requests:  87%|████████▋ | 3574/4096 [00:12<00:01, 307.60it/s]
Adding requests:  88%|████████▊ | 3605/4096 [00:12<00:01, 302.62it/s]
Adding requests:  89%|████████▉ | 3636/4096 [00:12<00:01, 303.03it/s]
Adding requests:  90%|████████▉ | 3667/4096 [00:12<00:01, 293.52it/s]
Adding requests:  90%|█████████ | 3697/4096 [00:12<00:01, 292.77it/s]
Adding requests:  91%|█████████ | 3730/4096 [00:12<00:01, 303.23it/s]
Adding requests:  92%|█████████▏| 3761/4096 [00:12<00:01, 296.20it/s]
Adding requests:  93%|█████████▎| 3791/4096 [00:13<00:01, 288.98it/s]
Adding requests:  93%|█████████▎| 3820/4096 [00:13<00:00, 286.66it/s]
Adding requests:  94%|█████████▍| 3850/4096 [00:13<00:00, 287.89it/s]
Adding requests:  95%|█████████▍| 3882/4096 [00:13<00:00, 294.89it/s]
Adding requests:  96%|█████████▌| 3912/4096 [00:13<00:00, 292.46it/s]
Adding requests:  96%|█████████▌| 3942/4096 [00:13<00:00, 287.71it/s]
Adding requests:  97%|█████████▋| 3973/4096 [00:13<00:00, 291.86it/s]
Adding requests:  98%|█████████▊| 4003/4096 [00:13<00:00, 294.20it/s]
Adding requests:  99%|█████████▊| 4035/4096 [00:13<00:00, 299.41it/s]
Adding requests:  99%|█████████▉| 4065/4096 [00:13<00:00, 298.74it/s]
Adding requests: 100%|██████████| 4096/4096 [00:14<00:00, 301.72it/s]
Adding requests: 100%|██████████| 4096/4096 [00:14<00:00, 291.38it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  12%|█▏        | 497/4096 [00:00<00:05, 696.29it/s, est. speed input: 713029.33 toks/s, output: 696.30 toks/s]
Processed prompts:  14%|█▍        | 567/4096 [00:02<00:19, 182.04it/s, est. speed input: 231341.55 toks/s, output: 225.92 toks/s]
Processed prompts:  15%|█▍        | 598/4096 [00:03<00:27, 129.10it/s, est. speed input: 179633.75 toks/s, output: 175.42 toks/s]
Processed prompts:  15%|█▌        | 625/4096 [00:04<00:36, 95.51it/s, est. speed input: 148539.14 toks/s, output: 145.06 toks/s] 
Processed prompts:  16%|█▌        | 657/4096 [00:05<00:45, 75.99it/s, est. speed input: 129210.25 toks/s, output: 126.18 toks/s]
Processed prompts:  17%|█▋        | 689/4096 [00:06<00:53, 63.15it/s, est. speed input: 115550.82 toks/s, output: 112.84 toks/s]
Processed prompts:  18%|█▊        | 721/4096 [00:07<01:01, 54.55it/s, est. speed input: 105402.78 toks/s, output: 102.93 toks/s]
Processed prompts:  18%|█▊        | 753/4096 [00:07<01:08, 48.69it/s, est. speed input: 97550.42 toks/s, output: 95.26 toks/s]  
Processed prompts:  19%|█▉        | 785/4096 [00:08<01:13, 45.03it/s, est. speed input: 91547.89 toks/s, output: 89.40 toks/s]
Processed prompts:  20%|█▉        | 817/4096 [00:09<01:17, 42.13it/s, est. speed input: 86421.78 toks/s, output: 84.40 toks/s]
Processed prompts:  21%|██        | 849/4096 [00:10<01:20, 40.14it/s, est. speed input: 82173.75 toks/s, output: 80.25 toks/s]
Processed prompts:  22%|██▏       | 881/4096 [00:11<01:23, 38.72it/s, est. speed input: 78568.80 toks/s, output: 76.73 toks/s]
Processed prompts:  22%|██▏       | 913/4096 [00:12<01:24, 37.76it/s, est. speed input: 75501.34 toks/s, output: 73.73 toks/s]
Processed prompts:  23%|██▎       | 945/4096 [00:13<01:25, 37.04it/s, est. speed input: 72829.83 toks/s, output: 71.12 toks/s]
Processed prompts:  24%|██▍       | 977/4096 [00:14<01:25, 36.56it/s, est. speed input: 70503.15 toks/s, output: 68.85 toks/s]
Processed prompts:  25%|██▍       | 1009/4096 [00:15<01:25, 36.22it/s, est. speed input: 68456.05 toks/s, output: 66.85 toks/s]
Processed prompts:  25%|██▌       | 1041/4096 [00:15<01:24, 35.98it/s, est. speed input: 66639.13 toks/s, output: 65.08 toks/s]
Processed prompts:  26%|██▌       | 1073/4096 [00:16<01:24, 35.82it/s, est. speed input: 65018.05 toks/s, output: 63.49 toks/s]
Processed prompts:  27%|██▋       | 1105/4096 [00:17<01:23, 35.70it/s, est. speed input: 63557.77 toks/s, output: 62.07 toks/s]
Processed prompts:  28%|██▊       | 1137/4096 [00:18<01:23, 35.62it/s, est. speed input: 62241.54 toks/s, output: 60.78 toks/s]
Processed prompts:  29%|██▊       | 1169/4096 [00:19<01:22, 35.55it/s, est. speed input: 61041.42 toks/s, output: 59.61 toks/s]
Processed prompts:  29%|██▉       | 1201/4096 [00:20<01:20, 35.81it/s, est. speed input: 60023.86 toks/s, output: 58.62 toks/s]
Processed prompts:  30%|███       | 1233/4096 [00:21<01:19, 35.96it/s, est. speed input: 59082.60 toks/s, output: 57.70 toks/s]
Processed prompts:  31%|███       | 1265/4096 [00:22<01:19, 35.81it/s, est. speed input: 58160.10 toks/s, output: 56.80 toks/s]
Processed prompts:  32%|███▏      | 1297/4096 [00:23<01:18, 35.68it/s, est. speed input: 57303.59 toks/s, output: 55.96 toks/s]
Processed prompts:  32%|███▏      | 1329/4096 [00:24<01:17, 35.87it/s, est. speed input: 56566.89 toks/s, output: 55.24 toks/s]
Processed prompts:  33%|███▎      | 1361/4096 [00:24<01:16, 35.74it/s, est. speed input: 55833.25 toks/s, output: 54.52 toks/s]
Processed prompts:  34%|███▍      | 1393/4096 [00:25<01:15, 35.61it/s, est. speed input: 55143.89 toks/s, output: 53.85 toks/s]
Processed prompts:  35%|███▍      | 1425/4096 [00:26<01:15, 35.52it/s, est. speed input: 54501.71 toks/s, output: 53.22 toks/s]
Processed prompts:  36%|███▌      | 1457/4096 [00:27<01:13, 35.76it/s, est. speed input: 53950.21 toks/s, output: 52.69 toks/s]
Processed prompts:  36%|███▋      | 1489/4096 [00:28<01:13, 35.63it/s, est. speed input: 53387.53 toks/s, output: 52.14 toks/s]
Processed prompts:  37%|███▋      | 1521/4096 [00:29<01:11, 35.84it/s, est. speed input: 52903.39 toks/s, output: 51.66 toks/s]
Processed prompts:  38%|███▊      | 1553/4096 [00:30<01:10, 35.97it/s, est. speed input: 52444.60 toks/s, output: 51.22 toks/s]
Processed prompts:  39%|███▊      | 1585/4096 [00:31<01:10, 35.74it/s, est. speed input: 51968.44 toks/s, output: 50.75 toks/s]
Processed prompts:  39%|███▉      | 1617/4096 [00:32<01:09, 35.88it/s, est. speed input: 51558.84 toks/s, output: 50.35 toks/s]
Processed prompts:  40%|████      | 1649/4096 [00:33<01:08, 35.67it/s, est. speed input: 51131.73 toks/s, output: 49.93 toks/s]
Processed prompts:  41%|████      | 1681/4096 [00:33<01:07, 35.55it/s, est. speed input: 50729.43 toks/s, output: 49.54 toks/s]
Processed prompts:  42%|████▏     | 1713/4096 [00:34<01:06, 35.76it/s, est. speed input: 50385.31 toks/s, output: 49.20 toks/s]
Processed prompts:  43%|████▎     | 1745/4096 [00:35<01:05, 35.90it/s, est. speed input: 50056.19 toks/s, output: 48.88 toks/s]
Processed prompts:  43%|████▎     | 1777/4096 [00:36<01:04, 35.69it/s, est. speed input: 49708.90 toks/s, output: 48.54 toks/s]
Processed prompts:  44%|████▍     | 1809/4096 [00:37<01:04, 35.54it/s, est. speed input: 49377.59 toks/s, output: 48.22 toks/s]
Processed prompts:  45%|████▍     | 1841/4096 [00:38<01:03, 35.44it/s, est. speed input: 49061.90 toks/s, output: 47.91 toks/s]
Processed prompts:  46%|████▌     | 1873/4096 [00:39<01:02, 35.67it/s, est. speed input: 48792.96 toks/s, output: 47.65 toks/s]
Processed prompts:  47%|████▋     | 1905/4096 [00:40<01:01, 35.53it/s, est. speed input: 48504.99 toks/s, output: 47.37 toks/s]
Processed prompts:  47%|████▋     | 1937/4096 [00:41<01:00, 35.44it/s, est. speed input: 48230.51 toks/s, output: 47.10 toks/s]
Processed prompts:  48%|████▊     | 1969/4096 [00:42<00:59, 35.67it/s, est. speed input: 47996.12 toks/s, output: 46.87 toks/s]
Processed prompts:  49%|████▉     | 2001/4096 [00:42<00:59, 35.48it/s, est. speed input: 47738.90 toks/s, output: 46.62 toks/s]
Processed prompts:  50%|████▉     | 2033/4096 [00:43<00:58, 35.39it/s, est. speed input: 47495.54 toks/s, output: 46.38 toks/s]
Processed prompts:  50%|█████     | 2065/4096 [00:44<00:57, 35.59it/s, est. speed input: 47286.30 toks/s, output: 46.18 toks/s]
Processed prompts:  51%|█████     | 2097/4096 [00:45<00:56, 35.46it/s, est. speed input: 47060.99 toks/s, output: 45.96 toks/s]
Processed prompts:  52%|█████▏    | 2129/4096 [00:46<00:55, 35.36it/s, est. speed input: 46844.33 toks/s, output: 45.75 toks/s]
Processed prompts:  53%|█████▎    | 2161/4096 [00:47<00:54, 35.26it/s, est. speed input: 46632.99 toks/s, output: 45.54 toks/s]
Processed prompts:  54%|█████▎    | 2193/4096 [00:48<00:53, 35.49it/s, est. speed input: 46453.78 toks/s, output: 45.37 toks/s]
Processed prompts:  54%|█████▍    | 2225/4096 [00:49<00:52, 35.37it/s, est. speed input: 46259.32 toks/s, output: 45.18 toks/s]
Processed prompts:  55%|█████▌    | 2257/4096 [00:50<00:52, 35.28it/s, est. speed input: 46071.19 toks/s, output: 44.99 toks/s]
Processed prompts:  56%|█████▌    | 2289/4096 [00:51<00:51, 35.20it/s, est. speed input: 45888.52 toks/s, output: 44.81 toks/s]
Processed prompts:  57%|█████▋    | 2321/4096 [00:51<00:50, 35.17it/s, est. speed input: 45714.33 toks/s, output: 44.64 toks/s]
Processed prompts:  57%|█████▋    | 2353/4096 [00:52<00:49, 35.15it/s, est. speed input: 45545.96 toks/s, output: 44.48 toks/s]
Processed prompts:  58%|█████▊    | 2385/4096 [00:53<00:48, 35.12it/s, est. speed input: 45382.26 toks/s, output: 44.32 toks/s]
Processed prompts:  59%|█████▉    | 2417/4096 [00:54<00:47, 35.11it/s, est. speed input: 45224.65 toks/s, output: 44.16 toks/s]
Processed prompts:  60%|█████▉    | 2449/4096 [00:55<00:46, 35.09it/s, est. speed input: 45071.24 toks/s, output: 44.01 toks/s]
Processed prompts:  61%|██████    | 2481/4096 [00:56<00:46, 35.06it/s, est. speed input: 44921.56 toks/s, output: 43.87 toks/s]
Processed prompts:  61%|██████▏   | 2513/4096 [00:57<00:45, 35.06it/s, est. speed input: 44778.25 toks/s, output: 43.73 toks/s]
Processed prompts:  62%|██████▏   | 2545/4096 [00:58<00:43, 35.35it/s, est. speed input: 44658.95 toks/s, output: 43.61 toks/s]
Processed prompts:  63%|██████▎   | 2577/4096 [00:59<00:42, 35.56it/s, est. speed input: 44542.85 toks/s, output: 43.50 toks/s]
Processed prompts:  64%|██████▎   | 2609/4096 [01:00<00:42, 35.38it/s, est. speed input: 44410.28 toks/s, output: 43.37 toks/s]
Processed prompts:  64%|██████▍   | 2641/4096 [01:01<00:40, 35.59it/s, est. speed input: 44301.54 toks/s, output: 43.26 toks/s]
Processed prompts:  65%|██████▌   | 2673/4096 [01:01<00:40, 35.41it/s, est. speed input: 44176.86 toks/s, output: 43.14 toks/s]
Processed prompts:  66%|██████▌   | 2705/4096 [01:02<00:39, 35.26it/s, est. speed input: 44054.18 toks/s, output: 43.02 toks/s]
Processed prompts:  67%|██████▋   | 2737/4096 [01:03<00:38, 35.47it/s, est. speed input: 43953.52 toks/s, output: 42.92 toks/s]
Processed prompts:  68%|██████▊   | 2769/4096 [01:04<00:37, 35.33it/s, est. speed input: 43839.10 toks/s, output: 42.81 toks/s]
Processed prompts:  68%|██████▊   | 2801/4096 [01:05<00:36, 35.24it/s, est. speed input: 43727.82 toks/s, output: 42.70 toks/s]
Processed prompts:  69%|██████▉   | 2833/4096 [01:06<00:35, 35.16it/s, est. speed input: 43619.32 toks/s, output: 42.60 toks/s]
Processed prompts:  70%|██████▉   | 2865/4096 [01:07<00:35, 35.10it/s, est. speed input: 43513.22 toks/s, output: 42.49 toks/s]
Processed prompts:  71%|███████   | 2897/4096 [01:08<00:33, 36.03it/s, est. speed input: 43462.06 toks/s, output: 42.44 toks/s]
Processed prompts:  72%|███████▏  | 2929/4096 [01:09<00:32, 35.71it/s, est. speed input: 43360.76 toks/s, output: 42.34 toks/s]
Processed prompts:  72%|███████▏  | 2961/4096 [01:10<00:32, 35.46it/s, est. speed input: 43261.00 toks/s, output: 42.25 toks/s]
Processed prompts:  73%|███████▎  | 2993/4096 [01:11<00:31, 35.31it/s, est. speed input: 43164.95 toks/s, output: 42.15 toks/s]
Processed prompts:  74%|███████▍  | 3025/4096 [01:11<00:30, 35.20it/s, est. speed input: 43071.16 toks/s, output: 42.06 toks/s]
Processed prompts:  75%|███████▍  | 3057/4096 [01:12<00:29, 35.11it/s, est. speed input: 42978.53 toks/s, output: 41.97 toks/s]
Processed prompts:  75%|███████▌  | 3089/4096 [01:13<00:28, 35.06it/s, est. speed input: 42889.06 toks/s, output: 41.88 toks/s]
Processed prompts:  76%|███████▌  | 3121/4096 [01:14<00:27, 35.01it/s, est. speed input: 42801.39 toks/s, output: 41.80 toks/s]
Processed prompts:  77%|███████▋  | 3153/4096 [01:15<00:26, 34.98it/s, est. speed input: 42715.96 toks/s, output: 41.71 toks/s]
Processed prompts:  78%|███████▊  | 3185/4096 [01:16<00:26, 34.97it/s, est. speed input: 42632.66 toks/s, output: 41.63 toks/s]
Processed prompts:  79%|███████▊  | 3217/4096 [01:17<00:25, 34.95it/s, est. speed input: 42551.37 toks/s, output: 41.55 toks/s]
Processed prompts:  79%|███████▉  | 3249/4096 [01:18<00:24, 34.93it/s, est. speed input: 42471.18 toks/s, output: 41.48 toks/s]
Processed prompts:  80%|████████  | 3281/4096 [01:19<00:23, 34.92it/s, est. speed input: 42393.46 toks/s, output: 41.40 toks/s]
Processed prompts:  81%|████████  | 3313/4096 [01:20<00:22, 34.92it/s, est. speed input: 42317.29 toks/s, output: 41.33 toks/s]
Processed prompts:  82%|████████▏ | 3345/4096 [01:21<00:21, 34.91it/s, est. speed input: 42242.98 toks/s, output: 41.25 toks/s]
Processed prompts:  82%|████████▏ | 3377/4096 [01:22<00:20, 34.90it/s, est. speed input: 42169.86 toks/s, output: 41.18 toks/s]
Processed prompts:  83%|████████▎ | 3409/4096 [01:22<00:19, 34.90it/s, est. speed input: 42098.88 toks/s, output: 41.11 toks/s]
Processed prompts:  84%|████████▍ | 3441/4096 [01:23<00:18, 34.89it/s, est. speed input: 42028.73 toks/s, output: 41.04 toks/s]
Processed prompts:  85%|████████▍ | 3473/4096 [01:24<00:17, 34.89it/s, est. speed input: 41960.35 toks/s, output: 40.98 toks/s]
Processed prompts:  86%|████████▌ | 3505/4096 [01:25<00:16, 34.88it/s, est. speed input: 41893.17 toks/s, output: 40.91 toks/s]
Processed prompts:  86%|████████▋ | 3537/4096 [01:26<00:15, 35.17it/s, est. speed input: 41840.22 toks/s, output: 40.86 toks/s]
Processed prompts:  87%|████████▋ | 3569/4096 [01:27<00:15, 35.06it/s, est. speed input: 41775.08 toks/s, output: 40.80 toks/s]
Processed prompts:  88%|████████▊ | 3601/4096 [01:28<00:14, 35.00it/s, est. speed input: 41711.69 toks/s, output: 40.73 toks/s]
Processed prompts:  89%|████████▊ | 3633/4096 [01:29<00:13, 34.95it/s, est. speed input: 41649.77 toks/s, output: 40.67 toks/s]
Processed prompts:  89%|████████▉ | 3665/4096 [01:30<00:12, 35.22it/s, est. speed input: 41601.16 toks/s, output: 40.63 toks/s]
Processed prompts:  90%|█████████ | 3697/4096 [01:31<00:11, 35.10it/s, est. speed input: 41541.02 toks/s, output: 40.57 toks/s]
Processed prompts:  91%|█████████ | 3729/4096 [01:32<00:10, 35.01it/s, est. speed input: 41482.16 toks/s, output: 40.51 toks/s]
Processed prompts:  92%|█████████▏| 3761/4096 [01:32<00:09, 34.98it/s, est. speed input: 41425.48 toks/s, output: 40.45 toks/s]
Processed prompts:  93%|█████████▎| 3793/4096 [01:33<00:08, 34.97it/s, est. speed input: 41370.53 toks/s, output: 40.40 toks/s]
Processed prompts:  93%|█████████▎| 3825/4096 [01:34<00:07, 34.97it/s, est. speed input: 41316.99 toks/s, output: 40.35 toks/s]
Processed prompts:  94%|█████████▍| 3857/4096 [01:35<00:06, 34.95it/s, est. speed input: 41263.62 toks/s, output: 40.30 toks/s]
Processed prompts:  95%|█████████▍| 3889/4096 [01:36<00:05, 34.96it/s, est. speed input: 41211.95 toks/s, output: 40.25 toks/s]
Processed prompts:  96%|█████████▌| 3921/4096 [01:37<00:04, 35.57it/s, est. speed input: 41183.20 toks/s, output: 40.22 toks/s]
Processed prompts:  97%|█████████▋| 3953/4096 [01:38<00:04, 35.39it/s, est. speed input: 41133.33 toks/s, output: 40.17 toks/s]
Processed prompts:  97%|█████████▋| 3985/4096 [01:39<00:03, 35.55it/s, est. speed input: 41094.53 toks/s, output: 40.13 toks/s]
Processed prompts:  98%|█████████▊| 4017/4096 [01:40<00:02, 35.36it/s, est. speed input: 41045.85 toks/s, output: 40.08 toks/s]
Processed prompts:  99%|█████████▉| 4049/4096 [01:41<00:01, 35.57it/s, est. speed input: 41009.77 toks/s, output: 40.05 toks/s]
Processed prompts: 100%|█████████▉| 4081/4096 [01:41<00:00, 42.10it/s, est. speed input: 41156.90 toks/s, output: 40.19 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [01:41<00:00, 42.10it/s, est. speed input: 41308.01 toks/s, output: 40.34 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [01:41<00:00, 40.34it/s, est. speed input: 41308.01 toks/s, output: 40.34 toks/s]
[rank0]:[W125 19:38:54.444293491 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=65536 ==========
Time: 2026-01-25 19:38:56
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=8192, max_num_seqs=64
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 8192 --max-num-seqs 64 --max-model-len 1025 --max-num-batched-tokens 65536 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/Qwen2.5-7B-INT8_M65536.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 19:40:07 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=372966) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=372966) WARNING 01-25 19:40:26 [backends.py:609] Failed to read file <frozen os>
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 240, in _initialize_kv_caches
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     available_gpu_memory = self.model_executor.determine_available_memory()
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     return self.collective_rpc("determine_available_memory")
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     result = run_method(self.driver_worker, method, args, kwargs)
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/root/vllmbench/vllm/v1/serial_utils.py", line 461, in run_method
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 340, in determine_available_memory
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     self.model_runner.profile_run()
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4474, in profile_run
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     hidden_states, last_hidden_states = self._dummy_run(
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]                                         ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4198, in _dummy_run
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     outputs = self.model(
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]               ^^^^^^^^^^^
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 583, in forward
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     hidden_states = self.model(
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]                     ^^^^^^^^^^^
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/root/vllmbench/vllm/compilation/decorators.py", line 526, in __call__
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/root/vllmbench/vllm/compilation/wrapper.py", line 218, in __call__
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     return self._call_with_optional_nvtx_range(
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/root/vllmbench/vllm/compilation/wrapper.py", line 109, in _call_with_optional_nvtx_range
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     return callable_fn(*args, **kwargs)
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 832, in compile_wrapper
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     return fn(*args, **kwargs)
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 418, in forward
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     def forward(
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     return fn(*args, **kwargs)
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/root/vllmbench/vllm/compilation/caching.py", line 54, in __call__
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     return self.optimized_call(*args, **kwargs)
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 837, in call_wrapped
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     return self._wrapped_call(self, *args, **kwargs)
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 413, in __call__
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     raise e
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 400, in __call__
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     return super(self.cls, obj).__call__(*args, **kwargs)  # type: ignore[misc]
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "<eval_with_key>.58", line 325, in forward
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     submod_2 = self.submod_2(getitem_3, s72, l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_scale_, l_self_modules_layers_modules_0_modules_post_attention_layernorm_parameters_weight_, getitem_4, l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_scale_, l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_input_layernorm_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_bias_, l_positions_, l_self_modules_layers_modules_0_modules_self_attn_modules_rotary_emb_buffers_cos_sin_cache_);  getitem_3 = l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_scale_ = l_self_modules_layers_modules_0_modules_post_attention_layernorm_parameters_weight_ = getitem_4 = l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_scale_ = l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_input_layernorm_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_bias_ = None
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/root/vllmbench/vllm/compilation/piecewise_backend.py", line 178, in __call__
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     return range_entry.runnable(*args)
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/standalone_compile.py", line 63, in __call__
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     return self._compiled_fn(*args)
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     return fn(*args, **kwargs)
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/aot_autograd.py", line 1130, in forward
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     return compiled_fn(full_args)
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 353, in runtime_wrapper
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     all_outs = call_func_at_runtime_with_args(
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/utils.py", line 129, in call_func_at_runtime_with_args
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     out = normalize_as_list(f(args))
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]                             ^^^^^^^
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 724, in inner_fn
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     outs = compiled_fn(args)
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]            ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 526, in wrapper
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     return compiled_fn(runtime_args)
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/output_code.py", line 613, in __call__
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     return self.current_callable(inputs)
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/utils.py", line 2962, in run
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     out = model(new_inputs)
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]           ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/tmp/torchinductor_root/mg/cmgpwljzo6ba4mma7n4yhaoccaaovsui6woecf6rfef3pw3qqgh2.py", line 1090, in call
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     triton_poi_fused_mul_quant_slide_int8_silu_slice_1.run(buf15, buf16, triton_poi_fused_mul_quant_slide_int8_silu_slice_1_xnumel, stream=stream0)
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 1272, in run
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     self.autotune_to_one_config(*args, **kwargs)
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 1048, in autotune_to_one_config
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     timings = self.benchmark_all_configs(*args, **kwargs)
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 1023, in benchmark_all_configs
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     launcher: self.bench(launcher, *args, **kwargs)
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 891, in bench
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     return benchmarker.benchmark_gpu(kernel_call, rep=40)
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/benchmarking.py", line 39, in wrapper
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     return fn(self, *args, **kwargs)
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/benchmarking.py", line 247, in benchmark_gpu
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     torch.cuda.synchronize()
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py", line 1083, in synchronize
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]     return torch._C._cuda_synchronize()
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866] torch.AcceleratorError: CUDA error: an illegal memory access was encountered
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866] Search for `cudaErrorIllegalAddress' in https://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__TYPES.html for more information.
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866] CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866] For debugging consider passing CUDA_LAUNCH_BLOCKING=1
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866] Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
(EngineCore_DP0 pid=372966) ERROR 01-25 19:40:38 [core.py:866] 

STDERR:
[2026-01-25 19:40:07] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 19:40:07] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 19:40:07] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 19:40:07] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:40:07] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:40:07] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:40:07] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:40:07] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:40:07] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 19:40:07] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 19:40:07] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 19:40:07] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 19:40:07] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 19:40:07] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 19:40:15] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 19:40:15] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-25 19:40:15] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-25 19:40:15] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:40:15] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:40:15] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:40:15] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:40:15] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-25 19:40:15] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-25 19:40:15] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 19:40:15] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 19:40:15] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 19:40:15] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 19:40:15] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=372966) [2026-01-25 19:40:16] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=372966) [2026-01-25 19:40:16] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=372966) [2026-01-25 19:40:16] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=372966) [2026-01-25 19:40:16] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=372966) [2026-01-25 19:40:16] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=372966) [2026-01-25 19:40:16] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=372966) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=372966) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.73it/s]
(EngineCore_DP0 pid=372966) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.72it/s]
(EngineCore_DP0 pid=372966) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.72it/s]
(EngineCore_DP0 pid=372966) 
(EngineCore_DP0 pid=372966) [2026-01-25 19:40:18] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 3584] -> 1D uint8
(EngineCore_DP0 pid=372966) [2026-01-25 19:40:18] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12386304 bytes
(EngineCore_DP0 pid=372966) [2026-01-25 19:40:18] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 3584] -> 1D uint8
(EngineCore_DP0 pid=372966) [2026-01-25 19:40:18] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9633792 bytes
(EngineCore_DP0 pid=372966) [2026-01-25 19:40:18] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 3584] -> 1D uint8
(EngineCore_DP0 pid=372966) [2026-01-25 19:40:18] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 101842944 bytes
(EngineCore_DP0 pid=372966) [2026-01-25 19:40:18] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 18944] -> 1D uint8
(EngineCore_DP0 pid=372966) [2026-01-25 19:40:18] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 50921472 bytes
(EngineCore_DP0 pid=372966) [rank0]:W0125 19:40:35.774000 372966 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=372966) [rank0]:W0125 19:40:35.898000 372966 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=372966) [rank0]:W0125 19:40:37.325000 372966 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=372966) [rank0]:W0125 19:40:37.526000 372966 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=372966) Process EngineCore_DP0:
(EngineCore_DP0 pid=372966) Traceback (most recent call last):
(EngineCore_DP0 pid=372966)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=372966)     self.run()
(EngineCore_DP0 pid=372966)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=372966)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=372966)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=372966)     raise e
(EngineCore_DP0 pid=372966)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=372966)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=372966)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=372966)     super().__init__(
(EngineCore_DP0 pid=372966)   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=372966)     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=372966)                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966)   File "/root/vllmbench/vllm/v1/engine/core.py", line 240, in _initialize_kv_caches
(EngineCore_DP0 pid=372966)     available_gpu_memory = self.model_executor.determine_available_memory()
(EngineCore_DP0 pid=372966)                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966)   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
(EngineCore_DP0 pid=372966)     return self.collective_rpc("determine_available_memory")
(EngineCore_DP0 pid=372966)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966)   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
(EngineCore_DP0 pid=372966)     result = run_method(self.driver_worker, method, args, kwargs)
(EngineCore_DP0 pid=372966)              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966)   File "/root/vllmbench/vllm/v1/serial_utils.py", line 461, in run_method
(EngineCore_DP0 pid=372966)     return func(*args, **kwargs)
(EngineCore_DP0 pid=372966)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966)   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=372966)     return func(*args, **kwargs)
(EngineCore_DP0 pid=372966)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966)   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 340, in determine_available_memory
(EngineCore_DP0 pid=372966)     self.model_runner.profile_run()
(EngineCore_DP0 pid=372966)   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4474, in profile_run
(EngineCore_DP0 pid=372966)     hidden_states, last_hidden_states = self._dummy_run(
(EngineCore_DP0 pid=372966)                                         ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966)   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=372966)     return func(*args, **kwargs)
(EngineCore_DP0 pid=372966)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966)   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4198, in _dummy_run
(EngineCore_DP0 pid=372966)     outputs = self.model(
(EngineCore_DP0 pid=372966)               ^^^^^^^^^^^
(EngineCore_DP0 pid=372966)   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=372966)     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=372966)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=372966)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=372966)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=372966)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=372966)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 583, in forward
(EngineCore_DP0 pid=372966)     hidden_states = self.model(
(EngineCore_DP0 pid=372966)                     ^^^^^^^^^^^
(EngineCore_DP0 pid=372966)   File "/root/vllmbench/vllm/compilation/decorators.py", line 526, in __call__
(EngineCore_DP0 pid=372966)     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
(EngineCore_DP0 pid=372966)              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966)   File "/root/vllmbench/vllm/compilation/wrapper.py", line 218, in __call__
(EngineCore_DP0 pid=372966)     return self._call_with_optional_nvtx_range(
(EngineCore_DP0 pid=372966)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966)   File "/root/vllmbench/vllm/compilation/wrapper.py", line 109, in _call_with_optional_nvtx_range
(EngineCore_DP0 pid=372966)     return callable_fn(*args, **kwargs)
(EngineCore_DP0 pid=372966)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966)   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 832, in compile_wrapper
(EngineCore_DP0 pid=372966)     return fn(*args, **kwargs)
(EngineCore_DP0 pid=372966)            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 418, in forward
(EngineCore_DP0 pid=372966)     def forward(
(EngineCore_DP0 pid=372966)   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=372966)     return fn(*args, **kwargs)
(EngineCore_DP0 pid=372966)            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966)   File "/root/vllmbench/vllm/compilation/caching.py", line 54, in __call__
(EngineCore_DP0 pid=372966)     return self.optimized_call(*args, **kwargs)
(EngineCore_DP0 pid=372966)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966)   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 837, in call_wrapped
(EngineCore_DP0 pid=372966)     return self._wrapped_call(self, *args, **kwargs)
(EngineCore_DP0 pid=372966)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966)   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 413, in __call__
(EngineCore_DP0 pid=372966)     raise e
(EngineCore_DP0 pid=372966)   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 400, in __call__
(EngineCore_DP0 pid=372966)     return super(self.cls, obj).__call__(*args, **kwargs)  # type: ignore[misc]
(EngineCore_DP0 pid=372966)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=372966)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=372966)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=372966)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=372966)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966)   File "<eval_with_key>.58", line 325, in forward
(EngineCore_DP0 pid=372966)     submod_2 = self.submod_2(getitem_3, s72, l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_scale_, l_self_modules_layers_modules_0_modules_post_attention_layernorm_parameters_weight_, getitem_4, l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_scale_, l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_input_layernorm_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_bias_, l_positions_, l_self_modules_layers_modules_0_modules_self_attn_modules_rotary_emb_buffers_cos_sin_cache_);  getitem_3 = l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_scale_ = l_self_modules_layers_modules_0_modules_post_attention_layernorm_parameters_weight_ = getitem_4 = l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_scale_ = l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_input_layernorm_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_bias_ = None
(EngineCore_DP0 pid=372966)                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966)   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=372966)     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=372966)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966)   File "/root/vllmbench/vllm/compilation/piecewise_backend.py", line 178, in __call__
(EngineCore_DP0 pid=372966)     return range_entry.runnable(*args)
(EngineCore_DP0 pid=372966)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/standalone_compile.py", line 63, in __call__
(EngineCore_DP0 pid=372966)     return self._compiled_fn(*args)
(EngineCore_DP0 pid=372966)            ^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966)   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=372966)     return fn(*args, **kwargs)
(EngineCore_DP0 pid=372966)            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/aot_autograd.py", line 1130, in forward
(EngineCore_DP0 pid=372966)     return compiled_fn(full_args)
(EngineCore_DP0 pid=372966)            ^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 353, in runtime_wrapper
(EngineCore_DP0 pid=372966)     all_outs = call_func_at_runtime_with_args(
(EngineCore_DP0 pid=372966)                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/utils.py", line 129, in call_func_at_runtime_with_args
(EngineCore_DP0 pid=372966)     out = normalize_as_list(f(args))
(EngineCore_DP0 pid=372966)                             ^^^^^^^
(EngineCore_DP0 pid=372966)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 724, in inner_fn
(EngineCore_DP0 pid=372966)     outs = compiled_fn(args)
(EngineCore_DP0 pid=372966)            ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 526, in wrapper
(EngineCore_DP0 pid=372966)     return compiled_fn(runtime_args)
(EngineCore_DP0 pid=372966)            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/output_code.py", line 613, in __call__
(EngineCore_DP0 pid=372966)     return self.current_callable(inputs)
(EngineCore_DP0 pid=372966)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/utils.py", line 2962, in run
(EngineCore_DP0 pid=372966)     out = model(new_inputs)
(EngineCore_DP0 pid=372966)           ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966)   File "/tmp/torchinductor_root/mg/cmgpwljzo6ba4mma7n4yhaoccaaovsui6woecf6rfef3pw3qqgh2.py", line 1090, in call
(EngineCore_DP0 pid=372966)     triton_poi_fused_mul_quant_slide_int8_silu_slice_1.run(buf15, buf16, triton_poi_fused_mul_quant_slide_int8_silu_slice_1_xnumel, stream=stream0)
(EngineCore_DP0 pid=372966)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 1272, in run
(EngineCore_DP0 pid=372966)     self.autotune_to_one_config(*args, **kwargs)
(EngineCore_DP0 pid=372966)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 1048, in autotune_to_one_config
(EngineCore_DP0 pid=372966)     timings = self.benchmark_all_configs(*args, **kwargs)
(EngineCore_DP0 pid=372966)               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 1023, in benchmark_all_configs
(EngineCore_DP0 pid=372966)     launcher: self.bench(launcher, *args, **kwargs)
(EngineCore_DP0 pid=372966)               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 891, in bench
(EngineCore_DP0 pid=372966)     return benchmarker.benchmark_gpu(kernel_call, rep=40)
(EngineCore_DP0 pid=372966)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/benchmarking.py", line 39, in wrapper
(EngineCore_DP0 pid=372966)     return fn(self, *args, **kwargs)
(EngineCore_DP0 pid=372966)            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/benchmarking.py", line 247, in benchmark_gpu
(EngineCore_DP0 pid=372966)     torch.cuda.synchronize()
(EngineCore_DP0 pid=372966)   File "/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py", line 1083, in synchronize
(EngineCore_DP0 pid=372966)     return torch._C._cuda_synchronize()
(EngineCore_DP0 pid=372966)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=372966) torch.AcceleratorError: CUDA error: an illegal memory access was encountered
(EngineCore_DP0 pid=372966) Search for `cudaErrorIllegalAddress' in https://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__TYPES.html for more information.
(EngineCore_DP0 pid=372966) CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
(EngineCore_DP0 pid=372966) For debugging consider passing CUDA_LAUNCH_BLOCKING=1
(EngineCore_DP0 pid=372966) Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
(EngineCore_DP0 pid=372966) 
[rank0]:[W125 19:40:39.789161584 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

ERROR: Test failed for M=65536

========== M=512 ==========
Time: 2026-01-25 21:25:49
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_4
Params: prompt_len=512, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_4 --dataset-name random --input-len 512 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 513 --max-num-batched-tokens 513 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/Qwen2.5-14B-INT8_M512.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 21:25:57 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=469037) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=469037) WARNING 01-25 21:36:34 [backends.py:609] Failed to read file <frozen os>
Throughput: 12.96 requests/s, 6646.10 total tokens/s, 12.96 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128

STDERR:
[2026-01-25 21:25:57] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 21:25:57] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-25 21:25:57] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-25 21:25:57] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:25:57] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:25:57] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:25:57] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:25:57] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:25:57] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-25 21:25:57] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 21:25:57] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 21:25:57] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 21:25:57] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 21:25:57] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 21:26:05] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 21:26:05] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-25 21:26:05] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-25 21:26:05] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:26:05] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:26:05] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:26:05] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:26:05] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:26:05] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-25 21:26:05] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 21:26:05] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 21:26:05] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 21:26:05] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 21:26:05] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=469037) [2026-01-25 21:26:06] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=469037) [2026-01-25 21:26:06] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=469037) [2026-01-25 21:26:06] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=469037) [2026-01-25 21:26:06] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=469037) [2026-01-25 21:26:06] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=469037) [2026-01-25 21:26:06] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=469037) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=469037) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [02:37<07:52, 157.61s/it]
(EngineCore_DP0 pid=469037) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [03:54<03:40, 110.25s/it]
(EngineCore_DP0 pid=469037) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [06:24<02:08, 128.18s/it]
(EngineCore_DP0 pid=469037) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [10:14<00:00, 168.52s/it]
(EngineCore_DP0 pid=469037) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [10:14<00:00, 153.65s/it]
(EngineCore_DP0 pid=469037) 
(EngineCore_DP0 pid=469037) [2026-01-25 21:36:21] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 5120] -> 1D uint8
(EngineCore_DP0 pid=469037) [2026-01-25 21:36:21] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 27525120 bytes
(EngineCore_DP0 pid=469037) [2026-01-25 21:36:21] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 5120] -> 1D uint8
(EngineCore_DP0 pid=469037) [2026-01-25 21:36:21] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 19660800 bytes
(EngineCore_DP0 pid=469037) [2026-01-25 21:36:21] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 5120] -> 1D uint8
(EngineCore_DP0 pid=469037) [2026-01-25 21:36:21] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 106168320 bytes
(EngineCore_DP0 pid=469037) [2026-01-25 21:36:21] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 13824] -> 1D uint8
(EngineCore_DP0 pid=469037) [2026-01-25 21:36:21] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 53084160 bytes
(EngineCore_DP0 pid=469037) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  2.17it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:01<00:00,  1.89it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:01<00:00,  1.92it/s]
(EngineCore_DP0 pid=469037) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  5.92it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  5.91it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  41%|████▏     | 53/128 [00:00<00:00, 518.70it/s]
Adding requests:  85%|████████▌ | 109/128 [00:00<00:00, 541.29it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 534.61it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:54,  2.34it/s, est. speed input: 1199.57 toks/s, output: 2.34 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:20,  5.98it/s, est. speed input: 2648.72 toks/s, output: 5.17 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:14,  8.35it/s, est. speed input: 3509.47 toks/s, output: 6.85 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:12,  9.95it/s, est. speed input: 4081.34 toks/s, output: 7.97 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:01<00:10, 11.11it/s, est. speed input: 4502.09 toks/s, output: 8.79 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:01<00:09, 11.89it/s, est. speed input: 4814.24 toks/s, output: 9.40 toks/s]
Processed prompts:  10%|█         | 13/128 [00:01<00:09, 12.45it/s, est. speed input: 5060.81 toks/s, output: 9.88 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:01<00:08, 12.89it/s, est. speed input: 5263.80 toks/s, output: 10.28 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:01<00:08, 13.00it/s, est. speed input: 5406.95 toks/s, output: 10.56 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:01<00:08, 13.34it/s, est. speed input: 5555.61 toks/s, output: 10.85 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:01<00:07, 13.55it/s, est. speed input: 5678.06 toks/s, output: 11.09 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:02<00:07, 13.69it/s, est. speed input: 5783.26 toks/s, output: 11.30 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:02<00:07, 13.84it/s, est. speed input: 5879.36 toks/s, output: 11.48 toks/s]
Processed prompts:  21%|██        | 27/128 [00:02<00:07, 13.88it/s, est. speed input: 5957.74 toks/s, output: 11.64 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:02<00:07, 13.80it/s, est. speed input: 6018.13 toks/s, output: 11.75 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:02<00:07, 13.81it/s, est. speed input: 6077.02 toks/s, output: 11.87 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:02<00:07, 13.48it/s, est. speed input: 6103.09 toks/s, output: 11.92 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:02<00:06, 13.39it/s, est. speed input: 6137.20 toks/s, output: 11.99 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:03<00:06, 13.62it/s, est. speed input: 6188.84 toks/s, output: 12.09 toks/s]
Processed prompts:  30%|███       | 39/128 [00:03<00:06, 13.64it/s, est. speed input: 6226.14 toks/s, output: 12.16 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:03<00:06, 13.63it/s, est. speed input: 6258.91 toks/s, output: 12.22 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:03<00:06, 13.64it/s, est. speed input: 6289.33 toks/s, output: 12.28 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:03<00:06, 13.51it/s, est. speed input: 6309.12 toks/s, output: 12.32 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:03<00:05, 13.64it/s, est. speed input: 6341.03 toks/s, output: 12.38 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:03<00:05, 13.81it/s, est. speed input: 6374.58 toks/s, output: 12.45 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:04<00:05, 13.68it/s, est. speed input: 6392.10 toks/s, output: 12.48 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:04<00:05, 13.78it/s, est. speed input: 6418.45 toks/s, output: 12.54 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:04<00:05, 13.84it/s, est. speed input: 6442.56 toks/s, output: 12.58 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:04<00:05, 13.86it/s, est. speed input: 6464.15 toks/s, output: 12.63 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:04<00:04, 13.89it/s, est. speed input: 6485.04 toks/s, output: 12.67 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:04<00:04, 13.98it/s, est. speed input: 6508.00 toks/s, output: 12.71 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:04<00:04, 14.05it/s, est. speed input: 6529.94 toks/s, output: 12.75 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:05<00:04, 14.09it/s, est. speed input: 6550.33 toks/s, output: 12.79 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:05<00:04, 14.09it/s, est. speed input: 6568.48 toks/s, output: 12.83 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:05<00:04, 13.98it/s, est. speed input: 6580.96 toks/s, output: 12.85 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:05<00:04, 13.87it/s, est. speed input: 6591.47 toks/s, output: 12.87 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:05<00:03, 13.91it/s, est. speed input: 6606.14 toks/s, output: 12.90 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:05<00:03, 13.73it/s, est. speed input: 6611.85 toks/s, output: 12.91 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:05<00:03, 13.75it/s, est. speed input: 6622.67 toks/s, output: 12.93 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:06<00:03, 13.81it/s, est. speed input: 6635.11 toks/s, output: 12.96 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:06<00:03, 13.94it/s, est. speed input: 6650.04 toks/s, output: 12.99 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:06<00:03, 14.01it/s, est. speed input: 6663.32 toks/s, output: 13.01 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:06<00:03, 13.96it/s, est. speed input: 6672.68 toks/s, output: 13.03 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:06<00:02, 13.93it/s, est. speed input: 6681.99 toks/s, output: 13.05 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:06<00:02, 13.92it/s, est. speed input: 6690.99 toks/s, output: 13.07 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:06<00:02, 13.91it/s, est. speed input: 6699.74 toks/s, output: 13.09 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:07<00:02, 13.97it/s, est. speed input: 6710.38 toks/s, output: 13.11 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:07<00:02, 14.05it/s, est. speed input: 6721.56 toks/s, output: 13.13 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:07<00:02, 14.07it/s, est. speed input: 6731.25 toks/s, output: 13.15 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:07<00:02, 14.00it/s, est. speed input: 6738.09 toks/s, output: 13.16 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:07<00:01, 13.90it/s, est. speed input: 6743.14 toks/s, output: 13.17 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:07<00:01, 13.65it/s, est. speed input: 6742.50 toks/s, output: 13.17 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:07<00:01, 13.76it/s, est. speed input: 6750.35 toks/s, output: 13.18 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:08<00:01, 13.76it/s, est. speed input: 6755.57 toks/s, output: 13.19 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:08<00:01, 13.80it/s, est. speed input: 6761.93 toks/s, output: 13.21 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:08<00:01, 13.90it/s, est. speed input: 6769.82 toks/s, output: 13.22 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:08<00:01, 13.85it/s, est. speed input: 6774.47 toks/s, output: 13.23 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:08<00:00, 13.80it/s, est. speed input: 6778.20 toks/s, output: 13.24 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:08<00:00, 13.87it/s, est. speed input: 6784.78 toks/s, output: 13.25 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:08<00:00, 13.94it/s, est. speed input: 6791.75 toks/s, output: 13.27 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:09<00:00, 13.68it/s, est. speed input: 6790.42 toks/s, output: 13.26 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:09<00:00, 13.69it/s, est. speed input: 6793.95 toks/s, output: 13.27 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:09<00:00, 13.61it/s, est. speed input: 6795.28 toks/s, output: 13.27 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:09<00:00, 13.66it/s, est. speed input: 6799.21 toks/s, output: 13.28 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:09<00:00, 13.66it/s, est. speed input: 6798.76 toks/s, output: 13.28 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:09<00:00, 13.28it/s, est. speed input: 6798.76 toks/s, output: 13.28 toks/s]
[rank0]:[W125 21:37:11.621948629 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=1024 ==========
Time: 2026-01-25 21:37:13
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 1025 --max-num-batched-tokens 1025 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/Qwen2.5-14B-INT8_M1024.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 21:37:21 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=478858) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=478858) WARNING 01-25 21:37:47 [backends.py:609] Failed to read file <frozen os>
Throughput: 13.00 requests/s, 13324.63 total tokens/s, 13.00 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128

STDERR:
[2026-01-25 21:37:21] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 21:37:21] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-25 21:37:21] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-25 21:37:21] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:37:21] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:37:21] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:37:21] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:37:21] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:37:21] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-25 21:37:21] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 21:37:21] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 21:37:21] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 21:37:21] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 21:37:21] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 21:37:29] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 21:37:29] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-25 21:37:29] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-25 21:37:29] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:37:29] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:37:29] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:37:29] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:37:29] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:37:29] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-25 21:37:29] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 21:37:29] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 21:37:29] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 21:37:29] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 21:37:29] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=478858) [2026-01-25 21:37:30] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=478858) [2026-01-25 21:37:30] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=478858) [2026-01-25 21:37:30] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=478858) [2026-01-25 21:37:30] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=478858) [2026-01-25 21:37:30] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=478858) [2026-01-25 21:37:30] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=478858) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=478858) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:01<00:04,  1.66s/it]
(EngineCore_DP0 pid=478858) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.15it/s]
(EngineCore_DP0 pid=478858) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:03<00:01,  1.16s/it]
(EngineCore_DP0 pid=478858) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.00s/it]
(EngineCore_DP0 pid=478858) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.06s/it]
(EngineCore_DP0 pid=478858) 
(EngineCore_DP0 pid=478858) [2026-01-25 21:37:34] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 5120] -> 1D uint8
(EngineCore_DP0 pid=478858) [2026-01-25 21:37:34] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 27525120 bytes
(EngineCore_DP0 pid=478858) [2026-01-25 21:37:34] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 5120] -> 1D uint8
(EngineCore_DP0 pid=478858) [2026-01-25 21:37:34] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 19660800 bytes
(EngineCore_DP0 pid=478858) [2026-01-25 21:37:35] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 5120] -> 1D uint8
(EngineCore_DP0 pid=478858) [2026-01-25 21:37:35] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 106168320 bytes
(EngineCore_DP0 pid=478858) [2026-01-25 21:37:35] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 13824] -> 1D uint8
(EngineCore_DP0 pid=478858) [2026-01-25 21:37:35] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 53084160 bytes
(EngineCore_DP0 pid=478858) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  6.24it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  6.46it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  6.42it/s]
(EngineCore_DP0 pid=478858) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  6.01it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  6.00it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  22%|██▏       | 28/128 [00:00<00:00, 273.51it/s]
Adding requests:  45%|████▍     | 57/128 [00:00<00:00, 280.27it/s]
Adding requests:  67%|██████▋   | 86/128 [00:00<00:00, 284.51it/s]
Adding requests:  90%|████████▉ | 115/128 [00:00<00:00, 280.46it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 280.19it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:04, 29.71it/s, est. speed input: 30427.58 toks/s, output: 29.71 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:06, 17.75it/s, est. speed input: 19526.92 toks/s, output: 19.07 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:00<00:07, 15.74it/s, est. speed input: 17605.64 toks/s, output: 17.19 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:00<00:07, 15.04it/s, est. speed input: 16836.86 toks/s, output: 16.44 toks/s]
Processed prompts:  10%|█         | 13/128 [00:00<00:07, 14.59it/s, est. speed input: 16336.70 toks/s, output: 15.95 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:00<00:08, 14.01it/s, est. speed input: 15830.91 toks/s, output: 15.46 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:01<00:08, 13.80it/s, est. speed input: 15538.84 toks/s, output: 15.17 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:01<00:07, 13.76it/s, est. speed input: 15361.22 toks/s, output: 15.00 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:01<00:07, 13.71it/s, est. speed input: 15210.27 toks/s, output: 14.85 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:01<00:07, 13.63it/s, est. speed input: 15073.58 toks/s, output: 14.72 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:01<00:07, 13.64it/s, est. speed input: 14980.86 toks/s, output: 14.63 toks/s]
Processed prompts:  21%|██        | 27/128 [00:01<00:07, 13.68it/s, est. speed input: 14911.43 toks/s, output: 14.56 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:01<00:07, 13.75it/s, est. speed input: 14864.58 toks/s, output: 14.52 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:02<00:07, 13.58it/s, est. speed input: 14769.84 toks/s, output: 14.42 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:02<00:07, 13.53it/s, est. speed input: 14703.76 toks/s, output: 14.36 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:02<00:06, 13.63it/s, est. speed input: 14673.13 toks/s, output: 14.33 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:02<00:06, 13.64it/s, est. speed input: 14635.69 toks/s, output: 14.29 toks/s]
Processed prompts:  30%|███       | 39/128 [00:02<00:06, 13.62it/s, est. speed input: 14596.02 toks/s, output: 14.25 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:02<00:06, 13.69it/s, est. speed input: 14575.54 toks/s, output: 14.23 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:03<00:06, 13.76it/s, est. speed input: 14560.11 toks/s, output: 14.22 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:03<00:06, 13.67it/s, est. speed input: 14523.91 toks/s, output: 14.18 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:03<00:05, 13.64it/s, est. speed input: 14495.81 toks/s, output: 14.16 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:03<00:05, 13.70it/s, est. speed input: 14482.88 toks/s, output: 14.14 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:03<00:05, 13.31it/s, est. speed input: 14408.14 toks/s, output: 14.07 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:03<00:05, 13.34it/s, est. speed input: 14381.36 toks/s, output: 14.04 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:03<00:05, 13.49it/s, est. speed input: 14373.88 toks/s, output: 14.04 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:04<00:05, 13.62it/s, est. speed input: 14369.84 toks/s, output: 14.03 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:04<00:05, 13.56it/s, est. speed input: 14347.54 toks/s, output: 14.01 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:04<00:04, 13.59it/s, est. speed input: 14336.07 toks/s, output: 14.00 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:04<00:04, 13.68it/s, est. speed input: 14331.82 toks/s, output: 14.00 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:04<00:04, 13.70it/s, est. speed input: 14324.50 toks/s, output: 13.99 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:04<00:04, 13.74it/s, est. speed input: 14318.99 toks/s, output: 13.98 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:04<00:04, 13.71it/s, est. speed input: 14309.42 toks/s, output: 13.97 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:05<00:04, 13.71it/s, est. speed input: 14300.92 toks/s, output: 13.97 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:05<00:04, 13.64it/s, est. speed input: 14287.49 toks/s, output: 13.95 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:05<00:03, 13.60it/s, est. speed input: 14274.48 toks/s, output: 13.94 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:05<00:03, 13.64it/s, est. speed input: 14268.73 toks/s, output: 13.93 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:05<00:03, 13.35it/s, est. speed input: 14234.93 toks/s, output: 13.90 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:05<00:03, 13.05it/s, est. speed input: 14192.64 toks/s, output: 13.86 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:06<00:03, 12.85it/s, est. speed input: 14152.85 toks/s, output: 13.82 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:06<00:03, 12.72it/s, est. speed input: 14115.71 toks/s, output: 13.78 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:06<00:03, 12.62it/s, est. speed input: 14078.80 toks/s, output: 13.75 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:06<00:03, 12.55it/s, est. speed input: 14044.09 toks/s, output: 13.71 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:06<00:02, 12.63it/s, est. speed input: 14022.86 toks/s, output: 13.69 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:06<00:02, 12.56it/s, est. speed input: 13991.67 toks/s, output: 13.66 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:06<00:02, 12.57it/s, est. speed input: 13966.15 toks/s, output: 13.64 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:07<00:02, 12.77it/s, est. speed input: 13957.93 toks/s, output: 13.63 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:07<00:02, 13.03it/s, est. speed input: 13959.13 toks/s, output: 13.63 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:07<00:02, 13.17it/s, est. speed input: 13956.97 toks/s, output: 13.63 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:07<00:01, 13.35it/s, est. speed input: 13959.93 toks/s, output: 13.63 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:07<00:01, 13.23it/s, est. speed input: 13945.91 toks/s, output: 13.62 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:07<00:01, 13.28it/s, est. speed input: 13941.45 toks/s, output: 13.61 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:08<00:01, 13.39it/s, est. speed input: 13942.26 toks/s, output: 13.62 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:08<00:01, 13.52it/s, est. speed input: 13946.02 toks/s, output: 13.62 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:08<00:01, 13.57it/s, est. speed input: 13947.45 toks/s, output: 13.62 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:08<00:00, 13.60it/s, est. speed input: 13948.24 toks/s, output: 13.62 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:08<00:00, 13.65it/s, est. speed input: 13950.95 toks/s, output: 13.62 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:08<00:00, 13.77it/s, est. speed input: 13957.86 toks/s, output: 13.63 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:08<00:00, 13.77it/s, est. speed input: 13960.55 toks/s, output: 13.63 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:09<00:00, 13.79it/s, est. speed input: 13963.84 toks/s, output: 13.64 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:09<00:00, 13.75it/s, est. speed input: 13964.19 toks/s, output: 13.64 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:09<00:00, 13.68it/s, est. speed input: 13962.31 toks/s, output: 13.64 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:09<00:00, 13.68it/s, est. speed input: 13961.17 toks/s, output: 13.63 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:09<00:00, 13.63it/s, est. speed input: 13961.17 toks/s, output: 13.63 toks/s]
[rank0]:[W125 21:38:22.803060420 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=2048 ==========
Time: 2026-01-25 21:38:24
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=256, max_num_seqs=2
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 256 --max-num-seqs 2 --max-model-len 1025 --max-num-batched-tokens 2048 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/Qwen2.5-14B-INT8_M2048.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 21:38:33 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=480100) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=480100) WARNING 01-25 21:38:57 [backends.py:609] Failed to read file <frozen os>
Throughput: 17.36 requests/s, 17793.69 total tokens/s, 17.36 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256

STDERR:
[2026-01-25 21:38:33] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 21:38:33] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-25 21:38:33] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-25 21:38:33] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:38:33] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:38:33] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:38:33] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:38:33] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:38:33] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-25 21:38:33] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 21:38:33] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 21:38:33] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 21:38:33] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 21:38:33] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 21:38:41] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 21:38:41] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-25 21:38:41] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-25 21:38:41] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:38:41] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:38:41] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:38:41] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:38:41] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:38:41] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-25 21:38:41] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 21:38:41] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 21:38:41] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 21:38:41] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 21:38:41] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=480100) [2026-01-25 21:38:42] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=480100) [2026-01-25 21:38:42] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=480100) [2026-01-25 21:38:42] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=480100) [2026-01-25 21:38:42] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=480100) [2026-01-25 21:38:42] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=480100) [2026-01-25 21:38:42] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=480100) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=480100) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:01,  1.82it/s]
(EngineCore_DP0 pid=480100) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:00<00:00,  2.43it/s]
(EngineCore_DP0 pid=480100) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:01<00:00,  1.98it/s]
(EngineCore_DP0 pid=480100) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.70it/s]
(EngineCore_DP0 pid=480100) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.82it/s]
(EngineCore_DP0 pid=480100) 
(EngineCore_DP0 pid=480100) [2026-01-25 21:38:45] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 5120] -> 1D uint8
(EngineCore_DP0 pid=480100) [2026-01-25 21:38:45] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 27525120 bytes
(EngineCore_DP0 pid=480100) [2026-01-25 21:38:45] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 5120] -> 1D uint8
(EngineCore_DP0 pid=480100) [2026-01-25 21:38:45] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 19660800 bytes
(EngineCore_DP0 pid=480100) [2026-01-25 21:38:45] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 5120] -> 1D uint8
(EngineCore_DP0 pid=480100) [2026-01-25 21:38:45] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 106168320 bytes
(EngineCore_DP0 pid=480100) [2026-01-25 21:38:45] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 13824] -> 1D uint8
(EngineCore_DP0 pid=480100) [2026-01-25 21:38:45] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 53084160 bytes
(EngineCore_DP0 pid=480100) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  33%|███▎      | 1/3 [00:00<00:00,  6.58it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  67%|██████▋   | 2/3 [00:00<00:00,  6.91it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00,  6.69it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00,  6.71it/s]
(EngineCore_DP0 pid=480100) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 1/2 [00:00<00:00,  6.16it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  6.63it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  6.55it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  10%|█         | 26/256 [00:00<00:00, 254.12it/s]
Adding requests:  22%|██▏       | 56/256 [00:00<00:00, 279.08it/s]
Adding requests:  33%|███▎      | 85/256 [00:00<00:00, 281.98it/s]
Adding requests:  45%|████▍     | 114/256 [00:00<00:00, 283.83it/s]
Adding requests:  57%|█████▋    | 145/256 [00:00<00:00, 292.33it/s]
Adding requests:  69%|██████▉   | 176/256 [00:00<00:00, 294.87it/s]
Adding requests:  80%|████████  | 206/256 [00:00<00:00, 292.29it/s]
Adding requests:  92%|█████████▏| 236/256 [00:00<00:00, 290.66it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 286.89it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▋         | 16/256 [00:00<00:02, 117.71it/s, est. speed input: 120557.52 toks/s, output: 117.71 toks/s]
Processed prompts:  11%|█         | 28/256 [00:00<00:07, 29.65it/s, est. speed input: 34825.90 toks/s, output: 34.01 toks/s]   
Processed prompts:  13%|█▎        | 34/256 [00:01<00:08, 24.90it/s, est. speed input: 29786.25 toks/s, output: 29.09 toks/s]
Processed prompts:  15%|█▍        | 38/256 [00:01<00:09, 22.87it/s, est. speed input: 27808.33 toks/s, output: 27.16 toks/s]
Processed prompts:  16%|█▋        | 42/256 [00:01<00:10, 21.35it/s, est. speed input: 26400.71 toks/s, output: 25.78 toks/s]
Processed prompts:  18%|█▊        | 45/256 [00:01<00:09, 22.17it/s, est. speed input: 26434.62 toks/s, output: 25.81 toks/s]
Processed prompts:  19%|█▉        | 48/256 [00:01<00:10, 19.26it/s, est. speed input: 24920.31 toks/s, output: 24.34 toks/s]
Processed prompts:  20%|█▉        | 51/256 [00:02<00:09, 20.54it/s, est. speed input: 25020.61 toks/s, output: 24.43 toks/s]
Processed prompts:  21%|██        | 54/256 [00:02<00:11, 17.93it/s, est. speed input: 23864.78 toks/s, output: 23.31 toks/s]
Processed prompts:  22%|██▏       | 57/256 [00:02<00:10, 19.56it/s, est. speed input: 23999.83 toks/s, output: 23.44 toks/s]
Processed prompts:  23%|██▎       | 60/256 [00:02<00:11, 17.23it/s, est. speed input: 23090.81 toks/s, output: 22.55 toks/s]
Processed prompts:  24%|██▍       | 62/256 [00:02<00:11, 17.26it/s, est. speed input: 22872.37 toks/s, output: 22.34 toks/s]
Processed prompts:  25%|██▌       | 64/256 [00:02<00:11, 17.31it/s, est. speed input: 22674.60 toks/s, output: 22.14 toks/s]
Processed prompts:  26%|██▌       | 66/256 [00:03<00:10, 17.34it/s, est. speed input: 22491.18 toks/s, output: 21.96 toks/s]
Processed prompts:  27%|██▋       | 68/256 [00:03<00:10, 17.34it/s, est. speed input: 22315.95 toks/s, output: 21.79 toks/s]
Processed prompts:  27%|██▋       | 70/256 [00:03<00:10, 17.37it/s, est. speed input: 22158.30 toks/s, output: 21.64 toks/s]
Processed prompts:  28%|██▊       | 72/256 [00:03<00:10, 17.35it/s, est. speed input: 22005.69 toks/s, output: 21.49 toks/s]
Processed prompts:  29%|██▉       | 74/256 [00:03<00:10, 17.32it/s, est. speed input: 21860.35 toks/s, output: 21.35 toks/s]
Processed prompts:  30%|██▉       | 76/256 [00:03<00:10, 17.36it/s, est. speed input: 21733.00 toks/s, output: 21.22 toks/s]
Processed prompts:  30%|███       | 78/256 [00:03<00:10, 17.37it/s, est. speed input: 21610.41 toks/s, output: 21.10 toks/s]
Processed prompts:  31%|███▏      | 80/256 [00:03<00:10, 17.43it/s, est. speed input: 21502.26 toks/s, output: 21.00 toks/s]
Processed prompts:  32%|███▏      | 82/256 [00:03<00:09, 17.43it/s, est. speed input: 21395.63 toks/s, output: 20.89 toks/s]
Processed prompts:  33%|███▎      | 84/256 [00:04<00:09, 17.41it/s, est. speed input: 21292.23 toks/s, output: 20.79 toks/s]
Processed prompts:  34%|███▎      | 86/256 [00:04<00:09, 17.39it/s, est. speed input: 21194.20 toks/s, output: 20.70 toks/s]
Processed prompts:  34%|███▍      | 88/256 [00:04<00:09, 17.37it/s, est. speed input: 21101.31 toks/s, output: 20.61 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:04<00:09, 17.38it/s, est. speed input: 21015.03 toks/s, output: 20.52 toks/s]
Processed prompts:  36%|███▌      | 92/256 [00:04<00:09, 17.36it/s, est. speed input: 20930.41 toks/s, output: 20.44 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:04<00:09, 17.36it/s, est. speed input: 20851.80 toks/s, output: 20.36 toks/s]
Processed prompts:  38%|███▊      | 96/256 [00:04<00:09, 17.39it/s, est. speed input: 20780.18 toks/s, output: 20.29 toks/s]
Processed prompts:  38%|███▊      | 98/256 [00:04<00:09, 17.39it/s, est. speed input: 20709.08 toks/s, output: 20.22 toks/s]
Processed prompts:  39%|███▉      | 100/256 [00:04<00:08, 17.38it/s, est. speed input: 20641.44 toks/s, output: 20.16 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:05<00:08, 17.43it/s, est. speed input: 20581.24 toks/s, output: 20.10 toks/s]
Processed prompts:  41%|████      | 104/256 [00:05<00:08, 17.40it/s, est. speed input: 20518.24 toks/s, output: 20.04 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:05<00:08, 17.37it/s, est. speed input: 20457.52 toks/s, output: 19.98 toks/s]
Processed prompts:  42%|████▏     | 108/256 [00:05<00:08, 17.38it/s, est. speed input: 20401.28 toks/s, output: 19.92 toks/s]
Processed prompts:  43%|████▎     | 110/256 [00:05<00:08, 17.38it/s, est. speed input: 20346.81 toks/s, output: 19.87 toks/s]
Processed prompts:  44%|████▍     | 112/256 [00:05<00:08, 17.36it/s, est. speed input: 20293.95 toks/s, output: 19.82 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:05<00:08, 17.37it/s, est. speed input: 20243.93 toks/s, output: 19.77 toks/s]
Processed prompts:  45%|████▌     | 116/256 [00:05<00:08, 17.37it/s, est. speed input: 20196.11 toks/s, output: 19.72 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:05<00:07, 17.37it/s, est. speed input: 20149.79 toks/s, output: 19.68 toks/s]
Processed prompts:  47%|████▋     | 120/256 [00:06<00:07, 17.39it/s, est. speed input: 20106.87 toks/s, output: 19.64 toks/s]
Processed prompts:  48%|████▊     | 122/256 [00:06<00:07, 17.41it/s, est. speed input: 20065.63 toks/s, output: 19.60 toks/s]
Processed prompts:  48%|████▊     | 124/256 [00:06<00:07, 17.40it/s, est. speed input: 20024.15 toks/s, output: 19.55 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:06<00:07, 17.41it/s, est. speed input: 19985.85 toks/s, output: 19.52 toks/s]
Processed prompts:  50%|█████     | 128/256 [00:06<00:07, 17.39it/s, est. speed input: 19946.85 toks/s, output: 19.48 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:06<00:07, 17.38it/s, est. speed input: 19909.39 toks/s, output: 19.44 toks/s]
Processed prompts:  52%|█████▏    | 132/256 [00:06<00:07, 17.39it/s, est. speed input: 19874.03 toks/s, output: 19.41 toks/s]
Processed prompts:  52%|█████▏    | 134/256 [00:06<00:07, 17.40it/s, est. speed input: 19840.31 toks/s, output: 19.38 toks/s]
Processed prompts:  53%|█████▎    | 136/256 [00:07<00:06, 17.36it/s, est. speed input: 19805.05 toks/s, output: 19.34 toks/s]
Processed prompts:  54%|█████▍    | 138/256 [00:07<00:06, 17.35it/s, est. speed input: 19771.73 toks/s, output: 19.31 toks/s]
Processed prompts:  55%|█████▍    | 140/256 [00:07<00:06, 17.34it/s, est. speed input: 19738.93 toks/s, output: 19.28 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:07<00:06, 17.36it/s, est. speed input: 19709.52 toks/s, output: 19.25 toks/s]
Processed prompts:  56%|█████▋    | 144/256 [00:07<00:06, 17.38it/s, est. speed input: 19680.54 toks/s, output: 19.22 toks/s]
Processed prompts:  57%|█████▋    | 146/256 [00:07<00:06, 17.37it/s, est. speed input: 19651.54 toks/s, output: 19.19 toks/s]
Processed prompts:  58%|█████▊    | 148/256 [00:07<00:06, 17.35it/s, est. speed input: 19622.82 toks/s, output: 19.16 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:07<00:06, 17.38it/s, est. speed input: 19596.93 toks/s, output: 19.14 toks/s]
Processed prompts:  59%|█████▉    | 152/256 [00:07<00:05, 17.36it/s, est. speed input: 19570.07 toks/s, output: 19.11 toks/s]
Processed prompts:  60%|██████    | 154/256 [00:08<00:05, 17.35it/s, est. speed input: 19543.97 toks/s, output: 19.09 toks/s]
Processed prompts:  61%|██████    | 156/256 [00:08<00:05, 17.32it/s, est. speed input: 19517.15 toks/s, output: 19.06 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:08<00:05, 17.37it/s, est. speed input: 19494.91 toks/s, output: 19.04 toks/s]
Processed prompts:  62%|██████▎   | 160/256 [00:08<00:05, 17.39it/s, est. speed input: 19472.49 toks/s, output: 19.02 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:08<00:05, 17.36it/s, est. speed input: 19448.41 toks/s, output: 18.99 toks/s]
Processed prompts:  64%|██████▍   | 164/256 [00:08<00:05, 17.38it/s, est. speed input: 19427.12 toks/s, output: 18.97 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:08<00:05, 17.40it/s, est. speed input: 19406.93 toks/s, output: 18.95 toks/s]
Processed prompts:  66%|██████▌   | 168/256 [00:08<00:05, 17.39it/s, est. speed input: 19385.58 toks/s, output: 18.93 toks/s]
Processed prompts:  66%|██████▋   | 170/256 [00:08<00:04, 17.43it/s, est. speed input: 19367.42 toks/s, output: 18.91 toks/s]
Processed prompts:  67%|██████▋   | 172/256 [00:09<00:04, 17.42it/s, est. speed input: 19347.71 toks/s, output: 18.89 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:09<00:04, 17.39it/s, est. speed input: 19327.70 toks/s, output: 18.87 toks/s]
Processed prompts:  69%|██████▉   | 176/256 [00:09<00:04, 17.37it/s, est. speed input: 19308.19 toks/s, output: 18.86 toks/s]
Processed prompts:  70%|██████▉   | 178/256 [00:09<00:04, 17.38it/s, est. speed input: 19290.00 toks/s, output: 18.84 toks/s]
Processed prompts:  70%|███████   | 180/256 [00:09<00:04, 17.38it/s, est. speed input: 19272.19 toks/s, output: 18.82 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:09<00:04, 17.39it/s, est. speed input: 19255.00 toks/s, output: 18.80 toks/s]
Processed prompts:  72%|███████▏  | 184/256 [00:09<00:04, 17.38it/s, est. speed input: 19237.62 toks/s, output: 18.79 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:09<00:04, 17.38it/s, est. speed input: 19221.02 toks/s, output: 18.77 toks/s]
Processed prompts:  73%|███████▎  | 188/256 [00:10<00:03, 17.38it/s, est. speed input: 19204.71 toks/s, output: 18.75 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:10<00:03, 17.40it/s, est. speed input: 19189.25 toks/s, output: 18.74 toks/s]
Processed prompts:  75%|███████▌  | 192/256 [00:10<00:03, 17.38it/s, est. speed input: 19173.35 toks/s, output: 18.72 toks/s]
Processed prompts:  76%|███████▌  | 194/256 [00:10<00:03, 17.38it/s, est. speed input: 19157.84 toks/s, output: 18.71 toks/s]
Processed prompts:  77%|███████▋  | 196/256 [00:10<00:03, 17.40it/s, est. speed input: 19143.72 toks/s, output: 18.70 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:10<00:03, 17.39it/s, est. speed input: 19129.19 toks/s, output: 18.68 toks/s]
Processed prompts:  78%|███████▊  | 200/256 [00:10<00:03, 17.36it/s, est. speed input: 19113.68 toks/s, output: 18.67 toks/s]
Processed prompts:  80%|███████▉  | 204/256 [00:10<00:02, 19.02it/s, est. speed input: 19161.83 toks/s, output: 18.71 toks/s]
Processed prompts:  80%|████████  | 206/256 [00:11<00:02, 18.59it/s, est. speed input: 19147.74 toks/s, output: 18.70 toks/s]
Processed prompts:  81%|████████▏ | 208/256 [00:11<00:02, 18.27it/s, est. speed input: 19134.31 toks/s, output: 18.69 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:11<00:02, 18.03it/s, est. speed input: 19121.07 toks/s, output: 18.67 toks/s]
Processed prompts:  83%|████████▎ | 212/256 [00:11<00:02, 17.81it/s, est. speed input: 19106.52 toks/s, output: 18.66 toks/s]
Processed prompts:  84%|████████▎ | 214/256 [00:11<00:02, 17.70it/s, est. speed input: 19093.81 toks/s, output: 18.65 toks/s]
Processed prompts:  84%|████████▍ | 216/256 [00:11<00:02, 17.61it/s, est. speed input: 19080.99 toks/s, output: 18.63 toks/s]
Processed prompts:  85%|████████▌ | 218/256 [00:11<00:02, 17.49it/s, est. speed input: 19066.67 toks/s, output: 18.62 toks/s]
Processed prompts:  86%|████████▌ | 220/256 [00:11<00:02, 17.47it/s, est. speed input: 19054.51 toks/s, output: 18.61 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:11<00:01, 17.46it/s, est. speed input: 19043.05 toks/s, output: 18.60 toks/s]
Processed prompts:  88%|████████▊ | 224/256 [00:12<00:01, 17.44it/s, est. speed input: 19031.26 toks/s, output: 18.59 toks/s]
Processed prompts:  88%|████████▊ | 226/256 [00:12<00:01, 17.42it/s, est. speed input: 19019.61 toks/s, output: 18.57 toks/s]
Processed prompts:  89%|████████▉ | 228/256 [00:12<00:01, 17.37it/s, est. speed input: 19006.95 toks/s, output: 18.56 toks/s]
Processed prompts:  90%|████████▉ | 230/256 [00:12<00:01, 17.31it/s, est. speed input: 18993.53 toks/s, output: 18.55 toks/s]
Processed prompts:  91%|█████████ | 232/256 [00:12<00:01, 17.28it/s, est. speed input: 18980.81 toks/s, output: 18.54 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:12<00:01, 17.32it/s, est. speed input: 18970.48 toks/s, output: 18.53 toks/s]
Processed prompts:  92%|█████████▏| 236/256 [00:12<00:01, 17.36it/s, est. speed input: 18960.42 toks/s, output: 18.52 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:12<00:01, 17.35it/s, est. speed input: 18949.68 toks/s, output: 18.51 toks/s]
Processed prompts:  94%|█████████▍| 240/256 [00:12<00:00, 17.35it/s, est. speed input: 18939.07 toks/s, output: 18.50 toks/s]
Processed prompts:  95%|█████████▍| 242/256 [00:13<00:00, 17.36it/s, est. speed input: 18928.92 toks/s, output: 18.49 toks/s]
Processed prompts:  95%|█████████▌| 244/256 [00:13<00:00, 17.37it/s, est. speed input: 18919.42 toks/s, output: 18.48 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:13<00:00, 17.35it/s, est. speed input: 18908.92 toks/s, output: 18.47 toks/s]
Processed prompts:  97%|█████████▋| 248/256 [00:13<00:00, 17.38it/s, est. speed input: 18900.18 toks/s, output: 18.46 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:13<00:00, 17.37it/s, est. speed input: 18890.31 toks/s, output: 18.45 toks/s]
Processed prompts:  98%|█████████▊| 252/256 [00:13<00:00, 17.36it/s, est. speed input: 18880.70 toks/s, output: 18.44 toks/s]
Processed prompts:  99%|█████████▉| 254/256 [00:13<00:00, 17.33it/s, est. speed input: 18870.69 toks/s, output: 18.43 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:13<00:00, 17.33it/s, est. speed input: 18923.19 toks/s, output: 18.48 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:13<00:00, 18.48it/s, est. speed input: 18923.19 toks/s, output: 18.48 toks/s]
[rank0]:[W125 21:39:38.905829443 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=4096 ==========
Time: 2026-01-25 21:39:40
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=512, max_num_seqs=4
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 512 --max-num-seqs 4 --max-model-len 1025 --max-num-batched-tokens 4096 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/Qwen2.5-14B-INT8_M4096.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 21:39:51 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=481421) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=481421) WARNING 01-25 21:40:15 [backends.py:609] Failed to read file <frozen os>
Throughput: 17.97 requests/s, 18418.06 total tokens/s, 17.97 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512

STDERR:
[2026-01-25 21:39:51] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 21:39:51] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-25 21:39:51] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-25 21:39:51] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:39:51] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:39:51] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:39:51] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:39:51] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:39:51] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-25 21:39:51] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 21:39:51] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 21:39:51] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 21:39:51] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 21:39:51] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 21:39:59] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 21:39:59] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-25 21:39:59] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-25 21:39:59] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:39:59] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:39:59] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:39:59] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:39:59] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:39:59] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-25 21:39:59] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 21:39:59] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 21:39:59] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 21:39:59] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 21:39:59] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=481421) [2026-01-25 21:40:00] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=481421) [2026-01-25 21:40:00] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=481421) [2026-01-25 21:40:00] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=481421) [2026-01-25 21:40:00] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=481421) [2026-01-25 21:40:00] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=481421) [2026-01-25 21:40:00] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=481421) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=481421) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:01,  1.83it/s]
(EngineCore_DP0 pid=481421) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:00<00:00,  2.44it/s]
(EngineCore_DP0 pid=481421) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:01<00:00,  1.96it/s]
(EngineCore_DP0 pid=481421) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.71it/s]
(EngineCore_DP0 pid=481421) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.83it/s]
(EngineCore_DP0 pid=481421) 
(EngineCore_DP0 pid=481421) [2026-01-25 21:40:02] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 5120] -> 1D uint8
(EngineCore_DP0 pid=481421) [2026-01-25 21:40:02] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 27525120 bytes
(EngineCore_DP0 pid=481421) [2026-01-25 21:40:02] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 5120] -> 1D uint8
(EngineCore_DP0 pid=481421) [2026-01-25 21:40:02] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 19660800 bytes
(EngineCore_DP0 pid=481421) [2026-01-25 21:40:02] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 5120] -> 1D uint8
(EngineCore_DP0 pid=481421) [2026-01-25 21:40:02] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 106168320 bytes
(EngineCore_DP0 pid=481421) [2026-01-25 21:40:02] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 13824] -> 1D uint8
(EngineCore_DP0 pid=481421) [2026-01-25 21:40:02] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 53084160 bytes
(EngineCore_DP0 pid=481421) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  25%|██▌       | 1/4 [00:00<00:00,  6.35it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 2/4 [00:00<00:00,  6.44it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  75%|███████▌  | 3/4 [00:00<00:00,  6.64it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  6.24it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  6.33it/s]
(EngineCore_DP0 pid=481421) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  33%|███▎      | 1/3 [00:00<00:00,  5.72it/s]
Capturing CUDA graphs (decode, FULL):  67%|██████▋   | 2/3 [00:00<00:00,  6.20it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  6.63it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  6.45it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   5%|▍         | 25/512 [00:00<00:01, 249.31it/s]
Adding requests:  11%|█         | 54/512 [00:00<00:01, 269.59it/s]
Adding requests:  17%|█▋        | 85/512 [00:00<00:01, 287.26it/s]
Adding requests:  22%|██▏       | 115/512 [00:00<00:01, 286.42it/s]
Adding requests:  28%|██▊       | 144/512 [00:00<00:01, 287.41it/s]
Adding requests:  34%|███▍      | 175/512 [00:00<00:01, 294.49it/s]
Adding requests:  40%|████      | 207/512 [00:00<00:01, 300.66it/s]
Adding requests:  46%|████▋     | 238/512 [00:00<00:00, 294.30it/s]
Adding requests:  52%|█████▏    | 268/512 [00:00<00:00, 291.37it/s]
Adding requests:  58%|█████▊    | 298/512 [00:01<00:00, 289.88it/s]
Adding requests:  64%|██████▍   | 328/512 [00:01<00:00, 290.98it/s]
Adding requests:  70%|███████   | 360/512 [00:01<00:00, 297.82it/s]
Adding requests:  76%|███████▌  | 390/512 [00:01<00:00, 294.22it/s]
Adding requests:  83%|████████▎ | 424/512 [00:01<00:00, 305.04it/s]
Adding requests:  89%|████████▉ | 455/512 [00:01<00:00, 301.44it/s]
Adding requests:  95%|█████████▌| 488/512 [00:01<00:00, 307.53it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 296.87it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▌         | 30/512 [00:00<00:02, 186.58it/s, est. speed input: 191088.15 toks/s, output: 186.59 toks/s]
Processed prompts:  10%|▉         | 49/512 [00:01<00:11, 40.00it/s, est. speed input: 47866.32 toks/s, output: 46.74 toks/s]   
Processed prompts:  11%|█▏        | 58/512 [00:01<00:16, 27.08it/s, est. speed input: 34642.92 toks/s, output: 33.83 toks/s]
Processed prompts:  12%|█▎        | 64/512 [00:01<00:16, 27.08it/s, est. speed input: 33849.96 toks/s, output: 33.06 toks/s]
Processed prompts:  13%|█▎        | 69/512 [00:02<00:16, 26.10it/s, est. speed input: 32732.25 toks/s, output: 31.96 toks/s]
Processed prompts:  14%|█▍        | 73/512 [00:02<00:18, 24.22it/s, est. speed input: 31399.09 toks/s, output: 30.66 toks/s]
Processed prompts:  15%|█▍        | 76/512 [00:02<00:20, 21.55it/s, est. speed input: 29900.46 toks/s, output: 29.20 toks/s]
Processed prompts:  15%|█▌        | 79/512 [00:02<00:22, 19.44it/s, est. speed input: 28639.10 toks/s, output: 27.97 toks/s]
Processed prompts:  16%|█▌        | 82/512 [00:03<00:24, 17.84it/s, est. speed input: 27565.31 toks/s, output: 26.92 toks/s]
Processed prompts:  17%|█▋        | 86/512 [00:03<00:23, 17.88it/s, est. speed input: 26943.75 toks/s, output: 26.31 toks/s]
Processed prompts:  18%|█▊        | 90/512 [00:03<00:23, 17.91it/s, est. speed input: 26400.83 toks/s, output: 25.78 toks/s]
Processed prompts:  18%|█▊        | 94/512 [00:03<00:23, 17.94it/s, est. speed input: 25923.95 toks/s, output: 25.32 toks/s]
Processed prompts:  19%|█▉        | 98/512 [00:03<00:23, 17.98it/s, est. speed input: 25506.23 toks/s, output: 24.91 toks/s]
Processed prompts:  20%|█▉        | 102/512 [00:04<00:22, 17.98it/s, est. speed input: 25128.42 toks/s, output: 24.54 toks/s]
Processed prompts:  21%|██        | 106/512 [00:04<00:22, 17.99it/s, est. speed input: 24789.02 toks/s, output: 24.21 toks/s]
Processed prompts:  21%|██▏       | 110/512 [00:04<00:22, 17.99it/s, est. speed input: 24481.18 toks/s, output: 23.91 toks/s]
Processed prompts:  22%|██▏       | 114/512 [00:04<00:22, 18.00it/s, est. speed input: 24202.96 toks/s, output: 23.64 toks/s]
Processed prompts:  23%|██▎       | 118/512 [00:05<00:21, 18.00it/s, est. speed input: 23948.94 toks/s, output: 23.39 toks/s]
Processed prompts:  24%|██▍       | 122/512 [00:05<00:21, 18.01it/s, est. speed input: 23718.28 toks/s, output: 23.16 toks/s]
Processed prompts:  25%|██▍       | 126/512 [00:05<00:21, 18.02it/s, est. speed input: 23505.91 toks/s, output: 22.95 toks/s]
Processed prompts:  25%|██▌       | 130/512 [00:05<00:21, 18.02it/s, est. speed input: 23310.02 toks/s, output: 22.76 toks/s]
Processed prompts:  26%|██▌       | 134/512 [00:05<00:20, 18.04it/s, est. speed input: 23131.70 toks/s, output: 22.59 toks/s]
Processed prompts:  27%|██▋       | 138/512 [00:06<00:20, 18.02it/s, est. speed input: 22960.24 toks/s, output: 22.42 toks/s]
Processed prompts:  28%|██▊       | 142/512 [00:06<00:20, 18.03it/s, est. speed input: 22804.67 toks/s, output: 22.27 toks/s]
Processed prompts:  29%|██▊       | 146/512 [00:06<00:20, 18.02it/s, est. speed input: 22657.64 toks/s, output: 22.13 toks/s]
Processed prompts:  29%|██▉       | 150/512 [00:06<00:20, 18.02it/s, est. speed input: 22521.04 toks/s, output: 21.99 toks/s]
Processed prompts:  30%|███       | 154/512 [00:07<00:19, 18.01it/s, est. speed input: 22390.74 toks/s, output: 21.87 toks/s]
Processed prompts:  31%|███       | 158/512 [00:07<00:19, 18.02it/s, est. speed input: 22271.15 toks/s, output: 21.75 toks/s]
Processed prompts:  32%|███▏      | 162/512 [00:07<00:19, 18.06it/s, est. speed input: 22162.71 toks/s, output: 21.64 toks/s]
Processed prompts:  32%|███▏      | 166/512 [00:07<00:19, 18.05it/s, est. speed input: 22056.48 toks/s, output: 21.54 toks/s]
Processed prompts:  33%|███▎      | 170/512 [00:07<00:18, 18.04it/s, est. speed input: 21954.83 toks/s, output: 21.44 toks/s]
Processed prompts:  34%|███▍      | 174/512 [00:08<00:18, 18.04it/s, est. speed input: 21860.60 toks/s, output: 21.35 toks/s]
Processed prompts:  35%|███▍      | 178/512 [00:08<00:18, 17.99it/s, est. speed input: 21765.76 toks/s, output: 21.26 toks/s]
Processed prompts:  36%|███▌      | 182/512 [00:08<00:18, 18.03it/s, est. speed input: 21683.08 toks/s, output: 21.17 toks/s]
Processed prompts:  36%|███▋      | 186/512 [00:08<00:18, 18.04it/s, est. speed input: 21603.07 toks/s, output: 21.10 toks/s]
Processed prompts:  37%|███▋      | 190/512 [00:09<00:17, 18.01it/s, est. speed input: 21523.84 toks/s, output: 21.02 toks/s]
Processed prompts:  38%|███▊      | 194/512 [00:09<00:17, 18.00it/s, est. speed input: 21448.50 toks/s, output: 20.95 toks/s]
Processed prompts:  39%|███▊      | 198/512 [00:09<00:17, 18.01it/s, est. speed input: 21378.83 toks/s, output: 20.88 toks/s]
Processed prompts:  39%|███▉      | 202/512 [00:09<00:16, 19.18it/s, est. speed input: 21411.12 toks/s, output: 20.91 toks/s]
Processed prompts:  40%|████      | 206/512 [00:09<00:16, 18.82it/s, est. speed input: 21345.21 toks/s, output: 20.84 toks/s]
Processed prompts:  41%|████      | 210/512 [00:10<00:16, 18.57it/s, est. speed input: 21281.03 toks/s, output: 20.78 toks/s]
Processed prompts:  42%|████▏     | 214/512 [00:10<00:16, 18.38it/s, est. speed input: 21218.68 toks/s, output: 20.72 toks/s]
Processed prompts:  43%|████▎     | 218/512 [00:10<00:16, 18.27it/s, est. speed input: 21160.33 toks/s, output: 20.66 toks/s]
Processed prompts:  43%|████▎     | 222/512 [00:10<00:15, 18.18it/s, est. speed input: 21103.63 toks/s, output: 20.61 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:10<00:15, 18.13it/s, est. speed input: 21049.76 toks/s, output: 20.56 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:11<00:15, 18.07it/s, est. speed input: 20996.68 toks/s, output: 20.50 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:11<00:15, 18.03it/s, est. speed input: 20945.27 toks/s, output: 20.45 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:11<00:15, 18.03it/s, est. speed input: 20897.99 toks/s, output: 20.41 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:11<00:14, 18.02it/s, est. speed input: 20851.99 toks/s, output: 20.36 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:12<00:14, 18.00it/s, est. speed input: 20806.22 toks/s, output: 20.32 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:12<00:14, 18.01it/s, est. speed input: 20764.13 toks/s, output: 20.28 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:12<00:14, 18.00it/s, est. speed input: 20722.68 toks/s, output: 20.24 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:12<00:14, 18.02it/s, est. speed input: 20684.19 toks/s, output: 20.20 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:12<00:13, 17.99it/s, est. speed input: 20644.27 toks/s, output: 20.16 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:13<00:13, 17.99it/s, est. speed input: 20606.72 toks/s, output: 20.12 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:13<00:13, 17.98it/s, est. speed input: 20570.19 toks/s, output: 20.09 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:13<00:13, 17.99it/s, est. speed input: 20535.30 toks/s, output: 20.05 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:13<00:12, 18.01it/s, est. speed input: 20502.52 toks/s, output: 20.02 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:14<00:12, 17.97it/s, est. speed input: 20468.16 toks/s, output: 19.99 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:14<00:12, 17.97it/s, est. speed input: 20436.11 toks/s, output: 19.96 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:14<00:12, 17.99it/s, est. speed input: 20405.89 toks/s, output: 19.93 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:14<00:12, 17.96it/s, est. speed input: 20374.66 toks/s, output: 19.90 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:14<00:11, 17.98it/s, est. speed input: 20346.21 toks/s, output: 19.87 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:15<00:11, 17.96it/s, est. speed input: 20316.92 toks/s, output: 19.84 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:15<00:11, 17.96it/s, est. speed input: 20289.04 toks/s, output: 19.81 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:15<00:11, 17.97it/s, est. speed input: 20262.78 toks/s, output: 19.79 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:15<00:10, 18.01it/s, est. speed input: 20238.84 toks/s, output: 19.76 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:16<00:10, 17.98it/s, est. speed input: 20212.44 toks/s, output: 19.74 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:16<00:10, 17.97it/s, est. speed input: 20187.28 toks/s, output: 19.71 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:16<00:10, 18.00it/s, est. speed input: 20164.93 toks/s, output: 19.69 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:16<00:10, 18.00it/s, est. speed input: 20141.68 toks/s, output: 19.67 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:16<00:09, 18.00it/s, est. speed input: 20119.32 toks/s, output: 19.65 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:17<00:09, 17.97it/s, est. speed input: 20096.16 toks/s, output: 19.63 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:17<00:09, 17.98it/s, est. speed input: 20075.10 toks/s, output: 19.60 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:17<00:09, 17.98it/s, est. speed input: 20054.12 toks/s, output: 19.58 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:17<00:09, 17.99it/s, est. speed input: 20034.30 toks/s, output: 19.56 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:18<00:08, 17.98it/s, est. speed input: 20013.98 toks/s, output: 19.54 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:18<00:08, 17.98it/s, est. speed input: 19994.62 toks/s, output: 19.53 toks/s]
Processed prompts:  71%|███████   | 362/512 [00:18<00:08, 17.97it/s, est. speed input: 19975.30 toks/s, output: 19.51 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:18<00:08, 17.97it/s, est. speed input: 19956.45 toks/s, output: 19.49 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [00:19<00:07, 17.98it/s, est. speed input: 19938.56 toks/s, output: 19.47 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [00:19<00:07, 17.95it/s, est. speed input: 19919.52 toks/s, output: 19.45 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [00:19<00:07, 17.93it/s, est. speed input: 19901.29 toks/s, output: 19.43 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [00:19<00:07, 17.92it/s, est. speed input: 19883.32 toks/s, output: 19.42 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [00:19<00:07, 17.95it/s, est. speed input: 19867.44 toks/s, output: 19.40 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [00:20<00:06, 17.94it/s, est. speed input: 19850.33 toks/s, output: 19.39 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [00:20<00:06, 17.95it/s, est. speed input: 19834.58 toks/s, output: 19.37 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [00:20<00:06, 17.94it/s, est. speed input: 19818.37 toks/s, output: 19.35 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [00:20<00:06, 17.96it/s, est. speed input: 19803.66 toks/s, output: 19.34 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [00:21<00:05, 17.95it/s, est. speed input: 19788.39 toks/s, output: 19.32 toks/s]
Processed prompts:  80%|████████  | 410/512 [00:21<00:05, 17.94it/s, est. speed input: 19773.05 toks/s, output: 19.31 toks/s]
Processed prompts:  81%|████████  | 414/512 [00:21<00:05, 17.93it/s, est. speed input: 19758.03 toks/s, output: 19.29 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [00:21<00:05, 17.92it/s, est. speed input: 19743.40 toks/s, output: 19.28 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [00:21<00:05, 17.93it/s, est. speed input: 19729.73 toks/s, output: 19.27 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [00:22<00:04, 17.92it/s, est. speed input: 19715.53 toks/s, output: 19.25 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [00:22<00:04, 17.92it/s, est. speed input: 19701.93 toks/s, output: 19.24 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [00:22<00:04, 17.92it/s, est. speed input: 19688.64 toks/s, output: 19.23 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [00:22<00:04, 17.93it/s, est. speed input: 19675.87 toks/s, output: 19.21 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [00:23<00:03, 17.94it/s, est. speed input: 19663.38 toks/s, output: 19.20 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [00:23<00:03, 17.92it/s, est. speed input: 19650.42 toks/s, output: 19.19 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [00:23<00:03, 17.91it/s, est. speed input: 19637.65 toks/s, output: 19.18 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [00:23<00:03, 17.90it/s, est. speed input: 19624.87 toks/s, output: 19.16 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [00:23<00:03, 17.89it/s, est. speed input: 19612.66 toks/s, output: 19.15 toks/s]
Processed prompts:  90%|█████████ | 462/512 [00:24<00:02, 17.89it/s, est. speed input: 19600.73 toks/s, output: 19.14 toks/s]
Processed prompts:  91%|█████████ | 466/512 [00:24<00:02, 17.90it/s, est. speed input: 19589.26 toks/s, output: 19.13 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [00:24<00:02, 17.89it/s, est. speed input: 19577.49 toks/s, output: 19.12 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [00:24<00:02, 17.89it/s, est. speed input: 19566.07 toks/s, output: 19.11 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [00:25<00:01, 17.90it/s, est. speed input: 19555.32 toks/s, output: 19.10 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [00:25<00:01, 17.90it/s, est. speed input: 19544.62 toks/s, output: 19.09 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [00:25<00:01, 17.90it/s, est. speed input: 19533.80 toks/s, output: 19.08 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [00:25<00:01, 17.90it/s, est. speed input: 19523.46 toks/s, output: 19.07 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [00:25<00:01, 17.90it/s, est. speed input: 19513.06 toks/s, output: 19.06 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [00:26<00:00, 17.92it/s, est. speed input: 19503.46 toks/s, output: 19.05 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [00:26<00:00, 17.91it/s, est. speed input: 19493.44 toks/s, output: 19.04 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [00:26<00:00, 17.91it/s, est. speed input: 19483.91 toks/s, output: 19.03 toks/s]
Processed prompts: 100%|█████████▉| 510/512 [00:26<00:00, 19.18it/s, est. speed input: 19510.09 toks/s, output: 19.05 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:26<00:00, 19.18it/s, est. speed input: 19586.50 toks/s, output: 19.13 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:26<00:00, 19.13it/s, est. speed input: 19586.50 toks/s, output: 19.13 toks/s]
[rank0]:[W125 21:41:11.130890022 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=8192 ==========
Time: 2026-01-25 21:41:13
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=1024, max_num_seqs=8
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 1024 --max-num-seqs 8 --max-model-len 1025 --max-num-batched-tokens 8192 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/Qwen2.5-14B-INT8_M8192.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 21:41:28 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=482996) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=482996) WARNING 01-25 21:41:52 [backends.py:609] Failed to read file <frozen os>
Throughput: 18.36 requests/s, 18816.03 total tokens/s, 18.36 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024

STDERR:
[2026-01-25 21:41:28] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 21:41:28] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-25 21:41:28] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-25 21:41:28] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:41:28] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:41:28] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:41:28] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:41:28] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:41:28] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-25 21:41:28] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 21:41:28] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 21:41:28] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 21:41:28] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 21:41:28] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 21:41:35] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 21:41:35] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-25 21:41:35] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-25 21:41:35] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:41:35] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:41:35] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:41:35] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:41:35] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:41:35] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-25 21:41:35] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 21:41:35] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 21:41:35] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 21:41:35] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 21:41:35] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=482996) [2026-01-25 21:41:36] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=482996) [2026-01-25 21:41:36] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=482996) [2026-01-25 21:41:36] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=482996) [2026-01-25 21:41:36] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=482996) [2026-01-25 21:41:36] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=482996) [2026-01-25 21:41:36] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=482996) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=482996) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:01,  1.79it/s]
(EngineCore_DP0 pid=482996) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:00<00:00,  2.41it/s]
(EngineCore_DP0 pid=482996) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:01<00:00,  1.98it/s]
(EngineCore_DP0 pid=482996) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.71it/s]
(EngineCore_DP0 pid=482996) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.82it/s]
(EngineCore_DP0 pid=482996) 
(EngineCore_DP0 pid=482996) [2026-01-25 21:41:39] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 5120] -> 1D uint8
(EngineCore_DP0 pid=482996) [2026-01-25 21:41:39] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 27525120 bytes
(EngineCore_DP0 pid=482996) [2026-01-25 21:41:39] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 5120] -> 1D uint8
(EngineCore_DP0 pid=482996) [2026-01-25 21:41:39] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 19660800 bytes
(EngineCore_DP0 pid=482996) [2026-01-25 21:41:39] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 5120] -> 1D uint8
(EngineCore_DP0 pid=482996) [2026-01-25 21:41:39] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 106168320 bytes
(EngineCore_DP0 pid=482996) [2026-01-25 21:41:39] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 13824] -> 1D uint8
(EngineCore_DP0 pid=482996) [2026-01-25 21:41:39] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 53084160 bytes
(EngineCore_DP0 pid=482996) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:01,  3.47it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  40%|████      | 2/5 [00:00<00:00,  4.80it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  60%|██████    | 3/5 [00:00<00:00,  5.62it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  80%|████████  | 4/5 [00:00<00:00,  6.00it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00,  6.10it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00,  5.61it/s]
(EngineCore_DP0 pid=482996) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:00,  6.12it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 2/4 [00:00<00:00,  6.65it/s]
Capturing CUDA graphs (decode, FULL):  75%|███████▌  | 3/4 [00:00<00:00,  6.64it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  6.83it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  6.72it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   3%|▎         | 27/1024 [00:00<00:03, 260.31it/s]
Adding requests:   5%|▌         | 54/1024 [00:00<00:03, 265.65it/s]
Adding requests:   8%|▊         | 82/1024 [00:00<00:03, 271.66it/s]
Adding requests:  11%|█         | 110/1024 [00:00<00:03, 270.38it/s]
Adding requests:  14%|█▎        | 139/1024 [00:00<00:03, 276.58it/s]
Adding requests:  16%|█▋        | 167/1024 [00:00<00:03, 277.55it/s]
Adding requests:  19%|█▉        | 199/1024 [00:00<00:02, 290.20it/s]
Adding requests:  22%|██▏       | 230/1024 [00:00<00:02, 293.81it/s]
Adding requests:  25%|██▌       | 260/1024 [00:00<00:02, 284.84it/s]
Adding requests:  28%|██▊       | 290/1024 [00:01<00:02, 286.45it/s]
Adding requests:  31%|███▏      | 320/1024 [00:01<00:02, 290.20it/s]
Adding requests:  34%|███▍      | 350/1024 [00:01<00:02, 292.19it/s]
Adding requests:  37%|███▋      | 381/1024 [00:01<00:02, 296.79it/s]
Adding requests:  41%|████      | 415/1024 [00:01<00:01, 308.07it/s]
Adding requests:  44%|████▎     | 446/1024 [00:01<00:01, 307.63it/s]
Adding requests:  47%|████▋     | 479/1024 [00:01<00:01, 312.62it/s]
Adding requests:  50%|█████     | 512/1024 [00:01<00:01, 316.09it/s]
Adding requests:  53%|█████▎    | 544/1024 [00:01<00:01, 316.64it/s]
Adding requests:  56%|█████▋    | 576/1024 [00:01<00:01, 309.87it/s]
Adding requests:  59%|█████▉    | 608/1024 [00:02<00:01, 297.44it/s]
Adding requests:  62%|██████▏   | 638/1024 [00:02<00:01, 293.09it/s]
Adding requests:  65%|██████▌   | 668/1024 [00:02<00:01, 290.58it/s]
Adding requests:  68%|██████▊   | 698/1024 [00:02<00:01, 291.90it/s]
Adding requests:  71%|███████   | 728/1024 [00:02<00:01, 283.22it/s]
Adding requests:  74%|███████▍  | 759/1024 [00:02<00:00, 289.86it/s]
Adding requests:  77%|███████▋  | 791/1024 [00:02<00:00, 296.53it/s]
Adding requests:  80%|████████  | 821/1024 [00:02<00:00, 296.44it/s]
Adding requests:  83%|████████▎ | 854/1024 [00:02<00:00, 305.50it/s]
Adding requests:  87%|████████▋ | 886/1024 [00:02<00:00, 309.61it/s]
Adding requests:  90%|████████▉ | 918/1024 [00:03<00:00, 306.18it/s]
Adding requests:  93%|█████████▎| 949/1024 [00:03<00:00, 302.49it/s]
Adding requests:  96%|█████████▌| 980/1024 [00:03<00:00, 303.73it/s]
Adding requests:  99%|█████████▊| 1011/1024 [00:03<00:00, 302.75it/s]
Adding requests: 100%|██████████| 1024/1024 [00:03<00:00, 296.36it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▌         | 58/1024 [00:00<00:01, 543.20it/s, est. speed input: 556334.22 toks/s, output: 543.22 toks/s]
Processed prompts:  11%|█         | 113/1024 [00:02<00:25, 35.84it/s, est. speed input: 42863.90 toks/s, output: 41.86 toks/s]  
Processed prompts:  13%|█▎        | 137/1024 [00:03<00:30, 28.73it/s, est. speed input: 35098.66 toks/s, output: 34.28 toks/s]
Processed prompts:  15%|█▍        | 151/1024 [00:04<00:34, 25.19it/s, est. speed input: 31788.30 toks/s, output: 31.04 toks/s]
Processed prompts:  16%|█▌        | 160/1024 [00:05<00:35, 24.45it/s, est. speed input: 30925.26 toks/s, output: 30.20 toks/s]
Processed prompts:  16%|█▋        | 167/1024 [00:05<00:37, 22.86it/s, est. speed input: 29845.78 toks/s, output: 29.15 toks/s]
Processed prompts:  17%|█▋        | 172/1024 [00:06<00:41, 20.43it/s, est. speed input: 28583.52 toks/s, output: 27.91 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [00:06<00:44, 18.88it/s, est. speed input: 27637.56 toks/s, output: 26.99 toks/s]
Processed prompts:  18%|█▊        | 186/1024 [00:07<00:44, 18.77it/s, est. speed input: 27098.71 toks/s, output: 26.46 toks/s]
Processed prompts:  19%|█▉        | 194/1024 [00:07<00:44, 18.69it/s, est. speed input: 26622.65 toks/s, output: 26.00 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [00:07<00:42, 19.17it/s, est. speed input: 26348.24 toks/s, output: 25.73 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:08<00:42, 18.96it/s, est. speed input: 25956.33 toks/s, output: 25.35 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [00:08<00:42, 18.81it/s, est. speed input: 25605.29 toks/s, output: 25.01 toks/s]
Processed prompts:  22%|██▏       | 226/1024 [00:09<00:42, 18.70it/s, est. speed input: 25286.69 toks/s, output: 24.69 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:09<00:42, 18.63it/s, est. speed input: 24998.63 toks/s, output: 24.41 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:10<00:42, 18.58it/s, est. speed input: 24734.84 toks/s, output: 24.16 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:10<00:41, 18.54it/s, est. speed input: 24491.38 toks/s, output: 23.92 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:10<00:41, 18.49it/s, est. speed input: 24265.37 toks/s, output: 23.70 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:11<00:41, 18.47it/s, est. speed input: 24057.56 toks/s, output: 23.49 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:11<00:40, 18.47it/s, est. speed input: 23868.75 toks/s, output: 23.31 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:12<00:40, 18.44it/s, est. speed input: 23688.26 toks/s, output: 23.13 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:12<00:39, 18.46it/s, est. speed input: 23525.07 toks/s, output: 22.97 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:13<00:39, 18.43it/s, est. speed input: 23367.75 toks/s, output: 22.82 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:13<00:38, 18.42it/s, est. speed input: 23221.24 toks/s, output: 22.68 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:13<00:38, 18.40it/s, est. speed input: 23082.65 toks/s, output: 22.54 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:14<00:38, 18.42it/s, est. speed input: 22956.78 toks/s, output: 22.42 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:14<00:37, 18.41it/s, est. speed input: 22835.62 toks/s, output: 22.30 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:15<00:37, 18.40it/s, est. speed input: 22721.09 toks/s, output: 22.19 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:15<00:36, 18.40it/s, est. speed input: 22612.86 toks/s, output: 22.08 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:16<00:36, 18.38it/s, est. speed input: 22509.54 toks/s, output: 21.98 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:16<00:36, 18.38it/s, est. speed input: 22412.51 toks/s, output: 21.89 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:16<00:35, 18.38it/s, est. speed input: 22320.45 toks/s, output: 21.80 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:17<00:35, 18.38it/s, est. speed input: 22233.16 toks/s, output: 21.71 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:17<00:34, 18.39it/s, est. speed input: 22150.56 toks/s, output: 21.63 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [00:18<00:34, 18.40it/s, est. speed input: 22072.45 toks/s, output: 21.56 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:18<00:33, 18.39it/s, est. speed input: 21996.26 toks/s, output: 21.48 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:19<00:33, 18.39it/s, est. speed input: 21924.33 toks/s, output: 21.41 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:19<00:32, 18.38it/s, est. speed input: 21855.01 toks/s, output: 21.34 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:20<00:32, 18.37it/s, est. speed input: 21788.14 toks/s, output: 21.28 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:20<00:32, 18.36it/s, est. speed input: 21723.72 toks/s, output: 21.21 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:20<00:31, 18.36it/s, est. speed input: 21662.52 toks/s, output: 21.15 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:21<00:31, 18.35it/s, est. speed input: 21603.63 toks/s, output: 21.10 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:21<00:30, 18.36it/s, est. speed input: 21547.72 toks/s, output: 21.04 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:22<00:30, 18.35it/s, est. speed input: 21493.05 toks/s, output: 20.99 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:22<00:29, 18.36it/s, est. speed input: 21441.82 toks/s, output: 20.94 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:23<00:29, 18.36it/s, est. speed input: 21392.00 toks/s, output: 20.89 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:23<00:29, 18.36it/s, est. speed input: 21343.88 toks/s, output: 20.84 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:23<00:28, 18.34it/s, est. speed input: 21296.51 toks/s, output: 20.80 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:24<00:28, 18.36it/s, est. speed input: 21252.49 toks/s, output: 20.75 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:24<00:27, 18.35it/s, est. speed input: 21209.09 toks/s, output: 20.71 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:25<00:27, 18.35it/s, est. speed input: 21167.42 toks/s, output: 20.67 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:25<00:26, 18.35it/s, est. speed input: 21126.94 toks/s, output: 20.63 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:26<00:26, 18.34it/s, est. speed input: 21087.52 toks/s, output: 20.59 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:26<00:26, 18.33it/s, est. speed input: 21048.77 toks/s, output: 20.56 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:26<00:25, 18.33it/s, est. speed input: 21011.95 toks/s, output: 20.52 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:27<00:25, 18.33it/s, est. speed input: 20976.39 toks/s, output: 20.48 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:27<00:24, 18.33it/s, est. speed input: 20941.82 toks/s, output: 20.45 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:28<00:24, 18.33it/s, est. speed input: 20908.54 toks/s, output: 20.42 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:28<00:23, 18.31it/s, est. speed input: 20874.75 toks/s, output: 20.39 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:29<00:23, 18.31it/s, est. speed input: 20842.69 toks/s, output: 20.35 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:29<00:23, 18.30it/s, est. speed input: 20811.26 toks/s, output: 20.32 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:30<00:22, 18.30it/s, est. speed input: 20781.10 toks/s, output: 20.29 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:30<00:22, 18.30it/s, est. speed input: 20752.03 toks/s, output: 20.27 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:30<00:21, 18.31it/s, est. speed input: 20723.90 toks/s, output: 20.24 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:31<00:21, 18.29it/s, est. speed input: 20695.32 toks/s, output: 20.21 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:31<00:20, 18.30it/s, est. speed input: 20669.06 toks/s, output: 20.18 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:32<00:20, 18.31it/s, est. speed input: 20643.38 toks/s, output: 20.16 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:32<00:19, 18.30it/s, est. speed input: 20617.64 toks/s, output: 20.13 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:33<00:19, 18.29it/s, est. speed input: 20592.37 toks/s, output: 20.11 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:33<00:19, 18.29it/s, est. speed input: 20568.01 toks/s, output: 20.09 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:33<00:18, 18.30it/s, est. speed input: 20544.78 toks/s, output: 20.06 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:34<00:18, 18.28it/s, est. speed input: 20520.93 toks/s, output: 20.04 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:34<00:17, 18.28it/s, est. speed input: 20498.37 toks/s, output: 20.02 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:35<00:17, 18.27it/s, est. speed input: 20475.98 toks/s, output: 20.00 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:35<00:16, 18.27it/s, est. speed input: 20454.43 toks/s, output: 19.98 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:36<00:16, 18.27it/s, est. speed input: 20433.11 toks/s, output: 19.95 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:36<00:16, 18.27it/s, est. speed input: 20412.42 toks/s, output: 19.93 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:37<00:15, 18.28it/s, est. speed input: 20392.92 toks/s, output: 19.91 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:37<00:15, 18.27it/s, est. speed input: 20373.04 toks/s, output: 19.90 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:37<00:14, 18.27it/s, est. speed input: 20353.78 toks/s, output: 19.88 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:38<00:14, 18.27it/s, est. speed input: 20334.85 toks/s, output: 19.86 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:38<00:13, 18.25it/s, est. speed input: 20315.93 toks/s, output: 19.84 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:39<00:13, 18.26it/s, est. speed input: 20298.14 toks/s, output: 19.82 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:39<00:12, 18.86it/s, est. speed input: 20304.26 toks/s, output: 19.83 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:40<00:12, 18.66it/s, est. speed input: 20286.11 toks/s, output: 19.81 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:40<00:11, 18.54it/s, est. speed input: 20268.76 toks/s, output: 19.79 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:40<00:11, 18.46it/s, est. speed input: 20252.34 toks/s, output: 19.78 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:41<00:11, 18.39it/s, est. speed input: 20235.42 toks/s, output: 19.76 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:41<00:10, 18.36it/s, est. speed input: 20219.77 toks/s, output: 19.75 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:42<00:10, 18.33it/s, est. speed input: 20204.05 toks/s, output: 19.73 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [00:42<00:09, 18.32it/s, est. speed input: 20188.83 toks/s, output: 19.72 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [00:43<00:09, 18.28it/s, est. speed input: 20173.15 toks/s, output: 19.70 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:43<00:09, 18.27it/s, est. speed input: 20158.14 toks/s, output: 19.69 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [00:44<00:08, 18.26it/s, est. speed input: 20143.40 toks/s, output: 19.67 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [00:44<00:08, 18.25it/s, est. speed input: 20128.65 toks/s, output: 19.66 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [00:44<00:07, 18.23it/s, est. speed input: 20113.91 toks/s, output: 19.64 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [00:45<00:07, 18.21it/s, est. speed input: 20099.31 toks/s, output: 19.63 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [00:45<00:06, 18.22it/s, est. speed input: 20085.57 toks/s, output: 19.61 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [00:46<00:06, 18.21it/s, est. speed input: 20071.75 toks/s, output: 19.60 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [00:46<00:06, 18.22it/s, est. speed input: 20058.76 toks/s, output: 19.59 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [00:47<00:05, 18.21it/s, est. speed input: 20045.44 toks/s, output: 19.58 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [00:47<00:05, 18.18it/s, est. speed input: 20031.50 toks/s, output: 19.56 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [00:47<00:04, 18.21it/s, est. speed input: 20019.60 toks/s, output: 19.55 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [00:48<00:04, 18.20it/s, est. speed input: 20006.66 toks/s, output: 19.54 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [00:48<00:03, 18.20it/s, est. speed input: 19994.41 toks/s, output: 19.53 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [00:49<00:03, 18.20it/s, est. speed input: 19982.41 toks/s, output: 19.51 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [00:49<00:02, 18.21it/s, est. speed input: 19970.62 toks/s, output: 19.50 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [00:50<00:02, 18.23it/s, est. speed input: 19959.65 toks/s, output: 19.49 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [00:50<00:02, 18.19it/s, est. speed input: 19947.15 toks/s, output: 19.48 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [00:51<00:01, 18.19it/s, est. speed input: 19935.89 toks/s, output: 19.47 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [00:51<00:01, 18.18it/s, est. speed input: 19924.23 toks/s, output: 19.46 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [00:51<00:00, 18.19it/s, est. speed input: 19913.48 toks/s, output: 19.45 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [00:52<00:00, 18.85it/s, est. speed input: 19922.23 toks/s, output: 19.46 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:52<00:00, 18.85it/s, est. speed input: 20039.54 toks/s, output: 19.57 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:52<00:00, 19.57it/s, est. speed input: 20039.54 toks/s, output: 19.57 toks/s]
[rank0]:[W125 21:43:19.630604849 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=16384 ==========
Time: 2026-01-25 21:43:21
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=2048, max_num_seqs=16
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 2048 --max-num-seqs 16 --max-model-len 1025 --max-num-batched-tokens 16384 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/Qwen2.5-14B-INT8_M16384.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 21:43:42 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=485098) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=485098) WARNING 01-25 21:44:06 [backends.py:609] Failed to read file <frozen os>
Throughput: 18.39 requests/s, 18852.48 total tokens/s, 18.39 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048

STDERR:
[2026-01-25 21:43:42] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 21:43:42] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-25 21:43:42] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-25 21:43:42] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:43:42] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:43:42] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:43:42] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:43:42] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:43:42] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-25 21:43:42] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 21:43:42] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 21:43:42] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 21:43:42] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 21:43:42] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 21:43:50] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 21:43:50] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-25 21:43:50] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-25 21:43:50] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:43:50] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:43:50] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:43:50] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:43:50] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:43:50] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-25 21:43:50] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 21:43:50] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 21:43:50] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 21:43:50] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 21:43:50] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=485098) [2026-01-25 21:43:51] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=485098) [2026-01-25 21:43:51] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=485098) [2026-01-25 21:43:51] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=485098) [2026-01-25 21:43:51] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=485098) [2026-01-25 21:43:51] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=485098) [2026-01-25 21:43:51] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=485098) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=485098) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:01,  1.79it/s]
(EngineCore_DP0 pid=485098) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:00<00:00,  2.44it/s]
(EngineCore_DP0 pid=485098) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:01<00:00,  1.97it/s]
(EngineCore_DP0 pid=485098) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.70it/s]
(EngineCore_DP0 pid=485098) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.82it/s]
(EngineCore_DP0 pid=485098) 
(EngineCore_DP0 pid=485098) [2026-01-25 21:43:54] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 5120] -> 1D uint8
(EngineCore_DP0 pid=485098) [2026-01-25 21:43:54] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 27525120 bytes
(EngineCore_DP0 pid=485098) [2026-01-25 21:43:54] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 5120] -> 1D uint8
(EngineCore_DP0 pid=485098) [2026-01-25 21:43:54] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 19660800 bytes
(EngineCore_DP0 pid=485098) [2026-01-25 21:43:54] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 5120] -> 1D uint8
(EngineCore_DP0 pid=485098) [2026-01-25 21:43:54] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 106168320 bytes
(EngineCore_DP0 pid=485098) [2026-01-25 21:43:54] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 13824] -> 1D uint8
(EngineCore_DP0 pid=485098) [2026-01-25 21:43:54] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 53084160 bytes
(EngineCore_DP0 pid=485098) [rank0]:W0125 21:44:20.623000 485098 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=485098) [rank0]:W0125 21:44:20.701000 485098 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=485098) [rank0]:W0125 21:44:21.591000 485098 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=485098) [rank0]:W0125 21:44:21.709000 485098 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=485098) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  14%|█▍        | 1/7 [00:00<00:01,  5.75it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  29%|██▊       | 2/7 [00:00<00:00,  6.01it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  43%|████▎     | 3/7 [00:00<00:00,  6.30it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  57%|█████▋    | 4/7 [00:00<00:00,  6.28it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  71%|███████▏  | 5/7 [00:00<00:00,  6.26it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  86%|████████▌ | 6/7 [00:00<00:00,  6.23it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:01<00:00,  5.99it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:01<00:00,  6.10it/s]
(EngineCore_DP0 pid=485098) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  20%|██        | 1/5 [00:00<00:00,  5.61it/s]
Capturing CUDA graphs (decode, FULL):  40%|████      | 2/5 [00:00<00:00,  5.99it/s]
Capturing CUDA graphs (decode, FULL):  60%|██████    | 3/5 [00:00<00:00,  6.11it/s]
Capturing CUDA graphs (decode, FULL):  80%|████████  | 4/5 [00:00<00:00,  6.31it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00,  6.42it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00,  6.26it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   1%|          | 25/2048 [00:00<00:08, 247.74it/s]
Adding requests:   2%|▏         | 50/2048 [00:00<00:08, 247.46it/s]
Adding requests:   4%|▍         | 78/2048 [00:00<00:07, 259.46it/s]
Adding requests:   5%|▌         | 106/2048 [00:00<00:07, 263.88it/s]
Adding requests:   6%|▋         | 133/2048 [00:00<00:07, 264.98it/s]
Adding requests:   8%|▊         | 162/2048 [00:00<00:06, 271.54it/s]
Adding requests:   9%|▉         | 193/2048 [00:00<00:06, 281.01it/s]
Adding requests:  11%|█         | 223/2048 [00:00<00:06, 284.92it/s]
Adding requests:  12%|█▏        | 252/2048 [00:00<00:06, 281.23it/s]
Adding requests:  14%|█▎        | 281/2048 [00:01<00:06, 281.57it/s]
Adding requests:  15%|█▌        | 310/2048 [00:01<00:06, 282.20it/s]
Adding requests:  17%|█▋        | 340/2048 [00:01<00:05, 285.37it/s]
Adding requests:  18%|█▊        | 369/2048 [00:01<00:05, 284.42it/s]
Adding requests:  19%|█▉        | 399/2048 [00:01<00:05, 287.70it/s]
Adding requests:  21%|██        | 429/2048 [00:01<00:05, 289.15it/s]
Adding requests:  22%|██▏       | 458/2048 [00:01<00:05, 284.46it/s]
Adding requests:  24%|██▍       | 489/2048 [00:01<00:05, 290.20it/s]
Adding requests:  25%|██▌       | 519/2048 [00:01<00:05, 292.06it/s]
Adding requests:  27%|██▋       | 549/2048 [00:01<00:05, 291.44it/s]
Adding requests:  28%|██▊       | 579/2048 [00:02<00:05, 290.44it/s]
Adding requests:  30%|██▉       | 609/2048 [00:02<00:05, 282.58it/s]
Adding requests:  31%|███       | 638/2048 [00:02<00:05, 280.20it/s]
Adding requests:  33%|███▎      | 667/2048 [00:02<00:05, 273.06it/s]
Adding requests:  34%|███▍      | 697/2048 [00:02<00:04, 277.85it/s]
Adding requests:  35%|███▌      | 725/2048 [00:02<00:04, 277.23it/s]
Adding requests:  37%|███▋      | 755/2048 [00:02<00:04, 283.49it/s]
Adding requests:  38%|███▊      | 787/2048 [00:02<00:04, 292.06it/s]
Adding requests:  40%|███▉      | 817/2048 [00:02<00:04, 292.27it/s]
Adding requests:  41%|████▏     | 847/2048 [00:02<00:04, 292.37it/s]
Adding requests:  43%|████▎     | 877/2048 [00:03<00:04, 291.85it/s]
Adding requests:  44%|████▍     | 909/2048 [00:03<00:03, 298.30it/s]
Adding requests:  46%|████▌     | 939/2048 [00:03<00:03, 287.28it/s]
Adding requests:  47%|████▋     | 968/2048 [00:03<00:03, 287.82it/s]
Adding requests:  49%|████▊     | 997/2048 [00:03<00:03, 280.77it/s]
Adding requests:  50%|█████     | 1026/2048 [00:03<00:03, 278.59it/s]
Adding requests:  51%|█████▏    | 1054/2048 [00:03<00:03, 277.23it/s]
Adding requests:  53%|█████▎    | 1083/2048 [00:03<00:03, 278.89it/s]
Adding requests:  54%|█████▍    | 1112/2048 [00:03<00:03, 280.77it/s]
Adding requests:  56%|█████▌    | 1142/2048 [00:04<00:03, 285.45it/s]
Adding requests:  57%|█████▋    | 1171/2048 [00:04<00:03, 280.19it/s]
Adding requests:  59%|█████▊    | 1200/2048 [00:04<00:03, 280.66it/s]
Adding requests:  60%|██████    | 1229/2048 [00:04<00:02, 283.03it/s]
Adding requests:  61%|██████▏   | 1258/2048 [00:04<00:02, 280.11it/s]
Adding requests:  63%|██████▎   | 1287/2048 [00:04<00:02, 278.74it/s]
Adding requests:  64%|██████▍   | 1317/2048 [00:04<00:02, 283.18it/s]
Adding requests:  66%|██████▌   | 1346/2048 [00:04<00:02, 284.28it/s]
Adding requests:  67%|██████▋   | 1376/2048 [00:04<00:02, 288.69it/s]
Adding requests:  69%|██████▊   | 1406/2048 [00:04<00:02, 290.61it/s]
Adding requests:  70%|███████   | 1437/2048 [00:05<00:02, 294.38it/s]
Adding requests:  72%|███████▏  | 1468/2048 [00:05<00:01, 296.23it/s]
Adding requests:  73%|███████▎  | 1499/2048 [00:05<00:01, 296.92it/s]
Adding requests:  75%|███████▍  | 1529/2048 [00:05<00:01, 293.36it/s]
Adding requests:  76%|███████▌  | 1559/2048 [00:05<00:01, 284.65it/s]
Adding requests:  78%|███████▊  | 1588/2048 [00:05<00:01, 281.53it/s]
Adding requests:  79%|███████▉  | 1617/2048 [00:05<00:01, 283.20it/s]
Adding requests:  80%|████████  | 1646/2048 [00:05<00:01, 278.26it/s]
Adding requests:  82%|████████▏ | 1675/2048 [00:05<00:01, 279.77it/s]
Adding requests:  83%|████████▎ | 1704/2048 [00:06<00:01, 280.84it/s]
Adding requests:  85%|████████▍ | 1733/2048 [00:06<00:01, 275.77it/s]
Adding requests:  86%|████████▌ | 1762/2048 [00:06<00:01, 279.62it/s]
Adding requests:  87%|████████▋ | 1791/2048 [00:06<00:00, 281.65it/s]
Adding requests:  89%|████████▉ | 1820/2048 [00:06<00:00, 276.00it/s]
Adding requests:  90%|█████████ | 1849/2048 [00:06<00:00, 277.58it/s]
Adding requests:  92%|█████████▏| 1879/2048 [00:06<00:00, 281.64it/s]
Adding requests:  93%|█████████▎| 1908/2048 [00:06<00:00, 281.14it/s]
Adding requests:  95%|█████████▍| 1939/2048 [00:06<00:00, 286.96it/s]
Adding requests:  96%|█████████▌| 1969/2048 [00:06<00:00, 287.73it/s]
Adding requests:  98%|█████████▊| 1998/2048 [00:07<00:00, 283.75it/s]
Adding requests:  99%|█████████▉| 2027/2048 [00:07<00:00, 269.87it/s]
Adding requests: 100%|██████████| 2048/2048 [00:07<00:00, 282.30it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▋         | 130/2048 [00:00<00:08, 223.97it/s, est. speed input: 229351.91 toks/s, output: 223.97 toks/s]
Processed prompts:   7%|▋         | 153/2048 [00:01<00:21, 90.01it/s, est. speed input: 108753.22 toks/s, output: 106.20 toks/s] 
Processed prompts:   8%|▊         | 164/2048 [00:02<00:36, 52.02it/s, est. speed input: 73032.16 toks/s, output: 71.32 toks/s]  
Processed prompts:   9%|▊         | 178/2048 [00:03<00:50, 37.26it/s, est. speed input: 57690.91 toks/s, output: 56.34 toks/s]
Processed prompts:   9%|▉         | 194/2048 [00:03<00:59, 30.93it/s, est. speed input: 49981.31 toks/s, output: 48.81 toks/s]
Processed prompts:  10%|█         | 210/2048 [00:04<01:09, 26.60it/s, est. speed input: 44473.50 toks/s, output: 43.43 toks/s]
Processed prompts:  11%|█         | 226/2048 [00:05<01:16, 23.94it/s, est. speed input: 40639.67 toks/s, output: 39.69 toks/s]
Processed prompts:  12%|█▏        | 242/2048 [00:06<01:21, 22.21it/s, est. speed input: 37800.46 toks/s, output: 36.91 toks/s]
Processed prompts:  13%|█▎        | 258/2048 [00:07<01:25, 21.05it/s, est. speed input: 35614.67 toks/s, output: 34.78 toks/s]
Processed prompts:  13%|█▎        | 274/2048 [00:08<01:27, 20.27it/s, est. speed input: 33883.80 toks/s, output: 33.09 toks/s]
Processed prompts:  14%|█▍        | 290/2048 [00:09<01:28, 19.75it/s, est. speed input: 32485.50 toks/s, output: 31.72 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [00:10<01:29, 19.39it/s, est. speed input: 31321.87 toks/s, output: 30.59 toks/s]
Processed prompts:  16%|█▌        | 322/2048 [00:10<01:30, 19.12it/s, est. speed input: 30338.71 toks/s, output: 29.63 toks/s]
Processed prompts:  17%|█▋        | 338/2048 [00:11<01:30, 18.92it/s, est. speed input: 29494.53 toks/s, output: 28.80 toks/s]
Processed prompts:  17%|█▋        | 354/2048 [00:12<01:30, 18.80it/s, est. speed input: 28773.80 toks/s, output: 28.10 toks/s]
Processed prompts:  18%|█▊        | 370/2048 [00:13<01:29, 18.73it/s, est. speed input: 28147.64 toks/s, output: 27.49 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [00:14<01:29, 18.66it/s, est. speed input: 27593.04 toks/s, output: 26.95 toks/s]
Processed prompts:  20%|█▉        | 402/2048 [00:15<01:28, 18.62it/s, est. speed input: 27101.20 toks/s, output: 26.47 toks/s]
Processed prompts:  20%|██        | 418/2048 [00:16<01:27, 18.58it/s, est. speed input: 26662.64 toks/s, output: 26.04 toks/s]
Processed prompts:  21%|██        | 434/2048 [00:16<01:26, 18.57it/s, est. speed input: 26269.80 toks/s, output: 25.65 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [00:17<01:26, 18.53it/s, est. speed input: 25910.58 toks/s, output: 25.30 toks/s]
Processed prompts:  23%|██▎       | 466/2048 [00:18<01:25, 18.53it/s, est. speed input: 25588.19 toks/s, output: 24.99 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [00:19<01:24, 18.52it/s, est. speed input: 25293.94 toks/s, output: 24.70 toks/s]
Processed prompts:  24%|██▍       | 498/2048 [00:20<01:23, 18.51it/s, est. speed input: 25022.96 toks/s, output: 24.44 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [00:21<01:22, 18.51it/s, est. speed input: 24775.66 toks/s, output: 24.19 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [00:22<01:22, 18.49it/s, est. speed input: 24545.16 toks/s, output: 23.97 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [00:22<01:21, 18.48it/s, est. speed input: 24332.00 toks/s, output: 23.76 toks/s]
Processed prompts:  27%|██▋       | 562/2048 [00:23<01:20, 18.47it/s, est. speed input: 24134.79 toks/s, output: 23.57 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [00:24<01:19, 18.47it/s, est. speed input: 23951.60 toks/s, output: 23.39 toks/s]
Processed prompts:  29%|██▉       | 594/2048 [00:25<01:18, 18.47it/s, est. speed input: 23780.58 toks/s, output: 23.22 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [00:26<01:17, 18.46it/s, est. speed input: 23620.48 toks/s, output: 23.07 toks/s]
Processed prompts:  31%|███       | 626/2048 [00:27<01:16, 18.47it/s, est. speed input: 23471.50 toks/s, output: 22.92 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [00:28<01:16, 18.47it/s, est. speed input: 23330.90 toks/s, output: 22.78 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [00:29<01:15, 18.46it/s, est. speed input: 23197.97 toks/s, output: 22.65 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [00:29<01:14, 18.46it/s, est. speed input: 23073.90 toks/s, output: 22.53 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [00:30<01:13, 18.46it/s, est. speed input: 22956.35 toks/s, output: 22.42 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [00:31<01:12, 18.45it/s, est. speed input: 22843.98 toks/s, output: 22.31 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [00:32<01:11, 18.44it/s, est. speed input: 22737.81 toks/s, output: 22.20 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [00:33<01:11, 18.44it/s, est. speed input: 22636.99 toks/s, output: 22.11 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [00:34<01:10, 18.44it/s, est. speed input: 22541.73 toks/s, output: 22.01 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [00:35<01:09, 18.43it/s, est. speed input: 22450.62 toks/s, output: 21.92 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [00:35<01:07, 18.72it/s, est. speed input: 22392.33 toks/s, output: 21.87 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [00:36<01:06, 18.63it/s, est. speed input: 22309.15 toks/s, output: 21.79 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [00:37<01:06, 18.57it/s, est. speed input: 22229.95 toks/s, output: 21.71 toks/s]
Processed prompts:  41%|████      | 834/2048 [00:38<01:05, 18.52it/s, est. speed input: 22153.57 toks/s, output: 21.63 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [00:39<01:04, 18.48it/s, est. speed input: 22080.00 toks/s, output: 21.56 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [00:40<01:04, 18.44it/s, est. speed input: 22009.28 toks/s, output: 21.49 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [00:41<01:03, 18.43it/s, est. speed input: 21941.87 toks/s, output: 21.43 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [00:42<01:02, 18.42it/s, est. speed input: 21877.73 toks/s, output: 21.36 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [00:42<01:01, 18.40it/s, est. speed input: 21815.27 toks/s, output: 21.30 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [00:43<01:00, 18.39it/s, est. speed input: 21755.52 toks/s, output: 21.25 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [00:44<00:59, 18.39it/s, est. speed input: 21698.39 toks/s, output: 21.19 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [00:45<00:59, 18.38it/s, est. speed input: 21643.23 toks/s, output: 21.14 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [00:46<00:58, 18.38it/s, est. speed input: 21589.74 toks/s, output: 21.08 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [00:47<00:57, 18.36it/s, est. speed input: 21537.37 toks/s, output: 21.03 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [00:48<00:56, 18.36it/s, est. speed input: 21487.72 toks/s, output: 20.98 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [00:49<00:55, 18.35it/s, est. speed input: 21439.61 toks/s, output: 20.94 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [00:49<00:54, 18.35it/s, est. speed input: 21393.15 toks/s, output: 20.89 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [00:50<00:53, 18.35it/s, est. speed input: 21348.53 toks/s, output: 20.85 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [00:51<00:53, 18.34it/s, est. speed input: 21304.75 toks/s, output: 20.81 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [00:52<00:52, 18.34it/s, est. speed input: 21262.93 toks/s, output: 20.76 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [00:53<00:51, 18.34it/s, est. speed input: 21222.19 toks/s, output: 20.72 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [00:54<00:50, 18.33it/s, est. speed input: 21182.45 toks/s, output: 20.69 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [00:55<00:49, 18.32it/s, est. speed input: 21143.49 toks/s, output: 20.65 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [00:55<00:48, 18.33it/s, est. speed input: 21106.80 toks/s, output: 20.61 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [00:56<00:47, 18.32it/s, est. speed input: 21070.20 toks/s, output: 20.58 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [00:57<00:47, 18.31it/s, est. speed input: 21034.73 toks/s, output: 20.54 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [00:58<00:46, 18.31it/s, est. speed input: 21000.98 toks/s, output: 20.51 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [00:59<00:45, 18.31it/s, est. speed input: 20967.64 toks/s, output: 20.48 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [01:00<00:44, 18.30it/s, est. speed input: 20935.15 toks/s, output: 20.44 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [01:01<00:43, 18.30it/s, est. speed input: 20903.96 toks/s, output: 20.41 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [01:02<00:42, 18.30it/s, est. speed input: 20873.47 toks/s, output: 20.38 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [01:02<00:41, 18.30it/s, est. speed input: 20843.60 toks/s, output: 20.36 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [01:03<00:41, 18.29it/s, est. speed input: 20814.44 toks/s, output: 20.33 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [01:04<00:40, 18.28it/s, est. speed input: 20785.86 toks/s, output: 20.30 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [01:05<00:39, 18.29it/s, est. speed input: 20758.47 toks/s, output: 20.27 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [01:06<00:38, 18.28it/s, est. speed input: 20731.48 toks/s, output: 20.25 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [01:07<00:37, 18.29it/s, est. speed input: 20705.59 toks/s, output: 20.22 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [01:08<00:36, 18.28it/s, est. speed input: 20679.75 toks/s, output: 20.20 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [01:09<00:35, 18.27it/s, est. speed input: 20654.74 toks/s, output: 20.17 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [01:09<00:34, 18.27it/s, est. speed input: 20630.21 toks/s, output: 20.15 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [01:10<00:34, 18.26it/s, est. speed input: 20606.19 toks/s, output: 20.12 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [01:11<00:33, 18.27it/s, est. speed input: 20583.08 toks/s, output: 20.10 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [01:12<00:32, 18.26it/s, est. speed input: 20560.19 toks/s, output: 20.08 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [01:13<00:31, 18.26it/s, est. speed input: 20538.03 toks/s, output: 20.06 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [01:14<00:30, 18.26it/s, est. speed input: 20516.26 toks/s, output: 20.04 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [01:15<00:29, 18.25it/s, est. speed input: 20494.71 toks/s, output: 20.01 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [01:16<00:28, 18.26it/s, est. speed input: 20474.25 toks/s, output: 19.99 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [01:16<00:27, 18.25it/s, est. speed input: 20453.74 toks/s, output: 19.97 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [01:17<00:26, 18.55it/s, est. speed input: 20446.23 toks/s, output: 19.97 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [01:18<00:25, 18.45it/s, est. speed input: 20426.47 toks/s, output: 19.95 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [01:19<00:25, 18.38it/s, est. speed input: 20406.81 toks/s, output: 19.93 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [01:20<00:24, 18.34it/s, est. speed input: 20388.03 toks/s, output: 19.91 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [01:21<00:23, 18.61it/s, est. speed input: 20381.30 toks/s, output: 19.90 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [01:22<00:22, 18.49it/s, est. speed input: 20362.84 toks/s, output: 19.89 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [01:23<00:21, 18.41it/s, est. speed input: 20344.77 toks/s, output: 19.87 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [01:23<00:20, 18.36it/s, est. speed input: 20327.33 toks/s, output: 19.85 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [01:24<00:19, 18.32it/s, est. speed input: 20310.22 toks/s, output: 19.83 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [01:25<00:19, 18.28it/s, est. speed input: 20293.02 toks/s, output: 19.82 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [01:26<00:18, 18.26it/s, est. speed input: 20276.38 toks/s, output: 19.80 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [01:27<00:17, 18.24it/s, est. speed input: 20259.89 toks/s, output: 19.79 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [01:28<00:16, 18.24it/s, est. speed input: 20244.21 toks/s, output: 19.77 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [01:29<00:15, 18.23it/s, est. speed input: 20228.35 toks/s, output: 19.75 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [01:30<00:14, 18.22it/s, est. speed input: 20212.89 toks/s, output: 19.74 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [01:30<00:13, 18.23it/s, est. speed input: 20198.05 toks/s, output: 19.72 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [01:31<00:13, 18.21it/s, est. speed input: 20182.83 toks/s, output: 19.71 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [01:32<00:12, 18.20it/s, est. speed input: 20167.86 toks/s, output: 19.70 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [01:33<00:11, 18.20it/s, est. speed input: 20153.43 toks/s, output: 19.68 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [01:34<00:10, 18.19it/s, est. speed input: 20138.99 toks/s, output: 19.67 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [01:35<00:09, 18.19it/s, est. speed input: 20125.07 toks/s, output: 19.65 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [01:36<00:08, 18.20it/s, est. speed input: 20111.56 toks/s, output: 19.64 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [01:37<00:07, 18.19it/s, est. speed input: 20097.89 toks/s, output: 19.63 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [01:37<00:06, 18.19it/s, est. speed input: 20084.61 toks/s, output: 19.61 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [01:38<00:06, 18.18it/s, est. speed input: 20071.49 toks/s, output: 19.60 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [01:39<00:05, 18.18it/s, est. speed input: 20058.64 toks/s, output: 19.59 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [01:40<00:04, 18.19it/s, est. speed input: 20046.24 toks/s, output: 19.58 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [01:41<00:03, 18.18it/s, est. speed input: 20033.62 toks/s, output: 19.56 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [01:42<00:02, 18.17it/s, est. speed input: 20021.31 toks/s, output: 19.55 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [01:43<00:01, 18.20it/s, est. speed input: 20010.03 toks/s, output: 19.54 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [01:44<00:00, 18.56it/s, est. speed input: 20009.39 toks/s, output: 19.54 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [01:44<00:00, 18.56it/s, est. speed input: 20147.03 toks/s, output: 19.67 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [01:44<00:00, 19.67it/s, est. speed input: 20147.03 toks/s, output: 19.67 toks/s]
[rank0]:[W125 21:46:31.444942629 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=32768 ==========
Time: 2026-01-25 21:46:33
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=4096, max_num_seqs=32
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 4096 --max-num-seqs 32 --max-model-len 1025 --max-num-batched-tokens 32768 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/Qwen2.5-14B-INT8_M32768.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 21:47:09 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=488200) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=488200) WARNING 01-25 21:47:34 [backends.py:609] Failed to read file <frozen os>
Throughput: 18.41 requests/s, 18871.96 total tokens/s, 18.41 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096

STDERR:
[2026-01-25 21:47:09] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 21:47:09] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-25 21:47:09] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-25 21:47:09] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:47:09] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:47:09] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:47:09] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:47:09] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:47:09] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-25 21:47:09] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 21:47:09] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 21:47:09] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 21:47:09] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 21:47:09] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 21:47:17] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 21:47:17] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-25 21:47:17] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-25 21:47:17] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:47:17] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:47:17] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:47:17] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:47:17] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:47:17] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-25 21:47:17] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 21:47:17] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 21:47:17] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 21:47:17] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 21:47:17] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=488200) [2026-01-25 21:47:18] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=488200) [2026-01-25 21:47:18] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=488200) [2026-01-25 21:47:18] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=488200) [2026-01-25 21:47:18] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=488200) [2026-01-25 21:47:18] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=488200) [2026-01-25 21:47:18] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=488200) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=488200) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:01,  1.80it/s]
(EngineCore_DP0 pid=488200) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:00<00:00,  2.37it/s]
(EngineCore_DP0 pid=488200) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:01<00:00,  1.95it/s]
(EngineCore_DP0 pid=488200) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.68it/s]
(EngineCore_DP0 pid=488200) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.80it/s]
(EngineCore_DP0 pid=488200) 
(EngineCore_DP0 pid=488200) [2026-01-25 21:47:21] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 5120] -> 1D uint8
(EngineCore_DP0 pid=488200) [2026-01-25 21:47:21] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 27525120 bytes
(EngineCore_DP0 pid=488200) [2026-01-25 21:47:21] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 5120] -> 1D uint8
(EngineCore_DP0 pid=488200) [2026-01-25 21:47:21] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 19660800 bytes
(EngineCore_DP0 pid=488200) [2026-01-25 21:47:21] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 5120] -> 1D uint8
(EngineCore_DP0 pid=488200) [2026-01-25 21:47:21] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 106168320 bytes
(EngineCore_DP0 pid=488200) [2026-01-25 21:47:21] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 13824] -> 1D uint8
(EngineCore_DP0 pid=488200) [2026-01-25 21:47:21] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 53084160 bytes
(EngineCore_DP0 pid=488200) [rank0]:W0125 21:47:47.908000 488200 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=488200) [rank0]:W0125 21:47:47.991000 488200 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=488200) [rank0]:W0125 21:47:48.900000 488200 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=488200) [rank0]:W0125 21:47:49.026000 488200 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=488200) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   9%|▉         | 1/11 [00:00<00:01,  5.83it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  18%|█▊        | 2/11 [00:00<00:01,  5.96it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  27%|██▋       | 3/11 [00:00<00:01,  5.95it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  36%|███▋      | 4/11 [00:00<00:01,  6.22it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  45%|████▌     | 5/11 [00:00<00:00,  6.37it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  55%|█████▍    | 6/11 [00:00<00:00,  6.39it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  64%|██████▎   | 7/11 [00:01<00:00,  6.46it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  73%|███████▎  | 8/11 [00:01<00:00,  6.55it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  82%|████████▏ | 9/11 [00:01<00:00,  6.61it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  91%|█████████ | 10/11 [00:01<00:00,  6.65it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00,  6.46it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00,  6.39it/s]
(EngineCore_DP0 pid=488200) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  14%|█▍        | 1/7 [00:00<00:01,  5.99it/s]
Capturing CUDA graphs (decode, FULL):  29%|██▊       | 2/7 [00:00<00:00,  6.35it/s]
Capturing CUDA graphs (decode, FULL):  43%|████▎     | 3/7 [00:00<00:00,  6.36it/s]
Capturing CUDA graphs (decode, FULL):  57%|█████▋    | 4/7 [00:00<00:00,  6.51it/s]
Capturing CUDA graphs (decode, FULL):  71%|███████▏  | 5/7 [00:00<00:00,  6.34it/s]
Capturing CUDA graphs (decode, FULL):  86%|████████▌ | 6/7 [00:00<00:00,  6.47it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:01<00:00,  6.58it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:01<00:00,  6.46it/s]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   1%|          | 27/4096 [00:00<00:15, 260.26it/s]
Adding requests:   1%|▏         | 56/4096 [00:00<00:14, 277.37it/s]
Adding requests:   2%|▏         | 86/4096 [00:00<00:14, 283.18it/s]
Adding requests:   3%|▎         | 115/4096 [00:00<00:14, 283.73it/s]
Adding requests:   4%|▎         | 145/4096 [00:00<00:13, 287.85it/s]
Adding requests:   4%|▍         | 175/4096 [00:00<00:13, 287.95it/s]
Adding requests:   5%|▌         | 205/4096 [00:00<00:13, 288.69it/s]
Adding requests:   6%|▌         | 235/4096 [00:00<00:13, 291.39it/s]
Adding requests:   6%|▋         | 265/4096 [00:00<00:13, 286.75it/s]
Adding requests:   7%|▋         | 294/4096 [00:01<00:13, 284.74it/s]
Adding requests:   8%|▊         | 324/4096 [00:01<00:13, 287.70it/s]
Adding requests:   9%|▊         | 356/4096 [00:01<00:12, 296.65it/s]
Adding requests:   9%|▉         | 387/4096 [00:01<00:12, 298.68it/s]
Adding requests:  10%|█         | 419/4096 [00:01<00:12, 304.60it/s]
Adding requests:  11%|█         | 450/4096 [00:01<00:12, 298.60it/s]
Adding requests:  12%|█▏        | 482/4096 [00:01<00:11, 304.18it/s]
Adding requests:  13%|█▎        | 515/4096 [00:01<00:11, 311.49it/s]
Adding requests:  13%|█▎        | 547/4096 [00:01<00:11, 311.78it/s]
Adding requests:  14%|█▍        | 579/4096 [00:01<00:11, 310.71it/s]
Adding requests:  15%|█▍        | 611/4096 [00:02<00:11, 292.00it/s]
Adding requests:  16%|█▌        | 641/4096 [00:02<00:11, 289.84it/s]
Adding requests:  16%|█▋        | 671/4096 [00:02<00:12, 279.47it/s]
Adding requests:  17%|█▋        | 700/4096 [00:02<00:12, 281.17it/s]
Adding requests:  18%|█▊        | 729/4096 [00:02<00:12, 280.35it/s]
Adding requests:  19%|█▊        | 758/4096 [00:02<00:11, 282.62it/s]
Adding requests:  19%|█▉        | 789/4096 [00:02<00:11, 289.24it/s]
Adding requests:  20%|██        | 820/4096 [00:02<00:11, 292.24it/s]
Adding requests:  21%|██        | 853/4096 [00:02<00:10, 300.70it/s]
Adding requests:  22%|██▏       | 885/4096 [00:03<00:10, 304.45it/s]
Adding requests:  22%|██▏       | 916/4096 [00:03<00:10, 297.29it/s]
Adding requests:  23%|██▎       | 946/4096 [00:03<00:10, 296.72it/s]
Adding requests:  24%|██▍       | 977/4096 [00:03<00:10, 299.80it/s]
Adding requests:  25%|██▍       | 1008/4096 [00:03<00:10, 296.25it/s]
Adding requests:  25%|██▌       | 1039/4096 [00:03<00:10, 299.94it/s]
Adding requests:  26%|██▌       | 1070/4096 [00:03<00:10, 297.83it/s]
Adding requests:  27%|██▋       | 1100/4096 [00:03<00:10, 291.61it/s]
Adding requests:  28%|██▊       | 1130/4096 [00:03<00:10, 288.82it/s]
Adding requests:  28%|██▊       | 1159/4096 [00:03<00:10, 285.47it/s]
Adding requests:  29%|██▉       | 1188/4096 [00:04<00:10, 285.39it/s]
Adding requests:  30%|██▉       | 1219/4096 [00:04<00:09, 291.71it/s]
Adding requests:  30%|███       | 1249/4096 [00:04<00:09, 285.77it/s]
Adding requests:  31%|███       | 1278/4096 [00:04<00:09, 285.08it/s]
Adding requests:  32%|███▏      | 1308/4096 [00:04<00:09, 287.08it/s]
Adding requests:  33%|███▎      | 1338/4096 [00:04<00:09, 289.18it/s]
Adding requests:  33%|███▎      | 1370/4096 [00:04<00:09, 296.22it/s]
Adding requests:  34%|███▍      | 1400/4096 [00:04<00:09, 294.84it/s]
Adding requests:  35%|███▍      | 1430/4096 [00:04<00:09, 289.38it/s]
Adding requests:  36%|███▌      | 1460/4096 [00:04<00:09, 289.68it/s]
Adding requests:  36%|███▋      | 1492/4096 [00:05<00:08, 298.29it/s]
Adding requests:  37%|███▋      | 1522/4096 [00:05<00:08, 293.24it/s]
Adding requests:  38%|███▊      | 1552/4096 [00:05<00:08, 293.58it/s]
Adding requests:  39%|███▊      | 1582/4096 [00:05<00:08, 285.61it/s]
Adding requests:  39%|███▉      | 1611/4096 [00:05<00:08, 279.00it/s]
Adding requests:  40%|████      | 1639/4096 [00:05<00:09, 270.81it/s]
Adding requests:  41%|████      | 1667/4096 [00:05<00:08, 272.28it/s]
Adding requests:  41%|████▏     | 1698/4096 [00:05<00:08, 282.69it/s]
Adding requests:  42%|████▏     | 1729/4096 [00:05<00:08, 287.51it/s]
Adding requests:  43%|████▎     | 1760/4096 [00:06<00:08, 290.96it/s]
Adding requests:  44%|████▎     | 1790/4096 [00:06<00:07, 289.58it/s]
Adding requests:  44%|████▍     | 1819/4096 [00:06<00:07, 285.66it/s]
Adding requests:  45%|████▌     | 1850/4096 [00:06<00:07, 292.03it/s]
Adding requests:  46%|████▌     | 1882/4096 [00:06<00:07, 299.18it/s]
Adding requests:  47%|████▋     | 1914/4096 [00:06<00:07, 303.19it/s]
Adding requests:  47%|████▋     | 1945/4096 [00:06<00:07, 303.90it/s]
Adding requests:  48%|████▊     | 1976/4096 [00:06<00:06, 303.29it/s]
Adding requests:  49%|████▉     | 2007/4096 [00:06<00:06, 301.62it/s]
Adding requests:  50%|████▉     | 2038/4096 [00:06<00:06, 297.01it/s]
Adding requests:  50%|█████     | 2068/4096 [00:07<00:06, 289.88it/s]
Adding requests:  51%|█████     | 2098/4096 [00:07<00:06, 292.53it/s]
Adding requests:  52%|█████▏    | 2128/4096 [00:07<00:06, 292.29it/s]
Adding requests:  53%|█████▎    | 2158/4096 [00:07<00:06, 291.79it/s]
Adding requests:  53%|█████▎    | 2188/4096 [00:07<00:06, 290.81it/s]
Adding requests:  54%|█████▍    | 2218/4096 [00:07<00:06, 289.29it/s]
Adding requests:  55%|█████▍    | 2248/4096 [00:07<00:06, 292.23it/s]
Adding requests:  56%|█████▌    | 2281/4096 [00:07<00:06, 301.49it/s]
Adding requests:  56%|█████▋    | 2313/4096 [00:07<00:05, 304.86it/s]
Adding requests:  57%|█████▋    | 2344/4096 [00:08<00:05, 298.47it/s]
Adding requests:  58%|█████▊    | 2374/4096 [00:08<00:05, 297.49it/s]
Adding requests:  59%|█████▊    | 2404/4096 [00:08<00:05, 297.85it/s]
Adding requests:  59%|█████▉    | 2434/4096 [00:08<00:05, 295.85it/s]
Adding requests:  60%|██████    | 2464/4096 [00:08<00:05, 293.55it/s]
Adding requests:  61%|██████    | 2494/4096 [00:08<00:05, 294.92it/s]
Adding requests:  62%|██████▏   | 2524/4096 [00:08<00:05, 290.70it/s]
Adding requests:  62%|██████▏   | 2556/4096 [00:08<00:05, 297.88it/s]
Adding requests:  63%|██████▎   | 2586/4096 [00:08<00:05, 298.10it/s]
Adding requests:  64%|██████▍   | 2616/4096 [00:08<00:05, 295.87it/s]
Adding requests:  65%|██████▍   | 2646/4096 [00:09<00:04, 290.24it/s]
Adding requests:  65%|██████▌   | 2676/4096 [00:09<00:04, 291.56it/s]
Adding requests:  66%|██████▌   | 2706/4096 [00:09<00:04, 289.78it/s]
Adding requests:  67%|██████▋   | 2735/4096 [00:09<00:04, 288.98it/s]
Adding requests:  68%|██████▊   | 2767/4096 [00:09<00:04, 297.69it/s]
Adding requests:  68%|██████▊   | 2798/4096 [00:09<00:04, 299.14it/s]
Adding requests:  69%|██████▉   | 2828/4096 [00:09<00:04, 297.31it/s]
Adding requests:  70%|██████▉   | 2859/4096 [00:09<00:04, 299.29it/s]
Adding requests:  71%|███████   | 2890/4096 [00:09<00:03, 301.64it/s]
Adding requests:  71%|███████▏  | 2921/4096 [00:09<00:03, 297.08it/s]
Adding requests:  72%|███████▏  | 2954/4096 [00:10<00:03, 304.15it/s]
Adding requests:  73%|███████▎  | 2985/4096 [00:10<00:03, 302.48it/s]
Adding requests:  74%|███████▎  | 3017/4096 [00:10<00:03, 307.36it/s]
Adding requests:  74%|███████▍  | 3048/4096 [00:10<00:03, 299.25it/s]
Adding requests:  75%|███████▌  | 3080/4096 [00:10<00:03, 302.49it/s]
Adding requests:  76%|███████▌  | 3111/4096 [00:10<00:03, 302.46it/s]
Adding requests:  77%|███████▋  | 3143/4096 [00:10<00:03, 306.95it/s]
Adding requests:  77%|███████▋  | 3174/4096 [00:10<00:03, 297.94it/s]
Adding requests:  78%|███████▊  | 3204/4096 [00:10<00:02, 297.46it/s]
Adding requests:  79%|███████▉  | 3236/4096 [00:11<00:02, 301.23it/s]
Adding requests:  80%|███████▉  | 3267/4096 [00:11<00:02, 295.18it/s]
Adding requests:  80%|████████  | 3297/4096 [00:11<00:02, 291.77it/s]
Adding requests:  81%|████████  | 3327/4096 [00:11<00:02, 293.78it/s]
Adding requests:  82%|████████▏ | 3357/4096 [00:11<00:02, 295.53it/s]
Adding requests:  83%|████████▎ | 3389/4096 [00:11<00:02, 302.08it/s]
Adding requests:  83%|████████▎ | 3420/4096 [00:11<00:02, 296.88it/s]
Adding requests:  84%|████████▍ | 3450/4096 [00:11<00:02, 292.43it/s]
Adding requests:  85%|████████▍ | 3480/4096 [00:11<00:02, 290.78it/s]
Adding requests:  86%|████████▌ | 3512/4096 [00:11<00:01, 295.06it/s]
Adding requests:  87%|████████▋ | 3545/4096 [00:12<00:01, 304.23it/s]
Adding requests:  87%|████████▋ | 3576/4096 [00:12<00:01, 301.59it/s]
Adding requests:  88%|████████▊ | 3607/4096 [00:12<00:01, 303.02it/s]
Adding requests:  89%|████████▉ | 3638/4096 [00:12<00:01, 304.77it/s]
Adding requests:  90%|████████▉ | 3669/4096 [00:12<00:01, 292.21it/s]
Adding requests:  90%|█████████ | 3699/4096 [00:12<00:01, 283.30it/s]
Adding requests:  91%|█████████ | 3730/4096 [00:12<00:01, 287.94it/s]
Adding requests:  92%|█████████▏| 3759/4096 [00:12<00:01, 288.00it/s]
Adding requests:  92%|█████████▏| 3788/4096 [00:12<00:01, 285.38it/s]
Adding requests:  93%|█████████▎| 3817/4096 [00:13<00:00, 283.43it/s]
Adding requests:  94%|█████████▍| 3846/4096 [00:13<00:00, 285.17it/s]
Adding requests:  95%|█████████▍| 3877/4096 [00:13<00:00, 291.13it/s]
Adding requests:  95%|█████████▌| 3907/4096 [00:13<00:00, 288.96it/s]
Adding requests:  96%|█████████▌| 3936/4096 [00:13<00:00, 282.32it/s]
Adding requests:  97%|█████████▋| 3965/4096 [00:13<00:00, 283.75it/s]
Adding requests:  98%|█████████▊| 3995/4096 [00:13<00:00, 287.27it/s]
Adding requests:  98%|█████████▊| 4025/4096 [00:13<00:00, 289.90it/s]
Adding requests:  99%|█████████▉| 4055/4096 [00:13<00:00, 284.19it/s]
Adding requests: 100%|█████████▉| 4085/4096 [00:13<00:00, 288.36it/s]
Adding requests: 100%|██████████| 4096/4096 [00:13<00:00, 293.22it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▌         | 251/4096 [00:01<00:17, 219.89it/s, est. speed input: 225175.85 toks/s, output: 219.89 toks/s]
Processed prompts:   7%|▋         | 283/4096 [00:02<00:46, 82.52it/s, est. speed input: 101346.36 toks/s, output: 98.97 toks/s]  
Processed prompts:   8%|▊         | 315/4096 [00:04<01:14, 50.95it/s, est. speed input: 70441.30 toks/s, output: 68.79 toks/s] 
Processed prompts:   8%|▊         | 347/4096 [00:06<01:39, 37.56it/s, est. speed input: 56404.69 toks/s, output: 55.08 toks/s]
Processed prompts:   9%|▉         | 379/4096 [00:08<02:01, 30.50it/s, est. speed input: 48374.56 toks/s, output: 47.24 toks/s]
Processed prompts:  10%|█         | 411/4096 [00:09<02:19, 26.36it/s, est. speed input: 43183.50 toks/s, output: 42.17 toks/s]
Processed prompts:  11%|█         | 443/4096 [00:11<02:33, 23.77it/s, est. speed input: 39545.08 toks/s, output: 38.62 toks/s]
Processed prompts:  12%|█▏        | 475/4096 [00:13<02:43, 22.10it/s, est. speed input: 36861.18 toks/s, output: 36.00 toks/s]
Processed prompts:  12%|█▏        | 507/4096 [00:14<02:51, 20.98it/s, est. speed input: 34796.62 toks/s, output: 33.98 toks/s]
Processed prompts:  13%|█▎        | 539/4096 [00:16<02:55, 20.22it/s, est. speed input: 33155.48 toks/s, output: 32.38 toks/s]
Processed prompts:  14%|█▍        | 571/4096 [00:18<02:58, 19.70it/s, est. speed input: 31822.85 toks/s, output: 31.08 toks/s]
Processed prompts:  15%|█▍        | 603/4096 [00:20<03:00, 19.35it/s, est. speed input: 30719.81 toks/s, output: 30.00 toks/s]
Processed prompts:  16%|█▌        | 635/4096 [00:21<03:01, 19.09it/s, est. speed input: 29786.36 toks/s, output: 29.09 toks/s]
Processed prompts:  16%|█▋        | 667/4096 [00:23<03:01, 18.91it/s, est. speed input: 28991.52 toks/s, output: 28.31 toks/s]
Processed prompts:  17%|█▋        | 699/4096 [00:25<03:00, 18.78it/s, est. speed input: 28301.29 toks/s, output: 27.64 toks/s]
Processed prompts:  18%|█▊        | 731/4096 [00:27<03:00, 18.69it/s, est. speed input: 27699.78 toks/s, output: 27.05 toks/s]
Processed prompts:  19%|█▊        | 763/4096 [00:28<02:57, 18.78it/s, est. speed input: 27216.28 toks/s, output: 26.58 toks/s]
Processed prompts:  19%|█▉        | 795/4096 [00:30<02:56, 18.68it/s, est. speed input: 26742.66 toks/s, output: 26.12 toks/s]
Processed prompts:  20%|██        | 827/4096 [00:32<02:55, 18.62it/s, est. speed input: 26320.43 toks/s, output: 25.70 toks/s]
Processed prompts:  21%|██        | 859/4096 [00:33<02:54, 18.56it/s, est. speed input: 25939.85 toks/s, output: 25.33 toks/s]
Processed prompts:  22%|██▏       | 891/4096 [00:35<02:52, 18.53it/s, est. speed input: 25597.07 toks/s, output: 25.00 toks/s]
Processed prompts:  23%|██▎       | 923/4096 [00:37<02:51, 18.50it/s, est. speed input: 25284.39 toks/s, output: 24.69 toks/s]
Processed prompts:  23%|██▎       | 955/4096 [00:39<02:49, 18.48it/s, est. speed input: 25000.30 toks/s, output: 24.41 toks/s]
Processed prompts:  24%|██▍       | 987/4096 [00:40<02:48, 18.48it/s, est. speed input: 24743.59 toks/s, output: 24.16 toks/s]
Processed prompts:  25%|██▍       | 1019/4096 [00:42<02:46, 18.49it/s, est. speed input: 24508.49 toks/s, output: 23.93 toks/s]
Processed prompts:  26%|██▌       | 1051/4096 [00:44<02:48, 18.11it/s, est. speed input: 24224.15 toks/s, output: 23.66 toks/s]
Processed prompts:  26%|██▋       | 1083/4096 [00:46<02:45, 18.22it/s, est. speed input: 24026.01 toks/s, output: 23.46 toks/s]
Processed prompts:  27%|██▋       | 1115/4096 [00:47<02:42, 18.30it/s, est. speed input: 23841.76 toks/s, output: 23.28 toks/s]
Processed prompts:  28%|██▊       | 1147/4096 [00:49<02:40, 18.35it/s, est. speed input: 23669.93 toks/s, output: 23.12 toks/s]
Processed prompts:  29%|██▉       | 1179/4096 [00:51<02:38, 18.39it/s, est. speed input: 23509.68 toks/s, output: 22.96 toks/s]
Processed prompts:  30%|██▉       | 1211/4096 [00:53<02:36, 18.41it/s, est. speed input: 23359.39 toks/s, output: 22.81 toks/s]
Processed prompts:  30%|███       | 1243/4096 [00:54<02:34, 18.42it/s, est. speed input: 23217.82 toks/s, output: 22.67 toks/s]
Processed prompts:  31%|███       | 1275/4096 [00:56<02:33, 18.43it/s, est. speed input: 23085.75 toks/s, output: 22.54 toks/s]
Processed prompts:  32%|███▏      | 1307/4096 [00:58<02:31, 18.44it/s, est. speed input: 22961.01 toks/s, output: 22.42 toks/s]
Processed prompts:  33%|███▎      | 1339/4096 [01:00<02:29, 18.44it/s, est. speed input: 22842.93 toks/s, output: 22.31 toks/s]
Processed prompts:  33%|███▎      | 1371/4096 [01:01<02:27, 18.44it/s, est. speed input: 22731.79 toks/s, output: 22.20 toks/s]
Processed prompts:  34%|███▍      | 1403/4096 [01:03<02:26, 18.44it/s, est. speed input: 22626.30 toks/s, output: 22.10 toks/s]
Processed prompts:  35%|███▌      | 1435/4096 [01:05<02:24, 18.44it/s, est. speed input: 22526.56 toks/s, output: 22.00 toks/s]
Processed prompts:  36%|███▌      | 1467/4096 [01:06<02:22, 18.43it/s, est. speed input: 22431.14 toks/s, output: 21.91 toks/s]
Processed prompts:  37%|███▋      | 1499/4096 [01:08<02:20, 18.42it/s, est. speed input: 22340.48 toks/s, output: 21.82 toks/s]
Processed prompts:  37%|███▋      | 1531/4096 [01:10<02:19, 18.42it/s, est. speed input: 22254.62 toks/s, output: 21.73 toks/s]
Processed prompts:  38%|███▊      | 1563/4096 [01:12<02:16, 18.56it/s, est. speed input: 22186.58 toks/s, output: 21.67 toks/s]
Processed prompts:  39%|███▉      | 1595/4096 [01:13<02:15, 18.52it/s, est. speed input: 22108.14 toks/s, output: 21.59 toks/s]
Processed prompts:  40%|███▉      | 1627/4096 [01:15<02:12, 18.63it/s, est. speed input: 22046.30 toks/s, output: 21.53 toks/s]
Processed prompts:  41%|████      | 1659/4096 [01:17<02:11, 18.56it/s, est. speed input: 21973.86 toks/s, output: 21.46 toks/s]
Processed prompts:  41%|████▏     | 1691/4096 [01:19<02:09, 18.50it/s, est. speed input: 21904.24 toks/s, output: 21.39 toks/s]
Processed prompts:  42%|████▏     | 1723/4096 [01:20<02:08, 18.47it/s, est. speed input: 21838.55 toks/s, output: 21.33 toks/s]
Processed prompts:  43%|████▎     | 1755/4096 [01:22<02:06, 18.44it/s, est. speed input: 21774.16 toks/s, output: 21.26 toks/s]
Processed prompts:  44%|████▎     | 1787/4096 [01:24<02:05, 18.42it/s, est. speed input: 21713.26 toks/s, output: 21.20 toks/s]
Processed prompts:  44%|████▍     | 1819/4096 [01:26<02:03, 18.41it/s, est. speed input: 21654.71 toks/s, output: 21.15 toks/s]
Processed prompts:  45%|████▌     | 1851/4096 [01:27<02:02, 18.40it/s, est. speed input: 21598.33 toks/s, output: 21.09 toks/s]
Processed prompts:  46%|████▌     | 1883/4096 [01:29<02:00, 18.39it/s, est. speed input: 21544.09 toks/s, output: 21.04 toks/s]
Processed prompts:  47%|████▋     | 1915/4096 [01:31<01:58, 18.38it/s, est. speed input: 21491.67 toks/s, output: 20.99 toks/s]
Processed prompts:  48%|████▊     | 1947/4096 [01:32<01:56, 18.37it/s, est. speed input: 21440.93 toks/s, output: 20.94 toks/s]
Processed prompts:  48%|████▊     | 1979/4096 [01:34<01:55, 18.37it/s, est. speed input: 21392.52 toks/s, output: 20.89 toks/s]
Processed prompts:  49%|████▉     | 2011/4096 [01:36<01:53, 18.36it/s, est. speed input: 21345.53 toks/s, output: 20.85 toks/s]
Processed prompts:  50%|████▉     | 2043/4096 [01:38<01:51, 18.36it/s, est. speed input: 21300.24 toks/s, output: 20.80 toks/s]
Processed prompts:  51%|█████     | 2075/4096 [01:39<01:50, 18.35it/s, est. speed input: 21256.13 toks/s, output: 20.76 toks/s]
Processed prompts:  51%|█████▏    | 2107/4096 [01:41<01:48, 18.35it/s, est. speed input: 21213.91 toks/s, output: 20.72 toks/s]
Processed prompts:  52%|█████▏    | 2139/4096 [01:43<01:46, 18.35it/s, est. speed input: 21172.89 toks/s, output: 20.68 toks/s]
Processed prompts:  53%|█████▎    | 2171/4096 [01:45<01:44, 18.49it/s, est. speed input: 21142.51 toks/s, output: 20.65 toks/s]
Processed prompts:  54%|█████▍    | 2203/4096 [01:46<01:42, 18.44it/s, est. speed input: 21103.78 toks/s, output: 20.61 toks/s]
Processed prompts:  55%|█████▍    | 2235/4096 [01:48<01:41, 18.41it/s, est. speed input: 21066.41 toks/s, output: 20.57 toks/s]
Processed prompts:  55%|█████▌    | 2267/4096 [01:50<01:39, 18.39it/s, est. speed input: 21030.21 toks/s, output: 20.54 toks/s]
Processed prompts:  56%|█████▌    | 2299/4096 [01:52<01:37, 18.37it/s, est. speed input: 20995.04 toks/s, output: 20.50 toks/s]
Processed prompts:  57%|█████▋    | 2331/4096 [01:53<01:36, 18.35it/s, est. speed input: 20960.63 toks/s, output: 20.47 toks/s]
Processed prompts:  58%|█████▊    | 2363/4096 [01:55<01:34, 18.35it/s, est. speed input: 20927.53 toks/s, output: 20.44 toks/s]
Processed prompts:  58%|█████▊    | 2395/4096 [01:57<01:32, 18.34it/s, est. speed input: 20895.35 toks/s, output: 20.41 toks/s]
Processed prompts:  59%|█████▉    | 2427/4096 [01:59<01:31, 18.34it/s, est. speed input: 20864.12 toks/s, output: 20.38 toks/s]
Processed prompts:  60%|██████    | 2459/4096 [02:00<01:29, 18.33it/s, est. speed input: 20833.73 toks/s, output: 20.35 toks/s]
Processed prompts:  61%|██████    | 2491/4096 [02:02<01:27, 18.33it/s, est. speed input: 20804.31 toks/s, output: 20.32 toks/s]
Processed prompts:  62%|██████▏   | 2523/4096 [02:04<01:25, 18.33it/s, est. speed input: 20775.73 toks/s, output: 20.29 toks/s]
Processed prompts:  62%|██████▏   | 2555/4096 [02:06<01:24, 18.33it/s, est. speed input: 20748.11 toks/s, output: 20.26 toks/s]
Processed prompts:  63%|██████▎   | 2587/4096 [02:07<01:22, 18.32it/s, est. speed input: 20720.70 toks/s, output: 20.24 toks/s]
Processed prompts:  64%|██████▍   | 2619/4096 [02:09<01:20, 18.32it/s, est. speed input: 20693.98 toks/s, output: 20.21 toks/s]
Processed prompts:  65%|██████▍   | 2651/4096 [02:11<01:18, 18.33it/s, est. speed input: 20668.64 toks/s, output: 20.18 toks/s]
Processed prompts:  66%|██████▌   | 2683/4096 [02:13<01:17, 18.32it/s, est. speed input: 20643.37 toks/s, output: 20.16 toks/s]
Processed prompts:  66%|██████▋   | 2715/4096 [02:14<01:15, 18.32it/s, est. speed input: 20619.00 toks/s, output: 20.14 toks/s]
Processed prompts:  67%|██████▋   | 2747/4096 [02:16<01:13, 18.31it/s, est. speed input: 20594.90 toks/s, output: 20.11 toks/s]
Processed prompts:  68%|██████▊   | 2779/4096 [02:18<01:11, 18.32it/s, est. speed input: 20571.83 toks/s, output: 20.09 toks/s]
Processed prompts:  69%|██████▊   | 2811/4096 [02:20<01:10, 18.32it/s, est. speed input: 20549.15 toks/s, output: 20.07 toks/s]
Processed prompts:  69%|██████▉   | 2843/4096 [02:21<01:08, 18.31it/s, est. speed input: 20526.82 toks/s, output: 20.05 toks/s]
Processed prompts:  70%|███████   | 2875/4096 [02:23<01:06, 18.31it/s, est. speed input: 20505.08 toks/s, output: 20.02 toks/s]
Processed prompts:  71%|███████   | 2907/4096 [02:25<01:04, 18.45it/s, est. speed input: 20490.43 toks/s, output: 20.01 toks/s]
Processed prompts:  72%|███████▏  | 2939/4096 [02:27<01:02, 18.41it/s, est. speed input: 20469.74 toks/s, output: 19.99 toks/s]
Processed prompts:  73%|███████▎  | 2971/4096 [02:28<01:01, 18.38it/s, est. speed input: 20449.41 toks/s, output: 19.97 toks/s]
Processed prompts:  73%|███████▎  | 3003/4096 [02:30<00:59, 18.36it/s, est. speed input: 20429.78 toks/s, output: 19.95 toks/s]
Processed prompts:  74%|███████▍  | 3035/4096 [02:32<00:57, 18.35it/s, est. speed input: 20410.59 toks/s, output: 19.93 toks/s]
Processed prompts:  75%|███████▍  | 3067/4096 [02:34<00:56, 18.32it/s, est. speed input: 20391.26 toks/s, output: 19.91 toks/s]
Processed prompts:  76%|███████▌  | 3099/4096 [02:35<00:54, 18.32it/s, est. speed input: 20372.81 toks/s, output: 19.90 toks/s]
Processed prompts:  76%|███████▋  | 3131/4096 [02:37<00:52, 18.31it/s, est. speed input: 20354.57 toks/s, output: 19.88 toks/s]
Processed prompts:  77%|███████▋  | 3163/4096 [02:39<00:50, 18.30it/s, est. speed input: 20336.66 toks/s, output: 19.86 toks/s]
Processed prompts:  78%|███████▊  | 3195/4096 [02:41<00:49, 18.31it/s, est. speed input: 20319.46 toks/s, output: 19.84 toks/s]
Processed prompts:  79%|███████▉  | 3227/4096 [02:42<00:47, 18.30it/s, est. speed input: 20302.15 toks/s, output: 19.83 toks/s]
Processed prompts:  80%|███████▉  | 3259/4096 [02:44<00:45, 18.30it/s, est. speed input: 20285.61 toks/s, output: 19.81 toks/s]
Processed prompts:  80%|████████  | 3291/4096 [02:46<00:44, 18.29it/s, est. speed input: 20269.13 toks/s, output: 19.79 toks/s]
Processed prompts:  81%|████████  | 3323/4096 [02:48<00:42, 18.29it/s, est. speed input: 20253.13 toks/s, output: 19.78 toks/s]
Processed prompts:  82%|████████▏ | 3355/4096 [02:49<00:40, 18.29it/s, est. speed input: 20237.24 toks/s, output: 19.76 toks/s]
Processed prompts:  83%|████████▎ | 3387/4096 [02:51<00:38, 18.29it/s, est. speed input: 20221.98 toks/s, output: 19.75 toks/s]
Processed prompts:  83%|████████▎ | 3419/4096 [02:53<00:37, 18.30it/s, est. speed input: 20207.12 toks/s, output: 19.73 toks/s]
Processed prompts:  84%|████████▍ | 3451/4096 [02:55<00:35, 18.29it/s, est. speed input: 20192.32 toks/s, output: 19.72 toks/s]
Processed prompts:  85%|████████▌ | 3483/4096 [02:56<00:33, 18.30it/s, est. speed input: 20177.98 toks/s, output: 19.71 toks/s]
Processed prompts:  86%|████████▌ | 3515/4096 [02:58<00:31, 18.30it/s, est. speed input: 20163.81 toks/s, output: 19.69 toks/s]
Processed prompts:  87%|████████▋ | 3547/4096 [03:00<00:30, 18.29it/s, est. speed input: 20149.81 toks/s, output: 19.68 toks/s]
Processed prompts:  87%|████████▋ | 3579/4096 [03:02<00:28, 18.29it/s, est. speed input: 20136.15 toks/s, output: 19.66 toks/s]
Processed prompts:  88%|████████▊ | 3611/4096 [03:03<00:26, 18.29it/s, est. speed input: 20122.74 toks/s, output: 19.65 toks/s]
Processed prompts:  89%|████████▉ | 3643/4096 [03:05<00:24, 18.29it/s, est. speed input: 20109.60 toks/s, output: 19.64 toks/s]
Processed prompts:  90%|████████▉ | 3675/4096 [03:07<00:22, 18.45it/s, est. speed input: 20101.95 toks/s, output: 19.63 toks/s]
Processed prompts:  91%|█████████ | 3707/4096 [03:08<00:21, 18.39it/s, est. speed input: 20089.06 toks/s, output: 19.62 toks/s]
Processed prompts:  91%|█████████▏| 3739/4096 [03:10<00:19, 18.36it/s, est. speed input: 20076.57 toks/s, output: 19.61 toks/s]
Processed prompts:  92%|█████████▏| 3771/4096 [03:12<00:17, 18.33it/s, est. speed input: 20064.09 toks/s, output: 19.59 toks/s]
Processed prompts:  93%|█████████▎| 3803/4096 [03:14<00:15, 18.32it/s, est. speed input: 20052.16 toks/s, output: 19.58 toks/s]
Processed prompts:  94%|█████████▎| 3835/4096 [03:15<00:14, 18.31it/s, est. speed input: 20040.16 toks/s, output: 19.57 toks/s]
Processed prompts:  94%|█████████▍| 3867/4096 [03:17<00:12, 18.30it/s, est. speed input: 20028.49 toks/s, output: 19.56 toks/s]
Processed prompts:  95%|█████████▌| 3899/4096 [03:19<00:10, 18.30it/s, est. speed input: 20017.11 toks/s, output: 19.55 toks/s]
Processed prompts:  96%|█████████▌| 3931/4096 [03:21<00:08, 18.45it/s, est. speed input: 20010.73 toks/s, output: 19.54 toks/s]
Processed prompts:  97%|█████████▋| 3963/4096 [03:22<00:07, 18.40it/s, est. speed input: 19999.53 toks/s, output: 19.53 toks/s]
Processed prompts:  98%|█████████▊| 3995/4096 [03:24<00:05, 18.37it/s, est. speed input: 19988.69 toks/s, output: 19.52 toks/s]
Processed prompts:  98%|█████████▊| 4027/4096 [03:26<00:03, 18.34it/s, est. speed input: 19977.88 toks/s, output: 19.51 toks/s]
Processed prompts:  99%|█████████▉| 4059/4096 [03:28<00:02, 18.33it/s, est. speed input: 19967.70 toks/s, output: 19.50 toks/s]
Processed prompts: 100%|█████████▉| 4091/4096 [03:28<00:00, 24.18it/s, est. speed input: 20092.43 toks/s, output: 19.62 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [03:28<00:00, 24.18it/s, est. speed input: 20116.96 toks/s, output: 19.65 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [03:28<00:00, 19.65it/s, est. speed input: 20116.96 toks/s, output: 19.65 toks/s]
[rank0]:[W125 21:51:51.116883325 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=65536 ==========
Time: 2026-01-25 21:51:53
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=8192, max_num_seqs=64
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 8192 --max-num-seqs 64 --max-model-len 1025 --max-num-batched-tokens 65536 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/Qwen2.5-14B-INT8_M65536.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-25 21:53:00 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=493473) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=493473) WARNING 01-25 21:53:24 [backends.py:609] Failed to read file <frozen os>
Throughput: 18.36 requests/s, 18822.74 total tokens/s, 18.36 output tokens/s
Total num prompt tokens:  8388608
Total num output tokens:  8192

STDERR:
[2026-01-25 21:53:00] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 21:53:00] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-25 21:53:00] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-25 21:53:00] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:53:00] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:53:00] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:53:00] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:53:00] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:53:00] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-25 21:53:00] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 21:53:00] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 21:53:00] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 21:53:00] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 21:53:00] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-25 21:53:07] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-25 21:53:07] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-25 21:53:07] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-25 21:53:07] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:53:07] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:53:07] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:53:07] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:53:07] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-25 21:53:07] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-25 21:53:07] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-25 21:53:07] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-25 21:53:07] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-25 21:53:07] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-25 21:53:07] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=493473) [2026-01-25 21:53:09] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=493473) [2026-01-25 21:53:09] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=493473) [2026-01-25 21:53:09] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=493473) [2026-01-25 21:53:09] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=493473) [2026-01-25 21:53:09] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=493473) [2026-01-25 21:53:09] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=493473) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=493473) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:01,  1.81it/s]
(EngineCore_DP0 pid=493473) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:00<00:00,  2.40it/s]
(EngineCore_DP0 pid=493473) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:01<00:00,  1.96it/s]
(EngineCore_DP0 pid=493473) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.70it/s]
(EngineCore_DP0 pid=493473) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:02<00:00,  1.81it/s]
(EngineCore_DP0 pid=493473) 
(EngineCore_DP0 pid=493473) [2026-01-25 21:53:12] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 5120] -> 1D uint8
(EngineCore_DP0 pid=493473) [2026-01-25 21:53:12] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 27525120 bytes
(EngineCore_DP0 pid=493473) [2026-01-25 21:53:12] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 5120] -> 1D uint8
(EngineCore_DP0 pid=493473) [2026-01-25 21:53:12] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 19660800 bytes
(EngineCore_DP0 pid=493473) [2026-01-25 21:53:12] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 5120] -> 1D uint8
(EngineCore_DP0 pid=493473) [2026-01-25 21:53:12] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 106168320 bytes
(EngineCore_DP0 pid=493473) [2026-01-25 21:53:12] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 13824] -> 1D uint8
(EngineCore_DP0 pid=493473) [2026-01-25 21:53:12] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 53084160 bytes
(EngineCore_DP0 pid=493473) [rank0]:W0125 21:53:38.097000 493473 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=493473) [rank0]:W0125 21:53:38.175000 493473 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=493473) [rank0]:W0125 21:53:39.109000 493473 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=493473) [rank0]:W0125 21:53:39.243000 493473 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=493473) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/19 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   5%|▌         | 1/19 [00:00<00:05,  3.33it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  11%|█         | 2/19 [00:00<00:05,  3.34it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  16%|█▌        | 3/19 [00:00<00:03,  4.23it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  21%|██        | 4/19 [00:00<00:03,  4.90it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  26%|██▋       | 5/19 [00:01<00:02,  5.31it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  32%|███▏      | 6/19 [00:01<00:02,  5.61it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  37%|███▋      | 7/19 [00:01<00:02,  5.92it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  42%|████▏     | 8/19 [00:01<00:01,  6.16it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  47%|████▋     | 9/19 [00:01<00:01,  6.33it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  53%|█████▎    | 10/19 [00:01<00:01,  6.41it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  58%|█████▊    | 11/19 [00:01<00:01,  6.37it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  63%|██████▎   | 12/19 [00:02<00:01,  6.42it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  68%|██████▊   | 13/19 [00:02<00:00,  6.51it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  74%|███████▎  | 14/19 [00:02<00:00,  6.59it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  79%|███████▉  | 15/19 [00:02<00:00,  6.62it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  84%|████████▍ | 16/19 [00:02<00:00,  6.63it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  89%|████████▉ | 17/19 [00:02<00:00,  6.66it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  95%|█████████▍| 18/19 [00:03<00:00,  6.59it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 19/19 [00:03<00:00,  6.35it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 19/19 [00:03<00:00,  5.91it/s]
(EngineCore_DP0 pid=493473) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):   9%|▉         | 1/11 [00:00<00:01,  6.10it/s]
Capturing CUDA graphs (decode, FULL):  18%|█▊        | 2/11 [00:00<00:01,  6.50it/s]
Capturing CUDA graphs (decode, FULL):  27%|██▋       | 3/11 [00:00<00:01,  6.49it/s]
Capturing CUDA graphs (decode, FULL):  36%|███▋      | 4/11 [00:00<00:01,  6.37it/s]
Capturing CUDA graphs (decode, FULL):  45%|████▌     | 5/11 [00:00<00:01,  4.45it/s]
Capturing CUDA graphs (decode, FULL):  55%|█████▍    | 6/11 [00:01<00:00,  5.04it/s]
Capturing CUDA graphs (decode, FULL):  64%|██████▎   | 7/11 [00:01<00:00,  5.53it/s]
Capturing CUDA graphs (decode, FULL):  73%|███████▎  | 8/11 [00:01<00:00,  5.77it/s]
Capturing CUDA graphs (decode, FULL):  82%|████████▏ | 9/11 [00:01<00:00,  6.02it/s]
Capturing CUDA graphs (decode, FULL):  91%|█████████ | 10/11 [00:01<00:00,  6.17it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 11/11 [00:01<00:00,  6.34it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 11/11 [00:01<00:00,  5.88it/s]

Adding requests:   0%|          | 0/8192 [00:00<?, ?it/s]
Adding requests:   0%|          | 26/8192 [00:00<00:31, 257.19it/s]
Adding requests:   1%|          | 52/8192 [00:00<00:32, 253.54it/s]
Adding requests:   1%|          | 79/8192 [00:00<00:31, 260.91it/s]
Adding requests:   1%|▏         | 106/8192 [00:00<00:31, 259.74it/s]
Adding requests:   2%|▏         | 133/8192 [00:00<00:30, 263.18it/s]
Adding requests:   2%|▏         | 160/8192 [00:00<00:30, 262.47it/s]
Adding requests:   2%|▏         | 190/8192 [00:00<00:29, 273.97it/s]
Adding requests:   3%|▎         | 220/8192 [00:00<00:28, 280.60it/s]
Adding requests:   3%|▎         | 249/8192 [00:00<00:28, 279.67it/s]
Adding requests:   3%|▎         | 277/8192 [00:01<00:29, 272.28it/s]
Adding requests:   4%|▎         | 305/8192 [00:01<00:29, 269.62it/s]
Adding requests:   4%|▍         | 335/8192 [00:01<00:28, 276.48it/s]
Adding requests:   4%|▍         | 363/8192 [00:01<00:28, 276.14it/s]
Adding requests:   5%|▍         | 393/8192 [00:01<00:27, 281.59it/s]
Adding requests:   5%|▌         | 425/8192 [00:01<00:26, 289.62it/s]
Adding requests:   6%|▌         | 454/8192 [00:01<00:27, 280.71it/s]
Adding requests:   6%|▌         | 483/8192 [00:01<00:27, 280.75it/s]
Adding requests:   6%|▋         | 513/8192 [00:01<00:27, 284.17it/s]
Adding requests:   7%|▋         | 544/8192 [00:01<00:26, 290.84it/s]
Adding requests:   7%|▋         | 574/8192 [00:02<00:25, 293.39it/s]
Adding requests:   7%|▋         | 604/8192 [00:02<00:26, 284.74it/s]
Adding requests:   8%|▊         | 633/8192 [00:02<00:26, 284.98it/s]
Adding requests:   8%|▊         | 662/8192 [00:02<00:27, 278.66it/s]
Adding requests:   8%|▊         | 693/8192 [00:02<00:26, 285.84it/s]
Adding requests:   9%|▉         | 722/8192 [00:02<00:26, 282.25it/s]
Adding requests:   9%|▉         | 751/8192 [00:02<00:27, 272.94it/s]
Adding requests:  10%|▉         | 781/8192 [00:02<00:26, 277.58it/s]
Adding requests:  10%|▉         | 810/8192 [00:02<00:26, 278.03it/s]
Adding requests:  10%|█         | 841/8192 [00:03<00:25, 286.07it/s]
Adding requests:  11%|█         | 872/8192 [00:03<00:24, 292.95it/s]
Adding requests:  11%|█         | 902/8192 [00:03<00:24, 293.34it/s]
Adding requests:  11%|█▏        | 932/8192 [00:03<00:25, 282.37it/s]
Adding requests:  12%|█▏        | 961/8192 [00:03<00:25, 278.87it/s]
Adding requests:  12%|█▏        | 989/8192 [00:03<00:25, 278.60it/s]
Adding requests:  12%|█▏        | 1017/8192 [00:03<00:25, 278.35it/s]
Adding requests:  13%|█▎        | 1045/8192 [00:03<00:25, 277.01it/s]
Adding requests:  13%|█▎        | 1074/8192 [00:03<00:25, 278.53it/s]
Adding requests:  13%|█▎        | 1103/8192 [00:03<00:25, 280.28it/s]
Adding requests:  14%|█▍        | 1132/8192 [00:04<00:24, 282.95it/s]
Adding requests:  14%|█▍        | 1161/8192 [00:04<00:25, 277.01it/s]
Adding requests:  15%|█▍        | 1193/8192 [00:04<00:24, 286.36it/s]
Adding requests:  15%|█▍        | 1225/8192 [00:04<00:23, 293.77it/s]
Adding requests:  15%|█▌        | 1256/8192 [00:04<00:23, 294.89it/s]
Adding requests:  16%|█▌        | 1286/8192 [00:04<00:23, 291.37it/s]
Adding requests:  16%|█▌        | 1316/8192 [00:04<00:23, 287.83it/s]
Adding requests:  16%|█▋        | 1345/8192 [00:04<00:24, 280.38it/s]
Adding requests:  17%|█▋        | 1375/8192 [00:04<00:23, 284.85it/s]
Adding requests:  17%|█▋        | 1404/8192 [00:05<00:24, 278.65it/s]
Adding requests:  17%|█▋        | 1432/8192 [00:05<00:24, 277.95it/s]
Adding requests:  18%|█▊        | 1462/8192 [00:05<00:23, 284.18it/s]
Adding requests:  18%|█▊        | 1491/8192 [00:05<00:23, 285.78it/s]
Adding requests:  19%|█▊        | 1521/8192 [00:05<00:23, 288.70it/s]
Adding requests:  19%|█▉        | 1550/8192 [00:05<00:23, 285.01it/s]
Adding requests:  19%|█▉        | 1579/8192 [00:05<00:23, 280.05it/s]
Adding requests:  20%|█▉        | 1608/8192 [00:05<00:23, 280.45it/s]
Adding requests:  20%|█▉        | 1637/8192 [00:05<00:24, 270.58it/s]
Adding requests:  20%|██        | 1665/8192 [00:05<00:24, 266.13it/s]
Adding requests:  21%|██        | 1693/8192 [00:06<00:24, 268.78it/s]
Adding requests:  21%|██        | 1723/8192 [00:06<00:23, 276.00it/s]
Adding requests:  21%|██▏       | 1754/8192 [00:06<00:22, 285.84it/s]
Adding requests:  22%|██▏       | 1784/8192 [00:06<00:22, 287.17it/s]
Adding requests:  22%|██▏       | 1813/8192 [00:06<00:22, 278.04it/s]
Adding requests:  22%|██▏       | 1842/8192 [00:06<00:22, 279.34it/s]
Adding requests:  23%|██▎       | 1873/8192 [00:06<00:22, 286.30it/s]
Adding requests:  23%|██▎       | 1902/8192 [00:06<00:22, 283.80it/s]
Adding requests:  24%|██▎       | 1931/8192 [00:06<00:22, 282.03it/s]
Adding requests:  24%|██▍       | 1960/8192 [00:06<00:21, 284.21it/s]
Adding requests:  24%|██▍       | 1989/8192 [00:07<00:21, 283.60it/s]
Adding requests:  25%|██▍       | 2018/8192 [00:07<00:22, 278.97it/s]
Adding requests:  25%|██▌       | 2048/8192 [00:07<00:21, 284.38it/s]
Adding requests:  25%|██▌       | 2077/8192 [00:07<00:22, 273.78it/s]
Adding requests:  26%|██▌       | 2109/8192 [00:07<00:21, 284.99it/s]
Adding requests:  26%|██▌       | 2138/8192 [00:07<00:21, 284.24it/s]
Adding requests:  26%|██▋       | 2167/8192 [00:07<00:21, 284.71it/s]
Adding requests:  27%|██▋       | 2196/8192 [00:07<00:21, 284.75it/s]
Adding requests:  27%|██▋       | 2225/8192 [00:07<00:21, 280.55it/s]
Adding requests:  28%|██▊       | 2256/8192 [00:08<00:20, 288.26it/s]
Adding requests:  28%|██▊       | 2286/8192 [00:08<00:20, 290.04it/s]
Adding requests:  28%|██▊       | 2316/8192 [00:08<00:20, 288.59it/s]
Adding requests:  29%|██▊       | 2346/8192 [00:08<00:20, 291.35it/s]
Adding requests:  29%|██▉       | 2376/8192 [00:08<00:20, 288.50it/s]
Adding requests:  29%|██▉       | 2408/8192 [00:08<00:19, 296.02it/s]
Adding requests:  30%|██▉       | 2439/8192 [00:08<00:19, 298.34it/s]
Adding requests:  30%|███       | 2469/8192 [00:08<00:19, 295.16it/s]
Adding requests:  31%|███       | 2501/8192 [00:08<00:18, 300.98it/s]
Adding requests:  31%|███       | 2532/8192 [00:08<00:19, 296.98it/s]
Adding requests:  31%|███▏      | 2563/8192 [00:09<00:18, 298.84it/s]
Adding requests:  32%|███▏      | 2595/8192 [00:09<00:18, 302.05it/s]
Adding requests:  32%|███▏      | 2626/8192 [00:09<00:18, 298.83it/s]
Adding requests:  32%|███▏      | 2656/8192 [00:09<00:18, 294.52it/s]
Adding requests:  33%|███▎      | 2686/8192 [00:09<00:18, 292.61it/s]
Adding requests:  33%|███▎      | 2716/8192 [00:09<00:19, 283.99it/s]
Adding requests:  34%|███▎      | 2746/8192 [00:09<00:18, 287.13it/s]
Adding requests:  34%|███▍      | 2777/8192 [00:09<00:18, 292.72it/s]
Adding requests:  34%|███▍      | 2810/8192 [00:09<00:17, 303.15it/s]
Adding requests:  35%|███▍      | 2841/8192 [00:10<00:18, 296.16it/s]
Adding requests:  35%|███▌      | 2871/8192 [00:10<00:18, 294.32it/s]
Adding requests:  35%|███▌      | 2902/8192 [00:10<00:17, 297.79it/s]
Adding requests:  36%|███▌      | 2932/8192 [00:10<00:17, 294.47it/s]
Adding requests:  36%|███▌      | 2962/8192 [00:10<00:17, 295.96it/s]
Adding requests:  37%|███▋      | 2992/8192 [00:10<00:17, 294.58it/s]
Adding requests:  37%|███▋      | 3024/8192 [00:10<00:17, 301.61it/s]
Adding requests:  37%|███▋      | 3057/8192 [00:10<00:16, 306.99it/s]
Adding requests:  38%|███▊      | 3088/8192 [00:10<00:16, 305.55it/s]
Adding requests:  38%|███▊      | 3121/8192 [00:10<00:16, 310.57it/s]
Adding requests:  38%|███▊      | 3153/8192 [00:11<00:17, 295.68it/s]
Adding requests:  39%|███▉      | 3183/8192 [00:11<00:17, 292.70it/s]
Adding requests:  39%|███▉      | 3213/8192 [00:11<00:17, 291.72it/s]
Adding requests:  40%|███▉      | 3243/8192 [00:11<00:17, 285.70it/s]
Adding requests:  40%|███▉      | 3272/8192 [00:11<00:17, 285.01it/s]
Adding requests:  40%|████      | 3301/8192 [00:11<00:17, 282.67it/s]
Adding requests:  41%|████      | 3330/8192 [00:11<00:17, 283.99it/s]
Adding requests:  41%|████      | 3361/8192 [00:11<00:16, 290.57it/s]
Adding requests:  41%|████▏     | 3391/8192 [00:11<00:16, 292.45it/s]
Adding requests:  42%|████▏     | 3421/8192 [00:11<00:16, 293.08it/s]
Adding requests:  42%|████▏     | 3451/8192 [00:12<00:16, 293.06it/s]
Adding requests:  43%|████▎     | 3482/8192 [00:12<00:15, 295.22it/s]
Adding requests:  43%|████▎     | 3513/8192 [00:12<00:15, 297.08it/s]
Adding requests:  43%|████▎     | 3545/8192 [00:12<00:15, 303.48it/s]
Adding requests:  44%|████▎     | 3576/8192 [00:12<00:15, 302.50it/s]
Adding requests:  44%|████▍     | 3607/8192 [00:12<00:15, 301.51it/s]
Adding requests:  44%|████▍     | 3638/8192 [00:12<00:15, 298.67it/s]
Adding requests:  45%|████▍     | 3668/8192 [00:12<00:15, 289.00it/s]
Adding requests:  45%|████▌     | 3697/8192 [00:12<00:15, 286.44it/s]
Adding requests:  46%|████▌     | 3728/8192 [00:13<00:15, 291.92it/s]
Adding requests:  46%|████▌     | 3758/8192 [00:13<00:15, 282.04it/s]
Adding requests:  46%|████▌     | 3787/8192 [00:13<00:16, 271.34it/s]
Adding requests:  47%|████▋     | 3815/8192 [00:13<00:16, 266.32it/s]
Adding requests:  47%|████▋     | 3846/8192 [00:13<00:15, 276.80it/s]
Adding requests:  47%|████▋     | 3877/8192 [00:13<00:15, 285.11it/s]
Adding requests:  48%|████▊     | 3906/8192 [00:13<00:15, 284.44it/s]
Adding requests:  48%|████▊     | 3935/8192 [00:13<00:15, 281.07it/s]
Adding requests:  48%|████▊     | 3966/8192 [00:13<00:14, 286.69it/s]
Adding requests:  49%|████▉     | 3996/8192 [00:13<00:14, 288.23it/s]
Adding requests:  49%|████▉     | 4026/8192 [00:14<00:14, 289.02it/s]
Adding requests:  49%|████▉     | 4055/8192 [00:14<00:14, 283.33it/s]
Adding requests:  50%|████▉     | 4085/8192 [00:14<00:14, 287.23it/s]
Adding requests:  50%|█████     | 4115/8192 [00:14<00:14, 289.70it/s]
Adding requests:  51%|█████     | 4144/8192 [00:14<00:14, 288.86it/s]
Adding requests:  51%|█████     | 4176/8192 [00:14<00:13, 297.88it/s]
Adding requests:  51%|█████▏    | 4206/8192 [00:14<00:13, 293.72it/s]
Adding requests:  52%|█████▏    | 4237/8192 [00:14<00:13, 297.87it/s]
Adding requests:  52%|█████▏    | 4267/8192 [00:14<00:13, 295.37it/s]
Adding requests:  52%|█████▏    | 4297/8192 [00:15<00:13, 295.83it/s]
Adding requests:  53%|█████▎    | 4327/8192 [00:15<00:13, 293.92it/s]
Adding requests:  53%|█████▎    | 4357/8192 [00:15<00:13, 288.10it/s]
Adding requests:  54%|█████▎    | 4386/8192 [00:15<00:13, 280.99it/s]
Adding requests:  54%|█████▍    | 4416/8192 [00:15<00:13, 286.31it/s]
Adding requests:  54%|█████▍    | 4447/8192 [00:15<00:12, 290.60it/s]
Adding requests:  55%|█████▍    | 4479/8192 [00:15<00:12, 296.61it/s]
Adding requests:  55%|█████▌    | 4509/8192 [00:15<00:12, 296.09it/s]
Adding requests:  55%|█████▌    | 4539/8192 [00:15<00:12, 291.00it/s]
Adding requests:  56%|█████▌    | 4569/8192 [00:15<00:12, 280.13it/s]
Adding requests:  56%|█████▌    | 4598/8192 [00:16<00:12, 277.16it/s]
Adding requests:  56%|█████▋    | 4627/8192 [00:16<00:12, 280.47it/s]
Adding requests:  57%|█████▋    | 4656/8192 [00:16<00:12, 273.87it/s]
Adding requests:  57%|█████▋    | 4684/8192 [00:16<00:13, 268.90it/s]
Adding requests:  58%|█████▊    | 4712/8192 [00:16<00:12, 270.92it/s]
Adding requests:  58%|█████▊    | 4743/8192 [00:16<00:12, 281.76it/s]
Adding requests:  58%|█████▊    | 4774/8192 [00:16<00:11, 288.72it/s]
Adding requests:  59%|█████▊    | 4803/8192 [00:16<00:11, 283.69it/s]
Adding requests:  59%|█████▉    | 4832/8192 [00:16<00:12, 279.19it/s]
Adding requests:  59%|█████▉    | 4860/8192 [00:17<00:12, 275.00it/s]
Adding requests:  60%|█████▉    | 4890/8192 [00:17<00:11, 281.68it/s]
Adding requests:  60%|██████    | 4920/8192 [00:17<00:11, 284.82it/s]
Adding requests:  60%|██████    | 4949/8192 [00:17<00:11, 284.78it/s]
Adding requests:  61%|██████    | 4978/8192 [00:17<00:11, 283.71it/s]
Adding requests:  61%|██████    | 5008/8192 [00:17<00:11, 287.56it/s]
Adding requests:  62%|██████▏   | 5041/8192 [00:17<00:10, 297.63it/s]
Adding requests:  62%|██████▏   | 5072/8192 [00:17<00:10, 298.42it/s]
Adding requests:  62%|██████▏   | 5102/8192 [00:17<00:10, 298.37it/s]
Adding requests:  63%|██████▎   | 5134/8192 [00:17<00:10, 302.33it/s]
Adding requests:  63%|██████▎   | 5165/8192 [00:18<00:10, 297.86it/s]
Adding requests:  63%|██████▎   | 5195/8192 [00:18<00:10, 296.19it/s]
Adding requests:  64%|██████▍   | 5227/8192 [00:18<00:09, 300.06it/s]
Adding requests:  64%|██████▍   | 5258/8192 [00:18<00:10, 288.10it/s]
Adding requests:  65%|██████▍   | 5287/8192 [00:18<00:10, 285.57it/s]
Adding requests:  65%|██████▍   | 5316/8192 [00:18<00:10, 281.54it/s]
Adding requests:  65%|██████▌   | 5348/8192 [00:18<00:09, 290.69it/s]
Adding requests:  66%|██████▌   | 5378/8192 [00:18<00:09, 292.99it/s]
Adding requests:  66%|██████▌   | 5408/8192 [00:18<00:09, 287.13it/s]
Adding requests:  66%|██████▋   | 5437/8192 [00:18<00:09, 282.46it/s]
Adding requests:  67%|██████▋   | 5468/8192 [00:19<00:09, 289.00it/s]
Adding requests:  67%|██████▋   | 5500/8192 [00:19<00:09, 293.91it/s]
Adding requests:  68%|██████▊   | 5530/8192 [00:19<00:09, 292.79it/s]
Adding requests:  68%|██████▊   | 5560/8192 [00:19<00:09, 287.65it/s]
Adding requests:  68%|██████▊   | 5589/8192 [00:19<00:09, 284.16it/s]
Adding requests:  69%|██████▊   | 5618/8192 [00:19<00:09, 283.89it/s]
Adding requests:  69%|██████▉   | 5649/8192 [00:19<00:08, 290.80it/s]
Adding requests:  69%|██████▉   | 5680/8192 [00:19<00:08, 295.06it/s]
Adding requests:  70%|██████▉   | 5710/8192 [00:19<00:08, 295.42it/s]
Adding requests:  70%|███████   | 5740/8192 [00:20<00:08, 291.37it/s]
Adding requests:  70%|███████   | 5770/8192 [00:20<00:08, 292.19it/s]
Adding requests:  71%|███████   | 5800/8192 [00:20<00:08, 292.59it/s]
Adding requests:  71%|███████   | 5830/8192 [00:20<00:08, 289.79it/s]
Adding requests:  72%|███████▏  | 5859/8192 [00:20<00:08, 285.61it/s]
Adding requests:  72%|███████▏  | 5891/8192 [00:20<00:07, 295.05it/s]
Adding requests:  72%|███████▏  | 5922/8192 [00:20<00:07, 297.98it/s]
Adding requests:  73%|███████▎  | 5954/8192 [00:20<00:07, 303.85it/s]
Adding requests:  73%|███████▎  | 5985/8192 [00:20<00:07, 297.40it/s]
Adding requests:  73%|███████▎  | 6015/8192 [00:20<00:07, 296.21it/s]
Adding requests:  74%|███████▍  | 6045/8192 [00:21<00:07, 294.18it/s]
Adding requests:  74%|███████▍  | 6075/8192 [00:21<00:07, 295.70it/s]
Adding requests:  75%|███████▍  | 6105/8192 [00:21<00:07, 289.89it/s]
Adding requests:  75%|███████▍  | 6135/8192 [00:21<00:07, 288.73it/s]
Adding requests:  75%|███████▌  | 6164/8192 [00:21<00:07, 288.03it/s]
Adding requests:  76%|███████▌  | 6193/8192 [00:21<00:07, 279.45it/s]
Adding requests:  76%|███████▌  | 6222/8192 [00:21<00:06, 282.11it/s]
Adding requests:  76%|███████▋  | 6251/8192 [00:21<00:06, 281.09it/s]
Adding requests:  77%|███████▋  | 6281/8192 [00:21<00:06, 284.51it/s]
Adding requests:  77%|███████▋  | 6310/8192 [00:21<00:06, 284.22it/s]
Adding requests:  77%|███████▋  | 6339/8192 [00:22<00:06, 284.49it/s]
Adding requests:  78%|███████▊  | 6369/8192 [00:22<00:06, 287.25it/s]
Adding requests:  78%|███████▊  | 6398/8192 [00:22<00:06, 278.66it/s]
Adding requests:  78%|███████▊  | 6426/8192 [00:22<00:06, 274.95it/s]
Adding requests:  79%|███████▉  | 6454/8192 [00:22<00:06, 275.23it/s]
Adding requests:  79%|███████▉  | 6483/8192 [00:22<00:06, 277.18it/s]
Adding requests:  80%|███████▉  | 6513/8192 [00:22<00:05, 283.76it/s]
Adding requests:  80%|███████▉  | 6543/8192 [00:22<00:05, 288.33it/s]
Adding requests:  80%|████████  | 6574/8192 [00:22<00:05, 293.25it/s]
Adding requests:  81%|████████  | 6604/8192 [00:23<00:05, 291.18it/s]
Adding requests:  81%|████████  | 6636/8192 [00:23<00:05, 299.19it/s]
Adding requests:  81%|████████▏ | 6666/8192 [00:23<00:05, 299.26it/s]
Adding requests:  82%|████████▏ | 6696/8192 [00:23<00:05, 293.12it/s]
Adding requests:  82%|████████▏ | 6726/8192 [00:23<00:05, 291.46it/s]
Adding requests:  82%|████████▏ | 6757/8192 [00:23<00:04, 293.85it/s]
Adding requests:  83%|████████▎ | 6787/8192 [00:23<00:04, 288.52it/s]
Adding requests:  83%|████████▎ | 6816/8192 [00:23<00:04, 287.07it/s]
Adding requests:  84%|████████▎ | 6846/8192 [00:23<00:04, 287.90it/s]
Adding requests:  84%|████████▍ | 6878/8192 [00:23<00:04, 295.55it/s]
Adding requests:  84%|████████▍ | 6908/8192 [00:24<00:04, 293.96it/s]
Adding requests:  85%|████████▍ | 6941/8192 [00:24<00:04, 302.04it/s]
Adding requests:  85%|████████▌ | 6972/8192 [00:24<00:04, 299.13it/s]
Adding requests:  85%|████████▌ | 7004/8192 [00:24<00:03, 303.40it/s]
Adding requests:  86%|████████▌ | 7035/8192 [00:24<00:03, 303.17it/s]
Adding requests:  86%|████████▋ | 7066/8192 [00:24<00:03, 293.85it/s]
Adding requests:  87%|████████▋ | 7096/8192 [00:24<00:03, 293.02it/s]
Adding requests:  87%|████████▋ | 7126/8192 [00:24<00:03, 294.54it/s]
Adding requests:  87%|████████▋ | 7156/8192 [00:24<00:03, 294.18it/s]
Adding requests:  88%|████████▊ | 7189/8192 [00:24<00:03, 304.15it/s]
Adding requests:  88%|████████▊ | 7222/8192 [00:25<00:03, 308.57it/s]
Adding requests:  89%|████████▊ | 7253/8192 [00:25<00:03, 299.50it/s]
Adding requests:  89%|████████▉ | 7284/8192 [00:25<00:03, 294.89it/s]
Adding requests:  89%|████████▉ | 7314/8192 [00:25<00:03, 290.04it/s]
Adding requests:  90%|████████▉ | 7344/8192 [00:25<00:02, 285.97it/s]
Adding requests:  90%|█████████ | 7373/8192 [00:25<00:02, 286.86it/s]
Adding requests:  90%|█████████ | 7402/8192 [00:25<00:02, 282.01it/s]
Adding requests:  91%|█████████ | 7433/8192 [00:25<00:02, 287.64it/s]
Adding requests:  91%|█████████ | 7462/8192 [00:25<00:02, 286.94it/s]
Adding requests:  91%|█████████▏| 7491/8192 [00:26<00:02, 284.20it/s]
Adding requests:  92%|█████████▏| 7521/8192 [00:26<00:02, 286.16it/s]
Adding requests:  92%|█████████▏| 7550/8192 [00:26<00:02, 286.71it/s]
Adding requests:  93%|█████████▎| 7579/8192 [00:26<00:02, 285.38it/s]
Adding requests:  93%|█████████▎| 7608/8192 [00:26<00:02, 280.36it/s]
Adding requests:  93%|█████████▎| 7637/8192 [00:26<00:01, 282.20it/s]
Adding requests:  94%|█████████▎| 7668/8192 [00:26<00:01, 289.90it/s]
Adding requests:  94%|█████████▍| 7698/8192 [00:26<00:01, 292.76it/s]
Adding requests:  94%|█████████▍| 7729/8192 [00:26<00:01, 297.69it/s]
Adding requests:  95%|█████████▍| 7759/8192 [00:26<00:01, 288.60it/s]
Adding requests:  95%|█████████▌| 7788/8192 [00:27<00:01, 284.20it/s]
Adding requests:  95%|█████████▌| 7818/8192 [00:27<00:01, 288.73it/s]
Adding requests:  96%|█████████▌| 7847/8192 [00:27<00:01, 287.45it/s]
Adding requests:  96%|█████████▌| 7876/8192 [00:27<00:01, 280.60it/s]
Adding requests:  96%|█████████▋| 7905/8192 [00:27<00:01, 281.72it/s]
Adding requests:  97%|█████████▋| 7936/8192 [00:27<00:00, 287.17it/s]
Adding requests:  97%|█████████▋| 7965/8192 [00:27<00:00, 287.43it/s]
Adding requests:  98%|█████████▊| 7996/8192 [00:27<00:00, 291.63it/s]
Adding requests:  98%|█████████▊| 8026/8192 [00:27<00:00, 287.93it/s]
Adding requests:  98%|█████████▊| 8055/8192 [00:28<00:00, 286.28it/s]
Adding requests:  99%|█████████▊| 8087/8192 [00:28<00:00, 293.83it/s]
Adding requests:  99%|█████████▉| 8117/8192 [00:28<00:00, 291.00it/s]
Adding requests:  99%|█████████▉| 8147/8192 [00:28<00:00, 283.80it/s]
Adding requests: 100%|█████████▉| 8176/8192 [00:28<00:00, 278.63it/s]
Adding requests: 100%|██████████| 8192/8192 [00:28<00:00, 287.43it/s]

Processed prompts:   0%|          | 0/8192 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▌         | 475/8192 [00:00<00:06, 1240.96it/s, est. speed input: 1270839.70 toks/s, output: 1240.98 toks/s]
Processed prompts:   7%|▋         | 600/8192 [00:03<01:01, 123.00it/s, est. speed input: 160232.69 toks/s, output: 156.48 toks/s]   
Processed prompts:   8%|▊         | 654/8192 [00:07<02:02, 61.76it/s, est. speed input: 91854.52 toks/s, output: 89.70 toks/s]   
Processed prompts:   8%|▊         | 684/8192 [00:10<03:17, 37.93it/s, est. speed input: 65171.50 toks/s, output: 63.64 toks/s]
Processed prompts:   9%|▉         | 731/8192 [00:14<04:21, 28.56it/s, est. speed input: 52866.18 toks/s, output: 51.63 toks/s]
Processed prompts:  10%|▉         | 795/8192 [00:17<04:56, 24.93it/s, est. speed input: 46191.03 toks/s, output: 45.11 toks/s]
Processed prompts:  10%|█         | 859/8192 [00:21<05:22, 22.73it/s, est. speed input: 41703.06 toks/s, output: 40.73 toks/s]
Processed prompts:  11%|█▏        | 923/8192 [00:24<05:40, 21.33it/s, est. speed input: 38479.99 toks/s, output: 37.58 toks/s]
Processed prompts:  12%|█▏        | 987/8192 [00:28<05:53, 20.41it/s, est. speed input: 36051.06 toks/s, output: 35.21 toks/s]
Processed prompts:  13%|█▎        | 1051/8192 [00:31<06:01, 19.78it/s, est. speed input: 34151.87 toks/s, output: 33.35 toks/s]
Processed prompts:  14%|█▎        | 1115/8192 [00:34<06:05, 19.35it/s, est. speed input: 32629.52 toks/s, output: 31.86 toks/s]
Processed prompts:  14%|█▍        | 1179/8192 [00:38<06:07, 19.09it/s, est. speed input: 31395.52 toks/s, output: 30.66 toks/s]
Processed prompts:  15%|█▌        | 1243/8192 [00:41<06:07, 18.90it/s, est. speed input: 30364.28 toks/s, output: 29.65 toks/s]
Processed prompts:  16%|█▌        | 1307/8192 [00:45<06:06, 18.76it/s, est. speed input: 29487.74 toks/s, output: 28.80 toks/s]
Processed prompts:  17%|█▋        | 1371/8192 [00:48<06:05, 18.67it/s, est. speed input: 28735.70 toks/s, output: 28.06 toks/s]
Processed prompts:  18%|█▊        | 1435/8192 [00:52<06:03, 18.60it/s, est. speed input: 28082.28 toks/s, output: 27.42 toks/s]
Processed prompts:  18%|█▊        | 1499/8192 [00:55<06:00, 18.54it/s, est. speed input: 27506.55 toks/s, output: 26.86 toks/s]
Processed prompts:  19%|█▉        | 1563/8192 [00:59<05:56, 18.58it/s, est. speed input: 27020.02 toks/s, output: 26.39 toks/s]
Processed prompts:  20%|█▉        | 1627/8192 [01:02<05:52, 18.60it/s, est. speed input: 26586.34 toks/s, output: 25.96 toks/s]
Processed prompts:  21%|██        | 1691/8192 [01:06<05:50, 18.54it/s, est. speed input: 26178.56 toks/s, output: 25.56 toks/s]
Processed prompts:  21%|██▏       | 1755/8192 [01:09<05:48, 18.49it/s, est. speed input: 25810.39 toks/s, output: 25.21 toks/s]
Processed prompts:  22%|██▏       | 1819/8192 [01:13<05:45, 18.46it/s, est. speed input: 25477.39 toks/s, output: 24.88 toks/s]
Processed prompts:  23%|██▎       | 1883/8192 [01:16<05:42, 18.43it/s, est. speed input: 25174.93 toks/s, output: 24.58 toks/s]
Processed prompts:  24%|██▍       | 1947/8192 [01:20<05:39, 18.41it/s, est. speed input: 24896.38 toks/s, output: 24.31 toks/s]
Processed prompts:  25%|██▍       | 2011/8192 [01:23<05:36, 18.39it/s, est. speed input: 24642.65 toks/s, output: 24.07 toks/s]
Processed prompts:  25%|██▌       | 2075/8192 [01:27<05:32, 18.37it/s, est. speed input: 24406.93 toks/s, output: 23.83 toks/s]
Processed prompts:  26%|██▌       | 2139/8192 [01:30<05:28, 18.44it/s, est. speed input: 24202.77 toks/s, output: 23.64 toks/s]
Processed prompts:  27%|██▋       | 2203/8192 [01:33<05:25, 18.41it/s, est. speed input: 24001.59 toks/s, output: 23.44 toks/s]
Processed prompts:  28%|██▊       | 2267/8192 [01:37<05:22, 18.39it/s, est. speed input: 23814.56 toks/s, output: 23.26 toks/s]
Processed prompts:  28%|██▊       | 2331/8192 [01:40<05:19, 18.37it/s, est. speed input: 23639.84 toks/s, output: 23.09 toks/s]
Processed prompts:  29%|██▉       | 2395/8192 [01:44<05:15, 18.35it/s, est. speed input: 23476.34 toks/s, output: 22.93 toks/s]
Processed prompts:  30%|███       | 2459/8192 [01:47<05:12, 18.35it/s, est. speed input: 23324.32 toks/s, output: 22.78 toks/s]
Processed prompts:  31%|███       | 2523/8192 [01:51<05:09, 18.34it/s, est. speed input: 23181.02 toks/s, output: 22.64 toks/s]
Processed prompts:  32%|███▏      | 2587/8192 [01:54<05:05, 18.33it/s, est. speed input: 23046.29 toks/s, output: 22.51 toks/s]
Processed prompts:  32%|███▏      | 2651/8192 [01:58<05:02, 18.32it/s, est. speed input: 22919.56 toks/s, output: 22.38 toks/s]
Processed prompts:  33%|███▎      | 2715/8192 [02:01<04:58, 18.32it/s, est. speed input: 22799.87 toks/s, output: 22.27 toks/s]
Processed prompts:  34%|███▍      | 2779/8192 [02:05<04:55, 18.31it/s, est. speed input: 22686.72 toks/s, output: 22.15 toks/s]
Processed prompts:  35%|███▍      | 2843/8192 [02:08<04:52, 18.31it/s, est. speed input: 22579.16 toks/s, output: 22.05 toks/s]
Processed prompts:  35%|███▌      | 2907/8192 [02:12<04:47, 18.39it/s, est. speed input: 22486.63 toks/s, output: 21.96 toks/s]
Processed prompts:  36%|███▋      | 2971/8192 [02:15<04:44, 18.36it/s, est. speed input: 22389.84 toks/s, output: 21.87 toks/s]
Processed prompts:  37%|███▋      | 3035/8192 [02:19<04:41, 18.33it/s, est. speed input: 22297.68 toks/s, output: 21.78 toks/s]
Processed prompts:  38%|███▊      | 3099/8192 [02:22<04:37, 18.33it/s, est. speed input: 22210.75 toks/s, output: 21.69 toks/s]
Processed prompts:  39%|███▊      | 3163/8192 [02:26<04:34, 18.32it/s, est. speed input: 22127.86 toks/s, output: 21.61 toks/s]
Processed prompts:  39%|███▉      | 3227/8192 [02:29<04:31, 18.31it/s, est. speed input: 22048.57 toks/s, output: 21.53 toks/s]
Processed prompts:  40%|████      | 3291/8192 [02:33<04:27, 18.30it/s, est. speed input: 21972.53 toks/s, output: 21.46 toks/s]
Processed prompts:  41%|████      | 3355/8192 [02:36<04:24, 18.30it/s, est. speed input: 21899.98 toks/s, output: 21.39 toks/s]
Processed prompts:  42%|████▏     | 3419/8192 [02:40<04:20, 18.29it/s, est. speed input: 21830.69 toks/s, output: 21.32 toks/s]
Processed prompts:  43%|████▎     | 3483/8192 [02:43<04:17, 18.29it/s, est. speed input: 21764.16 toks/s, output: 21.25 toks/s]
Processed prompts:  43%|████▎     | 3547/8192 [02:47<04:14, 18.28it/s, est. speed input: 21700.35 toks/s, output: 21.19 toks/s]
Processed prompts:  44%|████▍     | 3611/8192 [02:50<04:10, 18.29it/s, est. speed input: 21639.90 toks/s, output: 21.13 toks/s]
Processed prompts:  45%|████▍     | 3675/8192 [02:54<04:05, 18.37it/s, est. speed input: 21587.67 toks/s, output: 21.08 toks/s]
Processed prompts:  46%|████▌     | 3739/8192 [02:57<04:02, 18.34it/s, est. speed input: 21531.34 toks/s, output: 21.03 toks/s]
Processed prompts:  46%|████▋     | 3803/8192 [03:01<03:59, 18.33it/s, est. speed input: 21477.26 toks/s, output: 20.97 toks/s]
Processed prompts:  47%|████▋     | 3867/8192 [03:04<03:56, 18.32it/s, est. speed input: 21425.38 toks/s, output: 20.92 toks/s]
Processed prompts:  48%|████▊     | 3931/8192 [03:08<03:51, 18.39it/s, est. speed input: 21380.95 toks/s, output: 20.88 toks/s]
Processed prompts:  49%|████▉     | 3995/8192 [03:11<03:48, 18.36it/s, est. speed input: 21332.40 toks/s, output: 20.83 toks/s]
Processed prompts:  50%|████▉     | 4059/8192 [03:15<03:44, 18.42it/s, est. speed input: 21291.19 toks/s, output: 20.79 toks/s]
Processed prompts:  50%|█████     | 4123/8192 [03:18<03:41, 18.38it/s, est. speed input: 21245.95 toks/s, output: 20.75 toks/s]
Processed prompts:  51%|█████     | 4187/8192 [03:22<03:38, 18.35it/s, est. speed input: 21202.42 toks/s, output: 20.71 toks/s]
Processed prompts:  52%|█████▏    | 4251/8192 [03:25<03:34, 18.33it/s, est. speed input: 21160.42 toks/s, output: 20.66 toks/s]
Processed prompts:  53%|█████▎    | 4315/8192 [03:29<03:31, 18.32it/s, est. speed input: 21119.57 toks/s, output: 20.62 toks/s]
Processed prompts:  53%|█████▎    | 4379/8192 [03:32<03:28, 18.31it/s, est. speed input: 21080.19 toks/s, output: 20.59 toks/s]
Processed prompts:  54%|█████▍    | 4443/8192 [03:36<03:24, 18.31it/s, est. speed input: 21042.31 toks/s, output: 20.55 toks/s]
Processed prompts:  55%|█████▌    | 4507/8192 [03:39<03:21, 18.30it/s, est. speed input: 21005.49 toks/s, output: 20.51 toks/s]
Processed prompts:  56%|█████▌    | 4571/8192 [03:43<03:17, 18.30it/s, est. speed input: 20970.11 toks/s, output: 20.48 toks/s]
Processed prompts:  57%|█████▋    | 4635/8192 [03:46<03:14, 18.30it/s, est. speed input: 20935.67 toks/s, output: 20.44 toks/s]
Processed prompts:  57%|█████▋    | 4699/8192 [03:50<03:10, 18.30it/s, est. speed input: 20902.46 toks/s, output: 20.41 toks/s]
Processed prompts:  58%|█████▊    | 4763/8192 [03:53<03:07, 18.30it/s, est. speed input: 20869.82 toks/s, output: 20.38 toks/s]
Processed prompts:  59%|█████▉    | 4827/8192 [03:57<03:03, 18.30it/s, est. speed input: 20838.21 toks/s, output: 20.35 toks/s]
Processed prompts:  60%|█████▉    | 4891/8192 [04:00<03:00, 18.29it/s, est. speed input: 20807.34 toks/s, output: 20.32 toks/s]
Processed prompts:  60%|██████    | 4955/8192 [04:04<02:56, 18.36it/s, est. speed input: 20781.55 toks/s, output: 20.29 toks/s]
Processed prompts:  61%|██████▏   | 5019/8192 [04:07<02:52, 18.34it/s, est. speed input: 20752.69 toks/s, output: 20.27 toks/s]
Processed prompts:  62%|██████▏   | 5083/8192 [04:11<02:49, 18.33it/s, est. speed input: 20724.50 toks/s, output: 20.24 toks/s]
Processed prompts:  63%|██████▎   | 5147/8192 [04:14<02:46, 18.32it/s, est. speed input: 20697.02 toks/s, output: 20.21 toks/s]
Processed prompts:  64%|██████▎   | 5211/8192 [04:18<02:42, 18.31it/s, est. speed input: 20670.50 toks/s, output: 20.19 toks/s]
Processed prompts:  64%|██████▍   | 5275/8192 [04:21<02:39, 18.30it/s, est. speed input: 20644.49 toks/s, output: 20.16 toks/s]
Processed prompts:  65%|██████▌   | 5339/8192 [04:25<02:35, 18.30it/s, est. speed input: 20619.05 toks/s, output: 20.14 toks/s]
Processed prompts:  66%|██████▌   | 5403/8192 [04:28<02:32, 18.29it/s, est. speed input: 20594.27 toks/s, output: 20.11 toks/s]
Processed prompts:  67%|██████▋   | 5467/8192 [04:32<02:28, 18.29it/s, est. speed input: 20570.23 toks/s, output: 20.09 toks/s]
Processed prompts:  68%|██████▊   | 5531/8192 [04:35<02:25, 18.29it/s, est. speed input: 20546.82 toks/s, output: 20.07 toks/s]
Processed prompts:  68%|██████▊   | 5595/8192 [04:39<02:21, 18.29it/s, est. speed input: 20524.26 toks/s, output: 20.04 toks/s]
Processed prompts:  69%|██████▉   | 5659/8192 [04:42<02:18, 18.29it/s, est. speed input: 20501.97 toks/s, output: 20.02 toks/s]
Processed prompts:  70%|██████▉   | 5723/8192 [04:46<02:14, 18.29it/s, est. speed input: 20480.33 toks/s, output: 20.00 toks/s]
Processed prompts:  71%|███████   | 5787/8192 [04:49<02:11, 18.29it/s, est. speed input: 20459.23 toks/s, output: 19.98 toks/s]
Processed prompts:  71%|███████▏  | 5851/8192 [04:53<02:08, 18.29it/s, est. speed input: 20438.41 toks/s, output: 19.96 toks/s]
Processed prompts:  72%|███████▏  | 5915/8192 [04:56<02:03, 18.37it/s, est. speed input: 20421.60 toks/s, output: 19.94 toks/s]
Processed prompts:  73%|███████▎  | 5979/8192 [05:00<02:00, 18.42it/s, est. speed input: 20405.09 toks/s, output: 19.93 toks/s]
Processed prompts:  74%|███████▍  | 6043/8192 [05:03<01:56, 18.38it/s, est. speed input: 20385.82 toks/s, output: 19.91 toks/s]
Processed prompts:  75%|███████▍  | 6107/8192 [05:07<01:53, 18.36it/s, est. speed input: 20367.05 toks/s, output: 19.89 toks/s]
Processed prompts:  75%|███████▌  | 6171/8192 [05:10<01:50, 18.33it/s, est. speed input: 20348.47 toks/s, output: 19.87 toks/s]
Processed prompts:  76%|███████▌  | 6235/8192 [05:14<01:46, 18.31it/s, est. speed input: 20330.07 toks/s, output: 19.85 toks/s]
Processed prompts:  77%|███████▋  | 6299/8192 [05:17<01:43, 18.31it/s, est. speed input: 20312.44 toks/s, output: 19.84 toks/s]
Processed prompts:  78%|███████▊  | 6363/8192 [05:21<01:39, 18.29it/s, est. speed input: 20294.83 toks/s, output: 19.82 toks/s]
Processed prompts:  78%|███████▊  | 6427/8192 [05:24<01:36, 18.29it/s, est. speed input: 20277.95 toks/s, output: 19.80 toks/s]
Processed prompts:  79%|███████▉  | 6491/8192 [05:28<01:32, 18.29it/s, est. speed input: 20261.42 toks/s, output: 19.79 toks/s]
Processed prompts:  80%|████████  | 6555/8192 [05:31<01:29, 18.29it/s, est. speed input: 20245.04 toks/s, output: 19.77 toks/s]
Processed prompts:  81%|████████  | 6619/8192 [05:35<01:26, 18.29it/s, est. speed input: 20229.22 toks/s, output: 19.76 toks/s]
Processed prompts:  82%|████████▏ | 6683/8192 [05:38<01:22, 18.29it/s, est. speed input: 20213.70 toks/s, output: 19.74 toks/s]
Processed prompts:  82%|████████▏ | 6747/8192 [05:42<01:18, 18.29it/s, est. speed input: 20198.62 toks/s, output: 19.73 toks/s]
Processed prompts:  83%|████████▎ | 6811/8192 [05:45<01:15, 18.29it/s, est. speed input: 20183.81 toks/s, output: 19.71 toks/s]
Processed prompts:  84%|████████▍ | 6875/8192 [05:49<01:11, 18.29it/s, est. speed input: 20169.25 toks/s, output: 19.70 toks/s]
Processed prompts:  85%|████████▍ | 6939/8192 [05:52<01:08, 18.29it/s, est. speed input: 20154.99 toks/s, output: 19.68 toks/s]
Processed prompts:  85%|████████▌ | 7003/8192 [05:56<01:04, 18.29it/s, est. speed input: 20141.01 toks/s, output: 19.67 toks/s]
Processed prompts:  86%|████████▋ | 7067/8192 [05:59<01:01, 18.30it/s, est. speed input: 20127.43 toks/s, output: 19.66 toks/s]
Processed prompts:  87%|████████▋ | 7131/8192 [06:03<00:57, 18.30it/s, est. speed input: 20114.10 toks/s, output: 19.64 toks/s]
Processed prompts:  88%|████████▊ | 7195/8192 [06:06<00:54, 18.30it/s, est. speed input: 20101.06 toks/s, output: 19.63 toks/s]
Processed prompts:  89%|████████▊ | 7259/8192 [06:10<00:50, 18.30it/s, est. speed input: 20088.17 toks/s, output: 19.62 toks/s]
Processed prompts:  89%|████████▉ | 7323/8192 [06:13<00:47, 18.30it/s, est. speed input: 20075.44 toks/s, output: 19.60 toks/s]
Processed prompts:  90%|█████████ | 7387/8192 [06:17<00:44, 18.29it/s, est. speed input: 20062.91 toks/s, output: 19.59 toks/s]
Processed prompts:  91%|█████████ | 7451/8192 [06:20<00:40, 18.29it/s, est. speed input: 20050.56 toks/s, output: 19.58 toks/s]
Processed prompts:  92%|█████████▏| 7515/8192 [06:24<00:37, 18.29it/s, est. speed input: 20038.44 toks/s, output: 19.57 toks/s]
Processed prompts:  93%|█████████▎| 7579/8192 [06:27<00:33, 18.29it/s, est. speed input: 20026.71 toks/s, output: 19.56 toks/s]
Processed prompts:  93%|█████████▎| 7643/8192 [06:31<00:30, 18.29it/s, est. speed input: 20015.22 toks/s, output: 19.55 toks/s]
Processed prompts:  94%|█████████▍| 7707/8192 [06:34<00:26, 18.29it/s, est. speed input: 20003.71 toks/s, output: 19.53 toks/s]
Processed prompts:  95%|█████████▍| 7771/8192 [06:38<00:23, 18.29it/s, est. speed input: 19992.36 toks/s, output: 19.52 toks/s]
Processed prompts:  96%|█████████▌| 7835/8192 [06:41<00:19, 18.29it/s, est. speed input: 19981.29 toks/s, output: 19.51 toks/s]
Processed prompts:  96%|█████████▋| 7899/8192 [06:45<00:16, 18.29it/s, est. speed input: 19970.58 toks/s, output: 19.50 toks/s]
Processed prompts:  97%|█████████▋| 7963/8192 [06:48<00:12, 18.29it/s, est. speed input: 19960.02 toks/s, output: 19.49 toks/s]
Processed prompts:  98%|█████████▊| 8027/8192 [06:52<00:09, 18.29it/s, est. speed input: 19949.44 toks/s, output: 19.48 toks/s]
Processed prompts:  99%|█████████▉| 8091/8192 [06:55<00:05, 18.29it/s, est. speed input: 19939.19 toks/s, output: 19.47 toks/s]
Processed prompts: 100%|█████████▉| 8155/8192 [06:57<00:01, 20.84it/s, est. speed input: 19997.26 toks/s, output: 19.53 toks/s]
Processed prompts: 100%|██████████| 8192/8192 [06:57<00:00, 20.84it/s, est. speed input: 20087.96 toks/s, output: 19.62 toks/s]
Processed prompts: 100%|██████████| 8192/8192 [06:57<00:00, 19.62it/s, est. speed input: 20087.96 toks/s, output: 19.62 toks/s]
[rank0]:[W125 22:01:30.526122017 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=65536 ==========
Time: 2026-01-26 02:40:23
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=8192, max_num_seqs=64
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 8192 --max-num-seqs 64 --max-model-len 1025 --max-num-batched-tokens 65536 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/Qwen2.5-7B-INT8_M65536.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 02:41:30 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=748851) ERROR 01-26 02:41:38 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=748851) ERROR 01-26 02:41:38 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=748851) ERROR 01-26 02:41:38 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=748851) ERROR 01-26 02:41:38 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=748851) ERROR 01-26 02:41:38 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=748851) ERROR 01-26 02:41:38 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=748851) ERROR 01-26 02:41:38 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=748851) ERROR 01-26 02:41:38 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 102, in __init__
(EngineCore_DP0 pid=748851) ERROR 01-26 02:41:38 [core.py:866]     self.model_executor = executor_class(vllm_config)
(EngineCore_DP0 pid=748851) ERROR 01-26 02:41:38 [core.py:866]                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=748851) ERROR 01-26 02:41:38 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 101, in __init__
(EngineCore_DP0 pid=748851) ERROR 01-26 02:41:38 [core.py:866]     self._init_executor()
(EngineCore_DP0 pid=748851) ERROR 01-26 02:41:38 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 47, in _init_executor
(EngineCore_DP0 pid=748851) ERROR 01-26 02:41:38 [core.py:866]     self.driver_worker.init_device()
(EngineCore_DP0 pid=748851) ERROR 01-26 02:41:38 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/worker_base.py", line 326, in init_device
(EngineCore_DP0 pid=748851) ERROR 01-26 02:41:38 [core.py:866]     self.worker.init_device()  # type: ignore
(EngineCore_DP0 pid=748851) ERROR 01-26 02:41:38 [core.py:866]     ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=748851) ERROR 01-26 02:41:38 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 247, in init_device
(EngineCore_DP0 pid=748851) ERROR 01-26 02:41:38 [core.py:866]     raise ValueError(
(EngineCore_DP0 pid=748851) ERROR 01-26 02:41:38 [core.py:866] ValueError: Free memory on device (11.35/79.25 GiB) on startup is less than desired GPU memory utilization (0.8, 63.4 GiB). Decrease GPU memory utilization or reduce GPU memory used by other processes.

STDERR:
[2026-01-26 02:41:30] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 02:41:30] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:41:30] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 02:41:30] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:41:30] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:41:30] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:41:30] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:41:30] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:41:30] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:41:30] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 02:41:30] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 02:41:30] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 02:41:30] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 02:41:30] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 02:41:38] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 02:41:38] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:41:38] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 02:41:38] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:41:38] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:41:38] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:41:38] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:41:38] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:41:38] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:41:38] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 02:41:38] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 02:41:38] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 02:41:38] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 02:41:38] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=748851) Process EngineCore_DP0:
(EngineCore_DP0 pid=748851) Traceback (most recent call last):
(EngineCore_DP0 pid=748851)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=748851)     self.run()
(EngineCore_DP0 pid=748851)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=748851)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=748851)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=748851)     raise e
(EngineCore_DP0 pid=748851)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=748851)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=748851)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=748851)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=748851)     super().__init__(
(EngineCore_DP0 pid=748851)   File "/root/vllmbench/vllm/v1/engine/core.py", line 102, in __init__
(EngineCore_DP0 pid=748851)     self.model_executor = executor_class(vllm_config)
(EngineCore_DP0 pid=748851)                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=748851)   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 101, in __init__
(EngineCore_DP0 pid=748851)     self._init_executor()
(EngineCore_DP0 pid=748851)   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 47, in _init_executor
(EngineCore_DP0 pid=748851)     self.driver_worker.init_device()
(EngineCore_DP0 pid=748851)   File "/root/vllmbench/vllm/v1/worker/worker_base.py", line 326, in init_device
(EngineCore_DP0 pid=748851)     self.worker.init_device()  # type: ignore
(EngineCore_DP0 pid=748851)     ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=748851)   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 247, in init_device
(EngineCore_DP0 pid=748851)     raise ValueError(
(EngineCore_DP0 pid=748851) ValueError: Free memory on device (11.35/79.25 GiB) on startup is less than desired GPU memory utilization (0.8, 63.4 GiB). Decrease GPU memory utilization or reduce GPU memory used by other processes.
[rank0]:[W126 02:41:39.703311777 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

ERROR: Test failed for M=65536

========== M=65536 ==========
Time: 2026-01-26 02:41:59
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=8192, max_num_seqs=64
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 8192 --max-num-seqs 64 --max-model-len 1025 --max-num-batched-tokens 65536 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/Qwen2.5-7B-INT8_M65536.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 02:43:07 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=749538) ERROR 01-26 02:43:15 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=749538) ERROR 01-26 02:43:15 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=749538) ERROR 01-26 02:43:15 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=749538) ERROR 01-26 02:43:15 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=749538) ERROR 01-26 02:43:15 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=749538) ERROR 01-26 02:43:15 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=749538) ERROR 01-26 02:43:15 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=749538) ERROR 01-26 02:43:15 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 102, in __init__
(EngineCore_DP0 pid=749538) ERROR 01-26 02:43:15 [core.py:866]     self.model_executor = executor_class(vllm_config)
(EngineCore_DP0 pid=749538) ERROR 01-26 02:43:15 [core.py:866]                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=749538) ERROR 01-26 02:43:15 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 101, in __init__
(EngineCore_DP0 pid=749538) ERROR 01-26 02:43:15 [core.py:866]     self._init_executor()
(EngineCore_DP0 pid=749538) ERROR 01-26 02:43:15 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 47, in _init_executor
(EngineCore_DP0 pid=749538) ERROR 01-26 02:43:15 [core.py:866]     self.driver_worker.init_device()
(EngineCore_DP0 pid=749538) ERROR 01-26 02:43:15 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/worker_base.py", line 326, in init_device
(EngineCore_DP0 pid=749538) ERROR 01-26 02:43:15 [core.py:866]     self.worker.init_device()  # type: ignore
(EngineCore_DP0 pid=749538) ERROR 01-26 02:43:15 [core.py:866]     ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=749538) ERROR 01-26 02:43:15 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 247, in init_device
(EngineCore_DP0 pid=749538) ERROR 01-26 02:43:15 [core.py:866]     raise ValueError(
(EngineCore_DP0 pid=749538) ERROR 01-26 02:43:15 [core.py:866] ValueError: Free memory on device (11.35/79.25 GiB) on startup is less than desired GPU memory utilization (0.8, 63.4 GiB). Decrease GPU memory utilization or reduce GPU memory used by other processes.

STDERR:
[2026-01-26 02:43:07] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 02:43:07] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:43:07] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 02:43:07] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:43:07] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:43:07] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:43:07] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:43:07] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:43:07] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:43:07] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 02:43:07] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 02:43:07] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 02:43:07] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 02:43:07] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 02:43:15] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 02:43:15] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:43:15] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 02:43:15] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:43:15] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:43:15] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:43:15] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:43:15] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:43:15] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:43:15] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 02:43:15] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 02:43:15] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 02:43:15] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 02:43:15] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=749538) Process EngineCore_DP0:
(EngineCore_DP0 pid=749538) Traceback (most recent call last):
(EngineCore_DP0 pid=749538)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=749538)     self.run()
(EngineCore_DP0 pid=749538)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=749538)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=749538)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=749538)     raise e
(EngineCore_DP0 pid=749538)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=749538)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=749538)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=749538)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=749538)     super().__init__(
(EngineCore_DP0 pid=749538)   File "/root/vllmbench/vllm/v1/engine/core.py", line 102, in __init__
(EngineCore_DP0 pid=749538)     self.model_executor = executor_class(vllm_config)
(EngineCore_DP0 pid=749538)                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=749538)   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 101, in __init__
(EngineCore_DP0 pid=749538)     self._init_executor()
(EngineCore_DP0 pid=749538)   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 47, in _init_executor
(EngineCore_DP0 pid=749538)     self.driver_worker.init_device()
(EngineCore_DP0 pid=749538)   File "/root/vllmbench/vllm/v1/worker/worker_base.py", line 326, in init_device
(EngineCore_DP0 pid=749538)     self.worker.init_device()  # type: ignore
(EngineCore_DP0 pid=749538)     ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=749538)   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 247, in init_device
(EngineCore_DP0 pid=749538)     raise ValueError(
(EngineCore_DP0 pid=749538) ValueError: Free memory on device (11.35/79.25 GiB) on startup is less than desired GPU memory utilization (0.8, 63.4 GiB). Decrease GPU memory utilization or reduce GPU memory used by other processes.
[rank0]:[W126 02:43:16.571180965 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

ERROR: Test failed for M=65536

========== M=65536 ==========
Time: 2026-01-26 02:43:36
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=8192, max_num_seqs=64
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 8192 --max-num-seqs 64 --max-model-len 1025 --max-num-batched-tokens 65536 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/Qwen2.5-7B-INT8_M65536.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-26 02:44:40 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=750201) ERROR 01-26 02:44:48 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=750201) ERROR 01-26 02:44:48 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=750201) ERROR 01-26 02:44:48 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=750201) ERROR 01-26 02:44:48 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=750201) ERROR 01-26 02:44:48 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=750201) ERROR 01-26 02:44:48 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=750201) ERROR 01-26 02:44:48 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=750201) ERROR 01-26 02:44:48 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 102, in __init__
(EngineCore_DP0 pid=750201) ERROR 01-26 02:44:48 [core.py:866]     self.model_executor = executor_class(vllm_config)
(EngineCore_DP0 pid=750201) ERROR 01-26 02:44:48 [core.py:866]                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=750201) ERROR 01-26 02:44:48 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 101, in __init__
(EngineCore_DP0 pid=750201) ERROR 01-26 02:44:48 [core.py:866]     self._init_executor()
(EngineCore_DP0 pid=750201) ERROR 01-26 02:44:48 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 47, in _init_executor
(EngineCore_DP0 pid=750201) ERROR 01-26 02:44:48 [core.py:866]     self.driver_worker.init_device()
(EngineCore_DP0 pid=750201) ERROR 01-26 02:44:48 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/worker_base.py", line 326, in init_device
(EngineCore_DP0 pid=750201) ERROR 01-26 02:44:48 [core.py:866]     self.worker.init_device()  # type: ignore
(EngineCore_DP0 pid=750201) ERROR 01-26 02:44:48 [core.py:866]     ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=750201) ERROR 01-26 02:44:48 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 247, in init_device
(EngineCore_DP0 pid=750201) ERROR 01-26 02:44:48 [core.py:866]     raise ValueError(
(EngineCore_DP0 pid=750201) ERROR 01-26 02:44:48 [core.py:866] ValueError: Free memory on device (11.35/79.25 GiB) on startup is less than desired GPU memory utilization (0.8, 63.4 GiB). Decrease GPU memory utilization or reduce GPU memory used by other processes.

STDERR:
[2026-01-26 02:44:40] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 02:44:40] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:44:40] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 02:44:40] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:44:40] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:44:40] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:44:40] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:44:40] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:44:40] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:44:40] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 02:44:40] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 02:44:40] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 02:44:40] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 02:44:40] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 02:44:48] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 02:44:48] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:44:48] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 02:44:48] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:44:48] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:44:48] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:44:48] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:44:48] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:44:48] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:44:48] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 02:44:48] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 02:44:48] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 02:44:48] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 02:44:48] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=750201) Process EngineCore_DP0:
(EngineCore_DP0 pid=750201) Traceback (most recent call last):
(EngineCore_DP0 pid=750201)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=750201)     self.run()
(EngineCore_DP0 pid=750201)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=750201)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=750201)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=750201)     raise e
(EngineCore_DP0 pid=750201)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=750201)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=750201)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=750201)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=750201)     super().__init__(
(EngineCore_DP0 pid=750201)   File "/root/vllmbench/vllm/v1/engine/core.py", line 102, in __init__
(EngineCore_DP0 pid=750201)     self.model_executor = executor_class(vllm_config)
(EngineCore_DP0 pid=750201)                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=750201)   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 101, in __init__
(EngineCore_DP0 pid=750201)     self._init_executor()
(EngineCore_DP0 pid=750201)   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 47, in _init_executor
(EngineCore_DP0 pid=750201)     self.driver_worker.init_device()
(EngineCore_DP0 pid=750201)   File "/root/vllmbench/vllm/v1/worker/worker_base.py", line 326, in init_device
(EngineCore_DP0 pid=750201)     self.worker.init_device()  # type: ignore
(EngineCore_DP0 pid=750201)     ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=750201)   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 247, in init_device
(EngineCore_DP0 pid=750201)     raise ValueError(
(EngineCore_DP0 pid=750201) ValueError: Free memory on device (11.35/79.25 GiB) on startup is less than desired GPU memory utilization (0.8, 63.4 GiB). Decrease GPU memory utilization or reduce GPU memory used by other processes.
[rank0]:[W126 02:44:49.582566904 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

ERROR: Test failed for M=65536

========== M=512 ==========
Time: 2026-01-28 00:03:44
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_4
Params: prompt_len=512, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_4 --dataset-name random --input-len 512 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 513 --max-num-batched-tokens 513 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/BitNet-2B-INT8_M512.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:03:52 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=2215329) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=2215329) WARNING 01-28 00:04:10 [backends.py:609] Failed to read file <frozen os>
Throughput: 18.38 requests/s, 9428.83 total tokens/s, 18.38 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128

STDERR:
[2026-01-28 00:03:51] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:03:51] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:03:51] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:03:51] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:03:51] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:03:51] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:03:51] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:03:51] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:03:51] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:03:51] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:03:52] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:03:52] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:03:52] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:03:52] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:03:59] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:03:59] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:03:59] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:03:59] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:03:59] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:03:59] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:03:59] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:03:59] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:03:59] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:03:59] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:03:59] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:03:59] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:03:59] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:03:59] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=2215329) [2026-01-28 00:04:00] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=2215329) [2026-01-28 00:04:00] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=2215329) [2026-01-28 00:04:00] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=2215329) [2026-01-28 00:04:00] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=2215329) [2026-01-28 00:04:00] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=2215329) [2026-01-28 00:04:00] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=2215329) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=2215329) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.95it/s]
(EngineCore_DP0 pid=2215329) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.95it/s]
(EngineCore_DP0 pid=2215329) 
(EngineCore_DP0 pid=2215329) [2026-01-28 00:04:01] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 2560] -> 1D uint8
(EngineCore_DP0 pid=2215329) [2026-01-28 00:04:01] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7372800 bytes
(EngineCore_DP0 pid=2215329) [2026-01-28 00:04:01] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 2560] -> 1D uint8
(EngineCore_DP0 pid=2215329) [2026-01-28 00:04:01] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4915200 bytes
(EngineCore_DP0 pid=2215329) [2026-01-28 00:04:01] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 2560] -> 1D uint8
(EngineCore_DP0 pid=2215329) [2026-01-28 00:04:01] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 26542080 bytes
(EngineCore_DP0 pid=2215329) [2026-01-28 00:04:01] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 6912] -> 1D uint8
(EngineCore_DP0 pid=2215329) [2026-01-28 00:04:01] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 13271040 bytes
(EngineCore_DP0 pid=2215329) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  1.80it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:01<00:00,  1.70it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:01<00:00,  1.72it/s]
(EngineCore_DP0 pid=2215329) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  8.85it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  8.84it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  49%|████▉     | 63/128 [00:00<00:00, 624.66it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 637.91it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 635.41it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:45,  2.81it/s, est. speed input: 1440.22 toks/s, output: 2.81 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:16,  7.67it/s, est. speed input: 3348.05 toks/s, output: 6.54 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:10, 11.19it/s, est. speed input: 4572.29 toks/s, output: 8.93 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:08, 13.60it/s, est. speed input: 5398.42 toks/s, output: 10.54 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:00<00:07, 15.41it/s, est. speed input: 6023.25 toks/s, output: 11.76 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:00<00:07, 16.55it/s, est. speed input: 6478.46 toks/s, output: 12.65 toks/s]
Processed prompts:  10%|█         | 13/128 [00:00<00:06, 17.51it/s, est. speed input: 6859.87 toks/s, output: 13.40 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:01<00:06, 18.19it/s, est. speed input: 7169.16 toks/s, output: 14.00 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:01<00:05, 18.97it/s, est. speed input: 7557.12 toks/s, output: 14.76 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:01<00:05, 19.41it/s, est. speed input: 7859.20 toks/s, output: 15.35 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:01<00:05, 19.82it/s, est. speed input: 8119.34 toks/s, output: 15.86 toks/s]
Processed prompts:  21%|██        | 27/128 [00:01<00:05, 19.52it/s, est. speed input: 8269.45 toks/s, output: 16.15 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:01<00:04, 19.76it/s, est. speed input: 8441.66 toks/s, output: 16.49 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:01<00:04, 19.75it/s, est. speed input: 8528.82 toks/s, output: 16.66 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:02<00:04, 19.94it/s, est. speed input: 8663.23 toks/s, output: 16.92 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:02<00:04, 19.87it/s, est. speed input: 8728.37 toks/s, output: 17.05 toks/s]
Processed prompts:  30%|███       | 39/128 [00:02<00:04, 19.74it/s, est. speed input: 8782.56 toks/s, output: 17.15 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:02<00:04, 19.75it/s, est. speed input: 8839.71 toks/s, output: 17.26 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:02<00:04, 19.85it/s, est. speed input: 8923.40 toks/s, output: 17.43 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:02<00:04, 19.37it/s, est. speed input: 8938.40 toks/s, output: 17.46 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:02<00:04, 19.44it/s, est. speed input: 8979.49 toks/s, output: 17.54 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:02<00:03, 19.75it/s, est. speed input: 9052.29 toks/s, output: 17.68 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:03<00:03, 19.83it/s, est. speed input: 9110.81 toks/s, output: 17.79 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:03<00:03, 19.49it/s, est. speed input: 9123.50 toks/s, output: 17.82 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:03<00:03, 19.80it/s, est. speed input: 9183.06 toks/s, output: 17.94 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:03<00:03, 20.04it/s, est. speed input: 9239.97 toks/s, output: 18.05 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:03<00:03, 19.98it/s, est. speed input: 9265.12 toks/s, output: 18.10 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:03<00:03, 19.89it/s, est. speed input: 9287.25 toks/s, output: 18.14 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:03<00:03, 19.88it/s, est. speed input: 9310.64 toks/s, output: 18.18 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:03<00:02, 20.06it/s, est. speed input: 9353.59 toks/s, output: 18.27 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:04<00:02, 19.95it/s, est. speed input: 9381.68 toks/s, output: 18.32 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:04<00:02, 20.08it/s, est. speed input: 9418.28 toks/s, output: 18.39 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:04<00:02, 20.03it/s, est. speed input: 9445.41 toks/s, output: 18.45 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:04<00:02, 19.81it/s, est. speed input: 9461.29 toks/s, output: 18.48 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:04<00:02, 19.89it/s, est. speed input: 9487.57 toks/s, output: 18.53 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:04<00:01, 20.01it/s, est. speed input: 9515.32 toks/s, output: 18.58 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:04<00:01, 20.00it/s, est. speed input: 9537.24 toks/s, output: 18.63 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:05<00:01, 20.04it/s, est. speed input: 9559.88 toks/s, output: 18.67 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:05<00:01, 20.11it/s, est. speed input: 9582.78 toks/s, output: 18.72 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:05<00:01, 20.10it/s, est. speed input: 9602.27 toks/s, output: 18.75 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:05<00:01, 20.24it/s, est. speed input: 9626.87 toks/s, output: 18.80 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:05<00:01, 19.75it/s, est. speed input: 9625.42 toks/s, output: 18.80 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:05<00:00, 19.88it/s, est. speed input: 9643.39 toks/s, output: 18.83 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:05<00:00, 19.87it/s, est. speed input: 9652.25 toks/s, output: 18.85 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:06<00:00, 20.09it/s, est. speed input: 9673.20 toks/s, output: 18.89 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:06<00:00, 19.62it/s, est. speed input: 9670.37 toks/s, output: 18.89 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:06<00:00, 19.60it/s, est. speed input: 9675.63 toks/s, output: 18.90 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:06<00:00, 19.58it/s, est. speed input: 9680.76 toks/s, output: 18.91 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:06<00:00, 19.39it/s, est. speed input: 9680.30 toks/s, output: 18.91 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:06<00:00, 19.53it/s, est. speed input: 9688.05 toks/s, output: 18.92 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:06<00:00, 19.52it/s, est. speed input: 9692.68 toks/s, output: 18.93 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:06<00:00, 19.52it/s, est. speed input: 9692.68 toks/s, output: 18.93 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:06<00:00, 18.93it/s, est. speed input: 9692.68 toks/s, output: 18.93 toks/s]
[rank0]:[W128 00:04:37.691777253 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=1024 ==========
Time: 2026-01-28 00:04:39
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=128, max_num_seqs=1
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 128 --max-num-seqs 1 --max-model-len 1025 --max-num-batched-tokens 1025 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/BitNet-2B-INT8_M1024.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:04:47 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=2216463) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=2216463) WARNING 01-28 00:05:06 [backends.py:609] Failed to read file <frozen os>
Throughput: 18.43 requests/s, 18888.14 total tokens/s, 18.43 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128

STDERR:
[2026-01-28 00:04:47] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:04:47] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:04:47] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:04:47] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:04:47] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:04:47] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:04:47] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:04:47] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:04:47] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:04:47] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:04:47] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:04:47] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:04:47] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:04:47] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:04:55] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:04:55] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:04:55] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:04:55] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:04:55] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:04:55] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:04:55] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:04:55] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:04:55] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:04:55] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:04:55] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:04:55] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:04:55] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:04:55] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=2216463) [2026-01-28 00:04:56] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=2216463) [2026-01-28 00:04:56] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=2216463) [2026-01-28 00:04:56] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=2216463) [2026-01-28 00:04:56] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=2216463) [2026-01-28 00:04:56] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=2216463) [2026-01-28 00:04:56] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=2216463) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=2216463) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.76it/s]
(EngineCore_DP0 pid=2216463) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.76it/s]
(EngineCore_DP0 pid=2216463) 
(EngineCore_DP0 pid=2216463) [2026-01-28 00:04:57] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 2560] -> 1D uint8
(EngineCore_DP0 pid=2216463) [2026-01-28 00:04:57] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7372800 bytes
(EngineCore_DP0 pid=2216463) [2026-01-28 00:04:57] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 2560] -> 1D uint8
(EngineCore_DP0 pid=2216463) [2026-01-28 00:04:57] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4915200 bytes
(EngineCore_DP0 pid=2216463) [2026-01-28 00:04:57] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 2560] -> 1D uint8
(EngineCore_DP0 pid=2216463) [2026-01-28 00:04:57] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 26542080 bytes
(EngineCore_DP0 pid=2216463) [2026-01-28 00:04:57] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 6912] -> 1D uint8
(EngineCore_DP0 pid=2216463) [2026-01-28 00:04:57] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 13271040 bytes
(EngineCore_DP0 pid=2216463) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  9.09it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  8.78it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  8.82it/s]
(EngineCore_DP0 pid=2216463) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  8.89it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  8.88it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  26%|██▌       | 33/128 [00:00<00:00, 326.84it/s]
Adding requests:  54%|█████▍    | 69/128 [00:00<00:00, 342.02it/s]
Adding requests:  82%|████████▏ | 105/128 [00:00<00:00, 347.02it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 347.32it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 2/128 [00:00<00:08, 14.33it/s, est. speed input: 14677.05 toks/s, output: 14.33 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:07, 16.48it/s, est. speed input: 16506.88 toks/s, output: 16.12 toks/s]
Processed prompts:   5%|▍         | 6/128 [00:00<00:07, 17.30it/s, est. speed input: 17211.40 toks/s, output: 16.81 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:00<00:06, 17.76it/s, est. speed input: 17620.91 toks/s, output: 17.21 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:00<00:06, 18.03it/s, est. speed input: 17875.59 toks/s, output: 17.46 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:00<00:06, 18.23it/s, est. speed input: 18062.64 toks/s, output: 17.64 toks/s]
Processed prompts:  11%|█         | 14/128 [00:00<00:06, 18.34it/s, est. speed input: 18193.31 toks/s, output: 17.77 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:00<00:06, 18.31it/s, est. speed input: 18255.21 toks/s, output: 17.83 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:01<00:06, 18.32it/s, est. speed input: 18312.29 toks/s, output: 17.88 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:01<00:05, 18.38it/s, est. speed input: 18373.95 toks/s, output: 17.94 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:01<00:05, 18.44it/s, est. speed input: 18430.05 toks/s, output: 18.00 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:01<00:05, 18.52it/s, est. speed input: 18489.33 toks/s, output: 18.06 toks/s]
Processed prompts:  20%|██        | 26/128 [00:01<00:05, 18.54it/s, est. speed input: 18529.24 toks/s, output: 18.09 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:01<00:05, 18.60it/s, est. speed input: 18574.72 toks/s, output: 18.14 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:01<00:05, 18.67it/s, est. speed input: 18621.08 toks/s, output: 18.18 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:01<00:05, 18.68it/s, est. speed input: 18653.86 toks/s, output: 18.22 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:01<00:05, 18.69it/s, est. speed input: 18682.13 toks/s, output: 18.24 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:01<00:04, 18.68it/s, est. speed input: 18706.10 toks/s, output: 18.27 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:02<00:04, 18.68it/s, est. speed input: 18727.91 toks/s, output: 18.29 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:02<00:04, 18.98it/s, est. speed input: 18796.02 toks/s, output: 18.36 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:02<00:04, 19.70it/s, est. speed input: 18958.12 toks/s, output: 18.51 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:02<00:04, 19.82it/s, est. speed input: 19053.67 toks/s, output: 18.61 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:02<00:04, 19.70it/s, est. speed input: 19083.36 toks/s, output: 18.64 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:02<00:04, 19.45it/s, est. speed input: 19090.20 toks/s, output: 18.64 toks/s]
Processed prompts:  41%|████      | 52/128 [00:02<00:03, 19.46it/s, est. speed input: 19122.83 toks/s, output: 18.67 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:02<00:03, 19.38it/s, est. speed input: 19141.28 toks/s, output: 18.69 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:02<00:03, 19.45it/s, est. speed input: 19173.86 toks/s, output: 18.72 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:03<00:03, 19.91it/s, est. speed input: 19266.85 toks/s, output: 18.82 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:03<00:03, 20.15it/s, est. speed input: 19348.24 toks/s, output: 18.89 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:03<00:03, 20.36it/s, est. speed input: 19430.64 toks/s, output: 18.98 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:03<00:03, 19.93it/s, est. speed input: 19435.27 toks/s, output: 18.98 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:03<00:02, 19.74it/s, est. speed input: 19439.87 toks/s, output: 18.98 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:03<00:02, 20.07it/s, est. speed input: 19508.68 toks/s, output: 19.05 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:03<00:02, 20.33it/s, est. speed input: 19576.88 toks/s, output: 19.12 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:04<00:02, 20.13it/s, est. speed input: 19598.89 toks/s, output: 19.14 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:04<00:02, 19.82it/s, est. speed input: 19600.30 toks/s, output: 19.14 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:04<00:02, 20.19it/s, est. speed input: 19664.21 toks/s, output: 19.20 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:04<00:01, 20.04it/s, est. speed input: 19680.80 toks/s, output: 19.22 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:04<00:01, 20.18it/s, est. speed input: 19722.03 toks/s, output: 19.26 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:04<00:01, 19.81it/s, est. speed input: 19713.69 toks/s, output: 19.25 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:04<00:01, 19.52it/s, est. speed input: 19698.73 toks/s, output: 19.24 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:05<00:01, 19.49it/s, est. speed input: 19702.31 toks/s, output: 19.24 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:05<00:01, 19.88it/s, est. speed input: 19743.20 toks/s, output: 19.28 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:05<00:01, 20.11it/s, est. speed input: 19779.17 toks/s, output: 19.32 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:05<00:01, 19.79it/s, est. speed input: 19774.33 toks/s, output: 19.31 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:05<00:00, 20.04it/s, est. speed input: 19808.77 toks/s, output: 19.34 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:05<00:00, 20.09it/s, est. speed input: 19831.07 toks/s, output: 19.37 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:05<00:00, 20.11it/s, est. speed input: 19850.78 toks/s, output: 19.39 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:06<00:00, 20.18it/s, est. speed input: 19874.64 toks/s, output: 19.41 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:06<00:00, 20.02it/s, est. speed input: 19881.15 toks/s, output: 19.42 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:06<00:00, 20.11it/s, est. speed input: 19902.16 toks/s, output: 19.44 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:06<00:00, 20.29it/s, est. speed input: 19931.05 toks/s, output: 19.46 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:06<00:00, 20.29it/s, est. speed input: 19931.05 toks/s, output: 19.46 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:06<00:00, 19.46it/s, est. speed input: 19931.05 toks/s, output: 19.46 toks/s]
[rank0]:[W128 00:05:32.640029745 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=2048 ==========
Time: 2026-01-28 00:05:34
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=256, max_num_seqs=2
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 256 --max-num-seqs 2 --max-model-len 1025 --max-num-batched-tokens 2048 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/BitNet-2B-INT8_M2048.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:05:43 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=2217490) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=2217490) WARNING 01-28 00:06:01 [backends.py:609] Failed to read file <frozen os>
Throughput: 37.40 requests/s, 38336.80 total tokens/s, 37.40 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256

STDERR:
[2026-01-28 00:05:42] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:05:43] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:05:43] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:05:43] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:05:43] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:05:43] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:05:43] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:05:43] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:05:43] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:05:43] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:05:43] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:05:43] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:05:43] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:05:43] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:05:50] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:05:50] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:05:50] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:05:50] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:05:50] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:05:50] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:05:50] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:05:50] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:05:50] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:05:50] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:05:50] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:05:50] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:05:50] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:05:50] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=2217490) [2026-01-28 00:05:51] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=2217490) [2026-01-28 00:05:51] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=2217490) [2026-01-28 00:05:51] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=2217490) [2026-01-28 00:05:51] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=2217490) [2026-01-28 00:05:51] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=2217490) [2026-01-28 00:05:51] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=2217490) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=2217490) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.87it/s]
(EngineCore_DP0 pid=2217490) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.87it/s]
(EngineCore_DP0 pid=2217490) 
(EngineCore_DP0 pid=2217490) [2026-01-28 00:05:52] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 2560] -> 1D uint8
(EngineCore_DP0 pid=2217490) [2026-01-28 00:05:52] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7372800 bytes
(EngineCore_DP0 pid=2217490) [2026-01-28 00:05:52] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 2560] -> 1D uint8
(EngineCore_DP0 pid=2217490) [2026-01-28 00:05:52] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4915200 bytes
(EngineCore_DP0 pid=2217490) [2026-01-28 00:05:52] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 2560] -> 1D uint8
(EngineCore_DP0 pid=2217490) [2026-01-28 00:05:52] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 26542080 bytes
(EngineCore_DP0 pid=2217490) [2026-01-28 00:05:52] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 6912] -> 1D uint8
(EngineCore_DP0 pid=2217490) [2026-01-28 00:05:52] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 13271040 bytes
(EngineCore_DP0 pid=2217490) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  33%|███▎      | 1/3 [00:00<00:00,  8.11it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  67%|██████▋   | 2/3 [00:00<00:00,  8.74it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00,  8.58it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00,  8.56it/s]
(EngineCore_DP0 pid=2217490) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 1/2 [00:00<00:00,  8.50it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  9.22it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  9.10it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  14%|█▎        | 35/256 [00:00<00:00, 348.88it/s]
Adding requests:  29%|██▉       | 74/256 [00:00<00:00, 369.91it/s]
Adding requests:  43%|████▎     | 111/256 [00:00<00:00, 369.48it/s]
Adding requests:  58%|█████▊    | 148/256 [00:00<00:00, 369.33it/s]
Adding requests:  72%|███████▏  | 185/256 [00:00<00:00, 368.58it/s]
Adding requests:  87%|████████▋ | 223/256 [00:00<00:00, 371.69it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 372.04it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   9%|▉         | 24/256 [00:00<00:01, 187.88it/s, est. speed input: 192409.97 toks/s, output: 187.88 toks/s]
Processed prompts:  17%|█▋        | 43/256 [00:00<00:03, 65.16it/s, est. speed input: 74916.91 toks/s, output: 73.16 toks/s]   
Processed prompts:  21%|██        | 54/256 [00:00<00:03, 51.56it/s, est. speed input: 61272.48 toks/s, output: 59.84 toks/s]
Processed prompts:  24%|██▍       | 62/256 [00:01<00:04, 47.73it/s, est. speed input: 57224.39 toks/s, output: 55.88 toks/s]
Processed prompts:  27%|██▋       | 68/256 [00:01<00:04, 45.03it/s, est. speed input: 54744.55 toks/s, output: 53.46 toks/s]
Processed prompts:  29%|██▉       | 74/256 [00:01<00:04, 43.82it/s, est. speed input: 53310.63 toks/s, output: 52.06 toks/s]
Processed prompts:  31%|███▏      | 80/256 [00:01<00:04, 42.93it/s, est. speed input: 52182.17 toks/s, output: 50.96 toks/s]
Processed prompts:  34%|███▎      | 86/256 [00:01<00:04, 42.04it/s, est. speed input: 51167.22 toks/s, output: 49.97 toks/s]
Processed prompts:  36%|███▌      | 91/256 [00:01<00:03, 43.10it/s, est. speed input: 50985.90 toks/s, output: 49.79 toks/s]
Processed prompts:  38%|███▊      | 96/256 [00:01<00:04, 39.46it/s, est. speed input: 49495.39 toks/s, output: 48.33 toks/s]
Processed prompts:  39%|███▉      | 101/256 [00:02<00:03, 41.28it/s, est. speed input: 49444.69 toks/s, output: 48.29 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:02<00:03, 38.77it/s, est. speed input: 48425.72 toks/s, output: 47.29 toks/s]
Processed prompts:  44%|████▍     | 112/256 [00:02<00:03, 39.11it/s, est. speed input: 47946.58 toks/s, output: 46.82 toks/s]
Processed prompts:  45%|████▌     | 116/256 [00:02<00:03, 39.07it/s, est. speed input: 47614.53 toks/s, output: 46.50 toks/s]
Processed prompts:  47%|████▋     | 120/256 [00:02<00:03, 39.12it/s, est. speed input: 47323.05 toks/s, output: 46.21 toks/s]
Processed prompts:  48%|████▊     | 124/256 [00:02<00:03, 38.37it/s, est. speed input: 46916.74 toks/s, output: 45.82 toks/s]
Processed prompts:  50%|█████     | 128/256 [00:02<00:03, 37.83it/s, est. speed input: 46543.32 toks/s, output: 45.45 toks/s]
Processed prompts:  52%|█████▏    | 132/256 [00:02<00:03, 37.47it/s, est. speed input: 46203.11 toks/s, output: 45.12 toks/s]
Processed prompts:  53%|█████▎    | 136/256 [00:03<00:03, 37.68it/s, est. speed input: 45959.75 toks/s, output: 44.88 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:03<00:02, 38.67it/s, est. speed input: 45745.39 toks/s, output: 44.67 toks/s]
Processed prompts:  57%|█████▋    | 146/256 [00:03<00:02, 38.65it/s, est. speed input: 45548.48 toks/s, output: 44.48 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:03<00:02, 38.70it/s, est. speed input: 45373.10 toks/s, output: 44.31 toks/s]
Processed prompts:  60%|██████    | 154/256 [00:03<00:02, 38.84it/s, est. speed input: 45219.38 toks/s, output: 44.16 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:03<00:02, 38.81it/s, est. speed input: 45059.43 toks/s, output: 44.00 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:03<00:02, 38.88it/s, est. speed input: 44919.46 toks/s, output: 43.87 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:03<00:02, 39.08it/s, est. speed input: 44801.44 toks/s, output: 43.75 toks/s]
Processed prompts:  66%|██████▋   | 170/256 [00:03<00:02, 39.05it/s, est. speed input: 44672.77 toks/s, output: 43.63 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:04<00:02, 38.54it/s, est. speed input: 44502.65 toks/s, output: 43.46 toks/s]
Processed prompts:  70%|██████▉   | 178/256 [00:04<00:02, 38.72it/s, est. speed input: 44392.35 toks/s, output: 43.35 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:04<00:01, 38.47it/s, est. speed input: 44252.22 toks/s, output: 43.21 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:04<00:01, 38.53it/s, est. speed input: 44140.95 toks/s, output: 43.11 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:04<00:01, 38.91it/s, est. speed input: 44064.44 toks/s, output: 43.03 toks/s]
Processed prompts:  76%|███████▌  | 194/256 [00:04<00:01, 39.21it/s, est. speed input: 43994.20 toks/s, output: 42.96 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:04<00:01, 38.96it/s, est. speed input: 43888.07 toks/s, output: 42.86 toks/s]
Processed prompts:  79%|███████▉  | 202/256 [00:04<00:01, 39.11it/s, est. speed input: 43813.38 toks/s, output: 42.79 toks/s]
Processed prompts:  80%|████████  | 206/256 [00:04<00:01, 39.00it/s, est. speed input: 43724.78 toks/s, output: 42.70 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:04<00:01, 38.77it/s, est. speed input: 43628.29 toks/s, output: 42.61 toks/s]
Processed prompts:  84%|████████▎ | 214/256 [00:05<00:01, 38.32it/s, est. speed input: 43512.39 toks/s, output: 42.49 toks/s]
Processed prompts:  85%|████████▌ | 218/256 [00:05<00:01, 37.81it/s, est. speed input: 43386.47 toks/s, output: 42.37 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:05<00:00, 37.46it/s, est. speed input: 43265.38 toks/s, output: 42.25 toks/s]
Processed prompts:  88%|████████▊ | 226/256 [00:05<00:00, 37.36it/s, est. speed input: 43159.49 toks/s, output: 42.15 toks/s]
Processed prompts:  90%|████████▉ | 230/256 [00:05<00:00, 37.40it/s, est. speed input: 43066.93 toks/s, output: 42.06 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:05<00:00, 38.13it/s, est. speed input: 43027.78 toks/s, output: 42.02 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:05<00:00, 38.53it/s, est. speed input: 42981.95 toks/s, output: 41.97 toks/s]
Processed prompts:  95%|█████████▍| 242/256 [00:05<00:00, 37.98it/s, est. speed input: 42880.84 toks/s, output: 41.88 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:05<00:00, 37.59it/s, est. speed input: 42783.14 toks/s, output: 41.78 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:05<00:00, 37.27it/s, est. speed input: 42685.62 toks/s, output: 41.69 toks/s]
Processed prompts:  99%|█████████▉| 254/256 [00:06<00:00, 37.13it/s, est. speed input: 42596.60 toks/s, output: 41.60 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:06<00:00, 37.13it/s, est. speed input: 42590.08 toks/s, output: 41.59 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:06<00:00, 41.59it/s, est. speed input: 42590.08 toks/s, output: 41.59 toks/s]
[rank0]:[W128 00:06:27.889127616 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=4096 ==========
Time: 2026-01-28 00:06:29
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=512, max_num_seqs=4
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 512 --max-num-seqs 4 --max-model-len 1025 --max-num-batched-tokens 4096 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/BitNet-2B-INT8_M4096.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:06:39 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=2218507) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=2218507) WARNING 01-28 00:06:58 [backends.py:609] Failed to read file <frozen os>
Throughput: 73.35 requests/s, 75178.75 total tokens/s, 73.35 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512

STDERR:
[2026-01-28 00:06:39] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:06:39] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:06:39] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:06:39] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:06:39] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:06:39] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:06:39] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:06:39] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:06:39] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:06:39] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:06:39] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:06:39] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:06:39] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:06:39] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:06:47] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:06:47] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:06:47] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:06:47] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:06:47] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:06:47] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:06:47] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:06:47] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:06:47] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:06:47] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:06:47] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:06:47] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:06:47] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:06:47] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=2218507) [2026-01-28 00:06:48] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=2218507) [2026-01-28 00:06:48] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=2218507) [2026-01-28 00:06:48] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=2218507) [2026-01-28 00:06:48] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=2218507) [2026-01-28 00:06:48] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=2218507) [2026-01-28 00:06:48] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=2218507) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=2218507) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.82it/s]
(EngineCore_DP0 pid=2218507) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.82it/s]
(EngineCore_DP0 pid=2218507) 
(EngineCore_DP0 pid=2218507) [2026-01-28 00:06:49] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 2560] -> 1D uint8
(EngineCore_DP0 pid=2218507) [2026-01-28 00:06:49] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7372800 bytes
(EngineCore_DP0 pid=2218507) [2026-01-28 00:06:49] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 2560] -> 1D uint8
(EngineCore_DP0 pid=2218507) [2026-01-28 00:06:49] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4915200 bytes
(EngineCore_DP0 pid=2218507) [2026-01-28 00:06:49] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 2560] -> 1D uint8
(EngineCore_DP0 pid=2218507) [2026-01-28 00:06:49] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 26542080 bytes
(EngineCore_DP0 pid=2218507) [2026-01-28 00:06:49] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 6912] -> 1D uint8
(EngineCore_DP0 pid=2218507) [2026-01-28 00:06:49] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 13271040 bytes
(EngineCore_DP0 pid=2218507) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  25%|██▌       | 1/4 [00:00<00:00,  9.25it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  75%|███████▌  | 3/4 [00:00<00:00, 10.24it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  9.68it/s]
(EngineCore_DP0 pid=2218507) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  33%|███▎      | 1/3 [00:00<00:00,  8.98it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00, 10.10it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  9.97it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   7%|▋         | 35/512 [00:00<00:01, 349.77it/s]
Adding requests:  14%|█▍        | 74/512 [00:00<00:01, 368.56it/s]
Adding requests:  22%|██▏       | 111/512 [00:00<00:01, 364.56it/s]
Adding requests:  29%|██▉       | 148/512 [00:00<00:00, 365.89it/s]
Adding requests:  36%|███▌      | 185/512 [00:00<00:00, 362.58it/s]
Adding requests:  44%|████▍     | 224/512 [00:00<00:00, 371.00it/s]
Adding requests:  51%|█████     | 262/512 [00:00<00:00, 373.61it/s]
Adding requests:  59%|█████▉    | 302/512 [00:00<00:00, 381.02it/s]
Adding requests:  67%|██████▋   | 342/512 [00:00<00:00, 386.28it/s]
Adding requests:  75%|███████▍  | 383/512 [00:01<00:00, 392.18it/s]
Adding requests:  83%|████████▎ | 425/512 [00:01<00:00, 398.38it/s]
Adding requests:  91%|█████████ | 466/512 [00:01<00:00, 400.22it/s]
Adding requests:  99%|█████████▉| 507/512 [00:01<00:00, 398.71it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 384.39it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  18%|█▊        | 94/512 [00:00<00:00, 625.80it/s, est. speed input: 640895.39 toks/s, output: 625.82 toks/s]
Processed prompts:  31%|███       | 157/512 [00:00<00:02, 142.33it/s, est. speed input: 169227.68 toks/s, output: 165.26 toks/s]
Processed prompts:  37%|███▋      | 188/512 [00:01<00:02, 114.90it/s, est. speed input: 140411.98 toks/s, output: 137.12 toks/s]
Processed prompts:  41%|████      | 208/512 [00:01<00:02, 104.64it/s, est. speed input: 130309.79 toks/s, output: 127.26 toks/s]
Processed prompts:  44%|████▍     | 224/512 [00:01<00:02, 98.11it/s, est. speed input: 124372.45 toks/s, output: 121.46 toks/s] 
Processed prompts:  46%|████▋     | 237/512 [00:02<00:02, 95.06it/s, est. speed input: 121251.78 toks/s, output: 118.41 toks/s]
Processed prompts:  48%|████▊     | 248/512 [00:02<00:02, 89.14it/s, est. speed input: 117469.74 toks/s, output: 114.72 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:02<00:03, 83.02it/s, est. speed input: 113912.11 toks/s, output: 111.24 toks/s]
Processed prompts:  52%|█████▏    | 267/512 [00:02<00:02, 83.08it/s, est. speed input: 112638.99 toks/s, output: 110.00 toks/s]
Processed prompts:  54%|█████▍    | 276/512 [00:02<00:02, 83.61it/s, est. speed input: 111601.85 toks/s, output: 108.99 toks/s]
Processed prompts:  56%|█████▌    | 285/512 [00:02<00:02, 83.80it/s, est. speed input: 110587.81 toks/s, output: 108.00 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:02<00:02, 74.61it/s, est. speed input: 107549.53 toks/s, output: 105.03 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:02<00:02, 75.06it/s, est. speed input: 106497.88 toks/s, output: 104.00 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:03<00:02, 75.35it/s, est. speed input: 105504.65 toks/s, output: 103.03 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:03<00:02, 75.60it/s, est. speed input: 104582.64 toks/s, output: 102.13 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:03<00:02, 75.64it/s, est. speed input: 103695.42 toks/s, output: 101.26 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:03<00:02, 75.50it/s, est. speed input: 102839.20 toks/s, output: 100.43 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:03<00:02, 74.59it/s, est. speed input: 101917.92 toks/s, output: 99.53 toks/s] 
Processed prompts:  68%|██████▊   | 350/512 [00:03<00:02, 75.10it/s, est. speed input: 101216.85 toks/s, output: 98.84 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:03<00:02, 74.97it/s, est. speed input: 100488.65 toks/s, output: 98.13 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:03<00:01, 75.08it/s, est. speed input: 99829.35 toks/s, output: 97.49 toks/s] 
Processed prompts:  73%|███████▎  | 374/512 [00:03<00:01, 75.44it/s, est. speed input: 99240.04 toks/s, output: 96.91 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [00:03<00:01, 75.62it/s, est. speed input: 98673.25 toks/s, output: 96.36 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [00:04<00:01, 75.86it/s, est. speed input: 98147.45 toks/s, output: 95.85 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [00:04<00:01, 75.99it/s, est. speed input: 97645.37 toks/s, output: 95.36 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [00:04<00:01, 76.03it/s, est. speed input: 97161.19 toks/s, output: 94.88 toks/s]
Processed prompts:  81%|████████  | 414/512 [00:04<00:01, 75.95it/s, est. speed input: 96690.12 toks/s, output: 94.42 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [00:04<00:01, 75.90it/s, est. speed input: 96241.08 toks/s, output: 93.98 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [00:04<00:01, 75.90it/s, est. speed input: 95815.83 toks/s, output: 93.57 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [00:04<00:00, 75.97it/s, est. speed input: 95417.01 toks/s, output: 93.18 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [00:04<00:00, 75.95it/s, est. speed input: 95028.51 toks/s, output: 92.80 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [00:04<00:00, 75.64it/s, est. speed input: 94630.71 toks/s, output: 92.41 toks/s]
Processed prompts:  90%|█████████ | 462/512 [00:05<00:00, 75.72it/s, est. speed input: 94276.41 toks/s, output: 92.07 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [00:05<00:00, 75.78it/s, est. speed input: 93936.06 toks/s, output: 91.73 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [00:05<00:00, 75.84it/s, est. speed input: 93611.44 toks/s, output: 91.42 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [00:05<00:00, 75.78it/s, est. speed input: 93290.94 toks/s, output: 91.10 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [00:05<00:00, 75.84it/s, est. speed input: 92990.80 toks/s, output: 90.81 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [00:05<00:00, 75.99it/s, est. speed input: 92710.99 toks/s, output: 90.54 toks/s]
Processed prompts: 100%|█████████▉| 510/512 [00:05<00:00, 76.62it/s, est. speed input: 92480.50 toks/s, output: 90.31 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:05<00:00, 76.62it/s, est. speed input: 92840.09 toks/s, output: 90.66 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:05<00:00, 90.66it/s, est. speed input: 92840.09 toks/s, output: 90.66 toks/s]
[rank0]:[W128 00:07:24.854504278 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=8192 ==========
Time: 2026-01-28 00:07:26
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=1024, max_num_seqs=8
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 1024 --max-num-seqs 8 --max-model-len 1025 --max-num-batched-tokens 8192 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/BitNet-2B-INT8_M8192.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:07:39 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=2219557) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=2219557) WARNING 01-28 00:07:57 [backends.py:609] Failed to read file <frozen os>
Throughput: 79.11 requests/s, 81082.71 total tokens/s, 79.11 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024

STDERR:
[2026-01-28 00:07:39] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:07:39] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:07:39] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:07:39] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:07:39] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:07:39] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:07:39] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:07:39] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:07:39] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:07:39] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:07:39] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:07:39] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:07:39] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:07:39] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:07:47] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:07:47] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:07:47] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:07:47] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:07:47] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:07:47] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:07:47] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:07:47] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:07:47] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:07:47] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:07:47] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:07:47] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:07:47] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:07:47] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=2219557) [2026-01-28 00:07:48] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=2219557) [2026-01-28 00:07:48] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=2219557) [2026-01-28 00:07:48] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=2219557) [2026-01-28 00:07:48] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=2219557) [2026-01-28 00:07:48] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=2219557) [2026-01-28 00:07:48] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=2219557) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=2219557) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.85it/s]
(EngineCore_DP0 pid=2219557) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.85it/s]
(EngineCore_DP0 pid=2219557) 
(EngineCore_DP0 pid=2219557) [2026-01-28 00:07:49] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 2560] -> 1D uint8
(EngineCore_DP0 pid=2219557) [2026-01-28 00:07:49] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7372800 bytes
(EngineCore_DP0 pid=2219557) [2026-01-28 00:07:49] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 2560] -> 1D uint8
(EngineCore_DP0 pid=2219557) [2026-01-28 00:07:49] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4915200 bytes
(EngineCore_DP0 pid=2219557) [2026-01-28 00:07:49] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 2560] -> 1D uint8
(EngineCore_DP0 pid=2219557) [2026-01-28 00:07:49] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 26542080 bytes
(EngineCore_DP0 pid=2219557) [2026-01-28 00:07:49] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 6912] -> 1D uint8
(EngineCore_DP0 pid=2219557) [2026-01-28 00:07:49] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 13271040 bytes
(EngineCore_DP0 pid=2219557) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:00,  5.06it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  40%|████      | 2/5 [00:00<00:00,  6.94it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  80%|████████  | 4/5 [00:00<00:00,  8.81it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00,  8.85it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00,  8.24it/s]
(EngineCore_DP0 pid=2219557) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:00,  9.16it/s]
Capturing CUDA graphs (decode, FULL):  75%|███████▌  | 3/4 [00:00<00:00, 10.12it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  9.98it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  9.94it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   4%|▎         | 37/1024 [00:00<00:02, 365.25it/s]
Adding requests:   7%|▋         | 76/1024 [00:00<00:02, 378.69it/s]
Adding requests:  11%|█         | 115/1024 [00:00<00:02, 380.14it/s]
Adding requests:  15%|█▌        | 154/1024 [00:00<00:02, 370.22it/s]
Adding requests:  19%|█▉        | 192/1024 [00:00<00:02, 365.53it/s]
Adding requests:  23%|██▎       | 232/1024 [00:00<00:02, 375.62it/s]
Adding requests:  26%|██▋       | 270/1024 [00:00<00:02, 367.41it/s]
Adding requests:  30%|██▉       | 307/1024 [00:00<00:02, 353.22it/s]
Adding requests:  33%|███▎      | 343/1024 [00:00<00:02, 316.40it/s]
Adding requests:  37%|███▋      | 381/1024 [00:01<00:01, 333.41it/s]
Adding requests:  41%|████      | 420/1024 [00:01<00:01, 347.75it/s]
Adding requests:  45%|████▍     | 458/1024 [00:01<00:01, 355.03it/s]
Adding requests:  48%|████▊     | 495/1024 [00:01<00:01, 359.31it/s]
Adding requests:  52%|█████▏    | 532/1024 [00:01<00:01, 351.68it/s]
Adding requests:  56%|█████▌    | 571/1024 [00:01<00:01, 360.38it/s]
Adding requests:  59%|█████▉    | 608/1024 [00:01<00:01, 360.64it/s]
Adding requests:  63%|██████▎   | 648/1024 [00:01<00:01, 371.22it/s]
Adding requests:  67%|██████▋   | 690/1024 [00:01<00:00, 383.79it/s]
Adding requests:  71%|███████   | 729/1024 [00:02<00:00, 382.68it/s]
Adding requests:  75%|███████▌  | 768/1024 [00:02<00:00, 381.80it/s]
Adding requests:  79%|███████▉  | 807/1024 [00:02<00:00, 376.57it/s]
Adding requests:  83%|████████▎ | 845/1024 [00:02<00:00, 375.94it/s]
Adding requests:  87%|████████▋ | 888/1024 [00:02<00:00, 391.08it/s]
Adding requests:  91%|█████████ | 928/1024 [00:02<00:00, 390.97it/s]
Adding requests:  95%|█████████▍| 969/1024 [00:02<00:00, 392.84it/s]
Adding requests:  99%|█████████▊| 1011/1024 [00:02<00:00, 399.39it/s]
Adding requests: 100%|██████████| 1024/1024 [00:02<00:00, 370.93it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [00:00<00:00, 1513.38it/s, est. speed input: 1550011.21 toks/s, output: 1513.53 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:02<00:04, 152.00it/s, est. speed input: 185074.73 toks/s, output: 180.74 toks/s]   
Processed prompts:  43%|████▎     | 438/1024 [00:02<00:04, 127.46it/s, est. speed input: 157330.59 toks/s, output: 153.64 toks/s]
Processed prompts:  47%|████▋     | 479/1024 [00:03<00:04, 116.61it/s, est. speed input: 146593.18 toks/s, output: 143.16 toks/s]
Processed prompts:  50%|████▉     | 507/1024 [00:03<00:04, 106.17it/s, est. speed input: 138436.89 toks/s, output: 135.19 toks/s]
Processed prompts:  52%|█████▏    | 528/1024 [00:03<00:04, 105.88it/s, est. speed input: 136811.20 toks/s, output: 133.60 toks/s]
Processed prompts:  53%|█████▎    | 545/1024 [00:04<00:04, 102.35it/s, est. speed input: 134348.62 toks/s, output: 131.20 toks/s]
Processed prompts:  55%|█████▍    | 560/1024 [00:04<00:04, 97.04it/s, est. speed input: 131641.98 toks/s, output: 128.56 toks/s] 
Processed prompts:  56%|█████▌    | 572/1024 [00:04<00:05, 89.09it/s, est. speed input: 128515.22 toks/s, output: 125.50 toks/s]
Processed prompts:  57%|█████▋    | 583/1024 [00:04<00:04, 91.71it/s, est. speed input: 128148.36 toks/s, output: 125.14 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:04<00:05, 81.53it/s, est. speed input: 125144.13 toks/s, output: 122.21 toks/s]
Processed prompts:  59%|█████▉    | 603/1024 [00:04<00:05, 82.80it/s, est. speed input: 124457.95 toks/s, output: 121.54 toks/s]
Processed prompts:  60%|█████▉    | 612/1024 [00:05<00:04, 84.04it/s, est. speed input: 123803.35 toks/s, output: 120.90 toks/s]
Processed prompts:  61%|██████    | 621/1024 [00:05<00:04, 85.16it/s, est. speed input: 123172.04 toks/s, output: 120.29 toks/s]
Processed prompts:  62%|██████▏   | 630/1024 [00:05<00:04, 86.06it/s, est. speed input: 122556.26 toks/s, output: 119.68 toks/s]
Processed prompts:  62%|██████▏   | 639/1024 [00:05<00:04, 86.82it/s, est. speed input: 121967.00 toks/s, output: 119.11 toks/s]
Processed prompts:  63%|██████▎   | 648/1024 [00:05<00:04, 87.49it/s, est. speed input: 121405.51 toks/s, output: 118.56 toks/s]
Processed prompts:  64%|██████▍   | 657/1024 [00:05<00:04, 87.96it/s, est. speed input: 120861.03 toks/s, output: 118.03 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:05<00:05, 69.00it/s, est. speed input: 118237.79 toks/s, output: 115.47 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:05<00:04, 71.37it/s, est. speed input: 117590.84 toks/s, output: 114.83 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:05<00:04, 73.36it/s, est. speed input: 116973.28 toks/s, output: 114.23 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:06<00:04, 74.87it/s, est. speed input: 116372.22 toks/s, output: 113.64 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:06<00:04, 76.07it/s, est. speed input: 115795.89 toks/s, output: 113.08 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:06<00:04, 77.05it/s, est. speed input: 115244.78 toks/s, output: 112.54 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:06<00:03, 77.64it/s, est. speed input: 114701.35 toks/s, output: 112.01 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:06<00:03, 78.00it/s, est. speed input: 114169.81 toks/s, output: 111.49 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:06<00:03, 78.30it/s, est. speed input: 113658.41 toks/s, output: 110.99 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:06<00:03, 78.53it/s, est. speed input: 113163.28 toks/s, output: 110.51 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:06<00:03, 78.72it/s, est. speed input: 112684.52 toks/s, output: 110.04 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:06<00:03, 78.94it/s, est. speed input: 112226.06 toks/s, output: 109.60 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:06<00:03, 79.06it/s, est. speed input: 111779.02 toks/s, output: 109.16 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:07<00:03, 79.16it/s, est. speed input: 111345.82 toks/s, output: 108.74 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:07<00:03, 79.21it/s, est. speed input: 110922.67 toks/s, output: 108.32 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:07<00:03, 79.24it/s, est. speed input: 110511.15 toks/s, output: 107.92 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:07<00:02, 79.44it/s, est. speed input: 110122.32 toks/s, output: 107.54 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:07<00:02, 79.37it/s, est. speed input: 109730.80 toks/s, output: 107.16 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:07<00:02, 79.42it/s, est. speed input: 109355.76 toks/s, output: 106.79 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:07<00:02, 79.35it/s, est. speed input: 108983.77 toks/s, output: 106.43 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:07<00:02, 79.36it/s, est. speed input: 108625.40 toks/s, output: 106.08 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:07<00:02, 79.32it/s, est. speed input: 108273.67 toks/s, output: 105.74 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [00:07<00:02, 79.33it/s, est. speed input: 107932.42 toks/s, output: 105.40 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [00:08<00:02, 79.31it/s, est. speed input: 107598.71 toks/s, output: 105.08 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:08<00:02, 79.30it/s, est. speed input: 107273.30 toks/s, output: 104.76 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [00:08<00:01, 79.25it/s, est. speed input: 106953.12 toks/s, output: 104.45 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [00:08<00:01, 79.24it/s, est. speed input: 106642.26 toks/s, output: 104.14 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [00:08<00:01, 79.08it/s, est. speed input: 106330.38 toks/s, output: 103.84 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [00:08<00:01, 79.12it/s, est. speed input: 106034.33 toks/s, output: 103.55 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [00:08<00:01, 79.16it/s, est. speed input: 105745.26 toks/s, output: 103.27 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [00:08<00:01, 79.18it/s, est. speed input: 105462.63 toks/s, output: 102.99 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [00:08<00:01, 79.23it/s, est. speed input: 105188.63 toks/s, output: 102.72 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [00:08<00:01, 79.18it/s, est. speed input: 104916.20 toks/s, output: 102.46 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [00:09<00:01, 79.18it/s, est. speed input: 104651.46 toks/s, output: 102.20 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [00:09<00:00, 80.69it/s, est. speed input: 104231.30 toks/s, output: 101.79 toks/s]
Processed prompts:  94%|█████████▎| 958/1024 [00:09<00:00, 90.50it/s, est. speed input: 104429.56 toks/s, output: 101.98 toks/s]
Processed prompts:  95%|█████████▍| 968/1024 [00:09<00:00, 92.63it/s, est. speed input: 104391.55 toks/s, output: 101.94 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [00:09<00:00, 74.16it/s, est. speed input: 103279.15 toks/s, output: 100.86 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [00:09<00:00, 77.50it/s, est. speed input: 102927.64 toks/s, output: 100.52 toks/s]
Processed prompts:  98%|█████████▊| 1003/1024 [00:09<00:00, 80.00it/s, est. speed input: 102808.31 toks/s, output: 100.40 toks/s]
Processed prompts:  99%|█████████▉| 1012/1024 [00:10<00:00, 82.19it/s, est. speed input: 102694.26 toks/s, output: 100.29 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:10<00:00, 82.19it/s, est. speed input: 102983.45 toks/s, output: 100.57 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:10<00:00, 100.57it/s, est. speed input: 102983.45 toks/s, output: 100.57 toks/s]
[rank0]:[W128 00:08:30.099037619 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=16384 ==========
Time: 2026-01-28 00:08:32
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=2048, max_num_seqs=16
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 2048 --max-num-seqs 16 --max-model-len 1025 --max-num-batched-tokens 16384 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/BitNet-2B-INT8_M16384.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:08:52 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=2220812) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=2220812) WARNING 01-28 00:09:10 [backends.py:609] Failed to read file <frozen os>
Throughput: 81.30 requests/s, 83330.12 total tokens/s, 81.30 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048

STDERR:
[2026-01-28 00:08:52] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:08:52] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:08:52] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:08:52] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:08:52] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:08:52] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:08:52] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:08:52] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:08:52] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:08:52] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:08:52] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:08:52] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:08:52] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:08:52] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:09:00] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:09:00] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:09:00] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:09:00] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:09:00] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:09:00] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:09:00] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:09:00] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:09:00] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:09:00] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:09:00] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:09:00] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:09:00] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:09:00] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=2220812) [2026-01-28 00:09:01] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=2220812) [2026-01-28 00:09:01] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=2220812) [2026-01-28 00:09:01] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=2220812) [2026-01-28 00:09:01] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=2220812) [2026-01-28 00:09:01] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=2220812) [2026-01-28 00:09:01] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=2220812) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=2220812) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.80it/s]
(EngineCore_DP0 pid=2220812) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.80it/s]
(EngineCore_DP0 pid=2220812) 
(EngineCore_DP0 pid=2220812) [2026-01-28 00:09:02] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 2560] -> 1D uint8
(EngineCore_DP0 pid=2220812) [2026-01-28 00:09:02] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7372800 bytes
(EngineCore_DP0 pid=2220812) [2026-01-28 00:09:02] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 2560] -> 1D uint8
(EngineCore_DP0 pid=2220812) [2026-01-28 00:09:02] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4915200 bytes
(EngineCore_DP0 pid=2220812) [2026-01-28 00:09:02] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 2560] -> 1D uint8
(EngineCore_DP0 pid=2220812) [2026-01-28 00:09:02] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 26542080 bytes
(EngineCore_DP0 pid=2220812) [2026-01-28 00:09:02] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 6912] -> 1D uint8
(EngineCore_DP0 pid=2220812) [2026-01-28 00:09:02] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 13271040 bytes
(EngineCore_DP0 pid=2220812) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  14%|█▍        | 1/7 [00:00<00:00,  8.66it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  29%|██▊       | 2/7 [00:00<00:00,  8.60it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  43%|████▎     | 3/7 [00:00<00:00,  8.75it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  57%|█████▋    | 4/7 [00:00<00:00,  8.86it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  86%|████████▌ | 6/7 [00:00<00:00,  9.23it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00,  8.75it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00,  8.82it/s]
(EngineCore_DP0 pid=2220812) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  20%|██        | 1/5 [00:00<00:00,  7.87it/s]
Capturing CUDA graphs (decode, FULL):  40%|████      | 2/5 [00:00<00:00,  8.63it/s]
Capturing CUDA graphs (decode, FULL):  60%|██████    | 3/5 [00:00<00:00,  8.81it/s]
Capturing CUDA graphs (decode, FULL):  80%|████████  | 4/5 [00:00<00:00,  8.90it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00,  8.97it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00,  8.83it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 34/2048 [00:00<00:05, 338.90it/s]
Adding requests:   3%|▎         | 71/2048 [00:00<00:05, 353.16it/s]
Adding requests:   5%|▌         | 107/2048 [00:00<00:05, 354.72it/s]
Adding requests:   7%|▋         | 143/2048 [00:00<00:05, 356.51it/s]
Adding requests:   9%|▊         | 179/2048 [00:00<00:05, 349.03it/s]
Adding requests:  10%|█         | 215/2048 [00:00<00:05, 350.79it/s]
Adding requests:  12%|█▏        | 253/2048 [00:00<00:05, 357.02it/s]
Adding requests:  14%|█▍        | 289/2048 [00:00<00:04, 356.43it/s]
Adding requests:  16%|█▌        | 325/2048 [00:00<00:04, 354.13it/s]
Adding requests:  18%|█▊        | 362/2048 [00:01<00:04, 357.28it/s]
Adding requests:  19%|█▉        | 399/2048 [00:01<00:04, 359.53it/s]
Adding requests:  21%|██▏       | 436/2048 [00:01<00:04, 359.77it/s]
Adding requests:  23%|██▎       | 473/2048 [00:01<00:04, 361.89it/s]
Adding requests:  25%|██▍       | 510/2048 [00:01<00:04, 359.54it/s]
Adding requests:  27%|██▋       | 546/2048 [00:01<00:04, 357.83it/s]
Adding requests:  29%|██▊       | 584/2048 [00:01<00:04, 363.30it/s]
Adding requests:  30%|███       | 622/2048 [00:01<00:03, 366.49it/s]
Adding requests:  32%|███▏      | 660/2048 [00:01<00:03, 368.94it/s]
Adding requests:  34%|███▍      | 699/2048 [00:01<00:03, 374.95it/s]
Adding requests:  36%|███▌      | 737/2048 [00:02<00:03, 371.42it/s]
Adding requests:  38%|███▊      | 775/2048 [00:02<00:03, 365.19it/s]
Adding requests:  40%|███▉      | 812/2048 [00:02<00:03, 364.36it/s]
Adding requests:  42%|████▏     | 850/2048 [00:02<00:03, 367.97it/s]
Adding requests:  44%|████▎     | 891/2048 [00:02<00:03, 379.87it/s]
Adding requests:  45%|████▌     | 930/2048 [00:02<00:02, 378.12it/s]
Adding requests:  47%|████▋     | 968/2048 [00:02<00:02, 374.83it/s]
Adding requests:  49%|████▉     | 1006/2048 [00:02<00:02, 373.05it/s]
Adding requests:  51%|█████     | 1045/2048 [00:02<00:02, 375.69it/s]
Adding requests:  53%|█████▎    | 1083/2048 [00:02<00:02, 372.97it/s]
Adding requests:  55%|█████▍    | 1121/2048 [00:03<00:02, 370.62it/s]
Adding requests:  57%|█████▋    | 1160/2048 [00:03<00:02, 375.23it/s]
Adding requests:  59%|█████▊    | 1200/2048 [00:03<00:02, 380.91it/s]
Adding requests:  60%|██████    | 1239/2048 [00:03<00:02, 379.88it/s]
Adding requests:  62%|██████▏   | 1277/2048 [00:03<00:02, 376.15it/s]
Adding requests:  64%|██████▍   | 1315/2048 [00:03<00:01, 376.75it/s]
Adding requests:  66%|██████▌   | 1353/2048 [00:03<00:01, 377.43it/s]
Adding requests:  68%|██████▊   | 1392/2048 [00:03<00:01, 380.19it/s]
Adding requests:  70%|██████▉   | 1431/2048 [00:03<00:01, 378.52it/s]
Adding requests:  72%|███████▏  | 1471/2048 [00:03<00:01, 383.21it/s]
Adding requests:  74%|███████▍  | 1511/2048 [00:04<00:01, 386.73it/s]
Adding requests:  76%|███████▌  | 1550/2048 [00:04<00:01, 387.16it/s]
Adding requests:  78%|███████▊  | 1590/2048 [00:04<00:01, 389.25it/s]
Adding requests:  80%|███████▉  | 1629/2048 [00:04<00:01, 389.40it/s]
Adding requests:  81%|████████▏ | 1668/2048 [00:04<00:00, 383.84it/s]
Adding requests:  83%|████████▎ | 1707/2048 [00:04<00:00, 383.05it/s]
Adding requests:  85%|████████▌ | 1746/2048 [00:04<00:00, 379.17it/s]
Adding requests:  87%|████████▋ | 1784/2048 [00:04<00:00, 374.32it/s]
Adding requests:  89%|████████▉ | 1822/2048 [00:04<00:00, 374.67it/s]
Adding requests:  91%|█████████ | 1860/2048 [00:05<00:00, 372.83it/s]
Adding requests:  93%|█████████▎| 1898/2048 [00:05<00:00, 361.83it/s]
Adding requests:  94%|█████████▍| 1935/2048 [00:05<00:00, 363.72it/s]
Adding requests:  96%|█████████▋| 1973/2048 [00:05<00:00, 366.04it/s]
Adding requests:  98%|█████████▊| 2012/2048 [00:05<00:00, 372.33it/s]
Adding requests: 100%|██████████| 2048/2048 [00:05<00:00, 370.60it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [00:00<00:00, 1747.88it/s, est. speed input: 1790032.13 toks/s, output: 1747.93 toks/s]
Processed prompts:  31%|███       | 625/2048 [00:02<00:06, 228.48it/s, est. speed input: 288049.56 toks/s, output: 281.30 toks/s]   
Processed prompts:  34%|███▍      | 703/2048 [00:03<00:07, 169.36it/s, est. speed input: 224511.38 toks/s, output: 219.25 toks/s]
Processed prompts:  37%|███▋      | 749/2048 [00:03<00:08, 146.27it/s, est. speed input: 202071.14 toks/s, output: 197.33 toks/s]
Processed prompts:  38%|███▊      | 780/2048 [00:04<00:09, 133.21it/s, est. speed input: 190705.60 toks/s, output: 186.24 toks/s]
Processed prompts:  39%|███▉      | 803/2048 [00:04<00:10, 117.02it/s, est. speed input: 179508.74 toks/s, output: 175.30 toks/s]
Processed prompts:  40%|████      | 820/2048 [00:04<00:10, 112.88it/s, est. speed input: 175752.24 toks/s, output: 171.63 toks/s]
Processed prompts:  41%|████      | 835/2048 [00:04<00:11, 107.02it/s, est. speed input: 171905.80 toks/s, output: 167.88 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [00:05<00:11, 101.31it/s, est. speed input: 168353.44 toks/s, output: 164.41 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [00:05<00:12, 97.12it/s, est. speed input: 165242.15 toks/s, output: 161.37 toks/s] 
Processed prompts:  43%|████▎     | 882/2048 [00:05<00:12, 93.45it/s, est. speed input: 162342.19 toks/s, output: 158.54 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [00:05<00:12, 90.43it/s, est. speed input: 159638.58 toks/s, output: 155.90 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [00:05<00:12, 88.07it/s, est. speed input: 157124.24 toks/s, output: 153.44 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [00:06<00:12, 87.50it/s, est. speed input: 155026.19 toks/s, output: 151.39 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [00:06<00:12, 85.91it/s, est. speed input: 152830.19 toks/s, output: 149.25 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [00:06<00:12, 84.59it/s, est. speed input: 150737.11 toks/s, output: 147.20 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [00:06<00:12, 84.76it/s, est. speed input: 148962.56 toks/s, output: 145.47 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [00:06<00:12, 83.76it/s, est. speed input: 147099.17 toks/s, output: 143.65 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [00:07<00:12, 82.97it/s, est. speed input: 145323.70 toks/s, output: 141.92 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [00:07<00:12, 82.53it/s, est. speed input: 143663.35 toks/s, output: 140.30 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [00:07<00:12, 82.29it/s, est. speed input: 142099.63 toks/s, output: 138.77 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [00:07<00:12, 82.05it/s, est. speed input: 140604.69 toks/s, output: 137.31 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [00:07<00:11, 81.75it/s, est. speed input: 139165.06 toks/s, output: 135.90 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [00:08<00:11, 81.66it/s, est. speed input: 137812.47 toks/s, output: 134.58 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [00:08<00:11, 81.64it/s, est. speed input: 136529.63 toks/s, output: 133.33 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [00:08<00:11, 81.64it/s, est. speed input: 135308.18 toks/s, output: 132.14 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [00:08<00:11, 81.47it/s, est. speed input: 134120.30 toks/s, output: 130.98 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [00:08<00:10, 82.72it/s, est. speed input: 133148.79 toks/s, output: 130.03 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [00:09<00:10, 82.21it/s, est. speed input: 132056.75 toks/s, output: 128.96 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [00:09<00:10, 82.01it/s, est. speed input: 131028.80 toks/s, output: 127.96 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [00:09<00:10, 81.91it/s, est. speed input: 130047.99 toks/s, output: 127.00 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [00:09<00:10, 81.49it/s, est. speed input: 129070.13 toks/s, output: 126.04 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [00:09<00:10, 81.34it/s, est. speed input: 128144.89 toks/s, output: 125.14 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [00:10<00:09, 81.31it/s, est. speed input: 127265.29 toks/s, output: 124.28 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [00:10<00:09, 82.56it/s, est. speed input: 126543.29 toks/s, output: 123.58 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [00:10<00:09, 82.13it/s, est. speed input: 125722.73 toks/s, output: 122.78 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [00:10<00:09, 81.75it/s, est. speed input: 124924.95 toks/s, output: 122.00 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [00:10<00:09, 81.52it/s, est. speed input: 124159.26 toks/s, output: 121.25 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [00:11<00:08, 81.35it/s, est. speed input: 123420.11 toks/s, output: 120.53 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [00:11<00:08, 81.14it/s, est. speed input: 122699.48 toks/s, output: 119.82 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [00:11<00:08, 81.25it/s, est. speed input: 122025.01 toks/s, output: 119.16 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [00:11<00:08, 81.27it/s, est. speed input: 121369.65 toks/s, output: 118.52 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [00:11<00:08, 81.23it/s, est. speed input: 120731.31 toks/s, output: 117.90 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [00:12<00:07, 81.21it/s, est. speed input: 120113.87 toks/s, output: 117.30 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [00:12<00:07, 81.34it/s, est. speed input: 119528.38 toks/s, output: 116.73 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [00:12<00:07, 81.30it/s, est. speed input: 118950.98 toks/s, output: 116.16 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [00:12<00:07, 81.26it/s, est. speed input: 118390.60 toks/s, output: 115.62 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [00:12<00:07, 81.26it/s, est. speed input: 117850.22 toks/s, output: 115.09 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [00:13<00:06, 81.28it/s, est. speed input: 117326.92 toks/s, output: 114.58 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [00:13<00:06, 81.31it/s, est. speed input: 116820.81 toks/s, output: 114.08 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [00:13<00:06, 81.26it/s, est. speed input: 116324.07 toks/s, output: 113.60 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [00:13<00:06, 81.23it/s, est. speed input: 115842.88 toks/s, output: 113.13 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [00:13<00:06, 81.19it/s, est. speed input: 115373.26 toks/s, output: 112.67 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [00:13<00:05, 81.25it/s, est. speed input: 114923.54 toks/s, output: 112.23 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [00:14<00:05, 82.67it/s, est. speed input: 114573.79 toks/s, output: 111.89 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [00:14<00:05, 82.25it/s, est. speed input: 114144.87 toks/s, output: 111.47 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [00:14<00:05, 82.00it/s, est. speed input: 113729.52 toks/s, output: 111.06 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [00:14<00:05, 81.72it/s, est. speed input: 113319.23 toks/s, output: 110.66 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [00:14<00:04, 81.59it/s, est. speed input: 112923.91 toks/s, output: 110.28 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [00:15<00:04, 81.45it/s, est. speed input: 112534.96 toks/s, output: 109.90 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [00:15<00:04, 81.43it/s, est. speed input: 112161.52 toks/s, output: 109.53 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [00:15<00:04, 81.40it/s, est. speed input: 111795.97 toks/s, output: 109.18 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [00:15<00:04, 81.28it/s, est. speed input: 111434.25 toks/s, output: 108.82 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [00:15<00:03, 81.34it/s, est. speed input: 111089.26 toks/s, output: 108.49 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [00:16<00:03, 81.22it/s, est. speed input: 110744.25 toks/s, output: 108.15 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [00:16<00:03, 81.23it/s, est. speed input: 110412.30 toks/s, output: 107.82 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [00:16<00:03, 81.18it/s, est. speed input: 110085.39 toks/s, output: 107.51 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [00:16<00:03, 81.24it/s, est. speed input: 109771.52 toks/s, output: 107.20 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [00:16<00:02, 81.23it/s, est. speed input: 109461.28 toks/s, output: 106.90 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [00:17<00:02, 81.33it/s, est. speed input: 109164.01 toks/s, output: 106.61 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [00:17<00:02, 81.15it/s, est. speed input: 108861.11 toks/s, output: 106.31 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [00:17<00:02, 81.15it/s, est. speed input: 108571.10 toks/s, output: 106.03 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [00:17<00:02, 82.43it/s, est. speed input: 108350.08 toks/s, output: 105.81 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [00:17<00:01, 82.08it/s, est. speed input: 108073.74 toks/s, output: 105.54 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [00:18<00:01, 81.72it/s, est. speed input: 107797.91 toks/s, output: 105.27 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [00:18<00:01, 81.53it/s, est. speed input: 107531.10 toks/s, output: 105.01 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [00:18<00:01, 81.35it/s, est. speed input: 107267.61 toks/s, output: 104.75 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [00:18<00:01, 82.40it/s, est. speed input: 107063.29 toks/s, output: 104.55 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [00:18<00:00, 81.92it/s, est. speed input: 106808.73 toks/s, output: 104.31 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [00:19<00:00, 81.70it/s, est. speed input: 106564.42 toks/s, output: 104.07 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [00:19<00:00, 81.55it/s, est. speed input: 106325.09 toks/s, output: 103.83 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [00:19<00:00, 81.43it/s, est. speed input: 106089.88 toks/s, output: 103.60 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [00:19<00:00, 82.92it/s, est. speed input: 105926.38 toks/s, output: 103.44 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:19<00:00, 82.92it/s, est. speed input: 106653.32 toks/s, output: 104.15 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:19<00:00, 104.15it/s, est. speed input: 106653.32 toks/s, output: 104.15 toks/s]
[rank0]:[W128 00:09:58.441995996 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())


========== M=32768 ==========
Time: 2026-01-28 00:10:01
Backend: cuSPARSELt (2:4)
Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_4
Params: prompt_len=1024, output_len=1, num_prompts=4096, max_num_seqs=32
Command: vllm bench throughput --model /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_4 --dataset-name random --input-len 1024 --output-len 1 --num-prompts 4096 --max-num-seqs 32 --max-model-len 1025 --max-num-batched-tokens 32768 --no-enable-chunked-prefill --gpu-memory-utilization 0.8 --disable-log-stats --output-json /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/A100_cc80_INT8_py312_cu129_x86_64/cusparselt/2_4/json/BitNet-2B-INT8_M32768.json

STDOUT:
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:10:31 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=2223003) [INFO] Loading compress extension: cusparselt_compress_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=2223003) WARNING 01-28 00:10:50 [backends.py:609] Failed to read file <frozen os>
Throughput: 82.22 requests/s, 84273.00 total tokens/s, 82.22 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096

STDERR:
[2026-01-28 00:10:31] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:10:31] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:10:31] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:10:31] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:10:31] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:10:31] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:10:31] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:10:31] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:10:31] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:10:31] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:10:31] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:10:31] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:10:31] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:10:31] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:10:39] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:10:39] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:10:39] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:10:39] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:10:39] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:10:39] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:10:39] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:10:39] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:10:39] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:10:39] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:10:39] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:10:39] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:10:39] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:10:39] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=2223003) [2026-01-28 00:10:40] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=2223003) [2026-01-28 00:10:40] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_A100_cc80_py312_cu129_x86_64.so
(EngineCore_DP0 pid=2223003) [2026-01-28 00:10:40] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=2223003) [2026-01-28 00:10:40] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=2223003) [2026-01-28 00:10:40] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=2223003) [2026-01-28 00:10:40] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=2223003) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=2223003) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.76it/s]
(EngineCore_DP0 pid=2223003) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.76it/s]
(EngineCore_DP0 pid=2223003) 
(EngineCore_DP0 pid=2223003) [2026-01-28 00:10:41] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 2560] -> 1D uint8
(EngineCore_DP0 pid=2223003) [2026-01-28 00:10:41] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7372800 bytes
(EngineCore_DP0 pid=2223003) [2026-01-28 00:10:41] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 2560] -> 1D uint8
(EngineCore_DP0 pid=2223003) [2026-01-28 00:10:41] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4915200 bytes
(EngineCore_DP0 pid=2223003) [2026-01-28 00:10:41] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 2560] -> 1D uint8
(EngineCore_DP0 pid=2223003) [2026-01-28 00:10:41] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 26542080 bytes
(EngineCore_DP0 pid=2223003) [2026-01-28 00:10:41] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 6912] -> 1D uint8
(EngineCore_DP0 pid=2223003) [2026-01-28 00:10:41] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 13271040 bytes
(EngineCore_DP0 pid=2223003) [rank0]:W0128 00:11:00.148000 2223003 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=2223003) [rank0]:W0128 00:11:00.274000 2223003 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=2223003) [rank0]:W0128 00:11:01.776000 2223003 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=2223003) [rank0]:W0128 00:11:01.977000 2223003 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=2223003) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   9%|▉         | 1/11 [00:00<00:01,  9.31it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  18%|█▊        | 2/11 [00:00<00:00,  9.07it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  36%|███▋      | 4/11 [00:00<00:00,  9.53it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  45%|████▌     | 5/11 [00:00<00:00,  9.49it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  55%|█████▍    | 6/11 [00:00<00:00,  9.38it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  64%|██████▎   | 7/11 [00:00<00:00,  9.35it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  73%|███████▎  | 8/11 [00:00<00:00,  9.36it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  82%|████████▏ | 9/11 [00:00<00:00,  9.32it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  91%|█████████ | 10/11 [00:01<00:00,  9.36it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00,  8.99it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00,  9.25it/s]
(EngineCore_DP0 pid=2223003) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  14%|█▍        | 1/7 [00:00<00:00,  8.14it/s]
Capturing CUDA graphs (decode, FULL):  43%|████▎     | 3/7 [00:00<00:00,  9.36it/s]
Capturing CUDA graphs (decode, FULL):  57%|█████▋    | 4/7 [00:00<00:00,  9.53it/s]
Capturing CUDA graphs (decode, FULL):  71%|███████▏  | 5/7 [00:00<00:00,  9.59it/s]
Capturing CUDA graphs (decode, FULL):  86%|████████▌ | 6/7 [00:00<00:00,  9.69it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00,  9.62it/s]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   1%|          | 34/4096 [00:00<00:12, 336.97it/s]
Adding requests:   2%|▏         | 70/4096 [00:00<00:11, 348.11it/s]
Adding requests:   3%|▎         | 105/4096 [00:00<00:11, 348.86it/s]
Adding requests:   3%|▎         | 141/4096 [00:00<00:11, 348.66it/s]
Adding requests:   4%|▍         | 177/4096 [00:00<00:11, 350.75it/s]
Adding requests:   5%|▌         | 213/4096 [00:00<00:10, 353.50it/s]
Adding requests:   6%|▌         | 252/4096 [00:00<00:10, 363.47it/s]
Adding requests:   7%|▋         | 289/4096 [00:00<00:10, 360.12it/s]
Adding requests:   8%|▊         | 327/4096 [00:00<00:10, 363.88it/s]
Adding requests:   9%|▉         | 366/4096 [00:01<00:10, 369.79it/s]
Adding requests:  10%|▉         | 405/4096 [00:01<00:09, 375.33it/s]
Adding requests:  11%|█         | 443/4096 [00:01<00:09, 376.73it/s]
Adding requests:  12%|█▏        | 481/4096 [00:01<00:09, 375.81it/s]
Adding requests:  13%|█▎        | 519/4096 [00:01<00:09, 363.40it/s]
Adding requests:  14%|█▎        | 556/4096 [00:01<00:09, 359.49it/s]
Adding requests:  14%|█▍        | 593/4096 [00:01<00:09, 359.88it/s]
Adding requests:  15%|█▌        | 630/4096 [00:01<00:09, 359.82it/s]
Adding requests:  16%|█▋        | 667/4096 [00:01<00:09, 361.89it/s]
Adding requests:  17%|█▋        | 706/4096 [00:01<00:09, 367.24it/s]
Adding requests:  18%|█▊        | 743/4096 [00:02<00:09, 365.29it/s]
Adding requests:  19%|█▉        | 782/4096 [00:02<00:08, 372.25it/s]
Adding requests:  20%|██        | 820/4096 [00:02<00:08, 368.44it/s]
Adding requests:  21%|██        | 858/4096 [00:02<00:08, 369.39it/s]
Adding requests:  22%|██▏       | 898/4096 [00:02<00:08, 376.66it/s]
Adding requests:  23%|██▎       | 936/4096 [00:02<00:08, 372.17it/s]
Adding requests:  24%|██▍       | 974/4096 [00:02<00:08, 371.79it/s]
Adding requests:  25%|██▍       | 1012/4096 [00:02<00:08, 371.43it/s]
Adding requests:  26%|██▌       | 1050/4096 [00:02<00:08, 373.56it/s]
Adding requests:  27%|██▋       | 1088/4096 [00:02<00:08, 358.46it/s]
Adding requests:  28%|██▊       | 1127/4096 [00:03<00:08, 367.43it/s]
Adding requests:  28%|██▊       | 1165/4096 [00:03<00:07, 371.07it/s]
Adding requests:  29%|██▉       | 1206/4096 [00:03<00:07, 380.86it/s]
Adding requests:  30%|███       | 1245/4096 [00:03<00:07, 372.47it/s]
Adding requests:  31%|███▏      | 1283/4096 [00:03<00:07, 367.98it/s]
Adding requests:  32%|███▏      | 1321/4096 [00:03<00:07, 371.25it/s]
Adding requests:  33%|███▎      | 1359/4096 [00:03<00:07, 371.73it/s]
Adding requests:  34%|███▍      | 1398/4096 [00:03<00:07, 375.13it/s]
Adding requests:  35%|███▌      | 1436/4096 [00:03<00:07, 371.97it/s]
Adding requests:  36%|███▌      | 1475/4096 [00:04<00:06, 374.49it/s]
Adding requests:  37%|███▋      | 1514/4096 [00:04<00:06, 378.10it/s]
Adding requests:  38%|███▊      | 1554/4096 [00:04<00:06, 383.76it/s]
Adding requests:  39%|███▉      | 1594/4096 [00:04<00:06, 386.56it/s]
Adding requests:  40%|███▉      | 1633/4096 [00:04<00:06, 386.51it/s]
Adding requests:  41%|████      | 1672/4096 [00:04<00:06, 379.03it/s]
Adding requests:  42%|████▏     | 1710/4096 [00:04<00:06, 375.44it/s]
Adding requests:  43%|████▎     | 1748/4096 [00:04<00:06, 372.78it/s]
Adding requests:  44%|████▎     | 1786/4096 [00:04<00:06, 371.79it/s]
Adding requests:  45%|████▍     | 1824/4096 [00:04<00:06, 373.30it/s]
Adding requests:  45%|████▌     | 1862/4096 [00:05<00:06, 372.21it/s]
Adding requests:  46%|████▋     | 1900/4096 [00:05<00:05, 373.36it/s]
Adding requests:  47%|████▋     | 1938/4096 [00:05<00:05, 372.63it/s]
Adding requests:  48%|████▊     | 1977/4096 [00:05<00:05, 375.08it/s]
Adding requests:  49%|████▉     | 2015/4096 [00:05<00:05, 374.54it/s]
Adding requests:  50%|█████     | 2054/4096 [00:05<00:05, 378.81it/s]
Adding requests:  51%|█████     | 2092/4096 [00:05<00:05, 377.86it/s]
Adding requests:  52%|█████▏    | 2130/4096 [00:05<00:05, 368.03it/s]
Adding requests:  53%|█████▎    | 2167/4096 [00:05<00:05, 363.09it/s]
Adding requests:  54%|█████▍    | 2204/4096 [00:05<00:05, 359.62it/s]
Adding requests:  55%|█████▍    | 2242/4096 [00:06<00:05, 365.26it/s]
Adding requests:  56%|█████▌    | 2279/4096 [00:06<00:05, 353.32it/s]
Adding requests:  57%|█████▋    | 2317/4096 [00:06<00:04, 358.52it/s]
Adding requests:  57%|█████▋    | 2353/4096 [00:06<00:04, 357.46it/s]
Adding requests:  58%|█████▊    | 2389/4096 [00:06<00:04, 357.99it/s]
Adding requests:  59%|█████▉    | 2426/4096 [00:06<00:04, 361.18it/s]
Adding requests:  60%|██████    | 2463/4096 [00:06<00:04, 360.22it/s]
Adding requests:  61%|██████    | 2500/4096 [00:06<00:04, 362.36it/s]
Adding requests:  62%|██████▏   | 2539/4096 [00:06<00:04, 370.15it/s]
Adding requests:  63%|██████▎   | 2579/4096 [00:06<00:04, 378.08it/s]
Adding requests:  64%|██████▍   | 2619/4096 [00:07<00:03, 382.40it/s]
Adding requests:  65%|██████▍   | 2659/4096 [00:07<00:03, 386.76it/s]
Adding requests:  66%|██████▌   | 2698/4096 [00:07<00:03, 383.71it/s]
Adding requests:  67%|██████▋   | 2737/4096 [00:07<00:03, 380.55it/s]
Adding requests:  68%|██████▊   | 2776/4096 [00:07<00:03, 374.94it/s]
Adding requests:  69%|██████▊   | 2814/4096 [00:07<00:03, 369.57it/s]
Adding requests:  70%|██████▉   | 2851/4096 [00:07<00:03, 369.27it/s]
Adding requests:  71%|███████   | 2889/4096 [00:07<00:03, 370.31it/s]
Adding requests:  71%|███████▏  | 2927/4096 [00:07<00:03, 364.46it/s]
Adding requests:  72%|███████▏  | 2964/4096 [00:08<00:03, 362.23it/s]
Adding requests:  73%|███████▎  | 3002/4096 [00:08<00:02, 365.70it/s]
Adding requests:  74%|███████▍  | 3039/4096 [00:08<00:02, 360.30it/s]
Adding requests:  75%|███████▌  | 3076/4096 [00:08<00:02, 359.73it/s]
Adding requests:  76%|███████▌  | 3113/4096 [00:08<00:02, 362.38it/s]
Adding requests:  77%|███████▋  | 3150/4096 [00:08<00:02, 359.62it/s]
Adding requests:  78%|███████▊  | 3188/4096 [00:08<00:02, 362.62it/s]
Adding requests:  79%|███████▊  | 3225/4096 [00:08<00:02, 360.24it/s]
Adding requests:  80%|███████▉  | 3262/4096 [00:08<00:02, 361.43it/s]
Adding requests:  81%|████████  | 3299/4096 [00:08<00:02, 363.47it/s]
Adding requests:  81%|████████▏ | 3336/4096 [00:09<00:02, 362.98it/s]
Adding requests:  82%|████████▏ | 3376/4096 [00:09<00:01, 372.53it/s]
Adding requests:  83%|████████▎ | 3414/4096 [00:09<00:01, 373.31it/s]
Adding requests:  84%|████████▍ | 3452/4096 [00:09<00:01, 369.77it/s]
Adding requests:  85%|████████▌ | 3489/4096 [00:09<00:01, 363.54it/s]
Adding requests:  86%|████████▌ | 3526/4096 [00:09<00:01, 363.45it/s]
Adding requests:  87%|████████▋ | 3563/4096 [00:09<00:01, 359.39it/s]
Adding requests:  88%|████████▊ | 3599/4096 [00:09<00:01, 346.39it/s]
Adding requests:  89%|████████▊ | 3634/4096 [00:09<00:01, 344.32it/s]
Adding requests:  90%|████████▉ | 3669/4096 [00:09<00:01, 345.68it/s]
Adding requests:  90%|█████████ | 3705/4096 [00:10<00:01, 346.91it/s]
Adding requests:  91%|█████████▏| 3740/4096 [00:10<00:01, 344.38it/s]
Adding requests:  92%|█████████▏| 3778/4096 [00:10<00:00, 353.53it/s]
Adding requests:  93%|█████████▎| 3814/4096 [00:10<00:00, 353.15it/s]
Adding requests:  94%|█████████▍| 3850/4096 [00:10<00:00, 354.75it/s]
Adding requests:  95%|█████████▍| 3886/4096 [00:10<00:00, 356.03it/s]
Adding requests:  96%|█████████▌| 3924/4096 [00:10<00:00, 361.75it/s]
Adding requests:  97%|█████████▋| 3961/4096 [00:10<00:00, 356.18it/s]
Adding requests:  98%|█████████▊| 3997/4096 [00:10<00:00, 350.85it/s]
Adding requests:  98%|█████████▊| 4033/4096 [00:11<00:00, 349.76it/s]
Adding requests:  99%|█████████▉| 4068/4096 [00:11<00:00, 348.56it/s]
Adding requests: 100%|██████████| 4096/4096 [00:11<00:00, 365.74it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  23%|██▎       | 923/4096 [00:00<00:01, 2124.01it/s, est. speed input: 2175120.40 toks/s, output: 2124.05 toks/s]
Processed prompts:  28%|██▊       | 1136/4096 [00:02<00:09, 327.15it/s, est. speed input: 422025.43 toks/s, output: 412.13 toks/s]  
Processed prompts:  30%|███       | 1229/4096 [00:03<00:12, 231.86it/s, est. speed input: 321625.13 toks/s, output: 314.09 toks/s]
Processed prompts:  31%|███▏      | 1284/4096 [00:04<00:14, 189.00it/s, est. speed input: 280985.24 toks/s, output: 274.40 toks/s]
Processed prompts:  32%|███▏      | 1320/4096 [00:05<00:16, 173.22it/s, est. speed input: 266619.23 toks/s, output: 260.37 toks/s]
Processed prompts:  33%|███▎      | 1347/4096 [00:05<00:17, 153.67it/s, est. speed input: 252686.65 toks/s, output: 246.76 toks/s]
Processed prompts:  33%|███▎      | 1371/4096 [00:05<00:20, 134.26it/s, est. speed input: 240136.05 toks/s, output: 234.51 toks/s]
Processed prompts:  34%|███▍      | 1403/4096 [00:06<00:22, 122.12it/s, est. speed input: 230386.21 toks/s, output: 224.99 toks/s]
Processed prompts:  35%|███▌      | 1435/4096 [00:06<00:23, 112.15it/s, est. speed input: 221789.18 toks/s, output: 216.59 toks/s]
Processed prompts:  36%|███▌      | 1467/4096 [00:07<00:25, 104.36it/s, est. speed input: 214185.24 toks/s, output: 209.16 toks/s]
Processed prompts:  37%|███▋      | 1499/4096 [00:07<00:26, 98.35it/s, est. speed input: 207365.08 toks/s, output: 202.50 toks/s] 
Processed prompts:  37%|███▋      | 1531/4096 [00:07<00:27, 93.79it/s, est. speed input: 201200.00 toks/s, output: 196.48 toks/s]
Processed prompts:  38%|███▊      | 1563/4096 [00:08<00:28, 90.40it/s, est. speed input: 195604.69 toks/s, output: 191.02 toks/s]
Processed prompts:  39%|███▉      | 1595/4096 [00:08<00:28, 88.71it/s, est. speed input: 190776.40 toks/s, output: 186.30 toks/s]
Processed prompts:  40%|███▉      | 1627/4096 [00:08<00:28, 86.74it/s, est. speed input: 186122.49 toks/s, output: 181.76 toks/s]
Processed prompts:  41%|████      | 1659/4096 [00:09<00:28, 85.35it/s, est. speed input: 181861.46 toks/s, output: 177.60 toks/s]
Processed prompts:  41%|████▏     | 1691/4096 [00:09<00:28, 84.40it/s, est. speed input: 177948.11 toks/s, output: 173.78 toks/s]
Processed prompts:  42%|████▏     | 1723/4096 [00:10<00:28, 83.71it/s, est. speed input: 174330.54 toks/s, output: 170.24 toks/s]
Processed prompts:  43%|████▎     | 1755/4096 [00:10<00:28, 83.26it/s, est. speed input: 170992.10 toks/s, output: 166.98 toks/s]
Processed prompts:  44%|████▎     | 1787/4096 [00:10<00:27, 82.96it/s, est. speed input: 167894.40 toks/s, output: 163.96 toks/s]
Processed prompts:  44%|████▍     | 1819/4096 [00:11<00:27, 82.62it/s, est. speed input: 164981.24 toks/s, output: 161.11 toks/s]
Processed prompts:  45%|████▌     | 1851/4096 [00:11<00:27, 83.13it/s, est. speed input: 162427.19 toks/s, output: 158.62 toks/s]
Processed prompts:  46%|████▌     | 1883/4096 [00:12<00:26, 82.82it/s, est. speed input: 159894.35 toks/s, output: 156.15 toks/s]
Processed prompts:  47%|████▋     | 1915/4096 [00:12<00:26, 82.52it/s, est. speed input: 157503.37 toks/s, output: 153.81 toks/s]
Processed prompts:  48%|████▊     | 1947/4096 [00:12<00:25, 83.06it/s, est. speed input: 155400.35 toks/s, output: 151.76 toks/s]
Processed prompts:  48%|████▊     | 1979/4096 [00:13<00:25, 82.71it/s, est. speed input: 153286.95 toks/s, output: 149.69 toks/s]
Processed prompts:  49%|████▉     | 2011/4096 [00:13<00:25, 82.47it/s, est. speed input: 151294.93 toks/s, output: 147.75 toks/s]
Processed prompts:  50%|████▉     | 2043/4096 [00:14<00:24, 82.26it/s, est. speed input: 149406.69 toks/s, output: 145.90 toks/s]
Processed prompts:  51%|█████     | 2075/4096 [00:14<00:24, 82.20it/s, est. speed input: 147634.68 toks/s, output: 144.17 toks/s]
Processed prompts:  51%|█████▏    | 2107/4096 [00:14<00:24, 82.06it/s, est. speed input: 145942.41 toks/s, output: 142.52 toks/s]
Processed prompts:  52%|█████▏    | 2139/4096 [00:15<00:23, 81.99it/s, est. speed input: 144339.88 toks/s, output: 140.96 toks/s]
Processed prompts:  53%|█████▎    | 2171/4096 [00:15<00:23, 81.93it/s, est. speed input: 142816.85 toks/s, output: 139.47 toks/s]
Processed prompts:  54%|█████▍    | 2203/4096 [00:15<00:23, 81.91it/s, est. speed input: 141372.72 toks/s, output: 138.06 toks/s]
Processed prompts:  55%|█████▍    | 2235/4096 [00:16<00:22, 83.36it/s, est. speed input: 140193.14 toks/s, output: 136.91 toks/s]
Processed prompts:  55%|█████▌    | 2267/4096 [00:16<00:22, 82.99it/s, est. speed input: 138884.93 toks/s, output: 135.63 toks/s]
Processed prompts:  56%|█████▌    | 2299/4096 [00:17<00:21, 83.28it/s, est. speed input: 137705.66 toks/s, output: 134.48 toks/s]
Processed prompts:  57%|█████▋    | 2331/4096 [00:17<00:21, 83.47it/s, est. speed input: 136576.00 toks/s, output: 133.37 toks/s]
Processed prompts:  58%|█████▊    | 2363/4096 [00:17<00:20, 84.38it/s, est. speed input: 135583.96 toks/s, output: 132.41 toks/s]
Processed prompts:  58%|█████▊    | 2395/4096 [00:18<00:20, 83.60it/s, est. speed input: 134473.83 toks/s, output: 131.32 toks/s]
Processed prompts:  59%|█████▉    | 2427/4096 [00:18<00:20, 83.07it/s, est. speed input: 133410.70 toks/s, output: 130.28 toks/s]
Processed prompts:  60%|██████    | 2459/4096 [00:19<00:19, 82.68it/s, est. speed input: 132388.84 toks/s, output: 129.29 toks/s]
Processed prompts:  61%|██████    | 2491/4096 [00:19<00:19, 83.04it/s, est. speed input: 131475.35 toks/s, output: 128.39 toks/s]
Processed prompts:  62%|██████▏   | 2523/4096 [00:19<00:19, 82.65it/s, est. speed input: 130530.63 toks/s, output: 127.47 toks/s]
Processed prompts:  62%|██████▏   | 2555/4096 [00:20<00:18, 82.42it/s, est. speed input: 129627.13 toks/s, output: 126.59 toks/s]
Processed prompts:  63%|██████▎   | 2587/4096 [00:20<00:18, 82.82it/s, est. speed input: 128812.45 toks/s, output: 125.79 toks/s]
Processed prompts:  64%|██████▍   | 2619/4096 [00:20<00:17, 82.51it/s, est. speed input: 127971.84 toks/s, output: 124.97 toks/s]
Processed prompts:  65%|██████▍   | 2651/4096 [00:21<00:17, 82.33it/s, est. speed input: 127164.53 toks/s, output: 124.18 toks/s]
Processed prompts:  66%|██████▌   | 2683/4096 [00:21<00:17, 82.16it/s, est. speed input: 126382.60 toks/s, output: 123.42 toks/s]
Processed prompts:  66%|██████▋   | 2715/4096 [00:22<00:16, 82.04it/s, est. speed input: 125627.87 toks/s, output: 122.68 toks/s]
Processed prompts:  67%|██████▋   | 2747/4096 [00:22<00:16, 81.91it/s, est. speed input: 124895.42 toks/s, output: 121.97 toks/s]
Processed prompts:  68%|██████▊   | 2779/4096 [00:22<00:16, 81.93it/s, est. speed input: 124197.78 toks/s, output: 121.29 toks/s]
Processed prompts:  69%|██████▊   | 2811/4096 [00:23<00:15, 81.90it/s, est. speed input: 123520.17 toks/s, output: 120.63 toks/s]
Processed prompts:  69%|██████▉   | 2843/4096 [00:23<00:15, 81.82it/s, est. speed input: 122859.27 toks/s, output: 119.98 toks/s]
Processed prompts:  70%|███████   | 2875/4096 [00:24<00:14, 81.81it/s, est. speed input: 122224.33 toks/s, output: 119.36 toks/s]
Processed prompts:  71%|███████   | 2907/4096 [00:24<00:14, 81.74it/s, est. speed input: 121604.54 toks/s, output: 118.75 toks/s]
Processed prompts:  72%|███████▏  | 2939/4096 [00:24<00:14, 81.77it/s, est. speed input: 121010.29 toks/s, output: 118.17 toks/s]
Processed prompts:  73%|███████▎  | 2971/4096 [00:25<00:13, 81.74it/s, est. speed input: 120430.14 toks/s, output: 117.61 toks/s]
Processed prompts:  73%|███████▎  | 3003/4096 [00:25<00:13, 81.76it/s, est. speed input: 119870.99 toks/s, output: 117.06 toks/s]
Processed prompts:  74%|███████▍  | 3035/4096 [00:26<00:12, 81.75it/s, est. speed input: 119327.01 toks/s, output: 116.53 toks/s]
Processed prompts:  75%|███████▍  | 3067/4096 [00:26<00:12, 81.66it/s, est. speed input: 118793.35 toks/s, output: 116.01 toks/s]
Processed prompts:  76%|███████▌  | 3099/4096 [00:26<00:12, 81.61it/s, est. speed input: 118276.28 toks/s, output: 115.50 toks/s]
Processed prompts:  76%|███████▋  | 3131/4096 [00:27<00:11, 82.31it/s, est. speed input: 117824.12 toks/s, output: 115.06 toks/s]
Processed prompts:  77%|███████▋  | 3163/4096 [00:27<00:11, 82.12it/s, est. speed input: 117338.81 toks/s, output: 114.59 toks/s]
Processed prompts:  78%|███████▊  | 3195/4096 [00:27<00:10, 82.01it/s, est. speed input: 116869.13 toks/s, output: 114.13 toks/s]
Processed prompts:  79%|███████▉  | 3227/4096 [00:28<00:10, 81.90it/s, est. speed input: 116409.70 toks/s, output: 113.68 toks/s]
Processed prompts:  80%|███████▉  | 3259/4096 [00:28<00:10, 81.72it/s, est. speed input: 115956.13 toks/s, output: 113.24 toks/s]
Processed prompts:  80%|████████  | 3291/4096 [00:29<00:09, 81.76it/s, est. speed input: 115525.19 toks/s, output: 112.82 toks/s]
Processed prompts:  81%|████████  | 3323/4096 [00:29<00:09, 81.75it/s, est. speed input: 115103.82 toks/s, output: 112.41 toks/s]
Processed prompts:  82%|████████▏ | 3355/4096 [00:29<00:09, 81.68it/s, est. speed input: 114689.55 toks/s, output: 112.00 toks/s]
Processed prompts:  83%|████████▎ | 3387/4096 [00:30<00:08, 81.63it/s, est. speed input: 114285.36 toks/s, output: 111.61 toks/s]
Processed prompts:  83%|████████▎ | 3419/4096 [00:30<00:08, 81.63it/s, est. speed input: 113894.22 toks/s, output: 111.22 toks/s]
Processed prompts:  84%|████████▍ | 3451/4096 [00:31<00:07, 81.57it/s, est. speed input: 113509.03 toks/s, output: 110.85 toks/s]
Processed prompts:  85%|████████▌ | 3483/4096 [00:31<00:07, 83.02it/s, est. speed input: 113217.65 toks/s, output: 110.56 toks/s]
Processed prompts:  86%|████████▌ | 3515/4096 [00:31<00:07, 82.54it/s, est. speed input: 112850.69 toks/s, output: 110.21 toks/s]
Processed prompts:  87%|████████▋ | 3547/4096 [00:32<00:06, 82.25it/s, est. speed input: 112494.45 toks/s, output: 109.86 toks/s]
Processed prompts:  87%|████████▋ | 3579/4096 [00:32<00:06, 82.04it/s, est. speed input: 112146.38 toks/s, output: 109.52 toks/s]
Processed prompts:  88%|████████▊ | 3611/4096 [00:33<00:05, 81.82it/s, est. speed input: 111802.74 toks/s, output: 109.18 toks/s]
Processed prompts:  89%|████████▉ | 3643/4096 [00:33<00:05, 81.74it/s, est. speed input: 111471.24 toks/s, output: 108.86 toks/s]
Processed prompts:  90%|████████▉ | 3675/4096 [00:33<00:05, 81.63it/s, est. speed input: 111144.39 toks/s, output: 108.54 toks/s]
Processed prompts:  91%|█████████ | 3707/4096 [00:34<00:04, 81.60it/s, est. speed input: 110827.50 toks/s, output: 108.23 toks/s]
Processed prompts:  91%|█████████▏| 3739/4096 [00:34<00:04, 82.19it/s, est. speed input: 110548.77 toks/s, output: 107.96 toks/s]
Processed prompts:  92%|█████████▏| 3771/4096 [00:35<00:03, 81.91it/s, est. speed input: 110241.48 toks/s, output: 107.66 toks/s]
Processed prompts:  93%|█████████▎| 3803/4096 [00:35<00:03, 81.75it/s, est. speed input: 109942.82 toks/s, output: 107.37 toks/s]
Processed prompts:  94%|█████████▎| 3835/4096 [00:35<00:03, 82.32it/s, est. speed input: 109683.82 toks/s, output: 107.11 toks/s]
Processed prompts:  94%|█████████▍| 3867/4096 [00:36<00:02, 82.00it/s, est. speed input: 109395.93 toks/s, output: 106.83 toks/s]
Processed prompts:  95%|█████████▌| 3899/4096 [00:36<00:02, 81.92it/s, est. speed input: 109120.58 toks/s, output: 106.56 toks/s]
Processed prompts:  96%|█████████▌| 3931/4096 [00:36<00:02, 81.82it/s, est. speed input: 108849.72 toks/s, output: 106.30 toks/s]
Processed prompts:  97%|█████████▋| 3963/4096 [00:37<00:01, 81.74it/s, est. speed input: 108583.47 toks/s, output: 106.04 toks/s]
Processed prompts:  98%|█████████▊| 3995/4096 [00:37<00:01, 81.70it/s, est. speed input: 108323.86 toks/s, output: 105.78 toks/s]
Processed prompts:  98%|█████████▊| 4027/4096 [00:38<00:00, 82.27it/s, est. speed input: 108096.11 toks/s, output: 105.56 toks/s]
Processed prompts:  99%|█████████▉| 4059/4096 [00:38<00:00, 82.25it/s, est. speed input: 107854.66 toks/s, output: 105.33 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [00:38<00:00, 82.25it/s, est. speed input: 108612.22 toks/s, output: 106.07 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [00:38<00:00, 106.07it/s, est. speed input: 108612.22 toks/s, output: 106.07 toks/s]
[rank0]:[W128 00:12:03.038173791 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

