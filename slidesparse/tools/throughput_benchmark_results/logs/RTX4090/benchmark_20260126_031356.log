======================================================================
SlideSparse vLLM Throughput Benchmark Log
Created: 2026-01-26 03:13:56
======================================================================

原始命令:
  /root/vllmbench/slidesparse/tools/throughput_benchmark.py --model qwen2.5-7b-fp8 --backend cublaslt,cusparselt --stage prefill --sparsity 2_4,2_6,2_8,2_10 --M 512,1024,2048,4096,8192,16384,32768,65536

命令行参数:
  --model: qwen2.5-7b-fp8
  --backend: cublaslt,cusparselt
  --sparsity: 2_4,2_6,2_8,2_10
  --stage: prefill
  --M: 512,1024,2048,4096,8192,16384,32768,65536
  --N: None
  --inner-32: False
  --eager: False
  --gpu-id: 0
  --gpu-mem: 0.8
  --dry-run: False
  --list-models: False

硬件信息:
  GPU: RTX4090
  Compute Capability: cc89
  VRAM: 24.0 GB
  CUDA: 12.9
  Python: py312

Backend 环境变量 (初始状态):
  DISABLE_SLIDESPARSE: 未设置
  USE_CUBLASLT: 未设置
  USE_CUSPARSELT: 未设置
  SPARSITY: 未设置
  INNER_DTYPE_32: 未设置

======================================================================


============================================================
  Qwen2.5-7B-FP8 | cuBLASLt | prefill
============================================================

[INFO] Checkpoint: /root/vllmbench/checkpoints/Qwen2.5-7B-FP8
[INFO] Output: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cublaslt

============================================================
[1/8] 测试 M=512
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuBLASLt                                        │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 512
│   M_prefill     = 512 (= 1 x 512)
│   M_decode      = 1
│   batched_tokens = 513 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 512
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 513
│   --max-num-batched-tokens = 513
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 03:14:04 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 03:14:05 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=105291) WARNING 01-26 03:14:11 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=105291) WARNING 01-26 03:14:28 [backends.py:609] Failed to read file <frozen os>
Throughput: 16.18 requests/s, 8301.85 total tokens/s, 16.18 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128


─── STDERR ───
[2026-01-26 03:14:04] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:14:04] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:14:04] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:14:04] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:14:04] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:14:04] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:14:04] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:14:04] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:14:04] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:14:04] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:14:04] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:14:04] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:14:04] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:14:04] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 03:14:10] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:14:10] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:14:10] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:14:10] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:14:10] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:14:10] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:14:10] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:14:10] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:14:10] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:14:10] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:14:10] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:14:10] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:14:10] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:14:10] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=105291) [2026-01-26 03:14:12] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=105291) [2026-01-26 03:14:12] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=105291) [2026-01-26 03:14:12] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=105291) [2026-01-26 03:14:12] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=105291) [2026-01-26 03:14:12] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuBLASLt
(EngineCore_DP0 pid=105291) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=105291) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:02<00:02,  2.90s/it]
(EngineCore_DP0 pid=105291) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:06<00:00,  3.57s/it]
(EngineCore_DP0 pid=105291) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:06<00:00,  3.47s/it]
(EngineCore_DP0 pid=105291) 
(EngineCore_DP0 pid=105291) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  7.96it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  7.89it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  7.90it/s]
(EngineCore_DP0 pid=105291) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.00it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  6.99it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests: 100%|██████████| 128/128 [-1:59:59<00:00, -114.31it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:03, 39.85it/s, est. speed input: 20408.93 toks/s, output: 39.85 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:00<00:05, 21.71it/s, est. speed input: 11931.53 toks/s, output: 23.30 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:00<00:06, 19.16it/s, est. speed input: 10645.19 toks/s, output: 20.79 toks/s]
Processed prompts:  11%|█         | 14/128 [00:00<00:06, 18.14it/s, est. speed input: 10089.72 toks/s, output: 19.71 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:00<00:06, 17.72it/s, est. speed input: 9859.44 toks/s, output: 19.26 toks/s] 
Processed prompts:  14%|█▍        | 18/128 [00:00<00:06, 17.39it/s, est. speed input: 9681.41 toks/s, output: 18.91 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:01<00:06, 17.13it/s, est. speed input: 9540.34 toks/s, output: 18.63 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:01<00:06, 16.89it/s, est. speed input: 9418.30 toks/s, output: 18.39 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:01<00:06, 16.82it/s, est. speed input: 9337.64 toks/s, output: 18.24 toks/s]
Processed prompts:  20%|██        | 26/128 [00:01<00:06, 16.79it/s, est. speed input: 9271.86 toks/s, output: 18.11 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:01<00:06, 16.60it/s, est. speed input: 9193.60 toks/s, output: 17.96 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:01<00:05, 16.54it/s, est. speed input: 9135.76 toks/s, output: 17.84 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:01<00:05, 16.48it/s, est. speed input: 9082.99 toks/s, output: 17.74 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:01<00:05, 16.45it/s, est. speed input: 9038.59 toks/s, output: 17.65 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:02<00:05, 16.50it/s, est. speed input: 9007.52 toks/s, output: 17.59 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:02<00:05, 16.50it/s, est. speed input: 8976.12 toks/s, output: 17.53 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:02<00:05, 16.52it/s, est. speed input: 8950.00 toks/s, output: 17.48 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:02<00:05, 16.41it/s, est. speed input: 8915.67 toks/s, output: 17.41 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:02<00:05, 16.32it/s, est. speed input: 8882.92 toks/s, output: 17.35 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:02<00:05, 16.30it/s, est. speed input: 8856.58 toks/s, output: 17.30 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:02<00:04, 16.34it/s, est. speed input: 8837.14 toks/s, output: 17.26 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:02<00:04, 16.35it/s, est. speed input: 8818.52 toks/s, output: 17.22 toks/s]
Processed prompts:  41%|████      | 52/128 [00:03<00:04, 16.36it/s, est. speed input: 8801.23 toks/s, output: 17.19 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:03<00:04, 16.36it/s, est. speed input: 8784.56 toks/s, output: 17.16 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:03<00:04, 16.40it/s, est. speed input: 8772.24 toks/s, output: 17.13 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:03<00:04, 16.50it/s, est. speed input: 8765.02 toks/s, output: 17.12 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:03<00:04, 16.56it/s, est. speed input: 8757.61 toks/s, output: 17.10 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:03<00:03, 16.51it/s, est. speed input: 8745.65 toks/s, output: 17.08 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:03<00:03, 16.53it/s, est. speed input: 8737.19 toks/s, output: 17.06 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:03<00:03, 16.46it/s, est. speed input: 8724.76 toks/s, output: 17.04 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:03<00:03, 16.57it/s, est. speed input: 8721.42 toks/s, output: 17.03 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:04<00:03, 16.60it/s, est. speed input: 8716.21 toks/s, output: 17.02 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:04<00:03, 16.64it/s, est. speed input: 8711.79 toks/s, output: 17.02 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:04<00:03, 16.73it/s, est. speed input: 8710.93 toks/s, output: 17.01 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:04<00:03, 16.67it/s, est. speed input: 8704.21 toks/s, output: 17.00 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:04<00:03, 16.60it/s, est. speed input: 8696.46 toks/s, output: 16.99 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:04<00:02, 16.52it/s, est. speed input: 8687.85 toks/s, output: 16.97 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:04<00:02, 16.51it/s, est. speed input: 8681.92 toks/s, output: 16.96 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:04<00:02, 16.60it/s, est. speed input: 8679.94 toks/s, output: 16.95 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:05<00:02, 16.65it/s, est. speed input: 8677.82 toks/s, output: 16.95 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:05<00:02, 16.56it/s, est. speed input: 8670.81 toks/s, output: 16.94 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:05<00:02, 16.62it/s, est. speed input: 8668.76 toks/s, output: 16.93 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:05<00:02, 16.69it/s, est. speed input: 8667.83 toks/s, output: 16.93 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:05<00:02, 16.69it/s, est. speed input: 8665.09 toks/s, output: 16.92 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:05<00:01, 16.59it/s, est. speed input: 8659.06 toks/s, output: 16.91 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:05<00:01, 16.48it/s, est. speed input: 8651.57 toks/s, output: 16.90 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:05<00:01, 16.45it/s, est. speed input: 8646.21 toks/s, output: 16.89 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:06<00:01, 16.47it/s, est. speed input: 8642.44 toks/s, output: 16.88 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:06<00:01, 16.41it/s, est. speed input: 8636.14 toks/s, output: 16.87 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:06<00:01, 16.42it/s, est. speed input: 8631.88 toks/s, output: 16.86 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:06<00:01, 16.44it/s, est. speed input: 8628.44 toks/s, output: 16.85 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:06<00:01, 16.38it/s, est. speed input: 8622.64 toks/s, output: 16.84 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:06<00:00, 16.20it/s, est. speed input: 8612.27 toks/s, output: 16.82 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:06<00:00, 16.25it/s, est. speed input: 8608.26 toks/s, output: 16.81 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:06<00:00, 16.30it/s, est. speed input: 8604.63 toks/s, output: 16.81 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:07<00:00, 16.42it/s, est. speed input: 8603.73 toks/s, output: 16.80 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:07<00:00, 16.44it/s, est. speed input: 8600.91 toks/s, output: 16.80 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:07<00:00, 16.52it/s, est. speed input: 8600.33 toks/s, output: 16.80 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:07<00:00, 16.50it/s, est. speed input: 8597.39 toks/s, output: 16.79 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:07<00:00, 16.54it/s, est. speed input: 8595.94 toks/s, output: 16.79 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 16.53it/s, est. speed input: 8593.84 toks/s, output: 16.78 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 16.53it/s, est. speed input: 8593.84 toks/s, output: 16.78 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 16.78it/s, est. speed input: 8593.84 toks/s, output: 16.78 toks/s]
[rank0]:[W126 03:14:46.075047966 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 52.9s

测试结果:
  Requests/s:   16.18
  Tokens/s:     8301.85
  Total Reqs:   128
  Elapsed:      7.91s

  [Prefill 分析]
  Total Prefill Tokens: 65536
  Prefill Tokens/s:     8285.67

============================================================
[2/8] 测试 M=1024
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuBLASLt                                        │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 1024
│   M_prefill     = 1024 (= 1 x 1024)
│   M_decode      = 1
│   batched_tokens = 1025 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 1025
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 03:15:00 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 03:15:01 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=106296) WARNING 01-26 03:15:09 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=106296) WARNING 01-26 03:15:23 [backends.py:609] Failed to read file <frozen os>
Throughput: 14.74 requests/s, 15103.56 total tokens/s, 14.74 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128


─── STDERR ───
[2026-01-26 03:15:00] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:15:00] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:15:00] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:15:00] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:15:00] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:15:00] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:15:00] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:15:00] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:15:00] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:15:00] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:15:00] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:15:00] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:15:00] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:15:00] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 03:15:08] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:15:08] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:15:08] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:15:08] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:15:08] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:15:08] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:15:08] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:15:08] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:15:08] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:15:08] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:15:08] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:15:08] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:15:08] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:15:08] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=106296) [2026-01-26 03:15:10] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=106296) [2026-01-26 03:15:10] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=106296) [2026-01-26 03:15:10] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=106296) [2026-01-26 03:15:10] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=106296) [2026-01-26 03:15:10] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuBLASLt
(EngineCore_DP0 pid=106296) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=106296) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:01<00:01,  1.41s/it]
(EngineCore_DP0 pid=106296) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:04<00:00,  2.27s/it]
(EngineCore_DP0 pid=106296) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:04<00:00,  2.14s/it]
(EngineCore_DP0 pid=106296) 
(EngineCore_DP0 pid=106296) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  8.38it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  8.38it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  8.38it/s]
(EngineCore_DP0 pid=106296) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.17it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.16it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  20%|█▉        | 25/128 [00:00<00:00, 241.16it/s]
Adding requests:  40%|███▉      | 51/128 [00:00<00:00, 248.79it/s]
Adding requests:  62%|██████▏   | 79/128 [00:00<00:00, 260.34it/s]
Adding requests:  84%|████████▎ | 107/128 [00:00<00:00, 264.72it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 260.20it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:02, 46.15it/s, est. speed input: 47272.35 toks/s, output: 46.16 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:00<00:05, 21.02it/s, est. speed input: 23445.03 toks/s, output: 22.89 toks/s]
Processed prompts:  10%|█         | 13/128 [00:00<00:06, 18.64it/s, est. speed input: 20999.84 toks/s, output: 20.51 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:00<00:06, 17.38it/s, est. speed input: 19717.03 toks/s, output: 19.25 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:00<00:06, 16.82it/s, est. speed input: 19153.71 toks/s, output: 18.70 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:01<00:06, 16.37it/s, est. speed input: 18719.90 toks/s, output: 18.28 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:01<00:06, 16.05it/s, est. speed input: 18381.04 toks/s, output: 17.95 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:01<00:06, 15.81it/s, est. speed input: 18108.25 toks/s, output: 17.68 toks/s]
Processed prompts:  20%|██        | 26/128 [00:01<00:06, 15.63it/s, est. speed input: 17882.61 toks/s, output: 17.46 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:01<00:06, 15.49it/s, est. speed input: 17691.61 toks/s, output: 17.28 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:01<00:06, 15.42it/s, est. speed input: 17534.26 toks/s, output: 17.12 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:01<00:06, 15.37it/s, est. speed input: 17400.32 toks/s, output: 16.99 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:02<00:06, 15.32it/s, est. speed input: 17281.16 toks/s, output: 16.88 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:02<00:06, 15.30it/s, est. speed input: 17178.75 toks/s, output: 16.78 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:02<00:05, 15.27it/s, est. speed input: 17085.94 toks/s, output: 16.69 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:02<00:05, 15.25it/s, est. speed input: 17003.04 toks/s, output: 16.60 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:02<00:05, 15.23it/s, est. speed input: 16927.01 toks/s, output: 16.53 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:02<00:05, 15.24it/s, est. speed input: 16863.68 toks/s, output: 16.47 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:02<00:05, 15.24it/s, est. speed input: 16805.28 toks/s, output: 16.41 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:02<00:05, 15.24it/s, est. speed input: 16750.93 toks/s, output: 16.36 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:03<00:05, 15.23it/s, est. speed input: 16701.13 toks/s, output: 16.31 toks/s]
Processed prompts:  41%|████      | 52/128 [00:03<00:04, 15.24it/s, est. speed input: 16656.27 toks/s, output: 16.27 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:03<00:04, 15.25it/s, est. speed input: 16617.07 toks/s, output: 16.23 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:03<00:04, 15.22it/s, est. speed input: 16575.03 toks/s, output: 16.19 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:03<00:04, 15.23it/s, est. speed input: 16540.22 toks/s, output: 16.15 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:03<00:04, 15.23it/s, est. speed input: 16507.12 toks/s, output: 16.12 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:03<00:04, 15.25it/s, est. speed input: 16477.85 toks/s, output: 16.09 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:03<00:04, 15.24it/s, est. speed input: 16448.13 toks/s, output: 16.06 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:04<00:04, 15.24it/s, est. speed input: 16421.23 toks/s, output: 16.04 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:04<00:03, 15.22it/s, est. speed input: 16394.04 toks/s, output: 16.01 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:04<00:03, 15.21it/s, est. speed input: 16368.90 toks/s, output: 15.99 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:04<00:03, 15.22it/s, est. speed input: 16346.13 toks/s, output: 15.96 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:04<00:03, 15.19it/s, est. speed input: 16321.47 toks/s, output: 15.94 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:04<00:03, 15.19it/s, est. speed input: 16300.19 toks/s, output: 15.92 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:04<00:03, 15.20it/s, est. speed input: 16281.37 toks/s, output: 15.90 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:05<00:03, 15.19it/s, est. speed input: 16261.83 toks/s, output: 15.88 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:05<00:03, 15.20it/s, est. speed input: 16244.89 toks/s, output: 15.86 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:05<00:02, 15.21it/s, est. speed input: 16228.90 toks/s, output: 15.85 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:05<00:02, 15.22it/s, est. speed input: 16213.85 toks/s, output: 15.83 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:05<00:02, 15.23it/s, est. speed input: 16199.75 toks/s, output: 15.82 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:05<00:02, 15.22it/s, est. speed input: 16184.97 toks/s, output: 15.81 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:05<00:02, 15.23it/s, est. speed input: 16172.64 toks/s, output: 15.79 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:05<00:02, 15.24it/s, est. speed input: 16160.14 toks/s, output: 15.78 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:06<00:02, 15.23it/s, est. speed input: 16147.98 toks/s, output: 15.77 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:06<00:01, 15.24it/s, est. speed input: 16136.95 toks/s, output: 15.76 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:06<00:01, 15.23it/s, est. speed input: 16125.14 toks/s, output: 15.75 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:06<00:01, 15.24it/s, est. speed input: 16115.40 toks/s, output: 15.74 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:06<00:01, 15.23it/s, est. speed input: 16104.10 toks/s, output: 15.73 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:06<00:01, 15.21it/s, est. speed input: 16093.18 toks/s, output: 15.72 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:06<00:00, 15.21it/s, est. speed input: 19254.07 toks/s, output: 18.80 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:06<00:00, 18.80it/s, est. speed input: 19254.07 toks/s, output: 18.80 toks/s]
[rank0]:[W126 03:15:42.582896740 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 55.8s

测试结果:
  Requests/s:   14.74
  Tokens/s:     15103.56
  Total Reqs:   128
  Elapsed:      8.69s

  [Prefill 分析]
  Total Prefill Tokens: 131072
  Prefill Tokens/s:     15088.83

============================================================
[3/8] 测试 M=2048
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuBLASLt                                        │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 2048
│   M_prefill     = 2048 (= 2 x 1024)
│   M_decode      = 2
│   batched_tokens = 2048 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 256
│   --max-num-seqs           = 2
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 2048
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 03:15:54 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 03:15:55 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=107259) WARNING 01-26 03:16:02 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=107259) WARNING 01-26 03:16:12 [backends.py:609] Failed to read file <frozen os>
Throughput: 15.52 requests/s, 15912.53 total tokens/s, 15.52 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256


─── STDERR ───
[2026-01-26 03:15:54] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:15:54] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:15:54] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:15:54] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:15:54] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:15:54] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:15:54] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:15:54] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:15:54] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:15:54] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:15:54] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:15:54] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:15:54] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:15:54] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 03:16:02] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:16:02] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:16:02] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:16:02] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:16:02] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:16:02] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:16:02] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:16:02] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:16:02] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:16:02] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:16:02] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:16:02] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:16:02] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:16:02] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=107259) [2026-01-26 03:16:03] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=107259) [2026-01-26 03:16:03] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=107259) [2026-01-26 03:16:03] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=107259) [2026-01-26 03:16:03] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=107259) [2026-01-26 03:16:03] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuBLASLt
(EngineCore_DP0 pid=107259) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=107259) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.45it/s]
(EngineCore_DP0 pid=107259) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.16it/s]
(EngineCore_DP0 pid=107259) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.19it/s]
(EngineCore_DP0 pid=107259) 
(EngineCore_DP0 pid=107259) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  33%|███▎      | 1/3 [00:00<00:00,  7.87it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  67%|██████▋   | 2/3 [00:00<00:00,  8.43it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00,  7.72it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00,  7.84it/s]
(EngineCore_DP0 pid=107259) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 1/2 [00:00<00:00,  7.11it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  7.99it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  7.84it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  10%|▉         | 25/256 [00:00<00:00, 242.26it/s]
Adding requests:  20%|██        | 52/256 [00:00<00:00, 255.04it/s]
Adding requests:  31%|███▏      | 80/256 [00:00<00:00, 262.96it/s]
Adding requests:  42%|████▏     | 107/256 [00:00<00:00, 260.56it/s]
Adding requests:  52%|█████▏    | 134/256 [00:00<00:00, 259.61it/s]
Adding requests:  63%|██████▎   | 161/256 [00:00<00:00, 261.23it/s]
Adding requests:  73%|███████▎  | 188/256 [00:00<00:00, 264.01it/s]
Adding requests:  84%|████████▍ | 215/256 [00:00<00:00, 263.95it/s]
Adding requests:  95%|█████████▍| 243/256 [00:00<00:00, 267.01it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 262.44it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▌         | 14/256 [00:00<00:02, 98.09it/s, est. speed input: 100456.66 toks/s, output: 98.09 toks/s]
Processed prompts:   9%|▉         | 24/256 [00:00<00:08, 26.87it/s, est. speed input: 31521.98 toks/s, output: 30.78 toks/s] 
Processed prompts:  11%|█▏        | 29/256 [00:01<00:09, 24.48it/s, est. speed input: 28715.30 toks/s, output: 28.04 toks/s]
Processed prompts:  13%|█▎        | 33/256 [00:01<00:10, 21.65it/s, est. speed input: 26206.52 toks/s, output: 25.59 toks/s]
Processed prompts:  14%|█▍        | 36/256 [00:01<00:11, 18.53it/s, est. speed input: 23857.40 toks/s, output: 23.30 toks/s]
Processed prompts:  15%|█▌        | 39/256 [00:01<00:11, 19.44it/s, est. speed input: 23873.55 toks/s, output: 23.31 toks/s]
Processed prompts:  16%|█▋        | 42/256 [00:01<00:12, 16.80it/s, est. speed input: 22308.22 toks/s, output: 21.79 toks/s]
Processed prompts:  17%|█▋        | 44/256 [00:02<00:12, 16.60it/s, est. speed input: 21927.14 toks/s, output: 21.41 toks/s]
Processed prompts:  18%|█▊        | 46/256 [00:02<00:12, 16.41it/s, est. speed input: 21589.48 toks/s, output: 21.08 toks/s]
Processed prompts:  19%|█▉        | 48/256 [00:02<00:12, 16.26it/s, est. speed input: 21290.02 toks/s, output: 20.79 toks/s]
Processed prompts:  20%|█▉        | 50/256 [00:02<00:12, 16.12it/s, est. speed input: 21020.12 toks/s, output: 20.53 toks/s]
Processed prompts:  20%|██        | 52/256 [00:02<00:12, 16.02it/s, est. speed input: 20775.76 toks/s, output: 20.29 toks/s]
Processed prompts:  21%|██        | 54/256 [00:02<00:12, 15.95it/s, est. speed input: 20557.02 toks/s, output: 20.08 toks/s]
Processed prompts:  22%|██▏       | 56/256 [00:02<00:12, 15.89it/s, est. speed input: 20357.01 toks/s, output: 19.88 toks/s]
Processed prompts:  23%|██▎       | 58/256 [00:02<00:12, 15.86it/s, est. speed input: 20175.74 toks/s, output: 19.70 toks/s]
Processed prompts:  23%|██▎       | 60/256 [00:03<00:12, 15.81it/s, est. speed input: 20006.40 toks/s, output: 19.54 toks/s]
Processed prompts:  24%|██▍       | 62/256 [00:03<00:12, 15.79it/s, est. speed input: 19851.66 toks/s, output: 19.39 toks/s]
Processed prompts:  25%|██▌       | 64/256 [00:03<00:12, 15.77it/s, est. speed input: 19707.73 toks/s, output: 19.25 toks/s]
Processed prompts:  26%|██▌       | 66/256 [00:03<00:12, 15.73it/s, est. speed input: 19571.46 toks/s, output: 19.11 toks/s]
Processed prompts:  27%|██▋       | 68/256 [00:03<00:11, 15.71it/s, est. speed input: 19445.61 toks/s, output: 18.99 toks/s]
Processed prompts:  27%|██▋       | 70/256 [00:03<00:11, 15.71it/s, est. speed input: 19329.43 toks/s, output: 18.88 toks/s]
Processed prompts:  28%|██▊       | 72/256 [00:03<00:11, 15.69it/s, est. speed input: 19218.96 toks/s, output: 18.77 toks/s]
Processed prompts:  29%|██▉       | 74/256 [00:03<00:11, 15.69it/s, est. speed input: 19118.38 toks/s, output: 18.67 toks/s]
Processed prompts:  30%|██▉       | 76/256 [00:04<00:11, 15.68it/s, est. speed input: 19021.96 toks/s, output: 18.58 toks/s]
Processed prompts:  30%|███       | 78/256 [00:04<00:11, 15.70it/s, est. speed input: 18934.39 toks/s, output: 18.49 toks/s]
Processed prompts:  31%|███▏      | 80/256 [00:04<00:11, 15.70it/s, est. speed input: 18850.91 toks/s, output: 18.41 toks/s]
Processed prompts:  32%|███▏      | 82/256 [00:04<00:11, 15.69it/s, est. speed input: 18770.21 toks/s, output: 18.33 toks/s]
Processed prompts:  33%|███▎      | 84/256 [00:04<00:10, 15.68it/s, est. speed input: 18694.10 toks/s, output: 18.26 toks/s]
Processed prompts:  34%|███▎      | 86/256 [00:04<00:10, 15.67it/s, est. speed input: 18622.26 toks/s, output: 18.19 toks/s]
Processed prompts:  34%|███▍      | 88/256 [00:04<00:10, 15.67it/s, est. speed input: 18554.44 toks/s, output: 18.12 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:04<00:10, 15.67it/s, est. speed input: 18490.02 toks/s, output: 18.06 toks/s]
Processed prompts:  36%|███▌      | 92/256 [00:05<00:10, 15.66it/s, est. speed input: 18428.33 toks/s, output: 18.00 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:05<00:10, 15.68it/s, est. speed input: 18372.07 toks/s, output: 17.94 toks/s]
Processed prompts:  38%|███▊      | 96/256 [00:05<00:10, 15.70it/s, est. speed input: 18319.02 toks/s, output: 17.89 toks/s]
Processed prompts:  38%|███▊      | 98/256 [00:05<00:10, 15.71it/s, est. speed input: 18267.26 toks/s, output: 17.84 toks/s]
Processed prompts:  39%|███▉      | 100/256 [00:05<00:09, 15.70it/s, est. speed input: 18217.62 toks/s, output: 17.79 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:05<00:09, 15.69it/s, est. speed input: 18168.90 toks/s, output: 17.74 toks/s]
Processed prompts:  41%|████      | 104/256 [00:05<00:09, 15.66it/s, est. speed input: 18120.60 toks/s, output: 17.70 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:06<00:09, 15.67it/s, est. speed input: 18077.63 toks/s, output: 17.65 toks/s]
Processed prompts:  42%|████▏     | 108/256 [00:06<00:09, 15.68it/s, est. speed input: 18035.77 toks/s, output: 17.61 toks/s]
Processed prompts:  43%|████▎     | 110/256 [00:06<00:09, 15.68it/s, est. speed input: 17995.30 toks/s, output: 17.57 toks/s]
Processed prompts:  44%|████▍     | 112/256 [00:06<00:09, 15.68it/s, est. speed input: 17956.65 toks/s, output: 17.54 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:06<00:09, 15.69it/s, est. speed input: 17920.20 toks/s, output: 17.50 toks/s]
Processed prompts:  45%|████▌     | 116/256 [00:06<00:08, 15.67it/s, est. speed input: 17883.37 toks/s, output: 17.46 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:06<00:08, 15.64it/s, est. speed input: 17846.68 toks/s, output: 17.43 toks/s]
Processed prompts:  47%|████▋     | 120/256 [00:06<00:08, 15.65it/s, est. speed input: 17812.98 toks/s, output: 17.40 toks/s]
Processed prompts:  48%|████▊     | 122/256 [00:07<00:08, 15.63it/s, est. speed input: 17779.19 toks/s, output: 17.36 toks/s]
Processed prompts:  48%|████▊     | 124/256 [00:07<00:08, 15.65it/s, est. speed input: 17748.86 toks/s, output: 17.33 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:07<00:08, 15.64it/s, est. speed input: 17718.12 toks/s, output: 17.30 toks/s]
Processed prompts:  50%|█████     | 128/256 [00:07<00:08, 15.67it/s, est. speed input: 17690.37 toks/s, output: 17.28 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:07<00:08, 15.67it/s, est. speed input: 17662.88 toks/s, output: 17.25 toks/s]
Processed prompts:  52%|█████▏    | 132/256 [00:07<00:07, 15.64it/s, est. speed input: 17634.09 toks/s, output: 17.22 toks/s]
Processed prompts:  52%|█████▏    | 134/256 [00:07<00:07, 15.63it/s, est. speed input: 17606.64 toks/s, output: 17.19 toks/s]
Processed prompts:  53%|█████▎    | 136/256 [00:07<00:07, 15.62it/s, est. speed input: 17580.15 toks/s, output: 17.17 toks/s]
Processed prompts:  54%|█████▍    | 138/256 [00:08<00:07, 15.61it/s, est. speed input: 17554.35 toks/s, output: 17.14 toks/s]
Processed prompts:  55%|█████▍    | 140/256 [00:08<00:07, 15.60it/s, est. speed input: 17529.49 toks/s, output: 17.12 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:08<00:07, 15.60it/s, est. speed input: 17505.14 toks/s, output: 17.09 toks/s]
Processed prompts:  56%|█████▋    | 144/256 [00:08<00:07, 15.62it/s, est. speed input: 17483.33 toks/s, output: 17.07 toks/s]
Processed prompts:  57%|█████▋    | 146/256 [00:08<00:07, 15.62it/s, est. speed input: 17460.85 toks/s, output: 17.05 toks/s]
Processed prompts:  58%|█████▊    | 148/256 [00:08<00:06, 15.62it/s, est. speed input: 17439.32 toks/s, output: 17.03 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:08<00:06, 15.63it/s, est. speed input: 17418.83 toks/s, output: 17.01 toks/s]
Processed prompts:  59%|█████▉    | 152/256 [00:08<00:06, 15.65it/s, est. speed input: 17399.46 toks/s, output: 16.99 toks/s]
Processed prompts:  60%|██████    | 154/256 [00:09<00:06, 15.65it/s, est. speed input: 17380.59 toks/s, output: 16.97 toks/s]
Processed prompts:  61%|██████    | 156/256 [00:09<00:06, 15.65it/s, est. speed input: 17361.50 toks/s, output: 16.95 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:09<00:06, 15.63it/s, est. speed input: 17342.28 toks/s, output: 16.94 toks/s]
Processed prompts:  62%|██████▎   | 160/256 [00:09<00:06, 15.63it/s, est. speed input: 17324.22 toks/s, output: 16.92 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:09<00:06, 15.63it/s, est. speed input: 17306.67 toks/s, output: 16.90 toks/s]
Processed prompts:  64%|██████▍   | 164/256 [00:09<00:05, 15.63it/s, est. speed input: 17289.36 toks/s, output: 16.88 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:09<00:05, 15.63it/s, est. speed input: 17272.70 toks/s, output: 16.87 toks/s]
Processed prompts:  66%|██████▌   | 168/256 [00:09<00:05, 15.62it/s, est. speed input: 17256.13 toks/s, output: 16.85 toks/s]
Processed prompts:  66%|██████▋   | 170/256 [00:10<00:05, 15.63it/s, est. speed input: 17240.28 toks/s, output: 16.84 toks/s]
Processed prompts:  67%|██████▋   | 172/256 [00:10<00:05, 15.63it/s, est. speed input: 17225.09 toks/s, output: 16.82 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:10<00:05, 15.63it/s, est. speed input: 17210.20 toks/s, output: 16.81 toks/s]
Processed prompts:  69%|██████▉   | 176/256 [00:10<00:05, 15.61it/s, est. speed input: 17194.30 toks/s, output: 16.79 toks/s]
Processed prompts:  70%|██████▉   | 178/256 [00:10<00:05, 15.59it/s, est. speed input: 17178.78 toks/s, output: 16.78 toks/s]
Processed prompts:  70%|███████   | 180/256 [00:10<00:04, 15.57it/s, est. speed input: 17163.62 toks/s, output: 16.76 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:10<00:04, 15.57it/s, est. speed input: 17149.19 toks/s, output: 16.75 toks/s]
Processed prompts:  72%|███████▏  | 184/256 [00:10<00:04, 15.58it/s, est. speed input: 17135.55 toks/s, output: 16.73 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:11<00:04, 15.57it/s, est. speed input: 17121.49 toks/s, output: 16.72 toks/s]
Processed prompts:  73%|███████▎  | 188/256 [00:11<00:04, 15.56it/s, est. speed input: 17107.63 toks/s, output: 16.71 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:11<00:04, 15.57it/s, est. speed input: 17094.72 toks/s, output: 16.69 toks/s]
Processed prompts:  75%|███████▌  | 192/256 [00:11<00:04, 15.56it/s, est. speed input: 17081.31 toks/s, output: 16.68 toks/s]
Processed prompts:  76%|███████▌  | 194/256 [00:11<00:03, 15.56it/s, est. speed input: 17068.84 toks/s, output: 16.67 toks/s]
Processed prompts:  77%|███████▋  | 196/256 [00:11<00:03, 15.57it/s, est. speed input: 17056.67 toks/s, output: 16.66 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:11<00:03, 15.56it/s, est. speed input: 17044.24 toks/s, output: 16.64 toks/s]
Processed prompts:  78%|███████▊  | 200/256 [00:12<00:03, 15.56it/s, est. speed input: 17032.59 toks/s, output: 16.63 toks/s]
Processed prompts:  80%|███████▉  | 204/256 [00:12<00:02, 17.41it/s, est. speed input: 17091.69 toks/s, output: 16.69 toks/s]
Processed prompts:  80%|████████  | 206/256 [00:12<00:02, 16.93it/s, est. speed input: 17080.29 toks/s, output: 16.68 toks/s]
Processed prompts:  81%|████████▏ | 208/256 [00:12<00:02, 16.55it/s, est. speed input: 17068.73 toks/s, output: 16.67 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:12<00:02, 16.26it/s, est. speed input: 17056.60 toks/s, output: 16.66 toks/s]
Processed prompts:  83%|████████▎ | 212/256 [00:12<00:02, 16.07it/s, est. speed input: 17045.68 toks/s, output: 16.65 toks/s]
Processed prompts:  84%|████████▎ | 214/256 [00:12<00:02, 15.92it/s, est. speed input: 17034.66 toks/s, output: 16.64 toks/s]
Processed prompts:  84%|████████▍ | 216/256 [00:12<00:02, 15.83it/s, est. speed input: 17024.45 toks/s, output: 16.63 toks/s]
Processed prompts:  85%|████████▌ | 218/256 [00:13<00:02, 15.76it/s, est. speed input: 17014.01 toks/s, output: 16.62 toks/s]
Processed prompts:  86%|████████▌ | 220/256 [00:13<00:02, 15.70it/s, est. speed input: 17003.65 toks/s, output: 16.61 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:13<00:02, 15.64it/s, est. speed input: 16992.62 toks/s, output: 16.59 toks/s]
Processed prompts:  88%|████████▊ | 224/256 [00:13<00:02, 15.61it/s, est. speed input: 16982.32 toks/s, output: 16.58 toks/s]
Processed prompts:  88%|████████▊ | 226/256 [00:13<00:01, 15.58it/s, est. speed input: 16971.79 toks/s, output: 16.57 toks/s]
Processed prompts:  89%|████████▉ | 228/256 [00:13<00:01, 15.55it/s, est. speed input: 16961.21 toks/s, output: 16.56 toks/s]
Processed prompts:  90%|████████▉ | 230/256 [00:13<00:01, 15.53it/s, est. speed input: 16951.09 toks/s, output: 16.55 toks/s]
Processed prompts:  91%|█████████ | 232/256 [00:14<00:01, 15.51it/s, est. speed input: 16940.69 toks/s, output: 16.54 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:14<00:01, 15.49it/s, est. speed input: 16930.52 toks/s, output: 16.53 toks/s]
Processed prompts:  92%|█████████▏| 236/256 [00:14<00:01, 15.49it/s, est. speed input: 16920.73 toks/s, output: 16.52 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:14<00:01, 15.48it/s, est. speed input: 16911.11 toks/s, output: 16.51 toks/s]
Processed prompts:  94%|█████████▍| 240/256 [00:14<00:01, 15.49it/s, est. speed input: 16902.03 toks/s, output: 16.51 toks/s]
Processed prompts:  95%|█████████▍| 242/256 [00:14<00:00, 15.48it/s, est. speed input: 16892.59 toks/s, output: 16.50 toks/s]
Processed prompts:  95%|█████████▌| 244/256 [00:14<00:00, 15.48it/s, est. speed input: 16883.55 toks/s, output: 16.49 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:14<00:00, 15.47it/s, est. speed input: 16874.10 toks/s, output: 16.48 toks/s]
Processed prompts:  97%|█████████▋| 248/256 [00:15<00:00, 15.47it/s, est. speed input: 16865.26 toks/s, output: 16.47 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:15<00:00, 15.46it/s, est. speed input: 16856.39 toks/s, output: 16.46 toks/s]
Processed prompts:  98%|█████████▊| 252/256 [00:15<00:00, 15.45it/s, est. speed input: 16847.47 toks/s, output: 16.45 toks/s]
Processed prompts:  99%|█████████▉| 254/256 [00:15<00:00, 15.47it/s, est. speed input: 16839.28 toks/s, output: 16.44 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:15<00:00, 15.47it/s, est. speed input: 16898.34 toks/s, output: 16.50 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:15<00:00, 16.50it/s, est. speed input: 16898.34 toks/s, output: 16.50 toks/s]
[rank0]:[W126 03:16:41.998743901 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 58.9s

测试结果:
  Requests/s:   15.52
  Tokens/s:     15912.53
  Total Reqs:   256
  Elapsed:      16.49s

  [Prefill 分析]
  Total Prefill Tokens: 262144
  Prefill Tokens/s:     15897.00

============================================================
[4/8] 测试 M=4096
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuBLASLt                                        │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 4096
│   M_prefill     = 4096 (= 4 x 1024)
│   M_decode      = 4
│   batched_tokens = 4096 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 512
│   --max-num-seqs           = 4
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 4096
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 03:16:53 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 03:16:54 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=108311) WARNING 01-26 03:17:02 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=108311) WARNING 01-26 03:17:14 [backends.py:609] Failed to read file <frozen os>
Throughput: 16.05 requests/s, 16456.15 total tokens/s, 16.05 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512


─── STDERR ───
[2026-01-26 03:16:53] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:16:53] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:16:53] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:16:53] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:16:53] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:16:53] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:16:53] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:16:53] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:16:53] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:16:53] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:16:53] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:16:53] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:16:53] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:16:53] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 03:17:01] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:17:01] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:17:01] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:17:01] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:17:01] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:17:01] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:17:01] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:17:01] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:17:01] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:17:01] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:17:01] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:17:01] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:17:01] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:17:01] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=108311) [2026-01-26 03:17:03] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=108311) [2026-01-26 03:17:03] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=108311) [2026-01-26 03:17:03] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=108311) [2026-01-26 03:17:03] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=108311) [2026-01-26 03:17:03] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuBLASLt
(EngineCore_DP0 pid=108311) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=108311) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.39it/s]
(EngineCore_DP0 pid=108311) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.13it/s]
(EngineCore_DP0 pid=108311) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.17it/s]
(EngineCore_DP0 pid=108311) 
(EngineCore_DP0 pid=108311) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  25%|██▌       | 1/4 [00:00<00:00,  8.13it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 2/4 [00:00<00:00,  8.53it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  75%|███████▌  | 3/4 [00:00<00:00,  8.74it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  7.94it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  8.15it/s]
(EngineCore_DP0 pid=108311) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  33%|███▎      | 1/3 [00:00<00:00,  6.88it/s]
Capturing CUDA graphs (decode, FULL):  67%|██████▋   | 2/3 [00:00<00:00,  7.97it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  8.38it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  8.13it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   4%|▍         | 21/512 [00:00<00:02, 203.17it/s]
Adding requests:   9%|▉         | 48/512 [00:00<00:01, 235.17it/s]
Adding requests:  14%|█▍        | 74/512 [00:00<00:01, 241.89it/s]
Adding requests:  19%|█▉        | 99/512 [00:00<00:01, 242.79it/s]
Adding requests:  24%|██▍       | 125/512 [00:00<00:01, 248.73it/s]
Adding requests:  29%|██▉       | 150/512 [00:00<00:01, 247.82it/s]
Adding requests:  35%|███▍      | 177/512 [00:00<00:01, 252.69it/s]
Adding requests:  40%|████      | 205/512 [00:00<00:01, 259.43it/s]
Adding requests:  46%|████▌     | 234/512 [00:00<00:01, 265.44it/s]
Adding requests:  51%|█████     | 261/512 [00:01<00:00, 266.80it/s]
Adding requests:  56%|█████▋    | 288/512 [00:01<00:00, 267.28it/s]
Adding requests:  62%|██████▏   | 318/512 [00:01<00:00, 275.52it/s]
Adding requests:  68%|██████▊   | 346/512 [00:01<00:00, 269.92it/s]
Adding requests:  73%|███████▎  | 374/512 [00:01<00:00, 262.94it/s]
Adding requests:  79%|███████▊  | 403/512 [00:01<00:00, 270.08it/s]
Adding requests:  84%|████████▍ | 431/512 [00:01<00:00, 271.27it/s]
Adding requests:  90%|████████▉ | 459/512 [00:01<00:00, 260.68it/s]
Adding requests:  95%|█████████▌| 488/512 [00:01<00:00, 267.95it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 261.22it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▌         | 30/512 [00:00<00:05, 94.27it/s, est. speed input: 96544.54 toks/s, output: 94.28 toks/s]
Processed prompts:   8%|▊         | 40/512 [00:00<00:10, 43.42it/s, est. speed input: 50609.44 toks/s, output: 49.42 toks/s]
Processed prompts:   9%|▉         | 46/512 [00:01<00:16, 27.98it/s, est. speed input: 36240.65 toks/s, output: 35.39 toks/s]
Processed prompts:  10%|▉         | 50/512 [00:01<00:18, 24.94it/s, est. speed input: 33147.28 toks/s, output: 32.37 toks/s]
Processed prompts:  11%|█         | 54/512 [00:01<00:20, 22.59it/s, est. speed input: 30892.09 toks/s, output: 30.17 toks/s]
Processed prompts:  11%|█▏        | 58/512 [00:02<00:21, 20.82it/s, est. speed input: 29175.46 toks/s, output: 28.49 toks/s]
Processed prompts:  12%|█▏        | 62/512 [00:02<00:23, 19.53it/s, est. speed input: 27832.20 toks/s, output: 27.18 toks/s]
Processed prompts:  13%|█▎        | 66/512 [00:02<00:23, 18.60it/s, est. speed input: 26751.74 toks/s, output: 26.12 toks/s]
Processed prompts:  14%|█▎        | 70/512 [00:02<00:24, 17.92it/s, est. speed input: 25859.17 toks/s, output: 25.25 toks/s]
Processed prompts:  14%|█▍        | 74/512 [00:03<00:25, 17.44it/s, est. speed input: 25111.52 toks/s, output: 24.52 toks/s]
Processed prompts:  15%|█▌        | 78/512 [00:03<00:25, 17.09it/s, est. speed input: 24474.41 toks/s, output: 23.90 toks/s]
Processed prompts:  16%|█▌        | 82/512 [00:03<00:25, 16.84it/s, est. speed input: 23924.94 toks/s, output: 23.36 toks/s]
Processed prompts:  17%|█▋        | 86/512 [00:03<00:25, 16.68it/s, est. speed input: 23451.32 toks/s, output: 22.90 toks/s]
Processed prompts:  18%|█▊        | 90/512 [00:04<00:25, 16.56it/s, est. speed input: 23035.19 toks/s, output: 22.49 toks/s]
Processed prompts:  18%|█▊        | 94/512 [00:04<00:25, 16.47it/s, est. speed input: 22664.97 toks/s, output: 22.13 toks/s]
Processed prompts:  19%|█▉        | 98/512 [00:04<00:25, 16.42it/s, est. speed input: 22339.18 toks/s, output: 21.82 toks/s]
Processed prompts:  20%|█▉        | 102/512 [00:04<00:25, 16.37it/s, est. speed input: 22044.23 toks/s, output: 21.53 toks/s]
Processed prompts:  21%|██        | 106/512 [00:04<00:24, 16.33it/s, est. speed input: 21776.75 toks/s, output: 21.27 toks/s]
Processed prompts:  21%|██▏       | 110/512 [00:05<00:24, 16.31it/s, est. speed input: 21534.38 toks/s, output: 21.03 toks/s]
Processed prompts:  22%|██▏       | 114/512 [00:05<00:24, 16.29it/s, est. speed input: 21313.99 toks/s, output: 20.81 toks/s]
Processed prompts:  23%|██▎       | 118/512 [00:05<00:24, 16.27it/s, est. speed input: 21111.93 toks/s, output: 20.62 toks/s]
Processed prompts:  24%|██▍       | 122/512 [00:05<00:24, 16.24it/s, est. speed input: 20923.79 toks/s, output: 20.43 toks/s]
Processed prompts:  25%|██▍       | 126/512 [00:06<00:23, 16.24it/s, est. speed input: 20753.65 toks/s, output: 20.27 toks/s]
Processed prompts:  25%|██▌       | 130/512 [00:06<00:23, 16.22it/s, est. speed input: 20593.23 toks/s, output: 20.11 toks/s]
Processed prompts:  26%|██▌       | 134/512 [00:06<00:23, 16.22it/s, est. speed input: 20446.12 toks/s, output: 19.97 toks/s]
Processed prompts:  27%|██▋       | 138/512 [00:06<00:23, 16.22it/s, est. speed input: 20309.85 toks/s, output: 19.83 toks/s]
Processed prompts:  28%|██▊       | 142/512 [00:07<00:22, 16.21it/s, est. speed input: 20182.79 toks/s, output: 19.71 toks/s]
Processed prompts:  29%|██▊       | 146/512 [00:07<00:22, 16.21it/s, est. speed input: 20063.12 toks/s, output: 19.59 toks/s]
Processed prompts:  29%|██▉       | 150/512 [00:07<00:22, 16.21it/s, est. speed input: 19952.16 toks/s, output: 19.48 toks/s]
Processed prompts:  30%|███       | 154/512 [00:07<00:22, 16.21it/s, est. speed input: 19847.92 toks/s, output: 19.38 toks/s]
Processed prompts:  31%|███       | 158/512 [00:08<00:21, 16.21it/s, est. speed input: 19750.05 toks/s, output: 19.29 toks/s]
Processed prompts:  32%|███▏      | 162/512 [00:08<00:21, 16.21it/s, est. speed input: 19657.62 toks/s, output: 19.20 toks/s]
Processed prompts:  32%|███▏      | 166/512 [00:08<00:21, 16.20it/s, est. speed input: 19569.80 toks/s, output: 19.11 toks/s]
Processed prompts:  33%|███▎      | 170/512 [00:08<00:21, 16.19it/s, est. speed input: 19486.65 toks/s, output: 19.03 toks/s]
Processed prompts:  34%|███▍      | 174/512 [00:09<00:20, 16.20it/s, est. speed input: 19409.22 toks/s, output: 18.95 toks/s]
Processed prompts:  35%|███▍      | 178/512 [00:09<00:20, 16.19it/s, est. speed input: 19334.79 toks/s, output: 18.88 toks/s]
Processed prompts:  36%|███▌      | 182/512 [00:09<00:20, 16.19it/s, est. speed input: 19263.72 toks/s, output: 18.81 toks/s]
Processed prompts:  36%|███▋      | 186/512 [00:09<00:20, 16.18it/s, est. speed input: 19195.77 toks/s, output: 18.75 toks/s]
Processed prompts:  37%|███▋      | 190/512 [00:10<00:19, 16.17it/s, est. speed input: 19130.96 toks/s, output: 18.68 toks/s]
Processed prompts:  38%|███▊      | 194/512 [00:10<00:19, 16.16it/s, est. speed input: 19069.23 toks/s, output: 18.62 toks/s]
Processed prompts:  39%|███▊      | 198/512 [00:10<00:19, 16.16it/s, est. speed input: 19010.26 toks/s, output: 18.56 toks/s]
Processed prompts:  39%|███▉      | 202/512 [00:10<00:18, 17.20it/s, est. speed input: 19041.37 toks/s, output: 18.60 toks/s]
Processed prompts:  40%|████      | 206/512 [00:11<00:18, 16.87it/s, est. speed input: 18985.63 toks/s, output: 18.54 toks/s]
Processed prompts:  41%|████      | 210/512 [00:11<00:18, 16.64it/s, est. speed input: 18931.94 toks/s, output: 18.49 toks/s]
Processed prompts:  42%|████▏     | 214/512 [00:11<00:18, 16.49it/s, est. speed input: 18880.41 toks/s, output: 18.44 toks/s]
Processed prompts:  43%|████▎     | 218/512 [00:11<00:17, 16.38it/s, est. speed input: 18831.07 toks/s, output: 18.39 toks/s]
Processed prompts:  43%|████▎     | 222/512 [00:12<00:17, 16.30it/s, est. speed input: 18783.68 toks/s, output: 18.34 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:12<00:17, 16.25it/s, est. speed input: 18737.88 toks/s, output: 18.30 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:12<00:17, 16.22it/s, est. speed input: 18694.51 toks/s, output: 18.26 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:12<00:17, 16.19it/s, est. speed input: 18652.69 toks/s, output: 18.22 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:13<00:16, 16.17it/s, est. speed input: 18611.89 toks/s, output: 18.18 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:13<00:16, 16.16it/s, est. speed input: 18573.06 toks/s, output: 18.14 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:13<00:16, 16.15it/s, est. speed input: 18535.55 toks/s, output: 18.10 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:13<00:16, 16.14it/s, est. speed input: 18499.10 toks/s, output: 18.07 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:14<00:15, 16.14it/s, est. speed input: 18464.08 toks/s, output: 18.03 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:14<00:15, 16.14it/s, est. speed input: 18430.48 toks/s, output: 18.00 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:14<00:15, 16.13it/s, est. speed input: 18397.92 toks/s, output: 17.97 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:14<00:15, 16.13it/s, est. speed input: 18366.13 toks/s, output: 17.94 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:15<00:15, 16.13it/s, est. speed input: 18335.60 toks/s, output: 17.91 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:15<00:14, 16.13it/s, est. speed input: 18306.22 toks/s, output: 17.88 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:15<00:14, 16.14it/s, est. speed input: 18278.23 toks/s, output: 17.85 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:15<00:14, 16.14it/s, est. speed input: 18250.68 toks/s, output: 17.82 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:16<00:14, 16.13it/s, est. speed input: 18223.50 toks/s, output: 17.80 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:16<00:13, 16.12it/s, est. speed input: 18197.22 toks/s, output: 17.77 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:16<00:13, 16.12it/s, est. speed input: 18171.71 toks/s, output: 17.75 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:16<00:13, 16.12it/s, est. speed input: 18147.42 toks/s, output: 17.72 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:17<00:13, 16.12it/s, est. speed input: 18123.51 toks/s, output: 17.70 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:17<00:12, 16.12it/s, est. speed input: 18100.29 toks/s, output: 17.68 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:17<00:12, 16.12it/s, est. speed input: 18077.98 toks/s, output: 17.65 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:17<00:12, 16.12it/s, est. speed input: 18055.74 toks/s, output: 17.63 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:18<00:12, 16.12it/s, est. speed input: 18034.63 toks/s, output: 17.61 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:18<00:11, 16.12it/s, est. speed input: 18013.67 toks/s, output: 17.59 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:18<00:11, 16.12it/s, est. speed input: 17993.61 toks/s, output: 17.57 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:18<00:11, 16.11it/s, est. speed input: 17973.38 toks/s, output: 17.55 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:19<00:11, 16.11it/s, est. speed input: 17954.03 toks/s, output: 17.53 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:19<00:10, 16.10it/s, est. speed input: 17934.87 toks/s, output: 17.51 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:19<00:10, 16.10it/s, est. speed input: 17916.62 toks/s, output: 17.50 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:19<00:10, 16.11it/s, est. speed input: 17898.88 toks/s, output: 17.48 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [00:20<00:03, 40.42it/s, est. speed input: 19016.79 toks/s, output: 18.57 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [00:20<00:03, 33.67it/s, est. speed input: 18986.04 toks/s, output: 18.54 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [00:20<00:04, 28.68it/s, est. speed input: 18955.92 toks/s, output: 18.51 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [00:20<00:05, 25.05it/s, est. speed input: 18926.46 toks/s, output: 18.48 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [00:21<00:05, 22.43it/s, est. speed input: 18897.62 toks/s, output: 18.45 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [00:21<00:05, 20.57it/s, est. speed input: 18869.57 toks/s, output: 18.43 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [00:21<00:05, 19.24it/s, est. speed input: 18842.06 toks/s, output: 18.40 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [00:21<00:06, 18.31it/s, est. speed input: 18815.23 toks/s, output: 18.37 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [00:22<00:06, 17.66it/s, est. speed input: 18789.56 toks/s, output: 18.35 toks/s]
Processed prompts:  80%|████████  | 410/512 [00:22<00:05, 17.21it/s, est. speed input: 18764.45 toks/s, output: 18.32 toks/s]
Processed prompts:  81%|████████  | 414/512 [00:22<00:05, 16.89it/s, est. speed input: 18739.88 toks/s, output: 18.30 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [00:22<00:05, 16.65it/s, est. speed input: 18715.47 toks/s, output: 18.28 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [00:23<00:05, 16.49it/s, est. speed input: 18691.49 toks/s, output: 18.25 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [00:23<00:05, 16.37it/s, est. speed input: 18668.11 toks/s, output: 18.23 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [00:23<00:05, 16.30it/s, est. speed input: 18645.32 toks/s, output: 18.21 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [00:23<00:04, 16.23it/s, est. speed input: 18622.57 toks/s, output: 18.19 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [00:24<00:04, 16.18it/s, est. speed input: 18600.31 toks/s, output: 18.16 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [00:24<00:04, 16.16it/s, est. speed input: 18578.67 toks/s, output: 18.14 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [00:24<00:04, 16.14it/s, est. speed input: 18557.36 toks/s, output: 18.12 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [00:24<00:03, 16.13it/s, est. speed input: 18536.85 toks/s, output: 18.10 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [00:25<00:03, 16.12it/s, est. speed input: 18516.41 toks/s, output: 18.08 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [00:25<00:03, 16.11it/s, est. speed input: 18496.37 toks/s, output: 18.06 toks/s]
Processed prompts:  90%|█████████ | 462/512 [00:25<00:03, 16.10it/s, est. speed input: 18476.67 toks/s, output: 18.04 toks/s]
Processed prompts:  91%|█████████ | 466/512 [00:25<00:02, 16.09it/s, est. speed input: 18457.34 toks/s, output: 18.02 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [00:26<00:02, 16.09it/s, est. speed input: 18438.36 toks/s, output: 18.01 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [00:26<00:02, 16.09it/s, est. speed input: 18419.81 toks/s, output: 17.99 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [00:26<00:02, 16.08it/s, est. speed input: 18401.40 toks/s, output: 17.97 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [00:26<00:01, 16.08it/s, est. speed input: 18383.61 toks/s, output: 17.95 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [00:27<00:01, 16.08it/s, est. speed input: 18365.65 toks/s, output: 17.94 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [00:27<00:01, 16.06it/s, est. speed input: 18347.92 toks/s, output: 17.92 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [00:27<00:01, 16.07it/s, est. speed input: 18330.96 toks/s, output: 17.90 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [00:27<00:00, 16.06it/s, est. speed input: 18313.97 toks/s, output: 17.88 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [00:28<00:00, 16.06it/s, est. speed input: 18297.31 toks/s, output: 17.87 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [00:28<00:00, 16.06it/s, est. speed input: 18281.03 toks/s, output: 17.85 toks/s]
Processed prompts: 100%|█████████▉| 510/512 [00:28<00:00, 17.24it/s, est. speed input: 18301.50 toks/s, output: 17.87 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:28<00:00, 17.24it/s, est. speed input: 18373.13 toks/s, output: 17.94 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:28<00:00, 17.94it/s, est. speed input: 18373.13 toks/s, output: 17.94 toks/s]
[rank0]:[W126 03:17:55.299335856 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 74.1s

测试结果:
  Requests/s:   16.05
  Tokens/s:     16456.15
  Total Reqs:   512
  Elapsed:      31.89s

  [Prefill 分析]
  Total Prefill Tokens: 524288
  Prefill Tokens/s:     16440.09

============================================================
[5/8] 测试 M=8192
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuBLASLt                                        │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 8192
│   M_prefill     = 8192 (= 8 x 1024)
│   M_decode      = 8
│   batched_tokens = 8192 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 1024
│   --max-num-seqs           = 8
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 8192
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 03:18:12 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 03:18:13 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=109635) WARNING 01-26 03:18:20 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=109635) WARNING 01-26 03:18:31 [backends.py:609] Failed to read file <frozen os>
Throughput: 15.93 requests/s, 16323.98 total tokens/s, 15.93 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024


─── STDERR ───
[2026-01-26 03:18:12] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:18:12] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:18:12] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:18:12] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:18:12] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:18:12] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:18:12] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:18:12] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:18:12] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:18:12] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:18:12] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:18:12] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:18:12] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:18:12] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 03:18:19] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:18:19] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:18:19] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:18:19] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:18:19] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:18:19] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:18:19] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:18:19] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:18:19] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:18:19] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:18:19] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:18:19] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:18:19] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:18:19] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=109635) [2026-01-26 03:18:20] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=109635) [2026-01-26 03:18:20] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=109635) [2026-01-26 03:18:20] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=109635) [2026-01-26 03:18:20] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=109635) [2026-01-26 03:18:20] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuBLASLt
(EngineCore_DP0 pid=109635) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=109635) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.42it/s]
(EngineCore_DP0 pid=109635) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.12it/s]
(EngineCore_DP0 pid=109635) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.16it/s]
(EngineCore_DP0 pid=109635) 
(EngineCore_DP0 pid=109635) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:00,  7.85it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  40%|████      | 2/5 [00:00<00:00,  8.22it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  60%|██████    | 3/5 [00:00<00:00,  8.61it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  80%|████████  | 4/5 [00:00<00:00,  8.69it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00,  7.99it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00,  8.18it/s]
(EngineCore_DP0 pid=109635) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:00,  7.04it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 2/4 [00:00<00:00,  7.97it/s]
Capturing CUDA graphs (decode, FULL):  75%|███████▌  | 3/4 [00:00<00:00,  8.50it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  8.80it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  8.48it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 25/1024 [00:00<00:04, 243.97it/s]
Adding requests:   5%|▌         | 52/1024 [00:00<00:03, 253.01it/s]
Adding requests:   8%|▊         | 80/1024 [00:00<00:03, 261.00it/s]
Adding requests:  11%|█         | 108/1024 [00:00<00:03, 263.50it/s]
Adding requests:  13%|█▎        | 135/1024 [00:00<00:03, 263.53it/s]
Adding requests:  16%|█▌        | 162/1024 [00:00<00:03, 265.21it/s]
Adding requests:  19%|█▊        | 191/1024 [00:00<00:03, 272.29it/s]
Adding requests:  21%|██▏       | 220/1024 [00:00<00:02, 275.96it/s]
Adding requests:  24%|██▍       | 248/1024 [00:00<00:02, 272.47it/s]
Adding requests:  27%|██▋       | 276/1024 [00:01<00:02, 273.51it/s]
Adding requests:  30%|██▉       | 305/1024 [00:01<00:02, 276.04it/s]
Adding requests:  33%|███▎      | 333/1024 [00:01<00:02, 276.70it/s]
Adding requests:  35%|███▌      | 361/1024 [00:01<00:02, 274.45it/s]
Adding requests:  38%|███▊      | 390/1024 [00:01<00:02, 278.03it/s]
Adding requests:  41%|████      | 420/1024 [00:01<00:02, 283.97it/s]
Adding requests:  44%|████▍     | 449/1024 [00:01<00:02, 276.79it/s]
Adding requests:  47%|████▋     | 479/1024 [00:01<00:01, 280.65it/s]
Adding requests:  50%|████▉     | 508/1024 [00:01<00:01, 282.85it/s]
Adding requests:  53%|█████▎    | 538/1024 [00:01<00:01, 285.16it/s]
Adding requests:  55%|█████▌    | 567/1024 [00:02<00:01, 286.19it/s]
Adding requests:  58%|█████▊    | 596/1024 [00:02<00:01, 274.97it/s]
Adding requests:  61%|██████    | 624/1024 [00:02<00:01, 269.51it/s]
Adding requests:  64%|██████▎   | 652/1024 [00:02<00:01, 264.57it/s]
Adding requests:  67%|██████▋   | 681/1024 [00:02<00:01, 269.89it/s]
Adding requests:  69%|██████▉   | 711/1024 [00:02<00:01, 276.52it/s]
Adding requests:  72%|███████▏  | 739/1024 [00:02<00:01, 262.89it/s]
Adding requests:  75%|███████▍  | 766/1024 [00:02<00:00, 262.38it/s]
Adding requests:  78%|███████▊  | 794/1024 [00:02<00:00, 266.27it/s]
Adding requests:  80%|████████  | 823/1024 [00:03<00:00, 271.05it/s]
Adding requests:  83%|████████▎ | 853/1024 [00:03<00:00, 276.59it/s]
Adding requests:  86%|████████▌ | 881/1024 [00:03<00:00, 277.14it/s]
Adding requests:  89%|████████▉ | 909/1024 [00:03<00:00, 275.21it/s]
Adding requests:  92%|█████████▏| 937/1024 [00:03<00:00, 267.98it/s]
Adding requests:  94%|█████████▍| 966/1024 [00:03<00:00, 272.53it/s]
Adding requests:  97%|█████████▋| 994/1024 [00:03<00:00, 267.69it/s]
Adding requests: 100%|█████████▉| 1022/1024 [00:03<00:00, 268.71it/s]
Adding requests: 100%|██████████| 1024/1024 [00:03<00:00, 272.03it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▌         | 58/1024 [00:00<00:07, 125.80it/s, est. speed input: 128826.12 toks/s, output: 125.80 toks/s]
Processed prompts:   7%|▋         | 71/1024 [00:00<00:14, 65.51it/s, est. speed input: 76010.87 toks/s, output: 74.23 toks/s]   
Processed prompts:  10%|▉         | 98/1024 [00:01<00:16, 57.34it/s, est. speed input: 66505.31 toks/s, output: 64.95 toks/s]
Processed prompts:  10%|█         | 106/1024 [00:02<00:22, 41.41it/s, est. speed input: 54137.23 toks/s, output: 52.87 toks/s]
Processed prompts:  11%|█         | 114/1024 [00:02<00:28, 32.42it/s, est. speed input: 46674.49 toks/s, output: 45.58 toks/s]
Processed prompts:  12%|█▏        | 122/1024 [00:02<00:33, 27.06it/s, est. speed input: 41780.36 toks/s, output: 40.80 toks/s]
Processed prompts:  13%|█▎        | 130/1024 [00:03<00:37, 23.62it/s, est. speed input: 38275.72 toks/s, output: 37.38 toks/s]
Processed prompts:  13%|█▎        | 138/1024 [00:03<00:41, 21.34it/s, est. speed input: 35630.81 toks/s, output: 34.80 toks/s]
Processed prompts:  14%|█▍        | 146/1024 [00:04<00:44, 19.80it/s, est. speed input: 33564.89 toks/s, output: 32.78 toks/s]
Processed prompts:  15%|█▌        | 154/1024 [00:04<00:46, 18.68it/s, est. speed input: 31869.44 toks/s, output: 31.12 toks/s]
Processed prompts:  16%|█▌        | 162/1024 [00:05<00:47, 17.98it/s, est. speed input: 30509.29 toks/s, output: 29.79 toks/s]
Processed prompts:  17%|█▋        | 170/1024 [00:05<00:48, 17.49it/s, est. speed input: 29376.17 toks/s, output: 28.69 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [00:06<00:49, 17.15it/s, est. speed input: 28414.15 toks/s, output: 27.75 toks/s]
Processed prompts:  18%|█▊        | 186/1024 [00:06<00:49, 16.90it/s, est. speed input: 27585.80 toks/s, output: 26.94 toks/s]
Processed prompts:  19%|█▉        | 194/1024 [00:07<00:49, 16.74it/s, est. speed input: 26867.35 toks/s, output: 26.24 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [00:07<00:47, 17.19it/s, est. speed input: 26418.65 toks/s, output: 25.80 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:08<00:48, 16.92it/s, est. speed input: 25848.18 toks/s, output: 25.24 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [00:08<00:48, 16.73it/s, est. speed input: 25338.54 toks/s, output: 24.74 toks/s]
Processed prompts:  22%|██▏       | 226/1024 [00:09<00:48, 16.61it/s, est. speed input: 24884.20 toks/s, output: 24.30 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:09<00:47, 16.51it/s, est. speed input: 24472.49 toks/s, output: 23.90 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:10<00:47, 16.36it/s, est. speed input: 24079.53 toks/s, output: 23.52 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:10<00:47, 16.24it/s, est. speed input: 23722.41 toks/s, output: 23.17 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:11<00:47, 16.17it/s, est. speed input: 23397.80 toks/s, output: 22.85 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:11<00:47, 16.12it/s, est. speed input: 23099.93 toks/s, output: 22.56 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:12<00:46, 16.08it/s, est. speed input: 22826.19 toks/s, output: 22.29 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:12<00:46, 16.04it/s, est. speed input: 22572.01 toks/s, output: 22.04 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:13<00:45, 16.02it/s, est. speed input: 22337.32 toks/s, output: 21.81 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:13<00:45, 16.00it/s, est. speed input: 22119.93 toks/s, output: 21.60 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:14<00:44, 15.99it/s, est. speed input: 21917.22 toks/s, output: 21.40 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:14<00:44, 15.98it/s, est. speed input: 21728.60 toks/s, output: 21.22 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:15<00:43, 15.97it/s, est. speed input: 21552.07 toks/s, output: 21.05 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:15<00:43, 15.96it/s, est. speed input: 21385.79 toks/s, output: 20.88 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:16<00:42, 15.96it/s, est. speed input: 21230.10 toks/s, output: 20.73 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:16<00:42, 15.95it/s, est. speed input: 21083.09 toks/s, output: 20.59 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:17<00:42, 15.94it/s, est. speed input: 20944.65 toks/s, output: 20.45 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:17<00:41, 15.94it/s, est. speed input: 20814.46 toks/s, output: 20.33 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:18<00:41, 15.94it/s, est. speed input: 20691.32 toks/s, output: 20.21 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:18<00:40, 15.93it/s, est. speed input: 20572.99 toks/s, output: 20.09 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:19<00:40, 15.90it/s, est. speed input: 20459.53 toks/s, output: 19.98 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [00:19<00:39, 15.88it/s, est. speed input: 20351.06 toks/s, output: 19.87 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:20<00:39, 15.87it/s, est. speed input: 20248.29 toks/s, output: 19.77 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:20<00:38, 15.85it/s, est. speed input: 20149.93 toks/s, output: 19.68 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:21<00:38, 15.85it/s, est. speed input: 20056.92 toks/s, output: 19.59 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:21<00:37, 15.84it/s, est. speed input: 19968.08 toks/s, output: 19.50 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:22<00:37, 15.84it/s, est. speed input: 19882.84 toks/s, output: 19.42 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:22<00:36, 15.83it/s, est. speed input: 19801.44 toks/s, output: 19.34 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:23<00:36, 15.83it/s, est. speed input: 19723.74 toks/s, output: 19.26 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:23<00:35, 15.83it/s, est. speed input: 19648.96 toks/s, output: 19.19 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:24<00:35, 15.82it/s, est. speed input: 19577.36 toks/s, output: 19.12 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:24<00:34, 15.82it/s, est. speed input: 19508.30 toks/s, output: 19.05 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:25<00:34, 15.82it/s, est. speed input: 19442.25 toks/s, output: 18.99 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:25<00:33, 15.82it/s, est. speed input: 19378.87 toks/s, output: 18.92 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:26<00:33, 15.82it/s, est. speed input: 19318.06 toks/s, output: 18.87 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:26<00:32, 15.83it/s, est. speed input: 19260.06 toks/s, output: 18.81 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:27<00:32, 15.85it/s, est. speed input: 19205.48 toks/s, output: 18.76 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:27<00:31, 15.86it/s, est. speed input: 19152.50 toks/s, output: 18.70 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:28<00:31, 15.86it/s, est. speed input: 19100.80 toks/s, output: 18.65 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:28<00:30, 15.86it/s, est. speed input: 19051.06 toks/s, output: 18.60 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:29<00:30, 15.86it/s, est. speed input: 19002.52 toks/s, output: 18.56 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:29<00:29, 15.86it/s, est. speed input: 18956.34 toks/s, output: 18.51 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:30<00:29, 15.86it/s, est. speed input: 18911.03 toks/s, output: 18.47 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:30<00:28, 15.87it/s, est. speed input: 18868.36 toks/s, output: 18.43 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:31<00:28, 15.87it/s, est. speed input: 18826.44 toks/s, output: 18.39 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:31<00:27, 15.87it/s, est. speed input: 18785.46 toks/s, output: 18.35 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:32<00:13, 30.71it/s, est. speed input: 19425.29 toks/s, output: 18.97 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:32<00:15, 25.63it/s, est. speed input: 19375.91 toks/s, output: 18.92 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:33<00:17, 22.43it/s, est. speed input: 19328.33 toks/s, output: 18.88 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:33<00:19, 20.33it/s, est. speed input: 19282.01 toks/s, output: 18.83 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:34<00:20, 18.93it/s, est. speed input: 19237.23 toks/s, output: 18.79 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:34<00:20, 17.98it/s, est. speed input: 19193.41 toks/s, output: 18.74 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:35<00:21, 17.33it/s, est. speed input: 19150.91 toks/s, output: 18.70 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:35<00:21, 16.88it/s, est. speed input: 19109.67 toks/s, output: 18.66 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:36<00:21, 16.56it/s, est. speed input: 19069.23 toks/s, output: 18.62 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:36<00:20, 16.35it/s, est. speed input: 19030.26 toks/s, output: 18.58 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:37<00:20, 16.20it/s, est. speed input: 18992.16 toks/s, output: 18.55 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:37<00:20, 16.09it/s, est. speed input: 18955.00 toks/s, output: 18.51 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:38<00:19, 16.01it/s, est. speed input: 18918.89 toks/s, output: 18.48 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:38<00:19, 15.96it/s, est. speed input: 18883.56 toks/s, output: 18.44 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:39<00:18, 15.92it/s, est. speed input: 18849.18 toks/s, output: 18.41 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:39<00:18, 15.90it/s, est. speed input: 18815.97 toks/s, output: 18.37 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:40<00:18, 15.88it/s, est. speed input: 18783.12 toks/s, output: 18.34 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:40<00:17, 15.86it/s, est. speed input: 18751.25 toks/s, output: 18.31 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:41<00:17, 15.85it/s, est. speed input: 18720.01 toks/s, output: 18.28 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:41<00:16, 15.85it/s, est. speed input: 18689.83 toks/s, output: 18.25 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:42<00:16, 15.84it/s, est. speed input: 18660.12 toks/s, output: 18.22 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:42<00:15, 15.84it/s, est. speed input: 18631.31 toks/s, output: 18.19 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:43<00:14, 16.39it/s, est. speed input: 18627.32 toks/s, output: 18.19 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:43<00:14, 16.22it/s, est. speed input: 18599.61 toks/s, output: 18.16 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:44<00:13, 16.10it/s, est. speed input: 18572.35 toks/s, output: 18.14 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:44<00:13, 16.02it/s, est. speed input: 18545.67 toks/s, output: 18.11 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:45<00:12, 15.97it/s, est. speed input: 18519.69 toks/s, output: 18.09 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:45<00:12, 15.93it/s, est. speed input: 18494.30 toks/s, output: 18.06 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:46<00:11, 15.90it/s, est. speed input: 18469.41 toks/s, output: 18.04 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [00:46<00:11, 15.88it/s, est. speed input: 18444.84 toks/s, output: 18.01 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [00:47<00:10, 15.86it/s, est. speed input: 18420.99 toks/s, output: 17.99 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:47<00:10, 15.86it/s, est. speed input: 18397.70 toks/s, output: 17.97 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [00:48<00:09, 15.85it/s, est. speed input: 18374.79 toks/s, output: 17.94 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [00:48<00:09, 15.85it/s, est. speed input: 18352.48 toks/s, output: 17.92 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [00:49<00:08, 15.84it/s, est. speed input: 18330.63 toks/s, output: 17.90 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [00:49<00:08, 15.84it/s, est. speed input: 18309.10 toks/s, output: 17.88 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [00:50<00:07, 15.84it/s, est. speed input: 18288.10 toks/s, output: 17.86 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [00:50<00:07, 15.84it/s, est. speed input: 18267.39 toks/s, output: 17.84 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [00:51<00:06, 15.83it/s, est. speed input: 18247.12 toks/s, output: 17.82 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [00:51<00:06, 15.83it/s, est. speed input: 18227.26 toks/s, output: 17.80 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [00:52<00:05, 15.83it/s, est. speed input: 18207.65 toks/s, output: 17.78 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [00:52<00:05, 15.83it/s, est. speed input: 18188.61 toks/s, output: 17.76 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [00:53<00:04, 15.83it/s, est. speed input: 18169.84 toks/s, output: 17.74 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [00:53<00:04, 15.83it/s, est. speed input: 18151.47 toks/s, output: 17.73 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [00:54<00:03, 15.83it/s, est. speed input: 18133.43 toks/s, output: 17.71 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [00:54<00:03, 15.83it/s, est. speed input: 18115.57 toks/s, output: 17.69 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [00:55<00:02, 15.83it/s, est. speed input: 18098.14 toks/s, output: 17.67 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [00:55<00:02, 15.83it/s, est. speed input: 18081.06 toks/s, output: 17.66 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [00:56<00:01, 15.83it/s, est. speed input: 18064.27 toks/s, output: 17.64 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [00:56<00:01, 15.83it/s, est. speed input: 18047.74 toks/s, output: 17.62 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [00:57<00:00, 15.83it/s, est. speed input: 18031.46 toks/s, output: 17.61 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [00:57<00:00, 16.42it/s, est. speed input: 18034.44 toks/s, output: 17.61 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:57<00:00, 16.42it/s, est. speed input: 18140.66 toks/s, output: 17.72 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:57<00:00, 17.72it/s, est. speed input: 18140.66 toks/s, output: 17.72 toks/s]
[rank0]:[W126 03:19:45.582539606 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 110.3s

测试结果:
  Requests/s:   15.93
  Tokens/s:     16323.98
  Total Reqs:   1024
  Elapsed:      64.30s

  [Prefill 分析]
  Total Prefill Tokens: 1048576
  Prefill Tokens/s:     16308.05

============================================================
[6/8] 测试 M=16384
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuBLASLt                                        │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 16384
│   M_prefill     = 16384 (= 16 x 1024)
│   M_decode      = 16
│   batched_tokens = 16384 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 2048
│   --max-num-seqs           = 16
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 16384
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 03:20:09 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 03:20:10 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=111498) WARNING 01-26 03:20:17 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=111498) WARNING 01-26 03:20:28 [backends.py:609] Failed to read file <frozen os>
Throughput: 15.64 requests/s, 16026.57 total tokens/s, 15.64 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048


─── STDERR ───
[2026-01-26 03:20:09] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:20:09] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:20:09] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:20:09] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:20:09] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:20:09] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:20:09] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:20:09] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:20:09] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:20:09] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:20:09] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:20:09] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:20:09] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:20:09] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 03:20:17] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:20:17] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:20:17] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:20:17] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:20:17] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:20:17] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:20:17] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:20:17] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:20:17] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:20:17] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:20:17] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:20:17] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:20:17] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:20:17] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=111498) [2026-01-26 03:20:18] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=111498) [2026-01-26 03:20:18] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=111498) [2026-01-26 03:20:18] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=111498) [2026-01-26 03:20:18] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=111498) [2026-01-26 03:20:18] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuBLASLt
(EngineCore_DP0 pid=111498) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=111498) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.42it/s]
(EngineCore_DP0 pid=111498) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.12it/s]
(EngineCore_DP0 pid=111498) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.15it/s]
(EngineCore_DP0 pid=111498) 
(EngineCore_DP0 pid=111498) [rank0]:W0126 03:20:36.300000 111498 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=111498) [rank0]:W0126 03:20:36.415000 111498 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=111498) [rank0]:W0126 03:20:37.868000 111498 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=111498) [rank0]:W0126 03:20:38.048000 111498 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=111498) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  14%|█▍        | 1/7 [00:00<00:00,  7.63it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  29%|██▊       | 2/7 [00:00<00:00,  7.93it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  43%|████▎     | 3/7 [00:00<00:00,  8.33it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  57%|█████▋    | 4/7 [00:00<00:00,  8.51it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  71%|███████▏  | 5/7 [00:00<00:00,  8.51it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  86%|████████▌ | 6/7 [00:00<00:00,  8.50it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00,  7.82it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00,  8.09it/s]
(EngineCore_DP0 pid=111498) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  20%|██        | 1/5 [00:00<00:00,  7.02it/s]
Capturing CUDA graphs (decode, FULL):  40%|████      | 2/5 [00:00<00:00,  7.87it/s]
Capturing CUDA graphs (decode, FULL):  60%|██████    | 3/5 [00:00<00:00,  7.95it/s]
Capturing CUDA graphs (decode, FULL):  80%|████████  | 4/5 [00:00<00:00,  6.62it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00,  6.93it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00,  7.09it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   1%|          | 25/2048 [00:00<00:08, 241.26it/s]
Adding requests:   2%|▏         | 50/2048 [00:00<00:08, 237.06it/s]
Adding requests:   4%|▎         | 76/2048 [00:00<00:07, 246.96it/s]
Adding requests:   5%|▍         | 102/2048 [00:00<00:07, 251.85it/s]
Adding requests:   6%|▋         | 129/2048 [00:00<00:07, 255.21it/s]
Adding requests:   8%|▊         | 156/2048 [00:00<00:07, 258.94it/s]
Adding requests:   9%|▉         | 185/2048 [00:00<00:06, 266.66it/s]
Adding requests:  10%|█         | 213/2048 [00:00<00:06, 270.16it/s]
Adding requests:  12%|█▏        | 241/2048 [00:00<00:06, 271.12it/s]
Adding requests:  13%|█▎        | 269/2048 [00:01<00:06, 265.78it/s]
Adding requests:  14%|█▍        | 296/2048 [00:01<00:06, 264.79it/s]
Adding requests:  16%|█▌        | 324/2048 [00:01<00:06, 267.72it/s]
Adding requests:  17%|█▋        | 352/2048 [00:01<00:06, 271.12it/s]
Adding requests:  19%|█▊        | 380/2048 [00:01<00:06, 271.80it/s]
Adding requests:  20%|██        | 410/2048 [00:01<00:05, 276.62it/s]
Adding requests:  21%|██▏       | 438/2048 [00:01<00:05, 272.84it/s]
Adding requests:  23%|██▎       | 466/2048 [00:01<00:05, 272.00it/s]
Adding requests:  24%|██▍       | 497/2048 [00:01<00:05, 281.65it/s]
Adding requests:  26%|██▌       | 529/2048 [00:01<00:05, 289.98it/s]
Adding requests:  27%|██▋       | 559/2048 [00:02<00:05, 286.78it/s]
Adding requests:  29%|██▊       | 588/2048 [00:02<00:05, 277.59it/s]
Adding requests:  30%|███       | 616/2048 [00:02<00:05, 273.67it/s]
Adding requests:  31%|███▏      | 644/2048 [00:02<00:05, 271.08it/s]
Adding requests:  33%|███▎      | 672/2048 [00:02<00:05, 266.75it/s]
Adding requests:  34%|███▍      | 702/2048 [00:02<00:04, 275.41it/s]
Adding requests:  36%|███▌      | 730/2048 [00:02<00:04, 271.68it/s]
Adding requests:  37%|███▋      | 758/2048 [00:02<00:04, 268.98it/s]
Adding requests:  38%|███▊      | 787/2048 [00:02<00:04, 273.10it/s]
Adding requests:  40%|███▉      | 815/2048 [00:03<00:04, 272.09it/s]
Adding requests:  41%|████▏     | 845/2048 [00:03<00:04, 278.03it/s]
Adding requests:  43%|████▎     | 873/2048 [00:03<00:04, 271.65it/s]
Adding requests:  44%|████▍     | 901/2048 [00:03<00:04, 272.19it/s]
Adding requests:  45%|████▌     | 929/2048 [00:03<00:04, 267.20it/s]
Adding requests:  47%|████▋     | 958/2048 [00:03<00:04, 270.86it/s]
Adding requests:  48%|████▊     | 986/2048 [00:03<00:03, 271.16it/s]
Adding requests:  50%|████▉     | 1014/2048 [00:03<00:03, 265.11it/s]
Adding requests:  51%|█████     | 1042/2048 [00:03<00:03, 269.27it/s]
Adding requests:  52%|█████▏    | 1070/2048 [00:03<00:03, 269.31it/s]
Adding requests:  54%|█████▎    | 1097/2048 [00:04<00:03, 267.53it/s]
Adding requests:  55%|█████▍    | 1124/2048 [00:04<00:03, 267.24it/s]
Adding requests:  56%|█████▌    | 1151/2048 [00:04<00:03, 266.47it/s]
Adding requests:  58%|█████▊    | 1178/2048 [00:04<00:03, 260.58it/s]
Adding requests:  59%|█████▉    | 1205/2048 [00:04<00:03, 262.94it/s]
Adding requests:  60%|██████    | 1234/2048 [00:04<00:03, 269.61it/s]
Adding requests:  62%|██████▏   | 1261/2048 [00:04<00:02, 266.95it/s]
Adding requests:  63%|██████▎   | 1288/2048 [00:04<00:02, 263.01it/s]
Adding requests:  64%|██████▍   | 1317/2048 [00:04<00:02, 269.24it/s]
Adding requests:  66%|██████▌   | 1344/2048 [00:04<00:02, 267.24it/s]
Adding requests:  67%|██████▋   | 1374/2048 [00:05<00:02, 274.76it/s]
Adding requests:  68%|██████▊   | 1402/2048 [00:05<00:02, 274.61it/s]
Adding requests:  70%|██████▉   | 1430/2048 [00:05<00:02, 258.53it/s]
Adding requests:  71%|███████   | 1458/2048 [00:05<00:02, 261.94it/s]
Adding requests:  73%|███████▎  | 1487/2048 [00:05<00:02, 268.66it/s]
Adding requests:  74%|███████▍  | 1516/2048 [00:05<00:01, 273.65it/s]
Adding requests:  75%|███████▌  | 1544/2048 [00:05<00:01, 273.19it/s]
Adding requests:  77%|███████▋  | 1572/2048 [00:05<00:01, 267.61it/s]
Adding requests:  97%|█████████▋| 1981/2048 [00:05<00:00, 1368.00it/s]
Adding requests: 100%|██████████| 2048/2048 [00:06<00:00, 329.28it/s] 

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▌         | 114/2048 [00:00<00:12, 156.01it/s, est. speed input: 159756.79 toks/s, output: 156.01 toks/s]
Processed prompts:   6%|▋         | 130/2048 [00:01<00:30, 62.81it/s, est. speed input: 76309.35 toks/s, output: 74.52 toks/s]   
Processed prompts:   7%|▋         | 146/2048 [00:02<00:47, 39.90it/s, est. speed input: 54198.74 toks/s, output: 52.93 toks/s]
Processed prompts:   8%|▊         | 162/2048 [00:03<01:02, 29.99it/s, est. speed input: 43961.08 toks/s, output: 42.93 toks/s]
Processed prompts:   9%|▊         | 178/2048 [00:04<01:15, 24.73it/s, est. speed input: 38061.96 toks/s, output: 37.17 toks/s]
Processed prompts:   9%|▉         | 194/2048 [00:05<01:25, 21.62it/s, est. speed input: 34219.36 toks/s, output: 33.42 toks/s]
Processed prompts:  10%|█         | 210/2048 [00:06<01:33, 19.67it/s, est. speed input: 31519.45 toks/s, output: 30.78 toks/s]
Processed prompts:  11%|█         | 226/2048 [00:07<01:39, 18.40it/s, est. speed input: 29516.17 toks/s, output: 28.82 toks/s]
Processed prompts:  12%|█▏        | 242/2048 [00:08<01:42, 17.56it/s, est. speed input: 27973.31 toks/s, output: 27.32 toks/s]
Processed prompts:  13%|█▎        | 258/2048 [00:09<01:45, 16.98it/s, est. speed input: 26745.17 toks/s, output: 26.12 toks/s]
Processed prompts:  13%|█▎        | 274/2048 [00:10<01:46, 16.58it/s, est. speed input: 25744.82 toks/s, output: 25.14 toks/s]
Processed prompts:  14%|█▍        | 290/2048 [00:11<01:47, 16.31it/s, est. speed input: 24915.20 toks/s, output: 24.33 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [00:12<01:48, 16.11it/s, est. speed input: 24215.28 toks/s, output: 23.65 toks/s]
Processed prompts:  16%|█▌        | 322/2048 [00:13<01:47, 15.98it/s, est. speed input: 23619.51 toks/s, output: 23.07 toks/s]
Processed prompts:  17%|█▋        | 338/2048 [00:14<01:47, 15.89it/s, est. speed input: 23103.28 toks/s, output: 22.56 toks/s]
Processed prompts:  17%|█▋        | 354/2048 [00:16<01:47, 15.82it/s, est. speed input: 22652.72 toks/s, output: 22.12 toks/s]
Processed prompts:  18%|█▊        | 370/2048 [00:17<01:46, 15.77it/s, est. speed input: 22255.70 toks/s, output: 21.73 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [00:18<01:45, 15.74it/s, est. speed input: 21903.90 toks/s, output: 21.39 toks/s]
Processed prompts:  20%|█▉        | 402/2048 [00:19<01:44, 15.71it/s, est. speed input: 21588.68 toks/s, output: 21.08 toks/s]
Processed prompts:  20%|██        | 418/2048 [00:20<01:43, 15.70it/s, est. speed input: 21305.76 toks/s, output: 20.81 toks/s]
Processed prompts:  21%|██        | 434/2048 [00:21<01:42, 15.68it/s, est. speed input: 21049.84 toks/s, output: 20.56 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [00:22<01:41, 15.67it/s, est. speed input: 20817.25 toks/s, output: 20.33 toks/s]
Processed prompts:  23%|██▎       | 466/2048 [00:23<01:41, 15.66it/s, est. speed input: 20605.17 toks/s, output: 20.12 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [00:24<01:40, 15.66it/s, est. speed input: 20411.78 toks/s, output: 19.93 toks/s]
Processed prompts:  24%|██▍       | 498/2048 [00:25<01:39, 15.65it/s, est. speed input: 20233.41 toks/s, output: 19.76 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [00:26<01:38, 15.65it/s, est. speed input: 20069.15 toks/s, output: 19.60 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [00:27<01:37, 15.65it/s, est. speed input: 19917.02 toks/s, output: 19.45 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [00:28<01:35, 15.65it/s, est. speed input: 19775.96 toks/s, output: 19.31 toks/s]
Processed prompts:  27%|██▋       | 562/2048 [00:29<01:34, 15.64it/s, est. speed input: 19644.55 toks/s, output: 19.18 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [00:30<01:33, 15.64it/s, est. speed input: 19522.37 toks/s, output: 19.06 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [00:30<01:03, 22.74it/s, est. speed input: 20162.69 toks/s, output: 19.69 toks/s]
Processed prompts:  31%|███       | 626/2048 [00:32<01:09, 20.44it/s, est. speed input: 20030.38 toks/s, output: 19.56 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [00:33<01:14, 18.93it/s, est. speed input: 19906.39 toks/s, output: 19.44 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [00:34<01:17, 17.90it/s, est. speed input: 19788.88 toks/s, output: 19.33 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [00:35<01:19, 17.20it/s, est. speed input: 19678.22 toks/s, output: 19.22 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [00:36<01:21, 16.72it/s, est. speed input: 19573.80 toks/s, output: 19.12 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [00:37<01:21, 16.39it/s, est. speed input: 19475.44 toks/s, output: 19.02 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [00:38<01:22, 16.16it/s, est. speed input: 19382.31 toks/s, output: 18.93 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [00:39<01:21, 16.00it/s, est. speed input: 19293.89 toks/s, output: 18.84 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [00:40<01:21, 15.88it/s, est. speed input: 19209.62 toks/s, output: 18.76 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [00:41<01:20, 15.80it/s, est. speed input: 19129.27 toks/s, output: 18.68 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [00:42<01:18, 16.06it/s, est. speed input: 19083.43 toks/s, output: 18.64 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [00:43<01:18, 15.92it/s, est. speed input: 19009.96 toks/s, output: 18.56 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [00:44<01:17, 15.83it/s, est. speed input: 18940.00 toks/s, output: 18.50 toks/s]
Processed prompts:  41%|████      | 834/2048 [00:45<01:17, 15.76it/s, est. speed input: 18873.13 toks/s, output: 18.43 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [00:46<01:16, 15.72it/s, est. speed input: 18809.50 toks/s, output: 18.37 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [00:47<01:15, 15.69it/s, est. speed input: 18748.67 toks/s, output: 18.31 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [00:48<01:14, 15.67it/s, est. speed input: 18690.38 toks/s, output: 18.25 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [00:49<01:13, 15.66it/s, est. speed input: 18634.52 toks/s, output: 18.20 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [00:50<01:12, 15.65it/s, est. speed input: 18580.95 toks/s, output: 18.15 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [00:51<01:11, 15.64it/s, est. speed input: 18529.54 toks/s, output: 18.10 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [00:52<01:10, 15.64it/s, est. speed input: 18480.07 toks/s, output: 18.05 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [00:53<01:09, 15.63it/s, est. speed input: 18432.65 toks/s, output: 18.00 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [00:54<01:08, 15.63it/s, est. speed input: 18386.78 toks/s, output: 17.96 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [00:55<01:07, 15.63it/s, est. speed input: 18342.67 toks/s, output: 17.91 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [00:56<01:06, 15.63it/s, est. speed input: 18300.26 toks/s, output: 17.87 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [00:57<01:05, 15.63it/s, est. speed input: 18259.36 toks/s, output: 17.83 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [00:58<01:04, 15.62it/s, est. speed input: 18219.59 toks/s, output: 17.79 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [00:59<01:03, 15.62it/s, est. speed input: 18181.30 toks/s, output: 17.76 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [01:00<01:02, 15.62it/s, est. speed input: 18144.23 toks/s, output: 17.72 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [01:01<01:01, 15.62it/s, est. speed input: 18108.38 toks/s, output: 17.68 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [01:02<00:40, 22.72it/s, est. speed input: 18442.36 toks/s, output: 18.01 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [01:03<00:44, 20.42it/s, est. speed input: 18402.68 toks/s, output: 17.97 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [01:04<00:47, 18.91it/s, est. speed input: 18364.61 toks/s, output: 17.93 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [01:05<00:49, 17.89it/s, est. speed input: 18327.67 toks/s, output: 17.90 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [01:06<00:50, 17.19it/s, est. speed input: 18291.67 toks/s, output: 17.86 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [01:07<00:50, 16.72it/s, est. speed input: 18257.13 toks/s, output: 17.83 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [01:08<00:50, 16.38it/s, est. speed input: 18223.22 toks/s, output: 17.80 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [01:09<00:50, 16.15it/s, est. speed input: 18190.51 toks/s, output: 17.76 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [01:10<00:49, 15.99it/s, est. speed input: 18158.49 toks/s, output: 17.73 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [01:11<00:49, 15.88it/s, est. speed input: 18127.31 toks/s, output: 17.70 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [01:12<00:48, 15.80it/s, est. speed input: 18097.19 toks/s, output: 17.67 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [01:13<00:47, 15.74it/s, est. speed input: 18067.93 toks/s, output: 17.64 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [01:14<00:46, 15.71it/s, est. speed input: 18039.40 toks/s, output: 17.62 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [01:15<00:45, 15.68it/s, est. speed input: 18011.87 toks/s, output: 17.59 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [01:16<00:44, 15.66it/s, est. speed input: 17984.52 toks/s, output: 17.56 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [01:17<00:43, 15.64it/s, est. speed input: 17958.12 toks/s, output: 17.54 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [01:18<00:42, 15.63it/s, est. speed input: 17932.34 toks/s, output: 17.51 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [01:19<00:41, 15.62it/s, est. speed input: 17907.10 toks/s, output: 17.49 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [01:20<00:40, 15.61it/s, est. speed input: 17882.50 toks/s, output: 17.46 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [01:21<00:39, 15.61it/s, est. speed input: 17858.62 toks/s, output: 17.44 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [01:22<00:38, 15.61it/s, est. speed input: 17835.20 toks/s, output: 17.42 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [01:23<00:37, 15.61it/s, est. speed input: 17812.57 toks/s, output: 17.40 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [01:24<00:36, 15.61it/s, est. speed input: 17790.44 toks/s, output: 17.37 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [01:25<00:35, 15.61it/s, est. speed input: 17768.87 toks/s, output: 17.35 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [01:26<00:34, 15.61it/s, est. speed input: 17747.80 toks/s, output: 17.33 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [01:27<00:33, 15.61it/s, est. speed input: 17727.18 toks/s, output: 17.31 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [01:28<00:32, 15.61it/s, est. speed input: 17707.15 toks/s, output: 17.29 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [01:29<00:31, 15.61it/s, est. speed input: 17687.58 toks/s, output: 17.27 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [01:30<00:30, 15.61it/s, est. speed input: 17668.36 toks/s, output: 17.25 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [01:32<00:29, 15.61it/s, est. speed input: 17649.61 toks/s, output: 17.24 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [01:32<00:18, 23.20it/s, est. speed input: 17889.74 toks/s, output: 17.47 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [01:33<00:19, 20.70it/s, est. speed input: 17868.80 toks/s, output: 17.45 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [01:34<00:20, 19.08it/s, est. speed input: 17848.53 toks/s, output: 17.43 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [01:35<00:21, 18.00it/s, est. speed input: 17828.95 toks/s, output: 17.41 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [01:36<00:21, 17.27it/s, est. speed input: 17809.77 toks/s, output: 17.39 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [01:37<00:20, 16.77it/s, est. speed input: 17791.04 toks/s, output: 17.37 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [01:38<00:20, 16.43it/s, est. speed input: 17772.68 toks/s, output: 17.36 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [01:39<00:19, 16.19it/s, est. speed input: 17754.72 toks/s, output: 17.34 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [01:40<00:18, 16.02it/s, est. speed input: 17737.02 toks/s, output: 17.32 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [01:41<00:17, 15.91it/s, est. speed input: 17719.86 toks/s, output: 17.30 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [01:42<00:17, 15.82it/s, est. speed input: 17702.46 toks/s, output: 17.29 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [01:43<00:16, 15.74it/s, est. speed input: 17685.02 toks/s, output: 17.27 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [01:44<00:15, 15.69it/s, est. speed input: 17667.94 toks/s, output: 17.25 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [01:45<00:14, 15.65it/s, est. speed input: 17651.10 toks/s, output: 17.24 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [01:46<00:13, 15.62it/s, est. speed input: 17634.60 toks/s, output: 17.22 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [01:47<00:12, 15.61it/s, est. speed input: 17618.51 toks/s, output: 17.21 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [01:49<00:11, 15.60it/s, est. speed input: 17602.83 toks/s, output: 17.19 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [01:50<00:10, 15.60it/s, est. speed input: 17587.61 toks/s, output: 17.18 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [01:51<00:09, 15.59it/s, est. speed input: 17572.30 toks/s, output: 17.16 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [01:52<00:08, 15.58it/s, est. speed input: 17557.44 toks/s, output: 17.15 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [01:53<00:07, 15.58it/s, est. speed input: 17542.84 toks/s, output: 17.13 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [01:54<00:06, 15.58it/s, est. speed input: 17528.51 toks/s, output: 17.12 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [01:55<00:05, 15.58it/s, est. speed input: 17514.39 toks/s, output: 17.10 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [01:56<00:03, 15.57it/s, est. speed input: 17500.46 toks/s, output: 17.09 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [01:57<00:02, 15.57it/s, est. speed input: 17486.67 toks/s, output: 17.08 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [01:58<00:01, 15.57it/s, est. speed input: 17473.24 toks/s, output: 17.06 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [01:59<00:00, 15.92it/s, est. speed input: 17471.02 toks/s, output: 17.06 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [01:59<00:00, 15.92it/s, est. speed input: 17591.22 toks/s, output: 17.18 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [01:59<00:00, 17.18it/s, est. speed input: 17591.22 toks/s, output: 17.18 toks/s]
[rank0]:[W126 03:22:53.339470109 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 187.3s

测试结果:
  Requests/s:   15.64
  Tokens/s:     16026.57
  Total Reqs:   2048
  Elapsed:      130.98s

  [Prefill 分析]
  Total Prefill Tokens: 2097152
  Prefill Tokens/s:     16010.94

============================================================
[7/8] 测试 M=32768
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuBLASLt                                        │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 32768
│   M_prefill     = 32768 (= 32 x 1024)
│   M_decode      = 32
│   batched_tokens = 32768 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 4096
│   --max-num-seqs           = 32
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 32768
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 03:23:29 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 03:23:30 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=114574) WARNING 01-26 03:23:38 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=114574) WARNING 01-26 03:23:49 [backends.py:609] Failed to read file <frozen os>
Throughput: 15.83 requests/s, 16223.06 total tokens/s, 15.83 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096


─── STDERR ───
[2026-01-26 03:23:29] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:23:29] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:23:29] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:23:29] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:23:29] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:23:29] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:23:29] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:23:29] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:23:29] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:23:29] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:23:29] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:23:29] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:23:29] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:23:29] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 03:23:37] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:23:37] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:23:37] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:23:37] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:23:37] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:23:37] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:23:37] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:23:37] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:23:37] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:23:37] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:23:37] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:23:37] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:23:37] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:23:37] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=114574) [2026-01-26 03:23:38] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=114574) [2026-01-26 03:23:38] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=114574) [2026-01-26 03:23:38] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=114574) [2026-01-26 03:23:38] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=114574) [2026-01-26 03:23:38] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuBLASLt
(EngineCore_DP0 pid=114574) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=114574) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.39it/s]
(EngineCore_DP0 pid=114574) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.11it/s]
(EngineCore_DP0 pid=114574) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.14it/s]
(EngineCore_DP0 pid=114574) 
(EngineCore_DP0 pid=114574) [rank0]:W0126 03:23:57.690000 114574 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=114574) [rank0]:W0126 03:23:57.807000 114574 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=114574) [rank0]:W0126 03:23:59.353000 114574 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=114574) [rank0]:W0126 03:23:59.533000 114574 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=114574) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   9%|▉         | 1/11 [00:00<00:01,  7.84it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  18%|█▊        | 2/11 [00:00<00:01,  7.97it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  27%|██▋       | 3/11 [00:00<00:00,  8.26it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  36%|███▋      | 4/11 [00:00<00:00,  8.36it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  45%|████▌     | 5/11 [00:00<00:00,  8.36it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  55%|█████▍    | 6/11 [00:00<00:00,  8.34it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  64%|██████▎   | 7/11 [00:00<00:00,  8.36it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  73%|███████▎  | 8/11 [00:00<00:00,  8.33it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  82%|████████▏ | 9/11 [00:01<00:00,  7.06it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  91%|█████████ | 10/11 [00:01<00:00,  6.92it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00,  6.73it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00,  7.52it/s]
(EngineCore_DP0 pid=114574) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  14%|█▍        | 1/7 [00:00<00:00,  6.84it/s]
Capturing CUDA graphs (decode, FULL):  29%|██▊       | 2/7 [00:00<00:00,  7.72it/s]
Capturing CUDA graphs (decode, FULL):  43%|████▎     | 3/7 [00:00<00:00,  8.09it/s]
Capturing CUDA graphs (decode, FULL):  57%|█████▋    | 4/7 [00:00<00:00,  8.31it/s]
Capturing CUDA graphs (decode, FULL):  71%|███████▏  | 5/7 [00:00<00:00,  8.40it/s]
Capturing CUDA graphs (decode, FULL):  86%|████████▌ | 6/7 [00:00<00:00,  8.49it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00,  8.57it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00,  8.30it/s]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   1%|          | 23/4096 [00:00<00:17, 226.60it/s]
Adding requests:   1%|          | 49/4096 [00:00<00:16, 242.67it/s]
Adding requests:   2%|▏         | 77/4096 [00:00<00:15, 256.16it/s]
Adding requests:   3%|▎         | 103/4096 [00:00<00:15, 253.98it/s]
Adding requests:   3%|▎         | 129/4096 [00:00<00:15, 249.97it/s]
Adding requests:   4%|▍         | 155/4096 [00:00<00:15, 249.26it/s]
Adding requests:   5%|▍         | 185/4096 [00:00<00:14, 262.37it/s]
Adding requests:   5%|▌         | 214/4096 [00:00<00:14, 268.60it/s]
Adding requests:   6%|▌         | 242/4096 [00:00<00:14, 269.23it/s]
Adding requests:   7%|▋         | 270/4096 [00:01<00:14, 269.01it/s]
Adding requests:   7%|▋         | 299/4096 [00:01<00:13, 272.86it/s]
Adding requests:   8%|▊         | 327/4096 [00:01<00:14, 268.81it/s]
Adding requests:   9%|▊         | 357/4096 [00:01<00:13, 274.67it/s]
Adding requests:   9%|▉         | 386/4096 [00:01<00:13, 277.47it/s]
Adding requests:  10%|█         | 416/4096 [00:01<00:13, 282.43it/s]
Adding requests:  11%|█         | 445/4096 [00:01<00:13, 276.97it/s]
Adding requests:  12%|█▏        | 474/4096 [00:01<00:13, 278.10it/s]
Adding requests:  12%|█▏        | 504/4096 [00:01<00:12, 283.45it/s]
Adding requests:  13%|█▎        | 535/4096 [00:01<00:12, 290.47it/s]
Adding requests:  14%|█▍        | 565/4096 [00:02<00:12, 292.38it/s]
Adding requests:  15%|█▍        | 595/4096 [00:02<00:12, 282.26it/s]
Adding requests:  15%|█▌        | 624/4096 [00:02<00:12, 275.85it/s]
Adding requests:  16%|█▌        | 652/4096 [00:02<00:12, 271.76it/s]
Adding requests:  17%|█▋        | 680/4096 [00:02<00:12, 272.97it/s]
Adding requests:  17%|█▋        | 708/4096 [00:02<00:12, 274.59it/s]
Adding requests:  18%|█▊        | 736/4096 [00:02<00:12, 265.88it/s]
Adding requests:  19%|█▊        | 764/4096 [00:02<00:12, 266.95it/s]
Adding requests:  19%|█▉        | 792/4096 [00:02<00:12, 269.70it/s]
Adding requests:  20%|██        | 820/4096 [00:03<00:12, 269.70it/s]
Adding requests:  21%|██        | 848/4096 [00:03<00:11, 272.62it/s]
Adding requests:  21%|██▏       | 876/4096 [00:03<00:11, 272.56it/s]
Adding requests:  22%|██▏       | 904/4096 [00:03<00:11, 274.29it/s]
Adding requests:  23%|██▎       | 932/4096 [00:03<00:11, 265.55it/s]
Adding requests:  23%|██▎       | 960/4096 [00:03<00:11, 267.64it/s]
Adding requests:  24%|██▍       | 987/4096 [00:03<00:11, 267.70it/s]
Adding requests:  25%|██▍       | 1014/4096 [00:03<00:12, 249.37it/s]
Adding requests:  25%|██▌       | 1040/4096 [00:03<00:13, 230.07it/s]
Adding requests:  26%|██▌       | 1064/4096 [00:04<00:14, 214.23it/s]
Adding requests:  27%|██▋       | 1086/4096 [00:04<00:14, 204.39it/s]
Adding requests:  27%|██▋       | 1107/4096 [00:04<00:15, 197.78it/s]
Adding requests:  28%|██▊       | 1128/4096 [00:04<00:14, 199.21it/s]
Adding requests:  28%|██▊       | 1149/4096 [00:04<00:14, 199.07it/s]
Adding requests:  29%|██▊       | 1176/4096 [00:04<00:13, 216.70it/s]
Adding requests:  29%|██▉       | 1200/4096 [00:04<00:12, 222.78it/s]
Adding requests:  30%|███       | 1229/4096 [00:04<00:11, 241.78it/s]
Adding requests:  31%|███       | 1258/4096 [00:04<00:11, 252.66it/s]
Adding requests:  31%|███▏      | 1285/4096 [00:04<00:10, 256.80it/s]
Adding requests:  32%|███▏      | 1314/4096 [00:05<00:10, 264.76it/s]
Adding requests:  33%|███▎      | 1343/4096 [00:05<00:10, 269.24it/s]
Adding requests:  34%|███▎      | 1373/4096 [00:05<00:09, 276.07it/s]
Adding requests:  34%|███▍      | 1401/4096 [00:05<00:09, 275.61it/s]
Adding requests:  35%|███▍      | 1429/4096 [00:05<00:09, 274.78it/s]
Adding requests:  36%|███▌      | 1458/4096 [00:05<00:09, 275.97it/s]
Adding requests:  36%|███▋      | 1488/4096 [00:05<00:09, 280.46it/s]
Adding requests:  37%|███▋      | 1517/4096 [00:05<00:09, 280.17it/s]
Adding requests:  38%|███▊      | 1546/4096 [00:05<00:09, 278.97it/s]
Adding requests:  38%|███▊      | 1574/4096 [00:06<00:09, 275.11it/s]
Adding requests:  39%|███▉      | 1602/4096 [00:06<00:09, 274.37it/s]
Adding requests:  40%|███▉      | 1630/4096 [00:06<00:09, 267.83it/s]
Adding requests:  40%|████      | 1657/4096 [00:06<00:09, 263.70it/s]
Adding requests:  41%|████      | 1684/4096 [00:06<00:09, 263.33it/s]
Adding requests:  42%|████▏     | 1712/4096 [00:06<00:08, 266.81it/s]
Adding requests:  42%|████▏     | 1739/4096 [00:06<00:08, 263.83it/s]
Adding requests:  43%|████▎     | 1768/4096 [00:06<00:08, 271.29it/s]
Adding requests:  44%|████▍     | 1796/4096 [00:06<00:08, 263.40it/s]
Adding requests:  45%|████▍     | 1825/4096 [00:06<00:08, 269.84it/s]
Adding requests:  45%|████▌     | 1853/4096 [00:07<00:08, 271.24it/s]
Adding requests:  46%|████▌     | 1882/4096 [00:07<00:08, 275.51it/s]
Adding requests:  47%|████▋     | 1910/4096 [00:07<00:07, 276.17it/s]
Adding requests:  47%|████▋     | 1940/4096 [00:07<00:07, 282.97it/s]
Adding requests:  48%|████▊     | 1969/4096 [00:07<00:07, 282.09it/s]
Adding requests:  49%|████▉     | 1998/4096 [00:07<00:07, 278.89it/s]
Adding requests:  49%|████▉     | 2026/4096 [00:07<00:07, 273.14it/s]
Adding requests:  50%|█████     | 2054/4096 [00:07<00:07, 272.84it/s]
Adding requests:  51%|█████     | 2082/4096 [00:07<00:07, 261.77it/s]
Adding requests:  52%|█████▏    | 2111/4096 [00:08<00:07, 269.14it/s]
Adding requests:  52%|█████▏    | 2139/4096 [00:08<00:07, 266.52it/s]
Adding requests:  53%|█████▎    | 2166/4096 [00:08<00:07, 262.70it/s]
Adding requests:  54%|█████▎    | 2193/4096 [00:08<00:07, 264.49it/s]
Adding requests:  54%|█████▍    | 2220/4096 [00:08<00:07, 265.06it/s]
Adding requests:  55%|█████▍    | 2247/4096 [00:08<00:07, 261.47it/s]
Adding requests:  56%|█████▌    | 2277/4096 [00:08<00:06, 270.72it/s]
Adding requests:  56%|█████▋    | 2306/4096 [00:08<00:06, 273.47it/s]
Adding requests:  57%|█████▋    | 2334/4096 [00:08<00:06, 271.95it/s]
Adding requests:  58%|█████▊    | 2362/4096 [00:08<00:06, 273.46it/s]
Adding requests:  58%|█████▊    | 2392/4096 [00:09<00:06, 279.41it/s]
Adding requests:  59%|█████▉    | 2421/4096 [00:09<00:05, 281.03it/s]
Adding requests:  60%|█████▉    | 2450/4096 [00:09<00:06, 267.29it/s]
Adding requests:  60%|██████    | 2477/4096 [00:09<00:06, 267.97it/s]
Adding requests:  61%|██████    | 2506/4096 [00:09<00:05, 273.39it/s]
Adding requests:  62%|██████▏   | 2535/4096 [00:09<00:05, 276.18it/s]
Adding requests:  63%|██████▎   | 2566/4096 [00:09<00:05, 285.46it/s]
Adding requests:  63%|██████▎   | 2595/4096 [00:09<00:05, 285.19it/s]
Adding requests:  64%|██████▍   | 2624/4096 [00:09<00:05, 276.74it/s]
Adding requests:  65%|██████▍   | 2652/4096 [00:10<00:05, 268.91it/s]
Adding requests:  65%|██████▌   | 2680/4096 [00:10<00:05, 270.49it/s]
Adding requests:  66%|██████▌   | 2708/4096 [00:10<00:05, 271.53it/s]
Adding requests:  67%|██████▋   | 2736/4096 [00:10<00:04, 273.30it/s]
Adding requests:  68%|██████▊   | 2767/4096 [00:10<00:04, 282.46it/s]
Adding requests:  68%|██████▊   | 2797/4096 [00:10<00:04, 286.57it/s]
Adding requests:  69%|██████▉   | 2826/4096 [00:10<00:04, 285.12it/s]
Adding requests:  70%|██████▉   | 2856/4096 [00:10<00:04, 286.71it/s]
Adding requests:  70%|███████   | 2885/4096 [00:10<00:04, 285.25it/s]
Adding requests:  71%|███████   | 2914/4096 [00:10<00:04, 283.74it/s]
Adding requests:  72%|███████▏  | 2943/4096 [00:11<00:04, 282.86it/s]
Adding requests:  73%|███████▎  | 2972/4096 [00:11<00:03, 282.34it/s]
Adding requests:  73%|███████▎  | 3001/4096 [00:11<00:03, 284.29it/s]
Adding requests:  74%|███████▍  | 3032/4096 [00:11<00:03, 289.91it/s]
Adding requests:  75%|███████▍  | 3061/4096 [00:11<00:03, 289.26it/s]
Adding requests:  75%|███████▌  | 3090/4096 [00:11<00:03, 288.74it/s]
Adding requests:  76%|███████▌  | 3121/4096 [00:11<00:03, 292.83it/s]
Adding requests:  77%|███████▋  | 3151/4096 [00:11<00:03, 289.43it/s]
Adding requests:  78%|███████▊  | 3180/4096 [00:11<00:03, 282.24it/s]
Adding requests:  78%|███████▊  | 3209/4096 [00:11<00:03, 281.08it/s]
Adding requests:  79%|███████▉  | 3238/4096 [00:12<00:03, 283.63it/s]
Adding requests:  80%|███████▉  | 3267/4096 [00:12<00:02, 278.29it/s]
Adding requests:  80%|████████  | 3295/4096 [00:12<00:02, 272.21it/s]
Adding requests:  81%|████████  | 3323/4096 [00:12<00:02, 270.90it/s]
Adding requests:  82%|████████▏ | 3351/4096 [00:12<00:02, 267.96it/s]
Adding requests:  83%|████████▎ | 3380/4096 [00:12<00:02, 271.37it/s]
Adding requests:  83%|████████▎ | 3408/4096 [00:12<00:02, 272.65it/s]
Adding requests:  84%|████████▍ | 3436/4096 [00:12<00:02, 269.53it/s]
Adding requests:  85%|████████▍ | 3463/4096 [00:12<00:02, 268.29it/s]
Adding requests:  85%|████████▌ | 3490/4096 [00:13<00:02, 260.95it/s]
Adding requests:  86%|████████▌ | 3517/4096 [00:13<00:02, 262.13it/s]
Adding requests:  87%|████████▋ | 3546/4096 [00:13<00:02, 268.05it/s]
Adding requests:  87%|████████▋ | 3574/4096 [00:13<00:01, 268.85it/s]
Adding requests:  88%|████████▊ | 3602/4096 [00:13<00:01, 269.90it/s]
Adding requests:  89%|████████▊ | 3630/4096 [00:13<00:01, 270.86it/s]
Adding requests:  89%|████████▉ | 3658/4096 [00:13<00:01, 271.93it/s]
Adding requests:  90%|████████▉ | 3686/4096 [00:13<00:01, 267.32it/s]
Adding requests:  91%|█████████ | 3713/4096 [00:13<00:01, 261.44it/s]
Adding requests:  91%|█████████▏| 3741/4096 [00:13<00:01, 265.57it/s]
Adding requests:  92%|█████████▏| 3768/4096 [00:14<00:01, 263.34it/s]
Adding requests:  93%|█████████▎| 3795/4096 [00:14<00:01, 255.79it/s]
Adding requests:  93%|█████████▎| 3821/4096 [00:14<00:01, 246.63it/s]
Adding requests:  94%|█████████▍| 3849/4096 [00:14<00:00, 254.35it/s]
Adding requests:  95%|█████████▍| 3878/4096 [00:14<00:00, 264.06it/s]
Adding requests:  95%|█████████▌| 3905/4096 [00:14<00:00, 259.99it/s]
Adding requests:  96%|█████████▌| 3932/4096 [00:14<00:00, 259.94it/s]
Adding requests:  97%|█████████▋| 3961/4096 [00:14<00:00, 266.66it/s]
Adding requests:  97%|█████████▋| 3988/4096 [00:14<00:00, 266.59it/s]
Adding requests:  98%|█████████▊| 4016/4096 [00:15<00:00, 268.08it/s]
Adding requests:  99%|█████████▊| 4043/4096 [00:15<00:00, 264.90it/s]
Adding requests:  99%|█████████▉| 4071/4096 [00:15<00:00, 267.24it/s]
Adding requests: 100%|██████████| 4096/4096 [00:15<00:00, 267.59it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▌         | 226/4096 [00:01<00:19, 195.77it/s, est. speed input: 200470.48 toks/s, output: 195.77 toks/s]
Processed prompts:   6%|▋         | 258/4096 [00:03<00:56, 67.63it/s, est. speed input: 83640.58 toks/s, output: 81.68 toks/s]   
Processed prompts:   7%|▋         | 290/4096 [00:05<01:31, 41.55it/s, est. speed input: 57504.51 toks/s, output: 56.16 toks/s]
Processed prompts:   8%|▊         | 322/4096 [00:05<01:27, 43.36it/s, est. speed input: 56983.95 toks/s, output: 55.65 toks/s]
Processed prompts:   9%|▊         | 354/4096 [00:07<02:01, 30.81it/s, est. speed input: 46503.87 toks/s, output: 45.41 toks/s]
Processed prompts:   9%|▉         | 386/4096 [00:09<02:28, 24.93it/s, est. speed input: 40318.14 toks/s, output: 39.37 toks/s]
Processed prompts:  10%|█         | 418/4096 [00:11<02:49, 21.67it/s, est. speed input: 36226.76 toks/s, output: 35.38 toks/s]
Processed prompts:  11%|█         | 450/4096 [00:13<03:05, 19.70it/s, est. speed input: 33319.32 toks/s, output: 32.54 toks/s]
Processed prompts:  12%|█▏        | 482/4096 [00:15<03:15, 18.45it/s, est. speed input: 31150.91 toks/s, output: 30.42 toks/s]
Processed prompts:  13%|█▎        | 514/4096 [00:17<03:23, 17.63it/s, est. speed input: 29466.96 toks/s, output: 28.78 toks/s]
Processed prompts:  13%|█▎        | 546/4096 [00:19<03:27, 17.07it/s, est. speed input: 28125.54 toks/s, output: 27.47 toks/s]
Processed prompts:  14%|█▍        | 578/4096 [00:21<03:30, 16.70it/s, est. speed input: 27029.37 toks/s, output: 26.40 toks/s]
Processed prompts:  15%|█▍        | 610/4096 [00:23<03:32, 16.44it/s, est. speed input: 26117.83 toks/s, output: 25.51 toks/s]
Processed prompts:  16%|█▌        | 642/4096 [00:25<03:32, 16.26it/s, est. speed input: 25349.15 toks/s, output: 24.76 toks/s]
Processed prompts:  16%|█▋        | 674/4096 [00:27<03:32, 16.14it/s, est. speed input: 24690.98 toks/s, output: 24.11 toks/s]
Processed prompts:  17%|█▋        | 706/4096 [00:29<03:31, 16.05it/s, est. speed input: 24122.12 toks/s, output: 23.56 toks/s]
Processed prompts:  18%|█▊        | 738/4096 [00:31<03:30, 15.99it/s, est. speed input: 23623.18 toks/s, output: 23.07 toks/s]
Processed prompts:  19%|█▉        | 770/4096 [00:33<03:26, 16.08it/s, est. speed input: 23221.91 toks/s, output: 22.68 toks/s]
Processed prompts:  20%|█▉        | 802/4096 [00:35<03:25, 16.01it/s, est. speed input: 22829.38 toks/s, output: 22.29 toks/s]
Processed prompts:  20%|██        | 834/4096 [00:37<03:24, 15.96it/s, est. speed input: 22477.80 toks/s, output: 21.95 toks/s]
Processed prompts:  21%|██        | 866/4096 [00:38<02:40, 20.07it/s, est. speed input: 22956.88 toks/s, output: 22.42 toks/s]
Processed prompts:  22%|██▏       | 898/4096 [00:40<02:52, 18.58it/s, est. speed input: 22621.39 toks/s, output: 22.09 toks/s]
Processed prompts:  23%|██▎       | 930/4096 [00:42<02:59, 17.67it/s, est. speed input: 22318.96 toks/s, output: 21.80 toks/s]
Processed prompts:  23%|██▎       | 962/4096 [00:44<03:03, 17.08it/s, est. speed input: 22043.18 toks/s, output: 21.53 toks/s]
Processed prompts:  24%|██▍       | 994/4096 [00:46<03:05, 16.68it/s, est. speed input: 21791.28 toks/s, output: 21.28 toks/s]
Processed prompts:  25%|██▌       | 1026/4096 [00:48<03:06, 16.42it/s, est. speed input: 21560.04 toks/s, output: 21.05 toks/s]
Processed prompts:  26%|██▌       | 1058/4096 [00:50<03:07, 16.24it/s, est. speed input: 21347.01 toks/s, output: 20.85 toks/s]
Processed prompts:  27%|██▋       | 1090/4096 [00:52<03:06, 16.11it/s, est. speed input: 21150.26 toks/s, output: 20.65 toks/s]
Processed prompts:  27%|██▋       | 1122/4096 [00:54<03:05, 16.03it/s, est. speed input: 20968.16 toks/s, output: 20.48 toks/s]
Processed prompts:  28%|██▊       | 1154/4096 [00:56<03:04, 15.97it/s, est. speed input: 20799.05 toks/s, output: 20.31 toks/s]
Processed prompts:  29%|██▉       | 1186/4096 [00:58<03:02, 15.93it/s, est. speed input: 20641.66 toks/s, output: 20.16 toks/s]
Processed prompts:  30%|██▉       | 1218/4096 [01:00<03:00, 15.90it/s, est. speed input: 20494.60 toks/s, output: 20.01 toks/s]
Processed prompts:  31%|███       | 1250/4096 [01:02<02:59, 15.88it/s, est. speed input: 20357.29 toks/s, output: 19.88 toks/s]
Processed prompts:  31%|███▏      | 1282/4096 [01:04<02:57, 15.87it/s, est. speed input: 20228.20 toks/s, output: 19.75 toks/s]
Processed prompts:  32%|███▏      | 1314/4096 [01:06<02:55, 15.85it/s, est. speed input: 20106.39 toks/s, output: 19.64 toks/s]
Processed prompts:  33%|███▎      | 1346/4096 [01:08<02:53, 15.85it/s, est. speed input: 19992.31 toks/s, output: 19.52 toks/s]
Processed prompts:  34%|███▎      | 1378/4096 [01:09<02:16, 19.97it/s, est. speed input: 20282.49 toks/s, output: 19.81 toks/s]
Processed prompts:  34%|███▍      | 1410/4096 [01:11<02:25, 18.52it/s, est. speed input: 20167.61 toks/s, output: 19.69 toks/s]
Processed prompts:  35%|███▌      | 1442/4096 [01:13<02:30, 17.63it/s, est. speed input: 20059.42 toks/s, output: 19.59 toks/s]
Processed prompts:  36%|███▌      | 1474/4096 [01:15<02:33, 17.05it/s, est. speed input: 19957.01 toks/s, output: 19.49 toks/s]
Processed prompts:  37%|███▋      | 1506/4096 [01:17<02:35, 16.67it/s, est. speed input: 19859.62 toks/s, output: 19.39 toks/s]
Processed prompts:  38%|███▊      | 1538/4096 [01:19<02:35, 16.41it/s, est. speed input: 19767.11 toks/s, output: 19.30 toks/s]
Processed prompts:  38%|███▊      | 1570/4096 [01:21<02:35, 16.22it/s, est. speed input: 19678.57 toks/s, output: 19.22 toks/s]
Processed prompts:  39%|███▉      | 1602/4096 [01:23<02:33, 16.24it/s, est. speed input: 19607.54 toks/s, output: 19.15 toks/s]
Processed prompts:  40%|███▉      | 1634/4096 [01:25<02:32, 16.11it/s, est. speed input: 19526.98 toks/s, output: 19.07 toks/s]
Processed prompts:  41%|████      | 1666/4096 [01:27<02:31, 16.02it/s, est. speed input: 19450.26 toks/s, output: 18.99 toks/s]
Processed prompts:  41%|████▏     | 1698/4096 [01:29<02:30, 15.95it/s, est. speed input: 19376.25 toks/s, output: 18.92 toks/s]
Processed prompts:  42%|████▏     | 1730/4096 [01:31<02:28, 15.91it/s, est. speed input: 19305.91 toks/s, output: 18.85 toks/s]
Processed prompts:  43%|████▎     | 1762/4096 [01:33<02:26, 15.88it/s, est. speed input: 19238.72 toks/s, output: 18.79 toks/s]
Processed prompts:  44%|████▍     | 1794/4096 [01:35<02:25, 15.86it/s, est. speed input: 19174.45 toks/s, output: 18.73 toks/s]
Processed prompts:  45%|████▍     | 1826/4096 [01:37<02:23, 15.85it/s, est. speed input: 19112.98 toks/s, output: 18.67 toks/s]
Processed prompts:  45%|████▌     | 1858/4096 [01:39<02:21, 15.84it/s, est. speed input: 19054.03 toks/s, output: 18.61 toks/s]
Processed prompts:  46%|████▌     | 1890/4096 [01:40<01:50, 19.97it/s, est. speed input: 19260.91 toks/s, output: 18.81 toks/s]
Processed prompts:  47%|████▋     | 1922/4096 [01:42<01:57, 18.52it/s, est. speed input: 19201.22 toks/s, output: 18.75 toks/s]
Processed prompts:  48%|████▊     | 1954/4096 [01:44<02:01, 17.64it/s, est. speed input: 19144.47 toks/s, output: 18.70 toks/s]
Processed prompts:  48%|████▊     | 1986/4096 [01:46<02:03, 17.07it/s, est. speed input: 19089.44 toks/s, output: 18.64 toks/s]
Processed prompts:  49%|████▉     | 2018/4096 [01:48<02:04, 16.69it/s, est. speed input: 19036.64 toks/s, output: 18.59 toks/s]
Processed prompts:  50%|█████     | 2050/4096 [01:50<02:04, 16.41it/s, est. speed input: 18984.28 toks/s, output: 18.54 toks/s]
Processed prompts:  51%|█████     | 2082/4096 [01:52<02:04, 16.21it/s, est. speed input: 18933.05 toks/s, output: 18.49 toks/s]
Processed prompts:  52%|█████▏    | 2114/4096 [01:54<02:03, 16.07it/s, est. speed input: 18883.55 toks/s, output: 18.44 toks/s]
Processed prompts:  52%|█████▏    | 2146/4096 [01:56<02:02, 15.98it/s, est. speed input: 18835.57 toks/s, output: 18.39 toks/s]
Processed prompts:  53%|█████▎    | 2178/4096 [01:58<01:59, 16.05it/s, est. speed input: 18798.61 toks/s, output: 18.36 toks/s]
Processed prompts:  54%|█████▍    | 2210/4096 [02:00<01:58, 15.96it/s, est. speed input: 18753.59 toks/s, output: 18.31 toks/s]
Processed prompts:  55%|█████▍    | 2242/4096 [02:02<01:56, 15.89it/s, est. speed input: 18710.10 toks/s, output: 18.27 toks/s]
Processed prompts:  56%|█████▌    | 2274/4096 [02:04<01:54, 15.85it/s, est. speed input: 18668.16 toks/s, output: 18.23 toks/s]
Processed prompts:  56%|█████▋    | 2306/4096 [02:06<01:52, 15.84it/s, est. speed input: 18628.87 toks/s, output: 18.19 toks/s]
Processed prompts:  57%|█████▋    | 2338/4096 [02:08<01:51, 15.83it/s, est. speed input: 18590.44 toks/s, output: 18.15 toks/s]
Processed prompts:  58%|█████▊    | 2370/4096 [02:10<01:49, 15.83it/s, est. speed input: 18553.58 toks/s, output: 18.12 toks/s]
Processed prompts:  59%|█████▊    | 2402/4096 [02:11<01:24, 20.02it/s, est. speed input: 18716.47 toks/s, output: 18.28 toks/s]
Processed prompts:  59%|█████▉    | 2434/4096 [02:13<01:29, 18.54it/s, est. speed input: 18678.44 toks/s, output: 18.24 toks/s]
Processed prompts:  60%|██████    | 2466/4096 [02:15<01:32, 17.63it/s, est. speed input: 18641.12 toks/s, output: 18.20 toks/s]
Processed prompts:  61%|██████    | 2498/4096 [02:17<01:33, 17.04it/s, est. speed input: 18605.08 toks/s, output: 18.17 toks/s]
Processed prompts:  62%|██████▏   | 2530/4096 [02:19<01:34, 16.65it/s, est. speed input: 18570.13 toks/s, output: 18.13 toks/s]
Processed prompts:  63%|██████▎   | 2562/4096 [02:21<01:33, 16.39it/s, est. speed input: 18536.23 toks/s, output: 18.10 toks/s]
Processed prompts:  63%|██████▎   | 2594/4096 [02:23<01:32, 16.22it/s, est. speed input: 18503.29 toks/s, output: 18.07 toks/s]
Processed prompts:  64%|██████▍   | 2626/4096 [02:25<01:31, 16.09it/s, est. speed input: 18470.97 toks/s, output: 18.04 toks/s]
Processed prompts:  65%|██████▍   | 2658/4096 [02:27<01:29, 16.01it/s, est. speed input: 18439.93 toks/s, output: 18.01 toks/s]
Processed prompts:  66%|██████▌   | 2690/4096 [02:29<01:28, 15.95it/s, est. speed input: 18409.71 toks/s, output: 17.98 toks/s]
Processed prompts:  66%|██████▋   | 2722/4096 [02:31<01:26, 15.91it/s, est. speed input: 18379.92 toks/s, output: 17.95 toks/s]
Processed prompts:  67%|██████▋   | 2754/4096 [02:33<01:24, 15.88it/s, est. speed input: 18351.15 toks/s, output: 17.92 toks/s]
Processed prompts:  68%|██████▊   | 2786/4096 [02:35<01:22, 15.86it/s, est. speed input: 18322.91 toks/s, output: 17.89 toks/s]
Processed prompts:  69%|██████▉   | 2818/4096 [02:37<01:20, 15.84it/s, est. speed input: 18295.68 toks/s, output: 17.87 toks/s]
Processed prompts:  70%|██████▉   | 2850/4096 [02:39<01:18, 15.83it/s, est. speed input: 18268.91 toks/s, output: 17.84 toks/s]
Processed prompts:  70%|███████   | 2882/4096 [02:41<01:16, 15.82it/s, est. speed input: 18242.83 toks/s, output: 17.82 toks/s]
Processed prompts:  71%|███████   | 2914/4096 [02:42<00:59, 19.91it/s, est. speed input: 18372.73 toks/s, output: 17.94 toks/s]
Processed prompts:  72%|███████▏  | 2946/4096 [02:44<01:02, 18.47it/s, est. speed input: 18345.86 toks/s, output: 17.92 toks/s]
Processed prompts:  73%|███████▎  | 2978/4096 [02:46<01:03, 17.58it/s, est. speed input: 18319.54 toks/s, output: 17.89 toks/s]
Processed prompts:  73%|███████▎  | 3010/4096 [02:48<01:03, 17.01it/s, est. speed input: 18293.80 toks/s, output: 17.87 toks/s]
Processed prompts:  74%|███████▍  | 3042/4096 [02:50<01:03, 16.63it/s, est. speed input: 18268.71 toks/s, output: 17.84 toks/s]
Processed prompts:  75%|███████▌  | 3074/4096 [02:52<01:02, 16.37it/s, est. speed input: 18244.20 toks/s, output: 17.82 toks/s]
Processed prompts:  76%|███████▌  | 3106/4096 [02:54<01:01, 16.20it/s, est. speed input: 18220.38 toks/s, output: 17.79 toks/s]
Processed prompts:  77%|███████▋  | 3138/4096 [02:56<00:59, 16.08it/s, est. speed input: 18196.99 toks/s, output: 17.77 toks/s]
Processed prompts:  77%|███████▋  | 3170/4096 [02:58<00:57, 15.99it/s, est. speed input: 18174.09 toks/s, output: 17.75 toks/s]
Processed prompts:  78%|███████▊  | 3202/4096 [03:00<00:56, 15.93it/s, est. speed input: 18151.47 toks/s, output: 17.73 toks/s]
Processed prompts:  79%|███████▉  | 3234/4096 [03:02<00:54, 15.90it/s, est. speed input: 18129.99 toks/s, output: 17.71 toks/s]
Processed prompts:  80%|███████▉  | 3266/4096 [03:04<00:52, 15.87it/s, est. speed input: 18108.81 toks/s, output: 17.68 toks/s]
Processed prompts:  81%|████████  | 3298/4096 [03:06<00:50, 15.86it/s, est. speed input: 18088.21 toks/s, output: 17.66 toks/s]
Processed prompts:  81%|████████▏ | 3330/4096 [03:08<00:48, 15.85it/s, est. speed input: 18068.03 toks/s, output: 17.64 toks/s]
Processed prompts:  82%|████████▏ | 3362/4096 [03:10<00:46, 15.84it/s, est. speed input: 18048.10 toks/s, output: 17.63 toks/s]
Processed prompts:  83%|████████▎ | 3394/4096 [03:12<00:44, 15.83it/s, est. speed input: 18028.64 toks/s, output: 17.61 toks/s]
Processed prompts:  84%|████████▎ | 3426/4096 [03:13<00:33, 19.91it/s, est. speed input: 18138.20 toks/s, output: 17.71 toks/s]
Processed prompts:  84%|████████▍ | 3458/4096 [03:15<00:34, 18.47it/s, est. speed input: 18118.01 toks/s, output: 17.69 toks/s]
Processed prompts:  85%|████████▌ | 3490/4096 [03:17<00:34, 17.58it/s, est. speed input: 18098.25 toks/s, output: 17.67 toks/s]
Processed prompts:  86%|████████▌ | 3522/4096 [03:19<00:33, 17.00it/s, est. speed input: 18078.66 toks/s, output: 17.65 toks/s]
Processed prompts:  87%|████████▋ | 3554/4096 [03:21<00:32, 16.62it/s, est. speed input: 18059.49 toks/s, output: 17.64 toks/s]
Processed prompts:  88%|████████▊ | 3586/4096 [03:23<00:31, 16.36it/s, est. speed input: 18040.62 toks/s, output: 17.62 toks/s]
Processed prompts:  88%|████████▊ | 3618/4096 [03:25<00:29, 16.18it/s, est. speed input: 18021.91 toks/s, output: 17.60 toks/s]
Processed prompts:  89%|████████▉ | 3650/4096 [03:27<00:27, 16.06it/s, est. speed input: 18003.89 toks/s, output: 17.58 toks/s]
Processed prompts:  90%|████████▉ | 3682/4096 [03:29<00:25, 16.12it/s, est. speed input: 17991.12 toks/s, output: 17.57 toks/s]
Processed prompts:  91%|█████████ | 3714/4096 [03:31<00:23, 16.03it/s, est. speed input: 17973.92 toks/s, output: 17.55 toks/s]
Processed prompts:  91%|█████████▏| 3746/4096 [03:33<00:21, 15.96it/s, est. speed input: 17956.88 toks/s, output: 17.54 toks/s]
Processed prompts:  92%|█████████▏| 3778/4096 [03:35<00:19, 15.91it/s, est. speed input: 17940.27 toks/s, output: 17.52 toks/s]
Processed prompts:  93%|█████████▎| 3810/4096 [03:37<00:18, 15.88it/s, est. speed input: 17923.87 toks/s, output: 17.50 toks/s]
Processed prompts:  94%|█████████▍| 3842/4096 [03:39<00:16, 15.85it/s, est. speed input: 17907.72 toks/s, output: 17.49 toks/s]
Processed prompts:  95%|█████████▍| 3874/4096 [03:41<00:14, 15.84it/s, est. speed input: 17892.06 toks/s, output: 17.47 toks/s]
Processed prompts:  95%|█████████▌| 3906/4096 [03:43<00:11, 15.96it/s, est. speed input: 17881.02 toks/s, output: 17.46 toks/s]
Processed prompts:  96%|█████████▌| 3938/4096 [03:44<00:07, 20.37it/s, est. speed input: 17982.62 toks/s, output: 17.56 toks/s]
Processed prompts:  97%|█████████▋| 3970/4096 [03:46<00:06, 18.75it/s, est. speed input: 17966.52 toks/s, output: 17.55 toks/s]
Processed prompts:  98%|█████████▊| 4002/4096 [03:48<00:05, 17.75it/s, est. speed input: 17950.58 toks/s, output: 17.53 toks/s]
Processed prompts:  98%|█████████▊| 4034/4096 [03:50<00:03, 17.11it/s, est. speed input: 17934.94 toks/s, output: 17.51 toks/s]
Processed prompts:  99%|█████████▉| 4066/4096 [03:52<00:01, 16.86it/s, est. speed input: 17924.53 toks/s, output: 17.50 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [03:52<00:00, 16.86it/s, est. speed input: 18056.74 toks/s, output: 17.63 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [03:52<00:00, 17.63it/s, est. speed input: 18056.74 toks/s, output: 17.63 toks/s]
[rank0]:[W126 03:28:16.287273135 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 323.7s

测试结果:
  Requests/s:   15.83
  Tokens/s:     16223.06
  Total Reqs:   4096
  Elapsed:      258.79s

  [Prefill 分析]
  Total Prefill Tokens: 4194304
  Prefill Tokens/s:     16207.23

============================================================
[8/8] 测试 M=65536
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuBLASLt                                        │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 65536
│   M_prefill     = 65536 (= 64 x 1024)
│   M_decode      = 64
│   batched_tokens = 65536 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 8192
│   --max-num-seqs           = 64
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 65536
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 03:29:23 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 03:29:24 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=119866) WARNING 01-26 03:29:41 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=119866) WARNING 01-26 03:29:51 [backends.py:609] Failed to read file <frozen os>
Throughput: 15.67 requests/s, 16062.00 total tokens/s, 15.67 output tokens/s
Total num prompt tokens:  8388608
Total num output tokens:  8192


─── STDERR ───
[2026-01-26 03:29:23] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:29:23] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:29:23] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:29:23] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:29:23] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:29:23] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:29:23] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:29:23] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:29:23] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:29:23] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:29:23] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:29:23] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:29:23] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:29:23] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 03:29:31] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:29:31] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:29:31] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:29:31] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:29:31] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:29:31] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:29:31] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:29:31] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:29:31] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:29:31] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:29:31] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:29:31] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:29:31] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:29:31] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[W126 03:29:41.596263955 socket.cpp:209] [c10d] The hostname of the client socket cannot be retrieved. err=-3
(EngineCore_DP0 pid=119866) [2026-01-26 03:29:42] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=119866) [2026-01-26 03:29:42] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=119866) [2026-01-26 03:29:42] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=119866) [2026-01-26 03:29:42] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=119866) [2026-01-26 03:29:42] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuBLASLt
(EngineCore_DP0 pid=119866) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=119866) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.23it/s]
(EngineCore_DP0 pid=119866) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.07it/s]
(EngineCore_DP0 pid=119866) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.09it/s]
(EngineCore_DP0 pid=119866) 
(EngineCore_DP0 pid=119866) [rank0]:W0126 03:29:59.588000 119866 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=119866) [rank0]:W0126 03:29:59.700000 119866 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:00] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=4608, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [rank0]:W0126 03:30:01.368000 119866 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=119866) [rank0]:W0126 03:30:01.541000 119866 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:02] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:02] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=37888, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:02] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=18944), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:02] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=4608, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:02] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:02] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=37888, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:02] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=18944), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:02] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=4608, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:02] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:02] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=37888, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:02] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=18944), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:02] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=4608, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:03] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:03] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=37888, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:03] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=18944), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:03] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=4608, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:03] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:03] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=37888, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:03] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=18944), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:03] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=4608, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:03] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:03] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=37888, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:03] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=18944), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:03] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=4608, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:03] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:03] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=37888, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:03] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=18944), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:03] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=4608, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:03] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:03] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=37888, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:03] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=18944), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:03] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=4608, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:04] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:04] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=37888, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:04] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=18944), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:04] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=4608, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:04] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:04] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=37888, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:04] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=18944), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:04] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=4608, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:04] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:04] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=37888, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:04] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=18944), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:04] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=4608, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:04] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:04] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=37888, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:04] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=18944), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:04] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=4608, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:04] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:04] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=37888, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:04] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=18944), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:04] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=4608, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:05] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:05] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=37888, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:05] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=18944), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:05] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=4608, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:05] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:05] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=37888, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:05] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=18944), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:05] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=4608, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:05] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:05] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=37888, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:05] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=18944), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:05] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=4608, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:05] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:05] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=37888, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:05] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=18944), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:05] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=4608, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:05] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:05] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=37888, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:05] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=18944), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:05] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=4608, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:06] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:06] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=37888, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:06] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=18944), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:06] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=4608, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:06] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:06] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=37888, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:06] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=18944), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:06] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=4608, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:06] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:06] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=37888, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:06] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=18944), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:06] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=4608, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:07] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:07] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=37888, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:07] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=18944), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:07] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=4608, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:07] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:07] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=37888, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:07] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=18944), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:07] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=4608, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:07] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:07] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=37888, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:07] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=18944), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:07] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=4608, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:07] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:07] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=37888, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:07] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=18944), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:07] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=4608, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:07] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:07] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=37888, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:07] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=18944), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:07] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=4608, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:08] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:08] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=37888, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:08] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=18944), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:08] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=4608, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:08] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:08] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=37888, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=119866) [2026-01-26 03:30:09] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=18944), falling back to default heuristic
(EngineCore_DP0 pid=119866) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/19 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   5%|▌         | 1/19 [00:00<00:02,  7.54it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  11%|█         | 2/19 [00:00<00:02,  7.89it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  16%|█▌        | 3/19 [00:00<00:01,  8.11it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  21%|██        | 4/19 [00:00<00:01,  8.31it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  26%|██▋       | 5/19 [00:00<00:01,  8.41it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  32%|███▏      | 6/19 [00:00<00:01,  8.42it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  37%|███▋      | 7/19 [00:00<00:01,  8.47it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  42%|████▏     | 8/19 [00:00<00:01,  8.49it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  47%|████▋     | 9/19 [00:01<00:01,  8.23it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  53%|█████▎    | 10/19 [00:01<00:01,  6.84it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  58%|█████▊    | 11/19 [00:01<00:01,  6.87it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  63%|██████▎   | 12/19 [00:01<00:01,  6.76it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 19/19 [00:01<00:00, 18.78it/s]
(EngineCore_DP0 pid=119866) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):   9%|▉         | 1/11 [00:00<00:01,  7.09it/s]
Capturing CUDA graphs (decode, FULL):  18%|█▊        | 2/11 [00:00<00:01,  8.01it/s]
Capturing CUDA graphs (decode, FULL):  27%|██▋       | 3/11 [00:00<00:00,  8.35it/s]
Capturing CUDA graphs (decode, FULL):  36%|███▋      | 4/11 [00:00<00:00,  8.59it/s]
Capturing CUDA graphs (decode, FULL):  45%|████▌     | 5/11 [00:00<00:00,  8.63it/s]
Capturing CUDA graphs (decode, FULL):  55%|█████▍    | 6/11 [00:00<00:00,  8.75it/s]
Capturing CUDA graphs (decode, FULL):  64%|██████▎   | 7/11 [00:00<00:00,  8.80it/s]
Capturing CUDA graphs (decode, FULL):  73%|███████▎  | 8/11 [00:00<00:00,  8.90it/s]
Capturing CUDA graphs (decode, FULL):  82%|████████▏ | 9/11 [00:01<00:00,  8.89it/s]
Capturing CUDA graphs (decode, FULL):  91%|█████████ | 10/11 [00:01<00:00,  8.87it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 11/11 [00:01<00:00,  8.86it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 11/11 [00:01<00:00,  8.68it/s]

Adding requests:   0%|          | 0/8192 [00:00<?, ?it/s]
Adding requests:   0%|          | 23/8192 [00:00<00:36, 226.34it/s]
Adding requests:   1%|          | 49/8192 [00:00<00:33, 244.40it/s]
Adding requests:   1%|          | 76/8192 [00:00<00:31, 255.24it/s]
Adding requests:   1%|          | 102/8192 [00:00<00:31, 254.23it/s]
Adding requests:   2%|▏         | 128/8192 [00:00<00:31, 254.34it/s]
Adding requests:   2%|▏         | 155/8192 [00:00<00:31, 256.37it/s]
Adding requests:   2%|▏         | 184/8192 [00:00<00:30, 266.36it/s]
Adding requests:   3%|▎         | 211/8192 [00:00<00:30, 265.71it/s]
Adding requests:   3%|▎         | 238/8192 [00:00<00:30, 261.44it/s]
Adding requests:   3%|▎         | 265/8192 [00:01<00:30, 260.20it/s]
Adding requests:   4%|▎         | 292/8192 [00:01<00:30, 261.45it/s]
Adding requests:   4%|▍         | 320/8192 [00:01<00:29, 264.64it/s]
Adding requests:   4%|▍         | 347/8192 [00:01<00:30, 260.92it/s]
Adding requests:   5%|▍         | 375/8192 [00:01<00:29, 264.38it/s]
Adding requests:   5%|▍         | 404/8192 [00:01<00:28, 268.71it/s]
Adding requests:   5%|▌         | 431/8192 [00:01<00:29, 266.90it/s]
Adding requests:   6%|▌         | 458/8192 [00:01<00:29, 261.80it/s]
Adding requests:   6%|▌         | 487/8192 [00:01<00:28, 269.93it/s]
Adding requests:   6%|▋         | 515/8192 [00:01<00:28, 269.15it/s]
Adding requests:   7%|▋         | 544/8192 [00:02<00:28, 272.98it/s]
Adding requests:   7%|▋         | 573/8192 [00:02<00:27, 275.31it/s]
Adding requests:   7%|▋         | 601/8192 [00:02<00:28, 266.99it/s]
Adding requests:   8%|▊         | 628/8192 [00:02<00:28, 266.25it/s]
Adding requests:   8%|▊         | 655/8192 [00:02<00:28, 261.26it/s]
Adding requests:   8%|▊         | 683/8192 [00:02<00:28, 264.42it/s]
Adding requests:   9%|▊         | 710/8192 [00:02<00:28, 262.27it/s]
Adding requests:   9%|▉         | 737/8192 [00:02<00:28, 260.23it/s]
Adding requests:   9%|▉         | 765/8192 [00:02<00:28, 264.24it/s]
Adding requests:  10%|▉         | 793/8192 [00:03<00:27, 267.19it/s]
Adding requests:  10%|█         | 820/8192 [00:03<00:27, 266.05it/s]
Adding requests:  10%|█         | 849/8192 [00:03<00:27, 271.87it/s]
Adding requests:  11%|█         | 877/8192 [00:03<00:26, 272.10it/s]
Adding requests:  11%|█         | 906/8192 [00:03<00:26, 275.23it/s]
Adding requests:  11%|█▏        | 934/8192 [00:03<00:27, 264.20it/s]
Adding requests:  12%|█▏        | 962/8192 [00:03<00:27, 267.27it/s]
Adding requests:  12%|█▏        | 989/8192 [00:03<00:27, 264.23it/s]
Adding requests:  12%|█▏        | 1016/8192 [00:03<00:27, 262.55it/s]
Adding requests:  13%|█▎        | 1044/8192 [00:03<00:27, 264.30it/s]
Adding requests:  13%|█▎        | 1071/8192 [00:04<00:26, 265.33it/s]
Adding requests:  13%|█▎        | 1098/8192 [00:04<00:27, 262.47it/s]
Adding requests:  14%|█▎        | 1126/8192 [00:04<00:26, 265.25it/s]
Adding requests:  14%|█▍        | 1153/8192 [00:04<00:26, 262.99it/s]
Adding requests:  14%|█▍        | 1181/8192 [00:04<00:26, 266.78it/s]
Adding requests:  15%|█▍        | 1209/8192 [00:04<00:25, 269.60it/s]
Adding requests:  15%|█▌        | 1237/8192 [00:04<00:25, 271.81it/s]
Adding requests:  15%|█▌        | 1265/8192 [00:04<00:25, 270.81it/s]
Adding requests:  16%|█▌        | 1293/8192 [00:04<00:26, 263.04it/s]
Adding requests:  16%|█▌        | 1320/8192 [00:04<00:25, 264.36it/s]
Adding requests:  16%|█▋        | 1347/8192 [00:05<00:25, 265.97it/s]
Adding requests:  17%|█▋        | 1375/8192 [00:05<00:25, 267.14it/s]
Adding requests:  17%|█▋        | 1402/8192 [00:05<00:26, 260.70it/s]
Adding requests:  17%|█▋        | 1429/8192 [00:05<00:26, 259.25it/s]
Adding requests:  18%|█▊        | 1456/8192 [00:05<00:25, 261.74it/s]
Adding requests:  18%|█▊        | 1484/8192 [00:05<00:25, 266.72it/s]
Adding requests:  18%|█▊        | 1512/8192 [00:05<00:24, 270.04it/s]
Adding requests:  19%|█▉        | 1540/8192 [00:05<00:24, 268.18it/s]
Adding requests:  19%|█▉        | 1567/8192 [00:05<00:24, 266.09it/s]
Adding requests:  19%|█▉        | 1594/8192 [00:06<00:25, 262.15it/s]
Adding requests:  20%|█▉        | 1621/8192 [00:06<00:25, 259.01it/s]
Adding requests:  20%|██        | 1647/8192 [00:06<00:25, 258.01it/s]
Adding requests:  20%|██        | 1673/8192 [00:06<00:25, 256.14it/s]
Adding requests:  21%|██        | 1700/8192 [00:06<00:25, 257.77it/s]
Adding requests:  21%|██        | 1728/8192 [00:06<00:24, 262.95it/s]
Adding requests:  21%|██▏       | 1756/8192 [00:06<00:24, 266.67it/s]
Adding requests:  22%|██▏       | 1784/8192 [00:06<00:23, 270.16it/s]
Adding requests:  22%|██▏       | 1812/8192 [00:06<00:23, 270.55it/s]
Adding requests:  22%|██▏       | 1840/8192 [00:06<00:23, 271.92it/s]
Adding requests:  23%|██▎       | 1868/8192 [00:07<00:23, 269.34it/s]
Adding requests:  23%|██▎       | 1895/8192 [00:07<00:24, 262.07it/s]
Adding requests:  23%|██▎       | 1924/8192 [00:07<00:23, 269.33it/s]
Adding requests:  24%|██▍       | 1952/8192 [00:07<00:23, 270.04it/s]
Adding requests:  24%|██▍       | 1980/8192 [00:07<00:23, 264.62it/s]
Adding requests:  24%|██▍       | 2007/8192 [00:07<00:23, 261.48it/s]
Adding requests:  25%|██▍       | 2034/8192 [00:07<00:23, 258.29it/s]
Adding requests:  25%|██▌       | 2060/8192 [00:07<00:23, 257.20it/s]
Adding requests:  25%|██▌       | 2086/8192 [00:07<00:24, 251.47it/s]
Adding requests:  26%|██▌       | 2114/8192 [00:08<00:23, 258.54it/s]
Adding requests:  26%|██▌       | 2141/8192 [00:08<00:23, 258.61it/s]
Adding requests:  26%|██▋       | 2167/8192 [00:08<00:23, 254.55it/s]
Adding requests:  27%|██▋       | 2193/8192 [00:08<00:23, 250.47it/s]
Adding requests:  27%|██▋       | 2219/8192 [00:08<00:23, 250.66it/s]
Adding requests:  27%|██▋       | 2245/8192 [00:08<00:23, 252.50it/s]
Adding requests:  28%|██▊       | 2271/8192 [00:08<00:25, 231.84it/s]
Adding requests:  28%|██▊       | 2297/8192 [00:08<00:24, 237.12it/s]
Adding requests:  28%|██▊       | 2325/8192 [00:08<00:23, 247.67it/s]
Adding requests:  29%|██▊       | 2354/8192 [00:08<00:22, 259.01it/s]
Adding requests:  29%|██▉       | 2383/8192 [00:09<00:21, 267.64it/s]
Adding requests:  29%|██▉       | 2411/8192 [00:09<00:21, 268.95it/s]
Adding requests:  30%|██▉       | 2439/8192 [00:09<00:21, 267.79it/s]
Adding requests:  30%|███       | 2466/8192 [00:09<00:21, 267.32it/s]
Adding requests:  30%|███       | 2495/8192 [00:09<00:21, 271.22it/s]
Adding requests:  31%|███       | 2523/8192 [00:09<00:20, 271.21it/s]
Adding requests:  31%|███       | 2551/8192 [00:09<00:20, 271.95it/s]
Adding requests:  32%|███▏      | 2581/8192 [00:09<00:20, 278.17it/s]
Adding requests:  32%|███▏      | 2609/8192 [00:09<00:20, 275.76it/s]
Adding requests:  32%|███▏      | 2637/8192 [00:10<00:20, 267.51it/s]
Adding requests:  33%|███▎      | 2664/8192 [00:10<00:20, 264.31it/s]
Adding requests:  33%|███▎      | 2692/8192 [00:10<00:20, 266.33it/s]
Adding requests:  33%|███▎      | 2719/8192 [00:10<00:20, 265.95it/s]
Adding requests:  34%|███▎      | 2747/8192 [00:10<00:20, 268.94it/s]
Adding requests:  34%|███▍      | 2775/8192 [00:10<00:20, 270.46it/s]
Adding requests:  34%|███▍      | 2805/8192 [00:10<00:19, 278.40it/s]
Adding requests:  35%|███▍      | 2833/8192 [00:10<00:19, 273.75it/s]
Adding requests:  35%|███▍      | 2862/8192 [00:10<00:19, 275.52it/s]
Adding requests:  35%|███▌      | 2890/8192 [00:10<00:19, 274.09it/s]
Adding requests:  36%|███▌      | 2918/8192 [00:11<00:19, 272.60it/s]
Adding requests:  36%|███▌      | 2946/8192 [00:11<00:19, 272.73it/s]
Adding requests:  36%|███▋      | 2974/8192 [00:11<00:19, 270.21it/s]
Adding requests:  37%|███▋      | 3003/8192 [00:11<00:18, 273.91it/s]
Adding requests:  37%|███▋      | 3032/8192 [00:11<00:18, 277.42it/s]
Adding requests:  37%|███▋      | 3060/8192 [00:11<00:18, 273.90it/s]
Adding requests:  38%|███▊      | 3088/8192 [00:11<00:18, 271.48it/s]
Adding requests:  38%|███▊      | 3116/8192 [00:11<00:18, 267.56it/s]
Adding requests:  38%|███▊      | 3144/8192 [00:11<00:18, 270.97it/s]
Adding requests:  39%|███▊      | 3172/8192 [00:11<00:18, 266.24it/s]
Adding requests:  39%|███▉      | 3200/8192 [00:12<00:18, 267.30it/s]
Adding requests:  39%|███▉      | 3227/8192 [00:12<00:18, 262.66it/s]
Adding requests:  40%|███▉      | 3255/8192 [00:12<00:18, 267.50it/s]
Adding requests:  40%|████      | 3282/8192 [00:12<00:18, 262.46it/s]
Adding requests:  40%|████      | 3309/8192 [00:12<00:18, 258.69it/s]
Adding requests:  41%|████      | 3337/8192 [00:12<00:18, 262.83it/s]
Adding requests:  41%|████      | 3365/8192 [00:12<00:18, 266.35it/s]
Adding requests:  41%|████▏     | 3393/8192 [00:12<00:17, 270.02it/s]
Adding requests:  42%|████▏     | 3421/8192 [00:12<00:17, 271.21it/s]
Adding requests:  42%|████▏     | 3450/8192 [00:13<00:17, 274.44it/s]
Adding requests:  42%|████▏     | 3478/8192 [00:13<00:17, 275.91it/s]
Adding requests:  43%|████▎     | 3506/8192 [00:13<00:17, 271.26it/s]
Adding requests:  43%|████▎     | 3536/8192 [00:13<00:16, 279.52it/s]
Adding requests:  44%|████▎     | 3566/8192 [00:13<00:16, 283.44it/s]
Adding requests:  44%|████▍     | 3595/8192 [00:13<00:16, 281.00it/s]
Adding requests:  44%|████▍     | 3624/8192 [00:13<00:16, 277.17it/s]
Adding requests:  45%|████▍     | 3652/8192 [00:13<00:16, 275.20it/s]
Adding requests:  45%|████▍     | 3680/8192 [00:13<00:16, 267.83it/s]
Adding requests:  45%|████▌     | 3707/8192 [00:13<00:16, 266.39it/s]
Adding requests:  46%|████▌     | 3734/8192 [00:14<00:16, 267.25it/s]
Adding requests:  46%|████▌     | 3761/8192 [00:14<00:16, 261.26it/s]
Adding requests:  46%|████▌     | 3788/8192 [00:14<00:17, 253.68it/s]
Adding requests:  47%|████▋     | 3814/8192 [00:14<00:17, 248.87it/s]
Adding requests:  47%|████▋     | 3842/8192 [00:14<00:17, 255.07it/s]
Adding requests:  47%|████▋     | 3868/8192 [00:14<00:16, 255.00it/s]
Adding requests:  48%|████▊     | 3894/8192 [00:14<00:17, 249.26it/s]
Adding requests:  48%|████▊     | 3919/8192 [00:14<00:19, 216.50it/s]
Adding requests:  48%|████▊     | 3942/8192 [00:14<00:20, 211.73it/s]
Adding requests:  48%|████▊     | 3969/8192 [00:15<00:18, 224.89it/s]
Adding requests:  49%|████▉     | 3996/8192 [00:15<00:17, 235.46it/s]
Adding requests:  49%|████▉     | 4023/8192 [00:15<00:17, 243.51it/s]
Adding requests:  49%|████▉     | 4050/8192 [00:15<00:16, 248.94it/s]
Adding requests:  50%|████▉     | 4077/8192 [00:15<00:16, 253.75it/s]
Adding requests:  50%|█████     | 4104/8192 [00:15<00:15, 257.76it/s]
Adding requests:  50%|█████     | 4131/8192 [00:15<00:15, 260.81it/s]
Adding requests:  51%|█████     | 4158/8192 [00:15<00:15, 262.23it/s]
Adding requests:  51%|█████     | 4186/8192 [00:15<00:15, 266.08it/s]
Adding requests:  51%|█████▏    | 4213/8192 [00:15<00:15, 262.89it/s]
Adding requests:  52%|█████▏    | 4240/8192 [00:16<00:14, 264.67it/s]
Adding requests:  52%|█████▏    | 4267/8192 [00:16<00:14, 264.69it/s]
Adding requests:  52%|█████▏    | 4295/8192 [00:16<00:14, 266.56it/s]
Adding requests:  53%|█████▎    | 4322/8192 [00:16<00:14, 267.13it/s]
Adding requests:  53%|█████▎    | 4349/8192 [00:16<00:14, 264.79it/s]
Adding requests:  53%|█████▎    | 4377/8192 [00:16<00:14, 268.36it/s]
Adding requests:  54%|█████▍    | 4404/8192 [00:16<00:14, 263.02it/s]
Adding requests:  54%|█████▍    | 4432/8192 [00:16<00:14, 266.75it/s]
Adding requests:  54%|█████▍    | 4460/8192 [00:16<00:13, 268.00it/s]
Adding requests:  55%|█████▍    | 4488/8192 [00:17<00:13, 270.92it/s]
Adding requests:  55%|█████▌    | 4516/8192 [00:17<00:13, 267.25it/s]
Adding requests:  55%|█████▌    | 4544/8192 [00:17<00:13, 270.61it/s]
Adding requests:  56%|█████▌    | 4572/8192 [00:17<00:13, 265.59it/s]
Adding requests:  56%|█████▌    | 4599/8192 [00:17<00:14, 256.38it/s]
Adding requests:  56%|█████▋    | 4625/8192 [00:17<00:13, 256.17it/s]
Adding requests:  57%|█████▋    | 4651/8192 [00:17<00:13, 254.64it/s]
Adding requests:  57%|█████▋    | 4677/8192 [00:17<00:13, 253.99it/s]
Adding requests:  57%|█████▋    | 4703/8192 [00:17<00:13, 251.27it/s]
Adding requests:  58%|█████▊    | 4729/8192 [00:18<00:14, 231.98it/s]
Adding requests:  58%|█████▊    | 4753/8192 [00:18<00:14, 232.40it/s]
Adding requests:  58%|█████▊    | 4780/8192 [00:18<00:14, 239.18it/s]
Adding requests:  59%|█████▊    | 4806/8192 [00:18<00:13, 244.49it/s]
Adding requests:  59%|█████▉    | 4832/8192 [00:18<00:13, 247.81it/s]
Adding requests:  59%|█████▉    | 4858/8192 [00:18<00:13, 251.16it/s]
Adding requests:  60%|█████▉    | 4885/8192 [00:18<00:12, 255.12it/s]
Adding requests:  60%|█████▉    | 4913/8192 [00:18<00:12, 259.45it/s]
Adding requests:  60%|██████    | 4943/8192 [00:18<00:12, 269.15it/s]
Adding requests:  61%|██████    | 4970/8192 [00:18<00:11, 269.37it/s]
Adding requests:  61%|██████    | 4997/8192 [00:19<00:11, 268.07it/s]
Adding requests:  61%|██████▏   | 5025/8192 [00:19<00:11, 270.93it/s]
Adding requests:  62%|██████▏   | 5053/8192 [00:19<00:11, 271.88it/s]
Adding requests:  62%|██████▏   | 5081/8192 [00:19<00:11, 270.76it/s]
Adding requests:  62%|██████▏   | 5109/8192 [00:19<00:11, 270.90it/s]
Adding requests:  63%|██████▎   | 5137/8192 [00:19<00:12, 246.19it/s]
Adding requests:  63%|██████▎   | 5163/8192 [00:19<00:13, 224.79it/s]
Adding requests:  63%|██████▎   | 5187/8192 [00:19<00:13, 214.75it/s]
Adding requests:  64%|██████▎   | 5214/8192 [00:19<00:13, 228.10it/s]
Adding requests:  64%|██████▍   | 5241/8192 [00:20<00:12, 238.52it/s]
Adding requests:  64%|██████▍   | 5266/8192 [00:20<00:12, 241.47it/s]
Adding requests:  65%|██████▍   | 5294/8192 [00:20<00:11, 249.60it/s]
Adding requests:  65%|██████▍   | 5320/8192 [00:20<00:11, 250.88it/s]
Adding requests:  65%|██████▌   | 5348/8192 [00:20<00:10, 258.60it/s]
Adding requests:  66%|██████▌   | 5375/8192 [00:20<00:10, 259.23it/s]
Adding requests:  66%|██████▌   | 5402/8192 [00:20<00:10, 254.79it/s]
Adding requests:  66%|██████▋   | 5428/8192 [00:20<00:10, 252.92it/s]
Adding requests:  67%|██████▋   | 5456/8192 [00:20<00:10, 259.74it/s]
Adding requests:  67%|██████▋   | 5483/8192 [00:20<00:10, 262.43it/s]
Adding requests:  67%|██████▋   | 5511/8192 [00:21<00:10, 265.87it/s]
Adding requests:  68%|██████▊   | 5538/8192 [00:21<00:10, 259.08it/s]
Adding requests:  68%|██████▊   | 5565/8192 [00:21<00:10, 259.76it/s]
Adding requests:  68%|██████▊   | 5592/8192 [00:21<00:10, 256.86it/s]
Adding requests:  69%|██████▊   | 5619/8192 [00:21<00:09, 258.59it/s]
Adding requests:  69%|██████▉   | 5648/8192 [00:21<00:09, 266.21it/s]
Adding requests:  69%|██████▉   | 5676/8192 [00:21<00:09, 268.10it/s]
Adding requests:  70%|██████▉   | 5703/8192 [00:21<00:09, 267.96it/s]
Adding requests:  70%|██████▉   | 5730/8192 [00:21<00:09, 260.67it/s]
Adding requests:  70%|███████   | 5757/8192 [00:22<00:09, 262.68it/s]
Adding requests:  71%|███████   | 5784/8192 [00:22<00:09, 260.06it/s]
Adding requests:  71%|███████   | 5811/8192 [00:22<00:09, 259.33it/s]
Adding requests:  71%|███████▏  | 5838/8192 [00:22<00:09, 261.30it/s]
Adding requests:  72%|███████▏  | 5866/8192 [00:22<00:08, 266.68it/s]
Adding requests:  72%|███████▏  | 5894/8192 [00:22<00:08, 268.84it/s]
Adding requests:  72%|███████▏  | 5921/8192 [00:22<00:08, 267.77it/s]
Adding requests:  73%|███████▎  | 5948/8192 [00:22<00:08, 262.04it/s]
Adding requests:  73%|███████▎  | 5976/8192 [00:22<00:08, 266.85it/s]
Adding requests:  73%|███████▎  | 6004/8192 [00:22<00:08, 269.46it/s]
Adding requests:  74%|███████▎  | 6032/8192 [00:23<00:07, 271.85it/s]
Adding requests:  74%|███████▍  | 6060/8192 [00:23<00:07, 268.93it/s]
Adding requests:  74%|███████▍  | 6087/8192 [00:23<00:07, 267.13it/s]
Adding requests:  75%|███████▍  | 6114/8192 [00:23<00:07, 266.93it/s]
Adding requests:  75%|███████▍  | 6142/8192 [00:23<00:07, 269.51it/s]
Adding requests:  75%|███████▌  | 6169/8192 [00:23<00:07, 269.26it/s]
Adding requests:  76%|███████▌  | 6196/8192 [00:23<00:07, 265.99it/s]
Adding requests:  76%|███████▌  | 6223/8192 [00:23<00:07, 266.21it/s]
Adding requests:  76%|███████▋  | 6250/8192 [00:23<00:07, 262.70it/s]
Adding requests:  77%|███████▋  | 6277/8192 [00:23<00:07, 258.01it/s]
Adding requests:  77%|███████▋  | 6305/8192 [00:24<00:07, 262.64it/s]
Adding requests:  77%|███████▋  | 6334/8192 [00:24<00:06, 270.12it/s]
Adding requests:  78%|███████▊  | 6362/8192 [00:24<00:06, 267.40it/s]
Adding requests:  78%|███████▊  | 6389/8192 [00:24<00:06, 262.50it/s]
Adding requests:  78%|███████▊  | 6416/8192 [00:24<00:06, 258.45it/s]
Adding requests:  79%|███████▊  | 6442/8192 [00:24<00:06, 255.71it/s]
Adding requests:  79%|███████▉  | 6469/8192 [00:24<00:06, 257.47it/s]
Adding requests:  79%|███████▉  | 6495/8192 [00:24<00:06, 256.85it/s]
Adding requests:  80%|███████▉  | 6523/8192 [00:24<00:06, 260.91it/s]
Adding requests:  80%|███████▉  | 6550/8192 [00:25<00:06, 262.49it/s]
Adding requests:  80%|████████  | 6577/8192 [00:25<00:06, 263.33it/s]
Adding requests:  81%|████████  | 6604/8192 [00:25<00:06, 261.71it/s]
Adding requests:  81%|████████  | 6632/8192 [00:25<00:05, 266.94it/s]
Adding requests:  81%|████████▏ | 6660/8192 [00:25<00:05, 268.29it/s]
Adding requests:  82%|████████▏ | 6687/8192 [00:25<00:05, 266.23it/s]
Adding requests:  82%|████████▏ | 6714/8192 [00:25<00:05, 267.28it/s]
Adding requests:  82%|████████▏ | 6741/8192 [00:25<00:05, 265.94it/s]
Adding requests:  83%|████████▎ | 6770/8192 [00:25<00:05, 272.82it/s]
Adding requests:  83%|████████▎ | 6798/8192 [00:25<00:05, 268.88it/s]
Adding requests:  83%|████████▎ | 6825/8192 [00:26<00:05, 261.36it/s]
Adding requests:  84%|████████▎ | 6852/8192 [00:26<00:05, 262.03it/s]
Adding requests:  84%|████████▍ | 6880/8192 [00:26<00:04, 267.24it/s]
Adding requests:  84%|████████▍ | 6907/8192 [00:26<00:04, 263.54it/s]
Adding requests:  85%|████████▍ | 6936/8192 [00:26<00:04, 270.56it/s]
Adding requests:  85%|████████▌ | 6964/8192 [00:26<00:04, 262.50it/s]
Adding requests:  85%|████████▌ | 6993/8192 [00:26<00:04, 268.55it/s]
Adding requests:  86%|████████▌ | 7021/8192 [00:26<00:04, 270.52it/s]
Adding requests:  86%|████████▌ | 7049/8192 [00:26<00:04, 264.62it/s]
Adding requests:  86%|████████▋ | 7076/8192 [00:26<00:04, 263.21it/s]
Adding requests:  87%|████████▋ | 7103/8192 [00:27<00:04, 257.73it/s]
Adding requests:  87%|████████▋ | 7132/8192 [00:27<00:03, 265.34it/s]
Adding requests:  87%|████████▋ | 7159/8192 [00:27<00:03, 263.66it/s]
Adding requests:  88%|████████▊ | 7187/8192 [00:27<00:03, 267.78it/s]
Adding requests:  88%|████████▊ | 7214/8192 [00:27<00:03, 265.20it/s]
Adding requests:  88%|████████▊ | 7241/8192 [00:27<00:03, 265.62it/s]
Adding requests:  89%|████████▊ | 7270/8192 [00:27<00:03, 270.56it/s]
Adding requests:  89%|████████▉ | 7298/8192 [00:27<00:03, 257.41it/s]
Adding requests:  89%|████████▉ | 7325/8192 [00:27<00:03, 260.81it/s]
Adding requests:  90%|████████▉ | 7352/8192 [00:28<00:03, 262.10it/s]
Adding requests:  90%|█████████ | 7379/8192 [00:28<00:03, 262.38it/s]
Adding requests:  90%|█████████ | 7406/8192 [00:28<00:03, 260.42it/s]
Adding requests:  91%|█████████ | 7433/8192 [00:28<00:02, 262.17it/s]
Adding requests:  91%|█████████ | 7460/8192 [00:28<00:02, 262.46it/s]
Adding requests:  91%|█████████▏| 7487/8192 [00:28<00:02, 262.23it/s]
Adding requests:  92%|█████████▏| 7516/8192 [00:28<00:02, 268.21it/s]
Adding requests:  97%|█████████▋| 7906/8192 [00:28<00:00, 1329.13it/s]
Adding requests:  98%|█████████▊| 8041/8192 [00:29<00:00, 615.25it/s] 
Adding requests:  99%|█████████▉| 8144/8192 [00:29<00:00, 457.48it/s]
Adding requests: 100%|██████████| 8192/8192 [00:29<00:00, 274.52it/s]

Processed prompts:   0%|          | 0/8192 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▌         | 485/8192 [00:00<00:01, 4574.27it/s, est. speed input: 4685169.46 toks/s, output: 4574.63 toks/s]
Processed prompts:   9%|▉         | 778/8192 [00:18<00:01, 4574.27it/s, est. speed input: 43398.17 toks/s, output: 42.38 toks/s]    
Processed prompts:  10%|▉         | 779/8192 [00:18<03:39, 33.75it/s, est. speed input: 42423.02 toks/s, output: 41.43 toks/s]  
Processed prompts:  10%|▉         | 786/8192 [00:19<03:43, 33.16it/s, est. speed input: 41814.70 toks/s, output: 40.83 toks/s]
Processed prompts:  12%|█▏        | 976/8192 [00:29<04:48, 25.04it/s, est. speed input: 33407.76 toks/s, output: 32.62 toks/s]
Processed prompts:  12%|█▏        | 982/8192 [00:30<04:52, 24.69it/s, est. speed input: 33119.13 toks/s, output: 32.34 toks/s]
Processed prompts:  13%|█▎        | 1086/8192 [00:36<05:28, 21.63it/s, est. speed input: 30374.82 toks/s, output: 29.66 toks/s]
Processed prompts:  14%|█▍        | 1150/8192 [00:41<05:59, 19.59it/s, est. speed input: 28667.74 toks/s, output: 28.00 toks/s]
Processed prompts:  15%|█▍        | 1191/8192 [00:43<06:01, 19.38it/s, est. speed input: 28158.34 toks/s, output: 27.50 toks/s]
Processed prompts:  15%|█▍        | 1219/8192 [00:45<06:11, 18.79it/s, est. speed input: 27679.40 toks/s, output: 27.03 toks/s]
Processed prompts:  15%|█▌        | 1239/8192 [00:46<06:21, 18.23it/s, est. speed input: 27322.67 toks/s, output: 26.68 toks/s]
Processed prompts:  15%|█▌        | 1253/8192 [00:47<06:27, 17.92it/s, est. speed input: 27110.11 toks/s, output: 26.47 toks/s]
Processed prompts:  15%|█▌        | 1263/8192 [00:48<06:49, 16.92it/s, est. speed input: 26820.11 toks/s, output: 26.19 toks/s]
Processed prompts:  16%|█▌        | 1271/8192 [00:48<06:46, 17.01it/s, est. speed input: 26742.11 toks/s, output: 26.12 toks/s]
Processed prompts:  16%|█▌        | 1277/8192 [00:49<06:57, 16.58it/s, est. speed input: 26624.11 toks/s, output: 26.00 toks/s]
Processed prompts:  16%|█▌        | 1283/8192 [00:49<07:08, 16.12it/s, est. speed input: 26508.26 toks/s, output: 25.89 toks/s]
Processed prompts:  16%|█▌        | 1290/8192 [00:50<07:10, 16.05it/s, est. speed input: 26415.31 toks/s, output: 25.80 toks/s]
Processed prompts:  16%|█▌        | 1297/8192 [00:50<07:11, 15.97it/s, est. speed input: 26323.38 toks/s, output: 25.71 toks/s]
Processed prompts:  16%|█▌        | 1304/8192 [00:50<07:12, 15.91it/s, est. speed input: 26233.51 toks/s, output: 25.62 toks/s]
Processed prompts:  16%|█▌        | 1311/8192 [00:51<07:14, 15.85it/s, est. speed input: 26144.80 toks/s, output: 25.53 toks/s]
Processed prompts:  16%|█▌        | 1318/8192 [00:51<07:14, 15.81it/s, est. speed input: 26058.03 toks/s, output: 25.45 toks/s]
Processed prompts:  16%|█▌        | 1325/8192 [00:52<07:15, 15.78it/s, est. speed input: 25972.60 toks/s, output: 25.36 toks/s]
Processed prompts:  16%|█▋        | 1332/8192 [00:52<07:15, 15.75it/s, est. speed input: 25888.67 toks/s, output: 25.28 toks/s]
Processed prompts:  16%|█▋        | 1339/8192 [00:53<07:15, 15.73it/s, est. speed input: 25806.08 toks/s, output: 25.20 toks/s]
Processed prompts:  16%|█▋        | 1346/8192 [00:53<07:15, 15.71it/s, est. speed input: 25724.30 toks/s, output: 25.12 toks/s]
Processed prompts:  17%|█▋        | 1353/8192 [00:54<07:16, 15.68it/s, est. speed input: 25643.66 toks/s, output: 25.04 toks/s]
Processed prompts:  17%|█▋        | 1360/8192 [00:54<07:16, 15.66it/s, est. speed input: 25564.31 toks/s, output: 24.97 toks/s]
Processed prompts:  17%|█▋        | 1367/8192 [00:54<07:15, 15.67it/s, est. speed input: 25487.03 toks/s, output: 24.89 toks/s]
Processed prompts:  17%|█▋        | 1374/8192 [00:55<07:15, 15.67it/s, est. speed input: 25411.01 toks/s, output: 24.82 toks/s]
Processed prompts:  17%|█▋        | 1381/8192 [00:55<07:14, 15.68it/s, est. speed input: 25336.49 toks/s, output: 24.74 toks/s]
Processed prompts:  17%|█▋        | 1388/8192 [00:56<07:14, 15.67it/s, est. speed input: 25262.52 toks/s, output: 24.67 toks/s]
Processed prompts:  17%|█▋        | 1395/8192 [00:56<07:13, 15.68it/s, est. speed input: 25190.40 toks/s, output: 24.60 toks/s]
Processed prompts:  17%|█▋        | 1402/8192 [00:57<07:13, 15.68it/s, est. speed input: 25118.86 toks/s, output: 24.53 toks/s]
Processed prompts:  17%|█▋        | 1409/8192 [00:57<07:12, 15.68it/s, est. speed input: 25048.60 toks/s, output: 24.46 toks/s]
Processed prompts:  17%|█▋        | 1416/8192 [00:58<07:12, 15.68it/s, est. speed input: 24979.42 toks/s, output: 24.39 toks/s]
Processed prompts:  17%|█▋        | 1423/8192 [00:58<07:11, 15.68it/s, est. speed input: 24911.57 toks/s, output: 24.33 toks/s]
Processed prompts:  17%|█▋        | 1430/8192 [00:58<07:11, 15.68it/s, est. speed input: 24844.33 toks/s, output: 24.26 toks/s]
Processed prompts:  18%|█▊        | 1437/8192 [00:59<07:10, 15.68it/s, est. speed input: 24778.36 toks/s, output: 24.20 toks/s]
Processed prompts:  18%|█▊        | 1444/8192 [00:59<07:10, 15.67it/s, est. speed input: 24712.97 toks/s, output: 24.13 toks/s]
Processed prompts:  18%|█▊        | 1451/8192 [01:00<07:09, 15.68it/s, est. speed input: 24649.01 toks/s, output: 24.07 toks/s]
Processed prompts:  18%|█▊        | 1458/8192 [01:00<07:09, 15.68it/s, est. speed input: 24585.71 toks/s, output: 24.01 toks/s]
Processed prompts:  18%|█▊        | 1486/8192 [01:01<03:36, 31.01it/s, est. speed input: 24899.00 toks/s, output: 24.32 toks/s]
Processed prompts:  18%|█▊        | 1493/8192 [01:01<04:14, 26.27it/s, est. speed input: 24834.65 toks/s, output: 24.25 toks/s]
Processed prompts:  18%|█▊        | 1500/8192 [01:02<04:50, 23.02it/s, est. speed input: 24771.11 toks/s, output: 24.19 toks/s]
Processed prompts:  18%|█▊        | 1507/8192 [01:02<05:21, 20.78it/s, est. speed input: 24708.57 toks/s, output: 24.13 toks/s]
Processed prompts:  18%|█▊        | 1514/8192 [01:02<05:47, 19.24it/s, est. speed input: 24647.19 toks/s, output: 24.07 toks/s]
Processed prompts:  19%|█▊        | 1521/8192 [01:03<06:07, 18.17it/s, est. speed input: 24586.68 toks/s, output: 24.01 toks/s]
Processed prompts:  19%|█▊        | 1528/8192 [01:03<06:22, 17.42it/s, est. speed input: 24526.95 toks/s, output: 23.95 toks/s]
Processed prompts:  19%|█▊        | 1535/8192 [01:04<06:34, 16.89it/s, est. speed input: 24468.08 toks/s, output: 23.89 toks/s]
Processed prompts:  19%|█▉        | 1542/8192 [01:04<06:42, 16.53it/s, est. speed input: 24409.92 toks/s, output: 23.84 toks/s]
Processed prompts:  19%|█▉        | 1549/8192 [01:05<06:48, 16.27it/s, est. speed input: 24352.64 toks/s, output: 23.78 toks/s]
Processed prompts:  19%|█▉        | 1556/8192 [01:05<06:52, 16.09it/s, est. speed input: 24295.99 toks/s, output: 23.73 toks/s]
Processed prompts:  19%|█▉        | 1563/8192 [01:06<06:55, 15.96it/s, est. speed input: 24240.06 toks/s, output: 23.67 toks/s]
Processed prompts:  19%|█▉        | 1570/8192 [01:06<06:57, 15.87it/s, est. speed input: 24185.01 toks/s, output: 23.62 toks/s]
Processed prompts:  19%|█▉        | 1577/8192 [01:06<06:58, 15.81it/s, est. speed input: 24130.75 toks/s, output: 23.57 toks/s]
Processed prompts:  19%|█▉        | 1584/8192 [01:07<06:58, 15.78it/s, est. speed input: 24077.47 toks/s, output: 23.51 toks/s]
Processed prompts:  19%|█▉        | 1591/8192 [01:07<06:59, 15.75it/s, est. speed input: 24024.50 toks/s, output: 23.46 toks/s]
Processed prompts:  20%|█▉        | 1598/8192 [01:08<06:59, 15.73it/s, est. speed input: 23972.40 toks/s, output: 23.41 toks/s]
Processed prompts:  20%|█▉        | 1605/8192 [01:08<06:59, 15.71it/s, est. speed input: 23920.90 toks/s, output: 23.36 toks/s]
Processed prompts:  20%|█▉        | 1612/8192 [01:09<06:59, 15.70it/s, est. speed input: 23870.19 toks/s, output: 23.31 toks/s]
Processed prompts:  20%|█▉        | 1619/8192 [01:09<06:58, 15.69it/s, est. speed input: 23819.93 toks/s, output: 23.26 toks/s]
Processed prompts:  20%|█▉        | 1626/8192 [01:10<06:58, 15.69it/s, est. speed input: 23770.50 toks/s, output: 23.21 toks/s]
Processed prompts:  20%|█▉        | 1633/8192 [01:10<06:58, 15.68it/s, est. speed input: 23721.47 toks/s, output: 23.17 toks/s]
Processed prompts:  20%|██        | 1640/8192 [01:10<06:57, 15.69it/s, est. speed input: 23673.50 toks/s, output: 23.12 toks/s]
Processed prompts:  20%|██        | 1647/8192 [01:11<06:57, 15.68it/s, est. speed input: 23625.67 toks/s, output: 23.07 toks/s]
Processed prompts:  20%|██        | 1654/8192 [01:11<06:56, 15.68it/s, est. speed input: 23578.75 toks/s, output: 23.03 toks/s]
Processed prompts:  20%|██        | 1661/8192 [01:12<06:56, 15.68it/s, est. speed input: 23532.28 toks/s, output: 22.98 toks/s]
Processed prompts:  20%|██        | 1668/8192 [01:12<06:56, 15.68it/s, est. speed input: 23486.33 toks/s, output: 22.94 toks/s]
Processed prompts:  20%|██        | 1675/8192 [01:13<06:55, 15.67it/s, est. speed input: 23440.79 toks/s, output: 22.89 toks/s]
Processed prompts:  21%|██        | 1682/8192 [01:13<06:55, 15.67it/s, est. speed input: 23395.81 toks/s, output: 22.85 toks/s]
Processed prompts:  21%|██        | 1689/8192 [01:14<06:54, 15.67it/s, est. speed input: 23351.63 toks/s, output: 22.80 toks/s]
Processed prompts:  21%|██        | 1696/8192 [01:14<06:54, 15.68it/s, est. speed input: 23307.99 toks/s, output: 22.76 toks/s]
Processed prompts:  21%|██        | 1703/8192 [01:14<06:54, 15.67it/s, est. speed input: 23264.59 toks/s, output: 22.72 toks/s]
Processed prompts:  21%|██        | 1710/8192 [01:15<06:53, 15.68it/s, est. speed input: 23222.03 toks/s, output: 22.68 toks/s]
Processed prompts:  21%|██        | 1717/8192 [01:15<06:53, 15.67it/s, est. speed input: 23179.65 toks/s, output: 22.64 toks/s]
Processed prompts:  21%|██        | 1724/8192 [01:16<06:52, 15.67it/s, est. speed input: 23137.90 toks/s, output: 22.60 toks/s]
Processed prompts:  21%|██        | 1731/8192 [01:16<06:52, 15.67it/s, est. speed input: 23096.59 toks/s, output: 22.56 toks/s]
Processed prompts:  21%|██        | 1738/8192 [01:17<06:51, 15.67it/s, est. speed input: 23055.72 toks/s, output: 22.52 toks/s]
Processed prompts:  21%|██▏       | 1745/8192 [01:17<06:51, 15.67it/s, est. speed input: 23015.53 toks/s, output: 22.48 toks/s]
Processed prompts:  21%|██▏       | 1752/8192 [01:18<06:51, 15.67it/s, est. speed input: 22975.55 toks/s, output: 22.44 toks/s]
Processed prompts:  21%|██▏       | 1759/8192 [01:18<06:50, 15.67it/s, est. speed input: 22936.27 toks/s, output: 22.40 toks/s]
Processed prompts:  22%|██▏       | 1766/8192 [01:18<06:50, 15.67it/s, est. speed input: 22897.25 toks/s, output: 22.36 toks/s]
Processed prompts:  22%|██▏       | 1773/8192 [01:19<06:49, 15.68it/s, est. speed input: 22858.87 toks/s, output: 22.32 toks/s]
Processed prompts:  22%|██▏       | 1780/8192 [01:19<06:49, 15.67it/s, est. speed input: 22820.67 toks/s, output: 22.29 toks/s]
Processed prompts:  22%|██▏       | 1787/8192 [01:20<06:48, 15.67it/s, est. speed input: 22783.05 toks/s, output: 22.25 toks/s]
Processed prompts:  22%|██▏       | 1794/8192 [01:20<06:48, 15.66it/s, est. speed input: 22745.53 toks/s, output: 22.21 toks/s]
Processed prompts:  22%|██▏       | 1801/8192 [01:21<06:48, 15.66it/s, est. speed input: 22708.57 toks/s, output: 22.18 toks/s]
Processed prompts:  22%|██▏       | 1808/8192 [01:21<06:47, 15.67it/s, est. speed input: 22672.20 toks/s, output: 22.14 toks/s]
Processed prompts:  22%|██▏       | 1815/8192 [01:22<06:47, 15.67it/s, est. speed input: 22636.14 toks/s, output: 22.11 toks/s]
Processed prompts:  22%|██▏       | 1822/8192 [01:22<06:46, 15.67it/s, est. speed input: 22600.43 toks/s, output: 22.07 toks/s]
Processed prompts:  22%|██▏       | 1829/8192 [01:23<06:46, 15.66it/s, est. speed input: 22564.97 toks/s, output: 22.04 toks/s]
Processed prompts:  22%|██▏       | 1836/8192 [01:23<06:45, 15.66it/s, est. speed input: 22530.01 toks/s, output: 22.00 toks/s]
Processed prompts:  22%|██▏       | 1843/8192 [01:23<06:45, 15.66it/s, est. speed input: 22495.41 toks/s, output: 21.97 toks/s]
Processed prompts:  23%|██▎       | 1850/8192 [01:24<06:44, 15.66it/s, est. speed input: 22461.26 toks/s, output: 21.93 toks/s]
Processed prompts:  23%|██▎       | 1857/8192 [01:24<06:44, 15.67it/s, est. speed input: 22427.60 toks/s, output: 21.90 toks/s]
Processed prompts:  23%|██▎       | 1864/8192 [01:25<06:43, 15.67it/s, est. speed input: 22394.07 toks/s, output: 21.87 toks/s]
Processed prompts:  23%|██▎       | 1871/8192 [01:25<06:43, 15.67it/s, est. speed input: 22361.04 toks/s, output: 21.84 toks/s]
Processed prompts:  23%|██▎       | 1878/8192 [01:26<06:42, 15.67it/s, est. speed input: 22328.26 toks/s, output: 21.80 toks/s]
Processed prompts:  23%|██▎       | 1885/8192 [01:26<06:42, 15.67it/s, est. speed input: 22295.94 toks/s, output: 21.77 toks/s]
Processed prompts:  23%|██▎       | 1892/8192 [01:27<06:42, 15.67it/s, est. speed input: 22263.81 toks/s, output: 21.74 toks/s]
Processed prompts:  23%|██▎       | 1899/8192 [01:27<06:41, 15.68it/s, est. speed input: 22232.28 toks/s, output: 21.71 toks/s]
Processed prompts:  23%|██▎       | 1906/8192 [01:27<06:41, 15.67it/s, est. speed input: 22200.73 toks/s, output: 21.68 toks/s]
Processed prompts:  23%|██▎       | 1913/8192 [01:28<06:40, 15.68it/s, est. speed input: 22169.70 toks/s, output: 21.65 toks/s]
Processed prompts:  23%|██▎       | 1920/8192 [01:28<06:40, 15.67it/s, est. speed input: 22138.72 toks/s, output: 21.62 toks/s]
Processed prompts:  24%|██▎       | 1927/8192 [01:29<06:39, 15.67it/s, est. speed input: 22108.31 toks/s, output: 21.59 toks/s]
Processed prompts:  24%|██▎       | 1934/8192 [01:29<06:39, 15.67it/s, est. speed input: 22078.13 toks/s, output: 21.56 toks/s]
Processed prompts:  24%|██▎       | 1941/8192 [01:30<06:38, 15.67it/s, est. speed input: 22048.26 toks/s, output: 21.53 toks/s]
Processed prompts:  24%|██▍       | 1948/8192 [01:30<06:38, 15.67it/s, est. speed input: 22018.55 toks/s, output: 21.50 toks/s]
Processed prompts:  24%|██▍       | 1955/8192 [01:31<06:38, 15.66it/s, est. speed input: 21989.17 toks/s, output: 21.47 toks/s]
Processed prompts:  24%|██▍       | 1962/8192 [01:31<06:37, 15.67it/s, est. speed input: 21960.34 toks/s, output: 21.45 toks/s]
Processed prompts:  24%|██▍       | 1969/8192 [01:31<06:37, 15.67it/s, est. speed input: 21931.49 toks/s, output: 21.42 toks/s]
Processed prompts:  24%|██▍       | 1997/8192 [01:32<03:20, 30.83it/s, est. speed input: 22148.06 toks/s, output: 21.63 toks/s]
Processed prompts:  24%|██▍       | 2004/8192 [01:32<03:56, 26.19it/s, est. speed input: 22118.95 toks/s, output: 21.60 toks/s]
Processed prompts:  25%|██▍       | 2011/8192 [01:33<04:29, 22.98it/s, est. speed input: 22089.83 toks/s, output: 21.57 toks/s]
Processed prompts:  25%|██▍       | 2018/8192 [01:33<04:57, 20.75it/s, est. speed input: 22060.87 toks/s, output: 21.54 toks/s]
Processed prompts:  25%|██▍       | 2025/8192 [01:34<05:21, 19.21it/s, est. speed input: 22032.25 toks/s, output: 21.52 toks/s]
Processed prompts:  25%|██▍       | 2032/8192 [01:34<05:39, 18.14it/s, est. speed input: 22004.02 toks/s, output: 21.49 toks/s]
Processed prompts:  25%|██▍       | 2039/8192 [01:35<05:53, 17.40it/s, est. speed input: 21976.08 toks/s, output: 21.46 toks/s]
Processed prompts:  25%|██▍       | 2046/8192 [01:35<06:04, 16.88it/s, est. speed input: 21948.27 toks/s, output: 21.43 toks/s]
Processed prompts:  25%|██▌       | 2053/8192 [01:35<06:11, 16.52it/s, est. speed input: 21920.84 toks/s, output: 21.41 toks/s]
Processed prompts:  25%|██▌       | 2060/8192 [01:36<06:17, 16.26it/s, est. speed input: 21893.56 toks/s, output: 21.38 toks/s]
Processed prompts:  25%|██▌       | 2067/8192 [01:36<06:20, 16.09it/s, est. speed input: 21866.76 toks/s, output: 21.35 toks/s]
Processed prompts:  25%|██▌       | 2074/8192 [01:37<06:23, 15.97it/s, est. speed input: 21840.01 toks/s, output: 21.33 toks/s]
Processed prompts:  25%|██▌       | 2081/8192 [01:37<06:24, 15.88it/s, est. speed input: 21813.52 toks/s, output: 21.30 toks/s]
Processed prompts:  25%|██▌       | 2088/8192 [01:38<06:26, 15.81it/s, est. speed input: 21787.20 toks/s, output: 21.28 toks/s]
Processed prompts:  26%|██▌       | 2095/8192 [01:38<06:26, 15.77it/s, est. speed input: 21761.28 toks/s, output: 21.25 toks/s]
Processed prompts:  26%|██▌       | 2102/8192 [01:39<06:26, 15.74it/s, est. speed input: 21735.52 toks/s, output: 21.23 toks/s]
Processed prompts:  26%|██▌       | 2109/8192 [01:39<06:26, 15.73it/s, est. speed input: 21710.09 toks/s, output: 21.20 toks/s]
Processed prompts:  26%|██▌       | 2116/8192 [01:39<06:26, 15.71it/s, est. speed input: 21684.70 toks/s, output: 21.18 toks/s]
Processed prompts:  26%|██▌       | 2123/8192 [01:40<06:26, 15.70it/s, est. speed input: 21659.71 toks/s, output: 21.15 toks/s]
Processed prompts:  26%|██▌       | 2130/8192 [01:40<06:26, 15.69it/s, est. speed input: 21634.81 toks/s, output: 21.13 toks/s]
Processed prompts:  26%|██▌       | 2137/8192 [01:41<06:25, 15.69it/s, est. speed input: 21610.22 toks/s, output: 21.10 toks/s]
Processed prompts:  26%|██▌       | 2144/8192 [01:41<06:25, 15.68it/s, est. speed input: 21585.76 toks/s, output: 21.08 toks/s]
Processed prompts:  26%|██▋       | 2151/8192 [01:42<06:25, 15.68it/s, est. speed input: 21561.60 toks/s, output: 21.06 toks/s]
Processed prompts:  26%|██▋       | 2158/8192 [01:42<06:24, 15.68it/s, est. speed input: 21537.59 toks/s, output: 21.03 toks/s]
Processed prompts:  26%|██▋       | 2165/8192 [01:43<06:24, 15.68it/s, est. speed input: 21513.85 toks/s, output: 21.01 toks/s]
Processed prompts:  27%|██▋       | 2172/8192 [01:43<06:24, 15.67it/s, est. speed input: 21490.15 toks/s, output: 20.99 toks/s]
Processed prompts:  27%|██▋       | 2179/8192 [01:43<06:23, 15.67it/s, est. speed input: 21466.78 toks/s, output: 20.96 toks/s]
Processed prompts:  27%|██▋       | 2186/8192 [01:44<06:23, 15.68it/s, est. speed input: 21443.68 toks/s, output: 20.94 toks/s]
Processed prompts:  27%|██▋       | 2193/8192 [01:44<06:22, 15.67it/s, est. speed input: 21420.54 toks/s, output: 20.92 toks/s]
Processed prompts:  27%|██▋       | 2200/8192 [01:45<06:22, 15.66it/s, est. speed input: 21397.67 toks/s, output: 20.90 toks/s]
Processed prompts:  27%|██▋       | 2207/8192 [01:45<06:22, 15.66it/s, est. speed input: 21374.99 toks/s, output: 20.87 toks/s]
Processed prompts:  27%|██▋       | 2214/8192 [01:46<06:21, 15.66it/s, est. speed input: 21352.53 toks/s, output: 20.85 toks/s]
Processed prompts:  27%|██▋       | 2221/8192 [01:46<06:21, 15.66it/s, est. speed input: 21330.20 toks/s, output: 20.83 toks/s]
Processed prompts:  27%|██▋       | 2228/8192 [01:47<06:20, 15.66it/s, est. speed input: 21308.02 toks/s, output: 20.81 toks/s]
Processed prompts:  27%|██▋       | 2235/8192 [01:47<06:20, 15.66it/s, est. speed input: 21286.15 toks/s, output: 20.79 toks/s]
Processed prompts:  27%|██▋       | 2242/8192 [01:47<06:19, 15.66it/s, est. speed input: 21264.38 toks/s, output: 20.77 toks/s]
Processed prompts:  27%|██▋       | 2249/8192 [01:48<06:19, 15.66it/s, est. speed input: 21242.81 toks/s, output: 20.74 toks/s]
Processed prompts:  28%|██▊       | 2256/8192 [01:48<06:18, 15.67it/s, est. speed input: 21221.59 toks/s, output: 20.72 toks/s]
Processed prompts:  28%|██▊       | 2263/8192 [01:49<06:18, 15.66it/s, est. speed input: 21200.33 toks/s, output: 20.70 toks/s]
Processed prompts:  28%|██▊       | 2270/8192 [01:49<06:17, 15.67it/s, est. speed input: 21179.51 toks/s, output: 20.68 toks/s]
Processed prompts:  28%|██▊       | 2277/8192 [01:50<06:17, 15.68it/s, est. speed input: 21158.77 toks/s, output: 20.66 toks/s]
Processed prompts:  28%|██▊       | 2284/8192 [01:50<06:16, 15.68it/s, est. speed input: 21138.22 toks/s, output: 20.64 toks/s]
Processed prompts:  28%|██▊       | 2291/8192 [01:51<06:16, 15.68it/s, est. speed input: 21117.73 toks/s, output: 20.62 toks/s]
Processed prompts:  28%|██▊       | 2298/8192 [01:51<06:15, 15.68it/s, est. speed input: 21097.50 toks/s, output: 20.60 toks/s]
Processed prompts:  28%|██▊       | 2305/8192 [01:51<06:15, 15.67it/s, est. speed input: 21077.30 toks/s, output: 20.58 toks/s]
Processed prompts:  28%|██▊       | 2312/8192 [01:52<06:14, 15.68it/s, est. speed input: 21057.46 toks/s, output: 20.56 toks/s]
Processed prompts:  28%|██▊       | 2319/8192 [01:52<06:14, 15.67it/s, est. speed input: 21037.58 toks/s, output: 20.54 toks/s]
Processed prompts:  28%|██▊       | 2326/8192 [01:53<06:14, 15.67it/s, est. speed input: 21017.89 toks/s, output: 20.53 toks/s]
Processed prompts:  28%|██▊       | 2333/8192 [01:53<06:13, 15.67it/s, est. speed input: 20998.28 toks/s, output: 20.51 toks/s]
Processed prompts:  29%|██▊       | 2340/8192 [01:54<06:13, 15.67it/s, est. speed input: 20978.88 toks/s, output: 20.49 toks/s]
Processed prompts:  29%|██▊       | 2347/8192 [01:54<06:13, 15.66it/s, est. speed input: 20959.54 toks/s, output: 20.47 toks/s]
Processed prompts:  29%|██▊       | 2354/8192 [01:55<06:12, 15.66it/s, est. speed input: 20940.35 toks/s, output: 20.45 toks/s]
Processed prompts:  29%|██▉       | 2361/8192 [01:55<06:12, 15.66it/s, est. speed input: 20921.34 toks/s, output: 20.43 toks/s]
Processed prompts:  29%|██▉       | 2368/8192 [01:56<06:12, 15.65it/s, est. speed input: 20902.45 toks/s, output: 20.41 toks/s]
Processed prompts:  29%|██▉       | 2375/8192 [01:56<06:11, 15.65it/s, est. speed input: 20883.74 toks/s, output: 20.39 toks/s]
Processed prompts:  29%|██▉       | 2382/8192 [01:56<06:11, 15.65it/s, est. speed input: 20865.16 toks/s, output: 20.38 toks/s]
Processed prompts:  29%|██▉       | 2389/8192 [01:57<06:10, 15.66it/s, est. speed input: 20846.83 toks/s, output: 20.36 toks/s]
Processed prompts:  29%|██▉       | 2396/8192 [01:57<06:10, 15.66it/s, est. speed input: 20828.61 toks/s, output: 20.34 toks/s]
Processed prompts:  29%|██▉       | 2403/8192 [01:58<06:09, 15.67it/s, est. speed input: 20810.63 toks/s, output: 20.32 toks/s]
Processed prompts:  29%|██▉       | 2410/8192 [01:58<06:09, 15.67it/s, est. speed input: 20792.67 toks/s, output: 20.31 toks/s]
Processed prompts:  30%|██▉       | 2417/8192 [01:59<06:08, 15.68it/s, est. speed input: 20775.02 toks/s, output: 20.29 toks/s]
Processed prompts:  30%|██▉       | 2424/8192 [01:59<06:08, 15.67it/s, est. speed input: 20757.30 toks/s, output: 20.27 toks/s]
Processed prompts:  30%|██▉       | 2431/8192 [02:00<06:07, 15.67it/s, est. speed input: 20739.78 toks/s, output: 20.25 toks/s]
Processed prompts:  30%|██▉       | 2438/8192 [02:00<06:07, 15.67it/s, est. speed input: 20722.33 toks/s, output: 20.24 toks/s]
Processed prompts:  30%|██▉       | 2445/8192 [02:00<06:06, 15.67it/s, est. speed input: 20705.12 toks/s, output: 20.22 toks/s]
Processed prompts:  30%|██▉       | 2452/8192 [02:01<06:06, 15.68it/s, est. speed input: 20688.06 toks/s, output: 20.20 toks/s]
Processed prompts:  30%|███       | 2459/8192 [02:01<06:05, 15.68it/s, est. speed input: 20671.05 toks/s, output: 20.19 toks/s]
Processed prompts:  30%|███       | 2466/8192 [02:02<06:05, 15.68it/s, est. speed input: 20654.25 toks/s, output: 20.17 toks/s]
Processed prompts:  30%|███       | 2473/8192 [02:02<06:04, 15.68it/s, est. speed input: 20637.52 toks/s, output: 20.15 toks/s]
Processed prompts:  30%|███       | 2480/8192 [02:03<06:04, 15.67it/s, est. speed input: 20620.80 toks/s, output: 20.14 toks/s]
Processed prompts:  31%|███       | 2508/8192 [02:03<03:04, 30.76it/s, est. speed input: 20786.25 toks/s, output: 20.30 toks/s]
Processed prompts:  31%|███       | 2515/8192 [02:03<03:37, 26.12it/s, est. speed input: 20769.06 toks/s, output: 20.28 toks/s]
Processed prompts:  31%|███       | 2522/8192 [02:04<04:07, 22.94it/s, est. speed input: 20752.16 toks/s, output: 20.27 toks/s]
Processed prompts:  31%|███       | 2529/8192 [02:04<04:33, 20.74it/s, est. speed input: 20735.37 toks/s, output: 20.25 toks/s]
Processed prompts:  31%|███       | 2536/8192 [02:05<04:54, 19.20it/s, est. speed input: 20718.54 toks/s, output: 20.23 toks/s]
Processed prompts:  31%|███       | 2543/8192 [02:05<05:11, 18.12it/s, est. speed input: 20701.75 toks/s, output: 20.22 toks/s]
Processed prompts:  31%|███       | 2550/8192 [02:06<05:24, 17.37it/s, est. speed input: 20685.07 toks/s, output: 20.20 toks/s]
Processed prompts:  31%|███       | 2557/8192 [02:06<05:34, 16.85it/s, est. speed input: 20668.57 toks/s, output: 20.18 toks/s]
Processed prompts:  31%|███▏      | 2564/8192 [02:07<05:41, 16.48it/s, est. speed input: 20652.10 toks/s, output: 20.17 toks/s]
Processed prompts:  31%|███▏      | 2571/8192 [02:07<05:46, 16.23it/s, est. speed input: 20635.82 toks/s, output: 20.15 toks/s]
Processed prompts:  31%|███▏      | 2578/8192 [02:08<05:49, 16.05it/s, est. speed input: 20619.59 toks/s, output: 20.14 toks/s]
Processed prompts:  32%|███▏      | 2585/8192 [02:08<05:52, 15.92it/s, est. speed input: 20603.53 toks/s, output: 20.12 toks/s]
Processed prompts:  32%|███▏      | 2592/8192 [02:08<05:53, 15.83it/s, est. speed input: 20587.55 toks/s, output: 20.11 toks/s]
Processed prompts:  32%|███▏      | 2599/8192 [02:09<05:54, 15.77it/s, est. speed input: 20571.69 toks/s, output: 20.09 toks/s]
Processed prompts:  32%|███▏      | 2606/8192 [02:09<05:55, 15.73it/s, est. speed input: 20555.92 toks/s, output: 20.07 toks/s]
Processed prompts:  32%|███▏      | 2613/8192 [02:10<05:55, 15.70it/s, est. speed input: 20540.36 toks/s, output: 20.06 toks/s]
Processed prompts:  32%|███▏      | 2620/8192 [02:10<05:55, 15.67it/s, est. speed input: 20524.70 toks/s, output: 20.04 toks/s]
Processed prompts:  32%|███▏      | 2627/8192 [02:11<05:55, 15.66it/s, est. speed input: 20509.22 toks/s, output: 20.03 toks/s]
Processed prompts:  32%|███▏      | 2634/8192 [02:11<05:55, 15.65it/s, est. speed input: 20493.87 toks/s, output: 20.01 toks/s]
Processed prompts:  32%|███▏      | 2641/8192 [02:12<05:54, 15.64it/s, est. speed input: 20478.68 toks/s, output: 20.00 toks/s]
Processed prompts:  32%|███▏      | 2648/8192 [02:12<05:54, 15.66it/s, est. speed input: 20463.78 toks/s, output: 19.98 toks/s]
Processed prompts:  32%|███▏      | 2655/8192 [02:12<05:53, 15.65it/s, est. speed input: 20448.83 toks/s, output: 19.97 toks/s]
Processed prompts:  32%|███▏      | 2662/8192 [02:13<05:53, 15.65it/s, est. speed input: 20434.00 toks/s, output: 19.96 toks/s]
Processed prompts:  33%|███▎      | 2669/8192 [02:13<05:52, 15.65it/s, est. speed input: 20419.21 toks/s, output: 19.94 toks/s]
Processed prompts:  33%|███▎      | 2676/8192 [02:14<05:52, 15.65it/s, est. speed input: 20404.61 toks/s, output: 19.93 toks/s]
Processed prompts:  33%|███▎      | 2683/8192 [02:14<05:51, 15.66it/s, est. speed input: 20390.20 toks/s, output: 19.91 toks/s]
Processed prompts:  33%|███▎      | 2690/8192 [02:15<05:51, 15.66it/s, est. speed input: 20375.74 toks/s, output: 19.90 toks/s]
Processed prompts:  33%|███▎      | 2697/8192 [02:15<05:50, 15.66it/s, est. speed input: 20361.44 toks/s, output: 19.88 toks/s]
Processed prompts:  33%|███▎      | 2704/8192 [02:16<05:50, 15.65it/s, est. speed input: 20347.16 toks/s, output: 19.87 toks/s]
Processed prompts:  33%|███▎      | 2711/8192 [02:16<05:50, 15.65it/s, est. speed input: 20333.00 toks/s, output: 19.86 toks/s]
Processed prompts:  33%|███▎      | 2718/8192 [02:16<05:49, 15.66it/s, est. speed input: 20319.05 toks/s, output: 19.84 toks/s]
Processed prompts:  33%|███▎      | 2725/8192 [02:17<05:49, 15.66it/s, est. speed input: 20305.10 toks/s, output: 19.83 toks/s]
Processed prompts:  33%|███▎      | 2732/8192 [02:17<05:48, 15.66it/s, est. speed input: 20291.30 toks/s, output: 19.82 toks/s]
Processed prompts:  33%|███▎      | 2739/8192 [02:18<05:48, 15.66it/s, est. speed input: 20277.54 toks/s, output: 19.80 toks/s]
Processed prompts:  34%|███▎      | 2746/8192 [02:18<05:47, 15.66it/s, est. speed input: 20263.87 toks/s, output: 19.79 toks/s]
Processed prompts:  34%|███▎      | 2753/8192 [02:19<05:47, 15.66it/s, est. speed input: 20250.32 toks/s, output: 19.78 toks/s]
Processed prompts:  34%|███▎      | 2760/8192 [02:19<05:46, 15.66it/s, est. speed input: 20236.84 toks/s, output: 19.76 toks/s]
Processed prompts:  34%|███▍      | 2767/8192 [02:20<05:46, 15.67it/s, est. speed input: 20223.54 toks/s, output: 19.75 toks/s]
Processed prompts:  34%|███▍      | 2774/8192 [02:20<05:45, 15.66it/s, est. speed input: 20210.16 toks/s, output: 19.74 toks/s]
Processed prompts:  34%|███▍      | 2781/8192 [02:20<05:45, 15.67it/s, est. speed input: 20197.06 toks/s, output: 19.72 toks/s]
Processed prompts:  34%|███▍      | 2788/8192 [02:21<05:45, 15.66it/s, est. speed input: 20183.83 toks/s, output: 19.71 toks/s]
Processed prompts:  34%|███▍      | 2795/8192 [02:21<05:44, 15.66it/s, est. speed input: 20170.74 toks/s, output: 19.70 toks/s]
Processed prompts:  34%|███▍      | 2802/8192 [02:22<05:44, 15.65it/s, est. speed input: 20157.65 toks/s, output: 19.69 toks/s]
Processed prompts:  34%|███▍      | 2809/8192 [02:22<05:43, 15.65it/s, est. speed input: 20144.68 toks/s, output: 19.67 toks/s]
Processed prompts:  34%|███▍      | 2816/8192 [02:23<05:43, 15.65it/s, est. speed input: 20131.85 toks/s, output: 19.66 toks/s]
Processed prompts:  34%|███▍      | 2823/8192 [02:23<05:42, 15.66it/s, est. speed input: 20119.16 toks/s, output: 19.65 toks/s]
Processed prompts:  35%|███▍      | 2830/8192 [02:24<05:42, 15.66it/s, est. speed input: 20106.48 toks/s, output: 19.64 toks/s]
Processed prompts:  35%|███▍      | 2837/8192 [02:24<05:41, 15.66it/s, est. speed input: 20093.98 toks/s, output: 19.62 toks/s]
Processed prompts:  35%|███▍      | 2844/8192 [02:25<05:41, 15.66it/s, est. speed input: 20081.46 toks/s, output: 19.61 toks/s]
Processed prompts:  35%|███▍      | 2851/8192 [02:25<05:40, 15.67it/s, est. speed input: 20069.11 toks/s, output: 19.60 toks/s]
Processed prompts:  35%|███▍      | 2858/8192 [02:25<05:40, 15.67it/s, est. speed input: 20056.75 toks/s, output: 19.59 toks/s]
Processed prompts:  35%|███▍      | 2865/8192 [02:26<05:40, 15.67it/s, est. speed input: 20044.50 toks/s, output: 19.57 toks/s]
Processed prompts:  35%|███▌      | 2872/8192 [02:26<05:39, 15.66it/s, est. speed input: 20032.20 toks/s, output: 19.56 toks/s]
Processed prompts:  35%|███▌      | 2879/8192 [02:27<05:39, 15.66it/s, est. speed input: 20020.04 toks/s, output: 19.55 toks/s]
Processed prompts:  35%|███▌      | 2886/8192 [02:27<05:38, 15.66it/s, est. speed input: 20008.04 toks/s, output: 19.54 toks/s]
Processed prompts:  35%|███▌      | 2893/8192 [02:28<05:38, 15.66it/s, est. speed input: 19996.09 toks/s, output: 19.53 toks/s]
Processed prompts:  35%|███▌      | 2900/8192 [02:28<05:37, 15.67it/s, est. speed input: 19984.31 toks/s, output: 19.52 toks/s]
Processed prompts:  35%|███▌      | 2907/8192 [02:29<05:37, 15.67it/s, est. speed input: 19972.47 toks/s, output: 19.50 toks/s]
Processed prompts:  36%|███▌      | 2914/8192 [02:29<05:36, 15.67it/s, est. speed input: 19960.77 toks/s, output: 19.49 toks/s]
Processed prompts:  36%|███▌      | 2921/8192 [02:29<05:36, 15.67it/s, est. speed input: 19949.07 toks/s, output: 19.48 toks/s]
Processed prompts:  36%|███▌      | 2928/8192 [02:30<05:35, 15.67it/s, est. speed input: 19937.54 toks/s, output: 19.47 toks/s]
Processed prompts:  36%|███▌      | 2935/8192 [02:30<05:35, 15.67it/s, est. speed input: 19926.00 toks/s, output: 19.46 toks/s]
Processed prompts:  36%|███▌      | 2942/8192 [02:31<05:34, 15.67it/s, est. speed input: 19914.58 toks/s, output: 19.45 toks/s]
Processed prompts:  36%|███▌      | 2949/8192 [02:31<05:34, 15.67it/s, est. speed input: 19903.13 toks/s, output: 19.44 toks/s]
Processed prompts:  36%|███▌      | 2956/8192 [02:32<05:34, 15.68it/s, est. speed input: 19891.89 toks/s, output: 19.43 toks/s]
Processed prompts:  36%|███▌      | 2963/8192 [02:32<05:33, 15.67it/s, est. speed input: 19880.57 toks/s, output: 19.41 toks/s]
Processed prompts:  36%|███▋      | 2970/8192 [02:33<05:33, 15.67it/s, est. speed input: 19869.44 toks/s, output: 19.40 toks/s]
Processed prompts:  36%|███▋      | 2977/8192 [02:33<05:32, 15.67it/s, est. speed input: 19858.25 toks/s, output: 19.39 toks/s]
Processed prompts:  36%|███▋      | 2984/8192 [02:33<05:32, 15.67it/s, est. speed input: 19847.21 toks/s, output: 19.38 toks/s]
Processed prompts:  37%|███▋      | 3012/8192 [02:34<02:47, 30.89it/s, est. speed input: 19982.43 toks/s, output: 19.51 toks/s]
Processed prompts:  37%|███▋      | 3019/8192 [02:34<03:17, 26.22it/s, est. speed input: 19971.19 toks/s, output: 19.50 toks/s]
Processed prompts:  37%|███▋      | 3026/8192 [02:35<03:44, 23.00it/s, est. speed input: 19959.90 toks/s, output: 19.49 toks/s]
Processed prompts:  37%|███▋      | 3033/8192 [02:35<04:08, 20.78it/s, est. speed input: 19948.79 toks/s, output: 19.48 toks/s]
Processed prompts:  37%|███▋      | 3040/8192 [02:36<04:27, 19.24it/s, est. speed input: 19937.63 toks/s, output: 19.47 toks/s]
Processed prompts:  37%|███▋      | 3047/8192 [02:36<04:43, 18.18it/s, est. speed input: 19926.71 toks/s, output: 19.46 toks/s]
Processed prompts:  37%|███▋      | 3054/8192 [02:37<04:54, 17.42it/s, est. speed input: 19915.71 toks/s, output: 19.45 toks/s]
Processed prompts:  37%|███▋      | 3061/8192 [02:37<05:03, 16.91it/s, est. speed input: 19904.87 toks/s, output: 19.44 toks/s]
Processed prompts:  37%|███▋      | 3068/8192 [02:37<05:09, 16.54it/s, est. speed input: 19893.99 toks/s, output: 19.43 toks/s]
Processed prompts:  38%|███▊      | 3075/8192 [02:38<05:14, 16.29it/s, est. speed input: 19883.29 toks/s, output: 19.42 toks/s]
Processed prompts:  38%|███▊      | 3082/8192 [02:38<05:17, 16.11it/s, est. speed input: 19872.51 toks/s, output: 19.41 toks/s]
Processed prompts:  38%|███▊      | 3089/8192 [02:39<05:19, 15.99it/s, est. speed input: 19861.91 toks/s, output: 19.40 toks/s]
Processed prompts:  38%|███▊      | 3096/8192 [02:39<05:20, 15.89it/s, est. speed input: 19851.27 toks/s, output: 19.39 toks/s]
Processed prompts:  38%|███▊      | 3103/8192 [02:40<05:21, 15.84it/s, est. speed input: 19840.79 toks/s, output: 19.38 toks/s]
Processed prompts:  38%|███▊      | 3110/8192 [02:40<05:21, 15.79it/s, est. speed input: 19830.26 toks/s, output: 19.37 toks/s]
Processed prompts:  38%|███▊      | 3117/8192 [02:41<05:22, 15.76it/s, est. speed input: 19819.84 toks/s, output: 19.36 toks/s]
Processed prompts:  38%|███▊      | 3124/8192 [02:41<05:22, 15.74it/s, est. speed input: 19809.42 toks/s, output: 19.35 toks/s]
Processed prompts:  38%|███▊      | 3131/8192 [02:41<05:21, 15.72it/s, est. speed input: 19799.14 toks/s, output: 19.34 toks/s]
Processed prompts:  38%|███▊      | 3138/8192 [02:42<05:21, 15.71it/s, est. speed input: 19788.79 toks/s, output: 19.32 toks/s]
Processed prompts:  38%|███▊      | 3145/8192 [02:42<05:21, 15.70it/s, est. speed input: 19778.53 toks/s, output: 19.31 toks/s]
Processed prompts:  38%|███▊      | 3152/8192 [02:43<05:21, 15.68it/s, est. speed input: 19768.21 toks/s, output: 19.30 toks/s]
Processed prompts:  39%|███▊      | 3159/8192 [02:43<05:21, 15.68it/s, est. speed input: 19758.05 toks/s, output: 19.29 toks/s]
Processed prompts:  39%|███▊      | 3166/8192 [02:44<05:20, 15.67it/s, est. speed input: 19747.89 toks/s, output: 19.29 toks/s]
Processed prompts:  39%|███▊      | 3173/8192 [02:44<05:20, 15.67it/s, est. speed input: 19737.82 toks/s, output: 19.28 toks/s]
Processed prompts:  39%|███▉      | 3180/8192 [02:45<05:19, 15.67it/s, est. speed input: 19727.84 toks/s, output: 19.27 toks/s]
Processed prompts:  39%|███▉      | 3187/8192 [02:45<05:19, 15.66it/s, est. speed input: 19717.85 toks/s, output: 19.26 toks/s]
Processed prompts:  39%|███▉      | 3194/8192 [02:45<05:18, 15.67it/s, est. speed input: 19708.01 toks/s, output: 19.25 toks/s]
Processed prompts:  39%|███▉      | 3201/8192 [02:46<05:18, 15.66it/s, est. speed input: 19698.11 toks/s, output: 19.24 toks/s]
Processed prompts:  39%|███▉      | 3208/8192 [02:46<05:18, 15.67it/s, est. speed input: 19688.40 toks/s, output: 19.23 toks/s]
Processed prompts:  39%|███▉      | 3215/8192 [02:47<05:17, 15.67it/s, est. speed input: 19678.64 toks/s, output: 19.22 toks/s]
Processed prompts:  39%|███▉      | 3222/8192 [02:47<05:17, 15.67it/s, est. speed input: 19668.97 toks/s, output: 19.21 toks/s]
Processed prompts:  39%|███▉      | 3229/8192 [02:48<05:16, 15.67it/s, est. speed input: 19659.30 toks/s, output: 19.20 toks/s]
Processed prompts:  40%|███▉      | 3236/8192 [02:48<05:16, 15.67it/s, est. speed input: 19649.76 toks/s, output: 19.19 toks/s]
Processed prompts:  40%|███▉      | 3243/8192 [02:49<05:15, 15.66it/s, est. speed input: 19640.18 toks/s, output: 19.18 toks/s]
Processed prompts:  40%|███▉      | 3250/8192 [02:49<05:15, 15.67it/s, est. speed input: 19630.75 toks/s, output: 19.17 toks/s]
Processed prompts:  40%|███▉      | 3257/8192 [02:49<05:15, 15.66it/s, est. speed input: 19621.23 toks/s, output: 19.16 toks/s]
Processed prompts:  40%|███▉      | 3264/8192 [02:50<05:14, 15.66it/s, est. speed input: 19611.80 toks/s, output: 19.15 toks/s]
Processed prompts:  40%|███▉      | 3271/8192 [02:50<05:14, 15.66it/s, est. speed input: 19602.41 toks/s, output: 19.14 toks/s]
Processed prompts:  40%|████      | 3278/8192 [02:51<05:13, 15.65it/s, est. speed input: 19593.05 toks/s, output: 19.13 toks/s]
Processed prompts:  40%|████      | 3285/8192 [02:51<05:13, 15.65it/s, est. speed input: 19583.76 toks/s, output: 19.12 toks/s]
Processed prompts:  40%|████      | 3292/8192 [02:52<05:13, 15.65it/s, est. speed input: 19574.53 toks/s, output: 19.12 toks/s]
Processed prompts:  40%|████      | 3299/8192 [02:52<05:12, 15.65it/s, est. speed input: 19565.29 toks/s, output: 19.11 toks/s]
Processed prompts:  40%|████      | 3306/8192 [02:53<05:12, 15.65it/s, est. speed input: 19556.16 toks/s, output: 19.10 toks/s]
Processed prompts:  40%|████      | 3313/8192 [02:53<05:11, 15.65it/s, est. speed input: 19547.05 toks/s, output: 19.09 toks/s]
Processed prompts:  41%|████      | 3320/8192 [02:54<05:11, 15.64it/s, est. speed input: 19537.93 toks/s, output: 19.08 toks/s]
Processed prompts:  41%|████      | 3327/8192 [02:54<05:11, 15.64it/s, est. speed input: 19528.90 toks/s, output: 19.07 toks/s]
Processed prompts:  41%|████      | 3334/8192 [02:54<05:10, 15.64it/s, est. speed input: 19519.88 toks/s, output: 19.06 toks/s]
Processed prompts:  41%|████      | 3341/8192 [02:55<05:10, 15.65it/s, est. speed input: 19511.02 toks/s, output: 19.05 toks/s]
Processed prompts:  41%|████      | 3348/8192 [02:55<05:09, 15.64it/s, est. speed input: 19502.07 toks/s, output: 19.04 toks/s]
Processed prompts:  41%|████      | 3355/8192 [02:56<05:09, 15.64it/s, est. speed input: 19493.26 toks/s, output: 19.04 toks/s]
Processed prompts:  41%|████      | 3362/8192 [02:56<05:08, 15.64it/s, est. speed input: 19484.45 toks/s, output: 19.03 toks/s]
Processed prompts:  41%|████      | 3369/8192 [02:57<05:08, 15.64it/s, est. speed input: 19475.69 toks/s, output: 19.02 toks/s]
Processed prompts:  41%|████      | 3376/8192 [02:57<05:08, 15.63it/s, est. speed input: 19466.80 toks/s, output: 19.01 toks/s]
Processed prompts:  41%|████▏     | 3383/8192 [02:58<05:07, 15.62it/s, est. speed input: 19458.05 toks/s, output: 19.00 toks/s]
Processed prompts:  41%|████▏     | 3390/8192 [02:58<05:07, 15.64it/s, est. speed input: 19449.51 toks/s, output: 18.99 toks/s]
Processed prompts:  41%|████▏     | 3397/8192 [02:58<05:06, 15.64it/s, est. speed input: 19440.90 toks/s, output: 18.99 toks/s]
Processed prompts:  42%|████▏     | 3404/8192 [02:59<05:06, 15.64it/s, est. speed input: 19432.42 toks/s, output: 18.98 toks/s]
Processed prompts:  42%|████▏     | 3411/8192 [02:59<05:05, 15.65it/s, est. speed input: 19423.96 toks/s, output: 18.97 toks/s]
Processed prompts:  42%|████▏     | 3418/8192 [03:00<05:04, 15.65it/s, est. speed input: 19415.58 toks/s, output: 18.96 toks/s]
Processed prompts:  42%|████▏     | 3425/8192 [03:00<05:04, 15.66it/s, est. speed input: 19407.23 toks/s, output: 18.95 toks/s]
Processed prompts:  42%|████▏     | 3432/8192 [03:01<05:03, 15.66it/s, est. speed input: 19398.94 toks/s, output: 18.94 toks/s]
Processed prompts:  42%|████▏     | 3439/8192 [03:01<05:03, 15.66it/s, est. speed input: 19390.66 toks/s, output: 18.94 toks/s]
Processed prompts:  42%|████▏     | 3446/8192 [03:02<05:03, 15.66it/s, est. speed input: 19382.39 toks/s, output: 18.93 toks/s]
Processed prompts:  42%|████▏     | 3453/8192 [03:02<05:02, 15.65it/s, est. speed input: 19374.14 toks/s, output: 18.92 toks/s]
Processed prompts:  42%|████▏     | 3460/8192 [03:02<05:02, 15.65it/s, est. speed input: 19365.95 toks/s, output: 18.91 toks/s]
Processed prompts:  42%|████▏     | 3467/8192 [03:03<05:01, 15.65it/s, est. speed input: 19357.84 toks/s, output: 18.90 toks/s]
Processed prompts:  42%|████▏     | 3474/8192 [03:03<05:01, 15.66it/s, est. speed input: 19349.78 toks/s, output: 18.90 toks/s]
Processed prompts:  42%|████▏     | 3481/8192 [03:04<05:00, 15.66it/s, est. speed input: 19341.75 toks/s, output: 18.89 toks/s]
Processed prompts:  43%|████▎     | 3488/8192 [03:04<05:00, 15.66it/s, est. speed input: 19333.79 toks/s, output: 18.88 toks/s]
Processed prompts:  43%|████▎     | 3495/8192 [03:05<05:00, 15.66it/s, est. speed input: 19325.77 toks/s, output: 18.87 toks/s]
Processed prompts:  43%|████▎     | 3523/8192 [03:05<02:30, 31.01it/s, est. speed input: 19440.03 toks/s, output: 18.98 toks/s]
Processed prompts:  43%|████▎     | 3530/8192 [03:06<02:57, 26.28it/s, est. speed input: 19431.92 toks/s, output: 18.98 toks/s]
Processed prompts:  43%|████▎     | 3537/8192 [03:06<03:21, 23.07it/s, est. speed input: 19424.03 toks/s, output: 18.97 toks/s]
Processed prompts:  43%|████▎     | 3544/8192 [03:06<03:43, 20.84it/s, est. speed input: 19416.10 toks/s, output: 18.96 toks/s]
Processed prompts:  43%|████▎     | 3551/8192 [03:07<04:00, 19.30it/s, est. speed input: 19408.28 toks/s, output: 18.95 toks/s]
Processed prompts:  43%|████▎     | 3558/8192 [03:07<04:14, 18.21it/s, est. speed input: 19400.40 toks/s, output: 18.95 toks/s]
Processed prompts:  44%|████▎     | 3565/8192 [03:08<04:24, 17.47it/s, est. speed input: 19392.67 toks/s, output: 18.94 toks/s]
Processed prompts:  44%|████▎     | 3572/8192 [03:08<04:32, 16.94it/s, est. speed input: 19384.88 toks/s, output: 18.93 toks/s]
Processed prompts:  44%|████▎     | 3579/8192 [03:09<04:38, 16.58it/s, est. speed input: 19377.23 toks/s, output: 18.92 toks/s]
Processed prompts:  44%|████▍     | 3586/8192 [03:09<04:42, 16.33it/s, est. speed input: 19369.53 toks/s, output: 18.92 toks/s]
Processed prompts:  44%|████▍     | 3593/8192 [03:10<04:44, 16.15it/s, est. speed input: 19361.92 toks/s, output: 18.91 toks/s]
Processed prompts:  44%|████▍     | 3600/8192 [03:10<04:46, 16.02it/s, est. speed input: 19354.29 toks/s, output: 18.90 toks/s]
Processed prompts:  44%|████▍     | 3607/8192 [03:10<04:47, 15.93it/s, est. speed input: 19346.73 toks/s, output: 18.89 toks/s]
Processed prompts:  44%|████▍     | 3614/8192 [03:11<04:48, 15.87it/s, est. speed input: 19339.15 toks/s, output: 18.89 toks/s]
Processed prompts:  44%|████▍     | 3621/8192 [03:11<04:48, 15.83it/s, est. speed input: 19331.65 toks/s, output: 18.88 toks/s]
Processed prompts:  44%|████▍     | 3628/8192 [03:12<04:48, 15.80it/s, est. speed input: 19324.22 toks/s, output: 18.87 toks/s]
Processed prompts:  44%|████▍     | 3635/8192 [03:12<04:48, 15.78it/s, est. speed input: 19316.75 toks/s, output: 18.86 toks/s]
Processed prompts:  44%|████▍     | 3642/8192 [03:13<04:48, 15.77it/s, est. speed input: 19309.41 toks/s, output: 18.86 toks/s]
Processed prompts:  45%|████▍     | 3649/8192 [03:13<04:48, 15.75it/s, est. speed input: 19302.00 toks/s, output: 18.85 toks/s]
Processed prompts:  45%|████▍     | 3656/8192 [03:14<04:48, 15.75it/s, est. speed input: 19294.68 toks/s, output: 18.84 toks/s]
Processed prompts:  45%|████▍     | 3663/8192 [03:14<04:48, 15.69it/s, est. speed input: 19286.91 toks/s, output: 18.83 toks/s]
Processed prompts:  45%|████▍     | 3670/8192 [03:14<04:48, 15.66it/s, est. speed input: 19279.29 toks/s, output: 18.83 toks/s]
Processed prompts:  45%|████▍     | 3677/8192 [03:15<04:48, 15.64it/s, est. speed input: 19271.63 toks/s, output: 18.82 toks/s]
Processed prompts:  45%|████▍     | 3684/8192 [03:15<04:48, 15.62it/s, est. speed input: 19264.01 toks/s, output: 18.81 toks/s]
Processed prompts:  45%|████▌     | 3691/8192 [03:16<04:48, 15.61it/s, est. speed input: 19256.44 toks/s, output: 18.81 toks/s]
Processed prompts:  45%|████▌     | 3698/8192 [03:16<04:48, 15.60it/s, est. speed input: 19248.86 toks/s, output: 18.80 toks/s]
Processed prompts:  45%|████▌     | 3705/8192 [03:17<04:47, 15.60it/s, est. speed input: 19241.41 toks/s, output: 18.79 toks/s]
Processed prompts:  45%|████▌     | 3712/8192 [03:17<04:47, 15.59it/s, est. speed input: 19233.89 toks/s, output: 18.78 toks/s]
Processed prompts:  45%|████▌     | 3719/8192 [03:18<04:47, 15.58it/s, est. speed input: 19226.43 toks/s, output: 18.78 toks/s]
Processed prompts:  45%|████▌     | 3726/8192 [03:18<04:46, 15.58it/s, est. speed input: 19218.99 toks/s, output: 18.77 toks/s]
Processed prompts:  46%|████▌     | 3733/8192 [03:18<04:46, 15.58it/s, est. speed input: 19211.62 toks/s, output: 18.76 toks/s]
Processed prompts:  46%|████▌     | 3740/8192 [03:19<04:45, 15.58it/s, est. speed input: 19204.27 toks/s, output: 18.75 toks/s]
Processed prompts:  46%|████▌     | 3747/8192 [03:19<04:45, 15.58it/s, est. speed input: 19196.98 toks/s, output: 18.75 toks/s]
Processed prompts:  46%|████▌     | 3754/8192 [03:20<04:44, 15.58it/s, est. speed input: 19189.73 toks/s, output: 18.74 toks/s]
Processed prompts:  46%|████▌     | 3761/8192 [03:20<04:44, 15.58it/s, est. speed input: 19182.45 toks/s, output: 18.73 toks/s]
Processed prompts:  46%|████▌     | 3768/8192 [03:21<04:44, 15.57it/s, est. speed input: 19175.14 toks/s, output: 18.73 toks/s]
Processed prompts:  46%|████▌     | 3775/8192 [03:21<04:43, 15.56it/s, est. speed input: 19167.83 toks/s, output: 18.72 toks/s]
Processed prompts:  46%|████▌     | 3782/8192 [03:22<04:43, 15.55it/s, est. speed input: 19160.59 toks/s, output: 18.71 toks/s]
Processed prompts:  46%|████▋     | 3789/8192 [03:22<04:43, 15.56it/s, est. speed input: 19153.44 toks/s, output: 18.70 toks/s]
Processed prompts:  46%|████▋     | 3796/8192 [03:23<04:42, 15.56it/s, est. speed input: 19146.32 toks/s, output: 18.70 toks/s]
Processed prompts:  46%|████▋     | 3803/8192 [03:23<04:41, 15.58it/s, est. speed input: 19139.38 toks/s, output: 18.69 toks/s]
Processed prompts:  47%|████▋     | 3810/8192 [03:23<04:41, 15.59it/s, est. speed input: 19132.46 toks/s, output: 18.68 toks/s]
Processed prompts:  47%|████▋     | 3817/8192 [03:24<04:40, 15.60it/s, est. speed input: 19125.64 toks/s, output: 18.68 toks/s]
Processed prompts:  47%|████▋     | 3824/8192 [03:24<04:39, 15.61it/s, est. speed input: 19118.75 toks/s, output: 18.67 toks/s]
Processed prompts:  47%|████▋     | 3831/8192 [03:25<04:39, 15.61it/s, est. speed input: 19111.91 toks/s, output: 18.66 toks/s]
Processed prompts:  47%|████▋     | 3838/8192 [03:25<04:39, 15.60it/s, est. speed input: 19105.05 toks/s, output: 18.66 toks/s]
Processed prompts:  47%|████▋     | 3845/8192 [03:26<04:38, 15.60it/s, est. speed input: 19098.24 toks/s, output: 18.65 toks/s]
Processed prompts:  47%|████▋     | 3852/8192 [03:26<04:38, 15.60it/s, est. speed input: 19091.45 toks/s, output: 18.64 toks/s]
Processed prompts:  47%|████▋     | 3859/8192 [03:27<04:37, 15.60it/s, est. speed input: 19084.69 toks/s, output: 18.64 toks/s]
Processed prompts:  47%|████▋     | 3866/8192 [03:27<04:37, 15.60it/s, est. speed input: 19077.97 toks/s, output: 18.63 toks/s]
Processed prompts:  47%|████▋     | 3873/8192 [03:27<04:36, 15.61it/s, est. speed input: 19071.32 toks/s, output: 18.62 toks/s]
Processed prompts:  47%|████▋     | 3880/8192 [03:28<04:36, 15.61it/s, est. speed input: 19064.70 toks/s, output: 18.62 toks/s]
Processed prompts:  47%|████▋     | 3887/8192 [03:28<04:35, 15.61it/s, est. speed input: 19058.12 toks/s, output: 18.61 toks/s]
Processed prompts:  48%|████▊     | 3894/8192 [03:29<04:35, 15.61it/s, est. speed input: 19051.52 toks/s, output: 18.60 toks/s]
Processed prompts:  48%|████▊     | 3901/8192 [03:29<04:34, 15.61it/s, est. speed input: 19044.93 toks/s, output: 18.60 toks/s]
Processed prompts:  48%|████▊     | 3908/8192 [03:30<04:34, 15.61it/s, est. speed input: 19038.46 toks/s, output: 18.59 toks/s]
Processed prompts:  48%|████▊     | 3915/8192 [03:30<04:33, 15.63it/s, est. speed input: 19032.14 toks/s, output: 18.59 toks/s]
Processed prompts:  48%|████▊     | 3922/8192 [03:31<04:32, 15.65it/s, est. speed input: 19025.84 toks/s, output: 18.58 toks/s]
Processed prompts:  48%|████▊     | 3929/8192 [03:31<04:32, 15.65it/s, est. speed input: 19019.55 toks/s, output: 18.57 toks/s]
Processed prompts:  48%|████▊     | 3936/8192 [03:31<04:31, 15.66it/s, est. speed input: 19013.33 toks/s, output: 18.57 toks/s]
Processed prompts:  48%|████▊     | 3943/8192 [03:32<04:31, 15.67it/s, est. speed input: 19007.08 toks/s, output: 18.56 toks/s]
Processed prompts:  48%|████▊     | 3950/8192 [03:32<04:30, 15.67it/s, est. speed input: 19000.90 toks/s, output: 18.56 toks/s]
Processed prompts:  48%|████▊     | 3957/8192 [03:33<04:30, 15.67it/s, est. speed input: 18994.75 toks/s, output: 18.55 toks/s]
Processed prompts:  48%|████▊     | 3964/8192 [03:33<04:29, 15.67it/s, est. speed input: 18988.54 toks/s, output: 18.54 toks/s]
Processed prompts:  48%|████▊     | 3971/8192 [03:34<04:29, 15.68it/s, est. speed input: 18982.46 toks/s, output: 18.54 toks/s]
Processed prompts:  49%|████▊     | 3978/8192 [03:34<04:28, 15.67it/s, est. speed input: 18976.34 toks/s, output: 18.53 toks/s]
Processed prompts:  49%|████▊     | 3985/8192 [03:35<04:28, 15.68it/s, est. speed input: 18970.32 toks/s, output: 18.53 toks/s]
Processed prompts:  49%|████▊     | 3992/8192 [03:35<04:27, 15.67it/s, est. speed input: 18964.23 toks/s, output: 18.52 toks/s]
Processed prompts:  49%|████▉     | 3999/8192 [03:35<04:27, 15.68it/s, est. speed input: 18958.23 toks/s, output: 18.51 toks/s]
Processed prompts:  49%|████▉     | 4006/8192 [03:36<04:27, 15.68it/s, est. speed input: 18952.23 toks/s, output: 18.51 toks/s]
Processed prompts:  49%|████▉     | 4034/8192 [03:36<02:11, 31.65it/s, est. speed input: 19053.13 toks/s, output: 18.61 toks/s]
Processed prompts:  49%|████▉     | 4041/8192 [03:37<02:35, 26.65it/s, est. speed input: 19046.93 toks/s, output: 18.60 toks/s]
Processed prompts:  49%|████▉     | 4048/8192 [03:37<02:58, 23.25it/s, est. speed input: 19040.75 toks/s, output: 18.59 toks/s]
Processed prompts:  49%|████▉     | 4055/8192 [03:38<03:17, 20.94it/s, est. speed input: 19034.69 toks/s, output: 18.59 toks/s]
Processed prompts:  50%|████▉     | 4062/8192 [03:38<03:32, 19.44it/s, est. speed input: 19029.25 toks/s, output: 18.58 toks/s]
Processed prompts:  50%|████▉     | 4069/8192 [03:39<03:44, 18.40it/s, est. speed input: 19023.88 toks/s, output: 18.58 toks/s]
Processed prompts:  50%|████▉     | 4076/8192 [03:39<03:53, 17.66it/s, est. speed input: 19018.52 toks/s, output: 18.57 toks/s]
Processed prompts:  50%|████▉     | 4083/8192 [03:39<03:59, 17.16it/s, est. speed input: 19013.26 toks/s, output: 18.57 toks/s]
Processed prompts:  50%|████▉     | 4090/8192 [03:40<04:04, 16.80it/s, est. speed input: 19007.90 toks/s, output: 18.56 toks/s]
Processed prompts:  50%|█████     | 4097/8192 [03:40<04:07, 16.55it/s, est. speed input: 19002.68 toks/s, output: 18.56 toks/s]
Processed prompts:  50%|█████     | 4104/8192 [03:41<04:09, 16.37it/s, est. speed input: 18997.38 toks/s, output: 18.55 toks/s]
Processed prompts:  50%|█████     | 4111/8192 [03:41<04:11, 16.26it/s, est. speed input: 18992.18 toks/s, output: 18.55 toks/s]
Processed prompts:  50%|█████     | 4118/8192 [03:42<04:11, 16.17it/s, est. speed input: 18986.95 toks/s, output: 18.54 toks/s]
Processed prompts:  50%|█████     | 4125/8192 [03:42<04:12, 16.11it/s, est. speed input: 18981.76 toks/s, output: 18.54 toks/s]
Processed prompts:  50%|█████     | 4132/8192 [03:42<04:12, 16.07it/s, est. speed input: 18976.58 toks/s, output: 18.53 toks/s]
Processed prompts:  51%|█████     | 4139/8192 [03:43<04:12, 16.04it/s, est. speed input: 18971.44 toks/s, output: 18.53 toks/s]
Processed prompts:  51%|█████     | 4146/8192 [03:43<04:12, 16.01it/s, est. speed input: 18966.29 toks/s, output: 18.52 toks/s]
Processed prompts:  51%|█████     | 4153/8192 [03:44<04:12, 16.00it/s, est. speed input: 18961.15 toks/s, output: 18.52 toks/s]
Processed prompts:  51%|█████     | 4160/8192 [03:44<04:12, 15.99it/s, est. speed input: 18956.04 toks/s, output: 18.51 toks/s]
Processed prompts:  51%|█████     | 4167/8192 [03:45<04:11, 15.97it/s, est. speed input: 18950.92 toks/s, output: 18.51 toks/s]
Processed prompts:  51%|█████     | 4174/8192 [03:45<04:12, 15.89it/s, est. speed input: 18945.27 toks/s, output: 18.50 toks/s]
Processed prompts:  51%|█████     | 4181/8192 [03:46<04:13, 15.82it/s, est. speed input: 18939.47 toks/s, output: 18.50 toks/s]
Processed prompts:  51%|█████     | 4188/8192 [03:46<04:13, 15.77it/s, est. speed input: 18933.74 toks/s, output: 18.49 toks/s]
Processed prompts:  51%|█████     | 4195/8192 [03:46<04:13, 15.74it/s, est. speed input: 18928.03 toks/s, output: 18.48 toks/s]
Processed prompts:  51%|█████▏    | 4202/8192 [03:47<04:13, 15.72it/s, est. speed input: 18922.37 toks/s, output: 18.48 toks/s]
Processed prompts:  51%|█████▏    | 4209/8192 [03:47<04:13, 15.71it/s, est. speed input: 18916.78 toks/s, output: 18.47 toks/s]
Processed prompts:  51%|█████▏    | 4216/8192 [03:48<04:13, 15.70it/s, est. speed input: 18911.17 toks/s, output: 18.47 toks/s]
Processed prompts:  52%|█████▏    | 4223/8192 [03:48<04:12, 15.70it/s, est. speed input: 18905.62 toks/s, output: 18.46 toks/s]
Processed prompts:  52%|█████▏    | 4230/8192 [03:49<04:12, 15.69it/s, est. speed input: 18900.03 toks/s, output: 18.46 toks/s]
Processed prompts:  52%|█████▏    | 4237/8192 [03:49<04:12, 15.69it/s, est. speed input: 18894.51 toks/s, output: 18.45 toks/s]
Processed prompts:  52%|█████▏    | 4244/8192 [03:50<04:11, 15.68it/s, est. speed input: 18889.00 toks/s, output: 18.45 toks/s]
Processed prompts:  52%|█████▏    | 4251/8192 [03:50<04:11, 15.68it/s, est. speed input: 18883.48 toks/s, output: 18.44 toks/s]
Processed prompts:  52%|█████▏    | 4258/8192 [03:50<04:10, 15.68it/s, est. speed input: 18878.01 toks/s, output: 18.44 toks/s]
Processed prompts:  52%|█████▏    | 4265/8192 [03:51<04:10, 15.67it/s, est. speed input: 18872.53 toks/s, output: 18.43 toks/s]
Processed prompts:  52%|█████▏    | 4272/8192 [03:51<04:10, 15.68it/s, est. speed input: 18867.14 toks/s, output: 18.42 toks/s]
Processed prompts:  52%|█████▏    | 4279/8192 [03:52<04:09, 15.68it/s, est. speed input: 18861.70 toks/s, output: 18.42 toks/s]
Processed prompts:  52%|█████▏    | 4286/8192 [03:52<04:09, 15.68it/s, est. speed input: 18856.34 toks/s, output: 18.41 toks/s]
Processed prompts:  52%|█████▏    | 4293/8192 [03:53<04:08, 15.68it/s, est. speed input: 18850.95 toks/s, output: 18.41 toks/s]
Processed prompts:  52%|█████▏    | 4300/8192 [03:53<04:08, 15.68it/s, est. speed input: 18845.65 toks/s, output: 18.40 toks/s]
Processed prompts:  53%|█████▎    | 4307/8192 [03:54<04:07, 15.67it/s, est. speed input: 18840.26 toks/s, output: 18.40 toks/s]
Processed prompts:  53%|█████▎    | 4314/8192 [03:54<04:07, 15.65it/s, est. speed input: 18834.80 toks/s, output: 18.39 toks/s]
Processed prompts:  53%|█████▎    | 4321/8192 [03:54<04:07, 15.63it/s, est. speed input: 18829.27 toks/s, output: 18.39 toks/s]
Processed prompts:  53%|█████▎    | 4328/8192 [03:55<04:07, 15.62it/s, est. speed input: 18823.80 toks/s, output: 18.38 toks/s]
Processed prompts:  53%|█████▎    | 4335/8192 [03:55<04:07, 15.61it/s, est. speed input: 18818.36 toks/s, output: 18.38 toks/s]
Processed prompts:  53%|█████▎    | 4342/8192 [03:56<04:06, 15.60it/s, est. speed input: 18812.89 toks/s, output: 18.37 toks/s]
Processed prompts:  53%|█████▎    | 4349/8192 [03:56<04:06, 15.60it/s, est. speed input: 18807.52 toks/s, output: 18.37 toks/s]
Processed prompts:  53%|█████▎    | 4356/8192 [03:57<04:05, 15.59it/s, est. speed input: 18802.13 toks/s, output: 18.36 toks/s]
Processed prompts:  53%|█████▎    | 4363/8192 [03:57<04:05, 15.60it/s, est. speed input: 18796.81 toks/s, output: 18.36 toks/s]
Processed prompts:  53%|█████▎    | 4370/8192 [03:58<04:05, 15.59it/s, est. speed input: 18791.42 toks/s, output: 18.35 toks/s]
Processed prompts:  53%|█████▎    | 4377/8192 [03:58<04:04, 15.58it/s, est. speed input: 18786.00 toks/s, output: 18.35 toks/s]
Processed prompts:  54%|█████▎    | 4384/8192 [03:59<04:04, 15.58it/s, est. speed input: 18780.71 toks/s, output: 18.34 toks/s]
Processed prompts:  54%|█████▎    | 4391/8192 [03:59<04:03, 15.58it/s, est. speed input: 18775.39 toks/s, output: 18.34 toks/s]
Processed prompts:  54%|█████▎    | 4398/8192 [03:59<04:03, 15.58it/s, est. speed input: 18770.14 toks/s, output: 18.33 toks/s]
Processed prompts:  54%|█████▍    | 4405/8192 [04:00<04:03, 15.58it/s, est. speed input: 18764.87 toks/s, output: 18.33 toks/s]
Processed prompts:  54%|█████▍    | 4412/8192 [04:00<04:02, 15.58it/s, est. speed input: 18759.64 toks/s, output: 18.32 toks/s]
Processed prompts:  54%|█████▍    | 4419/8192 [04:01<04:02, 15.59it/s, est. speed input: 18754.44 toks/s, output: 18.31 toks/s]
Processed prompts:  54%|█████▍    | 4426/8192 [04:01<04:01, 15.59it/s, est. speed input: 18749.26 toks/s, output: 18.31 toks/s]
Processed prompts:  54%|█████▍    | 4433/8192 [04:02<04:01, 15.59it/s, est. speed input: 18744.11 toks/s, output: 18.30 toks/s]
Processed prompts:  54%|█████▍    | 4440/8192 [04:02<04:00, 15.61it/s, est. speed input: 18739.14 toks/s, output: 18.30 toks/s]
Processed prompts:  54%|█████▍    | 4447/8192 [04:03<03:59, 15.63it/s, est. speed input: 18734.21 toks/s, output: 18.30 toks/s]
Processed prompts:  54%|█████▍    | 4454/8192 [04:03<03:58, 15.64it/s, est. speed input: 18729.28 toks/s, output: 18.29 toks/s]
Processed prompts:  54%|█████▍    | 4461/8192 [04:03<03:58, 15.66it/s, est. speed input: 18724.41 toks/s, output: 18.29 toks/s]
Processed prompts:  55%|█████▍    | 4468/8192 [04:04<03:57, 15.66it/s, est. speed input: 18719.48 toks/s, output: 18.28 toks/s]
Processed prompts:  55%|█████▍    | 4475/8192 [04:04<03:57, 15.67it/s, est. speed input: 18714.68 toks/s, output: 18.28 toks/s]
Processed prompts:  55%|█████▍    | 4482/8192 [04:05<03:56, 15.67it/s, est. speed input: 18709.81 toks/s, output: 18.27 toks/s]
Processed prompts:  55%|█████▍    | 4489/8192 [04:05<03:56, 15.68it/s, est. speed input: 18705.02 toks/s, output: 18.27 toks/s]
Processed prompts:  55%|█████▍    | 4496/8192 [04:06<03:55, 15.67it/s, est. speed input: 18700.18 toks/s, output: 18.26 toks/s]
Processed prompts:  55%|█████▍    | 4503/8192 [04:06<03:55, 15.68it/s, est. speed input: 18695.41 toks/s, output: 18.26 toks/s]
Processed prompts:  55%|█████▌    | 4510/8192 [04:07<03:54, 15.67it/s, est. speed input: 18690.61 toks/s, output: 18.25 toks/s]
Processed prompts:  55%|█████▌    | 4517/8192 [04:07<03:54, 15.68it/s, est. speed input: 18685.89 toks/s, output: 18.25 toks/s]
Processed prompts:  55%|█████▌    | 4545/8192 [04:08<02:05, 28.97it/s, est. speed input: 18764.69 toks/s, output: 18.32 toks/s]
Processed prompts:  56%|█████▌    | 4552/8192 [04:08<02:25, 25.07it/s, est. speed input: 18759.85 toks/s, output: 18.32 toks/s]
Processed prompts:  56%|█████▌    | 4559/8192 [04:08<02:43, 22.28it/s, est. speed input: 18754.97 toks/s, output: 18.32 toks/s]
Processed prompts:  56%|█████▌    | 4566/8192 [04:09<02:58, 20.32it/s, est. speed input: 18750.14 toks/s, output: 18.31 toks/s]
Processed prompts:  56%|█████▌    | 4573/8192 [04:09<03:11, 18.94it/s, est. speed input: 18745.31 toks/s, output: 18.31 toks/s]
Processed prompts:  56%|█████▌    | 4580/8192 [04:10<03:21, 17.97it/s, est. speed input: 18740.53 toks/s, output: 18.30 toks/s]
Processed prompts:  56%|█████▌    | 4587/8192 [04:10<03:28, 17.28it/s, est. speed input: 18735.71 toks/s, output: 18.30 toks/s]
Processed prompts:  56%|█████▌    | 4594/8192 [04:11<03:34, 16.81it/s, est. speed input: 18730.99 toks/s, output: 18.29 toks/s]
Processed prompts:  56%|█████▌    | 4601/8192 [04:11<03:38, 16.46it/s, est. speed input: 18726.16 toks/s, output: 18.29 toks/s]
Processed prompts:  56%|█████▋    | 4608/8192 [04:12<03:41, 16.22it/s, est. speed input: 18721.38 toks/s, output: 18.28 toks/s]
Processed prompts:  56%|█████▋    | 4615/8192 [04:12<03:42, 16.05it/s, est. speed input: 18716.61 toks/s, output: 18.28 toks/s]
Processed prompts:  56%|█████▋    | 4622/8192 [04:12<03:44, 15.93it/s, est. speed input: 18711.86 toks/s, output: 18.27 toks/s]
Processed prompts:  57%|█████▋    | 4629/8192 [04:13<03:44, 15.85it/s, est. speed input: 18707.15 toks/s, output: 18.27 toks/s]
Processed prompts:  57%|█████▋    | 4636/8192 [04:13<03:45, 15.80it/s, est. speed input: 18702.47 toks/s, output: 18.26 toks/s]
Processed prompts:  57%|█████▋    | 4643/8192 [04:14<03:45, 15.75it/s, est. speed input: 18697.77 toks/s, output: 18.26 toks/s]
Processed prompts:  57%|█████▋    | 4650/8192 [04:14<03:45, 15.72it/s, est. speed input: 18693.06 toks/s, output: 18.25 toks/s]
Processed prompts:  57%|█████▋    | 4657/8192 [04:15<03:45, 15.69it/s, est. speed input: 18688.32 toks/s, output: 18.25 toks/s]
Processed prompts:  57%|█████▋    | 4664/8192 [04:15<03:45, 15.67it/s, est. speed input: 18683.59 toks/s, output: 18.25 toks/s]
Processed prompts:  57%|█████▋    | 4671/8192 [04:16<03:44, 15.66it/s, est. speed input: 18678.90 toks/s, output: 18.24 toks/s]
Processed prompts:  57%|█████▋    | 4678/8192 [04:16<03:44, 15.65it/s, est. speed input: 18674.22 toks/s, output: 18.24 toks/s]
Processed prompts:  57%|█████▋    | 4685/8192 [04:16<03:44, 15.64it/s, est. speed input: 18669.58 toks/s, output: 18.23 toks/s]
Processed prompts:  57%|█████▋    | 4692/8192 [04:17<03:43, 15.64it/s, est. speed input: 18664.93 toks/s, output: 18.23 toks/s]
Processed prompts:  57%|█████▋    | 4699/8192 [04:17<03:43, 15.63it/s, est. speed input: 18660.30 toks/s, output: 18.22 toks/s]
Processed prompts:  57%|█████▋    | 4706/8192 [04:18<03:43, 15.63it/s, est. speed input: 18655.68 toks/s, output: 18.22 toks/s]
Processed prompts:  58%|█████▊    | 4713/8192 [04:18<03:42, 15.63it/s, est. speed input: 18651.11 toks/s, output: 18.21 toks/s]
Processed prompts:  58%|█████▊    | 4720/8192 [04:19<03:42, 15.64it/s, est. speed input: 18646.57 toks/s, output: 18.21 toks/s]
Processed prompts:  58%|█████▊    | 4727/8192 [04:19<03:41, 15.64it/s, est. speed input: 18642.02 toks/s, output: 18.21 toks/s]
Processed prompts:  58%|█████▊    | 4734/8192 [04:20<03:41, 15.63it/s, est. speed input: 18637.45 toks/s, output: 18.20 toks/s]
Processed prompts:  58%|█████▊    | 4741/8192 [04:20<03:40, 15.64it/s, est. speed input: 18632.98 toks/s, output: 18.20 toks/s]
Processed prompts:  58%|█████▊    | 4748/8192 [04:20<03:40, 15.65it/s, est. speed input: 18628.59 toks/s, output: 18.19 toks/s]
Processed prompts:  58%|█████▊    | 4755/8192 [04:21<03:39, 15.66it/s, est. speed input: 18624.17 toks/s, output: 18.19 toks/s]
Processed prompts:  58%|█████▊    | 4762/8192 [04:21<03:38, 15.67it/s, est. speed input: 18619.81 toks/s, output: 18.18 toks/s]
Processed prompts:  58%|█████▊    | 4769/8192 [04:22<03:38, 15.67it/s, est. speed input: 18615.42 toks/s, output: 18.18 toks/s]
Processed prompts:  58%|█████▊    | 4776/8192 [04:22<03:37, 15.68it/s, est. speed input: 18611.11 toks/s, output: 18.17 toks/s]
Processed prompts:  58%|█████▊    | 4783/8192 [04:23<03:37, 15.68it/s, est. speed input: 18606.77 toks/s, output: 18.17 toks/s]
Processed prompts:  58%|█████▊    | 4790/8192 [04:23<03:36, 15.68it/s, est. speed input: 18602.48 toks/s, output: 18.17 toks/s]
Processed prompts:  59%|█████▊    | 4797/8192 [04:24<03:36, 15.68it/s, est. speed input: 18598.18 toks/s, output: 18.16 toks/s]
Processed prompts:  59%|█████▊    | 4804/8192 [04:24<03:36, 15.68it/s, est. speed input: 18593.89 toks/s, output: 18.16 toks/s]
Processed prompts:  59%|█████▊    | 4811/8192 [04:25<03:35, 15.68it/s, est. speed input: 18589.63 toks/s, output: 18.15 toks/s]
Processed prompts:  59%|█████▉    | 4818/8192 [04:25<03:35, 15.68it/s, est. speed input: 18585.36 toks/s, output: 18.15 toks/s]
Processed prompts:  59%|█████▉    | 4825/8192 [04:25<03:34, 15.68it/s, est. speed input: 18581.09 toks/s, output: 18.15 toks/s]
Processed prompts:  59%|█████▉    | 4832/8192 [04:26<03:34, 15.67it/s, est. speed input: 18576.81 toks/s, output: 18.14 toks/s]
Processed prompts:  59%|█████▉    | 4839/8192 [04:26<03:34, 15.66it/s, est. speed input: 18572.53 toks/s, output: 18.14 toks/s]
Processed prompts:  59%|█████▉    | 4846/8192 [04:27<03:33, 15.67it/s, est. speed input: 18568.31 toks/s, output: 18.13 toks/s]
Processed prompts:  59%|█████▉    | 4853/8192 [04:27<03:33, 15.67it/s, est. speed input: 18564.09 toks/s, output: 18.13 toks/s]
Processed prompts:  59%|█████▉    | 4860/8192 [04:28<03:32, 15.67it/s, est. speed input: 18559.88 toks/s, output: 18.12 toks/s]
Processed prompts:  59%|█████▉    | 4867/8192 [04:28<03:32, 15.66it/s, est. speed input: 18555.68 toks/s, output: 18.12 toks/s]
Processed prompts:  59%|█████▉    | 4874/8192 [04:29<03:31, 15.67it/s, est. speed input: 18551.54 toks/s, output: 18.12 toks/s]
Processed prompts:  60%|█████▉    | 4881/8192 [04:29<03:31, 15.67it/s, est. speed input: 18547.40 toks/s, output: 18.11 toks/s]
Processed prompts:  60%|█████▉    | 4888/8192 [04:29<03:30, 15.67it/s, est. speed input: 18543.27 toks/s, output: 18.11 toks/s]
Processed prompts:  60%|█████▉    | 4895/8192 [04:30<03:30, 15.68it/s, est. speed input: 18539.17 toks/s, output: 18.10 toks/s]
Processed prompts:  60%|█████▉    | 4902/8192 [04:30<03:30, 15.67it/s, est. speed input: 18535.01 toks/s, output: 18.10 toks/s]
Processed prompts:  60%|█████▉    | 4909/8192 [04:31<03:29, 15.66it/s, est. speed input: 18530.87 toks/s, output: 18.10 toks/s]
Processed prompts:  60%|██████    | 4916/8192 [04:31<03:29, 15.66it/s, est. speed input: 18526.78 toks/s, output: 18.09 toks/s]
Processed prompts:  60%|██████    | 4923/8192 [04:32<03:28, 15.66it/s, est. speed input: 18522.69 toks/s, output: 18.09 toks/s]
Processed prompts:  60%|██████    | 4930/8192 [04:32<03:28, 15.67it/s, est. speed input: 18518.66 toks/s, output: 18.08 toks/s]
Processed prompts:  60%|██████    | 4937/8192 [04:33<03:27, 15.66it/s, est. speed input: 18514.56 toks/s, output: 18.08 toks/s]
Processed prompts:  60%|██████    | 4944/8192 [04:33<03:27, 15.66it/s, est. speed input: 18510.49 toks/s, output: 18.08 toks/s]
Processed prompts:  60%|██████    | 4951/8192 [04:33<03:26, 15.66it/s, est. speed input: 18506.47 toks/s, output: 18.07 toks/s]
Processed prompts:  61%|██████    | 4958/8192 [04:34<03:26, 15.67it/s, est. speed input: 18502.47 toks/s, output: 18.07 toks/s]
Processed prompts:  61%|██████    | 4965/8192 [04:34<03:25, 15.67it/s, est. speed input: 18498.48 toks/s, output: 18.06 toks/s]
Processed prompts:  61%|██████    | 4972/8192 [04:35<03:25, 15.66it/s, est. speed input: 18494.47 toks/s, output: 18.06 toks/s]
Processed prompts:  61%|██████    | 4979/8192 [04:35<03:25, 15.65it/s, est. speed input: 18490.44 toks/s, output: 18.06 toks/s]
Processed prompts:  61%|██████    | 4986/8192 [04:36<03:24, 15.65it/s, est. speed input: 18486.45 toks/s, output: 18.05 toks/s]
Processed prompts:  61%|██████    | 4993/8192 [04:36<03:24, 15.66it/s, est. speed input: 18482.55 toks/s, output: 18.05 toks/s]
Processed prompts:  61%|██████    | 5000/8192 [04:37<03:23, 15.66it/s, est. speed input: 18478.60 toks/s, output: 18.05 toks/s]
Processed prompts:  61%|██████    | 5007/8192 [04:37<03:23, 15.67it/s, est. speed input: 18474.70 toks/s, output: 18.04 toks/s]
Processed prompts:  61%|██████    | 5014/8192 [04:37<03:22, 15.66it/s, est. speed input: 18470.77 toks/s, output: 18.04 toks/s]
Processed prompts:  61%|██████▏   | 5021/8192 [04:38<03:22, 15.66it/s, est. speed input: 18466.86 toks/s, output: 18.03 toks/s]
Processed prompts:  61%|██████▏   | 5028/8192 [04:38<03:21, 15.67it/s, est. speed input: 18463.01 toks/s, output: 18.03 toks/s]
Processed prompts:  62%|██████▏   | 5056/8192 [04:39<01:42, 30.55it/s, est. speed input: 18538.65 toks/s, output: 18.10 toks/s]
Processed prompts:  62%|██████▏   | 5063/8192 [04:39<02:00, 26.00it/s, est. speed input: 18534.65 toks/s, output: 18.10 toks/s]
Processed prompts:  62%|██████▏   | 5070/8192 [04:40<02:16, 22.87it/s, est. speed input: 18530.72 toks/s, output: 18.10 toks/s]
Processed prompts:  62%|██████▏   | 5077/8192 [04:40<02:30, 20.69it/s, est. speed input: 18526.75 toks/s, output: 18.09 toks/s]
Processed prompts:  62%|██████▏   | 5084/8192 [04:41<02:42, 19.18it/s, est. speed input: 18522.82 toks/s, output: 18.09 toks/s]
Processed prompts:  62%|██████▏   | 5091/8192 [04:41<02:51, 18.12it/s, est. speed input: 18518.89 toks/s, output: 18.08 toks/s]
Processed prompts:  62%|██████▏   | 5098/8192 [04:41<02:58, 17.38it/s, est. speed input: 18514.95 toks/s, output: 18.08 toks/s]
Processed prompts:  62%|██████▏   | 5105/8192 [04:42<03:03, 16.85it/s, est. speed input: 18510.95 toks/s, output: 18.08 toks/s]
Processed prompts:  62%|██████▏   | 5112/8192 [04:42<03:06, 16.48it/s, est. speed input: 18506.95 toks/s, output: 18.07 toks/s]
Processed prompts:  62%|██████▏   | 5119/8192 [04:43<03:09, 16.22it/s, est. speed input: 18503.00 toks/s, output: 18.07 toks/s]
Processed prompts:  63%|██████▎   | 5126/8192 [04:43<03:11, 16.04it/s, est. speed input: 18499.03 toks/s, output: 18.07 toks/s]
Processed prompts:  63%|██████▎   | 5133/8192 [04:44<03:12, 15.92it/s, est. speed input: 18495.09 toks/s, output: 18.06 toks/s]
Processed prompts:  63%|██████▎   | 5140/8192 [04:44<03:12, 15.84it/s, est. speed input: 18491.22 toks/s, output: 18.06 toks/s]
Processed prompts:  63%|██████▎   | 5147/8192 [04:45<03:12, 15.79it/s, est. speed input: 18487.40 toks/s, output: 18.05 toks/s]
Processed prompts:  63%|██████▎   | 5154/8192 [04:45<03:12, 15.75it/s, est. speed input: 18483.58 toks/s, output: 18.05 toks/s]
Processed prompts:  63%|██████▎   | 5161/8192 [04:45<03:12, 15.73it/s, est. speed input: 18479.79 toks/s, output: 18.05 toks/s]
Processed prompts:  63%|██████▎   | 5168/8192 [04:46<03:12, 15.71it/s, est. speed input: 18475.95 toks/s, output: 18.04 toks/s]
Processed prompts:  63%|██████▎   | 5175/8192 [04:46<03:12, 15.70it/s, est. speed input: 18472.17 toks/s, output: 18.04 toks/s]
Processed prompts:  63%|██████▎   | 5182/8192 [04:47<03:11, 15.69it/s, est. speed input: 18468.40 toks/s, output: 18.04 toks/s]
Processed prompts:  63%|██████▎   | 5189/8192 [04:47<03:11, 15.68it/s, est. speed input: 18464.63 toks/s, output: 18.03 toks/s]
Processed prompts:  63%|██████▎   | 5196/8192 [04:48<03:11, 15.68it/s, est. speed input: 18460.88 toks/s, output: 18.03 toks/s]
Processed prompts:  64%|██████▎   | 5203/8192 [04:48<03:10, 15.67it/s, est. speed input: 18457.12 toks/s, output: 18.02 toks/s]
Processed prompts:  64%|██████▎   | 5210/8192 [04:49<03:10, 15.67it/s, est. speed input: 18453.40 toks/s, output: 18.02 toks/s]
Processed prompts:  64%|██████▎   | 5217/8192 [04:49<03:09, 15.67it/s, est. speed input: 18449.67 toks/s, output: 18.02 toks/s]
Processed prompts:  64%|██████▍   | 5224/8192 [04:50<03:09, 15.67it/s, est. speed input: 18445.97 toks/s, output: 18.01 toks/s]
Processed prompts:  64%|██████▍   | 5231/8192 [04:50<03:08, 15.67it/s, est. speed input: 18442.28 toks/s, output: 18.01 toks/s]
Processed prompts:  64%|██████▍   | 5238/8192 [04:50<03:08, 15.67it/s, est. speed input: 18438.58 toks/s, output: 18.01 toks/s]
Processed prompts:  64%|██████▍   | 5245/8192 [04:51<03:08, 15.67it/s, est. speed input: 18434.94 toks/s, output: 18.00 toks/s]
Processed prompts:  64%|██████▍   | 5252/8192 [04:51<03:07, 15.66it/s, est. speed input: 18431.23 toks/s, output: 18.00 toks/s]
Processed prompts:  64%|██████▍   | 5259/8192 [04:52<03:07, 15.67it/s, est. speed input: 18427.61 toks/s, output: 18.00 toks/s]
Processed prompts:  64%|██████▍   | 5266/8192 [04:52<03:06, 15.67it/s, est. speed input: 18423.98 toks/s, output: 17.99 toks/s]
Processed prompts:  64%|██████▍   | 5273/8192 [04:53<03:06, 15.67it/s, est. speed input: 18420.37 toks/s, output: 17.99 toks/s]
Processed prompts:  64%|██████▍   | 5280/8192 [04:53<03:05, 15.67it/s, est. speed input: 18416.75 toks/s, output: 17.99 toks/s]
Processed prompts:  65%|██████▍   | 5287/8192 [04:54<03:05, 15.67it/s, est. speed input: 18413.15 toks/s, output: 17.98 toks/s]
Processed prompts:  65%|██████▍   | 5294/8192 [04:54<03:04, 15.68it/s, est. speed input: 18409.59 toks/s, output: 17.98 toks/s]
Processed prompts:  65%|██████▍   | 5301/8192 [04:54<03:04, 15.67it/s, est. speed input: 18405.98 toks/s, output: 17.97 toks/s]
Processed prompts:  65%|██████▍   | 5308/8192 [04:55<03:04, 15.67it/s, est. speed input: 18402.42 toks/s, output: 17.97 toks/s]
Processed prompts:  65%|██████▍   | 5315/8192 [04:55<03:03, 15.67it/s, est. speed input: 18398.86 toks/s, output: 17.97 toks/s]
Processed prompts:  65%|██████▍   | 5322/8192 [04:56<03:03, 15.67it/s, est. speed input: 18395.32 toks/s, output: 17.96 toks/s]
Processed prompts:  65%|██████▌   | 5329/8192 [04:56<03:02, 15.67it/s, est. speed input: 18391.78 toks/s, output: 17.96 toks/s]
Processed prompts:  65%|██████▌   | 5336/8192 [04:57<03:02, 15.66it/s, est. speed input: 18388.20 toks/s, output: 17.96 toks/s]
Processed prompts:  65%|██████▌   | 5343/8192 [04:57<03:01, 15.67it/s, est. speed input: 18384.69 toks/s, output: 17.95 toks/s]
Processed prompts:  65%|██████▌   | 5350/8192 [04:58<03:01, 15.66it/s, est. speed input: 18381.12 toks/s, output: 17.95 toks/s]
Processed prompts:  65%|██████▌   | 5357/8192 [04:58<03:01, 15.66it/s, est. speed input: 18377.62 toks/s, output: 17.95 toks/s]
Processed prompts:  65%|██████▌   | 5364/8192 [04:58<03:00, 15.66it/s, est. speed input: 18374.12 toks/s, output: 17.94 toks/s]
Processed prompts:  66%|██████▌   | 5371/8192 [04:59<03:00, 15.65it/s, est. speed input: 18370.59 toks/s, output: 17.94 toks/s]
Processed prompts:  66%|██████▌   | 5378/8192 [04:59<02:59, 15.65it/s, est. speed input: 18367.10 toks/s, output: 17.94 toks/s]
Processed prompts:  66%|██████▌   | 5385/8192 [05:00<02:59, 15.66it/s, est. speed input: 18363.64 toks/s, output: 17.93 toks/s]
Processed prompts:  66%|██████▌   | 5392/8192 [05:00<02:58, 15.66it/s, est. speed input: 18360.21 toks/s, output: 17.93 toks/s]
Processed prompts:  66%|██████▌   | 5399/8192 [05:01<02:58, 15.67it/s, est. speed input: 18356.82 toks/s, output: 17.93 toks/s]
Processed prompts:  66%|██████▌   | 5406/8192 [05:01<02:57, 15.67it/s, est. speed input: 18353.39 toks/s, output: 17.92 toks/s]
Processed prompts:  66%|██████▌   | 5413/8192 [05:02<02:57, 15.68it/s, est. speed input: 18350.06 toks/s, output: 17.92 toks/s]
Processed prompts:  66%|██████▌   | 5420/8192 [05:02<02:56, 15.68it/s, est. speed input: 18346.63 toks/s, output: 17.92 toks/s]
Processed prompts:  66%|██████▌   | 5427/8192 [05:02<02:56, 15.68it/s, est. speed input: 18343.28 toks/s, output: 17.91 toks/s]
Processed prompts:  66%|██████▋   | 5434/8192 [05:03<02:55, 15.68it/s, est. speed input: 18339.89 toks/s, output: 17.91 toks/s]
Processed prompts:  66%|██████▋   | 5441/8192 [05:03<02:55, 15.68it/s, est. speed input: 18336.55 toks/s, output: 17.91 toks/s]
Processed prompts:  67%|██████▋   | 5448/8192 [05:04<02:55, 15.68it/s, est. speed input: 18333.19 toks/s, output: 17.90 toks/s]
Processed prompts:  67%|██████▋   | 5455/8192 [05:04<02:54, 15.69it/s, est. speed input: 18329.89 toks/s, output: 17.90 toks/s]
Processed prompts:  67%|██████▋   | 5462/8192 [05:05<02:54, 15.68it/s, est. speed input: 18326.53 toks/s, output: 17.90 toks/s]
Processed prompts:  67%|██████▋   | 5469/8192 [05:05<02:53, 15.68it/s, est. speed input: 18323.24 toks/s, output: 17.89 toks/s]
Processed prompts:  67%|██████▋   | 5476/8192 [05:06<02:53, 15.68it/s, est. speed input: 18319.92 toks/s, output: 17.89 toks/s]
Processed prompts:  67%|██████▋   | 5483/8192 [05:06<02:52, 15.68it/s, est. speed input: 18316.64 toks/s, output: 17.89 toks/s]
Processed prompts:  67%|██████▋   | 5490/8192 [05:06<02:52, 15.68it/s, est. speed input: 18313.33 toks/s, output: 17.88 toks/s]
Processed prompts:  67%|██████▋   | 5497/8192 [05:07<02:51, 15.68it/s, est. speed input: 18310.08 toks/s, output: 17.88 toks/s]
Processed prompts:  67%|██████▋   | 5504/8192 [05:07<02:51, 15.68it/s, est. speed input: 18306.79 toks/s, output: 17.88 toks/s]
Processed prompts:  67%|██████▋   | 5511/8192 [05:08<02:50, 15.68it/s, est. speed input: 18303.54 toks/s, output: 17.87 toks/s]
Processed prompts:  67%|██████▋   | 5518/8192 [05:08<02:50, 15.68it/s, est. speed input: 18300.28 toks/s, output: 17.87 toks/s]
Processed prompts:  67%|██████▋   | 5525/8192 [05:09<02:50, 15.68it/s, est. speed input: 18297.03 toks/s, output: 17.87 toks/s]
Processed prompts:  68%|██████▊   | 5532/8192 [05:09<02:49, 15.68it/s, est. speed input: 18293.80 toks/s, output: 17.87 toks/s]
Processed prompts:  68%|██████▊   | 5560/8192 [05:10<01:26, 30.56it/s, est. speed input: 18362.15 toks/s, output: 17.93 toks/s]
Processed prompts:  68%|██████▊   | 5567/8192 [05:10<01:40, 25.99it/s, est. speed input: 18358.74 toks/s, output: 17.93 toks/s]
Processed prompts:  68%|██████▊   | 5574/8192 [05:10<01:54, 22.84it/s, est. speed input: 18355.34 toks/s, output: 17.93 toks/s]
Processed prompts:  68%|██████▊   | 5581/8192 [05:11<02:06, 20.65it/s, est. speed input: 18351.95 toks/s, output: 17.92 toks/s]
Processed prompts:  68%|██████▊   | 5588/8192 [05:11<02:16, 19.13it/s, est. speed input: 18348.57 toks/s, output: 17.92 toks/s]
Processed prompts:  68%|██████▊   | 5595/8192 [05:12<02:23, 18.08it/s, est. speed input: 18345.21 toks/s, output: 17.92 toks/s]
Processed prompts:  68%|██████▊   | 5602/8192 [05:12<02:29, 17.34it/s, est. speed input: 18341.85 toks/s, output: 17.91 toks/s]
Processed prompts:  68%|██████▊   | 5609/8192 [05:13<02:33, 16.83it/s, est. speed input: 18338.53 toks/s, output: 17.91 toks/s]
Processed prompts:  69%|██████▊   | 5616/8192 [05:13<02:36, 16.47it/s, est. speed input: 18335.21 toks/s, output: 17.91 toks/s]
Processed prompts:  69%|██████▊   | 5623/8192 [05:14<02:38, 16.22it/s, est. speed input: 18331.90 toks/s, output: 17.90 toks/s]
Processed prompts:  69%|██████▊   | 5630/8192 [05:14<02:39, 16.04it/s, est. speed input: 18328.58 toks/s, output: 17.90 toks/s]
Processed prompts:  69%|██████▉   | 5637/8192 [05:14<02:40, 15.92it/s, est. speed input: 18325.26 toks/s, output: 17.90 toks/s]
Processed prompts:  69%|██████▉   | 5644/8192 [05:15<02:40, 15.83it/s, est. speed input: 18321.97 toks/s, output: 17.89 toks/s]
Processed prompts:  69%|██████▉   | 5651/8192 [05:15<02:41, 15.77it/s, est. speed input: 18318.68 toks/s, output: 17.89 toks/s]
Processed prompts:  69%|██████▉   | 5658/8192 [05:16<02:41, 15.73it/s, est. speed input: 18315.41 toks/s, output: 17.89 toks/s]
Processed prompts:  69%|██████▉   | 5665/8192 [05:16<02:40, 15.70it/s, est. speed input: 18312.12 toks/s, output: 17.88 toks/s]
Processed prompts:  69%|██████▉   | 5672/8192 [05:17<02:40, 15.68it/s, est. speed input: 18308.86 toks/s, output: 17.88 toks/s]
Processed prompts:  69%|██████▉   | 5679/8192 [05:17<02:40, 15.66it/s, est. speed input: 18305.60 toks/s, output: 17.88 toks/s]
Processed prompts:  69%|██████▉   | 5686/8192 [05:18<02:40, 15.65it/s, est. speed input: 18302.36 toks/s, output: 17.87 toks/s]
Processed prompts:  69%|██████▉   | 5693/8192 [05:18<02:39, 15.64it/s, est. speed input: 18299.12 toks/s, output: 17.87 toks/s]
Processed prompts:  70%|██████▉   | 5700/8192 [05:19<02:39, 15.64it/s, est. speed input: 18295.89 toks/s, output: 17.87 toks/s]
Processed prompts:  70%|██████▉   | 5707/8192 [05:19<02:38, 15.63it/s, est. speed input: 18292.67 toks/s, output: 17.86 toks/s]
Processed prompts:  70%|██████▉   | 5714/8192 [05:19<02:38, 15.63it/s, est. speed input: 18289.48 toks/s, output: 17.86 toks/s]
Processed prompts:  70%|██████▉   | 5721/8192 [05:20<02:38, 15.63it/s, est. speed input: 18286.29 toks/s, output: 17.86 toks/s]
Processed prompts:  70%|██████▉   | 5728/8192 [05:20<02:37, 15.64it/s, est. speed input: 18283.15 toks/s, output: 17.85 toks/s]
Processed prompts:  70%|███████   | 5735/8192 [05:21<02:37, 15.65it/s, est. speed input: 18280.03 toks/s, output: 17.85 toks/s]
Processed prompts:  70%|███████   | 5742/8192 [05:21<02:36, 15.65it/s, est. speed input: 18276.92 toks/s, output: 17.85 toks/s]
Processed prompts:  70%|███████   | 5749/8192 [05:22<02:36, 15.66it/s, est. speed input: 18273.82 toks/s, output: 17.85 toks/s]
Processed prompts:  70%|███████   | 5756/8192 [05:22<02:35, 15.66it/s, est. speed input: 18270.75 toks/s, output: 17.84 toks/s]
Processed prompts:  70%|███████   | 5763/8192 [05:23<02:35, 15.66it/s, est. speed input: 18267.67 toks/s, output: 17.84 toks/s]
Processed prompts:  70%|███████   | 5770/8192 [05:23<02:34, 15.67it/s, est. speed input: 18264.63 toks/s, output: 17.84 toks/s]
Processed prompts:  71%|███████   | 5777/8192 [05:23<02:34, 15.66it/s, est. speed input: 18261.53 toks/s, output: 17.83 toks/s]
Processed prompts:  71%|███████   | 5784/8192 [05:24<02:33, 15.66it/s, est. speed input: 18258.44 toks/s, output: 17.83 toks/s]
Processed prompts:  71%|███████   | 5791/8192 [05:24<02:33, 15.66it/s, est. speed input: 18255.41 toks/s, output: 17.83 toks/s]
Processed prompts:  71%|███████   | 5798/8192 [05:25<02:32, 15.66it/s, est. speed input: 18252.37 toks/s, output: 17.82 toks/s]
Processed prompts:  71%|███████   | 5805/8192 [05:25<02:32, 15.67it/s, est. speed input: 18249.36 toks/s, output: 17.82 toks/s]
Processed prompts:  71%|███████   | 5812/8192 [05:26<02:31, 15.67it/s, est. speed input: 18246.33 toks/s, output: 17.82 toks/s]
Processed prompts:  71%|███████   | 5819/8192 [05:26<02:31, 15.67it/s, est. speed input: 18243.32 toks/s, output: 17.82 toks/s]
Processed prompts:  71%|███████   | 5826/8192 [05:27<02:31, 15.66it/s, est. speed input: 18240.29 toks/s, output: 17.81 toks/s]
Processed prompts:  71%|███████   | 5833/8192 [05:27<02:30, 15.66it/s, est. speed input: 18237.29 toks/s, output: 17.81 toks/s]
Processed prompts:  71%|███████▏  | 5840/8192 [05:27<02:30, 15.66it/s, est. speed input: 18234.26 toks/s, output: 17.81 toks/s]
Processed prompts:  71%|███████▏  | 5847/8192 [05:28<02:29, 15.65it/s, est. speed input: 18231.25 toks/s, output: 17.80 toks/s]
Processed prompts:  71%|███████▏  | 5854/8192 [05:28<02:29, 15.65it/s, est. speed input: 18228.25 toks/s, output: 17.80 toks/s]
Processed prompts:  72%|███████▏  | 5861/8192 [05:29<02:28, 15.65it/s, est. speed input: 18225.26 toks/s, output: 17.80 toks/s]
Processed prompts:  72%|███████▏  | 5868/8192 [05:29<02:28, 15.66it/s, est. speed input: 18222.31 toks/s, output: 17.80 toks/s]
Processed prompts:  72%|███████▏  | 5875/8192 [05:30<02:27, 15.66it/s, est. speed input: 18219.34 toks/s, output: 17.79 toks/s]
Processed prompts:  72%|███████▏  | 5882/8192 [05:30<02:27, 15.67it/s, est. speed input: 18216.43 toks/s, output: 17.79 toks/s]
Processed prompts:  72%|███████▏  | 5889/8192 [05:31<02:27, 15.66it/s, est. speed input: 18213.49 toks/s, output: 17.79 toks/s]
Processed prompts:  72%|███████▏  | 5896/8192 [05:31<02:26, 15.66it/s, est. speed input: 18210.55 toks/s, output: 17.78 toks/s]
Processed prompts:  72%|███████▏  | 5903/8192 [05:31<02:26, 15.67it/s, est. speed input: 18207.64 toks/s, output: 17.78 toks/s]
Processed prompts:  72%|███████▏  | 5910/8192 [05:32<02:25, 15.66it/s, est. speed input: 18204.72 toks/s, output: 17.78 toks/s]
Processed prompts:  72%|███████▏  | 5917/8192 [05:32<02:25, 15.67it/s, est. speed input: 18201.85 toks/s, output: 17.78 toks/s]
Processed prompts:  72%|███████▏  | 5924/8192 [05:33<02:24, 15.66it/s, est. speed input: 18198.93 toks/s, output: 17.77 toks/s]
Processed prompts:  72%|███████▏  | 5931/8192 [05:33<02:24, 15.67it/s, est. speed input: 18196.07 toks/s, output: 17.77 toks/s]
Processed prompts:  72%|███████▏  | 5938/8192 [05:34<02:23, 15.67it/s, est. speed input: 18193.18 toks/s, output: 17.77 toks/s]
Processed prompts:  73%|███████▎  | 5945/8192 [05:34<02:23, 15.67it/s, est. speed input: 18190.34 toks/s, output: 17.76 toks/s]
Processed prompts:  73%|███████▎  | 5952/8192 [05:35<02:22, 15.67it/s, est. speed input: 18187.47 toks/s, output: 17.76 toks/s]
Processed prompts:  73%|███████▎  | 5959/8192 [05:35<02:22, 15.67it/s, est. speed input: 18184.60 toks/s, output: 17.76 toks/s]
Processed prompts:  73%|███████▎  | 5966/8192 [05:36<02:22, 15.66it/s, est. speed input: 18181.74 toks/s, output: 17.76 toks/s]
Processed prompts:  73%|███████▎  | 5973/8192 [05:36<02:21, 15.66it/s, est. speed input: 18178.90 toks/s, output: 17.75 toks/s]
Processed prompts:  73%|███████▎  | 5980/8192 [05:36<02:21, 15.67it/s, est. speed input: 18176.10 toks/s, output: 17.75 toks/s]
Processed prompts:  73%|███████▎  | 5987/8192 [05:37<02:20, 15.67it/s, est. speed input: 18173.27 toks/s, output: 17.75 toks/s]
Processed prompts:  73%|███████▎  | 5994/8192 [05:37<02:20, 15.67it/s, est. speed input: 18170.46 toks/s, output: 17.74 toks/s]
Processed prompts:  73%|███████▎  | 6001/8192 [05:38<02:19, 15.67it/s, est. speed input: 18167.63 toks/s, output: 17.74 toks/s]
Processed prompts:  73%|███████▎  | 6008/8192 [05:38<02:19, 15.67it/s, est. speed input: 18164.86 toks/s, output: 17.74 toks/s]
Processed prompts:  73%|███████▎  | 6015/8192 [05:39<02:18, 15.67it/s, est. speed input: 18162.07 toks/s, output: 17.74 toks/s]
Processed prompts:  74%|███████▎  | 6022/8192 [05:39<02:18, 15.67it/s, est. speed input: 18159.27 toks/s, output: 17.73 toks/s]
Processed prompts:  74%|███████▎  | 6029/8192 [05:40<02:17, 15.67it/s, est. speed input: 18156.52 toks/s, output: 17.73 toks/s]
Processed prompts:  74%|███████▎  | 6036/8192 [05:40<02:17, 15.67it/s, est. speed input: 18153.73 toks/s, output: 17.73 toks/s]
Processed prompts:  74%|███████▍  | 6043/8192 [05:40<02:17, 15.67it/s, est. speed input: 18150.99 toks/s, output: 17.73 toks/s]
Processed prompts:  74%|███████▍  | 6071/8192 [05:41<01:09, 30.58it/s, est. speed input: 18213.32 toks/s, output: 17.79 toks/s]
Processed prompts:  74%|███████▍  | 6078/8192 [05:41<01:21, 26.03it/s, est. speed input: 18210.50 toks/s, output: 17.78 toks/s]
Processed prompts:  74%|███████▍  | 6085/8192 [05:42<01:32, 22.88it/s, est. speed input: 18207.68 toks/s, output: 17.78 toks/s]
Processed prompts:  74%|███████▍  | 6092/8192 [05:42<01:41, 20.70it/s, est. speed input: 18204.87 toks/s, output: 17.78 toks/s]
Processed prompts:  74%|███████▍  | 6099/8192 [05:43<01:49, 19.18it/s, est. speed input: 18202.06 toks/s, output: 17.78 toks/s]
Processed prompts:  75%|███████▍  | 6106/8192 [05:43<01:55, 18.13it/s, est. speed input: 18199.28 toks/s, output: 17.77 toks/s]
Processed prompts:  75%|███████▍  | 6113/8192 [05:44<01:59, 17.39it/s, est. speed input: 18196.48 toks/s, output: 17.77 toks/s]
Processed prompts:  75%|███████▍  | 6120/8192 [05:44<02:02, 16.88it/s, est. speed input: 18193.71 toks/s, output: 17.77 toks/s]
Processed prompts:  75%|███████▍  | 6127/8192 [05:44<02:05, 16.51it/s, est. speed input: 18190.91 toks/s, output: 17.76 toks/s]
Processed prompts:  75%|███████▍  | 6134/8192 [05:45<02:06, 16.25it/s, est. speed input: 18188.12 toks/s, output: 17.76 toks/s]
Processed prompts:  75%|███████▍  | 6141/8192 [05:45<02:07, 16.08it/s, est. speed input: 18185.34 toks/s, output: 17.76 toks/s]
Processed prompts:  75%|███████▌  | 6148/8192 [05:46<02:08, 15.95it/s, est. speed input: 18182.57 toks/s, output: 17.76 toks/s]
Processed prompts:  75%|███████▌  | 6155/8192 [05:46<02:08, 15.87it/s, est. speed input: 18179.84 toks/s, output: 17.75 toks/s]
Processed prompts:  75%|███████▌  | 6162/8192 [05:47<02:08, 15.81it/s, est. speed input: 18177.08 toks/s, output: 17.75 toks/s]
Processed prompts:  75%|███████▌  | 6169/8192 [05:47<02:08, 15.77it/s, est. speed input: 18174.34 toks/s, output: 17.75 toks/s]
Processed prompts:  75%|███████▌  | 6176/8192 [05:48<02:08, 15.73it/s, est. speed input: 18171.59 toks/s, output: 17.75 toks/s]
Processed prompts:  75%|███████▌  | 6183/8192 [05:48<02:07, 15.72it/s, est. speed input: 18168.87 toks/s, output: 17.74 toks/s]
Processed prompts:  76%|███████▌  | 6190/8192 [05:48<02:07, 15.71it/s, est. speed input: 18166.18 toks/s, output: 17.74 toks/s]
Processed prompts:  76%|███████▌  | 6197/8192 [05:49<02:07, 15.69it/s, est. speed input: 18163.43 toks/s, output: 17.74 toks/s]
Processed prompts:  76%|███████▌  | 6204/8192 [05:49<02:06, 15.68it/s, est. speed input: 18160.71 toks/s, output: 17.74 toks/s]
Processed prompts:  76%|███████▌  | 6211/8192 [05:50<02:06, 15.67it/s, est. speed input: 18158.00 toks/s, output: 17.73 toks/s]
Processed prompts:  76%|███████▌  | 6218/8192 [05:50<02:05, 15.67it/s, est. speed input: 18155.29 toks/s, output: 17.73 toks/s]
Processed prompts:  76%|███████▌  | 6225/8192 [05:51<02:05, 15.66it/s, est. speed input: 18152.58 toks/s, output: 17.73 toks/s]
Processed prompts:  76%|███████▌  | 6232/8192 [05:51<02:05, 15.66it/s, est. speed input: 18149.86 toks/s, output: 17.72 toks/s]
Processed prompts:  76%|███████▌  | 6239/8192 [05:52<02:04, 15.66it/s, est. speed input: 18147.17 toks/s, output: 17.72 toks/s]
Processed prompts:  76%|███████▌  | 6246/8192 [05:52<02:04, 15.65it/s, est. speed input: 18144.48 toks/s, output: 17.72 toks/s]
Processed prompts:  76%|███████▋  | 6253/8192 [05:52<02:03, 15.66it/s, est. speed input: 18141.82 toks/s, output: 17.72 toks/s]
Processed prompts:  76%|███████▋  | 6260/8192 [05:53<02:03, 15.66it/s, est. speed input: 18139.16 toks/s, output: 17.71 toks/s]
Processed prompts:  77%|███████▋  | 6267/8192 [05:53<02:02, 15.67it/s, est. speed input: 18136.54 toks/s, output: 17.71 toks/s]
Processed prompts:  77%|███████▋  | 6274/8192 [05:54<02:02, 15.67it/s, est. speed input: 18133.89 toks/s, output: 17.71 toks/s]
Processed prompts:  77%|███████▋  | 6281/8192 [05:54<02:01, 15.67it/s, est. speed input: 18131.29 toks/s, output: 17.71 toks/s]
Processed prompts:  77%|███████▋  | 6288/8192 [05:55<02:01, 15.67it/s, est. speed input: 18128.65 toks/s, output: 17.70 toks/s]
Processed prompts:  77%|███████▋  | 6295/8192 [05:55<02:01, 15.68it/s, est. speed input: 18126.07 toks/s, output: 17.70 toks/s]
Processed prompts:  77%|███████▋  | 6302/8192 [05:56<02:00, 15.67it/s, est. speed input: 18123.46 toks/s, output: 17.70 toks/s]
Processed prompts:  77%|███████▋  | 6309/8192 [05:56<02:00, 15.68it/s, est. speed input: 18120.87 toks/s, output: 17.70 toks/s]
Processed prompts:  77%|███████▋  | 6316/8192 [05:56<01:59, 15.67it/s, est. speed input: 18118.27 toks/s, output: 17.69 toks/s]
Processed prompts:  77%|███████▋  | 6323/8192 [05:57<01:59, 15.68it/s, est. speed input: 18115.70 toks/s, output: 17.69 toks/s]
Processed prompts:  77%|███████▋  | 6330/8192 [05:57<01:58, 15.68it/s, est. speed input: 18113.13 toks/s, output: 17.69 toks/s]
Processed prompts:  77%|███████▋  | 6337/8192 [05:58<01:58, 15.67it/s, est. speed input: 18110.53 toks/s, output: 17.69 toks/s]
Processed prompts:  77%|███████▋  | 6344/8192 [05:58<01:57, 15.67it/s, est. speed input: 18107.96 toks/s, output: 17.68 toks/s]
Processed prompts:  78%|███████▊  | 6351/8192 [05:59<01:57, 15.66it/s, est. speed input: 18105.37 toks/s, output: 17.68 toks/s]
Processed prompts:  78%|███████▊  | 6358/8192 [05:59<01:57, 15.67it/s, est. speed input: 18102.82 toks/s, output: 17.68 toks/s]
Processed prompts:  78%|███████▊  | 6365/8192 [06:00<01:56, 15.67it/s, est. speed input: 18100.27 toks/s, output: 17.68 toks/s]
Processed prompts:  78%|███████▊  | 6372/8192 [06:00<01:56, 15.66it/s, est. speed input: 18097.68 toks/s, output: 17.67 toks/s]
Processed prompts:  78%|███████▊  | 6379/8192 [06:00<01:55, 15.67it/s, est. speed input: 18095.19 toks/s, output: 17.67 toks/s]
Processed prompts:  78%|███████▊  | 6386/8192 [06:01<01:55, 15.67it/s, est. speed input: 18092.65 toks/s, output: 17.67 toks/s]
Processed prompts:  78%|███████▊  | 6393/8192 [06:01<01:54, 15.68it/s, est. speed input: 18090.15 toks/s, output: 17.67 toks/s]
Processed prompts:  78%|███████▊  | 6400/8192 [06:02<01:54, 15.67it/s, est. speed input: 18087.63 toks/s, output: 17.66 toks/s]
Processed prompts:  78%|███████▊  | 6407/8192 [06:02<01:53, 15.67it/s, est. speed input: 18085.12 toks/s, output: 17.66 toks/s]
Processed prompts:  78%|███████▊  | 6414/8192 [06:03<01:53, 15.67it/s, est. speed input: 18082.60 toks/s, output: 17.66 toks/s]
Processed prompts:  78%|███████▊  | 6421/8192 [06:03<01:53, 15.67it/s, est. speed input: 18080.10 toks/s, output: 17.66 toks/s]
Processed prompts:  78%|███████▊  | 6428/8192 [06:04<01:52, 15.67it/s, est. speed input: 18077.61 toks/s, output: 17.65 toks/s]
Processed prompts:  79%|███████▊  | 6435/8192 [06:04<01:52, 15.66it/s, est. speed input: 18075.09 toks/s, output: 17.65 toks/s]
Processed prompts:  79%|███████▊  | 6442/8192 [06:05<01:51, 15.67it/s, est. speed input: 18072.62 toks/s, output: 17.65 toks/s]
Processed prompts:  79%|███████▊  | 6449/8192 [06:05<01:51, 15.67it/s, est. speed input: 18070.14 toks/s, output: 17.65 toks/s]
Processed prompts:  79%|███████▉  | 6456/8192 [06:05<01:50, 15.67it/s, est. speed input: 18067.68 toks/s, output: 17.64 toks/s]
Processed prompts:  79%|███████▉  | 6463/8192 [06:06<01:50, 15.67it/s, est. speed input: 18065.21 toks/s, output: 17.64 toks/s]
Processed prompts:  79%|███████▉  | 6470/8192 [06:06<01:49, 15.67it/s, est. speed input: 18062.74 toks/s, output: 17.64 toks/s]
Processed prompts:  79%|███████▉  | 6477/8192 [06:07<01:49, 15.67it/s, est. speed input: 18060.31 toks/s, output: 17.64 toks/s]
Processed prompts:  79%|███████▉  | 6484/8192 [06:07<01:49, 15.67it/s, est. speed input: 18057.83 toks/s, output: 17.63 toks/s]
Processed prompts:  79%|███████▉  | 6491/8192 [06:08<01:48, 15.68it/s, est. speed input: 18055.45 toks/s, output: 17.63 toks/s]
Processed prompts:  79%|███████▉  | 6498/8192 [06:08<01:48, 15.67it/s, est. speed input: 18052.99 toks/s, output: 17.63 toks/s]
Processed prompts:  79%|███████▉  | 6505/8192 [06:09<01:47, 15.68it/s, est. speed input: 18050.59 toks/s, output: 17.63 toks/s]
Processed prompts:  79%|███████▉  | 6512/8192 [06:09<01:47, 15.67it/s, est. speed input: 18048.15 toks/s, output: 17.63 toks/s]
Processed prompts:  80%|███████▉  | 6519/8192 [06:09<01:46, 15.67it/s, est. speed input: 18045.74 toks/s, output: 17.62 toks/s]
Processed prompts:  80%|███████▉  | 6526/8192 [06:10<01:46, 15.67it/s, est. speed input: 18043.34 toks/s, output: 17.62 toks/s]
Processed prompts:  80%|███████▉  | 6533/8192 [06:10<01:45, 15.67it/s, est. speed input: 18040.93 toks/s, output: 17.62 toks/s]
Processed prompts:  80%|███████▉  | 6540/8192 [06:11<01:45, 15.68it/s, est. speed input: 18038.55 toks/s, output: 17.62 toks/s]
Processed prompts:  80%|███████▉  | 6547/8192 [06:11<01:44, 15.67it/s, est. speed input: 18036.14 toks/s, output: 17.61 toks/s]
Processed prompts:  80%|████████  | 6554/8192 [06:12<01:44, 15.68it/s, est. speed input: 18033.78 toks/s, output: 17.61 toks/s]
Processed prompts:  80%|████████  | 6582/8192 [06:12<00:52, 30.65it/s, est. speed input: 18091.16 toks/s, output: 17.67 toks/s]
Processed prompts:  80%|████████  | 6589/8192 [06:13<01:01, 26.07it/s, est. speed input: 18088.72 toks/s, output: 17.66 toks/s]
Processed prompts:  81%|████████  | 6596/8192 [06:13<01:09, 22.91it/s, est. speed input: 18086.28 toks/s, output: 17.66 toks/s]
Processed prompts:  81%|████████  | 6603/8192 [06:13<01:16, 20.71it/s, est. speed input: 18083.85 toks/s, output: 17.66 toks/s]
Processed prompts:  81%|████████  | 6610/8192 [06:14<01:22, 19.19it/s, est. speed input: 18081.40 toks/s, output: 17.66 toks/s]
Processed prompts:  81%|████████  | 6617/8192 [06:14<01:26, 18.14it/s, est. speed input: 18079.01 toks/s, output: 17.66 toks/s]
Processed prompts:  81%|████████  | 6624/8192 [06:15<01:30, 17.39it/s, est. speed input: 18076.58 toks/s, output: 17.65 toks/s]
Processed prompts:  81%|████████  | 6631/8192 [06:15<01:32, 16.87it/s, est. speed input: 18074.17 toks/s, output: 17.65 toks/s]
Processed prompts:  81%|████████  | 6638/8192 [06:16<01:34, 16.51it/s, est. speed input: 18071.74 toks/s, output: 17.65 toks/s]
Processed prompts:  81%|████████  | 6645/8192 [06:16<01:35, 16.26it/s, est. speed input: 18069.35 toks/s, output: 17.65 toks/s]
Processed prompts:  81%|████████  | 6652/8192 [06:17<01:35, 16.08it/s, est. speed input: 18066.95 toks/s, output: 17.64 toks/s]
Processed prompts:  81%|████████▏ | 6659/8192 [06:17<01:36, 15.96it/s, est. speed input: 18064.55 toks/s, output: 17.64 toks/s]
Processed prompts:  81%|████████▏ | 6666/8192 [06:17<01:36, 15.88it/s, est. speed input: 18062.20 toks/s, output: 17.64 toks/s]
Processed prompts:  81%|████████▏ | 6673/8192 [06:18<01:36, 15.81it/s, est. speed input: 18059.79 toks/s, output: 17.64 toks/s]
Processed prompts:  82%|████████▏ | 6680/8192 [06:18<01:35, 15.77it/s, est. speed input: 18057.45 toks/s, output: 17.63 toks/s]
Processed prompts:  82%|████████▏ | 6687/8192 [06:19<01:35, 15.74it/s, est. speed input: 18055.05 toks/s, output: 17.63 toks/s]
Processed prompts:  82%|████████▏ | 6694/8192 [06:19<01:35, 15.72it/s, est. speed input: 18052.69 toks/s, output: 17.63 toks/s]
Processed prompts:  82%|████████▏ | 6701/8192 [06:20<01:34, 15.71it/s, est. speed input: 18050.35 toks/s, output: 17.63 toks/s]
Processed prompts:  82%|████████▏ | 6708/8192 [06:20<01:34, 15.69it/s, est. speed input: 18047.98 toks/s, output: 17.62 toks/s]
Processed prompts:  82%|████████▏ | 6715/8192 [06:21<01:34, 15.68it/s, est. speed input: 18045.63 toks/s, output: 17.62 toks/s]
Processed prompts:  82%|████████▏ | 6722/8192 [06:21<01:33, 15.67it/s, est. speed input: 18043.25 toks/s, output: 17.62 toks/s]
Processed prompts:  82%|████████▏ | 6729/8192 [06:21<01:33, 15.67it/s, est. speed input: 18040.90 toks/s, output: 17.62 toks/s]
Processed prompts:  82%|████████▏ | 6736/8192 [06:22<01:32, 15.68it/s, est. speed input: 18038.60 toks/s, output: 17.62 toks/s]
Processed prompts:  82%|████████▏ | 6743/8192 [06:22<01:32, 15.68it/s, est. speed input: 18036.30 toks/s, output: 17.61 toks/s]
Processed prompts:  82%|████████▏ | 6750/8192 [06:23<01:31, 15.67it/s, est. speed input: 18033.98 toks/s, output: 17.61 toks/s]
Processed prompts:  82%|████████▏ | 6757/8192 [06:23<01:31, 15.68it/s, est. speed input: 18031.68 toks/s, output: 17.61 toks/s]
Processed prompts:  83%|████████▎ | 6764/8192 [06:24<01:31, 15.67it/s, est. speed input: 18029.37 toks/s, output: 17.61 toks/s]
Processed prompts:  83%|████████▎ | 6771/8192 [06:24<01:30, 15.68it/s, est. speed input: 18027.08 toks/s, output: 17.60 toks/s]
Processed prompts:  83%|████████▎ | 6778/8192 [06:25<01:30, 15.68it/s, est. speed input: 18024.79 toks/s, output: 17.60 toks/s]
Processed prompts:  83%|████████▎ | 6785/8192 [06:25<01:29, 15.67it/s, est. speed input: 18022.48 toks/s, output: 17.60 toks/s]
Processed prompts:  83%|████████▎ | 6792/8192 [06:25<01:29, 15.67it/s, est. speed input: 18020.21 toks/s, output: 17.60 toks/s]
Processed prompts:  83%|████████▎ | 6799/8192 [06:26<01:28, 15.67it/s, est. speed input: 18017.90 toks/s, output: 17.60 toks/s]
Processed prompts:  83%|████████▎ | 6806/8192 [06:26<01:28, 15.67it/s, est. speed input: 18015.64 toks/s, output: 17.59 toks/s]
Processed prompts:  83%|████████▎ | 6813/8192 [06:27<01:28, 15.67it/s, est. speed input: 18013.35 toks/s, output: 17.59 toks/s]
Processed prompts:  83%|████████▎ | 6820/8192 [06:27<01:27, 15.67it/s, est. speed input: 18011.10 toks/s, output: 17.59 toks/s]
Processed prompts:  83%|████████▎ | 6827/8192 [06:28<01:27, 15.67it/s, est. speed input: 18008.82 toks/s, output: 17.59 toks/s]
Processed prompts:  83%|████████▎ | 6834/8192 [06:28<01:26, 15.67it/s, est. speed input: 18006.57 toks/s, output: 17.58 toks/s]
Processed prompts:  84%|████████▎ | 6841/8192 [06:29<01:26, 15.67it/s, est. speed input: 18004.32 toks/s, output: 17.58 toks/s]
Processed prompts:  84%|████████▎ | 6848/8192 [06:29<01:25, 15.67it/s, est. speed input: 18002.07 toks/s, output: 17.58 toks/s]
Processed prompts:  84%|████████▎ | 6855/8192 [06:29<01:25, 15.67it/s, est. speed input: 17999.83 toks/s, output: 17.58 toks/s]
Processed prompts:  84%|████████▍ | 6862/8192 [06:30<01:24, 15.67it/s, est. speed input: 17997.58 toks/s, output: 17.58 toks/s]
Processed prompts:  84%|████████▍ | 6869/8192 [06:30<01:24, 15.67it/s, est. speed input: 17995.37 toks/s, output: 17.57 toks/s]
Processed prompts:  84%|████████▍ | 6876/8192 [06:31<01:23, 15.67it/s, est. speed input: 17993.13 toks/s, output: 17.57 toks/s]
Processed prompts:  84%|████████▍ | 6883/8192 [06:31<01:23, 15.67it/s, est. speed input: 17990.93 toks/s, output: 17.57 toks/s]
Processed prompts:  84%|████████▍ | 6890/8192 [06:32<01:23, 15.67it/s, est. speed input: 17988.69 toks/s, output: 17.57 toks/s]
Processed prompts:  84%|████████▍ | 6897/8192 [06:32<01:22, 15.67it/s, est. speed input: 17986.47 toks/s, output: 17.56 toks/s]
Processed prompts:  84%|████████▍ | 6904/8192 [06:33<01:22, 15.66it/s, est. speed input: 17984.24 toks/s, output: 17.56 toks/s]
Processed prompts:  84%|████████▍ | 6911/8192 [06:33<01:21, 15.66it/s, est. speed input: 17982.03 toks/s, output: 17.56 toks/s]
Processed prompts:  84%|████████▍ | 6918/8192 [06:33<01:21, 15.66it/s, est. speed input: 17979.81 toks/s, output: 17.56 toks/s]
Processed prompts:  85%|████████▍ | 6925/8192 [06:34<01:20, 15.66it/s, est. speed input: 17977.60 toks/s, output: 17.56 toks/s]
Processed prompts:  85%|████████▍ | 6932/8192 [06:34<01:20, 15.66it/s, est. speed input: 17975.40 toks/s, output: 17.55 toks/s]
Processed prompts:  85%|████████▍ | 6939/8192 [06:35<01:20, 15.65it/s, est. speed input: 17973.19 toks/s, output: 17.55 toks/s]
Processed prompts:  85%|████████▍ | 6946/8192 [06:35<01:19, 15.65it/s, est. speed input: 17970.99 toks/s, output: 17.55 toks/s]
Processed prompts:  85%|████████▍ | 6953/8192 [06:36<01:19, 15.65it/s, est. speed input: 17968.80 toks/s, output: 17.55 toks/s]
Processed prompts:  85%|████████▍ | 6960/8192 [06:36<01:18, 15.66it/s, est. speed input: 17966.63 toks/s, output: 17.55 toks/s]
Processed prompts:  85%|████████▌ | 6967/8192 [06:37<01:18, 15.66it/s, est. speed input: 17964.48 toks/s, output: 17.54 toks/s]
Processed prompts:  85%|████████▌ | 6974/8192 [06:37<01:17, 15.67it/s, est. speed input: 17962.35 toks/s, output: 17.54 toks/s]
Processed prompts:  85%|████████▌ | 6981/8192 [06:38<01:17, 15.67it/s, est. speed input: 17960.18 toks/s, output: 17.54 toks/s]
Processed prompts:  85%|████████▌ | 6988/8192 [06:38<01:16, 15.67it/s, est. speed input: 17958.05 toks/s, output: 17.54 toks/s]
Processed prompts:  85%|████████▌ | 6995/8192 [06:38<01:16, 15.67it/s, est. speed input: 17955.90 toks/s, output: 17.54 toks/s]
Processed prompts:  85%|████████▌ | 7002/8192 [06:39<01:15, 15.67it/s, est. speed input: 17953.78 toks/s, output: 17.53 toks/s]
Processed prompts:  86%|████████▌ | 7009/8192 [06:39<01:15, 15.67it/s, est. speed input: 17951.66 toks/s, output: 17.53 toks/s]
Processed prompts:  86%|████████▌ | 7016/8192 [06:40<01:15, 15.67it/s, est. speed input: 17949.54 toks/s, output: 17.53 toks/s]
Processed prompts:  86%|████████▌ | 7023/8192 [06:40<01:14, 15.67it/s, est. speed input: 17947.42 toks/s, output: 17.53 toks/s]
Processed prompts:  86%|████████▌ | 7030/8192 [06:41<01:14, 15.67it/s, est. speed input: 17945.31 toks/s, output: 17.52 toks/s]
Processed prompts:  86%|████████▌ | 7037/8192 [06:41<01:13, 15.67it/s, est. speed input: 17943.19 toks/s, output: 17.52 toks/s]
Processed prompts:  86%|████████▌ | 7044/8192 [06:42<01:13, 15.67it/s, est. speed input: 17941.08 toks/s, output: 17.52 toks/s]
Processed prompts:  86%|████████▌ | 7051/8192 [06:42<01:12, 15.67it/s, est. speed input: 17938.98 toks/s, output: 17.52 toks/s]
Processed prompts:  86%|████████▌ | 7058/8192 [06:42<01:12, 15.67it/s, est. speed input: 17936.88 toks/s, output: 17.52 toks/s]
Processed prompts:  86%|████████▋ | 7086/8192 [06:43<00:35, 30.75it/s, est. speed input: 17990.21 toks/s, output: 17.57 toks/s]
Processed prompts:  87%|████████▋ | 7093/8192 [06:43<00:42, 26.14it/s, est. speed input: 17988.10 toks/s, output: 17.57 toks/s]
Processed prompts:  87%|████████▋ | 7100/8192 [06:44<00:47, 22.94it/s, est. speed input: 17985.94 toks/s, output: 17.56 toks/s]
Processed prompts:  87%|████████▋ | 7107/8192 [06:44<00:52, 20.75it/s, est. speed input: 17983.82 toks/s, output: 17.56 toks/s]
Processed prompts:  87%|████████▋ | 7114/8192 [06:45<00:56, 19.21it/s, est. speed input: 17981.69 toks/s, output: 17.56 toks/s]
Processed prompts:  87%|████████▋ | 7121/8192 [06:45<00:59, 18.15it/s, est. speed input: 17979.58 toks/s, output: 17.56 toks/s]
Processed prompts:  87%|████████▋ | 7128/8192 [06:46<01:01, 17.40it/s, est. speed input: 17977.46 toks/s, output: 17.56 toks/s]
Processed prompts:  87%|████████▋ | 7135/8192 [06:46<01:02, 16.88it/s, est. speed input: 17975.33 toks/s, output: 17.55 toks/s]
Processed prompts:  87%|████████▋ | 7142/8192 [06:46<01:03, 16.52it/s, est. speed input: 17973.23 toks/s, output: 17.55 toks/s]
Processed prompts:  87%|████████▋ | 7149/8192 [06:47<01:04, 16.26it/s, est. speed input: 17971.10 toks/s, output: 17.55 toks/s]
Processed prompts:  87%|████████▋ | 7156/8192 [06:47<01:04, 16.09it/s, est. speed input: 17969.03 toks/s, output: 17.55 toks/s]
Processed prompts:  87%|████████▋ | 7163/8192 [06:48<01:04, 15.96it/s, est. speed input: 17966.91 toks/s, output: 17.55 toks/s]
Processed prompts:  88%|████████▊ | 7170/8192 [06:48<01:04, 15.88it/s, est. speed input: 17964.82 toks/s, output: 17.54 toks/s]
Processed prompts:  88%|████████▊ | 7177/8192 [06:49<01:04, 15.82it/s, est. speed input: 17962.75 toks/s, output: 17.54 toks/s]
Processed prompts:  88%|████████▊ | 7184/8192 [06:49<01:03, 15.78it/s, est. speed input: 17960.67 toks/s, output: 17.54 toks/s]
Processed prompts:  88%|████████▊ | 7191/8192 [06:50<01:03, 15.74it/s, est. speed input: 17958.56 toks/s, output: 17.54 toks/s]
Processed prompts:  88%|████████▊ | 7198/8192 [06:50<01:03, 15.71it/s, est. speed input: 17956.46 toks/s, output: 17.54 toks/s]
Processed prompts:  88%|████████▊ | 7205/8192 [06:50<01:02, 15.70it/s, est. speed input: 17954.36 toks/s, output: 17.53 toks/s]
Processed prompts:  88%|████████▊ | 7212/8192 [06:51<01:02, 15.68it/s, est. speed input: 17952.27 toks/s, output: 17.53 toks/s]
Processed prompts:  88%|████████▊ | 7219/8192 [06:51<01:02, 15.68it/s, est. speed input: 17950.20 toks/s, output: 17.53 toks/s]
Processed prompts:  88%|████████▊ | 7226/8192 [06:52<01:01, 15.67it/s, est. speed input: 17948.12 toks/s, output: 17.53 toks/s]
Processed prompts:  88%|████████▊ | 7233/8192 [06:52<01:01, 15.68it/s, est. speed input: 17946.08 toks/s, output: 17.53 toks/s]
Processed prompts:  88%|████████▊ | 7240/8192 [06:53<01:00, 15.67it/s, est. speed input: 17944.02 toks/s, output: 17.52 toks/s]
Processed prompts:  88%|████████▊ | 7247/8192 [06:53<01:00, 15.68it/s, est. speed input: 17941.99 toks/s, output: 17.52 toks/s]
Processed prompts:  89%|████████▊ | 7254/8192 [06:54<00:59, 15.67it/s, est. speed input: 17939.94 toks/s, output: 17.52 toks/s]
Processed prompts:  89%|████████▊ | 7261/8192 [06:54<00:59, 15.67it/s, est. speed input: 17937.90 toks/s, output: 17.52 toks/s]
Processed prompts:  89%|████████▊ | 7268/8192 [06:54<00:58, 15.67it/s, est. speed input: 17935.84 toks/s, output: 17.52 toks/s]
Processed prompts:  89%|████████▉ | 7275/8192 [06:55<00:58, 15.68it/s, est. speed input: 17933.85 toks/s, output: 17.51 toks/s]
Processed prompts:  89%|████████▉ | 7282/8192 [06:55<00:58, 15.67it/s, est. speed input: 17931.79 toks/s, output: 17.51 toks/s]
Processed prompts:  89%|████████▉ | 7289/8192 [06:56<00:57, 15.67it/s, est. speed input: 17929.79 toks/s, output: 17.51 toks/s]
Processed prompts:  89%|████████▉ | 7296/8192 [06:56<00:57, 15.67it/s, est. speed input: 17927.75 toks/s, output: 17.51 toks/s]
Processed prompts:  89%|████████▉ | 7303/8192 [06:57<00:56, 15.67it/s, est. speed input: 17925.75 toks/s, output: 17.51 toks/s]
Processed prompts:  89%|████████▉ | 7310/8192 [06:57<00:56, 15.67it/s, est. speed input: 17923.73 toks/s, output: 17.50 toks/s]
Processed prompts:  89%|████████▉ | 7317/8192 [06:58<00:55, 15.67it/s, est. speed input: 17921.73 toks/s, output: 17.50 toks/s]
Processed prompts:  89%|████████▉ | 7324/8192 [06:58<00:55, 15.66it/s, est. speed input: 17919.68 toks/s, output: 17.50 toks/s]
Processed prompts:  89%|████████▉ | 7331/8192 [06:58<00:55, 15.65it/s, est. speed input: 17917.62 toks/s, output: 17.50 toks/s]
Processed prompts:  90%|████████▉ | 7338/8192 [06:59<00:54, 15.63it/s, est. speed input: 17915.55 toks/s, output: 17.50 toks/s]
Processed prompts:  90%|████████▉ | 7345/8192 [06:59<00:54, 15.63it/s, est. speed input: 17913.50 toks/s, output: 17.49 toks/s]
Processed prompts:  90%|████████▉ | 7352/8192 [07:00<00:53, 15.62it/s, est. speed input: 17911.44 toks/s, output: 17.49 toks/s]
Processed prompts:  90%|████████▉ | 7359/8192 [07:00<00:53, 15.63it/s, est. speed input: 17909.41 toks/s, output: 17.49 toks/s]
Processed prompts:  90%|████████▉ | 7366/8192 [07:01<00:52, 15.62it/s, est. speed input: 17907.35 toks/s, output: 17.49 toks/s]
Processed prompts:  90%|█████████ | 7373/8192 [07:01<00:52, 15.62it/s, est. speed input: 17905.33 toks/s, output: 17.49 toks/s]
Processed prompts:  90%|█████████ | 7380/8192 [07:02<00:51, 15.62it/s, est. speed input: 17903.30 toks/s, output: 17.48 toks/s]
Processed prompts:  90%|█████████ | 7387/8192 [07:02<00:51, 15.62it/s, est. speed input: 17901.28 toks/s, output: 17.48 toks/s]
Processed prompts:  90%|█████████ | 7394/8192 [07:03<00:51, 15.62it/s, est. speed input: 17899.26 toks/s, output: 17.48 toks/s]
Processed prompts:  90%|█████████ | 7401/8192 [07:03<00:50, 15.62it/s, est. speed input: 17897.23 toks/s, output: 17.48 toks/s]
Processed prompts:  90%|█████████ | 7408/8192 [07:03<00:50, 15.62it/s, est. speed input: 17895.21 toks/s, output: 17.48 toks/s]
Processed prompts:  91%|█████████ | 7415/8192 [07:04<00:49, 15.62it/s, est. speed input: 17893.22 toks/s, output: 17.47 toks/s]
Processed prompts:  91%|█████████ | 7422/8192 [07:04<00:49, 15.64it/s, est. speed input: 17891.28 toks/s, output: 17.47 toks/s]
Processed prompts:  91%|█████████ | 7429/8192 [07:05<00:48, 15.64it/s, est. speed input: 17889.31 toks/s, output: 17.47 toks/s]
Processed prompts:  91%|█████████ | 7436/8192 [07:05<00:48, 15.65it/s, est. speed input: 17887.37 toks/s, output: 17.47 toks/s]
Processed prompts:  91%|█████████ | 7443/8192 [07:06<00:47, 15.65it/s, est. speed input: 17885.40 toks/s, output: 17.47 toks/s]
Processed prompts:  91%|█████████ | 7450/8192 [07:06<00:47, 15.65it/s, est. speed input: 17883.46 toks/s, output: 17.46 toks/s]
Processed prompts:  91%|█████████ | 7457/8192 [07:07<00:46, 15.65it/s, est. speed input: 17881.52 toks/s, output: 17.46 toks/s]
Processed prompts:  91%|█████████ | 7464/8192 [07:07<00:46, 15.66it/s, est. speed input: 17879.60 toks/s, output: 17.46 toks/s]
Processed prompts:  91%|█████████ | 7471/8192 [07:07<00:46, 15.66it/s, est. speed input: 17877.71 toks/s, output: 17.46 toks/s]
Processed prompts:  91%|█████████▏| 7478/8192 [07:08<00:45, 15.66it/s, est. speed input: 17875.76 toks/s, output: 17.46 toks/s]
Processed prompts:  91%|█████████▏| 7485/8192 [07:08<00:45, 15.66it/s, est. speed input: 17873.85 toks/s, output: 17.45 toks/s]
Processed prompts:  91%|█████████▏| 7492/8192 [07:09<00:44, 15.66it/s, est. speed input: 17871.94 toks/s, output: 17.45 toks/s]
Processed prompts:  92%|█████████▏| 7499/8192 [07:09<00:44, 15.66it/s, est. speed input: 17870.03 toks/s, output: 17.45 toks/s]
Processed prompts:  92%|█████████▏| 7506/8192 [07:10<00:43, 15.67it/s, est. speed input: 17868.15 toks/s, output: 17.45 toks/s]
Processed prompts:  92%|█████████▏| 7513/8192 [07:10<00:43, 15.66it/s, est. speed input: 17866.24 toks/s, output: 17.45 toks/s]
Processed prompts:  92%|█████████▏| 7520/8192 [07:11<00:42, 15.66it/s, est. speed input: 17864.35 toks/s, output: 17.45 toks/s]
Processed prompts:  92%|█████████▏| 7527/8192 [07:11<00:42, 15.66it/s, est. speed input: 17862.45 toks/s, output: 17.44 toks/s]
Processed prompts:  92%|█████████▏| 7534/8192 [07:11<00:42, 15.66it/s, est. speed input: 17860.56 toks/s, output: 17.44 toks/s]
Processed prompts:  92%|█████████▏| 7541/8192 [07:12<00:41, 15.67it/s, est. speed input: 17858.69 toks/s, output: 17.44 toks/s]
Processed prompts:  92%|█████████▏| 7548/8192 [07:12<00:41, 15.66it/s, est. speed input: 17856.80 toks/s, output: 17.44 toks/s]
Processed prompts:  92%|█████████▏| 7555/8192 [07:13<00:40, 15.67it/s, est. speed input: 17854.94 toks/s, output: 17.44 toks/s]
Processed prompts:  92%|█████████▏| 7562/8192 [07:13<00:40, 15.66it/s, est. speed input: 17853.06 toks/s, output: 17.43 toks/s]
Processed prompts:  92%|█████████▏| 7569/8192 [07:14<00:39, 15.67it/s, est. speed input: 17851.24 toks/s, output: 17.43 toks/s]
Processed prompts:  93%|█████████▎| 7597/8192 [07:14<00:19, 30.77it/s, est. speed input: 17900.84 toks/s, output: 17.48 toks/s]
Processed prompts:  93%|█████████▎| 7604/8192 [07:15<00:22, 26.15it/s, est. speed input: 17898.96 toks/s, output: 17.48 toks/s]
Processed prompts:  93%|█████████▎| 7611/8192 [07:15<00:25, 22.96it/s, est. speed input: 17897.09 toks/s, output: 17.48 toks/s]
Processed prompts:  93%|█████████▎| 7618/8192 [07:15<00:27, 20.77it/s, est. speed input: 17895.25 toks/s, output: 17.48 toks/s]
Processed prompts:  93%|█████████▎| 7625/8192 [07:16<00:29, 19.24it/s, est. speed input: 17893.39 toks/s, output: 17.47 toks/s]
Processed prompts:  93%|█████████▎| 7632/8192 [07:16<00:30, 18.17it/s, est. speed input: 17891.54 toks/s, output: 17.47 toks/s]
Processed prompts:  93%|█████████▎| 7639/8192 [07:17<00:31, 17.43it/s, est. speed input: 17889.69 toks/s, output: 17.47 toks/s]
Processed prompts:  93%|█████████▎| 7646/8192 [07:17<00:32, 16.91it/s, est. speed input: 17887.85 toks/s, output: 17.47 toks/s]
Processed prompts:  93%|█████████▎| 7653/8192 [07:18<00:32, 16.54it/s, est. speed input: 17885.99 toks/s, output: 17.47 toks/s]
Processed prompts:  94%|█████████▎| 7660/8192 [07:18<00:32, 16.29it/s, est. speed input: 17884.16 toks/s, output: 17.47 toks/s]
Processed prompts:  94%|█████████▎| 7667/8192 [07:19<00:32, 16.11it/s, est. speed input: 17882.32 toks/s, output: 17.46 toks/s]
Processed prompts:  94%|█████████▎| 7674/8192 [07:19<00:32, 15.98it/s, est. speed input: 17880.47 toks/s, output: 17.46 toks/s]
Processed prompts:  94%|█████████▍| 7681/8192 [07:19<00:32, 15.90it/s, est. speed input: 17878.64 toks/s, output: 17.46 toks/s]
Processed prompts:  94%|█████████▍| 7688/8192 [07:20<00:31, 15.84it/s, est. speed input: 17876.81 toks/s, output: 17.46 toks/s]
Processed prompts:  94%|█████████▍| 7695/8192 [07:20<00:31, 15.80it/s, est. speed input: 17875.00 toks/s, output: 17.46 toks/s]
Processed prompts:  94%|█████████▍| 7702/8192 [07:21<00:31, 15.77it/s, est. speed input: 17873.18 toks/s, output: 17.45 toks/s]
Processed prompts:  94%|█████████▍| 7709/8192 [07:21<00:30, 15.75it/s, est. speed input: 17871.38 toks/s, output: 17.45 toks/s]
Processed prompts:  94%|█████████▍| 7716/8192 [07:22<00:30, 15.73it/s, est. speed input: 17869.57 toks/s, output: 17.45 toks/s]
Processed prompts:  94%|█████████▍| 7723/8192 [07:22<00:29, 15.73it/s, est. speed input: 17867.77 toks/s, output: 17.45 toks/s]
Processed prompts:  94%|█████████▍| 7730/8192 [07:23<00:29, 15.71it/s, est. speed input: 17865.95 toks/s, output: 17.45 toks/s]
Processed prompts:  94%|█████████▍| 7737/8192 [07:23<00:29, 15.69it/s, est. speed input: 17864.06 toks/s, output: 17.45 toks/s]
Processed prompts:  95%|█████████▍| 7744/8192 [07:23<00:28, 15.67it/s, est. speed input: 17862.19 toks/s, output: 17.44 toks/s]
Processed prompts:  95%|█████████▍| 7751/8192 [07:24<00:28, 15.65it/s, est. speed input: 17860.29 toks/s, output: 17.44 toks/s]
Processed prompts:  95%|█████████▍| 7758/8192 [07:24<00:27, 15.64it/s, est. speed input: 17858.41 toks/s, output: 17.44 toks/s]
Processed prompts:  95%|█████████▍| 7765/8192 [07:25<00:27, 15.63it/s, est. speed input: 17856.52 toks/s, output: 17.44 toks/s]
Processed prompts:  95%|█████████▍| 7772/8192 [07:25<00:26, 15.62it/s, est. speed input: 17854.63 toks/s, output: 17.44 toks/s]
Processed prompts:  95%|█████████▍| 7779/8192 [07:26<00:26, 15.63it/s, est. speed input: 17852.77 toks/s, output: 17.43 toks/s]
Processed prompts:  95%|█████████▌| 7786/8192 [07:26<00:25, 15.63it/s, est. speed input: 17850.92 toks/s, output: 17.43 toks/s]
Processed prompts:  95%|█████████▌| 7793/8192 [07:27<00:25, 15.63it/s, est. speed input: 17849.08 toks/s, output: 17.43 toks/s]
Processed prompts:  95%|█████████▌| 7800/8192 [07:27<00:25, 15.63it/s, est. speed input: 17847.22 toks/s, output: 17.43 toks/s]
Processed prompts:  95%|█████████▌| 7807/8192 [07:27<00:24, 15.62it/s, est. speed input: 17845.36 toks/s, output: 17.43 toks/s]
Processed prompts:  95%|█████████▌| 7814/8192 [07:28<00:24, 15.62it/s, est. speed input: 17843.51 toks/s, output: 17.43 toks/s]
Processed prompts:  95%|█████████▌| 7821/8192 [07:28<00:23, 15.62it/s, est. speed input: 17841.65 toks/s, output: 17.42 toks/s]
Processed prompts:  96%|█████████▌| 7828/8192 [07:29<00:23, 15.63it/s, est. speed input: 17839.85 toks/s, output: 17.42 toks/s]
Processed prompts:  96%|█████████▌| 7835/8192 [07:29<00:22, 15.63it/s, est. speed input: 17838.01 toks/s, output: 17.42 toks/s]
Processed prompts:  96%|█████████▌| 7842/8192 [07:30<00:22, 15.63it/s, est. speed input: 17836.18 toks/s, output: 17.42 toks/s]
Processed prompts:  96%|█████████▌| 7849/8192 [07:30<00:21, 15.63it/s, est. speed input: 17834.37 toks/s, output: 17.42 toks/s]
Processed prompts:  96%|█████████▌| 7856/8192 [07:31<00:21, 15.63it/s, est. speed input: 17832.54 toks/s, output: 17.41 toks/s]
Processed prompts:  96%|█████████▌| 7863/8192 [07:31<00:21, 15.63it/s, est. speed input: 17830.75 toks/s, output: 17.41 toks/s]
Processed prompts:  96%|█████████▌| 7870/8192 [07:32<00:20, 15.62it/s, est. speed input: 17828.91 toks/s, output: 17.41 toks/s]
Processed prompts:  96%|█████████▌| 7877/8192 [07:32<00:20, 15.63it/s, est. speed input: 17827.13 toks/s, output: 17.41 toks/s]
Processed prompts:  96%|█████████▌| 7884/8192 [07:32<00:19, 15.63it/s, est. speed input: 17825.31 toks/s, output: 17.41 toks/s]
Processed prompts:  96%|█████████▋| 7891/8192 [07:33<00:19, 15.63it/s, est. speed input: 17823.53 toks/s, output: 17.41 toks/s]
Processed prompts:  96%|█████████▋| 7898/8192 [07:33<00:18, 15.63it/s, est. speed input: 17821.72 toks/s, output: 17.40 toks/s]
Processed prompts:  96%|█████████▋| 7905/8192 [07:34<00:18, 15.63it/s, est. speed input: 17819.92 toks/s, output: 17.40 toks/s]
Processed prompts:  97%|█████████▋| 7912/8192 [07:34<00:17, 15.63it/s, est. speed input: 17818.15 toks/s, output: 17.40 toks/s]
Processed prompts:  97%|█████████▋| 7919/8192 [07:35<00:17, 15.63it/s, est. speed input: 17816.35 toks/s, output: 17.40 toks/s]
Processed prompts:  97%|█████████▋| 7926/8192 [07:35<00:17, 15.62it/s, est. speed input: 17814.55 toks/s, output: 17.40 toks/s]
Processed prompts:  97%|█████████▋| 7933/8192 [07:36<00:16, 15.62it/s, est. speed input: 17812.74 toks/s, output: 17.40 toks/s]
Processed prompts:  97%|█████████▋| 7940/8192 [07:36<00:16, 15.62it/s, est. speed input: 17810.95 toks/s, output: 17.39 toks/s]
Processed prompts:  97%|█████████▋| 7947/8192 [07:36<00:15, 15.62it/s, est. speed input: 17809.19 toks/s, output: 17.39 toks/s]
Processed prompts:  97%|█████████▋| 7954/8192 [07:37<00:15, 15.62it/s, est. speed input: 17807.40 toks/s, output: 17.39 toks/s]
Processed prompts:  97%|█████████▋| 7961/8192 [07:37<00:14, 15.63it/s, est. speed input: 17805.65 toks/s, output: 17.39 toks/s]
Processed prompts:  97%|█████████▋| 7968/8192 [07:38<00:14, 15.62it/s, est. speed input: 17803.88 toks/s, output: 17.39 toks/s]
Processed prompts:  97%|█████████▋| 7975/8192 [07:38<00:13, 15.62it/s, est. speed input: 17802.12 toks/s, output: 17.38 toks/s]
Processed prompts:  97%|█████████▋| 7982/8192 [07:39<00:13, 15.63it/s, est. speed input: 17800.37 toks/s, output: 17.38 toks/s]
Processed prompts:  98%|█████████▊| 7989/8192 [07:39<00:12, 15.65it/s, est. speed input: 17798.68 toks/s, output: 17.38 toks/s]
Processed prompts:  98%|█████████▊| 7996/8192 [07:40<00:12, 15.65it/s, est. speed input: 17796.98 toks/s, output: 17.38 toks/s]
Processed prompts:  98%|█████████▊| 8003/8192 [07:40<00:12, 15.66it/s, est. speed input: 17795.28 toks/s, output: 17.38 toks/s]
Processed prompts:  98%|█████████▊| 8010/8192 [07:40<00:11, 15.67it/s, est. speed input: 17793.60 toks/s, output: 17.38 toks/s]
Processed prompts:  98%|█████████▊| 8017/8192 [07:41<00:11, 15.66it/s, est. speed input: 17791.90 toks/s, output: 17.37 toks/s]
Processed prompts:  98%|█████████▊| 8024/8192 [07:41<00:10, 15.68it/s, est. speed input: 17790.25 toks/s, output: 17.37 toks/s]
Processed prompts:  98%|█████████▊| 8031/8192 [07:42<00:10, 15.67it/s, est. speed input: 17788.56 toks/s, output: 17.37 toks/s]
Processed prompts:  98%|█████████▊| 8038/8192 [07:42<00:09, 15.68it/s, est. speed input: 17786.90 toks/s, output: 17.37 toks/s]
Processed prompts:  98%|█████████▊| 8045/8192 [07:43<00:09, 15.68it/s, est. speed input: 17785.22 toks/s, output: 17.37 toks/s]
Processed prompts:  98%|█████████▊| 8052/8192 [07:43<00:08, 15.67it/s, est. speed input: 17783.52 toks/s, output: 17.37 toks/s]
Processed prompts:  98%|█████████▊| 8059/8192 [07:44<00:08, 15.66it/s, est. speed input: 17781.83 toks/s, output: 17.37 toks/s]
Processed prompts:  98%|█████████▊| 8066/8192 [07:44<00:08, 15.66it/s, est. speed input: 17780.14 toks/s, output: 17.36 toks/s]
Processed prompts:  99%|█████████▊| 8073/8192 [07:44<00:07, 15.66it/s, est. speed input: 17778.47 toks/s, output: 17.36 toks/s]
Processed prompts:  99%|█████████▊| 8080/8192 [07:45<00:07, 15.66it/s, est. speed input: 17776.80 toks/s, output: 17.36 toks/s]
Processed prompts:  99%|█████████▉| 8108/8192 [07:45<00:02, 31.27it/s, est. speed input: 17824.04 toks/s, output: 17.41 toks/s]
Processed prompts:  99%|█████████▉| 8115/8192 [07:46<00:02, 26.43it/s, est. speed input: 17822.33 toks/s, output: 17.40 toks/s]
Processed prompts:  99%|█████████▉| 8122/8192 [07:46<00:03, 23.13it/s, est. speed input: 17820.64 toks/s, output: 17.40 toks/s]
Processed prompts:  99%|█████████▉| 8129/8192 [07:47<00:03, 20.87it/s, est. speed input: 17819.00 toks/s, output: 17.40 toks/s]
Processed prompts:  99%|█████████▉| 8136/8192 [07:47<00:02, 19.37it/s, est. speed input: 17817.52 toks/s, output: 17.40 toks/s]
Processed prompts:  99%|█████████▉| 8143/8192 [07:48<00:02, 18.31it/s, est. speed input: 17816.03 toks/s, output: 17.40 toks/s]
Processed prompts:  99%|█████████▉| 8150/8192 [07:48<00:02, 17.58it/s, est. speed input: 17814.55 toks/s, output: 17.40 toks/s]
Processed prompts: 100%|█████████▉| 8157/8192 [07:48<00:02, 17.06it/s, est. speed input: 17813.07 toks/s, output: 17.40 toks/s]
Processed prompts: 100%|█████████▉| 8164/8192 [07:49<00:01, 16.70it/s, est. speed input: 17811.58 toks/s, output: 17.39 toks/s]
Processed prompts: 100%|█████████▉| 8171/8192 [07:49<00:01, 16.45it/s, est. speed input: 17810.12 toks/s, output: 17.39 toks/s]
Processed prompts: 100%|█████████▉| 8178/8192 [07:50<00:00, 16.27it/s, est. speed input: 17808.65 toks/s, output: 17.39 toks/s]
Processed prompts: 100%|█████████▉| 8185/8192 [07:50<00:00, 16.16it/s, est. speed input: 17807.22 toks/s, output: 17.39 toks/s]
Processed prompts: 100%|██████████| 8192/8192 [07:50<00:00, 16.16it/s, est. speed input: 17819.89 toks/s, output: 17.40 toks/s]
Processed prompts: 100%|██████████| 8192/8192 [07:50<00:00, 17.40it/s, est. speed input: 17819.89 toks/s, output: 17.40 toks/s]
[rank0]:[W126 03:38:36.114212866 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 620.1s

测试结果:
  Requests/s:   15.67
  Tokens/s:     16062.00
  Total Reqs:   8192
  Elapsed:      522.77s

  [Prefill 分析]
  Total Prefill Tokens: 8388608
  Prefill Tokens/s:     16046.33


------------------------------------------------------------
  生成 CSV: Qwen2.5-7B-FP8
------------------------------------------------------------
[SUCCESS] CSV 保存到: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cublaslt/Qwen2.5-7B-FP8_prefill.csv

预览:
------------------------------------------------------------
M_prefill,prompt_len,max_num_seqs,num_prompts,N_prefill,requests_per_s,tokens_per_s,elapsed_time_s
512,512,1,128,128,16.1829,8301.8495,7.9096
1024,1024,1,128,128,14.7352,15103.5627,8.6867
2048,1024,2,256,128,15.5244,15912.5278,16.4902
4096,1024,4,512,128,16.0548,16456.1452,31.8908
8192,1024,8,1024,128,15.9258,16323.9802,64.2980
16384,1024,16,2048,128,15.6357,16026.5712,130.9825
32768,1024,32,4096,128,15.8274,16223.0564,258.7922
65536,1024,64,8192,128,15.6702,16061.9987,522.7743

------------------------------------------------------------

[INFO] 完成: 8 成功, 0 失败

============================================================
  Qwen2.5-7B-FP8 | cuSPARSELt (2_4) | prefill
============================================================

[INFO] Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-FP8-SlideSparse-2_4
[INFO] Output: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_4

============================================================
[1/8] 测试 M=512
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 512
│   M_prefill     = 512 (= 1 x 512)
│   M_decode      = 1
│   batched_tokens = 513 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 512
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 513
│   --max-num-batched-tokens = 513
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 03:38:47 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 03:38:48 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=128142) WARNING 01-26 03:38:56 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=128142) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=128142) WARNING 01-26 03:39:12 [backends.py:609] Failed to read file <frozen os>
Throughput: 16.42 requests/s, 8425.66 total tokens/s, 16.42 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128


─── STDERR ───
[2026-01-26 03:38:47] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:38:47] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:38:47] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:38:47] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:38:47] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:38:47] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:38:47] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:38:47] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:38:47] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:38:47] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:38:47] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:38:47] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:38:47] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:38:47] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 03:38:55] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:38:55] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:38:55] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:38:55] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:38:55] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:38:55] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:38:55] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:38:55] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:38:55] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:38:55] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:38:55] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:38:55] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:38:55] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:38:55] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=128142) [2026-01-26 03:38:56] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=128142) [2026-01-26 03:38:56] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=128142) [2026-01-26 03:38:56] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=128142) [2026-01-26 03:38:56] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=128142) [2026-01-26 03:38:56] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=128142) [2026-01-26 03:38:56] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=128142) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=128142) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:02<00:02,  2.97s/it]
(EngineCore_DP0 pid=128142) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:05<00:00,  2.65s/it]
(EngineCore_DP0 pid=128142) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:05<00:00,  2.70s/it]
(EngineCore_DP0 pid=128142) 
(EngineCore_DP0 pid=128142) [2026-01-26 03:39:02] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 3584] -> 1D uint8
(EngineCore_DP0 pid=128142) [2026-01-26 03:39:02] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12386304 bytes
(EngineCore_DP0 pid=128142) [2026-01-26 03:39:02] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 3584] -> 1D uint8
(EngineCore_DP0 pid=128142) [2026-01-26 03:39:02] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 9633792 bytes
(EngineCore_DP0 pid=128142) [2026-01-26 03:39:02] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 3584] -> 1D uint8
(EngineCore_DP0 pid=128142) [2026-01-26 03:39:02] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 101842944 bytes
(EngineCore_DP0 pid=128142) [2026-01-26 03:39:02] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 18944] -> 1D uint8
(EngineCore_DP0 pid=128142) [2026-01-26 03:39:02] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 50921472 bytes
(EngineCore_DP0 pid=128142) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  2.60it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  2.60it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  2.60it/s]
(EngineCore_DP0 pid=128142) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.39it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.38it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  35%|███▌      | 45/128 [00:00<00:00, 448.78it/s]
Adding requests:  72%|███████▏  | 92/128 [00:00<00:00, 461.13it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 460.20it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:26,  4.81it/s, est. speed input: 2460.94 toks/s, output: 4.81 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:12, 10.20it/s, est. speed input: 4697.10 toks/s, output: 9.17 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:09, 12.84it/s, est. speed input: 5754.97 toks/s, output: 11.24 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:08, 14.26it/s, est. speed input: 6356.44 toks/s, output: 12.41 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:00<00:07, 15.20it/s, est. speed input: 6764.72 toks/s, output: 13.21 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:00<00:07, 15.83it/s, est. speed input: 7059.40 toks/s, output: 13.79 toks/s]
Processed prompts:  10%|█         | 13/128 [00:00<00:07, 16.19it/s, est. speed input: 7269.28 toks/s, output: 14.20 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:01<00:06, 16.46it/s, est. speed input: 7435.74 toks/s, output: 14.52 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:01<00:06, 16.75it/s, est. speed input: 7583.07 toks/s, output: 14.81 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:01<00:06, 17.03it/s, est. speed input: 7714.84 toks/s, output: 15.07 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:01<00:06, 17.18it/s, est. speed input: 7819.95 toks/s, output: 15.27 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:01<00:06, 17.32it/s, est. speed input: 7912.39 toks/s, output: 15.45 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:01<00:05, 17.38it/s, est. speed input: 7987.58 toks/s, output: 15.60 toks/s]
Processed prompts:  21%|██        | 27/128 [00:01<00:05, 17.35it/s, est. speed input: 8045.27 toks/s, output: 15.71 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:01<00:05, 17.34it/s, est. speed input: 8097.10 toks/s, output: 15.81 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:01<00:00, 74.25it/s, est. speed input: 14230.68 toks/s, output: 27.79 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:02<00:01, 41.56it/s, est. speed input: 13369.24 toks/s, output: 26.11 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:02<00:01, 31.29it/s, est. speed input: 12783.40 toks/s, output: 24.97 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:03<00:02, 26.82it/s, est. speed input: 12430.99 toks/s, output: 24.28 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:03<00:02, 24.35it/s, est. speed input: 12197.50 toks/s, output: 23.82 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:03<00:02, 22.87it/s, est. speed input: 12043.55 toks/s, output: 23.52 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:03<00:02, 21.62it/s, est. speed input: 11903.38 toks/s, output: 23.25 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:03<00:02, 20.43it/s, est. speed input: 11757.35 toks/s, output: 22.96 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:03<00:01, 19.53it/s, est. speed input: 11624.81 toks/s, output: 22.70 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:04<00:01, 18.88it/s, est. speed input: 11505.01 toks/s, output: 22.47 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:04<00:01, 18.57it/s, est. speed input: 11434.15 toks/s, output: 22.33 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:04<00:01, 18.29it/s, est. speed input: 11366.40 toks/s, output: 22.20 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:04<00:01, 18.07it/s, est. speed input: 11303.01 toks/s, output: 22.08 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:04<00:01, 17.88it/s, est. speed input: 11241.44 toks/s, output: 21.96 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:04<00:01, 17.63it/s, est. speed input: 11176.81 toks/s, output: 21.83 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:04<00:01, 17.45it/s, est. speed input: 11116.34 toks/s, output: 21.71 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:04<00:01, 17.50it/s, est. speed input: 11067.60 toks/s, output: 21.62 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:05<00:01, 17.57it/s, est. speed input: 11023.05 toks/s, output: 21.53 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:05<00:01, 17.61it/s, est. speed input: 10979.90 toks/s, output: 21.45 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:05<00:00, 17.66it/s, est. speed input: 10939.98 toks/s, output: 21.37 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:05<00:00, 17.62it/s, est. speed input: 10898.12 toks/s, output: 21.29 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:05<00:00, 17.60it/s, est. speed input: 10858.04 toks/s, output: 21.21 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:05<00:00, 17.60it/s, est. speed input: 10820.65 toks/s, output: 21.13 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:05<00:00, 17.59it/s, est. speed input: 10783.93 toks/s, output: 21.06 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:05<00:00, 17.47it/s, est. speed input: 10744.51 toks/s, output: 20.99 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:05<00:00, 17.34it/s, est. speed input: 10704.52 toks/s, output: 20.91 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:06<00:00, 17.42it/s, est. speed input: 10672.73 toks/s, output: 20.85 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:06<00:00, 17.49it/s, est. speed input: 10642.61 toks/s, output: 20.79 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:06<00:00, 17.49it/s, est. speed input: 10642.61 toks/s, output: 20.79 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:06<00:00, 20.79it/s, est. speed input: 10642.61 toks/s, output: 20.79 toks/s]
[rank0]:[W126 03:39:37.771842194 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 60.8s

测试结果:
  Requests/s:   16.42
  Tokens/s:     8425.66
  Total Reqs:   128
  Elapsed:      7.79s

  [Prefill 分析]
  Total Prefill Tokens: 65536
  Prefill Tokens/s:     8409.24

============================================================
[2/8] 测试 M=1024
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 1024
│   M_prefill     = 1024 (= 1 x 1024)
│   M_decode      = 1
│   batched_tokens = 1025 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 1025
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 03:39:48 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 03:39:49 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=129304) WARNING 01-26 03:39:57 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=129304) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=129304) WARNING 01-26 03:40:08 [backends.py:609] Failed to read file <frozen os>
Throughput: 16.27 requests/s, 16673.82 total tokens/s, 16.27 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128


─── STDERR ───
[2026-01-26 03:39:48] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:39:48] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:39:48] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:39:48] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:39:48] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:39:48] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:39:48] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:39:48] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:39:48] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:39:48] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:39:48] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:39:48] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:39:48] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:39:48] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 03:39:56] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:39:56] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:39:56] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:39:56] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:39:56] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:39:56] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:39:56] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:39:56] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:39:56] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:39:56] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:39:56] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:39:56] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:39:56] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:39:56] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=129304) [2026-01-26 03:39:57] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=129304) [2026-01-26 03:39:57] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=129304) [2026-01-26 03:39:57] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=129304) [2026-01-26 03:39:57] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=129304) [2026-01-26 03:39:57] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=129304) [2026-01-26 03:39:57] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=129304) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=129304) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.42it/s]
(EngineCore_DP0 pid=129304) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.06it/s]
(EngineCore_DP0 pid=129304) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.10it/s]
(EngineCore_DP0 pid=129304) 
(EngineCore_DP0 pid=129304) [2026-01-26 03:40:00] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 3584] -> 1D uint8
(EngineCore_DP0 pid=129304) [2026-01-26 03:40:00] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12386304 bytes
(EngineCore_DP0 pid=129304) [2026-01-26 03:40:00] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 3584] -> 1D uint8
(EngineCore_DP0 pid=129304) [2026-01-26 03:40:00] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 9633792 bytes
(EngineCore_DP0 pid=129304) [2026-01-26 03:40:00] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 3584] -> 1D uint8
(EngineCore_DP0 pid=129304) [2026-01-26 03:40:00] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 101842944 bytes
(EngineCore_DP0 pid=129304) [2026-01-26 03:40:00] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 18944] -> 1D uint8
(EngineCore_DP0 pid=129304) [2026-01-26 03:40:00] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 50921472 bytes
(EngineCore_DP0 pid=129304) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  4.65it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  6.21it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  5.91it/s]
(EngineCore_DP0 pid=129304) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.41it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.40it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  19%|█▉        | 24/128 [00:00<00:00, 239.82it/s]
Adding requests:  38%|███▊      | 49/128 [00:00<00:00, 244.01it/s]
Adding requests:  59%|█████▉    | 76/128 [00:00<00:00, 255.11it/s]
Adding requests:  80%|████████  | 103/128 [00:00<00:00, 256.88it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 251.03it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:03, 39.21it/s, est. speed input: 40163.98 toks/s, output: 39.22 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:00<00:05, 23.42it/s, est. speed input: 25707.28 toks/s, output: 25.10 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:00<00:05, 20.70it/s, est. speed input: 23061.23 toks/s, output: 22.52 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:00<00:05, 19.28it/s, est. speed input: 21663.03 toks/s, output: 21.15 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:00<00:05, 18.46it/s, est. speed input: 20814.07 toks/s, output: 20.33 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:01<00:05, 18.13it/s, est. speed input: 20432.67 toks/s, output: 19.95 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:01<00:05, 17.77it/s, est. speed input: 20088.80 toks/s, output: 19.62 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:01<00:05, 17.51it/s, est. speed input: 19817.28 toks/s, output: 19.35 toks/s]
Processed prompts:  20%|██        | 26/128 [00:01<00:05, 17.43it/s, est. speed input: 19628.38 toks/s, output: 19.17 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:01<00:05, 17.33it/s, est. speed input: 19460.47 toks/s, output: 19.00 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:01<00:05, 17.21it/s, est. speed input: 19301.77 toks/s, output: 18.85 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:01<00:05, 17.13it/s, est. speed input: 19166.20 toks/s, output: 18.72 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:01<00:05, 17.11it/s, est. speed input: 19057.71 toks/s, output: 18.61 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:01<00:05, 17.10it/s, est. speed input: 18963.74 toks/s, output: 18.52 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:02<00:05, 17.12it/s, est. speed input: 18885.18 toks/s, output: 18.44 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:02<00:05, 17.05it/s, est. speed input: 18798.88 toks/s, output: 18.36 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:02<00:05, 17.02it/s, est. speed input: 18725.00 toks/s, output: 18.29 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:02<00:04, 17.06it/s, est. speed input: 18668.71 toks/s, output: 18.23 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:02<00:04, 17.12it/s, est. speed input: 18623.65 toks/s, output: 18.19 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:02<00:04, 17.10it/s, est. speed input: 18571.94 toks/s, output: 18.14 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:02<00:04, 17.02it/s, est. speed input: 18514.90 toks/s, output: 18.08 toks/s]
Processed prompts:  41%|████      | 52/128 [00:02<00:04, 16.95it/s, est. speed input: 18460.10 toks/s, output: 18.03 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:03<00:04, 17.03it/s, est. speed input: 18428.39 toks/s, output: 18.00 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:03<00:04, 17.02it/s, est. speed input: 18389.31 toks/s, output: 17.96 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:03<00:04, 16.94it/s, est. speed input: 18344.39 toks/s, output: 17.91 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:03<00:04, 16.93it/s, est. speed input: 18308.27 toks/s, output: 17.88 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:03<00:03, 16.94it/s, est. speed input: 18276.02 toks/s, output: 17.85 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:03<00:03, 16.97it/s, est. speed input: 18248.98 toks/s, output: 17.82 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:03<00:03, 16.97it/s, est. speed input: 18220.85 toks/s, output: 17.79 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:03<00:03, 16.94it/s, est. speed input: 18192.27 toks/s, output: 17.77 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:03<00:03, 16.98it/s, est. speed input: 18170.95 toks/s, output: 17.74 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:04<00:03, 17.06it/s, est. speed input: 18156.70 toks/s, output: 17.73 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:04<00:03, 17.10it/s, est. speed input: 18141.09 toks/s, output: 17.72 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:04<00:03, 17.08it/s, est. speed input: 18122.00 toks/s, output: 17.70 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:04<00:02, 17.04it/s, est. speed input: 18101.36 toks/s, output: 17.68 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:04<00:02, 17.08it/s, est. speed input: 18088.60 toks/s, output: 17.66 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:04<00:02, 17.11it/s, est. speed input: 18075.69 toks/s, output: 17.65 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:04<00:02, 17.02it/s, est. speed input: 18054.30 toks/s, output: 17.63 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:04<00:02, 17.00it/s, est. speed input: 18037.35 toks/s, output: 17.61 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:05<00:02, 16.95it/s, est. speed input: 18018.68 toks/s, output: 17.60 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:05<00:02, 16.96it/s, est. speed input: 18004.09 toks/s, output: 17.58 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:05<00:02, 17.03it/s, est. speed input: 17995.35 toks/s, output: 17.57 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:05<00:01, 17.06it/s, est. speed input: 17985.13 toks/s, output: 17.56 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:05<00:01, 16.98it/s, est. speed input: 17967.96 toks/s, output: 17.55 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:05<00:01, 16.95it/s, est. speed input: 17953.64 toks/s, output: 17.53 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:05<00:01, 16.90it/s, est. speed input: 17937.89 toks/s, output: 17.52 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:05<00:01, 16.92it/s, est. speed input: 17926.09 toks/s, output: 17.51 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:05<00:01, 17.01it/s, est. speed input: 17920.40 toks/s, output: 17.50 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:06<00:01, 17.08it/s, est. speed input: 17915.58 toks/s, output: 17.50 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:06<00:01, 17.14it/s, est. speed input: 17911.66 toks/s, output: 17.49 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:06<00:01, 17.20it/s, est. speed input: 17908.91 toks/s, output: 17.49 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:06<00:00, 17.10it/s, est. speed input: 17896.90 toks/s, output: 17.48 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:06<00:00, 16.97it/s, est. speed input: 17881.74 toks/s, output: 17.46 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:06<00:00, 16.92it/s, est. speed input: 17870.06 toks/s, output: 17.45 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:06<00:00, 16.87it/s, est. speed input: 17857.38 toks/s, output: 17.44 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:06<00:00, 16.83it/s, est. speed input: 17845.05 toks/s, output: 17.43 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:07<00:00, 16.78it/s, est. speed input: 17831.53 toks/s, output: 17.41 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:07<00:00, 16.84it/s, est. speed input: 17823.94 toks/s, output: 17.41 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:07<00:00, 16.93it/s, est. speed input: 17819.74 toks/s, output: 17.40 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 17.00it/s, est. speed input: 17815.82 toks/s, output: 17.40 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 17.00it/s, est. speed input: 17815.82 toks/s, output: 17.40 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 17.40it/s, est. speed input: 17815.82 toks/s, output: 17.40 toks/s]
[rank0]:[W126 03:40:34.171431548 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 55.7s

测试结果:
  Requests/s:   16.27
  Tokens/s:     16673.82
  Total Reqs:   128
  Elapsed:      7.87s

  [Prefill 分析]
  Total Prefill Tokens: 131072
  Prefill Tokens/s:     16657.55

============================================================
[3/8] 测试 M=2048
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 2048
│   M_prefill     = 2048 (= 2 x 1024)
│   M_decode      = 2
│   batched_tokens = 2048 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 256
│   --max-num-seqs           = 2
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 2048
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 03:40:45 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 03:40:46 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=130325) WARNING 01-26 03:40:53 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=130325) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=130325) WARNING 01-26 03:41:06 [backends.py:609] Failed to read file <frozen os>
Throughput: 23.03 requests/s, 23607.83 total tokens/s, 23.03 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256


─── STDERR ───
[2026-01-26 03:40:45] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:40:45] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:40:45] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:40:45] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:40:45] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:40:45] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:40:45] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:40:45] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:40:45] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:40:45] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:40:45] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:40:45] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:40:45] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:40:45] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 03:40:53] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:40:53] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:40:53] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:40:53] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:40:53] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:40:53] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:40:53] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:40:53] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:40:53] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:40:53] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:40:53] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:40:53] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:40:53] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:40:53] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=130325) [2026-01-26 03:40:54] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=130325) [2026-01-26 03:40:54] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=130325) [2026-01-26 03:40:54] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=130325) [2026-01-26 03:40:54] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=130325) [2026-01-26 03:40:54] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=130325) [2026-01-26 03:40:54] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=130325) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=130325) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.41it/s]
(EngineCore_DP0 pid=130325) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.13it/s]
(EngineCore_DP0 pid=130325) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.17it/s]
(EngineCore_DP0 pid=130325) 
(EngineCore_DP0 pid=130325) [2026-01-26 03:40:56] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 3584] -> 1D uint8
(EngineCore_DP0 pid=130325) [2026-01-26 03:40:56] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12386304 bytes
(EngineCore_DP0 pid=130325) [2026-01-26 03:40:56] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 3584] -> 1D uint8
(EngineCore_DP0 pid=130325) [2026-01-26 03:40:56] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 9633792 bytes
(EngineCore_DP0 pid=130325) [2026-01-26 03:40:56] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 3584] -> 1D uint8
(EngineCore_DP0 pid=130325) [2026-01-26 03:40:56] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 101842944 bytes
(EngineCore_DP0 pid=130325) [2026-01-26 03:40:56] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 18944] -> 1D uint8
(EngineCore_DP0 pid=130325) [2026-01-26 03:40:56] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 50921472 bytes
(EngineCore_DP0 pid=130325) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  33%|███▎      | 1/3 [00:00<00:00,  7.36it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  67%|██████▋   | 2/3 [00:00<00:00,  5.72it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00,  5.86it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00,  5.96it/s]
(EngineCore_DP0 pid=130325) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 1/2 [00:00<00:00,  7.19it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  8.48it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  8.25it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:   9%|▉         | 23/256 [00:00<00:01, 228.53it/s]
Adding requests:  19%|█▉        | 49/256 [00:00<00:00, 245.48it/s]
Adding requests:  30%|███       | 77/256 [00:00<00:00, 259.42it/s]
Adding requests:  40%|████      | 103/256 [00:00<00:00, 258.14it/s]
Adding requests:  50%|█████     | 129/256 [00:00<00:00, 258.67it/s]
Adding requests:  61%|██████    | 156/256 [00:00<00:00, 261.20it/s]
Adding requests:  71%|███████▏  | 183/256 [00:00<00:00, 262.24it/s]
Adding requests:  82%|████████▏ | 210/256 [00:00<00:00, 260.53it/s]
Adding requests:  93%|█████████▎| 237/256 [00:00<00:00, 259.26it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 257.34it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   8%|▊         | 20/256 [00:00<00:01, 170.54it/s, est. speed input: 174673.11 toks/s, output: 170.55 toks/s]
Processed prompts:  15%|█▍        | 38/256 [00:00<00:05, 37.73it/s, est. speed input: 44057.52 toks/s, output: 43.02 toks/s]   
Processed prompts:  18%|█▊        | 47/256 [00:01<00:06, 33.63it/s, est. speed input: 39342.82 toks/s, output: 38.42 toks/s]
Processed prompts:  21%|██        | 53/256 [00:01<00:06, 30.80it/s, est. speed input: 36718.47 toks/s, output: 35.86 toks/s]
Processed prompts:  23%|██▎       | 58/256 [00:01<00:07, 27.63it/s, est. speed input: 34287.53 toks/s, output: 33.48 toks/s]
Processed prompts:  24%|██▍       | 62/256 [00:01<00:07, 26.75it/s, est. speed input: 33380.57 toks/s, output: 32.60 toks/s]
Processed prompts:  26%|██▌       | 66/256 [00:02<00:07, 26.01it/s, est. speed input: 32622.49 toks/s, output: 31.86 toks/s]
Processed prompts:  27%|██▋       | 70/256 [00:02<00:07, 25.39it/s, est. speed input: 31978.87 toks/s, output: 31.23 toks/s]
Processed prompts:  29%|██▉       | 74/256 [00:02<00:07, 24.90it/s, est. speed input: 31420.85 toks/s, output: 30.68 toks/s]
Processed prompts:  30%|███       | 78/256 [00:02<00:07, 24.50it/s, est. speed input: 30932.71 toks/s, output: 30.21 toks/s]
Processed prompts:  32%|███▏      | 82/256 [00:02<00:07, 24.24it/s, est. speed input: 30513.98 toks/s, output: 29.80 toks/s]
Processed prompts:  34%|███▎      | 86/256 [00:02<00:07, 24.02it/s, est. speed input: 30135.84 toks/s, output: 29.43 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:03<00:06, 23.84it/s, est. speed input: 29795.45 toks/s, output: 29.10 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:03<00:06, 23.70it/s, est. speed input: 29487.99 toks/s, output: 28.80 toks/s]
Processed prompts:  38%|███▊      | 98/256 [00:03<00:06, 23.62it/s, est. speed input: 29214.24 toks/s, output: 28.53 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:03<00:06, 23.59it/s, est. speed input: 28972.67 toks/s, output: 28.29 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:03<00:06, 23.58it/s, est. speed input: 28753.19 toks/s, output: 28.08 toks/s]
Processed prompts:  43%|████▎     | 110/256 [00:03<00:06, 23.57it/s, est. speed input: 28554.27 toks/s, output: 27.88 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:04<00:06, 23.57it/s, est. speed input: 28371.15 toks/s, output: 27.71 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:04<00:05, 23.57it/s, est. speed input: 28203.17 toks/s, output: 27.54 toks/s]
Processed prompts:  48%|████▊     | 122/256 [00:04<00:05, 23.58it/s, est. speed input: 28049.37 toks/s, output: 27.39 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:04<00:05, 23.54it/s, est. speed input: 27900.90 toks/s, output: 27.25 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:04<00:05, 23.54it/s, est. speed input: 27766.67 toks/s, output: 27.12 toks/s]
Processed prompts:  52%|█████▏    | 134/256 [00:04<00:05, 23.53it/s, est. speed input: 27639.34 toks/s, output: 26.99 toks/s]
Processed prompts:  54%|█████▍    | 138/256 [00:05<00:05, 23.51it/s, est. speed input: 27519.12 toks/s, output: 26.87 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:05<00:04, 23.49it/s, est. speed input: 27406.62 toks/s, output: 26.76 toks/s]
Processed prompts:  57%|█████▋    | 146/256 [00:05<00:04, 23.51it/s, est. speed input: 27305.07 toks/s, output: 26.67 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:05<00:04, 23.50it/s, est. speed input: 27206.84 toks/s, output: 26.57 toks/s]
Processed prompts:  60%|██████    | 154/256 [00:05<00:04, 23.49it/s, est. speed input: 27112.90 toks/s, output: 26.48 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:05<00:04, 23.46it/s, est. speed input: 27022.57 toks/s, output: 26.39 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:06<00:04, 23.44it/s, est. speed input: 26937.43 toks/s, output: 26.31 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:06<00:03, 23.44it/s, est. speed input: 26858.03 toks/s, output: 26.23 toks/s]
Processed prompts:  66%|██████▋   | 170/256 [00:06<00:03, 23.41it/s, est. speed input: 26780.71 toks/s, output: 26.15 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:06<00:03, 23.41it/s, est. speed input: 26708.20 toks/s, output: 26.08 toks/s]
Processed prompts:  70%|██████▉   | 178/256 [00:06<00:03, 23.41it/s, est. speed input: 26639.60 toks/s, output: 26.02 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:07<00:03, 23.43it/s, est. speed input: 26576.52 toks/s, output: 25.95 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:07<00:02, 23.42it/s, est. speed input: 26514.30 toks/s, output: 25.89 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:07<00:02, 23.42it/s, est. speed input: 26455.18 toks/s, output: 25.84 toks/s]
Processed prompts:  76%|███████▌  | 194/256 [00:07<00:02, 23.47it/s, est. speed input: 26403.16 toks/s, output: 25.78 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:07<00:02, 23.49it/s, est. speed input: 26352.68 toks/s, output: 25.73 toks/s]
Processed prompts:  79%|███████▉  | 202/256 [00:07<00:02, 24.45it/s, est. speed input: 26377.27 toks/s, output: 25.76 toks/s]
Processed prompts:  80%|████████  | 206/256 [00:08<00:02, 24.16it/s, est. speed input: 26328.93 toks/s, output: 25.71 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:08<00:01, 23.93it/s, est. speed input: 26279.41 toks/s, output: 25.66 toks/s]
Processed prompts:  84%|████████▎ | 214/256 [00:08<00:01, 23.81it/s, est. speed input: 26234.94 toks/s, output: 25.62 toks/s]
Processed prompts:  85%|████████▌ | 218/256 [00:08<00:01, 23.70it/s, est. speed input: 26190.62 toks/s, output: 25.58 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:08<00:01, 23.66it/s, est. speed input: 26150.40 toks/s, output: 25.54 toks/s]
Processed prompts:  88%|████████▊ | 226/256 [00:08<00:01, 23.58it/s, est. speed input: 26107.93 toks/s, output: 25.50 toks/s]
Processed prompts:  90%|████████▉ | 230/256 [00:09<00:01, 23.54it/s, est. speed input: 26068.64 toks/s, output: 25.46 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:09<00:00, 23.48it/s, est. speed input: 26028.34 toks/s, output: 25.42 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:09<00:00, 23.46it/s, est. speed input: 25990.98 toks/s, output: 25.38 toks/s]
Processed prompts:  95%|█████████▍| 242/256 [00:09<00:00, 23.46it/s, est. speed input: 25955.64 toks/s, output: 25.35 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:09<00:00, 23.42it/s, est. speed input: 25919.45 toks/s, output: 25.31 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:09<00:00, 23.44it/s, est. speed input: 25886.88 toks/s, output: 25.28 toks/s]
Processed prompts:  99%|█████████▉| 254/256 [00:10<00:00, 23.45it/s, est. speed input: 25855.75 toks/s, output: 25.25 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:10<00:00, 23.45it/s, est. speed input: 25907.76 toks/s, output: 25.30 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:10<00:00, 25.30it/s, est. speed input: 25907.76 toks/s, output: 25.30 toks/s]
[rank0]:[W126 03:41:34.862489102 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 61.3s

测试结果:
  Requests/s:   23.03
  Tokens/s:     23607.83
  Total Reqs:   256
  Elapsed:      11.11s

  [Prefill 分析]
  Total Prefill Tokens: 262144
  Prefill Tokens/s:     23584.80

============================================================
[4/8] 测试 M=4096
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 4096
│   M_prefill     = 4096 (= 4 x 1024)
│   M_decode      = 4
│   batched_tokens = 4096 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 512
│   --max-num-seqs           = 4
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 4096
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 03:41:47 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 03:41:48 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=131435) WARNING 01-26 03:41:55 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=131435) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=131435) WARNING 01-26 03:42:07 [backends.py:609] Failed to read file <frozen os>
Throughput: 24.15 requests/s, 24754.02 total tokens/s, 24.15 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512


─── STDERR ───
[2026-01-26 03:41:46] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:41:47] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:41:47] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:41:47] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:41:47] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:41:47] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:41:47] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:41:47] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:41:47] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:41:47] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:41:47] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:41:47] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:41:47] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:41:47] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 03:41:54] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:41:54] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:41:54] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:41:54] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:41:54] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:41:54] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:41:54] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:41:54] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:41:54] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:41:54] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:41:54] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:41:54] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:41:54] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:41:54] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=131435) [2026-01-26 03:41:55] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=131435) [2026-01-26 03:41:55] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=131435) [2026-01-26 03:41:55] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=131435) [2026-01-26 03:41:55] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=131435) [2026-01-26 03:41:55] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=131435) [2026-01-26 03:41:55] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=131435) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=131435) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.42it/s]
(EngineCore_DP0 pid=131435) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.14it/s]
(EngineCore_DP0 pid=131435) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.17it/s]
(EngineCore_DP0 pid=131435) 
(EngineCore_DP0 pid=131435) [2026-01-26 03:41:58] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 3584] -> 1D uint8
(EngineCore_DP0 pid=131435) [2026-01-26 03:41:58] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12386304 bytes
(EngineCore_DP0 pid=131435) [2026-01-26 03:41:58] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 3584] -> 1D uint8
(EngineCore_DP0 pid=131435) [2026-01-26 03:41:58] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 9633792 bytes
(EngineCore_DP0 pid=131435) [2026-01-26 03:41:58] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 3584] -> 1D uint8
(EngineCore_DP0 pid=131435) [2026-01-26 03:41:58] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 101842944 bytes
(EngineCore_DP0 pid=131435) [2026-01-26 03:41:58] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 18944] -> 1D uint8
(EngineCore_DP0 pid=131435) [2026-01-26 03:41:58] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 50921472 bytes
(EngineCore_DP0 pid=131435) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  25%|██▌       | 1/4 [00:00<00:00,  8.50it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 2/4 [00:00<00:00,  9.02it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  75%|███████▌  | 3/4 [00:00<00:00,  9.19it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  8.33it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  8.55it/s]
(EngineCore_DP0 pid=131435) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  33%|███▎      | 1/3 [00:00<00:00,  7.32it/s]
Capturing CUDA graphs (decode, FULL):  67%|██████▋   | 2/3 [00:00<00:00,  8.40it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  8.71it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  8.49it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   5%|▍         | 24/512 [00:00<00:02, 233.31it/s]
Adding requests:  10%|▉         | 50/512 [00:00<00:01, 243.94it/s]
Adding requests:  15%|█▍        | 76/512 [00:00<00:01, 250.73it/s]
Adding requests:  20%|█▉        | 102/512 [00:00<00:01, 252.79it/s]
Adding requests:  25%|██▌       | 128/512 [00:00<00:01, 252.19it/s]
Adding requests:  30%|███       | 155/512 [00:00<00:01, 256.34it/s]
Adding requests:  36%|███▌      | 185/512 [00:00<00:01, 267.18it/s]
Adding requests:  42%|████▏     | 214/512 [00:00<00:01, 271.53it/s]
Adding requests:  47%|████▋     | 242/512 [00:00<00:00, 272.51it/s]
Adding requests:  53%|█████▎    | 270/512 [00:01<00:00, 270.35it/s]
Adding requests:  58%|█████▊    | 298/512 [00:01<00:00, 271.61it/s]
Adding requests:  64%|██████▎   | 326/512 [00:01<00:00, 272.54it/s]
Adding requests:  70%|██████▉   | 356/512 [00:01<00:00, 279.35it/s]
Adding requests:  75%|███████▌  | 384/512 [00:01<00:00, 277.65it/s]
Adding requests:  81%|████████  | 413/512 [00:01<00:00, 279.34it/s]
Adding requests:  86%|████████▌ | 441/512 [00:01<00:00, 279.30it/s]
Adding requests:  92%|█████████▏| 470/512 [00:01<00:00, 281.11it/s]
Adding requests:  98%|█████████▊| 500/512 [00:01<00:00, 286.03it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 271.86it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   8%|▊         | 42/512 [00:00<00:02, 206.42it/s, est. speed input: 211404.40 toks/s, output: 206.43 toks/s]
Processed prompts:  12%|█▏        | 63/512 [00:01<00:08, 52.54it/s, est. speed input: 63227.42 toks/s, output: 61.75 toks/s]   
Processed prompts:  14%|█▍        | 74/512 [00:01<00:11, 39.81it/s, est. speed input: 50141.90 toks/s, output: 48.97 toks/s]
Processed prompts:  16%|█▌        | 81/512 [00:01<00:10, 40.33it/s, est. speed input: 49534.97 toks/s, output: 48.37 toks/s]
Processed prompts:  17%|█▋        | 87/512 [00:02<00:12, 33.22it/s, est. speed input: 44512.92 toks/s, output: 43.47 toks/s]
Processed prompts:  18%|█▊        | 92/512 [00:02<00:12, 32.75it/s, est. speed input: 43530.36 toks/s, output: 42.51 toks/s]
Processed prompts:  19%|█▉        | 96/512 [00:02<00:13, 31.01it/s, est. speed input: 42240.07 toks/s, output: 41.25 toks/s]
Processed prompts:  20%|█▉        | 100/512 [00:02<00:13, 29.52it/s, est. speed input: 41122.58 toks/s, output: 40.16 toks/s]
Processed prompts:  20%|██        | 104/512 [00:02<00:14, 28.25it/s, est. speed input: 40130.07 toks/s, output: 39.19 toks/s]
Processed prompts:  21%|██        | 107/512 [00:02<00:15, 25.65it/s, est. speed input: 38891.49 toks/s, output: 37.98 toks/s]
Processed prompts:  21%|██▏       | 110/512 [00:02<00:16, 23.67it/s, est. speed input: 37792.01 toks/s, output: 36.91 toks/s]
Processed prompts:  22%|██▏       | 114/512 [00:03<00:16, 23.92it/s, est. speed input: 37138.48 toks/s, output: 36.27 toks/s]
Processed prompts:  23%|██▎       | 118/512 [00:03<00:16, 24.10it/s, est. speed input: 36545.13 toks/s, output: 35.69 toks/s]
Processed prompts:  24%|██▍       | 122/512 [00:03<00:16, 24.20it/s, est. speed input: 36002.85 toks/s, output: 35.16 toks/s]
Processed prompts:  25%|██▍       | 126/512 [00:03<00:15, 24.28it/s, est. speed input: 35511.41 toks/s, output: 34.68 toks/s]
Processed prompts:  25%|██▌       | 130/512 [00:03<00:15, 24.35it/s, est. speed input: 35062.74 toks/s, output: 34.24 toks/s]
Processed prompts:  26%|██▌       | 134/512 [00:03<00:15, 24.37it/s, est. speed input: 34647.72 toks/s, output: 33.84 toks/s]
Processed prompts:  27%|██▋       | 138/512 [00:04<00:15, 24.39it/s, est. speed input: 34265.43 toks/s, output: 33.46 toks/s]
Processed prompts:  28%|██▊       | 142/512 [00:04<00:15, 24.41it/s, est. speed input: 33913.76 toks/s, output: 33.12 toks/s]
Processed prompts:  29%|██▊       | 146/512 [00:04<00:14, 24.42it/s, est. speed input: 33586.31 toks/s, output: 32.80 toks/s]
Processed prompts:  29%|██▉       | 150/512 [00:04<00:14, 24.42it/s, est. speed input: 33281.89 toks/s, output: 32.50 toks/s]
Processed prompts:  30%|███       | 154/512 [00:04<00:14, 24.43it/s, est. speed input: 32999.59 toks/s, output: 32.23 toks/s]
Processed prompts:  31%|███       | 158/512 [00:04<00:14, 24.42it/s, est. speed input: 32733.98 toks/s, output: 31.97 toks/s]
Processed prompts:  32%|███▏      | 162/512 [00:05<00:14, 24.44it/s, est. speed input: 32488.36 toks/s, output: 31.73 toks/s]
Processed prompts:  32%|███▏      | 166/512 [00:05<00:14, 24.45it/s, est. speed input: 32258.58 toks/s, output: 31.50 toks/s]
Processed prompts:  33%|███▎      | 170/512 [00:05<00:13, 24.47it/s, est. speed input: 32043.24 toks/s, output: 31.29 toks/s]
Processed prompts:  34%|███▍      | 174/512 [00:05<00:13, 24.48it/s, est. speed input: 31841.09 toks/s, output: 31.09 toks/s]
Processed prompts:  35%|███▍      | 178/512 [00:05<00:13, 24.50it/s, est. speed input: 31650.73 toks/s, output: 30.91 toks/s]
Processed prompts:  36%|███▌      | 182/512 [00:05<00:13, 24.50it/s, est. speed input: 31469.48 toks/s, output: 30.73 toks/s]
Processed prompts:  36%|███▋      | 186/512 [00:06<00:13, 24.47it/s, est. speed input: 31294.86 toks/s, output: 30.56 toks/s]
Processed prompts:  37%|███▋      | 190/512 [00:06<00:13, 24.48it/s, est. speed input: 31133.29 toks/s, output: 30.40 toks/s]
Processed prompts:  38%|███▊      | 194/512 [00:06<00:12, 24.46it/s, est. speed input: 30976.91 toks/s, output: 30.25 toks/s]
Processed prompts:  39%|███▊      | 198/512 [00:06<00:12, 24.45it/s, est. speed input: 30827.94 toks/s, output: 30.11 toks/s]
Processed prompts:  39%|███▉      | 202/512 [00:06<00:12, 25.75it/s, est. speed input: 30813.59 toks/s, output: 30.09 toks/s]
Processed prompts:  40%|████      | 206/512 [00:06<00:12, 25.35it/s, est. speed input: 30676.38 toks/s, output: 29.96 toks/s]
Processed prompts:  41%|████      | 210/512 [00:07<00:12, 25.04it/s, est. speed input: 30542.42 toks/s, output: 29.83 toks/s]
Processed prompts:  42%|████▏     | 214/512 [00:07<00:12, 24.83it/s, est. speed input: 30414.83 toks/s, output: 29.70 toks/s]
Processed prompts:  43%|████▎     | 218/512 [00:07<00:11, 24.70it/s, est. speed input: 30293.59 toks/s, output: 29.58 toks/s]
Processed prompts:  43%|████▎     | 222/512 [00:07<00:11, 24.60it/s, est. speed input: 30177.82 toks/s, output: 29.47 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:07<00:11, 24.54it/s, est. speed input: 30066.77 toks/s, output: 29.36 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:07<00:11, 24.49it/s, est. speed input: 29960.31 toks/s, output: 29.26 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:08<00:11, 24.49it/s, est. speed input: 29860.76 toks/s, output: 29.16 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:08<00:11, 24.47it/s, est. speed input: 29763.93 toks/s, output: 29.07 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:08<00:11, 24.46it/s, est. speed input: 29671.04 toks/s, output: 28.98 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:08<00:10, 24.47it/s, est. speed input: 29582.60 toks/s, output: 28.89 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:08<00:10, 24.47it/s, est. speed input: 29497.71 toks/s, output: 28.81 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:08<00:10, 24.45it/s, est. speed input: 29414.42 toks/s, output: 28.72 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:09<00:10, 24.46it/s, est. speed input: 29335.34 toks/s, output: 28.65 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:09<00:10, 24.44it/s, est. speed input: 29257.62 toks/s, output: 28.57 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:09<00:10, 24.43it/s, est. speed input: 29182.40 toks/s, output: 28.50 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:09<00:09, 24.45it/s, est. speed input: 29112.19 toks/s, output: 28.43 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:09<00:09, 24.46it/s, est. speed input: 29044.00 toks/s, output: 28.36 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:09<00:09, 24.47it/s, est. speed input: 28977.83 toks/s, output: 28.30 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:09<00:09, 24.47it/s, est. speed input: 28914.05 toks/s, output: 28.24 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:10<00:09, 24.48it/s, est. speed input: 28852.38 toks/s, output: 28.18 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:10<00:09, 24.44it/s, est. speed input: 28790.12 toks/s, output: 28.12 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:10<00:08, 24.42it/s, est. speed input: 28729.83 toks/s, output: 28.06 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:10<00:08, 24.40it/s, est. speed input: 28671.19 toks/s, output: 28.00 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:10<00:08, 24.38it/s, est. speed input: 28614.45 toks/s, output: 27.94 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:10<00:08, 24.38it/s, est. speed input: 28560.00 toks/s, output: 27.89 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:11<00:08, 24.39it/s, est. speed input: 28507.16 toks/s, output: 27.84 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:11<00:08, 24.40it/s, est. speed input: 28456.43 toks/s, output: 27.79 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:11<00:07, 24.40it/s, est. speed input: 28407.15 toks/s, output: 27.74 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:11<00:07, 24.41it/s, est. speed input: 28359.56 toks/s, output: 27.69 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:11<00:07, 24.41it/s, est. speed input: 28312.63 toks/s, output: 27.65 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:11<00:07, 24.42it/s, est. speed input: 28267.79 toks/s, output: 27.61 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:12<00:07, 24.43it/s, est. speed input: 28224.28 toks/s, output: 27.56 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:12<00:07, 24.42it/s, est. speed input: 28181.08 toks/s, output: 27.52 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:12<00:06, 24.40it/s, est. speed input: 28138.06 toks/s, output: 27.48 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:12<00:06, 24.39it/s, est. speed input: 28096.47 toks/s, output: 27.44 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:12<00:06, 24.39it/s, est. speed input: 28056.59 toks/s, output: 27.40 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:12<00:06, 24.38it/s, est. speed input: 28016.95 toks/s, output: 27.36 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:13<00:06, 24.37it/s, est. speed input: 27978.06 toks/s, output: 27.32 toks/s]
Processed prompts:  71%|███████   | 362/512 [00:13<00:06, 24.36it/s, est. speed input: 27940.15 toks/s, output: 27.29 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:13<00:05, 24.35it/s, est. speed input: 27903.07 toks/s, output: 27.25 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [00:13<00:05, 24.33it/s, est. speed input: 27866.59 toks/s, output: 27.21 toks/s]
Processed prompts:  80%|████████  | 410/512 [00:13<00:01, 79.56it/s, est. speed input: 30351.08 toks/s, output: 29.64 toks/s]
Processed prompts:  81%|████████▏ | 417/512 [00:13<00:01, 69.45it/s, est. speed input: 30507.60 toks/s, output: 29.79 toks/s]
Processed prompts:  83%|████████▎ | 424/512 [00:14<00:01, 48.29it/s, est. speed input: 30308.52 toks/s, output: 29.60 toks/s]
Processed prompts:  84%|████████▍ | 429/512 [00:14<00:01, 44.04it/s, est. speed input: 30318.79 toks/s, output: 29.61 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [00:14<00:02, 32.32it/s, est. speed input: 29990.99 toks/s, output: 29.29 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [00:14<00:02, 30.51it/s, est. speed input: 29934.96 toks/s, output: 29.23 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [00:15<00:02, 29.00it/s, est. speed input: 29879.80 toks/s, output: 29.18 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [00:15<00:02, 27.77it/s, est. speed input: 29825.42 toks/s, output: 29.13 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [00:15<00:02, 26.84it/s, est. speed input: 29772.85 toks/s, output: 29.08 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [00:15<00:02, 26.12it/s, est. speed input: 29720.78 toks/s, output: 29.02 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [00:15<00:02, 25.59it/s, est. speed input: 29669.97 toks/s, output: 28.97 toks/s]
Processed prompts:  90%|█████████ | 462/512 [00:15<00:01, 25.22it/s, est. speed input: 29620.62 toks/s, output: 28.93 toks/s]
Processed prompts:  91%|█████████ | 466/512 [00:16<00:01, 24.95it/s, est. speed input: 29572.44 toks/s, output: 28.88 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [00:16<00:01, 24.76it/s, est. speed input: 29525.02 toks/s, output: 28.83 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [00:16<00:01, 24.62it/s, est. speed input: 29478.56 toks/s, output: 28.79 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [00:16<00:01, 24.53it/s, est. speed input: 29433.15 toks/s, output: 28.74 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [00:16<00:01, 24.48it/s, est. speed input: 29389.40 toks/s, output: 28.70 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [00:16<00:01, 24.44it/s, est. speed input: 29346.32 toks/s, output: 28.66 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [00:17<00:00, 24.42it/s, est. speed input: 29304.10 toks/s, output: 28.62 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [00:17<00:00, 24.40it/s, est. speed input: 29262.65 toks/s, output: 28.58 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [00:17<00:00, 24.38it/s, est. speed input: 29221.61 toks/s, output: 28.54 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [00:17<00:00, 24.35it/s, est. speed input: 29180.95 toks/s, output: 28.50 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [00:17<00:00, 24.34it/s, est. speed input: 29141.29 toks/s, output: 28.46 toks/s]
Processed prompts: 100%|█████████▉| 510/512 [00:17<00:00, 25.99it/s, est. speed input: 29159.23 toks/s, output: 28.48 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:17<00:00, 25.99it/s, est. speed input: 29273.22 toks/s, output: 28.59 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:17<00:00, 28.59it/s, est. speed input: 29273.22 toks/s, output: 28.59 toks/s]
[rank0]:[W126 03:42:44.833617375 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 69.9s

测试结果:
  Requests/s:   24.15
  Tokens/s:     24754.02
  Total Reqs:   512
  Elapsed:      21.20s

  [Prefill 分析]
  Total Prefill Tokens: 524288
  Prefill Tokens/s:     24729.87

============================================================
[5/8] 测试 M=8192
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 8192
│   M_prefill     = 8192 (= 8 x 1024)
│   M_decode      = 8
│   batched_tokens = 8192 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 1024
│   --max-num-seqs           = 8
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 8192
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 03:43:01 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 03:43:02 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=132715) WARNING 01-26 03:43:10 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=132715) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=132715) WARNING 01-26 03:43:21 [backends.py:609] Failed to read file <frozen os>
Throughput: 24.24 requests/s, 24848.55 total tokens/s, 24.24 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024


─── STDERR ───
[2026-01-26 03:43:01] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:43:01] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:43:01] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:43:01] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:43:01] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:43:01] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:43:01] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:43:01] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:43:01] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:43:01] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:43:01] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:43:01] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:43:01] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:43:01] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 03:43:09] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:43:09] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:43:09] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:43:09] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:43:09] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:43:09] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:43:09] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:43:09] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:43:09] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:43:09] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:43:09] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:43:09] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:43:09] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:43:09] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=132715) [2026-01-26 03:43:11] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=132715) [2026-01-26 03:43:11] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=132715) [2026-01-26 03:43:11] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=132715) [2026-01-26 03:43:11] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=132715) [2026-01-26 03:43:11] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=132715) [2026-01-26 03:43:11] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=132715) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=132715) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.41it/s]
(EngineCore_DP0 pid=132715) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.16it/s]
(EngineCore_DP0 pid=132715) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.19it/s]
(EngineCore_DP0 pid=132715) 
(EngineCore_DP0 pid=132715) [2026-01-26 03:43:12] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 3584] -> 1D uint8
(EngineCore_DP0 pid=132715) [2026-01-26 03:43:12] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12386304 bytes
(EngineCore_DP0 pid=132715) [2026-01-26 03:43:12] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 3584] -> 1D uint8
(EngineCore_DP0 pid=132715) [2026-01-26 03:43:12] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 9633792 bytes
(EngineCore_DP0 pid=132715) [2026-01-26 03:43:12] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 3584] -> 1D uint8
(EngineCore_DP0 pid=132715) [2026-01-26 03:43:12] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 101842944 bytes
(EngineCore_DP0 pid=132715) [2026-01-26 03:43:12] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 18944] -> 1D uint8
(EngineCore_DP0 pid=132715) [2026-01-26 03:43:12] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 50921472 bytes
(EngineCore_DP0 pid=132715) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:01,  2.61it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  40%|████      | 2/5 [00:00<00:00,  4.45it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  60%|██████    | 3/5 [00:00<00:00,  5.86it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  80%|████████  | 4/5 [00:00<00:00,  6.82it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00,  6.94it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00,  5.86it/s]
(EngineCore_DP0 pid=132715) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:00,  7.19it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 2/4 [00:00<00:00,  8.53it/s]
Capturing CUDA graphs (decode, FULL):  75%|███████▌  | 3/4 [00:00<00:00,  9.11it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  9.29it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  8.96it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 25/1024 [00:00<00:04, 240.42it/s]
Adding requests:   5%|▍         | 51/1024 [00:00<00:03, 251.02it/s]
Adding requests:   8%|▊         | 78/1024 [00:00<00:03, 256.38it/s]
Adding requests:  10%|█         | 104/1024 [00:00<00:03, 257.73it/s]
Adding requests:  13%|█▎        | 131/1024 [00:00<00:03, 258.27it/s]
Adding requests:  16%|█▌        | 159/1024 [00:00<00:03, 263.80it/s]
Adding requests:  18%|█▊        | 187/1024 [00:00<00:03, 267.73it/s]
Adding requests:  21%|██        | 215/1024 [00:00<00:02, 270.70it/s]
Adding requests:  24%|██▎       | 243/1024 [00:00<00:02, 266.70it/s]
Adding requests:  26%|██▋       | 270/1024 [00:01<00:02, 266.23it/s]
Adding requests:  29%|██▉       | 298/1024 [00:01<00:02, 268.57it/s]
Adding requests:  32%|███▏      | 326/1024 [00:01<00:02, 271.07it/s]
Adding requests:  35%|███▍      | 355/1024 [00:01<00:02, 274.84it/s]
Adding requests:  38%|███▊      | 384/1024 [00:01<00:02, 278.16it/s]
Adding requests:  40%|████      | 414/1024 [00:01<00:02, 283.43it/s]
Adding requests:  43%|████▎     | 443/1024 [00:01<00:02, 277.28it/s]
Adding requests:  46%|████▌     | 472/1024 [00:01<00:01, 278.93it/s]
Adding requests:  49%|████▉     | 502/1024 [00:01<00:01, 285.02it/s]
Adding requests:  52%|█████▏    | 533/1024 [00:01<00:01, 290.76it/s]
Adding requests:  90%|█████████ | 923/1024 [00:02<00:00, 1349.44it/s]
Adding requests: 100%|██████████| 1024/1024 [00:02<00:00, 421.76it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   9%|▉         | 90/1024 [00:00<00:03, 258.70it/s, est. speed input: 264959.52 toks/s, output: 258.71 toks/s]
Processed prompts:  11%|█▏        | 116/1024 [00:01<00:12, 72.84it/s, est. speed input: 89567.60 toks/s, output: 87.47 toks/s]  
Processed prompts:  13%|█▎        | 129/1024 [00:01<00:14, 63.72it/s, est. speed input: 79928.92 toks/s, output: 78.06 toks/s]
Processed prompts:  13%|█▎        | 138/1024 [00:02<00:21, 41.69it/s, est. speed input: 61289.87 toks/s, output: 59.85 toks/s]
Processed prompts:  14%|█▍        | 146/1024 [00:02<00:23, 37.57it/s, est. speed input: 56800.49 toks/s, output: 55.47 toks/s]
Processed prompts:  15%|█▌        | 154/1024 [00:02<00:25, 34.24it/s, est. speed input: 53300.04 toks/s, output: 52.05 toks/s]
Processed prompts:  16%|█▌        | 162/1024 [00:03<00:27, 31.63it/s, est. speed input: 50492.82 toks/s, output: 49.31 toks/s]
Processed prompts:  17%|█▋        | 170/1024 [00:03<00:28, 29.66it/s, est. speed input: 48195.53 toks/s, output: 47.07 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [00:03<00:30, 28.20it/s, est. speed input: 46278.53 toks/s, output: 45.19 toks/s]
Processed prompts:  18%|█▊        | 186/1024 [00:04<00:30, 27.12it/s, est. speed input: 44648.52 toks/s, output: 43.60 toks/s]
Processed prompts:  19%|█▉        | 194/1024 [00:04<00:31, 26.34it/s, est. speed input: 43251.56 toks/s, output: 42.24 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [00:04<00:31, 26.47it/s, est. speed input: 42286.83 toks/s, output: 41.30 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:05<00:31, 25.84it/s, est. speed input: 41200.64 toks/s, output: 40.23 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [00:05<00:31, 25.43it/s, est. speed input: 40247.41 toks/s, output: 39.30 toks/s]
Processed prompts:  22%|██▏       | 226/1024 [00:05<00:31, 25.13it/s, est. speed input: 39398.41 toks/s, output: 38.47 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:06<00:31, 24.92it/s, est. speed input: 38640.14 toks/s, output: 37.73 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:06<00:31, 24.78it/s, est. speed input: 37957.11 toks/s, output: 37.07 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:06<00:31, 24.67it/s, est. speed input: 37337.94 toks/s, output: 36.46 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:07<00:31, 24.60it/s, est. speed input: 36776.29 toks/s, output: 35.91 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:07<00:30, 24.54it/s, est. speed input: 36262.20 toks/s, output: 35.41 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:07<00:30, 24.50it/s, est. speed input: 35791.16 toks/s, output: 34.95 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:08<00:30, 24.46it/s, est. speed input: 35356.04 toks/s, output: 34.53 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:08<00:30, 24.44it/s, est. speed input: 34954.34 toks/s, output: 34.13 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:08<00:29, 24.42it/s, est. speed input: 34583.02 toks/s, output: 33.77 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:09<00:29, 24.40it/s, est. speed input: 34237.61 toks/s, output: 33.44 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:09<00:29, 24.39it/s, est. speed input: 33916.17 toks/s, output: 33.12 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:09<00:28, 24.38it/s, est. speed input: 33615.89 toks/s, output: 32.83 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:10<00:28, 24.37it/s, est. speed input: 33333.66 toks/s, output: 32.55 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:10<00:28, 24.36it/s, est. speed input: 33070.22 toks/s, output: 32.30 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:10<00:27, 24.37it/s, est. speed input: 32823.37 toks/s, output: 32.05 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:11<00:27, 24.36it/s, est. speed input: 32590.28 toks/s, output: 31.83 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:11<00:27, 24.35it/s, est. speed input: 32369.89 toks/s, output: 31.61 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:11<00:26, 24.34it/s, est. speed input: 32161.11 toks/s, output: 31.41 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:12<00:26, 24.34it/s, est. speed input: 31964.89 toks/s, output: 31.22 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:12<00:26, 24.34it/s, est. speed input: 31778.39 toks/s, output: 31.03 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [00:12<00:25, 24.34it/s, est. speed input: 31601.96 toks/s, output: 30.86 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:13<00:25, 24.33it/s, est. speed input: 31433.52 toks/s, output: 30.70 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:13<00:25, 24.32it/s, est. speed input: 31272.98 toks/s, output: 30.54 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:13<00:24, 24.32it/s, est. speed input: 31120.58 toks/s, output: 30.39 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:14<00:24, 24.32it/s, est. speed input: 30975.25 toks/s, output: 30.25 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:14<00:24, 24.31it/s, est. speed input: 30835.83 toks/s, output: 30.11 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:14<00:23, 24.30it/s, est. speed input: 30702.50 toks/s, output: 29.98 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:15<00:23, 24.29it/s, est. speed input: 30574.44 toks/s, output: 29.86 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:15<00:23, 24.29it/s, est. speed input: 30452.55 toks/s, output: 29.74 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:15<00:22, 24.29it/s, est. speed input: 30335.83 toks/s, output: 29.62 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:16<00:22, 24.29it/s, est. speed input: 30223.80 toks/s, output: 29.52 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:16<00:22, 24.29it/s, est. speed input: 30115.93 toks/s, output: 29.41 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:16<00:21, 24.29it/s, est. speed input: 30012.48 toks/s, output: 29.31 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:17<00:21, 24.28it/s, est. speed input: 29912.40 toks/s, output: 29.21 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:17<00:21, 24.27it/s, est. speed input: 29816.04 toks/s, output: 29.12 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:17<00:21, 24.26it/s, est. speed input: 29723.04 toks/s, output: 29.03 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:18<00:20, 24.26it/s, est. speed input: 29633.86 toks/s, output: 28.94 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:18<00:20, 24.26it/s, est. speed input: 29547.38 toks/s, output: 28.85 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:18<00:20, 24.25it/s, est. speed input: 29464.24 toks/s, output: 28.77 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:19<00:19, 24.25it/s, est. speed input: 29383.95 toks/s, output: 28.70 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:19<00:19, 24.25it/s, est. speed input: 29306.50 toks/s, output: 28.62 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:19<00:19, 24.25it/s, est. speed input: 29231.65 toks/s, output: 28.55 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:20<00:18, 24.25it/s, est. speed input: 29158.78 toks/s, output: 28.48 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:20<00:18, 24.24it/s, est. speed input: 29088.28 toks/s, output: 28.41 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:20<00:18, 24.25it/s, est. speed input: 29020.44 toks/s, output: 28.34 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:21<00:17, 24.24it/s, est. speed input: 28953.98 toks/s, output: 28.28 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:21<00:17, 24.24it/s, est. speed input: 28890.20 toks/s, output: 28.21 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:21<00:17, 24.24it/s, est. speed input: 28828.00 toks/s, output: 28.15 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:21<00:16, 24.23it/s, est. speed input: 28767.67 toks/s, output: 28.09 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:22<00:16, 24.23it/s, est. speed input: 28709.03 toks/s, output: 28.04 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:22<00:16, 24.23it/s, est. speed input: 28652.44 toks/s, output: 27.98 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:22<00:15, 24.23it/s, est. speed input: 28597.12 toks/s, output: 27.93 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:23<00:15, 24.23it/s, est. speed input: 28543.54 toks/s, output: 27.87 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:23<00:15, 24.22it/s, est. speed input: 28491.09 toks/s, output: 27.82 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:23<00:14, 24.22it/s, est. speed input: 28440.34 toks/s, output: 27.77 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:24<00:14, 24.22it/s, est. speed input: 28390.83 toks/s, output: 27.73 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:24<00:14, 24.23it/s, est. speed input: 28343.15 toks/s, output: 27.68 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:24<00:13, 24.23it/s, est. speed input: 28296.34 toks/s, output: 27.63 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:25<00:13, 24.23it/s, est. speed input: 28250.79 toks/s, output: 27.59 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:25<00:13, 24.22it/s, est. speed input: 28206.20 toks/s, output: 27.55 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:25<00:12, 24.22it/s, est. speed input: 28163.04 toks/s, output: 27.50 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:26<00:12, 24.23it/s, est. speed input: 28121.04 toks/s, output: 27.46 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:26<00:12, 24.23it/s, est. speed input: 28080.26 toks/s, output: 27.42 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:26<00:11, 24.23it/s, est. speed input: 28040.24 toks/s, output: 27.38 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:27<00:11, 24.24it/s, est. speed input: 28001.42 toks/s, output: 27.35 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:27<00:11, 24.23it/s, est. speed input: 27963.24 toks/s, output: 27.31 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:27<00:10, 24.23it/s, est. speed input: 27926.02 toks/s, output: 27.27 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:28<00:10, 24.24it/s, est. speed input: 27889.88 toks/s, output: 27.24 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:28<00:10, 24.24it/s, est. speed input: 27854.46 toks/s, output: 27.20 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:28<00:09, 24.95it/s, est. speed input: 27850.04 toks/s, output: 27.20 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:29<00:09, 24.74it/s, est. speed input: 27816.35 toks/s, output: 27.16 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:29<00:09, 24.60it/s, est. speed input: 27783.16 toks/s, output: 27.13 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:29<00:08, 24.48it/s, est. speed input: 27750.19 toks/s, output: 27.10 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:30<00:08, 24.42it/s, est. speed input: 27718.51 toks/s, output: 27.07 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:30<00:08, 24.37it/s, est. speed input: 27687.57 toks/s, output: 27.04 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [00:30<00:02, 57.30it/s, est. speed input: 28785.36 toks/s, output: 28.11 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [00:31<00:03, 46.92it/s, est. speed input: 28744.20 toks/s, output: 28.07 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [00:31<00:03, 39.92it/s, est. speed input: 28704.22 toks/s, output: 28.03 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [00:31<00:03, 35.11it/s, est. speed input: 28664.40 toks/s, output: 27.99 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [00:32<00:03, 31.83it/s, est. speed input: 28625.94 toks/s, output: 27.95 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [00:32<00:03, 29.55it/s, est. speed input: 28588.11 toks/s, output: 27.92 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [00:32<00:03, 27.97it/s, est. speed input: 28551.23 toks/s, output: 27.88 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [00:33<00:03, 26.87it/s, est. speed input: 28514.93 toks/s, output: 27.85 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [00:33<00:03, 26.10it/s, est. speed input: 28479.36 toks/s, output: 27.81 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [00:33<00:03, 25.56it/s, est. speed input: 28444.58 toks/s, output: 27.78 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [00:34<00:03, 25.19it/s, est. speed input: 28410.32 toks/s, output: 27.74 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [00:34<00:02, 24.92it/s, est. speed input: 28376.64 toks/s, output: 27.71 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [00:34<00:02, 24.73it/s, est. speed input: 28343.52 toks/s, output: 27.68 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [00:35<00:02, 24.60it/s, est. speed input: 28310.84 toks/s, output: 27.65 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [00:35<00:01, 24.51it/s, est. speed input: 28279.01 toks/s, output: 27.62 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [00:35<00:01, 24.45it/s, est. speed input: 28247.89 toks/s, output: 27.59 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [00:36<00:01, 24.41it/s, est. speed input: 28217.21 toks/s, output: 27.56 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [00:36<00:00, 24.37it/s, est. speed input: 28186.93 toks/s, output: 27.53 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [00:36<00:00, 24.35it/s, est. speed input: 28157.29 toks/s, output: 27.50 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [00:37<00:00, 25.11it/s, est. speed input: 28154.03 toks/s, output: 27.49 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:37<00:00, 25.11it/s, est. speed input: 28319.75 toks/s, output: 27.66 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:37<00:00, 27.66it/s, est. speed input: 28319.75 toks/s, output: 27.66 toks/s]
[rank0]:[W126 03:44:19.491801562 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 95.4s

测试结果:
  Requests/s:   24.24
  Tokens/s:     24848.55
  Total Reqs:   1024
  Elapsed:      42.24s

  [Prefill 分析]
  Total Prefill Tokens: 1048576
  Prefill Tokens/s:     24824.31

============================================================
[6/8] 测试 M=16384
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 16384
│   M_prefill     = 16384 (= 16 x 1024)
│   M_decode      = 16
│   batched_tokens = 16384 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 2048
│   --max-num-seqs           = 16
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 16384
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 03:44:43 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 03:44:44 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=134394) WARNING 01-26 03:44:51 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=134394) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=134394) WARNING 01-26 03:45:03 [backends.py:609] Failed to read file <frozen os>
Throughput: 24.30 requests/s, 24902.74 total tokens/s, 24.30 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048


─── STDERR ───
[2026-01-26 03:44:43] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:44:43] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:44:43] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:44:43] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:44:43] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:44:43] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:44:43] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:44:43] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:44:43] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:44:43] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:44:43] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:44:43] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:44:43] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:44:43] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 03:44:50] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:44:50] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:44:50] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:44:50] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:44:50] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:44:50] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:44:50] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:44:50] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:44:50] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:44:50] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:44:50] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:44:50] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:44:50] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:44:50] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=134394) [2026-01-26 03:44:52] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=134394) [2026-01-26 03:44:52] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=134394) [2026-01-26 03:44:52] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=134394) [2026-01-26 03:44:52] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=134394) [2026-01-26 03:44:52] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=134394) [2026-01-26 03:44:52] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=134394) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=134394) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.41it/s]
(EngineCore_DP0 pid=134394) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.13it/s]
(EngineCore_DP0 pid=134394) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.16it/s]
(EngineCore_DP0 pid=134394) 
(EngineCore_DP0 pid=134394) [2026-01-26 03:44:54] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 3584] -> 1D uint8
(EngineCore_DP0 pid=134394) [2026-01-26 03:44:54] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12386304 bytes
(EngineCore_DP0 pid=134394) [2026-01-26 03:44:54] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 3584] -> 1D uint8
(EngineCore_DP0 pid=134394) [2026-01-26 03:44:54] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 9633792 bytes
(EngineCore_DP0 pid=134394) [2026-01-26 03:44:54] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 3584] -> 1D uint8
(EngineCore_DP0 pid=134394) [2026-01-26 03:44:54] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 101842944 bytes
(EngineCore_DP0 pid=134394) [2026-01-26 03:44:54] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 18944] -> 1D uint8
(EngineCore_DP0 pid=134394) [2026-01-26 03:44:54] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 50921472 bytes
(EngineCore_DP0 pid=134394) [rank0]:W0126 03:45:11.769000 134394 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=134394) [rank0]:W0126 03:45:11.874000 134394 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=134394) [rank0]:W0126 03:45:13.383000 134394 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=134394) [rank0]:W0126 03:45:13.556000 134394 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=134394) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  14%|█▍        | 1/7 [00:00<00:00,  8.10it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  29%|██▊       | 2/7 [00:00<00:00,  8.37it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  43%|████▎     | 3/7 [00:00<00:00,  8.73it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  57%|█████▋    | 4/7 [00:00<00:00,  8.85it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  71%|███████▏  | 5/7 [00:00<00:00,  8.91it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  86%|████████▌ | 6/7 [00:00<00:00,  8.95it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00,  8.10it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00,  8.45it/s]
(EngineCore_DP0 pid=134394) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  20%|██        | 1/5 [00:00<00:00,  6.99it/s]
Capturing CUDA graphs (decode, FULL):  40%|████      | 2/5 [00:00<00:00,  8.02it/s]
Capturing CUDA graphs (decode, FULL):  60%|██████    | 3/5 [00:00<00:00,  8.50it/s]
Capturing CUDA graphs (decode, FULL):  80%|████████  | 4/5 [00:00<00:00,  8.83it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00,  8.98it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00,  8.64it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   1%|          | 24/2048 [00:00<00:08, 236.73it/s]
Adding requests:   2%|▏         | 50/2048 [00:00<00:08, 245.48it/s]
Adding requests:   4%|▍         | 77/2048 [00:00<00:07, 254.49it/s]
Adding requests:   5%|▌         | 104/2048 [00:00<00:07, 257.20it/s]
Adding requests:   6%|▋         | 131/2048 [00:00<00:07, 259.06it/s]
Adding requests:   8%|▊         | 157/2048 [00:00<00:07, 258.56it/s]
Adding requests:   9%|▉         | 187/2048 [00:00<00:06, 268.78it/s]
Adding requests:  10%|█         | 215/2048 [00:00<00:06, 269.60it/s]
Adding requests:  12%|█▏        | 242/2048 [00:00<00:06, 267.93it/s]
Adding requests:  13%|█▎        | 269/2048 [00:01<00:06, 265.29it/s]
Adding requests:  15%|█▍        | 297/2048 [00:01<00:06, 269.12it/s]
Adding requests:  16%|█▌        | 325/2048 [00:01<00:06, 269.12it/s]
Adding requests:  17%|█▋        | 354/2048 [00:01<00:06, 274.67it/s]
Adding requests:  19%|█▊        | 382/2048 [00:01<00:06, 275.82it/s]
Adding requests:  20%|██        | 411/2048 [00:01<00:05, 279.13it/s]
Adding requests:  21%|██▏       | 439/2048 [00:01<00:05, 276.16it/s]
Adding requests:  23%|██▎       | 468/2048 [00:01<00:05, 279.08it/s]
Adding requests:  24%|██▍       | 498/2048 [00:01<00:05, 285.06it/s]
Adding requests:  26%|██▌       | 529/2048 [00:01<00:05, 290.15it/s]
Adding requests:  27%|██▋       | 559/2048 [00:02<00:05, 284.58it/s]
Adding requests:  29%|██▊       | 588/2048 [00:02<00:05, 273.78it/s]
Adding requests:  30%|███       | 616/2048 [00:02<00:05, 268.90it/s]
Adding requests:  31%|███▏      | 643/2048 [00:02<00:05, 266.04it/s]
Adding requests:  33%|███▎      | 670/2048 [00:02<00:05, 261.00it/s]
Adding requests:  34%|███▍      | 698/2048 [00:02<00:05, 264.73it/s]
Adding requests:  35%|███▌      | 725/2048 [00:02<00:04, 265.06it/s]
Adding requests:  37%|███▋      | 752/2048 [00:02<00:04, 265.77it/s]
Adding requests:  38%|███▊      | 779/2048 [00:02<00:04, 264.91it/s]
Adding requests:  39%|███▉      | 806/2048 [00:02<00:04, 265.57it/s]
Adding requests:  41%|████      | 835/2048 [00:03<00:04, 272.46it/s]
Adding requests:  42%|████▏     | 863/2048 [00:03<00:04, 264.46it/s]
Adding requests:  44%|████▎     | 893/2048 [00:03<00:04, 271.52it/s]
Adding requests:  45%|████▍     | 921/2048 [00:03<00:04, 266.58it/s]
Adding requests:  46%|████▋     | 948/2048 [00:03<00:04, 267.30it/s]
Adding requests:  48%|████▊     | 976/2048 [00:03<00:03, 268.73it/s]
Adding requests:  49%|████▉     | 1003/2048 [00:03<00:03, 263.66it/s]
Adding requests:  50%|█████     | 1031/2048 [00:03<00:03, 267.00it/s]
Adding requests:  52%|█████▏    | 1058/2048 [00:03<00:03, 266.44it/s]
Adding requests:  53%|█████▎    | 1086/2048 [00:04<00:03, 268.80it/s]
Adding requests:  54%|█████▍    | 1114/2048 [00:04<00:03, 271.03it/s]
Adding requests:  56%|█████▌    | 1143/2048 [00:04<00:03, 273.39it/s]
Adding requests:  57%|█████▋    | 1171/2048 [00:04<00:03, 270.33it/s]
Adding requests:  59%|█████▊    | 1199/2048 [00:04<00:03, 269.34it/s]
Adding requests:  60%|██████    | 1229/2048 [00:04<00:02, 276.30it/s]
Adding requests:  61%|██████▏   | 1257/2048 [00:04<00:02, 276.76it/s]
Adding requests:  63%|██████▎   | 1285/2048 [00:04<00:02, 270.22it/s]
Adding requests:  64%|██████▍   | 1313/2048 [00:04<00:02, 273.01it/s]
Adding requests:  65%|██████▌   | 1341/2048 [00:04<00:02, 267.65it/s]
Adding requests:  67%|██████▋   | 1369/2048 [00:05<00:02, 271.11it/s]
Adding requests:  68%|██████▊   | 1397/2048 [00:05<00:02, 269.36it/s]
Adding requests:  70%|██████▉   | 1424/2048 [00:05<00:02, 265.00it/s]
Adding requests:  71%|███████   | 1451/2048 [00:05<00:02, 264.98it/s]
Adding requests:  72%|███████▏  | 1478/2048 [00:05<00:02, 264.77it/s]
Adding requests:  74%|███████▎  | 1506/2048 [00:05<00:02, 267.25it/s]
Adding requests:  75%|███████▍  | 1533/2048 [00:05<00:01, 262.57it/s]
Adding requests:  76%|███████▌  | 1560/2048 [00:05<00:01, 261.35it/s]
Adding requests:  77%|███████▋  | 1587/2048 [00:05<00:01, 261.20it/s]
Adding requests:  79%|███████▉  | 1615/2048 [00:06<00:01, 262.88it/s]
Adding requests:  80%|████████  | 1642/2048 [00:06<00:01, 258.98it/s]
Adding requests:  81%|████████▏ | 1668/2048 [00:06<00:01, 256.15it/s]
Adding requests:  83%|████████▎ | 1695/2048 [00:06<00:01, 259.87it/s]
Adding requests:  84%|████████▍ | 1723/2048 [00:06<00:01, 264.32it/s]
Adding requests:  86%|████████▌ | 1752/2048 [00:06<00:01, 269.62it/s]
Adding requests:  87%|████████▋ | 1780/2048 [00:06<00:00, 272.38it/s]
Adding requests:  88%|████████▊ | 1808/2048 [00:06<00:00, 268.82it/s]
Adding requests:  90%|████████▉ | 1836/2048 [00:06<00:00, 267.98it/s]
Adding requests:  91%|█████████ | 1865/2048 [00:06<00:00, 272.03it/s]
Adding requests:  92%|█████████▏| 1893/2048 [00:07<00:00, 271.54it/s]
Adding requests:  94%|█████████▍| 1921/2048 [00:07<00:00, 273.09it/s]
Adding requests:  95%|█████████▌| 1950/2048 [00:07<00:00, 276.61it/s]
Adding requests:  97%|█████████▋| 1978/2048 [00:07<00:00, 276.18it/s]
Adding requests:  98%|█████████▊| 2006/2048 [00:07<00:00, 272.74it/s]
Adding requests:  99%|█████████▉| 2034/2048 [00:07<00:00, 257.96it/s]
Adding requests: 100%|██████████| 2048/2048 [00:07<00:00, 268.23it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   9%|▊         | 178/2048 [00:00<00:04, 390.91it/s, est. speed input: 400318.88 toks/s, output: 390.92 toks/s]
Processed prompts:  11%|█         | 218/2048 [00:01<00:17, 103.11it/s, est. speed input: 128818.73 toks/s, output: 125.80 toks/s]
Processed prompts:  12%|█▏        | 236/2048 [00:02<00:24, 75.21it/s, est. speed input: 101245.93 toks/s, output: 98.87 toks/s]  
Processed prompts:  12%|█▏        | 248/2048 [00:03<00:32, 55.56it/s, est. speed input: 83497.49 toks/s, output: 81.54 toks/s] 
Processed prompts:  13%|█▎        | 258/2048 [00:03<00:42, 42.25it/s, est. speed input: 71483.98 toks/s, output: 69.81 toks/s]
Processed prompts:  13%|█▎        | 274/2048 [00:04<00:48, 36.55it/s, est. speed input: 64506.00 toks/s, output: 62.99 toks/s]
Processed prompts:  14%|█▍        | 290/2048 [00:05<00:53, 32.72it/s, est. speed input: 59320.09 toks/s, output: 57.93 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [00:05<00:57, 30.15it/s, est. speed input: 55348.37 toks/s, output: 54.05 toks/s]
Processed prompts:  16%|█▌        | 322/2048 [00:06<01:00, 28.38it/s, est. speed input: 52194.40 toks/s, output: 50.97 toks/s]
Processed prompts:  17%|█▋        | 338/2048 [00:06<01:02, 27.16it/s, est. speed input: 49632.30 toks/s, output: 48.47 toks/s]
Processed prompts:  17%|█▋        | 354/2048 [00:07<01:04, 26.31it/s, est. speed input: 47509.61 toks/s, output: 46.40 toks/s]
Processed prompts:  18%|█▊        | 370/2048 [00:08<01:05, 25.72it/s, est. speed input: 45721.75 toks/s, output: 44.65 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [00:08<01:05, 25.31it/s, est. speed input: 44193.92 toks/s, output: 43.16 toks/s]
Processed prompts:  20%|█▉        | 402/2048 [00:09<01:05, 25.02it/s, est. speed input: 42875.02 toks/s, output: 41.87 toks/s]
Processed prompts:  20%|██        | 418/2048 [00:10<01:05, 24.81it/s, est. speed input: 41723.47 toks/s, output: 40.75 toks/s]
Processed prompts:  21%|██        | 434/2048 [00:10<01:05, 24.67it/s, est. speed input: 40710.92 toks/s, output: 39.76 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [00:11<01:05, 24.49it/s, est. speed input: 39789.31 toks/s, output: 38.86 toks/s]
Processed prompts:  23%|██▎       | 466/2048 [00:12<01:04, 24.43it/s, est. speed input: 38988.06 toks/s, output: 38.07 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [00:12<01:04, 24.39it/s, est. speed input: 38268.22 toks/s, output: 37.37 toks/s]
Processed prompts:  24%|██▍       | 498/2048 [00:13<01:03, 24.36it/s, est. speed input: 37617.04 toks/s, output: 36.74 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [00:14<01:03, 24.34it/s, est. speed input: 37026.73 toks/s, output: 36.16 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [00:14<01:02, 24.31it/s, est. speed input: 36486.80 toks/s, output: 35.63 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [00:15<01:01, 24.31it/s, est. speed input: 35994.24 toks/s, output: 35.15 toks/s]
Processed prompts:  27%|██▋       | 562/2048 [00:16<01:01, 24.29it/s, est. speed input: 35539.92 toks/s, output: 34.71 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [00:16<01:00, 24.28it/s, est. speed input: 35120.74 toks/s, output: 34.30 toks/s]
Processed prompts:  31%|███       | 626/2048 [00:17<00:35, 40.12it/s, est. speed input: 36752.82 toks/s, output: 35.89 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [00:18<00:39, 35.26it/s, est. speed input: 36319.34 toks/s, output: 35.47 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [00:18<00:43, 31.91it/s, est. speed input: 35916.70 toks/s, output: 35.07 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [00:19<00:46, 29.60it/s, est. speed input: 35541.87 toks/s, output: 34.71 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [00:20<00:48, 27.99it/s, est. speed input: 35191.73 toks/s, output: 34.37 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [00:20<00:49, 26.88it/s, est. speed input: 34864.37 toks/s, output: 34.05 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [00:21<00:50, 26.10it/s, est. speed input: 34557.35 toks/s, output: 33.75 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [00:22<00:51, 25.57it/s, est. speed input: 34268.94 toks/s, output: 33.47 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [00:22<00:51, 25.20it/s, est. speed input: 33998.36 toks/s, output: 33.20 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [00:23<00:51, 24.92it/s, est. speed input: 33741.15 toks/s, output: 32.95 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [00:23<00:50, 25.10it/s, est. speed input: 33542.79 toks/s, output: 32.76 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [00:24<00:50, 24.87it/s, est. speed input: 33312.91 toks/s, output: 32.53 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [00:25<00:49, 24.71it/s, est. speed input: 33094.84 toks/s, output: 32.32 toks/s]
Processed prompts:  41%|████      | 834/2048 [00:25<00:49, 24.60it/s, est. speed input: 32888.28 toks/s, output: 32.12 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [00:26<00:48, 24.52it/s, est. speed input: 32691.66 toks/s, output: 31.93 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [00:27<00:48, 24.47it/s, est. speed input: 32504.63 toks/s, output: 31.74 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [00:27<00:47, 24.43it/s, est. speed input: 32326.51 toks/s, output: 31.57 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [00:28<00:47, 24.41it/s, est. speed input: 32156.61 toks/s, output: 31.40 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [00:29<00:46, 24.39it/s, est. speed input: 31994.05 toks/s, output: 31.24 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [00:29<00:45, 24.37it/s, est. speed input: 31838.24 toks/s, output: 31.09 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [00:30<00:45, 24.36it/s, est. speed input: 31689.57 toks/s, output: 30.95 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [00:31<00:44, 24.35it/s, est. speed input: 31546.68 toks/s, output: 30.81 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [00:31<00:43, 24.34it/s, est. speed input: 31409.68 toks/s, output: 30.67 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [00:32<00:43, 24.34it/s, est. speed input: 31278.30 toks/s, output: 30.55 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [00:33<00:42, 24.33it/s, est. speed input: 31151.91 toks/s, output: 30.42 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [00:33<00:42, 24.33it/s, est. speed input: 31030.49 toks/s, output: 30.30 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [00:34<00:41, 24.32it/s, est. speed input: 30913.30 toks/s, output: 30.19 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [00:35<00:40, 24.32it/s, est. speed input: 30800.64 toks/s, output: 30.08 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [00:35<00:40, 24.31it/s, est. speed input: 30691.98 toks/s, output: 29.97 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [00:36<00:39, 24.31it/s, est. speed input: 30587.41 toks/s, output: 29.87 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [00:37<00:38, 24.31it/s, est. speed input: 30486.57 toks/s, output: 29.77 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [00:37<00:38, 24.31it/s, est. speed input: 30389.28 toks/s, output: 29.68 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [00:38<00:37, 24.31it/s, est. speed input: 30295.19 toks/s, output: 29.59 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [00:39<00:36, 24.31it/s, est. speed input: 30204.42 toks/s, output: 29.50 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [00:39<00:36, 24.32it/s, est. speed input: 30116.84 toks/s, output: 29.41 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [00:40<00:35, 24.31it/s, est. speed input: 30031.68 toks/s, output: 29.33 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [00:41<00:34, 24.32it/s, est. speed input: 29950.16 toks/s, output: 29.25 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [00:41<00:34, 24.31it/s, est. speed input: 29869.99 toks/s, output: 29.17 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [00:42<00:33, 24.32it/s, est. speed input: 29793.23 toks/s, output: 29.09 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [00:43<00:32, 24.32it/s, est. speed input: 29718.59 toks/s, output: 29.02 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [00:43<00:32, 24.32it/s, est. speed input: 29646.19 toks/s, output: 28.95 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [00:44<00:31, 24.32it/s, est. speed input: 29576.07 toks/s, output: 28.88 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [00:45<00:30, 24.32it/s, est. speed input: 29507.91 toks/s, output: 28.82 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [00:45<00:30, 24.32it/s, est. speed input: 29441.62 toks/s, output: 28.75 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [00:46<00:29, 24.32it/s, est. speed input: 29377.05 toks/s, output: 28.69 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [00:47<00:28, 24.32it/s, est. speed input: 29314.61 toks/s, output: 28.63 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [00:47<00:28, 24.32it/s, est. speed input: 29253.84 toks/s, output: 28.57 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [00:48<00:27, 24.33it/s, est. speed input: 29194.84 toks/s, output: 28.51 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [00:48<00:15, 40.46it/s, est. speed input: 29856.85 toks/s, output: 29.16 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [00:49<00:17, 35.50it/s, est. speed input: 29791.74 toks/s, output: 29.09 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [00:50<00:18, 32.11it/s, est. speed input: 29728.76 toks/s, output: 29.03 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [00:50<00:19, 29.76it/s, est. speed input: 29667.37 toks/s, output: 28.97 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [00:51<00:19, 28.13it/s, est. speed input: 29607.48 toks/s, output: 28.91 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [00:52<00:20, 27.00it/s, est. speed input: 29548.96 toks/s, output: 28.86 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [00:52<00:20, 26.21it/s, est. speed input: 29491.89 toks/s, output: 28.80 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [00:53<00:19, 25.66it/s, est. speed input: 29436.34 toks/s, output: 28.75 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [00:54<00:19, 25.27it/s, est. speed input: 29382.15 toks/s, output: 28.69 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [00:54<00:19, 25.00it/s, est. speed input: 29329.13 toks/s, output: 28.64 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [00:55<00:18, 24.81it/s, est. speed input: 29277.27 toks/s, output: 28.59 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [00:56<00:18, 24.68it/s, est. speed input: 29226.80 toks/s, output: 28.54 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [00:56<00:17, 24.94it/s, est. speed input: 29193.27 toks/s, output: 28.51 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [00:57<00:16, 24.75it/s, est. speed input: 29144.30 toks/s, output: 28.46 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [00:58<00:16, 24.60it/s, est. speed input: 29095.17 toks/s, output: 28.41 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [00:58<00:15, 24.50it/s, est. speed input: 29047.60 toks/s, output: 28.37 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [00:59<00:14, 24.41it/s, est. speed input: 29000.17 toks/s, output: 28.32 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [01:00<00:14, 24.37it/s, est. speed input: 28954.79 toks/s, output: 28.28 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [01:00<00:13, 24.32it/s, est. speed input: 28909.36 toks/s, output: 28.23 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [01:01<00:13, 24.30it/s, est. speed input: 28865.40 toks/s, output: 28.19 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [01:02<00:12, 24.28it/s, est. speed input: 28822.41 toks/s, output: 28.15 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [01:02<00:11, 24.27it/s, est. speed input: 28780.27 toks/s, output: 28.11 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [01:03<00:11, 24.26it/s, est. speed input: 28739.00 toks/s, output: 28.07 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [01:04<00:10, 24.25it/s, est. speed input: 28698.43 toks/s, output: 28.03 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [01:04<00:09, 24.25it/s, est. speed input: 28658.84 toks/s, output: 27.99 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [01:05<00:09, 24.24it/s, est. speed input: 28619.92 toks/s, output: 27.95 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [01:05<00:08, 24.25it/s, est. speed input: 28582.13 toks/s, output: 27.91 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [01:06<00:07, 24.25it/s, est. speed input: 28545.22 toks/s, output: 27.88 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [01:07<00:07, 24.27it/s, est. speed input: 28509.37 toks/s, output: 27.84 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [01:07<00:06, 24.25it/s, est. speed input: 28473.29 toks/s, output: 27.81 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [01:08<00:05, 24.25it/s, est. speed input: 28438.36 toks/s, output: 27.77 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [01:09<00:05, 24.26it/s, est. speed input: 28404.17 toks/s, output: 27.74 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [01:09<00:04, 24.26it/s, est. speed input: 28370.54 toks/s, output: 27.71 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [01:10<00:03, 24.25it/s, est. speed input: 28337.50 toks/s, output: 27.67 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [01:11<00:03, 24.25it/s, est. speed input: 28305.09 toks/s, output: 27.64 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [01:11<00:02, 24.25it/s, est. speed input: 28273.25 toks/s, output: 27.61 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [01:12<00:01, 24.25it/s, est. speed input: 28241.98 toks/s, output: 27.58 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [01:13<00:01, 24.25it/s, est. speed input: 28211.28 toks/s, output: 27.55 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [01:13<00:00, 24.68it/s, est. speed input: 28195.56 toks/s, output: 27.53 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [01:13<00:00, 24.68it/s, est. speed input: 28389.46 toks/s, output: 27.72 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [01:13<00:00, 27.72it/s, est. speed input: 28389.46 toks/s, output: 27.72 toks/s]
[rank0]:[W126 03:46:43.568760788 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 143.7s

测试结果:
  Requests/s:   24.30
  Tokens/s:     24902.74
  Total Reqs:   2048
  Elapsed:      84.30s

  [Prefill 分析]
  Total Prefill Tokens: 2097152
  Prefill Tokens/s:     24878.45

============================================================
[7/8] 测试 M=32768
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 32768
│   M_prefill     = 32768 (= 32 x 1024)
│   M_decode      = 32
│   batched_tokens = 32768 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 4096
│   --max-num-seqs           = 32
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 32768
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 03:47:20 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 03:47:21 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=136857) WARNING 01-26 03:47:29 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=136857) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=136857) WARNING 01-26 03:47:41 [backends.py:609] Failed to read file <frozen os>
Throughput: 8.07 requests/s, 8276.57 total tokens/s, 8.07 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096


─── STDERR ───
[2026-01-26 03:47:20] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:47:20] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:47:20] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:47:20] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:47:20] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:47:20] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:47:20] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:47:20] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:47:20] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:47:20] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:47:20] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:47:20] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:47:20] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:47:20] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 03:47:28] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:47:28] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:47:28] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:47:28] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:47:28] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:47:28] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:47:28] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:47:28] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:47:28] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:47:28] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:47:28] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:47:28] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:47:28] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:47:28] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=136857) [2026-01-26 03:47:29] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=136857) [2026-01-26 03:47:29] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=136857) [2026-01-26 03:47:29] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=136857) [2026-01-26 03:47:29] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=136857) [2026-01-26 03:47:29] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=136857) [2026-01-26 03:47:29] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=136857) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=136857) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.40it/s]
(EngineCore_DP0 pid=136857) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.13it/s]
(EngineCore_DP0 pid=136857) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.17it/s]
(EngineCore_DP0 pid=136857) 
(EngineCore_DP0 pid=136857) [2026-01-26 03:47:32] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 3584] -> 1D uint8
(EngineCore_DP0 pid=136857) [2026-01-26 03:47:32] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12386304 bytes
(EngineCore_DP0 pid=136857) [2026-01-26 03:47:32] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 3584] -> 1D uint8
(EngineCore_DP0 pid=136857) [2026-01-26 03:47:32] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 9633792 bytes
(EngineCore_DP0 pid=136857) [2026-01-26 03:47:32] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 3584] -> 1D uint8
(EngineCore_DP0 pid=136857) [2026-01-26 03:47:32] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 101842944 bytes
(EngineCore_DP0 pid=136857) [2026-01-26 03:47:32] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 18944] -> 1D uint8
(EngineCore_DP0 pid=136857) [2026-01-26 03:47:32] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 50921472 bytes
(EngineCore_DP0 pid=136857) [rank0]:W0126 03:47:49.712000 136857 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=136857) [rank0]:W0126 03:47:49.821000 136857 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=136857) [rank0]:W0126 03:47:49.895000 136857 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=136857) [rank0]:W0126 03:47:50.076000 136857 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=136857) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   9%|▉         | 1/11 [00:00<00:01,  8.09it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  18%|█▊        | 2/11 [00:00<00:01,  8.36it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  27%|██▋       | 3/11 [00:00<00:00,  8.70it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  36%|███▋      | 4/11 [00:00<00:00,  8.88it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  45%|████▌     | 5/11 [00:00<00:00,  8.66it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  55%|█████▍    | 6/11 [00:00<00:00,  6.99it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  64%|██████▎   | 7/11 [00:00<00:00,  7.04it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  73%|███████▎  | 8/11 [00:01<00:00,  6.76it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  82%|████████▏ | 9/11 [00:01<00:00,  7.29it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  91%|█████████ | 10/11 [00:01<00:00,  7.72it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00,  7.60it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00,  7.64it/s]
(EngineCore_DP0 pid=136857) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  14%|█▍        | 1/7 [00:00<00:00,  7.00it/s]
Capturing CUDA graphs (decode, FULL):  29%|██▊       | 2/7 [00:00<00:00,  8.16it/s]
Capturing CUDA graphs (decode, FULL):  43%|████▎     | 3/7 [00:00<00:00,  8.72it/s]
Capturing CUDA graphs (decode, FULL):  57%|█████▋    | 4/7 [00:00<00:00,  8.96it/s]
Capturing CUDA graphs (decode, FULL):  71%|███████▏  | 5/7 [00:00<00:00,  9.19it/s]
Capturing CUDA graphs (decode, FULL):  86%|████████▌ | 6/7 [00:00<00:00,  9.29it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00,  9.38it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00,  9.01it/s]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   1%|          | 23/4096 [00:00<00:17, 229.93it/s]
Adding requests:   1%|          | 49/4096 [00:00<00:16, 243.04it/s]
Adding requests:   2%|▏         | 76/4096 [00:00<00:16, 250.58it/s]
Adding requests:   2%|▏         | 102/4096 [00:00<00:15, 253.17it/s]
Adding requests:   3%|▎         | 128/4096 [00:00<00:16, 244.23it/s]
Adding requests:   4%|▎         | 153/4096 [00:00<00:16, 238.15it/s]
Adding requests:   4%|▍         | 178/4096 [00:00<00:16, 240.67it/s]
Adding requests:   5%|▌         | 207/4096 [00:00<00:15, 254.06it/s]
Adding requests:   6%|▌         | 233/4096 [00:00<00:15, 245.22it/s]
Adding requests:   6%|▋         | 259/4096 [00:01<00:15, 248.51it/s]
Adding requests:   7%|▋         | 286/4096 [00:01<00:14, 254.74it/s]
Adding requests:   8%|▊         | 312/4096 [00:01<00:15, 248.74it/s]
Adding requests:   8%|▊         | 339/4096 [00:01<00:14, 254.10it/s]
Adding requests:   9%|▉         | 365/4096 [00:01<00:14, 250.60it/s]
Adding requests:  10%|▉         | 391/4096 [00:01<00:14, 249.48it/s]
Adding requests:  10%|█         | 420/4096 [00:01<00:14, 260.06it/s]
Adding requests:  11%|█         | 447/4096 [00:01<00:14, 246.57it/s]
Adding requests:  12%|█▏        | 476/4096 [00:01<00:14, 257.71it/s]
Adding requests:  12%|█▏        | 505/4096 [00:02<00:13, 265.57it/s]
Adding requests:  13%|█▎        | 532/4096 [00:02<00:13, 263.12it/s]
Adding requests:  14%|█▎        | 561/4096 [00:02<00:13, 269.41it/s]
Adding requests:  14%|█▍        | 589/4096 [00:02<00:13, 259.28it/s]
Adding requests:  15%|█▌        | 616/4096 [00:02<00:13, 256.06it/s]
Adding requests:  16%|█▌        | 643/4096 [00:02<00:13, 257.07it/s]
Adding requests:  16%|█▋        | 669/4096 [00:02<00:14, 241.59it/s]
Adding requests:  17%|█▋        | 697/4096 [00:02<00:13, 249.64it/s]
Adding requests:  18%|█▊        | 723/4096 [00:02<00:13, 245.94it/s]
Adding requests:  18%|█▊        | 748/4096 [00:02<00:13, 239.88it/s]
Adding requests:  19%|█▉        | 775/4096 [00:03<00:13, 248.03it/s]
Adding requests:  20%|█▉        | 800/4096 [00:03<00:13, 241.68it/s]
Adding requests:  20%|██        | 827/4096 [00:03<00:13, 247.36it/s]
Adding requests:  21%|██        | 855/4096 [00:03<00:12, 253.01it/s]
Adding requests:  22%|██▏       | 881/4096 [00:03<00:13, 242.85it/s]
Adding requests:  22%|██▏       | 909/4096 [00:03<00:12, 251.36it/s]
Adding requests:  23%|██▎       | 935/4096 [00:03<00:12, 244.61it/s]
Adding requests:  23%|██▎       | 960/4096 [00:03<00:12, 245.77it/s]
Adding requests:  24%|██▍       | 987/4096 [00:03<00:12, 252.37it/s]
Adding requests:  25%|██▍       | 1013/4096 [00:04<00:14, 212.99it/s]
Adding requests:  25%|██▌       | 1036/4096 [00:04<00:14, 206.37it/s]
Adding requests:  26%|██▌       | 1058/4096 [00:04<00:15, 191.53it/s]
Adding requests:  26%|██▋       | 1078/4096 [00:04<00:15, 190.92it/s]
Adding requests:  27%|██▋       | 1103/4096 [00:04<00:14, 204.91it/s]
Adding requests:  28%|██▊       | 1127/4096 [00:04<00:13, 214.04it/s]
Adding requests:  28%|██▊       | 1154/4096 [00:04<00:12, 228.23it/s]
Adding requests:  29%|██▉       | 1180/4096 [00:04<00:12, 235.92it/s]
Adding requests:  29%|██▉       | 1204/4096 [00:04<00:12, 228.31it/s]
Adding requests:  30%|███       | 1234/4096 [00:05<00:11, 246.85it/s]
Adding requests:  31%|███       | 1259/4096 [00:05<00:11, 240.69it/s]
Adding requests:  31%|███▏      | 1286/4096 [00:05<00:11, 247.62it/s]
Adding requests:  32%|███▏      | 1314/4096 [00:05<00:10, 254.10it/s]
Adding requests:  33%|███▎      | 1340/4096 [00:05<00:11, 245.97it/s]
Adding requests:  33%|███▎      | 1369/4096 [00:05<00:10, 257.67it/s]
Adding requests:  34%|███▍      | 1395/4096 [00:05<00:10, 256.46it/s]
Adding requests:  35%|███▍      | 1421/4096 [00:05<00:10, 250.07it/s]
Adding requests:  35%|███▌      | 1448/4096 [00:05<00:10, 253.16it/s]
Adding requests:  36%|███▌      | 1474/4096 [00:06<00:10, 246.38it/s]
Adding requests:  37%|███▋      | 1502/4096 [00:06<00:10, 255.90it/s]
Adding requests:  37%|███▋      | 1529/4096 [00:06<00:09, 259.92it/s]
Adding requests:  38%|███▊      | 1556/4096 [00:06<00:10, 245.75it/s]
Adding requests:  39%|███▊      | 1581/4096 [00:06<00:10, 245.49it/s]
Adding requests:  39%|███▉      | 1606/4096 [00:06<00:10, 238.75it/s]
Adding requests:  40%|███▉      | 1631/4096 [00:06<00:10, 234.87it/s]
Adding requests:  40%|████      | 1656/4096 [00:06<00:10, 236.05it/s]
Adding requests:  41%|████      | 1680/4096 [00:06<00:10, 228.85it/s]
Adding requests:  42%|████▏     | 1708/4096 [00:07<00:09, 242.16it/s]
Adding requests:  42%|████▏     | 1734/4096 [00:07<00:09, 244.74it/s]
Adding requests:  43%|████▎     | 1759/4096 [00:07<00:09, 245.65it/s]
Adding requests:  44%|████▎     | 1788/4096 [00:07<00:08, 256.92it/s]
Adding requests:  44%|████▍     | 1814/4096 [00:07<00:09, 248.71it/s]
Adding requests:  45%|████▍     | 1839/4096 [00:07<00:09, 248.37it/s]
Adding requests:  46%|████▌     | 1867/4096 [00:07<00:08, 255.48it/s]
Adding requests:  46%|████▌     | 1893/4096 [00:07<00:08, 248.53it/s]
Adding requests:  47%|████▋     | 1922/4096 [00:07<00:08, 259.53it/s]
Adding requests:  48%|████▊     | 1950/4096 [00:07<00:08, 264.91it/s]
Adding requests:  48%|████▊     | 1977/4096 [00:08<00:08, 255.12it/s]
Adding requests:  49%|████▉     | 2003/4096 [00:08<00:08, 256.02it/s]
Adding requests:  50%|████▉     | 2029/4096 [00:08<00:08, 246.90it/s]
Adding requests:  50%|█████     | 2055/4096 [00:08<00:08, 250.13it/s]
Adding requests:  51%|█████     | 2081/4096 [00:08<00:08, 249.18it/s]
Adding requests:  51%|█████▏    | 2106/4096 [00:08<00:08, 243.62it/s]
Adding requests:  52%|█████▏    | 2132/4096 [00:08<00:07, 248.14it/s]
Adding requests:  53%|█████▎    | 2158/4096 [00:08<00:07, 250.93it/s]
Adding requests:  53%|█████▎    | 2184/4096 [00:08<00:07, 241.96it/s]
Adding requests:  54%|█████▍    | 2209/4096 [00:09<00:07, 242.70it/s]
Adding requests:  55%|█████▍    | 2234/4096 [00:09<00:07, 241.34it/s]
Adding requests:  55%|█████▌    | 2260/4096 [00:09<00:07, 244.42it/s]
Adding requests:  56%|█████▌    | 2288/4096 [00:09<00:07, 253.25it/s]
Adding requests:  56%|█████▋    | 2314/4096 [00:09<00:07, 245.54it/s]
Adding requests:  57%|█████▋    | 2342/4096 [00:09<00:06, 253.02it/s]
Adding requests:  58%|█████▊    | 2368/4096 [00:09<00:06, 254.36it/s]
Adding requests:  58%|█████▊    | 2394/4096 [00:09<00:06, 248.30it/s]
Adding requests:  59%|█████▉    | 2423/4096 [00:09<00:06, 257.53it/s]
Adding requests:  60%|█████▉    | 2449/4096 [00:09<00:06, 245.27it/s]
Adding requests:  60%|██████    | 2476/4096 [00:10<00:06, 250.09it/s]
Adding requests:  61%|██████    | 2505/4096 [00:10<00:06, 258.93it/s]
Adding requests:  62%|██████▏   | 2531/4096 [00:10<00:06, 256.83it/s]
Adding requests:  62%|██████▎   | 2560/4096 [00:10<00:05, 266.18it/s]
Adding requests:  63%|██████▎   | 2590/4096 [00:10<00:05, 272.41it/s]
Adding requests:  64%|██████▍   | 2618/4096 [00:10<00:05, 257.54it/s]
Adding requests:  65%|██████▍   | 2645/4096 [00:10<00:05, 259.93it/s]
Adding requests:  65%|██████▌   | 2672/4096 [00:10<00:05, 251.36it/s]
Adding requests:  66%|██████▌   | 2698/4096 [00:10<00:05, 251.02it/s]
Adding requests:  67%|██████▋   | 2726/4096 [00:11<00:05, 257.03it/s]
Adding requests:  67%|██████▋   | 2752/4096 [00:11<00:05, 251.46it/s]
Adding requests:  68%|██████▊   | 2782/4096 [00:11<00:04, 264.24it/s]
Adding requests:  69%|██████▊   | 2811/4096 [00:11<00:04, 269.24it/s]
Adding requests:  69%|██████▉   | 2839/4096 [00:11<00:04, 262.91it/s]
Adding requests:  70%|██████▉   | 2867/4096 [00:11<00:04, 266.17it/s]
Adding requests:  71%|███████   | 2894/4096 [00:11<00:04, 258.24it/s]
Adding requests:  71%|███████▏  | 2920/4096 [00:11<00:04, 258.22it/s]
Adding requests:  72%|███████▏  | 2949/4096 [00:11<00:04, 266.85it/s]
Adding requests:  73%|███████▎  | 2976/4096 [00:12<00:04, 255.55it/s]
Adding requests:  73%|███████▎  | 3005/4096 [00:12<00:04, 263.07it/s]
Adding requests:  74%|███████▍  | 3032/4096 [00:12<00:04, 263.17it/s]
Adding requests:  75%|███████▍  | 3059/4096 [00:12<00:04, 255.74it/s]
Adding requests:  75%|███████▌  | 3087/4096 [00:12<00:03, 261.46it/s]
Adding requests:  76%|███████▌  | 3114/4096 [00:12<00:03, 255.95it/s]
Adding requests:  77%|███████▋  | 3140/4096 [00:12<00:03, 256.11it/s]
Adding requests:  77%|███████▋  | 3167/4096 [00:12<00:03, 259.11it/s]
Adding requests:  78%|███████▊  | 3193/4096 [00:12<00:03, 245.14it/s]
Adding requests:  79%|███████▊  | 3221/4096 [00:12<00:03, 252.94it/s]
Adding requests:  79%|███████▉  | 3250/4096 [00:13<00:03, 262.78it/s]
Adding requests:  80%|████████  | 3277/4096 [00:13<00:03, 247.85it/s]
Adding requests:  81%|████████  | 3303/4096 [00:13<00:03, 250.52it/s]
Adding requests:  81%|████████▏ | 3329/4096 [00:13<00:03, 244.90it/s]
Adding requests:  82%|████████▏ | 3356/4096 [00:13<00:02, 250.32it/s]
Adding requests:  83%|████████▎ | 3385/4096 [00:13<00:02, 261.32it/s]
Adding requests:  83%|████████▎ | 3412/4096 [00:13<00:02, 251.77it/s]
Adding requests:  84%|████████▍ | 3441/4096 [00:13<00:02, 260.20it/s]
Adding requests:  85%|████████▍ | 3469/4096 [00:13<00:02, 263.44it/s]
Adding requests:  85%|████████▌ | 3496/4096 [00:14<00:02, 252.17it/s]
Adding requests:  86%|████████▌ | 3527/4096 [00:14<00:02, 266.25it/s]
Adding requests:  87%|████████▋ | 3554/4096 [00:14<00:02, 261.23it/s]
Adding requests:  87%|████████▋ | 3581/4096 [00:14<00:01, 259.13it/s]
Adding requests:  88%|████████▊ | 3608/4096 [00:14<00:01, 262.05it/s]
Adding requests:  89%|████████▊ | 3635/4096 [00:14<00:01, 256.61it/s]
Adding requests:  89%|████████▉ | 3662/4096 [00:14<00:01, 260.13it/s]
Adding requests:  90%|█████████ | 3689/4096 [00:14<00:01, 257.16it/s]
Adding requests:  91%|█████████ | 3715/4096 [00:14<00:01, 254.54it/s]
Adding requests:  91%|█████████▏| 3742/4096 [00:14<00:01, 257.68it/s]
Adding requests:  92%|█████████▏| 3768/4096 [00:15<00:01, 245.93it/s]
Adding requests:  93%|█████████▎| 3793/4096 [00:15<00:01, 241.30it/s]
Adding requests:  93%|█████████▎| 3818/4096 [00:15<00:01, 229.16it/s]
Adding requests:  94%|█████████▍| 3842/4096 [00:15<00:01, 230.18it/s]
Adding requests:  94%|█████████▍| 3869/4096 [00:15<00:00, 241.10it/s]
Adding requests:  95%|█████████▌| 3894/4096 [00:15<00:00, 234.90it/s]
Adding requests:  96%|█████████▌| 3918/4096 [00:15<00:00, 233.09it/s]
Adding requests:  96%|█████████▋| 3945/4096 [00:15<00:00, 242.12it/s]
Adding requests:  97%|█████████▋| 3970/4096 [00:15<00:00, 232.41it/s]
Adding requests:  98%|█████████▊| 3996/4096 [00:16<00:00, 240.06it/s]
Adding requests:  98%|█████████▊| 4022/4096 [00:16<00:00, 242.29it/s]
Adding requests:  99%|█████████▉| 4047/4096 [00:16<00:00, 237.66it/s]
Adding requests:  99%|█████████▉| 4075/4096 [00:16<00:00, 248.78it/s]
Adding requests: 100%|██████████| 4096/4096 [00:16<00:00, 248.58it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   3%|▎         | 130/4096 [00:03<01:57, 33.71it/s, est. speed input: 34518.53 toks/s, output: 33.71 toks/s]
Processed prompts:   4%|▍         | 162/4096 [00:06<02:48, 23.33it/s, est. speed input: 25806.25 toks/s, output: 25.20 toks/s]
Processed prompts:   5%|▍         | 194/4096 [00:10<04:12, 15.43it/s, est. speed input: 19117.91 toks/s, output: 18.67 toks/s]
Processed prompts:   6%|▌         | 226/4096 [00:14<05:14, 12.30it/s, est. speed input: 16121.84 toks/s, output: 15.74 toks/s]
Processed prompts:   6%|▋         | 258/4096 [00:18<05:58, 10.70it/s, est. speed input: 14422.61 toks/s, output: 14.08 toks/s]
Processed prompts:   7%|▋         | 290/4096 [00:22<06:29,  9.78it/s, est. speed input: 13327.63 toks/s, output: 13.02 toks/s]
Processed prompts:   8%|▊         | 322/4096 [00:26<06:49,  9.21it/s, est. speed input: 12564.10 toks/s, output: 12.27 toks/s]
Processed prompts:   9%|▊         | 354/4096 [00:30<07:03,  8.84it/s, est. speed input: 11999.09 toks/s, output: 11.72 toks/s]
Processed prompts:   9%|▉         | 386/4096 [00:34<07:11,  8.60it/s, est. speed input: 11566.02 toks/s, output: 11.29 toks/s]
Processed prompts:  10%|█         | 418/4096 [00:36<06:28,  9.47it/s, est. speed input: 11647.42 toks/s, output: 11.37 toks/s]
Processed prompts:  11%|█         | 450/4096 [00:40<06:44,  9.00it/s, est. speed input: 11318.06 toks/s, output: 11.05 toks/s]
Processed prompts:  12%|█▏        | 482/4096 [00:44<06:55,  8.70it/s, est. speed input: 11046.83 toks/s, output: 10.79 toks/s]
Processed prompts:  13%|█▎        | 514/4096 [00:48<07:01,  8.50it/s, est. speed input: 10819.81 toks/s, output: 10.57 toks/s]
Processed prompts:  13%|█▎        | 546/4096 [00:52<07:04,  8.37it/s, est. speed input: 10626.88 toks/s, output: 10.38 toks/s]
Processed prompts:  14%|█▍        | 578/4096 [00:56<07:05,  8.28it/s, est. speed input: 10461.08 toks/s, output: 10.22 toks/s]
Processed prompts:  15%|█▍        | 610/4096 [01:00<07:04,  8.21it/s, est. speed input: 10317.02 toks/s, output: 10.08 toks/s]
Processed prompts:  16%|█▌        | 642/4096 [01:04<07:02,  8.17it/s, est. speed input: 10190.60 toks/s, output: 9.95 toks/s] 
Processed prompts:  16%|█▋        | 674/4096 [01:07<06:16,  9.10it/s, est. speed input: 10287.09 toks/s, output: 10.05 toks/s]
Processed prompts:  17%|█▋        | 706/4096 [01:11<06:26,  8.76it/s, est. speed input: 10174.13 toks/s, output: 9.94 toks/s] 
Processed prompts:  18%|█▊        | 738/4096 [01:15<06:33,  8.54it/s, est. speed input: 10073.11 toks/s, output: 9.84 toks/s]
Processed prompts:  19%|█▉        | 770/4096 [01:18<06:29,  8.53it/s, est. speed input: 10007.53 toks/s, output: 9.77 toks/s]
Processed prompts:  20%|█▉        | 802/4096 [01:22<06:32,  8.38it/s, est. speed input: 9923.68 toks/s, output: 9.69 toks/s] 
Processed prompts:  20%|██        | 834/4096 [01:26<06:33,  8.29it/s, est. speed input: 9847.53 toks/s, output: 9.62 toks/s]
Processed prompts:  21%|██        | 866/4096 [01:30<06:33,  8.22it/s, est. speed input: 9777.81 toks/s, output: 9.55 toks/s]
Processed prompts:  22%|██▏       | 898/4096 [01:34<06:31,  8.17it/s, est. speed input: 9714.04 toks/s, output: 9.49 toks/s]
Processed prompts:  23%|██▎       | 930/4096 [01:38<06:29,  8.14it/s, est. speed input: 9655.35 toks/s, output: 9.43 toks/s]
Processed prompts:  23%|██▎       | 962/4096 [01:41<05:45,  9.08it/s, est. speed input: 9734.10 toks/s, output: 9.51 toks/s]
Processed prompts:  24%|██▍       | 994/4096 [01:45<05:54,  8.75it/s, est. speed input: 9678.65 toks/s, output: 9.45 toks/s]
Processed prompts:  25%|██▌       | 1026/4096 [01:49<05:59,  8.54it/s, est. speed input: 9627.09 toks/s, output: 9.40 toks/s]
Processed prompts:  26%|██▌       | 1058/4096 [01:53<06:02,  8.39it/s, est. speed input: 9578.86 toks/s, output: 9.35 toks/s]
Processed prompts:  27%|██▋       | 1090/4096 [01:57<06:02,  8.28it/s, est. speed input: 9533.75 toks/s, output: 9.31 toks/s]
Processed prompts:  27%|██▋       | 1122/4096 [02:01<06:02,  8.21it/s, est. speed input: 9491.55 toks/s, output: 9.27 toks/s]
Processed prompts:  28%|██▊       | 1154/4096 [02:05<06:00,  8.17it/s, est. speed input: 9452.16 toks/s, output: 9.23 toks/s]
Processed prompts:  29%|██▉       | 1186/4096 [02:08<05:57,  8.14it/s, est. speed input: 9415.36 toks/s, output: 9.19 toks/s]
Processed prompts:  30%|██▉       | 1218/4096 [02:11<05:16,  9.08it/s, est. speed input: 9480.60 toks/s, output: 9.26 toks/s]
Processed prompts:  31%|███       | 1250/4096 [02:15<05:24,  8.76it/s, est. speed input: 9445.68 toks/s, output: 9.22 toks/s]
Processed prompts:  31%|███▏      | 1282/4096 [02:19<05:29,  8.54it/s, est. speed input: 9412.43 toks/s, output: 9.19 toks/s]
Processed prompts:  32%|███▏      | 1314/4096 [02:23<05:32,  8.38it/s, est. speed input: 9379.04 toks/s, output: 9.16 toks/s]
Processed prompts:  33%|███▎      | 1346/4096 [02:27<05:32,  8.27it/s, est. speed input: 9347.60 toks/s, output: 9.13 toks/s]
Processed prompts:  34%|███▎      | 1378/4096 [02:31<05:31,  8.20it/s, est. speed input: 9318.70 toks/s, output: 9.10 toks/s]
Processed prompts:  34%|███▍      | 1410/4096 [02:35<05:29,  8.16it/s, est. speed input: 9291.30 toks/s, output: 9.07 toks/s]
Processed prompts:  35%|███▌      | 1442/4096 [02:39<05:26,  8.13it/s, est. speed input: 9265.57 toks/s, output: 9.05 toks/s]
Processed prompts:  36%|███▌      | 1474/4096 [02:41<04:48,  9.09it/s, est. speed input: 9322.19 toks/s, output: 9.10 toks/s]
Processed prompts:  37%|███▋      | 1506/4096 [02:45<04:55,  8.76it/s, est. speed input: 9296.62 toks/s, output: 9.08 toks/s]
Processed prompts:  38%|███▊      | 1538/4096 [02:49<04:59,  8.53it/s, est. speed input: 9272.23 toks/s, output: 9.05 toks/s]
Processed prompts:  38%|███▊      | 1570/4096 [02:53<05:01,  8.39it/s, est. speed input: 9249.02 toks/s, output: 9.03 toks/s]
Processed prompts:  39%|███▉      | 1602/4096 [02:57<04:56,  8.42it/s, est. speed input: 9237.39 toks/s, output: 9.02 toks/s]
Processed prompts:  40%|███▉      | 1634/4096 [03:01<04:56,  8.31it/s, est. speed input: 9215.95 toks/s, output: 9.00 toks/s]
Processed prompts:  41%|████      | 1666/4096 [03:05<04:55,  8.23it/s, est. speed input: 9195.42 toks/s, output: 8.98 toks/s]
Processed prompts:  41%|████▏     | 1698/4096 [03:09<04:53,  8.18it/s, est. speed input: 9175.76 toks/s, output: 8.96 toks/s]
Processed prompts:  42%|████▏     | 1730/4096 [03:12<04:18,  9.15it/s, est. speed input: 9225.56 toks/s, output: 9.01 toks/s]
Processed prompts:  43%|████▎     | 1762/4096 [03:15<04:25,  8.80it/s, est. speed input: 9205.94 toks/s, output: 8.99 toks/s]
Processed prompts:  44%|████▍     | 1794/4096 [03:19<04:28,  8.56it/s, est. speed input: 9187.08 toks/s, output: 8.97 toks/s]
Processed prompts:  45%|████▍     | 1826/4096 [03:23<04:30,  8.41it/s, est. speed input: 9168.93 toks/s, output: 8.95 toks/s]
Processed prompts:  45%|████▌     | 1858/4096 [03:27<04:29,  8.30it/s, est. speed input: 9151.51 toks/s, output: 8.94 toks/s]
Processed prompts:  46%|████▌     | 1890/4096 [03:31<04:28,  8.23it/s, est. speed input: 9134.79 toks/s, output: 8.92 toks/s]
Processed prompts:  47%|████▋     | 1922/4096 [03:35<04:25,  8.18it/s, est. speed input: 9118.56 toks/s, output: 8.90 toks/s]
Processed prompts:  48%|████▊     | 1954/4096 [03:39<04:23,  8.14it/s, est. speed input: 9102.98 toks/s, output: 8.89 toks/s]
Processed prompts:  48%|████▊     | 1986/4096 [03:42<03:53,  9.05it/s, est. speed input: 9143.23 toks/s, output: 8.93 toks/s]
Processed prompts:  49%|████▉     | 2018/4096 [03:46<03:58,  8.73it/s, est. speed input: 9127.68 toks/s, output: 8.91 toks/s]
Processed prompts:  50%|█████     | 2050/4096 [03:50<04:00,  8.52it/s, est. speed input: 9112.65 toks/s, output: 8.90 toks/s]
Processed prompts:  51%|█████     | 2082/4096 [03:54<04:00,  8.38it/s, est. speed input: 9098.13 toks/s, output: 8.88 toks/s]
Processed prompts:  52%|█████▏    | 2114/4096 [03:58<03:59,  8.28it/s, est. speed input: 9084.11 toks/s, output: 8.87 toks/s]
Processed prompts:  52%|█████▏    | 2146/4096 [04:02<03:57,  8.21it/s, est. speed input: 9070.55 toks/s, output: 8.86 toks/s]
Processed prompts:  53%|█████▎    | 2178/4096 [04:06<03:51,  8.30it/s, est. speed input: 9064.86 toks/s, output: 8.85 toks/s]
Processed prompts:  54%|█████▍    | 2210/4096 [04:10<03:49,  8.22it/s, est. speed input: 9052.03 toks/s, output: 8.84 toks/s]
Processed prompts:  55%|█████▍    | 2242/4096 [04:13<03:46,  8.18it/s, est. speed input: 9039.59 toks/s, output: 8.83 toks/s]
Processed prompts:  56%|█████▌    | 2274/4096 [04:16<03:19,  9.11it/s, est. speed input: 9076.69 toks/s, output: 8.86 toks/s]
Processed prompts:  56%|█████▋    | 2306/4096 [04:20<03:24,  8.77it/s, est. speed input: 9064.20 toks/s, output: 8.85 toks/s]
Processed prompts:  57%|█████▋    | 2338/4096 [04:24<03:25,  8.55it/s, est. speed input: 9052.08 toks/s, output: 8.84 toks/s]
Processed prompts:  58%|█████▊    | 2370/4096 [04:28<03:25,  8.39it/s, est. speed input: 9040.31 toks/s, output: 8.83 toks/s]
Processed prompts:  59%|█████▊    | 2402/4096 [04:32<03:24,  8.29it/s, est. speed input: 9028.87 toks/s, output: 8.82 toks/s]
Processed prompts:  59%|█████▉    | 2434/4096 [04:36<03:22,  8.22it/s, est. speed input: 9017.78 toks/s, output: 8.81 toks/s]
Processed prompts:  60%|██████    | 2466/4096 [04:40<03:19,  8.17it/s, est. speed input: 9006.99 toks/s, output: 8.80 toks/s]
Processed prompts:  61%|██████    | 2498/4096 [04:44<03:16,  8.14it/s, est. speed input: 8996.52 toks/s, output: 8.79 toks/s]
Processed prompts:  62%|██████▏   | 2530/4096 [04:46<02:52,  9.08it/s, est. speed input: 9030.05 toks/s, output: 8.82 toks/s]
Processed prompts:  63%|██████▎   | 2562/4096 [04:50<02:55,  8.75it/s, est. speed input: 9019.51 toks/s, output: 8.81 toks/s]
Processed prompts:  63%|██████▎   | 2594/4096 [04:54<02:56,  8.53it/s, est. speed input: 9009.23 toks/s, output: 8.80 toks/s]
Processed prompts:  64%|██████▍   | 2626/4096 [04:58<02:55,  8.39it/s, est. speed input: 8999.22 toks/s, output: 8.79 toks/s]
Processed prompts:  65%|██████▍   | 2658/4096 [05:02<02:53,  8.29it/s, est. speed input: 8989.49 toks/s, output: 8.78 toks/s]
Processed prompts:  66%|██████▌   | 2690/4096 [05:06<02:51,  8.22it/s, est. speed input: 8980.03 toks/s, output: 8.77 toks/s]
Processed prompts:  66%|██████▋   | 2722/4096 [05:10<02:48,  8.17it/s, est. speed input: 8970.86 toks/s, output: 8.76 toks/s]
Processed prompts:  67%|██████▋   | 2754/4096 [05:14<02:44,  8.14it/s, est. speed input: 8961.82 toks/s, output: 8.75 toks/s]
Processed prompts:  68%|██████▊   | 2786/4096 [05:17<02:24,  9.08it/s, est. speed input: 8992.34 toks/s, output: 8.78 toks/s]
Processed prompts:  69%|██████▉   | 2818/4096 [05:21<02:26,  8.75it/s, est. speed input: 8983.29 toks/s, output: 8.77 toks/s]
Processed prompts:  70%|██████▉   | 2850/4096 [05:25<02:26,  8.53it/s, est. speed input: 8974.42 toks/s, output: 8.76 toks/s]
Processed prompts:  70%|███████   | 2882/4096 [05:29<02:24,  8.38it/s, est. speed input: 8965.74 toks/s, output: 8.76 toks/s]
Processed prompts:  71%|███████   | 2914/4096 [05:33<02:22,  8.29it/s, est. speed input: 8957.28 toks/s, output: 8.75 toks/s]
Processed prompts:  72%|███████▏  | 2946/4096 [05:37<02:19,  8.22it/s, est. speed input: 8949.02 toks/s, output: 8.74 toks/s]
Processed prompts:  73%|███████▎  | 2978/4096 [05:41<02:16,  8.17it/s, est. speed input: 8940.95 toks/s, output: 8.73 toks/s]
Processed prompts:  73%|███████▎  | 3010/4096 [05:45<02:13,  8.14it/s, est. speed input: 8933.06 toks/s, output: 8.72 toks/s]
Processed prompts:  74%|███████▍  | 3042/4096 [05:47<01:56,  9.08it/s, est. speed input: 8961.24 toks/s, output: 8.75 toks/s]
Processed prompts:  75%|███████▌  | 3074/4096 [05:51<01:56,  8.75it/s, est. speed input: 8953.38 toks/s, output: 8.74 toks/s]
Processed prompts:  76%|███████▌  | 3106/4096 [05:55<01:55,  8.54it/s, est. speed input: 8945.68 toks/s, output: 8.74 toks/s]
Processed prompts:  77%|███████▋  | 3138/4096 [05:59<01:54,  8.39it/s, est. speed input: 8938.00 toks/s, output: 8.73 toks/s]
Processed prompts:  77%|███████▋  | 3170/4096 [06:03<01:51,  8.28it/s, est. speed input: 8930.50 toks/s, output: 8.72 toks/s]
Processed prompts:  78%|███████▊  | 3202/4096 [06:07<01:48,  8.21it/s, est. speed input: 8923.10 toks/s, output: 8.71 toks/s]
Processed prompts:  79%|███████▉  | 3234/4096 [06:11<01:45,  8.16it/s, est. speed input: 8915.84 toks/s, output: 8.71 toks/s]
Processed prompts:  80%|███████▉  | 3266/4096 [06:15<01:42,  8.13it/s, est. speed input: 8908.82 toks/s, output: 8.70 toks/s]
Processed prompts:  81%|████████  | 3298/4096 [06:17<01:27,  9.08it/s, est. speed input: 8935.05 toks/s, output: 8.73 toks/s]
Processed prompts:  81%|████████▏ | 3330/4096 [06:21<01:27,  8.75it/s, est. speed input: 8928.17 toks/s, output: 8.72 toks/s]
Processed prompts:  82%|████████▏ | 3362/4096 [06:25<01:25,  8.54it/s, est. speed input: 8921.59 toks/s, output: 8.71 toks/s]
Processed prompts:  83%|████████▎ | 3394/4096 [06:29<01:23,  8.39it/s, est. speed input: 8914.73 toks/s, output: 8.71 toks/s]
Processed prompts:  84%|████████▎ | 3426/4096 [06:33<01:20,  8.28it/s, est. speed input: 8907.62 toks/s, output: 8.70 toks/s]
Processed prompts:  84%|████████▍ | 3458/4096 [06:37<01:17,  8.20it/s, est. speed input: 8900.83 toks/s, output: 8.69 toks/s]
Processed prompts:  85%|████████▌ | 3490/4096 [06:41<01:14,  8.16it/s, est. speed input: 8894.35 toks/s, output: 8.69 toks/s]
Processed prompts:  86%|████████▌ | 3522/4096 [06:45<01:10,  8.13it/s, est. speed input: 8888.06 toks/s, output: 8.68 toks/s]
Processed prompts:  87%|████████▋ | 3554/4096 [06:49<01:06,  8.11it/s, est. speed input: 8881.95 toks/s, output: 8.67 toks/s]
Processed prompts:  88%|████████▊ | 3586/4096 [06:52<00:56,  9.07it/s, est. speed input: 8906.53 toks/s, output: 8.70 toks/s]
Processed prompts:  88%|████████▊ | 3618/4096 [06:56<00:54,  8.74it/s, est. speed input: 8900.31 toks/s, output: 8.69 toks/s]
Processed prompts:  89%|████████▉ | 3650/4096 [07:00<00:52,  8.53it/s, est. speed input: 8894.20 toks/s, output: 8.69 toks/s]
Processed prompts:  90%|████████▉ | 3682/4096 [07:03<00:48,  8.52it/s, est. speed input: 8892.50 toks/s, output: 8.68 toks/s]
Processed prompts:  91%|█████████ | 3714/4096 [07:07<00:45,  8.38it/s, est. speed input: 8886.61 toks/s, output: 8.68 toks/s]
Processed prompts:  91%|█████████▏| 3746/4096 [07:11<00:42,  8.28it/s, est. speed input: 8880.82 toks/s, output: 8.67 toks/s]
Processed prompts:  92%|█████████▏| 3778/4096 [07:15<00:38,  8.21it/s, est. speed input: 8875.13 toks/s, output: 8.67 toks/s]
Processed prompts:  93%|█████████▎| 3810/4096 [07:19<00:35,  8.17it/s, est. speed input: 8869.56 toks/s, output: 8.66 toks/s]
Processed prompts:  94%|█████████▍| 3842/4096 [07:22<00:27,  9.11it/s, est. speed input: 8892.06 toks/s, output: 8.68 toks/s]
Processed prompts:  95%|█████████▍| 3874/4096 [07:26<00:25,  8.77it/s, est. speed input: 8886.41 toks/s, output: 8.68 toks/s]
Processed prompts:  95%|█████████▌| 3906/4096 [07:30<00:21,  8.68it/s, est. speed input: 8884.86 toks/s, output: 8.68 toks/s]
Processed prompts:  96%|█████████▌| 3938/4096 [07:34<00:18,  8.49it/s, est. speed input: 8879.35 toks/s, output: 8.67 toks/s]
Processed prompts:  97%|█████████▋| 3970/4096 [07:38<00:15,  8.35it/s, est. speed input: 8873.93 toks/s, output: 8.67 toks/s]
Processed prompts:  98%|█████████▊| 4002/4096 [07:42<00:11,  8.26it/s, est. speed input: 8868.62 toks/s, output: 8.66 toks/s]
Processed prompts:  98%|█████████▊| 4034/4096 [07:46<00:07,  8.20it/s, est. speed input: 8863.39 toks/s, output: 8.66 toks/s]
Processed prompts:  99%|█████████▉| 4066/4096 [07:49<00:03,  8.30it/s, est. speed input: 8862.29 toks/s, output: 8.65 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [07:49<00:00,  8.30it/s, est. speed input: 8927.67 toks/s, output: 8.72 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [07:49<00:00,  8.72it/s, est. speed input: 8927.67 toks/s, output: 8.72 toks/s]
[rank0]:[W126 03:56:06.963135057 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 561.9s

测试结果:
  Requests/s:   8.07
  Tokens/s:     8276.57
  Total Reqs:   4096
  Elapsed:      507.26s

  [Prefill 分析]
  Total Prefill Tokens: 4194304
  Prefill Tokens/s:     8268.50

============================================================
[8/8] 测试 M=65536
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 65536
│   M_prefill     = 65536 (= 64 x 1024)
│   M_decode      = 64
│   batched_tokens = 65536 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 8192
│   --max-num-seqs           = 64
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 65536
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 03:57:12 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 03:57:13 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=145404) WARNING 01-26 03:57:28 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=145404) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=145404) WARNING 01-26 03:57:40 [backends.py:609] Failed to read file <frozen os>
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 240, in _initialize_kv_caches
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     available_gpu_memory = self.model_executor.determine_available_memory()
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return self.collective_rpc("determine_available_memory")
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     result = run_method(self.driver_worker, method, args, kwargs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/root/vllmbench/vllm/v1/serial_utils.py", line 461, in run_method
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 340, in determine_available_memory
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     self.model_runner.profile_run()
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4474, in profile_run
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     hidden_states, last_hidden_states = self._dummy_run(
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]                                         ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4198, in _dummy_run
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     outputs = self.model(
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]               ^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 583, in forward
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     hidden_states = self.model(
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]                     ^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/root/vllmbench/vllm/compilation/decorators.py", line 526, in __call__
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/root/vllmbench/vllm/compilation/wrapper.py", line 218, in __call__
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return self._call_with_optional_nvtx_range(
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/root/vllmbench/vllm/compilation/wrapper.py", line 109, in _call_with_optional_nvtx_range
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return callable_fn(*args, **kwargs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 832, in compile_wrapper
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return fn(*args, **kwargs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 418, in forward
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     def forward(
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return fn(*args, **kwargs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/root/vllmbench/vllm/compilation/caching.py", line 54, in __call__
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return self.optimized_call(*args, **kwargs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 837, in call_wrapped
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return self._wrapped_call(self, *args, **kwargs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 413, in __call__
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     raise e
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 400, in __call__
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return super(self.cls, obj).__call__(*args, **kwargs)  # type: ignore[misc]
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "<eval_with_key>.58", line 325, in forward
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     submod_2 = self.submod_2(getitem_3, s72, l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_scale_, l_self_modules_layers_modules_0_modules_post_attention_layernorm_parameters_weight_, getitem_4, l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_scale_, l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_input_layernorm_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_bias_, l_positions_, l_self_modules_layers_modules_0_modules_self_attn_modules_rotary_emb_buffers_cos_sin_cache_);  getitem_3 = l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_scale_ = l_self_modules_layers_modules_0_modules_post_attention_layernorm_parameters_weight_ = getitem_4 = l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_scale_ = l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_input_layernorm_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_bias_ = None
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/root/vllmbench/vllm/compilation/piecewise_backend.py", line 178, in __call__
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return range_entry.runnable(*args)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/standalone_compile.py", line 63, in __call__
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return self._compiled_fn(*args)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return fn(*args, **kwargs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/aot_autograd.py", line 1130, in forward
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return compiled_fn(full_args)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 353, in runtime_wrapper
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     all_outs = call_func_at_runtime_with_args(
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/utils.py", line 129, in call_func_at_runtime_with_args
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     out = normalize_as_list(f(args))
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]                             ^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 724, in inner_fn
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     outs = compiled_fn(args)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 526, in wrapper
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return compiled_fn(runtime_args)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/output_code.py", line 613, in __call__
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return self.current_callable(inputs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/utils.py", line 2962, in run
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     out = model(new_inputs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]           ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/tmp/torchinductor_root/er/cerxfft23ekfx6urztnyltnj2ahvt5cw3kazwxmy6hk2wvowuoet.py", line 1090, in call
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     triton_poi_fused_mul_quant_slide_fp8_silu_slice_1.run(buf15, buf16, triton_poi_fused_mul_quant_slide_fp8_silu_slice_1_xnumel, stream=stream0)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 1272, in run
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     self.autotune_to_one_config(*args, **kwargs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 1048, in autotune_to_one_config
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     timings = self.benchmark_all_configs(*args, **kwargs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 1023, in benchmark_all_configs
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     launcher: self.bench(launcher, *args, **kwargs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 891, in bench
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return benchmarker.benchmark_gpu(kernel_call, rep=40)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/benchmarking.py", line 39, in wrapper
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return fn(self, *args, **kwargs)
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/benchmarking.py", line 247, in benchmark_gpu
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     torch.cuda.synchronize()
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py", line 1083, in synchronize
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]     return torch._C._cuda_synchronize()
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866] torch.AcceleratorError: CUDA error: an illegal memory access was encountered
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866] Search for `cudaErrorIllegalAddress' in https://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__TYPES.html for more information.
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866] CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866] For debugging consider passing CUDA_LAUNCH_BLOCKING=1
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866] Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
(EngineCore_DP0 pid=145404) ERROR 01-26 03:57:50 [core.py:866] 


─── STDERR ───
[2026-01-26 03:57:12] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:57:12] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:57:12] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:57:12] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:57:12] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:57:12] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:57:12] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:57:12] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:57:12] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:57:12] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:57:12] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:57:12] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:57:12] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:57:12] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 03:57:20] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:57:20] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:57:20] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:57:20] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:57:20] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:57:20] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:57:20] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:57:20] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:57:20] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:57:20] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:57:20] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:57:20] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:57:20] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:57:20] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[W126 03:57:28.013024573 socket.cpp:209] [c10d] The hostname of the client socket cannot be retrieved. err=-3
(EngineCore_DP0 pid=145404) [2026-01-26 03:57:29] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=145404) [2026-01-26 03:57:29] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=145404) [2026-01-26 03:57:29] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=145404) [2026-01-26 03:57:29] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=145404) [2026-01-26 03:57:29] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=145404) [2026-01-26 03:57:29] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=145404) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=145404) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.40it/s]
(EngineCore_DP0 pid=145404) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.16it/s]
(EngineCore_DP0 pid=145404) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.19it/s]
(EngineCore_DP0 pid=145404) 
(EngineCore_DP0 pid=145404) [2026-01-26 03:57:31] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 3584] -> 1D uint8
(EngineCore_DP0 pid=145404) [2026-01-26 03:57:31] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12386304 bytes
(EngineCore_DP0 pid=145404) [2026-01-26 03:57:31] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 3584] -> 1D uint8
(EngineCore_DP0 pid=145404) [2026-01-26 03:57:31] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 9633792 bytes
(EngineCore_DP0 pid=145404) [2026-01-26 03:57:31] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 3584] -> 1D uint8
(EngineCore_DP0 pid=145404) [2026-01-26 03:57:31] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 101842944 bytes
(EngineCore_DP0 pid=145404) [2026-01-26 03:57:31] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 18944] -> 1D uint8
(EngineCore_DP0 pid=145404) [2026-01-26 03:57:31] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 50921472 bytes
(EngineCore_DP0 pid=145404) [rank0]:W0126 03:57:47.642000 145404 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=145404) [rank0]:W0126 03:57:47.754000 145404 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=145404) [rank0]:W0126 03:57:49.400000 145404 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=145404) [rank0]:W0126 03:57:49.571000 145404 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=145404) Process EngineCore_DP0:
(EngineCore_DP0 pid=145404) Traceback (most recent call last):
(EngineCore_DP0 pid=145404)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=145404)     self.run()
(EngineCore_DP0 pid=145404)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=145404)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=145404)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=145404)     raise e
(EngineCore_DP0 pid=145404)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=145404)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=145404)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=145404)     super().__init__(
(EngineCore_DP0 pid=145404)   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=145404)     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=145404)                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/root/vllmbench/vllm/v1/engine/core.py", line 240, in _initialize_kv_caches
(EngineCore_DP0 pid=145404)     available_gpu_memory = self.model_executor.determine_available_memory()
(EngineCore_DP0 pid=145404)                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
(EngineCore_DP0 pid=145404)     return self.collective_rpc("determine_available_memory")
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
(EngineCore_DP0 pid=145404)     result = run_method(self.driver_worker, method, args, kwargs)
(EngineCore_DP0 pid=145404)              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/root/vllmbench/vllm/v1/serial_utils.py", line 461, in run_method
(EngineCore_DP0 pid=145404)     return func(*args, **kwargs)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=145404)     return func(*args, **kwargs)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 340, in determine_available_memory
(EngineCore_DP0 pid=145404)     self.model_runner.profile_run()
(EngineCore_DP0 pid=145404)   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4474, in profile_run
(EngineCore_DP0 pid=145404)     hidden_states, last_hidden_states = self._dummy_run(
(EngineCore_DP0 pid=145404)                                         ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=145404)     return func(*args, **kwargs)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4198, in _dummy_run
(EngineCore_DP0 pid=145404)     outputs = self.model(
(EngineCore_DP0 pid=145404)               ^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=145404)     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=145404)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=145404)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 583, in forward
(EngineCore_DP0 pid=145404)     hidden_states = self.model(
(EngineCore_DP0 pid=145404)                     ^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/root/vllmbench/vllm/compilation/decorators.py", line 526, in __call__
(EngineCore_DP0 pid=145404)     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
(EngineCore_DP0 pid=145404)              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/root/vllmbench/vllm/compilation/wrapper.py", line 218, in __call__
(EngineCore_DP0 pid=145404)     return self._call_with_optional_nvtx_range(
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/root/vllmbench/vllm/compilation/wrapper.py", line 109, in _call_with_optional_nvtx_range
(EngineCore_DP0 pid=145404)     return callable_fn(*args, **kwargs)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 832, in compile_wrapper
(EngineCore_DP0 pid=145404)     return fn(*args, **kwargs)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 418, in forward
(EngineCore_DP0 pid=145404)     def forward(
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=145404)     return fn(*args, **kwargs)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/root/vllmbench/vllm/compilation/caching.py", line 54, in __call__
(EngineCore_DP0 pid=145404)     return self.optimized_call(*args, **kwargs)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 837, in call_wrapped
(EngineCore_DP0 pid=145404)     return self._wrapped_call(self, *args, **kwargs)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 413, in __call__
(EngineCore_DP0 pid=145404)     raise e
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 400, in __call__
(EngineCore_DP0 pid=145404)     return super(self.cls, obj).__call__(*args, **kwargs)  # type: ignore[misc]
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=145404)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=145404)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "<eval_with_key>.58", line 325, in forward
(EngineCore_DP0 pid=145404)     submod_2 = self.submod_2(getitem_3, s72, l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_scale_, l_self_modules_layers_modules_0_modules_post_attention_layernorm_parameters_weight_, getitem_4, l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_scale_, l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_input_layernorm_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_bias_, l_positions_, l_self_modules_layers_modules_0_modules_self_attn_modules_rotary_emb_buffers_cos_sin_cache_);  getitem_3 = l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_scale_ = l_self_modules_layers_modules_0_modules_post_attention_layernorm_parameters_weight_ = getitem_4 = l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_scale_ = l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_input_layernorm_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_bias_ = None
(EngineCore_DP0 pid=145404)                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=145404)     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/root/vllmbench/vllm/compilation/piecewise_backend.py", line 178, in __call__
(EngineCore_DP0 pid=145404)     return range_entry.runnable(*args)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/standalone_compile.py", line 63, in __call__
(EngineCore_DP0 pid=145404)     return self._compiled_fn(*args)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=145404)     return fn(*args, **kwargs)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/aot_autograd.py", line 1130, in forward
(EngineCore_DP0 pid=145404)     return compiled_fn(full_args)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 353, in runtime_wrapper
(EngineCore_DP0 pid=145404)     all_outs = call_func_at_runtime_with_args(
(EngineCore_DP0 pid=145404)                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/utils.py", line 129, in call_func_at_runtime_with_args
(EngineCore_DP0 pid=145404)     out = normalize_as_list(f(args))
(EngineCore_DP0 pid=145404)                             ^^^^^^^
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 724, in inner_fn
(EngineCore_DP0 pid=145404)     outs = compiled_fn(args)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 526, in wrapper
(EngineCore_DP0 pid=145404)     return compiled_fn(runtime_args)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/output_code.py", line 613, in __call__
(EngineCore_DP0 pid=145404)     return self.current_callable(inputs)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/utils.py", line 2962, in run
(EngineCore_DP0 pid=145404)     out = model(new_inputs)
(EngineCore_DP0 pid=145404)           ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/tmp/torchinductor_root/er/cerxfft23ekfx6urztnyltnj2ahvt5cw3kazwxmy6hk2wvowuoet.py", line 1090, in call
(EngineCore_DP0 pid=145404)     triton_poi_fused_mul_quant_slide_fp8_silu_slice_1.run(buf15, buf16, triton_poi_fused_mul_quant_slide_fp8_silu_slice_1_xnumel, stream=stream0)
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 1272, in run
(EngineCore_DP0 pid=145404)     self.autotune_to_one_config(*args, **kwargs)
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 1048, in autotune_to_one_config
(EngineCore_DP0 pid=145404)     timings = self.benchmark_all_configs(*args, **kwargs)
(EngineCore_DP0 pid=145404)               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 1023, in benchmark_all_configs
(EngineCore_DP0 pid=145404)     launcher: self.bench(launcher, *args, **kwargs)
(EngineCore_DP0 pid=145404)               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/triton_heuristics.py", line 891, in bench
(EngineCore_DP0 pid=145404)     return benchmarker.benchmark_gpu(kernel_call, rep=40)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/benchmarking.py", line 39, in wrapper
(EngineCore_DP0 pid=145404)     return fn(self, *args, **kwargs)
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/runtime/benchmarking.py", line 247, in benchmark_gpu
(EngineCore_DP0 pid=145404)     torch.cuda.synchronize()
(EngineCore_DP0 pid=145404)   File "/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py", line 1083, in synchronize
(EngineCore_DP0 pid=145404)     return torch._C._cuda_synchronize()
(EngineCore_DP0 pid=145404)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=145404) torch.AcceleratorError: CUDA error: an illegal memory access was encountered
(EngineCore_DP0 pid=145404) Search for `cudaErrorIllegalAddress' in https://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__TYPES.html for more information.
(EngineCore_DP0 pid=145404) CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
(EngineCore_DP0 pid=145404) For debugging consider passing CUDA_LAUNCH_BLOCKING=1
(EngineCore_DP0 pid=145404) Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
(EngineCore_DP0 pid=145404) 
[rank0]:[W126 03:57:51.404367742 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

[ERROR] 测试失败: M=65536 (exit code: 1)


------------------------------------------------------------
  生成 CSV: Qwen2.5-7B-FP8
------------------------------------------------------------
[SUCCESS] CSV 保存到: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_4/Qwen2.5-7B-FP8_prefill.csv

预览:
------------------------------------------------------------
M_prefill,prompt_len,max_num_seqs,num_prompts,N_prefill,requests_per_s,tokens_per_s,elapsed_time_s
512,512,1,128,128,16.4243,8425.6603,7.7933
1024,1024,1,128,128,16.2671,16673.8170,7.8686
2048,1024,2,256,128,23.0320,23607.8286,11.1150
4096,1024,4,512,128,24.1503,24754.0184,21.2006
8192,1024,8,1024,128,24.2425,24848.5516,42.2399
16384,1024,16,2048,128,24.2954,24902.7416,84.2959
32768,1024,32,4096,128,8.0747,8276.5722,507.2631
65536,1024,64,8192,128,-1.0000,-1.0000,-1.0000

------------------------------------------------------------

[INFO] 完成: 7 成功, 1 失败

============================================================
  Qwen2.5-7B-FP8 | cuSPARSELt (2_6) | prefill
============================================================

[INFO] Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-FP8-SlideSparse-2_6
[INFO] Output: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_6

============================================================
[1/8] 测试 M=512
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 512
│   M_prefill     = 512 (= 1 x 512)
│   M_decode      = 1
│   batched_tokens = 513 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 512
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 513
│   --max-num-batched-tokens = 513
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 03:58:03 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 03:58:04 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=146318) WARNING 01-26 03:58:11 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=146318) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=146318) WARNING 01-26 03:58:29 [backends.py:609] Failed to read file <frozen os>
Throughput: 16.37 requests/s, 8399.53 total tokens/s, 16.37 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128


─── STDERR ───
[2026-01-26 03:58:03] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:58:03] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:58:03] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:58:03] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:58:03] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:58:03] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:58:03] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:58:03] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:58:03] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:58:03] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:58:03] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:58:03] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:58:03] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:58:03] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 03:58:11] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:58:11] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:58:11] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:58:11] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:58:11] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:58:11] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:58:11] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:58:11] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:58:11] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:58:11] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:58:11] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:58:11] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:58:11] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:58:11] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=146318) [2026-01-26 03:58:12] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=146318) [2026-01-26 03:58:12] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=146318) [2026-01-26 03:58:12] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=146318) [2026-01-26 03:58:12] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=146318) [2026-01-26 03:58:12] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=146318) [2026-01-26 03:58:12] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=146318) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=146318) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:02<00:02,  2.31s/it]
(EngineCore_DP0 pid=146318) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:06<00:00,  3.69s/it]
(EngineCore_DP0 pid=146318) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:06<00:00,  3.48s/it]
(EngineCore_DP0 pid=146318) 
(EngineCore_DP0 pid=146318) [2026-01-26 03:58:20] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 4800] -> 1D uint8
(EngineCore_DP0 pid=146318) [2026-01-26 03:58:20] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 16662528 bytes
(EngineCore_DP0 pid=146318) [2026-01-26 03:58:20] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 4800] -> 1D uint8
(EngineCore_DP0 pid=146318) [2026-01-26 03:58:20] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12959744 bytes
(EngineCore_DP0 pid=146318) [2026-01-26 03:58:20] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 4800] -> 1D uint8
(EngineCore_DP0 pid=146318) [2026-01-26 03:58:20] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 137003008 bytes
(EngineCore_DP0 pid=146318) [2026-01-26 03:58:20] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 25280] -> 1D uint8
(EngineCore_DP0 pid=146318) [2026-01-26 03:58:20] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 68009984 bytes
(EngineCore_DP0 pid=146318) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  2.56it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  2.27it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  2.31it/s]
(EngineCore_DP0 pid=146318) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  6.74it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  6.73it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  35%|███▌      | 45/128 [00:00<00:00, 444.99it/s]
Adding requests:  72%|███████▏  | 92/128 [00:00<00:00, 456.72it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 459.20it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:15,  8.24it/s, est. speed input: 4221.54 toks/s, output: 8.24 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:12, 10.02it/s, est. speed input: 5022.92 toks/s, output: 9.81 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:09, 12.70it/s, est. speed input: 6045.49 toks/s, output: 11.81 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:08, 14.25it/s, est. speed input: 6631.55 toks/s, output: 12.95 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:00<00:07, 15.19it/s, est. speed input: 7004.35 toks/s, output: 13.68 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:00<00:07, 15.85it/s, est. speed input: 7278.15 toks/s, output: 14.21 toks/s]
Processed prompts:  10%|█         | 13/128 [00:00<00:07, 16.25it/s, est. speed input: 7472.33 toks/s, output: 14.59 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:01<00:06, 16.54it/s, est. speed input: 7626.58 toks/s, output: 14.90 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:01<00:06, 16.79it/s, est. speed input: 7755.30 toks/s, output: 15.15 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:01<00:06, 16.90it/s, est. speed input: 7852.20 toks/s, output: 15.34 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:01<00:06, 16.97it/s, est. speed input: 7931.52 toks/s, output: 15.49 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:01<00:06, 17.04it/s, est. speed input: 8000.97 toks/s, output: 15.63 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:01<00:05, 17.21it/s, est. speed input: 8073.24 toks/s, output: 15.77 toks/s]
Processed prompts:  21%|██        | 27/128 [00:01<00:05, 17.06it/s, est. speed input: 8107.84 toks/s, output: 15.84 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:01<00:05, 17.17it/s, est. speed input: 8158.83 toks/s, output: 15.94 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:01<00:05, 16.99it/s, est. speed input: 8180.15 toks/s, output: 15.98 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:02<00:05, 17.04it/s, est. speed input: 8214.54 toks/s, output: 16.04 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:02<00:05, 17.23it/s, est. speed input: 8258.22 toks/s, output: 16.13 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:02<00:05, 17.37it/s, est. speed input: 8297.92 toks/s, output: 16.21 toks/s]
Processed prompts:  30%|███       | 39/128 [00:02<00:05, 17.46it/s, est. speed input: 8333.38 toks/s, output: 16.28 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:02<00:04, 17.54it/s, est. speed input: 8366.84 toks/s, output: 16.34 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:02<00:04, 17.56it/s, est. speed input: 8394.73 toks/s, output: 16.40 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:02<00:04, 17.45it/s, est. speed input: 8412.60 toks/s, output: 16.43 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:02<00:04, 17.43it/s, est. speed input: 8432.38 toks/s, output: 16.47 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:02<00:04, 17.47it/s, est. speed input: 8453.45 toks/s, output: 16.51 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:03<00:04, 17.48it/s, est. speed input: 8472.49 toks/s, output: 16.55 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:03<00:04, 17.52it/s, est. speed input: 8491.85 toks/s, output: 16.59 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:03<00:04, 17.56it/s, est. speed input: 8510.57 toks/s, output: 16.62 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:03<00:04, 17.61it/s, est. speed input: 8529.04 toks/s, output: 16.66 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:03<00:03, 17.51it/s, est. speed input: 8539.80 toks/s, output: 16.68 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:03<00:03, 17.53it/s, est. speed input: 8553.80 toks/s, output: 16.71 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:03<00:03, 17.40it/s, est. speed input: 8560.23 toks/s, output: 16.72 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:03<00:03, 17.33it/s, est. speed input: 8567.10 toks/s, output: 16.73 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:04<00:03, 17.32it/s, est. speed input: 8575.53 toks/s, output: 16.75 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:04<00:03, 17.25it/s, est. speed input: 8580.42 toks/s, output: 16.76 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:04<00:03, 17.32it/s, est. speed input: 8590.51 toks/s, output: 16.78 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:04<00:03, 17.34it/s, est. speed input: 8598.80 toks/s, output: 16.79 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:04<00:03, 17.32it/s, est. speed input: 8605.23 toks/s, output: 16.81 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:04<00:02, 17.36it/s, est. speed input: 8613.34 toks/s, output: 16.82 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:04<00:02, 17.45it/s, est. speed input: 8623.75 toks/s, output: 16.84 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:04<00:02, 17.45it/s, est. speed input: 8631.37 toks/s, output: 16.86 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:04<00:02, 17.41it/s, est. speed input: 8636.58 toks/s, output: 16.87 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:05<00:02, 17.31it/s, est. speed input: 8639.16 toks/s, output: 16.87 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:05<00:02, 17.21it/s, est. speed input: 8640.39 toks/s, output: 16.88 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:05<00:02, 17.20it/s, est. speed input: 8643.88 toks/s, output: 16.88 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:05<00:02, 17.23it/s, est. speed input: 8648.30 toks/s, output: 16.89 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:05<00:02, 17.21it/s, est. speed input: 8651.28 toks/s, output: 16.90 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:05<00:01, 17.05it/s, est. speed input: 8648.93 toks/s, output: 16.89 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:05<00:01, 17.20it/s, est. speed input: 8655.94 toks/s, output: 16.91 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:05<00:01, 17.31it/s, est. speed input: 8662.53 toks/s, output: 16.92 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:05<00:01, 17.18it/s, est. speed input: 8661.99 toks/s, output: 16.92 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:06<00:01, 17.26it/s, est. speed input: 8667.27 toks/s, output: 16.93 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:06<00:01, 17.29it/s, est. speed input: 8671.41 toks/s, output: 16.94 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:06<00:01, 17.39it/s, est. speed input: 8677.76 toks/s, output: 16.95 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:06<00:01, 17.50it/s, est. speed input: 8685.10 toks/s, output: 16.96 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:06<00:00, 17.62it/s, est. speed input: 8693.27 toks/s, output: 16.98 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:06<00:00, 17.67it/s, est. speed input: 8700.42 toks/s, output: 16.99 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:06<00:00, 17.67it/s, est. speed input: 8706.11 toks/s, output: 17.00 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:06<00:00, 17.58it/s, est. speed input: 8709.30 toks/s, output: 17.01 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:06<00:00, 17.24it/s, est. speed input: 8704.68 toks/s, output: 17.00 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:07<00:00, 17.08it/s, est. speed input: 8702.40 toks/s, output: 17.00 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:07<00:00, 17.01it/s, est. speed input: 8700.99 toks/s, output: 16.99 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:07<00:00, 16.94it/s, est. speed input: 8699.21 toks/s, output: 16.99 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:07<00:00, 16.85it/s, est. speed input: 8696.46 toks/s, output: 16.99 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 16.85it/s, est. speed input: 8695.14 toks/s, output: 16.98 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 16.98it/s, est. speed input: 8695.14 toks/s, output: 16.98 toks/s]
[rank0]:[W126 03:58:54.185286823 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 62.0s

测试结果:
  Requests/s:   16.37
  Tokens/s:     8399.53
  Total Reqs:   128
  Elapsed:      7.82s

  [Prefill 分析]
  Total Prefill Tokens: 65536
  Prefill Tokens/s:     8383.16

============================================================
[2/8] 测试 M=1024
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 1024
│   M_prefill     = 1024 (= 1 x 1024)
│   M_decode      = 1
│   batched_tokens = 1025 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 1025
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 03:59:05 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 03:59:06 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=147479) WARNING 01-26 03:59:14 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=147479) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=147479) WARNING 01-26 03:59:25 [backends.py:609] Failed to read file <frozen os>
Throughput: 16.34 requests/s, 16745.61 total tokens/s, 16.34 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128


─── STDERR ───
[2026-01-26 03:59:05] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:59:05] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:59:05] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:59:05] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:59:05] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:59:05] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:59:05] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:59:05] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:59:05] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:59:05] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:59:05] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:59:05] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:59:05] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:59:05] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 03:59:13] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 03:59:13] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:59:13] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 03:59:13] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:59:13] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:59:13] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:59:13] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:59:13] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 03:59:13] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 03:59:13] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 03:59:13] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 03:59:13] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 03:59:13] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 03:59:13] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=147479) [2026-01-26 03:59:14] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=147479) [2026-01-26 03:59:14] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=147479) [2026-01-26 03:59:14] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=147479) [2026-01-26 03:59:14] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=147479) [2026-01-26 03:59:14] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=147479) [2026-01-26 03:59:14] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=147479) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=147479) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
(EngineCore_DP0 pid=147479) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
(EngineCore_DP0 pid=147479) 
(EngineCore_DP0 pid=147479) [2026-01-26 03:59:16] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 4800] -> 1D uint8
(EngineCore_DP0 pid=147479) [2026-01-26 03:59:16] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 16662528 bytes
(EngineCore_DP0 pid=147479) [2026-01-26 03:59:16] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 4800] -> 1D uint8
(EngineCore_DP0 pid=147479) [2026-01-26 03:59:16] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12959744 bytes
(EngineCore_DP0 pid=147479) [2026-01-26 03:59:16] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 4800] -> 1D uint8
(EngineCore_DP0 pid=147479) [2026-01-26 03:59:16] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 137003008 bytes
(EngineCore_DP0 pid=147479) [2026-01-26 03:59:16] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 25280] -> 1D uint8
(EngineCore_DP0 pid=147479) [2026-01-26 03:59:16] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 68009984 bytes
(EngineCore_DP0 pid=147479) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  8.21it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  8.47it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  8.42it/s]
(EngineCore_DP0 pid=147479) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.29it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.28it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  19%|█▉        | 24/128 [00:00<00:00, 233.03it/s]
Adding requests:  38%|███▊      | 49/128 [00:00<00:00, 240.93it/s]
Adding requests:  60%|██████    | 77/128 [00:00<00:00, 256.11it/s]
Adding requests:  80%|████████  | 103/128 [00:00<00:00, 255.11it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 253.72it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:03, 32.18it/s, est. speed input: 32964.04 toks/s, output: 32.19 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:00<00:05, 21.38it/s, est. speed input: 23054.61 toks/s, output: 22.51 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:00<00:05, 19.62it/s, est. speed input: 21329.57 toks/s, output: 20.83 toks/s]
Processed prompts:  11%|█         | 14/128 [00:00<00:06, 18.77it/s, est. speed input: 20465.38 toks/s, output: 19.99 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:00<00:06, 18.39it/s, est. speed input: 20082.59 toks/s, output: 19.61 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:00<00:06, 18.15it/s, est. speed input: 19819.96 toks/s, output: 19.36 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:01<00:06, 18.00it/s, est. speed input: 19624.17 toks/s, output: 19.16 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:01<00:05, 17.82it/s, est. speed input: 19445.04 toks/s, output: 18.99 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:01<00:05, 17.70it/s, est. speed input: 19297.89 toks/s, output: 18.85 toks/s]
Processed prompts:  20%|██        | 26/128 [00:01<00:05, 17.59it/s, est. speed input: 19168.86 toks/s, output: 18.72 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:01<00:05, 17.47it/s, est. speed input: 19046.27 toks/s, output: 18.60 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:01<00:05, 17.23it/s, est. speed input: 18902.32 toks/s, output: 18.46 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:01<00:05, 17.21it/s, est. speed input: 18815.99 toks/s, output: 18.37 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:01<00:05, 17.18it/s, est. speed input: 18731.95 toks/s, output: 18.29 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:01<00:05, 17.05it/s, est. speed input: 18636.87 toks/s, output: 18.20 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:02<00:05, 16.95it/s, est. speed input: 18551.88 toks/s, output: 18.12 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:02<00:05, 16.96it/s, est. speed input: 18489.21 toks/s, output: 18.06 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:02<00:05, 16.96it/s, est. speed input: 18432.24 toks/s, output: 18.00 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:02<00:04, 16.99it/s, est. speed input: 18386.69 toks/s, output: 17.96 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:02<00:04, 17.03it/s, est. speed input: 18346.77 toks/s, output: 17.92 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:02<00:04, 16.92it/s, est. speed input: 18289.71 toks/s, output: 17.86 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:02<00:04, 16.87it/s, est. speed input: 18242.43 toks/s, output: 17.81 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:02<00:00, 79.59it/s, est. speed input: 26694.88 toks/s, output: 26.07 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:03<00:01, 38.32it/s, est. speed input: 25297.15 toks/s, output: 24.70 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:03<00:01, 29.21it/s, est. speed input: 24445.26 toks/s, output: 23.87 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:04<00:01, 25.51it/s, est. speed input: 23943.98 toks/s, output: 23.38 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:04<00:01, 23.27it/s, est. speed input: 23580.42 toks/s, output: 23.03 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:04<00:01, 21.56it/s, est. speed input: 23260.45 toks/s, output: 22.72 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:04<00:00, 20.54it/s, est. speed input: 23044.81 toks/s, output: 22.50 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:04<00:00, 19.69it/s, est. speed input: 22845.99 toks/s, output: 22.31 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:05<00:00, 19.20it/s, est. speed input: 22690.88 toks/s, output: 22.16 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:05<00:00, 18.82it/s, est. speed input: 22547.22 toks/s, output: 22.02 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:05<00:00, 18.47it/s, est. speed input: 22404.13 toks/s, output: 21.88 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:05<00:00, 18.19it/s, est. speed input: 22303.73 toks/s, output: 21.78 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:05<00:00, 18.05it/s, est. speed input: 22217.86 toks/s, output: 21.70 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:05<00:00, 18.01it/s, est. speed input: 22142.27 toks/s, output: 21.62 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:05<00:00, 17.99it/s, est. speed input: 22071.64 toks/s, output: 21.55 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:05<00:00, 17.99it/s, est. speed input: 22071.64 toks/s, output: 21.55 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:05<00:00, 21.55it/s, est. speed input: 22071.64 toks/s, output: 21.55 toks/s]
[rank0]:[W126 03:59:49.170529361 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 55.2s

测试结果:
  Requests/s:   16.34
  Tokens/s:     16745.61
  Total Reqs:   128
  Elapsed:      7.83s

  [Prefill 分析]
  Total Prefill Tokens: 131072
  Prefill Tokens/s:     16729.28

============================================================
[3/8] 测试 M=2048
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 2048
│   M_prefill     = 2048 (= 2 x 1024)
│   M_decode      = 2
│   batched_tokens = 2048 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 256
│   --max-num-seqs           = 2
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 2048
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 04:00:01 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 04:00:02 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=148515) WARNING 01-26 04:00:10 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=148515) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=148515) WARNING 01-26 04:00:21 [backends.py:609] Failed to read file <frozen os>
Throughput: 19.14 requests/s, 19620.28 total tokens/s, 19.14 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256


─── STDERR ───
[2026-01-26 04:00:01] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 04:00:01] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:00:01] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 04:00:01] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:00:01] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:00:01] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:00:01] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:00:01] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:00:01] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:00:01] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 04:00:01] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 04:00:01] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 04:00:01] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 04:00:01] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 04:00:09] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 04:00:09] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:00:09] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 04:00:09] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:00:09] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:00:09] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:00:09] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:00:09] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:00:09] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:00:09] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 04:00:09] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 04:00:09] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 04:00:09] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 04:00:09] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=148515) [2026-01-26 04:00:11] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=148515) [2026-01-26 04:00:11] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=148515) [2026-01-26 04:00:11] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=148515) [2026-01-26 04:00:11] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=148515) [2026-01-26 04:00:11] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=148515) [2026-01-26 04:00:11] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=148515) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=148515) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.20it/s]
(EngineCore_DP0 pid=148515) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.06s/it]
(EngineCore_DP0 pid=148515) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.03s/it]
(EngineCore_DP0 pid=148515) 
(EngineCore_DP0 pid=148515) [2026-01-26 04:00:13] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 4800] -> 1D uint8
(EngineCore_DP0 pid=148515) [2026-01-26 04:00:13] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 16662528 bytes
(EngineCore_DP0 pid=148515) [2026-01-26 04:00:13] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 4800] -> 1D uint8
(EngineCore_DP0 pid=148515) [2026-01-26 04:00:13] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12959744 bytes
(EngineCore_DP0 pid=148515) [2026-01-26 04:00:13] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 4800] -> 1D uint8
(EngineCore_DP0 pid=148515) [2026-01-26 04:00:13] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 137003008 bytes
(EngineCore_DP0 pid=148515) [2026-01-26 04:00:13] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 25280] -> 1D uint8
(EngineCore_DP0 pid=148515) [2026-01-26 04:00:13] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 68009984 bytes
(EngineCore_DP0 pid=148515) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  33%|███▎      | 1/3 [00:00<00:00,  8.15it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  67%|██████▋   | 2/3 [00:00<00:00,  8.82it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00,  8.14it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00,  8.24it/s]
(EngineCore_DP0 pid=148515) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 1/2 [00:00<00:00,  7.49it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  8.54it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  8.36it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  10%|▉         | 25/256 [00:00<00:00, 240.90it/s]
Adding requests:  20%|█▉        | 51/256 [00:00<00:00, 251.33it/s]
Adding requests:  30%|███       | 78/256 [00:00<00:00, 258.44it/s]
Adding requests:  41%|████      | 104/256 [00:00<00:00, 254.51it/s]
Adding requests:  51%|█████     | 130/256 [00:00<00:00, 255.72it/s]
Adding requests:  61%|██████▏   | 157/256 [00:00<00:00, 257.75it/s]
Adding requests:  73%|███████▎  | 187/256 [00:00<00:00, 268.07it/s]
Adding requests:  84%|████████▎ | 214/256 [00:00<00:00, 267.03it/s]
Adding requests:  94%|█████████▍| 241/256 [00:00<00:00, 267.82it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 261.11it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▋         | 16/256 [00:00<00:02, 83.42it/s, est. speed input: 85439.57 toks/s, output: 83.43 toks/s]
Processed prompts:  10%|▉         | 25/256 [00:00<00:06, 37.25it/s, est. speed input: 42679.49 toks/s, output: 41.68 toks/s]
Processed prompts:  12%|█▏        | 30/256 [00:00<00:08, 27.93it/s, est. speed input: 33928.74 toks/s, output: 33.13 toks/s]
Processed prompts:  13%|█▎        | 34/256 [00:01<00:08, 25.41it/s, est. speed input: 31351.49 toks/s, output: 30.62 toks/s]
Processed prompts:  14%|█▍        | 37/256 [00:01<00:08, 26.09it/s, est. speed input: 31236.50 toks/s, output: 30.50 toks/s]
Processed prompts:  16%|█▌        | 40/256 [00:01<00:09, 22.27it/s, est. speed input: 28893.28 toks/s, output: 28.22 toks/s]
Processed prompts:  17%|█▋        | 43/256 [00:01<00:09, 23.64it/s, est. speed input: 28974.10 toks/s, output: 28.29 toks/s]
Processed prompts:  18%|█▊        | 46/256 [00:01<00:10, 20.47it/s, est. speed input: 27327.21 toks/s, output: 26.69 toks/s]
Processed prompts:  19%|█▉        | 49/256 [00:01<00:09, 22.24it/s, est. speed input: 27470.70 toks/s, output: 26.83 toks/s]
Processed prompts:  20%|██        | 52/256 [00:02<00:10, 19.43it/s, est. speed input: 26204.92 toks/s, output: 25.59 toks/s]
Processed prompts:  21%|██▏       | 55/256 [00:02<00:09, 21.45it/s, est. speed input: 26379.07 toks/s, output: 25.76 toks/s]
Processed prompts:  23%|██▎       | 58/256 [00:02<00:10, 18.94it/s, est. speed input: 25387.76 toks/s, output: 24.79 toks/s]
Processed prompts:  24%|██▍       | 61/256 [00:02<00:09, 21.09it/s, est. speed input: 25575.61 toks/s, output: 24.98 toks/s]
Processed prompts:  25%|██▌       | 64/256 [00:02<00:10, 18.66it/s, est. speed input: 24751.88 toks/s, output: 24.17 toks/s]
Processed prompts:  26%|██▌       | 67/256 [00:02<00:09, 20.92it/s, est. speed input: 24951.60 toks/s, output: 24.37 toks/s]
Processed prompts:  27%|██▋       | 70/256 [00:02<00:10, 18.56it/s, est. speed input: 24261.18 toks/s, output: 23.69 toks/s]
Processed prompts:  29%|██▊       | 73/256 [00:03<00:08, 20.82it/s, est. speed input: 24451.78 toks/s, output: 23.88 toks/s]
Processed prompts:  30%|██▉       | 76/256 [00:03<00:09, 18.53it/s, est. speed input: 23866.13 toks/s, output: 23.31 toks/s]
Processed prompts:  31%|███       | 79/256 [00:03<00:08, 20.84it/s, est. speed input: 24055.84 toks/s, output: 23.49 toks/s]
Processed prompts:  32%|███▏      | 82/256 [00:03<00:09, 18.53it/s, est. speed input: 23543.13 toks/s, output: 22.99 toks/s]
Processed prompts:  33%|███▎      | 85/256 [00:03<00:08, 20.84it/s, est. speed input: 23724.90 toks/s, output: 23.17 toks/s]
Processed prompts:  34%|███▍      | 88/256 [00:03<00:09, 18.53it/s, est. speed input: 23269.80 toks/s, output: 22.72 toks/s]
Processed prompts:  36%|███▌      | 91/256 [00:03<00:07, 20.82it/s, est. speed input: 23442.98 toks/s, output: 22.89 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:04<00:08, 18.49it/s, est. speed input: 23029.19 toks/s, output: 22.49 toks/s]
Processed prompts:  38%|███▊      | 97/256 [00:04<00:07, 20.80it/s, est. speed input: 23197.82 toks/s, output: 22.65 toks/s]
Processed prompts:  39%|███▉      | 100/256 [00:04<00:08, 18.50it/s, est. speed input: 22827.20 toks/s, output: 22.29 toks/s]
Processed prompts:  40%|████      | 103/256 [00:04<00:07, 20.82it/s, est. speed input: 22989.68 toks/s, output: 22.45 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:04<00:08, 18.52it/s, est. speed input: 22653.95 toks/s, output: 22.12 toks/s]
Processed prompts:  43%|████▎     | 109/256 [00:04<00:07, 20.84it/s, est. speed input: 22809.29 toks/s, output: 22.27 toks/s]
Processed prompts:  44%|████▍     | 112/256 [00:05<00:07, 18.48it/s, est. speed input: 22493.73 toks/s, output: 21.97 toks/s]
Processed prompts:  45%|████▍     | 115/256 [00:05<00:06, 20.79it/s, est. speed input: 22642.19 toks/s, output: 22.11 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:05<00:07, 18.46it/s, est. speed input: 22352.26 toks/s, output: 21.83 toks/s]
Processed prompts:  47%|████▋     | 121/256 [00:05<00:06, 20.78it/s, est. speed input: 22495.70 toks/s, output: 21.97 toks/s]
Processed prompts:  48%|████▊     | 124/256 [00:05<00:07, 18.45it/s, est. speed input: 22225.42 toks/s, output: 21.70 toks/s]
Processed prompts:  50%|████▉     | 127/256 [00:05<00:06, 20.77it/s, est. speed input: 22364.00 toks/s, output: 21.84 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:06<00:06, 18.49it/s, est. speed input: 22116.83 toks/s, output: 21.60 toks/s]
Processed prompts:  52%|█████▏    | 133/256 [00:06<00:05, 20.77it/s, est. speed input: 22247.13 toks/s, output: 21.73 toks/s]
Processed prompts:  53%|█████▎    | 136/256 [00:06<00:06, 18.46it/s, est. speed input: 22013.37 toks/s, output: 21.50 toks/s]
Processed prompts:  54%|█████▍    | 139/256 [00:06<00:05, 20.76it/s, est. speed input: 22139.77 toks/s, output: 21.62 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:06<00:06, 18.46it/s, est. speed input: 21920.23 toks/s, output: 21.41 toks/s]
Processed prompts:  57%|█████▋    | 145/256 [00:06<00:05, 20.77it/s, est. speed input: 22043.44 toks/s, output: 21.53 toks/s]
Processed prompts:  58%|█████▊    | 148/256 [00:06<00:05, 18.49it/s, est. speed input: 21838.44 toks/s, output: 21.33 toks/s]
Processed prompts:  59%|█████▉    | 151/256 [00:07<00:05, 20.81it/s, est. speed input: 21958.66 toks/s, output: 21.44 toks/s]
Processed prompts:  60%|██████    | 154/256 [00:07<00:05, 18.48it/s, est. speed input: 21762.10 toks/s, output: 21.25 toks/s]
Processed prompts:  61%|██████▏   | 157/256 [00:07<00:04, 20.79it/s, est. speed input: 21877.30 toks/s, output: 21.36 toks/s]
Processed prompts:  62%|██████▎   | 160/256 [00:07<00:05, 18.48it/s, est. speed input: 21692.31 toks/s, output: 21.18 toks/s]
Processed prompts:  64%|██████▎   | 163/256 [00:07<00:04, 20.79it/s, est. speed input: 21803.87 toks/s, output: 21.29 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:07<00:04, 18.48it/s, est. speed input: 21627.53 toks/s, output: 21.12 toks/s]
Processed prompts:  66%|██████▌   | 169/256 [00:07<00:04, 20.78it/s, est. speed input: 21735.23 toks/s, output: 21.23 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:08<00:00, 74.98it/s, est. speed input: 25014.83 toks/s, output: 24.43 toks/s]
Processed prompts:  80%|████████  | 206/256 [00:08<00:01, 47.08it/s, est. speed input: 24892.10 toks/s, output: 24.31 toks/s]
Processed prompts:  83%|████████▎ | 213/256 [00:08<00:01, 37.81it/s, est. speed input: 24840.56 toks/s, output: 24.26 toks/s]
Processed prompts:  85%|████████▌ | 218/256 [00:09<00:01, 30.17it/s, est. speed input: 24563.45 toks/s, output: 23.99 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:09<00:01, 27.47it/s, est. speed input: 24461.53 toks/s, output: 23.89 toks/s]
Processed prompts:  88%|████████▊ | 226/256 [00:09<00:01, 25.37it/s, est. speed input: 24365.36 toks/s, output: 23.79 toks/s]
Processed prompts:  89%|████████▉ | 229/256 [00:09<00:01, 26.01it/s, est. speed input: 24426.46 toks/s, output: 23.85 toks/s]
Processed prompts:  91%|█████████ | 232/256 [00:09<00:01, 22.47it/s, est. speed input: 24230.73 toks/s, output: 23.66 toks/s]
Processed prompts:  92%|█████████▏| 235/256 [00:09<00:00, 23.69it/s, est. speed input: 24288.50 toks/s, output: 23.72 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:10<00:00, 20.56it/s, est. speed input: 24098.31 toks/s, output: 23.53 toks/s]
Processed prompts:  94%|█████████▍| 241/256 [00:10<00:00, 22.27it/s, est. speed input: 24156.99 toks/s, output: 23.59 toks/s]
Processed prompts:  95%|█████████▌| 244/256 [00:10<00:00, 19.52it/s, est. speed input: 23976.10 toks/s, output: 23.41 toks/s]
Processed prompts:  96%|█████████▋| 247/256 [00:10<00:00, 21.51it/s, est. speed input: 24034.40 toks/s, output: 23.47 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:10<00:00, 18.95it/s, est. speed input: 23860.24 toks/s, output: 23.30 toks/s]
Processed prompts:  99%|█████████▉| 253/256 [00:10<00:00, 21.12it/s, est. speed input: 23919.07 toks/s, output: 23.36 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:10<00:00, 20.26it/s, est. speed input: 23844.29 toks/s, output: 23.29 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:10<00:00, 20.26it/s, est. speed input: 23844.29 toks/s, output: 23.29 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:10<00:00, 23.28it/s, est. speed input: 23844.29 toks/s, output: 23.29 toks/s]
[rank0]:[W126 04:00:51.975940442 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 62.0s

测试结果:
  Requests/s:   19.14
  Tokens/s:     19620.28
  Total Reqs:   256
  Elapsed:      13.37s

  [Prefill 分析]
  Total Prefill Tokens: 262144
  Prefill Tokens/s:     19601.14

============================================================
[4/8] 测试 M=4096
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 4096
│   M_prefill     = 4096 (= 4 x 1024)
│   M_decode      = 4
│   batched_tokens = 4096 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 512
│   --max-num-seqs           = 4
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 4096
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 04:01:05 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 04:01:06 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=149637) WARNING 01-26 04:01:13 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=149637) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=149637) WARNING 01-26 04:01:24 [backends.py:609] Failed to read file <frozen os>
Throughput: 20.05 requests/s, 20550.78 total tokens/s, 20.05 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512


─── STDERR ───
[2026-01-26 04:01:05] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 04:01:05] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:01:05] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 04:01:05] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:01:05] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:01:05] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:01:05] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:01:05] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:01:05] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:01:05] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 04:01:05] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 04:01:05] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 04:01:05] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 04:01:05] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 04:01:13] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 04:01:13] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:01:13] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 04:01:13] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:01:13] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:01:13] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:01:13] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:01:13] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:01:13] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:01:13] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 04:01:13] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 04:01:13] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 04:01:13] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 04:01:13] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=149637) [2026-01-26 04:01:14] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=149637) [2026-01-26 04:01:14] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=149637) [2026-01-26 04:01:14] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=149637) [2026-01-26 04:01:14] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=149637) [2026-01-26 04:01:14] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=149637) [2026-01-26 04:01:14] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=149637) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=149637) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.15it/s]
(EngineCore_DP0 pid=149637) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.10s/it]
(EngineCore_DP0 pid=149637) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.06s/it]
(EngineCore_DP0 pid=149637) 
(EngineCore_DP0 pid=149637) [2026-01-26 04:01:17] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 4800] -> 1D uint8
(EngineCore_DP0 pid=149637) [2026-01-26 04:01:17] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 16662528 bytes
(EngineCore_DP0 pid=149637) [2026-01-26 04:01:17] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 4800] -> 1D uint8
(EngineCore_DP0 pid=149637) [2026-01-26 04:01:17] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12959744 bytes
(EngineCore_DP0 pid=149637) [2026-01-26 04:01:17] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 4800] -> 1D uint8
(EngineCore_DP0 pid=149637) [2026-01-26 04:01:17] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 137003008 bytes
(EngineCore_DP0 pid=149637) [2026-01-26 04:01:17] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 25280] -> 1D uint8
(EngineCore_DP0 pid=149637) [2026-01-26 04:01:17] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 68009984 bytes
(EngineCore_DP0 pid=149637) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  25%|██▌       | 1/4 [00:00<00:00,  8.07it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 2/4 [00:00<00:00,  8.62it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  75%|███████▌  | 3/4 [00:00<00:00,  8.91it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  8.15it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  8.32it/s]
(EngineCore_DP0 pid=149637) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  33%|███▎      | 1/3 [00:00<00:00,  7.43it/s]
Capturing CUDA graphs (decode, FULL):  67%|██████▋   | 2/3 [00:00<00:00,  8.53it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  8.99it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  8.72it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   5%|▍         | 24/512 [00:00<00:02, 239.60it/s]
Adding requests:  10%|▉         | 50/512 [00:00<00:01, 250.08it/s]
Adding requests:  15%|█▌        | 78/512 [00:00<00:01, 260.99it/s]
Adding requests:  21%|██        | 105/512 [00:00<00:01, 262.52it/s]
Adding requests:  26%|██▌       | 132/512 [00:00<00:01, 260.44it/s]
Adding requests:  31%|███▏      | 160/512 [00:00<00:01, 263.77it/s]
Adding requests:  37%|███▋      | 189/512 [00:00<00:01, 269.26it/s]
Adding requests:  42%|████▏     | 217/512 [00:00<00:01, 271.34it/s]
Adding requests:  48%|████▊     | 245/512 [00:00<00:00, 268.10it/s]
Adding requests:  53%|█████▎    | 272/512 [00:01<00:00, 266.21it/s]
Adding requests:  59%|█████▊    | 300/512 [00:01<00:00, 268.46it/s]
Adding requests:  64%|██████▍   | 327/512 [00:01<00:00, 268.15it/s]
Adding requests:  70%|██████▉   | 356/512 [00:01<00:00, 274.41it/s]
Adding requests:  75%|███████▌  | 384/512 [00:01<00:00, 275.19it/s]
Adding requests:  81%|████████  | 413/512 [00:01<00:00, 279.27it/s]
Adding requests:  86%|████████▌ | 441/512 [00:01<00:00, 279.05it/s]
Adding requests:  92%|█████████▏| 470/512 [00:01<00:00, 280.62it/s]
Adding requests:  98%|█████████▊| 500/512 [00:01<00:00, 285.90it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 272.44it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   7%|▋         | 34/512 [00:00<00:02, 170.97it/s, est. speed input: 175101.10 toks/s, output: 170.98 toks/s]
Processed prompts:  10%|█         | 52/512 [00:00<00:10, 45.17it/s, est. speed input: 54061.53 toks/s, output: 52.79 toks/s]   
Processed prompts:  12%|█▏        | 61/512 [00:01<00:12, 36.76it/s, est. speed input: 45327.83 toks/s, output: 44.27 toks/s]
Processed prompts:  13%|█▎        | 67/512 [00:01<00:15, 29.21it/s, est. speed input: 38726.55 toks/s, output: 37.82 toks/s]
Processed prompts:  14%|█▍        | 71/512 [00:01<00:16, 27.45it/s, est. speed input: 36946.98 toks/s, output: 36.08 toks/s]
Processed prompts:  15%|█▍        | 75/512 [00:02<00:16, 25.87it/s, est. speed input: 35483.09 toks/s, output: 34.65 toks/s]
Processed prompts:  15%|█▌        | 78/512 [00:02<00:18, 23.31it/s, est. speed input: 33830.51 toks/s, output: 33.04 toks/s]
Processed prompts:  16%|█▌        | 82/512 [00:02<00:19, 22.55it/s, est. speed input: 32830.71 toks/s, output: 32.06 toks/s]
Processed prompts:  17%|█▋        | 86/512 [00:02<00:19, 21.97it/s, est. speed input: 31979.64 toks/s, output: 31.23 toks/s]
Processed prompts:  18%|█▊        | 90/512 [00:02<00:19, 21.54it/s, est. speed input: 31243.95 toks/s, output: 30.51 toks/s]
Processed prompts:  18%|█▊        | 94/512 [00:03<00:19, 21.22it/s, est. speed input: 30599.03 toks/s, output: 29.88 toks/s]
Processed prompts:  19%|█▉        | 98/512 [00:03<00:19, 20.98it/s, est. speed input: 30028.00 toks/s, output: 29.32 toks/s]
Processed prompts:  20%|█▉        | 102/512 [00:03<00:19, 20.79it/s, est. speed input: 29515.77 toks/s, output: 28.82 toks/s]
Processed prompts:  21%|██        | 106/512 [00:03<00:19, 20.64it/s, est. speed input: 29055.19 toks/s, output: 28.37 toks/s]
Processed prompts:  21%|██▏       | 110/512 [00:03<00:19, 20.54it/s, est. speed input: 28641.13 toks/s, output: 27.97 toks/s]
Processed prompts:  22%|██▏       | 114/512 [00:04<00:19, 20.47it/s, est. speed input: 28265.82 toks/s, output: 27.60 toks/s]
Processed prompts:  23%|██▎       | 118/512 [00:04<00:19, 20.43it/s, est. speed input: 27927.74 toks/s, output: 27.27 toks/s]
Processed prompts:  24%|██▍       | 122/512 [00:04<00:19, 20.39it/s, est. speed input: 27616.69 toks/s, output: 26.97 toks/s]
Processed prompts:  25%|██▍       | 126/512 [00:04<00:18, 20.37it/s, est. speed input: 27332.37 toks/s, output: 26.69 toks/s]
Processed prompts:  25%|██▌       | 130/512 [00:04<00:18, 20.36it/s, est. speed input: 27072.17 toks/s, output: 26.44 toks/s]
Processed prompts:  26%|██▌       | 134/512 [00:05<00:18, 20.36it/s, est. speed input: 26833.07 toks/s, output: 26.20 toks/s]
Processed prompts:  27%|██▋       | 138/512 [00:05<00:18, 20.35it/s, est. speed input: 26609.62 toks/s, output: 25.99 toks/s]
Processed prompts:  28%|██▊       | 142/512 [00:05<00:18, 20.34it/s, est. speed input: 26402.60 toks/s, output: 25.78 toks/s]
Processed prompts:  29%|██▊       | 146/512 [00:05<00:18, 20.33it/s, est. speed input: 26208.88 toks/s, output: 25.59 toks/s]
Processed prompts:  29%|██▉       | 150/512 [00:05<00:17, 20.33it/s, est. speed input: 26029.58 toks/s, output: 25.42 toks/s]
Processed prompts:  36%|███▌      | 182/512 [00:06<00:05, 65.25it/s, est. speed input: 30676.81 toks/s, output: 29.96 toks/s]
Processed prompts:  37%|███▋      | 189/512 [00:06<00:05, 56.09it/s, est. speed input: 30854.84 toks/s, output: 30.13 toks/s]
Processed prompts:  38%|███▊      | 195/512 [00:06<00:08, 37.00it/s, est. speed input: 29954.99 toks/s, output: 29.25 toks/s]
Processed prompts:  39%|███▉      | 200/512 [00:06<00:09, 34.09it/s, est. speed input: 29840.88 toks/s, output: 29.14 toks/s]
Processed prompts:  40%|███▉      | 204/512 [00:07<00:09, 31.92it/s, est. speed input: 29732.84 toks/s, output: 29.04 toks/s]
Processed prompts:  41%|████      | 208/512 [00:07<00:10, 28.65it/s, est. speed input: 29490.89 toks/s, output: 28.80 toks/s]
Processed prompts:  41%|████▏     | 212/512 [00:07<00:11, 26.26it/s, est. speed input: 29261.46 toks/s, output: 28.58 toks/s]
Processed prompts:  42%|████▏     | 215/512 [00:07<00:12, 23.04it/s, est. speed input: 28907.36 toks/s, output: 28.23 toks/s]
Processed prompts:  43%|████▎     | 218/512 [00:07<00:14, 20.75it/s, est. speed input: 28572.38 toks/s, output: 27.90 toks/s]
Processed prompts:  43%|████▎     | 222/512 [00:08<00:14, 20.61it/s, est. speed input: 28380.59 toks/s, output: 27.72 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:08<00:13, 20.52it/s, est. speed input: 28197.75 toks/s, output: 27.54 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:08<00:13, 20.43it/s, est. speed input: 28021.94 toks/s, output: 27.37 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:08<00:13, 20.39it/s, est. speed input: 27856.05 toks/s, output: 27.20 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:08<00:13, 20.35it/s, est. speed input: 27696.14 toks/s, output: 27.05 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:08<00:13, 20.32it/s, est. speed input: 27543.37 toks/s, output: 26.90 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:09<00:13, 20.30it/s, est. speed input: 27397.24 toks/s, output: 26.76 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:09<00:12, 20.30it/s, est. speed input: 27258.28 toks/s, output: 26.62 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:09<00:12, 20.28it/s, est. speed input: 27123.66 toks/s, output: 26.49 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:09<00:12, 20.28it/s, est. speed input: 26995.55 toks/s, output: 26.36 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:09<00:12, 20.26it/s, est. speed input: 26870.78 toks/s, output: 26.24 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:10<00:12, 20.26it/s, est. speed input: 26751.72 toks/s, output: 26.12 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:10<00:11, 20.25it/s, est. speed input: 26636.55 toks/s, output: 26.01 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:10<00:11, 20.25it/s, est. speed input: 26526.18 toks/s, output: 25.90 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:10<00:11, 20.24it/s, est. speed input: 26419.73 toks/s, output: 25.80 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:10<00:11, 20.25it/s, est. speed input: 26317.38 toks/s, output: 25.70 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:11<00:11, 20.24it/s, est. speed input: 26218.35 toks/s, output: 25.60 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:11<00:10, 20.24it/s, est. speed input: 26122.83 toks/s, output: 25.51 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:11<00:10, 20.23it/s, est. speed input: 26029.59 toks/s, output: 25.42 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:11<00:10, 20.22it/s, est. speed input: 25939.46 toks/s, output: 25.33 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:11<00:10, 20.21it/s, est. speed input: 25852.00 toks/s, output: 25.25 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:12<00:10, 20.20it/s, est. speed input: 25767.90 toks/s, output: 25.16 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:12<00:10, 20.20it/s, est. speed input: 25686.13 toks/s, output: 25.08 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:12<00:09, 20.19it/s, est. speed input: 25606.66 toks/s, output: 25.01 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:12<00:09, 20.19it/s, est. speed input: 25530.16 toks/s, output: 24.93 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:12<00:09, 20.19it/s, est. speed input: 25455.71 toks/s, output: 24.86 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:13<00:09, 20.20it/s, est. speed input: 25384.69 toks/s, output: 24.79 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:13<00:08, 20.22it/s, est. speed input: 25316.16 toks/s, output: 24.72 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:13<00:08, 20.22it/s, est. speed input: 25248.52 toks/s, output: 24.66 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:13<00:08, 20.19it/s, est. speed input: 25181.43 toks/s, output: 24.59 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:13<00:08, 20.18it/s, est. speed input: 25117.04 toks/s, output: 24.53 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:14<00:08, 20.18it/s, est. speed input: 25054.50 toks/s, output: 24.47 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:14<00:08, 20.17it/s, est. speed input: 24993.10 toks/s, output: 24.41 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:14<00:07, 20.16it/s, est. speed input: 24933.52 toks/s, output: 24.35 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:14<00:07, 20.15it/s, est. speed input: 24875.37 toks/s, output: 24.29 toks/s]
Processed prompts:  71%|███████   | 362/512 [00:14<00:07, 20.15it/s, est. speed input: 24818.76 toks/s, output: 24.24 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:15<00:07, 20.13it/s, est. speed input: 24763.09 toks/s, output: 24.18 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [00:15<00:07, 20.13it/s, est. speed input: 24709.27 toks/s, output: 24.13 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [00:15<00:06, 20.12it/s, est. speed input: 24656.38 toks/s, output: 24.08 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [00:15<00:06, 20.12it/s, est. speed input: 24605.53 toks/s, output: 24.03 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [00:15<00:06, 20.12it/s, est. speed input: 24555.22 toks/s, output: 23.98 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [00:16<00:06, 20.13it/s, est. speed input: 24507.04 toks/s, output: 23.93 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [00:16<00:06, 20.13it/s, est. speed input: 24459.53 toks/s, output: 23.89 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [00:16<00:05, 20.12it/s, est. speed input: 24412.76 toks/s, output: 23.84 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [00:16<00:05, 20.12it/s, est. speed input: 24367.74 toks/s, output: 23.80 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [00:16<00:05, 20.12it/s, est. speed input: 24323.47 toks/s, output: 23.75 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [00:17<00:05, 20.12it/s, est. speed input: 24280.07 toks/s, output: 23.71 toks/s]
Processed prompts:  80%|████████  | 410/512 [00:17<00:05, 20.12it/s, est. speed input: 24237.86 toks/s, output: 23.67 toks/s]
Processed prompts:  81%|████████  | 414/512 [00:17<00:04, 20.12it/s, est. speed input: 24196.54 toks/s, output: 23.63 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [00:17<00:04, 20.11it/s, est. speed input: 24155.91 toks/s, output: 23.59 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [00:17<00:04, 20.12it/s, est. speed input: 24116.62 toks/s, output: 23.55 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [00:18<00:04, 20.11it/s, est. speed input: 24077.76 toks/s, output: 23.51 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [00:18<00:04, 20.10it/s, est. speed input: 24039.49 toks/s, output: 23.48 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [00:18<00:03, 20.09it/s, est. speed input: 24002.03 toks/s, output: 23.44 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [00:18<00:03, 20.08it/s, est. speed input: 23965.27 toks/s, output: 23.40 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [00:18<00:03, 20.08it/s, est. speed input: 23929.04 toks/s, output: 23.37 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [00:19<00:03, 20.07it/s, est. speed input: 23893.77 toks/s, output: 23.33 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [00:19<00:03, 20.09it/s, est. speed input: 23860.08 toks/s, output: 23.30 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [00:19<00:02, 20.09it/s, est. speed input: 23826.48 toks/s, output: 23.27 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [00:19<00:02, 20.10it/s, est. speed input: 23794.02 toks/s, output: 23.24 toks/s]
Processed prompts:  90%|█████████ | 462/512 [00:19<00:02, 20.11it/s, est. speed input: 23762.53 toks/s, output: 23.21 toks/s]
Processed prompts:  91%|█████████ | 466/512 [00:20<00:02, 20.12it/s, est. speed input: 23731.23 toks/s, output: 23.17 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [00:20<00:02, 20.10it/s, est. speed input: 23699.95 toks/s, output: 23.14 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [00:20<00:01, 20.10it/s, est. speed input: 23669.62 toks/s, output: 23.11 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [00:20<00:01, 20.10it/s, est. speed input: 23640.09 toks/s, output: 23.09 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [00:20<00:01, 20.10it/s, est. speed input: 23610.95 toks/s, output: 23.06 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [00:21<00:01, 20.11it/s, est. speed input: 23582.93 toks/s, output: 23.03 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [00:21<00:01, 20.10it/s, est. speed input: 23554.65 toks/s, output: 23.00 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [00:21<00:00, 20.12it/s, est. speed input: 23527.72 toks/s, output: 22.98 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [00:21<00:00, 20.09it/s, est. speed input: 23499.79 toks/s, output: 22.95 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [00:21<00:00, 20.06it/s, est. speed input: 23472.25 toks/s, output: 22.92 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [00:22<00:00, 20.08it/s, est. speed input: 23446.40 toks/s, output: 22.90 toks/s]
Processed prompts: 100%|█████████▉| 510/512 [00:22<00:00, 21.46it/s, est. speed input: 23465.75 toks/s, output: 22.92 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:22<00:00, 21.46it/s, est. speed input: 23557.54 toks/s, output: 23.01 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:22<00:00, 23.01it/s, est. speed input: 23557.54 toks/s, output: 23.01 toks/s]
[rank0]:[W126 04:02:07.378637935 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 75.6s

测试结果:
  Requests/s:   20.05
  Tokens/s:     20550.78
  Total Reqs:   512
  Elapsed:      25.54s

  [Prefill 分析]
  Total Prefill Tokens: 524288
  Prefill Tokens/s:     20530.73

============================================================
[5/8] 测试 M=8192
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 8192
│   M_prefill     = 8192 (= 8 x 1024)
│   M_decode      = 8
│   batched_tokens = 8192 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 1024
│   --max-num-seqs           = 8
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 8192
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 04:02:23 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 04:02:24 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=150979) WARNING 01-26 04:02:31 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=150979) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=150979) WARNING 01-26 04:02:44 [backends.py:609] Failed to read file <frozen os>
Throughput: 20.26 requests/s, 20767.35 total tokens/s, 20.26 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024


─── STDERR ───
[2026-01-26 04:02:23] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 04:02:23] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:02:23] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 04:02:23] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:02:23] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:02:23] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:02:23] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:02:23] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:02:23] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:02:23] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 04:02:23] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 04:02:23] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 04:02:23] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 04:02:23] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 04:02:31] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 04:02:31] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:02:31] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 04:02:31] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:02:31] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:02:31] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:02:31] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:02:31] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:02:31] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:02:31] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 04:02:31] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 04:02:31] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 04:02:31] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 04:02:31] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=150979) [2026-01-26 04:02:32] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=150979) [2026-01-26 04:02:32] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=150979) [2026-01-26 04:02:32] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=150979) [2026-01-26 04:02:32] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=150979) [2026-01-26 04:02:32] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=150979) [2026-01-26 04:02:32] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=150979) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=150979) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.15it/s]
(EngineCore_DP0 pid=150979) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.06s/it]
(EngineCore_DP0 pid=150979) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.03s/it]
(EngineCore_DP0 pid=150979) 
(EngineCore_DP0 pid=150979) [2026-01-26 04:02:35] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 4800] -> 1D uint8
(EngineCore_DP0 pid=150979) [2026-01-26 04:02:35] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 16662528 bytes
(EngineCore_DP0 pid=150979) [2026-01-26 04:02:35] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 4800] -> 1D uint8
(EngineCore_DP0 pid=150979) [2026-01-26 04:02:35] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12959744 bytes
(EngineCore_DP0 pid=150979) [2026-01-26 04:02:35] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 4800] -> 1D uint8
(EngineCore_DP0 pid=150979) [2026-01-26 04:02:35] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 137003008 bytes
(EngineCore_DP0 pid=150979) [2026-01-26 04:02:35] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 25280] -> 1D uint8
(EngineCore_DP0 pid=150979) [2026-01-26 04:02:35] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 68009984 bytes
(EngineCore_DP0 pid=150979) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:01,  2.52it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  40%|████      | 2/5 [00:00<00:00,  4.32it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  60%|██████    | 3/5 [00:00<00:00,  5.73it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  80%|████████  | 4/5 [00:00<00:00,  6.72it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00,  6.83it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00,  5.74it/s]
(EngineCore_DP0 pid=150979) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:00,  7.03it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 2/4 [00:00<00:00,  8.14it/s]
Capturing CUDA graphs (decode, FULL):  75%|███████▌  | 3/4 [00:00<00:00,  8.59it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  8.89it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  8.57it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 25/1024 [00:00<00:04, 240.47it/s]
Adding requests:   5%|▌         | 52/1024 [00:00<00:03, 252.89it/s]
Adding requests:   8%|▊         | 80/1024 [00:00<00:03, 262.02it/s]
Adding requests:  10%|█         | 107/1024 [00:00<00:03, 255.84it/s]
Adding requests:  13%|█▎        | 133/1024 [00:00<00:03, 252.84it/s]
Adding requests:  16%|█▌        | 161/1024 [00:00<00:03, 260.17it/s]
Adding requests:  19%|█▊        | 190/1024 [00:00<00:03, 269.37it/s]
Adding requests:  21%|██▏       | 218/1024 [00:00<00:02, 271.11it/s]
Adding requests:  24%|██▍       | 246/1024 [00:00<00:02, 271.23it/s]
Adding requests:  27%|██▋       | 274/1024 [00:01<00:02, 270.43it/s]
Adding requests:  30%|██▉       | 303/1024 [00:01<00:02, 274.00it/s]
Adding requests:  32%|███▏      | 331/1024 [00:01<00:02, 273.10it/s]
Adding requests:  35%|███▌      | 359/1024 [00:01<00:02, 270.88it/s]
Adding requests:  38%|███▊      | 387/1024 [00:01<00:02, 272.45it/s]
Adding requests:  41%|████      | 415/1024 [00:01<00:02, 273.04it/s]
Adding requests:  43%|████▎     | 443/1024 [00:01<00:02, 270.21it/s]
Adding requests:  46%|████▌     | 472/1024 [00:01<00:02, 273.28it/s]
Adding requests:  49%|████▉     | 502/1024 [00:01<00:01, 277.83it/s]
Adding requests:  52%|█████▏    | 532/1024 [00:01<00:01, 283.15it/s]
Adding requests:  55%|█████▍    | 561/1024 [00:02<00:01, 283.33it/s]
Adding requests:  58%|█████▊    | 590/1024 [00:02<00:01, 277.41it/s]
Adding requests:  60%|██████    | 618/1024 [00:02<00:01, 275.76it/s]
Adding requests:  63%|██████▎   | 646/1024 [00:02<00:01, 267.26it/s]
Adding requests:  66%|██████▌   | 673/1024 [00:02<00:01, 267.52it/s]
Adding requests:  69%|██████▊   | 703/1024 [00:02<00:01, 276.24it/s]
Adding requests:  71%|███████▏  | 731/1024 [00:02<00:01, 268.48it/s]
Adding requests:  74%|███████▍  | 758/1024 [00:02<00:00, 268.72it/s]
Adding requests:  77%|███████▋  | 787/1024 [00:02<00:00, 273.43it/s]
Adding requests:  80%|███████▉  | 815/1024 [00:03<00:00, 272.92it/s]
Adding requests:  82%|████████▏ | 844/1024 [00:03<00:00, 277.10it/s]
Adding requests:  85%|████████▌ | 873/1024 [00:03<00:00, 279.67it/s]
Adding requests:  88%|████████▊ | 901/1024 [00:03<00:00, 279.62it/s]
Adding requests:  91%|█████████ | 929/1024 [00:03<00:00, 267.56it/s]
Adding requests:  94%|█████████▎| 958/1024 [00:03<00:00, 270.75it/s]
Adding requests:  96%|█████████▋| 986/1024 [00:03<00:00, 270.53it/s]
Adding requests:  99%|█████████▉| 1014/1024 [00:03<00:00, 266.30it/s]
Adding requests: 100%|██████████| 1024/1024 [00:03<00:00, 270.62it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   7%|▋         | 74/1024 [00:00<00:05, 182.25it/s, est. speed input: 186635.95 toks/s, output: 182.25 toks/s]
Processed prompts:   9%|▉         | 93/1024 [00:01<00:13, 66.59it/s, est. speed input: 80360.49 toks/s, output: 78.48 toks/s]   
Processed prompts:  10%|▉         | 102/1024 [00:01<00:17, 51.64it/s, est. speed input: 66329.74 toks/s, output: 64.77 toks/s]
Processed prompts:  11%|█         | 108/1024 [00:01<00:23, 39.70it/s, est. speed input: 56289.26 toks/s, output: 54.97 toks/s]
Processed prompts:  11%|█         | 114/1024 [00:02<00:28, 31.92it/s, est. speed input: 49580.58 toks/s, output: 48.42 toks/s]
Processed prompts:  12%|█▏        | 122/1024 [00:02<00:31, 28.34it/s, est. speed input: 45516.25 toks/s, output: 44.45 toks/s]
Processed prompts:  13%|█▎        | 130/1024 [00:03<00:34, 25.92it/s, est. speed input: 42466.37 toks/s, output: 41.47 toks/s]
Processed prompts:  13%|█▎        | 138/1024 [00:03<00:36, 24.25it/s, est. speed input: 40089.00 toks/s, output: 39.15 toks/s]
Processed prompts:  14%|█▍        | 146/1024 [00:03<00:37, 23.11it/s, est. speed input: 38182.87 toks/s, output: 37.29 toks/s]
Processed prompts:  15%|█▌        | 154/1024 [00:04<00:38, 22.31it/s, est. speed input: 36623.03 toks/s, output: 35.76 toks/s]
Processed prompts:  16%|█▌        | 162/1024 [00:04<00:39, 21.75it/s, est. speed input: 35319.06 toks/s, output: 34.49 toks/s]
Processed prompts:  17%|█▋        | 170/1024 [00:05<00:39, 21.36it/s, est. speed input: 34215.25 toks/s, output: 33.41 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [00:05<00:40, 21.09it/s, est. speed input: 33268.64 toks/s, output: 32.49 toks/s]
Processed prompts:  18%|█▊        | 186/1024 [00:05<00:40, 20.90it/s, est. speed input: 32448.75 toks/s, output: 31.69 toks/s]
Processed prompts:  19%|█▉        | 194/1024 [00:06<00:39, 20.77it/s, est. speed input: 31730.42 toks/s, output: 30.99 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [00:06<00:38, 21.21it/s, est. speed input: 31251.77 toks/s, output: 30.52 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:07<00:38, 20.97it/s, est. speed input: 30674.64 toks/s, output: 29.96 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [00:07<00:38, 20.81it/s, est. speed input: 30158.60 toks/s, output: 29.45 toks/s]
Processed prompts:  22%|██▏       | 226/1024 [00:07<00:38, 20.69it/s, est. speed input: 29694.21 toks/s, output: 29.00 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:08<00:38, 20.61it/s, est. speed input: 29273.05 toks/s, output: 28.59 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:08<00:38, 20.55it/s, est. speed input: 28891.01 toks/s, output: 28.21 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:08<00:37, 20.50it/s, est. speed input: 28541.04 toks/s, output: 27.87 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:09<00:37, 20.47it/s, est. speed input: 28219.70 toks/s, output: 27.56 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:09<00:37, 20.44it/s, est. speed input: 27923.96 toks/s, output: 27.27 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:10<00:36, 20.42it/s, est. speed input: 27649.99 toks/s, output: 27.00 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:10<00:36, 20.41it/s, est. speed input: 27398.03 toks/s, output: 26.76 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:10<00:35, 20.39it/s, est. speed input: 27162.52 toks/s, output: 26.53 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:11<00:35, 20.39it/s, est. speed input: 26943.75 toks/s, output: 26.31 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:11<00:35, 20.38it/s, est. speed input: 26740.18 toks/s, output: 26.11 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:12<00:34, 20.38it/s, est. speed input: 26548.94 toks/s, output: 25.93 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:12<00:34, 20.36it/s, est. speed input: 26368.90 toks/s, output: 25.75 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:12<00:34, 20.35it/s, est. speed input: 26199.44 toks/s, output: 25.59 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:13<00:33, 20.34it/s, est. speed input: 26039.74 toks/s, output: 25.43 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:13<00:33, 20.33it/s, est. speed input: 25888.55 toks/s, output: 25.28 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:14<00:32, 20.32it/s, est. speed input: 25746.07 toks/s, output: 25.14 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:14<00:32, 20.31it/s, est. speed input: 25610.53 toks/s, output: 25.01 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:14<00:32, 20.30it/s, est. speed input: 25481.95 toks/s, output: 24.88 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:15<00:31, 20.30it/s, est. speed input: 25360.34 toks/s, output: 24.77 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:15<00:31, 20.29it/s, est. speed input: 25244.44 toks/s, output: 24.65 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [00:16<00:31, 20.29it/s, est. speed input: 25134.53 toks/s, output: 24.55 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:16<00:30, 20.27it/s, est. speed input: 25028.52 toks/s, output: 24.44 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:16<00:30, 20.27it/s, est. speed input: 24928.31 toks/s, output: 24.34 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:17<00:29, 20.27it/s, est. speed input: 24832.74 toks/s, output: 24.25 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:17<00:29, 20.27it/s, est. speed input: 24741.14 toks/s, output: 24.16 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:18<00:29, 20.26it/s, est. speed input: 24653.28 toks/s, output: 24.08 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:18<00:28, 20.26it/s, est. speed input: 24569.56 toks/s, output: 23.99 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:18<00:28, 20.26it/s, est. speed input: 24489.07 toks/s, output: 23.92 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:19<00:11, 45.45it/s, est. speed input: 25963.79 toks/s, output: 25.36 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:19<00:14, 36.98it/s, est. speed input: 25857.20 toks/s, output: 25.25 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:19<00:16, 31.55it/s, est. speed input: 25754.94 toks/s, output: 25.15 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:20<00:18, 27.97it/s, est. speed input: 25656.60 toks/s, output: 25.06 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:20<00:19, 25.57it/s, est. speed input: 25562.49 toks/s, output: 24.96 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:20<00:20, 23.93it/s, est. speed input: 25471.79 toks/s, output: 24.87 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:21<00:21, 22.80it/s, est. speed input: 25383.90 toks/s, output: 24.79 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:21<00:22, 22.02it/s, est. speed input: 25298.87 toks/s, output: 24.71 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:22<00:22, 21.47it/s, est. speed input: 25217.03 toks/s, output: 24.63 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:22<00:22, 21.10it/s, est. speed input: 25138.42 toks/s, output: 24.55 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:22<00:22, 20.84it/s, est. speed input: 25062.58 toks/s, output: 24.48 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:23<00:21, 20.67it/s, est. speed input: 24989.54 toks/s, output: 24.40 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:23<00:21, 20.55it/s, est. speed input: 24918.99 toks/s, output: 24.33 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:24<00:21, 20.46it/s, est. speed input: 24850.59 toks/s, output: 24.27 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:24<00:21, 20.39it/s, est. speed input: 24784.19 toks/s, output: 24.20 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:24<00:20, 20.35it/s, est. speed input: 24720.09 toks/s, output: 24.14 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:25<00:20, 20.32it/s, est. speed input: 24658.20 toks/s, output: 24.08 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:25<00:19, 20.30it/s, est. speed input: 24598.06 toks/s, output: 24.02 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:26<00:19, 20.29it/s, est. speed input: 24539.98 toks/s, output: 23.96 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:26<00:19, 20.28it/s, est. speed input: 24483.58 toks/s, output: 23.91 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:26<00:18, 20.28it/s, est. speed input: 24428.87 toks/s, output: 23.86 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:27<00:18, 20.28it/s, est. speed input: 24375.81 toks/s, output: 23.80 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:27<00:18, 20.27it/s, est. speed input: 24324.19 toks/s, output: 23.75 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:28<00:17, 20.27it/s, est. speed input: 24273.91 toks/s, output: 23.70 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:28<00:17, 20.27it/s, est. speed input: 24225.46 toks/s, output: 23.66 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:28<00:16, 20.27it/s, est. speed input: 24178.00 toks/s, output: 23.61 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:29<00:16, 20.27it/s, est. speed input: 24131.84 toks/s, output: 23.57 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:29<00:16, 20.27it/s, est. speed input: 24087.04 toks/s, output: 23.52 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:30<00:15, 20.27it/s, est. speed input: 24043.49 toks/s, output: 23.48 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:30<00:15, 20.28it/s, est. speed input: 24001.26 toks/s, output: 23.44 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:30<00:14, 20.28it/s, est. speed input: 23960.06 toks/s, output: 23.40 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:31<00:14, 20.28it/s, est. speed input: 23919.78 toks/s, output: 23.36 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:31<00:14, 20.29it/s, est. speed input: 23880.68 toks/s, output: 23.32 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:32<00:13, 20.29it/s, est. speed input: 23842.69 toks/s, output: 23.28 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:32<00:13, 20.29it/s, est. speed input: 23805.47 toks/s, output: 23.25 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:32<00:12, 20.29it/s, est. speed input: 23769.22 toks/s, output: 23.21 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:33<00:12, 20.29it/s, est. speed input: 23733.78 toks/s, output: 23.18 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:33<00:12, 20.29it/s, est. speed input: 23699.13 toks/s, output: 23.14 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:33<00:11, 20.85it/s, est. speed input: 23689.83 toks/s, output: 23.13 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:34<00:11, 20.68it/s, est. speed input: 23656.59 toks/s, output: 23.10 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:34<00:10, 20.57it/s, est. speed input: 23623.98 toks/s, output: 23.07 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:35<00:10, 20.48it/s, est. speed input: 23592.06 toks/s, output: 23.04 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:35<00:10, 20.43it/s, est. speed input: 23560.96 toks/s, output: 23.01 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:35<00:09, 20.39it/s, est. speed input: 23530.67 toks/s, output: 22.98 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:36<00:09, 20.36it/s, est. speed input: 23500.81 toks/s, output: 22.95 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [00:36<00:08, 20.34it/s, est. speed input: 23471.65 toks/s, output: 22.92 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [00:37<00:08, 20.33it/s, est. speed input: 23443.18 toks/s, output: 22.89 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:37<00:08, 20.31it/s, est. speed input: 23415.14 toks/s, output: 22.87 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [00:37<00:07, 20.31it/s, est. speed input: 23387.82 toks/s, output: 22.84 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [00:38<00:07, 20.30it/s, est. speed input: 23360.78 toks/s, output: 22.81 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [00:38<00:06, 20.30it/s, est. speed input: 23334.52 toks/s, output: 22.79 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [00:39<00:06, 20.30it/s, est. speed input: 23308.82 toks/s, output: 22.76 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [00:39<00:06, 20.30it/s, est. speed input: 23283.59 toks/s, output: 22.74 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [00:39<00:05, 20.30it/s, est. speed input: 23258.93 toks/s, output: 22.71 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [00:40<00:05, 20.29it/s, est. speed input: 23234.56 toks/s, output: 22.69 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [00:40<00:05, 20.29it/s, est. speed input: 23210.70 toks/s, output: 22.67 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [00:41<00:04, 20.29it/s, est. speed input: 23187.44 toks/s, output: 22.64 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [00:41<00:04, 20.29it/s, est. speed input: 23164.57 toks/s, output: 22.62 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [00:41<00:03, 20.29it/s, est. speed input: 23142.02 toks/s, output: 22.60 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [00:42<00:03, 20.29it/s, est. speed input: 23120.02 toks/s, output: 22.58 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [00:42<00:03, 20.29it/s, est. speed input: 23098.43 toks/s, output: 22.56 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [00:43<00:02, 20.29it/s, est. speed input: 23077.05 toks/s, output: 22.54 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [00:43<00:02, 20.29it/s, est. speed input: 23056.35 toks/s, output: 22.52 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [00:43<00:01, 20.29it/s, est. speed input: 23035.71 toks/s, output: 22.50 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [00:44<00:01, 20.29it/s, est. speed input: 23015.53 toks/s, output: 22.48 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [00:44<00:01, 20.29it/s, est. speed input: 22995.85 toks/s, output: 22.46 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [00:45<00:00, 20.29it/s, est. speed input: 22976.42 toks/s, output: 22.44 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [00:45<00:00, 20.93it/s, est. speed input: 22977.67 toks/s, output: 22.44 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:45<00:00, 20.93it/s, est. speed input: 23112.94 toks/s, output: 22.57 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:45<00:00, 22.57it/s, est. speed input: 23112.94 toks/s, output: 22.57 toks/s]
[rank0]:[W126 04:03:50.132033601 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 103.5s

测试结果:
  Requests/s:   20.26
  Tokens/s:     20767.35
  Total Reqs:   1024
  Elapsed:      50.54s

  [Prefill 分析]
  Total Prefill Tokens: 1048576
  Prefill Tokens/s:     20747.09

============================================================
[6/8] 测试 M=16384
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 16384
│   M_prefill     = 16384 (= 16 x 1024)
│   M_decode      = 16
│   batched_tokens = 16384 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 2048
│   --max-num-seqs           = 16
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 16384
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 04:04:14 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 04:04:15 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=152785) WARNING 01-26 04:04:22 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=152785) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=152785) WARNING 01-26 04:04:33 [backends.py:609] Failed to read file <frozen os>
Throughput: 20.25 requests/s, 20759.31 total tokens/s, 20.25 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048


─── STDERR ───
[2026-01-26 04:04:14] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 04:04:14] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:04:14] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 04:04:14] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:04:14] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:04:14] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:04:14] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:04:14] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:04:14] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:04:14] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 04:04:14] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 04:04:14] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 04:04:14] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 04:04:14] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 04:04:22] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 04:04:22] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:04:22] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 04:04:22] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:04:22] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:04:22] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:04:22] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:04:22] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:04:22] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:04:22] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 04:04:22] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 04:04:22] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 04:04:22] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 04:04:22] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=152785) [2026-01-26 04:04:23] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=152785) [2026-01-26 04:04:23] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=152785) [2026-01-26 04:04:23] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=152785) [2026-01-26 04:04:23] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=152785) [2026-01-26 04:04:23] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=152785) [2026-01-26 04:04:23] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=152785) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=152785) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.20it/s]
(EngineCore_DP0 pid=152785) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.06s/it]
(EngineCore_DP0 pid=152785) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.03s/it]
(EngineCore_DP0 pid=152785) 
(EngineCore_DP0 pid=152785) [2026-01-26 04:04:25] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 4800] -> 1D uint8
(EngineCore_DP0 pid=152785) [2026-01-26 04:04:26] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 16662528 bytes
(EngineCore_DP0 pid=152785) [2026-01-26 04:04:26] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 4800] -> 1D uint8
(EngineCore_DP0 pid=152785) [2026-01-26 04:04:26] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12959744 bytes
(EngineCore_DP0 pid=152785) [2026-01-26 04:04:26] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 4800] -> 1D uint8
(EngineCore_DP0 pid=152785) [2026-01-26 04:04:26] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 137003008 bytes
(EngineCore_DP0 pid=152785) [2026-01-26 04:04:26] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 25280] -> 1D uint8
(EngineCore_DP0 pid=152785) [2026-01-26 04:04:26] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 68009984 bytes
(EngineCore_DP0 pid=152785) [rank0]:W0126 04:04:42.063000 152785 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=152785) [rank0]:W0126 04:04:42.176000 152785 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=152785) [rank0]:W0126 04:04:43.842000 152785 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=152785) [rank0]:W0126 04:04:44.017000 152785 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=152785) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  14%|█▍        | 1/7 [00:00<00:00,  7.91it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  29%|██▊       | 2/7 [00:00<00:00,  8.28it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  43%|████▎     | 3/7 [00:00<00:00,  8.60it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  57%|█████▋    | 4/7 [00:00<00:00,  8.81it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  71%|███████▏  | 5/7 [00:00<00:00,  8.74it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  86%|████████▌ | 6/7 [00:00<00:00,  8.82it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00,  8.13it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00,  8.39it/s]
(EngineCore_DP0 pid=152785) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  20%|██        | 1/5 [00:00<00:00,  7.10it/s]
Capturing CUDA graphs (decode, FULL):  40%|████      | 2/5 [00:00<00:00,  8.15it/s]
Capturing CUDA graphs (decode, FULL):  60%|██████    | 3/5 [00:00<00:00,  8.54it/s]
Capturing CUDA graphs (decode, FULL):  80%|████████  | 4/5 [00:00<00:00,  8.82it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00,  9.03it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00,  8.69it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   1%|          | 25/2048 [00:00<00:08, 242.80it/s]
Adding requests:   3%|▎         | 52/2048 [00:00<00:07, 256.29it/s]
Adding requests:   4%|▍         | 79/2048 [00:00<00:07, 260.93it/s]
Adding requests:   5%|▌         | 106/2048 [00:00<00:07, 262.29it/s]
Adding requests:   6%|▋         | 133/2048 [00:00<00:07, 262.70it/s]
Adding requests:   8%|▊         | 161/2048 [00:00<00:07, 267.03it/s]
Adding requests:   9%|▉         | 190/2048 [00:00<00:06, 273.88it/s]
Adding requests:  11%|█         | 218/2048 [00:00<00:06, 271.48it/s]
Adding requests:  12%|█▏        | 246/2048 [00:00<00:06, 272.89it/s]
Adding requests:  13%|█▎        | 274/2048 [00:01<00:06, 269.72it/s]
Adding requests:  15%|█▍        | 303/2048 [00:01<00:06, 273.48it/s]
Adding requests:  16%|█▌        | 332/2048 [00:01<00:06, 276.26it/s]
Adding requests:  18%|█▊        | 362/2048 [00:01<00:06, 280.45it/s]
Adding requests:  19%|█▉        | 391/2048 [00:01<00:05, 282.62it/s]
Adding requests:  21%|██        | 421/2048 [00:01<00:05, 285.57it/s]
Adding requests:  22%|██▏       | 450/2048 [00:01<00:05, 279.66it/s]
Adding requests:  23%|██▎       | 481/2048 [00:01<00:05, 287.62it/s]
Adding requests:  25%|██▍       | 510/2048 [00:01<00:05, 282.46it/s]
Adding requests:  26%|██▋       | 539/2048 [00:01<00:05, 279.49it/s]
Adding requests:  28%|██▊       | 568/2048 [00:02<00:05, 279.51it/s]
Adding requests:  29%|██▉       | 596/2048 [00:02<00:05, 269.33it/s]
Adding requests:  30%|███       | 624/2048 [00:02<00:05, 268.31it/s]
Adding requests:  32%|███▏      | 651/2048 [00:02<00:05, 265.88it/s]
Adding requests:  33%|███▎      | 678/2048 [00:02<00:05, 265.20it/s]
Adding requests:  34%|███▍      | 706/2048 [00:02<00:05, 266.22it/s]
Adding requests:  36%|███▌      | 733/2048 [00:02<00:04, 266.13it/s]
Adding requests:  37%|███▋      | 760/2048 [00:02<00:04, 266.09it/s]
Adding requests:  39%|███▊      | 789/2048 [00:02<00:04, 271.20it/s]
Adding requests:  40%|███▉      | 817/2048 [00:03<00:04, 271.45it/s]
Adding requests:  41%|████▏     | 847/2048 [00:03<00:04, 270.92it/s]
Adding requests:  43%|████▎     | 875/2048 [00:03<00:04, 273.34it/s]
Adding requests:  44%|████▍     | 904/2048 [00:03<00:04, 277.77it/s]
Adding requests:  46%|████▌     | 932/2048 [00:03<00:04, 269.95it/s]
Adding requests:  47%|████▋     | 960/2048 [00:03<00:04, 271.69it/s]
Adding requests:  48%|████▊     | 988/2048 [00:03<00:03, 271.66it/s]
Adding requests:  50%|████▉     | 1016/2048 [00:03<00:03, 268.67it/s]
Adding requests:  51%|█████     | 1044/2048 [00:03<00:03, 270.27it/s]
Adding requests:  52%|█████▏    | 1072/2048 [00:03<00:03, 266.54it/s]
Adding requests:  54%|█████▎    | 1099/2048 [00:04<00:03, 266.94it/s]
Adding requests:  55%|█████▌    | 1128/2048 [00:04<00:03, 272.76it/s]
Adding requests:  56%|█████▋    | 1156/2048 [00:04<00:03, 269.07it/s]
Adding requests:  58%|█████▊    | 1184/2048 [00:04<00:03, 269.90it/s]
Adding requests:  59%|█████▉    | 1213/2048 [00:04<00:03, 272.85it/s]
Adding requests:  61%|██████    | 1241/2048 [00:04<00:02, 274.20it/s]
Adding requests:  62%|██████▏   | 1269/2048 [00:04<00:02, 271.27it/s]
Adding requests:  81%|████████▏ | 1669/2048 [00:04<00:00, 1353.42it/s]
Adding requests:  88%|████████▊ | 1806/2048 [00:05<00:00, 631.68it/s] 
Adding requests:  93%|█████████▎| 1911/2048 [00:05<00:00, 482.46it/s]
Adding requests:  97%|█████████▋| 1993/2048 [00:05<00:00, 417.77it/s]
Adding requests: 100%|██████████| 2048/2048 [00:06<00:00, 332.92it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   7%|▋         | 146/2048 [00:00<00:07, 251.31it/s, est. speed input: 257349.70 toks/s, output: 251.31 toks/s]
Processed prompts:   8%|▊         | 172/2048 [00:01<00:17, 107.77it/s, est. speed input: 129144.96 toks/s, output: 126.12 toks/s]
Processed prompts:   9%|▉         | 185/2048 [00:02<00:29, 63.63it/s, est. speed input: 88281.51 toks/s, output: 86.21 toks/s]   
Processed prompts:   9%|▉         | 194/2048 [00:02<00:43, 42.32it/s, est. speed input: 67857.43 toks/s, output: 66.27 toks/s]
Processed prompts:  10%|█         | 210/2048 [00:03<00:53, 34.24it/s, est. speed input: 57948.21 toks/s, output: 56.59 toks/s]
Processed prompts:  11%|█         | 226/2048 [00:04<01:01, 29.47it/s, est. speed input: 51492.84 toks/s, output: 50.29 toks/s]
Processed prompts:  12%|█▏        | 242/2048 [00:05<01:08, 26.46it/s, est. speed input: 46939.66 toks/s, output: 45.84 toks/s]
Processed prompts:  13%|█▎        | 258/2048 [00:06<01:13, 24.52it/s, est. speed input: 43569.11 toks/s, output: 42.55 toks/s]
Processed prompts:  13%|█▎        | 274/2048 [00:06<01:16, 23.22it/s, est. speed input: 40969.14 toks/s, output: 40.01 toks/s]
Processed prompts:  14%|█▍        | 290/2048 [00:07<01:18, 22.33it/s, est. speed input: 38898.20 toks/s, output: 37.99 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [00:08<01:20, 21.73it/s, est. speed input: 37212.99 toks/s, output: 36.34 toks/s]
Processed prompts:  16%|█▌        | 322/2048 [00:09<01:21, 21.31it/s, est. speed input: 35814.45 toks/s, output: 34.97 toks/s]
Processed prompts:  17%|█▋        | 338/2048 [00:09<01:21, 21.01it/s, est. speed input: 34635.79 toks/s, output: 33.82 toks/s]
Processed prompts:  17%|█▋        | 354/2048 [00:10<01:21, 20.81it/s, est. speed input: 33627.64 toks/s, output: 32.84 toks/s]
Processed prompts:  18%|█▊        | 370/2048 [00:11<01:21, 20.66it/s, est. speed input: 32755.56 toks/s, output: 31.99 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [00:12<01:20, 20.56it/s, est. speed input: 31994.37 toks/s, output: 31.24 toks/s]
Processed prompts:  20%|█▉        | 402/2048 [00:13<01:20, 20.44it/s, est. speed input: 31307.86 toks/s, output: 30.57 toks/s]
Processed prompts:  20%|██        | 418/2048 [00:13<01:19, 20.40it/s, est. speed input: 30713.60 toks/s, output: 29.99 toks/s]
Processed prompts:  21%|██        | 434/2048 [00:14<01:19, 20.37it/s, est. speed input: 30181.80 toks/s, output: 29.47 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [00:15<01:18, 20.34it/s, est. speed input: 29703.06 toks/s, output: 29.01 toks/s]
Processed prompts:  23%|██▎       | 466/2048 [00:16<01:17, 20.33it/s, est. speed input: 29271.80 toks/s, output: 28.59 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [00:17<01:17, 20.32it/s, est. speed input: 28881.38 toks/s, output: 28.20 toks/s]
Processed prompts:  24%|██▍       | 498/2048 [00:17<01:16, 20.31it/s, est. speed input: 28522.75 toks/s, output: 27.85 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [00:18<01:15, 20.29it/s, est. speed input: 28193.78 toks/s, output: 27.53 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [00:19<01:14, 20.29it/s, est. speed input: 27892.30 toks/s, output: 27.24 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [00:20<01:14, 20.28it/s, est. speed input: 27614.21 toks/s, output: 26.97 toks/s]
Processed prompts:  27%|██▋       | 562/2048 [00:21<01:13, 20.27it/s, est. speed input: 27355.67 toks/s, output: 26.71 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [00:21<01:12, 20.27it/s, est. speed input: 27116.70 toks/s, output: 26.48 toks/s]
Processed prompts:  29%|██▉       | 594/2048 [00:22<01:11, 20.26it/s, est. speed input: 26893.21 toks/s, output: 26.26 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [00:23<01:10, 20.26it/s, est. speed input: 26686.20 toks/s, output: 26.06 toks/s]
Processed prompts:  31%|███       | 626/2048 [00:24<01:10, 20.26it/s, est. speed input: 26492.32 toks/s, output: 25.87 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [00:24<01:09, 20.25it/s, est. speed input: 26309.71 toks/s, output: 25.69 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [00:25<01:08, 20.25it/s, est. speed input: 26138.42 toks/s, output: 25.53 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [00:26<01:07, 20.25it/s, est. speed input: 25977.64 toks/s, output: 25.37 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [00:27<01:07, 20.25it/s, est. speed input: 25826.95 toks/s, output: 25.22 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [00:28<01:06, 20.25it/s, est. speed input: 25683.45 toks/s, output: 25.08 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [00:28<01:05, 20.25it/s, est. speed input: 25548.75 toks/s, output: 24.95 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [00:29<00:37, 34.31it/s, est. speed input: 26518.62 toks/s, output: 25.90 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [00:29<00:43, 29.29it/s, est. speed input: 26367.20 toks/s, output: 25.75 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [00:30<00:47, 26.64it/s, est. speed input: 26253.34 toks/s, output: 25.64 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [00:31<00:50, 24.54it/s, est. speed input: 26115.09 toks/s, output: 25.50 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [00:32<00:53, 23.19it/s, est. speed input: 25985.13 toks/s, output: 25.38 toks/s]
Processed prompts:  41%|████      | 834/2048 [00:33<00:54, 22.28it/s, est. speed input: 25861.19 toks/s, output: 25.26 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [00:33<00:55, 21.65it/s, est. speed input: 25741.47 toks/s, output: 25.14 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [00:34<00:55, 21.24it/s, est. speed input: 25628.42 toks/s, output: 25.03 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [00:35<00:55, 20.96it/s, est. speed input: 25521.46 toks/s, output: 24.92 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [00:36<00:55, 20.75it/s, est. speed input: 25417.74 toks/s, output: 24.82 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [00:36<00:55, 20.60it/s, est. speed input: 25317.75 toks/s, output: 24.72 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [00:37<00:54, 20.51it/s, est. speed input: 25222.89 toks/s, output: 24.63 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [00:38<00:53, 20.45it/s, est. speed input: 25132.20 toks/s, output: 24.54 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [00:39<00:53, 20.40it/s, est. speed input: 25045.13 toks/s, output: 24.46 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [00:40<00:52, 20.36it/s, est. speed input: 24960.34 toks/s, output: 24.38 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [00:40<00:51, 20.33it/s, est. speed input: 24879.19 toks/s, output: 24.30 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [00:41<00:51, 20.32it/s, est. speed input: 24801.62 toks/s, output: 24.22 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [00:42<00:50, 20.31it/s, est. speed input: 24726.65 toks/s, output: 24.15 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [00:43<00:49, 20.28it/s, est. speed input: 24653.31 toks/s, output: 24.08 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [00:44<00:48, 20.28it/s, est. speed input: 24583.90 toks/s, output: 24.01 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [00:44<00:48, 20.29it/s, est. speed input: 24516.99 toks/s, output: 23.94 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [00:45<00:47, 20.27it/s, est. speed input: 24451.19 toks/s, output: 23.88 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [00:46<00:46, 20.27it/s, est. speed input: 24388.67 toks/s, output: 23.82 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [00:47<00:45, 20.28it/s, est. speed input: 24328.30 toks/s, output: 23.76 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [00:48<00:44, 20.27it/s, est. speed input: 24269.21 toks/s, output: 23.70 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [00:48<00:44, 20.28it/s, est. speed input: 24212.93 toks/s, output: 23.65 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [00:49<00:43, 20.27it/s, est. speed input: 24157.85 toks/s, output: 23.59 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [00:50<00:42, 20.27it/s, est. speed input: 24104.66 toks/s, output: 23.54 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [00:51<00:41, 20.27it/s, est. speed input: 24052.53 toks/s, output: 23.49 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [00:51<00:40, 20.27it/s, est. speed input: 24002.86 toks/s, output: 23.44 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [00:52<00:40, 20.28it/s, est. speed input: 23954.53 toks/s, output: 23.39 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [00:53<00:39, 20.27it/s, est. speed input: 23907.00 toks/s, output: 23.35 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [00:54<00:38, 20.27it/s, est. speed input: 23861.45 toks/s, output: 23.30 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [00:55<00:37, 20.28it/s, est. speed input: 23817.34 toks/s, output: 23.26 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [00:55<00:36, 20.28it/s, est. speed input: 23774.54 toks/s, output: 23.22 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [00:56<00:36, 20.27it/s, est. speed input: 23732.08 toks/s, output: 23.18 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [00:57<00:35, 20.27it/s, est. speed input: 23691.35 toks/s, output: 23.14 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [00:58<00:34, 20.28it/s, est. speed input: 23652.01 toks/s, output: 23.10 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [00:59<00:33, 20.27it/s, est. speed input: 23612.84 toks/s, output: 23.06 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [00:59<00:33, 20.27it/s, est. speed input: 23575.25 toks/s, output: 23.02 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [01:00<00:32, 20.28it/s, est. speed input: 23538.89 toks/s, output: 22.99 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [01:00<00:18, 34.39it/s, est. speed input: 24010.02 toks/s, output: 23.45 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [01:01<00:20, 29.35it/s, est. speed input: 23968.99 toks/s, output: 23.41 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [01:02<00:22, 26.28it/s, est. speed input: 23928.77 toks/s, output: 23.37 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [01:03<00:23, 24.31it/s, est. speed input: 23888.83 toks/s, output: 23.33 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [01:03<00:24, 23.04it/s, est. speed input: 23850.58 toks/s, output: 23.29 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [01:04<00:24, 22.18it/s, est. speed input: 23813.28 toks/s, output: 23.26 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [01:05<00:24, 21.59it/s, est. speed input: 23776.23 toks/s, output: 23.22 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [01:06<00:24, 21.20it/s, est. speed input: 23740.79 toks/s, output: 23.18 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [01:07<00:23, 20.92it/s, est. speed input: 23705.95 toks/s, output: 23.15 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [01:07<00:23, 20.72it/s, est. speed input: 23671.60 toks/s, output: 23.12 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [01:08<00:22, 20.59it/s, est. speed input: 23638.52 toks/s, output: 23.08 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [01:09<00:21, 20.48it/s, est. speed input: 23605.21 toks/s, output: 23.05 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [01:10<00:20, 20.70it/s, est. speed input: 23584.97 toks/s, output: 23.03 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [01:11<00:20, 20.57it/s, est. speed input: 23553.52 toks/s, output: 23.00 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [01:11<00:19, 20.47it/s, est. speed input: 23522.43 toks/s, output: 22.97 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [01:12<00:18, 20.40it/s, est. speed input: 23491.95 toks/s, output: 22.94 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [01:13<00:17, 20.35it/s, est. speed input: 23462.12 toks/s, output: 22.91 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [01:14<00:17, 20.32it/s, est. speed input: 23433.04 toks/s, output: 22.88 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [01:14<00:16, 20.30it/s, est. speed input: 23404.59 toks/s, output: 22.86 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [01:15<00:15, 20.28it/s, est. speed input: 23376.66 toks/s, output: 22.83 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [01:16<00:14, 20.27it/s, est. speed input: 23349.46 toks/s, output: 22.80 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [01:17<00:14, 20.27it/s, est. speed input: 23322.89 toks/s, output: 22.78 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [01:18<00:13, 20.25it/s, est. speed input: 23296.17 toks/s, output: 22.75 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [01:18<00:12, 20.25it/s, est. speed input: 23270.49 toks/s, output: 22.73 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [01:19<00:11, 20.24it/s, est. speed input: 23245.08 toks/s, output: 22.70 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [01:20<00:10, 20.24it/s, est. speed input: 23220.25 toks/s, output: 22.68 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [01:21<00:10, 20.24it/s, est. speed input: 23196.09 toks/s, output: 22.65 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [01:22<00:09, 20.23it/s, est. speed input: 23171.90 toks/s, output: 22.63 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [01:22<00:08, 20.24it/s, est. speed input: 23148.68 toks/s, output: 22.61 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [01:23<00:07, 20.24it/s, est. speed input: 23125.89 toks/s, output: 22.58 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [01:24<00:07, 20.24it/s, est. speed input: 23103.31 toks/s, output: 22.56 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [01:25<00:06, 20.24it/s, est. speed input: 23081.32 toks/s, output: 22.54 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [01:26<00:05, 20.24it/s, est. speed input: 23059.58 toks/s, output: 22.52 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [01:26<00:04, 20.25it/s, est. speed input: 23038.63 toks/s, output: 22.50 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [01:27<00:03, 20.26it/s, est. speed input: 23018.19 toks/s, output: 22.48 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [01:28<00:03, 20.25it/s, est. speed input: 22997.59 toks/s, output: 22.46 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [01:29<00:02, 20.25it/s, est. speed input: 22977.72 toks/s, output: 22.44 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [01:30<00:01, 20.26it/s, est. speed input: 22958.27 toks/s, output: 22.42 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [01:30<00:00, 20.59it/s, est. speed input: 22949.75 toks/s, output: 22.41 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [01:30<00:00, 20.59it/s, est. speed input: 23107.61 toks/s, output: 22.57 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [01:30<00:00, 22.57it/s, est. speed input: 23107.61 toks/s, output: 22.57 toks/s]
[rank0]:[W126 04:06:29.171597667 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 157.6s

测试结果:
  Requests/s:   20.25
  Tokens/s:     20759.31
  Total Reqs:   2048
  Elapsed:      101.12s

  [Prefill 分析]
  Total Prefill Tokens: 2097152
  Prefill Tokens/s:     20739.05

============================================================
[7/8] 测试 M=32768
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 32768
│   M_prefill     = 32768 (= 32 x 1024)
│   M_decode      = 32
│   batched_tokens = 32768 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 4096
│   --max-num-seqs           = 32
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 32768
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 04:07:07 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 04:07:07 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=155502) WARNING 01-26 04:07:15 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=155502) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=155502) WARNING 01-26 04:07:27 [backends.py:609] Failed to read file <frozen os>
Throughput: 6.05 requests/s, 6201.87 total tokens/s, 6.05 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096


─── STDERR ───
[2026-01-26 04:07:06] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 04:07:06] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:07:06] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 04:07:06] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:07:06] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:07:06] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:07:06] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:07:06] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:07:06] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:07:06] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 04:07:06] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 04:07:06] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 04:07:06] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 04:07:06] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 04:07:14] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 04:07:14] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:07:14] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 04:07:14] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:07:14] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:07:14] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:07:14] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:07:14] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:07:14] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:07:14] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 04:07:14] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 04:07:14] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 04:07:14] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 04:07:14] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=155502) [2026-01-26 04:07:15] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=155502) [2026-01-26 04:07:15] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=155502) [2026-01-26 04:07:15] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=155502) [2026-01-26 04:07:15] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=155502) [2026-01-26 04:07:15] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=155502) [2026-01-26 04:07:15] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=155502) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=155502) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.21it/s]
(EngineCore_DP0 pid=155502) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.04s/it]
(EngineCore_DP0 pid=155502) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.01s/it]
(EngineCore_DP0 pid=155502) 
(EngineCore_DP0 pid=155502) [2026-01-26 04:07:18] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 4800] -> 1D uint8
(EngineCore_DP0 pid=155502) [2026-01-26 04:07:18] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 16662528 bytes
(EngineCore_DP0 pid=155502) [2026-01-26 04:07:18] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 4800] -> 1D uint8
(EngineCore_DP0 pid=155502) [2026-01-26 04:07:18] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12959744 bytes
(EngineCore_DP0 pid=155502) [2026-01-26 04:07:18] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 4800] -> 1D uint8
(EngineCore_DP0 pid=155502) [2026-01-26 04:07:18] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 137003008 bytes
(EngineCore_DP0 pid=155502) [2026-01-26 04:07:18] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 25280] -> 1D uint8
(EngineCore_DP0 pid=155502) [2026-01-26 04:07:18] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 68009984 bytes
(EngineCore_DP0 pid=155502) [rank0]:W0126 04:07:34.465000 155502 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=155502) [rank0]:W0126 04:07:34.574000 155502 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=155502) [rank0]:W0126 04:07:36.070000 155502 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=155502) [rank0]:W0126 04:07:36.255000 155502 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=155502) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   9%|▉         | 1/11 [00:00<00:02,  3.99it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  18%|█▊        | 2/11 [00:00<00:01,  5.09it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  27%|██▋       | 3/11 [00:00<00:01,  5.50it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  36%|███▋      | 4/11 [00:00<00:01,  6.45it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  45%|████▌     | 5/11 [00:00<00:00,  7.09it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  55%|█████▍    | 6/11 [00:00<00:00,  7.66it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  64%|██████▎   | 7/11 [00:01<00:00,  7.99it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  73%|███████▎  | 8/11 [00:01<00:00,  8.27it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  82%|████████▏ | 9/11 [00:01<00:00,  8.41it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  91%|█████████ | 10/11 [00:01<00:00,  8.48it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00,  7.93it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00,  7.26it/s]
(EngineCore_DP0 pid=155502) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  14%|█▍        | 1/7 [00:00<00:00,  6.98it/s]
Capturing CUDA graphs (decode, FULL):  29%|██▊       | 2/7 [00:00<00:00,  7.98it/s]
Capturing CUDA graphs (decode, FULL):  43%|████▎     | 3/7 [00:00<00:00,  8.42it/s]
Capturing CUDA graphs (decode, FULL):  57%|█████▋    | 4/7 [00:00<00:00,  8.78it/s]
Capturing CUDA graphs (decode, FULL):  71%|███████▏  | 5/7 [00:00<00:00,  8.89it/s]
Capturing CUDA graphs (decode, FULL):  86%|████████▌ | 6/7 [00:00<00:00,  8.95it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00,  8.95it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00,  8.69it/s]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   1%|          | 24/4096 [00:00<00:17, 235.53it/s]
Adding requests:   1%|          | 50/4096 [00:00<00:16, 246.06it/s]
Adding requests:   2%|▏         | 78/4096 [00:00<00:15, 256.47it/s]
Adding requests:   3%|▎         | 104/4096 [00:00<00:15, 251.91it/s]
Adding requests:   3%|▎         | 130/4096 [00:00<00:15, 248.75it/s]
Adding requests:   4%|▍         | 156/4096 [00:00<00:15, 251.37it/s]
Adding requests:   4%|▍         | 182/4096 [00:00<00:15, 246.91it/s]
Adding requests:   5%|▌         | 207/4096 [00:00<00:15, 245.93it/s]
Adding requests:   6%|▌         | 234/4096 [00:00<00:15, 252.10it/s]
Adding requests:   6%|▋         | 261/4096 [00:01<00:14, 257.17it/s]
Adding requests:   7%|▋         | 287/4096 [00:01<00:15, 248.30it/s]
Adding requests:   8%|▊         | 315/4096 [00:01<00:14, 257.54it/s]
Adding requests:   8%|▊         | 342/4096 [00:01<00:14, 260.51it/s]
Adding requests:   9%|▉         | 369/4096 [00:01<00:14, 261.94it/s]
Adding requests:  10%|▉         | 396/4096 [00:01<00:14, 257.94it/s]
Adding requests:  10%|█         | 424/4096 [00:01<00:13, 264.14it/s]
Adding requests:  11%|█         | 451/4096 [00:01<00:13, 263.83it/s]
Adding requests:  12%|█▏        | 478/4096 [00:01<00:13, 259.25it/s]
Adding requests:  12%|█▏        | 504/4096 [00:01<00:13, 256.79it/s]
Adding requests:  13%|█▎        | 534/4096 [00:02<00:13, 267.91it/s]
Adding requests:  14%|█▎        | 562/4096 [00:02<00:13, 270.44it/s]
Adding requests:  14%|█▍        | 590/4096 [00:02<00:14, 248.41it/s]
Adding requests:  15%|█▌        | 616/4096 [00:02<00:14, 245.06it/s]
Adding requests:  16%|█▌        | 643/4096 [00:02<00:13, 250.03it/s]
Adding requests:  16%|█▋        | 669/4096 [00:02<00:14, 235.98it/s]
Adding requests:  17%|█▋        | 696/4096 [00:02<00:13, 244.08it/s]
Adding requests:  18%|█▊        | 721/4096 [00:02<00:13, 244.54it/s]
Adding requests:  18%|█▊        | 746/4096 [00:02<00:13, 243.00it/s]
Adding requests:  19%|█▉        | 771/4096 [00:03<00:14, 236.27it/s]
Adding requests:  19%|█▉        | 798/4096 [00:03<00:13, 245.53it/s]
Adding requests:  20%|██        | 826/4096 [00:03<00:12, 254.79it/s]
Adding requests:  21%|██        | 852/4096 [00:03<00:13, 249.51it/s]
Adding requests:  21%|██▏       | 878/4096 [00:03<00:12, 248.02it/s]
Adding requests:  22%|██▏       | 908/4096 [00:03<00:12, 260.83it/s]
Adding requests:  23%|██▎       | 935/4096 [00:03<00:12, 254.22it/s]
Adding requests:  23%|██▎       | 961/4096 [00:03<00:12, 248.84it/s]
Adding requests:  24%|██▍       | 988/4096 [00:03<00:12, 252.39it/s]
Adding requests:  25%|██▍       | 1014/4096 [00:04<00:12, 252.52it/s]
Adding requests:  25%|██▌       | 1040/4096 [00:04<00:12, 249.15it/s]
Adding requests:  26%|██▌       | 1065/4096 [00:04<00:12, 243.68it/s]
Adding requests:  27%|██▋       | 1092/4096 [00:04<00:12, 249.75it/s]
Adding requests:  27%|██▋       | 1119/4096 [00:04<00:11, 254.36it/s]
Adding requests:  28%|██▊       | 1145/4096 [00:04<00:11, 248.52it/s]
Adding requests:  29%|██▊       | 1171/4096 [00:04<00:11, 250.95it/s]
Adding requests:  29%|██▉       | 1199/4096 [00:04<00:11, 258.56it/s]
Adding requests:  30%|██▉       | 1225/4096 [00:04<00:11, 253.09it/s]
Adding requests:  31%|███       | 1251/4096 [00:04<00:11, 249.41it/s]
Adding requests:  31%|███       | 1276/4096 [00:05<00:11, 248.87it/s]
Adding requests:  32%|███▏      | 1303/4096 [00:05<00:11, 252.38it/s]
Adding requests:  32%|███▏      | 1329/4096 [00:05<00:11, 238.47it/s]
Adding requests:  33%|███▎      | 1356/4096 [00:05<00:11, 245.23it/s]
Adding requests:  34%|███▍      | 1383/4096 [00:05<00:10, 250.61it/s]
Adding requests:  34%|███▍      | 1409/4096 [00:05<00:10, 245.31it/s]
Adding requests:  35%|███▌      | 1434/4096 [00:05<00:11, 241.97it/s]
Adding requests:  36%|███▌      | 1461/4096 [00:05<00:10, 248.15it/s]
Adding requests:  36%|███▋      | 1488/4096 [00:05<00:10, 253.25it/s]
Adding requests:  37%|███▋      | 1514/4096 [00:06<00:10, 243.31it/s]
Adding requests:  38%|███▊      | 1539/4096 [00:06<00:10, 243.37it/s]
Adding requests:  38%|███▊      | 1566/4096 [00:06<00:10, 244.61it/s]
Adding requests:  39%|███▉      | 1592/4096 [00:06<00:10, 247.59it/s]
Adding requests:  39%|███▉      | 1617/4096 [00:06<00:10, 236.44it/s]
Adding requests:  40%|████      | 1642/4096 [00:06<00:10, 240.25it/s]
Adding requests:  41%|████      | 1668/4096 [00:06<00:09, 244.85it/s]
Adding requests:  41%|████▏     | 1693/4096 [00:06<00:09, 245.49it/s]
Adding requests:  42%|████▏     | 1719/4096 [00:06<00:09, 249.00it/s]
Adding requests:  43%|████▎     | 1747/4096 [00:06<00:09, 256.33it/s]
Adding requests:  43%|████▎     | 1777/4096 [00:07<00:08, 267.63it/s]
Adding requests:  44%|████▍     | 1804/4096 [00:07<00:09, 253.74it/s]
Adding requests:  45%|████▍     | 1831/4096 [00:07<00:08, 256.35it/s]
Adding requests:  45%|████▌     | 1859/4096 [00:07<00:08, 261.12it/s]
Adding requests:  46%|████▌     | 1886/4096 [00:07<00:08, 259.61it/s]
Adding requests:  47%|████▋     | 1913/4096 [00:07<00:08, 255.05it/s]
Adding requests:  47%|████▋     | 1942/4096 [00:07<00:08, 262.48it/s]
Adding requests:  48%|████▊     | 1970/4096 [00:07<00:08, 265.29it/s]
Adding requests:  49%|████▉     | 1997/4096 [00:07<00:08, 251.23it/s]
Adding requests:  49%|████▉     | 2023/4096 [00:08<00:08, 247.90it/s]
Adding requests:  50%|█████     | 2051/4096 [00:08<00:07, 255.81it/s]
Adding requests:  51%|█████     | 2077/4096 [00:08<00:08, 246.01it/s]
Adding requests:  51%|█████▏    | 2102/4096 [00:08<00:08, 243.18it/s]
Adding requests:  52%|█████▏    | 2129/4096 [00:08<00:07, 249.78it/s]
Adding requests:  53%|█████▎    | 2156/4096 [00:08<00:07, 252.98it/s]
Adding requests:  53%|█████▎    | 2182/4096 [00:08<00:08, 234.90it/s]
Adding requests:  54%|█████▍    | 2208/4096 [00:08<00:07, 239.96it/s]
Adding requests:  55%|█████▍    | 2235/4096 [00:08<00:07, 248.32it/s]
Adding requests:  55%|█████▌    | 2261/4096 [00:09<00:07, 246.51it/s]
Adding requests:  56%|█████▌    | 2286/4096 [00:09<00:07, 243.05it/s]
Adding requests:  56%|█████▋    | 2314/4096 [00:09<00:07, 251.67it/s]
Adding requests:  57%|█████▋    | 2343/4096 [00:09<00:06, 262.07it/s]
Adding requests:  58%|█████▊    | 2370/4096 [00:09<00:06, 251.50it/s]
Adding requests:  59%|█████▊    | 2399/4096 [00:09<00:06, 261.24it/s]
Adding requests:  59%|█████▉    | 2428/4096 [00:09<00:06, 268.41it/s]
Adding requests:  60%|█████▉    | 2455/4096 [00:09<00:06, 254.20it/s]
Adding requests:  61%|██████    | 2481/4096 [00:09<00:06, 249.80it/s]
Adding requests:  61%|██████▏   | 2509/4096 [00:09<00:06, 258.13it/s]
Adding requests:  62%|██████▏   | 2537/4096 [00:10<00:05, 263.38it/s]
Adding requests:  63%|██████▎   | 2564/4096 [00:10<00:05, 261.22it/s]
Adding requests:  63%|██████▎   | 2592/4096 [00:10<00:05, 264.20it/s]
Adding requests:  64%|██████▍   | 2620/4096 [00:10<00:05, 267.82it/s]
Adding requests:  65%|██████▍   | 2647/4096 [00:10<00:05, 263.92it/s]
Adding requests:  65%|██████▌   | 2674/4096 [00:10<00:05, 253.47it/s]
Adding requests:  66%|██████▌   | 2701/4096 [00:10<00:05, 257.27it/s]
Adding requests:  67%|██████▋   | 2729/4096 [00:10<00:05, 262.04it/s]
Adding requests:  67%|██████▋   | 2756/4096 [00:10<00:05, 262.48it/s]
Adding requests:  68%|██████▊   | 2783/4096 [00:11<00:05, 261.46it/s]
Adding requests:  69%|██████▊   | 2812/4096 [00:11<00:04, 265.96it/s]
Adding requests:  69%|██████▉   | 2841/4096 [00:11<00:04, 270.82it/s]
Adding requests:  70%|███████   | 2869/4096 [00:11<00:04, 258.38it/s]
Adding requests:  71%|███████   | 2896/4096 [00:11<00:04, 259.84it/s]
Adding requests:  71%|███████▏  | 2923/4096 [00:11<00:04, 262.01it/s]
Adding requests:  72%|███████▏  | 2952/4096 [00:11<00:04, 264.86it/s]
Adding requests:  73%|███████▎  | 2979/4096 [00:11<00:04, 253.44it/s]
Adding requests:  73%|███████▎  | 3008/4096 [00:11<00:04, 262.25it/s]
Adding requests:  74%|███████▍  | 3036/4096 [00:11<00:03, 266.74it/s]
Adding requests:  75%|███████▍  | 3063/4096 [00:12<00:04, 254.77it/s]
Adding requests:  75%|███████▌  | 3089/4096 [00:12<00:03, 253.94it/s]
Adding requests:  76%|███████▌  | 3118/4096 [00:12<00:03, 261.39it/s]
Adding requests:  77%|███████▋  | 3145/4096 [00:12<00:03, 263.52it/s]
Adding requests:  77%|███████▋  | 3172/4096 [00:12<00:03, 250.57it/s]
Adding requests:  78%|███████▊  | 3200/4096 [00:12<00:03, 257.08it/s]
Adding requests:  79%|███████▉  | 3230/4096 [00:12<00:03, 268.20it/s]
Adding requests:  80%|███████▉  | 3257/4096 [00:12<00:03, 258.40it/s]
Adding requests:  80%|████████  | 3283/4096 [00:12<00:03, 252.65it/s]
Adding requests:  81%|████████  | 3309/4096 [00:13<00:03, 252.83it/s]
Adding requests:  81%|████████▏ | 3336/4096 [00:13<00:02, 255.61it/s]
Adding requests:  82%|████████▏ | 3362/4096 [00:13<00:02, 249.96it/s]
Adding requests:  83%|████████▎ | 3390/4096 [00:13<00:02, 257.98it/s]
Adding requests:  83%|████████▎ | 3418/4096 [00:13<00:02, 263.05it/s]
Adding requests:  84%|████████▍ | 3445/4096 [00:13<00:02, 263.47it/s]
Adding requests:  85%|████████▍ | 3472/4096 [00:13<00:02, 260.08it/s]
Adding requests:  85%|████████▌ | 3499/4096 [00:13<00:02, 261.20it/s]
Adding requests:  86%|████████▌ | 3530/4096 [00:13<00:02, 272.83it/s]
Adding requests:  87%|████████▋ | 3558/4096 [00:14<00:02, 266.27it/s]
Adding requests:  88%|████████▊ | 3585/4096 [00:14<00:01, 263.97it/s]
Adding requests:  88%|████████▊ | 3614/4096 [00:14<00:01, 268.57it/s]
Adding requests:  89%|████████▉ | 3641/4096 [00:14<00:01, 265.47it/s]
Adding requests:  90%|████████▉ | 3668/4096 [00:14<00:01, 254.22it/s]
Adding requests:  90%|█████████ | 3694/4096 [00:14<00:01, 255.81it/s]
Adding requests:  91%|█████████ | 3722/4096 [00:14<00:01, 262.27it/s]
Adding requests:  92%|█████████▏| 3749/4096 [00:14<00:01, 242.88it/s]
Adding requests:  92%|█████████▏| 3774/4096 [00:14<00:01, 244.04it/s]
Adding requests:  93%|█████████▎| 3799/4096 [00:14<00:01, 243.12it/s]
Adding requests:  93%|█████████▎| 3824/4096 [00:15<00:01, 229.95it/s]
Adding requests:  94%|█████████▍| 3848/4096 [00:15<00:01, 230.29it/s]
Adding requests:  95%|█████████▍| 3876/4096 [00:15<00:00, 243.69it/s]
Adding requests:  95%|█████████▌| 3901/4096 [00:15<00:00, 243.57it/s]
Adding requests:  96%|█████████▌| 3926/4096 [00:15<00:00, 232.17it/s]
Adding requests:  96%|█████████▋| 3952/4096 [00:15<00:00, 239.33it/s]
Adding requests:  97%|█████████▋| 3978/4096 [00:15<00:00, 244.72it/s]
Adding requests:  98%|█████████▊| 4004/4096 [00:15<00:00, 247.29it/s]
Adding requests:  98%|█████████▊| 4029/4096 [00:15<00:00, 243.21it/s]
Adding requests:  99%|█████████▉| 4055/4096 [00:16<00:00, 246.59it/s]
Adding requests: 100%|█████████▉| 4083/4096 [00:16<00:00, 254.55it/s]
Adding requests: 100%|██████████| 4096/4096 [00:16<00:00, 252.99it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 66/4096 [00:00<00:15, 265.73it/s, est. speed input: 272136.09 toks/s, output: 265.74 toks/s]
Processed prompts:   2%|▏         | 98/4096 [00:04<03:27, 19.31it/s, est. speed input: 24334.12 toks/s, output: 23.76 toks/s]   
Processed prompts:   3%|▎         | 130/4096 [00:09<06:11, 10.68it/s, est. speed input: 14144.05 toks/s, output: 13.81 toks/s]
Processed prompts:   4%|▍         | 162/4096 [00:14<07:45,  8.45it/s, est. speed input: 11284.49 toks/s, output: 11.02 toks/s]
Processed prompts:   5%|▍         | 194/4096 [00:19<08:42,  7.47it/s, est. speed input: 9937.99 toks/s, output: 9.71 toks/s]  
Processed prompts:   6%|▌         | 226/4096 [00:25<09:17,  6.95it/s, est. speed input: 9154.88 toks/s, output: 8.94 toks/s]
Processed prompts:   6%|▋         | 258/4096 [00:30<09:38,  6.64it/s, est. speed input: 8642.61 toks/s, output: 8.44 toks/s]
Processed prompts:   7%|▋         | 290/4096 [00:34<08:58,  7.06it/s, est. speed input: 8619.45 toks/s, output: 8.42 toks/s]
Processed prompts:   8%|▊         | 322/4096 [00:39<09:21,  6.72it/s, est. speed input: 8295.94 toks/s, output: 8.10 toks/s]
Processed prompts:   9%|▊         | 354/4096 [00:45<09:35,  6.50it/s, est. speed input: 8048.84 toks/s, output: 7.86 toks/s]
Processed prompts:   9%|▉         | 386/4096 [00:50<09:43,  6.35it/s, est. speed input: 7853.72 toks/s, output: 7.67 toks/s]
Processed prompts:  10%|█         | 418/4096 [00:55<09:47,  6.26it/s, est. speed input: 7695.11 toks/s, output: 7.51 toks/s]
Processed prompts:  11%|█         | 450/4096 [01:00<09:48,  6.19it/s, est. speed input: 7564.14 toks/s, output: 7.39 toks/s]
Processed prompts:  12%|█▏        | 482/4096 [01:04<09:00,  6.69it/s, est. speed input: 7615.85 toks/s, output: 7.44 toks/s]
Processed prompts:  13%|█▎        | 514/4096 [01:10<09:12,  6.48it/s, est. speed input: 7508.20 toks/s, output: 7.33 toks/s]
Processed prompts:  13%|█▎        | 546/4096 [01:15<09:19,  6.34it/s, est. speed input: 7415.35 toks/s, output: 7.24 toks/s]
Processed prompts:  14%|█▍        | 578/4096 [01:20<09:22,  6.25it/s, est. speed input: 7334.77 toks/s, output: 7.16 toks/s]
Processed prompts:  15%|█▍        | 610/4096 [01:25<09:23,  6.19it/s, est. speed input: 7263.96 toks/s, output: 7.09 toks/s]
Processed prompts:  16%|█▌        | 642/4096 [01:31<09:22,  6.14it/s, est. speed input: 7201.65 toks/s, output: 7.03 toks/s]
Processed prompts:  16%|█▋        | 674/4096 [01:35<08:34,  6.65it/s, est. speed input: 7251.67 toks/s, output: 7.08 toks/s]
Processed prompts:  17%|█▋        | 706/4096 [01:40<08:45,  6.46it/s, est. speed input: 7195.94 toks/s, output: 7.03 toks/s]
Processed prompts:  18%|█▊        | 738/4096 [01:45<08:50,  6.33it/s, est. speed input: 7145.39 toks/s, output: 6.98 toks/s]
Processed prompts:  19%|█▉        | 770/4096 [01:50<08:46,  6.31it/s, est. speed input: 7112.64 toks/s, output: 6.95 toks/s]
Processed prompts:  20%|█▉        | 802/4096 [01:56<08:49,  6.23it/s, est. speed input: 7069.87 toks/s, output: 6.90 toks/s]
Processed prompts:  20%|██        | 834/4096 [02:01<08:48,  6.17it/s, est. speed input: 7031.07 toks/s, output: 6.87 toks/s]
Processed prompts:  21%|██        | 866/4096 [02:05<08:04,  6.67it/s, est. speed input: 7074.85 toks/s, output: 6.91 toks/s]
Processed prompts:  22%|██▏       | 898/4096 [02:10<08:13,  6.48it/s, est. speed input: 7039.79 toks/s, output: 6.87 toks/s]
Processed prompts:  23%|██▎       | 930/4096 [02:15<08:19,  6.34it/s, est. speed input: 7007.13 toks/s, output: 6.84 toks/s]
Processed prompts:  23%|██▎       | 962/4096 [02:21<08:22,  6.24it/s, est. speed input: 6974.73 toks/s, output: 6.81 toks/s]
Processed prompts:  24%|██▍       | 994/4096 [02:26<08:22,  6.17it/s, est. speed input: 6945.26 toks/s, output: 6.78 toks/s]
Processed prompts:  25%|██▌       | 1026/4096 [02:31<08:21,  6.13it/s, est. speed input: 6918.19 toks/s, output: 6.76 toks/s]
Processed prompts:  26%|██▌       | 1058/4096 [02:37<08:17,  6.10it/s, est. speed input: 6893.61 toks/s, output: 6.73 toks/s]
Processed prompts:  27%|██▋       | 1090/4096 [02:40<07:32,  6.65it/s, est. speed input: 6933.93 toks/s, output: 6.77 toks/s]
Processed prompts:  27%|██▋       | 1122/4096 [02:46<07:38,  6.49it/s, est. speed input: 6914.14 toks/s, output: 6.75 toks/s]
Processed prompts:  28%|██▊       | 1154/4096 [02:51<07:43,  6.35it/s, est. speed input: 6891.71 toks/s, output: 6.73 toks/s]
Processed prompts:  29%|██▉       | 1186/4096 [02:56<07:45,  6.25it/s, est. speed input: 6870.25 toks/s, output: 6.71 toks/s]
Processed prompts:  30%|██▉       | 1218/4096 [03:02<07:45,  6.18it/s, est. speed input: 6849.27 toks/s, output: 6.69 toks/s]
Processed prompts:  31%|███       | 1250/4096 [03:07<07:43,  6.13it/s, est. speed input: 6830.49 toks/s, output: 6.67 toks/s]
Processed prompts:  31%|███▏      | 1282/4096 [03:11<07:06,  6.60it/s, est. speed input: 6859.39 toks/s, output: 6.70 toks/s]
Processed prompts:  32%|███▏      | 1314/4096 [03:16<07:13,  6.42it/s, est. speed input: 6841.29 toks/s, output: 6.68 toks/s]
Processed prompts:  33%|███▎      | 1346/4096 [03:21<07:16,  6.30it/s, est. speed input: 6824.17 toks/s, output: 6.66 toks/s]
Processed prompts:  34%|███▎      | 1378/4096 [03:27<07:16,  6.22it/s, est. speed input: 6808.03 toks/s, output: 6.65 toks/s]
Processed prompts:  34%|███▍      | 1410/4096 [03:32<07:15,  6.17it/s, est. speed input: 6792.64 toks/s, output: 6.63 toks/s]
Processed prompts:  35%|███▌      | 1442/4096 [03:37<07:12,  6.13it/s, est. speed input: 6777.98 toks/s, output: 6.62 toks/s]
Processed prompts:  36%|███▌      | 1474/4096 [03:41<06:35,  6.63it/s, est. speed input: 6806.46 toks/s, output: 6.65 toks/s]
Processed prompts:  37%|███▋      | 1506/4096 [03:47<06:41,  6.44it/s, est. speed input: 6792.06 toks/s, output: 6.63 toks/s]
Processed prompts:  38%|███▊      | 1538/4096 [03:52<06:44,  6.32it/s, est. speed input: 6778.30 toks/s, output: 6.62 toks/s]
Processed prompts:  38%|███▊      | 1570/4096 [03:57<06:45,  6.23it/s, est. speed input: 6765.19 toks/s, output: 6.61 toks/s]
Processed prompts:  39%|███▉      | 1602/4096 [04:02<06:38,  6.25it/s, est. speed input: 6758.39 toks/s, output: 6.60 toks/s]
Processed prompts:  40%|███▉      | 1634/4096 [04:08<06:37,  6.19it/s, est. speed input: 6746.25 toks/s, output: 6.59 toks/s]
Processed prompts:  41%|████      | 1666/4096 [04:11<06:03,  6.68it/s, est. speed input: 6771.94 toks/s, output: 6.61 toks/s]
Processed prompts:  41%|████▏     | 1698/4096 [04:17<06:10,  6.48it/s, est. speed input: 6759.94 toks/s, output: 6.60 toks/s]
Processed prompts:  42%|████▏     | 1730/4096 [04:22<06:13,  6.34it/s, est. speed input: 6748.41 toks/s, output: 6.59 toks/s]
Processed prompts:  43%|████▎     | 1762/4096 [04:27<06:13,  6.25it/s, est. speed input: 6737.34 toks/s, output: 6.58 toks/s]
Processed prompts:  44%|████▍     | 1794/4096 [04:33<06:12,  6.19it/s, est. speed input: 6726.74 toks/s, output: 6.57 toks/s]
Processed prompts:  45%|████▍     | 1826/4096 [04:38<06:09,  6.14it/s, est. speed input: 6716.50 toks/s, output: 6.56 toks/s]
Processed prompts:  45%|████▌     | 1858/4096 [04:42<05:36,  6.64it/s, est. speed input: 6739.86 toks/s, output: 6.58 toks/s]
Processed prompts:  46%|████▌     | 1890/4096 [04:47<05:41,  6.45it/s, est. speed input: 6729.71 toks/s, output: 6.57 toks/s]
Processed prompts:  47%|████▋     | 1922/4096 [04:52<05:43,  6.32it/s, est. speed input: 6719.94 toks/s, output: 6.56 toks/s]
Processed prompts:  48%|████▊     | 1954/4096 [04:58<05:43,  6.24it/s, est. speed input: 6710.51 toks/s, output: 6.55 toks/s]
Processed prompts:  48%|████▊     | 1986/4096 [05:03<05:41,  6.18it/s, est. speed input: 6701.43 toks/s, output: 6.54 toks/s]
Processed prompts:  49%|████▉     | 2018/4096 [05:08<05:38,  6.14it/s, est. speed input: 6692.65 toks/s, output: 6.54 toks/s]
Processed prompts:  50%|█████     | 2050/4096 [05:12<05:08,  6.64it/s, est. speed input: 6713.99 toks/s, output: 6.56 toks/s]
Processed prompts:  51%|█████     | 2082/4096 [05:17<05:12,  6.45it/s, est. speed input: 6705.27 toks/s, output: 6.55 toks/s]
Processed prompts:  52%|█████▏    | 2114/4096 [05:23<05:13,  6.32it/s, est. speed input: 6696.80 toks/s, output: 6.54 toks/s]
Processed prompts:  52%|█████▏    | 2146/4096 [05:28<05:12,  6.24it/s, est. speed input: 6688.60 toks/s, output: 6.53 toks/s]
Processed prompts:  53%|█████▎    | 2178/4096 [05:33<05:06,  6.25it/s, est. speed input: 6684.82 toks/s, output: 6.53 toks/s]
Processed prompts:  54%|█████▍    | 2210/4096 [05:38<05:04,  6.19it/s, est. speed input: 6677.08 toks/s, output: 6.52 toks/s]
Processed prompts:  55%|█████▍    | 2242/4096 [05:42<04:37,  6.68it/s, est. speed input: 6696.80 toks/s, output: 6.54 toks/s]
Processed prompts:  56%|█████▌    | 2274/4096 [05:48<04:41,  6.48it/s, est. speed input: 6689.15 toks/s, output: 6.53 toks/s]
Processed prompts:  56%|█████▋    | 2306/4096 [05:53<04:42,  6.34it/s, est. speed input: 6681.71 toks/s, output: 6.53 toks/s]
Processed prompts:  57%|█████▋    | 2338/4096 [05:58<04:41,  6.25it/s, est. speed input: 6674.40 toks/s, output: 6.52 toks/s]
Processed prompts:  58%|█████▊    | 2370/4096 [06:03<04:39,  6.19it/s, est. speed input: 6667.29 toks/s, output: 6.51 toks/s]
Processed prompts:  59%|█████▊    | 2402/4096 [06:09<04:35,  6.14it/s, est. speed input: 6660.39 toks/s, output: 6.50 toks/s]
Processed prompts:  59%|█████▉    | 2434/4096 [06:14<04:31,  6.11it/s, est. speed input: 6653.69 toks/s, output: 6.50 toks/s]
Processed prompts:  60%|██████    | 2466/4096 [06:18<04:06,  6.62it/s, est. speed input: 6671.89 toks/s, output: 6.52 toks/s]
Processed prompts:  61%|██████    | 2498/4096 [06:23<04:08,  6.44it/s, est. speed input: 6665.40 toks/s, output: 6.51 toks/s]
Processed prompts:  62%|██████▏   | 2530/4096 [06:29<04:08,  6.31it/s, est. speed input: 6658.68 toks/s, output: 6.50 toks/s]
Processed prompts:  63%|██████▎   | 2562/4096 [06:34<04:06,  6.22it/s, est. speed input: 6652.12 toks/s, output: 6.50 toks/s]
Processed prompts:  63%|██████▎   | 2594/4096 [06:39<04:03,  6.16it/s, est. speed input: 6645.75 toks/s, output: 6.49 toks/s]
Processed prompts:  64%|██████▍   | 2626/4096 [06:44<03:59,  6.13it/s, est. speed input: 6639.78 toks/s, output: 6.48 toks/s]
Processed prompts:  65%|██████▍   | 2658/4096 [06:48<03:36,  6.65it/s, est. speed input: 6657.33 toks/s, output: 6.50 toks/s]
Processed prompts:  66%|██████▌   | 2690/4096 [06:54<03:36,  6.48it/s, est. speed input: 6652.52 toks/s, output: 6.50 toks/s]
Processed prompts:  66%|██████▋   | 2722/4096 [06:59<03:37,  6.32it/s, est. speed input: 6645.68 toks/s, output: 6.49 toks/s]
Processed prompts:  67%|██████▋   | 2754/4096 [07:04<03:35,  6.22it/s, est. speed input: 6639.14 toks/s, output: 6.48 toks/s]
Processed prompts:  68%|██████▊   | 2786/4096 [07:10<03:32,  6.16it/s, est. speed input: 6633.60 toks/s, output: 6.48 toks/s]
Processed prompts:  69%|██████▉   | 2818/4096 [07:15<03:28,  6.13it/s, est. speed input: 6628.50 toks/s, output: 6.47 toks/s]
Processed prompts:  70%|██████▉   | 2850/4096 [07:19<03:07,  6.65it/s, est. speed input: 6644.67 toks/s, output: 6.49 toks/s]
Processed prompts:  70%|███████   | 2882/4096 [07:24<03:08,  6.46it/s, est. speed input: 6639.29 toks/s, output: 6.48 toks/s]
Processed prompts:  71%|███████   | 2914/4096 [07:29<03:06,  6.33it/s, est. speed input: 6634.01 toks/s, output: 6.48 toks/s]
Processed prompts:  72%|███████▏  | 2946/4096 [07:35<03:04,  6.24it/s, est. speed input: 6628.89 toks/s, output: 6.47 toks/s]
Processed prompts:  73%|███████▎  | 2978/4096 [07:40<03:00,  6.18it/s, est. speed input: 6623.85 toks/s, output: 6.47 toks/s]
Processed prompts:  73%|███████▎  | 3010/4096 [07:45<02:56,  6.14it/s, est. speed input: 6618.93 toks/s, output: 6.46 toks/s]
Processed prompts:  74%|███████▍  | 3042/4096 [07:49<02:38,  6.63it/s, est. speed input: 6633.33 toks/s, output: 6.48 toks/s]
Processed prompts:  75%|███████▌  | 3074/4096 [07:54<02:38,  6.44it/s, est. speed input: 6628.39 toks/s, output: 6.47 toks/s]
Processed prompts:  76%|███████▌  | 3106/4096 [08:00<02:36,  6.32it/s, est. speed input: 6623.55 toks/s, output: 6.47 toks/s]
Processed prompts:  77%|███████▋  | 3138/4096 [08:05<02:33,  6.23it/s, est. speed input: 6618.81 toks/s, output: 6.46 toks/s]
Processed prompts:  77%|███████▋  | 3170/4096 [08:10<02:29,  6.17it/s, est. speed input: 6614.17 toks/s, output: 6.46 toks/s]
Processed prompts:  78%|███████▊  | 3202/4096 [08:16<02:25,  6.14it/s, est. speed input: 6609.65 toks/s, output: 6.45 toks/s]
Processed prompts:  79%|███████▉  | 3234/4096 [08:19<02:09,  6.64it/s, est. speed input: 6623.60 toks/s, output: 6.47 toks/s]
Processed prompts:  80%|███████▉  | 3266/4096 [08:25<02:08,  6.45it/s, est. speed input: 6619.05 toks/s, output: 6.46 toks/s]
Processed prompts:  81%|████████  | 3298/4096 [08:30<02:06,  6.32it/s, est. speed input: 6614.58 toks/s, output: 6.46 toks/s]
Processed prompts:  81%|████████▏ | 3330/4096 [08:35<02:02,  6.24it/s, est. speed input: 6610.22 toks/s, output: 6.46 toks/s]
Processed prompts:  82%|████████▏ | 3362/4096 [08:41<01:58,  6.18it/s, est. speed input: 6605.92 toks/s, output: 6.45 toks/s]
Processed prompts:  83%|████████▎ | 3394/4096 [08:46<01:54,  6.14it/s, est. speed input: 6601.73 toks/s, output: 6.45 toks/s]
Processed prompts:  84%|████████▎ | 3426/4096 [08:50<01:40,  6.64it/s, est. speed input: 6614.96 toks/s, output: 6.46 toks/s]
Processed prompts:  84%|████████▍ | 3458/4096 [08:55<01:38,  6.45it/s, est. speed input: 6610.74 toks/s, output: 6.46 toks/s]
Processed prompts:  85%|████████▌ | 3490/4096 [09:00<01:35,  6.32it/s, est. speed input: 6606.61 toks/s, output: 6.45 toks/s]
Processed prompts:  86%|████████▌ | 3522/4096 [09:06<01:32,  6.23it/s, est. speed input: 6602.56 toks/s, output: 6.45 toks/s]
Processed prompts:  87%|████████▋ | 3554/4096 [09:11<01:27,  6.18it/s, est. speed input: 6598.57 toks/s, output: 6.44 toks/s]
Processed prompts:  88%|████████▊ | 3586/4096 [09:16<01:23,  6.14it/s, est. speed input: 6594.67 toks/s, output: 6.44 toks/s]
Processed prompts:  88%|████████▊ | 3618/4096 [09:20<01:12,  6.64it/s, est. speed input: 6607.22 toks/s, output: 6.45 toks/s]
Processed prompts:  89%|████████▉ | 3650/4096 [09:26<01:09,  6.45it/s, est. speed input: 6603.31 toks/s, output: 6.45 toks/s]
Processed prompts:  90%|████████▉ | 3682/4096 [09:31<01:04,  6.40it/s, est. speed input: 6601.85 toks/s, output: 6.45 toks/s]
Processed prompts:  91%|█████████ | 3714/4096 [09:36<01:00,  6.29it/s, est. speed input: 6598.06 toks/s, output: 6.44 toks/s]
Processed prompts:  91%|█████████▏| 3746/4096 [09:41<00:56,  6.21it/s, est. speed input: 6594.32 toks/s, output: 6.44 toks/s]
Processed prompts:  92%|█████████▏| 3778/4096 [09:46<00:51,  6.16it/s, est. speed input: 6590.64 toks/s, output: 6.44 toks/s]
Processed prompts:  93%|█████████▎| 3810/4096 [09:52<00:46,  6.12it/s, est. speed input: 6587.04 toks/s, output: 6.43 toks/s]
Processed prompts:  94%|█████████▍| 3842/4096 [09:56<00:38,  6.63it/s, est. speed input: 6598.94 toks/s, output: 6.44 toks/s]
Processed prompts:  95%|█████████▍| 3874/4096 [10:01<00:34,  6.44it/s, est. speed input: 6595.34 toks/s, output: 6.44 toks/s]
Processed prompts:  95%|█████████▌| 3906/4096 [10:06<00:29,  6.40it/s, est. speed input: 6594.02 toks/s, output: 6.44 toks/s]
Processed prompts:  96%|█████████▌| 3938/4096 [10:11<00:25,  6.28it/s, est. speed input: 6590.49 toks/s, output: 6.44 toks/s]
Processed prompts:  97%|█████████▋| 3970/4096 [10:17<00:20,  6.21it/s, est. speed input: 6587.02 toks/s, output: 6.43 toks/s]
Processed prompts:  98%|█████████▊| 4002/4096 [10:22<00:15,  6.16it/s, est. speed input: 6583.63 toks/s, output: 6.43 toks/s]
Processed prompts:  98%|█████████▊| 4034/4096 [10:26<00:09,  6.66it/s, est. speed input: 6595.00 toks/s, output: 6.44 toks/s]
Processed prompts:  99%|█████████▉| 4066/4096 [10:31<00:04,  6.55it/s, est. speed input: 6593.92 toks/s, output: 6.44 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [10:31<00:00,  6.55it/s, est. speed input: 6642.56 toks/s, output: 6.49 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [10:31<00:00,  6.49it/s, est. speed input: 6642.56 toks/s, output: 6.49 toks/s]
[rank0]:[W126 04:18:33.772020070 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 725.7s

测试结果:
  Requests/s:   6.05
  Tokens/s:     6201.87
  Total Reqs:   4096
  Elapsed:      676.96s

  [Prefill 分析]
  Total Prefill Tokens: 4194304
  Prefill Tokens/s:     6195.82

============================================================
[8/8] 测试 M=65536
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 65536
│   M_prefill     = 65536 (= 64 x 1024)
│   M_decode      = 64
│   batched_tokens = 65536 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 8192
│   --max-num-seqs           = 64
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 65536
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 04:19:42 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 04:19:43 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=166712) WARNING 01-26 04:19:58 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=166712) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=166712) WARNING 01-26 04:20:12 [backends.py:609] Failed to read file <frozen os>
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 240, in _initialize_kv_caches
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     available_gpu_memory = self.model_executor.determine_available_memory()
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     return self.collective_rpc("determine_available_memory")
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     result = run_method(self.driver_worker, method, args, kwargs)
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/root/vllmbench/vllm/v1/serial_utils.py", line 461, in run_method
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 340, in determine_available_memory
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     self.model_runner.profile_run()
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4474, in profile_run
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     hidden_states, last_hidden_states = self._dummy_run(
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]                                         ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4198, in _dummy_run
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     outputs = self.model(
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]               ^^^^^^^^^^^
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 583, in forward
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     hidden_states = self.model(
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]                     ^^^^^^^^^^^
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/root/vllmbench/vllm/compilation/decorators.py", line 526, in __call__
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/root/vllmbench/vllm/compilation/wrapper.py", line 218, in __call__
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     return self._call_with_optional_nvtx_range(
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/root/vllmbench/vllm/compilation/wrapper.py", line 109, in _call_with_optional_nvtx_range
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     return callable_fn(*args, **kwargs)
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 832, in compile_wrapper
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     return fn(*args, **kwargs)
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 418, in forward
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     def forward(
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     return fn(*args, **kwargs)
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/root/vllmbench/vllm/compilation/caching.py", line 54, in __call__
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     return self.optimized_call(*args, **kwargs)
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 837, in call_wrapped
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     return self._wrapped_call(self, *args, **kwargs)
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 413, in __call__
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     raise e
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 400, in __call__
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     return super(self.cls, obj).__call__(*args, **kwargs)  # type: ignore[misc]
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "<eval_with_key>.58", line 325, in forward
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     submod_2 = self.submod_2(getitem_3, s72, l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_scale_, l_self_modules_layers_modules_0_modules_post_attention_layernorm_parameters_weight_, getitem_4, l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_scale_, l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_input_layernorm_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_bias_, l_positions_, l_self_modules_layers_modules_0_modules_self_attn_modules_rotary_emb_buffers_cos_sin_cache_);  getitem_3 = l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_scale_ = l_self_modules_layers_modules_0_modules_post_attention_layernorm_parameters_weight_ = getitem_4 = l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_scale_ = l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_input_layernorm_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_bias_ = None
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/root/vllmbench/vllm/compilation/piecewise_backend.py", line 178, in __call__
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     return range_entry.runnable(*args)
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/standalone_compile.py", line 63, in __call__
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     return self._compiled_fn(*args)
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     return fn(*args, **kwargs)
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/aot_autograd.py", line 1130, in forward
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     return compiled_fn(full_args)
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 353, in runtime_wrapper
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     all_outs = call_func_at_runtime_with_args(
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/utils.py", line 129, in call_func_at_runtime_with_args
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     out = normalize_as_list(f(args))
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]                             ^^^^^^^
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 724, in inner_fn
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     outs = compiled_fn(args)
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]            ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 526, in wrapper
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     return compiled_fn(runtime_args)
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/output_code.py", line 613, in __call__
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     return self.current_callable(inputs)
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/utils.py", line 2962, in run
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     out = model(new_inputs)
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]           ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/tmp/torchinductor_root/ss/csshv4l3lmhqprl2ob6nwekt2ruwfci2u7gsirottxbkuatuadsn.py", line 1093, in call
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     buf17 = torch.ops.slidesparse.quant_slide_fp8.default(buf16, 'Qwen2.5-7B-FP8', 6)
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_ops.py", line 841, in __call__
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     return self._op(*args, **kwargs)
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/root/vllmbench/slidesparse/core/kernels.py", line 521, in _quant_slide_fp8_impl
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     return fn(input, L)
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]            ^^^^^^^^^^^^
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/root/vllmbench/slidesparse/csrc/fused_quant_slide_triton/build/RTX4090_cc89_py312_cu129_x86_64/quant_slide_tuned_Qwen2.5-7B.py", line 263, in quant_slide_fp8_triton
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     _quant_slide_fp8_kernel[(M,)](
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/triton/runtime/jit.py", line 419, in <lambda>
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/triton/runtime/jit.py", line 756, in run
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     launch_metadata = kernel.launch_metadata(grid, stream, *bound_args.values())
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 490, in launch_metadata
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     self._init_handles()
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 473, in _init_handles
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]     self.module, self.function, self.n_regs, self.n_spills, self.n_max_threads = driver.active.utils.load_binary(
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866]                                                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712) ERROR 01-26 04:20:22 [core.py:866] RuntimeError: Triton Error [CUDA]: an illegal memory access was encountered


─── STDERR ───
[2026-01-26 04:19:42] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 04:19:42] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:19:42] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 04:19:42] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:19:42] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:19:42] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:19:42] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:19:42] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:19:42] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:19:42] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 04:19:42] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 04:19:42] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 04:19:42] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 04:19:42] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 04:19:50] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 04:19:50] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:19:50] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 04:19:50] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:19:50] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:19:50] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:19:50] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:19:50] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:19:50] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:19:50] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 04:19:50] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 04:19:50] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 04:19:50] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 04:19:50] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[W126 04:19:58.687727550 socket.cpp:209] [c10d] The hostname of the client socket cannot be retrieved. err=-3
(EngineCore_DP0 pid=166712) [2026-01-26 04:19:59] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=166712) [2026-01-26 04:19:59] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=166712) [2026-01-26 04:19:59] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=166712) [2026-01-26 04:19:59] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=166712) [2026-01-26 04:19:59] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=166712) [2026-01-26 04:19:59] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=166712) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=166712) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.21it/s]
(EngineCore_DP0 pid=166712) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.04s/it]
(EngineCore_DP0 pid=166712) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.01s/it]
(EngineCore_DP0 pid=166712) 
(EngineCore_DP0 pid=166712) [2026-01-26 04:20:02] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 4800] -> 1D uint8
(EngineCore_DP0 pid=166712) [2026-01-26 04:20:02] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 16662528 bytes
(EngineCore_DP0 pid=166712) [2026-01-26 04:20:02] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 4800] -> 1D uint8
(EngineCore_DP0 pid=166712) [2026-01-26 04:20:02] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12959744 bytes
(EngineCore_DP0 pid=166712) [2026-01-26 04:20:02] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 4800] -> 1D uint8
(EngineCore_DP0 pid=166712) [2026-01-26 04:20:02] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 137003008 bytes
(EngineCore_DP0 pid=166712) [2026-01-26 04:20:02] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 25280] -> 1D uint8
(EngineCore_DP0 pid=166712) [2026-01-26 04:20:02] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 68009984 bytes
(EngineCore_DP0 pid=166712) [rank0]:W0126 04:20:20.385000 166712 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=166712) [rank0]:W0126 04:20:20.496000 166712 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=166712) [rank0]:W0126 04:20:21.991000 166712 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=166712) [rank0]:W0126 04:20:22.165000 166712 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=166712) Process EngineCore_DP0:
(EngineCore_DP0 pid=166712) Traceback (most recent call last):
(EngineCore_DP0 pid=166712)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=166712)     self.run()
(EngineCore_DP0 pid=166712)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=166712)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=166712)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=166712)     raise e
(EngineCore_DP0 pid=166712)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=166712)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=166712)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=166712)     super().__init__(
(EngineCore_DP0 pid=166712)   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=166712)     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=166712)                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712)   File "/root/vllmbench/vllm/v1/engine/core.py", line 240, in _initialize_kv_caches
(EngineCore_DP0 pid=166712)     available_gpu_memory = self.model_executor.determine_available_memory()
(EngineCore_DP0 pid=166712)                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712)   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
(EngineCore_DP0 pid=166712)     return self.collective_rpc("determine_available_memory")
(EngineCore_DP0 pid=166712)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712)   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
(EngineCore_DP0 pid=166712)     result = run_method(self.driver_worker, method, args, kwargs)
(EngineCore_DP0 pid=166712)              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712)   File "/root/vllmbench/vllm/v1/serial_utils.py", line 461, in run_method
(EngineCore_DP0 pid=166712)     return func(*args, **kwargs)
(EngineCore_DP0 pid=166712)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712)   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=166712)     return func(*args, **kwargs)
(EngineCore_DP0 pid=166712)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712)   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 340, in determine_available_memory
(EngineCore_DP0 pid=166712)     self.model_runner.profile_run()
(EngineCore_DP0 pid=166712)   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4474, in profile_run
(EngineCore_DP0 pid=166712)     hidden_states, last_hidden_states = self._dummy_run(
(EngineCore_DP0 pid=166712)                                         ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712)   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=166712)     return func(*args, **kwargs)
(EngineCore_DP0 pid=166712)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712)   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4198, in _dummy_run
(EngineCore_DP0 pid=166712)     outputs = self.model(
(EngineCore_DP0 pid=166712)               ^^^^^^^^^^^
(EngineCore_DP0 pid=166712)   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=166712)     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=166712)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=166712)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=166712)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=166712)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=166712)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 583, in forward
(EngineCore_DP0 pid=166712)     hidden_states = self.model(
(EngineCore_DP0 pid=166712)                     ^^^^^^^^^^^
(EngineCore_DP0 pid=166712)   File "/root/vllmbench/vllm/compilation/decorators.py", line 526, in __call__
(EngineCore_DP0 pid=166712)     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
(EngineCore_DP0 pid=166712)              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712)   File "/root/vllmbench/vllm/compilation/wrapper.py", line 218, in __call__
(EngineCore_DP0 pid=166712)     return self._call_with_optional_nvtx_range(
(EngineCore_DP0 pid=166712)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712)   File "/root/vllmbench/vllm/compilation/wrapper.py", line 109, in _call_with_optional_nvtx_range
(EngineCore_DP0 pid=166712)     return callable_fn(*args, **kwargs)
(EngineCore_DP0 pid=166712)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712)   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 832, in compile_wrapper
(EngineCore_DP0 pid=166712)     return fn(*args, **kwargs)
(EngineCore_DP0 pid=166712)            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 418, in forward
(EngineCore_DP0 pid=166712)     def forward(
(EngineCore_DP0 pid=166712)   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=166712)     return fn(*args, **kwargs)
(EngineCore_DP0 pid=166712)            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712)   File "/root/vllmbench/vllm/compilation/caching.py", line 54, in __call__
(EngineCore_DP0 pid=166712)     return self.optimized_call(*args, **kwargs)
(EngineCore_DP0 pid=166712)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712)   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 837, in call_wrapped
(EngineCore_DP0 pid=166712)     return self._wrapped_call(self, *args, **kwargs)
(EngineCore_DP0 pid=166712)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712)   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 413, in __call__
(EngineCore_DP0 pid=166712)     raise e
(EngineCore_DP0 pid=166712)   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 400, in __call__
(EngineCore_DP0 pid=166712)     return super(self.cls, obj).__call__(*args, **kwargs)  # type: ignore[misc]
(EngineCore_DP0 pid=166712)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=166712)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=166712)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=166712)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=166712)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712)   File "<eval_with_key>.58", line 325, in forward
(EngineCore_DP0 pid=166712)     submod_2 = self.submod_2(getitem_3, s72, l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_scale_, l_self_modules_layers_modules_0_modules_post_attention_layernorm_parameters_weight_, getitem_4, l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_scale_, l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_input_layernorm_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_bias_, l_positions_, l_self_modules_layers_modules_0_modules_self_attn_modules_rotary_emb_buffers_cos_sin_cache_);  getitem_3 = l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_scale_ = l_self_modules_layers_modules_0_modules_post_attention_layernorm_parameters_weight_ = getitem_4 = l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_scale_ = l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_input_layernorm_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_bias_ = None
(EngineCore_DP0 pid=166712)                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712)   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=166712)     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=166712)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712)   File "/root/vllmbench/vllm/compilation/piecewise_backend.py", line 178, in __call__
(EngineCore_DP0 pid=166712)     return range_entry.runnable(*args)
(EngineCore_DP0 pid=166712)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/standalone_compile.py", line 63, in __call__
(EngineCore_DP0 pid=166712)     return self._compiled_fn(*args)
(EngineCore_DP0 pid=166712)            ^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712)   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=166712)     return fn(*args, **kwargs)
(EngineCore_DP0 pid=166712)            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/aot_autograd.py", line 1130, in forward
(EngineCore_DP0 pid=166712)     return compiled_fn(full_args)
(EngineCore_DP0 pid=166712)            ^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 353, in runtime_wrapper
(EngineCore_DP0 pid=166712)     all_outs = call_func_at_runtime_with_args(
(EngineCore_DP0 pid=166712)                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/utils.py", line 129, in call_func_at_runtime_with_args
(EngineCore_DP0 pid=166712)     out = normalize_as_list(f(args))
(EngineCore_DP0 pid=166712)                             ^^^^^^^
(EngineCore_DP0 pid=166712)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 724, in inner_fn
(EngineCore_DP0 pid=166712)     outs = compiled_fn(args)
(EngineCore_DP0 pid=166712)            ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 526, in wrapper
(EngineCore_DP0 pid=166712)     return compiled_fn(runtime_args)
(EngineCore_DP0 pid=166712)            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/output_code.py", line 613, in __call__
(EngineCore_DP0 pid=166712)     return self.current_callable(inputs)
(EngineCore_DP0 pid=166712)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/utils.py", line 2962, in run
(EngineCore_DP0 pid=166712)     out = model(new_inputs)
(EngineCore_DP0 pid=166712)           ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712)   File "/tmp/torchinductor_root/ss/csshv4l3lmhqprl2ob6nwekt2ruwfci2u7gsirottxbkuatuadsn.py", line 1093, in call
(EngineCore_DP0 pid=166712)     buf17 = torch.ops.slidesparse.quant_slide_fp8.default(buf16, 'Qwen2.5-7B-FP8', 6)
(EngineCore_DP0 pid=166712)             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712)   File "/usr/local/lib/python3.12/dist-packages/torch/_ops.py", line 841, in __call__
(EngineCore_DP0 pid=166712)     return self._op(*args, **kwargs)
(EngineCore_DP0 pid=166712)            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712)   File "/root/vllmbench/slidesparse/core/kernels.py", line 521, in _quant_slide_fp8_impl
(EngineCore_DP0 pid=166712)     return fn(input, L)
(EngineCore_DP0 pid=166712)            ^^^^^^^^^^^^
(EngineCore_DP0 pid=166712)   File "/root/vllmbench/slidesparse/csrc/fused_quant_slide_triton/build/RTX4090_cc89_py312_cu129_x86_64/quant_slide_tuned_Qwen2.5-7B.py", line 263, in quant_slide_fp8_triton
(EngineCore_DP0 pid=166712)     _quant_slide_fp8_kernel[(M,)](
(EngineCore_DP0 pid=166712)   File "/usr/local/lib/python3.12/dist-packages/triton/runtime/jit.py", line 419, in <lambda>
(EngineCore_DP0 pid=166712)     return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)
(EngineCore_DP0 pid=166712)                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712)   File "/usr/local/lib/python3.12/dist-packages/triton/runtime/jit.py", line 756, in run
(EngineCore_DP0 pid=166712)     launch_metadata = kernel.launch_metadata(grid, stream, *bound_args.values())
(EngineCore_DP0 pid=166712)                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712)   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 490, in launch_metadata
(EngineCore_DP0 pid=166712)     self._init_handles()
(EngineCore_DP0 pid=166712)   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 473, in _init_handles
(EngineCore_DP0 pid=166712)     self.module, self.function, self.n_regs, self.n_spills, self.n_max_threads = driver.active.utils.load_binary(
(EngineCore_DP0 pid=166712)                                                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=166712) RuntimeError: Triton Error [CUDA]: an illegal memory access was encountered
[rank0]:[W126 04:20:23.074343812 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

[ERROR] 测试失败: M=65536 (exit code: 1)


------------------------------------------------------------
  生成 CSV: Qwen2.5-7B-FP8
------------------------------------------------------------
[SUCCESS] CSV 保存到: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_6/Qwen2.5-7B-FP8_prefill.csv

预览:
------------------------------------------------------------
M_prefill,prompt_len,max_num_seqs,num_prompts,N_prefill,requests_per_s,tokens_per_s,elapsed_time_s
512,512,1,128,128,16.3734,8399.5292,7.8176
1024,1024,1,128,128,16.3372,16745.6137,7.8349
2048,1024,2,256,128,19.1417,19620.2817,13.3739
4096,1024,4,512,128,20.0495,20550.7755,25.5367
8192,1024,8,1024,128,20.2608,20767.3484,50.5409
16384,1024,16,2048,128,20.2530,20759.3069,101.1209
32768,1024,32,4096,128,6.0506,6201.8678,676.9573
65536,1024,64,8192,128,-1.0000,-1.0000,-1.0000

------------------------------------------------------------

[INFO] 完成: 7 成功, 1 失败

============================================================
  Qwen2.5-7B-FP8 | cuSPARSELt (2_8) | prefill
============================================================

[INFO] Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-FP8-SlideSparse-2_8
[INFO] Output: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_8

============================================================
[1/8] 测试 M=512
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 512
│   M_prefill     = 512 (= 1 x 512)
│   M_decode      = 1
│   batched_tokens = 513 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 512
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 513
│   --max-num-batched-tokens = 513
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 04:20:34 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 04:20:35 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=167672) WARNING 01-26 04:20:43 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=167672) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=167672) WARNING 01-26 04:21:02 [backends.py:609] Failed to read file <frozen os>
Throughput: 16.11 requests/s, 8263.47 total tokens/s, 16.11 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128


─── STDERR ───
[2026-01-26 04:20:34] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 04:20:34] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:20:34] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 04:20:34] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:20:34] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:20:34] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:20:34] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:20:34] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:20:34] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:20:34] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 04:20:34] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 04:20:34] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 04:20:34] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 04:20:34] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 04:20:42] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 04:20:42] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:20:42] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 04:20:42] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:20:42] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:20:42] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:20:42] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:20:42] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:20:42] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:20:42] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 04:20:42] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 04:20:42] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 04:20:42] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 04:20:42] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=167672) [2026-01-26 04:20:43] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=167672) [2026-01-26 04:20:43] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=167672) [2026-01-26 04:20:43] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=167672) [2026-01-26 04:20:43] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=167672) [2026-01-26 04:20:43] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=167672) [2026-01-26 04:20:43] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=167672) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=167672) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:03<00:03,  3.91s/it]
(EngineCore_DP0 pid=167672) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:09<00:00,  4.64s/it]
(EngineCore_DP0 pid=167672) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:09<00:00,  4.53s/it]
(EngineCore_DP0 pid=167672) 
(EngineCore_DP0 pid=167672) [2026-01-26 04:20:53] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=167672) [2026-01-26 04:20:53] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 18579456 bytes
(EngineCore_DP0 pid=167672) [2026-01-26 04:20:53] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=167672) [2026-01-26 04:20:53] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 14450688 bytes
(EngineCore_DP0 pid=167672) [2026-01-26 04:20:53] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=167672) [2026-01-26 04:20:53] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 152764416 bytes
(EngineCore_DP0 pid=167672) [2026-01-26 04:20:53] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=167672) [2026-01-26 04:20:53] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 76382208 bytes
(EngineCore_DP0 pid=167672) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  2.56it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  2.46it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  2.47it/s]
(EngineCore_DP0 pid=167672) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  3.65it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  3.65it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  35%|███▌      | 45/128 [00:00<00:00, 445.91it/s]
Adding requests:  72%|███████▏  | 92/128 [00:00<00:00, 455.61it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 460.67it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:17,  7.46it/s, est. speed input: 3821.85 toks/s, output: 7.46 toks/s]
Processed prompts:   2%|▏         | 2/128 [00:00<00:15,  8.29it/s, est. speed input: 4174.20 toks/s, output: 8.15 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:11, 10.83it/s, est. speed input: 5168.50 toks/s, output: 10.09 toks/s]
Processed prompts:   5%|▍         | 6/128 [00:00<00:09, 13.03it/s, est. speed input: 5965.85 toks/s, output: 11.65 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:00<00:08, 14.27it/s, est. speed input: 6448.07 toks/s, output: 12.59 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:00<00:07, 15.10it/s, est. speed input: 6786.31 toks/s, output: 13.25 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:00<00:07, 15.63it/s, est. speed input: 7031.50 toks/s, output: 13.73 toks/s]
Processed prompts:  11%|█         | 14/128 [00:00<00:07, 15.99it/s, est. speed input: 7219.55 toks/s, output: 14.10 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:01<00:06, 16.29it/s, est. speed input: 7375.08 toks/s, output: 14.40 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:01<00:06, 16.47it/s, est. speed input: 7497.24 toks/s, output: 14.64 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:01<00:06, 16.54it/s, est. speed input: 7590.79 toks/s, output: 14.83 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:01<00:06, 16.59it/s, est. speed input: 7669.32 toks/s, output: 14.98 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:01<00:06, 16.72it/s, est. speed input: 7746.32 toks/s, output: 15.13 toks/s]
Processed prompts:  20%|██        | 26/128 [00:01<00:06, 16.50it/s, est. speed input: 7779.30 toks/s, output: 15.19 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:01<00:06, 16.66it/s, est. speed input: 7840.48 toks/s, output: 15.31 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:01<00:05, 16.71it/s, est. speed input: 7887.31 toks/s, output: 15.40 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:02<00:05, 16.80it/s, est. speed input: 7934.55 toks/s, output: 15.50 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:02<00:05, 16.93it/s, est. speed input: 7981.64 toks/s, output: 15.59 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:02<00:05, 17.04it/s, est. speed input: 8026.17 toks/s, output: 15.68 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:02<00:05, 17.00it/s, est. speed input: 8057.18 toks/s, output: 15.74 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:02<00:05, 17.02it/s, est. speed input: 8088.83 toks/s, output: 15.80 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:02<00:05, 17.02it/s, est. speed input: 8116.16 toks/s, output: 15.85 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:02<00:04, 16.91it/s, est. speed input: 8134.44 toks/s, output: 15.89 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:02<00:04, 16.95it/s, est. speed input: 8158.18 toks/s, output: 15.93 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:03<00:04, 17.02it/s, est. speed input: 8183.26 toks/s, output: 15.98 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:03<00:04, 17.05it/s, est. speed input: 8204.83 toks/s, output: 16.02 toks/s]
Processed prompts:  41%|████      | 52/128 [00:03<00:04, 17.13it/s, est. speed input: 8228.78 toks/s, output: 16.07 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:03<00:04, 17.18it/s, est. speed input: 8250.19 toks/s, output: 16.11 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:03<00:04, 17.22it/s, est. speed input: 8271.00 toks/s, output: 16.15 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:03<00:04, 17.23it/s, est. speed input: 8289.14 toks/s, output: 16.19 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:03<00:03, 17.09it/s, est. speed input: 8298.64 toks/s, output: 16.21 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:03<00:03, 16.92it/s, est. speed input: 8304.15 toks/s, output: 16.22 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:03<00:03, 16.88it/s, est. speed input: 8312.98 toks/s, output: 16.24 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:04<00:03, 16.82it/s, est. speed input: 8319.75 toks/s, output: 16.25 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:04<00:03, 16.85it/s, est. speed input: 8329.31 toks/s, output: 16.27 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:04<00:03, 16.89it/s, est. speed input: 8339.37 toks/s, output: 16.29 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:04<00:03, 16.88it/s, est. speed input: 8347.06 toks/s, output: 16.30 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:04<00:03, 16.80it/s, est. speed input: 8351.34 toks/s, output: 16.31 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:04<00:03, 16.83it/s, est. speed input: 8358.88 toks/s, output: 16.33 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:04<00:02, 16.91it/s, est. speed input: 8368.73 toks/s, output: 16.35 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:04<00:02, 16.87it/s, est. speed input: 8374.22 toks/s, output: 16.36 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:05<00:02, 16.92it/s, est. speed input: 8382.26 toks/s, output: 16.37 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:05<00:02, 17.01it/s, est. speed input: 8392.14 toks/s, output: 16.39 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:05<00:02, 17.09it/s, est. speed input: 8402.29 toks/s, output: 16.41 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:05<00:02, 17.13it/s, est. speed input: 8411.29 toks/s, output: 16.43 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:05<00:02, 17.15it/s, est. speed input: 8419.80 toks/s, output: 16.44 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:05<00:02, 17.16it/s, est. speed input: 8427.59 toks/s, output: 16.46 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:05<00:01, 17.15it/s, est. speed input: 8434.50 toks/s, output: 16.47 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:05<00:01, 17.22it/s, est. speed input: 8443.88 toks/s, output: 16.49 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:05<00:01, 17.19it/s, est. speed input: 8450.08 toks/s, output: 16.50 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:06<00:01, 17.23it/s, est. speed input: 8458.06 toks/s, output: 16.52 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:06<00:01, 17.27it/s, est. speed input: 8466.13 toks/s, output: 16.54 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:06<00:01, 17.39it/s, est. speed input: 8476.70 toks/s, output: 16.56 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:06<00:01, 17.48it/s, est. speed input: 8487.02 toks/s, output: 16.58 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:06<00:01, 17.48it/s, est. speed input: 8495.22 toks/s, output: 16.59 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:06<00:01, 17.38it/s, est. speed input: 8500.27 toks/s, output: 16.60 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:06<00:00, 17.40it/s, est. speed input: 8507.57 toks/s, output: 16.62 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:06<00:00, 17.45it/s, est. speed input: 8515.62 toks/s, output: 16.63 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:06<00:00, 17.36it/s, est. speed input: 8519.99 toks/s, output: 16.64 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:07<00:00, 17.32it/s, est. speed input: 8524.93 toks/s, output: 16.65 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:07<00:00, 17.31it/s, est. speed input: 8530.26 toks/s, output: 16.66 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:07<00:00, 17.30it/s, est. speed input: 8535.20 toks/s, output: 16.67 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:07<00:00, 17.32it/s, est. speed input: 8540.82 toks/s, output: 16.68 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:07<00:00, 17.31it/s, est. speed input: 8545.56 toks/s, output: 16.69 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 17.22it/s, est. speed input: 8548.10 toks/s, output: 16.70 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 17.22it/s, est. speed input: 8548.10 toks/s, output: 16.70 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 16.69it/s, est. speed input: 8548.10 toks/s, output: 16.70 toks/s]
[rank0]:[W126 04:21:28.222630852 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 63.3s

测试结果:
  Requests/s:   16.11
  Tokens/s:     8263.47
  Total Reqs:   128
  Elapsed:      7.95s

  [Prefill 分析]
  Total Prefill Tokens: 65536
  Prefill Tokens/s:     8247.36

============================================================
[2/8] 测试 M=1024
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 1024
│   M_prefill     = 1024 (= 1 x 1024)
│   M_decode      = 1
│   batched_tokens = 1025 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 1025
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 04:21:38 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 04:21:39 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=168856) WARNING 01-26 04:21:46 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=168856) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=168856) WARNING 01-26 04:22:04 [backends.py:609] Failed to read file <frozen os>
Throughput: 16.15 requests/s, 16556.07 total tokens/s, 16.15 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128


─── STDERR ───
[2026-01-26 04:21:38] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 04:21:38] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:21:38] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 04:21:38] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:21:38] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:21:38] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:21:38] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:21:38] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:21:38] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:21:38] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 04:21:38] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 04:21:38] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 04:21:38] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 04:21:38] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 04:21:46] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 04:21:46] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:21:46] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 04:21:46] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:21:46] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:21:46] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:21:46] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:21:46] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:21:46] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:21:46] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 04:21:46] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 04:21:46] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 04:21:46] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 04:21:46] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=168856) [2026-01-26 04:21:47] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=168856) [2026-01-26 04:21:47] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=168856) [2026-01-26 04:21:47] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=168856) [2026-01-26 04:21:47] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=168856) [2026-01-26 04:21:47] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=168856) [2026-01-26 04:21:47] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=168856) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=168856) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:03<00:03,  3.85s/it]
(EngineCore_DP0 pid=168856) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:08<00:00,  4.44s/it]
(EngineCore_DP0 pid=168856) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:08<00:00,  4.35s/it]
(EngineCore_DP0 pid=168856) 
(EngineCore_DP0 pid=168856) [2026-01-26 04:21:56] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=168856) [2026-01-26 04:21:56] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 18579456 bytes
(EngineCore_DP0 pid=168856) [2026-01-26 04:21:56] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=168856) [2026-01-26 04:21:56] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 14450688 bytes
(EngineCore_DP0 pid=168856) [2026-01-26 04:21:56] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=168856) [2026-01-26 04:21:56] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 152764416 bytes
(EngineCore_DP0 pid=168856) [2026-01-26 04:21:56] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=168856) [2026-01-26 04:21:56] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 76382208 bytes
(EngineCore_DP0 pid=168856) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  8.17it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  8.39it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  8.35it/s]
(EngineCore_DP0 pid=168856) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.10it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.08it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  20%|█▉        | 25/128 [00:00<00:00, 238.61it/s]
Adding requests:  39%|███▉      | 50/128 [00:00<00:00, 240.35it/s]
Adding requests:  61%|██████    | 78/128 [00:00<00:00, 255.51it/s]
Adding requests:  82%|████████▏ | 105/128 [00:00<00:00, 259.78it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 254.54it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:03, 38.05it/s, est. speed input: 38976.51 toks/s, output: 38.06 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:00<00:05, 21.99it/s, est. speed input: 24037.77 toks/s, output: 23.47 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:00<00:05, 19.74it/s, est. speed input: 21767.40 toks/s, output: 21.26 toks/s]
Processed prompts:  11%|█         | 14/128 [00:00<00:06, 18.84it/s, est. speed input: 20782.09 toks/s, output: 20.29 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:00<00:06, 18.44it/s, est. speed input: 20349.31 toks/s, output: 19.87 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:00<00:06, 18.12it/s, est. speed input: 20021.26 toks/s, output: 19.55 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:01<00:06, 17.90it/s, est. speed input: 19767.54 toks/s, output: 19.30 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:01<00:06, 17.63it/s, est. speed input: 19523.59 toks/s, output: 19.06 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:01<00:05, 17.50it/s, est. speed input: 19348.13 toks/s, output: 18.89 toks/s]
Processed prompts:  20%|██        | 26/128 [00:01<00:05, 17.39it/s, est. speed input: 19194.48 toks/s, output: 18.74 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:01<00:05, 17.21it/s, est. speed input: 19037.32 toks/s, output: 18.59 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:01<00:05, 17.11it/s, est. speed input: 18909.42 toks/s, output: 18.47 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:01<00:05, 17.04it/s, est. speed input: 18800.01 toks/s, output: 18.36 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:01<00:05, 17.03it/s, est. speed input: 18712.10 toks/s, output: 18.27 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:01<00:05, 17.02it/s, est. speed input: 18635.67 toks/s, output: 18.20 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:02<00:05, 17.00it/s, est. speed input: 18562.79 toks/s, output: 18.13 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:02<00:05, 17.02it/s, est. speed input: 18505.85 toks/s, output: 18.07 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:02<00:05, 17.12it/s, est. speed input: 18469.07 toks/s, output: 18.04 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:02<00:04, 17.15it/s, est. speed input: 18428.51 toks/s, output: 18.00 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:02<00:04, 17.05it/s, est. speed input: 18372.72 toks/s, output: 17.94 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:02<00:04, 17.08it/s, est. speed input: 18338.45 toks/s, output: 17.91 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:02<00:04, 17.11it/s, est. speed input: 18308.09 toks/s, output: 17.88 toks/s]
Processed prompts:  41%|████      | 52/128 [00:02<00:04, 17.16it/s, est. speed input: 18281.78 toks/s, output: 17.85 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:03<00:04, 17.23it/s, est. speed input: 18265.13 toks/s, output: 17.84 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:03<00:04, 17.18it/s, est. speed input: 18236.39 toks/s, output: 17.81 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:03<00:04, 17.12it/s, est. speed input: 18204.42 toks/s, output: 17.78 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:03<00:03, 17.15it/s, est. speed input: 18184.23 toks/s, output: 17.76 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:03<00:03, 17.15it/s, est. speed input: 18163.74 toks/s, output: 17.74 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:03<00:03, 17.09it/s, est. speed input: 18137.18 toks/s, output: 17.71 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:03<00:03, 17.05it/s, est. speed input: 18113.54 toks/s, output: 17.69 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:03<00:03, 16.98it/s, est. speed input: 18085.79 toks/s, output: 17.66 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:03<00:03, 17.04it/s, est. speed input: 18071.62 toks/s, output: 17.65 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:04<00:03, 17.10it/s, est. speed input: 18058.97 toks/s, output: 17.64 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:04<00:03, 17.14it/s, est. speed input: 18047.81 toks/s, output: 17.62 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:04<00:03, 17.08it/s, est. speed input: 18028.29 toks/s, output: 17.61 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:04<00:02, 16.98it/s, est. speed input: 18004.97 toks/s, output: 17.58 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:04<00:02, 16.84it/s, est. speed input: 17976.37 toks/s, output: 17.55 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:04<00:02, 16.78it/s, est. speed input: 17952.22 toks/s, output: 17.53 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:04<00:02, 16.78it/s, est. speed input: 17933.25 toks/s, output: 17.51 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:04<00:02, 16.79it/s, est. speed input: 17915.45 toks/s, output: 17.50 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:05<00:02, 16.77it/s, est. speed input: 17896.98 toks/s, output: 17.48 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:05<00:02, 16.79it/s, est. speed input: 17881.94 toks/s, output: 17.46 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:05<00:02, 16.76it/s, est. speed input: 17863.89 toks/s, output: 17.45 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:05<00:02, 16.86it/s, est. speed input: 17855.70 toks/s, output: 17.44 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:05<00:01, 16.90it/s, est. speed input: 17845.99 toks/s, output: 17.43 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:05<00:01, 17.01it/s, est. speed input: 17842.62 toks/s, output: 17.42 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:05<00:01, 17.11it/s, est. speed input: 17841.79 toks/s, output: 17.42 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:05<00:01, 17.07it/s, est. speed input: 17832.16 toks/s, output: 17.41 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:05<00:01, 16.98it/s, est. speed input: 17818.74 toks/s, output: 17.40 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:06<00:01, 16.89it/s, est. speed input: 17804.73 toks/s, output: 17.39 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:06<00:01, 16.76it/s, est. speed input: 17786.53 toks/s, output: 17.37 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:06<00:01, 16.70it/s, est. speed input: 17770.36 toks/s, output: 17.35 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:06<00:00, 16.59it/s, est. speed input: 17750.82 toks/s, output: 17.33 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:06<00:00, 16.46it/s, est. speed input: 17728.19 toks/s, output: 17.31 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:06<00:00, 16.42it/s, est. speed input: 17709.67 toks/s, output: 17.29 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:06<00:00, 16.54it/s, est. speed input: 17701.26 toks/s, output: 17.29 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:06<00:00, 16.60it/s, est. speed input: 17691.91 toks/s, output: 17.28 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:07<00:00, 16.69it/s, est. speed input: 17685.35 toks/s, output: 17.27 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:07<00:00, 16.77it/s, est. speed input: 17680.11 toks/s, output: 17.27 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:07<00:00, 16.83it/s, est. speed input: 17675.22 toks/s, output: 17.26 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 16.77it/s, est. speed input: 17664.84 toks/s, output: 17.25 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 16.77it/s, est. speed input: 17664.84 toks/s, output: 17.25 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 17.25it/s, est. speed input: 17664.84 toks/s, output: 17.25 toks/s]
[rank0]:[W126 04:22:30.137095441 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 62.4s

测试结果:
  Requests/s:   16.15
  Tokens/s:     16556.07
  Total Reqs:   128
  Elapsed:      7.92s

  [Prefill 分析]
  Total Prefill Tokens: 131072
  Prefill Tokens/s:     16539.92

============================================================
[3/8] 测试 M=2048
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 2048
│   M_prefill     = 2048 (= 2 x 1024)
│   M_decode      = 2
│   batched_tokens = 2048 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 256
│   --max-num-seqs           = 2
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 2048
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 04:22:41 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 04:22:42 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=170008) WARNING 01-26 04:22:50 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=170008) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=170008) WARNING 01-26 04:23:04 [backends.py:609] Failed to read file <frozen os>
Throughput: 17.87 requests/s, 18320.29 total tokens/s, 17.87 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256


─── STDERR ───
[2026-01-26 04:22:41] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 04:22:41] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:22:41] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 04:22:41] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:22:41] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:22:41] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:22:41] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:22:41] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:22:41] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:22:41] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 04:22:41] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 04:22:41] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 04:22:41] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 04:22:41] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 04:22:49] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 04:22:49] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:22:49] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 04:22:49] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:22:49] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:22:49] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:22:49] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:22:49] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:22:49] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:22:49] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 04:22:49] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 04:22:49] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 04:22:49] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 04:22:49] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=170008) [2026-01-26 04:22:51] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=170008) [2026-01-26 04:22:51] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=170008) [2026-01-26 04:22:51] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=170008) [2026-01-26 04:22:51] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=170008) [2026-01-26 04:22:51] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=170008) [2026-01-26 04:22:51] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=170008) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=170008) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.06it/s]
(EngineCore_DP0 pid=170008) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.22s/it]
(EngineCore_DP0 pid=170008) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.18s/it]
(EngineCore_DP0 pid=170008) 
(EngineCore_DP0 pid=170008) [2026-01-26 04:22:54] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=170008) [2026-01-26 04:22:54] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 18579456 bytes
(EngineCore_DP0 pid=170008) [2026-01-26 04:22:54] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=170008) [2026-01-26 04:22:54] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 14450688 bytes
(EngineCore_DP0 pid=170008) [2026-01-26 04:22:54] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=170008) [2026-01-26 04:22:54] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 152764416 bytes
(EngineCore_DP0 pid=170008) [2026-01-26 04:22:54] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=170008) [2026-01-26 04:22:54] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 76382208 bytes
(EngineCore_DP0 pid=170008) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  33%|███▎      | 1/3 [00:00<00:00,  8.29it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  67%|██████▋   | 2/3 [00:00<00:00,  8.83it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00,  8.05it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00,  8.20it/s]
(EngineCore_DP0 pid=170008) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 1/2 [00:00<00:00,  7.20it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  8.39it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  8.18it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:   9%|▉         | 23/256 [00:00<00:01, 228.27it/s]
Adding requests:  19%|█▉        | 48/256 [00:00<00:00, 234.07it/s]
Adding requests:  29%|██▉       | 74/256 [00:00<00:00, 245.29it/s]
Adding requests:  39%|███▊      | 99/256 [00:00<00:00, 242.02it/s]
Adding requests:  48%|████▊     | 124/256 [00:00<00:00, 238.51it/s]
Adding requests:  58%|█████▊    | 149/256 [00:00<00:00, 239.26it/s]
Adding requests:  69%|██████▉   | 176/256 [00:00<00:00, 246.57it/s]
Adding requests:  79%|███████▊  | 201/256 [00:00<00:00, 247.30it/s]
Adding requests:  89%|████████▉ | 228/256 [00:00<00:00, 252.20it/s]
Adding requests:  99%|█████████▉| 254/256 [00:01<00:00, 249.24it/s]
Adding requests: 100%|██████████| 256/256 [00:01<00:00, 244.89it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▋         | 16/256 [00:00<00:03, 76.90it/s, est. speed input: 78759.32 toks/s, output: 76.91 toks/s]
Processed prompts:   9%|▉         | 24/256 [00:00<00:07, 32.92it/s, est. speed input: 38068.29 toks/s, output: 37.17 toks/s]
Processed prompts:  11%|█▏        | 29/256 [00:00<00:07, 29.43it/s, est. speed input: 34368.95 toks/s, output: 33.56 toks/s]
Processed prompts:  13%|█▎        | 33/256 [00:01<00:08, 25.71it/s, est. speed input: 31199.20 toks/s, output: 30.47 toks/s]
Processed prompts:  14%|█▍        | 36/256 [00:01<00:10, 21.84it/s, est. speed input: 28312.50 toks/s, output: 27.65 toks/s]
Processed prompts:  15%|█▌        | 39/256 [00:01<00:09, 22.89it/s, est. speed input: 28298.30 toks/s, output: 27.63 toks/s]
Processed prompts:  16%|█▋        | 42/256 [00:01<00:10, 19.68it/s, est. speed input: 26379.42 toks/s, output: 25.76 toks/s]
Processed prompts:  18%|█▊        | 45/256 [00:01<00:09, 21.22it/s, est. speed input: 26485.63 toks/s, output: 25.86 toks/s]
Processed prompts:  19%|█▉        | 48/256 [00:01<00:11, 18.49it/s, est. speed input: 25093.29 toks/s, output: 24.50 toks/s]
Processed prompts:  20%|█▉        | 51/256 [00:02<00:10, 20.32it/s, est. speed input: 25248.42 toks/s, output: 24.66 toks/s]
Processed prompts:  21%|██        | 54/256 [00:02<00:11, 17.87it/s, est. speed input: 24174.84 toks/s, output: 23.61 toks/s]
Processed prompts:  22%|██▏       | 56/256 [00:02<00:11, 17.96it/s, est. speed input: 23925.51 toks/s, output: 23.36 toks/s]
Processed prompts:  23%|██▎       | 58/256 [00:02<00:10, 18.04it/s, est. speed input: 23700.93 toks/s, output: 23.14 toks/s]
Processed prompts:  23%|██▎       | 60/256 [00:02<00:10, 18.11it/s, est. speed input: 23493.67 toks/s, output: 22.94 toks/s]
Processed prompts:  24%|██▍       | 62/256 [00:02<00:10, 18.15it/s, est. speed input: 23301.94 toks/s, output: 22.76 toks/s]
Processed prompts:  25%|██▌       | 64/256 [00:02<00:10, 18.20it/s, est. speed input: 23126.54 toks/s, output: 22.58 toks/s]
Processed prompts:  26%|██▌       | 66/256 [00:02<00:10, 18.23it/s, est. speed input: 22964.00 toks/s, output: 22.43 toks/s]
Processed prompts:  27%|██▋       | 68/256 [00:03<00:10, 18.24it/s, est. speed input: 22812.11 toks/s, output: 22.28 toks/s]
Processed prompts:  27%|██▋       | 70/256 [00:03<00:10, 18.25it/s, est. speed input: 22669.47 toks/s, output: 22.14 toks/s]
Processed prompts:  28%|██▊       | 72/256 [00:03<00:10, 18.27it/s, est. speed input: 22538.46 toks/s, output: 22.01 toks/s]
Processed prompts:  29%|██▉       | 74/256 [00:03<00:09, 18.29it/s, est. speed input: 22417.35 toks/s, output: 21.89 toks/s]
Processed prompts:  30%|██▉       | 76/256 [00:03<00:09, 18.30it/s, est. speed input: 22303.30 toks/s, output: 21.78 toks/s]
Processed prompts:  30%|███       | 78/256 [00:03<00:09, 18.30it/s, est. speed input: 22195.11 toks/s, output: 21.67 toks/s]
Processed prompts:  31%|███▏      | 80/256 [00:03<00:09, 18.28it/s, est. speed input: 22090.40 toks/s, output: 21.57 toks/s]
Processed prompts:  32%|███▏      | 82/256 [00:03<00:09, 18.28it/s, est. speed input: 21994.31 toks/s, output: 21.48 toks/s]
Processed prompts:  33%|███▎      | 84/256 [00:03<00:09, 18.29it/s, est. speed input: 21904.08 toks/s, output: 21.39 toks/s]
Processed prompts:  34%|███▎      | 86/256 [00:04<00:09, 18.29it/s, est. speed input: 21817.64 toks/s, output: 21.31 toks/s]
Processed prompts:  34%|███▍      | 88/256 [00:04<00:09, 18.26it/s, est. speed input: 21733.67 toks/s, output: 21.22 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:04<00:09, 18.26it/s, est. speed input: 21654.87 toks/s, output: 21.15 toks/s]
Processed prompts:  36%|███▌      | 92/256 [00:04<00:08, 18.28it/s, est. speed input: 21582.53 toks/s, output: 21.08 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:04<00:08, 18.28it/s, est. speed input: 21512.79 toks/s, output: 21.01 toks/s]
Processed prompts:  38%|███▊      | 96/256 [00:04<00:08, 18.29it/s, est. speed input: 21446.64 toks/s, output: 20.94 toks/s]
Processed prompts:  38%|███▊      | 98/256 [00:04<00:08, 18.29it/s, est. speed input: 21383.58 toks/s, output: 20.88 toks/s]
Processed prompts:  39%|███▉      | 100/256 [00:04<00:08, 18.28it/s, est. speed input: 21322.01 toks/s, output: 20.82 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:04<00:08, 18.28it/s, est. speed input: 21263.93 toks/s, output: 20.77 toks/s]
Processed prompts:  41%|████      | 104/256 [00:05<00:08, 18.27it/s, est. speed input: 21207.51 toks/s, output: 20.71 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:05<00:08, 18.27it/s, est. speed input: 21154.22 toks/s, output: 20.66 toks/s]
Processed prompts:  42%|████▏     | 108/256 [00:05<00:08, 18.26it/s, est. speed input: 21102.72 toks/s, output: 20.61 toks/s]
Processed prompts:  43%|████▎     | 110/256 [00:05<00:07, 18.26it/s, est. speed input: 21053.59 toks/s, output: 20.56 toks/s]
Processed prompts:  44%|████▍     | 112/256 [00:05<00:07, 18.26it/s, est. speed input: 21006.04 toks/s, output: 20.51 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:05<00:07, 18.25it/s, est. speed input: 20959.61 toks/s, output: 20.47 toks/s]
Processed prompts:  45%|████▌     | 116/256 [00:05<00:07, 18.25it/s, est. speed input: 20916.16 toks/s, output: 20.43 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:05<00:07, 18.25it/s, est. speed input: 20873.91 toks/s, output: 20.38 toks/s]
Processed prompts:  47%|████▋     | 120/256 [00:05<00:07, 18.25it/s, est. speed input: 20833.32 toks/s, output: 20.34 toks/s]
Processed prompts:  48%|████▊     | 122/256 [00:06<00:07, 18.26it/s, est. speed input: 20794.86 toks/s, output: 20.31 toks/s]
Processed prompts:  48%|████▊     | 124/256 [00:06<00:07, 18.27it/s, est. speed input: 20757.79 toks/s, output: 20.27 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:06<00:07, 18.28it/s, est. speed input: 20722.31 toks/s, output: 20.24 toks/s]
Processed prompts:  50%|█████     | 128/256 [00:06<00:06, 18.29it/s, est. speed input: 20688.59 toks/s, output: 20.20 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:06<00:06, 18.28it/s, est. speed input: 20654.75 toks/s, output: 20.17 toks/s]
Processed prompts:  52%|█████▏    | 132/256 [00:06<00:06, 18.28it/s, est. speed input: 20622.27 toks/s, output: 20.14 toks/s]
Processed prompts:  52%|█████▏    | 134/256 [00:06<00:06, 18.29it/s, est. speed input: 20591.86 toks/s, output: 20.11 toks/s]
Processed prompts:  53%|█████▎    | 136/256 [00:06<00:06, 18.30it/s, est. speed input: 20562.15 toks/s, output: 20.08 toks/s]
Processed prompts:  54%|█████▍    | 138/256 [00:06<00:06, 18.29it/s, est. speed input: 20532.93 toks/s, output: 20.05 toks/s]
Processed prompts:  55%|█████▍    | 140/256 [00:06<00:06, 18.28it/s, est. speed input: 20503.91 toks/s, output: 20.02 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:07<00:06, 18.28it/s, est. speed input: 20476.60 toks/s, output: 20.00 toks/s]
Processed prompts:  56%|█████▋    | 144/256 [00:07<00:06, 18.30it/s, est. speed input: 20450.72 toks/s, output: 19.97 toks/s]
Processed prompts:  57%|█████▋    | 146/256 [00:07<00:06, 18.31it/s, est. speed input: 20425.66 toks/s, output: 19.95 toks/s]
Processed prompts:  58%|█████▊    | 148/256 [00:07<00:05, 18.30it/s, est. speed input: 20400.71 toks/s, output: 19.92 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:07<00:05, 18.30it/s, est. speed input: 20376.39 toks/s, output: 19.90 toks/s]
Processed prompts:  59%|█████▉    | 152/256 [00:07<00:05, 18.30it/s, est. speed input: 20353.16 toks/s, output: 19.88 toks/s]
Processed prompts:  60%|██████    | 154/256 [00:07<00:05, 18.30it/s, est. speed input: 20330.21 toks/s, output: 19.85 toks/s]
Processed prompts:  61%|██████    | 156/256 [00:07<00:05, 18.27it/s, est. speed input: 20306.76 toks/s, output: 19.83 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:07<00:05, 18.27it/s, est. speed input: 20284.65 toks/s, output: 19.81 toks/s]
Processed prompts:  62%|██████▎   | 160/256 [00:08<00:05, 18.26it/s, est. speed input: 20262.87 toks/s, output: 19.79 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:08<00:05, 18.26it/s, est. speed input: 20242.13 toks/s, output: 19.77 toks/s]
Processed prompts:  64%|██████▍   | 164/256 [00:08<00:05, 18.26it/s, est. speed input: 20221.66 toks/s, output: 19.75 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:08<00:04, 18.25it/s, est. speed input: 20201.52 toks/s, output: 19.73 toks/s]
Processed prompts:  66%|██████▌   | 168/256 [00:08<00:04, 18.23it/s, est. speed input: 20181.11 toks/s, output: 19.71 toks/s]
Processed prompts:  66%|██████▋   | 170/256 [00:08<00:04, 18.24it/s, est. speed input: 20162.48 toks/s, output: 19.69 toks/s]
Processed prompts:  67%|██████▋   | 172/256 [00:08<00:04, 18.27it/s, est. speed input: 20144.99 toks/s, output: 19.67 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:08<00:04, 18.28it/s, est. speed input: 20127.87 toks/s, output: 19.66 toks/s]
Processed prompts:  69%|██████▉   | 176/256 [00:08<00:04, 18.28it/s, est. speed input: 20110.59 toks/s, output: 19.64 toks/s]
Processed prompts:  70%|██████▉   | 178/256 [00:09<00:04, 18.27it/s, est. speed input: 20093.18 toks/s, output: 19.62 toks/s]
Processed prompts:  70%|███████   | 180/256 [00:09<00:04, 18.26it/s, est. speed input: 20076.24 toks/s, output: 19.61 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:09<00:04, 18.26it/s, est. speed input: 20060.19 toks/s, output: 19.59 toks/s]
Processed prompts:  72%|███████▏  | 184/256 [00:09<00:03, 18.25it/s, est. speed input: 20044.02 toks/s, output: 19.57 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:09<00:03, 18.23it/s, est. speed input: 20027.53 toks/s, output: 19.56 toks/s]
Processed prompts:  73%|███████▎  | 188/256 [00:09<00:03, 18.22it/s, est. speed input: 20011.61 toks/s, output: 19.54 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:09<00:03, 18.21it/s, est. speed input: 19995.69 toks/s, output: 19.53 toks/s]
Processed prompts:  75%|███████▌  | 192/256 [00:09<00:03, 18.19it/s, est. speed input: 19980.01 toks/s, output: 19.51 toks/s]
Processed prompts:  76%|███████▌  | 194/256 [00:09<00:03, 18.17it/s, est. speed input: 19964.35 toks/s, output: 19.50 toks/s]
Processed prompts:  77%|███████▋  | 196/256 [00:10<00:03, 18.17it/s, est. speed input: 19949.35 toks/s, output: 19.48 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:10<00:03, 18.17it/s, est. speed input: 19934.80 toks/s, output: 19.47 toks/s]
Processed prompts:  78%|███████▊  | 200/256 [00:10<00:03, 18.18it/s, est. speed input: 19920.85 toks/s, output: 19.45 toks/s]
Processed prompts:  80%|███████▉  | 204/256 [00:10<00:02, 20.02it/s, est. speed input: 19977.03 toks/s, output: 19.51 toks/s]
Processed prompts:  80%|████████  | 206/256 [00:10<00:02, 19.53it/s, est. speed input: 19962.62 toks/s, output: 19.49 toks/s]
Processed prompts:  81%|████████▏ | 208/256 [00:10<00:02, 19.15it/s, est. speed input: 19948.39 toks/s, output: 19.48 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:10<00:02, 18.87it/s, est. speed input: 19934.69 toks/s, output: 19.47 toks/s]
Processed prompts:  83%|████████▎ | 212/256 [00:10<00:02, 18.66it/s, est. speed input: 19920.89 toks/s, output: 19.45 toks/s]
Processed prompts:  84%|████████▎ | 214/256 [00:11<00:02, 18.50it/s, est. speed input: 19906.97 toks/s, output: 19.44 toks/s]
Processed prompts:  84%|████████▍ | 216/256 [00:11<00:02, 18.38it/s, est. speed input: 19893.39 toks/s, output: 19.43 toks/s]
Processed prompts:  85%|████████▌ | 218/256 [00:11<00:02, 18.30it/s, est. speed input: 19880.28 toks/s, output: 19.41 toks/s]
Processed prompts:  86%|████████▌ | 220/256 [00:11<00:01, 18.24it/s, est. speed input: 19866.91 toks/s, output: 19.40 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:11<00:01, 18.19it/s, est. speed input: 19853.88 toks/s, output: 19.39 toks/s]
Processed prompts:  88%|████████▊ | 224/256 [00:11<00:01, 18.17it/s, est. speed input: 19841.48 toks/s, output: 19.38 toks/s]
Processed prompts:  88%|████████▊ | 226/256 [00:11<00:01, 18.16it/s, est. speed input: 19829.32 toks/s, output: 19.36 toks/s]
Processed prompts:  89%|████████▉ | 228/256 [00:11<00:01, 18.14it/s, est. speed input: 19817.36 toks/s, output: 19.35 toks/s]
Processed prompts:  90%|████████▉ | 230/256 [00:11<00:01, 18.15it/s, est. speed input: 19806.02 toks/s, output: 19.34 toks/s]
Processed prompts:  91%|█████████ | 232/256 [00:12<00:01, 18.14it/s, est. speed input: 19794.66 toks/s, output: 19.33 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:12<00:01, 18.14it/s, est. speed input: 19783.53 toks/s, output: 19.32 toks/s]
Processed prompts:  92%|█████████▏| 236/256 [00:12<00:01, 18.14it/s, est. speed input: 19772.42 toks/s, output: 19.31 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:12<00:00, 18.15it/s, est. speed input: 19762.21 toks/s, output: 19.30 toks/s]
Processed prompts:  94%|█████████▍| 240/256 [00:12<00:00, 18.15it/s, est. speed input: 19751.91 toks/s, output: 19.29 toks/s]
Processed prompts:  95%|█████████▍| 242/256 [00:12<00:00, 18.13it/s, est. speed input: 19740.94 toks/s, output: 19.28 toks/s]
Processed prompts:  95%|█████████▌| 244/256 [00:12<00:00, 18.13it/s, est. speed input: 19730.82 toks/s, output: 19.27 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:12<00:00, 18.14it/s, est. speed input: 19721.09 toks/s, output: 19.26 toks/s]
Processed prompts:  97%|█████████▋| 248/256 [00:12<00:00, 18.14it/s, est. speed input: 19711.27 toks/s, output: 19.25 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:12<00:00, 18.13it/s, est. speed input: 19701.26 toks/s, output: 19.24 toks/s]
Processed prompts:  98%|█████████▊| 252/256 [00:13<00:00, 18.14it/s, est. speed input: 19691.98 toks/s, output: 19.23 toks/s]
Processed prompts:  99%|█████████▉| 254/256 [00:13<00:00, 18.13it/s, est. speed input: 19682.52 toks/s, output: 19.22 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:13<00:00, 18.13it/s, est. speed input: 19746.35 toks/s, output: 19.28 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:13<00:00, 19.28it/s, est. speed input: 19746.35 toks/s, output: 19.28 toks/s]
[rank0]:[W126 04:23:35.545445451 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 64.0s

测试结果:
  Requests/s:   17.87
  Tokens/s:     18320.29
  Total Reqs:   256
  Elapsed:      14.32s

  [Prefill 分析]
  Total Prefill Tokens: 262144
  Prefill Tokens/s:     18302.41

============================================================
[4/8] 测试 M=4096
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 4096
│   M_prefill     = 4096 (= 4 x 1024)
│   M_decode      = 4
│   batched_tokens = 4096 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 512
│   --max-num-seqs           = 4
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 4096
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 04:23:49 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 04:23:51 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=171203) WARNING 01-26 04:23:59 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=171203) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=171203) WARNING 01-26 04:24:11 [backends.py:609] Failed to read file <frozen os>
Throughput: 18.76 requests/s, 19229.03 total tokens/s, 18.76 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512


─── STDERR ───
[2026-01-26 04:23:49] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 04:23:49] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:23:49] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 04:23:49] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:23:49] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:23:49] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:23:49] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:23:49] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:23:49] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:23:49] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 04:23:49] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 04:23:49] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 04:23:49] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 04:23:49] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 04:23:58] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 04:23:58] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:23:58] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 04:23:58] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:23:58] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:23:58] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:23:58] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:23:58] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:23:58] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:23:58] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 04:23:58] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 04:23:58] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 04:23:58] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 04:23:58] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=171203) [2026-01-26 04:23:59] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=171203) [2026-01-26 04:23:59] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=171203) [2026-01-26 04:23:59] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=171203) [2026-01-26 04:23:59] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=171203) [2026-01-26 04:23:59] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=171203) [2026-01-26 04:23:59] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=171203) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=171203) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.00it/s]
(EngineCore_DP0 pid=171203) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.22s/it]
(EngineCore_DP0 pid=171203) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.18s/it]
(EngineCore_DP0 pid=171203) 
(EngineCore_DP0 pid=171203) [2026-01-26 04:24:02] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=171203) [2026-01-26 04:24:02] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 18579456 bytes
(EngineCore_DP0 pid=171203) [2026-01-26 04:24:02] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=171203) [2026-01-26 04:24:02] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 14450688 bytes
(EngineCore_DP0 pid=171203) [2026-01-26 04:24:02] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=171203) [2026-01-26 04:24:02] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 152764416 bytes
(EngineCore_DP0 pid=171203) [2026-01-26 04:24:02] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=171203) [2026-01-26 04:24:02] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 76382208 bytes
(EngineCore_DP0 pid=171203) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  25%|██▌       | 1/4 [00:00<00:00,  7.13it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 2/4 [00:00<00:00,  4.68it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  75%|███████▌  | 3/4 [00:00<00:00,  5.93it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  5.01it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  5.21it/s]
(EngineCore_DP0 pid=171203) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  33%|███▎      | 1/3 [00:00<00:00,  6.84it/s]
Capturing CUDA graphs (decode, FULL):  67%|██████▋   | 2/3 [00:00<00:00,  7.91it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  8.40it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  8.13it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   4%|▍         | 22/512 [00:00<00:02, 214.66it/s]
Adding requests:   9%|▉         | 48/512 [00:00<00:01, 236.28it/s]
Adding requests:  14%|█▍        | 73/512 [00:00<00:01, 238.77it/s]
Adding requests:  19%|█▉        | 97/512 [00:00<00:01, 228.60it/s]
Adding requests:  24%|██▎       | 121/512 [00:00<00:01, 231.82it/s]
Adding requests:  28%|██▊       | 145/512 [00:00<00:01, 232.89it/s]
Adding requests:  33%|███▎      | 169/512 [00:00<00:01, 233.07it/s]
Adding requests:  38%|███▊      | 195/512 [00:00<00:01, 240.71it/s]
Adding requests:  43%|████▎     | 221/512 [00:00<00:01, 245.07it/s]
Adding requests:  48%|████▊     | 246/512 [00:01<00:01, 243.19it/s]
Adding requests:  53%|█████▎    | 271/512 [00:01<00:00, 241.26it/s]
Adding requests:  58%|█████▊    | 297/512 [00:01<00:00, 246.57it/s]
Adding requests:  63%|██████▎   | 323/512 [00:01<00:00, 248.79it/s]
Adding requests:  68%|██████▊   | 349/512 [00:01<00:00, 251.87it/s]
Adding requests:  73%|███████▎  | 375/512 [00:01<00:00, 254.17it/s]
Adding requests:  79%|███████▊  | 403/512 [00:01<00:00, 260.81it/s]
Adding requests:  84%|████████▍ | 430/512 [00:01<00:00, 257.85it/s]
Adding requests:  89%|████████▉ | 456/512 [00:01<00:00, 256.41it/s]
Adding requests:  95%|█████████▍| 484/512 [00:01<00:00, 262.69it/s]
Adding requests: 100%|██████████| 512/512 [00:02<00:00, 265.44it/s]
Adding requests: 100%|██████████| 512/512 [00:02<00:00, 248.64it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   7%|▋         | 38/512 [00:00<00:03, 128.56it/s, est. speed input: 131662.12 toks/s, output: 128.57 toks/s]
Processed prompts:  10%|▉         | 51/512 [00:00<00:09, 47.27it/s, est. speed input: 56377.89 toks/s, output: 55.06 toks/s]   
Processed prompts:  11%|█▏        | 58/512 [00:01<00:13, 34.48it/s, est. speed input: 44092.26 toks/s, output: 43.06 toks/s]
Processed prompts:  12%|█▏        | 63/512 [00:01<00:14, 32.02it/s, est. speed input: 41428.66 toks/s, output: 40.46 toks/s]
Processed prompts:  13%|█▎        | 67/512 [00:01<00:15, 28.81it/s, est. speed input: 38816.97 toks/s, output: 37.91 toks/s]
Processed prompts:  14%|█▎        | 70/512 [00:01<00:17, 25.01it/s, est. speed input: 36240.44 toks/s, output: 35.39 toks/s]
Processed prompts:  14%|█▍        | 74/512 [00:02<00:18, 23.37it/s, est. speed input: 34619.96 toks/s, output: 33.81 toks/s]
Processed prompts:  15%|█▌        | 78/512 [00:02<00:19, 22.15it/s, est. speed input: 33290.18 toks/s, output: 32.51 toks/s]
Processed prompts:  16%|█▌        | 82/512 [00:02<00:20, 21.26it/s, est. speed input: 32176.91 toks/s, output: 31.42 toks/s]
Processed prompts:  17%|█▋        | 86/512 [00:02<00:20, 20.60it/s, est. speed input: 31226.93 toks/s, output: 30.49 toks/s]
Processed prompts:  18%|█▊        | 90/512 [00:03<00:20, 20.13it/s, est. speed input: 30409.37 toks/s, output: 29.70 toks/s]
Processed prompts:  18%|█▊        | 94/512 [00:03<00:21, 19.80it/s, est. speed input: 29698.23 toks/s, output: 29.00 toks/s]
Processed prompts:  19%|█▉        | 98/512 [00:03<00:21, 19.56it/s, est. speed input: 29072.21 toks/s, output: 28.39 toks/s]
Processed prompts:  20%|█▉        | 102/512 [00:03<00:21, 19.40it/s, est. speed input: 28520.49 toks/s, output: 27.85 toks/s]
Processed prompts:  21%|██        | 106/512 [00:03<00:21, 19.27it/s, est. speed input: 28025.03 toks/s, output: 27.37 toks/s]
Processed prompts:  21%|██▏       | 110/512 [00:04<00:20, 19.18it/s, est. speed input: 27581.67 toks/s, output: 26.94 toks/s]
Processed prompts:  22%|██▏       | 114/512 [00:04<00:20, 19.12it/s, est. speed input: 27182.67 toks/s, output: 26.55 toks/s]
Processed prompts:  23%|██▎       | 118/512 [00:04<00:20, 19.08it/s, est. speed input: 26819.23 toks/s, output: 26.19 toks/s]
Processed prompts:  24%|██▍       | 122/512 [00:04<00:20, 19.05it/s, est. speed input: 26488.93 toks/s, output: 25.87 toks/s]
Processed prompts:  25%|██▍       | 126/512 [00:04<00:20, 19.03it/s, est. speed input: 26187.22 toks/s, output: 25.57 toks/s]
Processed prompts:  25%|██▌       | 130/512 [00:05<00:20, 19.01it/s, est. speed input: 25910.07 toks/s, output: 25.30 toks/s]
Processed prompts:  26%|██▌       | 134/512 [00:05<00:19, 19.01it/s, est. speed input: 25655.69 toks/s, output: 25.05 toks/s]
Processed prompts:  27%|██▋       | 138/512 [00:05<00:19, 19.00it/s, est. speed input: 25420.31 toks/s, output: 24.82 toks/s]
Processed prompts:  28%|██▊       | 142/512 [00:05<00:19, 18.98it/s, est. speed input: 25199.11 toks/s, output: 24.61 toks/s]
Processed prompts:  29%|██▊       | 146/512 [00:05<00:19, 18.98it/s, est. speed input: 24996.54 toks/s, output: 24.41 toks/s]
Processed prompts:  29%|██▉       | 150/512 [00:06<00:19, 18.98it/s, est. speed input: 24806.45 toks/s, output: 24.22 toks/s]
Processed prompts:  30%|███       | 154/512 [00:06<00:18, 18.97it/s, est. speed input: 24628.77 toks/s, output: 24.05 toks/s]
Processed prompts:  31%|███       | 158/512 [00:06<00:18, 18.97it/s, est. speed input: 24463.25 toks/s, output: 23.89 toks/s]
Processed prompts:  32%|███▏      | 162/512 [00:06<00:18, 18.96it/s, est. speed input: 24306.16 toks/s, output: 23.74 toks/s]
Processed prompts:  32%|███▏      | 166/512 [00:07<00:18, 18.97it/s, est. speed input: 24159.98 toks/s, output: 23.59 toks/s]
Processed prompts:  39%|███▊      | 198/512 [00:07<00:05, 52.63it/s, est. speed input: 27664.65 toks/s, output: 27.02 toks/s]
Processed prompts:  40%|███▉      | 203/512 [00:07<00:06, 46.82it/s, est. speed input: 27701.42 toks/s, output: 27.05 toks/s]
Processed prompts:  41%|████      | 208/512 [00:07<00:07, 40.04it/s, est. speed input: 27608.02 toks/s, output: 26.96 toks/s]
Processed prompts:  41%|████▏     | 212/512 [00:07<00:08, 33.78it/s, est. speed input: 27388.37 toks/s, output: 26.75 toks/s]
Processed prompts:  42%|████▏     | 216/512 [00:08<00:10, 29.36it/s, est. speed input: 27179.36 toks/s, output: 26.54 toks/s]
Processed prompts:  43%|████▎     | 219/512 [00:08<00:11, 24.83it/s, est. speed input: 26858.75 toks/s, output: 26.23 toks/s]
Processed prompts:  43%|████▎     | 222/512 [00:08<00:13, 21.66it/s, est. speed input: 26555.01 toks/s, output: 25.93 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:08<00:13, 20.83it/s, est. speed input: 26381.05 toks/s, output: 25.76 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:08<00:13, 20.26it/s, est. speed input: 26216.43 toks/s, output: 25.60 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:09<00:14, 19.85it/s, est. speed input: 26057.81 toks/s, output: 25.45 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:09<00:14, 19.54it/s, est. speed input: 25904.28 toks/s, output: 25.30 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:09<00:13, 19.33it/s, est. speed input: 25758.94 toks/s, output: 25.16 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:09<00:13, 19.20it/s, est. speed input: 25620.75 toks/s, output: 25.02 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:10<00:13, 19.10it/s, est. speed input: 25488.11 toks/s, output: 24.89 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:10<00:13, 19.02it/s, est. speed input: 25359.73 toks/s, output: 24.77 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:10<00:13, 18.98it/s, est. speed input: 25237.92 toks/s, output: 24.65 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:10<00:13, 18.93it/s, est. speed input: 25119.17 toks/s, output: 24.53 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:10<00:13, 18.91it/s, est. speed input: 25005.63 toks/s, output: 24.42 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:11<00:12, 18.89it/s, est. speed input: 24896.76 toks/s, output: 24.31 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:11<00:12, 18.89it/s, est. speed input: 24792.68 toks/s, output: 24.21 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:11<00:12, 18.88it/s, est. speed input: 24691.64 toks/s, output: 24.11 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:11<00:12, 18.86it/s, est. speed input: 24593.85 toks/s, output: 24.02 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:11<00:11, 18.87it/s, est. speed input: 24500.62 toks/s, output: 23.93 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:12<00:11, 18.86it/s, est. speed input: 24409.45 toks/s, output: 23.84 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:12<00:11, 18.85it/s, est. speed input: 24321.58 toks/s, output: 23.75 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:12<00:11, 18.84it/s, est. speed input: 24236.62 toks/s, output: 23.67 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:12<00:11, 18.84it/s, est. speed input: 24154.68 toks/s, output: 23.59 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:13<00:10, 18.83it/s, est. speed input: 24074.63 toks/s, output: 23.51 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:13<00:10, 18.83it/s, est. speed input: 23997.32 toks/s, output: 23.43 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:13<00:10, 18.81it/s, est. speed input: 23921.67 toks/s, output: 23.36 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:13<00:10, 18.82it/s, est. speed input: 23849.94 toks/s, output: 23.29 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:13<00:10, 18.82it/s, est. speed input: 23779.42 toks/s, output: 23.22 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:14<00:09, 18.82it/s, est. speed input: 23711.26 toks/s, output: 23.16 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:14<00:09, 18.82it/s, est. speed input: 23645.48 toks/s, output: 23.09 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:14<00:09, 18.81it/s, est. speed input: 23580.86 toks/s, output: 23.03 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:14<00:09, 18.80it/s, est. speed input: 23517.82 toks/s, output: 22.97 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:14<00:09, 18.80it/s, est. speed input: 23457.22 toks/s, output: 22.91 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:15<00:08, 18.80it/s, est. speed input: 23397.71 toks/s, output: 22.85 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:15<00:08, 18.79it/s, est. speed input: 23340.02 toks/s, output: 22.79 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:15<00:08, 18.80it/s, est. speed input: 23284.23 toks/s, output: 22.74 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:15<00:08, 18.78it/s, est. speed input: 23229.01 toks/s, output: 22.68 toks/s]
Processed prompts:  71%|███████   | 362/512 [00:15<00:07, 18.79it/s, est. speed input: 23176.19 toks/s, output: 22.63 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:16<00:07, 18.79it/s, est. speed input: 23124.44 toks/s, output: 22.58 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [00:16<00:07, 18.77it/s, est. speed input: 23073.20 toks/s, output: 22.53 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [00:16<00:07, 18.77it/s, est. speed input: 23023.61 toks/s, output: 22.48 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [00:16<00:07, 18.76it/s, est. speed input: 22975.22 toks/s, output: 22.44 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [00:17<00:06, 18.78it/s, est. speed input: 22928.86 toks/s, output: 22.39 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [00:17<00:06, 18.77it/s, est. speed input: 22882.95 toks/s, output: 22.35 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [00:17<00:06, 18.78it/s, est. speed input: 22838.60 toks/s, output: 22.30 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [00:17<00:06, 18.78it/s, est. speed input: 22795.27 toks/s, output: 22.26 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [00:17<00:06, 18.78it/s, est. speed input: 22752.89 toks/s, output: 22.22 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [00:18<00:05, 18.78it/s, est. speed input: 22711.41 toks/s, output: 22.18 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [00:18<00:05, 18.78it/s, est. speed input: 22671.13 toks/s, output: 22.14 toks/s]
Processed prompts:  80%|████████  | 410/512 [00:18<00:05, 18.78it/s, est. speed input: 22631.35 toks/s, output: 22.10 toks/s]
Processed prompts:  81%|████████  | 414/512 [00:18<00:05, 18.78it/s, est. speed input: 22592.76 toks/s, output: 22.06 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [00:18<00:05, 18.76it/s, est. speed input: 22554.54 toks/s, output: 22.03 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [00:19<00:04, 18.77it/s, est. speed input: 22517.49 toks/s, output: 21.99 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [00:19<00:04, 18.76it/s, est. speed input: 22481.00 toks/s, output: 21.95 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [00:19<00:04, 18.76it/s, est. speed input: 22445.53 toks/s, output: 21.92 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [00:19<00:04, 18.76it/s, est. speed input: 22410.67 toks/s, output: 21.89 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [00:20<00:03, 18.76it/s, est. speed input: 22376.45 toks/s, output: 21.85 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [00:20<00:03, 18.76it/s, est. speed input: 22343.41 toks/s, output: 21.82 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [00:20<00:03, 18.76it/s, est. speed input: 22310.81 toks/s, output: 21.79 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [00:20<00:03, 18.77it/s, est. speed input: 22279.07 toks/s, output: 21.76 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [00:20<00:03, 18.77it/s, est. speed input: 22247.71 toks/s, output: 21.73 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [00:21<00:02, 18.76it/s, est. speed input: 22217.06 toks/s, output: 21.70 toks/s]
Processed prompts:  90%|█████████ | 462/512 [00:21<00:02, 18.77it/s, est. speed input: 22187.12 toks/s, output: 21.67 toks/s]
Processed prompts:  91%|█████████ | 466/512 [00:21<00:02, 18.77it/s, est. speed input: 22157.68 toks/s, output: 21.64 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [00:21<00:02, 18.76it/s, est. speed input: 22128.59 toks/s, output: 21.61 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [00:21<00:02, 18.78it/s, est. speed input: 22100.89 toks/s, output: 21.58 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [00:22<00:01, 18.76it/s, est. speed input: 22072.82 toks/s, output: 21.56 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [00:22<00:01, 18.77it/s, est. speed input: 22045.78 toks/s, output: 21.53 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [00:22<00:01, 18.76it/s, est. speed input: 22018.74 toks/s, output: 21.50 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [00:22<00:01, 18.77it/s, est. speed input: 21992.81 toks/s, output: 21.48 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [00:23<00:00, 18.76it/s, est. speed input: 21966.94 toks/s, output: 21.45 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [00:23<00:00, 18.77it/s, est. speed input: 21941.78 toks/s, output: 21.43 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [00:23<00:00, 18.77it/s, est. speed input: 21917.02 toks/s, output: 21.40 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [00:23<00:00, 18.78it/s, est. speed input: 21893.18 toks/s, output: 21.38 toks/s]
Processed prompts: 100%|█████████▉| 510/512 [00:23<00:00, 20.08it/s, est. speed input: 21911.59 toks/s, output: 21.40 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:23<00:00, 20.08it/s, est. speed input: 21997.33 toks/s, output: 21.48 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:23<00:00, 21.48it/s, est. speed input: 21997.33 toks/s, output: 21.48 toks/s]
[rank0]:[W126 04:24:56.833029584 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 81.5s

测试结果:
  Requests/s:   18.76
  Tokens/s:     19229.03
  Total Reqs:   512
  Elapsed:      27.29s

  [Prefill 分析]
  Total Prefill Tokens: 524288
  Prefill Tokens/s:     19210.27

============================================================
[5/8] 测试 M=8192
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 8192
│   M_prefill     = 8192 (= 8 x 1024)
│   M_decode      = 8
│   batched_tokens = 8192 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 1024
│   --max-num-seqs           = 8
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 8192
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 04:25:13 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 04:25:14 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=172627) WARNING 01-26 04:25:22 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=172627) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=172627) WARNING 01-26 04:25:35 [backends.py:609] Failed to read file <frozen os>
Throughput: 18.92 requests/s, 19390.86 total tokens/s, 18.92 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024


─── STDERR ───
[2026-01-26 04:25:13] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 04:25:13] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:25:13] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 04:25:13] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:25:13] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:25:13] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:25:13] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:25:13] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:25:13] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:25:13] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 04:25:13] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 04:25:13] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 04:25:13] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 04:25:13] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 04:25:21] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 04:25:22] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:25:22] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 04:25:22] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:25:22] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:25:22] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:25:22] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:25:22] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:25:22] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:25:22] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 04:25:22] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 04:25:22] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 04:25:22] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 04:25:22] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=172627) [2026-01-26 04:25:23] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=172627) [2026-01-26 04:25:23] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=172627) [2026-01-26 04:25:23] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=172627) [2026-01-26 04:25:23] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=172627) [2026-01-26 04:25:23] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=172627) [2026-01-26 04:25:23] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=172627) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=172627) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.05it/s]
(EngineCore_DP0 pid=172627) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.22s/it]
(EngineCore_DP0 pid=172627) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.18s/it]
(EngineCore_DP0 pid=172627) 
(EngineCore_DP0 pid=172627) [2026-01-26 04:25:26] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=172627) [2026-01-26 04:25:26] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 18579456 bytes
(EngineCore_DP0 pid=172627) [2026-01-26 04:25:26] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=172627) [2026-01-26 04:25:26] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 14450688 bytes
(EngineCore_DP0 pid=172627) [2026-01-26 04:25:26] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=172627) [2026-01-26 04:25:26] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 152764416 bytes
(EngineCore_DP0 pid=172627) [2026-01-26 04:25:26] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=172627) [2026-01-26 04:25:26] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 76382208 bytes
(EngineCore_DP0 pid=172627) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:01,  2.43it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  40%|████      | 2/5 [00:00<00:00,  3.68it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  60%|██████    | 3/5 [00:00<00:00,  4.45it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  80%|████████  | 4/5 [00:00<00:00,  5.17it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:01<00:00,  4.95it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:01<00:00,  4.48it/s]
(EngineCore_DP0 pid=172627) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:00,  6.95it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 2/4 [00:00<00:00,  8.03it/s]
Capturing CUDA graphs (decode, FULL):  75%|███████▌  | 3/4 [00:00<00:00,  8.60it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  8.70it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  8.43it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 20/1024 [00:00<00:05, 198.61it/s]
Adding requests:   4%|▍         | 45/1024 [00:00<00:04, 226.14it/s]
Adding requests:   7%|▋         | 70/1024 [00:00<00:04, 234.56it/s]
Adding requests:   9%|▉         | 94/1024 [00:00<00:04, 231.67it/s]
Adding requests:  12%|█▏        | 118/1024 [00:00<00:03, 233.96it/s]
Adding requests:  14%|█▍        | 143/1024 [00:00<00:03, 237.17it/s]
Adding requests:  16%|█▋        | 168/1024 [00:00<00:03, 240.51it/s]
Adding requests:  19%|█▉        | 194/1024 [00:00<00:03, 243.43it/s]
Adding requests:  21%|██▏       | 219/1024 [00:00<00:03, 233.57it/s]
Adding requests:  24%|██▍       | 244/1024 [00:01<00:03, 235.93it/s]
Adding requests:  26%|██▋       | 269/1024 [00:01<00:03, 238.50it/s]
Adding requests:  29%|██▉       | 295/1024 [00:01<00:02, 243.65it/s]
Adding requests:  31%|███▏      | 322/1024 [00:01<00:02, 250.51it/s]
Adding requests:  34%|███▍      | 348/1024 [00:01<00:02, 250.68it/s]
Adding requests:  37%|███▋      | 374/1024 [00:01<00:02, 253.07it/s]
Adding requests:  39%|███▉      | 400/1024 [00:01<00:02, 251.39it/s]
Adding requests:  42%|████▏     | 427/1024 [00:01<00:02, 256.41it/s]
Adding requests:  44%|████▍     | 453/1024 [00:01<00:02, 249.29it/s]
Adding requests:  47%|████▋     | 480/1024 [00:01<00:02, 255.18it/s]
Adding requests:  50%|████▉     | 508/1024 [00:02<00:01, 261.38it/s]
Adding requests:  52%|█████▏    | 535/1024 [00:02<00:01, 262.84it/s]
Adding requests:  55%|█████▍    | 562/1024 [00:02<00:01, 260.91it/s]
Adding requests:  58%|█████▊    | 589/1024 [00:02<00:01, 253.66it/s]
Adding requests:  60%|██████    | 615/1024 [00:02<00:01, 253.20it/s]
Adding requests:  63%|██████▎   | 641/1024 [00:02<00:01, 253.59it/s]
Adding requests:  65%|██████▌   | 667/1024 [00:02<00:01, 250.88it/s]
Adding requests:  68%|██████▊   | 695/1024 [00:02<00:01, 256.38it/s]
Adding requests:  70%|███████   | 721/1024 [00:02<00:01, 245.13it/s]
Adding requests:  73%|███████▎  | 746/1024 [00:03<00:01, 245.41it/s]
Adding requests:  76%|███████▌  | 774/1024 [00:03<00:00, 253.63it/s]
Adding requests:  78%|███████▊  | 800/1024 [00:03<00:00, 255.17it/s]
Adding requests:  81%|████████  | 826/1024 [00:03<00:00, 256.45it/s]
Adding requests:  83%|████████▎ | 853/1024 [00:03<00:00, 258.73it/s]
Adding requests:  86%|████████▌ | 879/1024 [00:03<00:00, 246.22it/s]
Adding requests:  88%|████████▊ | 905/1024 [00:03<00:00, 247.60it/s]
Adding requests:  91%|█████████ | 930/1024 [00:03<00:00, 239.20it/s]
Adding requests:  93%|█████████▎| 955/1024 [00:03<00:00, 240.69it/s]
Adding requests:  96%|█████████▌| 980/1024 [00:03<00:00, 236.24it/s]
Adding requests:  98%|█████████▊| 1004/1024 [00:04<00:00, 231.86it/s]
Adding requests: 100%|██████████| 1024/1024 [00:04<00:00, 245.89it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   7%|▋         | 74/1024 [00:00<00:05, 160.92it/s, est. speed input: 164798.41 toks/s, output: 160.93 toks/s]
Processed prompts:   9%|▉         | 91/1024 [00:01<00:15, 59.67it/s, est. speed input: 72186.10 toks/s, output: 70.49 toks/s]   
Processed prompts:  10%|▉         | 99/1024 [00:01<00:20, 45.92it/s, est. speed input: 59393.70 toks/s, output: 58.00 toks/s]
Processed prompts:  10%|█         | 106/1024 [00:02<00:25, 36.40it/s, est. speed input: 51123.34 toks/s, output: 49.92 toks/s]
Processed prompts:  11%|█         | 114/1024 [00:02<00:29, 30.92it/s, est. speed input: 45965.97 toks/s, output: 44.89 toks/s]
Processed prompts:  12%|█▏        | 122/1024 [00:02<00:33, 27.26it/s, est. speed input: 42259.77 toks/s, output: 41.27 toks/s]
Processed prompts:  13%|█▎        | 130/1024 [00:03<00:36, 24.77it/s, est. speed input: 39467.33 toks/s, output: 38.54 toks/s]
Processed prompts:  13%|█▎        | 138/1024 [00:03<00:38, 23.05it/s, est. speed input: 37284.80 toks/s, output: 36.41 toks/s]
Processed prompts:  14%|█▍        | 146/1024 [00:04<00:40, 21.87it/s, est. speed input: 35535.33 toks/s, output: 34.70 toks/s]
Processed prompts:  15%|█▌        | 154/1024 [00:04<00:41, 21.05it/s, est. speed input: 34099.15 toks/s, output: 33.30 toks/s]
Processed prompts:  16%|█▌        | 162/1024 [00:05<00:42, 20.48it/s, est. speed input: 32900.19 toks/s, output: 32.13 toks/s]
Processed prompts:  17%|█▋        | 170/1024 [00:05<00:42, 20.08it/s, est. speed input: 31882.99 toks/s, output: 31.14 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [00:05<00:42, 19.80it/s, est. speed input: 31010.65 toks/s, output: 30.28 toks/s]
Processed prompts:  18%|█▊        | 186/1024 [00:06<00:42, 19.60it/s, est. speed input: 30252.55 toks/s, output: 29.54 toks/s]
Processed prompts:  19%|█▉        | 194/1024 [00:06<00:42, 19.46it/s, est. speed input: 29587.49 toks/s, output: 28.89 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [00:07<00:41, 19.70it/s, est. speed input: 29100.20 toks/s, output: 28.42 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:07<00:41, 19.52it/s, est. speed input: 28569.40 toks/s, output: 27.90 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [00:07<00:41, 19.39it/s, est. speed input: 28094.41 toks/s, output: 27.44 toks/s]
Processed prompts:  22%|██▏       | 226/1024 [00:08<00:41, 19.30it/s, est. speed input: 27666.83 toks/s, output: 27.02 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:08<00:41, 19.24it/s, est. speed input: 27279.61 toks/s, output: 26.64 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:09<00:40, 19.19it/s, est. speed input: 26926.97 toks/s, output: 26.30 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:09<00:40, 19.15it/s, est. speed input: 26604.34 toks/s, output: 25.98 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:10<00:40, 19.13it/s, est. speed input: 26309.23 toks/s, output: 25.69 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:10<00:39, 19.11it/s, est. speed input: 26036.70 toks/s, output: 25.43 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:10<00:39, 19.10it/s, est. speed input: 25785.31 toks/s, output: 25.18 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:11<00:38, 19.08it/s, est. speed input: 25552.34 toks/s, output: 24.95 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:11<00:38, 19.08it/s, est. speed input: 25336.08 toks/s, output: 24.74 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:12<00:38, 19.06it/s, est. speed input: 25133.94 toks/s, output: 24.54 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:12<00:37, 19.06it/s, est. speed input: 24945.63 toks/s, output: 24.36 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:12<00:37, 19.05it/s, est. speed input: 24768.84 toks/s, output: 24.19 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:13<00:36, 19.04it/s, est. speed input: 24603.13 toks/s, output: 24.03 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:13<00:36, 19.04it/s, est. speed input: 24447.57 toks/s, output: 23.87 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:14<00:36, 19.03it/s, est. speed input: 24300.86 toks/s, output: 23.73 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:14<00:16, 40.13it/s, est. speed input: 26085.05 toks/s, output: 25.47 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:14<00:19, 33.32it/s, est. speed input: 25898.72 toks/s, output: 25.29 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:15<00:22, 28.82it/s, est. speed input: 25723.68 toks/s, output: 25.12 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [00:15<00:24, 25.78it/s, est. speed input: 25557.62 toks/s, output: 24.96 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:16<00:26, 23.70it/s, est. speed input: 25400.00 toks/s, output: 24.80 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:16<00:27, 22.27it/s, est. speed input: 25250.03 toks/s, output: 24.66 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:17<00:28, 21.28it/s, est. speed input: 25107.26 toks/s, output: 24.52 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:17<00:29, 20.60it/s, est. speed input: 24971.60 toks/s, output: 24.39 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:17<00:29, 20.11it/s, est. speed input: 24841.72 toks/s, output: 24.26 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:18<00:29, 19.78it/s, est. speed input: 24717.82 toks/s, output: 24.14 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:18<00:29, 19.55it/s, est. speed input: 24599.89 toks/s, output: 24.02 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:19<00:29, 19.39it/s, est. speed input: 24487.32 toks/s, output: 23.91 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:19<00:28, 19.27it/s, est. speed input: 24379.21 toks/s, output: 23.81 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:19<00:28, 19.20it/s, est. speed input: 24275.90 toks/s, output: 23.71 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:20<00:28, 19.14it/s, est. speed input: 24176.57 toks/s, output: 23.61 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:20<00:27, 19.09it/s, est. speed input: 24080.91 toks/s, output: 23.52 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:21<00:27, 19.07it/s, est. speed input: 23989.60 toks/s, output: 23.43 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:21<00:27, 19.05it/s, est. speed input: 23901.57 toks/s, output: 23.34 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:22<00:26, 19.04it/s, est. speed input: 23817.26 toks/s, output: 23.26 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:22<00:26, 19.03it/s, est. speed input: 23735.75 toks/s, output: 23.18 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:22<00:25, 19.01it/s, est. speed input: 23656.78 toks/s, output: 23.10 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:23<00:25, 19.00it/s, est. speed input: 23580.50 toks/s, output: 23.03 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:23<00:25, 18.99it/s, est. speed input: 23506.93 toks/s, output: 22.96 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:24<00:24, 18.99it/s, est. speed input: 23435.83 toks/s, output: 22.89 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:24<00:24, 18.98it/s, est. speed input: 23367.27 toks/s, output: 22.82 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:25<00:23, 18.99it/s, est. speed input: 23301.52 toks/s, output: 22.76 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:25<00:23, 18.99it/s, est. speed input: 23237.88 toks/s, output: 22.69 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:25<00:23, 18.99it/s, est. speed input: 23176.40 toks/s, output: 22.63 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:26<00:22, 19.00it/s, est. speed input: 23116.85 toks/s, output: 22.58 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:26<00:22, 19.00it/s, est. speed input: 23059.22 toks/s, output: 22.52 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:27<00:21, 19.00it/s, est. speed input: 23003.52 toks/s, output: 22.46 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:27<00:21, 19.00it/s, est. speed input: 22949.46 toks/s, output: 22.41 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:27<00:20, 19.00it/s, est. speed input: 22897.01 toks/s, output: 22.36 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:28<00:20, 19.00it/s, est. speed input: 22846.15 toks/s, output: 22.31 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:28<00:20, 19.00it/s, est. speed input: 22796.68 toks/s, output: 22.26 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:29<00:19, 19.00it/s, est. speed input: 22748.51 toks/s, output: 22.22 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:29<00:19, 19.00it/s, est. speed input: 22701.86 toks/s, output: 22.17 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:30<00:18, 18.99it/s, est. speed input: 22656.09 toks/s, output: 22.13 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:30<00:18, 19.00it/s, est. speed input: 22612.08 toks/s, output: 22.08 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:30<00:18, 19.00it/s, est. speed input: 22569.13 toks/s, output: 22.04 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:31<00:17, 18.99it/s, est. speed input: 22526.93 toks/s, output: 22.00 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:31<00:17, 18.99it/s, est. speed input: 22485.95 toks/s, output: 21.96 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:32<00:16, 18.99it/s, est. speed input: 22446.09 toks/s, output: 21.92 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:32<00:16, 18.99it/s, est. speed input: 22407.32 toks/s, output: 21.88 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:33<00:15, 18.98it/s, est. speed input: 22369.39 toks/s, output: 21.85 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:33<00:15, 18.98it/s, est. speed input: 22332.29 toks/s, output: 21.81 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:33<00:15, 18.98it/s, est. speed input: 22296.31 toks/s, output: 21.77 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:34<00:14, 18.98it/s, est. speed input: 22261.24 toks/s, output: 21.74 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:34<00:14, 18.99it/s, est. speed input: 22227.14 toks/s, output: 21.71 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:35<00:13, 18.99it/s, est. speed input: 22193.73 toks/s, output: 21.67 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:35<00:13, 18.98it/s, est. speed input: 22161.10 toks/s, output: 21.64 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:36<00:12, 18.99it/s, est. speed input: 22129.31 toks/s, output: 21.61 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:36<00:12, 19.49it/s, est. speed input: 22120.07 toks/s, output: 21.60 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:36<00:11, 19.34it/s, est. speed input: 22089.54 toks/s, output: 21.57 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:37<00:11, 19.23it/s, est. speed input: 22059.54 toks/s, output: 21.54 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:37<00:11, 19.15it/s, est. speed input: 22030.07 toks/s, output: 21.51 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:38<00:10, 19.10it/s, est. speed input: 22001.53 toks/s, output: 21.49 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:38<00:10, 19.06it/s, est. speed input: 21973.27 toks/s, output: 21.46 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:38<00:09, 19.04it/s, est. speed input: 21945.97 toks/s, output: 21.43 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [00:39<00:09, 19.03it/s, est. speed input: 21919.32 toks/s, output: 21.41 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [00:39<00:09, 19.02it/s, est. speed input: 21893.15 toks/s, output: 21.38 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:40<00:08, 19.01it/s, est. speed input: 21867.68 toks/s, output: 21.36 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [00:40<00:08, 19.01it/s, est. speed input: 21842.45 toks/s, output: 21.33 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [00:41<00:07, 19.00it/s, est. speed input: 21817.98 toks/s, output: 21.31 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [00:41<00:07, 19.00it/s, est. speed input: 21793.97 toks/s, output: 21.28 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [00:41<00:07, 19.00it/s, est. speed input: 21770.39 toks/s, output: 21.26 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [00:42<00:06, 19.00it/s, est. speed input: 21747.27 toks/s, output: 21.24 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [00:42<00:06, 18.99it/s, est. speed input: 21724.48 toks/s, output: 21.22 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [00:43<00:05, 19.00it/s, est. speed input: 21702.40 toks/s, output: 21.19 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [00:43<00:05, 18.99it/s, est. speed input: 21680.47 toks/s, output: 21.17 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [00:43<00:04, 18.99it/s, est. speed input: 21658.99 toks/s, output: 21.15 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [00:44<00:04, 18.99it/s, est. speed input: 21637.91 toks/s, output: 21.13 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [00:44<00:04, 18.99it/s, est. speed input: 21617.24 toks/s, output: 21.11 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [00:45<00:03, 18.98it/s, est. speed input: 21596.88 toks/s, output: 21.09 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [00:45<00:03, 18.98it/s, est. speed input: 21576.98 toks/s, output: 21.07 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [00:45<00:00, 40.08it/s, est. speed input: 22158.38 toks/s, output: 21.64 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [00:46<00:00, 33.27it/s, est. speed input: 22133.59 toks/s, output: 21.61 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [00:46<00:00, 28.76it/s, est. speed input: 22109.24 toks/s, output: 21.59 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [00:47<00:00, 26.59it/s, est. speed input: 22106.10 toks/s, output: 21.59 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:47<00:00, 26.59it/s, est. speed input: 22236.26 toks/s, output: 21.72 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:47<00:00, 21.72it/s, est. speed input: 22236.26 toks/s, output: 21.72 toks/s]
[rank0]:[W126 04:26:45.634516468 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 109.3s

测试结果:
  Requests/s:   18.92
  Tokens/s:     19390.86
  Total Reqs:   1024
  Elapsed:      54.13s

  [Prefill 分析]
  Total Prefill Tokens: 1048576
  Prefill Tokens/s:     19371.94

============================================================
[6/8] 测试 M=16384
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 16384
│   M_prefill     = 16384 (= 16 x 1024)
│   M_decode      = 16
│   batched_tokens = 16384 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 2048
│   --max-num-seqs           = 16
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 16384
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 04:27:11 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 04:27:12 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=174613) WARNING 01-26 04:27:18 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=174613) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=174613) WARNING 01-26 04:27:31 [backends.py:609] Failed to read file <frozen os>
Throughput: 12.02 requests/s, 12322.10 total tokens/s, 12.02 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048


─── STDERR ───
[2026-01-26 04:27:11] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 04:27:11] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:27:11] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 04:27:11] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:27:11] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:27:11] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:27:11] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:27:11] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:27:11] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:27:11] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 04:27:11] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 04:27:11] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 04:27:11] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 04:27:11] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 04:27:17] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 04:27:17] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:27:17] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 04:27:17] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:27:17] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:27:17] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:27:17] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:27:17] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:27:17] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:27:17] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 04:27:17] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 04:27:17] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 04:27:17] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 04:27:17] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=174613) [2026-01-26 04:27:19] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=174613) [2026-01-26 04:27:19] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=174613) [2026-01-26 04:27:19] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=174613) [2026-01-26 04:27:19] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=174613) [2026-01-26 04:27:19] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=174613) [2026-01-26 04:27:19] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=174613) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=174613) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.05it/s]
(EngineCore_DP0 pid=174613) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.21s/it]
(EngineCore_DP0 pid=174613) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.17s/it]
(EngineCore_DP0 pid=174613) 
(EngineCore_DP0 pid=174613) [2026-01-26 04:27:22] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=174613) [2026-01-26 04:27:22] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 18579456 bytes
(EngineCore_DP0 pid=174613) [2026-01-26 04:27:22] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=174613) [2026-01-26 04:27:22] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 14450688 bytes
(EngineCore_DP0 pid=174613) [2026-01-26 04:27:22] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=174613) [2026-01-26 04:27:22] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 152764416 bytes
(EngineCore_DP0 pid=174613) [2026-01-26 04:27:22] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=174613) [2026-01-26 04:27:22] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 76382208 bytes
(EngineCore_DP0 pid=174613) [rank0]:W0126 04:27:39.864000 174613 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=174613) [rank0]:W0126 04:27:39.977000 174613 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=174613) [rank0]:W0126 04:27:41.565000 174613 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=174613) [rank0]:W0126 04:27:41.747000 174613 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=174613) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  14%|█▍        | 1/7 [00:00<00:00,  7.89it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  29%|██▊       | 2/7 [00:00<00:00,  8.29it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  43%|████▎     | 3/7 [00:00<00:00,  8.59it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  57%|█████▋    | 4/7 [00:00<00:00,  8.64it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  71%|███████▏  | 5/7 [00:00<00:00,  8.72it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  86%|████████▌ | 6/7 [00:00<00:00,  8.78it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00,  8.12it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00,  8.37it/s]
(EngineCore_DP0 pid=174613) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  20%|██        | 1/5 [00:00<00:00,  7.17it/s]
Capturing CUDA graphs (decode, FULL):  40%|████      | 2/5 [00:00<00:00,  8.35it/s]
Capturing CUDA graphs (decode, FULL):  60%|██████    | 3/5 [00:00<00:00,  8.69it/s]
Capturing CUDA graphs (decode, FULL):  80%|████████  | 4/5 [00:00<00:00,  8.92it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00,  9.06it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00,  8.77it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   1%|          | 24/2048 [00:00<00:08, 235.82it/s]
Adding requests:   2%|▏         | 50/2048 [00:00<00:08, 246.77it/s]
Adding requests:   4%|▍         | 77/2048 [00:00<00:07, 256.63it/s]
Adding requests:   5%|▌         | 103/2048 [00:00<00:07, 255.28it/s]
Adding requests:   6%|▋         | 129/2048 [00:00<00:07, 250.38it/s]
Adding requests:   8%|▊         | 155/2048 [00:00<00:07, 249.88it/s]
Adding requests:   9%|▉         | 181/2048 [00:00<00:07, 251.50it/s]
Adding requests:  10%|█         | 208/2048 [00:00<00:07, 255.10it/s]
Adding requests:  11%|█▏        | 234/2048 [00:00<00:07, 256.25it/s]
Adding requests:  13%|█▎        | 260/2048 [00:01<00:07, 253.30it/s]
Adding requests:  14%|█▍        | 287/2048 [00:01<00:06, 256.10it/s]
Adding requests:  15%|█▌        | 314/2048 [00:01<00:06, 259.33it/s]
Adding requests:  17%|█▋        | 341/2048 [00:01<00:06, 260.94it/s]
Adding requests:  18%|█▊        | 368/2048 [00:01<00:06, 255.62it/s]
Adding requests:  19%|█▉        | 395/2048 [00:01<00:06, 257.18it/s]
Adding requests:  21%|██        | 422/2048 [00:01<00:06, 260.06it/s]
Adding requests:  22%|██▏       | 449/2048 [00:01<00:06, 253.62it/s]
Adding requests:  23%|██▎       | 475/2048 [00:01<00:06, 254.06it/s]
Adding requests:  25%|██▍       | 503/2048 [00:01<00:05, 259.98it/s]
Adding requests:  26%|██▌       | 532/2048 [00:02<00:05, 265.60it/s]
Adding requests:  27%|██▋       | 559/2048 [00:02<00:05, 260.22it/s]
Adding requests:  29%|██▊       | 586/2048 [00:02<00:05, 249.25it/s]
Adding requests:  30%|██▉       | 612/2048 [00:02<00:05, 250.01it/s]
Adding requests:  31%|███       | 639/2048 [00:02<00:05, 253.96it/s]
Adding requests:  32%|███▏      | 665/2048 [00:02<00:05, 251.07it/s]
Adding requests:  34%|███▎      | 691/2048 [00:02<00:05, 251.86it/s]
Adding requests:  35%|███▌      | 717/2048 [00:02<00:05, 251.96it/s]
Adding requests:  36%|███▋      | 743/2048 [00:02<00:05, 249.32it/s]
Adding requests:  38%|███▊      | 768/2048 [00:03<00:05, 248.59it/s]
Adding requests:  39%|███▉      | 794/2048 [00:03<00:05, 250.32it/s]
Adding requests:  40%|████      | 820/2048 [00:03<00:04, 246.68it/s]
Adding requests:  41%|████▏     | 847/2048 [00:03<00:04, 251.41it/s]
Adding requests:  43%|████▎     | 874/2048 [00:03<00:04, 253.66it/s]
Adding requests:  44%|████▍     | 900/2048 [00:03<00:04, 252.45it/s]
Adding requests:  45%|████▌     | 926/2048 [00:03<00:04, 249.47it/s]
Adding requests:  46%|████▋     | 951/2048 [00:03<00:04, 243.27it/s]
Adding requests:  48%|████▊     | 978/2048 [00:03<00:04, 249.98it/s]
Adding requests:  49%|████▉     | 1004/2048 [00:03<00:04, 248.56it/s]
Adding requests:  50%|█████     | 1030/2048 [00:04<00:04, 250.19it/s]
Adding requests:  52%|█████▏    | 1056/2048 [00:04<00:04, 245.93it/s]
Adding requests:  53%|█████▎    | 1082/2048 [00:04<00:03, 249.73it/s]
Adding requests:  54%|█████▍    | 1108/2048 [00:04<00:03, 245.98it/s]
Adding requests:  55%|█████▌    | 1135/2048 [00:04<00:03, 252.75it/s]
Adding requests:  57%|█████▋    | 1161/2048 [00:04<00:03, 245.12it/s]
Adding requests:  58%|█████▊    | 1187/2048 [00:04<00:03, 248.56it/s]
Adding requests:  59%|█████▉    | 1213/2048 [00:04<00:03, 249.39it/s]
Adding requests:  61%|██████    | 1240/2048 [00:04<00:03, 253.14it/s]
Adding requests:  62%|██████▏   | 1266/2048 [00:05<00:03, 248.95it/s]
Adding requests:  63%|██████▎   | 1291/2048 [00:05<00:03, 245.76it/s]
Adding requests:  64%|██████▍   | 1317/2048 [00:05<00:02, 249.28it/s]
Adding requests:  66%|██████▌   | 1342/2048 [00:05<00:02, 247.69it/s]
Adding requests:  67%|██████▋   | 1368/2048 [00:05<00:02, 248.78it/s]
Adding requests:  68%|██████▊   | 1393/2048 [00:05<00:02, 248.28it/s]
Adding requests:  69%|██████▉   | 1418/2048 [00:05<00:02, 245.50it/s]
Adding requests:  71%|███████   | 1445/2048 [00:05<00:02, 251.77it/s]
Adding requests:  72%|███████▏  | 1471/2048 [00:05<00:02, 250.99it/s]
Adding requests:  73%|███████▎  | 1498/2048 [00:05<00:02, 256.41it/s]
Adding requests:  74%|███████▍  | 1525/2048 [00:06<00:02, 259.13it/s]
Adding requests:  76%|███████▌  | 1551/2048 [00:06<00:01, 257.91it/s]
Adding requests:  77%|███████▋  | 1577/2048 [00:06<00:01, 250.65it/s]
Adding requests:  78%|███████▊  | 1603/2048 [00:06<00:01, 252.04it/s]
Adding requests:  80%|███████▉  | 1629/2048 [00:06<00:01, 250.79it/s]
Adding requests:  81%|████████  | 1655/2048 [00:06<00:01, 246.37it/s]
Adding requests:  82%|████████▏ | 1680/2048 [00:06<00:01, 246.20it/s]
Adding requests:  83%|████████▎ | 1706/2048 [00:06<00:01, 249.86it/s]
Adding requests:  85%|████████▍ | 1732/2048 [00:06<00:01, 248.82it/s]
Adding requests:  86%|████████▌ | 1759/2048 [00:06<00:01, 253.22it/s]
Adding requests:  87%|████████▋ | 1787/2048 [00:07<00:01, 257.90it/s]
Adding requests:  89%|████████▊ | 1813/2048 [00:07<00:00, 255.99it/s]
Adding requests:  90%|████████▉ | 1839/2048 [00:07<00:00, 254.87it/s]
Adding requests:  91%|█████████ | 1865/2048 [00:07<00:00, 256.24it/s]
Adding requests:  92%|█████████▏| 1892/2048 [00:07<00:00, 259.09it/s]
Adding requests:  94%|█████████▎| 1919/2048 [00:07<00:00, 258.98it/s]
Adding requests:  95%|█████████▍| 1945/2048 [00:07<00:00, 256.45it/s]
Adding requests:  96%|█████████▌| 1971/2048 [00:07<00:00, 253.70it/s]
Adding requests:  98%|█████████▊| 1997/2048 [00:07<00:00, 251.42it/s]
Adding requests:  99%|█████████▉| 2023/2048 [00:08<00:00, 246.51it/s]
Adding requests: 100%|██████████| 2048/2048 [00:08<00:00, 246.77it/s]
Adding requests: 100%|██████████| 2048/2048 [00:08<00:00, 251.91it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   4%|▍         | 82/2048 [00:00<00:05, 334.10it/s, est. speed input: 342160.64 toks/s, output: 334.11 toks/s]
Processed prompts:   6%|▌         | 116/2048 [00:02<00:59, 32.42it/s, est. speed input: 41057.28 toks/s, output: 40.09 toks/s]  
Processed prompts:   6%|▋         | 131/2048 [00:04<01:20, 23.95it/s, est. speed input: 31804.15 toks/s, output: 31.06 toks/s]
Processed prompts:   7%|▋         | 146/2048 [00:05<01:38, 19.34it/s, est. speed input: 26972.35 toks/s, output: 26.34 toks/s]
Processed prompts:   8%|▊         | 162/2048 [00:06<01:51, 16.85it/s, est. speed input: 24152.35 toks/s, output: 23.59 toks/s]
Processed prompts:   9%|▊         | 178/2048 [00:08<02:02, 15.28it/s, est. speed input: 22243.66 toks/s, output: 21.72 toks/s]
Processed prompts:   9%|▉         | 194/2048 [00:09<02:10, 14.25it/s, est. speed input: 20867.21 toks/s, output: 20.38 toks/s]
Processed prompts:  10%|█         | 210/2048 [00:10<02:15, 13.57it/s, est. speed input: 19826.38 toks/s, output: 19.36 toks/s]
Processed prompts:  11%|█         | 226/2048 [00:12<02:19, 13.10it/s, est. speed input: 19011.80 toks/s, output: 18.57 toks/s]
Processed prompts:  12%|█▏        | 242/2048 [00:13<02:21, 12.78it/s, est. speed input: 18357.01 toks/s, output: 17.93 toks/s]
Processed prompts:  13%|█▎        | 258/2048 [00:14<02:22, 12.56it/s, est. speed input: 17819.41 toks/s, output: 17.40 toks/s]
Processed prompts:  13%|█▎        | 274/2048 [00:16<02:22, 12.41it/s, est. speed input: 17369.75 toks/s, output: 16.96 toks/s]
Processed prompts:  14%|█▍        | 290/2048 [00:17<02:22, 12.30it/s, est. speed input: 16987.95 toks/s, output: 16.59 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [00:18<02:22, 12.21it/s, est. speed input: 16653.31 toks/s, output: 16.26 toks/s]
Processed prompts:  17%|█▋        | 338/2048 [00:20<01:46, 16.04it/s, est. speed input: 17242.54 toks/s, output: 16.84 toks/s]
Processed prompts:  17%|█▋        | 354/2048 [00:21<01:54, 14.82it/s, est. speed input: 16936.83 toks/s, output: 16.54 toks/s]
Processed prompts:  18%|█▊        | 370/2048 [00:22<02:00, 13.98it/s, est. speed input: 16667.17 toks/s, output: 16.28 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [00:24<02:04, 13.39it/s, est. speed input: 16426.95 toks/s, output: 16.04 toks/s]
Processed prompts:  20%|█▉        | 402/2048 [00:25<02:06, 12.98it/s, est. speed input: 16211.80 toks/s, output: 15.83 toks/s]
Processed prompts:  20%|██        | 418/2048 [00:26<02:08, 12.69it/s, est. speed input: 16017.77 toks/s, output: 15.64 toks/s]
Processed prompts:  21%|██        | 434/2048 [00:28<02:09, 12.49it/s, est. speed input: 15841.91 toks/s, output: 15.47 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [00:29<02:09, 12.35it/s, est. speed input: 15682.00 toks/s, output: 15.31 toks/s]
Processed prompts:  23%|██▎       | 466/2048 [00:30<02:09, 12.25it/s, est. speed input: 15535.85 toks/s, output: 15.17 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [00:32<02:08, 12.18it/s, est. speed input: 15401.76 toks/s, output: 15.04 toks/s]
Processed prompts:  24%|██▍       | 498/2048 [00:33<02:07, 12.13it/s, est. speed input: 15278.26 toks/s, output: 14.92 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [00:34<02:06, 12.10it/s, est. speed input: 15164.22 toks/s, output: 14.81 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [00:36<02:05, 12.07it/s, est. speed input: 15058.17 toks/s, output: 14.71 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [00:37<02:04, 12.05it/s, est. speed input: 14959.94 toks/s, output: 14.61 toks/s]
Processed prompts:  27%|██▋       | 562/2048 [00:38<02:03, 12.04it/s, est. speed input: 14868.29 toks/s, output: 14.52 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [00:40<02:02, 12.03it/s, est. speed input: 14782.60 toks/s, output: 14.44 toks/s]
Processed prompts:  29%|██▉       | 594/2048 [00:41<02:00, 12.02it/s, est. speed input: 14702.38 toks/s, output: 14.36 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [00:42<01:59, 12.02it/s, est. speed input: 14627.29 toks/s, output: 14.28 toks/s]
Processed prompts:  31%|███       | 626/2048 [00:44<01:58, 12.01it/s, est. speed input: 14556.56 toks/s, output: 14.22 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [00:45<01:57, 12.01it/s, est. speed input: 14490.04 toks/s, output: 14.15 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [00:46<01:55, 12.01it/s, est. speed input: 14427.32 toks/s, output: 14.09 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [00:48<01:54, 12.01it/s, est. speed input: 14368.03 toks/s, output: 14.03 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [00:49<01:53, 12.01it/s, est. speed input: 14311.89 toks/s, output: 13.98 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [00:50<01:51, 12.01it/s, est. speed input: 14258.84 toks/s, output: 13.92 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [00:51<01:22, 15.85it/s, est. speed input: 14542.08 toks/s, output: 14.20 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [00:53<01:28, 14.68it/s, est. speed input: 14485.63 toks/s, output: 14.15 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [00:54<01:32, 13.87it/s, est. speed input: 14432.04 toks/s, output: 14.09 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [00:55<01:30, 13.96it/s, est. speed input: 14434.41 toks/s, output: 14.10 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [00:57<01:33, 13.35it/s, est. speed input: 14384.12 toks/s, output: 14.05 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [00:58<01:35, 12.93it/s, est. speed input: 14336.33 toks/s, output: 14.00 toks/s]
Processed prompts:  41%|████      | 834/2048 [00:59<01:35, 12.65it/s, est. speed input: 14290.58 toks/s, output: 13.96 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [01:01<01:36, 12.45it/s, est. speed input: 14246.75 toks/s, output: 13.91 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [01:02<01:35, 12.31it/s, est. speed input: 14204.90 toks/s, output: 13.87 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [01:03<01:35, 12.22it/s, est. speed input: 14164.66 toks/s, output: 13.83 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [01:05<01:34, 12.15it/s, est. speed input: 14126.10 toks/s, output: 13.80 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [01:06<01:33, 12.10it/s, est. speed input: 14089.08 toks/s, output: 13.76 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [01:07<01:32, 12.07it/s, est. speed input: 14053.53 toks/s, output: 13.72 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [01:09<01:31, 12.05it/s, est. speed input: 14019.33 toks/s, output: 13.69 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [01:10<01:30, 12.03it/s, est. speed input: 13986.41 toks/s, output: 13.66 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [01:11<01:29, 12.02it/s, est. speed input: 13954.72 toks/s, output: 13.63 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [01:13<01:27, 12.01it/s, est. speed input: 13924.17 toks/s, output: 13.60 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [01:14<01:26, 12.01it/s, est. speed input: 13894.77 toks/s, output: 13.57 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [01:15<01:25, 12.00it/s, est. speed input: 13866.24 toks/s, output: 13.54 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [01:17<01:23, 12.00it/s, est. speed input: 13838.75 toks/s, output: 13.51 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [01:18<01:22, 12.00it/s, est. speed input: 13812.23 toks/s, output: 13.49 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [01:19<01:21, 11.99it/s, est. speed input: 13786.58 toks/s, output: 13.46 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [01:21<01:19, 11.99it/s, est. speed input: 13761.86 toks/s, output: 13.44 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [01:22<00:58, 15.82it/s, est. speed input: 13947.35 toks/s, output: 13.62 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [01:23<01:02, 14.66it/s, est. speed input: 13920.71 toks/s, output: 13.59 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [01:25<01:04, 13.85it/s, est. speed input: 13894.95 toks/s, output: 13.57 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [01:26<01:06, 13.29it/s, est. speed input: 13870.07 toks/s, output: 13.54 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [01:27<01:06, 12.90it/s, est. speed input: 13845.77 toks/s, output: 13.52 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [01:29<01:06, 12.63it/s, est. speed input: 13822.36 toks/s, output: 13.50 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [01:30<01:06, 12.43it/s, est. speed input: 13799.40 toks/s, output: 13.48 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [01:31<01:06, 12.30it/s, est. speed input: 13777.17 toks/s, output: 13.45 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [01:33<01:05, 12.21it/s, est. speed input: 13755.66 toks/s, output: 13.43 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [01:34<01:04, 12.14it/s, est. speed input: 13734.76 toks/s, output: 13.41 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [01:35<01:03, 12.09it/s, est. speed input: 13714.42 toks/s, output: 13.39 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [01:37<01:02, 12.06it/s, est. speed input: 13694.63 toks/s, output: 13.37 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [01:38<01:00, 12.04it/s, est. speed input: 13675.35 toks/s, output: 13.35 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [01:39<00:59, 12.02it/s, est. speed input: 13656.60 toks/s, output: 13.34 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [01:41<00:58, 12.01it/s, est. speed input: 13638.35 toks/s, output: 13.32 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [01:42<00:57, 12.00it/s, est. speed input: 13620.49 toks/s, output: 13.30 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [01:43<00:55, 12.00it/s, est. speed input: 13603.17 toks/s, output: 13.28 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [01:45<00:54, 11.99it/s, est. speed input: 13586.27 toks/s, output: 13.27 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [01:46<00:53, 11.99it/s, est. speed input: 13569.81 toks/s, output: 13.25 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [01:47<00:51, 11.99it/s, est. speed input: 13553.81 toks/s, output: 13.24 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [01:49<00:50, 11.99it/s, est. speed input: 13538.14 toks/s, output: 13.22 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [01:50<00:49, 11.99it/s, est. speed input: 13522.86 toks/s, output: 13.21 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [01:51<00:47, 11.99it/s, est. speed input: 13507.96 toks/s, output: 13.19 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [01:53<00:34, 15.83it/s, est. speed input: 13646.73 toks/s, output: 13.33 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [01:54<00:35, 14.67it/s, est. speed input: 13630.84 toks/s, output: 13.31 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [01:55<00:36, 13.86it/s, est. speed input: 13615.37 toks/s, output: 13.30 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [01:57<00:37, 13.30it/s, est. speed input: 13600.14 toks/s, output: 13.28 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [01:58<00:37, 12.91it/s, est. speed input: 13585.29 toks/s, output: 13.27 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [01:59<00:36, 12.63it/s, est. speed input: 13570.83 toks/s, output: 13.25 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [02:01<00:35, 12.44it/s, est. speed input: 13556.56 toks/s, output: 13.24 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [02:02<00:33, 12.91it/s, est. speed input: 13565.56 toks/s, output: 13.25 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [02:03<00:32, 12.62it/s, est. speed input: 13551.46 toks/s, output: 13.23 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [02:04<00:32, 12.42it/s, est. speed input: 13537.71 toks/s, output: 13.22 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [02:06<00:31, 12.29it/s, est. speed input: 13524.24 toks/s, output: 13.21 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [02:07<00:30, 12.19it/s, est. speed input: 13511.06 toks/s, output: 13.19 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [02:08<00:28, 12.13it/s, est. speed input: 13498.14 toks/s, output: 13.18 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [02:10<00:27, 12.08it/s, est. speed input: 13485.36 toks/s, output: 13.17 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [02:11<00:26, 12.05it/s, est. speed input: 13472.87 toks/s, output: 13.16 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [02:12<00:25, 12.02it/s, est. speed input: 13460.59 toks/s, output: 13.15 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [02:14<00:23, 12.00it/s, est. speed input: 13448.55 toks/s, output: 13.13 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [02:15<00:22, 11.99it/s, est. speed input: 13436.71 toks/s, output: 13.12 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [02:16<00:21, 11.99it/s, est. speed input: 13425.22 toks/s, output: 13.11 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [02:18<00:19, 11.99it/s, est. speed input: 13414.06 toks/s, output: 13.10 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [02:19<00:18, 11.98it/s, est. speed input: 13403.10 toks/s, output: 13.09 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [02:20<00:17, 11.98it/s, est. speed input: 13392.39 toks/s, output: 13.08 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [02:22<00:15, 11.98it/s, est. speed input: 13381.86 toks/s, output: 13.07 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [02:23<00:14, 11.98it/s, est. speed input: 13371.53 toks/s, output: 13.06 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [02:24<00:08, 15.87it/s, est. speed input: 13482.01 toks/s, output: 13.17 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [02:26<00:08, 14.71it/s, est. speed input: 13471.49 toks/s, output: 13.16 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [02:27<00:07, 13.90it/s, est. speed input: 13461.13 toks/s, output: 13.15 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [02:28<00:07, 13.34it/s, est. speed input: 13450.99 toks/s, output: 13.14 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [02:30<00:06, 12.95it/s, est. speed input: 13441.00 toks/s, output: 13.13 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [02:31<00:04, 12.67it/s, est. speed input: 13431.21 toks/s, output: 13.12 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [02:32<00:03, 12.47it/s, est. speed input: 13421.34 toks/s, output: 13.11 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [02:34<00:02, 12.30it/s, est. speed input: 13410.69 toks/s, output: 13.10 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [02:35<00:01, 12.82it/s, est. speed input: 13419.10 toks/s, output: 13.10 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [02:35<00:00, 12.82it/s, est. speed input: 13511.43 toks/s, output: 13.19 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [02:35<00:00, 13.19it/s, est. speed input: 13511.43 toks/s, output: 13.19 toks/s]
[rank0]:[W126 04:30:32.817553734 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 227.3s

测试结果:
  Requests/s:   12.02
  Tokens/s:     12322.10
  Total Reqs:   2048
  Elapsed:      170.36s

  [Prefill 分析]
  Total Prefill Tokens: 2097152
  Prefill Tokens/s:     12310.08

============================================================
[7/8] 测试 M=32768
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 32768
│   M_prefill     = 32768 (= 32 x 1024)
│   M_decode      = 32
│   batched_tokens = 32768 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 4096
│   --max-num-seqs           = 32
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 32768
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 04:31:11 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 04:31:12 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=178350) WARNING 01-26 04:31:20 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=178350) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=178350) WARNING 01-26 04:31:31 [backends.py:609] Failed to read file <frozen os>
Throughput: 5.33 requests/s, 5466.83 total tokens/s, 5.33 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096


─── STDERR ───
[2026-01-26 04:31:11] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 04:31:11] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:31:11] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 04:31:11] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:31:11] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:31:11] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:31:11] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:31:11] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:31:11] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:31:11] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 04:31:11] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 04:31:11] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 04:31:11] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 04:31:11] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 04:31:19] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 04:31:19] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:31:19] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 04:31:19] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:31:19] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:31:19] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:31:19] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:31:19] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:31:19] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:31:19] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 04:31:19] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 04:31:19] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 04:31:19] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 04:31:19] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=178350) [2026-01-26 04:31:20] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=178350) [2026-01-26 04:31:20] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=178350) [2026-01-26 04:31:20] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=178350) [2026-01-26 04:31:20] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=178350) [2026-01-26 04:31:20] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=178350) [2026-01-26 04:31:20] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=178350) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=178350) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.06it/s]
(EngineCore_DP0 pid=178350) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  2.20it/s]
(EngineCore_DP0 pid=178350) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.89it/s]
(EngineCore_DP0 pid=178350) 
(EngineCore_DP0 pid=178350) [2026-01-26 04:31:22] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=178350) [2026-01-26 04:31:22] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 18579456 bytes
(EngineCore_DP0 pid=178350) [2026-01-26 04:31:22] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=178350) [2026-01-26 04:31:22] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 14450688 bytes
(EngineCore_DP0 pid=178350) [2026-01-26 04:31:22] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=178350) [2026-01-26 04:31:22] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 152764416 bytes
(EngineCore_DP0 pid=178350) [2026-01-26 04:31:22] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=178350) [2026-01-26 04:31:22] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 76382208 bytes
(EngineCore_DP0 pid=178350) [rank0]:W0126 04:31:39.980000 178350 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=178350) [rank0]:W0126 04:31:40.089000 178350 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=178350) [rank0]:W0126 04:31:41.585000 178350 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=178350) [rank0]:W0126 04:31:41.759000 178350 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=178350) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   9%|▉         | 1/11 [00:00<00:01,  7.92it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  18%|█▊        | 2/11 [00:00<00:01,  8.31it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  27%|██▋       | 3/11 [00:00<00:00,  8.49it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  36%|███▋      | 4/11 [00:00<00:00,  8.73it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  45%|████▌     | 5/11 [00:00<00:00,  8.75it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  55%|█████▍    | 6/11 [00:00<00:00,  8.52it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  64%|██████▎   | 7/11 [00:00<00:00,  6.23it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  73%|███████▎  | 8/11 [00:01<00:00,  6.67it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  82%|████████▏ | 9/11 [00:01<00:00,  6.11it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  91%|█████████ | 10/11 [00:01<00:00,  6.73it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00,  6.84it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00,  7.19it/s]
(EngineCore_DP0 pid=178350) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  14%|█▍        | 1/7 [00:00<00:00,  7.17it/s]
Capturing CUDA graphs (decode, FULL):  29%|██▊       | 2/7 [00:00<00:00,  7.82it/s]
Capturing CUDA graphs (decode, FULL):  43%|████▎     | 3/7 [00:00<00:00,  8.34it/s]
Capturing CUDA graphs (decode, FULL):  57%|█████▋    | 4/7 [00:00<00:00,  8.68it/s]
Capturing CUDA graphs (decode, FULL):  71%|███████▏  | 5/7 [00:00<00:00,  8.88it/s]
Capturing CUDA graphs (decode, FULL):  86%|████████▌ | 6/7 [00:00<00:00,  8.99it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00,  9.03it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00,  8.71it/s]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   0%|          | 20/4096 [00:00<00:20, 199.36it/s]
Adding requests:   1%|          | 43/4096 [00:00<00:18, 217.26it/s]
Adding requests:   2%|▏         | 69/4096 [00:00<00:17, 235.61it/s]
Adding requests:   2%|▏         | 93/4096 [00:00<00:17, 232.01it/s]
Adding requests:   3%|▎         | 118/4096 [00:00<00:16, 237.93it/s]
Adding requests:   3%|▎         | 143/4096 [00:00<00:16, 239.75it/s]
Adding requests:   4%|▍         | 169/4096 [00:00<00:16, 243.19it/s]
Adding requests:   5%|▍         | 194/4096 [00:00<00:16, 234.31it/s]
Adding requests:   5%|▌         | 219/4096 [00:00<00:16, 236.71it/s]
Adding requests:   6%|▌         | 244/4096 [00:01<00:16, 238.76it/s]
Adding requests:   7%|▋         | 269/4096 [00:01<00:15, 241.91it/s]
Adding requests:   7%|▋         | 294/4096 [00:01<00:16, 229.18it/s]
Adding requests:   8%|▊         | 320/4096 [00:01<00:15, 236.68it/s]
Adding requests:   8%|▊         | 348/4096 [00:01<00:15, 246.31it/s]
Adding requests:   9%|▉         | 376/4096 [00:01<00:14, 254.28it/s]
Adding requests:  10%|▉         | 402/4096 [00:01<00:15, 245.41it/s]
Adding requests:  10%|█         | 427/4096 [00:01<00:14, 245.64it/s]
Adding requests:  11%|█         | 454/4096 [00:01<00:14, 250.98it/s]
Adding requests:  12%|█▏        | 482/4096 [00:01<00:14, 256.50it/s]
Adding requests:  12%|█▏        | 508/4096 [00:02<00:14, 242.23it/s]
Adding requests:  13%|█▎        | 535/4096 [00:02<00:14, 247.07it/s]
Adding requests:  14%|█▍        | 564/4096 [00:02<00:13, 257.83it/s]
Adding requests:  14%|█▍        | 590/4096 [00:02<00:13, 255.70it/s]
Adding requests:  15%|█▌        | 616/4096 [00:02<00:14, 242.26it/s]
Adding requests:  24%|██▍       | 978/4096 [00:02<00:02, 1181.71it/s]
Adding requests:  27%|██▋       | 1102/4096 [00:03<00:05, 548.77it/s]
Adding requests:  29%|██▉       | 1196/4096 [00:03<00:06, 422.21it/s]
Adding requests:  31%|███       | 1269/4096 [00:03<00:07, 361.20it/s]
Adding requests:  32%|███▏      | 1328/4096 [00:04<00:08, 329.31it/s]
Adding requests:  34%|███▎      | 1376/4096 [00:04<00:08, 308.74it/s]
Adding requests:  35%|███▍      | 1417/4096 [00:04<00:09, 292.92it/s]
Adding requests:  35%|███▌      | 1453/4096 [00:04<00:09, 278.26it/s]
Adding requests:  36%|███▋      | 1485/4096 [00:04<00:09, 275.34it/s]
Adding requests:  37%|███▋      | 1516/4096 [00:04<00:09, 274.31it/s]
Adding requests:  38%|███▊      | 1546/4096 [00:04<00:09, 259.79it/s]
Adding requests:  38%|███▊      | 1574/4096 [00:05<00:10, 251.50it/s]
Adding requests:  39%|███▉      | 1600/4096 [00:05<00:09, 249.76it/s]
Adding requests:  40%|███▉      | 1626/4096 [00:05<00:09, 247.12it/s]
Adding requests:  40%|████      | 1651/4096 [00:05<00:10, 234.64it/s]
Adding requests:  41%|████      | 1675/4096 [00:05<00:10, 231.65it/s]
Adding requests:  42%|████▏     | 1703/4096 [00:05<00:09, 241.86it/s]
Adding requests:  42%|████▏     | 1730/4096 [00:05<00:09, 247.24it/s]
Adding requests:  43%|████▎     | 1755/4096 [00:05<00:09, 240.35it/s]
Adding requests:  43%|████▎     | 1781/4096 [00:05<00:09, 245.62it/s]
Adding requests:  44%|████▍     | 1807/4096 [00:06<00:09, 248.47it/s]
Adding requests:  45%|████▍     | 1834/4096 [00:06<00:08, 253.97it/s]
Adding requests:  45%|████▌     | 1860/4096 [00:06<00:09, 243.37it/s]
Adding requests:  46%|████▌     | 1886/4096 [00:06<00:08, 246.82it/s]
Adding requests:  47%|████▋     | 1912/4096 [00:06<00:08, 249.46it/s]
Adding requests:  47%|████▋     | 1940/4096 [00:06<00:08, 258.01it/s]
Adding requests:  48%|████▊     | 1966/4096 [00:06<00:08, 245.31it/s]
Adding requests:  49%|████▊     | 1991/4096 [00:06<00:08, 242.96it/s]
Adding requests:  49%|████▉     | 2016/4096 [00:06<00:08, 240.45it/s]
Adding requests:  50%|████▉     | 2041/4096 [00:07<00:08, 242.18it/s]
Adding requests:  50%|█████     | 2066/4096 [00:07<00:09, 223.44it/s]
Adding requests:  51%|█████     | 2089/4096 [00:07<00:08, 223.86it/s]
Adding requests:  52%|█████▏    | 2117/4096 [00:07<00:08, 237.80it/s]
Adding requests:  52%|█████▏    | 2142/4096 [00:07<00:08, 235.22it/s]
Adding requests:  53%|█████▎    | 2166/4096 [00:07<00:08, 221.64it/s]
Adding requests:  53%|█████▎    | 2190/4096 [00:07<00:08, 226.59it/s]
Adding requests:  54%|█████▍    | 2215/4096 [00:07<00:08, 232.06it/s]
Adding requests:  55%|█████▍    | 2240/4096 [00:07<00:07, 235.77it/s]
Adding requests:  55%|█████▌    | 2264/4096 [00:08<00:08, 227.79it/s]
Adding requests:  56%|█████▌    | 2291/4096 [00:08<00:07, 238.35it/s]
Adding requests:  57%|█████▋    | 2317/4096 [00:08<00:07, 243.47it/s]
Adding requests:  57%|█████▋    | 2344/4096 [00:08<00:06, 250.96it/s]
Adding requests:  58%|█████▊    | 2370/4096 [00:08<00:07, 235.32it/s]
Adding requests:  59%|█████▊    | 2397/4096 [00:08<00:06, 244.94it/s]
Adding requests:  59%|█████▉    | 2424/4096 [00:08<00:06, 251.55it/s]
Adding requests:  60%|█████▉    | 2450/4096 [00:08<00:06, 241.22it/s]
Adding requests:  60%|██████    | 2475/4096 [00:08<00:06, 233.35it/s]
Adding requests:  61%|██████    | 2502/4096 [00:08<00:06, 243.50it/s]
Adding requests:  62%|██████▏   | 2531/4096 [00:09<00:06, 255.26it/s]
Adding requests:  62%|██████▎   | 2560/4096 [00:09<00:05, 263.35it/s]
Adding requests:  63%|██████▎   | 2587/4096 [00:09<00:05, 255.01it/s]
Adding requests:  64%|██████▍   | 2613/4096 [00:09<00:05, 254.97it/s]
Adding requests:  64%|██████▍   | 2639/4096 [00:09<00:05, 254.42it/s]
Adding requests:  65%|██████▌   | 2666/4096 [00:09<00:05, 258.19it/s]
Adding requests:  66%|██████▌   | 2692/4096 [00:09<00:05, 243.97it/s]
Adding requests:  66%|██████▋   | 2717/4096 [00:09<00:05, 244.78it/s]
Adding requests:  67%|██████▋   | 2745/4096 [00:09<00:05, 252.24it/s]
Adding requests:  68%|██████▊   | 2773/4096 [00:10<00:05, 256.41it/s]
Adding requests:  68%|██████▊   | 2799/4096 [00:10<00:05, 249.89it/s]
Adding requests:  69%|██████▉   | 2825/4096 [00:10<00:05, 251.58it/s]
Adding requests:  70%|██████▉   | 2852/4096 [00:10<00:04, 256.57it/s]
Adding requests:  70%|███████   | 2879/4096 [00:10<00:04, 260.06it/s]
Adding requests:  71%|███████   | 2906/4096 [00:10<00:04, 245.00it/s]
Adding requests:  72%|███████▏  | 2931/4096 [00:10<00:04, 244.19it/s]
Adding requests:  72%|███████▏  | 2959/4096 [00:10<00:04, 253.77it/s]
Adding requests:  73%|███████▎  | 2985/4096 [00:10<00:04, 251.40it/s]
Adding requests:  74%|███████▎  | 3011/4096 [00:11<00:04, 241.94it/s]
Adding requests:  74%|███████▍  | 3037/4096 [00:11<00:04, 244.27it/s]
Adding requests:  75%|███████▍  | 3064/4096 [00:11<00:04, 250.93it/s]
Adding requests:  75%|███████▌  | 3091/4096 [00:11<00:03, 254.27it/s]
Adding requests:  76%|███████▌  | 3117/4096 [00:11<00:03, 245.33it/s]
Adding requests:  77%|███████▋  | 3142/4096 [00:11<00:03, 242.48it/s]
Adding requests:  77%|███████▋  | 3168/4096 [00:11<00:03, 247.23it/s]
Adding requests:  78%|███████▊  | 3195/4096 [00:11<00:03, 253.81it/s]
Adding requests:  79%|███████▊  | 3221/4096 [00:11<00:03, 247.50it/s]
Adding requests:  79%|███████▉  | 3246/4096 [00:11<00:03, 245.78it/s]
Adding requests:  80%|███████▉  | 3273/4096 [00:12<00:03, 252.01it/s]
Adding requests:  81%|████████  | 3299/4096 [00:12<00:03, 247.05it/s]
Adding requests:  81%|████████  | 3324/4096 [00:12<00:03, 239.73it/s]
Adding requests:  82%|████████▏ | 3349/4096 [00:12<00:03, 238.97it/s]
Adding requests:  82%|████████▏ | 3377/4096 [00:12<00:02, 250.14it/s]
Adding requests:  83%|████████▎ | 3405/4096 [00:12<00:02, 257.23it/s]
Adding requests:  84%|████████▍ | 3431/4096 [00:12<00:02, 245.69it/s]
Adding requests:  84%|████████▍ | 3456/4096 [00:12<00:02, 245.40it/s]
Adding requests:  85%|████████▌ | 3482/4096 [00:12<00:02, 249.19it/s]
Adding requests:  86%|████████▌ | 3511/4096 [00:13<00:02, 259.16it/s]
Adding requests:  86%|████████▋ | 3537/4096 [00:13<00:02, 258.66it/s]
Adding requests:  87%|████████▋ | 3563/4096 [00:13<00:02, 254.55it/s]
Adding requests:  88%|████████▊ | 3589/4096 [00:13<00:01, 255.03it/s]
Adding requests:  88%|████████▊ | 3616/4096 [00:13<00:01, 258.79it/s]
Adding requests:  89%|████████▉ | 3642/4096 [00:13<00:01, 257.05it/s]
Adding requests:  90%|████████▉ | 3668/4096 [00:13<00:01, 245.77it/s]
Adding requests:  90%|█████████ | 3694/4096 [00:13<00:01, 248.43it/s]
Adding requests:  91%|█████████ | 3720/4096 [00:13<00:01, 247.78it/s]
Adding requests:  91%|█████████▏| 3745/4096 [00:13<00:01, 233.09it/s]
Adding requests:  92%|█████████▏| 3769/4096 [00:14<00:01, 225.93it/s]
Adding requests:  93%|█████████▎| 3792/4096 [00:14<00:01, 224.11it/s]
Adding requests:  93%|█████████▎| 3816/4096 [00:14<00:01, 228.37it/s]
Adding requests:  94%|█████████▎| 3839/4096 [00:14<00:01, 219.20it/s]
Adding requests:  94%|█████████▍| 3862/4096 [00:14<00:01, 217.73it/s]
Adding requests:  95%|█████████▍| 3889/4096 [00:14<00:00, 229.57it/s]
Adding requests:  96%|█████████▌| 3913/4096 [00:14<00:00, 230.97it/s]
Adding requests:  96%|█████████▌| 3937/4096 [00:14<00:00, 228.31it/s]
Adding requests:  97%|█████████▋| 3961/4096 [00:14<00:00, 229.10it/s]
Adding requests:  97%|█████████▋| 3987/4096 [00:15<00:00, 237.27it/s]
Adding requests:  98%|█████████▊| 4014/4096 [00:15<00:00, 244.60it/s]
Adding requests:  99%|█████████▊| 4039/4096 [00:15<00:00, 240.46it/s]
Adding requests:  99%|█████████▉| 4064/4096 [00:15<00:00, 232.20it/s]
Adding requests: 100%|█████████▉| 4089/4096 [00:15<00:00, 236.92it/s]
Adding requests: 100%|██████████| 4096/4096 [00:15<00:00, 264.48it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 66/4096 [00:01<01:46, 37.71it/s, est. speed input: 38620.48 toks/s, output: 37.71 toks/s]
Processed prompts:   2%|▏         | 98/4096 [00:07<06:09, 10.82it/s, est. speed input: 12940.52 toks/s, output: 12.64 toks/s]
Processed prompts:   3%|▎         | 130/4096 [00:13<08:25,  7.84it/s, est. speed input: 9675.06 toks/s, output: 9.45 toks/s] 
Processed prompts:   4%|▍         | 162/4096 [00:18<08:44,  7.50it/s, est. speed input: 9030.50 toks/s, output: 8.82 toks/s]
Processed prompts:   5%|▍         | 194/4096 [00:24<09:50,  6.61it/s, est. speed input: 8150.44 toks/s, output: 7.96 toks/s]
Processed prompts:   6%|▌         | 226/4096 [00:30<10:30,  6.14it/s, est. speed input: 7617.78 toks/s, output: 7.44 toks/s]
Processed prompts:   6%|▋         | 258/4096 [00:36<10:55,  5.86it/s, est. speed input: 7261.12 toks/s, output: 7.09 toks/s]
Processed prompts:   7%|▋         | 290/4096 [00:42<11:09,  5.68it/s, est. speed input: 7004.50 toks/s, output: 6.84 toks/s]
Processed prompts:   8%|▊         | 322/4096 [00:48<11:17,  5.57it/s, est. speed input: 6811.94 toks/s, output: 6.65 toks/s]
Processed prompts:   9%|▊         | 354/4096 [00:53<10:31,  5.92it/s, est. speed input: 6836.89 toks/s, output: 6.68 toks/s]
Processed prompts:   9%|▉         | 386/4096 [00:59<10:47,  5.73it/s, est. speed input: 6695.86 toks/s, output: 6.54 toks/s]
Processed prompts:  10%|█         | 418/4096 [01:05<10:56,  5.60it/s, est. speed input: 6580.80 toks/s, output: 6.43 toks/s]
Processed prompts:  11%|█         | 450/4096 [01:11<11:01,  5.51it/s, est. speed input: 6485.39 toks/s, output: 6.33 toks/s]
Processed prompts:  12%|█▏        | 482/4096 [01:17<11:02,  5.46it/s, est. speed input: 6404.89 toks/s, output: 6.25 toks/s]
Processed prompts:  13%|█▎        | 514/4096 [01:21<10:14,  5.83it/s, est. speed input: 6444.01 toks/s, output: 6.29 toks/s]
Processed prompts:  13%|█▎        | 546/4096 [01:27<10:26,  5.67it/s, est. speed input: 6376.12 toks/s, output: 6.23 toks/s]
Processed prompts:  14%|█▍        | 578/4096 [01:33<10:32,  5.56it/s, est. speed input: 6316.88 toks/s, output: 6.17 toks/s]
Processed prompts:  15%|█▍        | 610/4096 [01:39<10:35,  5.49it/s, est. speed input: 6264.84 toks/s, output: 6.12 toks/s]
Processed prompts:  16%|█▌        | 642/4096 [01:45<10:35,  5.44it/s, est. speed input: 6218.62 toks/s, output: 6.07 toks/s]
Processed prompts:  16%|█▋        | 674/4096 [01:50<09:48,  5.81it/s, est. speed input: 6255.63 toks/s, output: 6.11 toks/s]
Processed prompts:  17%|█▋        | 706/4096 [01:56<09:58,  5.66it/s, est. speed input: 6214.38 toks/s, output: 6.07 toks/s]
Processed prompts:  18%|█▊        | 738/4096 [02:02<10:04,  5.55it/s, est. speed input: 6176.96 toks/s, output: 6.03 toks/s]
Processed prompts:  19%|█▉        | 770/4096 [02:08<10:00,  5.54it/s, est. speed input: 6152.97 toks/s, output: 6.01 toks/s]
Processed prompts:  20%|█▉        | 802/4096 [02:14<10:01,  5.47it/s, est. speed input: 6121.42 toks/s, output: 5.98 toks/s]
Processed prompts:  20%|██        | 834/4096 [02:20<10:00,  5.43it/s, est. speed input: 6092.62 toks/s, output: 5.95 toks/s]
Processed prompts:  21%|██        | 866/4096 [02:24<09:16,  5.81it/s, est. speed input: 6124.92 toks/s, output: 5.98 toks/s]
Processed prompts:  22%|██▏       | 898/4096 [02:30<09:25,  5.66it/s, est. speed input: 6098.50 toks/s, output: 5.96 toks/s]
Processed prompts:  23%|██▎       | 930/4096 [02:36<09:30,  5.55it/s, est. speed input: 6073.25 toks/s, output: 5.93 toks/s]
Processed prompts:  23%|██▎       | 962/4096 [02:42<09:32,  5.48it/s, est. speed input: 6049.81 toks/s, output: 5.91 toks/s]
Processed prompts:  24%|██▍       | 994/4096 [02:48<09:31,  5.43it/s, est. speed input: 6028.15 toks/s, output: 5.89 toks/s]
Processed prompts:  25%|██▌       | 1026/4096 [02:54<09:28,  5.40it/s, est. speed input: 6008.37 toks/s, output: 5.87 toks/s]
Processed prompts:  26%|██▌       | 1058/4096 [03:00<09:22,  5.41it/s, est. speed input: 5993.67 toks/s, output: 5.85 toks/s]
Processed prompts:  27%|██▋       | 1090/4096 [03:06<09:17,  5.39it/s, est. speed input: 5977.40 toks/s, output: 5.84 toks/s]
Processed prompts:  27%|██▋       | 1122/4096 [03:11<08:26,  5.88it/s, est. speed input: 6014.34 toks/s, output: 5.87 toks/s]
Processed prompts:  28%|██▊       | 1154/4096 [03:17<08:36,  5.70it/s, est. speed input: 5997.42 toks/s, output: 5.86 toks/s]
Processed prompts:  29%|██▉       | 1186/4096 [03:23<08:41,  5.58it/s, est. speed input: 5981.47 toks/s, output: 5.84 toks/s]
Processed prompts:  30%|██▉       | 1218/4096 [03:29<08:42,  5.51it/s, est. speed input: 5966.43 toks/s, output: 5.83 toks/s]
Processed prompts:  31%|███       | 1250/4096 [03:35<08:42,  5.45it/s, est. speed input: 5952.14 toks/s, output: 5.81 toks/s]
Processed prompts:  31%|███▏      | 1282/4096 [03:39<07:57,  5.90it/s, est. speed input: 5982.52 toks/s, output: 5.84 toks/s]
Processed prompts:  32%|███▏      | 1314/4096 [03:45<08:06,  5.72it/s, est. speed input: 5969.17 toks/s, output: 5.83 toks/s]
Processed prompts:  33%|███▎      | 1346/4096 [03:51<08:11,  5.60it/s, est. speed input: 5955.97 toks/s, output: 5.82 toks/s]
Processed prompts:  34%|███▎      | 1378/4096 [03:57<08:12,  5.52it/s, est. speed input: 5943.38 toks/s, output: 5.80 toks/s]
Processed prompts:  34%|███▍      | 1410/4096 [04:03<08:12,  5.46it/s, est. speed input: 5931.42 toks/s, output: 5.79 toks/s]
Processed prompts:  35%|███▌      | 1442/4096 [04:09<08:09,  5.42it/s, est. speed input: 5920.06 toks/s, output: 5.78 toks/s]
Processed prompts:  36%|███▌      | 1474/4096 [04:14<07:33,  5.78it/s, est. speed input: 5940.11 toks/s, output: 5.80 toks/s]
Processed prompts:  37%|███▋      | 1506/4096 [04:20<07:39,  5.64it/s, est. speed input: 5928.96 toks/s, output: 5.79 toks/s]
Processed prompts:  38%|███▊      | 1538/4096 [04:26<07:41,  5.54it/s, est. speed input: 5918.30 toks/s, output: 5.78 toks/s]
Processed prompts:  38%|███▊      | 1570/4096 [04:32<07:41,  5.48it/s, est. speed input: 5908.09 toks/s, output: 5.77 toks/s]
Processed prompts:  39%|███▉      | 1602/4096 [04:37<07:34,  5.49it/s, est. speed input: 5902.76 toks/s, output: 5.76 toks/s]
Processed prompts:  40%|███▉      | 1634/4096 [04:42<07:01,  5.85it/s, est. speed input: 5921.82 toks/s, output: 5.78 toks/s]
Processed prompts:  41%|████      | 1666/4096 [04:48<07:07,  5.68it/s, est. speed input: 5912.16 toks/s, output: 5.77 toks/s]
Processed prompts:  41%|████▏     | 1698/4096 [04:54<07:10,  5.57it/s, est. speed input: 5902.88 toks/s, output: 5.76 toks/s]
Processed prompts:  42%|████▏     | 1730/4096 [05:00<07:10,  5.50it/s, est. speed input: 5894.00 toks/s, output: 5.76 toks/s]
Processed prompts:  43%|████▎     | 1762/4096 [05:06<07:08,  5.44it/s, est. speed input: 5885.41 toks/s, output: 5.75 toks/s]
Processed prompts:  44%|████▍     | 1794/4096 [05:12<07:05,  5.41it/s, est. speed input: 5877.20 toks/s, output: 5.74 toks/s]
Processed prompts:  45%|████▍     | 1826/4096 [05:17<06:32,  5.78it/s, est. speed input: 5894.59 toks/s, output: 5.76 toks/s]
Processed prompts:  45%|████▌     | 1858/4096 [05:23<06:36,  5.64it/s, est. speed input: 5886.46 toks/s, output: 5.75 toks/s]
Processed prompts:  46%|████▌     | 1890/4096 [05:29<06:37,  5.54it/s, est. speed input: 5878.62 toks/s, output: 5.74 toks/s]
Processed prompts:  47%|████▋     | 1922/4096 [05:35<06:36,  5.48it/s, est. speed input: 5871.08 toks/s, output: 5.73 toks/s]
Processed prompts:  48%|████▊     | 1954/4096 [05:41<06:34,  5.43it/s, est. speed input: 5863.78 toks/s, output: 5.73 toks/s]
Processed prompts:  48%|████▊     | 1986/4096 [05:45<06:03,  5.80it/s, est. speed input: 5879.90 toks/s, output: 5.74 toks/s]
Processed prompts:  49%|████▉     | 2018/4096 [05:51<06:07,  5.65it/s, est. speed input: 5872.73 toks/s, output: 5.74 toks/s]
Processed prompts:  50%|█████     | 2050/4096 [05:57<06:08,  5.55it/s, est. speed input: 5865.70 toks/s, output: 5.73 toks/s]
Processed prompts:  51%|█████     | 2082/4096 [06:03<06:07,  5.48it/s, est. speed input: 5858.93 toks/s, output: 5.72 toks/s]
Processed prompts:  52%|█████▏    | 2114/4096 [06:09<06:04,  5.43it/s, est. speed input: 5852.37 toks/s, output: 5.72 toks/s]
Processed prompts:  52%|█████▏    | 2146/4096 [06:14<05:35,  5.81it/s, est. speed input: 5867.47 toks/s, output: 5.73 toks/s]
Processed prompts:  53%|█████▎    | 2178/4096 [06:20<05:35,  5.72it/s, est. speed input: 5864.28 toks/s, output: 5.73 toks/s]
Processed prompts:  54%|█████▍    | 2210/4096 [06:26<05:36,  5.60it/s, est. speed input: 5857.98 toks/s, output: 5.72 toks/s]
Processed prompts:  55%|█████▍    | 2242/4096 [06:32<05:36,  5.51it/s, est. speed input: 5851.80 toks/s, output: 5.71 toks/s]
Processed prompts:  56%|█████▌    | 2274/4096 [06:38<05:34,  5.45it/s, est. speed input: 5845.71 toks/s, output: 5.71 toks/s]
Processed prompts:  56%|█████▋    | 2306/4096 [06:44<05:30,  5.41it/s, est. speed input: 5839.87 toks/s, output: 5.70 toks/s]
Processed prompts:  57%|█████▋    | 2338/4096 [06:48<05:03,  5.79it/s, est. speed input: 5854.00 toks/s, output: 5.72 toks/s]
Processed prompts:  58%|█████▊    | 2370/4096 [06:54<05:05,  5.65it/s, est. speed input: 5848.69 toks/s, output: 5.71 toks/s]
Processed prompts:  59%|█████▊    | 2402/4096 [07:00<05:05,  5.55it/s, est. speed input: 5842.75 toks/s, output: 5.71 toks/s]
Processed prompts:  59%|█████▉    | 2434/4096 [07:07<05:03,  5.47it/s, est. speed input: 5836.86 toks/s, output: 5.70 toks/s]
Processed prompts:  60%|██████    | 2466/4096 [07:13<05:00,  5.42it/s, est. speed input: 5831.25 toks/s, output: 5.69 toks/s]
Processed prompts:  61%|██████    | 2498/4096 [07:17<04:35,  5.81it/s, est. speed input: 5845.06 toks/s, output: 5.71 toks/s]
Processed prompts:  62%|██████▏   | 2530/4096 [07:23<04:36,  5.66it/s, est. speed input: 5839.99 toks/s, output: 5.70 toks/s]
Processed prompts:  63%|██████▎   | 2562/4096 [07:29<04:35,  5.56it/s, est. speed input: 5835.09 toks/s, output: 5.70 toks/s]
Processed prompts:  63%|██████▎   | 2594/4096 [07:35<04:33,  5.49it/s, est. speed input: 5830.18 toks/s, output: 5.69 toks/s]
Processed prompts:  64%|██████▍   | 2626/4096 [07:41<04:30,  5.44it/s, est. speed input: 5825.30 toks/s, output: 5.69 toks/s]
Processed prompts:  65%|██████▍   | 2658/4096 [07:47<04:25,  5.41it/s, est. speed input: 5820.57 toks/s, output: 5.68 toks/s]
Processed prompts:  66%|██████▌   | 2690/4096 [07:52<04:03,  5.77it/s, est. speed input: 5832.42 toks/s, output: 5.70 toks/s]
Processed prompts:  66%|██████▋   | 2722/4096 [07:58<04:03,  5.63it/s, est. speed input: 5827.72 toks/s, output: 5.69 toks/s]
Processed prompts:  67%|██████▋   | 2754/4096 [08:04<04:02,  5.54it/s, est. speed input: 5823.12 toks/s, output: 5.69 toks/s]
Processed prompts:  68%|██████▊   | 2786/4096 [08:10<03:59,  5.47it/s, est. speed input: 5818.65 toks/s, output: 5.68 toks/s]
Processed prompts:  69%|██████▉   | 2818/4096 [08:16<03:55,  5.43it/s, est. speed input: 5814.27 toks/s, output: 5.68 toks/s]
Processed prompts:  70%|██████▉   | 2850/4096 [08:20<03:34,  5.80it/s, est. speed input: 5825.81 toks/s, output: 5.69 toks/s]
Processed prompts:  70%|███████   | 2882/4096 [08:26<03:34,  5.65it/s, est. speed input: 5821.45 toks/s, output: 5.69 toks/s]
Processed prompts:  71%|███████   | 2914/4096 [08:32<03:32,  5.55it/s, est. speed input: 5817.19 toks/s, output: 5.68 toks/s]
Processed prompts:  72%|███████▏  | 2946/4096 [08:38<03:29,  5.48it/s, est. speed input: 5813.02 toks/s, output: 5.68 toks/s]
Processed prompts:  73%|███████▎  | 2978/4096 [08:44<03:25,  5.44it/s, est. speed input: 5808.95 toks/s, output: 5.67 toks/s]
Processed prompts:  73%|███████▎  | 3010/4096 [08:50<03:21,  5.40it/s, est. speed input: 5804.95 toks/s, output: 5.67 toks/s]
Processed prompts:  74%|███████▍  | 3042/4096 [08:55<03:02,  5.78it/s, est. speed input: 5815.88 toks/s, output: 5.68 toks/s]
Processed prompts:  75%|███████▌  | 3074/4096 [09:01<03:01,  5.64it/s, est. speed input: 5811.89 toks/s, output: 5.68 toks/s]
Processed prompts:  76%|███████▌  | 3106/4096 [09:07<02:58,  5.54it/s, est. speed input: 5808.00 toks/s, output: 5.67 toks/s]
Processed prompts:  77%|███████▋  | 3138/4096 [09:13<02:54,  5.48it/s, est. speed input: 5804.19 toks/s, output: 5.67 toks/s]
Processed prompts:  77%|███████▋  | 3170/4096 [09:19<02:50,  5.43it/s, est. speed input: 5800.44 toks/s, output: 5.66 toks/s]
Processed prompts:  78%|███████▊  | 3202/4096 [09:24<02:34,  5.80it/s, est. speed input: 5810.84 toks/s, output: 5.67 toks/s]
Processed prompts:  79%|███████▉  | 3234/4096 [09:30<02:32,  5.65it/s, est. speed input: 5807.13 toks/s, output: 5.67 toks/s]
Processed prompts:  80%|███████▉  | 3266/4096 [09:36<02:29,  5.55it/s, est. speed input: 5803.48 toks/s, output: 5.67 toks/s]
Processed prompts:  81%|████████  | 3298/4096 [09:42<02:25,  5.48it/s, est. speed input: 5799.90 toks/s, output: 5.66 toks/s]
Processed prompts:  81%|████████▏ | 3330/4096 [09:48<02:20,  5.44it/s, est. speed input: 5796.40 toks/s, output: 5.66 toks/s]
Processed prompts:  82%|████████▏ | 3362/4096 [09:52<02:06,  5.81it/s, est. speed input: 5806.33 toks/s, output: 5.67 toks/s]
Processed prompts:  83%|████████▎ | 3394/4096 [09:58<02:04,  5.65it/s, est. speed input: 5802.83 toks/s, output: 5.67 toks/s]
Processed prompts:  84%|████████▎ | 3426/4096 [10:04<02:00,  5.55it/s, est. speed input: 5799.40 toks/s, output: 5.66 toks/s]
Processed prompts:  84%|████████▍ | 3458/4096 [10:10<01:56,  5.48it/s, est. speed input: 5796.01 toks/s, output: 5.66 toks/s]
Processed prompts:  85%|████████▌ | 3490/4096 [10:16<01:51,  5.44it/s, est. speed input: 5792.69 toks/s, output: 5.66 toks/s]
Processed prompts:  86%|████████▌ | 3522/4096 [10:22<01:46,  5.40it/s, est. speed input: 5789.44 toks/s, output: 5.65 toks/s]
Processed prompts:  87%|████████▋ | 3554/4096 [10:27<01:33,  5.78it/s, est. speed input: 5798.93 toks/s, output: 5.66 toks/s]
Processed prompts:  88%|████████▊ | 3586/4096 [10:33<01:30,  5.64it/s, est. speed input: 5795.71 toks/s, output: 5.66 toks/s]
Processed prompts:  88%|████████▊ | 3618/4096 [10:39<01:26,  5.54it/s, est. speed input: 5792.44 toks/s, output: 5.66 toks/s]
Processed prompts:  89%|████████▉ | 3650/4096 [10:45<01:21,  5.47it/s, est. speed input: 5789.14 toks/s, output: 5.65 toks/s]
Processed prompts:  90%|████████▉ | 3682/4096 [10:51<01:15,  5.48it/s, est. speed input: 5787.81 toks/s, output: 5.65 toks/s]
Processed prompts:  91%|█████████ | 3714/4096 [10:56<01:05,  5.85it/s, est. speed input: 5797.18 toks/s, output: 5.66 toks/s]
Processed prompts:  91%|█████████▏| 3746/4096 [11:02<01:01,  5.69it/s, est. speed input: 5794.32 toks/s, output: 5.66 toks/s]
Processed prompts:  92%|█████████▏| 3778/4096 [11:08<00:57,  5.57it/s, est. speed input: 5791.05 toks/s, output: 5.66 toks/s]
Processed prompts:  93%|█████████▎| 3810/4096 [11:14<00:52,  5.48it/s, est. speed input: 5787.49 toks/s, output: 5.65 toks/s]
Processed prompts:  94%|█████████▍| 3842/4096 [11:20<00:46,  5.43it/s, est. speed input: 5784.51 toks/s, output: 5.65 toks/s]
Processed prompts:  95%|█████████▍| 3874/4096 [11:26<00:41,  5.41it/s, est. speed input: 5781.83 toks/s, output: 5.65 toks/s]
Processed prompts:  95%|█████████▌| 3906/4096 [11:30<00:32,  5.87it/s, est. speed input: 5792.77 toks/s, output: 5.66 toks/s]
Processed prompts:  96%|█████████▌| 3938/4096 [11:36<00:27,  5.70it/s, est. speed input: 5789.88 toks/s, output: 5.65 toks/s]
Processed prompts:  97%|█████████▋| 3970/4096 [11:42<00:22,  5.58it/s, est. speed input: 5787.04 toks/s, output: 5.65 toks/s]
Processed prompts:  98%|█████████▊| 4002/4096 [11:48<00:17,  5.50it/s, est. speed input: 5784.25 toks/s, output: 5.65 toks/s]
Processed prompts:  98%|█████████▊| 4034/4096 [11:54<00:11,  5.45it/s, est. speed input: 5781.49 toks/s, output: 5.65 toks/s]
Processed prompts:  99%|█████████▉| 4066/4096 [11:58<00:05,  5.88it/s, est. speed input: 5791.42 toks/s, output: 5.66 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [11:58<00:00,  5.88it/s, est. speed input: 5834.14 toks/s, output: 5.70 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [11:58<00:00,  5.70it/s, est. speed input: 5834.14 toks/s, output: 5.70 toks/s]
[rank0]:[W126 04:44:06.224482967 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 814.3s

测试结果:
  Requests/s:   5.33
  Tokens/s:     5466.83
  Total Reqs:   4096
  Elapsed:      767.98s

  [Prefill 分析]
  Total Prefill Tokens: 4194304
  Prefill Tokens/s:     5461.50

============================================================
[8/8] 测试 M=65536
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 65536
│   M_prefill     = 65536 (= 64 x 1024)
│   M_decode      = 64
│   batched_tokens = 65536 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 8192
│   --max-num-seqs           = 64
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 65536
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 04:45:15 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 04:45:16 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=190917) WARNING 01-26 04:45:32 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=190917) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=190917) WARNING 01-26 04:45:45 [backends.py:609] Failed to read file <frozen os>
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 240, in _initialize_kv_caches
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     available_gpu_memory = self.model_executor.determine_available_memory()
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     return self.collective_rpc("determine_available_memory")
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     result = run_method(self.driver_worker, method, args, kwargs)
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/root/vllmbench/vllm/v1/serial_utils.py", line 461, in run_method
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 340, in determine_available_memory
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     self.model_runner.profile_run()
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4474, in profile_run
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     hidden_states, last_hidden_states = self._dummy_run(
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]                                         ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4198, in _dummy_run
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     outputs = self.model(
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]               ^^^^^^^^^^^
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 583, in forward
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     hidden_states = self.model(
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]                     ^^^^^^^^^^^
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/root/vllmbench/vllm/compilation/decorators.py", line 526, in __call__
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/root/vllmbench/vllm/compilation/wrapper.py", line 218, in __call__
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     return self._call_with_optional_nvtx_range(
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/root/vllmbench/vllm/compilation/wrapper.py", line 109, in _call_with_optional_nvtx_range
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     return callable_fn(*args, **kwargs)
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 832, in compile_wrapper
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     return fn(*args, **kwargs)
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 418, in forward
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     def forward(
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     return fn(*args, **kwargs)
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/root/vllmbench/vllm/compilation/caching.py", line 54, in __call__
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     return self.optimized_call(*args, **kwargs)
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 837, in call_wrapped
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     return self._wrapped_call(self, *args, **kwargs)
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 413, in __call__
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     raise e
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 400, in __call__
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     return super(self.cls, obj).__call__(*args, **kwargs)  # type: ignore[misc]
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "<eval_with_key>.58", line 325, in forward
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     submod_2 = self.submod_2(getitem_3, s72, l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_scale_, l_self_modules_layers_modules_0_modules_post_attention_layernorm_parameters_weight_, getitem_4, l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_scale_, l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_input_layernorm_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_bias_, l_positions_, l_self_modules_layers_modules_0_modules_self_attn_modules_rotary_emb_buffers_cos_sin_cache_);  getitem_3 = l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_scale_ = l_self_modules_layers_modules_0_modules_post_attention_layernorm_parameters_weight_ = getitem_4 = l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_scale_ = l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_input_layernorm_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_bias_ = None
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/root/vllmbench/vllm/compilation/piecewise_backend.py", line 178, in __call__
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     return range_entry.runnable(*args)
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/standalone_compile.py", line 63, in __call__
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     return self._compiled_fn(*args)
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     return fn(*args, **kwargs)
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/aot_autograd.py", line 1130, in forward
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     return compiled_fn(full_args)
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 353, in runtime_wrapper
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     all_outs = call_func_at_runtime_with_args(
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/utils.py", line 129, in call_func_at_runtime_with_args
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     out = normalize_as_list(f(args))
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]                             ^^^^^^^
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 724, in inner_fn
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     outs = compiled_fn(args)
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]            ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 526, in wrapper
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     return compiled_fn(runtime_args)
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/output_code.py", line 613, in __call__
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     return self.current_callable(inputs)
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/utils.py", line 2962, in run
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     out = model(new_inputs)
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]           ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/tmp/torchinductor_root/ft/cftm23efk4phtqrn4bvlv2q3rwl6hdgmtnki6iioztkhpj2rkjah.py", line 1093, in call
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     buf17 = torch.ops.slidesparse.quant_slide_fp8.default(buf16, 'Qwen2.5-7B-FP8', 8)
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_ops.py", line 841, in __call__
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     return self._op(*args, **kwargs)
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/root/vllmbench/slidesparse/core/kernels.py", line 521, in _quant_slide_fp8_impl
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     return fn(input, L)
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]            ^^^^^^^^^^^^
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/root/vllmbench/slidesparse/csrc/fused_quant_slide_triton/build/RTX4090_cc89_py312_cu129_x86_64/quant_slide_tuned_Qwen2.5-7B.py", line 263, in quant_slide_fp8_triton
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     _quant_slide_fp8_kernel[(M,)](
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/triton/runtime/jit.py", line 419, in <lambda>
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/triton/runtime/jit.py", line 756, in run
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     launch_metadata = kernel.launch_metadata(grid, stream, *bound_args.values())
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 490, in launch_metadata
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     self._init_handles()
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 473, in _init_handles
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]     self.module, self.function, self.n_regs, self.n_spills, self.n_max_threads = driver.active.utils.load_binary(
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866]                                                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917) ERROR 01-26 04:45:56 [core.py:866] RuntimeError: Triton Error [CUDA]: an illegal memory access was encountered


─── STDERR ───
[2026-01-26 04:45:15] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 04:45:15] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:45:15] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 04:45:15] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:45:15] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:45:15] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:45:15] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:45:15] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:45:15] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:45:15] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 04:45:15] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 04:45:15] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 04:45:15] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 04:45:15] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 04:45:23] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 04:45:23] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:45:23] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 04:45:23] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:45:23] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:45:23] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:45:23] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:45:23] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:45:23] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:45:23] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 04:45:23] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 04:45:23] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 04:45:23] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 04:45:23] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[W126 04:45:32.791908659 socket.cpp:209] [c10d] The hostname of the client socket cannot be retrieved. err=-3
(EngineCore_DP0 pid=190917) [2026-01-26 04:45:33] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=190917) [2026-01-26 04:45:33] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=190917) [2026-01-26 04:45:33] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=190917) [2026-01-26 04:45:33] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=190917) [2026-01-26 04:45:33] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=190917) [2026-01-26 04:45:33] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=190917) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=190917) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.04it/s]
(EngineCore_DP0 pid=190917) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.22s/it]
(EngineCore_DP0 pid=190917) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.18s/it]
(EngineCore_DP0 pid=190917) 
(EngineCore_DP0 pid=190917) [2026-01-26 04:45:37] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=190917) [2026-01-26 04:45:37] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 18579456 bytes
(EngineCore_DP0 pid=190917) [2026-01-26 04:45:37] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=190917) [2026-01-26 04:45:37] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 14450688 bytes
(EngineCore_DP0 pid=190917) [2026-01-26 04:45:37] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=190917) [2026-01-26 04:45:37] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 152764416 bytes
(EngineCore_DP0 pid=190917) [2026-01-26 04:45:37] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=190917) [2026-01-26 04:45:37] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 76382208 bytes
(EngineCore_DP0 pid=190917) [rank0]:W0126 04:45:53.486000 190917 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=190917) [rank0]:W0126 04:45:53.595000 190917 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=190917) [rank0]:W0126 04:45:55.201000 190917 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=190917) [rank0]:W0126 04:45:55.368000 190917 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=190917) Process EngineCore_DP0:
(EngineCore_DP0 pid=190917) Traceback (most recent call last):
(EngineCore_DP0 pid=190917)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=190917)     self.run()
(EngineCore_DP0 pid=190917)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=190917)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=190917)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=190917)     raise e
(EngineCore_DP0 pid=190917)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=190917)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=190917)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=190917)     super().__init__(
(EngineCore_DP0 pid=190917)   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=190917)     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=190917)                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917)   File "/root/vllmbench/vllm/v1/engine/core.py", line 240, in _initialize_kv_caches
(EngineCore_DP0 pid=190917)     available_gpu_memory = self.model_executor.determine_available_memory()
(EngineCore_DP0 pid=190917)                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917)   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
(EngineCore_DP0 pid=190917)     return self.collective_rpc("determine_available_memory")
(EngineCore_DP0 pid=190917)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917)   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
(EngineCore_DP0 pid=190917)     result = run_method(self.driver_worker, method, args, kwargs)
(EngineCore_DP0 pid=190917)              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917)   File "/root/vllmbench/vllm/v1/serial_utils.py", line 461, in run_method
(EngineCore_DP0 pid=190917)     return func(*args, **kwargs)
(EngineCore_DP0 pid=190917)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917)   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=190917)     return func(*args, **kwargs)
(EngineCore_DP0 pid=190917)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917)   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 340, in determine_available_memory
(EngineCore_DP0 pid=190917)     self.model_runner.profile_run()
(EngineCore_DP0 pid=190917)   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4474, in profile_run
(EngineCore_DP0 pid=190917)     hidden_states, last_hidden_states = self._dummy_run(
(EngineCore_DP0 pid=190917)                                         ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917)   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=190917)     return func(*args, **kwargs)
(EngineCore_DP0 pid=190917)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917)   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4198, in _dummy_run
(EngineCore_DP0 pid=190917)     outputs = self.model(
(EngineCore_DP0 pid=190917)               ^^^^^^^^^^^
(EngineCore_DP0 pid=190917)   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=190917)     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=190917)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=190917)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=190917)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=190917)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=190917)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 583, in forward
(EngineCore_DP0 pid=190917)     hidden_states = self.model(
(EngineCore_DP0 pid=190917)                     ^^^^^^^^^^^
(EngineCore_DP0 pid=190917)   File "/root/vllmbench/vllm/compilation/decorators.py", line 526, in __call__
(EngineCore_DP0 pid=190917)     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
(EngineCore_DP0 pid=190917)              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917)   File "/root/vllmbench/vllm/compilation/wrapper.py", line 218, in __call__
(EngineCore_DP0 pid=190917)     return self._call_with_optional_nvtx_range(
(EngineCore_DP0 pid=190917)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917)   File "/root/vllmbench/vllm/compilation/wrapper.py", line 109, in _call_with_optional_nvtx_range
(EngineCore_DP0 pid=190917)     return callable_fn(*args, **kwargs)
(EngineCore_DP0 pid=190917)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917)   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 832, in compile_wrapper
(EngineCore_DP0 pid=190917)     return fn(*args, **kwargs)
(EngineCore_DP0 pid=190917)            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 418, in forward
(EngineCore_DP0 pid=190917)     def forward(
(EngineCore_DP0 pid=190917)   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=190917)     return fn(*args, **kwargs)
(EngineCore_DP0 pid=190917)            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917)   File "/root/vllmbench/vllm/compilation/caching.py", line 54, in __call__
(EngineCore_DP0 pid=190917)     return self.optimized_call(*args, **kwargs)
(EngineCore_DP0 pid=190917)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917)   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 837, in call_wrapped
(EngineCore_DP0 pid=190917)     return self._wrapped_call(self, *args, **kwargs)
(EngineCore_DP0 pid=190917)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917)   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 413, in __call__
(EngineCore_DP0 pid=190917)     raise e
(EngineCore_DP0 pid=190917)   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 400, in __call__
(EngineCore_DP0 pid=190917)     return super(self.cls, obj).__call__(*args, **kwargs)  # type: ignore[misc]
(EngineCore_DP0 pid=190917)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=190917)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=190917)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=190917)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=190917)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917)   File "<eval_with_key>.58", line 325, in forward
(EngineCore_DP0 pid=190917)     submod_2 = self.submod_2(getitem_3, s72, l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_scale_, l_self_modules_layers_modules_0_modules_post_attention_layernorm_parameters_weight_, getitem_4, l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_scale_, l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_input_layernorm_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_bias_, l_positions_, l_self_modules_layers_modules_0_modules_self_attn_modules_rotary_emb_buffers_cos_sin_cache_);  getitem_3 = l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_scale_ = l_self_modules_layers_modules_0_modules_post_attention_layernorm_parameters_weight_ = getitem_4 = l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_scale_ = l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_input_layernorm_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_bias_ = None
(EngineCore_DP0 pid=190917)                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917)   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=190917)     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=190917)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917)   File "/root/vllmbench/vllm/compilation/piecewise_backend.py", line 178, in __call__
(EngineCore_DP0 pid=190917)     return range_entry.runnable(*args)
(EngineCore_DP0 pid=190917)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/standalone_compile.py", line 63, in __call__
(EngineCore_DP0 pid=190917)     return self._compiled_fn(*args)
(EngineCore_DP0 pid=190917)            ^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917)   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=190917)     return fn(*args, **kwargs)
(EngineCore_DP0 pid=190917)            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/aot_autograd.py", line 1130, in forward
(EngineCore_DP0 pid=190917)     return compiled_fn(full_args)
(EngineCore_DP0 pid=190917)            ^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 353, in runtime_wrapper
(EngineCore_DP0 pid=190917)     all_outs = call_func_at_runtime_with_args(
(EngineCore_DP0 pid=190917)                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/utils.py", line 129, in call_func_at_runtime_with_args
(EngineCore_DP0 pid=190917)     out = normalize_as_list(f(args))
(EngineCore_DP0 pid=190917)                             ^^^^^^^
(EngineCore_DP0 pid=190917)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 724, in inner_fn
(EngineCore_DP0 pid=190917)     outs = compiled_fn(args)
(EngineCore_DP0 pid=190917)            ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 526, in wrapper
(EngineCore_DP0 pid=190917)     return compiled_fn(runtime_args)
(EngineCore_DP0 pid=190917)            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/output_code.py", line 613, in __call__
(EngineCore_DP0 pid=190917)     return self.current_callable(inputs)
(EngineCore_DP0 pid=190917)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/utils.py", line 2962, in run
(EngineCore_DP0 pid=190917)     out = model(new_inputs)
(EngineCore_DP0 pid=190917)           ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917)   File "/tmp/torchinductor_root/ft/cftm23efk4phtqrn4bvlv2q3rwl6hdgmtnki6iioztkhpj2rkjah.py", line 1093, in call
(EngineCore_DP0 pid=190917)     buf17 = torch.ops.slidesparse.quant_slide_fp8.default(buf16, 'Qwen2.5-7B-FP8', 8)
(EngineCore_DP0 pid=190917)             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917)   File "/usr/local/lib/python3.12/dist-packages/torch/_ops.py", line 841, in __call__
(EngineCore_DP0 pid=190917)     return self._op(*args, **kwargs)
(EngineCore_DP0 pid=190917)            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917)   File "/root/vllmbench/slidesparse/core/kernels.py", line 521, in _quant_slide_fp8_impl
(EngineCore_DP0 pid=190917)     return fn(input, L)
(EngineCore_DP0 pid=190917)            ^^^^^^^^^^^^
(EngineCore_DP0 pid=190917)   File "/root/vllmbench/slidesparse/csrc/fused_quant_slide_triton/build/RTX4090_cc89_py312_cu129_x86_64/quant_slide_tuned_Qwen2.5-7B.py", line 263, in quant_slide_fp8_triton
(EngineCore_DP0 pid=190917)     _quant_slide_fp8_kernel[(M,)](
(EngineCore_DP0 pid=190917)   File "/usr/local/lib/python3.12/dist-packages/triton/runtime/jit.py", line 419, in <lambda>
(EngineCore_DP0 pid=190917)     return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)
(EngineCore_DP0 pid=190917)                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917)   File "/usr/local/lib/python3.12/dist-packages/triton/runtime/jit.py", line 756, in run
(EngineCore_DP0 pid=190917)     launch_metadata = kernel.launch_metadata(grid, stream, *bound_args.values())
(EngineCore_DP0 pid=190917)                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917)   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 490, in launch_metadata
(EngineCore_DP0 pid=190917)     self._init_handles()
(EngineCore_DP0 pid=190917)   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 473, in _init_handles
(EngineCore_DP0 pid=190917)     self.module, self.function, self.n_regs, self.n_spills, self.n_max_threads = driver.active.utils.load_binary(
(EngineCore_DP0 pid=190917)                                                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=190917) RuntimeError: Triton Error [CUDA]: an illegal memory access was encountered
[rank0]:[W126 04:45:57.804488310 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

[ERROR] 测试失败: M=65536 (exit code: 1)


------------------------------------------------------------
  生成 CSV: Qwen2.5-7B-FP8
------------------------------------------------------------
[SUCCESS] CSV 保存到: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_8/Qwen2.5-7B-FP8_prefill.csv

预览:
------------------------------------------------------------
M_prefill,prompt_len,max_num_seqs,num_prompts,N_prefill,requests_per_s,tokens_per_s,elapsed_time_s
512,512,1,128,128,16.1081,8263.4704,7.9463
1024,1024,1,128,128,16.1523,16556.0723,7.9246
2048,1024,2,256,128,17.8735,18320.2873,14.3229
4096,1024,4,512,128,18.7600,19229.0268,27.2921
8192,1024,8,1024,128,18.9179,19390.8609,54.1286
16384,1024,16,2048,128,12.0216,12322.1047,170.3605
32768,1024,32,4096,128,5.3335,5466.8335,767.9766
65536,1024,64,8192,128,-1.0000,-1.0000,-1.0000

------------------------------------------------------------

[INFO] 完成: 7 成功, 1 失败

============================================================
  Qwen2.5-7B-FP8 | cuSPARSELt (2_10) | prefill
============================================================

[INFO] Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-FP8-SlideSparse-2_10
[INFO] Output: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_10

============================================================
[1/8] 测试 M=512
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 512
│   M_prefill     = 512 (= 1 x 512)
│   M_decode      = 1
│   batched_tokens = 513 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 512
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 513
│   --max-num-batched-tokens = 513
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 04:46:09 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 04:46:08 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=191876) WARNING 01-26 04:46:16 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=191876) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=191876) WARNING 01-26 04:46:37 [backends.py:609] Failed to read file <frozen os>
Throughput: 16.15 requests/s, 8285.32 total tokens/s, 16.15 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128


─── STDERR ───
[2026-01-26 04:46:09] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 04:46:09] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:46:09] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 04:46:09] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:46:09] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:46:09] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:46:09] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:46:09] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:46:09] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:46:09] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 04:46:09] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 04:46:09] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 04:46:09] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 04:46:09] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 04:46:15] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 04:46:15] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:46:15] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 04:46:15] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:46:15] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:46:15] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:46:15] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:46:15] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:46:15] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:46:15] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 04:46:15] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 04:46:15] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 04:46:15] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 04:46:15] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=191876) [2026-01-26 04:46:17] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=191876) [2026-01-26 04:46:17] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=191876) [2026-01-26 04:46:17] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=191876) [2026-01-26 04:46:17] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=191876) [2026-01-26 04:46:17] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=191876) [2026-01-26 04:46:17] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=191876) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=191876) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:03<00:03,  3.96s/it]
(EngineCore_DP0 pid=191876) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:09<00:00,  4.79s/it]
(EngineCore_DP0 pid=191876) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:09<00:00,  4.66s/it]
(EngineCore_DP0 pid=191876) 
(EngineCore_DP0 pid=191876) [2026-01-26 04:46:27] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 5760] -> 1D uint8
(EngineCore_DP0 pid=191876) [2026-01-26 04:46:27] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 19906560 bytes
(EngineCore_DP0 pid=191876) [2026-01-26 04:46:27] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 5760] -> 1D uint8
(EngineCore_DP0 pid=191876) [2026-01-26 04:46:27] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 15482880 bytes
(EngineCore_DP0 pid=191876) [2026-01-26 04:46:27] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 5760] -> 1D uint8
(EngineCore_DP0 pid=191876) [2026-01-26 04:46:27] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 163676160 bytes
(EngineCore_DP0 pid=191876) [2026-01-26 04:46:27] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 30336] -> 1D uint8
(EngineCore_DP0 pid=191876) [2026-01-26 04:46:27] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 81543168 bytes
(EngineCore_DP0 pid=191876) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  2.57it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  2.55it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  2.55it/s]
(EngineCore_DP0 pid=191876) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.40it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.39it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  34%|███▍      | 44/128 [00:00<00:00, 436.61it/s]
Adding requests:  71%|███████   | 91/128 [00:00<00:00, 453.27it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 453.29it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:17,  7.29it/s, est. speed input: 3731.92 toks/s, output: 7.29 toks/s]
Processed prompts:   2%|▏         | 2/128 [00:00<00:15,  8.11it/s, est. speed input: 4085.75 toks/s, output: 7.98 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:11, 10.77it/s, est. speed input: 5117.75 toks/s, output: 10.00 toks/s]
Processed prompts:   5%|▍         | 6/128 [00:00<00:09, 13.05it/s, est. speed input: 5940.02 toks/s, output: 11.60 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:00<00:08, 14.45it/s, est. speed input: 6463.57 toks/s, output: 12.62 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:00<00:07, 15.30it/s, est. speed input: 6818.23 toks/s, output: 13.32 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:00<00:07, 15.85it/s, est. speed input: 7074.31 toks/s, output: 13.82 toks/s]
Processed prompts:  11%|█         | 14/128 [00:00<00:07, 16.26it/s, est. speed input: 7276.78 toks/s, output: 14.21 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:01<00:06, 16.61it/s, est. speed input: 7447.55 toks/s, output: 14.55 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:01<00:06, 16.87it/s, est. speed input: 7588.37 toks/s, output: 14.82 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:01<00:06, 16.91it/s, est. speed input: 7687.55 toks/s, output: 15.01 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:01<00:06, 16.99it/s, est. speed input: 7775.90 toks/s, output: 15.19 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:01<00:06, 16.91it/s, est. speed input: 7836.88 toks/s, output: 15.31 toks/s]
Processed prompts:  20%|██        | 26/128 [00:01<00:05, 17.00it/s, est. speed input: 7904.31 toks/s, output: 15.44 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:01<00:05, 17.00it/s, est. speed input: 7955.82 toks/s, output: 15.54 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:01<00:05, 17.08it/s, est. speed input: 8009.31 toks/s, output: 15.64 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:02<00:05, 17.18it/s, est. speed input: 8060.35 toks/s, output: 15.74 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:02<00:05, 17.24it/s, est. speed input: 8105.68 toks/s, output: 15.83 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:02<00:05, 17.26it/s, est. speed input: 8144.50 toks/s, output: 15.91 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:02<00:05, 17.22it/s, est. speed input: 8174.59 toks/s, output: 15.97 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:02<00:05, 17.02it/s, est. speed input: 8190.11 toks/s, output: 16.00 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:02<00:05, 16.99it/s, est. speed input: 8211.25 toks/s, output: 16.04 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:02<00:04, 17.00it/s, est. speed input: 8232.95 toks/s, output: 16.08 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:02<00:04, 17.00it/s, est. speed input: 8252.50 toks/s, output: 16.12 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:02<00:04, 17.01it/s, est. speed input: 8271.12 toks/s, output: 16.15 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:03<00:04, 17.05it/s, est. speed input: 8290.16 toks/s, output: 16.19 toks/s]
Processed prompts:  41%|████      | 52/128 [00:03<00:04, 17.07it/s, est. speed input: 8307.16 toks/s, output: 16.22 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:03<00:04, 17.06it/s, est. speed input: 8321.81 toks/s, output: 16.25 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:03<00:04, 17.08it/s, est. speed input: 8336.89 toks/s, output: 16.28 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:03<00:04, 17.12it/s, est. speed input: 8352.43 toks/s, output: 16.31 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:03<00:03, 17.17it/s, est. speed input: 8368.10 toks/s, output: 16.34 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:03<00:03, 17.19it/s, est. speed input: 8382.43 toks/s, output: 16.37 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:03<00:03, 17.18it/s, est. speed input: 8394.24 toks/s, output: 16.39 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:04<00:03, 17.26it/s, est. speed input: 8409.89 toks/s, output: 16.43 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:04<00:03, 17.29it/s, est. speed input: 8423.25 toks/s, output: 16.45 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:04<00:03, 17.38it/s, est. speed input: 8438.99 toks/s, output: 16.48 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:04<00:03, 17.44it/s, est. speed input: 8453.69 toks/s, output: 16.51 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:04<00:03, 17.31it/s, est. speed input: 8460.39 toks/s, output: 16.52 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:04<00:03, 17.24it/s, est. speed input: 8467.41 toks/s, output: 16.54 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:04<00:02, 17.31it/s, est. speed input: 8479.19 toks/s, output: 16.56 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:04<00:02, 17.34it/s, est. speed input: 8489.70 toks/s, output: 16.58 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:04<00:02, 17.25it/s, est. speed input: 8495.34 toks/s, output: 16.59 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:05<00:02, 17.27it/s, est. speed input: 8503.70 toks/s, output: 16.61 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:05<00:02, 17.33it/s, est. speed input: 8513.53 toks/s, output: 16.63 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:05<00:02, 17.39it/s, est. speed input: 8523.36 toks/s, output: 16.65 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:05<00:02, 17.41it/s, est. speed input: 8532.24 toks/s, output: 16.66 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:05<00:02, 17.33it/s, est. speed input: 8537.55 toks/s, output: 16.67 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:05<00:01, 17.02it/s, est. speed input: 8533.69 toks/s, output: 16.67 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:05<00:01, 17.06it/s, est. speed input: 8538.71 toks/s, output: 16.68 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:05<00:01, 17.05it/s, est. speed input: 8542.33 toks/s, output: 16.68 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:05<00:01, 17.04it/s, est. speed input: 8545.57 toks/s, output: 16.69 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:06<00:01, 17.11it/s, est. speed input: 8551.21 toks/s, output: 16.70 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:06<00:01, 17.01it/s, est. speed input: 8551.95 toks/s, output: 16.70 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:06<00:01, 16.92it/s, est. speed input: 8552.00 toks/s, output: 16.70 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:06<00:01, 16.88it/s, est. speed input: 8552.97 toks/s, output: 16.70 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:06<00:01, 16.85it/s, est. speed input: 8553.71 toks/s, output: 16.71 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:06<00:00, 16.79it/s, est. speed input: 8553.27 toks/s, output: 16.71 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:06<00:00, 16.98it/s, est. speed input: 8559.53 toks/s, output: 16.72 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:06<00:00, 16.90it/s, est. speed input: 8559.48 toks/s, output: 16.72 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:07<00:00, 16.96it/s, est. speed input: 8562.83 toks/s, output: 16.72 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:07<00:00, 17.10it/s, est. speed input: 8568.65 toks/s, output: 16.74 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:07<00:00, 17.09it/s, est. speed input: 8571.44 toks/s, output: 16.74 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:07<00:00, 16.90it/s, est. speed input: 8569.03 toks/s, output: 16.74 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:07<00:00, 17.00it/s, est. speed input: 8572.93 toks/s, output: 16.74 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 17.06it/s, est. speed input: 8576.57 toks/s, output: 16.75 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 17.06it/s, est. speed input: 8576.57 toks/s, output: 16.75 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 16.75it/s, est. speed input: 8576.57 toks/s, output: 16.75 toks/s]
[rank0]:[W126 04:47:02.699007377 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 63.9s

测试结果:
  Requests/s:   16.15
  Tokens/s:     8285.32
  Total Reqs:   128
  Elapsed:      7.93s

  [Prefill 分析]
  Total Prefill Tokens: 65536
  Prefill Tokens/s:     8269.17

============================================================
[2/8] 测试 M=1024
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 1024
│   M_prefill     = 1024 (= 1 x 1024)
│   M_decode      = 1
│   batched_tokens = 1025 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 1025
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 04:47:12 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 04:47:13 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=193051) WARNING 01-26 04:47:21 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=193051) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=193051) WARNING 01-26 04:47:34 [backends.py:609] Failed to read file <frozen os>
Throughput: 15.80 requests/s, 16194.24 total tokens/s, 15.80 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128


─── STDERR ───
[2026-01-26 04:47:12] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 04:47:12] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:47:12] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 04:47:12] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:47:12] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:47:12] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:47:12] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:47:12] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:47:12] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:47:12] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 04:47:12] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 04:47:12] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 04:47:12] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 04:47:12] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 04:47:20] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 04:47:20] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:47:20] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 04:47:20] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:47:20] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:47:20] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:47:20] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:47:20] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:47:20] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:47:20] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 04:47:20] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 04:47:20] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 04:47:20] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 04:47:20] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=193051) [2026-01-26 04:47:21] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=193051) [2026-01-26 04:47:21] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=193051) [2026-01-26 04:47:21] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=193051) [2026-01-26 04:47:21] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=193051) [2026-01-26 04:47:21] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=193051) [2026-01-26 04:47:21] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=193051) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=193051) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.06it/s]
(EngineCore_DP0 pid=193051) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.34s/it]
(EngineCore_DP0 pid=193051) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.28s/it]
(EngineCore_DP0 pid=193051) 
(EngineCore_DP0 pid=193051) [2026-01-26 04:47:25] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 5760] -> 1D uint8
(EngineCore_DP0 pid=193051) [2026-01-26 04:47:25] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 19906560 bytes
(EngineCore_DP0 pid=193051) [2026-01-26 04:47:25] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 5760] -> 1D uint8
(EngineCore_DP0 pid=193051) [2026-01-26 04:47:25] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 15482880 bytes
(EngineCore_DP0 pid=193051) [2026-01-26 04:47:25] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 5760] -> 1D uint8
(EngineCore_DP0 pid=193051) [2026-01-26 04:47:25] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 163676160 bytes
(EngineCore_DP0 pid=193051) [2026-01-26 04:47:25] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 30336] -> 1D uint8
(EngineCore_DP0 pid=193051) [2026-01-26 04:47:25] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 81543168 bytes
(EngineCore_DP0 pid=193051) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  8.19it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  8.25it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  8.23it/s]
(EngineCore_DP0 pid=193051) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.37it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.36it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  19%|█▉        | 24/128 [00:00<00:00, 235.40it/s]
Adding requests:  38%|███▊      | 49/128 [00:00<00:00, 237.36it/s]
Adding requests:  58%|█████▊    | 74/128 [00:00<00:00, 242.45it/s]
Adding requests:  77%|███████▋  | 99/128 [00:00<00:00, 244.91it/s]
Adding requests:  97%|█████████▋| 124/128 [00:00<00:00, 245.85it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 243.26it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:03, 32.98it/s, est. speed input: 33775.18 toks/s, output: 32.98 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:00<00:05, 21.68it/s, est. speed input: 23544.50 toks/s, output: 22.99 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:00<00:05, 19.44it/s, est. speed input: 21419.06 toks/s, output: 20.92 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:00<00:06, 18.41it/s, est. speed input: 20393.39 toks/s, output: 19.91 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:00<00:06, 17.95it/s, est. speed input: 19934.04 toks/s, output: 19.47 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:00<00:06, 17.60it/s, est. speed input: 19589.30 toks/s, output: 19.13 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:01<00:06, 17.33it/s, est. speed input: 19314.30 toks/s, output: 18.86 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:01<00:06, 17.15it/s, est. speed input: 19099.28 toks/s, output: 18.65 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:01<00:06, 17.03it/s, est. speed input: 18924.61 toks/s, output: 18.48 toks/s]
Processed prompts:  21%|██        | 27/128 [00:01<00:05, 16.95it/s, est. speed input: 18782.01 toks/s, output: 18.34 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:01<00:05, 16.83it/s, est. speed input: 18644.05 toks/s, output: 18.21 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:01<00:05, 16.80it/s, est. speed input: 18536.41 toks/s, output: 18.10 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:01<00:05, 16.76it/s, est. speed input: 18440.30 toks/s, output: 18.01 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:01<00:05, 16.65it/s, est. speed input: 18336.67 toks/s, output: 17.91 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:02<00:05, 16.56it/s, est. speed input: 18244.43 toks/s, output: 17.82 toks/s]
Processed prompts:  30%|███       | 39/128 [00:02<00:05, 16.46it/s, est. speed input: 18151.99 toks/s, output: 17.73 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:02<00:05, 16.47it/s, est. speed input: 18087.35 toks/s, output: 17.66 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:02<00:05, 16.51it/s, est. speed input: 18032.71 toks/s, output: 17.61 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:02<00:05, 16.54it/s, est. speed input: 17985.82 toks/s, output: 17.56 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:02<00:04, 16.54it/s, est. speed input: 17938.49 toks/s, output: 17.52 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:02<00:04, 16.53it/s, est. speed input: 17892.93 toks/s, output: 17.47 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:02<00:04, 16.48it/s, est. speed input: 17846.21 toks/s, output: 17.43 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:03<00:04, 16.47it/s, est. speed input: 17805.92 toks/s, output: 17.39 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:03<00:04, 16.47it/s, est. speed input: 17769.45 toks/s, output: 17.35 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:03<00:04, 16.54it/s, est. speed input: 17745.81 toks/s, output: 17.33 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:03<00:04, 16.59it/s, est. speed input: 17723.51 toks/s, output: 17.31 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:03<00:04, 16.60it/s, est. speed input: 17699.96 toks/s, output: 17.28 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:03<00:03, 16.63it/s, est. speed input: 17679.46 toks/s, output: 17.26 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:03<00:03, 16.63it/s, est. speed input: 17659.01 toks/s, output: 17.25 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:03<00:03, 16.65it/s, est. speed input: 17641.43 toks/s, output: 17.23 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:04<00:03, 16.62it/s, est. speed input: 17620.92 toks/s, output: 17.21 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:04<00:03, 16.57it/s, est. speed input: 17598.41 toks/s, output: 17.19 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:04<00:03, 16.60it/s, est. speed input: 17582.97 toks/s, output: 17.17 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:04<00:03, 16.64it/s, est. speed input: 17570.89 toks/s, output: 17.16 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:04<00:03, 16.63it/s, est. speed input: 17556.09 toks/s, output: 17.14 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:04<00:02, 16.60it/s, est. speed input: 17539.85 toks/s, output: 17.13 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:04<00:02, 16.61it/s, est. speed input: 17526.75 toks/s, output: 17.12 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:04<00:02, 16.61it/s, est. speed input: 17513.76 toks/s, output: 17.10 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:04<00:02, 16.64it/s, est. speed input: 17503.71 toks/s, output: 17.09 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:05<00:02, 16.55it/s, est. speed input: 17485.70 toks/s, output: 17.08 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:05<00:02, 16.48it/s, est. speed input: 17467.18 toks/s, output: 17.06 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:05<00:02, 16.50it/s, est. speed input: 17455.42 toks/s, output: 17.05 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:05<00:02, 16.51it/s, est. speed input: 17443.48 toks/s, output: 17.03 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:05<00:01, 16.51it/s, est. speed input: 17432.16 toks/s, output: 17.02 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:05<00:01, 16.51it/s, est. speed input: 17421.03 toks/s, output: 17.01 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:05<00:01, 16.46it/s, est. speed input: 17406.53 toks/s, output: 17.00 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:05<00:01, 16.48it/s, est. speed input: 17396.49 toks/s, output: 16.99 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:06<00:01, 16.52it/s, est. speed input: 17388.86 toks/s, output: 16.98 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:06<00:01, 16.46it/s, est. speed input: 17375.66 toks/s, output: 16.97 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:06<00:01, 16.49it/s, est. speed input: 17367.62 toks/s, output: 16.96 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:06<00:01, 16.54it/s, est. speed input: 17361.59 toks/s, output: 16.95 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:06<00:01, 16.58it/s, est. speed input: 17356.56 toks/s, output: 16.95 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:06<00:00, 16.60it/s, est. speed input: 17350.98 toks/s, output: 16.94 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:06<00:00, 16.59it/s, est. speed input: 17344.09 toks/s, output: 16.94 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:06<00:00, 16.59it/s, est. speed input: 17337.62 toks/s, output: 16.93 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:07<00:00, 16.60it/s, est. speed input: 17332.61 toks/s, output: 16.93 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:07<00:00, 16.62it/s, est. speed input: 17327.89 toks/s, output: 16.92 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:07<00:00, 16.54it/s, est. speed input: 17318.25 toks/s, output: 16.91 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:07<00:00, 16.56it/s, est. speed input: 17313.35 toks/s, output: 16.91 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:07<00:00, 16.57it/s, est. speed input: 17308.31 toks/s, output: 16.90 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 16.57it/s, est. speed input: 17306.07 toks/s, output: 16.90 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 16.90it/s, est. speed input: 17306.07 toks/s, output: 16.90 toks/s]
[rank0]:[W126 04:47:59.610359483 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 57.1s

测试结果:
  Requests/s:   15.80
  Tokens/s:     16194.24
  Total Reqs:   128
  Elapsed:      8.10s

  [Prefill 分析]
  Total Prefill Tokens: 131072
  Prefill Tokens/s:     16178.44

============================================================
[3/8] 测试 M=2048
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 2048
│   M_prefill     = 2048 (= 2 x 1024)
│   M_decode      = 2
│   batched_tokens = 2048 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 256
│   --max-num-seqs           = 2
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 2048
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 04:48:11 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 04:48:12 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=194115) WARNING 01-26 04:48:18 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=194115) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=194115) WARNING 01-26 04:48:31 [backends.py:609] Failed to read file <frozen os>
Throughput: 17.19 requests/s, 17617.78 total tokens/s, 17.19 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256


─── STDERR ───
[2026-01-26 04:48:11] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 04:48:11] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:48:11] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 04:48:11] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:48:11] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:48:11] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:48:11] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:48:11] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:48:11] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:48:11] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 04:48:11] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 04:48:11] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 04:48:11] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 04:48:11] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 04:48:18] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 04:48:18] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:48:18] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 04:48:18] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:48:18] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:48:18] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:48:18] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:48:18] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:48:18] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:48:18] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 04:48:18] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 04:48:18] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 04:48:18] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 04:48:18] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=194115) [2026-01-26 04:48:19] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=194115) [2026-01-26 04:48:19] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=194115) [2026-01-26 04:48:19] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=194115) [2026-01-26 04:48:19] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=194115) [2026-01-26 04:48:19] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=194115) [2026-01-26 04:48:19] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=194115) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=194115) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.03it/s]
(EngineCore_DP0 pid=194115) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.23s/it]
(EngineCore_DP0 pid=194115) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.19s/it]
(EngineCore_DP0 pid=194115) 
(EngineCore_DP0 pid=194115) [2026-01-26 04:48:22] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 5760] -> 1D uint8
(EngineCore_DP0 pid=194115) [2026-01-26 04:48:22] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 19906560 bytes
(EngineCore_DP0 pid=194115) [2026-01-26 04:48:22] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 5760] -> 1D uint8
(EngineCore_DP0 pid=194115) [2026-01-26 04:48:22] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 15482880 bytes
(EngineCore_DP0 pid=194115) [2026-01-26 04:48:22] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 5760] -> 1D uint8
(EngineCore_DP0 pid=194115) [2026-01-26 04:48:22] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 163676160 bytes
(EngineCore_DP0 pid=194115) [2026-01-26 04:48:22] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 30336] -> 1D uint8
(EngineCore_DP0 pid=194115) [2026-01-26 04:48:22] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 81543168 bytes
(EngineCore_DP0 pid=194115) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  33%|███▎      | 1/3 [00:00<00:00,  7.78it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  67%|██████▋   | 2/3 [00:00<00:00,  8.32it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00,  7.74it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00,  7.84it/s]
(EngineCore_DP0 pid=194115) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 1/2 [00:00<00:00,  7.04it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  8.12it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  7.93it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:   9%|▉         | 24/256 [00:00<00:00, 234.41it/s]
Adding requests:  20%|█▉        | 50/256 [00:00<00:00, 245.77it/s]
Adding requests:  30%|███       | 78/256 [00:00<00:00, 256.90it/s]
Adding requests:  41%|████      | 104/256 [00:00<00:00, 254.64it/s]
Adding requests:  51%|█████     | 130/256 [00:00<00:00, 251.89it/s]
Adding requests:  61%|██████    | 156/256 [00:00<00:00, 250.69it/s]
Adding requests:  71%|███████▏  | 183/256 [00:00<00:00, 256.06it/s]
Adding requests:  82%|████████▏ | 210/256 [00:00<00:00, 259.34it/s]
Adding requests:  93%|█████████▎| 237/256 [00:00<00:00, 260.76it/s]
Adding requests: 100%|██████████| 256/256 [00:01<00:00, 255.78it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▋         | 16/256 [00:00<00:03, 75.52it/s, est. speed input: 77341.51 toks/s, output: 75.52 toks/s]
Processed prompts:   9%|▉         | 24/256 [00:00<00:07, 31.74it/s, est. speed input: 36769.23 toks/s, output: 35.91 toks/s]
Processed prompts:  11%|█▏        | 29/256 [00:00<00:08, 28.24it/s, est. speed input: 33065.57 toks/s, output: 32.29 toks/s]
Processed prompts:  13%|█▎        | 33/256 [00:01<00:09, 24.64it/s, est. speed input: 29981.15 toks/s, output: 29.28 toks/s]
Processed prompts:  14%|█▍        | 36/256 [00:01<00:10, 20.92it/s, est. speed input: 27189.54 toks/s, output: 26.55 toks/s]
Processed prompts:  15%|█▌        | 39/256 [00:01<00:09, 21.91it/s, est. speed input: 27161.06 toks/s, output: 26.52 toks/s]
Processed prompts:  16%|█▋        | 42/256 [00:01<00:11, 18.82it/s, est. speed input: 25298.31 toks/s, output: 24.70 toks/s]
Processed prompts:  17%|█▋        | 44/256 [00:01<00:11, 18.54it/s, est. speed input: 24826.84 toks/s, output: 24.24 toks/s]
Processed prompts:  18%|█▊        | 46/256 [00:01<00:11, 18.30it/s, est. speed input: 24413.46 toks/s, output: 23.84 toks/s]
Processed prompts:  19%|█▉        | 48/256 [00:02<00:11, 18.11it/s, est. speed input: 24051.17 toks/s, output: 23.49 toks/s]
Processed prompts:  20%|█▉        | 50/256 [00:02<00:11, 17.98it/s, est. speed input: 23733.26 toks/s, output: 23.18 toks/s]
Processed prompts:  20%|██        | 52/256 [00:02<00:11, 17.87it/s, est. speed input: 23445.98 toks/s, output: 22.90 toks/s]
Processed prompts:  21%|██        | 54/256 [00:02<00:11, 17.79it/s, est. speed input: 23185.02 toks/s, output: 22.64 toks/s]
Processed prompts:  22%|██▏       | 56/256 [00:02<00:11, 17.72it/s, est. speed input: 22946.71 toks/s, output: 22.41 toks/s]
Processed prompts:  23%|██▎       | 58/256 [00:02<00:11, 17.67it/s, est. speed input: 22729.86 toks/s, output: 22.20 toks/s]
Processed prompts:  23%|██▎       | 60/256 [00:02<00:11, 17.63it/s, est. speed input: 22530.69 toks/s, output: 22.00 toks/s]
Processed prompts:  24%|██▍       | 62/256 [00:02<00:11, 17.58it/s, est. speed input: 22342.95 toks/s, output: 21.82 toks/s]
Processed prompts:  25%|██▌       | 64/256 [00:02<00:10, 17.56it/s, est. speed input: 22173.00 toks/s, output: 21.65 toks/s]
Processed prompts:  26%|██▌       | 66/256 [00:03<00:10, 17.55it/s, est. speed input: 22015.82 toks/s, output: 21.50 toks/s]
Processed prompts:  27%|██▋       | 68/256 [00:03<00:10, 17.54it/s, est. speed input: 21869.90 toks/s, output: 21.36 toks/s]
Processed prompts:  27%|██▋       | 70/256 [00:03<00:10, 17.56it/s, est. speed input: 21737.69 toks/s, output: 21.23 toks/s]
Processed prompts:  28%|██▊       | 72/256 [00:03<00:10, 17.55it/s, est. speed input: 21609.95 toks/s, output: 21.10 toks/s]
Processed prompts:  29%|██▉       | 74/256 [00:03<00:10, 17.56it/s, est. speed input: 21494.32 toks/s, output: 20.99 toks/s]
Processed prompts:  30%|██▉       | 76/256 [00:03<00:10, 17.57it/s, est. speed input: 21385.01 toks/s, output: 20.88 toks/s]
Processed prompts:  30%|███       | 78/256 [00:03<00:10, 17.56it/s, est. speed input: 21281.48 toks/s, output: 20.78 toks/s]
Processed prompts:  31%|███▏      | 80/256 [00:03<00:10, 17.56it/s, est. speed input: 21183.76 toks/s, output: 20.69 toks/s]
Processed prompts:  32%|███▏      | 82/256 [00:03<00:09, 17.52it/s, est. speed input: 21088.26 toks/s, output: 20.59 toks/s]
Processed prompts:  33%|███▎      | 84/256 [00:04<00:09, 17.49it/s, est. speed input: 20996.76 toks/s, output: 20.50 toks/s]
Processed prompts:  34%|███▎      | 86/256 [00:04<00:09, 17.48it/s, est. speed input: 20911.43 toks/s, output: 20.42 toks/s]
Processed prompts:  34%|███▍      | 88/256 [00:04<00:09, 17.49it/s, est. speed input: 20833.13 toks/s, output: 20.34 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:04<00:09, 17.46it/s, est. speed input: 20755.09 toks/s, output: 20.27 toks/s]
Processed prompts:  36%|███▌      | 92/256 [00:04<00:09, 17.46it/s, est. speed input: 20682.49 toks/s, output: 20.20 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:04<00:09, 17.48it/s, est. speed input: 20615.70 toks/s, output: 20.13 toks/s]
Processed prompts:  38%|███▊      | 96/256 [00:04<00:09, 17.47it/s, est. speed input: 20549.63 toks/s, output: 20.07 toks/s]
Processed prompts:  38%|███▊      | 98/256 [00:04<00:09, 17.44it/s, est. speed input: 20485.09 toks/s, output: 20.00 toks/s]
Processed prompts:  39%|███▉      | 100/256 [00:05<00:08, 17.43it/s, est. speed input: 20424.36 toks/s, output: 19.95 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:05<00:08, 17.45it/s, est. speed input: 20368.02 toks/s, output: 19.89 toks/s]
Processed prompts:  41%|████      | 104/256 [00:05<00:08, 17.47it/s, est. speed input: 20314.78 toks/s, output: 19.84 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:05<00:08, 17.46it/s, est. speed input: 20262.37 toks/s, output: 19.79 toks/s]
Processed prompts:  42%|████▏     | 108/256 [00:05<00:08, 17.46it/s, est. speed input: 20212.73 toks/s, output: 19.74 toks/s]
Processed prompts:  43%|████▎     | 110/256 [00:05<00:08, 17.47it/s, est. speed input: 20165.31 toks/s, output: 19.69 toks/s]
Processed prompts:  44%|████▍     | 112/256 [00:05<00:08, 17.49it/s, est. speed input: 20121.43 toks/s, output: 19.65 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:05<00:08, 17.50it/s, est. speed input: 20078.71 toks/s, output: 19.61 toks/s]
Processed prompts:  45%|████▌     | 116/256 [00:05<00:07, 17.51it/s, est. speed input: 20037.64 toks/s, output: 19.57 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:06<00:07, 17.53it/s, est. speed input: 19999.07 toks/s, output: 19.53 toks/s]
Processed prompts:  47%|████▋     | 120/256 [00:06<00:07, 17.52it/s, est. speed input: 19960.45 toks/s, output: 19.49 toks/s]
Processed prompts:  48%|████▊     | 122/256 [00:06<00:07, 17.51it/s, est. speed input: 19923.00 toks/s, output: 19.46 toks/s]
Processed prompts:  48%|████▊     | 124/256 [00:06<00:07, 17.50it/s, est. speed input: 19886.73 toks/s, output: 19.42 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:06<00:07, 17.48it/s, est. speed input: 19851.12 toks/s, output: 19.39 toks/s]
Processed prompts:  50%|█████     | 128/256 [00:06<00:07, 17.49it/s, est. speed input: 19817.47 toks/s, output: 19.35 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:06<00:07, 17.49it/s, est. speed input: 19785.58 toks/s, output: 19.32 toks/s]
Processed prompts:  52%|█████▏    | 132/256 [00:06<00:07, 17.51it/s, est. speed input: 19755.09 toks/s, output: 19.29 toks/s]
Processed prompts:  52%|█████▏    | 134/256 [00:06<00:06, 17.48it/s, est. speed input: 19723.43 toks/s, output: 19.26 toks/s]
Processed prompts:  53%|█████▎    | 136/256 [00:07<00:06, 17.50it/s, est. speed input: 19694.96 toks/s, output: 19.23 toks/s]
Processed prompts:  54%|█████▍    | 138/256 [00:07<00:06, 17.50it/s, est. speed input: 19666.90 toks/s, output: 19.21 toks/s]
Processed prompts:  55%|█████▍    | 140/256 [00:07<00:06, 17.47it/s, est. speed input: 19637.57 toks/s, output: 19.18 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:07<00:06, 17.45it/s, est. speed input: 19609.74 toks/s, output: 19.15 toks/s]
Processed prompts:  56%|█████▋    | 144/256 [00:07<00:06, 17.44it/s, est. speed input: 19582.44 toks/s, output: 19.12 toks/s]
Processed prompts:  57%|█████▋    | 146/256 [00:07<00:06, 17.44it/s, est. speed input: 19556.91 toks/s, output: 19.10 toks/s]
Processed prompts:  58%|█████▊    | 148/256 [00:07<00:06, 17.46it/s, est. speed input: 19532.52 toks/s, output: 19.07 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:07<00:06, 17.45it/s, est. speed input: 19508.32 toks/s, output: 19.05 toks/s]
Processed prompts:  59%|█████▉    | 152/256 [00:07<00:05, 17.45it/s, est. speed input: 19484.63 toks/s, output: 19.03 toks/s]
Processed prompts:  60%|██████    | 154/256 [00:08<00:05, 17.45it/s, est. speed input: 19461.51 toks/s, output: 19.01 toks/s]
Processed prompts:  61%|██████    | 156/256 [00:08<00:05, 17.46it/s, est. speed input: 19439.83 toks/s, output: 18.98 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:08<00:05, 17.44it/s, est. speed input: 19417.36 toks/s, output: 18.96 toks/s]
Processed prompts:  62%|██████▎   | 160/256 [00:08<00:05, 17.44it/s, est. speed input: 19396.10 toks/s, output: 18.94 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:08<00:05, 17.46it/s, est. speed input: 19376.41 toks/s, output: 18.92 toks/s]
Processed prompts:  64%|██████▍   | 164/256 [00:08<00:05, 17.48it/s, est. speed input: 19357.96 toks/s, output: 18.90 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:08<00:05, 17.48it/s, est. speed input: 19339.05 toks/s, output: 18.89 toks/s]
Processed prompts:  66%|██████▌   | 168/256 [00:08<00:05, 17.47it/s, est. speed input: 19320.04 toks/s, output: 18.87 toks/s]
Processed prompts:  66%|██████▋   | 170/256 [00:09<00:04, 17.46it/s, est. speed input: 19301.41 toks/s, output: 18.85 toks/s]
Processed prompts:  67%|██████▋   | 172/256 [00:09<00:04, 17.48it/s, est. speed input: 19284.57 toks/s, output: 18.83 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:09<00:04, 17.50it/s, est. speed input: 19268.16 toks/s, output: 18.82 toks/s]
Processed prompts:  69%|██████▉   | 176/256 [00:09<00:04, 17.49it/s, est. speed input: 19251.49 toks/s, output: 18.80 toks/s]
Processed prompts:  70%|██████▉   | 178/256 [00:09<00:04, 17.48it/s, est. speed input: 19234.67 toks/s, output: 18.78 toks/s]
Processed prompts:  70%|███████   | 180/256 [00:09<00:04, 17.48it/s, est. speed input: 19218.83 toks/s, output: 18.77 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:09<00:04, 17.51it/s, est. speed input: 19204.53 toks/s, output: 18.75 toks/s]
Processed prompts:  72%|███████▏  | 184/256 [00:09<00:04, 17.51it/s, est. speed input: 19189.52 toks/s, output: 18.74 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:09<00:03, 17.51it/s, est. speed input: 19175.03 toks/s, output: 18.73 toks/s]
Processed prompts:  73%|███████▎  | 188/256 [00:10<00:03, 17.51it/s, est. speed input: 19160.84 toks/s, output: 18.71 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:10<00:03, 17.51it/s, est. speed input: 19147.30 toks/s, output: 18.70 toks/s]
Processed prompts:  75%|███████▌  | 192/256 [00:10<00:03, 17.53it/s, est. speed input: 19134.52 toks/s, output: 18.69 toks/s]
Processed prompts:  76%|███████▌  | 194/256 [00:10<00:03, 17.52it/s, est. speed input: 19120.97 toks/s, output: 18.67 toks/s]
Processed prompts:  77%|███████▋  | 196/256 [00:10<00:03, 17.48it/s, est. speed input: 19106.53 toks/s, output: 18.66 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:10<00:03, 17.46it/s, est. speed input: 19092.79 toks/s, output: 18.65 toks/s]
Processed prompts:  78%|███████▊  | 200/256 [00:10<00:03, 17.45it/s, est. speed input: 19079.47 toks/s, output: 18.63 toks/s]
Processed prompts:  79%|███████▉  | 202/256 [00:10<00:03, 17.45it/s, est. speed input: 19066.75 toks/s, output: 18.62 toks/s]
Processed prompts:  80%|███████▉  | 204/256 [00:10<00:02, 17.46it/s, est. speed input: 19054.68 toks/s, output: 18.61 toks/s]
Processed prompts:  80%|████████  | 206/256 [00:11<00:02, 17.43it/s, est. speed input: 19041.49 toks/s, output: 18.60 toks/s]
Processed prompts:  81%|████████▏ | 208/256 [00:11<00:02, 17.43it/s, est. speed input: 19028.96 toks/s, output: 18.58 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:11<00:02, 17.42it/s, est. speed input: 19016.69 toks/s, output: 18.57 toks/s]
Processed prompts:  83%|████████▎ | 212/256 [00:11<00:02, 17.43it/s, est. speed input: 19005.22 toks/s, output: 18.56 toks/s]
Processed prompts:  84%|████████▎ | 214/256 [00:11<00:02, 17.41it/s, est. speed input: 18992.96 toks/s, output: 18.55 toks/s]
Processed prompts:  84%|████████▍ | 216/256 [00:11<00:02, 17.44it/s, est. speed input: 18982.57 toks/s, output: 18.54 toks/s]
Processed prompts:  85%|████████▌ | 218/256 [00:11<00:02, 17.47it/s, est. speed input: 18972.60 toks/s, output: 18.53 toks/s]
Processed prompts:  86%|████████▌ | 220/256 [00:11<00:02, 17.48it/s, est. speed input: 18962.53 toks/s, output: 18.52 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:11<00:01, 17.46it/s, est. speed input: 18951.77 toks/s, output: 18.51 toks/s]
Processed prompts:  88%|████████▊ | 224/256 [00:12<00:01, 17.45it/s, est. speed input: 18941.40 toks/s, output: 18.50 toks/s]
Processed prompts:  88%|████████▊ | 226/256 [00:12<00:01, 17.45it/s, est. speed input: 18931.33 toks/s, output: 18.49 toks/s]
Processed prompts:  89%|████████▉ | 228/256 [00:12<00:01, 17.46it/s, est. speed input: 18921.83 toks/s, output: 18.48 toks/s]
Processed prompts:  90%|████████▉ | 230/256 [00:12<00:01, 17.44it/s, est. speed input: 18911.75 toks/s, output: 18.47 toks/s]
Processed prompts:  91%|█████████ | 232/256 [00:12<00:01, 17.45it/s, est. speed input: 18902.16 toks/s, output: 18.46 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:12<00:01, 17.45it/s, est. speed input: 18892.78 toks/s, output: 18.45 toks/s]
Processed prompts:  92%|█████████▏| 236/256 [00:12<00:01, 17.45it/s, est. speed input: 18883.78 toks/s, output: 18.44 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:12<00:01, 17.46it/s, est. speed input: 18874.99 toks/s, output: 18.43 toks/s]
Processed prompts:  94%|█████████▍| 240/256 [00:13<00:00, 17.47it/s, est. speed input: 18866.69 toks/s, output: 18.42 toks/s]
Processed prompts:  95%|█████████▍| 242/256 [00:13<00:00, 17.45it/s, est. speed input: 18857.37 toks/s, output: 18.42 toks/s]
Processed prompts:  95%|█████████▌| 244/256 [00:13<00:00, 17.47it/s, est. speed input: 18849.39 toks/s, output: 18.41 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:13<00:00, 17.47it/s, est. speed input: 18841.18 toks/s, output: 18.40 toks/s]
Processed prompts:  97%|█████████▋| 248/256 [00:13<00:00, 17.43it/s, est. speed input: 18832.06 toks/s, output: 18.39 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:13<00:00, 17.41it/s, est. speed input: 18823.15 toks/s, output: 18.38 toks/s]
Processed prompts:  98%|█████████▊| 252/256 [00:13<00:00, 17.40it/s, est. speed input: 18814.57 toks/s, output: 18.37 toks/s]
Processed prompts:  99%|█████████▉| 254/256 [00:13<00:00, 17.40it/s, est. speed input: 18806.05 toks/s, output: 18.37 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:13<00:00, 17.40it/s, est. speed input: 18870.97 toks/s, output: 18.43 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:13<00:00, 18.43it/s, est. speed input: 18870.97 toks/s, output: 18.43 toks/s]
[rank0]:[W126 04:49:03.523857207 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 64.1s

测试结果:
  Requests/s:   17.19
  Tokens/s:     17617.78
  Total Reqs:   256
  Elapsed:      14.89s

  [Prefill 分析]
  Total Prefill Tokens: 262144
  Prefill Tokens/s:     17600.59

============================================================
[4/8] 测试 M=4096
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 4096
│   M_prefill     = 4096 (= 4 x 1024)
│   M_decode      = 4
│   batched_tokens = 4096 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 512
│   --max-num-seqs           = 4
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 4096
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 04:49:16 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 04:49:17 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=195278) WARNING 01-26 04:49:25 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=195278) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=195278) WARNING 01-26 04:49:38 [backends.py:609] Failed to read file <frozen os>
Throughput: 17.94 requests/s, 18388.07 total tokens/s, 17.94 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512


─── STDERR ───
[2026-01-26 04:49:16] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 04:49:16] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:49:16] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 04:49:16] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:49:16] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:49:16] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:49:16] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:49:16] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:49:16] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:49:16] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 04:49:16] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 04:49:16] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 04:49:16] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 04:49:16] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 04:49:24] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 04:49:24] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:49:24] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 04:49:24] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:49:24] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:49:24] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:49:24] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:49:24] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:49:24] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:49:24] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 04:49:24] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 04:49:24] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 04:49:24] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 04:49:24] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=195278) [2026-01-26 04:49:25] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=195278) [2026-01-26 04:49:25] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=195278) [2026-01-26 04:49:25] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=195278) [2026-01-26 04:49:25] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=195278) [2026-01-26 04:49:25] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=195278) [2026-01-26 04:49:25] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=195278) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=195278) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.01it/s]
(EngineCore_DP0 pid=195278) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.27s/it]
(EngineCore_DP0 pid=195278) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.23s/it]
(EngineCore_DP0 pid=195278) 
(EngineCore_DP0 pid=195278) [2026-01-26 04:49:28] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 5760] -> 1D uint8
(EngineCore_DP0 pid=195278) [2026-01-26 04:49:28] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 19906560 bytes
(EngineCore_DP0 pid=195278) [2026-01-26 04:49:28] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 5760] -> 1D uint8
(EngineCore_DP0 pid=195278) [2026-01-26 04:49:28] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 15482880 bytes
(EngineCore_DP0 pid=195278) [2026-01-26 04:49:28] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 5760] -> 1D uint8
(EngineCore_DP0 pid=195278) [2026-01-26 04:49:28] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 163676160 bytes
(EngineCore_DP0 pid=195278) [2026-01-26 04:49:28] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 30336] -> 1D uint8
(EngineCore_DP0 pid=195278) [2026-01-26 04:49:28] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 81543168 bytes
(EngineCore_DP0 pid=195278) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  25%|██▌       | 1/4 [00:00<00:00,  8.28it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 2/4 [00:00<00:00,  8.76it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  75%|███████▌  | 3/4 [00:00<00:00,  9.05it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  8.36it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  8.51it/s]
(EngineCore_DP0 pid=195278) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  33%|███▎      | 1/3 [00:00<00:00,  7.31it/s]
Capturing CUDA graphs (decode, FULL):  67%|██████▋   | 2/3 [00:00<00:00,  8.46it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  8.91it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  8.64it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   4%|▍         | 23/512 [00:00<00:02, 228.67it/s]
Adding requests:  10%|▉         | 50/512 [00:00<00:01, 247.57it/s]
Adding requests:  15%|█▌        | 78/512 [00:00<00:01, 259.11it/s]
Adding requests:  20%|██        | 104/512 [00:00<00:01, 258.87it/s]
Adding requests:  26%|██▌       | 131/512 [00:00<00:01, 260.07it/s]
Adding requests:  31%|███       | 159/512 [00:00<00:01, 265.33it/s]
Adding requests:  36%|███▋      | 186/512 [00:00<00:01, 265.98it/s]
Adding requests:  42%|████▏     | 213/512 [00:00<00:01, 262.98it/s]
Adding requests:  47%|████▋     | 240/512 [00:00<00:01, 261.78it/s]
Adding requests:  52%|█████▏    | 267/512 [00:01<00:00, 263.67it/s]
Adding requests:  57%|█████▋    | 294/512 [00:01<00:00, 261.87it/s]
Adding requests:  63%|██████▎   | 322/512 [00:01<00:00, 266.05it/s]
Adding requests:  68%|██████▊   | 350/512 [00:01<00:00, 268.62it/s]
Adding requests:  74%|███████▍  | 378/512 [00:01<00:00, 270.15it/s]
Adding requests:  79%|███████▉  | 407/512 [00:01<00:00, 275.13it/s]
Adding requests:  85%|████████▍ | 435/512 [00:01<00:00, 272.36it/s]
Adding requests:  90%|█████████ | 463/512 [00:01<00:00, 270.07it/s]
Adding requests:  96%|█████████▌| 491/512 [00:01<00:00, 271.21it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 265.35it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▌         | 30/512 [00:00<00:01, 254.38it/s, est. speed input: 260549.49 toks/s, output: 254.40 toks/s]
Processed prompts:  11%|█         | 56/512 [00:01<00:13, 33.61it/s, est. speed input: 39998.76 toks/s, output: 39.06 toks/s]   
Processed prompts:  13%|█▎        | 68/512 [00:02<00:16, 27.43it/s, est. speed input: 33288.23 toks/s, output: 32.51 toks/s]
Processed prompts:  15%|█▍        | 76/512 [00:02<00:17, 24.88it/s, est. speed input: 30753.99 toks/s, output: 30.03 toks/s]
Processed prompts:  16%|█▌        | 82/512 [00:02<00:19, 21.72it/s, est. speed input: 28287.55 toks/s, output: 27.62 toks/s]
Processed prompts:  17%|█▋        | 86/512 [00:03<00:20, 21.14it/s, est. speed input: 27627.75 toks/s, output: 26.98 toks/s]
Processed prompts:  18%|█▊        | 90/512 [00:03<00:20, 20.57it/s, est. speed input: 27050.35 toks/s, output: 26.42 toks/s]
Processed prompts:  18%|█▊        | 94/512 [00:03<00:20, 20.06it/s, est. speed input: 26541.81 toks/s, output: 25.92 toks/s]
Processed prompts:  19%|█▉        | 98/512 [00:03<00:21, 19.62it/s, est. speed input: 26089.65 toks/s, output: 25.48 toks/s]
Processed prompts:  20%|█▉        | 102/512 [00:04<00:21, 19.26it/s, est. speed input: 25687.06 toks/s, output: 25.08 toks/s]
Processed prompts:  21%|██        | 106/512 [00:04<00:21, 18.99it/s, est. speed input: 25327.45 toks/s, output: 24.73 toks/s]
Processed prompts:  21%|██▏       | 110/512 [00:04<00:21, 18.77it/s, est. speed input: 25000.93 toks/s, output: 24.41 toks/s]
Processed prompts:  22%|██▏       | 114/512 [00:04<00:21, 18.61it/s, est. speed input: 24706.39 toks/s, output: 24.13 toks/s]
Processed prompts:  23%|██▎       | 118/512 [00:04<00:21, 18.50it/s, est. speed input: 24437.05 toks/s, output: 23.86 toks/s]
Processed prompts:  24%|██▍       | 122/512 [00:05<00:21, 18.42it/s, est. speed input: 24191.52 toks/s, output: 23.62 toks/s]
Processed prompts:  25%|██▍       | 126/512 [00:05<00:21, 18.35it/s, est. speed input: 23964.45 toks/s, output: 23.40 toks/s]
Processed prompts:  25%|██▌       | 130/512 [00:05<00:20, 18.31it/s, est. speed input: 23755.10 toks/s, output: 23.20 toks/s]
Processed prompts:  26%|██▌       | 134/512 [00:05<00:20, 18.28it/s, est. speed input: 23562.82 toks/s, output: 23.01 toks/s]
Processed prompts:  27%|██▋       | 138/512 [00:06<00:20, 18.26it/s, est. speed input: 23384.18 toks/s, output: 22.84 toks/s]
Processed prompts:  28%|██▊       | 142/512 [00:06<00:20, 18.24it/s, est. speed input: 23217.96 toks/s, output: 22.67 toks/s]
Processed prompts:  29%|██▊       | 146/512 [00:06<00:20, 18.22it/s, est. speed input: 23061.30 toks/s, output: 22.52 toks/s]
Processed prompts:  29%|██▉       | 150/512 [00:06<00:19, 18.21it/s, est. speed input: 22915.05 toks/s, output: 22.38 toks/s]
Processed prompts:  30%|███       | 154/512 [00:06<00:19, 18.19it/s, est. speed input: 22777.33 toks/s, output: 22.24 toks/s]
Processed prompts:  31%|███       | 158/512 [00:07<00:19, 18.17it/s, est. speed input: 22647.45 toks/s, output: 22.12 toks/s]
Processed prompts:  32%|███▏      | 162/512 [00:07<00:19, 18.17it/s, est. speed input: 22526.56 toks/s, output: 22.00 toks/s]
Processed prompts:  32%|███▏      | 166/512 [00:07<00:19, 18.16it/s, est. speed input: 22411.82 toks/s, output: 21.89 toks/s]
Processed prompts:  33%|███▎      | 170/512 [00:07<00:18, 18.16it/s, est. speed input: 22303.61 toks/s, output: 21.78 toks/s]
Processed prompts:  34%|███▍      | 174/512 [00:08<00:18, 18.16it/s, est. speed input: 22201.84 toks/s, output: 21.68 toks/s]
Processed prompts:  35%|███▍      | 178/512 [00:08<00:18, 18.16it/s, est. speed input: 22105.48 toks/s, output: 21.59 toks/s]
Processed prompts:  36%|███▌      | 182/512 [00:08<00:18, 18.15it/s, est. speed input: 22013.08 toks/s, output: 21.50 toks/s]
Processed prompts:  36%|███▋      | 186/512 [00:08<00:17, 18.15it/s, est. speed input: 21925.74 toks/s, output: 21.41 toks/s]
Processed prompts:  37%|███▋      | 190/512 [00:08<00:17, 18.15it/s, est. speed input: 21843.82 toks/s, output: 21.33 toks/s]
Processed prompts:  38%|███▊      | 194/512 [00:09<00:17, 18.15it/s, est. speed input: 21764.84 toks/s, output: 21.25 toks/s]
Processed prompts:  39%|███▊      | 198/512 [00:09<00:17, 18.14it/s, est. speed input: 21689.19 toks/s, output: 21.18 toks/s]
Processed prompts:  39%|███▉      | 202/512 [00:09<00:17, 18.13it/s, est. speed input: 21616.50 toks/s, output: 21.11 toks/s]
Processed prompts:  40%|████      | 206/512 [00:09<00:16, 18.13it/s, est. speed input: 21547.46 toks/s, output: 21.04 toks/s]
Processed prompts:  41%|████      | 210/512 [00:10<00:16, 18.12it/s, est. speed input: 21480.70 toks/s, output: 20.98 toks/s]
Processed prompts:  42%|████▏     | 214/512 [00:10<00:16, 18.11it/s, est. speed input: 21416.88 toks/s, output: 20.91 toks/s]
Processed prompts:  43%|████▎     | 218/512 [00:10<00:16, 18.10it/s, est. speed input: 21355.79 toks/s, output: 20.86 toks/s]
Processed prompts:  43%|████▎     | 222/512 [00:10<00:16, 18.10it/s, est. speed input: 21297.14 toks/s, output: 20.80 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:10<00:15, 18.09it/s, est. speed input: 21239.93 toks/s, output: 20.74 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:11<00:15, 18.09it/s, est. speed input: 21186.24 toks/s, output: 20.69 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:11<00:15, 18.10it/s, est. speed input: 21134.73 toks/s, output: 20.64 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:11<00:15, 18.10it/s, est. speed input: 21084.86 toks/s, output: 20.59 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:11<00:14, 18.09it/s, est. speed input: 21036.16 toks/s, output: 20.54 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:12<00:14, 18.07it/s, est. speed input: 20989.05 toks/s, output: 20.50 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:12<00:14, 18.07it/s, est. speed input: 20944.08 toks/s, output: 20.45 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:12<00:14, 18.07it/s, est. speed input: 20900.59 toks/s, output: 20.41 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:12<00:14, 18.07it/s, est. speed input: 20858.76 toks/s, output: 20.37 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:12<00:13, 18.07it/s, est. speed input: 20817.98 toks/s, output: 20.33 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:13<00:13, 18.06it/s, est. speed input: 20778.64 toks/s, output: 20.29 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:13<00:13, 18.06it/s, est. speed input: 20740.67 toks/s, output: 20.25 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:13<00:13, 18.06it/s, est. speed input: 20704.08 toks/s, output: 20.22 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:13<00:12, 18.06it/s, est. speed input: 20668.45 toks/s, output: 20.18 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:13<00:12, 18.05it/s, est. speed input: 20633.60 toks/s, output: 20.15 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:14<00:12, 18.04it/s, est. speed input: 20599.51 toks/s, output: 20.12 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:14<00:12, 18.06it/s, est. speed input: 20567.72 toks/s, output: 20.09 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:14<00:12, 18.06it/s, est. speed input: 20536.53 toks/s, output: 20.06 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:14<00:11, 18.05it/s, est. speed input: 20505.43 toks/s, output: 20.02 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:15<00:11, 18.04it/s, est. speed input: 20475.39 toks/s, output: 20.00 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:15<00:11, 18.05it/s, est. speed input: 20446.90 toks/s, output: 19.97 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:15<00:11, 18.05it/s, est. speed input: 20418.89 toks/s, output: 19.94 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:15<00:10, 18.05it/s, est. speed input: 20391.44 toks/s, output: 19.91 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:15<00:10, 18.04it/s, est. speed input: 20364.80 toks/s, output: 19.89 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:16<00:10, 18.04it/s, est. speed input: 20338.67 toks/s, output: 19.86 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:16<00:10, 18.05it/s, est. speed input: 20314.03 toks/s, output: 19.84 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:16<00:10, 18.05it/s, est. speed input: 20289.70 toks/s, output: 19.81 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:16<00:09, 18.04it/s, est. speed input: 20265.54 toks/s, output: 19.79 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:17<00:09, 18.04it/s, est. speed input: 20242.30 toks/s, output: 19.77 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:17<00:09, 18.03it/s, est. speed input: 20219.14 toks/s, output: 19.75 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:17<00:09, 18.02it/s, est. speed input: 20196.63 toks/s, output: 19.72 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:17<00:08, 18.02it/s, est. speed input: 20174.64 toks/s, output: 19.70 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:17<00:08, 18.02it/s, est. speed input: 20153.49 toks/s, output: 19.68 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:18<00:08, 18.02it/s, est. speed input: 20132.76 toks/s, output: 19.66 toks/s]
Processed prompts:  71%|███████   | 362/512 [00:18<00:08, 18.02it/s, est. speed input: 20112.61 toks/s, output: 19.64 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:18<00:08, 18.01it/s, est. speed input: 20092.36 toks/s, output: 19.62 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [00:18<00:07, 18.00it/s, est. speed input: 20072.69 toks/s, output: 19.60 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [00:19<00:07, 18.00it/s, est. speed input: 20053.41 toks/s, output: 19.58 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [00:19<00:07, 18.00it/s, est. speed input: 20034.66 toks/s, output: 19.57 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [00:19<00:07, 18.00it/s, est. speed input: 20016.61 toks/s, output: 19.55 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [00:19<00:07, 18.00it/s, est. speed input: 19998.69 toks/s, output: 19.53 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [00:19<00:06, 18.00it/s, est. speed input: 19981.10 toks/s, output: 19.51 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [00:20<00:06, 17.99it/s, est. speed input: 19963.94 toks/s, output: 19.50 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [00:20<00:06, 18.00it/s, est. speed input: 19947.27 toks/s, output: 19.48 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [00:20<00:06, 17.99it/s, est. speed input: 19930.81 toks/s, output: 19.46 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [00:20<00:05, 17.99it/s, est. speed input: 19914.65 toks/s, output: 19.45 toks/s]
Processed prompts:  80%|████████  | 410/512 [00:21<00:05, 17.99it/s, est. speed input: 19898.76 toks/s, output: 19.43 toks/s]
Processed prompts:  81%|████████  | 414/512 [00:21<00:05, 17.99it/s, est. speed input: 19883.56 toks/s, output: 19.42 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [00:21<00:05, 17.99it/s, est. speed input: 19868.31 toks/s, output: 19.40 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [00:21<00:05, 17.99it/s, est. speed input: 19853.48 toks/s, output: 19.39 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [00:21<00:04, 17.98it/s, est. speed input: 19838.82 toks/s, output: 19.37 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [00:22<00:04, 17.99it/s, est. speed input: 19824.89 toks/s, output: 19.36 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [00:22<00:00, 54.22it/s, est. speed input: 20955.65 toks/s, output: 20.46 toks/s]
Processed prompts:  91%|█████████ | 465/512 [00:22<00:00, 47.04it/s, est. speed input: 21066.54 toks/s, output: 20.57 toks/s]
Processed prompts:  92%|█████████▏| 471/512 [00:23<00:01, 31.14it/s, est. speed input: 20927.02 toks/s, output: 20.44 toks/s]
Processed prompts:  93%|█████████▎| 476/512 [00:23<00:01, 28.96it/s, est. speed input: 20947.32 toks/s, output: 20.46 toks/s]
Processed prompts:  94%|█████████▍| 480/512 [00:23<00:01, 26.06it/s, est. speed input: 20923.71 toks/s, output: 20.43 toks/s]
Processed prompts:  95%|█████████▍| 484/512 [00:23<00:01, 23.84it/s, est. speed input: 20900.28 toks/s, output: 20.41 toks/s]
Processed prompts:  95%|█████████▌| 487/512 [00:23<00:01, 20.92it/s, est. speed input: 20834.49 toks/s, output: 20.35 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [00:24<00:01, 18.79it/s, est. speed input: 20770.00 toks/s, output: 20.28 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [00:24<00:00, 18.56it/s, est. speed input: 20748.59 toks/s, output: 20.26 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [00:24<00:00, 18.39it/s, est. speed input: 20727.70 toks/s, output: 20.24 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [00:24<00:00, 18.28it/s, est. speed input: 20707.14 toks/s, output: 20.22 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [00:25<00:00, 18.21it/s, est. speed input: 20687.58 toks/s, output: 20.20 toks/s]
Processed prompts: 100%|█████████▉| 510/512 [00:25<00:00, 19.32it/s, est. speed input: 20704.79 toks/s, output: 20.22 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:25<00:00, 19.32it/s, est. speed input: 20785.79 toks/s, output: 20.30 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:25<00:00, 20.30it/s, est. speed input: 20785.79 toks/s, output: 20.30 toks/s]
[rank0]:[W126 04:50:22.219354466 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 78.6s

测试结果:
  Requests/s:   17.94
  Tokens/s:     18388.07
  Total Reqs:   512
  Elapsed:      28.54s

  [Prefill 分析]
  Total Prefill Tokens: 524288
  Prefill Tokens/s:     18370.13

============================================================
[5/8] 测试 M=8192
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 8192
│   M_prefill     = 8192 (= 8 x 1024)
│   M_decode      = 8
│   batched_tokens = 8192 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 1024
│   --max-num-seqs           = 8
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 8192
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 04:50:40 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 04:50:41 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=196692) WARNING 01-26 04:50:48 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=196692) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=196692) WARNING 01-26 04:51:00 [backends.py:609] Failed to read file <frozen os>
Throughput: 18.14 requests/s, 18591.02 total tokens/s, 18.14 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024


─── STDERR ───
[2026-01-26 04:50:40] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 04:50:40] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:50:40] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 04:50:40] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:50:40] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:50:40] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:50:40] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:50:40] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:50:40] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:50:40] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 04:50:40] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 04:50:40] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 04:50:40] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 04:50:40] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 04:50:48] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 04:50:48] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:50:48] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 04:50:48] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:50:48] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:50:48] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:50:48] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:50:48] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:50:48] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:50:48] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 04:50:48] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 04:50:48] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 04:50:48] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 04:50:48] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=196692) [2026-01-26 04:50:49] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=196692) [2026-01-26 04:50:49] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=196692) [2026-01-26 04:50:49] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=196692) [2026-01-26 04:50:49] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=196692) [2026-01-26 04:50:49] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=196692) [2026-01-26 04:50:49] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=196692) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=196692) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.95it/s]
(EngineCore_DP0 pid=196692) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.94it/s]
(EngineCore_DP0 pid=196692) 
(EngineCore_DP0 pid=196692) [2026-01-26 04:50:51] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 5760] -> 1D uint8
(EngineCore_DP0 pid=196692) [2026-01-26 04:50:51] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 19906560 bytes
(EngineCore_DP0 pid=196692) [2026-01-26 04:50:51] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 5760] -> 1D uint8
(EngineCore_DP0 pid=196692) [2026-01-26 04:50:51] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 15482880 bytes
(EngineCore_DP0 pid=196692) [2026-01-26 04:50:51] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 5760] -> 1D uint8
(EngineCore_DP0 pid=196692) [2026-01-26 04:50:51] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 163676160 bytes
(EngineCore_DP0 pid=196692) [2026-01-26 04:50:51] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 30336] -> 1D uint8
(EngineCore_DP0 pid=196692) [2026-01-26 04:50:51] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 81543168 bytes
(EngineCore_DP0 pid=196692) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:01,  2.39it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  40%|████      | 2/5 [00:00<00:00,  4.18it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  60%|██████    | 3/5 [00:00<00:00,  5.58it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  80%|████████  | 4/5 [00:00<00:00,  6.58it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00,  6.78it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00,  5.62it/s]
(EngineCore_DP0 pid=196692) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:00,  7.45it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 2/4 [00:00<00:00,  8.53it/s]
Capturing CUDA graphs (decode, FULL):  75%|███████▌  | 3/4 [00:00<00:00,  8.95it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  9.14it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  8.87it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 23/1024 [00:00<00:04, 228.61it/s]
Adding requests:   5%|▍         | 47/1024 [00:00<00:04, 233.69it/s]
Adding requests:   7%|▋         | 73/1024 [00:00<00:03, 245.22it/s]
Adding requests:  10%|▉         | 98/1024 [00:00<00:03, 246.58it/s]
Adding requests:  12%|█▏        | 125/1024 [00:00<00:03, 253.02it/s]
Adding requests:  15%|█▍        | 151/1024 [00:00<00:03, 253.00it/s]
Adding requests:  17%|█▋        | 179/1024 [00:00<00:03, 258.71it/s]
Adding requests:  20%|██        | 208/1024 [00:00<00:03, 265.38it/s]
Adding requests:  23%|██▎       | 236/1024 [00:00<00:02, 269.61it/s]
Adding requests:  26%|██▌       | 263/1024 [00:01<00:02, 266.52it/s]
Adding requests:  28%|██▊       | 290/1024 [00:01<00:02, 264.47it/s]
Adding requests:  31%|███       | 319/1024 [00:01<00:02, 270.87it/s]
Adding requests:  34%|███▍      | 347/1024 [00:01<00:02, 270.76it/s]
Adding requests:  37%|███▋      | 376/1024 [00:01<00:02, 276.44it/s]
Adding requests:  40%|███▉      | 406/1024 [00:01<00:02, 282.47it/s]
Adding requests:  42%|████▏     | 435/1024 [00:01<00:02, 277.10it/s]
Adding requests:  45%|████▌     | 463/1024 [00:01<00:02, 275.10it/s]
Adding requests:  48%|████▊     | 493/1024 [00:01<00:01, 282.34it/s]
Adding requests:  51%|█████     | 524/1024 [00:01<00:01, 289.51it/s]
Adding requests:  54%|█████▍    | 553/1024 [00:02<00:01, 286.07it/s]
Adding requests:  93%|█████████▎| 955/1024 [00:02<00:00, 1382.13it/s]
Adding requests: 100%|██████████| 1024/1024 [00:02<00:00, 423.48it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▋         | 66/1024 [00:00<00:05, 160.34it/s, est. speed input: 164195.92 toks/s, output: 160.34 toks/s]
Processed prompts:   8%|▊         | 83/1024 [00:01<00:17, 54.62it/s, est. speed input: 66375.95 toks/s, output: 64.82 toks/s]   
Processed prompts:   9%|▉         | 91/1024 [00:01<00:22, 41.98it/s, est. speed input: 54332.02 toks/s, output: 53.06 toks/s]
Processed prompts:  10%|▉         | 98/1024 [00:02<00:27, 33.37it/s, est. speed input: 46684.41 toks/s, output: 45.59 toks/s]
Processed prompts:  10%|█         | 106/1024 [00:02<00:32, 28.54it/s, est. speed input: 41994.73 toks/s, output: 41.01 toks/s]
Processed prompts:  11%|█         | 114/1024 [00:03<00:35, 25.33it/s, est. speed input: 38653.96 toks/s, output: 37.75 toks/s]
Processed prompts:  12%|█▏        | 122/1024 [00:03<00:38, 23.17it/s, est. speed input: 36152.26 toks/s, output: 35.30 toks/s]
Processed prompts:  13%|█▎        | 130/1024 [00:03<00:41, 21.69it/s, est. speed input: 34210.45 toks/s, output: 33.41 toks/s]
Processed prompts:  13%|█▎        | 138/1024 [00:04<00:42, 20.67it/s, est. speed input: 32655.87 toks/s, output: 31.89 toks/s]
Processed prompts:  14%|█▍        | 146/1024 [00:04<00:43, 19.95it/s, est. speed input: 31382.59 toks/s, output: 30.65 toks/s]
Processed prompts:  15%|█▌        | 154/1024 [00:05<00:44, 19.46it/s, est. speed input: 30324.50 toks/s, output: 29.61 toks/s]
Processed prompts:  16%|█▌        | 162/1024 [00:05<00:45, 19.11it/s, est. speed input: 29426.92 toks/s, output: 28.74 toks/s]
Processed prompts:  17%|█▋        | 170/1024 [00:06<00:45, 18.87it/s, est. speed input: 28658.77 toks/s, output: 27.99 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [00:06<00:45, 18.70it/s, est. speed input: 27991.93 toks/s, output: 27.34 toks/s]
Processed prompts:  18%|█▊        | 186/1024 [00:06<00:45, 18.58it/s, est. speed input: 27409.72 toks/s, output: 26.77 toks/s]
Processed prompts:  19%|█▉        | 194/1024 [00:07<00:44, 18.49it/s, est. speed input: 26894.98 toks/s, output: 26.26 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [00:07<00:44, 18.42it/s, est. speed input: 26437.37 toks/s, output: 25.82 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:08<00:44, 18.38it/s, est. speed input: 26028.13 toks/s, output: 25.42 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [00:08<00:43, 18.35it/s, est. speed input: 25659.44 toks/s, output: 25.06 toks/s]
Processed prompts:  22%|██▏       | 226/1024 [00:09<00:43, 18.32it/s, est. speed input: 25325.16 toks/s, output: 24.73 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:09<00:43, 18.30it/s, est. speed input: 25021.58 toks/s, output: 24.44 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:10<00:42, 18.28it/s, est. speed input: 24744.27 toks/s, output: 24.16 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:10<00:42, 18.27it/s, est. speed input: 24489.48 toks/s, output: 23.92 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:10<00:41, 18.26it/s, est. speed input: 24255.26 toks/s, output: 23.69 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:11<00:41, 18.25it/s, est. speed input: 24038.95 toks/s, output: 23.48 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:11<00:41, 18.24it/s, est. speed input: 23838.63 toks/s, output: 23.28 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:12<00:40, 18.24it/s, est. speed input: 23652.28 toks/s, output: 23.10 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:12<00:40, 18.23it/s, est. speed input: 23478.62 toks/s, output: 22.93 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:13<00:39, 18.22it/s, est. speed input: 23316.34 toks/s, output: 22.77 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:13<00:39, 18.22it/s, est. speed input: 23164.26 toks/s, output: 22.62 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:13<00:38, 18.21it/s, est. speed input: 23022.01 toks/s, output: 22.48 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:14<00:38, 18.21it/s, est. speed input: 22888.21 toks/s, output: 22.35 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:14<00:38, 18.20it/s, est. speed input: 22761.34 toks/s, output: 22.23 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:15<00:37, 18.20it/s, est. speed input: 22642.77 toks/s, output: 22.11 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:15<00:37, 18.19it/s, est. speed input: 22530.25 toks/s, output: 22.00 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:16<00:36, 18.20it/s, est. speed input: 22424.29 toks/s, output: 21.90 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:16<00:36, 18.19it/s, est. speed input: 22323.50 toks/s, output: 21.80 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:17<00:35, 18.19it/s, est. speed input: 22228.35 toks/s, output: 21.71 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:17<00:35, 18.19it/s, est. speed input: 22137.82 toks/s, output: 21.62 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:17<00:35, 18.20it/s, est. speed input: 22052.01 toks/s, output: 21.54 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [00:18<00:34, 18.20it/s, est. speed input: 21970.09 toks/s, output: 21.46 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:18<00:34, 18.19it/s, est. speed input: 21891.93 toks/s, output: 21.38 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:19<00:33, 18.19it/s, est. speed input: 21817.47 toks/s, output: 21.31 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:19<00:33, 18.20it/s, est. speed input: 21746.42 toks/s, output: 21.24 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:20<00:32, 18.20it/s, est. speed input: 21678.38 toks/s, output: 21.17 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:20<00:32, 18.20it/s, est. speed input: 21613.37 toks/s, output: 21.11 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:21<00:31, 18.19it/s, est. speed input: 21550.72 toks/s, output: 21.05 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:21<00:31, 18.20it/s, est. speed input: 21490.93 toks/s, output: 20.99 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:21<00:31, 18.19it/s, est. speed input: 21433.44 toks/s, output: 20.93 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:22<00:30, 18.19it/s, est. speed input: 21378.26 toks/s, output: 20.88 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:22<00:30, 18.20it/s, est. speed input: 21325.51 toks/s, output: 20.83 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:23<00:29, 18.20it/s, est. speed input: 21274.59 toks/s, output: 20.78 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:23<00:29, 18.20it/s, est. speed input: 21225.31 toks/s, output: 20.73 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:24<00:28, 18.20it/s, est. speed input: 21177.99 toks/s, output: 20.68 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:24<00:28, 18.19it/s, est. speed input: 21131.91 toks/s, output: 20.64 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:24<00:28, 18.19it/s, est. speed input: 21087.86 toks/s, output: 20.59 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:25<00:27, 18.20it/s, est. speed input: 21045.59 toks/s, output: 20.55 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:25<00:27, 18.19it/s, est. speed input: 21004.08 toks/s, output: 20.51 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:26<00:26, 18.18it/s, est. speed input: 20963.69 toks/s, output: 20.47 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:26<00:26, 18.18it/s, est. speed input: 20924.77 toks/s, output: 20.43 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:27<00:25, 18.18it/s, est. speed input: 20887.31 toks/s, output: 20.40 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:27<00:25, 18.17it/s, est. speed input: 20850.77 toks/s, output: 20.36 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:28<00:24, 18.17it/s, est. speed input: 20815.35 toks/s, output: 20.33 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:28<00:24, 18.17it/s, est. speed input: 20781.09 toks/s, output: 20.29 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:28<00:24, 18.17it/s, est. speed input: 20748.03 toks/s, output: 20.26 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:29<00:23, 18.17it/s, est. speed input: 20716.06 toks/s, output: 20.23 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:29<00:23, 18.17it/s, est. speed input: 20684.72 toks/s, output: 20.20 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:30<00:22, 18.17it/s, est. speed input: 20654.28 toks/s, output: 20.17 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:30<00:22, 18.16it/s, est. speed input: 20624.67 toks/s, output: 20.14 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:31<00:10, 35.66it/s, est. speed input: 21418.15 toks/s, output: 20.92 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:31<00:12, 30.30it/s, est. speed input: 21379.05 toks/s, output: 20.88 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:31<00:13, 26.60it/s, est. speed input: 21340.81 toks/s, output: 20.84 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:32<00:14, 24.04it/s, est. speed input: 21303.63 toks/s, output: 20.80 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:32<00:15, 22.27it/s, est. speed input: 21267.44 toks/s, output: 20.77 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:33<00:15, 21.03it/s, est. speed input: 21232.31 toks/s, output: 20.73 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:33<00:16, 20.17it/s, est. speed input: 21197.83 toks/s, output: 20.70 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:34<00:16, 19.56it/s, est. speed input: 21164.07 toks/s, output: 20.67 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:34<00:16, 19.14it/s, est. speed input: 21131.51 toks/s, output: 20.64 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:35<00:16, 18.84it/s, est. speed input: 21099.56 toks/s, output: 20.61 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:35<00:15, 18.64it/s, est. speed input: 21068.62 toks/s, output: 20.57 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:35<00:15, 18.50it/s, est. speed input: 21038.32 toks/s, output: 20.55 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:36<00:15, 18.40it/s, est. speed input: 21009.04 toks/s, output: 20.52 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:36<00:14, 18.33it/s, est. speed input: 20980.09 toks/s, output: 20.49 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:37<00:14, 18.28it/s, est. speed input: 20952.00 toks/s, output: 20.46 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:37<00:13, 18.25it/s, est. speed input: 20924.74 toks/s, output: 20.43 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:38<00:13, 18.22it/s, est. speed input: 20897.85 toks/s, output: 20.41 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:38<00:12, 18.68it/s, est. speed input: 20891.90 toks/s, output: 20.40 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:38<00:12, 18.53it/s, est. speed input: 20866.12 toks/s, output: 20.38 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:39<00:12, 18.42it/s, est. speed input: 20840.72 toks/s, output: 20.35 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:39<00:11, 18.34it/s, est. speed input: 20815.79 toks/s, output: 20.33 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:40<00:11, 18.28it/s, est. speed input: 20791.36 toks/s, output: 20.30 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:40<00:10, 18.25it/s, est. speed input: 20767.75 toks/s, output: 20.28 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:41<00:10, 18.22it/s, est. speed input: 20744.49 toks/s, output: 20.26 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [00:41<00:09, 18.20it/s, est. speed input: 20721.75 toks/s, output: 20.24 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [00:42<00:09, 18.19it/s, est. speed input: 20699.64 toks/s, output: 20.21 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:42<00:09, 18.19it/s, est. speed input: 20678.07 toks/s, output: 20.19 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [00:42<00:08, 18.19it/s, est. speed input: 20657.03 toks/s, output: 20.17 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [00:43<00:08, 18.18it/s, est. speed input: 20636.25 toks/s, output: 20.15 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [00:43<00:07, 18.18it/s, est. speed input: 20615.99 toks/s, output: 20.13 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [00:44<00:07, 18.18it/s, est. speed input: 20596.03 toks/s, output: 20.11 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [00:44<00:06, 18.18it/s, est. speed input: 20576.52 toks/s, output: 20.09 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [00:45<00:06, 18.18it/s, est. speed input: 20557.37 toks/s, output: 20.08 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [00:45<00:06, 18.17it/s, est. speed input: 20538.29 toks/s, output: 20.06 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [00:46<00:05, 18.17it/s, est. speed input: 20519.86 toks/s, output: 20.04 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [00:46<00:05, 18.17it/s, est. speed input: 20501.79 toks/s, output: 20.02 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [00:46<00:04, 18.17it/s, est. speed input: 20483.92 toks/s, output: 20.00 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [00:47<00:04, 18.17it/s, est. speed input: 20466.60 toks/s, output: 19.99 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [00:47<00:03, 18.17it/s, est. speed input: 20449.43 toks/s, output: 19.97 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [00:48<00:03, 18.17it/s, est. speed input: 20432.60 toks/s, output: 19.95 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [00:48<00:02, 18.17it/s, est. speed input: 20416.17 toks/s, output: 19.94 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [00:49<00:02, 18.17it/s, est. speed input: 20399.89 toks/s, output: 19.92 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [00:49<00:02, 18.18it/s, est. speed input: 20384.09 toks/s, output: 19.91 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [00:49<00:01, 18.17it/s, est. speed input: 20368.38 toks/s, output: 19.89 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [00:50<00:01, 18.17it/s, est. speed input: 20352.82 toks/s, output: 19.88 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [00:50<00:00, 18.17it/s, est. speed input: 20337.74 toks/s, output: 19.86 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [00:51<00:00, 18.73it/s, est. speed input: 20340.42 toks/s, output: 19.86 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:51<00:00, 18.73it/s, est. speed input: 20460.20 toks/s, output: 19.98 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:51<00:00, 19.98it/s, est. speed input: 20460.20 toks/s, output: 19.98 toks/s]
[rank0]:[W126 04:52:13.311014740 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 110.9s

测试结果:
  Requests/s:   18.14
  Tokens/s:     18591.02
  Total Reqs:   1024
  Elapsed:      56.46s

  [Prefill 分析]
  Total Prefill Tokens: 1048576
  Prefill Tokens/s:     18572.88

============================================================
[6/8] 测试 M=16384
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 16384
│   M_prefill     = 16384 (= 16 x 1024)
│   M_decode      = 16
│   batched_tokens = 16384 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 2048
│   --max-num-seqs           = 16
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 16384
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 04:52:37 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 04:52:38 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=198580) WARNING 01-26 04:52:46 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=198580) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=198580) WARNING 01-26 04:52:57 [backends.py:609] Failed to read file <frozen os>
Throughput: 9.57 requests/s, 9806.55 total tokens/s, 9.57 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048


─── STDERR ───
[2026-01-26 04:52:37] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 04:52:37] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:52:37] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 04:52:37] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:52:37] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:52:37] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:52:37] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:52:37] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:52:37] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:52:37] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 04:52:37] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 04:52:37] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 04:52:37] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 04:52:37] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 04:52:45] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 04:52:45] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:52:45] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 04:52:45] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:52:45] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:52:45] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:52:45] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:52:45] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:52:45] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:52:45] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 04:52:45] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 04:52:45] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 04:52:45] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 04:52:45] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=198580) [2026-01-26 04:52:46] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=198580) [2026-01-26 04:52:46] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=198580) [2026-01-26 04:52:46] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=198580) [2026-01-26 04:52:46] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=198580) [2026-01-26 04:52:46] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=198580) [2026-01-26 04:52:46] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=198580) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=198580) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.02it/s]
(EngineCore_DP0 pid=198580) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.26s/it]
(EngineCore_DP0 pid=198580) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.22s/it]
(EngineCore_DP0 pid=198580) 
(EngineCore_DP0 pid=198580) [2026-01-26 04:52:49] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 5760] -> 1D uint8
(EngineCore_DP0 pid=198580) [2026-01-26 04:52:49] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 19906560 bytes
(EngineCore_DP0 pid=198580) [2026-01-26 04:52:49] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 5760] -> 1D uint8
(EngineCore_DP0 pid=198580) [2026-01-26 04:52:49] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 15482880 bytes
(EngineCore_DP0 pid=198580) [2026-01-26 04:52:49] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 5760] -> 1D uint8
(EngineCore_DP0 pid=198580) [2026-01-26 04:52:49] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 163676160 bytes
(EngineCore_DP0 pid=198580) [2026-01-26 04:52:49] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 30336] -> 1D uint8
(EngineCore_DP0 pid=198580) [2026-01-26 04:52:49] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 81543168 bytes
(EngineCore_DP0 pid=198580) [rank0]:W0126 04:53:06.232000 198580 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=198580) [rank0]:W0126 04:53:06.342000 198580 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=198580) [rank0]:W0126 04:53:08.084000 198580 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=198580) [rank0]:W0126 04:53:08.259000 198580 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=198580) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  14%|█▍        | 1/7 [00:00<00:00,  7.93it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  29%|██▊       | 2/7 [00:00<00:00,  8.30it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  43%|████▎     | 3/7 [00:00<00:00,  8.64it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  57%|█████▋    | 4/7 [00:00<00:00,  8.89it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  71%|███████▏  | 5/7 [00:00<00:00,  8.93it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  86%|████████▌ | 6/7 [00:00<00:00,  8.98it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00,  8.23it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00,  8.49it/s]
(EngineCore_DP0 pid=198580) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  20%|██        | 1/5 [00:00<00:00,  7.42it/s]
Capturing CUDA graphs (decode, FULL):  40%|████      | 2/5 [00:00<00:00,  8.37it/s]
Capturing CUDA graphs (decode, FULL):  60%|██████    | 3/5 [00:00<00:00,  8.61it/s]
Capturing CUDA graphs (decode, FULL):  80%|████████  | 4/5 [00:00<00:00,  8.93it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00,  8.50it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00,  8.49it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   1%|          | 23/2048 [00:00<00:08, 227.66it/s]
Adding requests:   2%|▏         | 49/2048 [00:00<00:08, 241.95it/s]
Adding requests:   4%|▎         | 75/2048 [00:00<00:07, 248.00it/s]
Adding requests:   5%|▍         | 100/2048 [00:00<00:07, 246.10it/s]
Adding requests:   6%|▌         | 125/2048 [00:00<00:07, 243.38it/s]
Adding requests:   7%|▋         | 150/2048 [00:00<00:07, 241.26it/s]
Adding requests:   9%|▊         | 176/2048 [00:00<00:07, 245.14it/s]
Adding requests:  10%|▉         | 203/2048 [00:00<00:07, 251.42it/s]
Adding requests:  11%|█         | 229/2048 [00:00<00:07, 253.17it/s]
Adding requests:  12%|█▏        | 255/2048 [00:01<00:07, 248.33it/s]
Adding requests:  14%|█▎        | 280/2048 [00:01<00:07, 248.13it/s]
Adding requests:  15%|█▍        | 305/2048 [00:01<00:07, 246.16it/s]
Adding requests:  16%|█▌        | 330/2048 [00:01<00:07, 245.02it/s]
Adding requests:  17%|█▋        | 355/2048 [00:01<00:06, 246.10it/s]
Adding requests:  19%|█▊        | 381/2048 [00:01<00:06, 247.80it/s]
Adding requests:  20%|█▉        | 408/2048 [00:01<00:06, 254.11it/s]
Adding requests:  21%|██        | 434/2048 [00:01<00:06, 251.31it/s]
Adding requests:  22%|██▏       | 460/2048 [00:01<00:06, 246.44it/s]
Adding requests:  24%|██▍       | 487/2048 [00:01<00:06, 251.56it/s]
Adding requests:  25%|██▌       | 513/2048 [00:02<00:06, 249.72it/s]
Adding requests:  26%|██▋       | 538/2048 [00:02<00:06, 248.76it/s]
Adding requests:  28%|██▊       | 564/2048 [00:02<00:05, 251.62it/s]
Adding requests:  29%|██▉       | 590/2048 [00:02<00:06, 240.43it/s]
Adding requests:  30%|███       | 616/2048 [00:02<00:05, 245.72it/s]
Adding requests:  31%|███▏      | 642/2048 [00:02<00:05, 246.63it/s]
Adding requests:  33%|███▎      | 667/2048 [00:02<00:05, 242.26it/s]
Adding requests:  34%|███▍      | 694/2048 [00:02<00:05, 248.30it/s]
Adding requests:  35%|███▌      | 719/2048 [00:02<00:05, 247.16it/s]
Adding requests:  36%|███▋      | 744/2048 [00:03<00:05, 243.78it/s]
Adding requests:  38%|███▊      | 769/2048 [00:03<00:05, 241.09it/s]
Adding requests:  39%|███▉      | 794/2048 [00:03<00:05, 242.40it/s]
Adding requests:  40%|███▉      | 819/2048 [00:03<00:05, 244.39it/s]
Adding requests:  41%|████▏     | 846/2048 [00:03<00:04, 250.72it/s]
Adding requests:  43%|████▎     | 872/2048 [00:03<00:04, 245.93it/s]
Adding requests:  44%|████▍     | 898/2048 [00:03<00:04, 247.89it/s]
Adding requests:  45%|████▌     | 923/2048 [00:03<00:04, 243.12it/s]
Adding requests:  46%|████▋     | 948/2048 [00:03<00:04, 239.53it/s]
Adding requests:  48%|████▊     | 974/2048 [00:03<00:04, 244.32it/s]
Adding requests:  49%|████▉     | 999/2048 [00:04<00:04, 242.36it/s]
Adding requests:  50%|█████     | 1025/2048 [00:04<00:04, 245.44it/s]
Adding requests:  51%|█████▏    | 1050/2048 [00:04<00:04, 246.61it/s]
Adding requests:  52%|█████▏    | 1075/2048 [00:04<00:04, 241.04it/s]
Adding requests:  54%|█████▎    | 1100/2048 [00:04<00:04, 235.45it/s]
Adding requests:  55%|█████▍    | 1125/2048 [00:04<00:03, 239.40it/s]
Adding requests:  56%|█████▌    | 1149/2048 [00:04<00:03, 238.14it/s]
Adding requests:  57%|█████▋    | 1173/2048 [00:04<00:03, 238.66it/s]
Adding requests:  58%|█████▊    | 1197/2048 [00:04<00:03, 237.34it/s]
Adding requests:  60%|█████▉    | 1225/2048 [00:04<00:03, 247.30it/s]
Adding requests:  61%|██████    | 1250/2048 [00:05<00:03, 244.79it/s]
Adding requests:  62%|██████▏   | 1275/2048 [00:05<00:03, 241.01it/s]
Adding requests:  63%|██████▎   | 1300/2048 [00:05<00:03, 236.61it/s]
Adding requests:  65%|██████▍   | 1324/2048 [00:05<00:03, 236.50it/s]
Adding requests:  66%|██████▌   | 1349/2048 [00:05<00:02, 238.56it/s]
Adding requests:  67%|██████▋   | 1375/2048 [00:05<00:02, 243.02it/s]
Adding requests:  68%|██████▊   | 1400/2048 [00:05<00:02, 244.64it/s]
Adding requests:  70%|██████▉   | 1426/2048 [00:05<00:02, 246.87it/s]
Adding requests:  71%|███████   | 1451/2048 [00:05<00:02, 246.85it/s]
Adding requests:  72%|███████▏  | 1477/2048 [00:06<00:02, 250.47it/s]
Adding requests:  73%|███████▎  | 1504/2048 [00:06<00:02, 255.17it/s]
Adding requests:  75%|███████▍  | 1530/2048 [00:06<00:02, 253.47it/s]
Adding requests:  76%|███████▌  | 1556/2048 [00:06<00:01, 251.20it/s]
Adding requests:  77%|███████▋  | 1582/2048 [00:06<00:01, 244.90it/s]
Adding requests:  78%|███████▊  | 1607/2048 [00:06<00:01, 243.51it/s]
Adding requests:  80%|███████▉  | 1632/2048 [00:06<00:01, 239.93it/s]
Adding requests:  81%|████████  | 1657/2048 [00:06<00:01, 237.93it/s]
Adding requests:  82%|████████▏ | 1683/2048 [00:06<00:01, 241.58it/s]
Adding requests:  83%|████████▎ | 1709/2048 [00:06<00:01, 246.39it/s]
Adding requests:  85%|████████▍ | 1734/2048 [00:07<00:01, 245.60it/s]
Adding requests:  86%|████████▌ | 1760/2048 [00:07<00:01, 248.25it/s]
Adding requests:  87%|████████▋ | 1787/2048 [00:07<00:01, 253.52it/s]
Adding requests:  89%|████████▊ | 1813/2048 [00:07<00:00, 253.49it/s]
Adding requests:  90%|████████▉ | 1840/2048 [00:07<00:00, 255.74it/s]
Adding requests:  91%|█████████ | 1866/2048 [00:07<00:00, 249.92it/s]
Adding requests:  92%|█████████▏| 1892/2048 [00:07<00:00, 249.17it/s]
Adding requests:  94%|█████████▎| 1917/2048 [00:07<00:00, 248.29it/s]
Adding requests:  95%|█████████▍| 1942/2048 [00:07<00:00, 248.67it/s]
Adding requests:  96%|█████████▌| 1967/2048 [00:08<00:00, 245.26it/s]
Adding requests:  97%|█████████▋| 1992/2048 [00:08<00:00, 244.18it/s]
Adding requests:  98%|█████████▊| 2017/2048 [00:08<00:00, 240.39it/s]
Adding requests: 100%|█████████▉| 2042/2048 [00:08<00:00, 232.45it/s]
Adding requests: 100%|██████████| 2048/2048 [00:08<00:00, 244.60it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   4%|▍         | 82/2048 [00:00<00:15, 127.12it/s, est. speed input: 130176.50 toks/s, output: 127.12 toks/s]
Processed prompts:   5%|▍         | 98/2048 [00:02<00:56, 34.66it/s, est. speed input: 43424.71 toks/s, output: 42.41 toks/s]   
Processed prompts:   6%|▌         | 114/2048 [00:03<01:30, 21.41it/s, est. speed input: 29356.21 toks/s, output: 28.67 toks/s]
Processed prompts:   6%|▋         | 130/2048 [00:05<01:57, 16.33it/s, est. speed input: 23594.04 toks/s, output: 23.04 toks/s]
Processed prompts:   7%|▋         | 146/2048 [00:07<02:18, 13.76it/s, est. speed input: 20454.58 toks/s, output: 19.98 toks/s]
Processed prompts:   8%|▊         | 162/2048 [00:08<02:33, 12.30it/s, est. speed input: 18482.26 toks/s, output: 18.05 toks/s]
Processed prompts:   9%|▊         | 178/2048 [00:10<02:44, 11.39it/s, est. speed input: 17126.59 toks/s, output: 16.73 toks/s]
Processed prompts:   9%|▉         | 194/2048 [00:12<02:51, 10.81it/s, est. speed input: 16138.03 toks/s, output: 15.76 toks/s]
Processed prompts:  10%|█         | 210/2048 [00:13<02:56, 10.43it/s, est. speed input: 15384.42 toks/s, output: 15.02 toks/s]
Processed prompts:  11%|█         | 226/2048 [00:15<02:59, 10.17it/s, est. speed input: 14791.41 toks/s, output: 14.44 toks/s]
Processed prompts:  12%|█▏        | 242/2048 [00:17<03:00,  9.99it/s, est. speed input: 14312.41 toks/s, output: 13.98 toks/s]
Processed prompts:  13%|█▎        | 258/2048 [00:18<03:01,  9.87it/s, est. speed input: 13917.47 toks/s, output: 13.59 toks/s]
Processed prompts:  13%|█▎        | 274/2048 [00:20<03:01,  9.77it/s, est. speed input: 13581.41 toks/s, output: 13.26 toks/s]
Processed prompts:  14%|█▍        | 290/2048 [00:22<03:00,  9.71it/s, est. speed input: 13299.98 toks/s, output: 12.99 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [00:23<03:00,  9.67it/s, est. speed input: 13057.31 toks/s, output: 12.75 toks/s]
Processed prompts:  16%|█▌        | 322/2048 [00:25<02:58,  9.65it/s, est. speed input: 12846.21 toks/s, output: 12.55 toks/s]
Processed prompts:  17%|█▋        | 338/2048 [00:27<02:57,  9.63it/s, est. speed input: 12660.79 toks/s, output: 12.36 toks/s]
Processed prompts:  17%|█▋        | 354/2048 [00:29<02:56,  9.61it/s, est. speed input: 12496.85 toks/s, output: 12.20 toks/s]
Processed prompts:  18%|█▊        | 370/2048 [00:30<02:54,  9.60it/s, est. speed input: 12350.30 toks/s, output: 12.06 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [00:30<02:10, 12.78it/s, est. speed input: 12765.42 toks/s, output: 12.47 toks/s]
Processed prompts:  20%|█▉        | 402/2048 [00:32<02:21, 11.61it/s, est. speed input: 12613.81 toks/s, output: 12.32 toks/s]
Processed prompts:  20%|██        | 418/2048 [00:34<02:29, 10.92it/s, est. speed input: 12477.16 toks/s, output: 12.18 toks/s]
Processed prompts:  21%|██        | 434/2048 [00:35<02:34, 10.48it/s, est. speed input: 12352.92 toks/s, output: 12.06 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [00:37<02:36, 10.19it/s, est. speed input: 12239.70 toks/s, output: 11.95 toks/s]
Processed prompts:  23%|██▎       | 466/2048 [00:39<02:38,  9.99it/s, est. speed input: 12135.85 toks/s, output: 11.85 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [00:40<02:38,  9.86it/s, est. speed input: 12040.30 toks/s, output: 11.76 toks/s]
Processed prompts:  24%|██▍       | 498/2048 [00:42<02:38,  9.77it/s, est. speed input: 11952.41 toks/s, output: 11.67 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [00:44<02:38,  9.71it/s, est. speed input: 11870.94 toks/s, output: 11.59 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [00:46<02:37,  9.66it/s, est. speed input: 11795.36 toks/s, output: 11.52 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [00:47<02:35,  9.63it/s, est. speed input: 11725.04 toks/s, output: 11.45 toks/s]
Processed prompts:  27%|██▋       | 562/2048 [00:49<02:34,  9.61it/s, est. speed input: 11659.38 toks/s, output: 11.39 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [00:51<02:33,  9.59it/s, est. speed input: 11597.91 toks/s, output: 11.33 toks/s]
Processed prompts:  29%|██▉       | 594/2048 [00:52<02:31,  9.58it/s, est. speed input: 11540.38 toks/s, output: 11.27 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [00:54<02:30,  9.58it/s, est. speed input: 11486.44 toks/s, output: 11.22 toks/s]
Processed prompts:  31%|███       | 626/2048 [00:56<02:28,  9.57it/s, est. speed input: 11435.64 toks/s, output: 11.17 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [00:57<02:26,  9.57it/s, est. speed input: 11387.83 toks/s, output: 11.12 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [00:59<02:25,  9.56it/s, est. speed input: 11342.84 toks/s, output: 11.08 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [01:01<02:23,  9.56it/s, est. speed input: 11300.02 toks/s, output: 11.04 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [01:01<01:46, 12.72it/s, est. speed input: 11514.01 toks/s, output: 11.24 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [01:03<01:55, 11.57it/s, est. speed input: 11468.25 toks/s, output: 11.20 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [01:04<02:01, 10.89it/s, est. speed input: 11424.85 toks/s, output: 11.16 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [01:06<02:05, 10.45it/s, est. speed input: 11383.68 toks/s, output: 11.12 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [01:08<02:07, 10.17it/s, est. speed input: 11344.55 toks/s, output: 11.08 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [01:09<02:08,  9.98it/s, est. speed input: 11307.29 toks/s, output: 11.04 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [01:11<02:03, 10.24it/s, est. speed input: 11304.39 toks/s, output: 11.04 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [01:12<02:04, 10.02it/s, est. speed input: 11269.19 toks/s, output: 11.01 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [01:14<02:04,  9.87it/s, est. speed input: 11235.50 toks/s, output: 10.97 toks/s]
Processed prompts:  41%|████      | 834/2048 [01:16<02:04,  9.77it/s, est. speed input: 11203.23 toks/s, output: 10.94 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [01:17<02:03,  9.70it/s, est. speed input: 11172.32 toks/s, output: 10.91 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [01:19<02:02,  9.65it/s, est. speed input: 11142.69 toks/s, output: 10.88 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [01:21<02:01,  9.62it/s, est. speed input: 11114.21 toks/s, output: 10.85 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [01:22<01:59,  9.59it/s, est. speed input: 11086.83 toks/s, output: 10.83 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [01:24<01:58,  9.57it/s, est. speed input: 11060.50 toks/s, output: 10.80 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [01:26<01:56,  9.56it/s, est. speed input: 11035.27 toks/s, output: 10.78 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [01:27<01:55,  9.56it/s, est. speed input: 11011.18 toks/s, output: 10.75 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [01:29<01:53,  9.55it/s, est. speed input: 10987.98 toks/s, output: 10.73 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [01:31<01:52,  9.55it/s, est. speed input: 10965.67 toks/s, output: 10.71 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [01:33<01:50,  9.55it/s, est. speed input: 10944.14 toks/s, output: 10.69 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [01:33<01:21, 12.74it/s, est. speed input: 11087.37 toks/s, output: 10.83 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [01:34<01:28, 11.58it/s, est. speed input: 11064.24 toks/s, output: 10.80 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [01:36<01:32, 10.90it/s, est. speed input: 11042.53 toks/s, output: 10.78 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [01:38<01:34, 10.46it/s, est. speed input: 11021.54 toks/s, output: 10.76 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [01:39<01:35, 10.18it/s, est. speed input: 11001.25 toks/s, output: 10.74 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [01:41<01:35,  9.99it/s, est. speed input: 10981.62 toks/s, output: 10.72 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [01:43<01:35,  9.85it/s, est. speed input: 10961.95 toks/s, output: 10.71 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [01:45<01:35,  9.74it/s, est. speed input: 10942.08 toks/s, output: 10.69 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [01:46<01:34,  9.67it/s, est. speed input: 10922.88 toks/s, output: 10.67 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [01:48<01:32,  9.62it/s, est. speed input: 10904.24 toks/s, output: 10.65 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [01:50<01:31,  9.58it/s, est. speed input: 10886.20 toks/s, output: 10.63 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [01:51<01:30,  9.56it/s, est. speed input: 10869.11 toks/s, output: 10.61 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [01:53<01:28,  9.56it/s, est. speed input: 10852.81 toks/s, output: 10.60 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [01:55<01:26,  9.55it/s, est. speed input: 10836.89 toks/s, output: 10.58 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [01:56<01:25,  9.54it/s, est. speed input: 10821.49 toks/s, output: 10.57 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [01:58<01:23,  9.54it/s, est. speed input: 10806.51 toks/s, output: 10.55 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [02:00<01:21,  9.54it/s, est. speed input: 10792.14 toks/s, output: 10.54 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [02:01<01:20,  9.55it/s, est. speed input: 10778.23 toks/s, output: 10.53 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [02:03<01:18,  9.55it/s, est. speed input: 10764.64 toks/s, output: 10.51 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [02:03<00:57, 12.79it/s, est. speed input: 10874.54 toks/s, output: 10.62 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [02:05<01:01, 11.61it/s, est. speed input: 10859.88 toks/s, output: 10.61 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [02:07<01:04, 10.90it/s, est. speed input: 10845.59 toks/s, output: 10.59 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [02:08<01:05, 10.46it/s, est. speed input: 10831.62 toks/s, output: 10.58 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [02:10<01:05, 10.16it/s, est. speed input: 10818.02 toks/s, output: 10.56 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [02:12<01:05,  9.97it/s, est. speed input: 10804.81 toks/s, output: 10.55 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [02:13<01:04,  9.84it/s, est. speed input: 10791.89 toks/s, output: 10.54 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [02:15<01:03,  9.75it/s, est. speed input: 10779.33 toks/s, output: 10.53 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [02:17<01:02,  9.69it/s, est. speed input: 10767.13 toks/s, output: 10.51 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [02:18<01:01,  9.65it/s, est. speed input: 10755.21 toks/s, output: 10.50 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [02:20<00:59,  9.62it/s, est. speed input: 10743.54 toks/s, output: 10.49 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [02:22<00:58,  9.60it/s, est. speed input: 10732.13 toks/s, output: 10.48 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [02:23<00:56,  9.58it/s, est. speed input: 10721.01 toks/s, output: 10.47 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [02:25<00:54,  9.57it/s, est. speed input: 10710.14 toks/s, output: 10.46 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [02:27<00:53,  9.56it/s, est. speed input: 10699.53 toks/s, output: 10.45 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [02:28<00:51,  9.56it/s, est. speed input: 10689.16 toks/s, output: 10.44 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [02:30<00:50,  9.56it/s, est. speed input: 10679.03 toks/s, output: 10.43 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [02:32<00:48,  9.55it/s, est. speed input: 10669.08 toks/s, output: 10.42 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [02:33<00:46,  9.55it/s, est. speed input: 10659.36 toks/s, output: 10.41 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [02:35<00:43,  9.92it/s, est. speed input: 10664.20 toks/s, output: 10.41 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [02:35<00:31, 13.18it/s, est. speed input: 10749.96 toks/s, output: 10.50 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [02:37<00:33, 11.83it/s, est. speed input: 10739.60 toks/s, output: 10.49 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [02:38<00:34, 11.04it/s, est. speed input: 10729.47 toks/s, output: 10.48 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [02:40<00:34, 10.55it/s, est. speed input: 10719.56 toks/s, output: 10.47 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [02:42<00:34, 10.22it/s, est. speed input: 10709.84 toks/s, output: 10.46 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [02:44<00:33, 10.01it/s, est. speed input: 10700.33 toks/s, output: 10.45 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [02:45<00:32,  9.87it/s, est. speed input: 10691.01 toks/s, output: 10.44 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [02:47<00:30,  9.77it/s, est. speed input: 10681.87 toks/s, output: 10.43 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [02:49<00:29,  9.70it/s, est. speed input: 10672.93 toks/s, output: 10.42 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [02:50<00:27,  9.66it/s, est. speed input: 10664.12 toks/s, output: 10.41 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [02:52<00:26,  9.62it/s, est. speed input: 10655.53 toks/s, output: 10.41 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [02:54<00:24,  9.60it/s, est. speed input: 10647.05 toks/s, output: 10.40 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [02:55<00:23,  9.58it/s, est. speed input: 10638.77 toks/s, output: 10.39 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [02:57<00:21,  9.57it/s, est. speed input: 10630.62 toks/s, output: 10.38 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [02:59<00:19,  9.57it/s, est. speed input: 10622.63 toks/s, output: 10.37 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [03:00<00:18,  9.56it/s, est. speed input: 10614.80 toks/s, output: 10.37 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [03:02<00:16,  9.56it/s, est. speed input: 10607.10 toks/s, output: 10.36 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [03:04<00:14,  9.55it/s, est. speed input: 10599.57 toks/s, output: 10.35 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [03:05<00:13,  9.55it/s, est. speed input: 10592.17 toks/s, output: 10.34 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [03:06<00:08, 12.73it/s, est. speed input: 10664.09 toks/s, output: 10.41 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [03:07<00:08, 11.57it/s, est. speed input: 10656.19 toks/s, output: 10.41 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [03:09<00:07, 10.88it/s, est. speed input: 10648.42 toks/s, output: 10.40 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [03:11<00:05, 10.44it/s, est. speed input: 10640.77 toks/s, output: 10.39 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [03:12<00:04, 10.16it/s, est. speed input: 10633.29 toks/s, output: 10.38 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [03:14<00:03,  9.97it/s, est. speed input: 10625.90 toks/s, output: 10.38 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [03:15<00:01, 10.25it/s, est. speed input: 10630.54 toks/s, output: 10.38 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [03:15<00:00, 10.25it/s, est. speed input: 10703.69 toks/s, output: 10.45 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [03:15<00:00, 10.45it/s, est. speed input: 10703.69 toks/s, output: 10.45 toks/s]
[rank0]:[W126 04:56:41.385413242 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 268.6s

测试结果:
  Requests/s:   9.57
  Tokens/s:     9806.55
  Total Reqs:   2048
  Elapsed:      214.06s

  [Prefill 分析]
  Total Prefill Tokens: 2097152
  Prefill Tokens/s:     9796.98

============================================================
[7/8] 测试 M=32768
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 32768
│   M_prefill     = 32768 (= 32 x 1024)
│   M_decode      = 32
│   batched_tokens = 32768 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 4096
│   --max-num-seqs           = 32
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 32768
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 04:57:21 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 04:57:22 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=202856) WARNING 01-26 04:57:29 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=202856) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=202856) WARNING 01-26 04:57:42 [backends.py:609] Failed to read file <frozen os>
Throughput: 5.01 requests/s, 5135.02 total tokens/s, 5.01 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096


─── STDERR ───
[2026-01-26 04:57:21] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 04:57:21] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:57:21] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 04:57:21] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:57:21] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:57:21] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:57:21] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:57:21] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:57:21] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:57:21] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 04:57:21] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 04:57:21] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 04:57:21] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 04:57:21] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 04:57:29] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 04:57:29] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:57:29] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 04:57:29] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:57:29] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:57:29] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:57:29] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:57:29] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 04:57:29] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 04:57:29] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 04:57:29] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 04:57:29] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 04:57:29] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 04:57:29] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=202856) [2026-01-26 04:57:30] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=202856) [2026-01-26 04:57:30] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=202856) [2026-01-26 04:57:30] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=202856) [2026-01-26 04:57:30] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=202856) [2026-01-26 04:57:30] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=202856) [2026-01-26 04:57:30] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=202856) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=202856) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.06it/s]
(EngineCore_DP0 pid=202856) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.21s/it]
(EngineCore_DP0 pid=202856) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.17s/it]
(EngineCore_DP0 pid=202856) 
(EngineCore_DP0 pid=202856) [2026-01-26 04:57:33] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 5760] -> 1D uint8
(EngineCore_DP0 pid=202856) [2026-01-26 04:57:34] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 19906560 bytes
(EngineCore_DP0 pid=202856) [2026-01-26 04:57:34] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 5760] -> 1D uint8
(EngineCore_DP0 pid=202856) [2026-01-26 04:57:34] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 15482880 bytes
(EngineCore_DP0 pid=202856) [2026-01-26 04:57:34] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 5760] -> 1D uint8
(EngineCore_DP0 pid=202856) [2026-01-26 04:57:34] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 163676160 bytes
(EngineCore_DP0 pid=202856) [2026-01-26 04:57:34] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 30336] -> 1D uint8
(EngineCore_DP0 pid=202856) [2026-01-26 04:57:34] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 81543168 bytes
(EngineCore_DP0 pid=202856) [rank0]:W0126 04:57:50.639000 202856 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=202856) [rank0]:W0126 04:57:50.753000 202856 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=202856) [rank0]:W0126 04:57:52.278000 202856 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=202856) [rank0]:W0126 04:57:52.458000 202856 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=202856) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   9%|▉         | 1/11 [00:00<00:01,  8.00it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  18%|█▊        | 2/11 [00:00<00:01,  8.23it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  27%|██▋       | 3/11 [00:00<00:00,  8.51it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  36%|███▋      | 4/11 [00:00<00:00,  8.69it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  45%|████▌     | 5/11 [00:00<00:00,  8.70it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  55%|█████▍    | 6/11 [00:00<00:00,  8.79it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  64%|██████▎   | 7/11 [00:00<00:00,  8.76it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  73%|███████▎  | 8/11 [00:00<00:00,  8.86it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  82%|████████▏ | 9/11 [00:01<00:00,  8.95it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  91%|█████████ | 10/11 [00:01<00:00,  8.97it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00,  8.26it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00,  8.58it/s]
(EngineCore_DP0 pid=202856) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  14%|█▍        | 1/7 [00:00<00:00,  7.28it/s]
Capturing CUDA graphs (decode, FULL):  29%|██▊       | 2/7 [00:00<00:00,  8.37it/s]
Capturing CUDA graphs (decode, FULL):  43%|████▎     | 3/7 [00:00<00:00,  8.86it/s]
Capturing CUDA graphs (decode, FULL):  57%|█████▋    | 4/7 [00:00<00:00,  8.99it/s]
Capturing CUDA graphs (decode, FULL):  71%|███████▏  | 5/7 [00:00<00:00,  9.06it/s]
Capturing CUDA graphs (decode, FULL):  86%|████████▌ | 6/7 [00:00<00:00,  9.11it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00,  9.15it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00,  8.93it/s]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   1%|          | 21/4096 [00:00<00:19, 208.45it/s]
Adding requests:   1%|          | 43/4096 [00:00<00:18, 214.14it/s]
Adding requests:   2%|▏         | 67/4096 [00:00<00:18, 223.13it/s]
Adding requests:   2%|▏         | 90/4096 [00:00<00:17, 224.32it/s]
Adding requests:   3%|▎         | 114/4096 [00:00<00:17, 229.44it/s]
Adding requests:   3%|▎         | 138/4096 [00:00<00:17, 230.35it/s]
Adding requests:   4%|▍         | 162/4096 [00:00<00:17, 231.07it/s]
Adding requests:   5%|▍         | 186/4096 [00:00<00:17, 228.08it/s]
Adding requests:   5%|▌         | 212/4096 [00:00<00:16, 236.32it/s]
Adding requests:   6%|▌         | 238/4096 [00:01<00:15, 242.64it/s]
Adding requests:   6%|▋         | 263/4096 [00:01<00:15, 241.03it/s]
Adding requests:   7%|▋         | 288/4096 [00:01<00:16, 227.83it/s]
Adding requests:   8%|▊         | 311/4096 [00:01<00:16, 225.61it/s]
Adding requests:   8%|▊         | 335/4096 [00:01<00:16, 229.51it/s]
Adding requests:   9%|▉         | 360/4096 [00:01<00:15, 235.24it/s]
Adding requests:   9%|▉         | 384/4096 [00:01<00:16, 226.17it/s]
Adding requests:  10%|▉         | 408/4096 [00:01<00:16, 227.63it/s]
Adding requests:  11%|█         | 434/4096 [00:01<00:15, 234.05it/s]
Adding requests:  11%|█         | 460/4096 [00:01<00:15, 240.80it/s]
Adding requests:  12%|█▏        | 485/4096 [00:02<00:14, 243.38it/s]
Adding requests:  12%|█▏        | 510/4096 [00:02<00:15, 236.91it/s]
Adding requests:  13%|█▎        | 538/4096 [00:02<00:14, 247.08it/s]
Adding requests:  14%|█▍        | 564/4096 [00:02<00:14, 250.21it/s]
Adding requests:  14%|█▍        | 590/4096 [00:02<00:14, 239.41it/s]
Adding requests:  15%|█▌        | 615/4096 [00:02<00:15, 229.19it/s]
Adding requests:  16%|█▌        | 640/4096 [00:02<00:14, 234.68it/s]
Adding requests:  16%|█▌        | 665/4096 [00:02<00:14, 236.73it/s]
Adding requests:  17%|█▋        | 694/4096 [00:02<00:13, 248.69it/s]
Adding requests:  18%|█▊        | 719/4096 [00:03<00:14, 239.31it/s]
Adding requests:  18%|█▊        | 744/4096 [00:03<00:13, 239.60it/s]
Adding requests:  19%|█▉        | 770/4096 [00:03<00:13, 245.37it/s]
Adding requests:  19%|█▉        | 798/4096 [00:03<00:13, 253.38it/s]
Adding requests:  20%|██        | 824/4096 [00:03<00:13, 242.68it/s]
Adding requests:  21%|██        | 849/4096 [00:03<00:13, 241.59it/s]
Adding requests:  30%|██▉       | 1216/4096 [00:03<00:02, 1218.18it/s]
Adding requests:  33%|███▎      | 1343/4096 [00:04<00:05, 488.46it/s] 
Adding requests:  35%|███▌      | 1438/4096 [00:04<00:06, 399.51it/s]
Adding requests:  37%|███▋      | 1512/4096 [00:04<00:07, 354.59it/s]
Adding requests:  38%|███▊      | 1572/4096 [00:05<00:07, 327.88it/s]
Adding requests:  40%|███▉      | 1621/4096 [00:05<00:08, 302.08it/s]
Adding requests:  41%|████      | 1663/4096 [00:05<00:08, 290.39it/s]
Adding requests:  42%|████▏     | 1700/4096 [00:05<00:08, 277.81it/s]
Adding requests:  42%|████▏     | 1733/4096 [00:05<00:08, 271.93it/s]
Adding requests:  43%|████▎     | 1764/4096 [00:06<00:08, 273.65it/s]
Adding requests:  44%|████▍     | 1794/4096 [00:06<00:08, 267.40it/s]
Adding requests:  45%|████▍     | 1823/4096 [00:06<00:09, 249.47it/s]
Adding requests:  45%|████▌     | 1849/4096 [00:06<00:08, 249.69it/s]
Adding requests:  46%|████▌     | 1875/4096 [00:06<00:09, 246.30it/s]
Adding requests:  46%|████▋     | 1901/4096 [00:06<00:09, 242.68it/s]
Adding requests:  47%|████▋     | 1926/4096 [00:06<00:09, 236.05it/s]
Adding requests:  48%|████▊     | 1952/4096 [00:06<00:08, 242.11it/s]
Adding requests:  48%|████▊     | 1979/4096 [00:06<00:08, 247.75it/s]
Adding requests:  49%|████▉     | 2004/4096 [00:07<00:08, 246.49it/s]
Adding requests:  50%|████▉     | 2029/4096 [00:07<00:08, 229.89it/s]
Adding requests:  50%|█████     | 2053/4096 [00:07<00:08, 229.68it/s]
Adding requests:  51%|█████     | 2077/4096 [00:07<00:08, 230.15it/s]
Adding requests:  51%|█████▏    | 2105/4096 [00:07<00:08, 242.68it/s]
Adding requests:  52%|█████▏    | 2130/4096 [00:07<00:08, 233.00it/s]
Adding requests:  53%|█████▎    | 2154/4096 [00:07<00:08, 231.93it/s]
Adding requests:  53%|█████▎    | 2179/4096 [00:07<00:08, 236.13it/s]
Adding requests:  54%|█████▍    | 2205/4096 [00:07<00:07, 242.77it/s]
Adding requests:  54%|█████▍    | 2230/4096 [00:07<00:07, 242.70it/s]
Adding requests:  55%|█████▌    | 2255/4096 [00:08<00:07, 240.20it/s]
Adding requests:  56%|█████▌    | 2281/4096 [00:08<00:07, 245.02it/s]
Adding requests:  56%|█████▋    | 2308/4096 [00:08<00:07, 249.97it/s]
Adding requests:  57%|█████▋    | 2337/4096 [00:08<00:06, 258.70it/s]
Adding requests:  58%|█████▊    | 2363/4096 [00:08<00:07, 237.44it/s]
Adding requests:  58%|█████▊    | 2391/4096 [00:08<00:06, 248.02it/s]
Adding requests:  59%|█████▉    | 2419/4096 [00:08<00:06, 254.92it/s]
Adding requests:  60%|█████▉    | 2447/4096 [00:08<00:06, 259.49it/s]
Adding requests:  60%|██████    | 2474/4096 [00:08<00:06, 247.31it/s]
Adding requests:  61%|██████    | 2500/4096 [00:09<00:06, 249.27it/s]
Adding requests:  62%|██████▏   | 2527/4096 [00:09<00:06, 254.91it/s]
Adding requests:  62%|██████▏   | 2558/4096 [00:09<00:05, 269.16it/s]
Adding requests:  63%|██████▎   | 2586/4096 [00:09<00:05, 261.05it/s]
Adding requests:  64%|██████▍   | 2613/4096 [00:09<00:05, 249.82it/s]
Adding requests:  64%|██████▍   | 2639/4096 [00:09<00:05, 246.62it/s]
Adding requests:  65%|██████▌   | 2665/4096 [00:09<00:05, 249.82it/s]
Adding requests:  66%|██████▌   | 2691/4096 [00:09<00:05, 242.32it/s]
Adding requests:  66%|██████▋   | 2716/4096 [00:09<00:05, 231.68it/s]
Adding requests:  67%|██████▋   | 2743/4096 [00:10<00:05, 240.36it/s]
Adding requests:  68%|██████▊   | 2771/4096 [00:10<00:05, 249.97it/s]
Adding requests:  68%|██████▊   | 2798/4096 [00:10<00:05, 253.28it/s]
Adding requests:  69%|██████▉   | 2824/4096 [00:10<00:05, 239.19it/s]
Adding requests:  70%|██████▉   | 2851/4096 [00:10<00:05, 245.54it/s]
Adding requests:  70%|███████   | 2878/4096 [00:10<00:04, 251.22it/s]
Adding requests:  71%|███████   | 2905/4096 [00:10<00:04, 255.16it/s]
Adding requests:  72%|███████▏  | 2931/4096 [00:10<00:04, 243.84it/s]
Adding requests:  72%|███████▏  | 2959/4096 [00:10<00:04, 252.14it/s]
Adding requests:  73%|███████▎  | 2986/4096 [00:11<00:04, 254.68it/s]
Adding requests:  74%|███████▎  | 3015/4096 [00:11<00:04, 263.43it/s]
Adding requests:  74%|███████▍  | 3042/4096 [00:11<00:04, 254.36it/s]
Adding requests:  75%|███████▍  | 3068/4096 [00:11<00:04, 252.68it/s]
Adding requests:  76%|███████▌  | 3095/4096 [00:11<00:03, 257.39it/s]
Adding requests:  76%|███████▋  | 3124/4096 [00:11<00:03, 265.16it/s]
Adding requests:  77%|███████▋  | 3151/4096 [00:11<00:03, 258.14it/s]
Adding requests:  78%|███████▊  | 3177/4096 [00:11<00:03, 248.11it/s]
Adding requests:  78%|███████▊  | 3204/4096 [00:11<00:03, 253.37it/s]
Adding requests:  79%|███████▉  | 3231/4096 [00:11<00:03, 258.12it/s]
Adding requests:  80%|███████▉  | 3257/4096 [00:12<00:03, 247.38it/s]
Adding requests:  80%|████████  | 3282/4096 [00:12<00:03, 226.02it/s]
Adding requests:  81%|████████  | 3305/4096 [00:12<00:03, 218.15it/s]
Adding requests:  81%|████████▏ | 3328/4096 [00:12<00:03, 220.64it/s]
Adding requests:  82%|████████▏ | 3354/4096 [00:12<00:03, 229.37it/s]
Adding requests:  82%|████████▏ | 3378/4096 [00:12<00:03, 209.68it/s]
Adding requests:  83%|████████▎ | 3400/4096 [00:12<00:03, 198.27it/s]
Adding requests:  84%|████████▎ | 3423/4096 [00:12<00:03, 204.51it/s]
Adding requests:  84%|████████▍ | 3448/4096 [00:13<00:03, 213.61it/s]
Adding requests:  85%|████████▍ | 3470/4096 [00:13<00:02, 211.84it/s]
Adding requests:  85%|████████▌ | 3494/4096 [00:13<00:02, 217.50it/s]
Adding requests:  86%|████████▌ | 3522/4096 [00:13<00:02, 233.73it/s]
Adding requests:  87%|████████▋ | 3550/4096 [00:13<00:02, 246.66it/s]
Adding requests:  87%|████████▋ | 3575/4096 [00:13<00:02, 236.50it/s]
Adding requests:  88%|████████▊ | 3599/4096 [00:13<00:02, 235.22it/s]
Adding requests:  89%|████████▊ | 3627/4096 [00:13<00:01, 245.99it/s]
Adding requests:  89%|████████▉ | 3655/4096 [00:13<00:01, 253.12it/s]
Adding requests:  90%|████████▉ | 3681/4096 [00:13<00:01, 243.95it/s]
Adding requests:  90%|█████████ | 3706/4096 [00:14<00:01, 242.92it/s]
Adding requests:  91%|█████████ | 3731/4096 [00:14<00:01, 239.59it/s]
Adding requests:  92%|█████████▏| 3756/4096 [00:14<00:01, 238.22it/s]
Adding requests:  92%|█████████▏| 3780/4096 [00:14<00:01, 229.34it/s]
Adding requests:  93%|█████████▎| 3804/4096 [00:14<00:01, 219.13it/s]
Adding requests:  93%|█████████▎| 3829/4096 [00:14<00:01, 225.55it/s]
Adding requests:  94%|█████████▍| 3855/4096 [00:14<00:01, 233.65it/s]
Adding requests:  95%|█████████▍| 3880/4096 [00:14<00:00, 237.56it/s]
Adding requests:  95%|█████████▌| 3904/4096 [00:14<00:00, 227.51it/s]
Adding requests:  96%|█████████▌| 3928/4096 [00:15<00:00, 229.33it/s]
Adding requests:  97%|█████████▋| 3953/4096 [00:15<00:00, 234.71it/s]
Adding requests:  97%|█████████▋| 3978/4096 [00:15<00:00, 235.82it/s]
Adding requests:  98%|█████████▊| 4002/4096 [00:15<00:00, 231.80it/s]
Adding requests:  98%|█████████▊| 4027/4096 [00:15<00:00, 234.30it/s]
Adding requests:  99%|█████████▉| 4052/4096 [00:15<00:00, 238.59it/s]
Adding requests: 100%|█████████▉| 4078/4096 [00:15<00:00, 243.88it/s]
Adding requests: 100%|██████████| 4096/4096 [00:15<00:00, 260.17it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 66/4096 [00:02<02:37, 25.54it/s, est. speed input: 26150.27 toks/s, output: 25.54 toks/s]
Processed prompts:   2%|▏         | 98/4096 [00:08<06:59,  9.54it/s, est. speed input: 11185.97 toks/s, output: 10.92 toks/s]
Processed prompts:   3%|▎         | 130/4096 [00:15<09:14,  7.16it/s, est. speed input: 8669.24 toks/s, output: 8.47 toks/s] 
Processed prompts:   4%|▍         | 162/4096 [00:20<09:31,  6.88it/s, est. speed input: 8152.72 toks/s, output: 7.96 toks/s]
Processed prompts:   5%|▍         | 194/4096 [00:26<10:36,  6.13it/s, est. speed input: 7432.42 toks/s, output: 7.26 toks/s]
Processed prompts:   6%|▌         | 226/4096 [00:33<11:16,  5.72it/s, est. speed input: 6987.60 toks/s, output: 6.82 toks/s]
Processed prompts:   6%|▋         | 258/4096 [00:39<11:41,  5.47it/s, est. speed input: 6686.27 toks/s, output: 6.53 toks/s]
Processed prompts:   7%|▋         | 290/4096 [00:45<11:55,  5.32it/s, est. speed input: 6468.55 toks/s, output: 6.32 toks/s]
Processed prompts:   8%|▊         | 322/4096 [00:50<11:12,  5.61it/s, est. speed input: 6478.26 toks/s, output: 6.33 toks/s]
Processed prompts:   9%|▊         | 354/4096 [00:57<11:30,  5.42it/s, est. speed input: 6330.82 toks/s, output: 6.18 toks/s]
Processed prompts:   9%|▉         | 386/4096 [01:03<11:42,  5.28it/s, est. speed input: 6208.17 toks/s, output: 6.06 toks/s]
Processed prompts:  10%|█         | 418/4096 [01:10<11:48,  5.19it/s, est. speed input: 6107.28 toks/s, output: 5.96 toks/s]
Processed prompts:  11%|█         | 450/4096 [01:16<11:50,  5.13it/s, est. speed input: 6024.90 toks/s, output: 5.88 toks/s]
Processed prompts:  12%|█▏        | 482/4096 [01:21<11:01,  5.46it/s, est. speed input: 6059.18 toks/s, output: 5.92 toks/s]
Processed prompts:  13%|█▎        | 514/4096 [01:27<11:13,  5.32it/s, est. speed input: 5991.28 toks/s, output: 5.85 toks/s]
Processed prompts:  13%|█▎        | 546/4096 [01:34<11:20,  5.22it/s, est. speed input: 5932.60 toks/s, output: 5.79 toks/s]
Processed prompts:  14%|█▍        | 578/4096 [01:40<11:22,  5.15it/s, est. speed input: 5881.47 toks/s, output: 5.74 toks/s]
Processed prompts:  15%|█▍        | 610/4096 [01:47<11:22,  5.11it/s, est. speed input: 5836.48 toks/s, output: 5.70 toks/s]
Processed prompts:  16%|█▌        | 642/4096 [01:52<10:35,  5.44it/s, est. speed input: 5868.20 toks/s, output: 5.73 toks/s]
Processed prompts:  16%|█▋        | 674/4096 [01:58<10:45,  5.30it/s, est. speed input: 5828.16 toks/s, output: 5.69 toks/s]
Processed prompts:  17%|█▋        | 706/4096 [02:04<10:50,  5.21it/s, est. speed input: 5792.20 toks/s, output: 5.66 toks/s]
Processed prompts:  18%|█▊        | 738/4096 [02:11<10:52,  5.15it/s, est. speed input: 5759.75 toks/s, output: 5.62 toks/s]
Processed prompts:  19%|█▉        | 770/4096 [02:17<10:45,  5.16it/s, est. speed input: 5739.11 toks/s, output: 5.60 toks/s]
Processed prompts:  20%|█▉        | 802/4096 [02:22<10:01,  5.48it/s, est. speed input: 5767.83 toks/s, output: 5.63 toks/s]
Processed prompts:  20%|██        | 834/4096 [02:28<10:12,  5.33it/s, est. speed input: 5740.23 toks/s, output: 5.61 toks/s]
Processed prompts:  21%|██        | 866/4096 [02:35<10:18,  5.23it/s, est. speed input: 5714.93 toks/s, output: 5.58 toks/s]
Processed prompts:  22%|██▏       | 898/4096 [02:41<10:20,  5.16it/s, est. speed input: 5691.66 toks/s, output: 5.56 toks/s]
Processed prompts:  23%|██▎       | 930/4096 [02:47<10:19,  5.11it/s, est. speed input: 5670.12 toks/s, output: 5.54 toks/s]
Processed prompts:  23%|██▎       | 962/4096 [02:54<10:17,  5.08it/s, est. speed input: 5650.20 toks/s, output: 5.52 toks/s]
Processed prompts:  24%|██▍       | 994/4096 [02:59<09:32,  5.42it/s, est. speed input: 5675.45 toks/s, output: 5.54 toks/s]
Processed prompts:  25%|██▌       | 1026/4096 [03:05<09:40,  5.29it/s, est. speed input: 5656.56 toks/s, output: 5.52 toks/s]
Processed prompts:  26%|██▌       | 1058/4096 [03:12<09:44,  5.20it/s, est. speed input: 5638.90 toks/s, output: 5.51 toks/s]
Processed prompts:  27%|██▋       | 1090/4096 [03:18<09:44,  5.14it/s, est. speed input: 5622.40 toks/s, output: 5.49 toks/s]
Processed prompts:  27%|██▋       | 1122/4096 [03:24<09:43,  5.10it/s, est. speed input: 5606.93 toks/s, output: 5.48 toks/s]
Processed prompts:  28%|██▊       | 1154/4096 [03:29<09:01,  5.43it/s, est. speed input: 5629.50 toks/s, output: 5.50 toks/s]
Processed prompts:  29%|██▉       | 1186/4096 [03:36<09:09,  5.30it/s, est. speed input: 5614.64 toks/s, output: 5.48 toks/s]
Processed prompts:  30%|██▉       | 1218/4096 [03:42<09:12,  5.21it/s, est. speed input: 5600.60 toks/s, output: 5.47 toks/s]
Processed prompts:  31%|███       | 1250/4096 [03:49<09:13,  5.14it/s, est. speed input: 5587.36 toks/s, output: 5.46 toks/s]
Processed prompts:  31%|███▏      | 1282/4096 [03:55<09:11,  5.10it/s, est. speed input: 5574.84 toks/s, output: 5.44 toks/s]
Processed prompts:  32%|███▏      | 1314/4096 [04:00<08:32,  5.43it/s, est. speed input: 5595.30 toks/s, output: 5.46 toks/s]
Processed prompts:  33%|███▎      | 1346/4096 [04:06<08:38,  5.30it/s, est. speed input: 5583.26 toks/s, output: 5.45 toks/s]
Processed prompts:  34%|███▎      | 1378/4096 [04:13<08:42,  5.21it/s, est. speed input: 5571.66 toks/s, output: 5.44 toks/s]
Processed prompts:  34%|███▍      | 1410/4096 [04:19<08:42,  5.14it/s, est. speed input: 5560.57 toks/s, output: 5.43 toks/s]
Processed prompts:  35%|███▌      | 1442/4096 [04:26<08:40,  5.10it/s, est. speed input: 5550.09 toks/s, output: 5.42 toks/s]
Processed prompts:  36%|███▌      | 1474/4096 [04:31<08:02,  5.43it/s, est. speed input: 5568.73 toks/s, output: 5.44 toks/s]
Processed prompts:  37%|███▋      | 1506/4096 [04:37<08:08,  5.30it/s, est. speed input: 5558.53 toks/s, output: 5.43 toks/s]
Processed prompts:  38%|███▊      | 1538/4096 [04:43<08:11,  5.21it/s, est. speed input: 5548.78 toks/s, output: 5.42 toks/s]
Processed prompts:  38%|███▊      | 1570/4096 [04:50<08:10,  5.14it/s, est. speed input: 5539.47 toks/s, output: 5.41 toks/s]
Processed prompts:  39%|███▉      | 1602/4096 [04:56<08:03,  5.15it/s, est. speed input: 5534.49 toks/s, output: 5.40 toks/s]
Processed prompts:  40%|███▉      | 1634/4096 [05:01<07:29,  5.48it/s, est. speed input: 5551.47 toks/s, output: 5.42 toks/s]
Processed prompts:  41%|████      | 1666/4096 [05:07<07:36,  5.33it/s, est. speed input: 5542.63 toks/s, output: 5.41 toks/s]
Processed prompts:  41%|████▏     | 1698/4096 [05:14<07:38,  5.22it/s, est. speed input: 5534.13 toks/s, output: 5.40 toks/s]
Processed prompts:  42%|████▏     | 1730/4096 [05:20<07:38,  5.16it/s, est. speed input: 5526.07 toks/s, output: 5.40 toks/s]
Processed prompts:  43%|████▎     | 1762/4096 [05:26<07:36,  5.11it/s, est. speed input: 5518.34 toks/s, output: 5.39 toks/s]
Processed prompts:  44%|████▍     | 1794/4096 [05:31<07:03,  5.44it/s, est. speed input: 5533.84 toks/s, output: 5.40 toks/s]
Processed prompts:  45%|████▍     | 1826/4096 [05:38<07:08,  5.29it/s, est. speed input: 5525.71 toks/s, output: 5.40 toks/s]
Processed prompts:  45%|████▌     | 1858/4096 [05:44<07:10,  5.20it/s, est. speed input: 5518.05 toks/s, output: 5.39 toks/s]
Processed prompts:  46%|████▌     | 1890/4096 [05:51<07:09,  5.14it/s, est. speed input: 5510.96 toks/s, output: 5.38 toks/s]
Processed prompts:  47%|████▋     | 1922/4096 [05:57<07:06,  5.10it/s, est. speed input: 5504.13 toks/s, output: 5.38 toks/s]
Processed prompts:  48%|████▊     | 1954/4096 [06:02<06:33,  5.44it/s, est. speed input: 5519.30 toks/s, output: 5.39 toks/s]
Processed prompts:  48%|████▊     | 1986/4096 [06:08<06:37,  5.31it/s, est. speed input: 5512.53 toks/s, output: 5.38 toks/s]
Processed prompts:  49%|████▉     | 2018/4096 [06:15<06:38,  5.21it/s, est. speed input: 5505.96 toks/s, output: 5.38 toks/s]
Processed prompts:  50%|█████     | 2050/4096 [06:21<06:37,  5.15it/s, est. speed input: 5499.60 toks/s, output: 5.37 toks/s]
Processed prompts:  51%|█████     | 2082/4096 [06:28<06:34,  5.11it/s, est. speed input: 5493.46 toks/s, output: 5.36 toks/s]
Processed prompts:  52%|█████▏    | 2114/4096 [06:33<06:04,  5.43it/s, est. speed input: 5506.92 toks/s, output: 5.38 toks/s]
Processed prompts:  52%|█████▏    | 2146/4096 [06:39<06:07,  5.30it/s, est. speed input: 5500.87 toks/s, output: 5.37 toks/s]
Processed prompts:  53%|█████▎    | 2178/4096 [06:45<06:04,  5.26it/s, est. speed input: 5497.83 toks/s, output: 5.37 toks/s]
Processed prompts:  54%|█████▍    | 2210/4096 [06:52<06:03,  5.18it/s, est. speed input: 5492.07 toks/s, output: 5.36 toks/s]
Processed prompts:  55%|█████▍    | 2242/4096 [06:58<06:01,  5.13it/s, est. speed input: 5486.49 toks/s, output: 5.36 toks/s]
Processed prompts:  56%|█████▌    | 2274/4096 [07:03<05:34,  5.45it/s, est. speed input: 5499.08 toks/s, output: 5.37 toks/s]
Processed prompts:  56%|█████▋    | 2306/4096 [07:09<05:36,  5.31it/s, est. speed input: 5493.57 toks/s, output: 5.36 toks/s]
Processed prompts:  57%|█████▋    | 2338/4096 [07:16<05:37,  5.22it/s, est. speed input: 5488.16 toks/s, output: 5.36 toks/s]
Processed prompts:  58%|█████▊    | 2370/4096 [07:22<05:35,  5.15it/s, est. speed input: 5482.92 toks/s, output: 5.35 toks/s]
Processed prompts:  59%|█████▊    | 2402/4096 [07:29<05:31,  5.11it/s, est. speed input: 5477.81 toks/s, output: 5.35 toks/s]
Processed prompts:  59%|█████▉    | 2434/4096 [07:34<05:05,  5.44it/s, est. speed input: 5489.74 toks/s, output: 5.36 toks/s]
Processed prompts:  60%|██████    | 2466/4096 [07:40<05:07,  5.30it/s, est. speed input: 5484.81 toks/s, output: 5.36 toks/s]
Processed prompts:  61%|██████    | 2498/4096 [07:46<05:06,  5.21it/s, est. speed input: 5479.81 toks/s, output: 5.35 toks/s]
Processed prompts:  62%|██████▏   | 2530/4096 [07:53<05:04,  5.14it/s, est. speed input: 5474.82 toks/s, output: 5.35 toks/s]
Processed prompts:  63%|██████▎   | 2562/4096 [07:59<05:01,  5.10it/s, est. speed input: 5469.96 toks/s, output: 5.34 toks/s]
Processed prompts:  63%|██████▎   | 2594/4096 [08:04<04:36,  5.44it/s, est. speed input: 5481.56 toks/s, output: 5.35 toks/s]
Processed prompts:  64%|██████▍   | 2626/4096 [08:10<04:36,  5.31it/s, est. speed input: 5477.46 toks/s, output: 5.35 toks/s]
Processed prompts:  65%|██████▍   | 2658/4096 [08:17<04:35,  5.22it/s, est. speed input: 5473.01 toks/s, output: 5.34 toks/s]
Processed prompts:  66%|██████▌   | 2690/4096 [08:23<04:33,  5.13it/s, est. speed input: 5467.73 toks/s, output: 5.34 toks/s]
Processed prompts:  66%|██████▋   | 2722/4096 [08:30<04:29,  5.09it/s, est. speed input: 5463.35 toks/s, output: 5.34 toks/s]
Processed prompts:  67%|██████▋   | 2754/4096 [08:36<04:24,  5.07it/s, est. speed input: 5459.33 toks/s, output: 5.33 toks/s]
Processed prompts:  68%|██████▊   | 2786/4096 [08:41<04:01,  5.42it/s, est. speed input: 5470.19 toks/s, output: 5.34 toks/s]
Processed prompts:  69%|██████▉   | 2818/4096 [08:47<04:01,  5.29it/s, est. speed input: 5466.03 toks/s, output: 5.34 toks/s]
Processed prompts:  70%|██████▉   | 2850/4096 [08:54<03:59,  5.20it/s, est. speed input: 5461.96 toks/s, output: 5.33 toks/s]
Processed prompts:  70%|███████   | 2882/4096 [09:00<03:56,  5.14it/s, est. speed input: 5458.01 toks/s, output: 5.33 toks/s]
Processed prompts:  71%|███████   | 2914/4096 [09:07<03:51,  5.10it/s, est. speed input: 5454.15 toks/s, output: 5.33 toks/s]
Processed prompts:  72%|███████▏  | 2946/4096 [09:12<03:31,  5.43it/s, est. speed input: 5463.98 toks/s, output: 5.34 toks/s]
Processed prompts:  73%|███████▎  | 2978/4096 [09:18<03:31,  5.29it/s, est. speed input: 5460.10 toks/s, output: 5.33 toks/s]
Processed prompts:  73%|███████▎  | 3010/4096 [09:24<03:28,  5.20it/s, est. speed input: 5456.31 toks/s, output: 5.33 toks/s]
Processed prompts:  74%|███████▍  | 3042/4096 [09:31<03:24,  5.14it/s, est. speed input: 5452.64 toks/s, output: 5.32 toks/s]
Processed prompts:  75%|███████▌  | 3074/4096 [09:37<03:20,  5.10it/s, est. speed input: 5449.04 toks/s, output: 5.32 toks/s]
Processed prompts:  76%|███████▌  | 3106/4096 [09:42<03:02,  5.43it/s, est. speed input: 5458.51 toks/s, output: 5.33 toks/s]
Processed prompts:  77%|███████▋  | 3138/4096 [09:49<03:00,  5.29it/s, est. speed input: 5454.82 toks/s, output: 5.33 toks/s]
Processed prompts:  77%|███████▋  | 3170/4096 [09:55<02:57,  5.20it/s, est. speed input: 5451.24 toks/s, output: 5.32 toks/s]
Processed prompts:  78%|███████▊  | 3202/4096 [10:01<02:53,  5.14it/s, est. speed input: 5447.78 toks/s, output: 5.32 toks/s]
Processed prompts:  79%|███████▉  | 3234/4096 [10:08<02:49,  5.10it/s, est. speed input: 5444.37 toks/s, output: 5.32 toks/s]
Processed prompts:  80%|███████▉  | 3266/4096 [10:13<02:32,  5.44it/s, est. speed input: 5453.59 toks/s, output: 5.33 toks/s]
Processed prompts:  81%|████████  | 3298/4096 [10:19<02:30,  5.30it/s, est. speed input: 5450.21 toks/s, output: 5.32 toks/s]
Processed prompts:  81%|████████▏ | 3330/4096 [10:26<02:27,  5.21it/s, est. speed input: 5446.89 toks/s, output: 5.32 toks/s]
Processed prompts:  82%|████████▏ | 3362/4096 [10:32<02:22,  5.15it/s, est. speed input: 5443.65 toks/s, output: 5.32 toks/s]
Processed prompts:  83%|████████▎ | 3394/4096 [10:38<02:17,  5.10it/s, est. speed input: 5440.47 toks/s, output: 5.31 toks/s]
Processed prompts:  84%|████████▎ | 3426/4096 [10:43<02:03,  5.43it/s, est. speed input: 5449.16 toks/s, output: 5.32 toks/s]
Processed prompts:  84%|████████▍ | 3458/4096 [10:50<02:00,  5.30it/s, est. speed input: 5445.97 toks/s, output: 5.32 toks/s]
Processed prompts:  85%|████████▌ | 3490/4096 [10:56<01:56,  5.21it/s, est. speed input: 5442.83 toks/s, output: 5.32 toks/s]
Processed prompts:  86%|████████▌ | 3522/4096 [11:02<01:51,  5.14it/s, est. speed input: 5439.75 toks/s, output: 5.31 toks/s]
Processed prompts:  87%|████████▋ | 3554/4096 [11:09<01:46,  5.10it/s, est. speed input: 5436.74 toks/s, output: 5.31 toks/s]
Processed prompts:  88%|████████▊ | 3586/4096 [11:14<01:33,  5.44it/s, est. speed input: 5445.12 toks/s, output: 5.32 toks/s]
Processed prompts:  88%|████████▊ | 3618/4096 [11:20<01:30,  5.30it/s, est. speed input: 5442.16 toks/s, output: 5.31 toks/s]
Processed prompts:  89%|████████▉ | 3650/4096 [11:27<01:25,  5.21it/s, est. speed input: 5439.17 toks/s, output: 5.31 toks/s]
Processed prompts:  90%|████████▉ | 3682/4096 [11:33<01:19,  5.20it/s, est. speed input: 5437.87 toks/s, output: 5.31 toks/s]
Processed prompts:  91%|█████████ | 3714/4096 [11:39<01:14,  5.14it/s, est. speed input: 5434.97 toks/s, output: 5.31 toks/s]
Processed prompts:  91%|█████████▏| 3746/4096 [11:44<01:04,  5.46it/s, est. speed input: 5443.01 toks/s, output: 5.32 toks/s]
Processed prompts:  92%|█████████▏| 3778/4096 [11:51<00:59,  5.32it/s, est. speed input: 5440.14 toks/s, output: 5.31 toks/s]
Processed prompts:  93%|█████████▎| 3810/4096 [11:57<00:54,  5.22it/s, est. speed input: 5437.33 toks/s, output: 5.31 toks/s]
Processed prompts:  94%|█████████▍| 3842/4096 [12:03<00:49,  5.15it/s, est. speed input: 5434.55 toks/s, output: 5.31 toks/s]
Processed prompts:  95%|█████████▍| 3874/4096 [12:10<00:43,  5.11it/s, est. speed input: 5431.86 toks/s, output: 5.30 toks/s]
Processed prompts:  95%|█████████▌| 3906/4096 [12:15<00:34,  5.50it/s, est. speed input: 5441.09 toks/s, output: 5.31 toks/s]
Processed prompts:  96%|█████████▌| 3938/4096 [12:21<00:29,  5.34it/s, est. speed input: 5438.36 toks/s, output: 5.31 toks/s]
Processed prompts:  97%|█████████▋| 3970/4096 [12:27<00:24,  5.23it/s, est. speed input: 5435.67 toks/s, output: 5.31 toks/s]
Processed prompts:  98%|█████████▊| 4002/4096 [12:34<00:18,  5.16it/s, est. speed input: 5433.03 toks/s, output: 5.31 toks/s]
Processed prompts:  98%|█████████▊| 4034/4096 [12:40<00:12,  5.12it/s, est. speed input: 5430.46 toks/s, output: 5.30 toks/s]
Processed prompts:  99%|█████████▉| 4066/4096 [12:45<00:05,  5.51it/s, est. speed input: 5439.44 toks/s, output: 5.31 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [12:45<00:00,  5.51it/s, est. speed input: 5479.57 toks/s, output: 5.35 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [12:45<00:00,  5.35it/s, est. speed input: 5479.57 toks/s, output: 5.35 toks/s]
[rank0]:[W126 05:11:03.600812937 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 862.2s

测试结果:
  Requests/s:   5.01
  Tokens/s:     5135.02
  Total Reqs:   4096
  Elapsed:      817.60s

  [Prefill 分析]
  Total Prefill Tokens: 4194304
  Prefill Tokens/s:     5130.01

============================================================
[8/8] 测试 M=65536
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 65536
│   M_prefill     = 65536 (= 64 x 1024)
│   M_decode      = 64
│   batched_tokens = 65536 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 8192
│   --max-num-seqs           = 64
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 65536
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 05:12:13 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 05:12:14 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=215897) WARNING 01-26 05:12:21 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=215897) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=215897) WARNING 01-26 05:12:35 [backends.py:609] Failed to read file <frozen os>
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 240, in _initialize_kv_caches
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     available_gpu_memory = self.model_executor.determine_available_memory()
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     return self.collective_rpc("determine_available_memory")
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     result = run_method(self.driver_worker, method, args, kwargs)
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/root/vllmbench/vllm/v1/serial_utils.py", line 461, in run_method
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 340, in determine_available_memory
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     self.model_runner.profile_run()
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4474, in profile_run
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     hidden_states, last_hidden_states = self._dummy_run(
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]                                         ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4198, in _dummy_run
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     outputs = self.model(
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]               ^^^^^^^^^^^
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 583, in forward
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     hidden_states = self.model(
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]                     ^^^^^^^^^^^
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/root/vllmbench/vllm/compilation/decorators.py", line 526, in __call__
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/root/vllmbench/vllm/compilation/wrapper.py", line 218, in __call__
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     return self._call_with_optional_nvtx_range(
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/root/vllmbench/vllm/compilation/wrapper.py", line 109, in _call_with_optional_nvtx_range
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     return callable_fn(*args, **kwargs)
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 832, in compile_wrapper
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     return fn(*args, **kwargs)
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 418, in forward
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     def forward(
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     return fn(*args, **kwargs)
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/root/vllmbench/vllm/compilation/caching.py", line 54, in __call__
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     return self.optimized_call(*args, **kwargs)
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 837, in call_wrapped
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     return self._wrapped_call(self, *args, **kwargs)
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 413, in __call__
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     raise e
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 400, in __call__
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     return super(self.cls, obj).__call__(*args, **kwargs)  # type: ignore[misc]
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "<eval_with_key>.58", line 325, in forward
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     submod_2 = self.submod_2(getitem_3, s72, l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_scale_, l_self_modules_layers_modules_0_modules_post_attention_layernorm_parameters_weight_, getitem_4, l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_scale_, l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_input_layernorm_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_bias_, l_positions_, l_self_modules_layers_modules_0_modules_self_attn_modules_rotary_emb_buffers_cos_sin_cache_);  getitem_3 = l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_scale_ = l_self_modules_layers_modules_0_modules_post_attention_layernorm_parameters_weight_ = getitem_4 = l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_scale_ = l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_input_layernorm_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_bias_ = None
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/root/vllmbench/vllm/compilation/piecewise_backend.py", line 178, in __call__
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     return range_entry.runnable(*args)
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/standalone_compile.py", line 63, in __call__
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     return self._compiled_fn(*args)
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     return fn(*args, **kwargs)
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/aot_autograd.py", line 1130, in forward
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     return compiled_fn(full_args)
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 353, in runtime_wrapper
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     all_outs = call_func_at_runtime_with_args(
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/utils.py", line 129, in call_func_at_runtime_with_args
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     out = normalize_as_list(f(args))
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]                             ^^^^^^^
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 724, in inner_fn
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     outs = compiled_fn(args)
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]            ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 526, in wrapper
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     return compiled_fn(runtime_args)
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/output_code.py", line 613, in __call__
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     return self.current_callable(inputs)
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/utils.py", line 2962, in run
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     out = model(new_inputs)
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]           ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/tmp/torchinductor_root/ar/cargdknnyxc27i6nfnlzvi5zgcsm4wlzok6c55nlais5diyrot6v.py", line 1093, in call
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     buf17 = torch.ops.slidesparse.quant_slide_fp8.default(buf16, 'Qwen2.5-7B-FP8', 10)
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_ops.py", line 841, in __call__
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     return self._op(*args, **kwargs)
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/root/vllmbench/slidesparse/core/kernels.py", line 521, in _quant_slide_fp8_impl
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     return fn(input, L)
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]            ^^^^^^^^^^^^
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/root/vllmbench/slidesparse/csrc/fused_quant_slide_triton/build/RTX4090_cc89_py312_cu129_x86_64/quant_slide_tuned_Qwen2.5-7B.py", line 263, in quant_slide_fp8_triton
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     _quant_slide_fp8_kernel[(M,)](
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/triton/runtime/jit.py", line 419, in <lambda>
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/triton/runtime/jit.py", line 756, in run
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     launch_metadata = kernel.launch_metadata(grid, stream, *bound_args.values())
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 490, in launch_metadata
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     self._init_handles()
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 473, in _init_handles
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]     self.module, self.function, self.n_regs, self.n_spills, self.n_max_threads = driver.active.utils.load_binary(
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866]                                                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897) ERROR 01-26 05:12:44 [core.py:866] RuntimeError: Triton Error [CUDA]: an illegal memory access was encountered


─── STDERR ───
[2026-01-26 05:12:12] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:12:12] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 05:12:12] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 05:12:12] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 05:12:12] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 05:12:12] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 05:12:12] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 05:12:12] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 05:12:12] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 05:12:12] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:12:12] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:12:12] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:12:12] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:12:12] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 05:12:20] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:12:20] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 05:12:20] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 05:12:20] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 05:12:20] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 05:12:20] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 05:12:20] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 05:12:20] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 05:12:20] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 05:12:20] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:12:20] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:12:20] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:12:20] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:12:20] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=215897) [2026-01-26 05:12:22] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=215897) [2026-01-26 05:12:22] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=215897) [2026-01-26 05:12:22] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=215897) [2026-01-26 05:12:22] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=215897) [2026-01-26 05:12:22] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=215897) [2026-01-26 05:12:22] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=215897) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=215897) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.02it/s]
(EngineCore_DP0 pid=215897) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.22s/it]
(EngineCore_DP0 pid=215897) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.19s/it]
(EngineCore_DP0 pid=215897) 
(EngineCore_DP0 pid=215897) [2026-01-26 05:12:25] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 5760] -> 1D uint8
(EngineCore_DP0 pid=215897) [2026-01-26 05:12:25] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 19906560 bytes
(EngineCore_DP0 pid=215897) [2026-01-26 05:12:25] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 5760] -> 1D uint8
(EngineCore_DP0 pid=215897) [2026-01-26 05:12:25] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 15482880 bytes
(EngineCore_DP0 pid=215897) [2026-01-26 05:12:25] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 5760] -> 1D uint8
(EngineCore_DP0 pid=215897) [2026-01-26 05:12:25] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 163676160 bytes
(EngineCore_DP0 pid=215897) [2026-01-26 05:12:25] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 30336] -> 1D uint8
(EngineCore_DP0 pid=215897) [2026-01-26 05:12:25] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 81543168 bytes
(EngineCore_DP0 pid=215897) [rank0]:W0126 05:12:41.775000 215897 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=215897) [rank0]:W0126 05:12:41.887000 215897 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=215897) [rank0]:W0126 05:12:43.541000 215897 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=215897) [rank0]:W0126 05:12:43.706000 215897 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=215897) Process EngineCore_DP0:
(EngineCore_DP0 pid=215897) Traceback (most recent call last):
(EngineCore_DP0 pid=215897)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=215897)     self.run()
(EngineCore_DP0 pid=215897)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=215897)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=215897)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=215897)     raise e
(EngineCore_DP0 pid=215897)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=215897)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=215897)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=215897)     super().__init__(
(EngineCore_DP0 pid=215897)   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=215897)     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=215897)                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897)   File "/root/vllmbench/vllm/v1/engine/core.py", line 240, in _initialize_kv_caches
(EngineCore_DP0 pid=215897)     available_gpu_memory = self.model_executor.determine_available_memory()
(EngineCore_DP0 pid=215897)                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897)   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
(EngineCore_DP0 pid=215897)     return self.collective_rpc("determine_available_memory")
(EngineCore_DP0 pid=215897)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897)   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
(EngineCore_DP0 pid=215897)     result = run_method(self.driver_worker, method, args, kwargs)
(EngineCore_DP0 pid=215897)              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897)   File "/root/vllmbench/vllm/v1/serial_utils.py", line 461, in run_method
(EngineCore_DP0 pid=215897)     return func(*args, **kwargs)
(EngineCore_DP0 pid=215897)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897)   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=215897)     return func(*args, **kwargs)
(EngineCore_DP0 pid=215897)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897)   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 340, in determine_available_memory
(EngineCore_DP0 pid=215897)     self.model_runner.profile_run()
(EngineCore_DP0 pid=215897)   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4474, in profile_run
(EngineCore_DP0 pid=215897)     hidden_states, last_hidden_states = self._dummy_run(
(EngineCore_DP0 pid=215897)                                         ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897)   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=215897)     return func(*args, **kwargs)
(EngineCore_DP0 pid=215897)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897)   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4198, in _dummy_run
(EngineCore_DP0 pid=215897)     outputs = self.model(
(EngineCore_DP0 pid=215897)               ^^^^^^^^^^^
(EngineCore_DP0 pid=215897)   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=215897)     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=215897)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=215897)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=215897)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=215897)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=215897)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 583, in forward
(EngineCore_DP0 pid=215897)     hidden_states = self.model(
(EngineCore_DP0 pid=215897)                     ^^^^^^^^^^^
(EngineCore_DP0 pid=215897)   File "/root/vllmbench/vllm/compilation/decorators.py", line 526, in __call__
(EngineCore_DP0 pid=215897)     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
(EngineCore_DP0 pid=215897)              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897)   File "/root/vllmbench/vllm/compilation/wrapper.py", line 218, in __call__
(EngineCore_DP0 pid=215897)     return self._call_with_optional_nvtx_range(
(EngineCore_DP0 pid=215897)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897)   File "/root/vllmbench/vllm/compilation/wrapper.py", line 109, in _call_with_optional_nvtx_range
(EngineCore_DP0 pid=215897)     return callable_fn(*args, **kwargs)
(EngineCore_DP0 pid=215897)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897)   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 832, in compile_wrapper
(EngineCore_DP0 pid=215897)     return fn(*args, **kwargs)
(EngineCore_DP0 pid=215897)            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 418, in forward
(EngineCore_DP0 pid=215897)     def forward(
(EngineCore_DP0 pid=215897)   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=215897)     return fn(*args, **kwargs)
(EngineCore_DP0 pid=215897)            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897)   File "/root/vllmbench/vllm/compilation/caching.py", line 54, in __call__
(EngineCore_DP0 pid=215897)     return self.optimized_call(*args, **kwargs)
(EngineCore_DP0 pid=215897)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897)   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 837, in call_wrapped
(EngineCore_DP0 pid=215897)     return self._wrapped_call(self, *args, **kwargs)
(EngineCore_DP0 pid=215897)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897)   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 413, in __call__
(EngineCore_DP0 pid=215897)     raise e
(EngineCore_DP0 pid=215897)   File "/usr/local/lib/python3.12/dist-packages/torch/fx/graph_module.py", line 400, in __call__
(EngineCore_DP0 pid=215897)     return super(self.cls, obj).__call__(*args, **kwargs)  # type: ignore[misc]
(EngineCore_DP0 pid=215897)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=215897)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=215897)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=215897)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=215897)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897)   File "<eval_with_key>.58", line 325, in forward
(EngineCore_DP0 pid=215897)     submod_2 = self.submod_2(getitem_3, s72, l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_scale_, l_self_modules_layers_modules_0_modules_post_attention_layernorm_parameters_weight_, getitem_4, l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_scale_, l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_, l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_input_layernorm_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_scale_, l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_bias_, l_positions_, l_self_modules_layers_modules_0_modules_self_attn_modules_rotary_emb_buffers_cos_sin_cache_);  getitem_3 = l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_self_attn_modules_o_proj_parameters_weight_scale_ = l_self_modules_layers_modules_0_modules_post_attention_layernorm_parameters_weight_ = getitem_4 = l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_mlp_modules_gate_up_proj_parameters_weight_scale_ = l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_ = l_self_modules_layers_modules_0_modules_mlp_modules_down_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_input_layernorm_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_weight_scale_ = l_self_modules_layers_modules_1_modules_self_attn_modules_qkv_proj_parameters_bias_ = None
(EngineCore_DP0 pid=215897)                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897)   File "/root/vllmbench/vllm/compilation/cuda_graph.py", line 220, in __call__
(EngineCore_DP0 pid=215897)     return self.runnable(*args, **kwargs)
(EngineCore_DP0 pid=215897)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897)   File "/root/vllmbench/vllm/compilation/piecewise_backend.py", line 178, in __call__
(EngineCore_DP0 pid=215897)     return range_entry.runnable(*args)
(EngineCore_DP0 pid=215897)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/standalone_compile.py", line 63, in __call__
(EngineCore_DP0 pid=215897)     return self._compiled_fn(*args)
(EngineCore_DP0 pid=215897)            ^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897)   File "/usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
(EngineCore_DP0 pid=215897)     return fn(*args, **kwargs)
(EngineCore_DP0 pid=215897)            ^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/aot_autograd.py", line 1130, in forward
(EngineCore_DP0 pid=215897)     return compiled_fn(full_args)
(EngineCore_DP0 pid=215897)            ^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 353, in runtime_wrapper
(EngineCore_DP0 pid=215897)     all_outs = call_func_at_runtime_with_args(
(EngineCore_DP0 pid=215897)                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/utils.py", line 129, in call_func_at_runtime_with_args
(EngineCore_DP0 pid=215897)     out = normalize_as_list(f(args))
(EngineCore_DP0 pid=215897)                             ^^^^^^^
(EngineCore_DP0 pid=215897)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 724, in inner_fn
(EngineCore_DP0 pid=215897)     outs = compiled_fn(args)
(EngineCore_DP0 pid=215897)            ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897)   File "/usr/local/lib/python3.12/dist-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 526, in wrapper
(EngineCore_DP0 pid=215897)     return compiled_fn(runtime_args)
(EngineCore_DP0 pid=215897)            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/output_code.py", line 613, in __call__
(EngineCore_DP0 pid=215897)     return self.current_callable(inputs)
(EngineCore_DP0 pid=215897)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897)   File "/usr/local/lib/python3.12/dist-packages/torch/_inductor/utils.py", line 2962, in run
(EngineCore_DP0 pid=215897)     out = model(new_inputs)
(EngineCore_DP0 pid=215897)           ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897)   File "/tmp/torchinductor_root/ar/cargdknnyxc27i6nfnlzvi5zgcsm4wlzok6c55nlais5diyrot6v.py", line 1093, in call
(EngineCore_DP0 pid=215897)     buf17 = torch.ops.slidesparse.quant_slide_fp8.default(buf16, 'Qwen2.5-7B-FP8', 10)
(EngineCore_DP0 pid=215897)             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897)   File "/usr/local/lib/python3.12/dist-packages/torch/_ops.py", line 841, in __call__
(EngineCore_DP0 pid=215897)     return self._op(*args, **kwargs)
(EngineCore_DP0 pid=215897)            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897)   File "/root/vllmbench/slidesparse/core/kernels.py", line 521, in _quant_slide_fp8_impl
(EngineCore_DP0 pid=215897)     return fn(input, L)
(EngineCore_DP0 pid=215897)            ^^^^^^^^^^^^
(EngineCore_DP0 pid=215897)   File "/root/vllmbench/slidesparse/csrc/fused_quant_slide_triton/build/RTX4090_cc89_py312_cu129_x86_64/quant_slide_tuned_Qwen2.5-7B.py", line 263, in quant_slide_fp8_triton
(EngineCore_DP0 pid=215897)     _quant_slide_fp8_kernel[(M,)](
(EngineCore_DP0 pid=215897)   File "/usr/local/lib/python3.12/dist-packages/triton/runtime/jit.py", line 419, in <lambda>
(EngineCore_DP0 pid=215897)     return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)
(EngineCore_DP0 pid=215897)                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897)   File "/usr/local/lib/python3.12/dist-packages/triton/runtime/jit.py", line 756, in run
(EngineCore_DP0 pid=215897)     launch_metadata = kernel.launch_metadata(grid, stream, *bound_args.values())
(EngineCore_DP0 pid=215897)                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897)   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 490, in launch_metadata
(EngineCore_DP0 pid=215897)     self._init_handles()
(EngineCore_DP0 pid=215897)   File "/usr/local/lib/python3.12/dist-packages/triton/compiler/compiler.py", line 473, in _init_handles
(EngineCore_DP0 pid=215897)     self.module, self.function, self.n_regs, self.n_spills, self.n_max_threads = driver.active.utils.load_binary(
(EngineCore_DP0 pid=215897)                                                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=215897) RuntimeError: Triton Error [CUDA]: an illegal memory access was encountered
[rank0]:[W126 05:12:45.798436163 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

[ERROR] 测试失败: M=65536 (exit code: 1)


------------------------------------------------------------
  生成 CSV: Qwen2.5-7B-FP8
------------------------------------------------------------
[SUCCESS] CSV 保存到: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_FP8E4M3_py312_cu129_x86_64/cusparselt/2_10/Qwen2.5-7B-FP8_prefill.csv

预览:
------------------------------------------------------------
M_prefill,prompt_len,max_num_seqs,num_prompts,N_prefill,requests_per_s,tokens_per_s,elapsed_time_s
512,512,1,128,128,16.1507,8285.3188,7.9253
1024,1024,1,128,128,15.7993,16194.2397,8.1016
2048,1024,2,256,128,17.1881,17617.7769,14.8940
4096,1024,4,512,128,17.9396,18388.0729,28.5402
8192,1024,8,1024,128,18.1376,18591.0213,56.4574
16384,1024,16,2048,128,9.5674,9806.5480,214.0611
32768,1024,32,4096,128,5.0098,5135.0173,817.6019
65536,1024,64,8192,128,-1.0000,-1.0000,-1.0000

------------------------------------------------------------

[INFO] 完成: 7 成功, 1 失败


============================================================
  Benchmark 完成!
============================================================


总计: 36 成功, 4 失败
============================================================
