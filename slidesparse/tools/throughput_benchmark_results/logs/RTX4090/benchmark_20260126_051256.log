======================================================================
SlideSparse vLLM Throughput Benchmark Log
Created: 2026-01-26 05:12:56
======================================================================

原始命令:
  /root/vllmbench/slidesparse/tools/throughput_benchmark.py --model qwen2.5-14b-int8 --backend cublaslt,cusparselt --stage prefill --sparsity 2_4,2_6,2_8,2_10 --M 512,1024,2048,4096,8192,16384,32768,65536

命令行参数:
  --model: qwen2.5-14b-int8
  --backend: cublaslt,cusparselt
  --sparsity: 2_4,2_6,2_8,2_10
  --stage: prefill
  --M: 512,1024,2048,4096,8192,16384,32768,65536
  --N: None
  --inner-32: False
  --eager: False
  --gpu-id: 0
  --gpu-mem: 0.8
  --dry-run: False
  --list-models: False

硬件信息:
  GPU: RTX4090
  Compute Capability: cc89
  VRAM: 24.0 GB
  CUDA: 12.9
  Python: py312

Backend 环境变量 (初始状态):
  DISABLE_SLIDESPARSE: 未设置
  USE_CUBLASLT: 未设置
  USE_CUSPARSELT: 未设置
  SPARSITY: 未设置
  INNER_DTYPE_32: 未设置

======================================================================


============================================================
  Qwen2.5-14B-INT8 | cuBLASLt | prefill
============================================================

[INFO] Checkpoint: /root/vllmbench/checkpoints/Qwen2.5-14B-INT8
[INFO] Output: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cublaslt

============================================================
[1/8] 测试 M=512
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-14B-INT8                                │
│ Backend:  cuBLASLt [INT32 output]                         │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 512
│   M_prefill     = 512 (= 1 x 512)
│   M_decode      = 1
│   batched_tokens = 513 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 512
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 513
│   --max-num-batched-tokens = 513
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 05:13:04 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 05:13:05 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=216861) WARNING 01-26 05:13:11 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=216861) WARNING 01-26 05:13:38 [backends.py:609] Failed to read file <frozen os>
Throughput: 8.75 requests/s, 4491.08 total tokens/s, 8.75 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128


─── STDERR ───
[2026-01-26 05:13:04] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:13:04] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:13:04] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:13:04] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:13:04] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:13:04] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:13:04] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:13:04] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:13:04] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:13:04] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:13:04] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:13:04] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:13:04] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:13:04] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 05:13:10] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:13:10] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:13:10] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:13:10] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:13:10] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:13:10] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:13:10] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:13:10] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:13:10] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:13:10] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:13:10] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:13:10] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:13:10] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:13:10] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=216861) [2026-01-26 05:13:12] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=216861) [2026-01-26 05:13:12] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=216861) [2026-01-26 05:13:12] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=216861) [2026-01-26 05:13:12] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=216861) [2026-01-26 05:13:12] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuBLASLt, symmetric=True
(EngineCore_DP0 pid=216861) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=216861) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:03<00:11,  3.94s/it]
(EngineCore_DP0 pid=216861) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:07<00:07,  3.82s/it]
(EngineCore_DP0 pid=216861) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:08<00:02,  2.64s/it]
(EngineCore_DP0 pid=216861) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:12<00:00,  3.09s/it]
(EngineCore_DP0 pid=216861) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:12<00:00,  3.17s/it]
(EngineCore_DP0 pid=216861) 
[cuBLASLt] INFO: INT8 GEMM only supports INT32 output. inner_dtype parameter is ignored, always using int32.
(EngineCore_DP0 pid=216861) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  1.52it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:01<00:00,  1.37it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:01<00:00,  1.39it/s]
(EngineCore_DP0 pid=216861) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  3.66it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  3.66it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  34%|███▍      | 44/128 [00:00<00:00, 430.31it/s]
Adding requests:  71%|███████   | 91/128 [00:00<00:00, 448.93it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 451.16it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<01:11,  1.76it/s, est. speed input: 903.29 toks/s, output: 1.76 toks/s]
Processed prompts:   2%|▏         | 2/128 [00:00<00:37,  3.37it/s, est. speed input: 1517.02 toks/s, output: 2.96 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:26,  4.75it/s, est. speed input: 1963.27 toks/s, output: 3.83 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:21,  5.90it/s, est. speed input: 2303.23 toks/s, output: 4.50 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:18,  6.82it/s, est. speed input: 2572.03 toks/s, output: 5.02 toks/s]
Processed prompts:   5%|▍         | 6/128 [00:01<00:16,  7.31it/s, est. speed input: 2759.53 toks/s, output: 5.39 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:01<00:15,  7.89it/s, est. speed input: 2939.97 toks/s, output: 5.74 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:01<00:14,  8.29it/s, est. speed input: 3087.46 toks/s, output: 6.03 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:01<00:13,  8.54it/s, est. speed input: 3208.71 toks/s, output: 6.27 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:01<00:13,  8.72it/s, est. speed input: 3313.26 toks/s, output: 6.47 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:01<00:13,  8.84it/s, est. speed input: 3403.37 toks/s, output: 6.65 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:01<00:12,  8.96it/s, est. speed input: 3484.61 toks/s, output: 6.81 toks/s]
Processed prompts:  10%|█         | 13/128 [00:01<00:12,  9.06it/s, est. speed input: 3557.87 toks/s, output: 6.95 toks/s]
Processed prompts:  11%|█         | 14/128 [00:01<00:12,  9.10it/s, est. speed input: 3621.36 toks/s, output: 7.07 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:02<00:12,  9.16it/s, est. speed input: 3680.20 toks/s, output: 7.19 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:02<00:12,  9.21it/s, est. speed input: 3733.64 toks/s, output: 7.29 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:02<00:12,  9.23it/s, est. speed input: 3781.40 toks/s, output: 7.39 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:02<00:11,  9.20it/s, est. speed input: 3822.17 toks/s, output: 7.47 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:02<00:11,  9.15it/s, est. speed input: 3857.48 toks/s, output: 7.53 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:02<00:11,  9.17it/s, est. speed input: 3893.13 toks/s, output: 7.60 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:02<00:11,  9.19it/s, est. speed input: 3925.89 toks/s, output: 7.67 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:02<00:11,  9.18it/s, est. speed input: 3955.08 toks/s, output: 7.72 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:02<00:11,  9.19it/s, est. speed input: 3983.40 toks/s, output: 7.78 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:03<00:11,  9.21it/s, est. speed input: 4009.79 toks/s, output: 7.83 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:03<00:11,  9.24it/s, est. speed input: 4035.69 toks/s, output: 7.88 toks/s]
Processed prompts:  20%|██        | 26/128 [00:03<00:10,  9.29it/s, est. speed input: 4061.02 toks/s, output: 7.93 toks/s]
Processed prompts:  21%|██        | 27/128 [00:03<00:10,  9.31it/s, est. speed input: 4083.95 toks/s, output: 7.98 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:03<00:10,  9.32it/s, est. speed input: 4105.73 toks/s, output: 8.02 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:03<00:10,  9.25it/s, est. speed input: 4122.21 toks/s, output: 8.05 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:03<00:01, 45.05it/s, est. speed input: 5930.59 toks/s, output: 11.58 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:04<00:03, 21.12it/s, est. speed input: 5800.74 toks/s, output: 11.33 toks/s]
Processed prompts:  41%|████      | 52/128 [00:04<00:04, 16.02it/s, est. speed input: 5713.35 toks/s, output: 11.16 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:04<00:05, 13.93it/s, est. speed input: 5657.89 toks/s, output: 11.05 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:05<00:05, 12.51it/s, est. speed input: 5607.97 toks/s, output: 10.95 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:05<00:05, 11.73it/s, est. speed input: 5571.68 toks/s, output: 10.88 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:05<00:05, 11.14it/s, est. speed input: 5542.83 toks/s, output: 10.83 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:05<00:05, 10.70it/s, est. speed input: 5517.23 toks/s, output: 10.78 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:06<00:05, 10.36it/s, est. speed input: 5493.52 toks/s, output: 10.73 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:06<00:05, 10.03it/s, est. speed input: 5466.70 toks/s, output: 10.68 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:06<00:05,  9.75it/s, est. speed input: 5439.59 toks/s, output: 10.62 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:06<00:05,  9.58it/s, est. speed input: 5415.63 toks/s, output: 10.58 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:06<00:05,  9.51it/s, est. speed input: 5404.44 toks/s, output: 10.56 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:07<00:05,  9.45it/s, est. speed input: 5393.48 toks/s, output: 10.53 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:07<00:05,  9.42it/s, est. speed input: 5383.97 toks/s, output: 10.52 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:07<00:05,  9.38it/s, est. speed input: 5374.55 toks/s, output: 10.50 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:07<00:05,  9.31it/s, est. speed input: 5363.91 toks/s, output: 10.48 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:07<00:05,  9.29it/s, est. speed input: 5354.68 toks/s, output: 10.46 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:07<00:05,  9.22it/s, est. speed input: 5343.97 toks/s, output: 10.44 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:07<00:05,  9.18it/s, est. speed input: 5334.18 toks/s, output: 10.42 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:07<00:05,  9.22it/s, est. speed input: 5326.29 toks/s, output: 10.40 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:07<00:04,  9.22it/s, est. speed input: 5318.02 toks/s, output: 10.39 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:08<00:04,  9.24it/s, est. speed input: 5310.53 toks/s, output: 10.37 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:08<00:04,  9.25it/s, est. speed input: 5302.89 toks/s, output: 10.36 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:08<00:04,  9.29it/s, est. speed input: 5296.48 toks/s, output: 10.34 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:08<00:04,  9.27it/s, est. speed input: 5288.96 toks/s, output: 10.33 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:08<00:04,  9.23it/s, est. speed input: 5280.97 toks/s, output: 10.31 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:08<00:04,  9.16it/s, est. speed input: 5272.19 toks/s, output: 10.30 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:08<00:04,  9.13it/s, est. speed input: 5264.09 toks/s, output: 10.28 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:08<00:04,  9.14it/s, est. speed input: 5256.99 toks/s, output: 10.27 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:08<00:04,  9.15it/s, est. speed input: 5250.07 toks/s, output: 10.25 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:08<00:03,  9.15it/s, est. speed input: 5243.15 toks/s, output: 10.24 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:09<00:03,  9.14it/s, est. speed input: 5236.17 toks/s, output: 10.23 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:09<00:03,  9.13it/s, est. speed input: 5229.34 toks/s, output: 10.21 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:09<00:03,  9.07it/s, est. speed input: 5221.41 toks/s, output: 10.20 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:09<00:03,  9.06it/s, est. speed input: 5214.44 toks/s, output: 10.18 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:09<00:03,  9.08it/s, est. speed input: 5208.27 toks/s, output: 10.17 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:09<00:03,  9.09it/s, est. speed input: 5202.05 toks/s, output: 10.16 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:09<00:03,  9.10it/s, est. speed input: 5196.17 toks/s, output: 10.15 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:09<00:03,  9.14it/s, est. speed input: 5190.96 toks/s, output: 10.14 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:09<00:02,  9.11it/s, est. speed input: 5184.81 toks/s, output: 10.13 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:10<00:02,  9.15it/s, est. speed input: 5179.95 toks/s, output: 10.12 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:10<00:02,  9.13it/s, est. speed input: 5174.16 toks/s, output: 10.11 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:10<00:02,  9.16it/s, est. speed input: 5169.50 toks/s, output: 10.10 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:10<00:02,  9.20it/s, est. speed input: 5165.28 toks/s, output: 10.09 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:10<00:02,  9.21it/s, est. speed input: 5160.73 toks/s, output: 10.08 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:10<00:02,  9.20it/s, est. speed input: 5155.93 toks/s, output: 10.07 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:10<00:02,  9.17it/s, est. speed input: 5150.94 toks/s, output: 10.06 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:10<00:02,  9.16it/s, est. speed input: 5146.14 toks/s, output: 10.05 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:10<00:01,  9.14it/s, est. speed input: 5141.21 toks/s, output: 10.04 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:11<00:01,  9.13it/s, est. speed input: 5136.53 toks/s, output: 10.03 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:11<00:01,  9.15it/s, est. speed input: 5132.37 toks/s, output: 10.02 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:11<00:01,  9.16it/s, est. speed input: 5128.18 toks/s, output: 10.02 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:11<00:01,  9.15it/s, est. speed input: 5123.79 toks/s, output: 10.01 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:11<00:01,  9.17it/s, est. speed input: 5119.89 toks/s, output: 10.00 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:11<00:01,  9.15it/s, est. speed input: 5115.59 toks/s, output: 9.99 toks/s] 
Processed prompts:  91%|█████████▏| 117/128 [00:11<00:01,  9.12it/s, est. speed input: 5111.00 toks/s, output: 9.98 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:11<00:01,  9.12it/s, est. speed input: 5106.95 toks/s, output: 9.97 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:11<00:00,  9.11it/s, est. speed input: 5102.70 toks/s, output: 9.97 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:12<00:00,  9.11it/s, est. speed input: 5098.74 toks/s, output: 9.96 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:12<00:00,  9.12it/s, est. speed input: 5095.01 toks/s, output: 9.95 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:12<00:00,  9.13it/s, est. speed input: 5091.39 toks/s, output: 9.94 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:12<00:00,  9.14it/s, est. speed input: 5087.80 toks/s, output: 9.94 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:12<00:00,  9.17it/s, est. speed input: 5084.81 toks/s, output: 9.93 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:12<00:00,  9.19it/s, est. speed input: 5081.69 toks/s, output: 9.93 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:12<00:00,  9.18it/s, est. speed input: 5078.34 toks/s, output: 9.92 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:12<00:00,  9.19it/s, est. speed input: 5075.32 toks/s, output: 9.91 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:12<00:00,  9.22it/s, est. speed input: 5072.61 toks/s, output: 9.91 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:12<00:00,  9.22it/s, est. speed input: 5072.61 toks/s, output: 9.91 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:12<00:00,  9.91it/s, est. speed input: 5072.61 toks/s, output: 9.91 toks/s]
[rank0]:[W126 05:14:19.623615461 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 85.9s

测试结果:
  Requests/s:   8.75
  Tokens/s:     4491.08
  Total Reqs:   128
  Elapsed:      14.62s

  [Prefill 分析]
  Total Prefill Tokens: 65536
  Prefill Tokens/s:     4482.32

============================================================
[2/8] 测试 M=1024
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-14B-INT8                                │
│ Backend:  cuBLASLt [INT32 output]                         │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 1024
│   M_prefill     = 1024 (= 1 x 1024)
│   M_decode      = 1
│   batched_tokens = 1025 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 1025
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 05:14:31 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 05:14:32 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=218685) WARNING 01-26 05:14:39 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=218685) WARNING 01-26 05:15:02 [backends.py:609] Failed to read file <frozen os>
Throughput: 9.03 requests/s, 9257.58 total tokens/s, 9.03 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128


─── STDERR ───
[2026-01-26 05:14:30] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:14:31] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:14:31] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:14:31] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:14:31] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:14:31] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:14:31] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:14:31] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:14:31] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:14:31] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:14:31] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:14:31] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:14:31] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:14:31] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 05:14:38] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:14:38] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:14:38] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:14:38] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:14:38] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:14:38] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:14:38] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:14:38] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:14:38] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:14:38] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:14:38] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:14:38] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:14:38] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:14:38] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=218685) [2026-01-26 05:14:40] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=218685) [2026-01-26 05:14:40] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=218685) [2026-01-26 05:14:40] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=218685) [2026-01-26 05:14:40] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=218685) [2026-01-26 05:14:40] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuBLASLt, symmetric=True
(EngineCore_DP0 pid=218685) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=218685) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:03<00:11,  3.84s/it]
(EngineCore_DP0 pid=218685) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:07<00:07,  3.80s/it]
(EngineCore_DP0 pid=218685) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:08<00:02,  2.63s/it]
(EngineCore_DP0 pid=218685) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:10<00:00,  2.14s/it]
(EngineCore_DP0 pid=218685) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:10<00:00,  2.56s/it]
(EngineCore_DP0 pid=218685) 
[cuBLASLt] INFO: INT8 GEMM only supports INT32 output. inner_dtype parameter is ignored, always using int32.
(EngineCore_DP0 pid=218685) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  4.79it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  4.83it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  4.83it/s]
(EngineCore_DP0 pid=218685) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  4.45it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  4.44it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  19%|█▉        | 24/128 [00:00<00:00, 233.42it/s]
Adding requests:  38%|███▊      | 49/128 [00:00<00:00, 241.22it/s]
Adding requests:  59%|█████▉    | 76/128 [00:00<00:00, 249.45it/s]
Adding requests:  79%|███████▉  | 101/128 [00:00<00:00, 244.78it/s]
Adding requests:  99%|█████████▉| 127/128 [00:00<00:00, 249.73it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 246.73it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:14,  8.82it/s, est. speed input: 9033.08 toks/s, output: 8.82 toks/s]
Processed prompts:   2%|▏         | 2/128 [00:00<00:13,  9.04it/s, est. speed input: 9224.62 toks/s, output: 9.01 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:13,  9.18it/s, est. speed input: 9338.10 toks/s, output: 9.12 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:13,  9.30it/s, est. speed input: 9433.30 toks/s, output: 9.21 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:13,  9.41it/s, est. speed input: 9509.36 toks/s, output: 9.29 toks/s]
Processed prompts:   5%|▍         | 6/128 [00:00<00:12,  9.48it/s, est. speed input: 9566.12 toks/s, output: 9.34 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:12,  9.51it/s, est. speed input: 9596.66 toks/s, output: 9.37 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:00<00:12,  9.50it/s, est. speed input: 9610.09 toks/s, output: 9.38 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:00<00:12,  9.47it/s, est. speed input: 9611.43 toks/s, output: 9.39 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:01<00:12,  9.47it/s, est. speed input: 9620.03 toks/s, output: 9.39 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:01<00:12,  9.28it/s, est. speed input: 9568.45 toks/s, output: 9.34 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:01<00:12,  9.34it/s, est. speed input: 9581.42 toks/s, output: 9.36 toks/s]
Processed prompts:  10%|█         | 13/128 [00:01<00:12,  9.40it/s, est. speed input: 9594.32 toks/s, output: 9.37 toks/s]
Processed prompts:  11%|█         | 14/128 [00:01<00:12,  9.41it/s, est. speed input: 9600.50 toks/s, output: 9.38 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:01<00:11,  9.44it/s, est. speed input: 9608.62 toks/s, output: 9.38 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:01<00:11,  9.43it/s, est. speed input: 9609.76 toks/s, output: 9.38 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:01<00:11,  9.39it/s, est. speed input: 9604.44 toks/s, output: 9.38 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:01<00:11,  9.43it/s, est. speed input: 9611.99 toks/s, output: 9.39 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:02<00:11,  9.44it/s, est. speed input: 9615.93 toks/s, output: 9.39 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:02<00:11,  9.47it/s, est. speed input: 9624.11 toks/s, output: 9.40 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:02<00:11,  9.52it/s, est. speed input: 9635.20 toks/s, output: 9.41 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:02<00:11,  9.53it/s, est. speed input: 9641.71 toks/s, output: 9.42 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:02<00:10,  9.55it/s, est. speed input: 9649.77 toks/s, output: 9.42 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:02<00:10,  9.56it/s, est. speed input: 9656.49 toks/s, output: 9.43 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:02<00:10,  9.59it/s, est. speed input: 9666.23 toks/s, output: 9.44 toks/s]
Processed prompts:  20%|██        | 26/128 [00:02<00:10,  9.62it/s, est. speed input: 9675.93 toks/s, output: 9.45 toks/s]
Processed prompts:  21%|██        | 27/128 [00:02<00:10,  9.65it/s, est. speed input: 9685.20 toks/s, output: 9.46 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:02<00:10,  9.58it/s, est. speed input: 9683.62 toks/s, output: 9.46 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:03<00:10,  9.41it/s, est. speed input: 9668.18 toks/s, output: 9.44 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:03<00:10,  9.35it/s, est. speed input: 9660.88 toks/s, output: 9.43 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:03<00:10,  9.34it/s, est. speed input: 9656.56 toks/s, output: 9.43 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:03<00:10,  9.35it/s, est. speed input: 9654.34 toks/s, output: 9.43 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:03<00:10,  9.33it/s, est. speed input: 9650.05 toks/s, output: 9.42 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:03<00:10,  9.37it/s, est. speed input: 9651.45 toks/s, output: 9.43 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:03<00:09,  9.34it/s, est. speed input: 9646.32 toks/s, output: 9.42 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:03<00:09,  9.36it/s, est. speed input: 9646.55 toks/s, output: 9.42 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:03<00:09,  9.36it/s, est. speed input: 9644.35 toks/s, output: 9.42 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:04<00:09,  9.28it/s, est. speed input: 9635.21 toks/s, output: 9.41 toks/s]
Processed prompts:  30%|███       | 39/128 [00:04<00:09,  9.26it/s, est. speed input: 9630.38 toks/s, output: 9.40 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:04<00:09,  9.26it/s, est. speed input: 9626.86 toks/s, output: 9.40 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:04<00:09,  9.28it/s, est. speed input: 9624.66 toks/s, output: 9.40 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:04<00:09,  9.27it/s, est. speed input: 9620.74 toks/s, output: 9.40 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:04<00:09,  9.26it/s, est. speed input: 9616.69 toks/s, output: 9.39 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:04<00:09,  9.27it/s, est. speed input: 9614.35 toks/s, output: 9.39 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:04<00:08,  9.26it/s, est. speed input: 9610.68 toks/s, output: 9.39 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:04<00:08,  9.25it/s, est. speed input: 9607.43 toks/s, output: 9.38 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:05<00:08,  9.29it/s, est. speed input: 9607.07 toks/s, output: 9.38 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:05<00:08,  9.30it/s, est. speed input: 9605.75 toks/s, output: 9.38 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:05<00:08,  9.28it/s, est. speed input: 9602.74 toks/s, output: 9.38 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:05<00:08,  9.29it/s, est. speed input: 9601.60 toks/s, output: 9.38 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:05<00:08,  9.26it/s, est. speed input: 9597.93 toks/s, output: 9.37 toks/s]
Processed prompts:  41%|████      | 52/128 [00:05<00:08,  9.35it/s, est. speed input: 9601.71 toks/s, output: 9.38 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:05<00:07,  9.43it/s, est. speed input: 9606.47 toks/s, output: 9.38 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:05<00:07,  9.44it/s, est. speed input: 9607.78 toks/s, output: 9.38 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:05<00:07,  9.44it/s, est. speed input: 9608.73 toks/s, output: 9.38 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:05<00:07,  9.47it/s, est. speed input: 9611.50 toks/s, output: 9.39 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:06<00:07,  9.42it/s, est. speed input: 9610.24 toks/s, output: 9.38 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:06<00:07,  9.43it/s, est. speed input: 9611.28 toks/s, output: 9.39 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:06<00:07,  9.42it/s, est. speed input: 9611.60 toks/s, output: 9.39 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:06<00:07,  9.44it/s, est. speed input: 9613.42 toks/s, output: 9.39 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:06<00:07,  9.48it/s, est. speed input: 9616.59 toks/s, output: 9.39 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:06<00:06,  9.52it/s, est. speed input: 9619.83 toks/s, output: 9.39 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:06<00:06,  9.54it/s, est. speed input: 9622.80 toks/s, output: 9.40 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:06<00:06,  9.56it/s, est. speed input: 9626.20 toks/s, output: 9.40 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:06<00:06,  9.57it/s, est. speed input: 9629.37 toks/s, output: 9.40 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:07<00:06,  9.58it/s, est. speed input: 9632.32 toks/s, output: 9.41 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:07<00:06,  9.56it/s, est. speed input: 9633.68 toks/s, output: 9.41 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:07<00:06,  9.53it/s, est. speed input: 9634.65 toks/s, output: 9.41 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:07<00:06,  9.51it/s, est. speed input: 9635.21 toks/s, output: 9.41 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:07<00:06,  9.51it/s, est. speed input: 9636.76 toks/s, output: 9.41 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:07<00:05,  9.52it/s, est. speed input: 9638.52 toks/s, output: 9.41 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:07<00:05,  9.45it/s, est. speed input: 9636.71 toks/s, output: 9.41 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:07<00:05,  9.39it/s, est. speed input: 9634.39 toks/s, output: 9.41 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:07<00:05,  9.33it/s, est. speed input: 9631.34 toks/s, output: 9.41 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:07<00:05,  9.31it/s, est. speed input: 9629.35 toks/s, output: 9.40 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:08<00:05,  9.37it/s, est. speed input: 9630.78 toks/s, output: 9.41 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:08<00:05,  9.31it/s, est. speed input: 9627.78 toks/s, output: 9.40 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:08<00:05,  9.37it/s, est. speed input: 9629.18 toks/s, output: 9.40 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:08<00:05,  9.43it/s, est. speed input: 9631.13 toks/s, output: 9.41 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:08<00:05,  9.45it/s, est. speed input: 9632.46 toks/s, output: 9.41 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:08<00:04,  9.49it/s, est. speed input: 9634.76 toks/s, output: 9.41 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:08<00:04,  9.42it/s, est. speed input: 9632.64 toks/s, output: 9.41 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:08<00:04,  9.38it/s, est. speed input: 9631.33 toks/s, output: 9.41 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:08<00:04,  9.37it/s, est. speed input: 9630.71 toks/s, output: 9.40 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:09<00:04,  9.38it/s, est. speed input: 9630.68 toks/s, output: 9.40 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:09<00:04,  9.41it/s, est. speed input: 9631.48 toks/s, output: 9.41 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:09<00:04,  9.36it/s, est. speed input: 9629.59 toks/s, output: 9.40 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:09<00:04,  9.35it/s, est. speed input: 9628.49 toks/s, output: 9.40 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:09<00:04,  9.35it/s, est. speed input: 9627.83 toks/s, output: 9.40 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:09<00:04,  9.35it/s, est. speed input: 9627.25 toks/s, output: 9.40 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:09<00:03,  9.35it/s, est. speed input: 9626.90 toks/s, output: 9.40 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:09<00:03,  9.29it/s, est. speed input: 9623.86 toks/s, output: 9.40 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:09<00:03,  9.27it/s, est. speed input: 9621.83 toks/s, output: 9.40 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:10<00:03,  9.31it/s, est. speed input: 9621.95 toks/s, output: 9.40 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:10<00:03,  9.31it/s, est. speed input: 9621.23 toks/s, output: 9.40 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:10<00:03,  9.31it/s, est. speed input: 9620.30 toks/s, output: 9.39 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:10<00:03,  9.31it/s, est. speed input: 9619.46 toks/s, output: 9.39 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:10<00:03,  9.31it/s, est. speed input: 9618.51 toks/s, output: 9.39 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:10<00:03,  9.32it/s, est. speed input: 9618.09 toks/s, output: 9.39 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:10<00:03,  9.30it/s, est. speed input: 9616.61 toks/s, output: 9.39 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:10<00:02,  9.29it/s, est. speed input: 9615.43 toks/s, output: 9.39 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:10<00:02,  9.27it/s, est. speed input: 9613.57 toks/s, output: 9.39 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:10<00:02,  9.27it/s, est. speed input: 9612.40 toks/s, output: 9.39 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:11<00:02,  9.27it/s, est. speed input: 9611.29 toks/s, output: 9.39 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:11<00:02,  9.27it/s, est. speed input: 9610.26 toks/s, output: 9.38 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:11<00:02,  9.29it/s, est. speed input: 9609.62 toks/s, output: 9.38 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:11<00:02,  9.28it/s, est. speed input: 9608.45 toks/s, output: 9.38 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:11<00:02,  9.29it/s, est. speed input: 9607.88 toks/s, output: 9.38 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:11<00:02,  9.33it/s, est. speed input: 9608.21 toks/s, output: 9.38 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:11<00:01,  9.36it/s, est. speed input: 9608.73 toks/s, output: 9.38 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:11<00:01,  9.38it/s, est. speed input: 9609.20 toks/s, output: 9.38 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:11<00:01,  9.35it/s, est. speed input: 9608.02 toks/s, output: 9.38 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:12<00:01,  9.34it/s, est. speed input: 9607.39 toks/s, output: 9.38 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:12<00:01,  9.30it/s, est. speed input: 9605.98 toks/s, output: 9.38 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:12<00:01,  9.30it/s, est. speed input: 9605.25 toks/s, output: 9.38 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:12<00:01,  9.30it/s, est. speed input: 9604.40 toks/s, output: 9.38 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:12<00:01,  9.36it/s, est. speed input: 9605.48 toks/s, output: 9.38 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:12<00:01,  9.37it/s, est. speed input: 9605.74 toks/s, output: 9.38 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:12<00:00,  9.38it/s, est. speed input: 9605.86 toks/s, output: 9.38 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:12<00:00,  9.39it/s, est. speed input: 9606.23 toks/s, output: 9.38 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:12<00:00,  9.40it/s, est. speed input: 9606.60 toks/s, output: 9.38 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:13<00:00,  9.40it/s, est. speed input: 9606.83 toks/s, output: 9.38 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:13<00:00,  9.38it/s, est. speed input: 9606.34 toks/s, output: 9.38 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:13<00:00,  9.34it/s, est. speed input: 9605.34 toks/s, output: 9.38 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:13<00:00,  9.33it/s, est. speed input: 9604.77 toks/s, output: 9.38 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:13<00:00,  9.27it/s, est. speed input: 9602.70 toks/s, output: 9.38 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:13<00:00,  9.27it/s, est. speed input: 9601.67 toks/s, output: 9.38 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:13<00:00,  9.28it/s, est. speed input: 9601.15 toks/s, output: 9.38 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:13<00:00,  9.28it/s, est. speed input: 9601.15 toks/s, output: 9.38 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:13<00:00,  9.38it/s, est. speed input: 9601.15 toks/s, output: 9.38 toks/s]
[rank0]:[W126 05:15:39.200867190 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 80.4s

测试结果:
  Requests/s:   9.03
  Tokens/s:     9257.58
  Total Reqs:   128
  Elapsed:      14.17s

  [Prefill 分析]
  Total Prefill Tokens: 131072
  Prefill Tokens/s:     9248.55

============================================================
[3/8] 测试 M=2048
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-14B-INT8                                │
│ Backend:  cuBLASLt [INT32 output]                         │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 2048
│   M_prefill     = 2048 (= 2 x 1024)
│   M_decode      = 2
│   batched_tokens = 2048 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 256
│   --max-num-seqs           = 2
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 2048
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 05:15:50 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 05:15:51 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=220053) WARNING 01-26 05:15:59 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=220053) WARNING 01-26 05:16:15 [backends.py:609] Failed to read file <frozen os>
Throughput: 10.82 requests/s, 11086.84 total tokens/s, 10.82 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256


─── STDERR ───
[2026-01-26 05:15:50] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:15:50] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:15:50] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:15:50] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:15:50] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:15:50] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:15:50] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:15:50] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:15:50] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:15:50] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:15:50] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:15:50] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:15:50] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:15:50] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 05:15:58] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:15:58] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:15:58] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:15:58] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:15:58] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:15:58] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:15:58] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:15:58] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:15:58] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:15:58] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:15:58] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:15:58] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:15:58] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:15:58] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=220053) [2026-01-26 05:15:59] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=220053) [2026-01-26 05:16:00] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=220053) [2026-01-26 05:16:00] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=220053) [2026-01-26 05:16:00] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=220053) [2026-01-26 05:16:00] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuBLASLt, symmetric=True
(EngineCore_DP0 pid=220053) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=220053) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.02it/s]
(EngineCore_DP0 pid=220053) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:02,  1.00s/it]
(EngineCore_DP0 pid=220053) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.40it/s]
(EngineCore_DP0 pid=220053) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.25it/s]
(EngineCore_DP0 pid=220053) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.21it/s]
(EngineCore_DP0 pid=220053) 
[cuBLASLt] INFO: INT8 GEMM only supports INT32 output. inner_dtype parameter is ignored, always using int32.
(EngineCore_DP0 pid=220053) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  33%|███▎      | 1/3 [00:00<00:00,  4.59it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  67%|██████▋   | 2/3 [00:00<00:00,  4.76it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00,  4.49it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00,  4.54it/s]
(EngineCore_DP0 pid=220053) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 1/2 [00:00<00:00,  4.20it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  4.69it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  4.61it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:   8%|▊         | 21/256 [00:00<00:01, 203.62it/s]
Adding requests:  18%|█▊        | 47/256 [00:00<00:00, 235.10it/s]
Adding requests:  29%|██▉       | 74/256 [00:00<00:00, 245.92it/s]
Adding requests:  39%|███▊      | 99/256 [00:00<00:00, 240.38it/s]
Adding requests:  49%|████▉     | 125/256 [00:00<00:00, 245.32it/s]
Adding requests:  59%|█████▉    | 152/256 [00:00<00:00, 249.92it/s]
Adding requests:  70%|██████▉   | 179/256 [00:00<00:00, 256.20it/s]
Adding requests:  81%|████████  | 207/256 [00:00<00:00, 262.98it/s]
Adding requests:  92%|█████████▏| 235/256 [00:00<00:00, 266.52it/s]
Adding requests: 100%|██████████| 256/256 [00:01<00:00, 253.60it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   3%|▎         | 8/256 [00:00<00:04, 60.41it/s, est. speed input: 61873.65 toks/s, output: 60.41 toks/s]
Processed prompts:   6%|▌         | 15/256 [00:00<00:12, 19.75it/s, est. speed input: 22669.72 toks/s, output: 22.14 toks/s]
Processed prompts:   7%|▋         | 19/256 [00:01<00:14, 15.84it/s, est. speed input: 18704.70 toks/s, output: 18.27 toks/s]
Processed prompts:   9%|▊         | 22/256 [00:01<00:18, 12.87it/s, est. speed input: 16046.93 toks/s, output: 15.67 toks/s]
Processed prompts:   9%|▉         | 24/256 [00:01<00:18, 12.47it/s, est. speed input: 15501.62 toks/s, output: 15.14 toks/s]
Processed prompts:  10%|█         | 26/256 [00:01<00:18, 12.12it/s, est. speed input: 15067.50 toks/s, output: 14.71 toks/s]
Processed prompts:  11%|█         | 28/256 [00:01<00:19, 11.84it/s, est. speed input: 14715.07 toks/s, output: 14.37 toks/s]
Processed prompts:  12%|█▏        | 30/256 [00:02<00:19, 11.62it/s, est. speed input: 14420.19 toks/s, output: 14.08 toks/s]
Processed prompts:  12%|█▎        | 32/256 [00:02<00:19, 11.46it/s, est. speed input: 14175.63 toks/s, output: 13.84 toks/s]
Processed prompts:  13%|█▎        | 34/256 [00:02<00:19, 11.33it/s, est. speed input: 13964.81 toks/s, output: 13.64 toks/s]
Processed prompts:  14%|█▍        | 36/256 [00:02<00:19, 11.24it/s, est. speed input: 13780.45 toks/s, output: 13.46 toks/s]
Processed prompts:  15%|█▍        | 38/256 [00:02<00:19, 11.17it/s, est. speed input: 13621.15 toks/s, output: 13.30 toks/s]
Processed prompts:  16%|█▌        | 40/256 [00:03<00:19, 11.13it/s, est. speed input: 13482.95 toks/s, output: 13.17 toks/s]
Processed prompts:  16%|█▋        | 42/256 [00:03<00:19, 11.10it/s, est. speed input: 13359.04 toks/s, output: 13.05 toks/s]
Processed prompts:  17%|█▋        | 44/256 [00:03<00:19, 11.07it/s, est. speed input: 13247.82 toks/s, output: 12.94 toks/s]
Processed prompts:  18%|█▊        | 46/256 [00:03<00:18, 11.06it/s, est. speed input: 13148.65 toks/s, output: 12.84 toks/s]
Processed prompts:  25%|██▌       | 64/256 [00:03<00:05, 34.63it/s, est. speed input: 17192.72 toks/s, output: 16.79 toks/s]
Processed prompts:  27%|██▋       | 68/256 [00:04<00:07, 24.18it/s, est. speed input: 16675.44 toks/s, output: 16.28 toks/s]
Processed prompts:  28%|██▊       | 71/256 [00:04<00:08, 22.32it/s, est. speed input: 16682.74 toks/s, output: 16.29 toks/s]
Processed prompts:  29%|██▉       | 74/256 [00:04<00:10, 16.62it/s, est. speed input: 16051.36 toks/s, output: 15.68 toks/s]
Processed prompts:  30%|██▉       | 76/256 [00:04<00:11, 15.35it/s, est. speed input: 15874.14 toks/s, output: 15.50 toks/s]
Processed prompts:  30%|███       | 78/256 [00:05<00:12, 14.29it/s, est. speed input: 15708.22 toks/s, output: 15.34 toks/s]
Processed prompts:  31%|███▏      | 80/256 [00:05<00:13, 13.43it/s, est. speed input: 15553.86 toks/s, output: 15.19 toks/s]
Processed prompts:  32%|███▏      | 82/256 [00:05<00:13, 12.78it/s, est. speed input: 15410.35 toks/s, output: 15.05 toks/s]
Processed prompts:  33%|███▎      | 84/256 [00:05<00:14, 12.28it/s, est. speed input: 15276.51 toks/s, output: 14.92 toks/s]
Processed prompts:  34%|███▎      | 86/256 [00:05<00:14, 11.92it/s, est. speed input: 15151.81 toks/s, output: 14.80 toks/s]
Processed prompts:  34%|███▍      | 88/256 [00:05<00:14, 11.65it/s, est. speed input: 15032.96 toks/s, output: 14.68 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:06<00:14, 11.46it/s, est. speed input: 14921.80 toks/s, output: 14.57 toks/s]
Processed prompts:  36%|███▌      | 92/256 [00:06<00:14, 11.33it/s, est. speed input: 14817.48 toks/s, output: 14.47 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:06<00:14, 11.22it/s, est. speed input: 14717.84 toks/s, output: 14.37 toks/s]
Processed prompts:  38%|███▊      | 96/256 [00:06<00:14, 11.15it/s, est. speed input: 14623.95 toks/s, output: 14.28 toks/s]
Processed prompts:  38%|███▊      | 98/256 [00:06<00:14, 11.10it/s, est. speed input: 14534.80 toks/s, output: 14.19 toks/s]
Processed prompts:  39%|███▉      | 100/256 [00:07<00:14, 11.07it/s, est. speed input: 14450.86 toks/s, output: 14.11 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:07<00:13, 11.05it/s, est. speed input: 14370.71 toks/s, output: 14.03 toks/s]
Processed prompts:  41%|████      | 104/256 [00:07<00:13, 11.02it/s, est. speed input: 14293.21 toks/s, output: 13.96 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:07<00:13, 11.01it/s, est. speed input: 14220.43 toks/s, output: 13.89 toks/s]
Processed prompts:  42%|████▏     | 108/256 [00:07<00:13, 11.00it/s, est. speed input: 14151.28 toks/s, output: 13.82 toks/s]
Processed prompts:  43%|████▎     | 110/256 [00:07<00:13, 10.99it/s, est. speed input: 14084.82 toks/s, output: 13.75 toks/s]
Processed prompts:  44%|████▍     | 112/256 [00:08<00:13, 10.99it/s, est. speed input: 14021.47 toks/s, output: 13.69 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:08<00:12, 10.99it/s, est. speed input: 13961.16 toks/s, output: 13.63 toks/s]
Processed prompts:  45%|████▌     | 116/256 [00:08<00:12, 10.99it/s, est. speed input: 13903.52 toks/s, output: 13.58 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:08<00:12, 11.00it/s, est. speed input: 13849.56 toks/s, output: 13.52 toks/s]
Processed prompts:  47%|████▋     | 120/256 [00:08<00:12, 11.01it/s, est. speed input: 13797.00 toks/s, output: 13.47 toks/s]
Processed prompts:  48%|████▊     | 122/256 [00:09<00:12, 11.00it/s, est. speed input: 13745.91 toks/s, output: 13.42 toks/s]
Processed prompts:  48%|████▊     | 124/256 [00:09<00:12, 10.99it/s, est. speed input: 13696.68 toks/s, output: 13.38 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:09<00:11, 10.99it/s, est. speed input: 13649.21 toks/s, output: 13.33 toks/s]
Processed prompts:  50%|█████     | 128/256 [00:09<00:11, 10.98it/s, est. speed input: 13603.71 toks/s, output: 13.28 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:09<00:11, 10.98it/s, est. speed input: 13559.86 toks/s, output: 13.24 toks/s]
Processed prompts:  52%|█████▏    | 132/256 [00:09<00:11, 10.98it/s, est. speed input: 13517.61 toks/s, output: 13.20 toks/s]
Processed prompts:  52%|█████▏    | 134/256 [00:10<00:11, 10.99it/s, est. speed input: 13477.36 toks/s, output: 13.16 toks/s]
Processed prompts:  53%|█████▎    | 136/256 [00:10<00:10, 10.99it/s, est. speed input: 13438.17 toks/s, output: 13.12 toks/s]
Processed prompts:  54%|█████▍    | 138/256 [00:10<00:10, 10.98it/s, est. speed input: 13400.20 toks/s, output: 13.09 toks/s]
Processed prompts:  55%|█████▍    | 140/256 [00:10<00:10, 10.99it/s, est. speed input: 13364.38 toks/s, output: 13.05 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:10<00:10, 11.00it/s, est. speed input: 13329.71 toks/s, output: 13.02 toks/s]
Processed prompts:  56%|█████▋    | 144/256 [00:11<00:10, 11.00it/s, est. speed input: 13295.86 toks/s, output: 12.98 toks/s]
Processed prompts:  57%|█████▋    | 146/256 [00:11<00:10, 10.99it/s, est. speed input: 13262.34 toks/s, output: 12.95 toks/s]
Processed prompts:  58%|█████▊    | 148/256 [00:11<00:09, 10.98it/s, est. speed input: 13229.72 toks/s, output: 12.92 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:11<00:09, 10.98it/s, est. speed input: 13198.70 toks/s, output: 12.89 toks/s]
Processed prompts:  59%|█████▉    | 152/256 [00:11<00:09, 10.97it/s, est. speed input: 13167.91 toks/s, output: 12.86 toks/s]
Processed prompts:  60%|██████    | 154/256 [00:12<00:09, 10.97it/s, est. speed input: 13138.65 toks/s, output: 12.83 toks/s]
Processed prompts:  61%|██████    | 156/256 [00:12<00:09, 10.96it/s, est. speed input: 13109.42 toks/s, output: 12.80 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:12<00:08, 10.95it/s, est. speed input: 13081.28 toks/s, output: 12.77 toks/s]
Processed prompts:  62%|██████▎   | 160/256 [00:12<00:08, 10.95it/s, est. speed input: 13053.82 toks/s, output: 12.75 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:12<00:08, 10.95it/s, est. speed input: 13027.32 toks/s, output: 12.72 toks/s]
Processed prompts:  64%|██████▍   | 164/256 [00:12<00:08, 10.94it/s, est. speed input: 13001.40 toks/s, output: 12.70 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:13<00:08, 10.94it/s, est. speed input: 12976.33 toks/s, output: 12.67 toks/s]
Processed prompts:  66%|██████▌   | 168/256 [00:13<00:08, 10.94it/s, est. speed input: 12952.00 toks/s, output: 12.65 toks/s]
Processed prompts:  66%|██████▋   | 170/256 [00:13<00:07, 10.95it/s, est. speed input: 12928.68 toks/s, output: 12.63 toks/s]
Processed prompts:  67%|██████▋   | 172/256 [00:13<00:07, 10.96it/s, est. speed input: 12906.18 toks/s, output: 12.60 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:13<00:07, 10.97it/s, est. speed input: 12884.54 toks/s, output: 12.58 toks/s]
Processed prompts:  69%|██████▉   | 176/256 [00:14<00:07, 10.97it/s, est. speed input: 12863.27 toks/s, output: 12.56 toks/s]
Processed prompts:  70%|██████▉   | 178/256 [00:14<00:07, 10.97it/s, est. speed input: 12842.07 toks/s, output: 12.54 toks/s]
Processed prompts:  70%|███████   | 180/256 [00:14<00:06, 10.97it/s, est. speed input: 12821.69 toks/s, output: 12.52 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:14<00:06, 10.97it/s, est. speed input: 12801.68 toks/s, output: 12.50 toks/s]
Processed prompts:  72%|███████▏  | 184/256 [00:14<00:06, 10.96it/s, est. speed input: 12781.80 toks/s, output: 12.48 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:14<00:06, 10.96it/s, est. speed input: 12762.90 toks/s, output: 12.46 toks/s]
Processed prompts:  73%|███████▎  | 188/256 [00:15<00:06, 10.97it/s, est. speed input: 12744.48 toks/s, output: 12.45 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:15<00:06, 10.96it/s, est. speed input: 12726.37 toks/s, output: 12.43 toks/s]
Processed prompts:  75%|███████▌  | 192/256 [00:15<00:05, 10.95it/s, est. speed input: 12708.05 toks/s, output: 12.41 toks/s]
Processed prompts:  76%|███████▌  | 194/256 [00:15<00:05, 10.95it/s, est. speed input: 12690.42 toks/s, output: 12.39 toks/s]
Processed prompts:  77%|███████▋  | 196/256 [00:15<00:05, 10.95it/s, est. speed input: 12673.35 toks/s, output: 12.38 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:16<00:05, 10.94it/s, est. speed input: 12656.51 toks/s, output: 12.36 toks/s]
Processed prompts:  78%|███████▊  | 200/256 [00:16<00:05, 10.94it/s, est. speed input: 12640.02 toks/s, output: 12.34 toks/s]
Processed prompts:  79%|███████▉  | 202/256 [00:16<00:04, 10.95it/s, est. speed input: 12624.35 toks/s, output: 12.33 toks/s]
Processed prompts:  80%|███████▉  | 204/256 [00:16<00:04, 10.94it/s, est. speed input: 12608.58 toks/s, output: 12.31 toks/s]
Processed prompts:  80%|████████  | 206/256 [00:16<00:04, 10.94it/s, est. speed input: 12592.97 toks/s, output: 12.30 toks/s]
Processed prompts:  81%|████████▏ | 208/256 [00:16<00:04, 10.94it/s, est. speed input: 12577.86 toks/s, output: 12.28 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:17<00:04, 10.95it/s, est. speed input: 12563.82 toks/s, output: 12.27 toks/s]
Processed prompts:  83%|████████▎ | 212/256 [00:17<00:04, 10.96it/s, est. speed input: 12549.74 toks/s, output: 12.26 toks/s]
Processed prompts:  84%|████████▎ | 214/256 [00:17<00:03, 10.95it/s, est. speed input: 12535.42 toks/s, output: 12.24 toks/s]
Processed prompts:  84%|████████▍ | 216/256 [00:17<00:03, 10.95it/s, est. speed input: 12521.75 toks/s, output: 12.23 toks/s]
Processed prompts:  85%|████████▌ | 218/256 [00:17<00:03, 10.94it/s, est. speed input: 12508.17 toks/s, output: 12.21 toks/s]
Processed prompts:  86%|████████▌ | 220/256 [00:18<00:03, 10.94it/s, est. speed input: 12494.94 toks/s, output: 12.20 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:18<00:03, 10.95it/s, est. speed input: 12482.34 toks/s, output: 12.19 toks/s]
Processed prompts:  88%|████████▊ | 224/256 [00:18<00:02, 10.95it/s, est. speed input: 12469.84 toks/s, output: 12.18 toks/s]
Processed prompts:  88%|████████▊ | 226/256 [00:18<00:02, 10.94it/s, est. speed input: 12457.05 toks/s, output: 12.17 toks/s]
Processed prompts:  89%|████████▉ | 228/256 [00:18<00:02, 10.94it/s, est. speed input: 12444.71 toks/s, output: 12.15 toks/s]
Processed prompts:  90%|████████▉ | 230/256 [00:18<00:02, 10.94it/s, est. speed input: 12432.63 toks/s, output: 12.14 toks/s]
Processed prompts:  91%|█████████ | 232/256 [00:19<00:02, 10.93it/s, est. speed input: 12420.62 toks/s, output: 12.13 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:19<00:02, 10.93it/s, est. speed input: 12408.83 toks/s, output: 12.12 toks/s]
Processed prompts:  92%|█████████▏| 236/256 [00:19<00:01, 10.92it/s, est. speed input: 12397.09 toks/s, output: 12.11 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:19<00:01, 10.92it/s, est. speed input: 12385.75 toks/s, output: 12.10 toks/s]
Processed prompts:  94%|█████████▍| 240/256 [00:19<00:01, 10.92it/s, est. speed input: 12374.86 toks/s, output: 12.08 toks/s]
Processed prompts:  95%|█████████▍| 242/256 [00:20<00:01, 10.93it/s, est. speed input: 12364.05 toks/s, output: 12.07 toks/s]
Processed prompts:  95%|█████████▌| 244/256 [00:20<00:01, 10.93it/s, est. speed input: 12353.49 toks/s, output: 12.06 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:20<00:00, 10.93it/s, est. speed input: 12343.22 toks/s, output: 12.05 toks/s]
Processed prompts:  97%|█████████▋| 248/256 [00:20<00:00, 10.93it/s, est. speed input: 12332.96 toks/s, output: 12.04 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:20<00:00, 10.92it/s, est. speed input: 12322.68 toks/s, output: 12.03 toks/s]
Processed prompts:  98%|█████████▊| 252/256 [00:20<00:00, 10.92it/s, est. speed input: 12312.55 toks/s, output: 12.02 toks/s]
Processed prompts:  99%|█████████▉| 254/256 [00:21<00:00, 10.92it/s, est. speed input: 12302.92 toks/s, output: 12.01 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:21<00:00, 12.48it/s, est. speed input: 12337.35 toks/s, output: 12.05 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:21<00:00, 12.48it/s, est. speed input: 12337.35 toks/s, output: 12.05 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:21<00:00, 12.05it/s, est. speed input: 12337.35 toks/s, output: 12.05 toks/s]
[rank0]:[W126 05:17:02.420457632 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 83.1s

测试结果:
  Requests/s:   10.82
  Tokens/s:     11086.84
  Total Reqs:   256
  Elapsed:      23.67s

  [Prefill 分析]
  Total Prefill Tokens: 262144
  Prefill Tokens/s:     11076.03

============================================================
[4/8] 测试 M=4096
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-14B-INT8                                │
│ Backend:  cuBLASLt [INT32 output]                         │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 4096
│   M_prefill     = 4096 (= 4 x 1024)
│   M_decode      = 4
│   batched_tokens = 4096 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 512
│   --max-num-seqs           = 4
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 4096
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 05:17:15 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 05:17:16 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=221483) WARNING 01-26 05:17:24 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=221483) WARNING 01-26 05:17:41 [backends.py:609] Failed to read file <frozen os>
Throughput: 11.16 requests/s, 11438.32 total tokens/s, 11.16 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512


─── STDERR ───
[2026-01-26 05:17:15] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:17:15] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:17:15] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:17:15] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:17:15] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:17:15] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:17:15] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:17:15] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:17:15] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:17:15] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:17:15] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:17:15] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:17:15] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:17:15] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 05:17:23] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:17:23] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:17:23] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:17:23] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:17:23] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:17:23] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:17:23] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:17:23] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:17:23] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:17:23] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:17:23] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:17:23] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:17:23] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:17:23] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=221483) [2026-01-26 05:17:24] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=221483) [2026-01-26 05:17:24] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=221483) [2026-01-26 05:17:24] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=221483) [2026-01-26 05:17:24] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=221483) [2026-01-26 05:17:24] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuBLASLt, symmetric=True
(EngineCore_DP0 pid=221483) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=221483) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.05it/s]
(EngineCore_DP0 pid=221483) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:02,  1.00s/it]
(EngineCore_DP0 pid=221483) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.39it/s]
(EngineCore_DP0 pid=221483) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.22it/s]
(EngineCore_DP0 pid=221483) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.19it/s]
(EngineCore_DP0 pid=221483) 
[cuBLASLt] INFO: INT8 GEMM only supports INT32 output. inner_dtype parameter is ignored, always using int32.
(EngineCore_DP0 pid=221483) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  25%|██▌       | 1/4 [00:00<00:00,  4.63it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 2/4 [00:00<00:00,  4.70it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  75%|███████▌  | 3/4 [00:00<00:00,  4.72it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  4.48it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  4.55it/s]
(EngineCore_DP0 pid=221483) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  33%|███▎      | 1/3 [00:00<00:00,  2.64it/s]
Capturing CUDA graphs (decode, FULL):  67%|██████▋   | 2/3 [00:00<00:00,  3.49it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  3.98it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  3.70it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   5%|▍         | 24/512 [00:00<00:02, 233.71it/s]
Adding requests:  10%|▉         | 50/512 [00:00<00:01, 246.91it/s]
Adding requests:  15%|█▌        | 78/512 [00:00<00:01, 259.18it/s]
Adding requests:  20%|██        | 104/512 [00:00<00:01, 253.35it/s]
Adding requests:  25%|██▌       | 130/512 [00:00<00:01, 252.58it/s]
Adding requests:  30%|███       | 156/512 [00:00<00:01, 253.09it/s]
Adding requests:  36%|███▌      | 182/512 [00:00<00:01, 253.93it/s]
Adding requests:  41%|████      | 209/512 [00:00<00:01, 258.63it/s]
Adding requests:  46%|████▌     | 236/512 [00:00<00:01, 259.32it/s]
Adding requests:  51%|█████     | 262/512 [00:01<00:00, 258.17it/s]
Adding requests:  56%|█████▋    | 289/512 [00:01<00:00, 260.39it/s]
Adding requests:  62%|██████▏   | 317/512 [00:01<00:00, 265.83it/s]
Adding requests:  67%|██████▋   | 344/512 [00:01<00:00, 263.24it/s]
Adding requests:  73%|███████▎  | 373/512 [00:01<00:00, 269.71it/s]
Adding requests:  79%|███████▊  | 402/512 [00:01<00:00, 273.39it/s]
Adding requests:  84%|████████▍ | 431/512 [00:01<00:00, 275.88it/s]
Adding requests:  90%|████████▉ | 459/512 [00:01<00:00, 272.30it/s]
Adding requests:  95%|█████████▌| 488/512 [00:01<00:00, 276.99it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 264.36it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   4%|▎         | 18/512 [00:00<00:07, 64.30it/s, est. speed input: 65845.96 toks/s, output: 64.30 toks/s]
Processed prompts:   5%|▍         | 25/512 [00:00<00:13, 35.71it/s, est. speed input: 40456.21 toks/s, output: 39.51 toks/s]
Processed prompts:   6%|▌         | 29/512 [00:00<00:20, 24.06it/s, est. speed input: 30141.58 toks/s, output: 29.43 toks/s]
Processed prompts:   6%|▋         | 32/512 [00:01<00:27, 17.74it/s, est. speed input: 24491.98 toks/s, output: 23.92 toks/s]
Processed prompts:   7%|▋         | 34/512 [00:01<00:35, 13.30it/s, est. speed input: 20590.26 toks/s, output: 20.11 toks/s]
Processed prompts:   7%|▋         | 38/512 [00:02<00:37, 12.63it/s, est. speed input: 19040.15 toks/s, output: 18.59 toks/s]
Processed prompts:   8%|▊         | 42/512 [00:02<00:38, 12.20it/s, est. speed input: 17945.93 toks/s, output: 17.53 toks/s]
Processed prompts:   9%|▉         | 46/512 [00:02<00:39, 11.92it/s, est. speed input: 17130.63 toks/s, output: 16.73 toks/s]
Processed prompts:  10%|▉         | 50/512 [00:03<00:39, 11.74it/s, est. speed input: 16502.42 toks/s, output: 16.12 toks/s]
Processed prompts:  11%|█         | 54/512 [00:03<00:39, 11.61it/s, est. speed input: 16002.07 toks/s, output: 15.63 toks/s]
Processed prompts:  11%|█▏        | 58/512 [00:03<00:39, 11.53it/s, est. speed input: 15593.96 toks/s, output: 15.23 toks/s]
Processed prompts:  12%|█▏        | 62/512 [00:04<00:39, 11.46it/s, est. speed input: 15254.49 toks/s, output: 14.90 toks/s]
Processed prompts:  13%|█▎        | 66/512 [00:04<00:39, 11.42it/s, est. speed input: 14969.30 toks/s, output: 14.62 toks/s]
Processed prompts:  14%|█▎        | 70/512 [00:04<00:38, 11.40it/s, est. speed input: 14724.97 toks/s, output: 14.38 toks/s]
Processed prompts:  14%|█▍        | 74/512 [00:05<00:38, 11.37it/s, est. speed input: 14513.07 toks/s, output: 14.17 toks/s]
Processed prompts:  15%|█▌        | 78/512 [00:05<00:38, 11.36it/s, est. speed input: 14328.62 toks/s, output: 13.99 toks/s]
Processed prompts:  16%|█▌        | 82/512 [00:05<00:37, 11.35it/s, est. speed input: 14164.89 toks/s, output: 13.83 toks/s]
Processed prompts:  17%|█▋        | 86/512 [00:06<00:37, 11.34it/s, est. speed input: 14020.35 toks/s, output: 13.69 toks/s]
Processed prompts:  18%|█▊        | 90/512 [00:06<00:37, 11.33it/s, est. speed input: 13890.41 toks/s, output: 13.56 toks/s]
Processed prompts:  18%|█▊        | 94/512 [00:06<00:36, 11.32it/s, est. speed input: 13773.52 toks/s, output: 13.45 toks/s]
Processed prompts:  19%|█▉        | 98/512 [00:07<00:36, 11.32it/s, est. speed input: 13667.99 toks/s, output: 13.35 toks/s]
Processed prompts:  20%|█▉        | 102/512 [00:07<00:36, 11.32it/s, est. speed input: 13571.89 toks/s, output: 13.25 toks/s]
Processed prompts:  21%|██        | 106/512 [00:08<00:35, 11.31it/s, est. speed input: 13484.09 toks/s, output: 13.17 toks/s]
Processed prompts:  21%|██▏       | 110/512 [00:08<00:35, 11.31it/s, est. speed input: 13403.86 toks/s, output: 13.09 toks/s]
Processed prompts:  22%|██▏       | 114/512 [00:08<00:35, 11.31it/s, est. speed input: 13329.84 toks/s, output: 13.02 toks/s]
Processed prompts:  23%|██▎       | 118/512 [00:09<00:34, 11.30it/s, est. speed input: 13260.99 toks/s, output: 12.95 toks/s]
Processed prompts:  24%|██▍       | 122/512 [00:09<00:34, 11.30it/s, est. speed input: 13197.45 toks/s, output: 12.89 toks/s]
Processed prompts:  25%|██▍       | 126/512 [00:09<00:34, 11.29it/s, est. speed input: 13138.23 toks/s, output: 12.83 toks/s]
Processed prompts:  25%|██▌       | 130/512 [00:10<00:33, 11.30it/s, est. speed input: 13083.59 toks/s, output: 12.78 toks/s]
Processed prompts:  26%|██▌       | 134/512 [00:10<00:33, 11.29it/s, est. speed input: 13032.06 toks/s, output: 12.73 toks/s]
Processed prompts:  30%|███       | 154/512 [00:10<00:14, 24.30it/s, est. speed input: 14454.56 toks/s, output: 14.12 toks/s]
Processed prompts:  31%|███       | 158/512 [00:11<00:17, 20.44it/s, est. speed input: 14362.49 toks/s, output: 14.03 toks/s]
Processed prompts:  32%|███▏      | 162/512 [00:11<00:19, 17.71it/s, est. speed input: 14275.93 toks/s, output: 13.94 toks/s]
Processed prompts:  32%|███▏      | 166/512 [00:11<00:21, 15.79it/s, est. speed input: 14194.48 toks/s, output: 13.86 toks/s]
Processed prompts:  33%|███▎      | 170/512 [00:12<00:23, 14.44it/s, est. speed input: 14117.72 toks/s, output: 13.79 toks/s]
Processed prompts:  34%|███▍      | 174/512 [00:12<00:25, 13.48it/s, est. speed input: 14045.03 toks/s, output: 13.72 toks/s]
Processed prompts:  35%|███▍      | 178/512 [00:13<00:26, 12.81it/s, est. speed input: 13975.97 toks/s, output: 13.65 toks/s]
Processed prompts:  36%|███▌      | 182/512 [00:13<00:26, 12.35it/s, est. speed input: 13910.90 toks/s, output: 13.58 toks/s]
Processed prompts:  36%|███▋      | 186/512 [00:13<00:27, 12.02it/s, est. speed input: 13848.86 toks/s, output: 13.52 toks/s]
Processed prompts:  37%|███▋      | 190/512 [00:14<00:27, 11.79it/s, est. speed input: 13790.11 toks/s, output: 13.47 toks/s]
Processed prompts:  38%|███▊      | 194/512 [00:14<00:27, 11.63it/s, est. speed input: 13734.42 toks/s, output: 13.41 toks/s]
Processed prompts:  39%|███▊      | 198/512 [00:14<00:27, 11.51it/s, est. speed input: 13681.34 toks/s, output: 13.36 toks/s]
Processed prompts:  39%|███▉      | 202/512 [00:15<00:27, 11.43it/s, est. speed input: 13630.37 toks/s, output: 13.31 toks/s]
Processed prompts:  40%|████      | 206/512 [00:15<00:26, 11.37it/s, est. speed input: 13581.63 toks/s, output: 13.26 toks/s]
Processed prompts:  41%|████      | 210/512 [00:15<00:26, 11.33it/s, est. speed input: 13535.01 toks/s, output: 13.22 toks/s]
Processed prompts:  42%|████▏     | 214/512 [00:16<00:26, 11.30it/s, est. speed input: 13490.62 toks/s, output: 13.17 toks/s]
Processed prompts:  43%|████▎     | 218/512 [00:16<00:26, 11.28it/s, est. speed input: 13448.02 toks/s, output: 13.13 toks/s]
Processed prompts:  43%|████▎     | 222/512 [00:16<00:25, 11.27it/s, est. speed input: 13407.12 toks/s, output: 13.09 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:17<00:25, 11.26it/s, est. speed input: 13368.00 toks/s, output: 13.05 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:17<00:25, 11.25it/s, est. speed input: 13330.47 toks/s, output: 13.02 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:18<00:24, 11.25it/s, est. speed input: 13294.39 toks/s, output: 12.98 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:18<00:24, 11.24it/s, est. speed input: 13259.71 toks/s, output: 12.95 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:18<00:24, 11.24it/s, est. speed input: 13226.23 toks/s, output: 12.92 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:19<00:23, 11.23it/s, est. speed input: 13193.94 toks/s, output: 12.88 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:19<00:23, 11.23it/s, est. speed input: 13162.81 toks/s, output: 12.85 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:19<00:22, 11.22it/s, est. speed input: 13132.37 toks/s, output: 12.82 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:20<00:22, 11.22it/s, est. speed input: 13102.85 toks/s, output: 12.80 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:20<00:22, 11.21it/s, est. speed input: 13074.65 toks/s, output: 12.77 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:20<00:21, 11.22it/s, est. speed input: 13047.64 toks/s, output: 12.74 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:21<00:21, 11.22it/s, est. speed input: 13021.33 toks/s, output: 12.72 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:21<00:21, 11.22it/s, est. speed input: 12996.14 toks/s, output: 12.69 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:21<00:20, 11.22it/s, est. speed input: 12971.58 toks/s, output: 12.67 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:22<00:20, 11.22it/s, est. speed input: 12947.80 toks/s, output: 12.64 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:22<00:20, 11.22it/s, est. speed input: 12924.77 toks/s, output: 12.62 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:23<00:19, 11.22it/s, est. speed input: 12902.48 toks/s, output: 12.60 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:23<00:19, 11.21it/s, est. speed input: 12880.69 toks/s, output: 12.58 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:23<00:19, 11.21it/s, est. speed input: 12859.73 toks/s, output: 12.56 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:24<00:18, 11.21it/s, est. speed input: 12839.28 toks/s, output: 12.54 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:24<00:18, 11.21it/s, est. speed input: 12819.34 toks/s, output: 12.52 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:24<00:18, 11.21it/s, est. speed input: 12800.02 toks/s, output: 12.50 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:25<00:17, 11.21it/s, est. speed input: 12781.35 toks/s, output: 12.48 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:25<00:17, 11.21it/s, est. speed input: 12763.33 toks/s, output: 12.46 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:25<00:16, 11.21it/s, est. speed input: 12745.52 toks/s, output: 12.45 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:26<00:16, 11.21it/s, est. speed input: 12728.19 toks/s, output: 12.43 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:26<00:16, 11.21it/s, est. speed input: 12711.41 toks/s, output: 12.41 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:26<00:15, 11.21it/s, est. speed input: 12695.28 toks/s, output: 12.40 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:27<00:15, 11.21it/s, est. speed input: 12679.47 toks/s, output: 12.38 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:27<00:15, 11.21it/s, est. speed input: 12663.87 toks/s, output: 12.37 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:28<00:14, 11.21it/s, est. speed input: 12648.76 toks/s, output: 12.35 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:28<00:14, 11.21it/s, est. speed input: 12633.86 toks/s, output: 12.34 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:28<00:14, 11.20it/s, est. speed input: 12619.38 toks/s, output: 12.32 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:29<00:13, 11.20it/s, est. speed input: 12605.19 toks/s, output: 12.31 toks/s]
Processed prompts:  71%|███████   | 362/512 [00:29<00:13, 11.20it/s, est. speed input: 12591.43 toks/s, output: 12.30 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:29<00:13, 11.20it/s, est. speed input: 12577.92 toks/s, output: 12.28 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [00:30<00:12, 11.20it/s, est. speed input: 12564.98 toks/s, output: 12.27 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [00:30<00:12, 11.20it/s, est. speed input: 12552.20 toks/s, output: 12.26 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [00:30<00:11, 11.20it/s, est. speed input: 12539.70 toks/s, output: 12.25 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [00:31<00:11, 11.21it/s, est. speed input: 12527.58 toks/s, output: 12.23 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [00:31<00:11, 11.21it/s, est. speed input: 12515.70 toks/s, output: 12.22 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [00:31<00:10, 11.21it/s, est. speed input: 12504.12 toks/s, output: 12.21 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [00:32<00:10, 11.21it/s, est. speed input: 12492.97 toks/s, output: 12.20 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [00:32<00:10, 11.21it/s, est. speed input: 12481.98 toks/s, output: 12.19 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [00:33<00:09, 11.22it/s, est. speed input: 12471.35 toks/s, output: 12.18 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [00:33<00:09, 11.22it/s, est. speed input: 12460.88 toks/s, output: 12.17 toks/s]
Processed prompts:  80%|████████  | 410/512 [00:33<00:09, 11.22it/s, est. speed input: 12450.66 toks/s, output: 12.16 toks/s]
Processed prompts:  81%|████████  | 414/512 [00:34<00:08, 11.22it/s, est. speed input: 12440.65 toks/s, output: 12.15 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [00:34<00:08, 11.22it/s, est. speed input: 12430.85 toks/s, output: 12.14 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [00:34<00:08, 11.22it/s, est. speed input: 12421.20 toks/s, output: 12.13 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [00:35<00:07, 11.22it/s, est. speed input: 12411.80 toks/s, output: 12.12 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [00:35<00:07, 11.22it/s, est. speed input: 12402.45 toks/s, output: 12.11 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [00:35<00:06, 11.22it/s, est. speed input: 12393.41 toks/s, output: 12.10 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [00:36<00:06, 11.22it/s, est. speed input: 12384.53 toks/s, output: 12.09 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [00:36<00:06, 11.22it/s, est. speed input: 12375.86 toks/s, output: 12.09 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [00:36<00:05, 11.22it/s, est. speed input: 12367.26 toks/s, output: 12.08 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [00:37<00:05, 11.22it/s, est. speed input: 12358.68 toks/s, output: 12.07 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [00:37<00:05, 11.22it/s, est. speed input: 12350.57 toks/s, output: 12.06 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [00:37<00:04, 11.22it/s, est. speed input: 12342.41 toks/s, output: 12.05 toks/s]
Processed prompts:  90%|█████████ | 462/512 [00:38<00:04, 11.22it/s, est. speed input: 12334.43 toks/s, output: 12.05 toks/s]
Processed prompts:  91%|█████████ | 466/512 [00:38<00:04, 11.22it/s, est. speed input: 12326.57 toks/s, output: 12.04 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [00:39<00:03, 11.21it/s, est. speed input: 12318.81 toks/s, output: 12.03 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [00:39<00:03, 11.22it/s, est. speed input: 12311.36 toks/s, output: 12.02 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [00:39<00:03, 11.22it/s, est. speed input: 12304.04 toks/s, output: 12.02 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [00:40<00:02, 11.22it/s, est. speed input: 12296.83 toks/s, output: 12.01 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [00:40<00:02, 11.22it/s, est. speed input: 12289.66 toks/s, output: 12.00 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [00:40<00:01, 11.22it/s, est. speed input: 12282.66 toks/s, output: 11.99 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [00:41<00:01, 11.22it/s, est. speed input: 12275.72 toks/s, output: 11.99 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [00:41<00:01, 11.22it/s, est. speed input: 12268.93 toks/s, output: 11.98 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:41<00:00, 11.22it/s, est. speed input: 12743.57 toks/s, output: 12.44 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:41<00:00, 12.44it/s, est. speed input: 12743.57 toks/s, output: 12.44 toks/s]
[rank0]:[W126 05:18:48.109586424 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 106.0s

测试结果:
  Requests/s:   11.16
  Tokens/s:     11438.32
  Total Reqs:   512
  Elapsed:      45.88s

  [Prefill 分析]
  Total Prefill Tokens: 524288
  Prefill Tokens/s:     11427.16

============================================================
[5/8] 测试 M=8192
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-14B-INT8                                │
│ Backend:  cuBLASLt [INT32 output]                         │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 8192
│   M_prefill     = 8192 (= 8 x 1024)
│   M_decode      = 8
│   batched_tokens = 8192 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 1024
│   --max-num-seqs           = 8
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 8192
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 05:19:07 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 05:19:08 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=223276) WARNING 01-26 05:19:15 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=223276) WARNING 01-26 05:19:31 [backends.py:609] Failed to read file <frozen os>
Throughput: 11.11 requests/s, 11386.03 total tokens/s, 11.11 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024


─── STDERR ───
[2026-01-26 05:19:07] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:19:07] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:19:07] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:19:07] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:19:07] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:19:07] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:19:07] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:19:07] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:19:07] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:19:07] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:19:07] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:19:07] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:19:07] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:19:07] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 05:19:15] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:19:15] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:19:15] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:19:15] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:19:15] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:19:15] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:19:15] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:19:15] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:19:15] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:19:15] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:19:15] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:19:15] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:19:15] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:19:15] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=223276) [2026-01-26 05:19:16] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=223276) [2026-01-26 05:19:16] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=223276) [2026-01-26 05:19:16] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=223276) [2026-01-26 05:19:16] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=223276) [2026-01-26 05:19:16] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuBLASLt, symmetric=True
(EngineCore_DP0 pid=223276) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=223276) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.00it/s]
(EngineCore_DP0 pid=223276) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:02<00:02,  1.03s/it]
(EngineCore_DP0 pid=223276) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.36it/s]
(EngineCore_DP0 pid=223276) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.21it/s]
(EngineCore_DP0 pid=223276) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.18it/s]
(EngineCore_DP0 pid=223276) 
[cuBLASLt] INFO: INT8 GEMM only supports INT32 output. inner_dtype parameter is ignored, always using int32.
(EngineCore_DP0 pid=223276) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:02,  1.79it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  40%|████      | 2/5 [00:00<00:01,  2.84it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  60%|██████    | 3/5 [00:00<00:00,  3.43it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  80%|████████  | 4/5 [00:01<00:00,  3.80it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:01<00:00,  3.23it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:01<00:00,  3.13it/s]
(EngineCore_DP0 pid=223276) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:01,  2.79it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 2/4 [00:00<00:00,  3.67it/s]
Capturing CUDA graphs (decode, FULL):  75%|███████▌  | 3/4 [00:00<00:00,  4.20it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  4.50it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  4.14it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 24/1024 [00:00<00:04, 233.04it/s]
Adding requests:   5%|▍         | 49/1024 [00:00<00:04, 238.80it/s]
Adding requests:   7%|▋         | 76/1024 [00:00<00:03, 251.95it/s]
Adding requests:  10%|▉         | 102/1024 [00:00<00:03, 252.78it/s]
Adding requests:  12%|█▎        | 128/1024 [00:00<00:03, 250.98it/s]
Adding requests:  15%|█▌        | 154/1024 [00:00<00:03, 252.52it/s]
Adding requests:  18%|█▊        | 180/1024 [00:00<00:03, 253.26it/s]
Adding requests:  20%|██        | 208/1024 [00:00<00:03, 258.60it/s]
Adding requests:  23%|██▎       | 236/1024 [00:00<00:02, 263.13it/s]
Adding requests:  26%|██▌       | 263/1024 [00:01<00:02, 262.46it/s]
Adding requests:  28%|██▊       | 290/1024 [00:01<00:02, 263.50it/s]
Adding requests:  31%|███       | 319/1024 [00:01<00:02, 270.61it/s]
Adding requests:  34%|███▍      | 347/1024 [00:01<00:02, 270.68it/s]
Adding requests:  37%|███▋      | 375/1024 [00:01<00:02, 273.06it/s]
Adding requests:  39%|███▉      | 404/1024 [00:01<00:02, 276.85it/s]
Adding requests:  42%|████▏     | 432/1024 [00:01<00:02, 276.63it/s]
Adding requests:  45%|████▍     | 460/1024 [00:01<00:02, 273.49it/s]
Adding requests:  48%|████▊     | 490/1024 [00:01<00:01, 279.55it/s]
Adding requests:  51%|█████     | 519/1024 [00:01<00:01, 281.92it/s]
Adding requests:  54%|█████▎    | 548/1024 [00:02<00:01, 279.33it/s]
Adding requests:  56%|█████▋    | 576/1024 [00:02<00:01, 279.05it/s]
Adding requests:  59%|█████▉    | 604/1024 [00:02<00:01, 270.56it/s]
Adding requests:  62%|██████▏   | 632/1024 [00:02<00:01, 266.99it/s]
Adding requests:  64%|██████▍   | 659/1024 [00:02<00:01, 264.52it/s]
Adding requests:  67%|██████▋   | 686/1024 [00:02<00:01, 266.09it/s]
Adding requests:  70%|██████▉   | 714/1024 [00:02<00:01, 269.86it/s]
Adding requests:  72%|███████▏  | 742/1024 [00:02<00:01, 264.24it/s]
Adding requests:  75%|███████▌  | 769/1024 [00:02<00:00, 255.12it/s]
Adding requests:  78%|███████▊  | 796/1024 [00:03<00:00, 259.12it/s]
Adding requests:  80%|████████  | 823/1024 [00:03<00:00, 260.34it/s]
Adding requests:  83%|████████▎ | 850/1024 [00:03<00:00, 261.68it/s]
Adding requests:  86%|████████▌ | 877/1024 [00:03<00:00, 262.46it/s]
Adding requests:  88%|████████▊ | 906/1024 [00:03<00:00, 270.09it/s]
Adding requests:  91%|█████████ | 934/1024 [00:03<00:00, 260.84it/s]
Adding requests:  94%|█████████▍| 961/1024 [00:03<00:00, 262.59it/s]
Adding requests:  96%|█████████▋| 988/1024 [00:03<00:00, 260.62it/s]
Adding requests:  99%|█████████▉| 1015/1024 [00:03<00:00, 254.98it/s]
Adding requests: 100%|██████████| 1024/1024 [00:03<00:00, 264.23it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   3%|▎         | 34/1024 [00:00<00:09, 107.45it/s, est. speed input: 110043.71 toks/s, output: 107.46 toks/s]
Processed prompts:   4%|▍         | 45/1024 [00:01<00:26, 37.45it/s, est. speed input: 44992.01 toks/s, output: 43.94 toks/s]   
Processed prompts:   5%|▍         | 51/1024 [00:01<00:43, 22.36it/s, est. speed input: 30159.86 toks/s, output: 29.45 toks/s]
Processed prompts:   6%|▌         | 58/1024 [00:02<00:56, 17.04it/s, est. speed input: 24347.14 toks/s, output: 23.78 toks/s]
Processed prompts:   6%|▋         | 66/1024 [00:03<01:04, 14.86it/s, est. speed input: 21471.05 toks/s, output: 20.97 toks/s]
Processed prompts:   7%|▋         | 74/1024 [00:03<01:09, 13.61it/s, est. speed input: 19649.91 toks/s, output: 19.19 toks/s]
Processed prompts:   8%|▊         | 82/1024 [00:04<01:13, 12.83it/s, est. speed input: 18393.60 toks/s, output: 17.96 toks/s]
Processed prompts:   9%|▉         | 90/1024 [00:05<01:15, 12.33it/s, est. speed input: 17472.90 toks/s, output: 17.06 toks/s]
Processed prompts:  10%|▉         | 98/1024 [00:05<01:17, 11.99it/s, est. speed input: 16767.66 toks/s, output: 16.37 toks/s]
Processed prompts:  10%|█         | 106/1024 [00:06<01:18, 11.76it/s, est. speed input: 16210.35 toks/s, output: 15.83 toks/s]
Processed prompts:  11%|█         | 114/1024 [00:07<01:18, 11.60it/s, est. speed input: 15758.45 toks/s, output: 15.39 toks/s]
Processed prompts:  12%|█▏        | 122/1024 [00:08<01:18, 11.49it/s, est. speed input: 15385.09 toks/s, output: 15.02 toks/s]
Processed prompts:  13%|█▎        | 130/1024 [00:08<01:18, 11.40it/s, est. speed input: 15070.07 toks/s, output: 14.72 toks/s]
Processed prompts:  13%|█▎        | 138/1024 [00:09<01:18, 11.35it/s, est. speed input: 14801.67 toks/s, output: 14.45 toks/s]
Processed prompts:  14%|█▍        | 146/1024 [00:10<01:17, 11.30it/s, est. speed input: 14570.37 toks/s, output: 14.23 toks/s]
Processed prompts:  15%|█▌        | 154/1024 [00:10<01:17, 11.27it/s, est. speed input: 14368.73 toks/s, output: 14.03 toks/s]
Processed prompts:  16%|█▌        | 162/1024 [00:11<01:16, 11.25it/s, est. speed input: 14190.56 toks/s, output: 13.86 toks/s]
Processed prompts:  17%|█▋        | 170/1024 [00:12<01:16, 11.23it/s, est. speed input: 14032.95 toks/s, output: 13.70 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [00:13<01:15, 11.21it/s, est. speed input: 13891.89 toks/s, output: 13.57 toks/s]
Processed prompts:  18%|█▊        | 186/1024 [00:13<01:14, 11.20it/s, est. speed input: 13765.52 toks/s, output: 13.44 toks/s]
Processed prompts:  19%|█▉        | 194/1024 [00:14<01:14, 11.19it/s, est. speed input: 13651.22 toks/s, output: 13.33 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [00:15<01:13, 11.19it/s, est. speed input: 13547.32 toks/s, output: 13.23 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:15<01:12, 11.18it/s, est. speed input: 13452.60 toks/s, output: 13.14 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [00:16<01:12, 11.18it/s, est. speed input: 13365.92 toks/s, output: 13.05 toks/s]
Processed prompts:  22%|██▏       | 226/1024 [00:17<01:11, 11.17it/s, est. speed input: 13285.91 toks/s, output: 12.97 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:18<01:10, 11.17it/s, est. speed input: 13212.52 toks/s, output: 12.90 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:18<01:10, 11.16it/s, est. speed input: 13144.18 toks/s, output: 12.84 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:19<01:09, 11.16it/s, est. speed input: 13081.14 toks/s, output: 12.77 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:20<01:08, 11.16it/s, est. speed input: 13022.42 toks/s, output: 12.72 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:21<01:07, 11.16it/s, est. speed input: 12967.73 toks/s, output: 12.66 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:21<01:07, 11.16it/s, est. speed input: 12916.69 toks/s, output: 12.61 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:22<00:41, 17.65it/s, est. speed input: 13582.98 toks/s, output: 13.26 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:23<00:45, 15.72it/s, est. speed input: 13516.06 toks/s, output: 13.20 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:23<00:49, 14.35it/s, est. speed input: 13452.95 toks/s, output: 13.14 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:24<00:52, 13.40it/s, est. speed input: 13393.66 toks/s, output: 13.08 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:25<00:54, 12.73it/s, est. speed input: 13337.83 toks/s, output: 13.03 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:26<00:55, 12.26it/s, est. speed input: 13285.21 toks/s, output: 12.97 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:26<00:56, 11.93it/s, est. speed input: 13235.72 toks/s, output: 12.93 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:27<00:57, 11.70it/s, est. speed input: 13188.62 toks/s, output: 12.88 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:28<00:57, 11.54it/s, est. speed input: 13144.37 toks/s, output: 12.84 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:28<00:57, 11.43it/s, est. speed input: 13102.35 toks/s, output: 12.80 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:29<00:56, 11.36it/s, est. speed input: 13062.68 toks/s, output: 12.76 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:30<00:56, 11.31it/s, est. speed input: 13024.69 toks/s, output: 12.72 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [00:31<00:55, 11.27it/s, est. speed input: 12988.69 toks/s, output: 12.68 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:31<00:55, 11.25it/s, est. speed input: 12954.24 toks/s, output: 12.65 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:32<00:54, 11.23it/s, est. speed input: 12921.12 toks/s, output: 12.62 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:33<00:54, 11.21it/s, est. speed input: 12889.36 toks/s, output: 12.59 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:33<00:53, 11.20it/s, est. speed input: 12858.99 toks/s, output: 12.56 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:34<00:52, 11.20it/s, est. speed input: 12829.85 toks/s, output: 12.53 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:35<00:51, 11.19it/s, est. speed input: 12801.95 toks/s, output: 12.50 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:36<00:51, 11.19it/s, est. speed input: 12774.99 toks/s, output: 12.48 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:36<00:50, 11.19it/s, est. speed input: 12749.22 toks/s, output: 12.45 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:37<00:49, 11.18it/s, est. speed input: 12724.45 toks/s, output: 12.43 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:38<00:49, 11.18it/s, est. speed input: 12700.54 toks/s, output: 12.40 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:38<00:48, 11.18it/s, est. speed input: 12677.49 toks/s, output: 12.38 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:39<00:47, 11.18it/s, est. speed input: 12655.26 toks/s, output: 12.36 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:40<00:47, 11.18it/s, est. speed input: 12633.83 toks/s, output: 12.34 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:41<00:46, 11.18it/s, est. speed input: 12613.14 toks/s, output: 12.32 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:41<00:45, 11.18it/s, est. speed input: 12593.16 toks/s, output: 12.30 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:42<00:44, 11.18it/s, est. speed input: 12573.75 toks/s, output: 12.28 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:43<00:44, 11.17it/s, est. speed input: 12554.76 toks/s, output: 12.26 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:43<00:43, 11.17it/s, est. speed input: 12536.53 toks/s, output: 12.24 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:44<00:42, 11.17it/s, est. speed input: 12518.94 toks/s, output: 12.23 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:45<00:42, 11.17it/s, est. speed input: 12501.92 toks/s, output: 12.21 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:46<00:41, 11.17it/s, est. speed input: 12485.34 toks/s, output: 12.19 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:46<00:40, 11.17it/s, est. speed input: 12469.32 toks/s, output: 12.18 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:47<00:39, 11.17it/s, est. speed input: 12453.69 toks/s, output: 12.16 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:48<00:39, 11.17it/s, est. speed input: 12438.48 toks/s, output: 12.15 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:48<00:38, 11.17it/s, est. speed input: 12423.82 toks/s, output: 12.13 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:49<00:37, 11.17it/s, est. speed input: 12409.52 toks/s, output: 12.12 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:50<00:37, 11.17it/s, est. speed input: 12395.60 toks/s, output: 12.11 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:51<00:36, 11.16it/s, est. speed input: 12382.04 toks/s, output: 12.09 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:51<00:35, 11.16it/s, est. speed input: 12368.91 toks/s, output: 12.08 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:52<00:34, 11.16it/s, est. speed input: 12356.16 toks/s, output: 12.07 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:53<00:34, 11.17it/s, est. speed input: 12343.76 toks/s, output: 12.05 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:53<00:20, 17.70it/s, est. speed input: 12630.18 toks/s, output: 12.33 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:54<00:22, 15.76it/s, est. speed input: 12614.51 toks/s, output: 12.32 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:55<00:23, 14.39it/s, est. speed input: 12599.30 toks/s, output: 12.30 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:56<00:24, 13.42it/s, est. speed input: 12584.49 toks/s, output: 12.29 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:56<00:25, 12.75it/s, est. speed input: 12570.00 toks/s, output: 12.28 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:57<00:25, 12.27it/s, est. speed input: 12555.81 toks/s, output: 12.26 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:58<00:25, 11.94it/s, est. speed input: 12542.13 toks/s, output: 12.25 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:59<00:25, 11.71it/s, est. speed input: 12528.67 toks/s, output: 12.24 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:59<00:25, 11.55it/s, est. speed input: 12515.56 toks/s, output: 12.22 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [01:00<00:25, 11.43it/s, est. speed input: 12502.70 toks/s, output: 12.21 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [01:01<00:24, 11.35it/s, est. speed input: 12490.24 toks/s, output: 12.20 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [01:01<00:23, 11.29it/s, est. speed input: 12477.83 toks/s, output: 12.19 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [01:02<00:23, 11.25it/s, est. speed input: 12465.70 toks/s, output: 12.17 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [01:03<00:22, 11.22it/s, est. speed input: 12453.80 toks/s, output: 12.16 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [01:04<00:21, 11.20it/s, est. speed input: 12442.12 toks/s, output: 12.15 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [01:04<00:21, 11.18it/s, est. speed input: 12430.80 toks/s, output: 12.14 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [01:05<00:20, 11.18it/s, est. speed input: 12419.76 toks/s, output: 12.13 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [01:06<00:19, 11.17it/s, est. speed input: 12408.88 toks/s, output: 12.12 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [01:06<00:19, 11.16it/s, est. speed input: 12398.19 toks/s, output: 12.11 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [01:07<00:18, 11.16it/s, est. speed input: 12387.76 toks/s, output: 12.10 toks/s]
Processed prompts:  81%|████████  | 826/1024 [01:08<00:17, 11.15it/s, est. speed input: 12377.44 toks/s, output: 12.09 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [01:09<00:17, 11.15it/s, est. speed input: 12367.41 toks/s, output: 12.08 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [01:09<00:16, 11.15it/s, est. speed input: 12357.62 toks/s, output: 12.07 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [01:10<00:15, 11.14it/s, est. speed input: 12347.83 toks/s, output: 12.06 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [01:11<00:14, 11.14it/s, est. speed input: 12338.27 toks/s, output: 12.05 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [01:11<00:14, 11.14it/s, est. speed input: 12328.83 toks/s, output: 12.04 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [01:12<00:13, 11.13it/s, est. speed input: 12319.60 toks/s, output: 12.03 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [01:13<00:12, 11.13it/s, est. speed input: 12310.56 toks/s, output: 12.02 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [01:14<00:12, 11.13it/s, est. speed input: 12301.70 toks/s, output: 12.01 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [01:14<00:11, 11.13it/s, est. speed input: 12293.02 toks/s, output: 12.00 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [01:15<00:10, 11.13it/s, est. speed input: 12284.46 toks/s, output: 12.00 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [01:16<00:09, 11.13it/s, est. speed input: 12276.04 toks/s, output: 11.99 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [01:16<00:09, 11.13it/s, est. speed input: 12267.88 toks/s, output: 11.98 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [01:17<00:08, 11.13it/s, est. speed input: 12259.88 toks/s, output: 11.97 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [01:18<00:07, 11.14it/s, est. speed input: 12252.12 toks/s, output: 11.96 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [01:19<00:07, 11.14it/s, est. speed input: 12244.50 toks/s, output: 11.96 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [01:19<00:06, 11.14it/s, est. speed input: 12236.98 toks/s, output: 11.95 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [01:20<00:05, 11.14it/s, est. speed input: 12229.61 toks/s, output: 11.94 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [01:21<00:04, 11.14it/s, est. speed input: 12222.35 toks/s, output: 11.94 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [01:21<00:04, 11.14it/s, est. speed input: 12215.36 toks/s, output: 11.93 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [01:22<00:03, 11.14it/s, est. speed input: 12208.28 toks/s, output: 11.92 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [01:23<00:02, 11.14it/s, est. speed input: 12201.44 toks/s, output: 11.92 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [01:24<00:01, 11.14it/s, est. speed input: 12194.74 toks/s, output: 11.91 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [01:24<00:00, 11.14it/s, est. speed input: 12473.65 toks/s, output: 12.18 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [01:24<00:00, 12.18it/s, est. speed input: 12473.65 toks/s, output: 12.18 toks/s]
[rank0]:[W126 05:21:24.061167943 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 155.9s

测试结果:
  Requests/s:   11.11
  Tokens/s:     11386.03
  Total Reqs:   1024
  Elapsed:      92.18s

  [Prefill 分析]
  Total Prefill Tokens: 1048576
  Prefill Tokens/s:     11374.92

============================================================
[6/8] 测试 M=16384
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-14B-INT8                                │
│ Backend:  cuBLASLt [INT32 output]                         │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 16384
│   M_prefill     = 16384 (= 16 x 1024)
│   M_decode      = 16
│   batched_tokens = 16384 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 2048
│   --max-num-seqs           = 16
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 16384
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 05:21:50 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 05:21:51 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=225875) WARNING 01-26 05:21:57 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=225875) WARNING 01-26 05:22:15 [backends.py:609] Failed to read file <frozen os>
Throughput: 10.99 requests/s, 11267.48 total tokens/s, 10.99 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048


─── STDERR ───
[2026-01-26 05:21:50] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:21:50] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:21:50] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:21:50] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:21:50] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:21:50] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:21:50] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:21:50] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:21:50] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:21:50] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:21:50] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:21:50] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:21:50] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:21:50] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 05:21:57] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:21:57] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:21:57] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:21:57] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:21:57] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:21:57] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:21:57] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:21:57] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:21:57] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:21:57] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:21:57] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:21:57] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:21:57] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:21:57] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=225875) [2026-01-26 05:21:58] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=225875) [2026-01-26 05:21:58] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=225875) [2026-01-26 05:21:58] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=225875) [2026-01-26 05:21:58] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=225875) [2026-01-26 05:21:58] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuBLASLt, symmetric=True
(EngineCore_DP0 pid=225875) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=225875) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.02it/s]
(EngineCore_DP0 pid=225875) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.01it/s]
(EngineCore_DP0 pid=225875) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.41it/s]
(EngineCore_DP0 pid=225875) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.26it/s]
(EngineCore_DP0 pid=225875) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.22it/s]
(EngineCore_DP0 pid=225875) 
(EngineCore_DP0 pid=225875) [rank0]:W0126 05:22:27.531000 225875 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=225875) [rank0]:W0126 05:22:28.486000 225875 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
[cuBLASLt] INFO: INT8 GEMM only supports INT32 output. inner_dtype parameter is ignored, always using int32.
(EngineCore_DP0 pid=225875) [rank0]:W0126 05:22:30.376000 225875 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=225875) [rank0]:W0126 05:22:30.497000 225875 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=225875) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  14%|█▍        | 1/7 [00:00<00:01,  4.60it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  29%|██▊       | 2/7 [00:00<00:01,  4.69it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  43%|████▎     | 3/7 [00:00<00:00,  4.75it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  57%|█████▋    | 4/7 [00:00<00:00,  4.36it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  71%|███████▏  | 5/7 [00:01<00:00,  3.86it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  86%|████████▌ | 6/7 [00:01<00:00,  3.34it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:01<00:00,  3.57it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:01<00:00,  3.84it/s]
(EngineCore_DP0 pid=225875) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  20%|██        | 1/5 [00:00<00:00,  4.24it/s]
Capturing CUDA graphs (decode, FULL):  40%|████      | 2/5 [00:00<00:00,  4.61it/s]
Capturing CUDA graphs (decode, FULL):  60%|██████    | 3/5 [00:00<00:00,  4.72it/s]
Capturing CUDA graphs (decode, FULL):  80%|████████  | 4/5 [00:00<00:00,  4.81it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:01<00:00,  4.82it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:01<00:00,  4.74it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   1%|          | 23/2048 [00:00<00:08, 228.99it/s]
Adding requests:   2%|▏         | 49/2048 [00:00<00:08, 243.62it/s]
Adding requests:   4%|▎         | 76/2048 [00:00<00:07, 254.87it/s]
Adding requests:   5%|▍         | 102/2048 [00:00<00:07, 256.17it/s]
Adding requests:   6%|▋         | 128/2048 [00:00<00:07, 255.60it/s]
Adding requests:   8%|▊         | 155/2048 [00:00<00:07, 257.61it/s]
Adding requests:   9%|▉         | 184/2048 [00:00<00:06, 266.45it/s]
Adding requests:  10%|█         | 211/2048 [00:00<00:06, 266.27it/s]
Adding requests:  12%|█▏        | 239/2048 [00:00<00:06, 268.49it/s]
Adding requests:  13%|█▎        | 266/2048 [00:01<00:06, 264.74it/s]
Adding requests:  14%|█▍        | 293/2048 [00:01<00:06, 258.49it/s]
Adding requests:  16%|█▌        | 319/2048 [00:01<00:07, 246.79it/s]
Adding requests:  17%|█▋        | 346/2048 [00:01<00:06, 253.24it/s]
Adding requests:  18%|█▊        | 374/2048 [00:01<00:06, 260.57it/s]
Adding requests:  20%|█▉        | 402/2048 [00:01<00:06, 265.71it/s]
Adding requests:  21%|██        | 430/2048 [00:01<00:06, 269.62it/s]
Adding requests:  22%|██▏       | 458/2048 [00:01<00:05, 268.29it/s]
Adding requests:  24%|██▍       | 487/2048 [00:01<00:05, 274.49it/s]
Adding requests:  25%|██▌       | 515/2048 [00:01<00:05, 275.75it/s]
Adding requests:  27%|██▋       | 543/2048 [00:02<00:05, 270.24it/s]
Adding requests:  28%|██▊       | 571/2048 [00:02<00:05, 266.03it/s]
Adding requests:  29%|██▉       | 598/2048 [00:02<00:05, 258.85it/s]
Adding requests:  30%|███       | 624/2048 [00:02<00:05, 256.52it/s]
Adding requests:  32%|███▏      | 650/2048 [00:02<00:05, 255.43it/s]
Adding requests:  33%|███▎      | 676/2048 [00:02<00:05, 254.85it/s]
Adding requests:  34%|███▍      | 704/2048 [00:02<00:05, 259.42it/s]
Adding requests:  36%|███▌      | 730/2048 [00:02<00:05, 256.00it/s]
Adding requests:  37%|███▋      | 756/2048 [00:02<00:05, 252.32it/s]
Adding requests:  38%|███▊      | 782/2048 [00:03<00:05, 252.97it/s]
Adding requests:  39%|███▉      | 808/2048 [00:03<00:04, 253.49it/s]
Adding requests:  41%|████      | 836/2048 [00:03<00:04, 260.77it/s]
Adding requests:  42%|████▏     | 863/2048 [00:03<00:04, 255.64it/s]
Adding requests:  44%|████▎     | 891/2048 [00:03<00:04, 262.45it/s]
Adding requests:  45%|████▍     | 918/2048 [00:03<00:04, 260.22it/s]
Adding requests:  46%|████▌     | 945/2048 [00:03<00:04, 259.31it/s]
Adding requests:  47%|████▋     | 972/2048 [00:03<00:04, 262.09it/s]
Adding requests:  49%|████▉     | 999/2048 [00:03<00:04, 258.15it/s]
Adding requests:  50%|█████     | 1025/2048 [00:03<00:03, 256.52it/s]
Adding requests:  51%|█████▏    | 1051/2048 [00:04<00:03, 255.32it/s]
Adding requests:  53%|█████▎    | 1077/2048 [00:04<00:03, 255.28it/s]
Adding requests:  54%|█████▍    | 1103/2048 [00:04<00:03, 254.44it/s]
Adding requests:  55%|█████▌    | 1132/2048 [00:04<00:03, 263.30it/s]
Adding requests:  57%|█████▋    | 1159/2048 [00:04<00:03, 256.39it/s]
Adding requests:  58%|█████▊    | 1186/2048 [00:04<00:03, 259.63it/s]
Adding requests:  59%|█████▉    | 1214/2048 [00:04<00:03, 262.56it/s]
Adding requests:  61%|██████    | 1241/2048 [00:04<00:03, 263.78it/s]
Adding requests:  62%|██████▏   | 1268/2048 [00:04<00:02, 261.47it/s]
Adding requests:  63%|██████▎   | 1295/2048 [00:04<00:02, 260.80it/s]
Adding requests:  65%|██████▍   | 1322/2048 [00:05<00:02, 262.23it/s]
Adding requests:  66%|██████▌   | 1349/2048 [00:05<00:02, 261.24it/s]
Adding requests:  67%|██████▋   | 1376/2048 [00:05<00:02, 262.99it/s]
Adding requests:  69%|██████▊   | 1403/2048 [00:05<00:02, 261.18it/s]
Adding requests:  70%|██████▉   | 1430/2048 [00:05<00:02, 261.63it/s]
Adding requests:  71%|███████   | 1457/2048 [00:05<00:02, 262.65it/s]
Adding requests:  72%|███████▏  | 1484/2048 [00:05<00:02, 262.68it/s]
Adding requests:  74%|███████▍  | 1512/2048 [00:05<00:02, 266.12it/s]
Adding requests:  75%|███████▌  | 1539/2048 [00:05<00:01, 260.49it/s]
Adding requests:  76%|███████▋  | 1566/2048 [00:06<00:01, 256.20it/s]
Adding requests:  78%|███████▊  | 1592/2048 [00:06<00:01, 254.49it/s]
Adding requests:  79%|███████▉  | 1618/2048 [00:06<00:01, 249.48it/s]
Adding requests:  80%|████████  | 1644/2048 [00:06<00:01, 250.27it/s]
Adding requests:  82%|████████▏ | 1670/2048 [00:06<00:01, 250.33it/s]
Adding requests:  83%|████████▎ | 1697/2048 [00:06<00:01, 255.13it/s]
Adding requests:  84%|████████▍ | 1726/2048 [00:06<00:01, 263.51it/s]
Adding requests:  86%|████████▌ | 1753/2048 [00:06<00:01, 262.60it/s]
Adding requests:  87%|████████▋ | 1781/2048 [00:06<00:01, 264.67it/s]
Adding requests:  88%|████████▊ | 1808/2048 [00:06<00:00, 262.22it/s]
Adding requests:  90%|████████▉ | 1835/2048 [00:07<00:00, 263.27it/s]
Adding requests:  91%|█████████ | 1862/2048 [00:07<00:00, 263.39it/s]
Adding requests:  92%|█████████▏| 1890/2048 [00:07<00:00, 265.46it/s]
Adding requests:  94%|█████████▎| 1918/2048 [00:07<00:00, 268.95it/s]
Adding requests:  95%|█████████▌| 1946/2048 [00:07<00:00, 270.04it/s]
Adding requests:  96%|█████████▋| 1974/2048 [00:07<00:00, 268.56it/s]
Adding requests:  98%|█████████▊| 2001/2048 [00:07<00:00, 266.11it/s]
Adding requests:  99%|█████████▉| 2028/2048 [00:07<00:00, 248.69it/s]
Adding requests: 100%|██████████| 2048/2048 [00:07<00:00, 259.83it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   4%|▍         | 86/2048 [00:00<00:08, 239.85it/s, est. speed input: 245625.49 toks/s, output: 239.85 toks/s]
Processed prompts:   5%|▌         | 110/2048 [00:02<00:55, 34.90it/s, est. speed input: 44698.50 toks/s, output: 43.65 toks/s]  
Processed prompts:   6%|▌         | 121/2048 [00:03<01:08, 27.99it/s, est. speed input: 37203.47 toks/s, output: 36.33 toks/s]
Processed prompts:   6%|▋         | 128/2048 [00:04<01:27, 21.85it/s, est. speed input: 31642.64 toks/s, output: 30.90 toks/s]
Processed prompts:   6%|▋         | 133/2048 [00:04<01:29, 21.40it/s, est. speed input: 30861.36 toks/s, output: 30.14 toks/s]
Processed prompts:   7%|▋         | 137/2048 [00:04<01:48, 17.58it/s, est. speed input: 28315.52 toks/s, output: 27.65 toks/s]
Processed prompts:   7%|▋         | 140/2048 [00:05<01:55, 16.52it/s, est. speed input: 27436.57 toks/s, output: 26.79 toks/s]
Processed prompts:   7%|▋         | 143/2048 [00:05<02:02, 15.50it/s, est. speed input: 26644.06 toks/s, output: 26.02 toks/s]
Processed prompts:   7%|▋         | 146/2048 [00:05<02:10, 14.56it/s, est. speed input: 25926.92 toks/s, output: 25.32 toks/s]
Processed prompts:   7%|▋         | 149/2048 [00:06<02:18, 13.75it/s, est. speed input: 25273.67 toks/s, output: 24.68 toks/s]
Processed prompts:   7%|▋         | 152/2048 [00:06<02:24, 13.08it/s, est. speed input: 24674.35 toks/s, output: 24.10 toks/s]
Processed prompts:   8%|▊         | 155/2048 [00:06<02:30, 12.55it/s, est. speed input: 24125.59 toks/s, output: 23.56 toks/s]
Processed prompts:   8%|▊         | 158/2048 [00:06<02:35, 12.15it/s, est. speed input: 23619.42 toks/s, output: 23.07 toks/s]
Processed prompts:   8%|▊         | 161/2048 [00:07<02:39, 11.84it/s, est. speed input: 23150.39 toks/s, output: 22.61 toks/s]
Processed prompts:   9%|▊         | 179/2048 [00:07<01:03, 29.41it/s, est. speed input: 25008.29 toks/s, output: 24.42 toks/s]
Processed prompts:   9%|▉         | 183/2048 [00:07<01:14, 24.94it/s, est. speed input: 24654.04 toks/s, output: 24.08 toks/s]
Processed prompts:   9%|▉         | 186/2048 [00:07<01:29, 20.73it/s, est. speed input: 24194.58 toks/s, output: 23.63 toks/s]
Processed prompts:   9%|▉         | 189/2048 [00:08<01:44, 17.81it/s, est. speed input: 23765.84 toks/s, output: 23.21 toks/s]
Processed prompts:   9%|▉         | 191/2048 [00:08<02:06, 14.66it/s, est. speed input: 23243.09 toks/s, output: 22.70 toks/s]
Processed prompts:   9%|▉         | 194/2048 [00:08<02:16, 13.57it/s, est. speed input: 22870.24 toks/s, output: 22.33 toks/s]
Processed prompts:  10%|▉         | 197/2048 [00:08<02:24, 12.81it/s, est. speed input: 22519.22 toks/s, output: 21.99 toks/s]
Processed prompts:  10%|▉         | 200/2048 [00:09<02:30, 12.28it/s, est. speed input: 22189.82 toks/s, output: 21.67 toks/s]
Processed prompts:  10%|▉         | 203/2048 [00:09<02:34, 11.90it/s, est. speed input: 21877.78 toks/s, output: 21.36 toks/s]
Processed prompts:  10%|█         | 206/2048 [00:09<02:38, 11.65it/s, est. speed input: 21584.26 toks/s, output: 21.08 toks/s]
Processed prompts:  10%|█         | 209/2048 [00:10<02:40, 11.47it/s, est. speed input: 21306.53 toks/s, output: 20.81 toks/s]
Processed prompts:  10%|█         | 212/2048 [00:10<02:41, 11.34it/s, est. speed input: 21044.07 toks/s, output: 20.55 toks/s]
Processed prompts:  10%|█         | 215/2048 [00:10<02:42, 11.25it/s, est. speed input: 20793.75 toks/s, output: 20.31 toks/s]
Processed prompts:  11%|█         | 218/2048 [00:10<02:43, 11.19it/s, est. speed input: 20556.58 toks/s, output: 20.07 toks/s]
Processed prompts:  11%|█         | 221/2048 [00:11<02:43, 11.15it/s, est. speed input: 20330.97 toks/s, output: 19.85 toks/s]
Processed prompts:  11%|█         | 224/2048 [00:11<02:44, 11.12it/s, est. speed input: 20116.03 toks/s, output: 19.64 toks/s]
Processed prompts:  11%|█         | 227/2048 [00:11<02:44, 11.09it/s, est. speed input: 19911.00 toks/s, output: 19.44 toks/s]
Processed prompts:  11%|█         | 230/2048 [00:11<02:44, 11.08it/s, est. speed input: 19714.94 toks/s, output: 19.25 toks/s]
Processed prompts:  11%|█▏        | 233/2048 [00:12<02:44, 11.06it/s, est. speed input: 19527.77 toks/s, output: 19.07 toks/s]
Processed prompts:  12%|█▏        | 236/2048 [00:12<02:43, 11.05it/s, est. speed input: 19348.27 toks/s, output: 18.89 toks/s]
Processed prompts:  12%|█▏        | 239/2048 [00:12<02:43, 11.04it/s, est. speed input: 19176.47 toks/s, output: 18.73 toks/s]
Processed prompts:  12%|█▏        | 242/2048 [00:13<02:43, 11.04it/s, est. speed input: 19012.03 toks/s, output: 18.57 toks/s]
Processed prompts:  12%|█▏        | 245/2048 [00:13<02:43, 11.04it/s, est. speed input: 18854.61 toks/s, output: 18.41 toks/s]
Processed prompts:  12%|█▏        | 248/2048 [00:13<02:43, 11.04it/s, est. speed input: 18703.28 toks/s, output: 18.26 toks/s]
Processed prompts:  12%|█▏        | 251/2048 [00:13<02:42, 11.04it/s, est. speed input: 18557.94 toks/s, output: 18.12 toks/s]
Processed prompts:  12%|█▏        | 254/2048 [00:14<02:42, 11.04it/s, est. speed input: 18418.12 toks/s, output: 17.99 toks/s]
Processed prompts:  13%|█▎        | 257/2048 [00:14<02:42, 11.04it/s, est. speed input: 18283.71 toks/s, output: 17.86 toks/s]
Processed prompts:  13%|█▎        | 260/2048 [00:14<02:42, 11.03it/s, est. speed input: 18153.86 toks/s, output: 17.73 toks/s]
Processed prompts:  13%|█▎        | 263/2048 [00:14<02:41, 11.03it/s, est. speed input: 18028.49 toks/s, output: 17.61 toks/s]
Processed prompts:  13%|█▎        | 266/2048 [00:15<02:41, 11.03it/s, est. speed input: 17908.19 toks/s, output: 17.49 toks/s]
Processed prompts:  13%|█▎        | 269/2048 [00:15<02:41, 11.02it/s, est. speed input: 17791.19 toks/s, output: 17.37 toks/s]
Processed prompts:  13%|█▎        | 272/2048 [00:15<02:41, 11.02it/s, est. speed input: 17678.57 toks/s, output: 17.26 toks/s]
Processed prompts:  13%|█▎        | 275/2048 [00:16<02:40, 11.02it/s, est. speed input: 17570.00 toks/s, output: 17.16 toks/s]
Processed prompts:  14%|█▎        | 278/2048 [00:16<02:40, 11.02it/s, est. speed input: 17465.08 toks/s, output: 17.06 toks/s]
Processed prompts:  14%|█▎        | 281/2048 [00:16<02:40, 11.02it/s, est. speed input: 17363.67 toks/s, output: 16.96 toks/s]
Processed prompts:  14%|█▍        | 284/2048 [00:16<02:40, 11.02it/s, est. speed input: 17265.37 toks/s, output: 16.86 toks/s]
Processed prompts:  14%|█▍        | 287/2048 [00:17<02:39, 11.02it/s, est. speed input: 17170.29 toks/s, output: 16.77 toks/s]
Processed prompts:  14%|█▍        | 290/2048 [00:17<02:39, 11.02it/s, est. speed input: 17077.92 toks/s, output: 16.68 toks/s]
Processed prompts:  14%|█▍        | 293/2048 [00:17<02:39, 11.02it/s, est. speed input: 16988.72 toks/s, output: 16.59 toks/s]
Processed prompts:  14%|█▍        | 296/2048 [00:17<02:39, 11.01it/s, est. speed input: 16901.54 toks/s, output: 16.51 toks/s]
Processed prompts:  15%|█▍        | 299/2048 [00:18<02:38, 11.02it/s, est. speed input: 16817.62 toks/s, output: 16.42 toks/s]
Processed prompts:  15%|█▍        | 302/2048 [00:18<02:38, 11.02it/s, est. speed input: 16735.99 toks/s, output: 16.34 toks/s]
Processed prompts:  15%|█▍        | 305/2048 [00:18<02:38, 11.01it/s, est. speed input: 16656.55 toks/s, output: 16.27 toks/s]
Processed prompts:  15%|█▌        | 308/2048 [00:19<02:37, 11.02it/s, est. speed input: 16579.71 toks/s, output: 16.19 toks/s]
Processed prompts:  15%|█▌        | 311/2048 [00:19<02:37, 11.02it/s, est. speed input: 16504.90 toks/s, output: 16.12 toks/s]
Processed prompts:  15%|█▌        | 314/2048 [00:19<02:37, 11.02it/s, est. speed input: 16432.15 toks/s, output: 16.05 toks/s]
Processed prompts:  15%|█▌        | 317/2048 [00:19<02:37, 11.01it/s, est. speed input: 16361.35 toks/s, output: 15.98 toks/s]
Processed prompts:  16%|█▌        | 320/2048 [00:20<02:36, 11.02it/s, est. speed input: 16292.60 toks/s, output: 15.91 toks/s]
Processed prompts:  16%|█▌        | 323/2048 [00:20<02:36, 11.02it/s, est. speed input: 16225.99 toks/s, output: 15.85 toks/s]
Processed prompts:  16%|█▌        | 326/2048 [00:20<02:36, 11.02it/s, est. speed input: 16160.83 toks/s, output: 15.78 toks/s]
Processed prompts:  16%|█▌        | 329/2048 [00:20<02:35, 11.02it/s, est. speed input: 16097.49 toks/s, output: 15.72 toks/s]
Processed prompts:  16%|█▌        | 332/2048 [00:21<02:35, 11.02it/s, est. speed input: 16035.58 toks/s, output: 15.66 toks/s]
Processed prompts:  16%|█▋        | 335/2048 [00:21<02:35, 11.02it/s, est. speed input: 15975.28 toks/s, output: 15.60 toks/s]
Processed prompts:  17%|█▋        | 338/2048 [00:21<02:35, 11.01it/s, est. speed input: 15916.11 toks/s, output: 15.54 toks/s]
Processed prompts:  17%|█▋        | 341/2048 [00:22<02:35, 11.01it/s, est. speed input: 15858.70 toks/s, output: 15.49 toks/s]
Processed prompts:  17%|█▋        | 344/2048 [00:22<02:34, 11.01it/s, est. speed input: 15802.77 toks/s, output: 15.43 toks/s]
Processed prompts:  17%|█▋        | 347/2048 [00:22<02:34, 11.02it/s, est. speed input: 15748.33 toks/s, output: 15.38 toks/s]
Processed prompts:  17%|█▋        | 350/2048 [00:22<02:34, 11.01it/s, est. speed input: 15694.75 toks/s, output: 15.33 toks/s]
Processed prompts:  17%|█▋        | 353/2048 [00:23<02:33, 11.02it/s, est. speed input: 15642.88 toks/s, output: 15.28 toks/s]
Processed prompts:  17%|█▋        | 356/2048 [00:23<02:33, 11.02it/s, est. speed input: 15592.22 toks/s, output: 15.23 toks/s]
Processed prompts:  18%|█▊        | 359/2048 [00:23<02:33, 11.02it/s, est. speed input: 15542.56 toks/s, output: 15.18 toks/s]
Processed prompts:  18%|█▊        | 362/2048 [00:23<02:33, 11.01it/s, est. speed input: 15493.84 toks/s, output: 15.13 toks/s]
Processed prompts:  18%|█▊        | 365/2048 [00:24<02:32, 11.01it/s, est. speed input: 15446.32 toks/s, output: 15.08 toks/s]
Processed prompts:  18%|█▊        | 368/2048 [00:24<02:32, 11.01it/s, est. speed input: 15399.84 toks/s, output: 15.04 toks/s]
Processed prompts:  18%|█▊        | 371/2048 [00:24<02:32, 11.01it/s, est. speed input: 15354.26 toks/s, output: 14.99 toks/s]
Processed prompts:  18%|█▊        | 374/2048 [00:25<02:32, 11.01it/s, est. speed input: 15309.75 toks/s, output: 14.95 toks/s]
Processed prompts:  18%|█▊        | 377/2048 [00:25<02:31, 11.01it/s, est. speed input: 15266.45 toks/s, output: 14.91 toks/s]
Processed prompts:  19%|█▊        | 380/2048 [00:25<02:31, 11.01it/s, est. speed input: 15224.04 toks/s, output: 14.87 toks/s]
Processed prompts:  19%|█▊        | 383/2048 [00:25<02:31, 11.01it/s, est. speed input: 15182.22 toks/s, output: 14.83 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [00:26<02:30, 11.01it/s, est. speed input: 15141.65 toks/s, output: 14.79 toks/s]
Processed prompts:  19%|█▉        | 389/2048 [00:26<02:30, 11.02it/s, est. speed input: 15101.79 toks/s, output: 14.75 toks/s]
Processed prompts:  19%|█▉        | 392/2048 [00:26<02:30, 11.02it/s, est. speed input: 15062.77 toks/s, output: 14.71 toks/s]
Processed prompts:  19%|█▉        | 395/2048 [00:26<02:30, 11.01it/s, est. speed input: 15024.34 toks/s, output: 14.67 toks/s]
Processed prompts:  19%|█▉        | 398/2048 [00:27<02:29, 11.02it/s, est. speed input: 14987.01 toks/s, output: 14.64 toks/s]
Processed prompts:  20%|█▉        | 401/2048 [00:27<02:29, 11.02it/s, est. speed input: 14950.26 toks/s, output: 14.60 toks/s]
Processed prompts:  20%|█▉        | 404/2048 [00:27<02:29, 11.01it/s, est. speed input: 14914.09 toks/s, output: 14.56 toks/s]
Processed prompts:  20%|█▉        | 407/2048 [00:28<02:29, 11.01it/s, est. speed input: 14878.45 toks/s, output: 14.53 toks/s]
Processed prompts:  20%|██        | 410/2048 [00:28<02:28, 11.01it/s, est. speed input: 14843.68 toks/s, output: 14.50 toks/s]
Processed prompts:  20%|██        | 413/2048 [00:28<02:28, 11.01it/s, est. speed input: 14809.57 toks/s, output: 14.46 toks/s]
Processed prompts:  20%|██        | 416/2048 [00:28<02:28, 11.01it/s, est. speed input: 14776.14 toks/s, output: 14.43 toks/s]
Processed prompts:  20%|██        | 419/2048 [00:29<02:27, 11.01it/s, est. speed input: 14743.53 toks/s, output: 14.40 toks/s]
Processed prompts:  21%|██        | 422/2048 [00:29<02:27, 11.02it/s, est. speed input: 14711.56 toks/s, output: 14.37 toks/s]
Processed prompts:  21%|██        | 425/2048 [00:29<02:27, 11.02it/s, est. speed input: 14680.04 toks/s, output: 14.34 toks/s]
Processed prompts:  21%|██        | 428/2048 [00:29<02:27, 11.02it/s, est. speed input: 14649.09 toks/s, output: 14.31 toks/s]
Processed prompts:  21%|██        | 431/2048 [00:30<02:26, 11.02it/s, est. speed input: 14618.81 toks/s, output: 14.28 toks/s]
Processed prompts:  21%|██        | 434/2048 [00:30<02:26, 11.02it/s, est. speed input: 14588.95 toks/s, output: 14.25 toks/s]
Processed prompts:  21%|██▏       | 437/2048 [00:30<02:26, 11.02it/s, est. speed input: 14559.61 toks/s, output: 14.22 toks/s]
Processed prompts:  21%|██▏       | 440/2048 [00:31<02:26, 11.01it/s, est. speed input: 14530.60 toks/s, output: 14.19 toks/s]
Processed prompts:  22%|██▏       | 443/2048 [00:31<02:25, 11.01it/s, est. speed input: 14502.33 toks/s, output: 14.16 toks/s]
Processed prompts:  22%|██▏       | 446/2048 [00:31<02:25, 11.02it/s, est. speed input: 14474.56 toks/s, output: 14.14 toks/s]
Processed prompts:  22%|██▏       | 449/2048 [00:31<02:25, 11.01it/s, est. speed input: 14447.11 toks/s, output: 14.11 toks/s]
Processed prompts:  22%|██▏       | 452/2048 [00:32<02:24, 11.02it/s, est. speed input: 14420.41 toks/s, output: 14.08 toks/s]
Processed prompts:  22%|██▏       | 455/2048 [00:32<02:24, 11.02it/s, est. speed input: 14394.13 toks/s, output: 14.06 toks/s]
Processed prompts:  22%|██▏       | 458/2048 [00:32<02:24, 11.02it/s, est. speed input: 14368.19 toks/s, output: 14.03 toks/s]
Processed prompts:  23%|██▎       | 461/2048 [00:32<02:24, 11.02it/s, est. speed input: 14342.54 toks/s, output: 14.01 toks/s]
Processed prompts:  23%|██▎       | 464/2048 [00:33<02:23, 11.02it/s, est. speed input: 14317.48 toks/s, output: 13.98 toks/s]
Processed prompts:  23%|██▎       | 467/2048 [00:33<02:23, 11.02it/s, est. speed input: 14292.86 toks/s, output: 13.96 toks/s]
Processed prompts:  23%|██▎       | 470/2048 [00:33<02:23, 11.01it/s, est. speed input: 14268.38 toks/s, output: 13.93 toks/s]
Processed prompts:  23%|██▎       | 473/2048 [00:34<02:22, 11.02it/s, est. speed input: 14244.47 toks/s, output: 13.91 toks/s]
Processed prompts:  23%|██▎       | 476/2048 [00:34<02:22, 11.01it/s, est. speed input: 14220.88 toks/s, output: 13.89 toks/s]
Processed prompts:  23%|██▎       | 479/2048 [00:34<02:22, 11.01it/s, est. speed input: 14197.57 toks/s, output: 13.86 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [00:34<02:22, 11.01it/s, est. speed input: 14174.60 toks/s, output: 13.84 toks/s]
Processed prompts:  24%|██▎       | 485/2048 [00:35<02:21, 11.01it/s, est. speed input: 14152.07 toks/s, output: 13.82 toks/s]
Processed prompts:  24%|██▍       | 488/2048 [00:35<02:21, 11.01it/s, est. speed input: 14130.09 toks/s, output: 13.80 toks/s]
Processed prompts:  24%|██▍       | 491/2048 [00:35<02:21, 11.02it/s, est. speed input: 14108.45 toks/s, output: 13.78 toks/s]
Processed prompts:  24%|██▍       | 494/2048 [00:35<02:21, 11.02it/s, est. speed input: 14087.02 toks/s, output: 13.76 toks/s]
Processed prompts:  24%|██▍       | 497/2048 [00:36<02:20, 11.02it/s, est. speed input: 14066.04 toks/s, output: 13.74 toks/s]
Processed prompts:  24%|██▍       | 500/2048 [00:36<02:20, 11.02it/s, est. speed input: 14045.20 toks/s, output: 13.72 toks/s]
Processed prompts:  25%|██▍       | 503/2048 [00:36<02:20, 11.02it/s, est. speed input: 14024.77 toks/s, output: 13.70 toks/s]
Processed prompts:  25%|██▍       | 506/2048 [00:36<02:19, 11.02it/s, est. speed input: 14004.53 toks/s, output: 13.68 toks/s]
Processed prompts:  25%|██▍       | 509/2048 [00:37<02:19, 11.02it/s, est. speed input: 13984.66 toks/s, output: 13.66 toks/s]
Processed prompts:  25%|██▌       | 512/2048 [00:37<02:19, 11.01it/s, est. speed input: 13964.91 toks/s, output: 13.64 toks/s]
Processed prompts:  25%|██▌       | 515/2048 [00:37<02:19, 11.01it/s, est. speed input: 13945.49 toks/s, output: 13.62 toks/s]
Processed prompts:  25%|██▌       | 518/2048 [00:38<02:18, 11.01it/s, est. speed input: 13926.39 toks/s, output: 13.60 toks/s]
Processed prompts:  25%|██▌       | 521/2048 [00:38<02:18, 11.01it/s, est. speed input: 13907.62 toks/s, output: 13.58 toks/s]
Processed prompts:  26%|██▋       | 539/2048 [00:38<00:51, 29.19it/s, est. speed input: 14305.71 toks/s, output: 13.97 toks/s]
Processed prompts:  27%|██▋       | 543/2048 [00:38<01:01, 24.65it/s, est. speed input: 14310.75 toks/s, output: 13.98 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [00:39<01:13, 20.44it/s, est. speed input: 14289.59 toks/s, output: 13.95 toks/s]
Processed prompts:  27%|██▋       | 549/2048 [00:39<01:25, 17.55it/s, est. speed input: 14268.70 toks/s, output: 13.93 toks/s]
Processed prompts:  27%|██▋       | 551/2048 [00:39<01:43, 14.45it/s, est. speed input: 14222.41 toks/s, output: 13.89 toks/s]
Processed prompts:  27%|██▋       | 554/2048 [00:39<01:51, 13.41it/s, est. speed input: 14202.41 toks/s, output: 13.87 toks/s]
Processed prompts:  27%|██▋       | 557/2048 [00:40<01:57, 12.69it/s, est. speed input: 14182.71 toks/s, output: 13.85 toks/s]
Processed prompts:  27%|██▋       | 560/2048 [00:40<02:02, 12.19it/s, est. speed input: 14163.34 toks/s, output: 13.83 toks/s]
Processed prompts:  27%|██▋       | 563/2048 [00:40<02:05, 11.84it/s, est. speed input: 14144.22 toks/s, output: 13.81 toks/s]
Processed prompts:  28%|██▊       | 566/2048 [00:41<02:07, 11.59it/s, est. speed input: 14125.16 toks/s, output: 13.79 toks/s]
Processed prompts:  28%|██▊       | 569/2048 [00:41<02:09, 11.42it/s, est. speed input: 14106.48 toks/s, output: 13.78 toks/s]
Processed prompts:  28%|██▊       | 572/2048 [00:41<02:10, 11.30it/s, est. speed input: 14087.95 toks/s, output: 13.76 toks/s]
Processed prompts:  28%|██▊       | 575/2048 [00:41<02:11, 11.21it/s, est. speed input: 14069.56 toks/s, output: 13.74 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [00:42<02:11, 11.15it/s, est. speed input: 14051.48 toks/s, output: 13.72 toks/s]
Processed prompts:  28%|██▊       | 581/2048 [00:42<02:12, 11.11it/s, est. speed input: 14033.56 toks/s, output: 13.70 toks/s]
Processed prompts:  29%|██▊       | 584/2048 [00:42<02:12, 11.08it/s, est. speed input: 14015.95 toks/s, output: 13.69 toks/s]
Processed prompts:  29%|██▊       | 587/2048 [00:42<02:12, 11.06it/s, est. speed input: 13998.59 toks/s, output: 13.67 toks/s]
Processed prompts:  29%|██▉       | 590/2048 [00:43<02:12, 11.04it/s, est. speed input: 13981.31 toks/s, output: 13.65 toks/s]
Processed prompts:  29%|██▉       | 593/2048 [00:43<02:11, 11.03it/s, est. speed input: 13964.35 toks/s, output: 13.64 toks/s]
Processed prompts:  29%|██▉       | 596/2048 [00:43<02:11, 11.03it/s, est. speed input: 13947.62 toks/s, output: 13.62 toks/s]
Processed prompts:  29%|██▉       | 599/2048 [00:44<02:11, 11.02it/s, est. speed input: 13931.09 toks/s, output: 13.60 toks/s]
Processed prompts:  29%|██▉       | 602/2048 [00:44<02:11, 11.01it/s, est. speed input: 13914.65 toks/s, output: 13.59 toks/s]
Processed prompts:  30%|██▉       | 605/2048 [00:44<02:11, 11.01it/s, est. speed input: 13898.53 toks/s, output: 13.57 toks/s]
Processed prompts:  30%|██▉       | 608/2048 [00:44<02:10, 11.01it/s, est. speed input: 13882.47 toks/s, output: 13.56 toks/s]
Processed prompts:  30%|██▉       | 611/2048 [00:45<02:10, 11.01it/s, est. speed input: 13866.67 toks/s, output: 13.54 toks/s]
Processed prompts:  30%|██▉       | 614/2048 [00:45<02:10, 11.01it/s, est. speed input: 13851.09 toks/s, output: 13.53 toks/s]
Processed prompts:  30%|███       | 617/2048 [00:45<02:09, 11.01it/s, est. speed input: 13835.72 toks/s, output: 13.51 toks/s]
Processed prompts:  30%|███       | 620/2048 [00:45<02:09, 11.01it/s, est. speed input: 13820.48 toks/s, output: 13.50 toks/s]
Processed prompts:  30%|███       | 623/2048 [00:46<02:09, 11.01it/s, est. speed input: 13805.46 toks/s, output: 13.48 toks/s]
Processed prompts:  31%|███       | 626/2048 [00:46<02:09, 11.01it/s, est. speed input: 13790.61 toks/s, output: 13.47 toks/s]
Processed prompts:  31%|███       | 629/2048 [00:46<02:08, 11.01it/s, est. speed input: 13776.00 toks/s, output: 13.45 toks/s]
Processed prompts:  31%|███       | 632/2048 [00:47<02:08, 11.01it/s, est. speed input: 13761.58 toks/s, output: 13.44 toks/s]
Processed prompts:  31%|███       | 635/2048 [00:47<02:08, 11.01it/s, est. speed input: 13747.23 toks/s, output: 13.43 toks/s]
Processed prompts:  31%|███       | 638/2048 [00:47<02:08, 11.01it/s, est. speed input: 13733.04 toks/s, output: 13.41 toks/s]
Processed prompts:  31%|███▏      | 641/2048 [00:47<02:07, 11.01it/s, est. speed input: 13719.06 toks/s, output: 13.40 toks/s]
Processed prompts:  31%|███▏      | 644/2048 [00:48<02:07, 11.01it/s, est. speed input: 13705.11 toks/s, output: 13.38 toks/s]
Processed prompts:  32%|███▏      | 647/2048 [00:48<02:07, 11.01it/s, est. speed input: 13691.38 toks/s, output: 13.37 toks/s]
Processed prompts:  32%|███▏      | 650/2048 [00:48<02:07, 11.00it/s, est. speed input: 13677.79 toks/s, output: 13.36 toks/s]
Processed prompts:  32%|███▏      | 653/2048 [00:48<02:06, 11.01it/s, est. speed input: 13664.39 toks/s, output: 13.34 toks/s]
Processed prompts:  32%|███▏      | 656/2048 [00:49<02:06, 11.00it/s, est. speed input: 13651.10 toks/s, output: 13.33 toks/s]
Processed prompts:  32%|███▏      | 659/2048 [00:49<02:06, 11.01it/s, est. speed input: 13637.99 toks/s, output: 13.32 toks/s]
Processed prompts:  32%|███▏      | 662/2048 [00:49<02:05, 11.01it/s, est. speed input: 13625.05 toks/s, output: 13.31 toks/s]
Processed prompts:  32%|███▏      | 665/2048 [00:50<02:05, 11.01it/s, est. speed input: 13612.27 toks/s, output: 13.29 toks/s]
Processed prompts:  33%|███▎      | 668/2048 [00:50<02:05, 11.01it/s, est. speed input: 13599.54 toks/s, output: 13.28 toks/s]
Processed prompts:  33%|███▎      | 671/2048 [00:50<02:05, 11.01it/s, est. speed input: 13587.12 toks/s, output: 13.27 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [00:50<02:04, 11.02it/s, est. speed input: 13574.85 toks/s, output: 13.26 toks/s]
Processed prompts:  33%|███▎      | 677/2048 [00:51<02:04, 11.01it/s, est. speed input: 13562.54 toks/s, output: 13.24 toks/s]
Processed prompts:  33%|███▎      | 680/2048 [00:51<02:04, 11.01it/s, est. speed input: 13550.41 toks/s, output: 13.23 toks/s]
Processed prompts:  33%|███▎      | 683/2048 [00:51<02:03, 11.01it/s, est. speed input: 13538.39 toks/s, output: 13.22 toks/s]
Processed prompts:  33%|███▎      | 686/2048 [00:51<02:03, 11.01it/s, est. speed input: 13526.44 toks/s, output: 13.21 toks/s]
Processed prompts:  34%|███▎      | 689/2048 [00:52<02:03, 11.01it/s, est. speed input: 13514.67 toks/s, output: 13.20 toks/s]
Processed prompts:  34%|███▍      | 692/2048 [00:52<02:03, 11.01it/s, est. speed input: 13503.03 toks/s, output: 13.19 toks/s]
Processed prompts:  34%|███▍      | 695/2048 [00:52<02:02, 11.01it/s, est. speed input: 13491.63 toks/s, output: 13.18 toks/s]
Processed prompts:  34%|███▍      | 698/2048 [00:53<02:02, 11.02it/s, est. speed input: 13480.32 toks/s, output: 13.16 toks/s]
Processed prompts:  34%|███▍      | 701/2048 [00:53<02:02, 11.01it/s, est. speed input: 13468.96 toks/s, output: 13.15 toks/s]
Processed prompts:  34%|███▍      | 704/2048 [00:53<02:02, 11.01it/s, est. speed input: 13457.86 toks/s, output: 13.14 toks/s]
Processed prompts:  35%|███▍      | 707/2048 [00:53<02:01, 11.01it/s, est. speed input: 13446.86 toks/s, output: 13.13 toks/s]
Processed prompts:  35%|███▍      | 710/2048 [00:54<02:01, 11.01it/s, est. speed input: 13435.90 toks/s, output: 13.12 toks/s]
Processed prompts:  35%|███▍      | 713/2048 [00:54<02:01, 11.01it/s, est. speed input: 13425.05 toks/s, output: 13.11 toks/s]
Processed prompts:  35%|███▍      | 716/2048 [00:54<02:01, 11.01it/s, est. speed input: 13414.27 toks/s, output: 13.10 toks/s]
Processed prompts:  35%|███▌      | 719/2048 [00:54<02:00, 11.00it/s, est. speed input: 13403.56 toks/s, output: 13.09 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [00:55<02:00, 11.00it/s, est. speed input: 13392.99 toks/s, output: 13.08 toks/s]
Processed prompts:  35%|███▌      | 725/2048 [00:55<02:00, 11.00it/s, est. speed input: 13382.58 toks/s, output: 13.07 toks/s]
Processed prompts:  36%|███▌      | 728/2048 [00:55<01:59, 11.01it/s, est. speed input: 13372.40 toks/s, output: 13.06 toks/s]
Processed prompts:  36%|███▌      | 731/2048 [00:56<01:59, 11.02it/s, est. speed input: 13362.31 toks/s, output: 13.05 toks/s]
Processed prompts:  36%|███▌      | 734/2048 [00:56<01:59, 11.02it/s, est. speed input: 13352.21 toks/s, output: 13.04 toks/s]
Processed prompts:  36%|███▌      | 737/2048 [00:56<01:59, 11.02it/s, est. speed input: 13342.23 toks/s, output: 13.03 toks/s]
Processed prompts:  36%|███▌      | 740/2048 [00:56<01:58, 11.02it/s, est. speed input: 13332.42 toks/s, output: 13.02 toks/s]
Processed prompts:  36%|███▋      | 743/2048 [00:57<01:58, 11.02it/s, est. speed input: 13322.60 toks/s, output: 13.01 toks/s]
Processed prompts:  36%|███▋      | 746/2048 [00:57<01:58, 11.01it/s, est. speed input: 13312.83 toks/s, output: 13.00 toks/s]
Processed prompts:  37%|███▋      | 749/2048 [00:57<01:57, 11.01it/s, est. speed input: 13303.18 toks/s, output: 12.99 toks/s]
Processed prompts:  37%|███▋      | 752/2048 [00:57<01:57, 11.01it/s, est. speed input: 13293.60 toks/s, output: 12.98 toks/s]
Processed prompts:  37%|███▋      | 755/2048 [00:58<01:57, 11.01it/s, est. speed input: 13284.14 toks/s, output: 12.97 toks/s]
Processed prompts:  37%|███▋      | 758/2048 [00:58<01:57, 11.01it/s, est. speed input: 13274.78 toks/s, output: 12.96 toks/s]
Processed prompts:  37%|███▋      | 761/2048 [00:58<01:56, 11.01it/s, est. speed input: 13265.42 toks/s, output: 12.95 toks/s]
Processed prompts:  37%|███▋      | 764/2048 [00:59<01:56, 11.01it/s, est. speed input: 13256.30 toks/s, output: 12.95 toks/s]
Processed prompts:  37%|███▋      | 767/2048 [00:59<01:56, 11.01it/s, est. speed input: 13247.13 toks/s, output: 12.94 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [00:59<01:56, 11.00it/s, est. speed input: 13238.03 toks/s, output: 12.93 toks/s]
Processed prompts:  38%|███▊      | 773/2048 [00:59<01:55, 11.01it/s, est. speed input: 13229.08 toks/s, output: 12.92 toks/s]
Processed prompts:  38%|███▊      | 776/2048 [01:00<01:55, 11.01it/s, est. speed input: 13220.25 toks/s, output: 12.91 toks/s]
Processed prompts:  38%|███▊      | 779/2048 [01:00<01:55, 11.01it/s, est. speed input: 13211.45 toks/s, output: 12.90 toks/s]
Processed prompts:  38%|███▊      | 782/2048 [01:00<01:55, 11.00it/s, est. speed input: 13202.64 toks/s, output: 12.89 toks/s]
Processed prompts:  38%|███▊      | 785/2048 [01:00<01:54, 11.00it/s, est. speed input: 13193.96 toks/s, output: 12.88 toks/s]
Processed prompts:  38%|███▊      | 788/2048 [01:01<01:54, 11.00it/s, est. speed input: 13185.38 toks/s, output: 12.88 toks/s]
Processed prompts:  39%|███▊      | 791/2048 [01:01<01:54, 11.00it/s, est. speed input: 13176.79 toks/s, output: 12.87 toks/s]
Processed prompts:  39%|███▉      | 794/2048 [01:01<01:53, 11.00it/s, est. speed input: 13168.37 toks/s, output: 12.86 toks/s]
Processed prompts:  39%|███▉      | 797/2048 [01:02<01:53, 11.00it/s, est. speed input: 13160.04 toks/s, output: 12.85 toks/s]
Processed prompts:  39%|███▉      | 800/2048 [01:02<01:53, 11.00it/s, est. speed input: 13151.77 toks/s, output: 12.84 toks/s]
Processed prompts:  39%|███▉      | 803/2048 [01:02<01:53, 11.00it/s, est. speed input: 13143.56 toks/s, output: 12.84 toks/s]
Processed prompts:  39%|███▉      | 806/2048 [01:02<01:52, 11.00it/s, est. speed input: 13135.40 toks/s, output: 12.83 toks/s]
Processed prompts:  40%|███▉      | 809/2048 [01:03<01:52, 11.00it/s, est. speed input: 13127.37 toks/s, output: 12.82 toks/s]
Processed prompts:  40%|███▉      | 812/2048 [01:03<01:52, 11.00it/s, est. speed input: 13119.37 toks/s, output: 12.81 toks/s]
Processed prompts:  40%|███▉      | 815/2048 [01:03<01:52, 11.00it/s, est. speed input: 13111.37 toks/s, output: 12.80 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [01:03<01:51, 11.00it/s, est. speed input: 13103.47 toks/s, output: 12.80 toks/s]
Processed prompts:  40%|████      | 821/2048 [01:04<01:51, 11.00it/s, est. speed input: 13095.66 toks/s, output: 12.79 toks/s]
Processed prompts:  40%|████      | 824/2048 [01:04<01:51, 11.00it/s, est. speed input: 13087.91 toks/s, output: 12.78 toks/s]
Processed prompts:  40%|████      | 827/2048 [01:04<01:51, 11.00it/s, est. speed input: 13080.21 toks/s, output: 12.77 toks/s]
Processed prompts:  41%|████      | 830/2048 [01:05<01:50, 11.00it/s, est. speed input: 13072.61 toks/s, output: 12.77 toks/s]
Processed prompts:  41%|████      | 833/2048 [01:05<01:50, 11.00it/s, est. speed input: 13065.06 toks/s, output: 12.76 toks/s]
Processed prompts:  41%|████      | 836/2048 [01:05<01:50, 11.00it/s, est. speed input: 13057.58 toks/s, output: 12.75 toks/s]
Processed prompts:  41%|████      | 839/2048 [01:05<01:49, 11.00it/s, est. speed input: 13050.21 toks/s, output: 12.74 toks/s]
Processed prompts:  41%|████      | 842/2048 [01:06<01:49, 11.00it/s, est. speed input: 13042.85 toks/s, output: 12.74 toks/s]
Processed prompts:  41%|████▏     | 845/2048 [01:06<01:49, 11.01it/s, est. speed input: 13035.61 toks/s, output: 12.73 toks/s]
Processed prompts:  41%|████▏     | 848/2048 [01:06<01:49, 11.00it/s, est. speed input: 13028.35 toks/s, output: 12.72 toks/s]
Processed prompts:  42%|████▏     | 851/2048 [01:06<01:48, 11.00it/s, est. speed input: 13021.10 toks/s, output: 12.72 toks/s]
Processed prompts:  42%|████▏     | 854/2048 [01:07<01:48, 11.00it/s, est. speed input: 13013.97 toks/s, output: 12.71 toks/s]
Processed prompts:  42%|████▏     | 857/2048 [01:07<01:48, 10.99it/s, est. speed input: 13006.81 toks/s, output: 12.70 toks/s]
Processed prompts:  42%|████▏     | 860/2048 [01:07<01:48, 10.99it/s, est. speed input: 12999.77 toks/s, output: 12.70 toks/s]
Processed prompts:  42%|████▏     | 863/2048 [01:08<01:47, 11.00it/s, est. speed input: 12992.86 toks/s, output: 12.69 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [01:08<01:47, 11.01it/s, est. speed input: 12986.05 toks/s, output: 12.68 toks/s]
Processed prompts:  42%|████▏     | 869/2048 [01:08<01:47, 11.01it/s, est. speed input: 12979.22 toks/s, output: 12.68 toks/s]
Processed prompts:  43%|████▎     | 872/2048 [01:08<01:46, 11.01it/s, est. speed input: 12972.46 toks/s, output: 12.67 toks/s]
Processed prompts:  43%|████▎     | 875/2048 [01:09<01:46, 11.00it/s, est. speed input: 12965.71 toks/s, output: 12.66 toks/s]
Processed prompts:  43%|████▎     | 878/2048 [01:09<01:46, 11.00it/s, est. speed input: 12959.03 toks/s, output: 12.66 toks/s]
Processed prompts:  44%|████▍     | 896/2048 [01:09<00:39, 28.90it/s, est. speed input: 13181.19 toks/s, output: 12.87 toks/s]
Processed prompts:  44%|████▍     | 900/2048 [01:09<00:46, 24.49it/s, est. speed input: 13188.42 toks/s, output: 12.88 toks/s]
Processed prompts:  44%|████▍     | 903/2048 [01:10<00:56, 20.34it/s, est. speed input: 13180.93 toks/s, output: 12.87 toks/s]
Processed prompts:  44%|████▍     | 906/2048 [01:10<01:05, 17.50it/s, est. speed input: 13173.56 toks/s, output: 12.86 toks/s]
Processed prompts:  44%|████▍     | 908/2048 [01:10<01:19, 14.41it/s, est. speed input: 13151.76 toks/s, output: 12.84 toks/s]
Processed prompts:  44%|████▍     | 911/2048 [01:10<01:24, 13.38it/s, est. speed input: 13144.54 toks/s, output: 12.84 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [01:11<01:29, 12.67it/s, est. speed input: 13137.38 toks/s, output: 12.83 toks/s]
Processed prompts:  45%|████▍     | 917/2048 [01:11<01:32, 12.16it/s, est. speed input: 13130.22 toks/s, output: 12.82 toks/s]
Processed prompts:  45%|████▍     | 920/2048 [01:11<01:35, 11.81it/s, est. speed input: 13123.11 toks/s, output: 12.82 toks/s]
Processed prompts:  45%|████▌     | 923/2048 [01:12<01:37, 11.57it/s, est. speed input: 13116.06 toks/s, output: 12.81 toks/s]
Processed prompts:  45%|████▌     | 926/2048 [01:12<01:38, 11.40it/s, est. speed input: 13109.07 toks/s, output: 12.80 toks/s]
Processed prompts:  45%|████▌     | 929/2048 [01:12<01:39, 11.27it/s, est. speed input: 13102.10 toks/s, output: 12.80 toks/s]
Processed prompts:  46%|████▌     | 932/2048 [01:12<01:39, 11.19it/s, est. speed input: 13095.22 toks/s, output: 12.79 toks/s]
Processed prompts:  46%|████▌     | 935/2048 [01:13<01:39, 11.13it/s, est. speed input: 13088.36 toks/s, output: 12.78 toks/s]
Processed prompts:  46%|████▌     | 938/2048 [01:13<01:40, 11.10it/s, est. speed input: 13081.63 toks/s, output: 12.78 toks/s]
Processed prompts:  46%|████▌     | 941/2048 [01:13<01:40, 11.07it/s, est. speed input: 13074.92 toks/s, output: 12.77 toks/s]
Processed prompts:  46%|████▌     | 944/2048 [01:13<01:39, 11.05it/s, est. speed input: 13068.29 toks/s, output: 12.76 toks/s]
Processed prompts:  46%|████▌     | 947/2048 [01:14<01:39, 11.03it/s, est. speed input: 13061.63 toks/s, output: 12.76 toks/s]
Processed prompts:  46%|████▋     | 950/2048 [01:14<01:39, 11.02it/s, est. speed input: 13055.06 toks/s, output: 12.75 toks/s]
Processed prompts:  47%|████▋     | 953/2048 [01:14<01:39, 11.02it/s, est. speed input: 13048.55 toks/s, output: 12.74 toks/s]
Processed prompts:  47%|████▋     | 956/2048 [01:15<01:39, 11.01it/s, est. speed input: 13041.97 toks/s, output: 12.74 toks/s]
Processed prompts:  47%|████▋     | 959/2048 [01:15<01:38, 11.00it/s, est. speed input: 13035.49 toks/s, output: 12.73 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [01:15<01:38, 11.00it/s, est. speed input: 13029.09 toks/s, output: 12.72 toks/s]
Processed prompts:  47%|████▋     | 965/2048 [01:15<01:38, 11.00it/s, est. speed input: 13022.78 toks/s, output: 12.72 toks/s]
Processed prompts:  47%|████▋     | 968/2048 [01:16<01:38, 11.00it/s, est. speed input: 13016.43 toks/s, output: 12.71 toks/s]
Processed prompts:  47%|████▋     | 971/2048 [01:16<01:37, 11.00it/s, est. speed input: 13010.19 toks/s, output: 12.71 toks/s]
Processed prompts:  48%|████▊     | 974/2048 [01:16<01:37, 11.00it/s, est. speed input: 13003.97 toks/s, output: 12.70 toks/s]
Processed prompts:  48%|████▊     | 977/2048 [01:16<01:37, 11.00it/s, est. speed input: 12997.81 toks/s, output: 12.69 toks/s]
Processed prompts:  48%|████▊     | 980/2048 [01:17<01:37, 11.00it/s, est. speed input: 12991.70 toks/s, output: 12.69 toks/s]
Processed prompts:  48%|████▊     | 983/2048 [01:17<01:36, 11.00it/s, est. speed input: 12985.65 toks/s, output: 12.68 toks/s]
Processed prompts:  48%|████▊     | 986/2048 [01:17<01:36, 11.00it/s, est. speed input: 12979.56 toks/s, output: 12.68 toks/s]
Processed prompts:  48%|████▊     | 989/2048 [01:18<01:36, 10.99it/s, est. speed input: 12973.51 toks/s, output: 12.67 toks/s]
Processed prompts:  48%|████▊     | 992/2048 [01:18<01:36, 10.99it/s, est. speed input: 12967.54 toks/s, output: 12.66 toks/s]
Processed prompts:  49%|████▊     | 995/2048 [01:18<01:35, 10.99it/s, est. speed input: 12961.57 toks/s, output: 12.66 toks/s]
Processed prompts:  49%|████▊     | 998/2048 [01:18<01:35, 11.00it/s, est. speed input: 12955.71 toks/s, output: 12.65 toks/s]
Processed prompts:  49%|████▉     | 1001/2048 [01:19<01:35, 11.00it/s, est. speed input: 12949.92 toks/s, output: 12.65 toks/s]
Processed prompts:  49%|████▉     | 1004/2048 [01:19<01:34, 11.00it/s, est. speed input: 12944.10 toks/s, output: 12.64 toks/s]
Processed prompts:  49%|████▉     | 1007/2048 [01:19<01:34, 11.00it/s, est. speed input: 12938.37 toks/s, output: 12.64 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [01:19<01:34, 11.00it/s, est. speed input: 12932.62 toks/s, output: 12.63 toks/s]
Processed prompts:  49%|████▉     | 1013/2048 [01:20<01:34, 11.00it/s, est. speed input: 12927.02 toks/s, output: 12.62 toks/s]
Processed prompts:  50%|████▉     | 1016/2048 [01:20<01:33, 11.01it/s, est. speed input: 12921.47 toks/s, output: 12.62 toks/s]
Processed prompts:  50%|████▉     | 1019/2048 [01:20<01:33, 11.01it/s, est. speed input: 12915.92 toks/s, output: 12.61 toks/s]
Processed prompts:  50%|████▉     | 1022/2048 [01:21<01:33, 11.01it/s, est. speed input: 12910.36 toks/s, output: 12.61 toks/s]
Processed prompts:  50%|█████     | 1025/2048 [01:21<01:32, 11.00it/s, est. speed input: 12904.82 toks/s, output: 12.60 toks/s]
Processed prompts:  50%|█████     | 1028/2048 [01:21<01:32, 11.00it/s, est. speed input: 12899.30 toks/s, output: 12.60 toks/s]
Processed prompts:  50%|█████     | 1031/2048 [01:21<01:32, 11.00it/s, est. speed input: 12893.85 toks/s, output: 12.59 toks/s]
Processed prompts:  50%|█████     | 1034/2048 [01:22<01:32, 11.00it/s, est. speed input: 12888.44 toks/s, output: 12.59 toks/s]
Processed prompts:  51%|█████     | 1037/2048 [01:22<01:31, 11.00it/s, est. speed input: 12883.10 toks/s, output: 12.58 toks/s]
Processed prompts:  51%|█████     | 1040/2048 [01:22<01:31, 11.00it/s, est. speed input: 12877.80 toks/s, output: 12.58 toks/s]
Processed prompts:  51%|█████     | 1043/2048 [01:22<01:31, 11.00it/s, est. speed input: 12872.48 toks/s, output: 12.57 toks/s]
Processed prompts:  51%|█████     | 1046/2048 [01:23<01:31, 11.00it/s, est. speed input: 12867.19 toks/s, output: 12.57 toks/s]
Processed prompts:  51%|█████     | 1049/2048 [01:23<01:30, 11.00it/s, est. speed input: 12861.97 toks/s, output: 12.56 toks/s]
Processed prompts:  51%|█████▏    | 1052/2048 [01:23<01:30, 11.00it/s, est. speed input: 12856.78 toks/s, output: 12.56 toks/s]
Processed prompts:  52%|█████▏    | 1055/2048 [01:24<01:30, 11.00it/s, est. speed input: 12851.64 toks/s, output: 12.55 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [01:24<01:30, 11.00it/s, est. speed input: 12846.48 toks/s, output: 12.55 toks/s]
Processed prompts:  52%|█████▏    | 1061/2048 [01:24<01:29, 11.00it/s, est. speed input: 12841.36 toks/s, output: 12.54 toks/s]
Processed prompts:  52%|█████▏    | 1064/2048 [01:24<01:29, 11.00it/s, est. speed input: 12836.28 toks/s, output: 12.54 toks/s]
Processed prompts:  52%|█████▏    | 1067/2048 [01:25<01:29, 11.00it/s, est. speed input: 12831.23 toks/s, output: 12.53 toks/s]
Processed prompts:  52%|█████▏    | 1070/2048 [01:25<01:28, 11.00it/s, est. speed input: 12826.23 toks/s, output: 12.53 toks/s]
Processed prompts:  52%|█████▏    | 1073/2048 [01:25<01:28, 11.00it/s, est. speed input: 12821.30 toks/s, output: 12.52 toks/s]
Processed prompts:  53%|█████▎    | 1076/2048 [01:25<01:28, 11.00it/s, est. speed input: 12816.37 toks/s, output: 12.52 toks/s]
Processed prompts:  53%|█████▎    | 1079/2048 [01:26<01:28, 11.00it/s, est. speed input: 12811.47 toks/s, output: 12.51 toks/s]
Processed prompts:  53%|█████▎    | 1082/2048 [01:26<01:27, 11.00it/s, est. speed input: 12806.60 toks/s, output: 12.51 toks/s]
Processed prompts:  53%|█████▎    | 1085/2048 [01:26<01:27, 11.00it/s, est. speed input: 12801.78 toks/s, output: 12.50 toks/s]
Processed prompts:  53%|█████▎    | 1088/2048 [01:27<01:27, 11.00it/s, est. speed input: 12796.93 toks/s, output: 12.50 toks/s]
Processed prompts:  53%|█████▎    | 1091/2048 [01:27<01:26, 11.00it/s, est. speed input: 12792.20 toks/s, output: 12.49 toks/s]
Processed prompts:  53%|█████▎    | 1094/2048 [01:27<01:26, 11.01it/s, est. speed input: 12787.47 toks/s, output: 12.49 toks/s]
Processed prompts:  54%|█████▎    | 1097/2048 [01:27<01:26, 11.00it/s, est. speed input: 12782.72 toks/s, output: 12.48 toks/s]
Processed prompts:  54%|█████▎    | 1100/2048 [01:28<01:26, 11.00it/s, est. speed input: 12777.98 toks/s, output: 12.48 toks/s]
Processed prompts:  54%|█████▍    | 1103/2048 [01:28<01:25, 11.00it/s, est. speed input: 12773.33 toks/s, output: 12.47 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [01:28<01:25, 11.00it/s, est. speed input: 12768.70 toks/s, output: 12.47 toks/s]
Processed prompts:  54%|█████▍    | 1109/2048 [01:28<01:25, 11.00it/s, est. speed input: 12764.11 toks/s, output: 12.46 toks/s]
Processed prompts:  54%|█████▍    | 1112/2048 [01:29<01:25, 11.00it/s, est. speed input: 12759.51 toks/s, output: 12.46 toks/s]
Processed prompts:  54%|█████▍    | 1115/2048 [01:29<01:24, 11.00it/s, est. speed input: 12754.90 toks/s, output: 12.46 toks/s]
Processed prompts:  55%|█████▍    | 1118/2048 [01:29<01:24, 11.00it/s, est. speed input: 12750.38 toks/s, output: 12.45 toks/s]
Processed prompts:  55%|█████▍    | 1121/2048 [01:30<01:24, 11.00it/s, est. speed input: 12745.90 toks/s, output: 12.45 toks/s]
Processed prompts:  55%|█████▍    | 1124/2048 [01:30<01:23, 11.00it/s, est. speed input: 12741.44 toks/s, output: 12.44 toks/s]
Processed prompts:  55%|█████▌    | 1127/2048 [01:30<01:23, 11.00it/s, est. speed input: 12736.94 toks/s, output: 12.44 toks/s]
Processed prompts:  55%|█████▌    | 1130/2048 [01:30<01:23, 10.99it/s, est. speed input: 12732.47 toks/s, output: 12.43 toks/s]
Processed prompts:  55%|█████▌    | 1133/2048 [01:31<01:23, 10.99it/s, est. speed input: 12728.05 toks/s, output: 12.43 toks/s]
Processed prompts:  55%|█████▌    | 1136/2048 [01:31<01:22, 10.99it/s, est. speed input: 12723.64 toks/s, output: 12.43 toks/s]
Processed prompts:  56%|█████▌    | 1139/2048 [01:31<01:22, 10.99it/s, est. speed input: 12719.23 toks/s, output: 12.42 toks/s]
Processed prompts:  56%|█████▌    | 1142/2048 [01:31<01:22, 10.99it/s, est. speed input: 12714.89 toks/s, output: 12.42 toks/s]
Processed prompts:  56%|█████▌    | 1145/2048 [01:32<01:22, 11.00it/s, est. speed input: 12710.64 toks/s, output: 12.41 toks/s]
Processed prompts:  56%|█████▌    | 1148/2048 [01:32<01:21, 11.00it/s, est. speed input: 12706.39 toks/s, output: 12.41 toks/s]
Processed prompts:  56%|█████▌    | 1151/2048 [01:32<01:21, 11.00it/s, est. speed input: 12702.13 toks/s, output: 12.40 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [01:33<01:21, 11.00it/s, est. speed input: 12697.94 toks/s, output: 12.40 toks/s]
Processed prompts:  56%|█████▋    | 1157/2048 [01:33<01:21, 11.00it/s, est. speed input: 12693.73 toks/s, output: 12.40 toks/s]
Processed prompts:  57%|█████▋    | 1160/2048 [01:33<01:20, 11.00it/s, est. speed input: 12689.58 toks/s, output: 12.39 toks/s]
Processed prompts:  57%|█████▋    | 1163/2048 [01:33<01:20, 11.00it/s, est. speed input: 12685.43 toks/s, output: 12.39 toks/s]
Processed prompts:  57%|█████▋    | 1166/2048 [01:34<01:20, 11.00it/s, est. speed input: 12681.31 toks/s, output: 12.38 toks/s]
Processed prompts:  57%|█████▋    | 1169/2048 [01:34<01:19, 11.00it/s, est. speed input: 12677.22 toks/s, output: 12.38 toks/s]
Processed prompts:  57%|█████▋    | 1172/2048 [01:34<01:19, 11.00it/s, est. speed input: 12673.13 toks/s, output: 12.38 toks/s]
Processed prompts:  57%|█████▋    | 1175/2048 [01:34<01:19, 11.00it/s, est. speed input: 12669.06 toks/s, output: 12.37 toks/s]
Processed prompts:  58%|█████▊    | 1178/2048 [01:35<01:19, 10.99it/s, est. speed input: 12665.00 toks/s, output: 12.37 toks/s]
Processed prompts:  58%|█████▊    | 1181/2048 [01:35<01:18, 11.00it/s, est. speed input: 12661.00 toks/s, output: 12.36 toks/s]
Processed prompts:  58%|█████▊    | 1184/2048 [01:35<01:18, 11.00it/s, est. speed input: 12657.04 toks/s, output: 12.36 toks/s]
Processed prompts:  58%|█████▊    | 1187/2048 [01:36<01:18, 11.00it/s, est. speed input: 12653.12 toks/s, output: 12.36 toks/s]
Processed prompts:  58%|█████▊    | 1190/2048 [01:36<01:17, 11.01it/s, est. speed input: 12649.23 toks/s, output: 12.35 toks/s]
Processed prompts:  58%|█████▊    | 1193/2048 [01:36<01:17, 11.01it/s, est. speed input: 12645.34 toks/s, output: 12.35 toks/s]
Processed prompts:  58%|█████▊    | 1196/2048 [01:36<01:17, 11.00it/s, est. speed input: 12641.43 toks/s, output: 12.35 toks/s]
Processed prompts:  59%|█████▊    | 1199/2048 [01:37<01:17, 11.00it/s, est. speed input: 12637.55 toks/s, output: 12.34 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [01:37<01:16, 11.00it/s, est. speed input: 12633.66 toks/s, output: 12.34 toks/s]
Processed prompts:  59%|█████▉    | 1205/2048 [01:37<01:16, 11.00it/s, est. speed input: 12629.83 toks/s, output: 12.33 toks/s]
Processed prompts:  59%|█████▉    | 1208/2048 [01:37<01:16, 11.00it/s, est. speed input: 12626.03 toks/s, output: 12.33 toks/s]
Processed prompts:  59%|█████▉    | 1211/2048 [01:38<01:16, 11.00it/s, est. speed input: 12622.24 toks/s, output: 12.33 toks/s]
Processed prompts:  59%|█████▉    | 1214/2048 [01:38<01:15, 11.00it/s, est. speed input: 12618.47 toks/s, output: 12.32 toks/s]
Processed prompts:  59%|█████▉    | 1217/2048 [01:38<01:15, 11.00it/s, est. speed input: 12614.77 toks/s, output: 12.32 toks/s]
Processed prompts:  60%|█████▉    | 1220/2048 [01:39<01:15, 11.01it/s, est. speed input: 12611.10 toks/s, output: 12.32 toks/s]
Processed prompts:  60%|█████▉    | 1223/2048 [01:39<01:14, 11.00it/s, est. speed input: 12607.41 toks/s, output: 12.31 toks/s]
Processed prompts:  60%|█████▉    | 1226/2048 [01:39<01:14, 11.01it/s, est. speed input: 12603.77 toks/s, output: 12.31 toks/s]
Processed prompts:  60%|██████    | 1229/2048 [01:39<01:14, 11.00it/s, est. speed input: 12600.06 toks/s, output: 12.30 toks/s]
Processed prompts:  60%|██████    | 1232/2048 [01:40<01:14, 11.00it/s, est. speed input: 12596.42 toks/s, output: 12.30 toks/s]
Processed prompts:  60%|██████    | 1235/2048 [01:40<01:13, 11.00it/s, est. speed input: 12592.79 toks/s, output: 12.30 toks/s]
Processed prompts:  61%|██████    | 1253/2048 [01:40<00:27, 28.84it/s, est. speed input: 12747.07 toks/s, output: 12.45 toks/s]
Processed prompts:  61%|██████▏   | 1257/2048 [01:40<00:32, 24.44it/s, est. speed input: 12753.19 toks/s, output: 12.45 toks/s]
Processed prompts:  62%|██████▏   | 1260/2048 [01:41<00:38, 20.31it/s, est. speed input: 12749.18 toks/s, output: 12.45 toks/s]
Processed prompts:  62%|██████▏   | 1263/2048 [01:41<00:44, 17.47it/s, est. speed input: 12745.16 toks/s, output: 12.45 toks/s]
Processed prompts:  62%|██████▏   | 1265/2048 [01:41<00:54, 14.39it/s, est. speed input: 12731.10 toks/s, output: 12.43 toks/s]
Processed prompts:  62%|██████▏   | 1268/2048 [01:42<00:58, 13.36it/s, est. speed input: 12727.14 toks/s, output: 12.43 toks/s]
Processed prompts:  62%|██████▏   | 1271/2048 [01:42<01:01, 12.65it/s, est. speed input: 12723.24 toks/s, output: 12.43 toks/s]
Processed prompts:  62%|██████▏   | 1274/2048 [01:42<01:03, 12.15it/s, est. speed input: 12719.35 toks/s, output: 12.42 toks/s]
Processed prompts:  62%|██████▏   | 1277/2048 [01:42<01:05, 11.81it/s, est. speed input: 12715.52 toks/s, output: 12.42 toks/s]
Processed prompts:  62%|██████▎   | 1280/2048 [01:43<01:06, 11.57it/s, est. speed input: 12711.69 toks/s, output: 12.41 toks/s]
Processed prompts:  63%|██████▎   | 1283/2048 [01:43<01:07, 11.40it/s, est. speed input: 12707.88 toks/s, output: 12.41 toks/s]
Processed prompts:  63%|██████▎   | 1286/2048 [01:43<01:07, 11.28it/s, est. speed input: 12704.08 toks/s, output: 12.41 toks/s]
Processed prompts:  63%|██████▎   | 1289/2048 [01:43<01:07, 11.20it/s, est. speed input: 12700.34 toks/s, output: 12.40 toks/s]
Processed prompts:  63%|██████▎   | 1292/2048 [01:44<01:07, 11.14it/s, est. speed input: 12696.55 toks/s, output: 12.40 toks/s]
Processed prompts:  63%|██████▎   | 1295/2048 [01:44<01:07, 11.10it/s, est. speed input: 12692.83 toks/s, output: 12.40 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [01:44<01:07, 11.07it/s, est. speed input: 12689.10 toks/s, output: 12.39 toks/s]
Processed prompts:  64%|██████▎   | 1301/2048 [01:45<01:07, 11.04it/s, est. speed input: 12685.37 toks/s, output: 12.39 toks/s]
Processed prompts:  64%|██████▎   | 1304/2048 [01:45<01:07, 11.03it/s, est. speed input: 12681.68 toks/s, output: 12.38 toks/s]
Processed prompts:  64%|██████▍   | 1307/2048 [01:45<01:07, 11.02it/s, est. speed input: 12678.02 toks/s, output: 12.38 toks/s]
Processed prompts:  64%|██████▍   | 1310/2048 [01:45<01:07, 11.01it/s, est. speed input: 12674.34 toks/s, output: 12.38 toks/s]
Processed prompts:  64%|██████▍   | 1313/2048 [01:46<01:06, 11.01it/s, est. speed input: 12670.72 toks/s, output: 12.37 toks/s]
Processed prompts:  64%|██████▍   | 1316/2048 [01:46<01:06, 11.01it/s, est. speed input: 12667.15 toks/s, output: 12.37 toks/s]
Processed prompts:  64%|██████▍   | 1319/2048 [01:46<01:06, 11.01it/s, est. speed input: 12663.58 toks/s, output: 12.37 toks/s]
Processed prompts:  65%|██████▍   | 1322/2048 [01:46<01:05, 11.00it/s, est. speed input: 12659.99 toks/s, output: 12.36 toks/s]
Processed prompts:  65%|██████▍   | 1325/2048 [01:47<01:05, 11.00it/s, est. speed input: 12656.45 toks/s, output: 12.36 toks/s]
Processed prompts:  65%|██████▍   | 1328/2048 [01:47<01:05, 11.00it/s, est. speed input: 12652.94 toks/s, output: 12.36 toks/s]
Processed prompts:  65%|██████▍   | 1331/2048 [01:47<01:05, 11.00it/s, est. speed input: 12649.44 toks/s, output: 12.35 toks/s]
Processed prompts:  65%|██████▌   | 1334/2048 [01:48<01:04, 11.01it/s, est. speed input: 12645.95 toks/s, output: 12.35 toks/s]
Processed prompts:  65%|██████▌   | 1337/2048 [01:48<01:04, 11.00it/s, est. speed input: 12642.42 toks/s, output: 12.35 toks/s]
Processed prompts:  65%|██████▌   | 1340/2048 [01:48<01:04, 11.00it/s, est. speed input: 12638.95 toks/s, output: 12.34 toks/s]
Processed prompts:  66%|██████▌   | 1343/2048 [01:48<01:04, 11.00it/s, est. speed input: 12635.51 toks/s, output: 12.34 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [01:49<01:03, 11.00it/s, est. speed input: 12632.05 toks/s, output: 12.34 toks/s]
Processed prompts:  66%|██████▌   | 1349/2048 [01:49<01:03, 11.00it/s, est. speed input: 12628.62 toks/s, output: 12.33 toks/s]
Processed prompts:  66%|██████▌   | 1352/2048 [01:49<01:03, 11.00it/s, est. speed input: 12625.25 toks/s, output: 12.33 toks/s]
Processed prompts:  66%|██████▌   | 1355/2048 [01:49<01:02, 11.00it/s, est. speed input: 12621.88 toks/s, output: 12.33 toks/s]
Processed prompts:  66%|██████▋   | 1358/2048 [01:50<01:02, 11.00it/s, est. speed input: 12618.53 toks/s, output: 12.32 toks/s]
Processed prompts:  66%|██████▋   | 1361/2048 [01:50<01:02, 11.00it/s, est. speed input: 12615.16 toks/s, output: 12.32 toks/s]
Processed prompts:  67%|██████▋   | 1364/2048 [01:50<01:02, 11.00it/s, est. speed input: 12611.84 toks/s, output: 12.32 toks/s]
Processed prompts:  67%|██████▋   | 1367/2048 [01:51<01:01, 11.00it/s, est. speed input: 12608.54 toks/s, output: 12.31 toks/s]
Processed prompts:  67%|██████▋   | 1370/2048 [01:51<01:01, 11.00it/s, est. speed input: 12605.20 toks/s, output: 12.31 toks/s]
Processed prompts:  67%|██████▋   | 1373/2048 [01:51<01:01, 10.99it/s, est. speed input: 12601.89 toks/s, output: 12.31 toks/s]
Processed prompts:  67%|██████▋   | 1376/2048 [01:51<01:01, 10.99it/s, est. speed input: 12598.62 toks/s, output: 12.30 toks/s]
Processed prompts:  67%|██████▋   | 1379/2048 [01:52<01:00, 10.99it/s, est. speed input: 12595.36 toks/s, output: 12.30 toks/s]
Processed prompts:  67%|██████▋   | 1382/2048 [01:52<01:00, 11.00it/s, est. speed input: 12592.12 toks/s, output: 12.30 toks/s]
Processed prompts:  68%|██████▊   | 1385/2048 [01:52<01:00, 11.00it/s, est. speed input: 12588.91 toks/s, output: 12.29 toks/s]
Processed prompts:  68%|██████▊   | 1388/2048 [01:52<00:59, 11.00it/s, est. speed input: 12585.74 toks/s, output: 12.29 toks/s]
Processed prompts:  68%|██████▊   | 1391/2048 [01:53<00:59, 11.00it/s, est. speed input: 12582.55 toks/s, output: 12.29 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [01:53<00:59, 11.00it/s, est. speed input: 12579.35 toks/s, output: 12.28 toks/s]
Processed prompts:  68%|██████▊   | 1397/2048 [01:53<00:59, 11.00it/s, est. speed input: 12576.22 toks/s, output: 12.28 toks/s]
Processed prompts:  68%|██████▊   | 1400/2048 [01:54<00:58, 11.00it/s, est. speed input: 12573.09 toks/s, output: 12.28 toks/s]
Processed prompts:  69%|██████▊   | 1403/2048 [01:54<00:58, 10.99it/s, est. speed input: 12569.91 toks/s, output: 12.28 toks/s]
Processed prompts:  69%|██████▊   | 1406/2048 [01:54<00:58, 10.99it/s, est. speed input: 12566.77 toks/s, output: 12.27 toks/s]
Processed prompts:  69%|██████▉   | 1409/2048 [01:54<00:58, 10.99it/s, est. speed input: 12563.67 toks/s, output: 12.27 toks/s]
Processed prompts:  69%|██████▉   | 1412/2048 [01:55<00:57, 10.99it/s, est. speed input: 12560.55 toks/s, output: 12.27 toks/s]
Processed prompts:  69%|██████▉   | 1415/2048 [01:55<00:57, 10.99it/s, est. speed input: 12557.46 toks/s, output: 12.26 toks/s]
Processed prompts:  69%|██████▉   | 1418/2048 [01:55<00:57, 11.00it/s, est. speed input: 12554.43 toks/s, output: 12.26 toks/s]
Processed prompts:  69%|██████▉   | 1421/2048 [01:55<00:56, 11.00it/s, est. speed input: 12551.43 toks/s, output: 12.26 toks/s]
Processed prompts:  70%|██████▉   | 1424/2048 [01:56<00:56, 11.00it/s, est. speed input: 12548.42 toks/s, output: 12.25 toks/s]
Processed prompts:  70%|██████▉   | 1427/2048 [01:56<00:56, 11.00it/s, est. speed input: 12545.38 toks/s, output: 12.25 toks/s]
Processed prompts:  70%|██████▉   | 1430/2048 [01:56<00:56, 11.00it/s, est. speed input: 12542.39 toks/s, output: 12.25 toks/s]
Processed prompts:  70%|██████▉   | 1433/2048 [01:57<00:55, 11.00it/s, est. speed input: 12539.43 toks/s, output: 12.25 toks/s]
Processed prompts:  70%|███████   | 1436/2048 [01:57<00:55, 11.00it/s, est. speed input: 12536.46 toks/s, output: 12.24 toks/s]
Processed prompts:  70%|███████   | 1439/2048 [01:57<00:55, 11.00it/s, est. speed input: 12533.49 toks/s, output: 12.24 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [01:57<00:55, 10.99it/s, est. speed input: 12530.51 toks/s, output: 12.24 toks/s]
Processed prompts:  71%|███████   | 1445/2048 [01:58<00:54, 10.99it/s, est. speed input: 12527.53 toks/s, output: 12.23 toks/s]
Processed prompts:  71%|███████   | 1448/2048 [01:58<00:54, 10.99it/s, est. speed input: 12524.62 toks/s, output: 12.23 toks/s]
Processed prompts:  71%|███████   | 1451/2048 [01:58<00:54, 10.99it/s, est. speed input: 12521.71 toks/s, output: 12.23 toks/s]
Processed prompts:  71%|███████   | 1454/2048 [01:58<00:54, 11.00it/s, est. speed input: 12518.86 toks/s, output: 12.23 toks/s]
Processed prompts:  71%|███████   | 1457/2048 [01:59<00:53, 11.00it/s, est. speed input: 12515.99 toks/s, output: 12.22 toks/s]
Processed prompts:  71%|███████▏  | 1460/2048 [01:59<00:53, 11.00it/s, est. speed input: 12513.12 toks/s, output: 12.22 toks/s]
Processed prompts:  71%|███████▏  | 1463/2048 [01:59<00:53, 11.00it/s, est. speed input: 12510.27 toks/s, output: 12.22 toks/s]
Processed prompts:  72%|███████▏  | 1466/2048 [02:00<00:52, 11.00it/s, est. speed input: 12507.43 toks/s, output: 12.21 toks/s]
Processed prompts:  72%|███████▏  | 1469/2048 [02:00<00:52, 11.00it/s, est. speed input: 12504.59 toks/s, output: 12.21 toks/s]
Processed prompts:  72%|███████▏  | 1472/2048 [02:00<00:52, 10.99it/s, est. speed input: 12501.74 toks/s, output: 12.21 toks/s]
Processed prompts:  72%|███████▏  | 1475/2048 [02:00<00:52, 10.99it/s, est. speed input: 12498.91 toks/s, output: 12.21 toks/s]
Processed prompts:  72%|███████▏  | 1478/2048 [02:01<00:51, 10.99it/s, est. speed input: 12496.09 toks/s, output: 12.20 toks/s]
Processed prompts:  72%|███████▏  | 1481/2048 [02:01<00:51, 10.99it/s, est. speed input: 12493.32 toks/s, output: 12.20 toks/s]
Processed prompts:  72%|███████▏  | 1484/2048 [02:01<00:51, 10.99it/s, est. speed input: 12490.55 toks/s, output: 12.20 toks/s]
Processed prompts:  73%|███████▎  | 1487/2048 [02:01<00:51, 11.00it/s, est. speed input: 12487.82 toks/s, output: 12.20 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [02:02<00:50, 11.00it/s, est. speed input: 12485.13 toks/s, output: 12.19 toks/s]
Processed prompts:  73%|███████▎  | 1493/2048 [02:02<00:50, 11.00it/s, est. speed input: 12482.36 toks/s, output: 12.19 toks/s]
Processed prompts:  73%|███████▎  | 1496/2048 [02:02<00:50, 10.99it/s, est. speed input: 12479.62 toks/s, output: 12.19 toks/s]
Processed prompts:  73%|███████▎  | 1499/2048 [02:03<00:49, 10.99it/s, est. speed input: 12476.91 toks/s, output: 12.18 toks/s]
Processed prompts:  73%|███████▎  | 1502/2048 [02:03<00:49, 11.00it/s, est. speed input: 12474.24 toks/s, output: 12.18 toks/s]
Processed prompts:  73%|███████▎  | 1505/2048 [02:03<00:49, 10.99it/s, est. speed input: 12471.54 toks/s, output: 12.18 toks/s]
Processed prompts:  74%|███████▎  | 1508/2048 [02:03<00:49, 10.99it/s, est. speed input: 12468.84 toks/s, output: 12.18 toks/s]
Processed prompts:  74%|███████▍  | 1511/2048 [02:04<00:48, 10.99it/s, est. speed input: 12466.17 toks/s, output: 12.17 toks/s]
Processed prompts:  74%|███████▍  | 1514/2048 [02:04<00:48, 10.99it/s, est. speed input: 12463.48 toks/s, output: 12.17 toks/s]
Processed prompts:  74%|███████▍  | 1517/2048 [02:04<00:48, 10.99it/s, est. speed input: 12460.84 toks/s, output: 12.17 toks/s]
Processed prompts:  74%|███████▍  | 1520/2048 [02:04<00:48, 10.99it/s, est. speed input: 12458.22 toks/s, output: 12.17 toks/s]
Processed prompts:  74%|███████▍  | 1523/2048 [02:05<00:47, 10.99it/s, est. speed input: 12455.58 toks/s, output: 12.16 toks/s]
Processed prompts:  75%|███████▍  | 1526/2048 [02:05<00:47, 10.99it/s, est. speed input: 12452.98 toks/s, output: 12.16 toks/s]
Processed prompts:  75%|███████▍  | 1529/2048 [02:05<00:47, 10.99it/s, est. speed input: 12450.37 toks/s, output: 12.16 toks/s]
Processed prompts:  75%|███████▍  | 1532/2048 [02:06<00:46, 11.00it/s, est. speed input: 12447.83 toks/s, output: 12.16 toks/s]
Processed prompts:  75%|███████▍  | 1535/2048 [02:06<00:46, 11.00it/s, est. speed input: 12445.26 toks/s, output: 12.15 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [02:06<00:46, 11.00it/s, est. speed input: 12442.70 toks/s, output: 12.15 toks/s]
Processed prompts:  75%|███████▌  | 1541/2048 [02:06<00:46, 10.99it/s, est. speed input: 12440.14 toks/s, output: 12.15 toks/s]
Processed prompts:  75%|███████▌  | 1544/2048 [02:07<00:45, 10.99it/s, est. speed input: 12437.59 toks/s, output: 12.15 toks/s]
Processed prompts:  76%|███████▌  | 1547/2048 [02:07<00:45, 10.99it/s, est. speed input: 12435.03 toks/s, output: 12.14 toks/s]
Processed prompts:  76%|███████▌  | 1550/2048 [02:07<00:45, 10.99it/s, est. speed input: 12432.52 toks/s, output: 12.14 toks/s]
Processed prompts:  76%|███████▌  | 1553/2048 [02:07<00:45, 10.99it/s, est. speed input: 12430.02 toks/s, output: 12.14 toks/s]
Processed prompts:  76%|███████▌  | 1556/2048 [02:08<00:44, 11.00it/s, est. speed input: 12427.56 toks/s, output: 12.14 toks/s]
Processed prompts:  76%|███████▌  | 1559/2048 [02:08<00:44, 11.00it/s, est. speed input: 12425.09 toks/s, output: 12.13 toks/s]
Processed prompts:  76%|███████▋  | 1562/2048 [02:08<00:44, 10.99it/s, est. speed input: 12422.58 toks/s, output: 12.13 toks/s]
Processed prompts:  76%|███████▋  | 1565/2048 [02:09<00:43, 11.00it/s, est. speed input: 12420.14 toks/s, output: 12.13 toks/s]
Processed prompts:  77%|███████▋  | 1568/2048 [02:09<00:43, 11.00it/s, est. speed input: 12417.72 toks/s, output: 12.13 toks/s]
Processed prompts:  77%|███████▋  | 1571/2048 [02:09<00:43, 11.00it/s, est. speed input: 12415.28 toks/s, output: 12.12 toks/s]
Processed prompts:  77%|███████▋  | 1574/2048 [02:09<00:43, 10.99it/s, est. speed input: 12412.82 toks/s, output: 12.12 toks/s]
Processed prompts:  77%|███████▋  | 1577/2048 [02:10<00:42, 10.99it/s, est. speed input: 12410.37 toks/s, output: 12.12 toks/s]
Processed prompts:  77%|███████▋  | 1580/2048 [02:10<00:42, 10.99it/s, est. speed input: 12407.96 toks/s, output: 12.12 toks/s]
Processed prompts:  77%|███████▋  | 1583/2048 [02:10<00:42, 10.99it/s, est. speed input: 12405.54 toks/s, output: 12.11 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [02:10<00:42, 10.99it/s, est. speed input: 12403.15 toks/s, output: 12.11 toks/s]
Processed prompts:  78%|███████▊  | 1589/2048 [02:11<00:41, 10.99it/s, est. speed input: 12400.75 toks/s, output: 12.11 toks/s]
Processed prompts:  78%|███████▊  | 1592/2048 [02:11<00:41, 10.99it/s, est. speed input: 12398.39 toks/s, output: 12.11 toks/s]
Processed prompts:  79%|███████▊  | 1610/2048 [02:11<00:15, 29.00it/s, est. speed input: 12517.12 toks/s, output: 12.22 toks/s]
Processed prompts:  79%|███████▉  | 1614/2048 [02:11<00:17, 24.53it/s, est. speed input: 12522.25 toks/s, output: 12.23 toks/s]
Processed prompts:  79%|███████▉  | 1617/2048 [02:12<00:21, 20.36it/s, est. speed input: 12519.66 toks/s, output: 12.23 toks/s]
Processed prompts:  79%|███████▉  | 1620/2048 [02:12<00:24, 17.51it/s, est. speed input: 12517.09 toks/s, output: 12.22 toks/s]
Processed prompts:  79%|███████▉  | 1622/2048 [02:12<00:29, 14.43it/s, est. speed input: 12506.88 toks/s, output: 12.21 toks/s]
Processed prompts:  79%|███████▉  | 1625/2048 [02:13<00:31, 13.39it/s, est. speed input: 12504.35 toks/s, output: 12.21 toks/s]
Processed prompts:  79%|███████▉  | 1628/2048 [02:13<00:33, 12.68it/s, est. speed input: 12501.85 toks/s, output: 12.21 toks/s]
Processed prompts:  80%|███████▉  | 1631/2048 [02:13<00:34, 12.17it/s, est. speed input: 12499.34 toks/s, output: 12.21 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [02:13<00:35, 11.82it/s, est. speed input: 12496.85 toks/s, output: 12.20 toks/s]
Processed prompts:  80%|███████▉  | 1637/2048 [02:14<00:35, 11.58it/s, est. speed input: 12494.38 toks/s, output: 12.20 toks/s]
Processed prompts:  80%|████████  | 1640/2048 [02:14<00:35, 11.41it/s, est. speed input: 12491.89 toks/s, output: 12.20 toks/s]
Processed prompts:  80%|████████  | 1643/2048 [02:14<00:35, 11.29it/s, est. speed input: 12489.41 toks/s, output: 12.20 toks/s]
Processed prompts:  80%|████████  | 1646/2048 [02:14<00:35, 11.20it/s, est. speed input: 12486.92 toks/s, output: 12.19 toks/s]
Processed prompts:  81%|████████  | 1649/2048 [02:15<00:35, 11.14it/s, est. speed input: 12484.45 toks/s, output: 12.19 toks/s]
Processed prompts:  81%|████████  | 1652/2048 [02:15<00:35, 11.10it/s, est. speed input: 12482.01 toks/s, output: 12.19 toks/s]
Processed prompts:  81%|████████  | 1655/2048 [02:15<00:35, 11.07it/s, est. speed input: 12479.58 toks/s, output: 12.19 toks/s]
Processed prompts:  81%|████████  | 1658/2048 [02:16<00:35, 11.05it/s, est. speed input: 12477.15 toks/s, output: 12.18 toks/s]
Processed prompts:  81%|████████  | 1661/2048 [02:16<00:35, 11.04it/s, est. speed input: 12474.73 toks/s, output: 12.18 toks/s]
Processed prompts:  81%|████████▏ | 1664/2048 [02:16<00:34, 11.03it/s, est. speed input: 12472.31 toks/s, output: 12.18 toks/s]
Processed prompts:  81%|████████▏ | 1667/2048 [02:16<00:34, 11.02it/s, est. speed input: 12469.91 toks/s, output: 12.18 toks/s]
Processed prompts:  82%|████████▏ | 1670/2048 [02:17<00:34, 11.01it/s, est. speed input: 12467.51 toks/s, output: 12.18 toks/s]
Processed prompts:  82%|████████▏ | 1673/2048 [02:17<00:34, 11.01it/s, est. speed input: 12465.14 toks/s, output: 12.17 toks/s]
Processed prompts:  82%|████████▏ | 1676/2048 [02:17<00:33, 11.01it/s, est. speed input: 12462.78 toks/s, output: 12.17 toks/s]
Processed prompts:  82%|████████▏ | 1679/2048 [02:17<00:33, 11.00it/s, est. speed input: 12460.39 toks/s, output: 12.17 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [02:18<00:33, 11.01it/s, est. speed input: 12458.05 toks/s, output: 12.17 toks/s]
Processed prompts:  82%|████████▏ | 1685/2048 [02:18<00:33, 11.00it/s, est. speed input: 12455.65 toks/s, output: 12.16 toks/s]
Processed prompts:  82%|████████▏ | 1688/2048 [02:18<00:32, 11.00it/s, est. speed input: 12453.32 toks/s, output: 12.16 toks/s]
Processed prompts:  83%|████████▎ | 1691/2048 [02:19<00:32, 11.00it/s, est. speed input: 12451.01 toks/s, output: 12.16 toks/s]
Processed prompts:  83%|████████▎ | 1694/2048 [02:19<00:32, 11.00it/s, est. speed input: 12448.68 toks/s, output: 12.16 toks/s]
Processed prompts:  83%|████████▎ | 1697/2048 [02:19<00:31, 11.00it/s, est. speed input: 12446.38 toks/s, output: 12.15 toks/s]
Processed prompts:  83%|████████▎ | 1700/2048 [02:19<00:31, 11.00it/s, est. speed input: 12444.06 toks/s, output: 12.15 toks/s]
Processed prompts:  83%|████████▎ | 1703/2048 [02:20<00:31, 11.00it/s, est. speed input: 12441.76 toks/s, output: 12.15 toks/s]
Processed prompts:  83%|████████▎ | 1706/2048 [02:20<00:31, 11.00it/s, est. speed input: 12439.46 toks/s, output: 12.15 toks/s]
Processed prompts:  83%|████████▎ | 1709/2048 [02:20<00:30, 10.99it/s, est. speed input: 12437.15 toks/s, output: 12.15 toks/s]
Processed prompts:  84%|████████▎ | 1712/2048 [02:20<00:30, 10.99it/s, est. speed input: 12434.87 toks/s, output: 12.14 toks/s]
Processed prompts:  84%|████████▎ | 1715/2048 [02:21<00:30, 10.99it/s, est. speed input: 12432.55 toks/s, output: 12.14 toks/s]
Processed prompts:  84%|████████▍ | 1718/2048 [02:21<00:30, 10.99it/s, est. speed input: 12430.26 toks/s, output: 12.14 toks/s]
Processed prompts:  84%|████████▍ | 1721/2048 [02:21<00:29, 10.99it/s, est. speed input: 12427.99 toks/s, output: 12.14 toks/s]
Processed prompts:  84%|████████▍ | 1724/2048 [02:22<00:29, 10.99it/s, est. speed input: 12425.73 toks/s, output: 12.13 toks/s]
Processed prompts:  84%|████████▍ | 1727/2048 [02:22<00:29, 10.99it/s, est. speed input: 12423.49 toks/s, output: 12.13 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [02:22<00:28, 10.99it/s, est. speed input: 12421.26 toks/s, output: 12.13 toks/s]
Processed prompts:  85%|████████▍ | 1733/2048 [02:22<00:28, 10.99it/s, est. speed input: 12419.05 toks/s, output: 12.13 toks/s]
Processed prompts:  85%|████████▍ | 1736/2048 [02:23<00:28, 10.99it/s, est. speed input: 12416.83 toks/s, output: 12.13 toks/s]
Processed prompts:  85%|████████▍ | 1739/2048 [02:23<00:28, 10.99it/s, est. speed input: 12414.60 toks/s, output: 12.12 toks/s]
Processed prompts:  85%|████████▌ | 1742/2048 [02:23<00:27, 10.99it/s, est. speed input: 12412.41 toks/s, output: 12.12 toks/s]
Processed prompts:  85%|████████▌ | 1745/2048 [02:23<00:27, 10.99it/s, est. speed input: 12410.19 toks/s, output: 12.12 toks/s]
Processed prompts:  85%|████████▌ | 1748/2048 [02:24<00:27, 10.98it/s, est. speed input: 12407.94 toks/s, output: 12.12 toks/s]
Processed prompts:  85%|████████▌ | 1751/2048 [02:24<00:27, 10.98it/s, est. speed input: 12405.77 toks/s, output: 12.12 toks/s]
Processed prompts:  86%|████████▌ | 1754/2048 [02:24<00:26, 10.98it/s, est. speed input: 12403.56 toks/s, output: 12.11 toks/s]
Processed prompts:  86%|████████▌ | 1757/2048 [02:25<00:26, 10.98it/s, est. speed input: 12401.37 toks/s, output: 12.11 toks/s]
Processed prompts:  86%|████████▌ | 1760/2048 [02:25<00:26, 10.98it/s, est. speed input: 12399.17 toks/s, output: 12.11 toks/s]
Processed prompts:  86%|████████▌ | 1763/2048 [02:25<00:25, 10.98it/s, est. speed input: 12397.02 toks/s, output: 12.11 toks/s]
Processed prompts:  86%|████████▌ | 1766/2048 [02:25<00:25, 10.99it/s, est. speed input: 12394.92 toks/s, output: 12.10 toks/s]
Processed prompts:  86%|████████▋ | 1769/2048 [02:26<00:25, 10.99it/s, est. speed input: 12392.77 toks/s, output: 12.10 toks/s]
Processed prompts:  87%|████████▋ | 1772/2048 [02:26<00:25, 10.99it/s, est. speed input: 12390.64 toks/s, output: 12.10 toks/s]
Processed prompts:  87%|████████▋ | 1775/2048 [02:26<00:24, 10.98it/s, est. speed input: 12388.50 toks/s, output: 12.10 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [02:26<00:24, 10.99it/s, est. speed input: 12386.39 toks/s, output: 12.10 toks/s]
Processed prompts:  87%|████████▋ | 1781/2048 [02:27<00:24, 10.99it/s, est. speed input: 12384.28 toks/s, output: 12.09 toks/s]
Processed prompts:  87%|████████▋ | 1784/2048 [02:27<00:24, 10.98it/s, est. speed input: 12382.16 toks/s, output: 12.09 toks/s]
Processed prompts:  87%|████████▋ | 1787/2048 [02:27<00:23, 10.98it/s, est. speed input: 12380.06 toks/s, output: 12.09 toks/s]
Processed prompts:  87%|████████▋ | 1790/2048 [02:28<00:23, 10.98it/s, est. speed input: 12377.96 toks/s, output: 12.09 toks/s]
Processed prompts:  88%|████████▊ | 1793/2048 [02:28<00:23, 10.98it/s, est. speed input: 12375.87 toks/s, output: 12.09 toks/s]
Processed prompts:  88%|████████▊ | 1796/2048 [02:28<00:22, 10.98it/s, est. speed input: 12373.79 toks/s, output: 12.08 toks/s]
Processed prompts:  88%|████████▊ | 1799/2048 [02:28<00:22, 10.98it/s, est. speed input: 12371.69 toks/s, output: 12.08 toks/s]
Processed prompts:  88%|████████▊ | 1802/2048 [02:29<00:22, 10.98it/s, est. speed input: 12369.65 toks/s, output: 12.08 toks/s]
Processed prompts:  88%|████████▊ | 1805/2048 [02:29<00:22, 10.99it/s, est. speed input: 12367.62 toks/s, output: 12.08 toks/s]
Processed prompts:  88%|████████▊ | 1808/2048 [02:29<00:21, 10.98it/s, est. speed input: 12365.57 toks/s, output: 12.08 toks/s]
Processed prompts:  88%|████████▊ | 1811/2048 [02:29<00:21, 10.98it/s, est. speed input: 12363.52 toks/s, output: 12.07 toks/s]
Processed prompts:  89%|████████▊ | 1814/2048 [02:30<00:21, 10.98it/s, est. speed input: 12361.48 toks/s, output: 12.07 toks/s]
Processed prompts:  89%|████████▊ | 1817/2048 [02:30<00:21, 10.98it/s, est. speed input: 12359.47 toks/s, output: 12.07 toks/s]
Processed prompts:  89%|████████▉ | 1820/2048 [02:30<00:20, 10.98it/s, est. speed input: 12357.45 toks/s, output: 12.07 toks/s]
Processed prompts:  89%|████████▉ | 1823/2048 [02:31<00:20, 10.98it/s, est. speed input: 12355.44 toks/s, output: 12.07 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [02:31<00:20, 10.99it/s, est. speed input: 12353.45 toks/s, output: 12.06 toks/s]
Processed prompts:  89%|████████▉ | 1829/2048 [02:31<00:19, 10.99it/s, est. speed input: 12351.51 toks/s, output: 12.06 toks/s]
Processed prompts:  89%|████████▉ | 1832/2048 [02:31<00:19, 10.99it/s, est. speed input: 12349.55 toks/s, output: 12.06 toks/s]
Processed prompts:  90%|████████▉ | 1835/2048 [02:32<00:19, 10.99it/s, est. speed input: 12347.54 toks/s, output: 12.06 toks/s]
Processed prompts:  90%|████████▉ | 1838/2048 [02:32<00:19, 10.99it/s, est. speed input: 12345.59 toks/s, output: 12.06 toks/s]
Processed prompts:  90%|████████▉ | 1841/2048 [02:32<00:18, 10.99it/s, est. speed input: 12343.66 toks/s, output: 12.05 toks/s]
Processed prompts:  90%|█████████ | 1844/2048 [02:32<00:18, 10.99it/s, est. speed input: 12341.68 toks/s, output: 12.05 toks/s]
Processed prompts:  90%|█████████ | 1847/2048 [02:33<00:18, 10.98it/s, est. speed input: 12339.72 toks/s, output: 12.05 toks/s]
Processed prompts:  90%|█████████ | 1850/2048 [02:33<00:18, 10.99it/s, est. speed input: 12337.79 toks/s, output: 12.05 toks/s]
Processed prompts:  90%|█████████ | 1853/2048 [02:33<00:17, 10.98it/s, est. speed input: 12335.83 toks/s, output: 12.05 toks/s]
Processed prompts:  91%|█████████ | 1856/2048 [02:34<00:17, 10.98it/s, est. speed input: 12333.89 toks/s, output: 12.04 toks/s]
Processed prompts:  91%|█████████ | 1859/2048 [02:34<00:17, 10.98it/s, est. speed input: 12331.95 toks/s, output: 12.04 toks/s]
Processed prompts:  91%|█████████ | 1862/2048 [02:34<00:16, 10.98it/s, est. speed input: 12330.05 toks/s, output: 12.04 toks/s]
Processed prompts:  91%|█████████ | 1865/2048 [02:34<00:16, 10.98it/s, est. speed input: 12328.13 toks/s, output: 12.04 toks/s]
Processed prompts:  91%|█████████ | 1868/2048 [02:35<00:16, 10.98it/s, est. speed input: 12326.21 toks/s, output: 12.04 toks/s]
Processed prompts:  91%|█████████▏| 1871/2048 [02:35<00:16, 10.98it/s, est. speed input: 12324.31 toks/s, output: 12.04 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [02:35<00:15, 10.99it/s, est. speed input: 12322.45 toks/s, output: 12.03 toks/s]
Processed prompts:  92%|█████████▏| 1877/2048 [02:36<00:15, 10.99it/s, est. speed input: 12320.60 toks/s, output: 12.03 toks/s]
Processed prompts:  92%|█████████▏| 1880/2048 [02:36<00:15, 10.99it/s, est. speed input: 12318.75 toks/s, output: 12.03 toks/s]
Processed prompts:  92%|█████████▏| 1883/2048 [02:36<00:15, 10.99it/s, est. speed input: 12316.88 toks/s, output: 12.03 toks/s]
Processed prompts:  92%|█████████▏| 1886/2048 [02:36<00:14, 10.99it/s, est. speed input: 12315.05 toks/s, output: 12.03 toks/s]
Processed prompts:  92%|█████████▏| 1889/2048 [02:37<00:14, 11.00it/s, est. speed input: 12313.23 toks/s, output: 12.02 toks/s]
Processed prompts:  92%|█████████▏| 1892/2048 [02:37<00:14, 10.99it/s, est. speed input: 12311.38 toks/s, output: 12.02 toks/s]
Processed prompts:  93%|█████████▎| 1895/2048 [02:37<00:13, 10.99it/s, est. speed input: 12309.55 toks/s, output: 12.02 toks/s]
Processed prompts:  93%|█████████▎| 1898/2048 [02:37<00:13, 10.99it/s, est. speed input: 12307.74 toks/s, output: 12.02 toks/s]
Processed prompts:  93%|█████████▎| 1901/2048 [02:38<00:13, 10.99it/s, est. speed input: 12305.92 toks/s, output: 12.02 toks/s]
Processed prompts:  93%|█████████▎| 1904/2048 [02:38<00:13, 10.99it/s, est. speed input: 12304.11 toks/s, output: 12.02 toks/s]
Processed prompts:  93%|█████████▎| 1907/2048 [02:38<00:12, 10.99it/s, est. speed input: 12302.32 toks/s, output: 12.01 toks/s]
Processed prompts:  93%|█████████▎| 1910/2048 [02:39<00:12, 11.00it/s, est. speed input: 12300.54 toks/s, output: 12.01 toks/s]
Processed prompts:  93%|█████████▎| 1913/2048 [02:39<00:12, 11.00it/s, est. speed input: 12298.77 toks/s, output: 12.01 toks/s]
Processed prompts:  94%|█████████▎| 1916/2048 [02:39<00:11, 11.00it/s, est. speed input: 12297.03 toks/s, output: 12.01 toks/s]
Processed prompts:  94%|█████████▎| 1919/2048 [02:39<00:11, 11.00it/s, est. speed input: 12295.25 toks/s, output: 12.01 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [02:40<00:11, 10.99it/s, est. speed input: 12293.46 toks/s, output: 12.01 toks/s]
Processed prompts:  94%|█████████▍| 1925/2048 [02:40<00:11, 10.99it/s, est. speed input: 12291.69 toks/s, output: 12.00 toks/s]
Processed prompts:  94%|█████████▍| 1928/2048 [02:40<00:10, 10.99it/s, est. speed input: 12289.92 toks/s, output: 12.00 toks/s]
Processed prompts:  94%|█████████▍| 1931/2048 [02:40<00:10, 10.99it/s, est. speed input: 12288.17 toks/s, output: 12.00 toks/s]
Processed prompts:  94%|█████████▍| 1934/2048 [02:41<00:10, 10.99it/s, est. speed input: 12286.43 toks/s, output: 12.00 toks/s]
Processed prompts:  95%|█████████▍| 1937/2048 [02:41<00:10, 11.00it/s, est. speed input: 12284.70 toks/s, output: 12.00 toks/s]
Processed prompts:  95%|█████████▍| 1940/2048 [02:41<00:09, 10.99it/s, est. speed input: 12282.97 toks/s, output: 12.00 toks/s]
Processed prompts:  95%|█████████▍| 1943/2048 [02:42<00:09, 10.99it/s, est. speed input: 12281.23 toks/s, output: 11.99 toks/s]
Processed prompts:  95%|█████████▌| 1946/2048 [02:42<00:09, 10.99it/s, est. speed input: 12279.48 toks/s, output: 11.99 toks/s]
Processed prompts:  95%|█████████▌| 1949/2048 [02:42<00:09, 10.99it/s, est. speed input: 12277.78 toks/s, output: 11.99 toks/s]
Processed prompts:  96%|█████████▌| 1967/2048 [02:42<00:02, 29.16it/s, est. speed input: 12374.37 toks/s, output: 12.08 toks/s]
Processed prompts:  96%|█████████▌| 1971/2048 [02:43<00:03, 24.63it/s, est. speed input: 12378.80 toks/s, output: 12.09 toks/s]
Processed prompts:  96%|█████████▋| 1974/2048 [02:43<00:03, 20.42it/s, est. speed input: 12376.92 toks/s, output: 12.09 toks/s]
Processed prompts:  97%|█████████▋| 1977/2048 [02:43<00:04, 17.53it/s, est. speed input: 12375.04 toks/s, output: 12.09 toks/s]
Processed prompts:  97%|█████████▋| 1979/2048 [02:43<00:04, 14.43it/s, est. speed input: 12366.93 toks/s, output: 12.08 toks/s]
Processed prompts:  97%|█████████▋| 1982/2048 [02:44<00:04, 13.39it/s, est. speed input: 12365.12 toks/s, output: 12.08 toks/s]
Processed prompts:  97%|█████████▋| 1985/2048 [02:44<00:04, 12.69it/s, est. speed input: 12363.37 toks/s, output: 12.07 toks/s]
Processed prompts:  97%|█████████▋| 1988/2048 [02:44<00:04, 12.19it/s, est. speed input: 12361.60 toks/s, output: 12.07 toks/s]
Processed prompts:  97%|█████████▋| 1991/2048 [02:44<00:04, 11.84it/s, est. speed input: 12359.87 toks/s, output: 12.07 toks/s]
Processed prompts:  97%|█████████▋| 1994/2048 [02:45<00:04, 11.60it/s, est. speed input: 12358.14 toks/s, output: 12.07 toks/s]
Processed prompts:  98%|█████████▊| 1997/2048 [02:45<00:04, 11.44it/s, est. speed input: 12356.42 toks/s, output: 12.07 toks/s]
Processed prompts:  98%|█████████▊| 2000/2048 [02:45<00:04, 11.32it/s, est. speed input: 12354.72 toks/s, output: 12.07 toks/s]
Processed prompts:  98%|█████████▊| 2003/2048 [02:46<00:04, 11.23it/s, est. speed input: 12352.99 toks/s, output: 12.06 toks/s]
Processed prompts:  98%|█████████▊| 2006/2048 [02:46<00:03, 11.18it/s, est. speed input: 12351.30 toks/s, output: 12.06 toks/s]
Processed prompts:  98%|█████████▊| 2009/2048 [02:46<00:03, 11.14it/s, est. speed input: 12349.63 toks/s, output: 12.06 toks/s]
Processed prompts:  98%|█████████▊| 2012/2048 [02:46<00:03, 11.11it/s, est. speed input: 12347.93 toks/s, output: 12.06 toks/s]
Processed prompts:  98%|█████████▊| 2015/2048 [02:47<00:02, 11.09it/s, est. speed input: 12346.26 toks/s, output: 12.06 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [02:47<00:02, 11.08it/s, est. speed input: 12344.55 toks/s, output: 12.06 toks/s]
Processed prompts:  99%|█████████▊| 2021/2048 [02:47<00:02, 11.07it/s, est. speed input: 12342.90 toks/s, output: 12.05 toks/s]
Processed prompts:  99%|█████████▉| 2024/2048 [02:47<00:02, 11.06it/s, est. speed input: 12341.21 toks/s, output: 12.05 toks/s]
Processed prompts:  99%|█████████▉| 2027/2048 [02:48<00:01, 11.05it/s, est. speed input: 12339.53 toks/s, output: 12.05 toks/s]
Processed prompts:  99%|█████████▉| 2030/2048 [02:48<00:01, 11.05it/s, est. speed input: 12337.87 toks/s, output: 12.05 toks/s]
Processed prompts:  99%|█████████▉| 2033/2048 [02:48<00:01, 11.05it/s, est. speed input: 12336.20 toks/s, output: 12.05 toks/s]
Processed prompts:  99%|█████████▉| 2036/2048 [02:49<00:01, 11.05it/s, est. speed input: 12334.55 toks/s, output: 12.05 toks/s]
Processed prompts: 100%|█████████▉| 2039/2048 [02:49<00:00, 11.04it/s, est. speed input: 12332.90 toks/s, output: 12.04 toks/s]
Processed prompts: 100%|█████████▉| 2042/2048 [02:49<00:00, 11.05it/s, est. speed input: 12331.31 toks/s, output: 12.04 toks/s]
Processed prompts: 100%|█████████▉| 2045/2048 [02:49<00:00, 11.05it/s, est. speed input: 12329.70 toks/s, output: 12.04 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [02:49<00:00, 13.47it/s, est. speed input: 12339.87 toks/s, output: 12.05 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [02:49<00:00, 13.47it/s, est. speed input: 12339.87 toks/s, output: 12.05 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [02:49<00:00, 12.05it/s, est. speed input: 12339.87 toks/s, output: 12.05 toks/s]
[rank0]:[W126 05:25:41.565604692 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 256.2s

测试结果:
  Requests/s:   10.99
  Tokens/s:     11267.48
  Total Reqs:   2048
  Elapsed:      186.31s

  [Prefill 分析]
  Total Prefill Tokens: 2097152
  Prefill Tokens/s:     11256.49

============================================================
[7/8] 测试 M=32768
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-14B-INT8                                │
│ Backend:  cuBLASLt [INT32 output]                         │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 32768
│   M_prefill     = 32768 (= 32 x 1024)
│   M_decode      = 32
│   batched_tokens = 32768 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 4096
│   --max-num-seqs           = 32
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 32768
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 05:26:20 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 05:26:21 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=230047) WARNING 01-26 05:26:29 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=230047) WARNING 01-26 05:26:44 [backends.py:609] Failed to read file <frozen os>
(EngineCore_DP0 pid=230047) ERROR 01-26 05:27:10 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=230047) ERROR 01-26 05:27:10 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=230047) ERROR 01-26 05:27:10 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=230047) ERROR 01-26 05:27:10 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=230047) ERROR 01-26 05:27:10 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=230047) ERROR 01-26 05:27:10 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=230047) ERROR 01-26 05:27:10 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=230047) ERROR 01-26 05:27:10 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=230047) ERROR 01-26 05:27:10 [core.py:866]     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=230047) ERROR 01-26 05:27:10 [core.py:866]                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=230047) ERROR 01-26 05:27:10 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 248, in _initialize_kv_caches
(EngineCore_DP0 pid=230047) ERROR 01-26 05:27:10 [core.py:866]     kv_cache_configs = get_kv_cache_configs(
(EngineCore_DP0 pid=230047) ERROR 01-26 05:27:10 [core.py:866]                        ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=230047) ERROR 01-26 05:27:10 [core.py:866]   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 1340, in get_kv_cache_configs
(EngineCore_DP0 pid=230047) ERROR 01-26 05:27:10 [core.py:866]     check_enough_kv_cache_memory(
(EngineCore_DP0 pid=230047) ERROR 01-26 05:27:10 [core.py:866]   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 687, in check_enough_kv_cache_memory
(EngineCore_DP0 pid=230047) ERROR 01-26 05:27:10 [core.py:866]     raise ValueError(
(EngineCore_DP0 pid=230047) ERROR 01-26 05:27:10 [core.py:866] ValueError: No available memory for the cache blocks. Try increasing `gpu_memory_utilization` when initializing the engine. See https://docs.vllm.ai/en/latest/configuration/conserving_memory/ for more details.


─── STDERR ───
[2026-01-26 05:26:20] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:26:20] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:26:20] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:26:20] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:26:20] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:26:20] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:26:20] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:26:20] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:26:20] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:26:20] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:26:20] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:26:20] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:26:20] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:26:20] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 05:26:28] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:26:28] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:26:28] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:26:28] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:26:28] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:26:28] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:26:28] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:26:28] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:26:28] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:26:28] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:26:28] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:26:28] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:26:28] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:26:28] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=230047) [2026-01-26 05:26:29] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=230047) [2026-01-26 05:26:29] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=230047) [2026-01-26 05:26:29] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=230047) [2026-01-26 05:26:29] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=230047) [2026-01-26 05:26:29] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuBLASLt, symmetric=True
(EngineCore_DP0 pid=230047) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=230047) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.03it/s]
(EngineCore_DP0 pid=230047) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.01it/s]
(EngineCore_DP0 pid=230047) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.41it/s]
(EngineCore_DP0 pid=230047) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.26it/s]
(EngineCore_DP0 pid=230047) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.22it/s]
(EngineCore_DP0 pid=230047) 
(EngineCore_DP0 pid=230047) [rank0]:W0126 05:26:58.850000 230047 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=230047) [rank0]:W0126 05:26:59.227000 230047 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
[cuBLASLt] INFO: INT8 GEMM only supports INT32 output. inner_dtype parameter is ignored, always using int32.
(EngineCore_DP0 pid=230047) [rank0]:W0126 05:27:00.526000 230047 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=230047) [rank0]:W0126 05:27:00.650000 230047 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=230047) Process EngineCore_DP0:
(EngineCore_DP0 pid=230047) Traceback (most recent call last):
(EngineCore_DP0 pid=230047)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=230047)     self.run()
(EngineCore_DP0 pid=230047)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=230047)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=230047)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=230047)     raise e
(EngineCore_DP0 pid=230047)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=230047)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=230047)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=230047)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=230047)     super().__init__(
(EngineCore_DP0 pid=230047)   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=230047)     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=230047)                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=230047)   File "/root/vllmbench/vllm/v1/engine/core.py", line 248, in _initialize_kv_caches
(EngineCore_DP0 pid=230047)     kv_cache_configs = get_kv_cache_configs(
(EngineCore_DP0 pid=230047)                        ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=230047)   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 1340, in get_kv_cache_configs
(EngineCore_DP0 pid=230047)     check_enough_kv_cache_memory(
(EngineCore_DP0 pid=230047)   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 687, in check_enough_kv_cache_memory
(EngineCore_DP0 pid=230047)     raise ValueError(
(EngineCore_DP0 pid=230047) ValueError: No available memory for the cache blocks. Try increasing `gpu_memory_utilization` when initializing the engine. See https://docs.vllm.ai/en/latest/configuration/conserving_memory/ for more details.
[rank0]:[W126 05:27:11.362917848 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

[ERROR] 测试失败: M=32768 (exit code: 1)

============================================================
[8/8] 测试 M=65536
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-14B-INT8                                │
│ Backend:  cuBLASLt [INT32 output]                         │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 65536
│   M_prefill     = 65536 (= 64 x 1024)
│   M_decode      = 64
│   batched_tokens = 65536 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 8192
│   --max-num-seqs           = 64
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 65536
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 05:28:21 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 05:28:22 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=231965) WARNING 01-26 05:28:30 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=231965) WARNING 01-26 05:28:47 [backends.py:609] Failed to read file <frozen os>
(EngineCore_DP0 pid=231965) ERROR 01-26 05:30:46 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=231965) ERROR 01-26 05:30:46 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=231965) ERROR 01-26 05:30:46 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=231965) ERROR 01-26 05:30:46 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=231965) ERROR 01-26 05:30:46 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=231965) ERROR 01-26 05:30:46 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=231965) ERROR 01-26 05:30:46 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=231965) ERROR 01-26 05:30:46 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=231965) ERROR 01-26 05:30:46 [core.py:866]     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=231965) ERROR 01-26 05:30:46 [core.py:866]                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=231965) ERROR 01-26 05:30:46 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 248, in _initialize_kv_caches
(EngineCore_DP0 pid=231965) ERROR 01-26 05:30:46 [core.py:866]     kv_cache_configs = get_kv_cache_configs(
(EngineCore_DP0 pid=231965) ERROR 01-26 05:30:46 [core.py:866]                        ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=231965) ERROR 01-26 05:30:46 [core.py:866]   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 1340, in get_kv_cache_configs
(EngineCore_DP0 pid=231965) ERROR 01-26 05:30:46 [core.py:866]     check_enough_kv_cache_memory(
(EngineCore_DP0 pid=231965) ERROR 01-26 05:30:46 [core.py:866]   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 687, in check_enough_kv_cache_memory
(EngineCore_DP0 pid=231965) ERROR 01-26 05:30:46 [core.py:866]     raise ValueError(
(EngineCore_DP0 pid=231965) ERROR 01-26 05:30:46 [core.py:866] ValueError: No available memory for the cache blocks. Try increasing `gpu_memory_utilization` when initializing the engine. See https://docs.vllm.ai/en/latest/configuration/conserving_memory/ for more details.


─── STDERR ───
[2026-01-26 05:28:21] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:28:21] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:28:21] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:28:21] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:28:21] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:28:21] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:28:21] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:28:21] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:28:21] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:28:21] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:28:21] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:28:21] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:28:21] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:28:21] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 05:28:29] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:28:29] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:28:29] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:28:29] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:28:29] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:28:29] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:28:29] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:28:29] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:28:29] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:28:29] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:28:29] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:28:29] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:28:29] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:28:29] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=231965) [2026-01-26 05:28:31] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=231965) [2026-01-26 05:28:31] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=231965) [2026-01-26 05:28:31] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=231965) [2026-01-26 05:28:31] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=231965) [2026-01-26 05:28:31] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuBLASLt, symmetric=True
(EngineCore_DP0 pid=231965) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=231965) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.04it/s]
(EngineCore_DP0 pid=231965) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:02<00:02,  1.04s/it]
(EngineCore_DP0 pid=231965) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.35it/s]
(EngineCore_DP0 pid=231965) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.19it/s]
(EngineCore_DP0 pid=231965) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.16it/s]
(EngineCore_DP0 pid=231965) 
(EngineCore_DP0 pid=231965) [rank0]:W0126 05:29:01.850000 231965 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=231965) [rank0]:W0126 05:29:02.280000 231965 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:02] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
[cuBLASLt] INFO: INT8 GEMM only supports INT32 output. inner_dtype parameter is ignored, always using int32.
(EngineCore_DP0 pid=231965) [rank0]:W0126 05:29:03.734000 231965 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=231965) [rank0]:W0126 05:29:03.855000 231965 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:07] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:07] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:11] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:11] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:11] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:11] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:11] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:11] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:13] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:13] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:13] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:13] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:15] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:15] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:15] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:15] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:17] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:17] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:17] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:17] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:19] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:19] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:19] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:19] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:21] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:21] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:21] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:21] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:23] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:23] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:23] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:23] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:25] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:25] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:25] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:25] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:27] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:27] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:27] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:27] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:29] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:29] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:29] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:29] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:30] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:30] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:30] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:30] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:32] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:32] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:32] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:32] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:34] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:34] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:34] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:34] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:36] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:36] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:36] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:36] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:38] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:38] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:38] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:38] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:40] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:40] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:40] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:40] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:42] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:42] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:42] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:42] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:42] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:42] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:42] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:42] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:44] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:44] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:44] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:44] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:46] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:46] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:46] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:46] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:48] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:48] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:48] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:48] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:50] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:50] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:50] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:50] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:51] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:51] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:51] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:51] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:53] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:53] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:53] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:53] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:55] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:55] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:55] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:55] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:57] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:57] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:57] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:57] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:59] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:59] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:59] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:29:59] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:01] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:01] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:01] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:01] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:03] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:03] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:03] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:03] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:05] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:05] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:05] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:05] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:06] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:06] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:06] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:06] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:09] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:09] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:09] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:09] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:10] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:10] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:10] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:10] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:12] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:12] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:12] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:12] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:13] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:13] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:13] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:13] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:15] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:15] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:15] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:15] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:16] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:16] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:16] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:16] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:18] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:18] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:18] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:18] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:20] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:20] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:20] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:20] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:22] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:22] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:22] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:22] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:24] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:24] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:24] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:24] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:26] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:26] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:26] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:26] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:28] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:28] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:28] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:28] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:30] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:30] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:30] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:30] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:31] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:31] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:31] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:31] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:33] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:33] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:33] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:33] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=7168, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:39] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:39] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=27648, K=5120), falling back to default heuristic
(EngineCore_DP0 pid=231965) [2026-01-26 05:30:44] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=5120, K=13824), falling back to default heuristic
(EngineCore_DP0 pid=231965) Process EngineCore_DP0:
(EngineCore_DP0 pid=231965) Traceback (most recent call last):
(EngineCore_DP0 pid=231965)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=231965)     self.run()
(EngineCore_DP0 pid=231965)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=231965)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=231965)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=231965)     raise e
(EngineCore_DP0 pid=231965)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=231965)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=231965)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=231965)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=231965)     super().__init__(
(EngineCore_DP0 pid=231965)   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=231965)     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=231965)                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=231965)   File "/root/vllmbench/vllm/v1/engine/core.py", line 248, in _initialize_kv_caches
(EngineCore_DP0 pid=231965)     kv_cache_configs = get_kv_cache_configs(
(EngineCore_DP0 pid=231965)                        ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=231965)   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 1340, in get_kv_cache_configs
(EngineCore_DP0 pid=231965)     check_enough_kv_cache_memory(
(EngineCore_DP0 pid=231965)   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 687, in check_enough_kv_cache_memory
(EngineCore_DP0 pid=231965)     raise ValueError(
(EngineCore_DP0 pid=231965) ValueError: No available memory for the cache blocks. Try increasing `gpu_memory_utilization` when initializing the engine. See https://docs.vllm.ai/en/latest/configuration/conserving_memory/ for more details.
[rank0]:[W126 05:30:48.831327666 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

[ERROR] 测试失败: M=65536 (exit code: 1)


------------------------------------------------------------
  生成 CSV: Qwen2.5-14B-INT8
------------------------------------------------------------
[SUCCESS] CSV 保存到: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cublaslt/Qwen2.5-14B-INT8_prefill.csv

预览:
------------------------------------------------------------
M_prefill,prompt_len,max_num_seqs,num_prompts,N_prefill,requests_per_s,tokens_per_s,elapsed_time_s
512,512,1,128,128,8.7545,4491.0754,14.6210
1024,1024,1,128,128,9.0318,9257.5827,14.1722
2048,1024,2,256,128,10.8164,11086.8437,23.6677
4096,1024,4,512,128,11.1593,11438.3233,45.8809
8192,1024,8,1024,128,11.1083,11386.0295,92.1831
16384,1024,16,2048,128,10.9927,11267.4833,186.3060
32768,1024,32,4096,128,-1.0000,-1.0000,-1.0000
65536,1024,64,8192,128,-1.0000,-1.0000,-1.0000

------------------------------------------------------------

[INFO] 完成: 6 成功, 2 失败

============================================================
  Qwen2.5-14B-INT8 | cuSPARSELt (2_4) | prefill
============================================================

[INFO] Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_4
[INFO] Output: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_4

============================================================
[1/8] 测试 M=512
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-14B-INT8                                │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 512
│   M_prefill     = 512 (= 1 x 512)
│   M_decode      = 1
│   batched_tokens = 513 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 512
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 513
│   --max-num-batched-tokens = 513
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 05:31:00 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 05:31:01 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=234420) WARNING 01-26 05:31:09 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=234420) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=234420) WARNING 01-26 05:31:36 [backends.py:609] Failed to read file <frozen os>
Throughput: 9.26 requests/s, 4750.09 total tokens/s, 9.26 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128


─── STDERR ───
[2026-01-26 05:31:00] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:31:00] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:31:00] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:31:00] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:31:00] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:31:00] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:31:00] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:31:00] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:31:00] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:31:00] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:31:00] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:31:00] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:31:00] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:31:00] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 05:31:08] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:31:08] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:31:08] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:31:08] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:31:08] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:31:08] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:31:08] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:31:08] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:31:08] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:31:08] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:31:08] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:31:08] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:31:08] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:31:08] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=234420) [2026-01-26 05:31:09] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=234420) [2026-01-26 05:31:09] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=234420) [2026-01-26 05:31:09] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=234420) [2026-01-26 05:31:09] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=234420) [2026-01-26 05:31:09] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=234420) [2026-01-26 05:31:09] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=234420) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=234420) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:03<00:11,  3.78s/it]
(EngineCore_DP0 pid=234420) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:06<00:06,  3.22s/it]
(EngineCore_DP0 pid=234420) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:07<00:02,  2.30s/it]
(EngineCore_DP0 pid=234420) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:11<00:00,  2.82s/it]
(EngineCore_DP0 pid=234420) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:11<00:00,  2.86s/it]
(EngineCore_DP0 pid=234420) 
(EngineCore_DP0 pid=234420) [2026-01-26 05:31:22] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 5120] -> 1D uint8
(EngineCore_DP0 pid=234420) [2026-01-26 05:31:22] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 27525120 bytes
(EngineCore_DP0 pid=234420) [2026-01-26 05:31:22] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 5120] -> 1D uint8
(EngineCore_DP0 pid=234420) [2026-01-26 05:31:22] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 19660800 bytes
(EngineCore_DP0 pid=234420) [2026-01-26 05:31:22] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 5120] -> 1D uint8
(EngineCore_DP0 pid=234420) [2026-01-26 05:31:22] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 106168320 bytes
(EngineCore_DP0 pid=234420) [2026-01-26 05:31:22] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 13824] -> 1D uint8
(EngineCore_DP0 pid=234420) [2026-01-26 05:31:22] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 53084160 bytes
(EngineCore_DP0 pid=234420) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  1.90it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:01<00:00,  1.71it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:01<00:00,  1.73it/s]
(EngineCore_DP0 pid=234420) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  4.61it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  4.60it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  34%|███▎      | 43/128 [00:00<00:00, 425.76it/s]
Adding requests:  69%|██████▉   | 88/128 [00:00<00:00, 438.32it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 414.76it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<01:30,  1.41it/s, est. speed input: 719.90 toks/s, output: 1.41 toks/s]
Processed prompts:   2%|▏         | 2/128 [00:00<00:44,  2.84it/s, est. speed input: 1260.02 toks/s, output: 2.46 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:29,  4.19it/s, est. speed input: 1676.54 toks/s, output: 3.27 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:01<00:22,  5.40it/s, est. speed input: 2009.83 toks/s, output: 3.93 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:01<00:19,  6.45it/s, est. speed input: 2284.28 toks/s, output: 4.46 toks/s]
Processed prompts:   5%|▍         | 6/128 [00:01<00:16,  7.31it/s, est. speed input: 2513.80 toks/s, output: 4.91 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:01<00:15,  7.98it/s, est. speed input: 2707.88 toks/s, output: 5.29 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:01<00:14,  8.51it/s, est. speed input: 2875.32 toks/s, output: 5.62 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:01<00:13,  8.90it/s, est. speed input: 3020.85 toks/s, output: 5.90 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:01<00:12,  9.18it/s, est. speed input: 3147.66 toks/s, output: 6.15 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:01<00:12,  9.42it/s, est. speed input: 3261.82 toks/s, output: 6.37 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:01<00:12,  9.48it/s, est. speed input: 3356.52 toks/s, output: 6.56 toks/s]
Processed prompts:  10%|█         | 13/128 [00:01<00:11,  9.59it/s, est. speed input: 3444.91 toks/s, output: 6.73 toks/s]
Processed prompts:  11%|█         | 14/128 [00:02<00:11,  9.61it/s, est. speed input: 3521.57 toks/s, output: 6.88 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:02<00:11,  9.69it/s, est. speed input: 3594.23 toks/s, output: 7.02 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:02<00:11,  9.71it/s, est. speed input: 3658.40 toks/s, output: 7.15 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:02<00:11,  9.72it/s, est. speed input: 3716.76 toks/s, output: 7.26 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:02<00:11,  9.75it/s, est. speed input: 3771.17 toks/s, output: 7.37 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:02<00:11,  9.73it/s, est. speed input: 3819.23 toks/s, output: 7.46 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:02<00:11,  9.76it/s, est. speed input: 3865.93 toks/s, output: 7.55 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:02<00:10,  9.75it/s, est. speed input: 3907.77 toks/s, output: 7.63 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:02<00:10,  9.74it/s, est. speed input: 3946.02 toks/s, output: 7.71 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:02<00:10,  9.68it/s, est. speed input: 3979.27 toks/s, output: 7.77 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:03<00:10,  9.69it/s, est. speed input: 4012.89 toks/s, output: 7.84 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:03<00:10,  9.70it/s, est. speed input: 4044.39 toks/s, output: 7.90 toks/s]
Processed prompts:  20%|██        | 26/128 [00:03<00:10,  9.73it/s, est. speed input: 4074.50 toks/s, output: 7.96 toks/s]
Processed prompts:  21%|██        | 27/128 [00:03<00:10,  9.78it/s, est. speed input: 4104.42 toks/s, output: 8.02 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:03<00:10,  9.83it/s, est. speed input: 4133.16 toks/s, output: 8.07 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:03<00:10,  9.85it/s, est. speed input: 4159.51 toks/s, output: 8.12 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:03<00:09,  9.88it/s, est. speed input: 4185.29 toks/s, output: 8.17 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:03<00:09,  9.90it/s, est. speed input: 4209.50 toks/s, output: 8.22 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:03<00:09,  9.86it/s, est. speed input: 4230.26 toks/s, output: 8.26 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:03<00:09,  9.89it/s, est. speed input: 4252.17 toks/s, output: 8.30 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:04<00:09,  9.85it/s, est. speed input: 4271.07 toks/s, output: 8.34 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:04<00:09,  9.86it/s, est. speed input: 4290.18 toks/s, output: 8.38 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:04<00:09,  9.82it/s, est. speed input: 4306.56 toks/s, output: 8.41 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:04<00:09,  9.81it/s, est. speed input: 4323.04 toks/s, output: 8.44 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:04<00:09,  9.85it/s, est. speed input: 4340.30 toks/s, output: 8.48 toks/s]
Processed prompts:  30%|███       | 39/128 [00:04<00:09,  9.88it/s, est. speed input: 4356.72 toks/s, output: 8.51 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:04<00:08,  9.83it/s, est. speed input: 4370.50 toks/s, output: 8.54 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:04<00:08,  9.99it/s, est. speed input: 4404.27 toks/s, output: 8.60 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:04<00:08,  9.99it/s, est. speed input: 4418.60 toks/s, output: 8.63 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:05<00:08, 10.05it/s, est. speed input: 4448.06 toks/s, output: 8.69 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:05<00:08, 10.05it/s, est. speed input: 4473.71 toks/s, output: 8.74 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:05<00:07, 10.08it/s, est. speed input: 4499.14 toks/s, output: 8.79 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:05<00:07, 10.07it/s, est. speed input: 4521.52 toks/s, output: 8.83 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:05<00:07, 10.06it/s, est. speed input: 4542.27 toks/s, output: 8.87 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:06<00:07, 10.05it/s, est. speed input: 4561.10 toks/s, output: 8.91 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:06<00:07, 10.05it/s, est. speed input: 4579.31 toks/s, output: 8.94 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:06<00:06, 10.07it/s, est. speed input: 4597.59 toks/s, output: 8.98 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:06<00:06, 10.09it/s, est. speed input: 4614.89 toks/s, output: 9.01 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:06<00:06, 10.14it/s, est. speed input: 4632.42 toks/s, output: 9.05 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:07<00:06, 10.18it/s, est. speed input: 4649.67 toks/s, output: 9.08 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:07<00:06, 10.14it/s, est. speed input: 4662.88 toks/s, output: 9.11 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:07<00:05, 10.11it/s, est. speed input: 4675.45 toks/s, output: 9.13 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:07<00:05, 10.13it/s, est. speed input: 4689.02 toks/s, output: 9.16 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:07<00:05, 10.07it/s, est. speed input: 4699.08 toks/s, output: 9.18 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:08<00:05, 10.10it/s, est. speed input: 4711.43 toks/s, output: 9.20 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:08<00:05, 10.10it/s, est. speed input: 4722.33 toks/s, output: 9.22 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:08<00:04, 10.09it/s, est. speed input: 4732.46 toks/s, output: 9.24 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:08<00:04, 10.08it/s, est. speed input: 4741.77 toks/s, output: 9.26 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:08<00:04, 10.07it/s, est. speed input: 4750.75 toks/s, output: 9.28 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:09<00:04, 10.10it/s, est. speed input: 4760.46 toks/s, output: 9.30 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:09<00:04, 10.09it/s, est. speed input: 4768.80 toks/s, output: 9.31 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:09<00:03, 10.07it/s, est. speed input: 4776.58 toks/s, output: 9.33 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:09<00:03, 10.09it/s, est. speed input: 4784.81 toks/s, output: 9.35 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:09<00:03, 10.14it/s, est. speed input: 4794.15 toks/s, output: 9.36 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:10<00:03, 10.14it/s, est. speed input: 4801.77 toks/s, output: 9.38 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:10<00:03, 10.12it/s, est. speed input: 4808.78 toks/s, output: 9.39 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:10<00:02, 10.04it/s, est. speed input: 4813.19 toks/s, output: 9.40 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:10<00:02,  9.86it/s, est. speed input: 4813.77 toks/s, output: 9.40 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:10<00:02,  9.85it/s, est. speed input: 4815.72 toks/s, output: 9.41 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:10<00:02,  9.84it/s, est. speed input: 4817.67 toks/s, output: 9.41 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:11<00:02,  9.86it/s, est. speed input: 4820.08 toks/s, output: 9.41 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:11<00:02,  9.88it/s, est. speed input: 4822.44 toks/s, output: 9.42 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:11<00:02,  9.87it/s, est. speed input: 4824.45 toks/s, output: 9.42 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:11<00:02,  9.87it/s, est. speed input: 4826.55 toks/s, output: 9.43 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:11<00:02,  9.89it/s, est. speed input: 4828.76 toks/s, output: 9.43 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:11<00:01,  9.88it/s, est. speed input: 4830.73 toks/s, output: 9.43 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:11<00:01,  9.82it/s, est. speed input: 4831.75 toks/s, output: 9.44 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:11<00:01,  9.76it/s, est. speed input: 4832.63 toks/s, output: 9.44 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:11<00:01,  9.75it/s, est. speed input: 4833.91 toks/s, output: 9.44 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:11<00:01,  9.74it/s, est. speed input: 4835.16 toks/s, output: 9.44 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:12<00:01,  9.58it/s, est. speed input: 4834.04 toks/s, output: 9.44 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:12<00:01,  9.60it/s, est. speed input: 4835.01 toks/s, output: 9.44 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:12<00:01,  9.59it/s, est. speed input: 4835.60 toks/s, output: 9.44 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:12<00:01,  9.61it/s, est. speed input: 4836.45 toks/s, output: 9.45 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:12<00:01,  9.65it/s, est. speed input: 4837.75 toks/s, output: 9.45 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:12<00:00,  9.67it/s, est. speed input: 4838.87 toks/s, output: 9.45 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:12<00:00,  9.55it/s, est. speed input: 4838.07 toks/s, output: 9.45 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:12<00:00,  9.56it/s, est. speed input: 4838.63 toks/s, output: 9.45 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:12<00:00,  9.64it/s, est. speed input: 4840.15 toks/s, output: 9.45 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:13<00:00,  9.67it/s, est. speed input: 4841.32 toks/s, output: 9.46 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:13<00:00,  9.70it/s, est. speed input: 4842.64 toks/s, output: 9.46 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:13<00:00,  9.76it/s, est. speed input: 4844.38 toks/s, output: 9.46 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:13<00:00,  9.79it/s, est. speed input: 4845.89 toks/s, output: 9.46 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:13<00:00,  9.83it/s, est. speed input: 4847.69 toks/s, output: 9.47 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:13<00:00,  9.88it/s, est. speed input: 4849.69 toks/s, output: 9.47 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:13<00:00,  9.88it/s, est. speed input: 4849.69 toks/s, output: 9.47 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:13<00:00,  9.47it/s, est. speed input: 4849.69 toks/s, output: 9.47 toks/s]
[rank0]:[W126 05:32:14.878822444 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 85.0s

测试结果:
  Requests/s:   9.26
  Tokens/s:     4750.09
  Total Reqs:   128
  Elapsed:      13.82s

  [Prefill 分析]
  Total Prefill Tokens: 65536
  Prefill Tokens/s:     4740.83

============================================================
[2/8] 测试 M=1024
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-14B-INT8                                │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 1024
│   M_prefill     = 1024 (= 1 x 1024)
│   M_decode      = 1
│   batched_tokens = 1025 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 1025
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 05:32:24 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 05:32:25 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=236012) WARNING 01-26 05:32:33 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=236012) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=236012) WARNING 01-26 05:32:51 [backends.py:609] Failed to read file <frozen os>
Throughput: 9.21 requests/s, 9436.28 total tokens/s, 9.21 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128


─── STDERR ───
[2026-01-26 05:32:24] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:32:24] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:32:24] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:32:24] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:32:24] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:32:24] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:32:24] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:32:24] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:32:24] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:32:24] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:32:24] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:32:24] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:32:24] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:32:24] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 05:32:32] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:32:32] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:32:32] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:32:32] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:32:32] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:32:32] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:32:32] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:32:32] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:32:32] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:32:32] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:32:32] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:32:32] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:32:32] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:32:32] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=236012) [2026-01-26 05:32:33] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=236012) [2026-01-26 05:32:33] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=236012) [2026-01-26 05:32:33] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=236012) [2026-01-26 05:32:33] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=236012) [2026-01-26 05:32:33] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=236012) [2026-01-26 05:32:33] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=236012) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=236012) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.05it/s]
(EngineCore_DP0 pid=236012) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:02<00:02,  1.10s/it]
(EngineCore_DP0 pid=236012) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.17it/s]
(EngineCore_DP0 pid=236012) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.09it/s]
(EngineCore_DP0 pid=236012) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.07it/s]
(EngineCore_DP0 pid=236012) 
(EngineCore_DP0 pid=236012) [2026-01-26 05:32:38] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 5120] -> 1D uint8
(EngineCore_DP0 pid=236012) [2026-01-26 05:32:38] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 27525120 bytes
(EngineCore_DP0 pid=236012) [2026-01-26 05:32:38] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 5120] -> 1D uint8
(EngineCore_DP0 pid=236012) [2026-01-26 05:32:38] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 19660800 bytes
(EngineCore_DP0 pid=236012) [2026-01-26 05:32:38] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 5120] -> 1D uint8
(EngineCore_DP0 pid=236012) [2026-01-26 05:32:38] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 106168320 bytes
(EngineCore_DP0 pid=236012) [2026-01-26 05:32:38] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 13824] -> 1D uint8
(EngineCore_DP0 pid=236012) [2026-01-26 05:32:38] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 53084160 bytes
(EngineCore_DP0 pid=236012) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  2.25it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  3.36it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  3.13it/s]
(EngineCore_DP0 pid=236012) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  4.79it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  4.79it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  18%|█▊        | 23/128 [00:00<00:00, 228.36it/s]
Adding requests:  38%|███▊      | 48/128 [00:00<00:00, 235.75it/s]
Adding requests:  58%|█████▊    | 74/128 [00:00<00:00, 243.49it/s]
Adding requests:  77%|███████▋  | 99/128 [00:00<00:00, 242.76it/s]
Adding requests:  98%|█████████▊| 125/128 [00:00<00:00, 246.60it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 242.84it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<01:00,  2.09it/s, est. speed input: 2145.16 toks/s, output: 2.09 toks/s]
Processed prompts:   2%|▏         | 2/128 [00:00<00:32,  3.89it/s, est. speed input: 3530.05 toks/s, output: 3.45 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:23,  5.39it/s, est. speed input: 4513.69 toks/s, output: 4.41 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:18,  6.55it/s, est. speed input: 5231.42 toks/s, output: 5.11 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:16,  7.46it/s, est. speed input: 5792.14 toks/s, output: 5.66 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:01<00:14,  8.54it/s, est. speed input: 6603.77 toks/s, output: 6.45 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:01<00:13,  8.86it/s, est. speed input: 6905.38 toks/s, output: 6.74 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:01<00:13,  9.14it/s, est. speed input: 7161.23 toks/s, output: 6.99 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:01<00:12,  9.31it/s, est. speed input: 7372.14 toks/s, output: 7.20 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:01<00:12,  9.41it/s, est. speed input: 7546.77 toks/s, output: 7.37 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:01<00:12,  9.52it/s, est. speed input: 7706.84 toks/s, output: 7.53 toks/s]
Processed prompts:  10%|█         | 13/128 [00:01<00:11,  9.62it/s, est. speed input: 7849.21 toks/s, output: 7.67 toks/s]
Processed prompts:  11%|█         | 14/128 [00:01<00:11,  9.66it/s, est. speed input: 7971.16 toks/s, output: 7.78 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:01<00:11,  9.70it/s, est. speed input: 8082.74 toks/s, output: 7.89 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:02<00:11,  9.76it/s, est. speed input: 8185.84 toks/s, output: 7.99 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:02<00:11,  9.81it/s, est. speed input: 8281.28 toks/s, output: 8.09 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:02<00:11,  9.86it/s, est. speed input: 8369.33 toks/s, output: 8.17 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:02<00:11,  9.85it/s, est. speed input: 8443.50 toks/s, output: 8.25 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:02<00:10,  9.87it/s, est. speed input: 8516.21 toks/s, output: 8.32 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:02<00:10,  9.86it/s, est. speed input: 8578.83 toks/s, output: 8.38 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:02<00:10,  9.79it/s, est. speed input: 8629.80 toks/s, output: 8.43 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:02<00:10,  9.81it/s, est. speed input: 8684.86 toks/s, output: 8.48 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:02<00:10,  9.83it/s, est. speed input: 8735.84 toks/s, output: 8.53 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:02<00:10,  9.87it/s, est. speed input: 8786.15 toks/s, output: 8.58 toks/s]
Processed prompts:  20%|██        | 26/128 [00:03<00:10,  9.90it/s, est. speed input: 8834.23 toks/s, output: 8.63 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:03<00:10,  9.91it/s, est. speed input: 8916.73 toks/s, output: 8.71 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:03<00:09,  9.95it/s, est. speed input: 8994.61 toks/s, output: 8.78 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:03<00:09,  9.94it/s, est. speed input: 9028.25 toks/s, output: 8.82 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:03<00:09,  9.92it/s, est. speed input: 9058.28 toks/s, output: 8.85 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:03<00:09,  9.92it/s, est. speed input: 9087.33 toks/s, output: 8.87 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:03<00:09,  9.97it/s, est. speed input: 9148.78 toks/s, output: 8.93 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:04<00:02, 36.90it/s, est. speed input: 12712.11 toks/s, output: 12.41 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:04<00:03, 22.52it/s, est. speed input: 12460.91 toks/s, output: 12.17 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:04<00:03, 17.92it/s, est. speed input: 12303.75 toks/s, output: 12.02 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:05<00:04, 15.16it/s, est. speed input: 12167.12 toks/s, output: 11.88 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:05<00:04, 13.78it/s, est. speed input: 12076.52 toks/s, output: 11.79 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:05<00:04, 12.71it/s, est. speed input: 11994.90 toks/s, output: 11.71 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:05<00:05, 11.93it/s, est. speed input: 11926.27 toks/s, output: 11.65 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:05<00:05, 11.38it/s, est. speed input: 11865.73 toks/s, output: 11.59 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:06<00:05, 10.98it/s, est. speed input: 11811.37 toks/s, output: 11.53 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:06<00:05, 10.69it/s, est. speed input: 11760.34 toks/s, output: 11.48 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:06<00:05, 10.44it/s, est. speed input: 11707.85 toks/s, output: 11.43 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:06<00:04, 10.30it/s, est. speed input: 11663.69 toks/s, output: 11.39 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:06<00:04, 10.17it/s, est. speed input: 11618.49 toks/s, output: 11.35 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:07<00:04, 10.11it/s, est. speed input: 11578.60 toks/s, output: 11.31 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:07<00:04, 10.00it/s, est. speed input: 11533.85 toks/s, output: 11.26 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:07<00:04,  9.90it/s, est. speed input: 11489.73 toks/s, output: 11.22 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:07<00:04,  9.88it/s, est. speed input: 11469.99 toks/s, output: 11.20 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:07<00:04,  9.84it/s, est. speed input: 11449.39 toks/s, output: 11.18 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:07<00:04,  9.85it/s, est. speed input: 11432.03 toks/s, output: 11.16 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:07<00:03,  9.84it/s, est. speed input: 11414.21 toks/s, output: 11.15 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:08<00:03,  9.85it/s, est. speed input: 11398.15 toks/s, output: 11.13 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:08<00:03,  9.85it/s, est. speed input: 11382.02 toks/s, output: 11.12 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:08<00:03,  9.80it/s, est. speed input: 11363.66 toks/s, output: 11.10 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:08<00:03,  9.80it/s, est. speed input: 11347.48 toks/s, output: 11.08 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:08<00:03,  9.81it/s, est. speed input: 11332.18 toks/s, output: 11.07 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:08<00:03,  9.79it/s, est. speed input: 11316.12 toks/s, output: 11.05 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:08<00:03,  9.81it/s, est. speed input: 11301.56 toks/s, output: 11.04 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:08<00:03,  9.81it/s, est. speed input: 11287.20 toks/s, output: 11.02 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:08<00:03,  9.83it/s, est. speed input: 11273.86 toks/s, output: 11.01 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:09<00:02,  9.82it/s, est. speed input: 11259.93 toks/s, output: 11.00 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:09<00:02,  9.87it/s, est. speed input: 11248.54 toks/s, output: 10.98 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:09<00:02,  9.90it/s, est. speed input: 11237.05 toks/s, output: 10.97 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:09<00:02,  9.89it/s, est. speed input: 11224.68 toks/s, output: 10.96 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:09<00:02,  9.85it/s, est. speed input: 11211.27 toks/s, output: 10.95 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:09<00:02,  9.83it/s, est. speed input: 11198.54 toks/s, output: 10.94 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:09<00:02,  9.83it/s, est. speed input: 11186.42 toks/s, output: 10.92 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:09<00:02,  9.83it/s, est. speed input: 11174.92 toks/s, output: 10.91 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:09<00:02,  9.88it/s, est. speed input: 11165.25 toks/s, output: 10.90 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:09<00:02,  9.89it/s, est. speed input: 11154.95 toks/s, output: 10.89 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:10<00:01,  9.90it/s, est. speed input: 11144.83 toks/s, output: 10.88 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:10<00:01,  9.90it/s, est. speed input: 11134.94 toks/s, output: 10.87 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:10<00:01,  9.93it/s, est. speed input: 11126.10 toks/s, output: 10.87 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:10<00:01,  9.85it/s, est. speed input: 11103.82 toks/s, output: 10.84 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:10<00:01,  9.88it/s, est. speed input: 11095.12 toks/s, output: 10.84 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:10<00:01,  9.85it/s, est. speed input: 11084.67 toks/s, output: 10.82 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:10<00:01,  9.82it/s, est. speed input: 11074.23 toks/s, output: 10.81 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:10<00:01,  9.82it/s, est. speed input: 11064.61 toks/s, output: 10.81 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:10<00:01,  9.83it/s, est. speed input: 11055.41 toks/s, output: 10.80 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:11<00:00,  9.82it/s, est. speed input: 11046.04 toks/s, output: 10.79 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:11<00:00,  9.84it/s, est. speed input: 11037.66 toks/s, output: 10.78 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:11<00:00,  9.84it/s, est. speed input: 11028.85 toks/s, output: 10.77 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:11<00:00,  9.83it/s, est. speed input: 11020.09 toks/s, output: 10.76 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:11<00:00,  9.78it/s, est. speed input: 11009.97 toks/s, output: 10.75 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:11<00:00,  9.73it/s, est. speed input: 10999.28 toks/s, output: 10.74 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:11<00:00,  9.77it/s, est. speed input: 10991.49 toks/s, output: 10.73 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:11<00:00,  9.74it/s, est. speed input: 10982.05 toks/s, output: 10.72 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:11<00:00,  9.77it/s, est. speed input: 10974.12 toks/s, output: 10.72 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:11<00:00,  9.79it/s, est. speed input: 10966.55 toks/s, output: 10.71 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:11<00:00,  9.79it/s, est. speed input: 10966.55 toks/s, output: 10.71 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:11<00:00, 10.71it/s, est. speed input: 10966.55 toks/s, output: 10.71 toks/s]
[rank0]:[W126 05:33:28.796516098 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 73.5s

测试结果:
  Requests/s:   9.21
  Tokens/s:     9436.28
  Total Reqs:   128
  Elapsed:      13.90s

  [Prefill 分析]
  Total Prefill Tokens: 131072
  Prefill Tokens/s:     9427.07

============================================================
[3/8] 测试 M=2048
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-14B-INT8                                │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 2048
│   M_prefill     = 2048 (= 2 x 1024)
│   M_decode      = 2
│   batched_tokens = 2048 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 256
│   --max-num-seqs           = 2
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 2048
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 05:33:40 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 05:33:41 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=237318) WARNING 01-26 05:33:49 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=237318) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=237318) WARNING 01-26 05:34:05 [backends.py:609] Failed to read file <frozen os>
Throughput: 15.44 requests/s, 15827.23 total tokens/s, 15.44 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256


─── STDERR ───
[2026-01-26 05:33:40] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:33:40] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:33:40] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:33:40] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:33:40] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:33:40] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:33:40] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:33:40] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:33:40] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:33:40] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:33:40] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:33:40] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:33:40] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:33:40] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 05:33:48] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:33:48] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:33:48] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:33:48] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:33:48] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:33:48] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:33:48] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:33:48] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:33:48] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:33:48] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:33:48] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:33:48] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:33:48] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:33:48] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=237318) [2026-01-26 05:33:49] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=237318) [2026-01-26 05:33:49] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=237318) [2026-01-26 05:33:49] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=237318) [2026-01-26 05:33:49] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=237318) [2026-01-26 05:33:49] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=237318) [2026-01-26 05:33:49] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=237318) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=237318) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:00<00:00,  4.03it/s]
(EngineCore_DP0 pid=237318) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:00<00:00,  3.38it/s]
(EngineCore_DP0 pid=237318) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:01<00:00,  1.89it/s]
(EngineCore_DP0 pid=237318) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:01<00:00,  2.25it/s]
(EngineCore_DP0 pid=237318) 
(EngineCore_DP0 pid=237318) [2026-01-26 05:33:52] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 5120] -> 1D uint8
(EngineCore_DP0 pid=237318) [2026-01-26 05:33:52] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 27525120 bytes
(EngineCore_DP0 pid=237318) [2026-01-26 05:33:52] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 5120] -> 1D uint8
(EngineCore_DP0 pid=237318) [2026-01-26 05:33:52] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 19660800 bytes
(EngineCore_DP0 pid=237318) [2026-01-26 05:33:52] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 5120] -> 1D uint8
(EngineCore_DP0 pid=237318) [2026-01-26 05:33:52] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 106168320 bytes
(EngineCore_DP0 pid=237318) [2026-01-26 05:33:52] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 13824] -> 1D uint8
(EngineCore_DP0 pid=237318) [2026-01-26 05:33:52] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 53084160 bytes
(EngineCore_DP0 pid=237318) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  33%|███▎      | 1/3 [00:00<00:00,  4.95it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  67%|██████▋   | 2/3 [00:00<00:00,  5.12it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00,  4.85it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00,  4.90it/s]
(EngineCore_DP0 pid=237318) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 1/2 [00:00<00:00,  4.56it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  4.49it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  4.50it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:   9%|▉         | 24/256 [00:00<00:00, 235.33it/s]
Adding requests:  20%|█▉        | 50/256 [00:00<00:00, 245.30it/s]
Adding requests:  30%|███       | 78/256 [00:00<00:00, 257.68it/s]
Adding requests:  41%|████      | 104/256 [00:00<00:00, 253.34it/s]
Adding requests:  51%|█████     | 130/256 [00:00<00:00, 252.38it/s]
Adding requests:  61%|██████▏   | 157/256 [00:00<00:00, 255.40it/s]
Adding requests:  73%|███████▎  | 186/256 [00:00<00:00, 264.65it/s]
Adding requests:  83%|████████▎ | 213/256 [00:00<00:00, 260.44it/s]
Adding requests:  94%|█████████▍| 240/256 [00:00<00:00, 258.18it/s]
Adding requests: 100%|██████████| 256/256 [00:01<00:00, 255.25it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▌         | 14/256 [00:00<00:03, 62.27it/s, est. speed input: 63772.35 toks/s, output: 62.27 toks/s]
Processed prompts:   8%|▊         | 21/256 [00:00<00:07, 31.20it/s, est. speed input: 35493.06 toks/s, output: 34.66 toks/s]
Processed prompts:  10%|▉         | 25/256 [00:00<00:09, 24.97it/s, est. speed input: 29764.77 toks/s, output: 29.07 toks/s]
Processed prompts:  11%|█         | 28/256 [00:01<00:11, 20.18it/s, est. speed input: 25744.57 toks/s, output: 25.14 toks/s]
Processed prompts:  12%|█▏        | 31/256 [00:01<00:10, 20.90it/s, est. speed input: 25592.76 toks/s, output: 24.99 toks/s]
Processed prompts:  13%|█▎        | 34/256 [00:01<00:12, 17.52it/s, est. speed input: 23297.61 toks/s, output: 22.75 toks/s]
Processed prompts:  14%|█▍        | 36/256 [00:01<00:12, 17.15it/s, est. speed input: 22737.33 toks/s, output: 22.20 toks/s]
Processed prompts:  15%|█▍        | 38/256 [00:01<00:12, 16.83it/s, est. speed input: 22258.44 toks/s, output: 21.74 toks/s]
Processed prompts:  16%|█▌        | 40/256 [00:01<00:13, 16.56it/s, est. speed input: 21841.27 toks/s, output: 21.33 toks/s]
Processed prompts:  16%|█▋        | 42/256 [00:02<00:13, 16.36it/s, est. speed input: 21481.43 toks/s, output: 20.98 toks/s]
Processed prompts:  17%|█▋        | 44/256 [00:02<00:13, 16.17it/s, est. speed input: 21157.46 toks/s, output: 20.66 toks/s]
Processed prompts:  18%|█▊        | 46/256 [00:02<00:13, 16.06it/s, est. speed input: 20876.74 toks/s, output: 20.39 toks/s]
Processed prompts:  19%|█▉        | 48/256 [00:02<00:13, 15.98it/s, est. speed input: 20624.72 toks/s, output: 20.14 toks/s]
Processed prompts:  20%|█▉        | 50/256 [00:02<00:12, 15.91it/s, est. speed input: 20397.85 toks/s, output: 19.92 toks/s]
Processed prompts:  20%|██        | 52/256 [00:02<00:12, 15.87it/s, est. speed input: 20192.62 toks/s, output: 19.72 toks/s]
Processed prompts:  21%|██        | 54/256 [00:02<00:12, 15.83it/s, est. speed input: 20005.66 toks/s, output: 19.54 toks/s]
Processed prompts:  22%|██▏       | 56/256 [00:02<00:12, 15.82it/s, est. speed input: 19837.87 toks/s, output: 19.37 toks/s]
Processed prompts:  23%|██▎       | 58/256 [00:03<00:12, 15.80it/s, est. speed input: 19682.05 toks/s, output: 19.22 toks/s]
Processed prompts:  23%|██▎       | 60/256 [00:03<00:12, 15.79it/s, est. speed input: 19538.74 toks/s, output: 19.08 toks/s]
Processed prompts:  24%|██▍       | 62/256 [00:03<00:12, 15.77it/s, est. speed input: 19404.54 toks/s, output: 18.95 toks/s]
Processed prompts:  25%|██▌       | 64/256 [00:03<00:12, 15.76it/s, est. speed input: 19282.15 toks/s, output: 18.83 toks/s]
Processed prompts:  26%|██▌       | 66/256 [00:03<00:12, 15.73it/s, est. speed input: 19164.56 toks/s, output: 18.72 toks/s]
Processed prompts:  27%|██▋       | 68/256 [00:03<00:11, 15.73it/s, est. speed input: 19057.82 toks/s, output: 18.61 toks/s]
Processed prompts:  27%|██▋       | 70/256 [00:03<00:11, 15.71it/s, est. speed input: 18956.50 toks/s, output: 18.51 toks/s]
Processed prompts:  28%|██▊       | 72/256 [00:03<00:11, 15.71it/s, est. speed input: 18863.21 toks/s, output: 18.42 toks/s]
Processed prompts:  29%|██▉       | 74/256 [00:04<00:11, 15.72it/s, est. speed input: 18776.76 toks/s, output: 18.34 toks/s]
Processed prompts:  30%|██▉       | 76/256 [00:04<00:11, 15.72it/s, est. speed input: 18694.62 toks/s, output: 18.26 toks/s]
Processed prompts:  30%|███       | 78/256 [00:04<00:11, 15.72it/s, est. speed input: 18618.17 toks/s, output: 18.18 toks/s]
Processed prompts:  31%|███▏      | 80/256 [00:04<00:11, 15.74it/s, est. speed input: 18547.57 toks/s, output: 18.11 toks/s]
Processed prompts:  32%|███▏      | 82/256 [00:04<00:11, 15.75it/s, est. speed input: 18480.86 toks/s, output: 18.05 toks/s]
Processed prompts:  33%|███▎      | 84/256 [00:04<00:10, 15.76it/s, est. speed input: 18418.17 toks/s, output: 17.99 toks/s]
Processed prompts:  34%|███▎      | 86/256 [00:04<00:10, 15.77it/s, est. speed input: 18358.24 toks/s, output: 17.93 toks/s]
Processed prompts:  34%|███▍      | 88/256 [00:04<00:10, 15.77it/s, est. speed input: 18301.30 toks/s, output: 17.87 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:05<00:10, 15.77it/s, est. speed input: 18247.12 toks/s, output: 17.82 toks/s]
Processed prompts:  36%|███▌      | 92/256 [00:05<00:10, 15.76it/s, est. speed input: 18195.11 toks/s, output: 17.77 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:05<00:10, 15.75it/s, est. speed input: 18144.48 toks/s, output: 17.72 toks/s]
Processed prompts:  38%|███▊      | 96/256 [00:05<00:10, 15.74it/s, est. speed input: 18096.72 toks/s, output: 17.67 toks/s]
Processed prompts:  38%|███▊      | 98/256 [00:05<00:10, 15.75it/s, est. speed input: 18052.08 toks/s, output: 17.63 toks/s]
Processed prompts:  39%|███▉      | 100/256 [00:05<00:09, 15.75it/s, est. speed input: 18009.18 toks/s, output: 17.59 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:05<00:09, 15.73it/s, est. speed input: 17966.71 toks/s, output: 17.55 toks/s]
Processed prompts:  41%|████      | 104/256 [00:05<00:09, 15.75it/s, est. speed input: 17928.75 toks/s, output: 17.51 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:06<00:09, 15.76it/s, est. speed input: 17891.55 toks/s, output: 17.47 toks/s]
Processed prompts:  42%|████▏     | 108/256 [00:06<00:09, 15.76it/s, est. speed input: 17855.62 toks/s, output: 17.44 toks/s]
Processed prompts:  43%|████▎     | 110/256 [00:06<00:09, 15.75it/s, est. speed input: 17820.61 toks/s, output: 17.40 toks/s]
Processed prompts:  44%|████▍     | 112/256 [00:06<00:09, 15.73it/s, est. speed input: 17785.72 toks/s, output: 17.37 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:06<00:09, 15.72it/s, est. speed input: 17752.68 toks/s, output: 17.34 toks/s]
Processed prompts:  45%|████▌     | 116/256 [00:06<00:08, 15.74it/s, est. speed input: 17722.46 toks/s, output: 17.31 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:06<00:08, 15.74it/s, est. speed input: 17692.91 toks/s, output: 17.28 toks/s]
Processed prompts:  47%|████▋     | 120/256 [00:06<00:08, 15.75it/s, est. speed input: 17664.72 toks/s, output: 17.25 toks/s]
Processed prompts:  48%|████▊     | 122/256 [00:07<00:08, 15.75it/s, est. speed input: 17637.03 toks/s, output: 17.22 toks/s]
Processed prompts:  48%|████▊     | 124/256 [00:07<00:08, 15.75it/s, est. speed input: 17610.23 toks/s, output: 17.20 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:07<00:08, 15.72it/s, est. speed input: 17582.89 toks/s, output: 17.17 toks/s]
Processed prompts:  50%|█████     | 128/256 [00:07<00:08, 15.70it/s, est. speed input: 17556.18 toks/s, output: 17.14 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:07<00:08, 15.72it/s, est. speed input: 17532.44 toks/s, output: 17.12 toks/s]
Processed prompts:  52%|█████▏    | 132/256 [00:07<00:07, 15.71it/s, est. speed input: 17508.44 toks/s, output: 17.10 toks/s]
Processed prompts:  52%|█████▏    | 134/256 [00:07<00:07, 15.71it/s, est. speed input: 17485.51 toks/s, output: 17.08 toks/s]
Processed prompts:  53%|█████▎    | 136/256 [00:07<00:07, 15.73it/s, est. speed input: 17464.20 toks/s, output: 17.05 toks/s]
Processed prompts:  54%|█████▍    | 138/256 [00:08<00:07, 15.74it/s, est. speed input: 17443.62 toks/s, output: 17.03 toks/s]
Processed prompts:  55%|█████▍    | 140/256 [00:08<00:07, 15.76it/s, est. speed input: 17424.11 toks/s, output: 17.02 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:08<00:07, 15.77it/s, est. speed input: 17405.08 toks/s, output: 17.00 toks/s]
Processed prompts:  56%|█████▋    | 144/256 [00:08<00:07, 15.75it/s, est. speed input: 17385.34 toks/s, output: 16.98 toks/s]
Processed prompts:  57%|█████▋    | 146/256 [00:08<00:06, 15.75it/s, est. speed input: 17366.86 toks/s, output: 16.96 toks/s]
Processed prompts:  58%|█████▊    | 148/256 [00:08<00:06, 15.76it/s, est. speed input: 17349.24 toks/s, output: 16.94 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:08<00:06, 15.76it/s, est. speed input: 17331.80 toks/s, output: 16.93 toks/s]
Processed prompts:  59%|█████▉    | 152/256 [00:08<00:06, 15.76it/s, est. speed input: 17315.17 toks/s, output: 16.91 toks/s]
Processed prompts:  60%|██████    | 154/256 [00:09<00:06, 15.77it/s, est. speed input: 17299.10 toks/s, output: 16.89 toks/s]
Processed prompts:  61%|██████    | 156/256 [00:09<00:06, 15.77it/s, est. speed input: 17283.37 toks/s, output: 16.88 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:09<00:06, 15.75it/s, est. speed input: 17266.92 toks/s, output: 16.86 toks/s]
Processed prompts:  62%|██████▎   | 160/256 [00:09<00:06, 15.73it/s, est. speed input: 17250.95 toks/s, output: 16.85 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:09<00:05, 15.72it/s, est. speed input: 17235.42 toks/s, output: 16.83 toks/s]
Processed prompts:  64%|██████▍   | 164/256 [00:09<00:05, 15.71it/s, est. speed input: 17220.03 toks/s, output: 16.82 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:09<00:05, 15.72it/s, est. speed input: 17205.79 toks/s, output: 16.80 toks/s]
Processed prompts:  66%|██████▌   | 168/256 [00:10<00:05, 15.72it/s, est. speed input: 17191.98 toks/s, output: 16.79 toks/s]
Processed prompts:  66%|██████▋   | 170/256 [00:10<00:05, 15.72it/s, est. speed input: 17177.86 toks/s, output: 16.78 toks/s]
Processed prompts:  67%|██████▋   | 172/256 [00:10<00:05, 15.72it/s, est. speed input: 17164.52 toks/s, output: 16.76 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:10<00:05, 15.72it/s, est. speed input: 17151.53 toks/s, output: 16.75 toks/s]
Processed prompts:  69%|██████▉   | 176/256 [00:10<00:05, 15.71it/s, est. speed input: 17138.24 toks/s, output: 16.74 toks/s]
Processed prompts:  70%|██████▉   | 178/256 [00:10<00:04, 15.72it/s, est. speed input: 17126.28 toks/s, output: 16.72 toks/s]
Processed prompts:  70%|███████   | 180/256 [00:10<00:04, 15.74it/s, est. speed input: 17114.88 toks/s, output: 16.71 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:10<00:04, 15.74it/s, est. speed input: 17103.07 toks/s, output: 16.70 toks/s]
Processed prompts:  72%|███████▏  | 184/256 [00:11<00:04, 15.75it/s, est. speed input: 17092.31 toks/s, output: 16.69 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:11<00:04, 15.75it/s, est. speed input: 17081.28 toks/s, output: 16.68 toks/s]
Processed prompts:  73%|███████▎  | 188/256 [00:11<00:04, 15.76it/s, est. speed input: 17070.83 toks/s, output: 16.67 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:11<00:04, 15.76it/s, est. speed input: 17060.66 toks/s, output: 16.66 toks/s]
Processed prompts:  75%|███████▌  | 192/256 [00:11<00:04, 15.76it/s, est. speed input: 17050.48 toks/s, output: 16.65 toks/s]
Processed prompts:  76%|███████▌  | 194/256 [00:11<00:03, 15.75it/s, est. speed input: 17040.04 toks/s, output: 16.64 toks/s]
Processed prompts:  77%|███████▋  | 196/256 [00:11<00:03, 15.72it/s, est. speed input: 17029.12 toks/s, output: 16.63 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:11<00:03, 15.73it/s, est. speed input: 17019.43 toks/s, output: 16.62 toks/s]
Processed prompts:  78%|███████▊  | 200/256 [00:12<00:03, 15.72it/s, est. speed input: 17009.50 toks/s, output: 16.61 toks/s]
Processed prompts:  79%|███████▉  | 202/256 [00:12<00:03, 15.73it/s, est. speed input: 17000.20 toks/s, output: 16.60 toks/s]
Processed prompts:  80%|███████▉  | 204/256 [00:12<00:03, 15.73it/s, est. speed input: 16991.07 toks/s, output: 16.59 toks/s]
Processed prompts:  80%|████████  | 206/256 [00:12<00:03, 15.74it/s, est. speed input: 16982.38 toks/s, output: 16.58 toks/s]
Processed prompts:  81%|████████▏ | 208/256 [00:12<00:03, 15.75it/s, est. speed input: 16973.93 toks/s, output: 16.58 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:12<00:02, 15.72it/s, est. speed input: 16964.58 toks/s, output: 16.57 toks/s]
Processed prompts:  83%|████████▎ | 212/256 [00:12<00:02, 15.70it/s, est. speed input: 16955.26 toks/s, output: 16.56 toks/s]
Processed prompts:  84%|████████▎ | 214/256 [00:12<00:02, 15.70it/s, est. speed input: 16946.59 toks/s, output: 16.55 toks/s]
Processed prompts:  84%|████████▍ | 216/256 [00:13<00:02, 15.69it/s, est. speed input: 16937.76 toks/s, output: 16.54 toks/s]
Processed prompts:  85%|████████▌ | 218/256 [00:13<00:02, 15.70it/s, est. speed input: 16929.71 toks/s, output: 16.53 toks/s]
Processed prompts:  86%|████████▌ | 220/256 [00:13<00:02, 15.71it/s, est. speed input: 16921.84 toks/s, output: 16.53 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:13<00:02, 15.71it/s, est. speed input: 16914.05 toks/s, output: 16.52 toks/s]
Processed prompts:  88%|████████▊ | 224/256 [00:13<00:02, 15.71it/s, est. speed input: 16906.19 toks/s, output: 16.51 toks/s]
Processed prompts:  88%|████████▊ | 226/256 [00:13<00:01, 15.72it/s, est. speed input: 16898.90 toks/s, output: 16.50 toks/s]
Processed prompts:  89%|████████▉ | 228/256 [00:13<00:01, 15.71it/s, est. speed input: 16891.26 toks/s, output: 16.50 toks/s]
Processed prompts:  90%|████████▉ | 230/256 [00:13<00:01, 15.72it/s, est. speed input: 16884.27 toks/s, output: 16.49 toks/s]
Processed prompts:  91%|█████████ | 232/256 [00:14<00:01, 15.71it/s, est. speed input: 16876.71 toks/s, output: 16.48 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:14<00:01, 15.72it/s, est. speed input: 16869.95 toks/s, output: 16.47 toks/s]
Processed prompts:  92%|█████████▏| 236/256 [00:14<00:01, 15.72it/s, est. speed input: 16863.10 toks/s, output: 16.47 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:14<00:01, 15.72it/s, est. speed input: 16856.48 toks/s, output: 16.46 toks/s]
Processed prompts:  94%|█████████▍| 240/256 [00:14<00:01, 15.71it/s, est. speed input: 16849.56 toks/s, output: 16.45 toks/s]
Processed prompts:  95%|█████████▍| 242/256 [00:14<00:00, 15.72it/s, est. speed input: 16843.28 toks/s, output: 16.45 toks/s]
Processed prompts:  95%|█████████▌| 244/256 [00:14<00:00, 15.72it/s, est. speed input: 16836.77 toks/s, output: 16.44 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:14<00:00, 15.73it/s, est. speed input: 16830.77 toks/s, output: 16.44 toks/s]
Processed prompts:  97%|█████████▋| 248/256 [00:15<00:00, 15.72it/s, est. speed input: 16824.40 toks/s, output: 16.43 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:15<00:00, 15.72it/s, est. speed input: 16818.38 toks/s, output: 16.42 toks/s]
Processed prompts:  98%|█████████▊| 252/256 [00:15<00:00, 15.70it/s, est. speed input: 16811.92 toks/s, output: 16.42 toks/s]
Processed prompts:  99%|█████████▉| 254/256 [00:15<00:00, 15.72it/s, est. speed input: 16806.37 toks/s, output: 16.41 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:15<00:00, 15.72it/s, est. speed input: 16831.91 toks/s, output: 16.44 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:15<00:00, 16.44it/s, est. speed input: 16831.91 toks/s, output: 16.44 toks/s]
[rank0]:[W126 05:34:45.874228889 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 77.5s

测试结果:
  Requests/s:   15.44
  Tokens/s:     15827.23
  Total Reqs:   256
  Elapsed:      16.58s

  [Prefill 分析]
  Total Prefill Tokens: 262144
  Prefill Tokens/s:     15811.78

============================================================
[4/8] 测试 M=4096
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-14B-INT8                                │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 4096
│   M_prefill     = 4096 (= 4 x 1024)
│   M_decode      = 4
│   batched_tokens = 4096 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 512
│   --max-num-seqs           = 4
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 4096
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 05:34:58 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 05:34:59 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=238648) WARNING 01-26 05:35:07 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=238648) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=238648) WARNING 01-26 05:35:24 [backends.py:609] Failed to read file <frozen os>
Throughput: 15.63 requests/s, 16025.19 total tokens/s, 15.63 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512


─── STDERR ───
[2026-01-26 05:34:58] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:34:58] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:34:58] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:34:58] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:34:58] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:34:58] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:34:58] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:34:58] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:34:58] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:34:58] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:34:58] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:34:58] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:34:58] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:34:58] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 05:35:06] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:35:06] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:35:06] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:35:06] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:35:06] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:35:06] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:35:06] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:35:06] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:35:06] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:35:06] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:35:06] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:35:06] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:35:06] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:35:06] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=238648) [2026-01-26 05:35:07] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=238648) [2026-01-26 05:35:07] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=238648) [2026-01-26 05:35:07] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=238648) [2026-01-26 05:35:07] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=238648) [2026-01-26 05:35:07] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=238648) [2026-01-26 05:35:07] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=238648) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=238648) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.06it/s]
(EngineCore_DP0 pid=238648) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.01it/s]
(EngineCore_DP0 pid=238648) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.42it/s]
(EngineCore_DP0 pid=238648) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.25it/s]
(EngineCore_DP0 pid=238648) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.22it/s]
(EngineCore_DP0 pid=238648) 
(EngineCore_DP0 pid=238648) [2026-01-26 05:35:11] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 5120] -> 1D uint8
(EngineCore_DP0 pid=238648) [2026-01-26 05:35:11] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 27525120 bytes
(EngineCore_DP0 pid=238648) [2026-01-26 05:35:11] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 5120] -> 1D uint8
(EngineCore_DP0 pid=238648) [2026-01-26 05:35:11] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 19660800 bytes
(EngineCore_DP0 pid=238648) [2026-01-26 05:35:11] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 5120] -> 1D uint8
(EngineCore_DP0 pid=238648) [2026-01-26 05:35:11] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 106168320 bytes
(EngineCore_DP0 pid=238648) [2026-01-26 05:35:11] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 13824] -> 1D uint8
(EngineCore_DP0 pid=238648) [2026-01-26 05:35:11] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 53084160 bytes
(EngineCore_DP0 pid=238648) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  25%|██▌       | 1/4 [00:00<00:00,  4.95it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 2/4 [00:00<00:00,  5.17it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  75%|███████▌  | 3/4 [00:00<00:00,  5.33it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  4.97it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  5.05it/s]
(EngineCore_DP0 pid=238648) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  33%|███▎      | 1/3 [00:00<00:00,  4.61it/s]
Capturing CUDA graphs (decode, FULL):  67%|██████▋   | 2/3 [00:00<00:00,  5.02it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  5.20it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  5.11it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   5%|▍         | 24/512 [00:00<00:02, 236.26it/s]
Adding requests:  10%|▉         | 50/512 [00:00<00:01, 248.29it/s]
Adding requests:  15%|█▌        | 77/512 [00:00<00:01, 256.75it/s]
Adding requests:  20%|██        | 103/512 [00:00<00:01, 252.68it/s]
Adding requests:  25%|██▌       | 130/512 [00:00<00:01, 255.08it/s]
Adding requests:  31%|███       | 157/512 [00:00<00:01, 259.57it/s]
Adding requests:  36%|███▌      | 185/512 [00:00<00:01, 265.24it/s]
Adding requests:  42%|████▏     | 213/512 [00:00<00:01, 268.64it/s]
Adding requests:  47%|████▋     | 240/512 [00:00<00:01, 266.47it/s]
Adding requests:  52%|█████▏    | 267/512 [00:01<00:00, 266.47it/s]
Adding requests:  57%|█████▋    | 294/512 [00:01<00:00, 265.80it/s]
Adding requests:  63%|██████▎   | 322/512 [00:01<00:00, 269.04it/s]
Adding requests:  68%|██████▊   | 350/512 [00:01<00:00, 269.96it/s]
Adding requests:  74%|███████▎  | 377/512 [00:01<00:00, 263.38it/s]
Adding requests:  79%|███████▉  | 405/512 [00:01<00:00, 266.23it/s]
Adding requests:  85%|████████▍ | 433/512 [00:01<00:00, 268.93it/s]
Adding requests:  90%|████████▉ | 460/512 [00:01<00:00, 266.26it/s]
Adding requests:  96%|█████████▌| 489/512 [00:01<00:00, 271.67it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 264.87it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▌         | 26/512 [00:00<00:03, 155.67it/s, est. speed input: 159435.11 toks/s, output: 155.68 toks/s]
Processed prompts:   8%|▊         | 42/512 [00:01<00:15, 30.35it/s, est. speed input: 36542.36 toks/s, output: 35.69 toks/s]   
Processed prompts:  10%|▉         | 50/512 [00:01<00:18, 24.69it/s, est. speed input: 30443.30 toks/s, output: 29.73 toks/s]
Processed prompts:  11%|█         | 55/512 [00:01<00:19, 23.61it/s, est. speed input: 29109.48 toks/s, output: 28.43 toks/s]
Processed prompts:  12%|█▏        | 59/512 [00:02<00:20, 21.77it/s, est. speed input: 27624.77 toks/s, output: 26.98 toks/s]
Processed prompts:  12%|█▏        | 62/512 [00:02<00:23, 19.27it/s, est. speed input: 26025.01 toks/s, output: 25.41 toks/s]
Processed prompts:  13%|█▎        | 66/512 [00:02<00:24, 18.37it/s, est. speed input: 25109.69 toks/s, output: 24.52 toks/s]
Processed prompts:  14%|█▎        | 70/512 [00:02<00:25, 17.67it/s, est. speed input: 24348.49 toks/s, output: 23.78 toks/s]
Processed prompts:  14%|█▍        | 74/512 [00:03<00:25, 17.16it/s, est. speed input: 23706.94 toks/s, output: 23.15 toks/s]
Processed prompts:  15%|█▌        | 78/512 [00:03<00:25, 16.78it/s, est. speed input: 23159.34 toks/s, output: 22.62 toks/s]
Processed prompts:  16%|█▌        | 82/512 [00:03<00:26, 16.50it/s, est. speed input: 22683.53 toks/s, output: 22.15 toks/s]
Processed prompts:  21%|██        | 106/512 [00:03<00:08, 47.78it/s, est. speed input: 28516.73 toks/s, output: 27.85 toks/s]
Processed prompts:  22%|██▏       | 115/512 [00:04<00:12, 32.69it/s, est. speed input: 27312.45 toks/s, output: 26.67 toks/s]
Processed prompts:  24%|██▍       | 122/512 [00:04<00:15, 24.79it/s, est. speed input: 25930.83 toks/s, output: 25.32 toks/s]
Processed prompts:  25%|██▍       | 127/512 [00:05<00:16, 23.63it/s, est. speed input: 25645.06 toks/s, output: 25.04 toks/s]
Processed prompts:  26%|██▌       | 131/512 [00:05<00:17, 21.70it/s, est. speed input: 25195.89 toks/s, output: 24.61 toks/s]
Processed prompts:  26%|██▋       | 135/512 [00:05<00:18, 20.15it/s, est. speed input: 24786.24 toks/s, output: 24.21 toks/s]
Processed prompts:  27%|██▋       | 138/512 [00:05<00:20, 17.90it/s, est. speed input: 24236.74 toks/s, output: 23.67 toks/s]
Processed prompts:  28%|██▊       | 142/512 [00:06<00:21, 17.31it/s, est. speed input: 23901.60 toks/s, output: 23.34 toks/s]
Processed prompts:  29%|██▊       | 146/512 [00:06<00:21, 16.89it/s, est. speed input: 23594.44 toks/s, output: 23.04 toks/s]
Processed prompts:  29%|██▉       | 150/512 [00:06<00:21, 16.57it/s, est. speed input: 23309.57 toks/s, output: 22.76 toks/s]
Processed prompts:  30%|███       | 154/512 [00:06<00:21, 16.34it/s, est. speed input: 23045.06 toks/s, output: 22.50 toks/s]
Processed prompts:  31%|███       | 158/512 [00:07<00:21, 16.18it/s, est. speed input: 22799.47 toks/s, output: 22.27 toks/s]
Processed prompts:  32%|███▏      | 162/512 [00:07<00:21, 16.07it/s, est. speed input: 22571.92 toks/s, output: 22.04 toks/s]
Processed prompts:  32%|███▏      | 166/512 [00:07<00:21, 16.00it/s, est. speed input: 22360.17 toks/s, output: 21.84 toks/s]
Processed prompts:  33%|███▎      | 170/512 [00:07<00:21, 15.95it/s, est. speed input: 22162.31 toks/s, output: 21.64 toks/s]
Processed prompts:  34%|███▍      | 174/512 [00:08<00:21, 15.89it/s, est. speed input: 21973.41 toks/s, output: 21.46 toks/s]
Processed prompts:  35%|███▍      | 178/512 [00:08<00:21, 15.86it/s, est. speed input: 21797.81 toks/s, output: 21.29 toks/s]
Processed prompts:  36%|███▌      | 182/512 [00:08<00:20, 15.84it/s, est. speed input: 21632.14 toks/s, output: 21.13 toks/s]
Processed prompts:  36%|███▋      | 186/512 [00:08<00:20, 15.83it/s, est. speed input: 21476.61 toks/s, output: 20.97 toks/s]
Processed prompts:  37%|███▋      | 190/512 [00:09<00:20, 15.81it/s, est. speed input: 21328.08 toks/s, output: 20.83 toks/s]
Processed prompts:  38%|███▊      | 194/512 [00:09<00:20, 15.81it/s, est. speed input: 21189.52 toks/s, output: 20.69 toks/s]
Processed prompts:  39%|███▊      | 198/512 [00:09<00:19, 15.82it/s, est. speed input: 21058.88 toks/s, output: 20.57 toks/s]
Processed prompts:  39%|███▉      | 202/512 [00:09<00:19, 15.81it/s, est. speed input: 20933.69 toks/s, output: 20.44 toks/s]
Processed prompts:  40%|████      | 206/512 [00:10<00:19, 15.81it/s, est. speed input: 20815.61 toks/s, output: 20.33 toks/s]
Processed prompts:  41%|████      | 210/512 [00:10<00:19, 15.81it/s, est. speed input: 20702.84 toks/s, output: 20.22 toks/s]
Processed prompts:  42%|████▏     | 214/512 [00:10<00:18, 15.80it/s, est. speed input: 20594.83 toks/s, output: 20.11 toks/s]
Processed prompts:  43%|████▎     | 218/512 [00:10<00:18, 15.80it/s, est. speed input: 20491.60 toks/s, output: 20.01 toks/s]
Processed prompts:  43%|████▎     | 222/512 [00:11<00:18, 15.80it/s, est. speed input: 20393.65 toks/s, output: 19.92 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:11<00:18, 15.79it/s, est. speed input: 20299.50 toks/s, output: 19.82 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:11<00:17, 15.79it/s, est. speed input: 20209.52 toks/s, output: 19.74 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:11<00:17, 15.78it/s, est. speed input: 20122.92 toks/s, output: 19.65 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:12<00:17, 15.78it/s, est. speed input: 20040.08 toks/s, output: 19.57 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:12<00:17, 15.78it/s, est. speed input: 19960.55 toks/s, output: 19.49 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:12<00:16, 15.78it/s, est. speed input: 19884.33 toks/s, output: 19.42 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:12<00:16, 15.78it/s, est. speed input: 19811.13 toks/s, output: 19.35 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:13<00:16, 15.77it/s, est. speed input: 19740.67 toks/s, output: 19.28 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:13<00:16, 15.78it/s, est. speed input: 19673.37 toks/s, output: 19.21 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:13<00:15, 15.78it/s, est. speed input: 19607.94 toks/s, output: 19.15 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:13<00:15, 15.77it/s, est. speed input: 19544.82 toks/s, output: 19.09 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:14<00:15, 15.76it/s, est. speed input: 19483.61 toks/s, output: 19.03 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:14<00:15, 15.76it/s, est. speed input: 19424.92 toks/s, output: 18.97 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:14<00:14, 15.76it/s, est. speed input: 19367.75 toks/s, output: 18.91 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:14<00:14, 15.75it/s, est. speed input: 19312.54 toks/s, output: 18.86 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:15<00:14, 15.75it/s, est. speed input: 19259.15 toks/s, output: 18.81 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:15<00:14, 15.75it/s, est. speed input: 19207.45 toks/s, output: 18.76 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:15<00:13, 15.74it/s, est. speed input: 19157.43 toks/s, output: 18.71 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:15<00:13, 15.74it/s, est. speed input: 19109.07 toks/s, output: 18.66 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:16<00:13, 15.75it/s, est. speed input: 19062.56 toks/s, output: 18.62 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:16<00:13, 15.75it/s, est. speed input: 19017.40 toks/s, output: 18.57 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:16<00:12, 15.75it/s, est. speed input: 18973.33 toks/s, output: 18.53 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:16<00:12, 15.75it/s, est. speed input: 18930.93 toks/s, output: 18.49 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:17<00:12, 15.75it/s, est. speed input: 18889.56 toks/s, output: 18.45 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:17<00:12, 15.75it/s, est. speed input: 18849.68 toks/s, output: 18.41 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:17<00:11, 15.74it/s, est. speed input: 18810.17 toks/s, output: 18.37 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:18<00:11, 15.73it/s, est. speed input: 18771.78 toks/s, output: 18.33 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:18<00:11, 15.73it/s, est. speed input: 18734.68 toks/s, output: 18.30 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:18<00:11, 15.73it/s, est. speed input: 18698.49 toks/s, output: 18.26 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:18<00:10, 15.73it/s, est. speed input: 18663.60 toks/s, output: 18.23 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:19<00:10, 15.72it/s, est. speed input: 18628.89 toks/s, output: 18.19 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:19<00:10, 15.72it/s, est. speed input: 18595.42 toks/s, output: 18.16 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:19<00:10, 15.73it/s, est. speed input: 18563.37 toks/s, output: 18.13 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:19<00:09, 15.74it/s, est. speed input: 18532.08 toks/s, output: 18.10 toks/s]
Processed prompts:  71%|███████   | 362/512 [00:20<00:09, 15.73it/s, est. speed input: 18501.02 toks/s, output: 18.07 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:20<00:09, 15.73it/s, est. speed input: 18470.91 toks/s, output: 18.04 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [00:20<00:09, 15.72it/s, est. speed input: 18441.07 toks/s, output: 18.01 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [00:20<00:08, 15.71it/s, est. speed input: 18412.04 toks/s, output: 17.98 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [00:21<00:08, 15.71it/s, est. speed input: 18383.77 toks/s, output: 17.95 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [00:21<00:08, 15.71it/s, est. speed input: 18356.33 toks/s, output: 17.93 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [00:21<00:08, 15.70it/s, est. speed input: 18329.39 toks/s, output: 17.90 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [00:21<00:07, 15.71it/s, est. speed input: 18303.26 toks/s, output: 17.87 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [00:22<00:07, 15.71it/s, est. speed input: 18277.70 toks/s, output: 17.85 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [00:22<00:07, 15.71it/s, est. speed input: 18252.85 toks/s, output: 17.83 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [00:22<00:06, 15.72it/s, est. speed input: 18228.86 toks/s, output: 17.80 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [00:22<00:06, 15.72it/s, est. speed input: 18205.09 toks/s, output: 17.78 toks/s]
Processed prompts:  80%|████████  | 410/512 [00:23<00:06, 15.71it/s, est. speed input: 18181.43 toks/s, output: 17.76 toks/s]
Processed prompts:  81%|████████  | 414/512 [00:23<00:06, 15.71it/s, est. speed input: 18158.43 toks/s, output: 17.73 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [00:23<00:05, 15.71it/s, est. speed input: 18136.08 toks/s, output: 17.71 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [00:23<00:05, 15.70it/s, est. speed input: 18114.01 toks/s, output: 17.69 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [00:24<00:05, 15.69it/s, est. speed input: 18092.14 toks/s, output: 17.67 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [00:24<00:05, 15.69it/s, est. speed input: 18070.93 toks/s, output: 17.65 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [00:24<00:04, 15.69it/s, est. speed input: 18049.92 toks/s, output: 17.63 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [00:24<00:04, 15.68it/s, est. speed input: 18029.43 toks/s, output: 17.61 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [00:25<00:04, 15.68it/s, est. speed input: 18009.38 toks/s, output: 17.59 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [00:25<00:04, 15.69it/s, est. speed input: 17989.93 toks/s, output: 17.57 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [00:25<00:03, 15.68it/s, est. speed input: 17970.70 toks/s, output: 17.55 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [00:25<00:03, 15.68it/s, est. speed input: 17951.83 toks/s, output: 17.53 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [00:26<00:03, 15.69it/s, est. speed input: 17933.59 toks/s, output: 17.51 toks/s]
Processed prompts:  90%|█████████ | 462/512 [00:26<00:03, 15.69it/s, est. speed input: 17915.66 toks/s, output: 17.50 toks/s]
Processed prompts:  91%|█████████ | 466/512 [00:26<00:02, 15.70it/s, est. speed input: 17898.17 toks/s, output: 17.48 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [00:26<00:02, 15.69it/s, est. speed input: 17880.74 toks/s, output: 17.46 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [00:27<00:02, 15.69it/s, est. speed input: 17863.51 toks/s, output: 17.44 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [00:27<00:02, 15.69it/s, est. speed input: 17846.90 toks/s, output: 17.43 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [00:27<00:01, 15.67it/s, est. speed input: 17829.90 toks/s, output: 17.41 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [00:27<00:01, 15.68it/s, est. speed input: 17813.78 toks/s, output: 17.40 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [00:28<00:01, 15.68it/s, est. speed input: 17798.00 toks/s, output: 17.38 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [00:28<00:01, 15.69it/s, est. speed input: 17782.53 toks/s, output: 17.37 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [00:28<00:00, 15.70it/s, est. speed input: 17767.69 toks/s, output: 17.35 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [00:28<00:00, 15.71it/s, est. speed input: 17753.05 toks/s, output: 17.34 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [00:29<00:00, 15.71it/s, est. speed input: 17738.52 toks/s, output: 17.32 toks/s]
Processed prompts: 100%|█████████▉| 510/512 [00:29<00:00, 16.93it/s, est. speed input: 17761.16 toks/s, output: 17.34 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:29<00:00, 16.93it/s, est. speed input: 17830.69 toks/s, output: 17.41 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:29<00:00, 17.41it/s, est. speed input: 17830.69 toks/s, output: 17.41 toks/s]
[rank0]:[W126 05:36:21.894993914 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 95.7s

测试结果:
  Requests/s:   15.63
  Tokens/s:     16025.19
  Total Reqs:   512
  Elapsed:      32.75s

  [Prefill 分析]
  Total Prefill Tokens: 524288
  Prefill Tokens/s:     16009.56

============================================================
[5/8] 测试 M=8192
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-14B-INT8                                │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 8192
│   M_prefill     = 8192 (= 8 x 1024)
│   M_decode      = 8
│   batched_tokens = 8192 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 1024
│   --max-num-seqs           = 8
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 8192
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 05:36:37 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 05:36:38 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=240267) WARNING 01-26 05:36:46 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=240267) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=240267) WARNING 01-26 05:37:04 [backends.py:609] Failed to read file <frozen os>
Throughput: 15.52 requests/s, 15905.45 total tokens/s, 15.52 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024


─── STDERR ───
[2026-01-26 05:36:37] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:36:37] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:36:37] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:36:37] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:36:37] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:36:37] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:36:37] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:36:37] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:36:37] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:36:37] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:36:37] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:36:37] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:36:37] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:36:37] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 05:36:45] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:36:45] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:36:45] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:36:45] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:36:45] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:36:45] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:36:45] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:36:45] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:36:45] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:36:45] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:36:45] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:36:45] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:36:45] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:36:45] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=240267) [2026-01-26 05:36:47] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=240267) [2026-01-26 05:36:47] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=240267) [2026-01-26 05:36:47] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=240267) [2026-01-26 05:36:47] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=240267) [2026-01-26 05:36:47] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=240267) [2026-01-26 05:36:47] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=240267) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=240267) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.03it/s]
(EngineCore_DP0 pid=240267) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.01it/s]
(EngineCore_DP0 pid=240267) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.43it/s]
(EngineCore_DP0 pid=240267) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.28it/s]
(EngineCore_DP0 pid=240267) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.23it/s]
(EngineCore_DP0 pid=240267) 
(EngineCore_DP0 pid=240267) [2026-01-26 05:36:51] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 5120] -> 1D uint8
(EngineCore_DP0 pid=240267) [2026-01-26 05:36:51] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 27525120 bytes
(EngineCore_DP0 pid=240267) [2026-01-26 05:36:51] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 5120] -> 1D uint8
(EngineCore_DP0 pid=240267) [2026-01-26 05:36:51] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 19660800 bytes
(EngineCore_DP0 pid=240267) [2026-01-26 05:36:51] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 5120] -> 1D uint8
(EngineCore_DP0 pid=240267) [2026-01-26 05:36:51] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 106168320 bytes
(EngineCore_DP0 pid=240267) [2026-01-26 05:36:51] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 13824] -> 1D uint8
(EngineCore_DP0 pid=240267) [2026-01-26 05:36:51] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 53084160 bytes
(EngineCore_DP0 pid=240267) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:02,  1.83it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  40%|████      | 2/5 [00:00<00:01,  2.96it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  60%|██████    | 3/5 [00:00<00:00,  3.71it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  80%|████████  | 4/5 [00:01<00:00,  4.19it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:01<00:00,  4.34it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:01<00:00,  3.75it/s]
(EngineCore_DP0 pid=240267) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:00,  4.51it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 2/4 [00:00<00:00,  5.02it/s]
Capturing CUDA graphs (decode, FULL):  75%|███████▌  | 3/4 [00:00<00:00,  5.22it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  5.35it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  5.21it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 24/1024 [00:00<00:04, 237.50it/s]
Adding requests:   5%|▍         | 49/1024 [00:00<00:03, 244.43it/s]
Adding requests:   7%|▋         | 76/1024 [00:00<00:03, 253.76it/s]
Adding requests:  10%|▉         | 102/1024 [00:00<00:03, 249.94it/s]
Adding requests:  12%|█▎        | 128/1024 [00:00<00:03, 248.46it/s]
Adding requests:  15%|█▌        | 154/1024 [00:00<00:03, 249.33it/s]
Adding requests:  18%|█▊        | 182/1024 [00:00<00:03, 258.56it/s]
Adding requests:  21%|██        | 211/1024 [00:00<00:03, 266.17it/s]
Adding requests:  23%|██▎       | 238/1024 [00:00<00:02, 264.35it/s]
Adding requests:  26%|██▌       | 265/1024 [00:01<00:02, 262.57it/s]
Adding requests:  29%|██▊       | 293/1024 [00:01<00:02, 264.82it/s]
Adding requests:  31%|███▏      | 322/1024 [00:01<00:02, 269.97it/s]
Adding requests:  34%|███▍      | 350/1024 [00:01<00:02, 270.06it/s]
Adding requests:  37%|███▋      | 378/1024 [00:01<00:02, 272.34it/s]
Adding requests:  40%|███▉      | 406/1024 [00:01<00:02, 272.31it/s]
Adding requests:  42%|████▏     | 434/1024 [00:01<00:02, 270.83it/s]
Adding requests:  45%|████▌     | 462/1024 [00:01<00:02, 270.17it/s]
Adding requests:  48%|████▊     | 492/1024 [00:01<00:01, 276.92it/s]
Adding requests:  51%|█████     | 521/1024 [00:01<00:01, 279.34it/s]
Adding requests:  54%|█████▎    | 549/1024 [00:02<00:01, 274.49it/s]
Adding requests:  56%|█████▋    | 577/1024 [00:02<00:01, 275.49it/s]
Adding requests:  59%|█████▉    | 605/1024 [00:02<00:01, 268.11it/s]
Adding requests:  62%|██████▏   | 632/1024 [00:02<00:01, 263.93it/s]
Adding requests:  64%|██████▍   | 659/1024 [00:02<00:01, 259.40it/s]
Adding requests:  67%|██████▋   | 686/1024 [00:02<00:01, 260.80it/s]
Adding requests:  70%|██████▉   | 713/1024 [00:02<00:01, 263.05it/s]
Adding requests:  72%|███████▏  | 740/1024 [00:02<00:01, 256.17it/s]
Adding requests:  75%|███████▍  | 766/1024 [00:02<00:01, 255.69it/s]
Adding requests:  77%|███████▋  | 793/1024 [00:03<00:00, 256.91it/s]
Adding requests:  80%|████████  | 821/1024 [00:03<00:00, 262.23it/s]
Adding requests:  83%|████████▎ | 850/1024 [00:03<00:00, 267.28it/s]
Adding requests:  86%|████████▌ | 878/1024 [00:03<00:00, 268.26it/s]
Adding requests:  89%|████████▊ | 907/1024 [00:03<00:00, 273.83it/s]
Adding requests:  91%|█████████▏| 935/1024 [00:03<00:00, 264.24it/s]
Adding requests:  94%|█████████▍| 962/1024 [00:03<00:00, 263.08it/s]
Adding requests:  97%|█████████▋| 989/1024 [00:03<00:00, 263.75it/s]
Adding requests:  99%|█████████▉| 1016/1024 [00:03<00:00, 261.35it/s]
Adding requests: 100%|██████████| 1024/1024 [00:03<00:00, 263.88it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▌         | 58/1024 [00:00<00:08, 112.64it/s, est. speed input: 115352.44 toks/s, output: 112.64 toks/s]
Processed prompts:   7%|▋         | 70/1024 [00:01<00:15, 60.36it/s, est. speed input: 69868.82 toks/s, output: 68.23 toks/s]   
Processed prompts:   8%|▊         | 77/1024 [00:01<00:24, 39.09it/s, est. speed input: 51303.76 toks/s, output: 50.10 toks/s]
Processed prompts:   8%|▊         | 82/1024 [00:02<00:34, 27.53it/s, est. speed input: 40999.59 toks/s, output: 40.04 toks/s]
Processed prompts:   9%|▉         | 90/1024 [00:02<00:40, 23.25it/s, est. speed input: 36012.24 toks/s, output: 35.17 toks/s]
Processed prompts:  10%|▉         | 98/1024 [00:03<00:44, 20.67it/s, est. speed input: 32688.45 toks/s, output: 31.92 toks/s]
Processed prompts:  10%|█         | 106/1024 [00:03<00:48, 19.03it/s, est. speed input: 30313.38 toks/s, output: 29.60 toks/s]
Processed prompts:  11%|█         | 114/1024 [00:04<00:50, 17.96it/s, est. speed input: 28528.61 toks/s, output: 27.86 toks/s]
Processed prompts:  12%|█▏        | 122/1024 [00:04<00:52, 17.23it/s, est. speed input: 27139.36 toks/s, output: 26.50 toks/s]
Processed prompts:  13%|█▎        | 130/1024 [00:05<00:53, 16.74it/s, est. speed input: 26026.56 toks/s, output: 25.42 toks/s]
Processed prompts:  13%|█▎        | 138/1024 [00:05<00:54, 16.40it/s, est. speed input: 25115.80 toks/s, output: 24.53 toks/s]
Processed prompts:  14%|█▍        | 146/1024 [00:06<00:54, 16.17it/s, est. speed input: 24357.58 toks/s, output: 23.79 toks/s]
Processed prompts:  15%|█▌        | 154/1024 [00:06<00:54, 16.01it/s, est. speed input: 23716.19 toks/s, output: 23.16 toks/s]
Processed prompts:  16%|█▌        | 162/1024 [00:07<00:54, 15.90it/s, est. speed input: 23166.01 toks/s, output: 22.62 toks/s]
Processed prompts:  17%|█▋        | 170/1024 [00:07<00:53, 15.82it/s, est. speed input: 22688.70 toks/s, output: 22.16 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [00:08<00:53, 15.76it/s, est. speed input: 22271.17 toks/s, output: 21.75 toks/s]
Processed prompts:  18%|█▊        | 186/1024 [00:08<00:53, 15.72it/s, est. speed input: 21902.66 toks/s, output: 21.39 toks/s]
Processed prompts:  19%|█▉        | 194/1024 [00:09<00:52, 15.69it/s, est. speed input: 21573.78 toks/s, output: 21.07 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [00:09<00:52, 15.67it/s, est. speed input: 21279.79 toks/s, output: 20.78 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:10<00:51, 15.65it/s, est. speed input: 21015.15 toks/s, output: 20.52 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [00:10<00:51, 15.63it/s, est. speed input: 20772.98 toks/s, output: 20.29 toks/s]
Processed prompts:  22%|██▏       | 226/1024 [00:11<00:51, 15.62it/s, est. speed input: 20554.62 toks/s, output: 20.07 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:11<00:50, 15.61it/s, est. speed input: 20354.56 toks/s, output: 19.88 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:12<00:50, 15.61it/s, est. speed input: 20172.28 toks/s, output: 19.70 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:12<00:49, 15.61it/s, est. speed input: 20004.31 toks/s, output: 19.54 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:13<00:49, 15.60it/s, est. speed input: 19848.57 toks/s, output: 19.38 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:13<00:48, 15.60it/s, est. speed input: 19704.19 toks/s, output: 19.24 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:14<00:48, 15.60it/s, est. speed input: 19570.84 toks/s, output: 19.11 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:14<00:47, 15.59it/s, est. speed input: 19445.81 toks/s, output: 18.99 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:15<00:47, 15.59it/s, est. speed input: 19329.70 toks/s, output: 18.88 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:15<00:46, 15.59it/s, est. speed input: 19221.17 toks/s, output: 18.77 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:16<00:46, 15.60it/s, est. speed input: 19119.63 toks/s, output: 18.67 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:16<00:45, 15.59it/s, est. speed input: 19023.81 toks/s, output: 18.58 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:17<00:45, 15.59it/s, est. speed input: 18933.77 toks/s, output: 18.49 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:17<00:44, 15.59it/s, est. speed input: 18848.55 toks/s, output: 18.41 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:18<00:44, 15.59it/s, est. speed input: 18768.03 toks/s, output: 18.33 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:18<00:43, 15.59it/s, est. speed input: 18691.80 toks/s, output: 18.25 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:19<00:42, 15.58it/s, est. speed input: 18619.67 toks/s, output: 18.18 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:19<00:42, 15.58it/s, est. speed input: 18551.20 toks/s, output: 18.12 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:20<00:41, 15.58it/s, est. speed input: 18486.07 toks/s, output: 18.05 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:21<00:41, 15.58it/s, est. speed input: 18424.14 toks/s, output: 17.99 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:21<00:40, 15.58it/s, est. speed input: 18364.84 toks/s, output: 17.93 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [00:22<00:40, 15.58it/s, est. speed input: 18308.55 toks/s, output: 17.88 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:22<00:39, 15.57it/s, est. speed input: 18254.70 toks/s, output: 17.83 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:23<00:39, 15.57it/s, est. speed input: 18203.27 toks/s, output: 17.78 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:23<00:38, 15.57it/s, est. speed input: 18153.55 toks/s, output: 17.73 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:24<00:38, 15.56it/s, est. speed input: 18105.77 toks/s, output: 17.68 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:24<00:37, 15.56it/s, est. speed input: 18060.27 toks/s, output: 17.64 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:25<00:37, 15.56it/s, est. speed input: 18016.64 toks/s, output: 17.59 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:25<00:36, 15.56it/s, est. speed input: 17974.71 toks/s, output: 17.55 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:26<00:36, 15.56it/s, est. speed input: 17934.61 toks/s, output: 17.51 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:26<00:35, 15.56it/s, est. speed input: 17895.80 toks/s, output: 17.48 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:27<00:35, 15.56it/s, est. speed input: 17858.75 toks/s, output: 17.44 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:27<00:34, 15.56it/s, est. speed input: 17822.95 toks/s, output: 17.41 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:28<00:34, 15.56it/s, est. speed input: 17788.60 toks/s, output: 17.37 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:28<00:16, 31.78it/s, est. speed input: 18565.69 toks/s, output: 18.13 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:28<00:19, 26.04it/s, est. speed input: 18518.64 toks/s, output: 18.08 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:29<00:21, 22.52it/s, est. speed input: 18473.22 toks/s, output: 18.04 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:29<00:23, 20.26it/s, est. speed input: 18429.30 toks/s, output: 18.00 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:30<00:25, 18.77it/s, est. speed input: 18387.10 toks/s, output: 17.96 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:30<00:26, 17.77it/s, est. speed input: 18346.00 toks/s, output: 17.92 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:31<00:27, 17.08it/s, est. speed input: 18306.29 toks/s, output: 17.88 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:31<00:27, 16.61it/s, est. speed input: 18267.51 toks/s, output: 17.84 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:32<00:27, 16.28it/s, est. speed input: 18230.06 toks/s, output: 17.80 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:32<00:27, 16.06it/s, est. speed input: 18193.92 toks/s, output: 17.77 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:33<00:27, 15.90it/s, est. speed input: 18158.64 toks/s, output: 17.73 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:34<00:26, 15.79it/s, est. speed input: 18124.45 toks/s, output: 17.70 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:34<00:26, 15.71it/s, est. speed input: 18091.52 toks/s, output: 17.67 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:35<00:25, 15.66it/s, est. speed input: 18059.33 toks/s, output: 17.64 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:35<00:25, 15.62it/s, est. speed input: 18028.09 toks/s, output: 17.61 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:36<00:25, 15.59it/s, est. speed input: 17997.87 toks/s, output: 17.58 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:36<00:24, 15.57it/s, est. speed input: 17968.35 toks/s, output: 17.55 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:37<00:24, 15.56it/s, est. speed input: 17939.76 toks/s, output: 17.52 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:37<00:23, 15.55it/s, est. speed input: 17911.81 toks/s, output: 17.49 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:38<00:23, 15.55it/s, est. speed input: 17884.64 toks/s, output: 17.47 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:38<00:22, 15.54it/s, est. speed input: 17858.33 toks/s, output: 17.44 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:39<00:22, 15.54it/s, est. speed input: 17832.66 toks/s, output: 17.41 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:39<00:21, 15.54it/s, est. speed input: 17807.84 toks/s, output: 17.39 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:40<00:20, 15.55it/s, est. speed input: 17783.77 toks/s, output: 17.37 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:40<00:20, 15.54it/s, est. speed input: 17760.08 toks/s, output: 17.34 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:41<00:19, 15.54it/s, est. speed input: 17737.12 toks/s, output: 17.32 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:41<00:19, 15.54it/s, est. speed input: 17714.61 toks/s, output: 17.30 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:42<00:18, 15.55it/s, est. speed input: 17692.85 toks/s, output: 17.28 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:42<00:18, 15.55it/s, est. speed input: 17671.60 toks/s, output: 17.26 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:43<00:17, 15.55it/s, est. speed input: 17650.80 toks/s, output: 17.24 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:43<00:17, 15.55it/s, est. speed input: 17630.45 toks/s, output: 17.22 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:44<00:16, 15.55it/s, est. speed input: 17610.61 toks/s, output: 17.20 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:44<00:16, 15.55it/s, est. speed input: 17591.29 toks/s, output: 17.18 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:45<00:15, 15.55it/s, est. speed input: 17572.37 toks/s, output: 17.16 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:45<00:15, 15.55it/s, est. speed input: 17553.90 toks/s, output: 17.14 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:46<00:14, 15.55it/s, est. speed input: 17535.89 toks/s, output: 17.12 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:46<00:14, 15.55it/s, est. speed input: 17518.24 toks/s, output: 17.11 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:47<00:13, 15.55it/s, est. speed input: 17500.92 toks/s, output: 17.09 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:47<00:13, 15.55it/s, est. speed input: 17483.93 toks/s, output: 17.07 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:48<00:12, 15.55it/s, est. speed input: 17467.47 toks/s, output: 17.06 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:48<00:12, 15.55it/s, est. speed input: 17451.23 toks/s, output: 17.04 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [00:49<00:11, 15.55it/s, est. speed input: 17435.36 toks/s, output: 17.03 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [00:49<00:11, 15.55it/s, est. speed input: 17419.81 toks/s, output: 17.01 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:50<00:10, 15.55it/s, est. speed input: 17404.46 toks/s, output: 17.00 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [00:50<00:10, 15.55it/s, est. speed input: 17389.62 toks/s, output: 16.98 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [00:51<00:09, 15.55it/s, est. speed input: 17374.94 toks/s, output: 16.97 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [00:52<00:09, 15.55it/s, est. speed input: 17360.63 toks/s, output: 16.95 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [00:52<00:08, 15.55it/s, est. speed input: 17346.59 toks/s, output: 16.94 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [00:53<00:08, 15.55it/s, est. speed input: 17332.84 toks/s, output: 16.93 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [00:53<00:07, 15.55it/s, est. speed input: 17319.16 toks/s, output: 16.91 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [00:54<00:07, 15.55it/s, est. speed input: 17305.86 toks/s, output: 16.90 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [00:54<00:06, 15.55it/s, est. speed input: 17292.80 toks/s, output: 16.89 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [00:55<00:06, 15.55it/s, est. speed input: 17280.02 toks/s, output: 16.88 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [00:55<00:05, 15.55it/s, est. speed input: 17267.44 toks/s, output: 16.86 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [00:56<00:05, 15.55it/s, est. speed input: 17255.13 toks/s, output: 16.85 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [00:56<00:04, 15.55it/s, est. speed input: 17243.06 toks/s, output: 16.84 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [00:57<00:03, 15.55it/s, est. speed input: 17231.19 toks/s, output: 16.83 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [00:57<00:03, 15.55it/s, est. speed input: 17219.46 toks/s, output: 16.82 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [00:58<00:02, 15.55it/s, est. speed input: 17207.90 toks/s, output: 16.80 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [00:58<00:02, 15.55it/s, est. speed input: 17196.60 toks/s, output: 16.79 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [00:59<00:01, 15.55it/s, est. speed input: 17185.55 toks/s, output: 16.78 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:59<00:00, 15.55it/s, est. speed input: 17688.76 toks/s, output: 17.27 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:59<00:00, 17.27it/s, est. speed input: 17688.76 toks/s, output: 17.27 toks/s]
[rank0]:[W126 05:38:30.693507147 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 129.6s

测试结果:
  Requests/s:   15.52
  Tokens/s:     15905.45
  Total Reqs:   1024
  Elapsed:      65.99s

  [Prefill 分析]
  Total Prefill Tokens: 1048576
  Prefill Tokens/s:     15889.94

============================================================
[6/8] 测试 M=16384
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-14B-INT8                                │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 16384
│   M_prefill     = 16384 (= 16 x 1024)
│   M_decode      = 16
│   batched_tokens = 16384 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 2048
│   --max-num-seqs           = 16
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 16384
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 05:38:56 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 05:38:57 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=242495) WARNING 01-26 05:39:03 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=242495) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=242495) WARNING 01-26 05:39:22 [backends.py:609] Failed to read file <frozen os>
Throughput: 15.43 requests/s, 15819.91 total tokens/s, 15.43 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048


─── STDERR ───
[2026-01-26 05:38:56] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:38:56] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:38:56] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:38:56] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:38:56] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:38:56] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:38:56] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:38:56] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:38:56] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:38:56] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:38:56] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:38:56] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:38:56] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:38:56] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 05:39:03] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:39:03] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:39:03] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:39:03] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:39:03] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:39:03] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:39:03] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:39:03] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:39:03] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:39:03] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:39:03] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:39:03] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:39:03] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:39:03] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=242495) [2026-01-26 05:39:04] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=242495) [2026-01-26 05:39:04] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=242495) [2026-01-26 05:39:04] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=242495) [2026-01-26 05:39:04] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=242495) [2026-01-26 05:39:04] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=242495) [2026-01-26 05:39:04] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=242495) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=242495) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.07it/s]
(EngineCore_DP0 pid=242495) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.03it/s]
(EngineCore_DP0 pid=242495) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.46it/s]
(EngineCore_DP0 pid=242495) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.29it/s]
(EngineCore_DP0 pid=242495) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.26it/s]
(EngineCore_DP0 pid=242495) 
(EngineCore_DP0 pid=242495) [2026-01-26 05:39:08] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 5120] -> 1D uint8
(EngineCore_DP0 pid=242495) [2026-01-26 05:39:08] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 27525120 bytes
(EngineCore_DP0 pid=242495) [2026-01-26 05:39:08] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 5120] -> 1D uint8
(EngineCore_DP0 pid=242495) [2026-01-26 05:39:08] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 19660800 bytes
(EngineCore_DP0 pid=242495) [2026-01-26 05:39:08] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 5120] -> 1D uint8
(EngineCore_DP0 pid=242495) [2026-01-26 05:39:08] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 106168320 bytes
(EngineCore_DP0 pid=242495) [2026-01-26 05:39:08] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 13824] -> 1D uint8
(EngineCore_DP0 pid=242495) [2026-01-26 05:39:08] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 53084160 bytes
(EngineCore_DP0 pid=242495) [rank0]:W0126 05:39:34.726000 242495 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=242495) [rank0]:W0126 05:39:34.804000 242495 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=242495) [rank0]:W0126 05:39:35.888000 242495 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=242495) [rank0]:W0126 05:39:36.009000 242495 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=242495) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  14%|█▍        | 1/7 [00:00<00:01,  4.93it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  29%|██▊       | 2/7 [00:00<00:00,  5.06it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  43%|████▎     | 3/7 [00:00<00:00,  5.14it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  57%|█████▋    | 4/7 [00:00<00:00,  5.22it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  71%|███████▏  | 5/7 [00:00<00:00,  5.24it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  86%|████████▌ | 6/7 [00:01<00:00,  5.22it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:01<00:00,  5.04it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:01<00:00,  5.11it/s]
(EngineCore_DP0 pid=242495) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  20%|██        | 1/5 [00:00<00:00,  4.59it/s]
Capturing CUDA graphs (decode, FULL):  40%|████      | 2/5 [00:00<00:00,  4.62it/s]
Capturing CUDA graphs (decode, FULL):  60%|██████    | 3/5 [00:00<00:00,  4.07it/s]
Capturing CUDA graphs (decode, FULL):  80%|████████  | 4/5 [00:00<00:00,  4.21it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:01<00:00,  4.34it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:01<00:00,  4.32it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   1%|          | 24/2048 [00:00<00:08, 239.10it/s]
Adding requests:   2%|▏         | 49/2048 [00:00<00:08, 241.87it/s]
Adding requests:   4%|▎         | 75/2048 [00:00<00:07, 247.83it/s]
Adding requests:   5%|▍         | 100/2048 [00:00<00:08, 232.39it/s]
Adding requests:   6%|▌         | 124/2048 [00:00<00:08, 229.85it/s]
Adding requests:   7%|▋         | 149/2048 [00:00<00:08, 233.81it/s]
Adding requests:   9%|▊         | 176/2048 [00:00<00:07, 242.89it/s]
Adding requests:  10%|▉         | 202/2048 [00:00<00:07, 245.19it/s]
Adding requests:  11%|█         | 229/2048 [00:00<00:07, 252.28it/s]
Adding requests:  12%|█▏        | 255/2048 [00:01<00:07, 249.67it/s]
Adding requests:  14%|█▍        | 282/2048 [00:01<00:06, 252.60it/s]
Adding requests:  15%|█▌        | 308/2048 [00:01<00:06, 254.60it/s]
Adding requests:  16%|█▋        | 336/2048 [00:01<00:06, 259.93it/s]
Adding requests:  18%|█▊        | 363/2048 [00:01<00:06, 261.26it/s]
Adding requests:  19%|█▉        | 391/2048 [00:01<00:06, 265.25it/s]
Adding requests:  21%|██        | 420/2048 [00:01<00:06, 271.20it/s]
Adding requests:  22%|██▏       | 448/2048 [00:01<00:05, 267.05it/s]
Adding requests:  23%|██▎       | 478/2048 [00:01<00:05, 273.41it/s]
Adding requests:  25%|██▍       | 507/2048 [00:01<00:05, 277.26it/s]
Adding requests:  26%|██▋       | 538/2048 [00:02<00:05, 283.53it/s]
Adding requests:  28%|██▊       | 567/2048 [00:02<00:05, 284.52it/s]
Adding requests:  29%|██▉       | 596/2048 [00:02<00:05, 269.67it/s]
Adding requests:  30%|███       | 624/2048 [00:02<00:05, 264.66it/s]
Adding requests:  32%|███▏      | 651/2048 [00:02<00:05, 261.41it/s]
Adding requests:  33%|███▎      | 678/2048 [00:02<00:05, 260.40it/s]
Adding requests:  34%|███▍      | 706/2048 [00:02<00:05, 265.26it/s]
Adding requests:  36%|███▌      | 733/2048 [00:02<00:04, 263.08it/s]
Adding requests:  37%|███▋      | 760/2048 [00:02<00:05, 254.30it/s]
Adding requests:  38%|███▊      | 788/2048 [00:03<00:04, 260.84it/s]
Adding requests:  40%|███▉      | 815/2048 [00:03<00:04, 261.56it/s]
Adding requests:  41%|████      | 844/2048 [00:03<00:04, 268.59it/s]
Adding requests:  43%|████▎     | 872/2048 [00:03<00:04, 271.64it/s]
Adding requests:  44%|████▍     | 900/2048 [00:03<00:04, 264.27it/s]
Adding requests:  45%|████▌     | 927/2048 [00:03<00:04, 255.94it/s]
Adding requests:  47%|████▋     | 953/2048 [00:03<00:04, 256.34it/s]
Adding requests:  48%|████▊     | 980/2048 [00:03<00:04, 258.26it/s]
Adding requests:  49%|████▉     | 1006/2048 [00:03<00:04, 256.61it/s]
Adding requests:  50%|█████     | 1033/2048 [00:03<00:03, 260.21it/s]
Adding requests:  52%|█████▏    | 1060/2048 [00:04<00:03, 257.90it/s]
Adding requests:  53%|█████▎    | 1087/2048 [00:04<00:03, 258.36it/s]
Adding requests:  54%|█████▍    | 1113/2048 [00:04<00:03, 257.23it/s]
Adding requests:  56%|█████▌    | 1140/2048 [00:04<00:03, 260.69it/s]
Adding requests:  57%|█████▋    | 1167/2048 [00:04<00:03, 256.91it/s]
Adding requests:  58%|█████▊    | 1193/2048 [00:04<00:03, 254.73it/s]
Adding requests:  60%|█████▉    | 1222/2048 [00:04<00:03, 263.59it/s]
Adding requests:  61%|██████    | 1249/2048 [00:04<00:03, 262.85it/s]
Adding requests:  62%|██████▏   | 1276/2048 [00:04<00:02, 262.36it/s]
Adding requests:  64%|██████▎   | 1304/2048 [00:05<00:02, 265.44it/s]
Adding requests:  65%|██████▍   | 1331/2048 [00:05<00:02, 265.77it/s]
Adding requests:  66%|██████▋   | 1360/2048 [00:05<00:02, 272.03it/s]
Adding requests:  68%|██████▊   | 1388/2048 [00:05<00:02, 270.26it/s]
Adding requests:  69%|██████▉   | 1416/2048 [00:05<00:02, 267.13it/s]
Adding requests:  71%|███████   | 1444/2048 [00:05<00:02, 269.16it/s]
Adding requests:  72%|███████▏  | 1471/2048 [00:05<00:02, 266.69it/s]
Adding requests:  73%|███████▎  | 1499/2048 [00:05<00:02, 269.42it/s]
Adding requests:  75%|███████▍  | 1527/2048 [00:05<00:01, 271.45it/s]
Adding requests:  76%|███████▌  | 1555/2048 [00:05<00:01, 268.23it/s]
Adding requests:  77%|███████▋  | 1582/2048 [00:06<00:01, 266.18it/s]
Adding requests:  79%|███████▊  | 1610/2048 [00:06<00:01, 267.88it/s]
Adding requests:  80%|███████▉  | 1637/2048 [00:06<00:01, 261.79it/s]
Adding requests:  81%|████████▏ | 1664/2048 [00:06<00:01, 254.25it/s]
Adding requests:  83%|████████▎ | 1691/2048 [00:06<00:01, 258.59it/s]
Adding requests:  84%|████████▍ | 1717/2048 [00:06<00:01, 258.91it/s]
Adding requests:  85%|████████▌ | 1743/2048 [00:06<00:01, 253.54it/s]
Adding requests:  87%|████████▋ | 1772/2048 [00:06<00:01, 261.92it/s]
Adding requests:  88%|████████▊ | 1799/2048 [00:06<00:00, 259.37it/s]
Adding requests:  89%|████████▉ | 1827/2048 [00:06<00:00, 263.98it/s]
Adding requests:  91%|█████████ | 1854/2048 [00:07<00:00, 261.53it/s]
Adding requests:  92%|█████████▏| 1882/2048 [00:07<00:00, 264.90it/s]
Adding requests:  93%|█████████▎| 1909/2048 [00:07<00:00, 264.72it/s]
Adding requests:  95%|█████████▍| 1936/2048 [00:07<00:00, 257.72it/s]
Adding requests:  96%|█████████▌| 1963/2048 [00:07<00:00, 258.06it/s]
Adding requests:  97%|█████████▋| 1989/2048 [00:07<00:00, 258.26it/s]
Adding requests:  98%|█████████▊| 2015/2048 [00:07<00:00, 255.99it/s]
Adding requests: 100%|█████████▉| 2041/2048 [00:07<00:00, 254.38it/s]
Adding requests: 100%|██████████| 2048/2048 [00:07<00:00, 260.66it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▍         | 98/2048 [00:00<00:11, 164.84it/s, est. speed input: 168807.42 toks/s, output: 164.85 toks/s]
Processed prompts:   6%|▌         | 115/2048 [00:01<00:32, 59.55it/s, est. speed input: 72884.69 toks/s, output: 71.18 toks/s]  
Processed prompts:   6%|▋         | 130/2048 [00:02<00:51, 36.95it/s, est. speed input: 50482.52 toks/s, output: 49.30 toks/s]
Processed prompts:   7%|▋         | 146/2048 [00:03<01:09, 27.56it/s, est. speed input: 40394.08 toks/s, output: 39.45 toks/s]
Processed prompts:   8%|▊         | 162/2048 [00:04<01:21, 23.15it/s, est. speed input: 35123.18 toks/s, output: 34.30 toks/s]
Processed prompts:   9%|▊         | 178/2048 [00:05<01:30, 20.56it/s, est. speed input: 31724.90 toks/s, output: 30.98 toks/s]
Processed prompts:   9%|▉         | 194/2048 [00:06<01:37, 18.93it/s, est. speed input: 29353.69 toks/s, output: 28.67 toks/s]
Processed prompts:  10%|█         | 210/2048 [00:07<01:42, 17.88it/s, est. speed input: 27601.98 toks/s, output: 26.95 toks/s]
Processed prompts:  12%|█▏        | 242/2048 [00:08<01:12, 25.04it/s, est. speed input: 29393.69 toks/s, output: 28.70 toks/s]
Processed prompts:  13%|█▎        | 258/2048 [00:09<01:21, 21.86it/s, est. speed input: 27943.76 toks/s, output: 27.29 toks/s]
Processed prompts:  13%|█▎        | 274/2048 [00:10<01:29, 19.83it/s, est. speed input: 26776.27 toks/s, output: 26.15 toks/s]
Processed prompts:  14%|█▍        | 290/2048 [00:11<01:35, 18.49it/s, est. speed input: 25814.12 toks/s, output: 25.21 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [00:12<01:39, 17.59it/s, est. speed input: 25007.65 toks/s, output: 24.42 toks/s]
Processed prompts:  16%|█▌        | 322/2048 [00:13<01:41, 16.97it/s, est. speed input: 24322.71 toks/s, output: 23.75 toks/s]
Processed prompts:  17%|█▋        | 338/2048 [00:14<01:43, 16.55it/s, est. speed input: 23733.88 toks/s, output: 23.18 toks/s]
Processed prompts:  17%|█▋        | 354/2048 [00:15<01:44, 16.25it/s, est. speed input: 23222.13 toks/s, output: 22.68 toks/s]
Processed prompts:  18%|█▊        | 370/2048 [00:16<01:44, 16.04it/s, est. speed input: 22772.41 toks/s, output: 22.24 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [00:17<01:44, 15.90it/s, est. speed input: 22375.91 toks/s, output: 21.85 toks/s]
Processed prompts:  20%|█▉        | 402/2048 [00:18<01:44, 15.80it/s, est. speed input: 22022.24 toks/s, output: 21.51 toks/s]
Processed prompts:  20%|██        | 418/2048 [00:19<01:43, 15.73it/s, est. speed input: 21705.23 toks/s, output: 21.20 toks/s]
Processed prompts:  21%|██        | 434/2048 [00:20<01:42, 15.68it/s, est. speed input: 21420.10 toks/s, output: 20.92 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [00:21<01:42, 15.65it/s, est. speed input: 21162.30 toks/s, output: 20.67 toks/s]
Processed prompts:  23%|██▎       | 466/2048 [00:22<01:41, 15.63it/s, est. speed input: 20926.71 toks/s, output: 20.44 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [00:23<01:40, 15.61it/s, est. speed input: 20712.51 toks/s, output: 20.23 toks/s]
Processed prompts:  24%|██▍       | 498/2048 [00:24<01:39, 15.60it/s, est. speed input: 20515.90 toks/s, output: 20.04 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [00:25<01:38, 15.60it/s, est. speed input: 20335.05 toks/s, output: 19.86 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [00:26<01:37, 15.59it/s, est. speed input: 20167.98 toks/s, output: 19.70 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [00:27<01:36, 15.59it/s, est. speed input: 20013.43 toks/s, output: 19.54 toks/s]
Processed prompts:  27%|██▋       | 562/2048 [00:28<01:35, 15.59it/s, est. speed input: 19869.59 toks/s, output: 19.40 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [00:29<01:34, 15.58it/s, est. speed input: 19735.36 toks/s, output: 19.27 toks/s]
Processed prompts:  29%|██▉       | 594/2048 [00:31<01:33, 15.58it/s, est. speed input: 19610.24 toks/s, output: 19.15 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [00:32<01:32, 15.59it/s, est. speed input: 19493.38 toks/s, output: 19.04 toks/s]
Processed prompts:  31%|███       | 626/2048 [00:33<01:31, 15.59it/s, est. speed input: 19383.72 toks/s, output: 18.93 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [00:34<01:30, 15.59it/s, est. speed input: 19280.73 toks/s, output: 18.83 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [00:35<01:29, 15.58it/s, est. speed input: 19183.39 toks/s, output: 18.73 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [00:36<01:28, 15.58it/s, est. speed input: 19091.90 toks/s, output: 18.64 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [00:37<01:27, 15.58it/s, est. speed input: 19005.28 toks/s, output: 18.56 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [00:38<01:26, 15.58it/s, est. speed input: 18923.37 toks/s, output: 18.48 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [00:39<01:25, 15.58it/s, est. speed input: 18845.54 toks/s, output: 18.40 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [00:39<00:56, 22.86it/s, est. speed input: 19366.42 toks/s, output: 18.91 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [00:40<01:02, 20.50it/s, est. speed input: 19281.50 toks/s, output: 18.83 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [00:41<01:06, 18.94it/s, est. speed input: 19200.60 toks/s, output: 18.75 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [00:42<01:09, 17.90it/s, est. speed input: 19123.76 toks/s, output: 18.68 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [00:43<01:11, 17.19it/s, est. speed input: 19050.37 toks/s, output: 18.60 toks/s]
Processed prompts:  41%|████      | 834/2048 [00:44<01:12, 16.71it/s, est. speed input: 18980.25 toks/s, output: 18.54 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [00:46<01:13, 16.37it/s, est. speed input: 18913.09 toks/s, output: 18.47 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [00:47<01:13, 16.13it/s, est. speed input: 18848.90 toks/s, output: 18.41 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [00:48<01:12, 15.98it/s, est. speed input: 18787.81 toks/s, output: 18.35 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [00:49<01:12, 15.85it/s, est. speed input: 18728.34 toks/s, output: 18.29 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [00:50<01:11, 15.77it/s, est. speed input: 18671.17 toks/s, output: 18.23 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [00:51<01:11, 15.71it/s, est. speed input: 18616.52 toks/s, output: 18.18 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [00:52<01:10, 15.67it/s, est. speed input: 18563.84 toks/s, output: 18.13 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [00:53<01:09, 15.64it/s, est. speed input: 18513.11 toks/s, output: 18.08 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [00:54<01:08, 15.61it/s, est. speed input: 18464.29 toks/s, output: 18.03 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [00:55<01:07, 15.60it/s, est. speed input: 18417.49 toks/s, output: 17.99 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [00:56<01:06, 15.59it/s, est. speed input: 18372.19 toks/s, output: 17.94 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [00:57<01:05, 15.58it/s, est. speed input: 18328.38 toks/s, output: 17.90 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [00:58<01:04, 15.57it/s, est. speed input: 18286.16 toks/s, output: 17.86 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [00:59<01:03, 15.57it/s, est. speed input: 18245.62 toks/s, output: 17.82 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [01:00<01:02, 15.56it/s, est. speed input: 18205.87 toks/s, output: 17.78 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [01:01<01:01, 15.56it/s, est. speed input: 18167.83 toks/s, output: 17.74 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [01:02<01:00, 15.56it/s, est. speed input: 18130.94 toks/s, output: 17.71 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [01:03<00:59, 15.56it/s, est. speed input: 18095.30 toks/s, output: 17.67 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [01:04<00:58, 15.56it/s, est. speed input: 18060.86 toks/s, output: 17.64 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [01:05<00:57, 15.56it/s, est. speed input: 18027.71 toks/s, output: 17.61 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [01:06<00:56, 15.57it/s, est. speed input: 17995.66 toks/s, output: 17.57 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [01:07<00:55, 15.57it/s, est. speed input: 17964.61 toks/s, output: 17.54 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [01:08<00:54, 15.57it/s, est. speed input: 17934.46 toks/s, output: 17.51 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [01:09<00:53, 15.57it/s, est. speed input: 17905.13 toks/s, output: 17.49 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [01:10<00:52, 15.57it/s, est. speed input: 17876.60 toks/s, output: 17.46 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [01:11<00:34, 22.89it/s, est. speed input: 18177.90 toks/s, output: 17.75 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [01:12<00:37, 20.51it/s, est. speed input: 18146.64 toks/s, output: 17.72 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [01:13<00:39, 18.99it/s, est. speed input: 18117.66 toks/s, output: 17.69 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [01:14<00:40, 17.96it/s, est. speed input: 18089.43 toks/s, output: 17.67 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [01:15<00:41, 17.26it/s, est. speed input: 18061.90 toks/s, output: 17.64 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [01:16<00:41, 16.78it/s, est. speed input: 18035.16 toks/s, output: 17.61 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [01:17<00:41, 16.44it/s, est. speed input: 18008.97 toks/s, output: 17.59 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [01:18<00:41, 16.21it/s, est. speed input: 17983.52 toks/s, output: 17.56 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [01:19<00:40, 16.05it/s, est. speed input: 17958.72 toks/s, output: 17.54 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [01:20<00:40, 15.92it/s, est. speed input: 17933.74 toks/s, output: 17.51 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [01:21<00:39, 15.78it/s, est. speed input: 17907.30 toks/s, output: 17.49 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [01:22<00:38, 15.69it/s, est. speed input: 17881.42 toks/s, output: 17.46 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [01:23<00:37, 15.62it/s, est. speed input: 17856.13 toks/s, output: 17.44 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [01:24<00:36, 15.58it/s, est. speed input: 17831.63 toks/s, output: 17.41 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [01:25<00:35, 15.55it/s, est. speed input: 17807.58 toks/s, output: 17.39 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [01:26<00:34, 15.53it/s, est. speed input: 17784.28 toks/s, output: 17.37 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [01:27<00:33, 15.51it/s, est. speed input: 17761.37 toks/s, output: 17.35 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [01:28<00:32, 15.51it/s, est. speed input: 17739.49 toks/s, output: 17.32 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [01:29<00:31, 15.51it/s, est. speed input: 17718.35 toks/s, output: 17.30 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [01:30<00:30, 15.52it/s, est. speed input: 17697.66 toks/s, output: 17.28 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [01:31<00:29, 15.52it/s, est. speed input: 17677.47 toks/s, output: 17.26 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [01:32<00:28, 15.52it/s, est. speed input: 17657.78 toks/s, output: 17.24 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [01:33<00:27, 15.52it/s, est. speed input: 17638.52 toks/s, output: 17.23 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [01:34<00:26, 15.52it/s, est. speed input: 17619.64 toks/s, output: 17.21 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [01:35<00:25, 15.53it/s, est. speed input: 17601.19 toks/s, output: 17.19 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [01:37<00:24, 15.54it/s, est. speed input: 17583.67 toks/s, output: 17.17 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [01:38<00:23, 15.55it/s, est. speed input: 17566.69 toks/s, output: 17.15 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [01:39<00:22, 15.57it/s, est. speed input: 17550.09 toks/s, output: 17.14 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [01:40<00:21, 15.57it/s, est. speed input: 17533.81 toks/s, output: 17.12 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [01:41<00:20, 15.58it/s, est. speed input: 17517.89 toks/s, output: 17.11 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [01:41<00:12, 22.94it/s, est. speed input: 17732.25 toks/s, output: 17.32 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [01:42<00:13, 20.54it/s, est. speed input: 17714.55 toks/s, output: 17.30 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [01:43<00:13, 18.96it/s, est. speed input: 17697.26 toks/s, output: 17.28 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [01:44<00:13, 17.91it/s, est. speed input: 17680.20 toks/s, output: 17.27 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [01:45<00:12, 17.18it/s, est. speed input: 17663.32 toks/s, output: 17.25 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [01:46<00:12, 16.69it/s, est. speed input: 17646.78 toks/s, output: 17.23 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [01:47<00:11, 16.35it/s, est. speed input: 17630.66 toks/s, output: 17.22 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [01:48<00:10, 16.11it/s, est. speed input: 17614.71 toks/s, output: 17.20 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [01:49<00:09, 15.95it/s, est. speed input: 17599.14 toks/s, output: 17.19 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [01:50<00:08, 15.84it/s, est. speed input: 17583.83 toks/s, output: 17.17 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [01:52<00:07, 15.76it/s, est. speed input: 17568.84 toks/s, output: 17.16 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [01:53<00:07, 15.70it/s, est. speed input: 17554.08 toks/s, output: 17.14 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [01:54<00:06, 15.66it/s, est. speed input: 17539.60 toks/s, output: 17.13 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [01:55<00:04, 15.64it/s, est. speed input: 17525.47 toks/s, output: 17.11 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [01:56<00:03, 15.62it/s, est. speed input: 17511.49 toks/s, output: 17.10 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [01:57<00:02, 15.60it/s, est. speed input: 17497.72 toks/s, output: 17.09 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [01:58<00:01, 15.60it/s, est. speed input: 17484.30 toks/s, output: 17.07 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [01:59<00:00, 15.89it/s, est. speed input: 17480.40 toks/s, output: 17.07 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [01:59<00:00, 15.89it/s, est. speed input: 17600.66 toks/s, output: 17.19 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [01:59<00:00, 17.19it/s, est. speed input: 17600.66 toks/s, output: 17.19 toks/s]
[rank0]:[W126 05:41:54.329658552 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 204.3s

测试结果:
  Requests/s:   15.43
  Tokens/s:     15819.91
  Total Reqs:   2048
  Elapsed:      132.69s

  [Prefill 分析]
  Total Prefill Tokens: 2097152
  Prefill Tokens/s:     15804.47

============================================================
[7/8] 测试 M=32768
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-14B-INT8                                │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 32768
│   M_prefill     = 32768 (= 32 x 1024)
│   M_decode      = 32
│   batched_tokens = 32768 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 4096
│   --max-num-seqs           = 32
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 32768
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 05:42:35 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 05:42:36 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=245934) WARNING 01-26 05:42:44 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=245934) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=245934) WARNING 01-26 05:43:01 [backends.py:609] Failed to read file <frozen os>
Throughput: 15.50 requests/s, 15890.01 total tokens/s, 15.50 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096


─── STDERR ───
[2026-01-26 05:42:35] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:42:35] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:42:35] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:42:35] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:42:35] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:42:35] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:42:35] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:42:35] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:42:35] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:42:35] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:42:35] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:42:35] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:42:35] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:42:35] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 05:42:43] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:42:43] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:42:43] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:42:43] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:42:43] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:42:43] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:42:43] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:42:43] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:42:43] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:42:43] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:42:43] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:42:43] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:42:43] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:42:43] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=245934) [2026-01-26 05:42:44] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=245934) [2026-01-26 05:42:44] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=245934) [2026-01-26 05:42:44] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=245934) [2026-01-26 05:42:44] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=245934) [2026-01-26 05:42:44] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=245934) [2026-01-26 05:42:44] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=245934) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=245934) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:01<00:03,  1.12s/it]
(EngineCore_DP0 pid=245934) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:02<00:02,  1.24s/it]
(EngineCore_DP0 pid=245934) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.14it/s]
(EngineCore_DP0 pid=245934) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.04s/it]
(EngineCore_DP0 pid=245934) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.04s/it]
(EngineCore_DP0 pid=245934) 
(EngineCore_DP0 pid=245934) [2026-01-26 05:42:49] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 5120] -> 1D uint8
(EngineCore_DP0 pid=245934) [2026-01-26 05:42:49] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 27525120 bytes
(EngineCore_DP0 pid=245934) [2026-01-26 05:42:49] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 5120] -> 1D uint8
(EngineCore_DP0 pid=245934) [2026-01-26 05:42:49] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 19660800 bytes
(EngineCore_DP0 pid=245934) [2026-01-26 05:42:49] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 5120] -> 1D uint8
(EngineCore_DP0 pid=245934) [2026-01-26 05:42:49] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 106168320 bytes
(EngineCore_DP0 pid=245934) [2026-01-26 05:42:49] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 13824] -> 1D uint8
(EngineCore_DP0 pid=245934) [2026-01-26 05:42:49] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 53084160 bytes
(EngineCore_DP0 pid=245934) [rank0]:W0126 05:43:14.971000 245934 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=245934) [rank0]:W0126 05:43:15.050000 245934 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=245934) [rank0]:W0126 05:43:16.213000 245934 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=245934) [rank0]:W0126 05:43:16.335000 245934 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=245934) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   9%|▉         | 1/11 [00:00<00:02,  4.82it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  18%|█▊        | 2/11 [00:00<00:01,  4.94it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  27%|██▋       | 3/11 [00:00<00:01,  4.95it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  36%|███▋      | 4/11 [00:00<00:01,  5.06it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  45%|████▌     | 5/11 [00:00<00:01,  5.12it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  55%|█████▍    | 6/11 [00:01<00:00,  5.11it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  64%|██████▎   | 7/11 [00:01<00:00,  5.12it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  73%|███████▎  | 8/11 [00:01<00:00,  5.14it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  82%|████████▏ | 9/11 [00:01<00:00,  4.93it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  91%|█████████ | 10/11 [00:02<00:00,  4.12it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00,  9.89it/s]
(EngineCore_DP0 pid=245934) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  14%|█▍        | 1/7 [00:00<00:01,  4.42it/s]
Capturing CUDA graphs (decode, FULL):  29%|██▊       | 2/7 [00:00<00:01,  4.95it/s]
Capturing CUDA graphs (decode, FULL):  43%|████▎     | 3/7 [00:00<00:00,  5.09it/s]
Capturing CUDA graphs (decode, FULL):  57%|█████▋    | 4/7 [00:00<00:00,  5.21it/s]
Capturing CUDA graphs (decode, FULL):  71%|███████▏  | 5/7 [00:00<00:00,  5.25it/s]
Capturing CUDA graphs (decode, FULL):  86%|████████▌ | 6/7 [00:01<00:00,  5.31it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:01<00:00,  5.38it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:01<00:00,  5.22it/s]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   1%|          | 23/4096 [00:00<00:17, 228.66it/s]
Adding requests:   1%|          | 48/4096 [00:00<00:17, 237.81it/s]
Adding requests:   2%|▏         | 75/4096 [00:00<00:16, 251.23it/s]
Adding requests:   2%|▏         | 101/4096 [00:00<00:16, 246.86it/s]
Adding requests:   3%|▎         | 127/4096 [00:00<00:16, 247.53it/s]
Adding requests:   4%|▎         | 152/4096 [00:00<00:15, 247.12it/s]
Adding requests:   4%|▍         | 179/4096 [00:00<00:15, 252.91it/s]
Adding requests:   5%|▌         | 207/4096 [00:00<00:14, 259.36it/s]
Adding requests:   6%|▌         | 234/4096 [00:00<00:14, 260.04it/s]
Adding requests:   6%|▋         | 261/4096 [00:01<00:14, 259.90it/s]
Adding requests:   7%|▋         | 288/4096 [00:01<00:14, 260.12it/s]
Adding requests:   8%|▊         | 317/4096 [00:01<00:14, 266.76it/s]
Adding requests:   8%|▊         | 344/4096 [00:01<00:14, 260.85it/s]
Adding requests:   9%|▉         | 372/4096 [00:01<00:14, 263.63it/s]
Adding requests:  10%|▉         | 400/4096 [00:01<00:13, 267.29it/s]
Adding requests:  10%|█         | 428/4096 [00:01<00:13, 269.18it/s]
Adding requests:  11%|█         | 455/4096 [00:01<00:13, 267.35it/s]
Adding requests:  12%|█▏        | 485/4096 [00:01<00:13, 274.19it/s]
Adding requests:  13%|█▎        | 514/4096 [00:01<00:12, 277.47it/s]
Adding requests:  13%|█▎        | 543/4096 [00:02<00:12, 279.02it/s]
Adding requests:  14%|█▍        | 571/4096 [00:02<00:12, 274.79it/s]
Adding requests:  15%|█▍        | 599/4096 [00:02<00:13, 265.34it/s]
Adding requests:  15%|█▌        | 626/4096 [00:02<00:13, 263.83it/s]
Adding requests:  16%|█▌        | 653/4096 [00:02<00:13, 258.70it/s]
Adding requests:  17%|█▋        | 680/4096 [00:02<00:13, 261.80it/s]
Adding requests:  17%|█▋        | 707/4096 [00:02<00:12, 261.70it/s]
Adding requests:  18%|█▊        | 734/4096 [00:02<00:13, 256.11it/s]
Adding requests:  19%|█▊        | 760/4096 [00:02<00:13, 253.67it/s]
Adding requests:  19%|█▉        | 787/4096 [00:03<00:12, 256.97it/s]
Adding requests:  20%|█▉        | 813/4096 [00:03<00:12, 254.73it/s]
Adding requests:  21%|██        | 842/4096 [00:03<00:12, 262.27it/s]
Adding requests:  21%|██        | 870/4096 [00:03<00:12, 265.55it/s]
Adding requests:  22%|██▏       | 898/4096 [00:03<00:11, 267.32it/s]
Adding requests:  23%|██▎       | 925/4096 [00:03<00:12, 262.97it/s]
Adding requests:  23%|██▎       | 952/4096 [00:03<00:11, 263.19it/s]
Adding requests:  24%|██▍       | 979/4096 [00:03<00:11, 264.76it/s]
Adding requests:  25%|██▍       | 1006/4096 [00:03<00:11, 259.39it/s]
Adding requests:  25%|██▌       | 1033/4096 [00:03<00:11, 260.94it/s]
Adding requests:  26%|██▌       | 1060/4096 [00:04<00:11, 256.52it/s]
Adding requests:  27%|██▋       | 1087/4096 [00:04<00:11, 258.10it/s]
Adding requests:  27%|██▋       | 1114/4096 [00:04<00:11, 260.06it/s]
Adding requests:  28%|██▊       | 1142/4096 [00:04<00:11, 264.41it/s]
Adding requests:  29%|██▊       | 1169/4096 [00:04<00:11, 261.51it/s]
Adding requests:  29%|██▉       | 1196/4096 [00:04<00:11, 255.29it/s]
Adding requests:  30%|██▉       | 1225/4096 [00:04<00:10, 264.38it/s]
Adding requests:  31%|███       | 1253/4096 [00:04<00:10, 266.46it/s]
Adding requests:  31%|███▏      | 1280/4096 [00:04<00:10, 261.42it/s]
Adding requests:  32%|███▏      | 1307/4096 [00:05<00:10, 258.98it/s]
Adding requests:  33%|███▎      | 1333/4096 [00:05<00:10, 257.08it/s]
Adding requests:  33%|███▎      | 1361/4096 [00:05<00:10, 263.05it/s]
Adding requests:  34%|███▍      | 1388/4096 [00:05<00:10, 261.15it/s]
Adding requests:  35%|███▍      | 1415/4096 [00:05<00:10, 256.94it/s]
Adding requests:  35%|███▌      | 1442/4096 [00:05<00:10, 259.90it/s]
Adding requests:  36%|███▌      | 1470/4096 [00:05<00:09, 263.69it/s]
Adding requests:  37%|███▋      | 1498/4096 [00:05<00:09, 265.69it/s]
Adding requests:  37%|███▋      | 1525/4096 [00:05<00:09, 263.72it/s]
Adding requests:  38%|███▊      | 1552/4096 [00:05<00:09, 261.57it/s]
Adding requests:  39%|███▊      | 1579/4096 [00:06<00:09, 255.40it/s]
Adding requests:  39%|███▉      | 1605/4096 [00:06<00:09, 252.35it/s]
Adding requests:  40%|███▉      | 1631/4096 [00:06<00:09, 250.01it/s]
Adding requests:  40%|████      | 1657/4096 [00:06<00:09, 249.87it/s]
Adding requests:  41%|████      | 1684/4096 [00:06<00:09, 252.50it/s]
Adding requests:  42%|████▏     | 1712/4096 [00:06<00:09, 259.40it/s]
Adding requests:  42%|████▏     | 1738/4096 [00:06<00:09, 258.42it/s]
Adding requests:  43%|████▎     | 1767/4096 [00:06<00:08, 267.20it/s]
Adding requests:  44%|████▍     | 1794/4096 [00:06<00:08, 262.34it/s]
Adding requests:  44%|████▍     | 1821/4096 [00:06<00:08, 258.84it/s]
Adding requests:  45%|████▌     | 1848/4096 [00:07<00:08, 261.90it/s]
Adding requests:  46%|████▌     | 1876/4096 [00:07<00:08, 265.23it/s]
Adding requests:  46%|████▋     | 1903/4096 [00:07<00:08, 263.63it/s]
Adding requests:  47%|████▋     | 1931/4096 [00:07<00:08, 268.18it/s]
Adding requests:  48%|████▊     | 1959/4096 [00:07<00:07, 271.45it/s]
Adding requests:  49%|████▊     | 1987/4096 [00:07<00:08, 262.90it/s]
Adding requests:  49%|████▉     | 2014/4096 [00:07<00:08, 260.17it/s]
Adding requests:  50%|████▉     | 2041/4096 [00:07<00:08, 256.47it/s]
Adding requests:  50%|█████     | 2067/4096 [00:07<00:08, 252.81it/s]
Adding requests:  51%|█████     | 2093/4096 [00:08<00:07, 251.91it/s]
Adding requests:  52%|█████▏    | 2121/4096 [00:08<00:07, 259.06it/s]
Adding requests:  52%|█████▏    | 2147/4096 [00:08<00:07, 259.10it/s]
Adding requests:  53%|█████▎    | 2173/4096 [00:08<00:07, 247.15it/s]
Adding requests:  54%|█████▎    | 2198/4096 [00:08<00:07, 246.78it/s]
Adding requests:  54%|█████▍    | 2224/4096 [00:08<00:07, 248.48it/s]
Adding requests:  55%|█████▍    | 2250/4096 [00:08<00:07, 250.32it/s]
Adding requests:  56%|█████▌    | 2278/4096 [00:08<00:07, 256.24it/s]
Adding requests:  56%|█████▋    | 2305/4096 [00:08<00:06, 259.96it/s]
Adding requests:  57%|█████▋    | 2332/4096 [00:08<00:06, 257.41it/s]
Adding requests:  58%|█████▊    | 2359/4096 [00:09<00:06, 258.63it/s]
Adding requests:  58%|█████▊    | 2388/4096 [00:09<00:06, 265.47it/s]
Adding requests:  59%|█████▉    | 2415/4096 [00:09<00:06, 265.23it/s]
Adding requests:  60%|█████▉    | 2442/4096 [00:09<00:06, 250.26it/s]
Adding requests:  60%|██████    | 2468/4096 [00:09<00:06, 250.95it/s]
Adding requests:  61%|██████    | 2496/4096 [00:09<00:06, 257.35it/s]
Adding requests:  62%|██████▏   | 2524/4096 [00:09<00:06, 261.94it/s]
Adding requests:  62%|██████▏   | 2554/4096 [00:09<00:05, 271.39it/s]
Adding requests:  63%|██████▎   | 2583/4096 [00:09<00:05, 275.05it/s]
Adding requests:  64%|██████▎   | 2611/4096 [00:10<00:05, 272.57it/s]
Adding requests:  64%|██████▍   | 2639/4096 [00:10<00:05, 265.37it/s]
Adding requests:  65%|██████▌   | 2666/4096 [00:10<00:05, 264.47it/s]
Adding requests:  66%|██████▌   | 2693/4096 [00:10<00:05, 262.74it/s]
Adding requests:  66%|██████▋   | 2720/4096 [00:10<00:05, 260.95it/s]
Adding requests:  67%|██████▋   | 2748/4096 [00:10<00:05, 264.02it/s]
Adding requests:  68%|██████▊   | 2776/4096 [00:10<00:04, 266.85it/s]
Adding requests:  69%|██████▊   | 2806/4096 [00:10<00:04, 275.41it/s]
Adding requests:  69%|██████▉   | 2834/4096 [00:10<00:04, 273.56it/s]
Adding requests:  70%|██████▉   | 2862/4096 [00:10<00:04, 274.71it/s]
Adding requests:  71%|███████   | 2890/4096 [00:11<00:04, 272.88it/s]
Adding requests:  71%|███████   | 2918/4096 [00:11<00:04, 269.63it/s]
Adding requests:  72%|███████▏  | 2946/4096 [00:11<00:04, 271.98it/s]
Adding requests:  73%|███████▎  | 2974/4096 [00:11<00:04, 268.09it/s]
Adding requests:  73%|███████▎  | 3001/4096 [00:11<00:04, 267.01it/s]
Adding requests:  74%|███████▍  | 3028/4096 [00:11<00:03, 267.20it/s]
Adding requests:  75%|███████▍  | 3056/4096 [00:11<00:03, 268.39it/s]
Adding requests:  75%|███████▌  | 3084/4096 [00:11<00:03, 268.81it/s]
Adding requests:  76%|███████▌  | 3112/4096 [00:11<00:03, 268.42it/s]
Adding requests:  77%|███████▋  | 3141/4096 [00:11<00:03, 272.51it/s]
Adding requests:  77%|███████▋  | 3169/4096 [00:12<00:03, 265.23it/s]
Adding requests:  78%|███████▊  | 3196/4096 [00:12<00:03, 262.31it/s]
Adding requests:  79%|███████▊  | 3223/4096 [00:12<00:03, 262.94it/s]
Adding requests:  79%|███████▉  | 3251/4096 [00:12<00:03, 266.55it/s]
Adding requests:  80%|████████  | 3278/4096 [00:12<00:03, 258.15it/s]
Adding requests:  81%|████████  | 3304/4096 [00:12<00:03, 252.18it/s]
Adding requests:  81%|████████▏ | 3331/4096 [00:12<00:02, 255.18it/s]
Adding requests:  82%|████████▏ | 3359/4096 [00:12<00:02, 261.49it/s]
Adding requests:  83%|████████▎ | 3388/4096 [00:12<00:02, 267.61it/s]
Adding requests:  83%|████████▎ | 3415/4096 [00:13<00:02, 267.01it/s]
Adding requests:  84%|████████▍ | 3442/4096 [00:13<00:02, 267.24it/s]
Adding requests:  85%|████████▍ | 3469/4096 [00:13<00:02, 264.77it/s]
Adding requests:  85%|████████▌ | 3496/4096 [00:13<00:02, 260.85it/s]
Adding requests:  86%|████████▌ | 3525/4096 [00:13<00:02, 268.94it/s]
Adding requests:  87%|████████▋ | 3555/4096 [00:13<00:01, 276.74it/s]
Adding requests:  87%|████████▋ | 3583/4096 [00:13<00:01, 266.04it/s]
Adding requests:  88%|████████▊ | 3610/4096 [00:13<00:01, 266.75it/s]
Adding requests:  89%|████████▉ | 3638/4096 [00:13<00:01, 269.19it/s]
Adding requests:  89%|████████▉ | 3665/4096 [00:13<00:01, 265.45it/s]
Adding requests:  90%|█████████ | 3692/4096 [00:14<00:01, 260.79it/s]
Adding requests:  91%|█████████ | 3720/4096 [00:14<00:01, 265.52it/s]
Adding requests:  91%|█████████▏| 3747/4096 [00:14<00:01, 262.27it/s]
Adding requests:  92%|█████████▏| 3774/4096 [00:14<00:01, 256.69it/s]
Adding requests:  93%|█████████▎| 3800/4096 [00:14<00:01, 239.47it/s]
Adding requests:  93%|█████████▎| 3825/4096 [00:14<00:01, 240.72it/s]
Adding requests:  94%|█████████▍| 3850/4096 [00:14<00:01, 242.57it/s]
Adding requests:  95%|█████████▍| 3877/4096 [00:14<00:00, 248.74it/s]
Adding requests:  95%|█████████▌| 3902/4096 [00:14<00:00, 246.35it/s]
Adding requests:  96%|█████████▌| 3927/4096 [00:15<00:00, 246.80it/s]
Adding requests:  97%|█████████▋| 3953/4096 [00:15<00:00, 250.05it/s]
Adding requests:  97%|█████████▋| 3979/4096 [00:15<00:00, 247.92it/s]
Adding requests:  98%|█████████▊| 4006/4096 [00:15<00:00, 251.65it/s]
Adding requests:  98%|█████████▊| 4032/4096 [00:15<00:00, 250.99it/s]
Adding requests:  99%|█████████▉| 4058/4096 [00:15<00:00, 249.53it/s]
Adding requests: 100%|█████████▉| 4084/4096 [00:15<00:00, 250.99it/s]
Adding requests: 100%|██████████| 4096/4096 [00:15<00:00, 260.61it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▌         | 240/4096 [00:00<00:12, 306.23it/s, est. speed input: 313591.87 toks/s, output: 306.23 toks/s]
Processed prompts:   7%|▋         | 271/4096 [00:02<00:45, 84.81it/s, est. speed input: 107495.36 toks/s, output: 104.98 toks/s] 
Processed prompts:   7%|▋         | 285/4096 [00:03<01:03, 60.31it/s, est. speed input: 83835.53 toks/s, output: 81.87 toks/s]  
Processed prompts:   7%|▋         | 296/4096 [00:04<01:26, 44.16it/s, est. speed input: 69192.24 toks/s, output: 67.57 toks/s]
Processed prompts:   8%|▊         | 310/4096 [00:05<01:48, 34.89it/s, est. speed input: 60115.70 toks/s, output: 58.71 toks/s]
Processed prompts:   8%|▊         | 324/4096 [00:06<02:11, 28.77it/s, est. speed input: 53679.96 toks/s, output: 52.42 toks/s]
Processed prompts:   8%|▊         | 338/4096 [00:07<02:32, 24.65it/s, est. speed input: 48880.65 toks/s, output: 47.73 toks/s]
Processed prompts:   9%|▊         | 352/4096 [00:07<02:51, 21.85it/s, est. speed input: 45162.37 toks/s, output: 44.10 toks/s]
Processed prompts:   9%|▉         | 366/4096 [00:08<03:07, 19.92it/s, est. speed input: 42196.30 toks/s, output: 41.21 toks/s]
Processed prompts:   9%|▉         | 380/4096 [00:09<03:19, 18.59it/s, est. speed input: 39774.17 toks/s, output: 38.84 toks/s]
Processed prompts:  10%|▉         | 394/4096 [00:10<03:29, 17.66it/s, est. speed input: 37761.45 toks/s, output: 36.88 toks/s]
Processed prompts:  10%|▉         | 408/4096 [00:11<03:36, 17.02it/s, est. speed input: 36061.10 toks/s, output: 35.22 toks/s]
Processed prompts:  10%|█         | 422/4096 [00:12<03:41, 16.57it/s, est. speed input: 34606.42 toks/s, output: 33.80 toks/s]
Processed prompts:  11%|█         | 450/4096 [00:12<02:24, 25.19it/s, est. speed input: 35769.72 toks/s, output: 34.93 toks/s]
Processed prompts:  11%|█▏        | 464/4096 [00:13<02:45, 21.90it/s, est. speed input: 34470.57 toks/s, output: 33.66 toks/s]
Processed prompts:  12%|█▏        | 478/4096 [00:14<03:02, 19.82it/s, est. speed input: 33332.92 toks/s, output: 32.55 toks/s]
Processed prompts:  12%|█▏        | 492/4096 [00:15<03:15, 18.45it/s, est. speed input: 32325.47 toks/s, output: 31.57 toks/s]
Processed prompts:  12%|█▏        | 506/4096 [00:16<03:24, 17.54it/s, est. speed input: 31428.70 toks/s, output: 30.69 toks/s]
Processed prompts:  13%|█▎        | 520/4096 [00:17<03:31, 16.92it/s, est. speed input: 30625.04 toks/s, output: 29.91 toks/s]
Processed prompts:  13%|█▎        | 534/4096 [00:18<03:35, 16.50it/s, est. speed input: 29899.56 toks/s, output: 29.20 toks/s]
Processed prompts:  13%|█▎        | 548/4096 [00:19<03:38, 16.21it/s, est. speed input: 29243.21 toks/s, output: 28.56 toks/s]
Processed prompts:  14%|█▎        | 562/4096 [00:20<03:40, 16.00it/s, est. speed input: 28644.97 toks/s, output: 27.97 toks/s]
Processed prompts:  14%|█▍        | 576/4096 [00:20<03:41, 15.86it/s, est. speed input: 28097.98 toks/s, output: 27.44 toks/s]
Processed prompts:  14%|█▍        | 590/4096 [00:21<03:42, 15.76it/s, est. speed input: 27595.99 toks/s, output: 26.95 toks/s]
Processed prompts:  15%|█▍        | 604/4096 [00:22<03:42, 15.69it/s, est. speed input: 27132.76 toks/s, output: 26.50 toks/s]
Processed prompts:  15%|█▌        | 618/4096 [00:23<03:42, 15.64it/s, est. speed input: 26704.91 toks/s, output: 26.08 toks/s]
Processed prompts:  15%|█▌        | 632/4096 [00:24<03:42, 15.60it/s, est. speed input: 26307.97 toks/s, output: 25.69 toks/s]
Processed prompts:  16%|█▌        | 646/4096 [00:25<03:41, 15.58it/s, est. speed input: 25939.54 toks/s, output: 25.33 toks/s]
Processed prompts:  16%|█▌        | 660/4096 [00:26<03:40, 15.56it/s, est. speed input: 25596.09 toks/s, output: 25.00 toks/s]
Processed prompts:  16%|█▋        | 674/4096 [00:27<03:40, 15.55it/s, est. speed input: 25275.77 toks/s, output: 24.68 toks/s]
Processed prompts:  17%|█▋        | 688/4096 [00:28<03:39, 15.54it/s, est. speed input: 24975.32 toks/s, output: 24.39 toks/s]
Processed prompts:  17%|█▋        | 702/4096 [00:29<03:38, 15.53it/s, est. speed input: 24693.86 toks/s, output: 24.12 toks/s]
Processed prompts:  17%|█▋        | 716/4096 [00:30<03:37, 15.53it/s, est. speed input: 24429.20 toks/s, output: 23.86 toks/s]
Processed prompts:  18%|█▊        | 730/4096 [00:30<03:36, 15.53it/s, est. speed input: 24180.29 toks/s, output: 23.61 toks/s]
Processed prompts:  18%|█▊        | 744/4096 [00:31<03:35, 15.52it/s, est. speed input: 23945.28 toks/s, output: 23.38 toks/s]
Processed prompts:  19%|█▊        | 758/4096 [00:32<03:35, 15.52it/s, est. speed input: 23723.31 toks/s, output: 23.17 toks/s]
Processed prompts:  19%|█▉        | 772/4096 [00:33<03:34, 15.52it/s, est. speed input: 23513.43 toks/s, output: 22.96 toks/s]
Processed prompts:  19%|█▉        | 786/4096 [00:34<03:33, 15.52it/s, est. speed input: 23314.40 toks/s, output: 22.77 toks/s]
Processed prompts:  20%|█▉        | 800/4096 [00:35<03:32, 15.52it/s, est. speed input: 23125.38 toks/s, output: 22.58 toks/s]
Processed prompts:  20%|█▉        | 814/4096 [00:36<03:31, 15.52it/s, est. speed input: 22945.91 toks/s, output: 22.41 toks/s]
Processed prompts:  20%|██        | 828/4096 [00:37<03:30, 15.52it/s, est. speed input: 22775.09 toks/s, output: 22.24 toks/s]
Processed prompts:  21%|██        | 842/4096 [00:38<03:29, 15.52it/s, est. speed input: 22612.45 toks/s, output: 22.08 toks/s]
Processed prompts:  21%|██        | 856/4096 [00:39<03:28, 15.52it/s, est. speed input: 22456.98 toks/s, output: 21.93 toks/s]
Processed prompts:  21%|██        | 870/4096 [00:39<03:27, 15.52it/s, est. speed input: 22308.83 toks/s, output: 21.79 toks/s]
Processed prompts:  22%|██▏       | 884/4096 [00:40<03:26, 15.53it/s, est. speed input: 22168.02 toks/s, output: 21.65 toks/s]
Processed prompts:  22%|██▏       | 898/4096 [00:41<03:26, 15.52it/s, est. speed input: 22031.90 toks/s, output: 21.52 toks/s]
Processed prompts:  22%|██▏       | 912/4096 [00:42<03:25, 15.52it/s, est. speed input: 21902.09 toks/s, output: 21.39 toks/s]
Processed prompts:  23%|██▎       | 926/4096 [00:43<03:24, 15.52it/s, est. speed input: 21777.42 toks/s, output: 21.27 toks/s]
Processed prompts:  23%|██▎       | 954/4096 [00:43<02:09, 24.29it/s, est. speed input: 22235.39 toks/s, output: 21.71 toks/s]
Processed prompts:  24%|██▎       | 968/4096 [00:44<02:26, 21.30it/s, est. speed input: 22107.51 toks/s, output: 21.59 toks/s]
Processed prompts:  24%|██▍       | 982/4096 [00:45<02:40, 19.42it/s, est. speed input: 21985.51 toks/s, output: 21.47 toks/s]
Processed prompts:  24%|██▍       | 996/4096 [00:46<02:50, 18.19it/s, est. speed input: 21868.91 toks/s, output: 21.36 toks/s]
Processed prompts:  25%|██▍       | 1010/4096 [00:47<02:57, 17.37it/s, est. speed input: 21756.74 toks/s, output: 21.25 toks/s]
Processed prompts:  25%|██▌       | 1024/4096 [00:48<03:02, 16.82it/s, est. speed input: 21648.85 toks/s, output: 21.14 toks/s]
Processed prompts:  25%|██▌       | 1038/4096 [00:49<03:06, 16.44it/s, est. speed input: 21544.92 toks/s, output: 21.04 toks/s]
Processed prompts:  26%|██▌       | 1052/4096 [00:50<03:08, 16.17it/s, est. speed input: 21444.65 toks/s, output: 20.94 toks/s]
Processed prompts:  26%|██▌       | 1066/4096 [00:51<03:09, 15.99it/s, est. speed input: 21347.80 toks/s, output: 20.85 toks/s]
Processed prompts:  26%|██▋       | 1080/4096 [00:52<03:10, 15.86it/s, est. speed input: 21254.55 toks/s, output: 20.76 toks/s]
Processed prompts:  27%|██▋       | 1094/4096 [00:52<03:10, 15.77it/s, est. speed input: 21164.15 toks/s, output: 20.67 toks/s]
Processed prompts:  27%|██▋       | 1108/4096 [00:53<03:10, 15.71it/s, est. speed input: 21076.83 toks/s, output: 20.58 toks/s]
Processed prompts:  27%|██▋       | 1122/4096 [00:54<03:10, 15.64it/s, est. speed input: 20990.71 toks/s, output: 20.50 toks/s]
Processed prompts:  28%|██▊       | 1136/4096 [00:55<03:09, 15.60it/s, est. speed input: 20907.60 toks/s, output: 20.42 toks/s]
Processed prompts:  28%|██▊       | 1150/4096 [00:56<03:09, 15.57it/s, est. speed input: 20827.13 toks/s, output: 20.34 toks/s]
Processed prompts:  28%|██▊       | 1164/4096 [00:57<03:08, 15.55it/s, est. speed input: 20749.25 toks/s, output: 20.26 toks/s]
Processed prompts:  29%|██▉       | 1178/4096 [00:58<03:07, 15.54it/s, est. speed input: 20673.84 toks/s, output: 20.19 toks/s]
Processed prompts:  29%|██▉       | 1192/4096 [00:59<03:07, 15.52it/s, est. speed input: 20600.59 toks/s, output: 20.12 toks/s]
Processed prompts:  29%|██▉       | 1206/4096 [01:00<03:06, 15.52it/s, est. speed input: 20529.55 toks/s, output: 20.05 toks/s]
Processed prompts:  30%|██▉       | 1220/4096 [01:01<03:05, 15.51it/s, est. speed input: 20460.36 toks/s, output: 19.98 toks/s]
Processed prompts:  30%|███       | 1234/4096 [01:01<03:04, 15.50it/s, est. speed input: 20393.27 toks/s, output: 19.92 toks/s]
Processed prompts:  30%|███       | 1248/4096 [01:02<03:03, 15.50it/s, est. speed input: 20327.99 toks/s, output: 19.85 toks/s]
Processed prompts:  31%|███       | 1262/4096 [01:03<03:02, 15.49it/s, est. speed input: 20264.52 toks/s, output: 19.79 toks/s]
Processed prompts:  31%|███       | 1276/4096 [01:04<03:02, 15.49it/s, est. speed input: 20202.80 toks/s, output: 19.73 toks/s]
Processed prompts:  31%|███▏      | 1290/4096 [01:05<03:01, 15.49it/s, est. speed input: 20142.83 toks/s, output: 19.67 toks/s]
Processed prompts:  32%|███▏      | 1304/4096 [01:06<03:00, 15.49it/s, est. speed input: 20084.53 toks/s, output: 19.61 toks/s]
Processed prompts:  32%|███▏      | 1318/4096 [01:07<02:59, 15.49it/s, est. speed input: 20027.81 toks/s, output: 19.56 toks/s]
Processed prompts:  33%|███▎      | 1332/4096 [01:08<02:58, 15.48it/s, est. speed input: 19972.44 toks/s, output: 19.50 toks/s]
Processed prompts:  33%|███▎      | 1346/4096 [01:09<02:57, 15.48it/s, est. speed input: 19918.49 toks/s, output: 19.45 toks/s]
Processed prompts:  33%|███▎      | 1360/4096 [01:10<02:56, 15.49it/s, est. speed input: 19866.31 toks/s, output: 19.40 toks/s]
Processed prompts:  34%|███▎      | 1374/4096 [01:11<02:55, 15.50it/s, est. speed input: 19815.82 toks/s, output: 19.35 toks/s]
Processed prompts:  34%|███▍      | 1388/4096 [01:11<02:54, 15.50it/s, est. speed input: 19766.65 toks/s, output: 19.30 toks/s]
Processed prompts:  34%|███▍      | 1402/4096 [01:12<02:53, 15.51it/s, est. speed input: 19718.56 toks/s, output: 19.26 toks/s]
Processed prompts:  35%|███▍      | 1416/4096 [01:13<02:52, 15.51it/s, est. speed input: 19671.75 toks/s, output: 19.21 toks/s]
Processed prompts:  35%|███▍      | 1430/4096 [01:14<02:51, 15.52it/s, est. speed input: 19626.13 toks/s, output: 19.17 toks/s]
Processed prompts:  36%|███▌      | 1458/4096 [01:15<01:48, 24.31it/s, est. speed input: 19906.40 toks/s, output: 19.44 toks/s]
Processed prompts:  36%|███▌      | 1472/4096 [01:15<02:03, 21.32it/s, est. speed input: 19858.89 toks/s, output: 19.39 toks/s]
Processed prompts:  36%|███▋      | 1486/4096 [01:16<02:14, 19.42it/s, est. speed input: 19812.28 toks/s, output: 19.35 toks/s]
Processed prompts:  37%|███▋      | 1500/4096 [01:17<02:22, 18.18it/s, est. speed input: 19766.84 toks/s, output: 19.30 toks/s]
Processed prompts:  37%|███▋      | 1514/4096 [01:18<02:28, 17.35it/s, est. speed input: 19722.40 toks/s, output: 19.26 toks/s]
Processed prompts:  37%|███▋      | 1528/4096 [01:19<02:33, 16.78it/s, est. speed input: 19678.93 toks/s, output: 19.22 toks/s]
Processed prompts:  38%|███▊      | 1542/4096 [01:20<02:35, 16.40it/s, est. speed input: 19636.44 toks/s, output: 19.18 toks/s]
Processed prompts:  38%|███▊      | 1556/4096 [01:21<02:37, 16.13it/s, est. speed input: 19594.94 toks/s, output: 19.14 toks/s]
Processed prompts:  38%|███▊      | 1570/4096 [01:22<02:38, 15.95it/s, est. speed input: 19554.45 toks/s, output: 19.10 toks/s]
Processed prompts:  39%|███▊      | 1584/4096 [01:23<02:38, 15.82it/s, est. speed input: 19514.71 toks/s, output: 19.06 toks/s]
Processed prompts:  39%|███▉      | 1598/4096 [01:24<02:38, 15.73it/s, est. speed input: 19475.73 toks/s, output: 19.02 toks/s]
Processed prompts:  39%|███▉      | 1612/4096 [01:24<02:38, 15.66it/s, est. speed input: 19437.59 toks/s, output: 18.98 toks/s]
Processed prompts:  40%|███▉      | 1626/4096 [01:25<02:38, 15.62it/s, est. speed input: 19400.17 toks/s, output: 18.95 toks/s]
Processed prompts:  40%|████      | 1640/4096 [01:26<02:37, 15.58it/s, est. speed input: 19363.38 toks/s, output: 18.91 toks/s]
Processed prompts:  40%|████      | 1654/4096 [01:27<02:36, 15.56it/s, est. speed input: 19327.38 toks/s, output: 18.87 toks/s]
Processed prompts:  41%|████      | 1668/4096 [01:28<02:36, 15.54it/s, est. speed input: 19292.22 toks/s, output: 18.84 toks/s]
Processed prompts:  41%|████      | 1682/4096 [01:29<02:35, 15.53it/s, est. speed input: 19257.74 toks/s, output: 18.81 toks/s]
Processed prompts:  41%|████▏     | 1696/4096 [01:30<02:34, 15.52it/s, est. speed input: 19223.95 toks/s, output: 18.77 toks/s]
Processed prompts:  42%|████▏     | 1710/4096 [01:31<02:33, 15.52it/s, est. speed input: 19190.86 toks/s, output: 18.74 toks/s]
Processed prompts:  42%|████▏     | 1724/4096 [01:32<02:32, 15.51it/s, est. speed input: 19158.38 toks/s, output: 18.71 toks/s]
Processed prompts:  42%|████▏     | 1738/4096 [01:33<02:32, 15.51it/s, est. speed input: 19126.57 toks/s, output: 18.68 toks/s]
Processed prompts:  43%|████▎     | 1752/4096 [01:33<02:31, 15.51it/s, est. speed input: 19095.38 toks/s, output: 18.65 toks/s]
Processed prompts:  43%|████▎     | 1766/4096 [01:34<02:30, 15.51it/s, est. speed input: 19064.71 toks/s, output: 18.62 toks/s]
Processed prompts:  43%|████▎     | 1780/4096 [01:35<02:29, 15.51it/s, est. speed input: 19034.63 toks/s, output: 18.59 toks/s]
Processed prompts:  44%|████▍     | 1794/4096 [01:36<02:28, 15.51it/s, est. speed input: 19005.20 toks/s, output: 18.56 toks/s]
Processed prompts:  44%|████▍     | 1808/4096 [01:37<02:27, 15.51it/s, est. speed input: 18976.39 toks/s, output: 18.53 toks/s]
Processed prompts:  44%|████▍     | 1822/4096 [01:38<02:26, 15.51it/s, est. speed input: 18947.82 toks/s, output: 18.50 toks/s]
Processed prompts:  45%|████▍     | 1836/4096 [01:39<02:25, 15.51it/s, est. speed input: 18919.92 toks/s, output: 18.48 toks/s]
Processed prompts:  45%|████▌     | 1850/4096 [01:40<02:24, 15.51it/s, est. speed input: 18892.59 toks/s, output: 18.45 toks/s]
Processed prompts:  46%|████▌     | 1864/4096 [01:41<02:23, 15.51it/s, est. speed input: 18865.63 toks/s, output: 18.42 toks/s]
Processed prompts:  46%|████▌     | 1878/4096 [01:42<02:23, 15.51it/s, est. speed input: 18839.21 toks/s, output: 18.40 toks/s]
Processed prompts:  46%|████▌     | 1892/4096 [01:42<02:22, 15.51it/s, est. speed input: 18813.24 toks/s, output: 18.37 toks/s]
Processed prompts:  47%|████▋     | 1906/4096 [01:43<02:21, 15.51it/s, est. speed input: 18787.74 toks/s, output: 18.35 toks/s]
Processed prompts:  47%|████▋     | 1920/4096 [01:44<02:20, 15.51it/s, est. speed input: 18762.71 toks/s, output: 18.32 toks/s]
Processed prompts:  47%|████▋     | 1934/4096 [01:45<02:19, 15.51it/s, est. speed input: 18738.01 toks/s, output: 18.30 toks/s]
Processed prompts:  48%|████▊     | 1962/4096 [01:46<01:28, 24.19it/s, est. speed input: 18937.49 toks/s, output: 18.49 toks/s]
Processed prompts:  48%|████▊     | 1976/4096 [01:46<01:39, 21.24it/s, est. speed input: 18911.59 toks/s, output: 18.47 toks/s]
Processed prompts:  49%|████▊     | 1990/4096 [01:47<01:48, 19.36it/s, est. speed input: 18886.11 toks/s, output: 18.44 toks/s]
Processed prompts:  49%|████▉     | 2004/4096 [01:48<01:55, 18.14it/s, est. speed input: 18861.16 toks/s, output: 18.42 toks/s]
Processed prompts:  49%|████▉     | 2018/4096 [01:49<02:00, 17.31it/s, est. speed input: 18836.56 toks/s, output: 18.40 toks/s]
Processed prompts:  50%|████▉     | 2032/4096 [01:50<02:03, 16.76it/s, est. speed input: 18812.64 toks/s, output: 18.37 toks/s]
Processed prompts:  50%|████▉     | 2046/4096 [01:51<02:05, 16.39it/s, est. speed input: 18789.09 toks/s, output: 18.35 toks/s]
Processed prompts:  50%|█████     | 2060/4096 [01:52<02:06, 16.12it/s, est. speed input: 18765.93 toks/s, output: 18.33 toks/s]
Processed prompts:  51%|█████     | 2074/4096 [01:53<02:06, 15.95it/s, est. speed input: 18743.17 toks/s, output: 18.30 toks/s]
Processed prompts:  51%|█████     | 2088/4096 [01:54<02:06, 15.82it/s, est. speed input: 18720.78 toks/s, output: 18.28 toks/s]
Processed prompts:  51%|█████▏    | 2102/4096 [01:55<02:06, 15.74it/s, est. speed input: 18698.78 toks/s, output: 18.26 toks/s]
Processed prompts:  52%|█████▏    | 2116/4096 [01:56<02:06, 15.67it/s, est. speed input: 18677.04 toks/s, output: 18.24 toks/s]
Processed prompts:  52%|█████▏    | 2130/4096 [01:56<02:05, 15.63it/s, est. speed input: 18655.66 toks/s, output: 18.22 toks/s]
Processed prompts:  52%|█████▏    | 2144/4096 [01:57<02:05, 15.60it/s, est. speed input: 18634.59 toks/s, output: 18.20 toks/s]
Processed prompts:  53%|█████▎    | 2158/4096 [01:58<02:04, 15.57it/s, est. speed input: 18613.54 toks/s, output: 18.18 toks/s]
Processed prompts:  53%|█████▎    | 2172/4096 [01:59<02:03, 15.55it/s, est. speed input: 18592.79 toks/s, output: 18.16 toks/s]
Processed prompts:  53%|█████▎    | 2186/4096 [02:00<02:02, 15.53it/s, est. speed input: 18572.34 toks/s, output: 18.14 toks/s]
Processed prompts:  54%|█████▎    | 2200/4096 [02:01<02:02, 15.52it/s, est. speed input: 18552.20 toks/s, output: 18.12 toks/s]
Processed prompts:  54%|█████▍    | 2214/4096 [02:02<02:01, 15.51it/s, est. speed input: 18532.29 toks/s, output: 18.10 toks/s]
Processed prompts:  54%|█████▍    | 2228/4096 [02:03<02:00, 15.50it/s, est. speed input: 18512.72 toks/s, output: 18.08 toks/s]
Processed prompts:  55%|█████▍    | 2242/4096 [02:04<01:59, 15.50it/s, est. speed input: 18493.49 toks/s, output: 18.06 toks/s]
Processed prompts:  55%|█████▌    | 2256/4096 [02:05<01:58, 15.50it/s, est. speed input: 18474.49 toks/s, output: 18.04 toks/s]
Processed prompts:  55%|█████▌    | 2270/4096 [02:05<01:57, 15.50it/s, est. speed input: 18455.71 toks/s, output: 18.02 toks/s]
Processed prompts:  56%|█████▌    | 2284/4096 [02:06<01:57, 15.48it/s, est. speed input: 18436.95 toks/s, output: 18.00 toks/s]
Processed prompts:  56%|█████▌    | 2298/4096 [02:07<01:56, 15.48it/s, est. speed input: 18418.46 toks/s, output: 17.99 toks/s]
Processed prompts:  56%|█████▋    | 2312/4096 [02:08<01:55, 15.47it/s, est. speed input: 18400.22 toks/s, output: 17.97 toks/s]
Processed prompts:  57%|█████▋    | 2326/4096 [02:09<01:54, 15.47it/s, est. speed input: 18382.29 toks/s, output: 17.95 toks/s]
Processed prompts:  57%|█████▋    | 2340/4096 [02:10<01:53, 15.47it/s, est. speed input: 18364.58 toks/s, output: 17.93 toks/s]
Processed prompts:  57%|█████▋    | 2354/4096 [02:11<01:52, 15.46it/s, est. speed input: 18347.09 toks/s, output: 17.92 toks/s]
Processed prompts:  58%|█████▊    | 2368/4096 [02:12<01:51, 15.46it/s, est. speed input: 18329.82 toks/s, output: 17.90 toks/s]
Processed prompts:  58%|█████▊    | 2382/4096 [02:13<01:50, 15.46it/s, est. speed input: 18312.79 toks/s, output: 17.88 toks/s]
Processed prompts:  58%|█████▊    | 2396/4096 [02:14<01:49, 15.47it/s, est. speed input: 18296.34 toks/s, output: 17.87 toks/s]
Processed prompts:  59%|█████▉    | 2410/4096 [02:14<01:48, 15.49it/s, est. speed input: 18280.43 toks/s, output: 17.85 toks/s]
Processed prompts:  59%|█████▉    | 2424/4096 [02:15<01:47, 15.51it/s, est. speed input: 18264.79 toks/s, output: 17.84 toks/s]
Processed prompts:  60%|█████▉    | 2438/4096 [02:16<01:46, 15.52it/s, est. speed input: 18249.32 toks/s, output: 17.82 toks/s]
Processed prompts:  60%|██████    | 2466/4096 [02:17<01:07, 24.33it/s, est. speed input: 18406.58 toks/s, output: 17.98 toks/s]
Processed prompts:  61%|██████    | 2480/4096 [02:18<01:15, 21.34it/s, est. speed input: 18390.37 toks/s, output: 17.96 toks/s]
Processed prompts:  61%|██████    | 2494/4096 [02:18<01:22, 19.45it/s, est. speed input: 18374.42 toks/s, output: 17.94 toks/s]
Processed prompts:  61%|██████    | 2508/4096 [02:19<01:27, 18.21it/s, est. speed input: 18358.63 toks/s, output: 17.93 toks/s]
Processed prompts:  62%|██████▏   | 2522/4096 [02:20<01:30, 17.37it/s, est. speed input: 18343.04 toks/s, output: 17.91 toks/s]
Processed prompts:  62%|██████▏   | 2536/4096 [02:21<01:32, 16.81it/s, est. speed input: 18327.67 toks/s, output: 17.90 toks/s]
Processed prompts:  62%|██████▏   | 2550/4096 [02:22<01:34, 16.41it/s, est. speed input: 18312.23 toks/s, output: 17.88 toks/s]
Processed prompts:  63%|██████▎   | 2564/4096 [02:23<01:34, 16.14it/s, est. speed input: 18296.99 toks/s, output: 17.87 toks/s]
Processed prompts:  63%|██████▎   | 2578/4096 [02:24<01:35, 15.95it/s, est. speed input: 18281.92 toks/s, output: 17.85 toks/s]
Processed prompts:  63%|██████▎   | 2592/4096 [02:25<01:35, 15.82it/s, est. speed input: 18267.13 toks/s, output: 17.84 toks/s]
Processed prompts:  64%|██████▎   | 2606/4096 [02:26<01:34, 15.73it/s, est. speed input: 18252.52 toks/s, output: 17.82 toks/s]
Processed prompts:  64%|██████▍   | 2620/4096 [02:27<01:34, 15.66it/s, est. speed input: 18237.88 toks/s, output: 17.81 toks/s]
Processed prompts:  64%|██████▍   | 2634/4096 [02:28<01:33, 15.62it/s, est. speed input: 18223.50 toks/s, output: 17.80 toks/s]
Processed prompts:  65%|██████▍   | 2648/4096 [02:28<01:32, 15.59it/s, est. speed input: 18209.34 toks/s, output: 17.78 toks/s]
Processed prompts:  65%|██████▍   | 2662/4096 [02:29<01:32, 15.56it/s, est. speed input: 18195.33 toks/s, output: 17.77 toks/s]
Processed prompts:  65%|██████▌   | 2676/4096 [02:30<01:31, 15.55it/s, est. speed input: 18181.43 toks/s, output: 17.76 toks/s]
Processed prompts:  66%|██████▌   | 2690/4096 [02:31<01:30, 15.53it/s, est. speed input: 18167.70 toks/s, output: 17.74 toks/s]
Processed prompts:  66%|██████▌   | 2704/4096 [02:32<01:29, 15.52it/s, est. speed input: 18154.15 toks/s, output: 17.73 toks/s]
Processed prompts:  66%|██████▋   | 2718/4096 [02:33<01:28, 15.52it/s, est. speed input: 18140.75 toks/s, output: 17.72 toks/s]
Processed prompts:  67%|██████▋   | 2732/4096 [02:34<01:27, 15.52it/s, est. speed input: 18127.52 toks/s, output: 17.70 toks/s]
Processed prompts:  67%|██████▋   | 2746/4096 [02:35<01:27, 15.51it/s, est. speed input: 18114.46 toks/s, output: 17.69 toks/s]
Processed prompts:  67%|██████▋   | 2760/4096 [02:36<01:26, 15.51it/s, est. speed input: 18101.54 toks/s, output: 17.68 toks/s]
Processed prompts:  68%|██████▊   | 2774/4096 [02:37<01:25, 15.51it/s, est. speed input: 18088.78 toks/s, output: 17.66 toks/s]
Processed prompts:  68%|██████▊   | 2788/4096 [02:37<01:24, 15.51it/s, est. speed input: 18076.12 toks/s, output: 17.65 toks/s]
Processed prompts:  68%|██████▊   | 2802/4096 [02:38<01:23, 15.51it/s, est. speed input: 18063.59 toks/s, output: 17.64 toks/s]
Processed prompts:  69%|██████▉   | 2816/4096 [02:39<01:22, 15.50it/s, est. speed input: 18051.21 toks/s, output: 17.63 toks/s]
Processed prompts:  69%|██████▉   | 2830/4096 [02:40<01:21, 15.51it/s, est. speed input: 18038.99 toks/s, output: 17.62 toks/s]
Processed prompts:  69%|██████▉   | 2844/4096 [02:41<01:20, 15.50it/s, est. speed input: 18026.86 toks/s, output: 17.60 toks/s]
Processed prompts:  70%|██████▉   | 2858/4096 [02:42<01:19, 15.50it/s, est. speed input: 18014.91 toks/s, output: 17.59 toks/s]
Processed prompts:  70%|███████   | 2872/4096 [02:43<01:18, 15.50it/s, est. speed input: 18003.10 toks/s, output: 17.58 toks/s]
Processed prompts:  70%|███████   | 2886/4096 [02:44<01:18, 15.51it/s, est. speed input: 17991.44 toks/s, output: 17.57 toks/s]
Processed prompts:  71%|███████   | 2900/4096 [02:45<01:17, 15.50it/s, est. speed input: 17979.86 toks/s, output: 17.56 toks/s]
Processed prompts:  71%|███████   | 2914/4096 [02:46<01:16, 15.50it/s, est. speed input: 17968.42 toks/s, output: 17.55 toks/s]
Processed prompts:  71%|███████▏  | 2928/4096 [02:46<01:15, 15.51it/s, est. speed input: 17957.18 toks/s, output: 17.54 toks/s]
Processed prompts:  72%|███████▏  | 2942/4096 [02:47<01:14, 15.51it/s, est. speed input: 17946.08 toks/s, output: 17.53 toks/s]
Processed prompts:  73%|███████▎  | 2970/4096 [02:48<00:46, 24.02it/s, est. speed input: 18071.66 toks/s, output: 17.65 toks/s]
Processed prompts:  73%|███████▎  | 2984/4096 [02:49<00:52, 21.15it/s, est. speed input: 18060.03 toks/s, output: 17.64 toks/s]
Processed prompts:  73%|███████▎  | 2998/4096 [02:50<00:56, 19.31it/s, est. speed input: 18048.48 toks/s, output: 17.63 toks/s]
Processed prompts:  74%|███████▎  | 3012/4096 [02:50<00:59, 18.11it/s, est. speed input: 18037.08 toks/s, output: 17.61 toks/s]
Processed prompts:  74%|███████▍  | 3026/4096 [02:51<01:01, 17.30it/s, est. speed input: 18025.82 toks/s, output: 17.60 toks/s]
Processed prompts:  74%|███████▍  | 3040/4096 [02:52<01:03, 16.75it/s, est. speed input: 18014.67 toks/s, output: 17.59 toks/s]
Processed prompts:  75%|███████▍  | 3054/4096 [02:53<01:03, 16.37it/s, est. speed input: 18003.63 toks/s, output: 17.58 toks/s]
Processed prompts:  75%|███████▍  | 3068/4096 [02:54<01:03, 16.11it/s, est. speed input: 17992.64 toks/s, output: 17.57 toks/s]
Processed prompts:  75%|███████▌  | 3082/4096 [02:55<01:03, 15.93it/s, est. speed input: 17981.78 toks/s, output: 17.56 toks/s]
Processed prompts:  76%|███████▌  | 3096/4096 [02:56<01:03, 15.80it/s, est. speed input: 17971.04 toks/s, output: 17.55 toks/s]
Processed prompts:  76%|███████▌  | 3110/4096 [02:57<01:02, 15.71it/s, est. speed input: 17960.41 toks/s, output: 17.54 toks/s]
Processed prompts:  76%|███████▋  | 3124/4096 [02:58<01:02, 15.65it/s, est. speed input: 17949.93 toks/s, output: 17.53 toks/s]
Processed prompts:  77%|███████▋  | 3138/4096 [02:59<01:01, 15.61it/s, est. speed input: 17939.49 toks/s, output: 17.52 toks/s]
Processed prompts:  77%|███████▋  | 3152/4096 [03:00<01:00, 15.58it/s, est. speed input: 17929.14 toks/s, output: 17.51 toks/s]
Processed prompts:  77%|███████▋  | 3166/4096 [03:00<00:59, 15.56it/s, est. speed input: 17918.89 toks/s, output: 17.50 toks/s]
Processed prompts:  78%|███████▊  | 3180/4096 [03:01<00:58, 15.54it/s, est. speed input: 17908.74 toks/s, output: 17.49 toks/s]
Processed prompts:  78%|███████▊  | 3194/4096 [03:02<00:58, 15.53it/s, est. speed input: 17898.66 toks/s, output: 17.48 toks/s]
Processed prompts:  78%|███████▊  | 3208/4096 [03:03<00:57, 15.52it/s, est. speed input: 17888.71 toks/s, output: 17.47 toks/s]
Processed prompts:  79%|███████▊  | 3222/4096 [03:04<00:56, 15.51it/s, est. speed input: 17878.83 toks/s, output: 17.46 toks/s]
Processed prompts:  79%|███████▉  | 3236/4096 [03:05<00:55, 15.51it/s, est. speed input: 17869.10 toks/s, output: 17.45 toks/s]
Processed prompts:  79%|███████▉  | 3250/4096 [03:06<00:54, 15.51it/s, est. speed input: 17859.41 toks/s, output: 17.44 toks/s]
Processed prompts:  80%|███████▉  | 3264/4096 [03:07<00:53, 15.51it/s, est. speed input: 17849.84 toks/s, output: 17.43 toks/s]
Processed prompts:  80%|████████  | 3278/4096 [03:08<00:52, 15.50it/s, est. speed input: 17840.32 toks/s, output: 17.42 toks/s]
Processed prompts:  80%|████████  | 3292/4096 [03:09<00:51, 15.50it/s, est. speed input: 17830.95 toks/s, output: 17.41 toks/s]
Processed prompts:  81%|████████  | 3306/4096 [03:09<00:50, 15.50it/s, est. speed input: 17821.67 toks/s, output: 17.40 toks/s]
Processed prompts:  81%|████████  | 3320/4096 [03:10<00:50, 15.50it/s, est. speed input: 17812.45 toks/s, output: 17.39 toks/s]
Processed prompts:  81%|████████▏ | 3334/4096 [03:11<00:49, 15.50it/s, est. speed input: 17803.34 toks/s, output: 17.39 toks/s]
Processed prompts:  82%|████████▏ | 3348/4096 [03:12<00:48, 15.50it/s, est. speed input: 17794.31 toks/s, output: 17.38 toks/s]
Processed prompts:  82%|████████▏ | 3362/4096 [03:13<00:47, 15.50it/s, est. speed input: 17785.34 toks/s, output: 17.37 toks/s]
Processed prompts:  82%|████████▏ | 3376/4096 [03:14<00:46, 15.50it/s, est. speed input: 17776.47 toks/s, output: 17.36 toks/s]
Processed prompts:  83%|████████▎ | 3390/4096 [03:15<00:45, 15.50it/s, est. speed input: 17767.66 toks/s, output: 17.35 toks/s]
Processed prompts:  83%|████████▎ | 3404/4096 [03:16<00:44, 15.50it/s, est. speed input: 17758.94 toks/s, output: 17.34 toks/s]
Processed prompts:  83%|████████▎ | 3418/4096 [03:17<00:43, 15.50it/s, est. speed input: 17750.29 toks/s, output: 17.33 toks/s]
Processed prompts:  84%|████████▍ | 3432/4096 [03:18<00:42, 15.51it/s, est. speed input: 17741.84 toks/s, output: 17.33 toks/s]
Processed prompts:  84%|████████▍ | 3446/4096 [03:18<00:41, 15.51it/s, est. speed input: 17733.46 toks/s, output: 17.32 toks/s]
Processed prompts:  85%|████████▍ | 3474/4096 [03:19<00:25, 24.14it/s, est. speed input: 17841.01 toks/s, output: 17.42 toks/s]
Processed prompts:  85%|████████▌ | 3488/4096 [03:20<00:28, 21.21it/s, est. speed input: 17832.21 toks/s, output: 17.41 toks/s]
Processed prompts:  85%|████████▌ | 3502/4096 [03:21<00:30, 19.36it/s, est. speed input: 17823.50 toks/s, output: 17.41 toks/s]
Processed prompts:  86%|████████▌ | 3516/4096 [03:22<00:31, 18.14it/s, est. speed input: 17814.89 toks/s, output: 17.40 toks/s]
Processed prompts:  86%|████████▌ | 3530/4096 [03:23<00:32, 17.32it/s, est. speed input: 17806.31 toks/s, output: 17.39 toks/s]
Processed prompts:  87%|████████▋ | 3544/4096 [03:23<00:32, 16.76it/s, est. speed input: 17797.86 toks/s, output: 17.38 toks/s]
Processed prompts:  87%|████████▋ | 3558/4096 [03:24<00:32, 16.38it/s, est. speed input: 17789.47 toks/s, output: 17.37 toks/s]
Processed prompts:  87%|████████▋ | 3572/4096 [03:25<00:32, 16.12it/s, est. speed input: 17781.14 toks/s, output: 17.36 toks/s]
Processed prompts:  88%|████████▊ | 3586/4096 [03:26<00:32, 15.94it/s, est. speed input: 17772.85 toks/s, output: 17.36 toks/s]
Processed prompts:  88%|████████▊ | 3600/4096 [03:27<00:31, 15.80it/s, est. speed input: 17764.58 toks/s, output: 17.35 toks/s]
Processed prompts:  88%|████████▊ | 3614/4096 [03:28<00:30, 15.71it/s, est. speed input: 17756.41 toks/s, output: 17.34 toks/s]
Processed prompts:  89%|████████▊ | 3628/4096 [03:29<00:29, 15.65it/s, est. speed input: 17748.30 toks/s, output: 17.33 toks/s]
Processed prompts:  89%|████████▉ | 3642/4096 [03:30<00:29, 15.61it/s, est. speed input: 17740.23 toks/s, output: 17.32 toks/s]
Processed prompts:  89%|████████▉ | 3656/4096 [03:31<00:28, 15.58it/s, est. speed input: 17732.27 toks/s, output: 17.32 toks/s]
Processed prompts:  90%|████████▉ | 3670/4096 [03:32<00:27, 15.55it/s, est. speed input: 17724.35 toks/s, output: 17.31 toks/s]
Processed prompts:  90%|████████▉ | 3684/4096 [03:32<00:26, 15.54it/s, est. speed input: 17716.49 toks/s, output: 17.30 toks/s]
Processed prompts:  90%|█████████ | 3698/4096 [03:33<00:25, 15.53it/s, est. speed input: 17708.74 toks/s, output: 17.29 toks/s]
Processed prompts:  91%|█████████ | 3712/4096 [03:34<00:24, 15.52it/s, est. speed input: 17701.00 toks/s, output: 17.29 toks/s]
Processed prompts:  91%|█████████ | 3726/4096 [03:35<00:23, 15.52it/s, est. speed input: 17693.37 toks/s, output: 17.28 toks/s]
Processed prompts:  91%|█████████▏| 3740/4096 [03:36<00:22, 15.50it/s, est. speed input: 17685.66 toks/s, output: 17.27 toks/s]
Processed prompts:  92%|█████████▏| 3754/4096 [03:37<00:22, 15.50it/s, est. speed input: 17678.04 toks/s, output: 17.26 toks/s]
Processed prompts:  92%|█████████▏| 3768/4096 [03:38<00:21, 15.49it/s, est. speed input: 17670.49 toks/s, output: 17.26 toks/s]
Processed prompts:  92%|█████████▏| 3782/4096 [03:39<00:20, 15.49it/s, est. speed input: 17663.05 toks/s, output: 17.25 toks/s]
Processed prompts:  93%|█████████▎| 3796/4096 [03:40<00:19, 15.49it/s, est. speed input: 17655.68 toks/s, output: 17.24 toks/s]
Processed prompts:  93%|█████████▎| 3810/4096 [03:41<00:18, 15.49it/s, est. speed input: 17648.37 toks/s, output: 17.23 toks/s]
Processed prompts:  93%|█████████▎| 3824/4096 [03:41<00:17, 15.50it/s, est. speed input: 17641.14 toks/s, output: 17.23 toks/s]
Processed prompts:  94%|█████████▎| 3838/4096 [03:42<00:16, 15.49it/s, est. speed input: 17633.92 toks/s, output: 17.22 toks/s]
Processed prompts:  94%|█████████▍| 3852/4096 [03:43<00:15, 15.49it/s, est. speed input: 17626.77 toks/s, output: 17.21 toks/s]
Processed prompts:  94%|█████████▍| 3866/4096 [03:44<00:14, 15.50it/s, est. speed input: 17619.73 toks/s, output: 17.21 toks/s]
Processed prompts:  95%|█████████▍| 3880/4096 [03:45<00:13, 15.50it/s, est. speed input: 17612.71 toks/s, output: 17.20 toks/s]
Processed prompts:  95%|█████████▌| 3894/4096 [03:46<00:13, 15.50it/s, est. speed input: 17605.75 toks/s, output: 17.19 toks/s]
Processed prompts:  95%|█████████▌| 3908/4096 [03:47<00:12, 15.50it/s, est. speed input: 17598.86 toks/s, output: 17.19 toks/s]
Processed prompts:  96%|█████████▌| 3922/4096 [03:48<00:11, 15.50it/s, est. speed input: 17592.02 toks/s, output: 17.18 toks/s]
Processed prompts:  96%|█████████▌| 3936/4096 [03:49<00:10, 15.50it/s, est. speed input: 17585.25 toks/s, output: 17.17 toks/s]
Processed prompts:  96%|█████████▋| 3950/4096 [03:50<00:09, 15.50it/s, est. speed input: 17578.55 toks/s, output: 17.17 toks/s]
Processed prompts:  97%|█████████▋| 3978/4096 [03:50<00:04, 24.24it/s, est. speed input: 17672.80 toks/s, output: 17.26 toks/s]
Processed prompts:  97%|█████████▋| 3992/4096 [03:51<00:04, 21.28it/s, est. speed input: 17665.90 toks/s, output: 17.25 toks/s]
Processed prompts:  98%|█████████▊| 4006/4096 [03:52<00:04, 19.40it/s, est. speed input: 17659.08 toks/s, output: 17.25 toks/s]
Processed prompts:  98%|█████████▊| 4020/4096 [03:53<00:04, 18.17it/s, est. speed input: 17652.28 toks/s, output: 17.24 toks/s]
Processed prompts:  98%|█████████▊| 4034/4096 [03:54<00:03, 17.34it/s, est. speed input: 17645.53 toks/s, output: 17.23 toks/s]
Processed prompts:  99%|█████████▉| 4048/4096 [03:55<00:02, 16.79it/s, est. speed input: 17638.86 toks/s, output: 17.23 toks/s]
Processed prompts:  99%|█████████▉| 4062/4096 [03:55<00:02, 16.40it/s, est. speed input: 17632.25 toks/s, output: 17.22 toks/s]
Processed prompts: 100%|█████████▉| 4076/4096 [03:56<00:01, 16.14it/s, est. speed input: 17625.74 toks/s, output: 17.21 toks/s]
Processed prompts: 100%|█████████▉| 4090/4096 [03:57<00:00, 18.80it/s, est. speed input: 17652.59 toks/s, output: 17.24 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [03:57<00:00, 18.80it/s, est. speed input: 17678.46 toks/s, output: 17.26 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [03:57<00:00, 17.26it/s, est. speed input: 17678.46 toks/s, output: 17.26 toks/s]
[rank0]:[W126 05:47:40.216413252 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 345.7s

测试结果:
  Requests/s:   15.50
  Tokens/s:     15890.01
  Total Reqs:   4096
  Elapsed:      264.22s

  [Prefill 分析]
  Total Prefill Tokens: 4194304
  Prefill Tokens/s:     15874.51

============================================================
[8/8] 测试 M=65536
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-14B-INT8                                │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 65536
│   M_prefill     = 65536 (= 64 x 1024)
│   M_decode      = 64
│   batched_tokens = 65536 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 8192
│   --max-num-seqs           = 64
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 65536
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 05:48:50 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 05:48:51 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=251526) WARNING 01-26 05:48:59 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=251526) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=251526) WARNING 01-26 05:49:17 [backends.py:609] Failed to read file <frozen os>
(EngineCore_DP0 pid=251526) ERROR 01-26 05:50:20 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=251526) ERROR 01-26 05:50:20 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=251526) ERROR 01-26 05:50:20 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=251526) ERROR 01-26 05:50:20 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=251526) ERROR 01-26 05:50:20 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=251526) ERROR 01-26 05:50:20 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=251526) ERROR 01-26 05:50:20 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=251526) ERROR 01-26 05:50:20 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=251526) ERROR 01-26 05:50:20 [core.py:866]     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=251526) ERROR 01-26 05:50:20 [core.py:866]                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=251526) ERROR 01-26 05:50:20 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 248, in _initialize_kv_caches
(EngineCore_DP0 pid=251526) ERROR 01-26 05:50:20 [core.py:866]     kv_cache_configs = get_kv_cache_configs(
(EngineCore_DP0 pid=251526) ERROR 01-26 05:50:20 [core.py:866]                        ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=251526) ERROR 01-26 05:50:20 [core.py:866]   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 1340, in get_kv_cache_configs
(EngineCore_DP0 pid=251526) ERROR 01-26 05:50:20 [core.py:866]     check_enough_kv_cache_memory(
(EngineCore_DP0 pid=251526) ERROR 01-26 05:50:20 [core.py:866]   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 687, in check_enough_kv_cache_memory
(EngineCore_DP0 pid=251526) ERROR 01-26 05:50:20 [core.py:866]     raise ValueError(
(EngineCore_DP0 pid=251526) ERROR 01-26 05:50:20 [core.py:866] ValueError: No available memory for the cache blocks. Try increasing `gpu_memory_utilization` when initializing the engine. See https://docs.vllm.ai/en/latest/configuration/conserving_memory/ for more details.


─── STDERR ───
[2026-01-26 05:48:50] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:48:50] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:48:50] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:48:50] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:48:50] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:48:50] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:48:50] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:48:50] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:48:50] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:48:50] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:48:50] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:48:50] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:48:50] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:48:50] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 05:48:58] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:48:58] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:48:58] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:48:58] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:48:58] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:48:58] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:48:58] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:48:58] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:48:58] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:48:58] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:48:58] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:48:58] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:48:58] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:48:58] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=251526) [2026-01-26 05:49:00] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=251526) [2026-01-26 05:49:00] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=251526) [2026-01-26 05:49:00] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=251526) [2026-01-26 05:49:00] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=251526) [2026-01-26 05:49:00] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=251526) [2026-01-26 05:49:00] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=251526) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=251526) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:00<00:02,  1.05it/s]
(EngineCore_DP0 pid=251526) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.02it/s]
(EngineCore_DP0 pid=251526) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.44it/s]
(EngineCore_DP0 pid=251526) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.26it/s]
(EngineCore_DP0 pid=251526) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.23it/s]
(EngineCore_DP0 pid=251526) 
(EngineCore_DP0 pid=251526) [2026-01-26 05:49:04] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 5120] -> 1D uint8
(EngineCore_DP0 pid=251526) [2026-01-26 05:49:04] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 27525120 bytes
(EngineCore_DP0 pid=251526) [2026-01-26 05:49:04] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 5120] -> 1D uint8
(EngineCore_DP0 pid=251526) [2026-01-26 05:49:04] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 19660800 bytes
(EngineCore_DP0 pid=251526) [2026-01-26 05:49:04] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 5120] -> 1D uint8
(EngineCore_DP0 pid=251526) [2026-01-26 05:49:04] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 106168320 bytes
(EngineCore_DP0 pid=251526) [2026-01-26 05:49:04] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 13824] -> 1D uint8
(EngineCore_DP0 pid=251526) [2026-01-26 05:49:04] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 53084160 bytes
(EngineCore_DP0 pid=251526) [rank0]:W0126 05:49:30.482000 251526 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=251526) [rank0]:W0126 05:49:30.560000 251526 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=251526) [rank0]:W0126 05:49:32.084000 251526 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=251526) [rank0]:W0126 05:49:32.199000 251526 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=251526) Process EngineCore_DP0:
(EngineCore_DP0 pid=251526) Traceback (most recent call last):
(EngineCore_DP0 pid=251526)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=251526)     self.run()
(EngineCore_DP0 pid=251526)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=251526)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=251526)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=251526)     raise e
(EngineCore_DP0 pid=251526)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=251526)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=251526)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=251526)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=251526)     super().__init__(
(EngineCore_DP0 pid=251526)   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=251526)     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=251526)                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=251526)   File "/root/vllmbench/vllm/v1/engine/core.py", line 248, in _initialize_kv_caches
(EngineCore_DP0 pid=251526)     kv_cache_configs = get_kv_cache_configs(
(EngineCore_DP0 pid=251526)                        ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=251526)   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 1340, in get_kv_cache_configs
(EngineCore_DP0 pid=251526)     check_enough_kv_cache_memory(
(EngineCore_DP0 pid=251526)   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 687, in check_enough_kv_cache_memory
(EngineCore_DP0 pid=251526)     raise ValueError(
(EngineCore_DP0 pid=251526) ValueError: No available memory for the cache blocks. Try increasing `gpu_memory_utilization` when initializing the engine. See https://docs.vllm.ai/en/latest/configuration/conserving_memory/ for more details.
[rank0]:[W126 05:50:21.258051017 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

[ERROR] 测试失败: M=65536 (exit code: 1)


------------------------------------------------------------
  生成 CSV: Qwen2.5-14B-INT8
------------------------------------------------------------
[SUCCESS] CSV 保存到: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_4/Qwen2.5-14B-INT8_prefill.csv

预览:
------------------------------------------------------------
M_prefill,prompt_len,max_num_seqs,num_prompts,N_prefill,requests_per_s,tokens_per_s,elapsed_time_s
512,512,1,128,128,9.2594,4750.0907,13.8237
1024,1024,1,128,128,9.2061,9436.2765,13.9038
2048,1024,2,256,128,15.4412,15827.2252,16.5790
4096,1024,4,512,128,15.6343,16025.1917,32.7484
8192,1024,8,1024,128,15.5175,15905.4530,65.9899
16384,1024,16,2048,128,15.4341,15819.9060,132.6936
32768,1024,32,4096,128,15.5024,15890.0103,264.2163
65536,1024,64,8192,128,-1.0000,-1.0000,-1.0000

------------------------------------------------------------

[INFO] 完成: 7 成功, 1 失败

============================================================
  Qwen2.5-14B-INT8 | cuSPARSELt (2_6) | prefill
============================================================

[INFO] Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_6
[INFO] Output: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6

============================================================
[1/8] 测试 M=512
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-14B-INT8                                │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 512
│   M_prefill     = 512 (= 1 x 512)
│   M_decode      = 1
│   batched_tokens = 513 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 512
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 513
│   --max-num-batched-tokens = 513
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 05:50:34 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 05:50:35 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=253218) WARNING 01-26 05:50:41 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=253218) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=253218) WARNING 01-26 05:51:11 [backends.py:609] Failed to read file <frozen os>
Throughput: 9.70 requests/s, 4978.09 total tokens/s, 9.70 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128


─── STDERR ───
[2026-01-26 05:50:34] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:50:34] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:50:34] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:50:34] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:50:34] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:50:34] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:50:34] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:50:34] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:50:34] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:50:34] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:50:34] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:50:34] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:50:34] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:50:34] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 05:50:40] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:50:40] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:50:40] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:50:40] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:50:40] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:50:40] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:50:40] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:50:40] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:50:40] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:50:40] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:50:40] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:50:40] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:50:40] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:50:40] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=253218) [2026-01-26 05:50:42] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=253218) [2026-01-26 05:50:42] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=253218) [2026-01-26 05:50:42] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=253218) [2026-01-26 05:50:42] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=253218) [2026-01-26 05:50:42] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=253218) [2026-01-26 05:50:42] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=253218) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=253218) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:05<00:15,  5.04s/it]
(EngineCore_DP0 pid=253218) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:09<00:09,  4.75s/it]
(EngineCore_DP0 pid=253218) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:10<00:03,  3.14s/it]
(EngineCore_DP0 pid=253218) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:15<00:00,  3.81s/it]
(EngineCore_DP0 pid=253218) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:15<00:00,  3.91s/it]
(EngineCore_DP0 pid=253218) 
(EngineCore_DP0 pid=253218) [2026-01-26 05:50:58] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 6848] -> 1D uint8
(EngineCore_DP0 pid=253218) [2026-01-26 05:50:58] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 36929536 bytes
(EngineCore_DP0 pid=253218) [2026-01-26 05:50:58] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 6848] -> 1D uint8
(EngineCore_DP0 pid=253218) [2026-01-26 05:50:58] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 26378240 bytes
(EngineCore_DP0 pid=253218) [2026-01-26 05:50:58] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 6848] -> 1D uint8
(EngineCore_DP0 pid=253218) [2026-01-26 05:50:58] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 142442496 bytes
(EngineCore_DP0 pid=253218) [2026-01-26 05:50:58] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 18432] -> 1D uint8
(EngineCore_DP0 pid=253218) [2026-01-26 05:50:59] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 70778880 bytes
(EngineCore_DP0 pid=253218) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  1.74it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:01<00:00,  1.58it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:01<00:00,  1.60it/s]
(EngineCore_DP0 pid=253218) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  3.73it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  3.73it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  34%|███▍      | 44/128 [00:00<00:00, 430.69it/s]
Adding requests:  71%|███████   | 91/128 [00:00<00:00, 448.84it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 449.94it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:32,  3.90it/s, est. speed input: 1994.70 toks/s, output: 3.90 toks/s]
Processed prompts:   2%|▏         | 2/128 [00:00<00:20,  6.05it/s, est. speed input: 2861.75 toks/s, output: 5.59 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:16,  7.36it/s, est. speed input: 3347.52 toks/s, output: 6.54 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:15,  8.19it/s, est. speed input: 3659.09 toks/s, output: 7.15 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:14,  8.75it/s, est. speed input: 3876.98 toks/s, output: 7.57 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:12,  9.32it/s, est. speed input: 4161.92 toks/s, output: 8.13 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:00<00:12,  9.49it/s, est. speed input: 4261.46 toks/s, output: 8.32 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:01<00:12,  9.62it/s, est. speed input: 4341.42 toks/s, output: 8.48 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:01<00:12,  9.69it/s, est. speed input: 4403.80 toks/s, output: 8.60 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:01<00:11,  9.87it/s, est. speed input: 4515.54 toks/s, output: 8.82 toks/s]
Processed prompts:  11%|█         | 14/128 [00:01<00:11,  9.99it/s, est. speed input: 4604.22 toks/s, output: 8.99 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:01<00:11, 10.03it/s, est. speed input: 4667.56 toks/s, output: 9.12 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:01<00:10, 10.07it/s, est. speed input: 4720.50 toks/s, output: 9.22 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:02<00:10, 10.04it/s, est. speed input: 4757.69 toks/s, output: 9.29 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:02<00:10, 10.04it/s, est. speed input: 4790.05 toks/s, output: 9.36 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:02<00:10, 10.08it/s, est. speed input: 4821.84 toks/s, output: 9.42 toks/s]
Processed prompts:  20%|██        | 26/128 [00:02<00:10, 10.09it/s, est. speed input: 4847.24 toks/s, output: 9.47 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:02<00:09, 10.08it/s, est. speed input: 4867.67 toks/s, output: 9.51 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:03<00:09, 10.06it/s, est. speed input: 4884.61 toks/s, output: 9.54 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:03<00:09, 10.03it/s, est. speed input: 4897.50 toks/s, output: 9.57 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:03<00:09, 10.02it/s, est. speed input: 4909.93 toks/s, output: 9.59 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:03<00:09, 10.02it/s, est. speed input: 4921.81 toks/s, output: 9.61 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:03<00:08, 10.02it/s, est. speed input: 4932.63 toks/s, output: 9.63 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:04<00:08, 10.01it/s, est. speed input: 4941.49 toks/s, output: 9.65 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:04<00:08,  9.98it/s, est. speed input: 4947.30 toks/s, output: 9.66 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:04<00:08,  9.97it/s, est. speed input: 4950.56 toks/s, output: 9.67 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:04<00:08, 10.01it/s, est. speed input: 4959.57 toks/s, output: 9.69 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:04<00:08, 10.05it/s, est. speed input: 4968.94 toks/s, output: 9.70 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:05<00:07, 10.04it/s, est. speed input: 4975.35 toks/s, output: 9.72 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:05<00:07, 10.04it/s, est. speed input: 4981.87 toks/s, output: 9.73 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:05<00:07, 10.04it/s, est. speed input: 4987.39 toks/s, output: 9.74 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:05<00:07, 10.04it/s, est. speed input: 4992.93 toks/s, output: 9.75 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:05<00:07, 10.07it/s, est. speed input: 4999.84 toks/s, output: 9.77 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:06<00:06, 10.09it/s, est. speed input: 5006.08 toks/s, output: 9.78 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:06<00:06, 10.05it/s, est. speed input: 5008.95 toks/s, output: 9.78 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:06<00:01, 34.93it/s, est. speed input: 6141.38 toks/s, output: 11.99 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:06<00:02, 20.03it/s, est. speed input: 6059.95 toks/s, output: 11.84 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:07<00:02, 16.34it/s, est. speed input: 6008.22 toks/s, output: 11.73 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:07<00:02, 14.25it/s, est. speed input: 5967.55 toks/s, output: 11.66 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:08<00:02, 13.12it/s, est. speed input: 5937.07 toks/s, output: 11.60 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:08<00:02, 12.24it/s, est. speed input: 5907.23 toks/s, output: 11.54 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:08<00:02, 11.76it/s, est. speed input: 5888.07 toks/s, output: 11.50 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:08<00:02, 11.37it/s, est. speed input: 5871.30 toks/s, output: 11.47 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:08<00:02, 11.04it/s, est. speed input: 5854.97 toks/s, output: 11.44 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:09<00:02, 10.75it/s, est. speed input: 5837.82 toks/s, output: 11.40 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:09<00:02, 10.56it/s, est. speed input: 5823.13 toks/s, output: 11.37 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:09<00:01, 10.45it/s, est. speed input: 5810.11 toks/s, output: 11.35 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:09<00:01, 10.35it/s, est. speed input: 5797.05 toks/s, output: 11.32 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:09<00:01, 10.25it/s, est. speed input: 5783.64 toks/s, output: 11.30 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:10<00:01, 10.20it/s, est. speed input: 5771.54 toks/s, output: 11.27 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:10<00:01, 10.18it/s, est. speed input: 5760.11 toks/s, output: 11.25 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:10<00:00, 10.13it/s, est. speed input: 5748.05 toks/s, output: 11.23 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:10<00:00, 10.12it/s, est. speed input: 5737.55 toks/s, output: 11.21 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:10<00:00, 10.10it/s, est. speed input: 5726.68 toks/s, output: 11.18 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:11<00:00, 10.08it/s, est. speed input: 5716.10 toks/s, output: 11.16 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:11<00:00, 10.04it/s, est. speed input: 5704.87 toks/s, output: 11.14 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:11<00:00, 10.05it/s, est. speed input: 5695.65 toks/s, output: 11.12 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:11<00:00, 10.05it/s, est. speed input: 5695.65 toks/s, output: 11.12 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:11<00:00, 11.12it/s, est. speed input: 5695.65 toks/s, output: 11.12 toks/s]
[rank0]:[W126 05:51:47.763154497 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 84.9s

测试结果:
  Requests/s:   9.70
  Tokens/s:     4978.09
  Total Reqs:   128
  Elapsed:      13.19s

  [Prefill 分析]
  Total Prefill Tokens: 65536
  Prefill Tokens/s:     4968.38

============================================================
[2/8] 测试 M=1024
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-14B-INT8                                │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 1024
│   M_prefill     = 1024 (= 1 x 1024)
│   M_decode      = 1
│   batched_tokens = 1025 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 1025
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 05:51:59 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 05:52:00 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=254698) WARNING 01-26 05:52:08 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=254698) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=254698) WARNING 01-26 05:52:38 [backends.py:609] Failed to read file <frozen os>
Throughput: 9.71 requests/s, 9948.15 total tokens/s, 9.71 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128


─── STDERR ───
[2026-01-26 05:51:59] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:51:59] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:51:59] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:51:59] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:51:59] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:51:59] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:51:59] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:51:59] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:51:59] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:51:59] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:51:59] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:51:59] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:51:59] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:51:59] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 05:52:07] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:52:07] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:52:07] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:52:07] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:52:07] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:52:07] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:52:07] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:52:07] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:52:07] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:52:07] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:52:07] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:52:07] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:52:07] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:52:07] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=254698) [2026-01-26 05:52:08] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=254698) [2026-01-26 05:52:08] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=254698) [2026-01-26 05:52:08] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=254698) [2026-01-26 05:52:08] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=254698) [2026-01-26 05:52:08] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=254698) [2026-01-26 05:52:08] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=254698) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=254698) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:03<00:10,  3.48s/it]
(EngineCore_DP0 pid=254698) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:08<00:08,  4.11s/it]
(EngineCore_DP0 pid=254698) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:09<00:02,  2.79s/it]
(EngineCore_DP0 pid=254698) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:14<00:00,  3.62s/it]
(EngineCore_DP0 pid=254698) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:14<00:00,  3.53s/it]
(EngineCore_DP0 pid=254698) 
(EngineCore_DP0 pid=254698) [2026-01-26 05:52:23] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 6848] -> 1D uint8
(EngineCore_DP0 pid=254698) [2026-01-26 05:52:23] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 36929536 bytes
(EngineCore_DP0 pid=254698) [2026-01-26 05:52:23] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 6848] -> 1D uint8
(EngineCore_DP0 pid=254698) [2026-01-26 05:52:23] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 26378240 bytes
(EngineCore_DP0 pid=254698) [2026-01-26 05:52:23] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 6848] -> 1D uint8
(EngineCore_DP0 pid=254698) [2026-01-26 05:52:23] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 142442496 bytes
(EngineCore_DP0 pid=254698) [2026-01-26 05:52:23] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 18432] -> 1D uint8
(EngineCore_DP0 pid=254698) [2026-01-26 05:52:23] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 70778880 bytes
(EngineCore_DP0 pid=254698) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  2.00it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  3.08it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  2.85it/s]
(EngineCore_DP0 pid=254698) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  4.66it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  4.66it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  17%|█▋        | 22/128 [00:00<00:00, 217.85it/s]
Adding requests:  37%|███▋      | 47/128 [00:00<00:00, 234.20it/s]
Adding requests:  57%|█████▋    | 73/128 [00:00<00:00, 241.21it/s]
Adding requests:  77%|███████▋  | 98/128 [00:00<00:00, 240.58it/s]
Adding requests:  96%|█████████▌| 123/128 [00:00<00:00, 240.46it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 238.50it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:05, 22.58it/s, est. speed input: 23126.70 toks/s, output: 22.58 toks/s]
Processed prompts:   5%|▍         | 6/128 [00:00<00:09, 12.99it/s, est. speed input: 14207.88 toks/s, output: 13.87 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:00<00:10, 11.73it/s, est. speed input: 12952.77 toks/s, output: 12.65 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:00<00:10, 11.12it/s, est. speed input: 12330.39 toks/s, output: 12.04 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:01<00:10, 10.76it/s, est. speed input: 11944.93 toks/s, output: 11.66 toks/s]
Processed prompts:  11%|█         | 14/128 [00:01<00:10, 10.45it/s, est. speed input: 11638.75 toks/s, output: 11.37 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:01<00:10, 10.30it/s, est. speed input: 11440.99 toks/s, output: 11.17 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:01<00:10, 10.17it/s, est. speed input: 11279.32 toks/s, output: 11.01 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:01<00:10, 10.09it/s, est. speed input: 11152.69 toks/s, output: 10.89 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:02<00:10, 10.02it/s, est. speed input: 11047.44 toks/s, output: 10.79 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:02<00:10,  9.96it/s, est. speed input: 10957.46 toks/s, output: 10.70 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:02<00:10,  9.93it/s, est. speed input: 10918.91 toks/s, output: 10.66 toks/s]
Processed prompts:  20%|██        | 26/128 [00:02<00:10,  9.92it/s, est. speed input: 10885.28 toks/s, output: 10.63 toks/s]
Processed prompts:  21%|██        | 27/128 [00:02<00:10,  9.90it/s, est. speed input: 10851.77 toks/s, output: 10.60 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:02<00:10,  9.89it/s, est. speed input: 10822.96 toks/s, output: 10.57 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:02<00:10,  9.86it/s, est. speed input: 10792.18 toks/s, output: 10.54 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:02<00:09,  9.86it/s, est. speed input: 10767.49 toks/s, output: 10.52 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:02<00:09,  9.83it/s, est. speed input: 10740.93 toks/s, output: 10.49 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:03<00:09,  9.82it/s, est. speed input: 10717.43 toks/s, output: 10.47 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:03<00:09,  9.79it/s, est. speed input: 10692.70 toks/s, output: 10.44 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:03<00:09,  9.91it/s, est. speed input: 10669.53 toks/s, output: 10.42 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:03<00:09, 10.05it/s, est. speed input: 10661.54 toks/s, output: 10.41 toks/s]
Processed prompts:  30%|███       | 39/128 [00:03<00:08, 10.11it/s, est. speed input: 10651.58 toks/s, output: 10.40 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:03<00:08, 10.14it/s, est. speed input: 10640.71 toks/s, output: 10.39 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:04<00:08, 10.16it/s, est. speed input: 10630.86 toks/s, output: 10.38 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:04<00:08, 10.13it/s, est. speed input: 10615.93 toks/s, output: 10.37 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:04<00:08, 10.12it/s, est. speed input: 10603.68 toks/s, output: 10.36 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:04<00:07, 10.11it/s, est. speed input: 10592.91 toks/s, output: 10.34 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:04<00:07, 10.10it/s, est. speed input: 10582.16 toks/s, output: 10.33 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:05<00:07, 10.16it/s, est. speed input: 10580.46 toks/s, output: 10.33 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:05<00:07, 10.11it/s, est. speed input: 10567.57 toks/s, output: 10.32 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:05<00:07, 10.09it/s, est. speed input: 10557.90 toks/s, output: 10.31 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:05<00:06, 10.11it/s, est. speed input: 10551.88 toks/s, output: 10.30 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:05<00:06, 10.09it/s, est. speed input: 10543.29 toks/s, output: 10.30 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:06<00:06, 10.10it/s, est. speed input: 10537.45 toks/s, output: 10.29 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:06<00:06, 10.02it/s, est. speed input: 10522.43 toks/s, output: 10.28 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:06<00:06, 10.05it/s, est. speed input: 10517.93 toks/s, output: 10.27 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:06<00:05, 10.08it/s, est. speed input: 10514.53 toks/s, output: 10.27 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:06<00:05, 10.11it/s, est. speed input: 10511.36 toks/s, output: 10.26 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:07<00:05, 10.13it/s, est. speed input: 10509.09 toks/s, output: 10.26 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:07<00:05, 10.11it/s, est. speed input: 10503.28 toks/s, output: 10.26 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:07<00:05, 10.13it/s, est. speed input: 10500.94 toks/s, output: 10.25 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:07<00:04, 10.15it/s, est. speed input: 10500.04 toks/s, output: 10.25 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:07<00:04, 10.13it/s, est. speed input: 10495.76 toks/s, output: 10.25 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:08<00:04, 10.07it/s, est. speed input: 10487.29 toks/s, output: 10.24 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:08<00:04, 10.05it/s, est. speed input: 10481.17 toks/s, output: 10.24 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:08<00:04,  9.97it/s, est. speed input: 10470.24 toks/s, output: 10.22 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:08<00:04,  9.95it/s, est. speed input: 10466.25 toks/s, output: 10.22 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:08<00:03,  9.94it/s, est. speed input: 10462.16 toks/s, output: 10.22 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:08<00:03,  9.94it/s, est. speed input: 10459.12 toks/s, output: 10.21 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:08<00:03,  9.95it/s, est. speed input: 10456.24 toks/s, output: 10.21 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:09<00:03,  9.94it/s, est. speed input: 10453.00 toks/s, output: 10.21 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:09<00:03,  9.93it/s, est. speed input: 10449.60 toks/s, output: 10.20 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:09<00:03,  9.93it/s, est. speed input: 10446.55 toks/s, output: 10.20 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:09<00:03,  9.87it/s, est. speed input: 10441.02 toks/s, output: 10.20 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:09<00:03,  9.84it/s, est. speed input: 10436.31 toks/s, output: 10.19 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:09<00:03,  9.84it/s, est. speed input: 10432.41 toks/s, output: 10.19 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:09<00:03,  9.86it/s, est. speed input: 10429.23 toks/s, output: 10.18 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:09<00:02,  9.89it/s, est. speed input: 10426.98 toks/s, output: 10.18 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:09<00:02,  9.95it/s, est. speed input: 10423.85 toks/s, output: 10.18 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:10<00:02,  9.96it/s, est. speed input: 10421.91 toks/s, output: 10.18 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:10<00:02,  9.97it/s, est. speed input: 10417.85 toks/s, output: 10.17 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:10<00:02,  9.96it/s, est. speed input: 10413.56 toks/s, output: 10.17 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:10<00:02,  9.93it/s, est. speed input: 10409.81 toks/s, output: 10.17 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:10<00:02,  9.93it/s, est. speed input: 10407.57 toks/s, output: 10.16 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:10<00:01,  9.97it/s, est. speed input: 10404.95 toks/s, output: 10.16 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:11<00:01,  9.98it/s, est. speed input: 10401.78 toks/s, output: 10.16 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:11<00:01,  9.98it/s, est. speed input: 10400.22 toks/s, output: 10.16 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:11<00:01,  9.98it/s, est. speed input: 10397.30 toks/s, output: 10.15 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:11<00:01,  9.92it/s, est. speed input: 10393.07 toks/s, output: 10.15 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:11<00:01,  9.88it/s, est. speed input: 10389.51 toks/s, output: 10.15 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:11<00:01,  9.86it/s, est. speed input: 10386.45 toks/s, output: 10.14 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:11<00:00,  9.86it/s, est. speed input: 10383.91 toks/s, output: 10.14 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:11<00:00,  9.86it/s, est. speed input: 10381.51 toks/s, output: 10.14 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:11<00:00,  9.84it/s, est. speed input: 10378.22 toks/s, output: 10.13 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:12<00:00,  9.85it/s, est. speed input: 10376.02 toks/s, output: 10.13 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:12<00:00,  9.87it/s, est. speed input: 10374.18 toks/s, output: 10.13 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:12<00:00,  9.88it/s, est. speed input: 10372.25 toks/s, output: 10.13 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:12<00:00,  9.86it/s, est. speed input: 10369.76 toks/s, output: 10.13 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:12<00:00,  9.85it/s, est. speed input: 10367.08 toks/s, output: 10.12 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:12<00:00,  9.83it/s, est. speed input: 10364.20 toks/s, output: 10.12 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:12<00:00,  9.82it/s, est. speed input: 10361.49 toks/s, output: 10.12 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:12<00:00,  9.82it/s, est. speed input: 10361.49 toks/s, output: 10.12 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:12<00:00, 10.12it/s, est. speed input: 10361.49 toks/s, output: 10.12 toks/s]
[rank0]:[W126 05:53:13.476951213 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 84.5s

测试结果:
  Requests/s:   9.71
  Tokens/s:     9948.15
  Total Reqs:   128
  Elapsed:      13.19s

  [Prefill 分析]
  Total Prefill Tokens: 131072
  Prefill Tokens/s:     9938.44

============================================================
[3/8] 测试 M=2048
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-14B-INT8                                │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 2048
│   M_prefill     = 2048 (= 2 x 1024)
│   M_decode      = 2
│   batched_tokens = 2048 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 256
│   --max-num-seqs           = 2
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 2048
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 05:53:24 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 05:53:25 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=256134) WARNING 01-26 05:53:33 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=256134) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=256134) WARNING 01-26 05:53:52 [backends.py:609] Failed to read file <frozen os>
Throughput: 13.09 requests/s, 13419.97 total tokens/s, 13.09 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256


─── STDERR ───
[2026-01-26 05:53:24] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:53:24] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:53:24] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:53:24] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:53:24] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:53:24] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:53:24] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:53:24] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:53:24] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:53:24] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:53:24] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:53:24] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:53:24] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:53:24] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 05:53:32] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:53:32] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:53:32] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:53:32] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:53:32] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:53:32] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:53:32] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:53:32] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:53:32] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:53:32] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:53:32] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:53:32] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:53:32] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:53:32] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=256134) [2026-01-26 05:53:34] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=256134) [2026-01-26 05:53:34] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=256134) [2026-01-26 05:53:34] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=256134) [2026-01-26 05:53:34] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=256134) [2026-01-26 05:53:34] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=256134) [2026-01-26 05:53:34] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=256134) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=256134) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:01<00:03,  1.26s/it]
(EngineCore_DP0 pid=256134) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:02<00:02,  1.27s/it]
(EngineCore_DP0 pid=256134) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.15it/s]
(EngineCore_DP0 pid=256134) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.00it/s]
(EngineCore_DP0 pid=256134) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.03s/it]
(EngineCore_DP0 pid=256134) 
(EngineCore_DP0 pid=256134) [2026-01-26 05:53:39] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 6848] -> 1D uint8
(EngineCore_DP0 pid=256134) [2026-01-26 05:53:39] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 36929536 bytes
(EngineCore_DP0 pid=256134) [2026-01-26 05:53:39] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 6848] -> 1D uint8
(EngineCore_DP0 pid=256134) [2026-01-26 05:53:39] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 26378240 bytes
(EngineCore_DP0 pid=256134) [2026-01-26 05:53:39] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 6848] -> 1D uint8
(EngineCore_DP0 pid=256134) [2026-01-26 05:53:39] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 142442496 bytes
(EngineCore_DP0 pid=256134) [2026-01-26 05:53:39] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 18432] -> 1D uint8
(EngineCore_DP0 pid=256134) [2026-01-26 05:53:39] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 70778880 bytes
(EngineCore_DP0 pid=256134) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  33%|███▎      | 1/3 [00:00<00:00,  2.59it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  67%|██████▋   | 2/3 [00:00<00:00,  2.83it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:01<00:00,  2.97it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:01<00:00,  2.90it/s]
(EngineCore_DP0 pid=256134) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 1/2 [00:00<00:00,  4.81it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  5.28it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  5.20it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:   9%|▊         | 22/256 [00:00<00:01, 218.42it/s]
Adding requests:  18%|█▊        | 47/256 [00:00<00:00, 232.26it/s]
Adding requests:  29%|██▉       | 74/256 [00:00<00:00, 244.74it/s]
Adding requests:  39%|███▊      | 99/256 [00:00<00:00, 244.03it/s]
Adding requests:  49%|████▉     | 126/256 [00:00<00:00, 250.47it/s]
Adding requests:  59%|█████▉    | 152/256 [00:00<00:00, 250.55it/s]
Adding requests:  70%|██████▉   | 178/256 [00:00<00:00, 252.44it/s]
Adding requests:  80%|████████  | 205/256 [00:00<00:00, 256.21it/s]
Adding requests:  91%|█████████ | 233/256 [00:00<00:00, 261.31it/s]
Adding requests: 100%|██████████| 256/256 [00:01<00:00, 251.92it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▍         | 12/256 [00:00<00:04, 53.86it/s, est. speed input: 55160.74 toks/s, output: 53.86 toks/s]
Processed prompts:  13%|█▎        | 34/256 [00:00<00:02, 78.52it/s, est. speed input: 76695.04 toks/s, output: 74.89 toks/s]
Processed prompts:  16%|█▋        | 42/256 [00:01<00:06, 33.58it/s, est. speed input: 40774.71 toks/s, output: 39.82 toks/s]
Processed prompts:  18%|█▊        | 47/256 [00:01<00:07, 28.00it/s, est. speed input: 35518.75 toks/s, output: 34.69 toks/s]
Processed prompts:  20%|█▉        | 51/256 [00:01<00:08, 23.33it/s, est. speed input: 31569.24 toks/s, output: 30.83 toks/s]
Processed prompts:  21%|██        | 54/256 [00:01<00:10, 19.16it/s, est. speed input: 28305.76 toks/s, output: 27.64 toks/s]
Processed prompts:  22%|██▏       | 57/256 [00:02<00:10, 19.30it/s, est. speed input: 27740.49 toks/s, output: 27.09 toks/s]
Processed prompts:  23%|██▎       | 60/256 [00:02<00:12, 16.12it/s, est. speed input: 25563.18 toks/s, output: 24.96 toks/s]
Processed prompts:  24%|██▍       | 62/256 [00:02<00:12, 15.56it/s, est. speed input: 24860.52 toks/s, output: 24.28 toks/s]
Processed prompts:  25%|██▌       | 64/256 [00:02<00:12, 15.08it/s, est. speed input: 24240.94 toks/s, output: 23.67 toks/s]
Processed prompts:  26%|██▌       | 66/256 [00:02<00:12, 14.67it/s, est. speed input: 23686.91 toks/s, output: 23.13 toks/s]
Processed prompts:  27%|██▋       | 68/256 [00:03<00:13, 14.31it/s, est. speed input: 23180.74 toks/s, output: 22.64 toks/s]
Processed prompts:  27%|██▋       | 70/256 [00:03<00:13, 14.04it/s, est. speed input: 22725.77 toks/s, output: 22.19 toks/s]
Processed prompts:  28%|██▊       | 72/256 [00:03<00:13, 13.84it/s, est. speed input: 22312.46 toks/s, output: 21.79 toks/s]
Processed prompts:  29%|██▉       | 74/256 [00:03<00:13, 13.70it/s, est. speed input: 21935.70 toks/s, output: 21.42 toks/s]
Processed prompts:  30%|██▉       | 76/256 [00:03<00:13, 13.57it/s, est. speed input: 21585.73 toks/s, output: 21.08 toks/s]
Processed prompts:  30%|███       | 78/256 [00:03<00:13, 13.49it/s, est. speed input: 21267.56 toks/s, output: 20.77 toks/s]
Processed prompts:  31%|███▏      | 80/256 [00:03<00:13, 13.43it/s, est. speed input: 20971.11 toks/s, output: 20.48 toks/s]
Processed prompts:  32%|███▏      | 82/256 [00:04<00:13, 13.38it/s, est. speed input: 20696.38 toks/s, output: 20.21 toks/s]
Processed prompts:  33%|███▎      | 84/256 [00:04<00:12, 13.36it/s, est. speed input: 20443.59 toks/s, output: 19.96 toks/s]
Processed prompts:  34%|███▎      | 86/256 [00:04<00:12, 13.35it/s, est. speed input: 20209.18 toks/s, output: 19.74 toks/s]
Processed prompts:  34%|███▍      | 88/256 [00:04<00:12, 13.33it/s, est. speed input: 19989.73 toks/s, output: 19.52 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:04<00:12, 13.31it/s, est. speed input: 19782.33 toks/s, output: 19.32 toks/s]
Processed prompts:  36%|███▌      | 92/256 [00:04<00:12, 13.32it/s, est. speed input: 19590.68 toks/s, output: 19.13 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:04<00:12, 13.33it/s, est. speed input: 19411.68 toks/s, output: 18.96 toks/s]
Processed prompts:  38%|███▊      | 96/256 [00:05<00:12, 13.33it/s, est. speed input: 19243.13 toks/s, output: 18.79 toks/s]
Processed prompts:  38%|███▊      | 98/256 [00:05<00:11, 13.33it/s, est. speed input: 19083.24 toks/s, output: 18.64 toks/s]
Processed prompts:  39%|███▉      | 100/256 [00:05<00:11, 13.32it/s, est. speed input: 18931.39 toks/s, output: 18.49 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:05<00:11, 13.33it/s, est. speed input: 18789.34 toks/s, output: 18.35 toks/s]
Processed prompts:  41%|████      | 104/256 [00:05<00:11, 13.32it/s, est. speed input: 18653.51 toks/s, output: 18.22 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:05<00:11, 13.33it/s, est. speed input: 18525.79 toks/s, output: 18.09 toks/s]
Processed prompts:  42%|████▏     | 108/256 [00:06<00:11, 13.33it/s, est. speed input: 18404.63 toks/s, output: 17.97 toks/s]
Processed prompts:  43%|████▎     | 110/256 [00:06<00:10, 13.33it/s, est. speed input: 18288.04 toks/s, output: 17.86 toks/s]
Processed prompts:  44%|████▍     | 112/256 [00:06<00:10, 13.32it/s, est. speed input: 18176.47 toks/s, output: 17.75 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:06<00:10, 13.30it/s, est. speed input: 18068.94 toks/s, output: 17.65 toks/s]
Processed prompts:  45%|████▌     | 116/256 [00:06<00:10, 13.30it/s, est. speed input: 17968.21 toks/s, output: 17.55 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:06<00:10, 13.30it/s, est. speed input: 17871.19 toks/s, output: 17.45 toks/s]
Processed prompts:  47%|████▋     | 120/256 [00:06<00:10, 13.29it/s, est. speed input: 17778.18 toks/s, output: 17.36 toks/s]
Processed prompts:  48%|████▊     | 122/256 [00:07<00:10, 13.29it/s, est. speed input: 17688.70 toks/s, output: 17.27 toks/s]
Processed prompts:  48%|████▊     | 124/256 [00:07<00:09, 13.28it/s, est. speed input: 17602.56 toks/s, output: 17.19 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:07<00:09, 13.28it/s, est. speed input: 17520.75 toks/s, output: 17.11 toks/s]
Processed prompts:  50%|█████     | 128/256 [00:07<00:09, 13.30it/s, est. speed input: 17443.82 toks/s, output: 17.03 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:07<00:09, 13.31it/s, est. speed input: 17369.42 toks/s, output: 16.96 toks/s]
Processed prompts:  52%|█████▏    | 132/256 [00:07<00:09, 13.30it/s, est. speed input: 17296.55 toks/s, output: 16.89 toks/s]
Processed prompts:  52%|█████▏    | 134/256 [00:07<00:09, 13.31it/s, est. speed input: 17228.22 toks/s, output: 16.82 toks/s]
Processed prompts:  53%|█████▎    | 136/256 [00:08<00:09, 13.31it/s, est. speed input: 17161.74 toks/s, output: 16.76 toks/s]
Processed prompts:  54%|█████▍    | 138/256 [00:08<00:08, 13.32it/s, est. speed input: 17097.89 toks/s, output: 16.70 toks/s]
Processed prompts:  55%|█████▍    | 140/256 [00:08<00:08, 13.32it/s, est. speed input: 17036.50 toks/s, output: 16.64 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:08<00:08, 13.32it/s, est. speed input: 16977.11 toks/s, output: 16.58 toks/s]
Processed prompts:  56%|█████▋    | 144/256 [00:08<00:08, 13.31it/s, est. speed input: 16919.03 toks/s, output: 16.52 toks/s]
Processed prompts:  57%|█████▋    | 146/256 [00:08<00:08, 13.29it/s, est. speed input: 16861.73 toks/s, output: 16.47 toks/s]
Processed prompts:  58%|█████▊    | 148/256 [00:09<00:08, 13.29it/s, est. speed input: 16807.54 toks/s, output: 16.41 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:09<00:07, 13.31it/s, est. speed input: 16755.97 toks/s, output: 16.36 toks/s]
Processed prompts:  59%|█████▉    | 152/256 [00:09<00:07, 13.30it/s, est. speed input: 16705.36 toks/s, output: 16.31 toks/s]
Processed prompts:  60%|██████    | 154/256 [00:09<00:07, 13.29it/s, est. speed input: 16655.35 toks/s, output: 16.26 toks/s]
Processed prompts:  61%|██████    | 156/256 [00:09<00:07, 13.28it/s, est. speed input: 16607.21 toks/s, output: 16.22 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:09<00:07, 13.28it/s, est. speed input: 16560.69 toks/s, output: 16.17 toks/s]
Processed prompts:  62%|██████▎   | 160/256 [00:09<00:07, 13.26it/s, est. speed input: 16514.81 toks/s, output: 16.13 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:10<00:07, 13.26it/s, est. speed input: 16470.43 toks/s, output: 16.08 toks/s]
Processed prompts:  64%|██████▍   | 164/256 [00:10<00:06, 13.25it/s, est. speed input: 16427.16 toks/s, output: 16.04 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:10<00:06, 13.25it/s, est. speed input: 16385.92 toks/s, output: 16.00 toks/s]
Processed prompts:  66%|██████▌   | 168/256 [00:10<00:06, 13.26it/s, est. speed input: 16346.17 toks/s, output: 15.96 toks/s]
Processed prompts:  66%|██████▋   | 170/256 [00:10<00:06, 13.26it/s, est. speed input: 16306.72 toks/s, output: 15.92 toks/s]
Processed prompts:  67%|██████▋   | 172/256 [00:10<00:06, 13.26it/s, est. speed input: 16268.64 toks/s, output: 15.89 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:10<00:06, 13.27it/s, est. speed input: 16232.22 toks/s, output: 15.85 toks/s]
Processed prompts:  69%|██████▉   | 176/256 [00:11<00:06, 13.29it/s, est. speed input: 16197.38 toks/s, output: 15.82 toks/s]
Processed prompts:  70%|██████▉   | 178/256 [00:11<00:05, 13.29it/s, est. speed input: 16163.22 toks/s, output: 15.78 toks/s]
Processed prompts:  70%|███████   | 180/256 [00:11<00:05, 13.31it/s, est. speed input: 16130.24 toks/s, output: 15.75 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:11<00:05, 13.30it/s, est. speed input: 16097.56 toks/s, output: 15.72 toks/s]
Processed prompts:  72%|███████▏  | 184/256 [00:11<00:05, 13.32it/s, est. speed input: 16066.51 toks/s, output: 15.69 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:11<00:05, 13.30it/s, est. speed input: 16034.74 toks/s, output: 15.66 toks/s]
Processed prompts:  73%|███████▎  | 188/256 [00:12<00:05, 13.28it/s, est. speed input: 16003.69 toks/s, output: 15.63 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:12<00:04, 13.27it/s, est. speed input: 15973.70 toks/s, output: 15.60 toks/s]
Processed prompts:  75%|███████▌  | 192/256 [00:12<00:04, 13.28it/s, est. speed input: 15944.98 toks/s, output: 15.57 toks/s]
Processed prompts:  76%|███████▌  | 194/256 [00:12<00:04, 13.28it/s, est. speed input: 15916.41 toks/s, output: 15.54 toks/s]
Processed prompts:  77%|███████▋  | 196/256 [00:12<00:04, 13.26it/s, est. speed input: 15887.86 toks/s, output: 15.52 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:12<00:04, 13.25it/s, est. speed input: 15860.04 toks/s, output: 15.49 toks/s]
Processed prompts:  78%|███████▊  | 200/256 [00:12<00:04, 13.25it/s, est. speed input: 15833.41 toks/s, output: 15.46 toks/s]
Processed prompts:  79%|███████▉  | 202/256 [00:13<00:04, 13.24it/s, est. speed input: 15806.93 toks/s, output: 15.44 toks/s]
Processed prompts:  80%|███████▉  | 204/256 [00:13<00:03, 13.23it/s, est. speed input: 15780.82 toks/s, output: 15.41 toks/s]
Processed prompts:  80%|████████  | 206/256 [00:13<00:03, 13.23it/s, est. speed input: 15755.61 toks/s, output: 15.39 toks/s]
Processed prompts:  81%|████████▏ | 208/256 [00:13<00:03, 13.23it/s, est. speed input: 15731.04 toks/s, output: 15.36 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:13<00:03, 13.25it/s, est. speed input: 15707.58 toks/s, output: 15.34 toks/s]
Processed prompts:  83%|████████▎ | 212/256 [00:13<00:03, 13.25it/s, est. speed input: 15684.30 toks/s, output: 15.32 toks/s]
Processed prompts:  84%|████████▎ | 214/256 [00:13<00:03, 13.23it/s, est. speed input: 15660.83 toks/s, output: 15.29 toks/s]
Processed prompts:  84%|████████▍ | 216/256 [00:14<00:03, 13.23it/s, est. speed input: 15638.37 toks/s, output: 15.27 toks/s]
Processed prompts:  85%|████████▌ | 218/256 [00:14<00:02, 13.25it/s, est. speed input: 15616.96 toks/s, output: 15.25 toks/s]
Processed prompts:  86%|████████▌ | 220/256 [00:14<00:02, 13.26it/s, est. speed input: 15595.77 toks/s, output: 15.23 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:14<00:02, 13.24it/s, est. speed input: 15574.32 toks/s, output: 15.21 toks/s]
Processed prompts:  88%|████████▊ | 224/256 [00:14<00:02, 13.25it/s, est. speed input: 15554.14 toks/s, output: 15.19 toks/s]
Processed prompts:  88%|████████▊ | 226/256 [00:14<00:02, 13.25it/s, est. speed input: 15533.97 toks/s, output: 15.17 toks/s]
Processed prompts:  89%|████████▉ | 228/256 [00:15<00:02, 13.25it/s, est. speed input: 15514.30 toks/s, output: 15.15 toks/s]
Processed prompts:  90%|████████▉ | 230/256 [00:15<00:01, 13.26it/s, est. speed input: 15495.20 toks/s, output: 15.13 toks/s]
Processed prompts:  91%|█████████ | 232/256 [00:15<00:01, 13.27it/s, est. speed input: 15476.71 toks/s, output: 15.11 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:15<00:01, 13.26it/s, est. speed input: 15458.17 toks/s, output: 15.10 toks/s]
Processed prompts:  92%|█████████▏| 236/256 [00:15<00:01, 13.23it/s, est. speed input: 15438.95 toks/s, output: 15.08 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:15<00:01, 13.22it/s, est. speed input: 15420.54 toks/s, output: 15.06 toks/s]
Processed prompts:  94%|█████████▍| 240/256 [00:15<00:01, 13.21it/s, est. speed input: 15402.34 toks/s, output: 15.04 toks/s]
Processed prompts:  95%|█████████▍| 242/256 [00:16<00:01, 13.21it/s, est. speed input: 15384.79 toks/s, output: 15.02 toks/s]
Processed prompts:  95%|█████████▌| 244/256 [00:16<00:00, 13.22it/s, est. speed input: 15367.90 toks/s, output: 15.01 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:16<00:00, 13.23it/s, est. speed input: 15351.09 toks/s, output: 14.99 toks/s]
Processed prompts:  97%|█████████▋| 248/256 [00:16<00:00, 13.22it/s, est. speed input: 15334.41 toks/s, output: 14.97 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:16<00:00, 13.21it/s, est. speed input: 15317.75 toks/s, output: 14.96 toks/s]
Processed prompts:  98%|█████████▊| 252/256 [00:16<00:00, 13.21it/s, est. speed input: 15301.85 toks/s, output: 14.94 toks/s]
Processed prompts:  99%|█████████▉| 254/256 [00:17<00:00, 13.22it/s, est. speed input: 15286.14 toks/s, output: 14.93 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:17<00:00, 14.66it/s, est. speed input: 15314.97 toks/s, output: 14.96 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:17<00:00, 14.66it/s, est. speed input: 15314.97 toks/s, output: 14.96 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:17<00:00, 14.96it/s, est. speed input: 15314.97 toks/s, output: 14.96 toks/s]
[rank0]:[W126 05:54:34.597204591 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 82.2s

测试结果:
  Requests/s:   13.09
  Tokens/s:     13419.97
  Total Reqs:   256
  Elapsed:      19.55s

  [Prefill 分析]
  Total Prefill Tokens: 262144
  Prefill Tokens/s:     13406.87

============================================================
[4/8] 测试 M=4096
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-14B-INT8                                │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 4096
│   M_prefill     = 4096 (= 4 x 1024)
│   M_decode      = 4
│   batched_tokens = 4096 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 512
│   --max-num-seqs           = 4
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 4096
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 05:54:47 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 05:54:48 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=257523) WARNING 01-26 05:54:56 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=257523) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=257523) WARNING 01-26 05:55:17 [backends.py:609] Failed to read file <frozen os>
Throughput: 13.25 requests/s, 13585.49 total tokens/s, 13.25 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512


─── STDERR ───
[2026-01-26 05:54:49] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:54:47] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:54:47] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:54:47] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:54:47] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:54:47] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:54:47] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:54:47] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:54:47] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:54:47] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:54:47] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:54:47] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:54:47] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:54:47] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 05:54:55] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:54:55] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:54:55] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:54:55] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:54:55] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:54:55] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:54:55] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:54:55] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:54:55] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:54:55] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:54:55] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:54:55] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:54:55] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:54:55] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=257523) [2026-01-26 05:54:57] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=257523) [2026-01-26 05:54:57] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=257523) [2026-01-26 05:54:57] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=257523) [2026-01-26 05:54:57] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=257523) [2026-01-26 05:54:57] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=257523) [2026-01-26 05:54:57] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=257523) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=257523) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:01<00:03,  1.26s/it]
(EngineCore_DP0 pid=257523) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:02<00:02,  1.28s/it]
(EngineCore_DP0 pid=257523) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.13it/s]
(EngineCore_DP0 pid=257523) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.03s/it]
(EngineCore_DP0 pid=257523) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.05s/it]
(EngineCore_DP0 pid=257523) 
(EngineCore_DP0 pid=257523) [2026-01-26 05:55:02] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 6848] -> 1D uint8
(EngineCore_DP0 pid=257523) [2026-01-26 05:55:02] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 36929536 bytes
(EngineCore_DP0 pid=257523) [2026-01-26 05:55:02] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 6848] -> 1D uint8
(EngineCore_DP0 pid=257523) [2026-01-26 05:55:02] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 26378240 bytes
(EngineCore_DP0 pid=257523) [2026-01-26 05:55:02] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 6848] -> 1D uint8
(EngineCore_DP0 pid=257523) [2026-01-26 05:55:02] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 142442496 bytes
(EngineCore_DP0 pid=257523) [2026-01-26 05:55:02] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 18432] -> 1D uint8
(EngineCore_DP0 pid=257523) [2026-01-26 05:55:02] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 70778880 bytes
(EngineCore_DP0 pid=257523) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  25%|██▌       | 1/4 [00:00<00:01,  2.75it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 2/4 [00:00<00:00,  3.82it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  75%|███████▌  | 3/4 [00:00<00:00,  4.39it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  4.43it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00,  4.15it/s]
(EngineCore_DP0 pid=257523) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  33%|███▎      | 1/3 [00:00<00:00,  4.63it/s]
Capturing CUDA graphs (decode, FULL):  67%|██████▋   | 2/3 [00:00<00:00,  5.01it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  5.22it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  5.11it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   5%|▍         | 24/512 [00:00<00:02, 235.35it/s]
Adding requests:  10%|▉         | 50/512 [00:00<00:01, 244.44it/s]
Adding requests:  15%|█▌        | 78/512 [00:00<00:01, 255.82it/s]
Adding requests:  20%|██        | 104/512 [00:00<00:01, 252.40it/s]
Adding requests:  25%|██▌       | 130/512 [00:00<00:01, 250.81it/s]
Adding requests:  31%|███       | 157/512 [00:00<00:01, 254.82it/s]
Adding requests:  36%|███▌      | 185/512 [00:00<00:01, 260.40it/s]
Adding requests:  41%|████▏     | 212/512 [00:00<00:01, 259.72it/s]
Adding requests:  46%|████▋     | 238/512 [00:00<00:01, 258.64it/s]
Adding requests:  52%|█████▏    | 264/512 [00:01<00:00, 255.74it/s]
Adding requests:  57%|█████▋    | 291/512 [00:01<00:00, 259.42it/s]
Adding requests:  62%|██████▎   | 320/512 [00:01<00:00, 266.53it/s]
Adding requests:  68%|██████▊   | 347/512 [00:01<00:00, 267.03it/s]
Adding requests:  73%|███████▎  | 375/512 [00:01<00:00, 269.45it/s]
Adding requests:  79%|███████▉  | 404/512 [00:01<00:00, 273.26it/s]
Adding requests:  84%|████████▍ | 432/512 [00:01<00:00, 273.00it/s]
Adding requests:  90%|████████▉ | 460/512 [00:01<00:00, 269.88it/s]
Adding requests:  96%|█████████▌| 489/512 [00:01<00:00, 273.50it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 263.73it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   4%|▍         | 22/512 [00:00<00:03, 144.91it/s, est. speed input: 148412.17 toks/s, output: 144.92 toks/s]
Processed prompts:   7%|▋         | 37/512 [00:01<00:15, 30.40it/s, est. speed input: 36236.00 toks/s, output: 35.39 toks/s]   
Processed prompts:   9%|▊         | 44/512 [00:01<00:21, 21.82it/s, est. speed input: 27445.04 toks/s, output: 26.80 toks/s]
Processed prompts:  10%|▉         | 49/512 [00:01<00:22, 20.58it/s, est. speed input: 25872.64 toks/s, output: 25.27 toks/s]
Processed prompts:  10%|█         | 53/512 [00:02<00:24, 18.71it/s, est. speed input: 24257.11 toks/s, output: 23.69 toks/s]
Processed prompts:  11%|█         | 56/512 [00:02<00:27, 16.37it/s, est. speed input: 22620.99 toks/s, output: 22.09 toks/s]
Processed prompts:  12%|█▏        | 59/512 [00:02<00:31, 14.61it/s, est. speed input: 21327.52 toks/s, output: 20.83 toks/s]
Processed prompts:  12%|█▏        | 62/512 [00:03<00:33, 13.32it/s, est. speed input: 20280.81 toks/s, output: 19.81 toks/s]
Processed prompts:  13%|█▎        | 66/512 [00:03<00:33, 13.35it/s, est. speed input: 19712.93 toks/s, output: 19.25 toks/s]
Processed prompts:  14%|█▎        | 70/512 [00:03<00:33, 13.37it/s, est. speed input: 19235.83 toks/s, output: 18.78 toks/s]
Processed prompts:  14%|█▍        | 74/512 [00:04<00:32, 13.38it/s, est. speed input: 18828.78 toks/s, output: 18.39 toks/s]
Processed prompts:  15%|█▌        | 78/512 [00:04<00:32, 13.40it/s, est. speed input: 18478.85 toks/s, output: 18.05 toks/s]
Processed prompts:  16%|█▌        | 82/512 [00:04<00:32, 13.40it/s, est. speed input: 18172.94 toks/s, output: 17.75 toks/s]
Processed prompts:  17%|█▋        | 86/512 [00:04<00:31, 13.41it/s, est. speed input: 17904.68 toks/s, output: 17.48 toks/s]
Processed prompts:  18%|█▊        | 90/512 [00:05<00:31, 13.41it/s, est. speed input: 17666.57 toks/s, output: 17.25 toks/s]
Processed prompts:  18%|█▊        | 94/512 [00:05<00:31, 13.42it/s, est. speed input: 17455.07 toks/s, output: 17.05 toks/s]
Processed prompts:  19%|█▉        | 98/512 [00:05<00:30, 13.42it/s, est. speed input: 17264.39 toks/s, output: 16.86 toks/s]
Processed prompts:  20%|█▉        | 102/512 [00:06<00:30, 13.42it/s, est. speed input: 17092.94 toks/s, output: 16.69 toks/s]
Processed prompts:  21%|██        | 106/512 [00:06<00:30, 13.42it/s, est. speed input: 16936.66 toks/s, output: 16.54 toks/s]
Processed prompts:  21%|██▏       | 110/512 [00:06<00:29, 13.41it/s, est. speed input: 16793.69 toks/s, output: 16.40 toks/s]
Processed prompts:  22%|██▏       | 114/512 [00:07<00:29, 13.41it/s, est. speed input: 16663.81 toks/s, output: 16.27 toks/s]
Processed prompts:  23%|██▎       | 118/512 [00:07<00:29, 13.41it/s, est. speed input: 16543.77 toks/s, output: 16.16 toks/s]
Processed prompts:  24%|██▍       | 122/512 [00:07<00:29, 13.41it/s, est. speed input: 16433.35 toks/s, output: 16.05 toks/s]
Processed prompts:  25%|██▍       | 126/512 [00:07<00:28, 13.41it/s, est. speed input: 16330.85 toks/s, output: 15.95 toks/s]
Processed prompts:  25%|██▌       | 130/512 [00:08<00:28, 13.41it/s, est. speed input: 16236.44 toks/s, output: 15.86 toks/s]
Processed prompts:  26%|██▌       | 134/512 [00:08<00:28, 13.41it/s, est. speed input: 16148.70 toks/s, output: 15.77 toks/s]
Processed prompts:  27%|██▋       | 138/512 [00:08<00:27, 13.41it/s, est. speed input: 16066.46 toks/s, output: 15.69 toks/s]
Processed prompts:  28%|██▊       | 142/512 [00:09<00:27, 13.40it/s, est. speed input: 15989.33 toks/s, output: 15.61 toks/s]
Processed prompts:  32%|███▏      | 166/512 [00:09<00:11, 31.11it/s, est. speed input: 17951.11 toks/s, output: 17.53 toks/s]
Processed prompts:  33%|███▎      | 170/512 [00:09<00:13, 26.07it/s, est. speed input: 17821.86 toks/s, output: 17.40 toks/s]
Processed prompts:  34%|███▍      | 174/512 [00:10<00:15, 22.39it/s, est. speed input: 17699.18 toks/s, output: 17.28 toks/s]
Processed prompts:  35%|███▍      | 178/512 [00:10<00:16, 19.76it/s, est. speed input: 17584.63 toks/s, output: 17.17 toks/s]
Processed prompts:  36%|███▌      | 182/512 [00:10<00:18, 17.89it/s, est. speed input: 17476.45 toks/s, output: 17.07 toks/s]
Processed prompts:  36%|███▋      | 186/512 [00:10<00:19, 16.55it/s, est. speed input: 17373.06 toks/s, output: 16.97 toks/s]
Processed prompts:  37%|███▋      | 190/512 [00:11<00:20, 15.60it/s, est. speed input: 17275.45 toks/s, output: 16.87 toks/s]
Processed prompts:  38%|███▊      | 194/512 [00:11<00:21, 14.93it/s, est. speed input: 17182.10 toks/s, output: 16.78 toks/s]
Processed prompts:  39%|███▊      | 198/512 [00:11<00:21, 14.46it/s, est. speed input: 17093.27 toks/s, output: 16.69 toks/s]
Processed prompts:  39%|███▉      | 202/512 [00:12<00:21, 14.12it/s, est. speed input: 17008.63 toks/s, output: 16.61 toks/s]
Processed prompts:  40%|████      | 206/512 [00:12<00:22, 13.90it/s, est. speed input: 16928.89 toks/s, output: 16.53 toks/s]
Processed prompts:  41%|████      | 210/512 [00:12<00:21, 13.74it/s, est. speed input: 16852.80 toks/s, output: 16.46 toks/s]
Processed prompts:  42%|████▏     | 214/512 [00:13<00:21, 13.62it/s, est. speed input: 16779.85 toks/s, output: 16.39 toks/s]
Processed prompts:  43%|████▎     | 218/512 [00:13<00:21, 13.54it/s, est. speed input: 16709.97 toks/s, output: 16.32 toks/s]
Processed prompts:  43%|████▎     | 222/512 [00:13<00:21, 13.48it/s, est. speed input: 16643.04 toks/s, output: 16.25 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:13<00:21, 13.44it/s, est. speed input: 16579.03 toks/s, output: 16.19 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:14<00:21, 13.41it/s, est. speed input: 16517.44 toks/s, output: 16.13 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:14<00:20, 13.38it/s, est. speed input: 16458.34 toks/s, output: 16.07 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:14<00:20, 13.37it/s, est. speed input: 16401.51 toks/s, output: 16.02 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:15<00:20, 13.35it/s, est. speed input: 16346.51 toks/s, output: 15.96 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:15<00:19, 13.34it/s, est. speed input: 16294.28 toks/s, output: 15.91 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:15<00:19, 13.34it/s, est. speed input: 16243.95 toks/s, output: 15.86 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:16<00:19, 13.33it/s, est. speed input: 16195.06 toks/s, output: 15.82 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:16<00:19, 13.33it/s, est. speed input: 16148.36 toks/s, output: 15.77 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:16<00:18, 13.33it/s, est. speed input: 16103.14 toks/s, output: 15.73 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:16<00:18, 13.33it/s, est. speed input: 16059.54 toks/s, output: 15.68 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:17<00:18, 13.32it/s, est. speed input: 16017.16 toks/s, output: 15.64 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:17<00:17, 13.31it/s, est. speed input: 15976.08 toks/s, output: 15.60 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:17<00:17, 13.31it/s, est. speed input: 15936.29 toks/s, output: 15.56 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:18<00:17, 13.30it/s, est. speed input: 15897.62 toks/s, output: 15.53 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:18<00:17, 13.29it/s, est. speed input: 15860.02 toks/s, output: 15.49 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:18<00:16, 13.29it/s, est. speed input: 15823.60 toks/s, output: 15.45 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:19<00:16, 13.29it/s, est. speed input: 15788.49 toks/s, output: 15.42 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:19<00:16, 13.29it/s, est. speed input: 15754.51 toks/s, output: 15.39 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:19<00:15, 13.28it/s, est. speed input: 15721.47 toks/s, output: 15.35 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:19<00:15, 13.28it/s, est. speed input: 15689.41 toks/s, output: 15.32 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:20<00:15, 13.28it/s, est. speed input: 15658.34 toks/s, output: 15.29 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:20<00:14, 13.28it/s, est. speed input: 15628.18 toks/s, output: 15.26 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:20<00:14, 13.28it/s, est. speed input: 15598.68 toks/s, output: 15.23 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:21<00:14, 13.28it/s, est. speed input: 15570.12 toks/s, output: 15.21 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:21<00:14, 13.27it/s, est. speed input: 15542.24 toks/s, output: 15.18 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:21<00:13, 13.28it/s, est. speed input: 15515.46 toks/s, output: 15.15 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:22<00:13, 13.27it/s, est. speed input: 15489.04 toks/s, output: 15.13 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:22<00:13, 13.28it/s, est. speed input: 15463.69 toks/s, output: 15.10 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:22<00:12, 13.28it/s, est. speed input: 15438.99 toks/s, output: 15.08 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:22<00:12, 13.28it/s, est. speed input: 15414.86 toks/s, output: 15.05 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:23<00:12, 13.28it/s, est. speed input: 15391.22 toks/s, output: 15.03 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:23<00:11, 13.28it/s, est. speed input: 15368.32 toks/s, output: 15.01 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:23<00:11, 13.28it/s, est. speed input: 15346.04 toks/s, output: 14.99 toks/s]
Processed prompts:  71%|███████   | 362/512 [00:24<00:11, 13.28it/s, est. speed input: 15324.12 toks/s, output: 14.96 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:24<00:11, 13.27it/s, est. speed input: 15302.68 toks/s, output: 14.94 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [00:24<00:10, 13.27it/s, est. speed input: 15281.89 toks/s, output: 14.92 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [00:25<00:10, 13.27it/s, est. speed input: 15261.65 toks/s, output: 14.90 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [00:25<00:10, 13.27it/s, est. speed input: 15241.84 toks/s, output: 14.88 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [00:25<00:09, 13.28it/s, est. speed input: 15222.55 toks/s, output: 14.87 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [00:25<00:09, 13.28it/s, est. speed input: 15203.82 toks/s, output: 14.85 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [00:26<00:09, 13.27it/s, est. speed input: 15185.26 toks/s, output: 14.83 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [00:26<00:08, 13.27it/s, est. speed input: 15167.22 toks/s, output: 14.81 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [00:26<00:08, 13.28it/s, est. speed input: 15149.71 toks/s, output: 14.79 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [00:27<00:08, 13.28it/s, est. speed input: 15132.41 toks/s, output: 14.78 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [00:27<00:07, 13.27it/s, est. speed input: 15115.51 toks/s, output: 14.76 toks/s]
Processed prompts:  80%|████████  | 410/512 [00:27<00:07, 13.27it/s, est. speed input: 15098.67 toks/s, output: 14.74 toks/s]
Processed prompts:  81%|████████  | 414/512 [00:28<00:07, 13.27it/s, est. speed input: 15082.52 toks/s, output: 14.73 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [00:28<00:07, 13.27it/s, est. speed input: 15066.53 toks/s, output: 14.71 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [00:28<00:06, 13.27it/s, est. speed input: 15051.03 toks/s, output: 14.70 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [00:29<00:06, 13.27it/s, est. speed input: 15035.84 toks/s, output: 14.68 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [00:29<00:06, 13.27it/s, est. speed input: 15021.07 toks/s, output: 14.67 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [00:29<00:05, 13.27it/s, est. speed input: 15006.37 toks/s, output: 14.65 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [00:29<00:05, 13.27it/s, est. speed input: 14992.05 toks/s, output: 14.64 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [00:30<00:05, 13.27it/s, est. speed input: 14977.96 toks/s, output: 14.63 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [00:30<00:04, 13.26it/s, est. speed input: 14964.07 toks/s, output: 14.61 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [00:30<00:04, 13.26it/s, est. speed input: 14950.60 toks/s, output: 14.60 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [00:31<00:04, 13.27it/s, est. speed input: 14937.55 toks/s, output: 14.59 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [00:31<00:04, 13.27it/s, est. speed input: 14924.51 toks/s, output: 14.57 toks/s]
Processed prompts:  90%|█████████ | 462/512 [00:31<00:03, 13.27it/s, est. speed input: 14911.80 toks/s, output: 14.56 toks/s]
Processed prompts:  91%|█████████ | 466/512 [00:32<00:03, 13.27it/s, est. speed input: 14899.50 toks/s, output: 14.55 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [00:32<00:03, 13.27it/s, est. speed input: 14887.31 toks/s, output: 14.54 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [00:32<00:02, 13.28it/s, est. speed input: 14875.44 toks/s, output: 14.53 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [00:32<00:02, 13.27it/s, est. speed input: 14863.58 toks/s, output: 14.52 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [00:33<00:02, 13.27it/s, est. speed input: 14851.98 toks/s, output: 14.50 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [00:33<00:01, 13.27it/s, est. speed input: 14840.68 toks/s, output: 14.49 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [00:33<00:01, 13.27it/s, est. speed input: 14829.53 toks/s, output: 14.48 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [00:34<00:01, 13.27it/s, est. speed input: 14818.69 toks/s, output: 14.47 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [00:34<00:01, 13.28it/s, est. speed input: 14808.01 toks/s, output: 14.46 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [00:34<00:00, 13.27it/s, est. speed input: 14797.39 toks/s, output: 14.45 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [00:35<00:00, 13.28it/s, est. speed input: 14787.31 toks/s, output: 14.44 toks/s]
Processed prompts: 100%|█████████▉| 510/512 [00:35<00:00, 14.31it/s, est. speed input: 14807.47 toks/s, output: 14.46 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:35<00:00, 14.31it/s, est. speed input: 14865.45 toks/s, output: 14.52 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:35<00:00, 14.52it/s, est. speed input: 14865.45 toks/s, output: 14.52 toks/s]
[rank0]:[W126 05:56:17.734636378 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 102.9s

测试结果:
  Requests/s:   13.25
  Tokens/s:     13585.49
  Total Reqs:   512
  Elapsed:      38.63s

  [Prefill 分析]
  Total Prefill Tokens: 524288
  Prefill Tokens/s:     13572.24

============================================================
[5/8] 测试 M=8192
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-14B-INT8                                │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 8192
│   M_prefill     = 8192 (= 8 x 1024)
│   M_decode      = 8
│   batched_tokens = 8192 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 1024
│   --max-num-seqs           = 8
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 8192
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 05:56:34 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 05:56:35 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=259222) WARNING 01-26 05:56:43 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=259222) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=259222) WARNING 01-26 05:57:02 [backends.py:609] Failed to read file <frozen os>
Throughput: 13.02 requests/s, 13341.75 total tokens/s, 13.02 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024


─── STDERR ───
[2026-01-26 05:56:34] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:56:34] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:56:34] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:56:34] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:56:34] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:56:34] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:56:34] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:56:34] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:56:34] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:56:34] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:56:34] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:56:34] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:56:34] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:56:34] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 05:56:42] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:56:42] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:56:42] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:56:42] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:56:42] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:56:42] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:56:42] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:56:42] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:56:42] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:56:42] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:56:42] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:56:42] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:56:42] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:56:42] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=259222) [2026-01-26 05:56:44] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=259222) [2026-01-26 05:56:44] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=259222) [2026-01-26 05:56:44] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=259222) [2026-01-26 05:56:44] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=259222) [2026-01-26 05:56:44] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=259222) [2026-01-26 05:56:44] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=259222) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=259222) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:01<00:03,  1.29s/it]
(EngineCore_DP0 pid=259222) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:02<00:02,  1.26s/it]
(EngineCore_DP0 pid=259222) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.16it/s]
(EngineCore_DP0 pid=259222) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.00it/s]
(EngineCore_DP0 pid=259222) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.03s/it]
(EngineCore_DP0 pid=259222) 
(EngineCore_DP0 pid=259222) [2026-01-26 05:56:49] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 6848] -> 1D uint8
(EngineCore_DP0 pid=259222) [2026-01-26 05:56:49] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 36929536 bytes
(EngineCore_DP0 pid=259222) [2026-01-26 05:56:49] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 6848] -> 1D uint8
(EngineCore_DP0 pid=259222) [2026-01-26 05:56:49] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 26378240 bytes
(EngineCore_DP0 pid=259222) [2026-01-26 05:56:49] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 6848] -> 1D uint8
(EngineCore_DP0 pid=259222) [2026-01-26 05:56:49] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 142442496 bytes
(EngineCore_DP0 pid=259222) [2026-01-26 05:56:49] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 18432] -> 1D uint8
(EngineCore_DP0 pid=259222) [2026-01-26 05:56:49] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 70778880 bytes
(EngineCore_DP0 pid=259222) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:01,  2.74it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  40%|████      | 2/5 [00:00<00:00,  3.81it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  60%|██████    | 3/5 [00:00<00:00,  4.40it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  80%|████████  | 4/5 [00:00<00:00,  4.74it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:01<00:00,  4.71it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:01<00:00,  4.38it/s]
(EngineCore_DP0 pid=259222) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:00,  4.65it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 2/4 [00:00<00:00,  5.10it/s]
Capturing CUDA graphs (decode, FULL):  75%|███████▌  | 3/4 [00:00<00:00,  5.24it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  5.31it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  5.21it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 23/1024 [00:00<00:04, 227.30it/s]
Adding requests:   5%|▍         | 48/1024 [00:00<00:04, 239.99it/s]
Adding requests:   7%|▋         | 74/1024 [00:00<00:03, 245.17it/s]
Adding requests:  10%|▉         | 99/1024 [00:00<00:03, 239.35it/s]
Adding requests:  12%|█▏        | 123/1024 [00:00<00:03, 231.88it/s]
Adding requests:  15%|█▍        | 149/1024 [00:00<00:03, 238.32it/s]
Adding requests:  17%|█▋        | 176/1024 [00:00<00:03, 247.19it/s]
Adding requests:  20%|█▉        | 203/1024 [00:00<00:03, 253.77it/s]
Adding requests:  23%|██▎       | 231/1024 [00:00<00:03, 260.94it/s]
Adding requests:  25%|██▌       | 258/1024 [00:01<00:02, 257.99it/s]
Adding requests:  28%|██▊       | 285/1024 [00:01<00:02, 260.87it/s]
Adding requests:  30%|███       | 312/1024 [00:01<00:02, 262.76it/s]
Adding requests:  33%|███▎      | 339/1024 [00:01<00:02, 261.99it/s]
Adding requests:  36%|███▌      | 366/1024 [00:01<00:02, 262.08it/s]
Adding requests:  38%|███▊      | 393/1024 [00:01<00:02, 263.80it/s]
Adding requests:  41%|████      | 422/1024 [00:01<00:02, 269.18it/s]
Adding requests:  44%|████▍     | 449/1024 [00:01<00:02, 261.78it/s]
Adding requests:  47%|████▋     | 478/1024 [00:01<00:02, 267.88it/s]
Adding requests:  49%|████▉     | 506/1024 [00:01<00:01, 270.87it/s]
Adding requests:  52%|█████▏    | 534/1024 [00:02<00:01, 271.46it/s]
Adding requests:  55%|█████▍    | 562/1024 [00:02<00:01, 270.44it/s]
Adding requests:  58%|█████▊    | 590/1024 [00:02<00:01, 260.27it/s]
Adding requests:  60%|██████    | 617/1024 [00:02<00:01, 258.56it/s]
Adding requests:  63%|██████▎   | 643/1024 [00:02<00:01, 255.30it/s]
Adding requests:  65%|██████▌   | 669/1024 [00:02<00:01, 253.40it/s]
Adding requests:  68%|██████▊   | 697/1024 [00:02<00:01, 259.86it/s]
Adding requests:  71%|███████   | 724/1024 [00:02<00:01, 260.36it/s]
Adding requests:  73%|███████▎  | 751/1024 [00:02<00:01, 257.00it/s]
Adding requests:  76%|███████▌  | 778/1024 [00:03<00:00, 260.48it/s]
Adding requests:  79%|███████▊  | 805/1024 [00:03<00:00, 260.93it/s]
Adding requests:  81%|████████▏ | 833/1024 [00:03<00:00, 265.10it/s]
Adding requests:  84%|████████▍ | 860/1024 [00:03<00:00, 265.59it/s]
Adding requests:  87%|████████▋ | 888/1024 [00:03<00:00, 268.78it/s]
Adding requests:  89%|████████▉ | 915/1024 [00:03<00:00, 263.29it/s]
Adding requests:  92%|█████████▏| 942/1024 [00:03<00:00, 257.70it/s]
Adding requests:  95%|█████████▍| 969/1024 [00:03<00:00, 259.24it/s]
Adding requests:  97%|█████████▋| 995/1024 [00:03<00:00, 255.75it/s]
Adding requests: 100%|█████████▉| 1022/1024 [00:03<00:00, 257.60it/s]
Adding requests: 100%|██████████| 1024/1024 [00:03<00:00, 258.58it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   4%|▍         | 42/1024 [00:00<00:04, 235.98it/s, est. speed input: 241688.26 toks/s, output: 236.00 toks/s]
Processed prompts:   6%|▋         | 66/1024 [00:01<00:34, 27.44it/s, est. speed input: 33804.40 toks/s, output: 33.01 toks/s]   
Processed prompts:   8%|▊         | 77/1024 [00:02<00:38, 24.60it/s, est. speed input: 30283.35 toks/s, output: 29.57 toks/s]
Processed prompts:   8%|▊         | 84/1024 [00:03<00:45, 20.63it/s, est. speed input: 26815.43 toks/s, output: 26.19 toks/s]
Processed prompts:   9%|▉         | 90/1024 [00:03<00:53, 17.38it/s, est. speed input: 24172.63 toks/s, output: 23.61 toks/s]
Processed prompts:  10%|▉         | 98/1024 [00:04<00:57, 16.13it/s, est. speed input: 22720.31 toks/s, output: 22.19 toks/s]
Processed prompts:  10%|█         | 106/1024 [00:05<01:00, 15.25it/s, est. speed input: 21613.89 toks/s, output: 21.11 toks/s]
Processed prompts:  11%|█         | 114/1024 [00:05<01:02, 14.64it/s, est. speed input: 20745.39 toks/s, output: 20.26 toks/s]
Processed prompts:  12%|█▏        | 122/1024 [00:06<01:03, 14.21it/s, est. speed input: 20045.03 toks/s, output: 19.58 toks/s]
Processed prompts:  13%|█▎        | 130/1024 [00:06<01:04, 13.91it/s, est. speed input: 19468.94 toks/s, output: 19.01 toks/s]
Processed prompts:  13%|█▎        | 138/1024 [00:07<01:06, 13.34it/s, est. speed input: 18846.53 toks/s, output: 18.40 toks/s]
Processed prompts:  14%|█▍        | 146/1024 [00:08<01:06, 13.30it/s, est. speed input: 18448.62 toks/s, output: 18.02 toks/s]
Processed prompts:  15%|█▌        | 154/1024 [00:08<01:05, 13.27it/s, est. speed input: 18105.83 toks/s, output: 17.68 toks/s]
Processed prompts:  16%|█▌        | 162/1024 [00:09<01:05, 13.25it/s, est. speed input: 17806.15 toks/s, output: 17.39 toks/s]
Processed prompts:  17%|█▋        | 170/1024 [00:09<01:04, 13.23it/s, est. speed input: 17543.14 toks/s, output: 17.13 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [00:10<01:04, 13.21it/s, est. speed input: 17309.53 toks/s, output: 16.90 toks/s]
Processed prompts:  18%|█▊        | 186/1024 [00:11<01:03, 13.20it/s, est. speed input: 17100.98 toks/s, output: 16.70 toks/s]
Processed prompts:  19%|█▉        | 194/1024 [00:11<01:02, 13.19it/s, est. speed input: 16913.81 toks/s, output: 16.52 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [00:12<01:02, 13.10it/s, est. speed input: 16728.54 toks/s, output: 16.34 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:12<01:02, 13.12it/s, est. speed input: 16575.20 toks/s, output: 16.19 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [00:13<01:01, 13.13it/s, est. speed input: 16436.02 toks/s, output: 16.05 toks/s]
Processed prompts:  22%|██▏       | 226/1024 [00:14<01:00, 13.13it/s, est. speed input: 16308.38 toks/s, output: 15.93 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:14<01:00, 13.14it/s, est. speed input: 16191.27 toks/s, output: 15.81 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:15<00:59, 13.13it/s, est. speed input: 16082.58 toks/s, output: 15.71 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:16<00:58, 13.13it/s, est. speed input: 15982.22 toks/s, output: 15.61 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:16<00:58, 13.13it/s, est. speed input: 15889.11 toks/s, output: 15.52 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:17<00:57, 13.13it/s, est. speed input: 15802.69 toks/s, output: 15.43 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:17<00:57, 13.06it/s, est. speed input: 15713.10 toks/s, output: 15.34 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:18<00:56, 13.08it/s, est. speed input: 15638.01 toks/s, output: 15.27 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:19<00:56, 13.09it/s, est. speed input: 15567.53 toks/s, output: 15.20 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:19<00:55, 13.10it/s, est. speed input: 15501.43 toks/s, output: 15.14 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:20<00:54, 13.11it/s, est. speed input: 15439.67 toks/s, output: 15.08 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:20<00:54, 13.11it/s, est. speed input: 15381.37 toks/s, output: 15.02 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:21<00:53, 13.12it/s, est. speed input: 15326.49 toks/s, output: 14.97 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:22<00:52, 13.12it/s, est. speed input: 15274.40 toks/s, output: 14.92 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:22<00:53, 12.73it/s, est. speed input: 15183.12 toks/s, output: 14.83 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:23<00:52, 12.84it/s, est. speed input: 15137.34 toks/s, output: 14.78 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:24<00:51, 12.92it/s, est. speed input: 15094.25 toks/s, output: 14.74 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:24<00:50, 12.98it/s, est. speed input: 15053.24 toks/s, output: 14.70 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:25<00:50, 13.03it/s, est. speed input: 15014.27 toks/s, output: 14.66 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:25<00:49, 13.05it/s, est. speed input: 14977.02 toks/s, output: 14.63 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:26<00:48, 13.08it/s, est. speed input: 14941.67 toks/s, output: 14.59 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:26<00:26, 23.03it/s, est. speed input: 15619.58 toks/s, output: 15.25 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:27<00:30, 19.86it/s, est. speed input: 15571.09 toks/s, output: 15.21 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:28<00:33, 17.74it/s, est. speed input: 15524.58 toks/s, output: 15.16 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:28<00:36, 16.31it/s, est. speed input: 15480.22 toks/s, output: 15.12 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:29<00:37, 15.33it/s, est. speed input: 15437.32 toks/s, output: 15.08 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:29<00:39, 14.66it/s, est. speed input: 15396.43 toks/s, output: 15.04 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:30<00:39, 14.19it/s, est. speed input: 15357.19 toks/s, output: 15.00 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:31<00:40, 13.86it/s, est. speed input: 15319.40 toks/s, output: 14.96 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:31<00:40, 13.64it/s, est. speed input: 15283.30 toks/s, output: 14.93 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:32<00:40, 13.40it/s, est. speed input: 15242.60 toks/s, output: 14.89 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:32<00:40, 13.32it/s, est. speed input: 15209.14 toks/s, output: 14.85 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:33<00:39, 13.25it/s, est. speed input: 15176.53 toks/s, output: 14.82 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:34<00:39, 13.21it/s, est. speed input: 15145.31 toks/s, output: 14.79 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:34<00:38, 13.18it/s, est. speed input: 15115.39 toks/s, output: 14.76 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:35<00:38, 13.16it/s, est. speed input: 15086.45 toks/s, output: 14.73 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:36<00:37, 13.15it/s, est. speed input: 15058.30 toks/s, output: 14.71 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:36<00:36, 13.14it/s, est. speed input: 15031.04 toks/s, output: 14.68 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:37<00:37, 12.72it/s, est. speed input: 14978.65 toks/s, output: 14.63 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:37<00:36, 12.84it/s, est. speed input: 14953.80 toks/s, output: 14.60 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:38<00:35, 12.92it/s, est. speed input: 14929.53 toks/s, output: 14.58 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:39<00:34, 12.97it/s, est. speed input: 14906.07 toks/s, output: 14.56 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:39<00:34, 13.01it/s, est. speed input: 14883.34 toks/s, output: 14.53 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:40<00:33, 13.04it/s, est. speed input: 14861.38 toks/s, output: 14.51 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:40<00:32, 13.07it/s, est. speed input: 14840.05 toks/s, output: 14.49 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:41<00:32, 13.08it/s, est. speed input: 14819.18 toks/s, output: 14.47 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:42<00:31, 13.09it/s, est. speed input: 14799.11 toks/s, output: 14.45 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:42<00:31, 13.02it/s, est. speed input: 14775.27 toks/s, output: 14.43 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:43<00:30, 13.04it/s, est. speed input: 14756.23 toks/s, output: 14.41 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:44<00:29, 13.07it/s, est. speed input: 14737.99 toks/s, output: 14.39 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:44<00:29, 13.08it/s, est. speed input: 14719.99 toks/s, output: 14.37 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:45<00:28, 13.09it/s, est. speed input: 14702.74 toks/s, output: 14.36 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:45<00:27, 13.10it/s, est. speed input: 14685.88 toks/s, output: 14.34 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:46<00:27, 13.11it/s, est. speed input: 14669.49 toks/s, output: 14.33 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:47<00:26, 13.11it/s, est. speed input: 14653.60 toks/s, output: 14.31 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:47<00:26, 13.06it/s, est. speed input: 14635.31 toks/s, output: 14.29 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:48<00:25, 13.07it/s, est. speed input: 14620.01 toks/s, output: 14.28 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:48<00:24, 13.09it/s, est. speed input: 14605.36 toks/s, output: 14.26 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:49<00:24, 13.10it/s, est. speed input: 14590.87 toks/s, output: 14.25 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:50<00:23, 13.11it/s, est. speed input: 14576.89 toks/s, output: 14.24 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:50<00:23, 13.11it/s, est. speed input: 14563.16 toks/s, output: 14.22 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:51<00:22, 13.11it/s, est. speed input: 14549.78 toks/s, output: 14.21 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:51<00:21, 13.12it/s, est. speed input: 14536.80 toks/s, output: 14.20 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:52<00:21, 13.12it/s, est. speed input: 14524.05 toks/s, output: 14.18 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:53<00:20, 13.04it/s, est. speed input: 14508.00 toks/s, output: 14.17 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:53<00:20, 13.06it/s, est. speed input: 14495.98 toks/s, output: 14.16 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:54<00:19, 13.08it/s, est. speed input: 14484.12 toks/s, output: 14.14 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:55<00:18, 13.09it/s, est. speed input: 14472.58 toks/s, output: 14.13 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:55<00:18, 13.10it/s, est. speed input: 14461.20 toks/s, output: 14.12 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:56<00:17, 13.11it/s, est. speed input: 14450.27 toks/s, output: 14.11 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:56<00:16, 13.11it/s, est. speed input: 14439.39 toks/s, output: 14.10 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:57<00:16, 13.12it/s, est. speed input: 14428.83 toks/s, output: 14.09 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:57<00:08, 23.07it/s, est. speed input: 14746.98 toks/s, output: 14.40 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [00:58<00:09, 19.89it/s, est. speed input: 14733.39 toks/s, output: 14.39 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [00:59<00:09, 17.76it/s, est. speed input: 14720.00 toks/s, output: 14.37 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:59<00:10, 16.33it/s, est. speed input: 14706.92 toks/s, output: 14.36 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [01:00<00:10, 15.35it/s, est. speed input: 14694.14 toks/s, output: 14.35 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [01:00<00:10, 14.67it/s, est. speed input: 14681.59 toks/s, output: 14.34 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [01:01<00:09, 14.20it/s, est. speed input: 14669.29 toks/s, output: 14.33 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [01:02<00:09, 13.86it/s, est. speed input: 14656.58 toks/s, output: 14.31 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [01:02<00:09, 13.63it/s, est. speed input: 14644.71 toks/s, output: 14.30 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [01:03<00:08, 13.48it/s, est. speed input: 14633.11 toks/s, output: 14.29 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [01:04<00:08, 13.37it/s, est. speed input: 14621.60 toks/s, output: 14.28 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [01:04<00:07, 13.29it/s, est. speed input: 14610.34 toks/s, output: 14.27 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [01:05<00:07, 13.24it/s, est. speed input: 14599.35 toks/s, output: 14.26 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [01:05<00:06, 13.20it/s, est. speed input: 14588.54 toks/s, output: 14.25 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [01:06<00:05, 13.18it/s, est. speed input: 14577.93 toks/s, output: 14.24 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [01:07<00:05, 13.16it/s, est. speed input: 14567.54 toks/s, output: 14.23 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [01:07<00:04, 13.07it/s, est. speed input: 14554.60 toks/s, output: 14.21 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [01:08<00:04, 13.08it/s, est. speed input: 14544.59 toks/s, output: 14.20 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [01:08<00:03, 13.09it/s, est. speed input: 14534.68 toks/s, output: 14.19 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [01:09<00:02, 13.10it/s, est. speed input: 14525.01 toks/s, output: 14.18 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [01:10<00:02, 13.10it/s, est. speed input: 14515.49 toks/s, output: 14.18 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [01:10<00:01, 13.10it/s, est. speed input: 14506.05 toks/s, output: 14.17 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [01:11<00:01, 13.11it/s, est. speed input: 14496.78 toks/s, output: 14.16 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [01:11<00:00, 13.61it/s, est. speed input: 14502.76 toks/s, output: 14.16 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [01:11<00:00, 13.61it/s, est. speed input: 14588.18 toks/s, output: 14.25 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [01:11<00:00, 14.25it/s, est. speed input: 14588.18 toks/s, output: 14.25 toks/s]
[rank0]:[W126 05:58:41.391264794 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 143.6s

测试结果:
  Requests/s:   13.02
  Tokens/s:     13341.75
  Total Reqs:   1024
  Elapsed:      78.67s

  [Prefill 分析]
  Total Prefill Tokens: 1048576
  Prefill Tokens/s:     13328.74

============================================================
[6/8] 测试 M=16384
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-14B-INT8                                │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 16384
│   M_prefill     = 16384 (= 16 x 1024)
│   M_decode      = 16
│   batched_tokens = 16384 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 2048
│   --max-num-seqs           = 16
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 16384
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 05:59:05 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 05:59:06 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=261598) WARNING 01-26 05:59:14 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=261598) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=261598) WARNING 01-26 05:59:34 [backends.py:609] Failed to read file <frozen os>
Throughput: 13.09 requests/s, 13415.49 total tokens/s, 13.09 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048


─── STDERR ───
[2026-01-26 05:59:05] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:59:05] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:59:05] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:59:05] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:59:05] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:59:05] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:59:05] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:59:05] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:59:05] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:59:05] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:59:05] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:59:05] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:59:05] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:59:05] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 05:59:13] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 05:59:13] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:59:13] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 05:59:13] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:59:13] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:59:13] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:59:13] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:59:13] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 05:59:13] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 05:59:13] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 05:59:13] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 05:59:13] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 05:59:13] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 05:59:13] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=261598) [2026-01-26 05:59:14] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=261598) [2026-01-26 05:59:14] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=261598) [2026-01-26 05:59:14] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=261598) [2026-01-26 05:59:14] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=261598) [2026-01-26 05:59:14] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=261598) [2026-01-26 05:59:14] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=261598) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=261598) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:01<00:03,  1.28s/it]
(EngineCore_DP0 pid=261598) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:02<00:02,  1.29s/it]
(EngineCore_DP0 pid=261598) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.13it/s]
(EngineCore_DP0 pid=261598) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.03s/it]
(EngineCore_DP0 pid=261598) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.06s/it]
(EngineCore_DP0 pid=261598) 
(EngineCore_DP0 pid=261598) [2026-01-26 05:59:20] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 6848] -> 1D uint8
(EngineCore_DP0 pid=261598) [2026-01-26 05:59:20] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 36929536 bytes
(EngineCore_DP0 pid=261598) [2026-01-26 05:59:20] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 6848] -> 1D uint8
(EngineCore_DP0 pid=261598) [2026-01-26 05:59:20] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 26378240 bytes
(EngineCore_DP0 pid=261598) [2026-01-26 05:59:20] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 6848] -> 1D uint8
(EngineCore_DP0 pid=261598) [2026-01-26 05:59:20] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 142442496 bytes
(EngineCore_DP0 pid=261598) [2026-01-26 05:59:20] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 18432] -> 1D uint8
(EngineCore_DP0 pid=261598) [2026-01-26 05:59:20] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 70778880 bytes
(EngineCore_DP0 pid=261598) [rank0]:W0126 05:59:47.381000 261598 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=261598) [rank0]:W0126 05:59:47.458000 261598 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=261598) [rank0]:W0126 05:59:48.561000 261598 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=261598) [rank0]:W0126 05:59:48.683000 261598 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=261598) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  14%|█▍        | 1/7 [00:00<00:02,  2.61it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  29%|██▊       | 2/7 [00:00<00:01,  3.61it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  43%|████▎     | 3/7 [00:00<00:00,  4.23it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  57%|█████▋    | 4/7 [00:00<00:00,  4.59it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  71%|███████▏  | 5/7 [00:01<00:00,  4.84it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  86%|████████▌ | 6/7 [00:01<00:00,  4.95it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:01<00:00,  4.80it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:01<00:00,  4.47it/s]
(EngineCore_DP0 pid=261598) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  20%|██        | 1/5 [00:00<00:00,  4.76it/s]
Capturing CUDA graphs (decode, FULL):  40%|████      | 2/5 [00:00<00:00,  5.18it/s]
Capturing CUDA graphs (decode, FULL):  60%|██████    | 3/5 [00:00<00:00,  5.27it/s]
Capturing CUDA graphs (decode, FULL):  80%|████████  | 4/5 [00:00<00:00,  5.30it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00,  5.34it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00,  5.27it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   1%|          | 23/2048 [00:00<00:08, 228.08it/s]
Adding requests:   2%|▏         | 48/2048 [00:00<00:08, 238.89it/s]
Adding requests:   4%|▎         | 73/2048 [00:00<00:08, 241.79it/s]
Adding requests:  22%|██▏       | 460/2048 [00:00<00:00, 1644.80it/s]
Adding requests:  30%|███       | 624/2048 [00:01<00:02, 573.71it/s] 
Adding requests:  36%|███▌      | 739/2048 [00:01<00:03, 435.13it/s]
Adding requests:  40%|████      | 824/2048 [00:01<00:03, 378.88it/s]
Adding requests:  43%|████▎     | 890/2048 [00:02<00:03, 350.54it/s]
Adding requests:  46%|████▌     | 943/2048 [00:02<00:03, 329.40it/s]
Adding requests:  48%|████▊     | 988/2048 [00:02<00:03, 314.11it/s]
Adding requests:  50%|█████     | 1027/2048 [00:02<00:03, 303.06it/s]
Adding requests:  52%|█████▏    | 1062/2048 [00:02<00:03, 293.65it/s]
Adding requests:  53%|█████▎    | 1095/2048 [00:02<00:03, 283.69it/s]
Adding requests:  55%|█████▍    | 1126/2048 [00:02<00:03, 279.60it/s]
Adding requests:  56%|█████▋    | 1155/2048 [00:03<00:03, 272.54it/s]
Adding requests:  58%|█████▊    | 1183/2048 [00:03<00:03, 271.67it/s]
Adding requests:  59%|█████▉    | 1211/2048 [00:03<00:03, 270.92it/s]
Adding requests:  60%|██████    | 1239/2048 [00:03<00:03, 268.11it/s]
Adding requests:  62%|██████▏   | 1266/2048 [00:03<00:02, 264.49it/s]
Adding requests:  63%|██████▎   | 1293/2048 [00:03<00:02, 260.38it/s]
Adding requests:  64%|██████▍   | 1320/2048 [00:03<00:02, 260.34it/s]
Adding requests:  66%|██████▌   | 1347/2048 [00:03<00:02, 259.78it/s]
Adding requests:  67%|██████▋   | 1373/2048 [00:03<00:02, 256.73it/s]
Adding requests:  68%|██████▊   | 1400/2048 [00:04<00:02, 258.99it/s]
Adding requests:  70%|██████▉   | 1427/2048 [00:04<00:02, 260.52it/s]
Adding requests:  71%|███████   | 1455/2048 [00:04<00:02, 264.65it/s]
Adding requests:  72%|███████▏  | 1483/2048 [00:04<00:02, 267.43it/s]
Adding requests:  74%|███████▍  | 1511/2048 [00:04<00:01, 270.41it/s]
Adding requests:  75%|███████▌  | 1539/2048 [00:04<00:01, 262.89it/s]
Adding requests:  76%|███████▋  | 1566/2048 [00:04<00:01, 261.19it/s]
Adding requests:  78%|███████▊  | 1593/2048 [00:04<00:01, 260.24it/s]
Adding requests:  79%|███████▉  | 1620/2048 [00:04<00:01, 258.39it/s]
Adding requests:  80%|████████  | 1646/2048 [00:04<00:01, 253.64it/s]
Adding requests:  82%|████████▏ | 1672/2048 [00:05<00:01, 252.93it/s]
Adding requests:  83%|████████▎ | 1699/2048 [00:05<00:01, 256.29it/s]
Adding requests:  84%|████████▍ | 1728/2048 [00:05<00:01, 263.11it/s]
Adding requests:  86%|████████▌ | 1756/2048 [00:05<00:01, 265.48it/s]
Adding requests:  87%|████████▋ | 1785/2048 [00:05<00:00, 270.39it/s]
Adding requests:  89%|████████▊ | 1813/2048 [00:05<00:00, 265.78it/s]
Adding requests:  90%|████████▉ | 1840/2048 [00:05<00:00, 264.66it/s]
Adding requests:  91%|█████████ | 1867/2048 [00:05<00:00, 261.81it/s]
Adding requests:  92%|█████████▏| 1894/2048 [00:05<00:00, 262.61it/s]
Adding requests:  94%|█████████▍| 1921/2048 [00:06<00:00, 263.69it/s]
Adding requests:  95%|█████████▌| 1948/2048 [00:06<00:00, 258.50it/s]
Adding requests:  96%|█████████▋| 1974/2048 [00:06<00:00, 256.99it/s]
Adding requests:  98%|█████████▊| 2000/2048 [00:06<00:00, 254.51it/s]
Adding requests:  99%|█████████▉| 2026/2048 [00:06<00:00, 248.63it/s]
Adding requests: 100%|██████████| 2048/2048 [00:06<00:00, 314.56it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▍         | 98/2048 [00:00<00:05, 329.28it/s, est. speed input: 337219.67 toks/s, output: 329.29 toks/s]
Processed prompts:   6%|▋         | 131/2048 [00:02<00:49, 38.79it/s, est. speed input: 49525.66 toks/s, output: 48.36 toks/s]  
Processed prompts:   7%|▋         | 146/2048 [00:03<01:07, 28.23it/s, est. speed input: 38086.21 toks/s, output: 37.19 toks/s]
Processed prompts:   8%|▊         | 155/2048 [00:04<01:14, 25.25it/s, est. speed input: 35006.09 toks/s, output: 34.19 toks/s]
Processed prompts:   8%|▊         | 162/2048 [00:05<01:25, 21.94it/s, est. speed input: 32255.20 toks/s, output: 31.50 toks/s]
Processed prompts:   8%|▊         | 170/2048 [00:05<01:35, 19.68it/s, est. speed input: 30260.45 toks/s, output: 29.55 toks/s]
Processed prompts:   9%|▊         | 178/2048 [00:06<01:44, 17.92it/s, est. speed input: 28647.79 toks/s, output: 27.98 toks/s]
Processed prompts:   9%|▉         | 186/2048 [00:06<01:52, 16.59it/s, est. speed input: 27317.67 toks/s, output: 26.68 toks/s]
Processed prompts:   9%|▉         | 194/2048 [00:07<01:58, 15.61it/s, est. speed input: 26200.38 toks/s, output: 25.59 toks/s]
Processed prompts:  10%|▉         | 202/2048 [00:08<02:04, 14.89it/s, est. speed input: 25248.28 toks/s, output: 24.66 toks/s]
Processed prompts:  10%|█         | 210/2048 [00:08<02:07, 14.37it/s, est. speed input: 24428.09 toks/s, output: 23.86 toks/s]
Processed prompts:  11%|█         | 218/2048 [00:09<02:10, 13.99it/s, est. speed input: 23713.60 toks/s, output: 23.16 toks/s]
Processed prompts:  11%|█         | 226/2048 [00:10<02:12, 13.73it/s, est. speed input: 23085.30 toks/s, output: 22.54 toks/s]
Processed prompts:  11%|█▏        | 234/2048 [00:10<02:14, 13.54it/s, est. speed input: 22528.56 toks/s, output: 22.00 toks/s]
Processed prompts:  12%|█▏        | 242/2048 [00:11<02:14, 13.41it/s, est. speed input: 22033.56 toks/s, output: 21.52 toks/s]
Processed prompts:  12%|█▏        | 250/2048 [00:11<02:15, 13.32it/s, est. speed input: 21590.02 toks/s, output: 21.08 toks/s]
Processed prompts:  13%|█▎        | 258/2048 [00:12<02:15, 13.26it/s, est. speed input: 21190.64 toks/s, output: 20.69 toks/s]
Processed prompts:  13%|█▎        | 266/2048 [00:13<02:14, 13.21it/s, est. speed input: 20827.63 toks/s, output: 20.34 toks/s]
Processed prompts:  13%|█▎        | 274/2048 [00:13<02:14, 13.18it/s, est. speed input: 20497.31 toks/s, output: 20.02 toks/s]
Processed prompts:  14%|█▍        | 282/2048 [00:14<02:14, 13.16it/s, est. speed input: 20194.87 toks/s, output: 19.72 toks/s]
Processed prompts:  14%|█▍        | 290/2048 [00:14<02:13, 13.14it/s, est. speed input: 19916.56 toks/s, output: 19.45 toks/s]
Processed prompts:  15%|█▍        | 298/2048 [00:15<02:13, 13.12it/s, est. speed input: 19660.33 toks/s, output: 19.20 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [00:16<02:12, 13.11it/s, est. speed input: 19423.43 toks/s, output: 18.97 toks/s]
Processed prompts:  15%|█▌        | 314/2048 [00:16<02:12, 13.11it/s, est. speed input: 19203.58 toks/s, output: 18.75 toks/s]
Processed prompts:  16%|█▌        | 322/2048 [00:17<02:11, 13.10it/s, est. speed input: 18999.17 toks/s, output: 18.55 toks/s]
Processed prompts:  16%|█▌        | 330/2048 [00:17<02:11, 13.10it/s, est. speed input: 18808.56 toks/s, output: 18.37 toks/s]
Processed prompts:  17%|█▋        | 338/2048 [00:18<02:10, 13.09it/s, est. speed input: 18630.25 toks/s, output: 18.19 toks/s]
Processed prompts:  17%|█▋        | 346/2048 [00:19<02:09, 13.10it/s, est. speed input: 18464.71 toks/s, output: 18.03 toks/s]
Processed prompts:  17%|█▋        | 354/2048 [00:19<02:09, 13.11it/s, est. speed input: 18310.21 toks/s, output: 17.88 toks/s]
Processed prompts:  18%|█▊        | 362/2048 [00:20<02:09, 13.07it/s, est. speed input: 18158.40 toks/s, output: 17.73 toks/s]
Processed prompts:  18%|█▊        | 370/2048 [00:21<02:08, 13.08it/s, est. speed input: 18021.48 toks/s, output: 17.60 toks/s]
Processed prompts:  18%|█▊        | 378/2048 [00:21<02:07, 13.09it/s, est. speed input: 17892.30 toks/s, output: 17.47 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [00:22<02:06, 13.10it/s, est. speed input: 17769.73 toks/s, output: 17.35 toks/s]
Processed prompts:  19%|█▉        | 394/2048 [00:22<02:06, 13.11it/s, est. speed input: 17654.02 toks/s, output: 17.24 toks/s]
Processed prompts:  20%|█▉        | 402/2048 [00:23<02:05, 13.11it/s, est. speed input: 17544.35 toks/s, output: 17.13 toks/s]
Processed prompts:  20%|██        | 410/2048 [00:24<02:04, 13.11it/s, est. speed input: 17440.08 toks/s, output: 17.03 toks/s]
Processed prompts:  20%|██        | 418/2048 [00:24<02:04, 13.11it/s, est. speed input: 17341.14 toks/s, output: 16.93 toks/s]
Processed prompts:  22%|██▏       | 442/2048 [00:25<01:08, 23.58it/s, est. speed input: 18054.74 toks/s, output: 17.63 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [00:25<01:19, 20.18it/s, est. speed input: 17945.02 toks/s, output: 17.52 toks/s]
Processed prompts:  22%|██▏       | 458/2048 [00:26<01:28, 17.94it/s, est. speed input: 17840.37 toks/s, output: 17.42 toks/s]
Processed prompts:  23%|██▎       | 466/2048 [00:26<01:36, 16.44it/s, est. speed input: 17740.28 toks/s, output: 17.32 toks/s]
Processed prompts:  23%|██▎       | 474/2048 [00:27<01:42, 15.41it/s, est. speed input: 17644.79 toks/s, output: 17.23 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [00:28<01:46, 14.71it/s, est. speed input: 17553.36 toks/s, output: 17.14 toks/s]
Processed prompts:  24%|██▍       | 490/2048 [00:28<01:49, 14.23it/s, est. speed input: 17465.91 toks/s, output: 17.06 toks/s]
Processed prompts:  24%|██▍       | 498/2048 [00:29<01:51, 13.89it/s, est. speed input: 17382.03 toks/s, output: 16.97 toks/s]
Processed prompts:  25%|██▍       | 506/2048 [00:29<01:52, 13.65it/s, est. speed input: 17301.34 toks/s, output: 16.90 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [00:30<01:53, 13.49it/s, est. speed input: 17224.19 toks/s, output: 16.82 toks/s]
Processed prompts:  25%|██▌       | 522/2048 [00:31<01:54, 13.38it/s, est. speed input: 17149.95 toks/s, output: 16.75 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [00:31<01:54, 13.30it/s, est. speed input: 17078.30 toks/s, output: 16.68 toks/s]
Processed prompts:  26%|██▋       | 538/2048 [00:32<01:54, 13.24it/s, est. speed input: 17009.71 toks/s, output: 16.61 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [00:32<01:53, 13.20it/s, est. speed input: 16943.26 toks/s, output: 16.55 toks/s]
Processed prompts:  27%|██▋       | 554/2048 [00:33<01:53, 13.18it/s, est. speed input: 16879.55 toks/s, output: 16.48 toks/s]
Processed prompts:  27%|██▋       | 562/2048 [00:34<01:52, 13.16it/s, est. speed input: 16818.28 toks/s, output: 16.42 toks/s]
Processed prompts:  28%|██▊       | 570/2048 [00:34<01:52, 13.15it/s, est. speed input: 16759.01 toks/s, output: 16.37 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [00:35<01:51, 13.14it/s, est. speed input: 16702.11 toks/s, output: 16.31 toks/s]
Processed prompts:  29%|██▊       | 586/2048 [00:36<01:51, 13.14it/s, est. speed input: 16646.89 toks/s, output: 16.26 toks/s]
Processed prompts:  29%|██▉       | 594/2048 [00:36<01:50, 13.13it/s, est. speed input: 16593.10 toks/s, output: 16.20 toks/s]
Processed prompts:  29%|██▉       | 602/2048 [00:37<01:50, 13.13it/s, est. speed input: 16541.45 toks/s, output: 16.15 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [00:37<01:49, 13.12it/s, est. speed input: 16491.50 toks/s, output: 16.10 toks/s]
Processed prompts:  30%|███       | 618/2048 [00:38<01:48, 13.12it/s, est. speed input: 16443.01 toks/s, output: 16.06 toks/s]
Processed prompts:  31%|███       | 626/2048 [00:39<01:48, 13.12it/s, est. speed input: 16396.16 toks/s, output: 16.01 toks/s]
Processed prompts:  31%|███       | 634/2048 [00:39<01:47, 13.12it/s, est. speed input: 16350.75 toks/s, output: 15.97 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [00:40<01:47, 13.12it/s, est. speed input: 16306.68 toks/s, output: 15.92 toks/s]
Processed prompts:  32%|███▏      | 650/2048 [00:40<01:46, 13.12it/s, est. speed input: 16263.82 toks/s, output: 15.88 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [00:41<01:45, 13.12it/s, est. speed input: 16222.32 toks/s, output: 15.84 toks/s]
Processed prompts:  33%|███▎      | 666/2048 [00:42<01:45, 13.12it/s, est. speed input: 16182.04 toks/s, output: 15.80 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [00:42<01:44, 13.12it/s, est. speed input: 16143.08 toks/s, output: 15.76 toks/s]
Processed prompts:  33%|███▎      | 682/2048 [00:43<01:44, 13.13it/s, est. speed input: 16105.35 toks/s, output: 15.73 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [00:43<01:43, 13.13it/s, est. speed input: 16068.60 toks/s, output: 15.69 toks/s]
Processed prompts:  34%|███▍      | 698/2048 [00:44<01:42, 13.13it/s, est. speed input: 16032.74 toks/s, output: 15.66 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [00:45<01:42, 13.13it/s, est. speed input: 15997.98 toks/s, output: 15.62 toks/s]
Processed prompts:  35%|███▍      | 714/2048 [00:45<01:41, 13.13it/s, est. speed input: 15964.16 toks/s, output: 15.59 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [00:46<01:40, 13.13it/s, est. speed input: 15931.15 toks/s, output: 15.56 toks/s]
Processed prompts:  36%|███▌      | 730/2048 [00:47<01:40, 13.13it/s, est. speed input: 15898.96 toks/s, output: 15.53 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [00:47<01:39, 13.13it/s, est. speed input: 15867.67 toks/s, output: 15.50 toks/s]
Processed prompts:  36%|███▋      | 746/2048 [00:48<01:39, 13.13it/s, est. speed input: 15837.14 toks/s, output: 15.47 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [00:48<01:38, 13.13it/s, est. speed input: 15807.22 toks/s, output: 15.44 toks/s]
Processed prompts:  37%|███▋      | 762/2048 [00:49<01:37, 13.13it/s, est. speed input: 15778.21 toks/s, output: 15.41 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [00:50<01:37, 13.14it/s, est. speed input: 15749.97 toks/s, output: 15.38 toks/s]
Processed prompts:  38%|███▊      | 778/2048 [00:50<01:36, 13.13it/s, est. speed input: 15722.29 toks/s, output: 15.35 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [00:51<01:36, 13.13it/s, est. speed input: 15695.10 toks/s, output: 15.33 toks/s]
Processed prompts:  39%|███▉      | 794/2048 [00:51<01:35, 13.13it/s, est. speed input: 15668.52 toks/s, output: 15.30 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [00:52<01:34, 13.12it/s, est. speed input: 15642.33 toks/s, output: 15.28 toks/s]
Processed prompts:  40%|███▉      | 810/2048 [00:53<01:34, 13.12it/s, est. speed input: 15616.97 toks/s, output: 15.25 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [00:53<01:33, 13.12it/s, est. speed input: 15592.11 toks/s, output: 15.23 toks/s]
Processed prompts:  40%|████      | 826/2048 [00:54<01:33, 13.12it/s, est. speed input: 15567.80 toks/s, output: 15.20 toks/s]
Processed prompts:  41%|████      | 834/2048 [00:54<01:32, 13.11it/s, est. speed input: 15544.03 toks/s, output: 15.18 toks/s]
Processed prompts:  41%|████      | 842/2048 [00:55<01:31, 13.11it/s, est. speed input: 15520.74 toks/s, output: 15.16 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [00:55<00:51, 23.06it/s, est. speed input: 15841.38 toks/s, output: 15.47 toks/s]
Processed prompts:  43%|████▎     | 874/2048 [00:56<00:59, 19.87it/s, est. speed input: 15815.24 toks/s, output: 15.44 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [00:57<01:05, 17.75it/s, est. speed input: 15789.72 toks/s, output: 15.42 toks/s]
Processed prompts:  43%|████▎     | 890/2048 [00:57<01:10, 16.31it/s, est. speed input: 15764.71 toks/s, output: 15.40 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [00:58<01:15, 15.33it/s, est. speed input: 15740.17 toks/s, output: 15.37 toks/s]
Processed prompts:  44%|████▍     | 906/2048 [00:59<01:17, 14.65it/s, est. speed input: 15716.08 toks/s, output: 15.35 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [00:59<01:20, 14.17it/s, est. speed input: 15692.33 toks/s, output: 15.32 toks/s]
Processed prompts:  45%|████▌     | 922/2048 [01:00<01:21, 13.84it/s, est. speed input: 15669.06 toks/s, output: 15.30 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [01:00<01:22, 13.62it/s, est. speed input: 15646.36 toks/s, output: 15.28 toks/s]
Processed prompts:  46%|████▌     | 938/2048 [01:01<01:22, 13.46it/s, est. speed input: 15624.03 toks/s, output: 15.26 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [01:02<01:22, 13.34it/s, est. speed input: 15602.08 toks/s, output: 15.24 toks/s]
Processed prompts:  47%|████▋     | 954/2048 [01:02<01:22, 13.27it/s, est. speed input: 15580.71 toks/s, output: 15.22 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [01:03<01:22, 13.21it/s, est. speed input: 15559.67 toks/s, output: 15.19 toks/s]
Processed prompts:  47%|████▋     | 970/2048 [01:03<01:21, 13.17it/s, est. speed input: 15538.96 toks/s, output: 15.17 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [01:04<01:21, 13.15it/s, est. speed input: 15518.67 toks/s, output: 15.15 toks/s]
Processed prompts:  48%|████▊     | 986/2048 [01:05<01:20, 13.13it/s, est. speed input: 15498.80 toks/s, output: 15.14 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [01:05<01:20, 13.12it/s, est. speed input: 15479.32 toks/s, output: 15.12 toks/s]
Processed prompts:  49%|████▉     | 1002/2048 [01:06<01:19, 13.11it/s, est. speed input: 15460.20 toks/s, output: 15.10 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [01:06<01:19, 13.10it/s, est. speed input: 15441.37 toks/s, output: 15.08 toks/s]
Processed prompts:  50%|████▉     | 1018/2048 [01:07<01:18, 13.10it/s, est. speed input: 15423.04 toks/s, output: 15.06 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [01:08<01:18, 13.10it/s, est. speed input: 15405.06 toks/s, output: 15.04 toks/s]
Processed prompts:  50%|█████     | 1034/2048 [01:08<01:17, 13.10it/s, est. speed input: 15387.47 toks/s, output: 15.03 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [01:09<01:16, 13.10it/s, est. speed input: 15370.07 toks/s, output: 15.01 toks/s]
Processed prompts:  51%|█████▏    | 1050/2048 [01:10<01:16, 13.10it/s, est. speed input: 15353.01 toks/s, output: 14.99 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [01:10<01:15, 13.10it/s, est. speed input: 15336.25 toks/s, output: 14.98 toks/s]
Processed prompts:  52%|█████▏    | 1066/2048 [01:11<01:14, 13.10it/s, est. speed input: 15319.81 toks/s, output: 14.96 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [01:11<01:14, 13.10it/s, est. speed input: 15303.72 toks/s, output: 14.95 toks/s]
Processed prompts:  53%|█████▎    | 1082/2048 [01:12<01:13, 13.10it/s, est. speed input: 15287.82 toks/s, output: 14.93 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [01:13<01:13, 13.10it/s, est. speed input: 15272.18 toks/s, output: 14.91 toks/s]
Processed prompts:  54%|█████▎    | 1098/2048 [01:13<01:12, 13.10it/s, est. speed input: 15256.78 toks/s, output: 14.90 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [01:14<01:11, 13.10it/s, est. speed input: 15241.64 toks/s, output: 14.88 toks/s]
Processed prompts:  54%|█████▍    | 1114/2048 [01:14<01:11, 13.10it/s, est. speed input: 15226.77 toks/s, output: 14.87 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [01:15<01:10, 13.10it/s, est. speed input: 15212.14 toks/s, output: 14.86 toks/s]
Processed prompts:  55%|█████▌    | 1130/2048 [01:16<01:10, 13.10it/s, est. speed input: 15197.66 toks/s, output: 14.84 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [01:16<01:09, 13.10it/s, est. speed input: 15183.47 toks/s, output: 14.83 toks/s]
Processed prompts:  56%|█████▌    | 1146/2048 [01:17<01:08, 13.10it/s, est. speed input: 15169.41 toks/s, output: 14.81 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [01:17<01:08, 13.10it/s, est. speed input: 15155.65 toks/s, output: 14.80 toks/s]
Processed prompts:  57%|█████▋    | 1162/2048 [01:18<01:07, 13.10it/s, est. speed input: 15142.06 toks/s, output: 14.79 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [01:19<01:07, 13.10it/s, est. speed input: 15128.71 toks/s, output: 14.77 toks/s]
Processed prompts:  58%|█████▊    | 1178/2048 [01:19<01:06, 13.09it/s, est. speed input: 15115.49 toks/s, output: 14.76 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [01:20<01:05, 13.09it/s, est. speed input: 15102.53 toks/s, output: 14.75 toks/s]
Processed prompts:  58%|█████▊    | 1194/2048 [01:21<01:05, 13.10it/s, est. speed input: 15089.78 toks/s, output: 14.74 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [01:21<01:04, 13.10it/s, est. speed input: 15077.26 toks/s, output: 14.72 toks/s]
Processed prompts:  59%|█████▉    | 1210/2048 [01:22<01:03, 13.10it/s, est. speed input: 15064.91 toks/s, output: 14.71 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [01:22<01:03, 13.10it/s, est. speed input: 15052.72 toks/s, output: 14.70 toks/s]
Processed prompts:  60%|█████▉    | 1226/2048 [01:23<01:02, 13.10it/s, est. speed input: 15040.70 toks/s, output: 14.69 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [01:24<01:02, 13.10it/s, est. speed input: 15028.87 toks/s, output: 14.68 toks/s]
Processed prompts:  61%|██████    | 1242/2048 [01:24<01:01, 13.10it/s, est. speed input: 15017.19 toks/s, output: 14.67 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [01:25<01:00, 13.10it/s, est. speed input: 15005.73 toks/s, output: 14.65 toks/s]
Processed prompts:  61%|██████▏   | 1258/2048 [01:25<01:00, 13.10it/s, est. speed input: 14994.42 toks/s, output: 14.64 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [01:26<00:59, 13.10it/s, est. speed input: 14983.23 toks/s, output: 14.63 toks/s]
Processed prompts:  63%|██████▎   | 1290/2048 [01:26<00:32, 23.34it/s, est. speed input: 15196.48 toks/s, output: 14.84 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [01:27<00:37, 20.03it/s, est. speed input: 15184.09 toks/s, output: 14.83 toks/s]
Processed prompts:  64%|██████▍   | 1306/2048 [01:28<00:41, 17.85it/s, est. speed input: 15171.87 toks/s, output: 14.82 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [01:28<00:44, 16.37it/s, est. speed input: 15159.74 toks/s, output: 14.80 toks/s]
Processed prompts:  65%|██████▍   | 1322/2048 [01:29<00:47, 15.37it/s, est. speed input: 15147.85 toks/s, output: 14.79 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [01:29<00:48, 14.67it/s, est. speed input: 15136.02 toks/s, output: 14.78 toks/s]
Processed prompts:  65%|██████▌   | 1338/2048 [01:30<00:50, 14.19it/s, est. speed input: 15124.43 toks/s, output: 14.77 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [01:31<00:50, 13.86it/s, est. speed input: 15113.01 toks/s, output: 14.76 toks/s]
Processed prompts:  66%|██████▌   | 1354/2048 [01:31<00:50, 13.63it/s, est. speed input: 15101.69 toks/s, output: 14.75 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [01:32<00:50, 13.47it/s, est. speed input: 15090.54 toks/s, output: 14.74 toks/s]
Processed prompts:  67%|██████▋   | 1370/2048 [01:33<00:50, 13.36it/s, est. speed input: 15079.48 toks/s, output: 14.73 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [01:33<00:50, 13.28it/s, est. speed input: 15068.62 toks/s, output: 14.72 toks/s]
Processed prompts:  68%|██████▊   | 1386/2048 [01:34<00:50, 13.22it/s, est. speed input: 15057.86 toks/s, output: 14.70 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [01:34<00:49, 13.19it/s, est. speed input: 15047.26 toks/s, output: 14.69 toks/s]
Processed prompts:  68%|██████▊   | 1402/2048 [01:35<00:49, 13.16it/s, est. speed input: 15036.81 toks/s, output: 14.68 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [01:36<00:48, 13.14it/s, est. speed input: 15026.43 toks/s, output: 14.67 toks/s]
Processed prompts:  69%|██████▉   | 1418/2048 [01:36<00:47, 13.13it/s, est. speed input: 15016.25 toks/s, output: 14.66 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [01:37<00:47, 13.12it/s, est. speed input: 15006.17 toks/s, output: 14.65 toks/s]
Processed prompts:  70%|███████   | 1434/2048 [01:37<00:46, 13.11it/s, est. speed input: 14996.25 toks/s, output: 14.64 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [01:38<00:46, 13.11it/s, est. speed input: 14986.44 toks/s, output: 14.64 toks/s]
Processed prompts:  71%|███████   | 1450/2048 [01:39<00:45, 13.11it/s, est. speed input: 14976.76 toks/s, output: 14.63 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [01:39<00:45, 13.10it/s, est. speed input: 14967.17 toks/s, output: 14.62 toks/s]
Processed prompts:  72%|███████▏  | 1466/2048 [01:40<00:44, 13.10it/s, est. speed input: 14957.71 toks/s, output: 14.61 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [01:40<00:43, 13.10it/s, est. speed input: 14948.41 toks/s, output: 14.60 toks/s]
Processed prompts:  72%|███████▏  | 1482/2048 [01:41<00:43, 13.10it/s, est. speed input: 14939.14 toks/s, output: 14.59 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [01:42<00:42, 13.10it/s, est. speed input: 14929.96 toks/s, output: 14.58 toks/s]
Processed prompts:  73%|███████▎  | 1498/2048 [01:42<00:41, 13.10it/s, est. speed input: 14920.95 toks/s, output: 14.57 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [01:43<00:41, 13.10it/s, est. speed input: 14912.03 toks/s, output: 14.56 toks/s]
Processed prompts:  74%|███████▍  | 1514/2048 [01:44<00:40, 13.10it/s, est. speed input: 14903.23 toks/s, output: 14.55 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [01:44<00:40, 13.10it/s, est. speed input: 14894.52 toks/s, output: 14.55 toks/s]
Processed prompts:  75%|███████▍  | 1530/2048 [01:45<00:39, 13.10it/s, est. speed input: 14885.86 toks/s, output: 14.54 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [01:45<00:38, 13.10it/s, est. speed input: 14877.36 toks/s, output: 14.53 toks/s]
Processed prompts:  75%|███████▌  | 1546/2048 [01:46<00:38, 13.10it/s, est. speed input: 14868.93 toks/s, output: 14.52 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [01:47<00:37, 13.10it/s, est. speed input: 14860.61 toks/s, output: 14.51 toks/s]
Processed prompts:  76%|███████▋  | 1562/2048 [01:47<00:37, 13.10it/s, est. speed input: 14852.39 toks/s, output: 14.50 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [01:48<00:36, 13.10it/s, est. speed input: 14844.31 toks/s, output: 14.50 toks/s]
Processed prompts:  77%|███████▋  | 1578/2048 [01:48<00:35, 13.10it/s, est. speed input: 14836.30 toks/s, output: 14.49 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [01:49<00:35, 13.10it/s, est. speed input: 14828.38 toks/s, output: 14.48 toks/s]
Processed prompts:  78%|███████▊  | 1594/2048 [01:50<00:34, 13.10it/s, est. speed input: 14820.57 toks/s, output: 14.47 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [01:50<00:34, 13.10it/s, est. speed input: 14812.81 toks/s, output: 14.47 toks/s]
Processed prompts:  79%|███████▊  | 1610/2048 [01:51<00:33, 13.10it/s, est. speed input: 14805.09 toks/s, output: 14.46 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [01:51<00:32, 13.10it/s, est. speed input: 14797.46 toks/s, output: 14.45 toks/s]
Processed prompts:  79%|███████▉  | 1626/2048 [01:52<00:32, 13.10it/s, est. speed input: 14789.97 toks/s, output: 14.44 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [01:53<00:31, 13.10it/s, est. speed input: 14782.47 toks/s, output: 14.44 toks/s]
Processed prompts:  80%|████████  | 1642/2048 [01:53<00:31, 13.10it/s, est. speed input: 14775.13 toks/s, output: 14.43 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [01:54<00:30, 13.09it/s, est. speed input: 14767.81 toks/s, output: 14.42 toks/s]
Processed prompts:  81%|████████  | 1658/2048 [01:55<00:29, 13.09it/s, est. speed input: 14760.59 toks/s, output: 14.41 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [01:55<00:29, 13.10it/s, est. speed input: 14753.46 toks/s, output: 14.41 toks/s]
Processed prompts:  82%|████████▏ | 1674/2048 [01:56<00:28, 13.10it/s, est. speed input: 14746.45 toks/s, output: 14.40 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [01:56<00:27, 13.10it/s, est. speed input: 14739.47 toks/s, output: 14.39 toks/s]
Processed prompts:  83%|████████▎ | 1690/2048 [01:57<00:27, 13.10it/s, est. speed input: 14732.56 toks/s, output: 14.39 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [01:58<00:26, 13.10it/s, est. speed input: 14725.74 toks/s, output: 14.38 toks/s]
Processed prompts:  84%|████████▍ | 1722/2048 [01:58<00:14, 23.26it/s, est. speed input: 14882.31 toks/s, output: 14.53 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [01:59<00:15, 19.99it/s, est. speed input: 14874.78 toks/s, output: 14.53 toks/s]
Processed prompts:  85%|████████▍ | 1738/2048 [01:59<00:17, 17.81it/s, est. speed input: 14867.32 toks/s, output: 14.52 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [02:00<00:18, 16.35it/s, est. speed input: 14859.95 toks/s, output: 14.51 toks/s]
Processed prompts:  86%|████████▌ | 1754/2048 [02:00<00:19, 15.35it/s, est. speed input: 14852.65 toks/s, output: 14.50 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [02:01<00:19, 14.66it/s, est. speed input: 14845.40 toks/s, output: 14.50 toks/s]
Processed prompts:  86%|████████▋ | 1770/2048 [02:02<00:19, 14.19it/s, est. speed input: 14838.23 toks/s, output: 14.49 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [02:02<00:19, 13.86it/s, est. speed input: 14831.12 toks/s, output: 14.48 toks/s]
Processed prompts:  87%|████████▋ | 1786/2048 [02:03<00:19, 13.63it/s, est. speed input: 14824.08 toks/s, output: 14.48 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [02:03<00:18, 13.47it/s, est. speed input: 14817.17 toks/s, output: 14.47 toks/s]
Processed prompts:  88%|████████▊ | 1802/2048 [02:04<00:18, 13.36it/s, est. speed input: 14810.28 toks/s, output: 14.46 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [02:05<00:17, 13.28it/s, est. speed input: 14803.45 toks/s, output: 14.46 toks/s]
Processed prompts:  89%|████████▉ | 1818/2048 [02:05<00:17, 13.23it/s, est. speed input: 14796.75 toks/s, output: 14.45 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [02:06<00:16, 13.19it/s, est. speed input: 14790.04 toks/s, output: 14.44 toks/s]
Processed prompts:  90%|████████▉ | 1834/2048 [02:07<00:16, 13.16it/s, est. speed input: 14783.46 toks/s, output: 14.44 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [02:07<00:15, 13.14it/s, est. speed input: 14776.89 toks/s, output: 14.43 toks/s]
Processed prompts:  90%|█████████ | 1850/2048 [02:08<00:15, 13.13it/s, est. speed input: 14770.41 toks/s, output: 14.42 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [02:08<00:14, 13.12it/s, est. speed input: 14763.95 toks/s, output: 14.42 toks/s]
Processed prompts:  91%|█████████ | 1866/2048 [02:09<00:13, 13.11it/s, est. speed input: 14757.58 toks/s, output: 14.41 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [02:10<00:13, 13.11it/s, est. speed input: 14751.26 toks/s, output: 14.41 toks/s]
Processed prompts:  92%|█████████▏| 1882/2048 [02:10<00:12, 13.11it/s, est. speed input: 14745.02 toks/s, output: 14.40 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [02:11<00:12, 13.10it/s, est. speed input: 14738.84 toks/s, output: 14.39 toks/s]
Processed prompts:  93%|█████████▎| 1898/2048 [02:11<00:11, 13.10it/s, est. speed input: 14732.67 toks/s, output: 14.39 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [02:12<00:10, 13.10it/s, est. speed input: 14726.59 toks/s, output: 14.38 toks/s]
Processed prompts:  93%|█████████▎| 1914/2048 [02:13<00:10, 13.10it/s, est. speed input: 14720.54 toks/s, output: 14.38 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [02:13<00:09, 13.10it/s, est. speed input: 14714.52 toks/s, output: 14.37 toks/s]
Processed prompts:  94%|█████████▍| 1930/2048 [02:14<00:09, 13.10it/s, est. speed input: 14708.60 toks/s, output: 14.36 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [02:14<00:08, 13.10it/s, est. speed input: 14702.78 toks/s, output: 14.36 toks/s]
Processed prompts:  95%|█████████▌| 1946/2048 [02:15<00:07, 13.10it/s, est. speed input: 14696.96 toks/s, output: 14.35 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [02:16<00:07, 13.10it/s, est. speed input: 14691.20 toks/s, output: 14.35 toks/s]
Processed prompts:  96%|█████████▌| 1962/2048 [02:16<00:06, 13.10it/s, est. speed input: 14685.49 toks/s, output: 14.34 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [02:17<00:05, 13.10it/s, est. speed input: 14679.87 toks/s, output: 14.34 toks/s]
Processed prompts:  97%|█████████▋| 1978/2048 [02:18<00:05, 13.10it/s, est. speed input: 14674.29 toks/s, output: 14.33 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [02:18<00:04, 13.10it/s, est. speed input: 14668.74 toks/s, output: 14.32 toks/s]
Processed prompts:  97%|█████████▋| 1994/2048 [02:19<00:04, 13.10it/s, est. speed input: 14663.22 toks/s, output: 14.32 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [02:19<00:03, 13.10it/s, est. speed input: 14657.78 toks/s, output: 14.31 toks/s]
Processed prompts:  98%|█████████▊| 2010/2048 [02:20<00:02, 13.10it/s, est. speed input: 14652.31 toks/s, output: 14.31 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [02:21<00:02, 13.10it/s, est. speed input: 14646.97 toks/s, output: 14.30 toks/s]
Processed prompts:  99%|█████████▉| 2026/2048 [02:21<00:01, 13.10it/s, est. speed input: 14641.66 toks/s, output: 14.30 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [02:22<00:01, 13.10it/s, est. speed input: 14636.39 toks/s, output: 14.29 toks/s]
Processed prompts: 100%|█████████▉| 2042/2048 [02:22<00:00, 13.59it/s, est. speed input: 14638.68 toks/s, output: 14.30 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [02:22<00:00, 13.59it/s, est. speed input: 14681.66 toks/s, output: 14.34 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [02:22<00:00, 14.34it/s, est. speed input: 14681.66 toks/s, output: 14.34 toks/s]
[rank0]:[W126 06:02:29.381898607 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 228.2s

测试结果:
  Requests/s:   13.09
  Tokens/s:     13415.49
  Total Reqs:   2048
  Elapsed:      156.48s

  [Prefill 分析]
  Total Prefill Tokens: 2097152
  Prefill Tokens/s:     13402.40

============================================================
[7/8] 测试 M=32768
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-14B-INT8                                │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 32768
│   M_prefill     = 32768 (= 32 x 1024)
│   M_decode      = 32
│   batched_tokens = 32768 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 4096
│   --max-num-seqs           = 32
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 32768
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 06:03:08 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 06:03:09 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=265251) WARNING 01-26 06:03:16 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=265251) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=265251) WARNING 01-26 06:03:37 [backends.py:609] Failed to read file <frozen os>
(EngineCore_DP0 pid=265251) ERROR 01-26 06:04:03 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=265251) ERROR 01-26 06:04:03 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=265251) ERROR 01-26 06:04:03 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=265251) ERROR 01-26 06:04:03 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=265251) ERROR 01-26 06:04:03 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=265251) ERROR 01-26 06:04:03 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=265251) ERROR 01-26 06:04:03 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=265251) ERROR 01-26 06:04:03 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=265251) ERROR 01-26 06:04:03 [core.py:866]     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=265251) ERROR 01-26 06:04:03 [core.py:866]                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=265251) ERROR 01-26 06:04:03 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 248, in _initialize_kv_caches
(EngineCore_DP0 pid=265251) ERROR 01-26 06:04:03 [core.py:866]     kv_cache_configs = get_kv_cache_configs(
(EngineCore_DP0 pid=265251) ERROR 01-26 06:04:03 [core.py:866]                        ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=265251) ERROR 01-26 06:04:03 [core.py:866]   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 1340, in get_kv_cache_configs
(EngineCore_DP0 pid=265251) ERROR 01-26 06:04:03 [core.py:866]     check_enough_kv_cache_memory(
(EngineCore_DP0 pid=265251) ERROR 01-26 06:04:03 [core.py:866]   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 687, in check_enough_kv_cache_memory
(EngineCore_DP0 pid=265251) ERROR 01-26 06:04:03 [core.py:866]     raise ValueError(
(EngineCore_DP0 pid=265251) ERROR 01-26 06:04:03 [core.py:866] ValueError: No available memory for the cache blocks. Try increasing `gpu_memory_utilization` when initializing the engine. See https://docs.vllm.ai/en/latest/configuration/conserving_memory/ for more details.


─── STDERR ───
[2026-01-26 06:03:07] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 06:03:08] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:03:08] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 06:03:08] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:03:08] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:03:08] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:03:08] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:03:08] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:03:08] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:03:08] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 06:03:08] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 06:03:08] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 06:03:08] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 06:03:08] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 06:03:16] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 06:03:16] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:03:16] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 06:03:16] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:03:16] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:03:16] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:03:16] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:03:16] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:03:16] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:03:16] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 06:03:16] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 06:03:16] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 06:03:16] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 06:03:16] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=265251) [2026-01-26 06:03:17] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=265251) [2026-01-26 06:03:17] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=265251) [2026-01-26 06:03:17] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=265251) [2026-01-26 06:03:17] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=265251) [2026-01-26 06:03:17] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=265251) [2026-01-26 06:03:17] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=265251) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=265251) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:01<00:05,  1.73s/it]
(EngineCore_DP0 pid=265251) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:03<00:03,  1.72s/it]
(EngineCore_DP0 pid=265251) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:03<00:01,  1.17s/it]
(EngineCore_DP0 pid=265251) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:05<00:00,  1.38s/it]
(EngineCore_DP0 pid=265251) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:05<00:00,  1.41s/it]
(EngineCore_DP0 pid=265251) 
(EngineCore_DP0 pid=265251) [2026-01-26 06:03:24] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 6848] -> 1D uint8
(EngineCore_DP0 pid=265251) [2026-01-26 06:03:24] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 36929536 bytes
(EngineCore_DP0 pid=265251) [2026-01-26 06:03:24] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 6848] -> 1D uint8
(EngineCore_DP0 pid=265251) [2026-01-26 06:03:24] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 26378240 bytes
(EngineCore_DP0 pid=265251) [2026-01-26 06:03:24] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 6848] -> 1D uint8
(EngineCore_DP0 pid=265251) [2026-01-26 06:03:24] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 142442496 bytes
(EngineCore_DP0 pid=265251) [2026-01-26 06:03:24] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 18432] -> 1D uint8
(EngineCore_DP0 pid=265251) [2026-01-26 06:03:24] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 70778880 bytes
(EngineCore_DP0 pid=265251) [rank0]:W0126 06:03:51.204000 265251 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=265251) [rank0]:W0126 06:03:51.285000 265251 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=265251) [rank0]:W0126 06:03:52.560000 265251 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=265251) [rank0]:W0126 06:03:52.684000 265251 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=265251) Process EngineCore_DP0:
(EngineCore_DP0 pid=265251) Traceback (most recent call last):
(EngineCore_DP0 pid=265251)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=265251)     self.run()
(EngineCore_DP0 pid=265251)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=265251)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=265251)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=265251)     raise e
(EngineCore_DP0 pid=265251)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=265251)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=265251)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=265251)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=265251)     super().__init__(
(EngineCore_DP0 pid=265251)   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=265251)     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=265251)                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=265251)   File "/root/vllmbench/vllm/v1/engine/core.py", line 248, in _initialize_kv_caches
(EngineCore_DP0 pid=265251)     kv_cache_configs = get_kv_cache_configs(
(EngineCore_DP0 pid=265251)                        ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=265251)   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 1340, in get_kv_cache_configs
(EngineCore_DP0 pid=265251)     check_enough_kv_cache_memory(
(EngineCore_DP0 pid=265251)   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 687, in check_enough_kv_cache_memory
(EngineCore_DP0 pid=265251)     raise ValueError(
(EngineCore_DP0 pid=265251) ValueError: No available memory for the cache blocks. Try increasing `gpu_memory_utilization` when initializing the engine. See https://docs.vllm.ai/en/latest/configuration/conserving_memory/ for more details.
[rank0]:[W126 06:04:04.242686078 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

[ERROR] 测试失败: M=32768 (exit code: 1)

============================================================
[8/8] 测试 M=65536
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-14B-INT8                                │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 65536
│   M_prefill     = 65536 (= 64 x 1024)
│   M_decode      = 64
│   batched_tokens = 65536 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 8192
│   --max-num-seqs           = 64
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 65536
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 06:05:15 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 06:05:16 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=267284) WARNING 01-26 06:05:32 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=267284) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=267284) WARNING 01-26 06:05:52 [backends.py:609] Failed to read file <frozen os>
(EngineCore_DP0 pid=267284) ERROR 01-26 06:07:16 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=267284) ERROR 01-26 06:07:16 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=267284) ERROR 01-26 06:07:16 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=267284) ERROR 01-26 06:07:16 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=267284) ERROR 01-26 06:07:16 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=267284) ERROR 01-26 06:07:16 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=267284) ERROR 01-26 06:07:16 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=267284) ERROR 01-26 06:07:16 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=267284) ERROR 01-26 06:07:16 [core.py:866]     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=267284) ERROR 01-26 06:07:16 [core.py:866]                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=267284) ERROR 01-26 06:07:16 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 248, in _initialize_kv_caches
(EngineCore_DP0 pid=267284) ERROR 01-26 06:07:16 [core.py:866]     kv_cache_configs = get_kv_cache_configs(
(EngineCore_DP0 pid=267284) ERROR 01-26 06:07:16 [core.py:866]                        ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=267284) ERROR 01-26 06:07:16 [core.py:866]   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 1340, in get_kv_cache_configs
(EngineCore_DP0 pid=267284) ERROR 01-26 06:07:16 [core.py:866]     check_enough_kv_cache_memory(
(EngineCore_DP0 pid=267284) ERROR 01-26 06:07:16 [core.py:866]   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 687, in check_enough_kv_cache_memory
(EngineCore_DP0 pid=267284) ERROR 01-26 06:07:16 [core.py:866]     raise ValueError(
(EngineCore_DP0 pid=267284) ERROR 01-26 06:07:16 [core.py:866] ValueError: No available memory for the cache blocks. Try increasing `gpu_memory_utilization` when initializing the engine. See https://docs.vllm.ai/en/latest/configuration/conserving_memory/ for more details.


─── STDERR ───
[2026-01-26 06:05:15] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 06:05:15] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:05:15] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 06:05:15] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:05:15] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:05:15] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:05:15] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:05:15] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:05:15] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:05:15] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 06:05:15] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 06:05:15] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 06:05:15] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 06:05:15] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 06:05:23] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 06:05:23] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:05:23] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 06:05:23] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:05:23] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:05:23] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:05:23] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:05:23] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:05:23] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:05:23] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 06:05:23] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 06:05:23] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 06:05:23] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 06:05:23] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[W126 06:05:32.979947714 socket.cpp:209] [c10d] The hostname of the client socket cannot be retrieved. err=-3
(EngineCore_DP0 pid=267284) [2026-01-26 06:05:33] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=267284) [2026-01-26 06:05:33] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=267284) [2026-01-26 06:05:33] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=267284) [2026-01-26 06:05:33] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=267284) [2026-01-26 06:05:33] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=267284) [2026-01-26 06:05:33] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=267284) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=267284) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:01<00:03,  1.21s/it]
(EngineCore_DP0 pid=267284) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:02<00:02,  1.23s/it]
(EngineCore_DP0 pid=267284) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:02<00:00,  1.17it/s]
(EngineCore_DP0 pid=267284) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.01s/it]
(EngineCore_DP0 pid=267284) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.03s/it]
(EngineCore_DP0 pid=267284) 
(EngineCore_DP0 pid=267284) [2026-01-26 06:05:39] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 6848] -> 1D uint8
(EngineCore_DP0 pid=267284) [2026-01-26 06:05:39] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 36929536 bytes
(EngineCore_DP0 pid=267284) [2026-01-26 06:05:39] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 6848] -> 1D uint8
(EngineCore_DP0 pid=267284) [2026-01-26 06:05:39] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 26378240 bytes
(EngineCore_DP0 pid=267284) [2026-01-26 06:05:39] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 6848] -> 1D uint8
(EngineCore_DP0 pid=267284) [2026-01-26 06:05:39] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 142442496 bytes
(EngineCore_DP0 pid=267284) [2026-01-26 06:05:39] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 18432] -> 1D uint8
(EngineCore_DP0 pid=267284) [2026-01-26 06:05:39] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 70778880 bytes
(EngineCore_DP0 pid=267284) [rank0]:W0126 06:06:05.794000 267284 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=267284) [rank0]:W0126 06:06:05.873000 267284 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=267284) [rank0]:W0126 06:06:07.752000 267284 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=267284) [rank0]:W0126 06:06:07.873000 267284 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=267284) Process EngineCore_DP0:
(EngineCore_DP0 pid=267284) Traceback (most recent call last):
(EngineCore_DP0 pid=267284)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=267284)     self.run()
(EngineCore_DP0 pid=267284)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=267284)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=267284)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=267284)     raise e
(EngineCore_DP0 pid=267284)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=267284)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=267284)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=267284)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=267284)     super().__init__(
(EngineCore_DP0 pid=267284)   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=267284)     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=267284)                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=267284)   File "/root/vllmbench/vllm/v1/engine/core.py", line 248, in _initialize_kv_caches
(EngineCore_DP0 pid=267284)     kv_cache_configs = get_kv_cache_configs(
(EngineCore_DP0 pid=267284)                        ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=267284)   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 1340, in get_kv_cache_configs
(EngineCore_DP0 pid=267284)     check_enough_kv_cache_memory(
(EngineCore_DP0 pid=267284)   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 687, in check_enough_kv_cache_memory
(EngineCore_DP0 pid=267284)     raise ValueError(
(EngineCore_DP0 pid=267284) ValueError: No available memory for the cache blocks. Try increasing `gpu_memory_utilization` when initializing the engine. See https://docs.vllm.ai/en/latest/configuration/conserving_memory/ for more details.
[rank0]:[W126 06:07:17.360643542 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

[ERROR] 测试失败: M=65536 (exit code: 1)


------------------------------------------------------------
  生成 CSV: Qwen2.5-14B-INT8
------------------------------------------------------------
[SUCCESS] CSV 保存到: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_6/Qwen2.5-14B-INT8_prefill.csv

预览:
------------------------------------------------------------
M_prefill,prompt_len,max_num_seqs,num_prompts,N_prefill,requests_per_s,tokens_per_s,elapsed_time_s
512,512,1,128,128,9.7039,4978.0868,13.1906
1024,1024,1,128,128,9.7055,9948.1462,13.1884
2048,1024,2,256,128,13.0927,13419.9664,19.5530
4096,1024,4,512,128,13.2541,13585.4912,38.6294
8192,1024,8,1024,128,13.0163,13341.7526,78.6703
16384,1024,16,2048,128,13.0883,13415.4930,156.4758
32768,1024,32,4096,128,-1.0000,-1.0000,-1.0000
65536,1024,64,8192,128,-1.0000,-1.0000,-1.0000

------------------------------------------------------------

[INFO] 完成: 6 成功, 2 失败

============================================================
  Qwen2.5-14B-INT8 | cuSPARSELt (2_8) | prefill
============================================================

[INFO] Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_8
[INFO] Output: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_8

============================================================
[1/8] 测试 M=512
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-14B-INT8                                │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 512
│   M_prefill     = 512 (= 1 x 512)
│   M_decode      = 1
│   batched_tokens = 513 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 512
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 513
│   --max-num-batched-tokens = 513
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 06:07:30 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 06:07:31 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=269407) WARNING 01-26 06:07:48 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=269407) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=269407) WARNING 01-26 06:08:21 [backends.py:609] Failed to read file <frozen os>
Throughput: 9.37 requests/s, 4809.18 total tokens/s, 9.37 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128


─── STDERR ───
[2026-01-26 06:07:30] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 06:07:30] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:07:30] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 06:07:30] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:07:30] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:07:30] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:07:30] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:07:30] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:07:30] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:07:30] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 06:07:30] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 06:07:30] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 06:07:30] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 06:07:30] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 06:07:38] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 06:07:38] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:07:38] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 06:07:38] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:07:38] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:07:38] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:07:38] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:07:38] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:07:38] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:07:38] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 06:07:38] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 06:07:38] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 06:07:38] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 06:07:38] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[W126 06:07:47.696425880 socket.cpp:209] [c10d] The hostname of the client socket cannot be retrieved. err=-3
(EngineCore_DP0 pid=269407) [2026-01-26 06:07:48] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=269407) [2026-01-26 06:07:48] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=269407) [2026-01-26 06:07:48] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=269407) [2026-01-26 06:07:48] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=269407) [2026-01-26 06:07:48] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=269407) [2026-01-26 06:07:48] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=269407) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=269407) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:06<00:19,  6.66s/it]
(EngineCore_DP0 pid=269407) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:11<00:11,  5.63s/it]
(EngineCore_DP0 pid=269407) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:12<00:03,  3.63s/it]
(EngineCore_DP0 pid=269407) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:18<00:00,  4.29s/it]
(EngineCore_DP0 pid=269407) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:18<00:00,  4.53s/it]
(EngineCore_DP0 pid=269407) 
(EngineCore_DP0 pid=269407) [2026-01-26 06:08:08] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 7680] -> 1D uint8
(EngineCore_DP0 pid=269407) [2026-01-26 06:08:08] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 41287680 bytes
(EngineCore_DP0 pid=269407) [2026-01-26 06:08:08] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 7680] -> 1D uint8
(EngineCore_DP0 pid=269407) [2026-01-26 06:08:08] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 29491200 bytes
(EngineCore_DP0 pid=269407) [2026-01-26 06:08:08] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 7680] -> 1D uint8
(EngineCore_DP0 pid=269407) [2026-01-26 06:08:08] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 159252480 bytes
(EngineCore_DP0 pid=269407) [2026-01-26 06:08:08] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 20736] -> 1D uint8
(EngineCore_DP0 pid=269407) [2026-01-26 06:08:08] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 79626240 bytes
(EngineCore_DP0 pid=269407) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  1.78it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:01<00:00,  1.96it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:01<00:00,  1.93it/s]
(EngineCore_DP0 pid=269407) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  4.58it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  4.58it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  34%|███▎      | 43/128 [00:00<00:00, 423.51it/s]
Adding requests:  68%|██████▊   | 87/128 [00:00<00:00, 432.79it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 435.83it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:32,  3.87it/s, est. speed input: 1983.61 toks/s, output: 3.87 toks/s]
Processed prompts:   2%|▏         | 2/128 [00:00<00:21,  5.87it/s, est. speed input: 2790.75 toks/s, output: 5.45 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:17,  7.14it/s, est. speed input: 3260.57 toks/s, output: 6.37 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:15,  7.96it/s, est. speed input: 3565.90 toks/s, output: 6.96 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:14,  8.54it/s, est. speed input: 3784.51 toks/s, output: 7.39 toks/s]
Processed prompts:   5%|▍         | 6/128 [00:00<00:13,  8.89it/s, est. speed input: 3939.07 toks/s, output: 7.69 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:13,  9.11it/s, est. speed input: 4053.84 toks/s, output: 7.92 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:00<00:12,  9.27it/s, est. speed input: 4145.94 toks/s, output: 8.10 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:01<00:12,  9.40it/s, est. speed input: 4223.47 toks/s, output: 8.25 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:01<00:12,  9.49it/s, est. speed input: 4287.43 toks/s, output: 8.37 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:01<00:12,  9.52it/s, est. speed input: 4337.85 toks/s, output: 8.47 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:01<00:12,  9.53it/s, est. speed input: 4379.13 toks/s, output: 8.55 toks/s]
Processed prompts:  10%|█         | 13/128 [00:01<00:12,  9.55it/s, est. speed input: 4416.07 toks/s, output: 8.63 toks/s]
Processed prompts:  11%|█         | 14/128 [00:01<00:11,  9.60it/s, est. speed input: 4451.56 toks/s, output: 8.69 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:01<00:11,  9.61it/s, est. speed input: 4481.02 toks/s, output: 8.75 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:01<00:11,  9.61it/s, est. speed input: 4506.35 toks/s, output: 8.80 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:01<00:11,  9.62it/s, est. speed input: 4529.60 toks/s, output: 8.85 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:02<00:11,  9.56it/s, est. speed input: 4545.06 toks/s, output: 8.88 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:02<00:11,  9.51it/s, est. speed input: 4558.21 toks/s, output: 8.90 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:02<00:11,  9.50it/s, est. speed input: 4572.10 toks/s, output: 8.93 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:02<00:11,  9.53it/s, est. speed input: 4587.35 toks/s, output: 8.96 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:02<00:02, 43.54it/s, est. speed input: 7380.96 toks/s, output: 14.42 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:02<00:03, 23.15it/s, est. speed input: 7024.40 toks/s, output: 13.72 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:03<00:04, 17.90it/s, est. speed input: 6824.22 toks/s, output: 13.33 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:03<00:05, 14.93it/s, est. speed input: 6656.54 toks/s, output: 13.00 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:03<00:05, 13.61it/s, est. speed input: 6563.11 toks/s, output: 12.82 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:03<00:06, 12.49it/s, est. speed input: 6471.64 toks/s, output: 12.64 toks/s]
Processed prompts:  41%|████      | 52/128 [00:04<00:06, 11.69it/s, est. speed input: 6393.43 toks/s, output: 12.49 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:04<00:06, 11.08it/s, est. speed input: 6321.53 toks/s, output: 12.35 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:04<00:06, 10.63it/s, est. speed input: 6254.93 toks/s, output: 12.22 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:04<00:06, 10.25it/s, est. speed input: 6189.81 toks/s, output: 12.09 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:05<00:06, 10.06it/s, est. speed input: 6136.15 toks/s, output: 11.98 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:05<00:06,  9.90it/s, est. speed input: 6085.84 toks/s, output: 11.89 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:05<00:06,  9.79it/s, est. speed input: 6039.31 toks/s, output: 11.80 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:05<00:06,  9.75it/s, est. speed input: 6017.62 toks/s, output: 11.75 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:05<00:06,  9.76it/s, est. speed input: 5999.17 toks/s, output: 11.72 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:05<00:06,  9.79it/s, est. speed input: 5983.03 toks/s, output: 11.69 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:05<00:06,  9.79it/s, est. speed input: 5966.00 toks/s, output: 11.65 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:05<00:05,  9.84it/s, est. speed input: 5951.43 toks/s, output: 11.62 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:06<00:05,  9.91it/s, est. speed input: 5924.64 toks/s, output: 11.57 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:06<00:05,  9.93it/s, est. speed input: 5911.61 toks/s, output: 11.55 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:06<00:05,  9.92it/s, est. speed input: 5898.25 toks/s, output: 11.52 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:06<00:05,  9.97it/s, est. speed input: 5874.90 toks/s, output: 11.47 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:06<00:05,  9.94it/s, est. speed input: 5862.16 toks/s, output: 11.45 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:06<00:05,  9.89it/s, est. speed input: 5848.93 toks/s, output: 11.42 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:06<00:05,  9.85it/s, est. speed input: 5835.96 toks/s, output: 11.40 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:06<00:04,  9.86it/s, est. speed input: 5824.61 toks/s, output: 11.38 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:07<00:04,  9.86it/s, est. speed input: 5813.33 toks/s, output: 11.35 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:07<00:04,  9.88it/s, est. speed input: 5803.17 toks/s, output: 11.33 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:07<00:04,  9.94it/s, est. speed input: 5784.86 toks/s, output: 11.30 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:07<00:04,  9.99it/s, est. speed input: 5768.39 toks/s, output: 11.27 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:07<00:04,  9.95it/s, est. speed input: 5758.51 toks/s, output: 11.25 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:07<00:04,  9.84it/s, est. speed input: 5746.18 toks/s, output: 11.22 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:07<00:04,  9.83it/s, est. speed input: 5736.93 toks/s, output: 11.20 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:07<00:03,  9.85it/s, est. speed input: 5728.28 toks/s, output: 11.19 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:08<00:03,  9.86it/s, est. speed input: 5719.97 toks/s, output: 11.17 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:08<00:03,  9.84it/s, est. speed input: 5711.05 toks/s, output: 11.15 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:08<00:03,  9.79it/s, est. speed input: 5701.59 toks/s, output: 11.14 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:08<00:03,  9.73it/s, est. speed input: 5691.69 toks/s, output: 11.12 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:08<00:03,  9.67it/s, est. speed input: 5681.71 toks/s, output: 11.10 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:08<00:03,  9.65it/s, est. speed input: 5672.36 toks/s, output: 11.08 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:08<00:03,  9.65it/s, est. speed input: 5663.63 toks/s, output: 11.06 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:08<00:03,  9.70it/s, est. speed input: 5656.19 toks/s, output: 11.05 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:08<00:03,  9.62it/s, est. speed input: 5646.44 toks/s, output: 11.03 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:08<00:03,  9.61it/s, est. speed input: 5637.81 toks/s, output: 11.01 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:09<00:02,  9.62it/s, est. speed input: 5629.84 toks/s, output: 11.00 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:09<00:02,  9.63it/s, est. speed input: 5622.21 toks/s, output: 10.98 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:09<00:02,  9.67it/s, est. speed input: 5615.18 toks/s, output: 10.97 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:09<00:02,  9.68it/s, est. speed input: 5608.23 toks/s, output: 10.95 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:09<00:02,  9.69it/s, est. speed input: 5601.41 toks/s, output: 10.94 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:09<00:02,  9.71it/s, est. speed input: 5594.80 toks/s, output: 10.93 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:09<00:02,  9.70it/s, est. speed input: 5588.11 toks/s, output: 10.91 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:09<00:02,  9.75it/s, est. speed input: 5582.51 toks/s, output: 10.90 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:09<00:02,  9.76it/s, est. speed input: 5576.59 toks/s, output: 10.89 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:10<00:01,  9.81it/s, est. speed input: 5571.64 toks/s, output: 10.88 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:10<00:01,  9.84it/s, est. speed input: 5566.67 toks/s, output: 10.87 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:10<00:01,  9.88it/s, est. speed input: 5562.24 toks/s, output: 10.86 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:10<00:01,  9.86it/s, est. speed input: 5556.88 toks/s, output: 10.85 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:10<00:01,  9.89it/s, est. speed input: 5552.51 toks/s, output: 10.84 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:10<00:01,  9.96it/s, est. speed input: 5544.77 toks/s, output: 10.83 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:10<00:01,  9.91it/s, est. speed input: 5535.17 toks/s, output: 10.81 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:10<00:01,  9.85it/s, est. speed input: 5529.50 toks/s, output: 10.80 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:11<00:00,  9.82it/s, est. speed input: 5524.39 toks/s, output: 10.79 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:11<00:00,  9.80it/s, est. speed input: 5519.51 toks/s, output: 10.78 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:11<00:00,  9.83it/s, est. speed input: 5515.49 toks/s, output: 10.77 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:11<00:00,  9.82it/s, est. speed input: 5510.95 toks/s, output: 10.76 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:11<00:00,  9.84it/s, est. speed input: 5506.97 toks/s, output: 10.76 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:11<00:00,  9.86it/s, est. speed input: 5503.22 toks/s, output: 10.75 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:11<00:00,  9.85it/s, est. speed input: 5499.15 toks/s, output: 10.74 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:11<00:00,  9.86it/s, est. speed input: 5495.32 toks/s, output: 10.73 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:11<00:00,  9.85it/s, est. speed input: 5491.27 toks/s, output: 10.73 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:11<00:00,  9.85it/s, est. speed input: 5487.55 toks/s, output: 10.72 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:11<00:00,  9.85it/s, est. speed input: 5487.55 toks/s, output: 10.72 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:11<00:00, 10.72it/s, est. speed input: 5487.55 toks/s, output: 10.72 toks/s]
[rank0]:[W126 06:08:57.692550126 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 98.8s

测试结果:
  Requests/s:   9.37
  Tokens/s:     4809.18
  Total Reqs:   128
  Elapsed:      13.65s

  [Prefill 分析]
  Total Prefill Tokens: 65536
  Prefill Tokens/s:     4799.81

============================================================
[2/8] 测试 M=1024
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-14B-INT8                                │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 1024
│   M_prefill     = 1024 (= 1 x 1024)
│   M_decode      = 1
│   batched_tokens = 1025 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 1025
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 06:09:09 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 06:09:10 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=271036) WARNING 01-26 06:09:24 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=271036) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=271036) WARNING 01-26 06:09:46 [backends.py:609] Failed to read file <frozen os>
Throughput: 9.63 requests/s, 9872.39 total tokens/s, 9.63 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128


─── STDERR ───
[2026-01-26 06:09:09] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 06:09:09] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:09:09] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 06:09:09] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:09:09] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:09:09] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:09:09] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:09:09] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:09:09] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:09:09] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 06:09:09] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 06:09:09] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 06:09:09] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 06:09:09] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 06:09:17] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 06:09:17] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:09:17] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 06:09:17] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:09:17] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:09:17] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:09:17] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:09:17] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:09:17] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:09:17] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 06:09:17] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 06:09:17] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 06:09:17] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 06:09:17] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[W126 06:09:24.364067698 socket.cpp:209] [c10d] The hostname of the client socket cannot be retrieved. err=-3
(EngineCore_DP0 pid=271036) [2026-01-26 06:09:25] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=271036) [2026-01-26 06:09:25] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=271036) [2026-01-26 06:09:25] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=271036) [2026-01-26 06:09:25] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=271036) [2026-01-26 06:09:25] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=271036) [2026-01-26 06:09:25] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=271036) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=271036) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:01<00:04,  1.42s/it]
(EngineCore_DP0 pid=271036) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:03<00:03,  1.58s/it]
(EngineCore_DP0 pid=271036) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:03<00:01,  1.18s/it]
(EngineCore_DP0 pid=271036) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:05<00:00,  1.27s/it]
(EngineCore_DP0 pid=271036) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:05<00:00,  1.31s/it]
(EngineCore_DP0 pid=271036) 
(EngineCore_DP0 pid=271036) [2026-01-26 06:09:31] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 7680] -> 1D uint8
(EngineCore_DP0 pid=271036) [2026-01-26 06:09:31] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 41287680 bytes
(EngineCore_DP0 pid=271036) [2026-01-26 06:09:31] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 7680] -> 1D uint8
(EngineCore_DP0 pid=271036) [2026-01-26 06:09:31] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 29491200 bytes
(EngineCore_DP0 pid=271036) [2026-01-26 06:09:31] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 7680] -> 1D uint8
(EngineCore_DP0 pid=271036) [2026-01-26 06:09:31] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 159252480 bytes
(EngineCore_DP0 pid=271036) [2026-01-26 06:09:31] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 20736] -> 1D uint8
(EngineCore_DP0 pid=271036) [2026-01-26 06:09:31] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 79626240 bytes
(EngineCore_DP0 pid=271036) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  2.47it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  3.09it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  2.97it/s]
(EngineCore_DP0 pid=271036) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  3.50it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  3.50it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  18%|█▊        | 23/128 [00:00<00:00, 228.83it/s]
Adding requests:  38%|███▊      | 48/128 [00:00<00:00, 235.19it/s]
Adding requests:  58%|█████▊    | 74/128 [00:00<00:00, 243.74it/s]
Adding requests:  77%|███████▋  | 99/128 [00:00<00:00, 241.17it/s]
Adding requests:  98%|█████████▊| 125/128 [00:00<00:00, 246.32it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 242.23it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:06, 18.04it/s, est. speed input: 18473.14 toks/s, output: 18.04 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:09, 12.77it/s, est. speed input: 13804.71 toks/s, output: 13.48 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:10, 11.38it/s, est. speed input: 12482.21 toks/s, output: 12.19 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:00<00:11, 10.81it/s, est. speed input: 11890.74 toks/s, output: 11.61 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:00<00:11, 10.47it/s, est. speed input: 11525.14 toks/s, output: 11.25 toks/s]
Processed prompts:  10%|█         | 13/128 [00:01<00:11, 10.29it/s, est. speed input: 11295.71 toks/s, output: 11.03 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:01<00:11, 10.18it/s, est. speed input: 11136.37 toks/s, output: 10.88 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:01<00:10, 10.09it/s, est. speed input: 11008.60 toks/s, output: 10.75 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:01<00:10, 10.03it/s, est. speed input: 10908.69 toks/s, output: 10.65 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:01<00:10,  9.96it/s, est. speed input: 10819.06 toks/s, output: 10.57 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:02<00:10,  9.97it/s, est. speed input: 10764.58 toks/s, output: 10.51 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:02<00:10, 10.00it/s, est. speed input: 10726.59 toks/s, output: 10.48 toks/s]
Processed prompts:  21%|██        | 27/128 [00:02<00:10, 10.01it/s, est. speed input: 10693.43 toks/s, output: 10.44 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:02<00:09, 10.04it/s, est. speed input: 10669.51 toks/s, output: 10.42 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:02<00:09, 10.03it/s, est. speed input: 10641.33 toks/s, output: 10.39 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:03<00:09, 10.04it/s, est. speed input: 10620.17 toks/s, output: 10.37 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:03<00:09,  9.99it/s, est. speed input: 10589.02 toks/s, output: 10.34 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:03<00:09,  9.90it/s, est. speed input: 10564.00 toks/s, output: 10.32 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:03<00:09,  9.91it/s, est. speed input: 10552.95 toks/s, output: 10.31 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:03<00:09,  9.92it/s, est. speed input: 10542.98 toks/s, output: 10.30 toks/s]
Processed prompts:  30%|███       | 39/128 [00:03<00:08,  9.92it/s, est. speed input: 10532.80 toks/s, output: 10.29 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:03<00:08,  9.89it/s, est. speed input: 10520.24 toks/s, output: 10.27 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:03<00:08,  9.87it/s, est. speed input: 10508.46 toks/s, output: 10.26 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:04<00:08,  9.87it/s, est. speed input: 10497.99 toks/s, output: 10.25 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:04<00:08,  9.87it/s, est. speed input: 10488.72 toks/s, output: 10.24 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:04<00:08,  9.90it/s, est. speed input: 10482.06 toks/s, output: 10.24 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:04<00:08,  9.89it/s, est. speed input: 10473.74 toks/s, output: 10.23 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:04<00:08,  9.87it/s, est. speed input: 10464.03 toks/s, output: 10.22 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:04<00:08,  9.89it/s, est. speed input: 10457.72 toks/s, output: 10.21 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:04<00:08,  9.86it/s, est. speed input: 10448.76 toks/s, output: 10.20 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:04<00:07,  9.92it/s, est. speed input: 10440.05 toks/s, output: 10.20 toks/s]
Processed prompts:  41%|████      | 52/128 [00:05<00:07,  9.96it/s, est. speed input: 10433.14 toks/s, output: 10.19 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:05<00:07,  9.93it/s, est. speed input: 10425.83 toks/s, output: 10.18 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:05<00:07, 10.00it/s, est. speed input: 10422.89 toks/s, output: 10.18 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:05<00:07, 10.00it/s, est. speed input: 10419.35 toks/s, output: 10.18 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:05<00:06, 10.05it/s, est. speed input: 10417.71 toks/s, output: 10.17 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:05<00:06, 10.01it/s, est. speed input: 10409.42 toks/s, output: 10.17 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:06<00:06,  9.98it/s, est. speed input: 10401.36 toks/s, output: 10.16 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:06<00:06,  9.96it/s, est. speed input: 10397.10 toks/s, output: 10.15 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:06<00:06,  9.95it/s, est. speed input: 10392.81 toks/s, output: 10.15 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:06<00:06,  9.97it/s, est. speed input: 10388.33 toks/s, output: 10.14 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:06<00:06,  9.97it/s, est. speed input: 10385.56 toks/s, output: 10.14 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:06<00:06,  9.97it/s, est. speed input: 10383.15 toks/s, output: 10.14 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:06<00:05,  9.96it/s, est. speed input: 10380.09 toks/s, output: 10.14 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:06<00:05,  9.96it/s, est. speed input: 10377.28 toks/s, output: 10.13 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:07<00:05,  9.99it/s, est. speed input: 10374.45 toks/s, output: 10.13 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:07<00:05,  9.98it/s, est. speed input: 10371.90 toks/s, output: 10.13 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:07<00:05,  9.96it/s, est. speed input: 10368.33 toks/s, output: 10.13 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:07<00:05,  9.93it/s, est. speed input: 10361.92 toks/s, output: 10.12 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:07<00:05,  9.93it/s, est. speed input: 10359.14 toks/s, output: 10.12 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:07<00:04,  9.98it/s, est. speed input: 10357.55 toks/s, output: 10.11 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:07<00:04,  9.96it/s, est. speed input: 10354.71 toks/s, output: 10.11 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:08<00:04,  9.95it/s, est. speed input: 10352.10 toks/s, output: 10.11 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:08<00:04,  9.96it/s, est. speed input: 10350.46 toks/s, output: 10.11 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:08<00:04,  9.94it/s, est. speed input: 10347.90 toks/s, output: 10.11 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:08<00:04,  9.95it/s, est. speed input: 10346.26 toks/s, output: 10.10 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:08<00:04,  9.99it/s, est. speed input: 10344.70 toks/s, output: 10.10 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:08<00:04,  9.95it/s, est. speed input: 10341.29 toks/s, output: 10.10 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:08<00:04,  9.96it/s, est. speed input: 10339.89 toks/s, output: 10.10 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:08<00:03,  9.96it/s, est. speed input: 10338.25 toks/s, output: 10.10 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:08<00:03,  9.97it/s, est. speed input: 10337.04 toks/s, output: 10.09 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:09<00:03,  9.98it/s, est. speed input: 10334.98 toks/s, output: 10.09 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:09<00:03,  9.97it/s, est. speed input: 10333.12 toks/s, output: 10.09 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:09<00:03, 10.01it/s, est. speed input: 10332.51 toks/s, output: 10.09 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:09<00:03, 10.00it/s, est. speed input: 10330.37 toks/s, output: 10.09 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:09<00:03,  9.97it/s, est. speed input: 10327.69 toks/s, output: 10.09 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:09<00:02,  9.97it/s, est. speed input: 10326.78 toks/s, output: 10.08 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:09<00:02,  9.94it/s, est. speed input: 10324.30 toks/s, output: 10.08 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:10<00:02,  9.91it/s, est. speed input: 10321.50 toks/s, output: 10.08 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:10<00:02,  9.91it/s, est. speed input: 10319.88 toks/s, output: 10.08 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:10<00:02,  9.89it/s, est. speed input: 10317.42 toks/s, output: 10.08 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:10<00:02,  9.90it/s, est. speed input: 10315.81 toks/s, output: 10.07 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:10<00:02,  9.90it/s, est. speed input: 10314.22 toks/s, output: 10.07 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:10<00:02,  9.89it/s, est. speed input: 10312.03 toks/s, output: 10.07 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:10<00:02,  9.90it/s, est. speed input: 10310.66 toks/s, output: 10.07 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:10<00:02,  9.87it/s, est. speed input: 10308.18 toks/s, output: 10.07 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:10<00:01,  9.86it/s, est. speed input: 10305.74 toks/s, output: 10.06 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:10<00:01,  9.84it/s, est. speed input: 10303.32 toks/s, output: 10.06 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:11<00:01,  9.84it/s, est. speed input: 10301.31 toks/s, output: 10.06 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:11<00:01,  9.83it/s, est. speed input: 10298.91 toks/s, output: 10.06 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:11<00:01,  9.73it/s, est. speed input: 10293.65 toks/s, output: 10.05 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:11<00:01,  9.77it/s, est. speed input: 10291.94 toks/s, output: 10.05 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:11<00:01,  9.81it/s, est. speed input: 10290.58 toks/s, output: 10.05 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:11<00:01,  9.85it/s, est. speed input: 10289.63 toks/s, output: 10.05 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:11<00:01,  9.89it/s, est. speed input: 10289.03 toks/s, output: 10.05 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:11<00:01,  9.90it/s, est. speed input: 10288.04 toks/s, output: 10.05 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:11<00:00,  9.89it/s, est. speed input: 10286.26 toks/s, output: 10.05 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:11<00:00,  9.92it/s, est. speed input: 10285.75 toks/s, output: 10.04 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:12<00:00,  9.84it/s, est. speed input: 10282.47 toks/s, output: 10.04 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:12<00:00,  9.81it/s, est. speed input: 10279.97 toks/s, output: 10.04 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:12<00:00,  9.81it/s, est. speed input: 10277.87 toks/s, output: 10.04 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:12<00:00,  9.82it/s, est. speed input: 10276.34 toks/s, output: 10.04 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:12<00:00,  9.84it/s, est. speed input: 10275.13 toks/s, output: 10.03 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:12<00:00,  9.87it/s, est. speed input: 10274.43 toks/s, output: 10.03 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:11<00:00,  9.87it/s, est. speed input: 11577.25 toks/s, output: 11.31 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:11<00:00, 11.31it/s, est. speed input: 11577.25 toks/s, output: 11.31 toks/s]
[rank0]:[W126 06:10:20.402489429 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 82.5s

测试结果:
  Requests/s:   9.63
  Tokens/s:     9872.39
  Total Reqs:   128
  Elapsed:      13.29s

  [Prefill 分析]
  Total Prefill Tokens: 131072
  Prefill Tokens/s:     9862.76

============================================================
[3/8] 测试 M=2048
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-14B-INT8                                │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 2048
│   M_prefill     = 2048 (= 2 x 1024)
│   M_decode      = 2
│   batched_tokens = 2048 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 256
│   --max-num-seqs           = 2
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 2048
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 06:10:32 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 06:10:34 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=272451) WARNING 01-26 06:10:42 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=272451) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=272451) WARNING 01-26 06:11:02 [backends.py:609] Failed to read file <frozen os>
Throughput: 12.30 requests/s, 12608.57 total tokens/s, 12.30 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256


─── STDERR ───
[2026-01-26 06:10:32] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 06:10:32] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:10:32] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 06:10:32] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:10:32] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:10:32] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:10:32] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:10:32] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:10:32] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:10:32] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 06:10:32] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 06:10:32] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 06:10:32] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 06:10:32] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 06:10:41] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 06:10:41] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:10:41] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 06:10:41] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:10:41] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:10:41] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:10:41] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:10:41] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:10:41] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:10:41] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 06:10:41] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 06:10:41] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 06:10:41] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 06:10:41] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=272451) [2026-01-26 06:10:42] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=272451) [2026-01-26 06:10:42] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=272451) [2026-01-26 06:10:42] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=272451) [2026-01-26 06:10:42] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=272451) [2026-01-26 06:10:42] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=272451) [2026-01-26 06:10:42] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=272451) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=272451) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:01<00:04,  1.40s/it]
(EngineCore_DP0 pid=272451) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:02<00:02,  1.41s/it]
(EngineCore_DP0 pid=272451) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:03<00:00,  1.04it/s]
(EngineCore_DP0 pid=272451) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.14s/it]
(EngineCore_DP0 pid=272451) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.16s/it]
(EngineCore_DP0 pid=272451) 
(EngineCore_DP0 pid=272451) [2026-01-26 06:10:48] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 7680] -> 1D uint8
(EngineCore_DP0 pid=272451) [2026-01-26 06:10:48] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 41287680 bytes
(EngineCore_DP0 pid=272451) [2026-01-26 06:10:48] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 7680] -> 1D uint8
(EngineCore_DP0 pid=272451) [2026-01-26 06:10:48] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 29491200 bytes
(EngineCore_DP0 pid=272451) [2026-01-26 06:10:48] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 7680] -> 1D uint8
(EngineCore_DP0 pid=272451) [2026-01-26 06:10:48] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 159252480 bytes
(EngineCore_DP0 pid=272451) [2026-01-26 06:10:48] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 20736] -> 1D uint8
(EngineCore_DP0 pid=272451) [2026-01-26 06:10:48] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 79626240 bytes
(EngineCore_DP0 pid=272451) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  33%|███▎      | 1/3 [00:00<00:00,  2.44it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  67%|██████▋   | 2/3 [00:00<00:00,  3.59it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00, -5.07it/s]
(EngineCore_DP0 pid=272451) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 1/2 [00:00<00:00,  4.56it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  5.05it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  4.97it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:   9%|▉         | 23/256 [00:00<00:01, 227.88it/s]
Adding requests:  19%|█▉        | 49/256 [00:00<00:00, 240.79it/s]
Adding requests:  30%|██▉       | 76/256 [00:00<00:00, 249.33it/s]
Adding requests:  39%|███▉      | 101/256 [00:00<00:00, 245.27it/s]
Adding requests:  50%|████▉     | 127/256 [00:00<00:00, 246.71it/s]
Adding requests:  59%|█████▉    | 152/256 [00:00<00:00, 243.45it/s]
Adding requests:  70%|██████▉   | 178/256 [00:00<00:00, 245.76it/s]
Adding requests:  79%|███████▉  | 203/256 [00:00<00:00, 246.52it/s]
Adding requests:  90%|█████████ | 231/256 [00:00<00:00, 253.89it/s]
Adding requests: 100%|██████████| 256/256 [00:01<00:00, 247.90it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▍         | 12/256 [00:00<00:03, 68.27it/s, est. speed input: 69922.80 toks/s, output: 68.28 toks/s]
Processed prompts:   7%|▋         | 19/256 [00:00<00:09, 25.52it/s, est. speed input: 29648.30 toks/s, output: 28.95 toks/s]
Processed prompts:   9%|▉         | 23/256 [00:00<00:11, 19.88it/s, est. speed input: 24103.12 toks/s, output: 23.54 toks/s]
Processed prompts:  10%|█         | 26/256 [00:01<00:14, 15.87it/s, est. speed input: 20511.98 toks/s, output: 20.03 toks/s]
Processed prompts:  11%|█         | 28/256 [00:01<00:15, 15.14it/s, est. speed input: 19661.18 toks/s, output: 19.20 toks/s]
Processed prompts:  12%|█▏        | 30/256 [00:01<00:15, 14.49it/s, est. speed input: 18966.80 toks/s, output: 18.52 toks/s]
Processed prompts:  12%|█▎        | 32/256 [00:01<00:16, 13.98it/s, est. speed input: 18405.81 toks/s, output: 17.97 toks/s]
Processed prompts:  13%|█▎        | 34/256 [00:01<00:16, 13.57it/s, est. speed input: 17936.18 toks/s, output: 17.52 toks/s]
Processed prompts:  14%|█▍        | 36/256 [00:02<00:16, 13.27it/s, est. speed input: 17542.52 toks/s, output: 17.13 toks/s]
Processed prompts:  15%|█▍        | 38/256 [00:02<00:16, 13.05it/s, est. speed input: 17203.28 toks/s, output: 16.80 toks/s]
Processed prompts:  16%|█▌        | 40/256 [00:02<00:16, 12.88it/s, est. speed input: 16910.27 toks/s, output: 16.51 toks/s]
Processed prompts:  16%|█▋        | 42/256 [00:02<00:16, 12.77it/s, est. speed input: 16655.06 toks/s, output: 16.26 toks/s]
Processed prompts:  17%|█▋        | 44/256 [00:02<00:16, 12.68it/s, est. speed input: 16427.64 toks/s, output: 16.04 toks/s]
Processed prompts:  18%|█▊        | 46/256 [00:02<00:16, 12.62it/s, est. speed input: 16226.54 toks/s, output: 15.85 toks/s]
Processed prompts:  19%|█▉        | 48/256 [00:03<00:16, 12.59it/s, est. speed input: 16047.25 toks/s, output: 15.67 toks/s]
Processed prompts:  20%|█▉        | 50/256 [00:03<00:16, 12.56it/s, est. speed input: 15885.66 toks/s, output: 15.51 toks/s]
Processed prompts:  20%|██        | 52/256 [00:03<00:16, 12.53it/s, est. speed input: 15737.08 toks/s, output: 15.37 toks/s]
Processed prompts:  21%|██        | 54/256 [00:03<00:16, 12.51it/s, est. speed input: 15602.67 toks/s, output: 15.24 toks/s]
Processed prompts:  22%|██▏       | 56/256 [00:03<00:16, 12.49it/s, est. speed input: 15478.87 toks/s, output: 15.12 toks/s]
Processed prompts:  23%|██▎       | 58/256 [00:03<00:15, 12.48it/s, est. speed input: 15365.55 toks/s, output: 15.01 toks/s]
Processed prompts:  23%|██▎       | 60/256 [00:04<00:15, 12.46it/s, est. speed input: 15259.63 toks/s, output: 14.90 toks/s]
Processed prompts:  24%|██▍       | 62/256 [00:04<00:15, 12.46it/s, est. speed input: 15163.36 toks/s, output: 14.81 toks/s]
Processed prompts:  25%|██▌       | 64/256 [00:04<00:15, 12.45it/s, est. speed input: 15073.00 toks/s, output: 14.72 toks/s]
Processed prompts:  26%|██▌       | 66/256 [00:04<00:15, 12.45it/s, est. speed input: 14990.55 toks/s, output: 14.64 toks/s]
Processed prompts:  27%|██▋       | 68/256 [00:04<00:15, 12.44it/s, est. speed input: 14911.97 toks/s, output: 14.56 toks/s]
Processed prompts:  27%|██▋       | 70/256 [00:04<00:14, 12.42it/s, est. speed input: 14837.40 toks/s, output: 14.49 toks/s]
Processed prompts:  28%|██▊       | 72/256 [00:04<00:14, 12.42it/s, est. speed input: 14768.36 toks/s, output: 14.42 toks/s]
Processed prompts:  29%|██▉       | 74/256 [00:05<00:14, 12.42it/s, est. speed input: 14704.52 toks/s, output: 14.36 toks/s]
Processed prompts:  30%|██▉       | 76/256 [00:05<00:14, 12.44it/s, est. speed input: 14646.30 toks/s, output: 14.30 toks/s]
Processed prompts:  30%|███       | 78/256 [00:05<00:14, 12.45it/s, est. speed input: 14591.58 toks/s, output: 14.25 toks/s]
Processed prompts:  31%|███▏      | 80/256 [00:05<00:14, 12.45it/s, est. speed input: 14539.55 toks/s, output: 14.20 toks/s]
Processed prompts:  32%|███▏      | 82/256 [00:05<00:13, 12.44it/s, est. speed input: 14488.70 toks/s, output: 14.15 toks/s]
Processed prompts:  33%|███▎      | 84/256 [00:05<00:13, 12.44it/s, est. speed input: 14440.86 toks/s, output: 14.10 toks/s]
Processed prompts:  34%|███▎      | 86/256 [00:06<00:13, 12.44it/s, est. speed input: 14396.63 toks/s, output: 14.06 toks/s]
Processed prompts:  34%|███▍      | 88/256 [00:06<00:13, 12.44it/s, est. speed input: 14353.84 toks/s, output: 14.02 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:06<00:13, 12.44it/s, est. speed input: 14313.49 toks/s, output: 13.98 toks/s]
Processed prompts:  36%|███▌      | 92/256 [00:06<00:13, 12.44it/s, est. speed input: 14274.81 toks/s, output: 13.94 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:06<00:13, 12.44it/s, est. speed input: 14238.95 toks/s, output: 13.91 toks/s]
Processed prompts:  38%|███▊      | 96/256 [00:06<00:12, 12.45it/s, est. speed input: 14204.38 toks/s, output: 13.87 toks/s]
Processed prompts:  38%|███▊      | 98/256 [00:07<00:12, 12.43it/s, est. speed input: 14170.19 toks/s, output: 13.84 toks/s]
Processed prompts:  39%|███▉      | 100/256 [00:07<00:12, 12.42it/s, est. speed input: 14137.21 toks/s, output: 13.81 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:07<00:12, 12.43it/s, est. speed input: 14106.77 toks/s, output: 13.78 toks/s]
Processed prompts:  41%|████      | 104/256 [00:07<00:12, 12.43it/s, est. speed input: 14078.00 toks/s, output: 13.75 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:07<00:12, 12.44it/s, est. speed input: 14050.31 toks/s, output: 13.72 toks/s]
Processed prompts:  42%|████▏     | 108/256 [00:07<00:11, 12.44it/s, est. speed input: 14023.39 toks/s, output: 13.69 toks/s]
Processed prompts:  43%|████▎     | 110/256 [00:08<00:11, 12.43it/s, est. speed input: 13996.90 toks/s, output: 13.67 toks/s]
Processed prompts:  44%|████▍     | 112/256 [00:08<00:11, 12.43it/s, est. speed input: 13972.34 toks/s, output: 13.64 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:08<00:11, 12.43it/s, est. speed input: 13948.25 toks/s, output: 13.62 toks/s]
Processed prompts:  45%|████▌     | 116/256 [00:08<00:11, 12.44it/s, est. speed input: 13926.23 toks/s, output: 13.60 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:08<00:11, 12.43it/s, est. speed input: 13903.27 toks/s, output: 13.58 toks/s]
Processed prompts:  47%|████▋     | 120/256 [00:08<00:10, 12.44it/s, est. speed input: 13882.42 toks/s, output: 13.56 toks/s]
Processed prompts:  48%|████▊     | 122/256 [00:09<00:10, 12.45it/s, est. speed input: 13862.59 toks/s, output: 13.54 toks/s]
Processed prompts:  48%|████▊     | 124/256 [00:09<00:10, 12.45it/s, est. speed input: 13843.35 toks/s, output: 13.52 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:09<00:10, 12.46it/s, est. speed input: 13824.88 toks/s, output: 13.50 toks/s]
Processed prompts:  50%|█████     | 128/256 [00:09<00:10, 12.46it/s, est. speed input: 13806.83 toks/s, output: 13.48 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:09<00:10, 12.45it/s, est. speed input: 13788.90 toks/s, output: 13.47 toks/s]
Processed prompts:  52%|█████▏    | 132/256 [00:09<00:09, 12.43it/s, est. speed input: 13770.96 toks/s, output: 13.45 toks/s]
Processed prompts:  52%|█████▏    | 134/256 [00:09<00:09, 12.42it/s, est. speed input: 13753.47 toks/s, output: 13.43 toks/s]
Processed prompts:  53%|█████▎    | 136/256 [00:10<00:09, 12.41it/s, est. speed input: 13736.39 toks/s, output: 13.41 toks/s]
Processed prompts:  54%|█████▍    | 138/256 [00:10<00:09, 12.41it/s, est. speed input: 13720.26 toks/s, output: 13.40 toks/s]
Processed prompts:  55%|█████▍    | 140/256 [00:10<00:09, 12.41it/s, est. speed input: 13704.54 toks/s, output: 13.38 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:10<00:09, 12.41it/s, est. speed input: 13689.71 toks/s, output: 13.37 toks/s]
Processed prompts:  56%|█████▋    | 144/256 [00:10<00:09, 12.41it/s, est. speed input: 13674.70 toks/s, output: 13.35 toks/s]
Processed prompts:  57%|█████▋    | 146/256 [00:10<00:08, 12.40it/s, est. speed input: 13660.30 toks/s, output: 13.34 toks/s]
Processed prompts:  58%|█████▊    | 148/256 [00:11<00:08, 12.40it/s, est. speed input: 13646.21 toks/s, output: 13.33 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:11<00:08, 12.40it/s, est. speed input: 13632.46 toks/s, output: 13.31 toks/s]
Processed prompts:  59%|█████▉    | 152/256 [00:11<00:08, 12.41it/s, est. speed input: 13619.72 toks/s, output: 13.30 toks/s]
Processed prompts:  60%|██████    | 154/256 [00:11<00:08, 12.42it/s, est. speed input: 13607.58 toks/s, output: 13.29 toks/s]
Processed prompts:  61%|██████    | 156/256 [00:11<00:08, 12.42it/s, est. speed input: 13595.57 toks/s, output: 13.28 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:11<00:07, 12.41it/s, est. speed input: 13583.09 toks/s, output: 13.26 toks/s]
Processed prompts:  62%|██████▎   | 160/256 [00:12<00:07, 12.40it/s, est. speed input: 13570.85 toks/s, output: 13.25 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:12<00:07, 12.41it/s, est. speed input: 13559.67 toks/s, output: 13.24 toks/s]
Processed prompts:  64%|██████▍   | 164/256 [00:12<00:07, 12.42it/s, est. speed input: 13548.98 toks/s, output: 13.23 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:12<00:07, 12.42it/s, est. speed input: 13538.63 toks/s, output: 13.22 toks/s]
Processed prompts:  66%|██████▌   | 168/256 [00:12<00:07, 12.43it/s, est. speed input: 13528.65 toks/s, output: 13.21 toks/s]
Processed prompts:  66%|██████▋   | 170/256 [00:12<00:06, 12.42it/s, est. speed input: 13518.35 toks/s, output: 13.20 toks/s]
Processed prompts:  67%|██████▋   | 172/256 [00:13<00:06, 12.41it/s, est. speed input: 13508.03 toks/s, output: 13.19 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:13<00:06, 12.40it/s, est. speed input: 13497.89 toks/s, output: 13.18 toks/s]
Processed prompts:  69%|██████▉   | 176/256 [00:13<00:06, 12.39it/s, est. speed input: 13487.78 toks/s, output: 13.17 toks/s]
Processed prompts:  70%|██████▉   | 178/256 [00:13<00:06, 12.38it/s, est. speed input: 13477.91 toks/s, output: 13.16 toks/s]
Processed prompts:  70%|███████   | 180/256 [00:13<00:06, 12.39it/s, est. speed input: 13468.85 toks/s, output: 13.15 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:13<00:05, 12.39it/s, est. speed input: 13459.63 toks/s, output: 13.14 toks/s]
Processed prompts:  72%|███████▏  | 184/256 [00:14<00:05, 12.38it/s, est. speed input: 13450.46 toks/s, output: 13.14 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:14<00:05, 12.37it/s, est. speed input: 13441.22 toks/s, output: 13.13 toks/s]
Processed prompts:  73%|███████▎  | 188/256 [00:14<00:05, 12.36it/s, est. speed input: 13432.23 toks/s, output: 13.12 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:14<00:05, 12.38it/s, est. speed input: 13424.16 toks/s, output: 13.11 toks/s]
Processed prompts:  75%|███████▌  | 192/256 [00:14<00:05, 12.39it/s, est. speed input: 13416.34 toks/s, output: 13.10 toks/s]
Processed prompts:  76%|███████▌  | 194/256 [00:14<00:05, 12.39it/s, est. speed input: 13408.44 toks/s, output: 13.09 toks/s]
Processed prompts:  77%|███████▋  | 196/256 [00:14<00:04, 12.39it/s, est. speed input: 13400.77 toks/s, output: 13.09 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:15<00:04, 12.39it/s, est. speed input: 13393.00 toks/s, output: 13.08 toks/s]
Processed prompts:  78%|███████▊  | 200/256 [00:15<00:04, 12.39it/s, est. speed input: 13385.50 toks/s, output: 13.07 toks/s]
Processed prompts:  79%|███████▉  | 202/256 [00:15<00:04, 12.38it/s, est. speed input: 13377.97 toks/s, output: 13.06 toks/s]
Processed prompts:  80%|███████▉  | 204/256 [00:15<00:04, 12.39it/s, est. speed input: 13370.91 toks/s, output: 13.06 toks/s]
Processed prompts:  80%|████████  | 206/256 [00:15<00:04, 12.39it/s, est. speed input: 13364.03 toks/s, output: 13.05 toks/s]
Processed prompts:  81%|████████▏ | 208/256 [00:15<00:03, 12.39it/s, est. speed input: 13357.30 toks/s, output: 13.04 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:16<00:03, 12.39it/s, est. speed input: 13350.63 toks/s, output: 13.04 toks/s]
Processed prompts:  83%|████████▎ | 212/256 [00:16<00:03, 12.38it/s, est. speed input: 13343.42 toks/s, output: 13.03 toks/s]
Processed prompts:  84%|████████▎ | 214/256 [00:16<00:03, 12.37it/s, est. speed input: 13336.70 toks/s, output: 13.02 toks/s]
Processed prompts:  84%|████████▍ | 216/256 [00:16<00:03, 12.36it/s, est. speed input: 13329.87 toks/s, output: 13.02 toks/s]
Processed prompts:  85%|████████▌ | 218/256 [00:16<00:03, 12.36it/s, est. speed input: 13323.37 toks/s, output: 13.01 toks/s]
Processed prompts:  86%|████████▌ | 220/256 [00:16<00:02, 12.36it/s, est. speed input: 13316.88 toks/s, output: 13.00 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:17<00:02, 12.35it/s, est. speed input: 13310.41 toks/s, output: 13.00 toks/s]
Processed prompts:  88%|████████▊ | 224/256 [00:17<00:02, 12.34it/s, est. speed input: 13303.75 toks/s, output: 12.99 toks/s]
Processed prompts:  88%|████████▊ | 226/256 [00:17<00:02, 12.34it/s, est. speed input: 13297.65 toks/s, output: 12.99 toks/s]
Processed prompts:  89%|████████▉ | 228/256 [00:17<00:02, 12.34it/s, est. speed input: 13291.38 toks/s, output: 12.98 toks/s]
Processed prompts:  90%|████████▉ | 230/256 [00:17<00:02, 12.36it/s, est. speed input: 13285.98 toks/s, output: 12.97 toks/s]
Processed prompts:  91%|█████████ | 232/256 [00:17<00:01, 12.36it/s, est. speed input: 13280.27 toks/s, output: 12.97 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:18<00:01, 12.34it/s, est. speed input: 13274.20 toks/s, output: 12.96 toks/s]
Processed prompts:  92%|█████████▏| 236/256 [00:18<00:01, 12.35it/s, est. speed input: 13268.87 toks/s, output: 12.96 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:18<00:01, 12.35it/s, est. speed input: 13263.36 toks/s, output: 12.95 toks/s]
Processed prompts:  94%|█████████▍| 240/256 [00:18<00:01, 12.36it/s, est. speed input: 13258.22 toks/s, output: 12.95 toks/s]
Processed prompts:  95%|█████████▍| 242/256 [00:18<00:01, 12.35it/s, est. speed input: 13252.83 toks/s, output: 12.94 toks/s]
Processed prompts:  95%|█████████▌| 244/256 [00:18<00:00, 12.36it/s, est. speed input: 13247.79 toks/s, output: 12.94 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:19<00:00, 12.36it/s, est. speed input: 13242.82 toks/s, output: 12.93 toks/s]
Processed prompts:  97%|█████████▋| 248/256 [00:19<00:00, 12.35it/s, est. speed input: 13237.68 toks/s, output: 12.93 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:19<00:00, 12.36it/s, est. speed input: 13232.81 toks/s, output: 12.92 toks/s]
Processed prompts:  98%|█████████▊| 252/256 [00:19<00:00, 12.35it/s, est. speed input: 13227.92 toks/s, output: 12.92 toks/s]
Processed prompts:  99%|█████████▉| 254/256 [00:19<00:00, 12.33it/s, est. speed input: 13222.55 toks/s, output: 12.91 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:19<00:00, 13.76it/s, est. speed input: 13255.19 toks/s, output: 12.94 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:19<00:00, 13.76it/s, est. speed input: 13255.19 toks/s, output: 12.94 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:19<00:00, 12.94it/s, est. speed input: 13255.19 toks/s, output: 12.94 toks/s]
[rank0]:[W126 06:11:45.579207500 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 85.3s

测试结果:
  Requests/s:   12.30
  Tokens/s:     12608.57
  Total Reqs:   256
  Elapsed:      20.81s

  [Prefill 分析]
  Total Prefill Tokens: 262144
  Prefill Tokens/s:     12596.27

============================================================
[4/8] 测试 M=4096
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-14B-INT8                                │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 4096
│   M_prefill     = 4096 (= 4 x 1024)
│   M_decode      = 4
│   batched_tokens = 4096 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 512
│   --max-num-seqs           = 4
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 4096
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 06:11:58 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 06:11:59 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=273874) WARNING 01-26 06:12:07 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=273874) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=273874) WARNING 01-26 06:12:26 [backends.py:609] Failed to read file <frozen os>
Throughput: 12.45 requests/s, 12758.11 total tokens/s, 12.45 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512


─── STDERR ───
[2026-01-26 06:11:58] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 06:11:58] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:11:58] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 06:11:58] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:11:58] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:11:58] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:11:58] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:11:58] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:11:58] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:11:58] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 06:11:58] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 06:11:58] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 06:11:58] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 06:11:58] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 06:12:06] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 06:12:06] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:12:06] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 06:12:06] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:12:06] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:12:06] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:12:06] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:12:06] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:12:06] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:12:06] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 06:12:06] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 06:12:06] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 06:12:06] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 06:12:06] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=273874) [2026-01-26 06:12:08] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=273874) [2026-01-26 06:12:08] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=273874) [2026-01-26 06:12:08] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=273874) [2026-01-26 06:12:08] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=273874) [2026-01-26 06:12:08] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=273874) [2026-01-26 06:12:08] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=273874) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=273874) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:01<00:04,  1.38s/it]
(EngineCore_DP0 pid=273874) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:02<00:02,  1.35s/it]
(EngineCore_DP0 pid=273874) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:03<00:00,  1.09it/s]
(EngineCore_DP0 pid=273874) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.09s/it]
(EngineCore_DP0 pid=273874) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.12s/it]
(EngineCore_DP0 pid=273874) 
(EngineCore_DP0 pid=273874) [2026-01-26 06:12:13] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 7680] -> 1D uint8
(EngineCore_DP0 pid=273874) [2026-01-26 06:12:13] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 41287680 bytes
(EngineCore_DP0 pid=273874) [2026-01-26 06:12:13] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 7680] -> 1D uint8
(EngineCore_DP0 pid=273874) [2026-01-26 06:12:13] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 29491200 bytes
(EngineCore_DP0 pid=273874) [2026-01-26 06:12:13] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 7680] -> 1D uint8
(EngineCore_DP0 pid=273874) [2026-01-26 06:12:13] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 159252480 bytes
(EngineCore_DP0 pid=273874) [2026-01-26 06:12:13] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 20736] -> 1D uint8
(EngineCore_DP0 pid=273874) [2026-01-26 06:12:13] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 79626240 bytes
(EngineCore_DP0 pid=273874) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  25%|██▌       | 1/4 [00:00<00:01,  2.74it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 2/4 [00:00<00:00,  3.13it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  75%|███████▌  | 3/4 [00:00<00:00,  3.88it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:01<00:00,  4.11it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:01<00:00,  3.78it/s]
(EngineCore_DP0 pid=273874) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  33%|███▎      | 1/3 [00:00<00:00,  4.59it/s]
Capturing CUDA graphs (decode, FULL):  67%|██████▋   | 2/3 [00:00<00:00,  5.00it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  4.71it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00,  4.74it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   5%|▍         | 24/512 [00:00<00:02, 234.94it/s]
Adding requests:  10%|▉         | 50/512 [00:00<00:01, 244.99it/s]
Adding requests:  15%|█▌        | 78/512 [00:00<00:01, 256.28it/s]
Adding requests:  20%|██        | 104/512 [00:00<00:01, 248.76it/s]
Adding requests:  25%|██▌       | 130/512 [00:00<00:01, 251.50it/s]
Adding requests:  30%|███       | 156/512 [00:00<00:01, 253.86it/s]
Adding requests:  36%|███▌      | 182/512 [00:00<00:01, 251.82it/s]
Adding requests:  41%|████      | 209/512 [00:00<00:01, 256.43it/s]
Adding requests:  46%|████▌     | 235/512 [00:00<00:01, 256.94it/s]
Adding requests:  51%|█████     | 261/512 [00:01<00:00, 251.68it/s]
Adding requests:  56%|█████▌    | 287/512 [00:01<00:00, 253.61it/s]
Adding requests:  61%|██████▏   | 314/512 [00:01<00:00, 258.20it/s]
Adding requests:  67%|██████▋   | 341/512 [00:01<00:00, 259.70it/s]
Adding requests:  72%|███████▏  | 367/512 [00:01<00:00, 258.96it/s]
Adding requests:  77%|███████▋  | 394/512 [00:01<00:00, 261.69it/s]
Adding requests:  82%|████████▏ | 422/512 [00:01<00:00, 265.27it/s]
Adding requests:  88%|████████▊ | 449/512 [00:01<00:00, 259.01it/s]
Adding requests:  93%|█████████▎| 477/512 [00:01<00:00, 264.41it/s]
Adding requests:  99%|█████████▉| 506/512 [00:01<00:00, 270.19it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 258.58it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   4%|▍         | 22/512 [00:00<00:04, 107.25it/s, est. speed input: 109843.28 toks/s, output: 107.26 toks/s]
Processed prompts:   6%|▋         | 33/512 [00:00<00:14, 33.95it/s, est. speed input: 40265.28 toks/s, output: 39.32 toks/s]   
Processed prompts:   8%|▊         | 39/512 [00:01<00:22, 20.77it/s, est. speed input: 27100.85 toks/s, output: 26.47 toks/s]
Processed prompts:   8%|▊         | 43/512 [00:01<00:25, 18.50it/s, est. speed input: 24589.58 toks/s, output: 24.01 toks/s]
Processed prompts:   9%|▉         | 46/512 [00:02<00:29, 15.94it/s, est. speed input: 22348.81 toks/s, output: 21.82 toks/s]
Processed prompts:  10%|▉         | 50/512 [00:02<00:30, 14.97it/s, est. speed input: 21112.61 toks/s, output: 20.62 toks/s]
Processed prompts:  11%|█         | 54/512 [00:02<00:32, 14.29it/s, est. speed input: 20166.46 toks/s, output: 19.69 toks/s]
Processed prompts:  11%|█▏        | 58/512 [00:03<00:32, 13.79it/s, est. speed input: 19414.36 toks/s, output: 18.96 toks/s]
Processed prompts:  12%|█▏        | 62/512 [00:03<00:33, 13.44it/s, est. speed input: 18800.44 toks/s, output: 18.36 toks/s]
Processed prompts:  13%|█▎        | 66/512 [00:03<00:33, 13.19it/s, est. speed input: 18294.38 toks/s, output: 17.87 toks/s]
Processed prompts:  14%|█▎        | 70/512 [00:04<00:33, 13.02it/s, est. speed input: 17868.24 toks/s, output: 17.45 toks/s]
Processed prompts:  18%|█▊        | 90/512 [00:04<00:12, 33.24it/s, est. speed input: 22154.61 toks/s, output: 21.64 toks/s]
Processed prompts:  19%|█▉        | 96/512 [00:04<00:14, 28.39it/s, est. speed input: 21952.83 toks/s, output: 21.44 toks/s]
Processed prompts:  20%|█▉        | 101/512 [00:04<00:16, 24.30it/s, est. speed input: 21568.48 toks/s, output: 21.06 toks/s]
Processed prompts:  21%|██        | 105/512 [00:05<00:19, 20.59it/s, est. speed input: 21029.86 toks/s, output: 20.54 toks/s]
Processed prompts:  21%|██        | 108/512 [00:05<00:23, 17.12it/s, est. speed input: 20367.51 toks/s, output: 19.89 toks/s]
Processed prompts:  22%|██▏       | 111/512 [00:05<00:27, 14.75it/s, est. speed input: 19775.24 toks/s, output: 19.31 toks/s]
Processed prompts:  22%|██▏       | 114/512 [00:06<00:30, 13.13it/s, est. speed input: 19245.81 toks/s, output: 18.79 toks/s]
Processed prompts:  23%|██▎       | 118/512 [00:06<00:30, 12.96it/s, est. speed input: 18928.12 toks/s, output: 18.48 toks/s]
Processed prompts:  24%|██▍       | 122/512 [00:06<00:30, 12.85it/s, est. speed input: 18642.22 toks/s, output: 18.21 toks/s]
Processed prompts:  25%|██▍       | 126/512 [00:07<00:30, 12.76it/s, est. speed input: 18379.89 toks/s, output: 17.95 toks/s]
Processed prompts:  25%|██▌       | 130/512 [00:07<00:30, 12.71it/s, est. speed input: 18141.44 toks/s, output: 17.72 toks/s]
Processed prompts:  26%|██▌       | 134/512 [00:07<00:29, 12.67it/s, est. speed input: 17922.76 toks/s, output: 17.50 toks/s]
Processed prompts:  27%|██▋       | 138/512 [00:07<00:29, 12.63it/s, est. speed input: 17720.39 toks/s, output: 17.31 toks/s]
Processed prompts:  28%|██▊       | 142/512 [00:08<00:29, 12.61it/s, est. speed input: 17533.54 toks/s, output: 17.12 toks/s]
Processed prompts:  29%|██▊       | 146/512 [00:08<00:29, 12.60it/s, est. speed input: 17361.64 toks/s, output: 16.95 toks/s]
Processed prompts:  29%|██▉       | 150/512 [00:08<00:28, 12.59it/s, est. speed input: 17201.21 toks/s, output: 16.80 toks/s]
Processed prompts:  30%|███       | 154/512 [00:09<00:28, 12.58it/s, est. speed input: 17051.80 toks/s, output: 16.65 toks/s]
Processed prompts:  31%|███       | 158/512 [00:09<00:28, 12.57it/s, est. speed input: 16912.36 toks/s, output: 16.52 toks/s]
Processed prompts:  32%|███▏      | 162/512 [00:09<00:27, 12.56it/s, est. speed input: 16780.80 toks/s, output: 16.39 toks/s]
Processed prompts:  32%|███▏      | 166/512 [00:10<00:27, 12.56it/s, est. speed input: 16657.97 toks/s, output: 16.27 toks/s]
Processed prompts:  33%|███▎      | 170/512 [00:10<00:27, 12.55it/s, est. speed input: 16542.24 toks/s, output: 16.15 toks/s]
Processed prompts:  34%|███▍      | 174/512 [00:10<00:26, 12.55it/s, est. speed input: 16432.93 toks/s, output: 16.05 toks/s]
Processed prompts:  35%|███▍      | 178/512 [00:11<00:26, 12.54it/s, est. speed input: 16329.83 toks/s, output: 15.95 toks/s]
Processed prompts:  36%|███▌      | 182/512 [00:11<00:26, 12.54it/s, est. speed input: 16233.11 toks/s, output: 15.85 toks/s]
Processed prompts:  36%|███▋      | 186/512 [00:11<00:26, 12.54it/s, est. speed input: 16140.80 toks/s, output: 15.76 toks/s]
Processed prompts:  37%|███▋      | 190/512 [00:12<00:25, 12.54it/s, est. speed input: 16053.74 toks/s, output: 15.68 toks/s]
Processed prompts:  38%|███▊      | 194/512 [00:12<00:25, 12.53it/s, est. speed input: 15970.68 toks/s, output: 15.60 toks/s]
Processed prompts:  39%|███▊      | 198/512 [00:12<00:25, 12.53it/s, est. speed input: 15891.80 toks/s, output: 15.52 toks/s]
Processed prompts:  39%|███▉      | 202/512 [00:13<00:24, 12.52it/s, est. speed input: 15816.14 toks/s, output: 15.45 toks/s]
Processed prompts:  40%|████      | 206/512 [00:13<00:24, 12.52it/s, est. speed input: 15744.92 toks/s, output: 15.38 toks/s]
Processed prompts:  41%|████      | 210/512 [00:13<00:24, 12.52it/s, est. speed input: 15676.55 toks/s, output: 15.31 toks/s]
Processed prompts:  42%|████▏     | 214/512 [00:14<00:23, 12.52it/s, est. speed input: 15611.23 toks/s, output: 15.25 toks/s]
Processed prompts:  43%|████▎     | 218/512 [00:14<00:23, 12.51it/s, est. speed input: 15548.21 toks/s, output: 15.18 toks/s]
Processed prompts:  43%|████▎     | 222/512 [00:14<00:23, 12.51it/s, est. speed input: 15488.42 toks/s, output: 15.13 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:14<00:22, 12.51it/s, est. speed input: 15431.25 toks/s, output: 15.07 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:15<00:22, 12.50it/s, est. speed input: 15376.10 toks/s, output: 15.02 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:15<00:22, 12.50it/s, est. speed input: 15323.37 toks/s, output: 14.96 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:15<00:21, 12.50it/s, est. speed input: 15272.42 toks/s, output: 14.91 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:16<00:21, 12.49it/s, est. speed input: 15223.24 toks/s, output: 14.87 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:16<00:21, 12.49it/s, est. speed input: 15176.15 toks/s, output: 14.82 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:16<00:20, 12.49it/s, est. speed input: 15130.85 toks/s, output: 14.78 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:17<00:20, 12.48it/s, est. speed input: 15086.73 toks/s, output: 14.73 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:17<00:20, 12.48it/s, est. speed input: 15044.44 toks/s, output: 14.69 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:17<00:20, 12.47it/s, est. speed input: 15003.53 toks/s, output: 14.65 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:18<00:19, 12.47it/s, est. speed input: 14963.93 toks/s, output: 14.61 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:18<00:19, 12.47it/s, est. speed input: 14925.71 toks/s, output: 14.58 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:18<00:19, 12.47it/s, est. speed input: 14888.86 toks/s, output: 14.54 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:19<00:18, 12.47it/s, est. speed input: 14853.43 toks/s, output: 14.51 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:19<00:18, 12.46it/s, est. speed input: 14818.92 toks/s, output: 14.47 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:19<00:18, 12.46it/s, est. speed input: 14785.56 toks/s, output: 14.44 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:20<00:17, 12.46it/s, est. speed input: 14753.16 toks/s, output: 14.41 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:20<00:17, 12.46it/s, est. speed input: 14721.91 toks/s, output: 14.38 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:20<00:17, 12.46it/s, est. speed input: 14691.42 toks/s, output: 14.35 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:21<00:16, 12.46it/s, est. speed input: 14662.10 toks/s, output: 14.32 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:21<00:16, 12.46it/s, est. speed input: 14633.80 toks/s, output: 14.29 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:21<00:16, 12.47it/s, est. speed input: 14606.40 toks/s, output: 14.26 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:22<00:15, 12.47it/s, est. speed input: 14579.73 toks/s, output: 14.24 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:22<00:15, 12.47it/s, est. speed input: 14553.59 toks/s, output: 14.21 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:22<00:15, 12.46it/s, est. speed input: 14527.97 toks/s, output: 14.19 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:23<00:14, 12.46it/s, est. speed input: 14503.40 toks/s, output: 14.16 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:23<00:14, 12.46it/s, est. speed input: 14479.35 toks/s, output: 14.14 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:23<00:14, 12.46it/s, est. speed input: 14455.95 toks/s, output: 14.12 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:23<00:13, 12.46it/s, est. speed input: 14433.05 toks/s, output: 14.09 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:24<00:13, 12.46it/s, est. speed input: 14410.97 toks/s, output: 14.07 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:24<00:13, 12.46it/s, est. speed input: 14389.45 toks/s, output: 14.05 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:24<00:13, 12.46it/s, est. speed input: 14368.46 toks/s, output: 14.03 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:25<00:12, 12.46it/s, est. speed input: 14348.02 toks/s, output: 14.01 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:25<00:12, 12.46it/s, est. speed input: 14328.05 toks/s, output: 13.99 toks/s]
Processed prompts:  71%|███████   | 362/512 [00:25<00:12, 12.46it/s, est. speed input: 14308.44 toks/s, output: 13.97 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:26<00:11, 12.45it/s, est. speed input: 14289.38 toks/s, output: 13.95 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [00:26<00:11, 12.45it/s, est. speed input: 14270.67 toks/s, output: 13.94 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [00:26<00:11, 12.45it/s, est. speed input: 14252.68 toks/s, output: 13.92 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [00:27<00:10, 12.46it/s, est. speed input: 14235.01 toks/s, output: 13.90 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [00:27<00:10, 12.46it/s, est. speed input: 14217.73 toks/s, output: 13.88 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [00:27<00:10, 12.46it/s, est. speed input: 14200.86 toks/s, output: 13.87 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [00:28<00:09, 12.46it/s, est. speed input: 14184.43 toks/s, output: 13.85 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [00:28<00:09, 12.46it/s, est. speed input: 14168.23 toks/s, output: 13.84 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [00:28<00:09, 12.46it/s, est. speed input: 14152.54 toks/s, output: 13.82 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [00:29<00:08, 12.46it/s, est. speed input: 14137.16 toks/s, output: 13.81 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [00:29<00:08, 12.46it/s, est. speed input: 14122.04 toks/s, output: 13.79 toks/s]
Processed prompts:  80%|████████  | 410/512 [00:29<00:08, 12.45it/s, est. speed input: 14107.21 toks/s, output: 13.78 toks/s]
Processed prompts:  81%|████████  | 414/512 [00:30<00:07, 12.46it/s, est. speed input: 14092.86 toks/s, output: 13.76 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [00:30<00:07, 12.46it/s, est. speed input: 14078.87 toks/s, output: 13.75 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [00:30<00:07, 12.46it/s, est. speed input: 14065.15 toks/s, output: 13.74 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [00:31<00:06, 12.46it/s, est. speed input: 14051.49 toks/s, output: 13.72 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [00:31<00:06, 12.46it/s, est. speed input: 14038.34 toks/s, output: 13.71 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [00:31<00:06, 12.46it/s, est. speed input: 14025.25 toks/s, output: 13.70 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [00:32<00:05, 12.45it/s, est. speed input: 14012.28 toks/s, output: 13.68 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [00:32<00:05, 12.45it/s, est. speed input: 13999.73 toks/s, output: 13.67 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [00:32<00:05, 12.45it/s, est. speed input: 13987.39 toks/s, output: 13.66 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [00:32<00:04, 12.45it/s, est. speed input: 13975.26 toks/s, output: 13.65 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [00:33<00:04, 12.45it/s, est. speed input: 13963.43 toks/s, output: 13.64 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [00:33<00:04, 12.45it/s, est. speed input: 13951.85 toks/s, output: 13.62 toks/s]
Processed prompts:  90%|█████████ | 462/512 [00:33<00:04, 12.45it/s, est. speed input: 13940.57 toks/s, output: 13.61 toks/s]
Processed prompts:  91%|█████████ | 466/512 [00:34<00:03, 12.45it/s, est. speed input: 13929.48 toks/s, output: 13.60 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [00:34<00:03, 12.45it/s, est. speed input: 13918.52 toks/s, output: 13.59 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [00:34<00:03, 12.46it/s, est. speed input: 13907.87 toks/s, output: 13.58 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [00:35<00:00, 31.40it/s, est. speed input: 14418.26 toks/s, output: 14.08 toks/s]
Processed prompts:  97%|█████████▋| 499/512 [00:35<00:00, 26.15it/s, est. speed input: 14431.56 toks/s, output: 14.09 toks/s]
Processed prompts:  98%|█████████▊| 503/512 [00:35<00:00, 21.78it/s, est. speed input: 14416.61 toks/s, output: 14.08 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [00:36<00:00, 17.87it/s, est. speed input: 14373.28 toks/s, output: 14.04 toks/s]
Processed prompts: 100%|█████████▉| 510/512 [00:36<00:00, 17.50it/s, est. speed input: 14389.64 toks/s, output: 14.05 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:36<00:00, 17.50it/s, est. speed input: 14445.98 toks/s, output: 14.11 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:36<00:00, 14.11it/s, est. speed input: 14445.98 toks/s, output: 14.11 toks/s]
[rank0]:[W126 06:13:29.724748810 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 103.5s

测试结果:
  Requests/s:   12.45
  Tokens/s:     12758.11
  Total Reqs:   512
  Elapsed:      41.13s

  [Prefill 分析]
  Total Prefill Tokens: 524288
  Prefill Tokens/s:     12745.66

============================================================
[5/8] 测试 M=8192
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-14B-INT8                                │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 8192
│   M_prefill     = 8192 (= 8 x 1024)
│   M_decode      = 8
│   batched_tokens = 8192 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 1024
│   --max-num-seqs           = 8
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 8192
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 06:13:47 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 06:13:48 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=275605) WARNING 01-26 06:13:56 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=275605) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=275605) WARNING 01-26 06:14:15 [backends.py:609] Failed to read file <frozen os>
Throughput: 12.43 requests/s, 12742.24 total tokens/s, 12.43 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024


─── STDERR ───
[2026-01-26 06:13:47] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 06:13:47] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:13:47] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 06:13:47] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:13:47] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:13:47] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:13:47] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:13:47] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:13:47] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:13:47] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 06:13:47] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 06:13:47] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 06:13:47] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 06:13:47] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 06:13:55] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 06:13:55] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:13:55] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 06:13:55] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:13:55] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:13:55] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:13:55] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:13:55] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:13:55] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:13:55] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 06:13:55] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 06:13:55] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 06:13:55] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 06:13:55] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=275605) [2026-01-26 06:13:56] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=275605) [2026-01-26 06:13:56] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=275605) [2026-01-26 06:13:56] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=275605) [2026-01-26 06:13:56] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=275605) [2026-01-26 06:13:56] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=275605) [2026-01-26 06:13:56] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=275605) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=275605) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:01<00:04,  1.36s/it]
(EngineCore_DP0 pid=275605) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:01<00:00,  2.01it/s]
(EngineCore_DP0 pid=275605) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.23it/s]
(EngineCore_DP0 pid=275605) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.26it/s]
(EngineCore_DP0 pid=275605) 
(EngineCore_DP0 pid=275605) [2026-01-26 06:14:00] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 7680] -> 1D uint8
(EngineCore_DP0 pid=275605) [2026-01-26 06:14:00] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 41287680 bytes
(EngineCore_DP0 pid=275605) [2026-01-26 06:14:00] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 7680] -> 1D uint8
(EngineCore_DP0 pid=275605) [2026-01-26 06:14:00] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 29491200 bytes
(EngineCore_DP0 pid=275605) [2026-01-26 06:14:00] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 7680] -> 1D uint8
(EngineCore_DP0 pid=275605) [2026-01-26 06:14:00] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 159252480 bytes
(EngineCore_DP0 pid=275605) [2026-01-26 06:14:00] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 20736] -> 1D uint8
(EngineCore_DP0 pid=275605) [2026-01-26 06:14:00] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 79626240 bytes
(EngineCore_DP0 pid=275605) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:00,  4.93it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  40%|████      | 2/5 [00:00<00:00,  5.07it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  60%|██████    | 3/5 [00:00<00:00,  5.20it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  80%|████████  | 4/5 [00:00<00:00,  5.24it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00,  5.06it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00,  5.10it/s]
(EngineCore_DP0 pid=275605) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:00,  4.53it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 2/4 [00:00<00:00,  5.07it/s]
Capturing CUDA graphs (decode, FULL):  75%|███████▌  | 3/4 [00:00<00:00,  3.66it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  4.05it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00,  4.11it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 24/1024 [00:00<00:04, 236.01it/s]
Adding requests:   5%|▍         | 49/1024 [00:00<00:04, 242.73it/s]
Adding requests:   7%|▋         | 76/1024 [00:00<00:03, 252.45it/s]
Adding requests:  10%|▉         | 102/1024 [00:00<00:03, 250.42it/s]
Adding requests:  12%|█▎        | 128/1024 [00:00<00:03, 245.38it/s]
Adding requests:  15%|█▌        | 154/1024 [00:00<00:03, 247.13it/s]
Adding requests:  18%|█▊        | 180/1024 [00:00<00:03, 250.50it/s]
Adding requests:  20%|██        | 208/1024 [00:00<00:03, 257.08it/s]
Adding requests:  23%|██▎       | 235/1024 [00:00<00:03, 260.92it/s]
Adding requests:  26%|██▌       | 262/1024 [00:01<00:02, 256.25it/s]
Adding requests:  28%|██▊       | 288/1024 [00:01<00:02, 256.79it/s]
Adding requests:  31%|███       | 314/1024 [00:01<00:02, 257.19it/s]
Adding requests:  33%|███▎      | 340/1024 [00:01<00:02, 253.51it/s]
Adding requests:  36%|███▌      | 366/1024 [00:01<00:02, 254.45it/s]
Adding requests:  38%|███▊      | 393/1024 [00:01<00:02, 256.47it/s]
Adding requests:  41%|████      | 421/1024 [00:01<00:02, 259.92it/s]
Adding requests:  44%|████▎     | 447/1024 [00:01<00:02, 254.74it/s]
Adding requests:  47%|████▋     | 477/1024 [00:01<00:02, 266.20it/s]
Adding requests:  49%|████▉     | 505/1024 [00:01<00:01, 269.94it/s]
Adding requests:  52%|█████▏    | 533/1024 [00:02<00:01, 271.48it/s]
Adding requests:  55%|█████▍    | 561/1024 [00:02<00:01, 270.21it/s]
Adding requests:  58%|█████▊    | 589/1024 [00:02<00:01, 264.75it/s]
Adding requests:  60%|██████    | 616/1024 [00:02<00:01, 261.17it/s]
Adding requests:  63%|██████▎   | 643/1024 [00:02<00:01, 258.76it/s]
Adding requests:  65%|██████▌   | 669/1024 [00:02<00:01, 256.10it/s]
Adding requests:  68%|██████▊   | 696/1024 [00:02<00:01, 258.62it/s]
Adding requests:  71%|███████   | 722/1024 [00:02<00:01, 257.14it/s]
Adding requests:  73%|███████▎  | 748/1024 [00:02<00:01, 254.35it/s]
Adding requests:  76%|███████▌  | 775/1024 [00:03<00:00, 256.18it/s]
Adding requests:  78%|███████▊  | 802/1024 [00:03<00:00, 257.29it/s]
Adding requests:  81%|████████  | 830/1024 [00:03<00:00, 262.38it/s]
Adding requests:  84%|████████▎ | 857/1024 [00:03<00:00, 260.60it/s]
Adding requests:  86%|████████▋ | 884/1024 [00:03<00:00, 260.01it/s]
Adding requests:  89%|████████▉ | 911/1024 [00:03<00:00, 261.71it/s]
Adding requests:  92%|█████████▏| 938/1024 [00:03<00:00, 254.22it/s]
Adding requests:  94%|█████████▍| 964/1024 [00:03<00:00, 254.61it/s]
Adding requests:  97%|█████████▋| 990/1024 [00:03<00:00, 253.10it/s]
Adding requests:  99%|█████████▉| 1016/1024 [00:03<00:00, 249.50it/s]
Adding requests: 100%|██████████| 1024/1024 [00:03<00:00, 256.76it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   4%|▍         | 46/1024 [00:00<00:04, 220.07it/s, est. speed input: 225388.41 toks/s, output: 220.08 toks/s]
Processed prompts:   7%|▋         | 69/1024 [00:01<00:30, 31.74it/s, est. speed input: 39213.29 toks/s, output: 38.29 toks/s]   
Processed prompts:   8%|▊         | 79/1024 [00:02<00:42, 22.37it/s, est. speed input: 29326.42 toks/s, output: 28.64 toks/s]
Processed prompts:   8%|▊         | 85/1024 [00:03<00:43, 21.76it/s, est. speed input: 28283.78 toks/s, output: 27.62 toks/s]
Processed prompts:   9%|▉         | 90/1024 [00:03<00:54, 17.14it/s, est. speed input: 24803.02 toks/s, output: 24.22 toks/s]
Processed prompts:   9%|▉         | 94/1024 [00:04<00:57, 16.26it/s, est. speed input: 23856.84 toks/s, output: 23.30 toks/s]
Processed prompts:  10%|▉         | 98/1024 [00:04<00:59, 15.46it/s, est. speed input: 23048.18 toks/s, output: 22.51 toks/s]
Processed prompts:  10%|▉         | 102/1024 [00:04<01:02, 14.77it/s, est. speed input: 22350.55 toks/s, output: 21.83 toks/s]
Processed prompts:  10%|█         | 106/1024 [00:04<01:04, 14.21it/s, est. speed input: 21742.02 toks/s, output: 21.23 toks/s]
Processed prompts:  11%|█         | 110/1024 [00:05<01:06, 13.77it/s, est. speed input: 21206.56 toks/s, output: 20.71 toks/s]
Processed prompts:  11%|█         | 114/1024 [00:05<01:07, 13.43it/s, est. speed input: 20732.93 toks/s, output: 20.25 toks/s]
Processed prompts:  12%|█▏        | 118/1024 [00:05<01:08, 13.18it/s, est. speed input: 20309.41 toks/s, output: 19.83 toks/s]
Processed prompts:  12%|█▏        | 122/1024 [00:06<01:09, 12.99it/s, est. speed input: 19928.83 toks/s, output: 19.46 toks/s]
Processed prompts:  12%|█▏        | 126/1024 [00:06<01:09, 12.86it/s, est. speed input: 19584.54 toks/s, output: 19.13 toks/s]
Processed prompts:  13%|█▎        | 130/1024 [00:06<01:10, 12.76it/s, est. speed input: 19271.85 toks/s, output: 18.82 toks/s]
Processed prompts:  13%|█▎        | 134/1024 [00:07<01:10, 12.69it/s, est. speed input: 18986.28 toks/s, output: 18.54 toks/s]
Processed prompts:  13%|█▎        | 138/1024 [00:07<01:10, 12.64it/s, est. speed input: 18725.11 toks/s, output: 18.29 toks/s]
Processed prompts:  14%|█▍        | 142/1024 [00:07<01:09, 12.60it/s, est. speed input: 18484.94 toks/s, output: 18.05 toks/s]
Processed prompts:  14%|█▍        | 146/1024 [00:08<01:09, 12.57it/s, est. speed input: 18263.14 toks/s, output: 17.84 toks/s]
Processed prompts:  15%|█▍        | 150/1024 [00:08<01:09, 12.55it/s, est. speed input: 18058.21 toks/s, output: 17.63 toks/s]
Processed prompts:  15%|█▌        | 154/1024 [00:08<01:09, 12.54it/s, est. speed input: 17867.75 toks/s, output: 17.45 toks/s]
Processed prompts:  15%|█▌        | 158/1024 [00:09<01:09, 12.52it/s, est. speed input: 17690.01 toks/s, output: 17.28 toks/s]
Processed prompts:  16%|█▌        | 162/1024 [00:09<01:08, 12.51it/s, est. speed input: 17523.45 toks/s, output: 17.11 toks/s]
Processed prompts:  16%|█▌        | 166/1024 [00:09<01:08, 12.50it/s, est. speed input: 17368.23 toks/s, output: 16.96 toks/s]
Processed prompts:  17%|█▋        | 170/1024 [00:10<01:08, 12.50it/s, est. speed input: 17222.88 toks/s, output: 16.82 toks/s]
Processed prompts:  17%|█▋        | 174/1024 [00:10<01:08, 12.49it/s, est. speed input: 17086.40 toks/s, output: 16.69 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [00:10<01:07, 12.49it/s, est. speed input: 16957.94 toks/s, output: 16.56 toks/s]
Processed prompts:  18%|█▊        | 182/1024 [00:11<01:07, 12.49it/s, est. speed input: 16837.50 toks/s, output: 16.44 toks/s]
Processed prompts:  18%|█▊        | 186/1024 [00:11<01:07, 12.49it/s, est. speed input: 16723.48 toks/s, output: 16.33 toks/s]
Processed prompts:  19%|█▊        | 190/1024 [00:11<01:06, 12.49it/s, est. speed input: 16615.69 toks/s, output: 16.23 toks/s]
Processed prompts:  19%|█▉        | 194/1024 [00:12<01:06, 12.48it/s, est. speed input: 16512.90 toks/s, output: 16.13 toks/s]
Processed prompts:  19%|█▉        | 198/1024 [00:12<01:06, 12.48it/s, est. speed input: 16415.61 toks/s, output: 16.03 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [00:12<01:05, 12.47it/s, est. speed input: 16322.79 toks/s, output: 15.94 toks/s]
Processed prompts:  20%|██        | 206/1024 [00:12<01:05, 12.47it/s, est. speed input: 16234.94 toks/s, output: 15.85 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:13<01:05, 12.47it/s, est. speed input: 16151.80 toks/s, output: 15.77 toks/s]
Processed prompts:  21%|██        | 214/1024 [00:13<01:04, 12.48it/s, est. speed input: 16073.17 toks/s, output: 15.70 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [00:13<01:04, 12.48it/s, est. speed input: 15997.80 toks/s, output: 15.62 toks/s]
Processed prompts:  22%|██▏       | 222/1024 [00:14<01:04, 12.48it/s, est. speed input: 15925.52 toks/s, output: 15.55 toks/s]
Processed prompts:  22%|██▏       | 226/1024 [00:14<01:03, 12.48it/s, est. speed input: 15856.62 toks/s, output: 15.48 toks/s]
Processed prompts:  22%|██▏       | 230/1024 [00:14<01:03, 12.48it/s, est. speed input: 15790.61 toks/s, output: 15.42 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:15<01:03, 12.49it/s, est. speed input: 15727.66 toks/s, output: 15.36 toks/s]
Processed prompts:  23%|██▎       | 238/1024 [00:15<01:02, 12.48it/s, est. speed input: 15666.78 toks/s, output: 15.30 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:15<01:02, 12.48it/s, est. speed input: 15608.62 toks/s, output: 15.24 toks/s]
Processed prompts:  24%|██▍       | 246/1024 [00:16<01:02, 12.48it/s, est. speed input: 15552.66 toks/s, output: 15.19 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:16<01:02, 12.48it/s, est. speed input: 15498.77 toks/s, output: 15.14 toks/s]
Processed prompts:  25%|██▍       | 254/1024 [00:16<01:01, 12.48it/s, est. speed input: 15446.73 toks/s, output: 15.08 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:17<01:01, 12.48it/s, est. speed input: 15396.73 toks/s, output: 15.04 toks/s]
Processed prompts:  26%|██▌       | 262/1024 [00:17<01:01, 12.48it/s, est. speed input: 15348.66 toks/s, output: 14.99 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:17<01:00, 12.48it/s, est. speed input: 15302.60 toks/s, output: 14.94 toks/s]
Processed prompts:  26%|██▋       | 270/1024 [00:18<01:00, 12.48it/s, est. speed input: 15257.63 toks/s, output: 14.90 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:18<01:00, 12.47it/s, est. speed input: 15214.40 toks/s, output: 14.86 toks/s]
Processed prompts:  27%|██▋       | 278/1024 [00:18<00:59, 12.48it/s, est. speed input: 15172.86 toks/s, output: 14.82 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:18<00:22, 32.23it/s, est. speed input: 16125.06 toks/s, output: 15.75 toks/s]
Processed prompts:  30%|██▉       | 303/1024 [00:19<00:27, 26.66it/s, est. speed input: 16122.58 toks/s, output: 15.74 toks/s]
Processed prompts:  30%|██▉       | 307/1024 [00:19<00:32, 22.08it/s, est. speed input: 16067.87 toks/s, output: 15.69 toks/s]
Processed prompts:  30%|███       | 310/1024 [00:19<00:39, 18.06it/s, est. speed input: 15963.54 toks/s, output: 15.59 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:20<00:43, 16.33it/s, est. speed input: 15913.23 toks/s, output: 15.54 toks/s]
Processed prompts:  31%|███       | 318/1024 [00:20<00:46, 15.14it/s, est. speed input: 15864.16 toks/s, output: 15.49 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:20<00:49, 14.32it/s, est. speed input: 15816.39 toks/s, output: 15.45 toks/s]
Processed prompts:  32%|███▏      | 326/1024 [00:21<00:50, 13.76it/s, est. speed input: 15770.36 toks/s, output: 15.40 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:21<00:51, 13.37it/s, est. speed input: 15725.60 toks/s, output: 15.36 toks/s]
Processed prompts:  33%|███▎      | 334/1024 [00:21<00:52, 13.10it/s, est. speed input: 15681.97 toks/s, output: 15.31 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:22<00:53, 12.91it/s, est. speed input: 15639.61 toks/s, output: 15.27 toks/s]
Processed prompts:  33%|███▎      | 342/1024 [00:22<00:53, 12.77it/s, est. speed input: 15598.55 toks/s, output: 15.23 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:22<00:53, 12.68it/s, est. speed input: 15558.58 toks/s, output: 15.19 toks/s]
Processed prompts:  34%|███▍      | 350/1024 [00:23<00:53, 12.61it/s, est. speed input: 15519.51 toks/s, output: 15.16 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:23<00:53, 12.57it/s, est. speed input: 15481.75 toks/s, output: 15.12 toks/s]
Processed prompts:  35%|███▍      | 358/1024 [00:23<00:53, 12.53it/s, est. speed input: 15444.78 toks/s, output: 15.08 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:24<00:52, 12.51it/s, est. speed input: 15408.88 toks/s, output: 15.05 toks/s]
Processed prompts:  36%|███▌      | 366/1024 [00:24<00:52, 12.49it/s, est. speed input: 15373.94 toks/s, output: 15.01 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:24<00:52, 12.48it/s, est. speed input: 15339.93 toks/s, output: 14.98 toks/s]
Processed prompts:  37%|███▋      | 374/1024 [00:25<00:52, 12.47it/s, est. speed input: 15306.61 toks/s, output: 14.95 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:25<00:51, 12.47it/s, est. speed input: 15274.24 toks/s, output: 14.92 toks/s]
Processed prompts:  37%|███▋      | 382/1024 [00:25<00:51, 12.47it/s, est. speed input: 15242.83 toks/s, output: 14.89 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:25<00:51, 12.46it/s, est. speed input: 15212.09 toks/s, output: 14.86 toks/s]
Processed prompts:  38%|███▊      | 390/1024 [00:26<00:50, 12.46it/s, est. speed input: 15182.06 toks/s, output: 14.83 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [00:26<00:50, 12.46it/s, est. speed input: 15152.80 toks/s, output: 14.80 toks/s]
Processed prompts:  39%|███▉      | 398/1024 [00:26<00:50, 12.46it/s, est. speed input: 15124.20 toks/s, output: 14.77 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:27<00:49, 12.46it/s, est. speed input: 15096.29 toks/s, output: 14.74 toks/s]
Processed prompts:  40%|███▉      | 406/1024 [00:27<00:49, 12.46it/s, est. speed input: 15069.15 toks/s, output: 14.72 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:27<00:49, 12.45it/s, est. speed input: 15042.34 toks/s, output: 14.69 toks/s]
Processed prompts:  40%|████      | 414/1024 [00:28<00:48, 12.46it/s, est. speed input: 15016.61 toks/s, output: 14.66 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:28<00:48, 12.46it/s, est. speed input: 14991.36 toks/s, output: 14.64 toks/s]
Processed prompts:  41%|████      | 422/1024 [00:28<00:48, 12.47it/s, est. speed input: 14966.81 toks/s, output: 14.62 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:29<00:48, 12.46it/s, est. speed input: 14942.06 toks/s, output: 14.59 toks/s]
Processed prompts:  42%|████▏     | 430/1024 [00:29<00:47, 12.46it/s, est. speed input: 14918.61 toks/s, output: 14.57 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:29<00:47, 12.46it/s, est. speed input: 14895.21 toks/s, output: 14.55 toks/s]
Processed prompts:  43%|████▎     | 438/1024 [00:30<00:47, 12.45it/s, est. speed input: 14872.06 toks/s, output: 14.52 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:30<00:46, 12.45it/s, est. speed input: 14849.89 toks/s, output: 14.50 toks/s]
Processed prompts:  44%|████▎     | 446/1024 [00:30<00:46, 12.46it/s, est. speed input: 14828.11 toks/s, output: 14.48 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:31<00:46, 12.45it/s, est. speed input: 14806.48 toks/s, output: 14.46 toks/s]
Processed prompts:  44%|████▍     | 454/1024 [00:31<00:45, 12.46it/s, est. speed input: 14785.80 toks/s, output: 14.44 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:31<00:45, 12.45it/s, est. speed input: 14765.08 toks/s, output: 14.42 toks/s]
Processed prompts:  45%|████▌     | 462/1024 [00:32<00:45, 12.44it/s, est. speed input: 14744.53 toks/s, output: 14.40 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:32<00:44, 12.46it/s, est. speed input: 14725.26 toks/s, output: 14.38 toks/s]
Processed prompts:  46%|████▌     | 470/1024 [00:32<00:44, 12.46it/s, est. speed input: 14706.10 toks/s, output: 14.36 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:33<00:44, 12.47it/s, est. speed input: 14687.65 toks/s, output: 14.34 toks/s]
Processed prompts:  47%|████▋     | 478/1024 [00:33<00:43, 12.47it/s, est. speed input: 14669.25 toks/s, output: 14.33 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:33<00:43, 12.48it/s, est. speed input: 14651.46 toks/s, output: 14.31 toks/s]
Processed prompts:  47%|████▋     | 486/1024 [00:34<00:43, 12.48it/s, est. speed input: 14633.88 toks/s, output: 14.29 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:34<00:42, 12.48it/s, est. speed input: 14616.58 toks/s, output: 14.27 toks/s]
Processed prompts:  48%|████▊     | 494/1024 [00:34<00:42, 12.48it/s, est. speed input: 14599.59 toks/s, output: 14.26 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:34<00:42, 12.48it/s, est. speed input: 14582.84 toks/s, output: 14.24 toks/s]
Processed prompts:  49%|████▉     | 502/1024 [00:35<00:41, 12.48it/s, est. speed input: 14566.41 toks/s, output: 14.22 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:35<00:41, 12.47it/s, est. speed input: 14549.96 toks/s, output: 14.21 toks/s]
Processed prompts:  50%|████▉     | 510/1024 [00:35<00:41, 12.47it/s, est. speed input: 14533.95 toks/s, output: 14.19 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:36<00:40, 12.47it/s, est. speed input: 14518.33 toks/s, output: 14.18 toks/s]
Processed prompts:  51%|█████     | 518/1024 [00:36<00:40, 12.46it/s, est. speed input: 14502.78 toks/s, output: 14.16 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:36<00:40, 12.46it/s, est. speed input: 14487.64 toks/s, output: 14.15 toks/s]
Processed prompts:  51%|█████▏    | 526/1024 [00:37<00:39, 12.46it/s, est. speed input: 14472.70 toks/s, output: 14.13 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:37<00:39, 12.46it/s, est. speed input: 14458.08 toks/s, output: 14.12 toks/s]
Processed prompts:  52%|█████▏    | 534/1024 [00:37<00:39, 12.46it/s, est. speed input: 14443.76 toks/s, output: 14.11 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:38<00:38, 12.46it/s, est. speed input: 14429.65 toks/s, output: 14.09 toks/s]
Processed prompts:  53%|█████▎    | 542/1024 [00:38<00:38, 12.47it/s, est. speed input: 14415.84 toks/s, output: 14.08 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:38<00:38, 12.47it/s, est. speed input: 14402.26 toks/s, output: 14.06 toks/s]
Processed prompts:  54%|█████▎    | 550/1024 [00:39<00:38, 12.47it/s, est. speed input: 14388.96 toks/s, output: 14.05 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:39<00:37, 12.47it/s, est. speed input: 14375.87 toks/s, output: 14.04 toks/s]
Processed prompts:  54%|█████▍    | 558/1024 [00:39<00:37, 12.48it/s, est. speed input: 14363.05 toks/s, output: 14.03 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:40<00:37, 12.48it/s, est. speed input: 14350.33 toks/s, output: 14.01 toks/s]
Processed prompts:  55%|█████▌    | 566/1024 [00:40<00:36, 12.47it/s, est. speed input: 14337.77 toks/s, output: 14.00 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:40<00:36, 12.48it/s, est. speed input: 14325.54 toks/s, output: 13.99 toks/s]
Processed prompts:  56%|█████▌    | 574/1024 [00:41<00:36, 12.48it/s, est. speed input: 14313.42 toks/s, output: 13.98 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:41<00:35, 12.47it/s, est. speed input: 14301.45 toks/s, output: 13.97 toks/s]
Processed prompts:  57%|█████▋    | 582/1024 [00:41<00:35, 12.48it/s, est. speed input: 14289.75 toks/s, output: 13.95 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:42<00:35, 12.48it/s, est. speed input: 14278.29 toks/s, output: 13.94 toks/s]
Processed prompts:  58%|█████▊    | 590/1024 [00:42<00:34, 12.48it/s, est. speed input: 14266.95 toks/s, output: 13.93 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:42<00:34, 12.47it/s, est. speed input: 14255.64 toks/s, output: 13.92 toks/s]
Processed prompts:  58%|█████▊    | 598/1024 [00:42<00:34, 12.47it/s, est. speed input: 14244.59 toks/s, output: 13.91 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:43<00:33, 12.47it/s, est. speed input: 14233.70 toks/s, output: 13.90 toks/s]
Processed prompts:  59%|█████▉    | 606/1024 [00:43<00:33, 12.48it/s, est. speed input: 14223.08 toks/s, output: 13.89 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:43<00:33, 12.48it/s, est. speed input: 14212.54 toks/s, output: 13.88 toks/s]
Processed prompts:  60%|█████▉    | 614/1024 [00:44<00:32, 12.48it/s, est. speed input: 14202.17 toks/s, output: 13.87 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:44<00:32, 12.48it/s, est. speed input: 14191.89 toks/s, output: 13.86 toks/s]
Processed prompts:  61%|██████    | 622/1024 [00:44<00:32, 12.48it/s, est. speed input: 14181.85 toks/s, output: 13.85 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:45<00:31, 12.48it/s, est. speed input: 14171.97 toks/s, output: 13.84 toks/s]
Processed prompts:  62%|██████▏   | 630/1024 [00:45<00:31, 12.47it/s, est. speed input: 14161.93 toks/s, output: 13.83 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:45<00:31, 12.47it/s, est. speed input: 14152.08 toks/s, output: 13.82 toks/s]
Processed prompts:  62%|██████▏   | 638/1024 [00:46<00:30, 12.46it/s, est. speed input: 14142.31 toks/s, output: 13.81 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:46<00:30, 12.46it/s, est. speed input: 14132.79 toks/s, output: 13.80 toks/s]
Processed prompts:  63%|██████▎   | 646/1024 [00:46<00:30, 12.46it/s, est. speed input: 14123.29 toks/s, output: 13.79 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:47<00:30, 12.46it/s, est. speed input: 14113.99 toks/s, output: 13.78 toks/s]
Processed prompts:  64%|██████▍   | 654/1024 [00:47<00:29, 12.46it/s, est. speed input: 14104.88 toks/s, output: 13.77 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:47<00:29, 12.46it/s, est. speed input: 14095.80 toks/s, output: 13.77 toks/s]
Processed prompts:  65%|██████▍   | 662/1024 [00:48<00:29, 12.46it/s, est. speed input: 14086.89 toks/s, output: 13.76 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:48<00:28, 12.46it/s, est. speed input: 14078.08 toks/s, output: 13.75 toks/s]
Processed prompts:  65%|██████▌   | 670/1024 [00:48<00:28, 12.46it/s, est. speed input: 14069.32 toks/s, output: 13.74 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:49<00:28, 12.46it/s, est. speed input: 14060.82 toks/s, output: 13.73 toks/s]
Processed prompts:  66%|██████▌   | 678/1024 [00:49<00:27, 12.46it/s, est. speed input: 14052.37 toks/s, output: 13.72 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:49<00:27, 12.46it/s, est. speed input: 14043.97 toks/s, output: 13.71 toks/s]
Processed prompts:  69%|██████▊   | 702/1024 [00:49<00:10, 31.03it/s, est. speed input: 14399.00 toks/s, output: 14.06 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:50<00:12, 24.97it/s, est. speed input: 14388.59 toks/s, output: 14.05 toks/s]
Processed prompts:  69%|██████▉   | 710/1024 [00:50<00:14, 20.99it/s, est. speed input: 14378.33 toks/s, output: 14.04 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:50<00:16, 18.33it/s, est. speed input: 14368.17 toks/s, output: 14.03 toks/s]
Processed prompts:  70%|███████   | 718/1024 [00:51<00:18, 16.52it/s, est. speed input: 14358.13 toks/s, output: 14.02 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:51<00:19, 15.28it/s, est. speed input: 14348.20 toks/s, output: 14.01 toks/s]
Processed prompts:  71%|███████   | 726/1024 [00:51<00:20, 14.43it/s, est. speed input: 14338.43 toks/s, output: 14.00 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:52<00:21, 13.83it/s, est. speed input: 14328.75 toks/s, output: 13.99 toks/s]
Processed prompts:  72%|███████▏  | 734/1024 [00:52<00:21, 13.42it/s, est. speed input: 14319.20 toks/s, output: 13.98 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:52<00:21, 13.14it/s, est. speed input: 14309.90 toks/s, output: 13.97 toks/s]
Processed prompts:  72%|███████▏  | 742/1024 [00:53<00:21, 12.94it/s, est. speed input: 14300.59 toks/s, output: 13.97 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:53<00:21, 12.80it/s, est. speed input: 14291.38 toks/s, output: 13.96 toks/s]
Processed prompts:  73%|███████▎  | 750/1024 [00:53<00:21, 12.69it/s, est. speed input: 14282.09 toks/s, output: 13.95 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:54<00:21, 12.62it/s, est. speed input: 14273.01 toks/s, output: 13.94 toks/s]
Processed prompts:  74%|███████▍  | 758/1024 [00:54<00:21, 12.56it/s, est. speed input: 14263.95 toks/s, output: 13.93 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:54<00:20, 12.53it/s, est. speed input: 14254.95 toks/s, output: 13.92 toks/s]
Processed prompts:  75%|███████▍  | 766/1024 [00:55<00:20, 12.51it/s, est. speed input: 14246.26 toks/s, output: 13.91 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:55<00:20, 12.49it/s, est. speed input: 14237.60 toks/s, output: 13.90 toks/s]
Processed prompts:  76%|███████▌  | 774/1024 [00:55<00:20, 12.48it/s, est. speed input: 14229.03 toks/s, output: 13.90 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:56<00:19, 12.48it/s, est. speed input: 14220.69 toks/s, output: 13.89 toks/s]
Processed prompts:  76%|███████▋  | 782/1024 [00:56<00:19, 12.47it/s, est. speed input: 14212.24 toks/s, output: 13.88 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:56<00:19, 12.46it/s, est. speed input: 14203.86 toks/s, output: 13.87 toks/s]
Processed prompts:  77%|███████▋  | 790/1024 [00:56<00:18, 12.46it/s, est. speed input: 14195.67 toks/s, output: 13.86 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:57<00:18, 12.45it/s, est. speed input: 14187.56 toks/s, output: 13.86 toks/s]
Processed prompts:  78%|███████▊  | 798/1024 [00:57<00:18, 12.45it/s, est. speed input: 14179.45 toks/s, output: 13.85 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:57<00:17, 12.45it/s, est. speed input: 14171.59 toks/s, output: 13.84 toks/s]
Processed prompts:  79%|███████▊  | 806/1024 [00:58<00:17, 12.45it/s, est. speed input: 14163.75 toks/s, output: 13.83 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:58<00:17, 12.45it/s, est. speed input: 14156.00 toks/s, output: 13.82 toks/s]
Processed prompts:  79%|███████▉  | 814/1024 [00:58<00:16, 12.45it/s, est. speed input: 14148.37 toks/s, output: 13.82 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:59<00:16, 12.45it/s, est. speed input: 14140.72 toks/s, output: 13.81 toks/s]
Processed prompts:  80%|████████  | 822/1024 [00:59<00:16, 12.45it/s, est. speed input: 14133.27 toks/s, output: 13.80 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:59<00:15, 12.45it/s, est. speed input: 14125.80 toks/s, output: 13.79 toks/s]
Processed prompts:  81%|████████  | 830/1024 [01:00<00:15, 12.45it/s, est. speed input: 14118.44 toks/s, output: 13.79 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [01:00<00:15, 12.45it/s, est. speed input: 14111.08 toks/s, output: 13.78 toks/s]
Processed prompts:  82%|████████▏ | 838/1024 [01:00<00:14, 12.44it/s, est. speed input: 14103.84 toks/s, output: 13.77 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [01:01<00:14, 12.45it/s, est. speed input: 14096.73 toks/s, output: 13.77 toks/s]
Processed prompts:  83%|████████▎ | 846/1024 [01:01<00:14, 12.45it/s, est. speed input: 14089.71 toks/s, output: 13.76 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [01:01<00:13, 12.45it/s, est. speed input: 14082.81 toks/s, output: 13.75 toks/s]
Processed prompts:  83%|████████▎ | 854/1024 [01:02<00:13, 12.46it/s, est. speed input: 14076.02 toks/s, output: 13.75 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [01:02<00:13, 12.46it/s, est. speed input: 14069.33 toks/s, output: 13.74 toks/s]
Processed prompts:  84%|████████▍ | 862/1024 [01:02<00:13, 12.46it/s, est. speed input: 14062.60 toks/s, output: 13.73 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [01:03<00:12, 12.46it/s, est. speed input: 14056.01 toks/s, output: 13.73 toks/s]
Processed prompts:  85%|████████▍ | 870/1024 [01:03<00:12, 12.47it/s, est. speed input: 14049.53 toks/s, output: 13.72 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [01:03<00:12, 12.47it/s, est. speed input: 14043.04 toks/s, output: 13.71 toks/s]
Processed prompts:  86%|████████▌ | 878/1024 [01:04<00:11, 12.47it/s, est. speed input: 14036.70 toks/s, output: 13.71 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [01:04<00:11, 12.47it/s, est. speed input: 14030.37 toks/s, output: 13.70 toks/s]
Processed prompts:  87%|████████▋ | 886/1024 [01:04<00:11, 12.47it/s, est. speed input: 14024.08 toks/s, output: 13.70 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [01:05<00:10, 12.46it/s, est. speed input: 14017.81 toks/s, output: 13.69 toks/s]
Processed prompts:  87%|████████▋ | 894/1024 [01:05<00:10, 12.47it/s, est. speed input: 14011.72 toks/s, output: 13.68 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [01:05<00:10, 12.47it/s, est. speed input: 14005.70 toks/s, output: 13.68 toks/s]
Processed prompts:  88%|████████▊ | 902/1024 [01:05<00:09, 12.47it/s, est. speed input: 13999.70 toks/s, output: 13.67 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [01:06<00:09, 12.47it/s, est. speed input: 13993.70 toks/s, output: 13.67 toks/s]
Processed prompts:  89%|████████▉ | 910/1024 [01:06<00:09, 12.46it/s, est. speed input: 13987.70 toks/s, output: 13.66 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [01:06<00:08, 12.46it/s, est. speed input: 13981.72 toks/s, output: 13.65 toks/s]
Processed prompts:  90%|████████▉ | 918/1024 [01:07<00:08, 12.46it/s, est. speed input: 13975.90 toks/s, output: 13.65 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [01:07<00:08, 12.46it/s, est. speed input: 13970.13 toks/s, output: 13.64 toks/s]
Processed prompts:  90%|█████████ | 926/1024 [01:07<00:07, 12.46it/s, est. speed input: 13964.39 toks/s, output: 13.64 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [01:08<00:07, 12.46it/s, est. speed input: 13958.79 toks/s, output: 13.63 toks/s]
Processed prompts:  91%|█████████ | 934/1024 [01:08<00:07, 12.46it/s, est. speed input: 13953.16 toks/s, output: 13.63 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [01:08<00:06, 12.46it/s, est. speed input: 13947.62 toks/s, output: 13.62 toks/s]
Processed prompts:  92%|█████████▏| 942/1024 [01:09<00:06, 12.46it/s, est. speed input: 13942.08 toks/s, output: 13.62 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [01:09<00:06, 12.46it/s, est. speed input: 13936.60 toks/s, output: 13.61 toks/s]
Processed prompts:  93%|█████████▎| 950/1024 [01:09<00:05, 12.46it/s, est. speed input: 13931.11 toks/s, output: 13.60 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [01:10<00:05, 12.45it/s, est. speed input: 13925.71 toks/s, output: 13.60 toks/s]
Processed prompts:  94%|█████████▎| 958/1024 [01:10<00:05, 12.46it/s, est. speed input: 13920.43 toks/s, output: 13.59 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [01:10<00:04, 12.46it/s, est. speed input: 13915.20 toks/s, output: 13.59 toks/s]
Processed prompts:  94%|█████████▍| 966/1024 [01:11<00:04, 12.46it/s, est. speed input: 13909.98 toks/s, output: 13.58 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [01:11<00:04, 12.46it/s, est. speed input: 13904.81 toks/s, output: 13.58 toks/s]
Processed prompts:  95%|█████████▌| 974/1024 [01:11<00:04, 12.46it/s, est. speed input: 13899.65 toks/s, output: 13.57 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [01:12<00:03, 12.45it/s, est. speed input: 13894.49 toks/s, output: 13.57 toks/s]
Processed prompts:  96%|█████████▌| 982/1024 [01:12<00:03, 12.45it/s, est. speed input: 13889.37 toks/s, output: 13.56 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [01:12<00:03, 12.45it/s, est. speed input: 13884.40 toks/s, output: 13.56 toks/s]
Processed prompts:  97%|█████████▋| 990/1024 [01:13<00:02, 12.45it/s, est. speed input: 13879.40 toks/s, output: 13.55 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [01:13<00:02, 12.45it/s, est. speed input: 13874.47 toks/s, output: 13.55 toks/s]
Processed prompts:  97%|█████████▋| 998/1024 [01:13<00:02, 12.46it/s, est. speed input: 13869.64 toks/s, output: 13.54 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [01:14<00:01, 12.46it/s, est. speed input: 13864.80 toks/s, output: 13.54 toks/s]
Processed prompts:  98%|█████████▊| 1006/1024 [01:14<00:01, 12.46it/s, est. speed input: 13860.07 toks/s, output: 13.54 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [01:14<00:01, 12.46it/s, est. speed input: 13855.33 toks/s, output: 13.53 toks/s]
Processed prompts:  99%|█████████▉| 1014/1024 [01:14<00:00, 12.46it/s, est. speed input: 13850.62 toks/s, output: 13.53 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [01:15<00:00, 12.46it/s, est. speed input: 13845.97 toks/s, output: 13.52 toks/s]
Processed prompts: 100%|█████████▉| 1022/1024 [01:15<00:00, 13.42it/s, est. speed input: 13855.40 toks/s, output: 13.53 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [01:15<00:00, 13.42it/s, est. speed input: 13882.47 toks/s, output: 13.56 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [01:15<00:00, 13.56it/s, est. speed input: 13882.47 toks/s, output: 13.56 toks/s]
[rank0]:[W126 06:15:57.155779310 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 148.8s

测试结果:
  Requests/s:   12.43
  Tokens/s:     12742.24
  Total Reqs:   1024
  Elapsed:      82.37s

  [Prefill 分析]
  Total Prefill Tokens: 1048576
  Prefill Tokens/s:     12729.81

============================================================
[6/8] 测试 M=16384
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-14B-INT8                                │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 16384
│   M_prefill     = 16384 (= 16 x 1024)
│   M_decode      = 16
│   batched_tokens = 16384 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 2048
│   --max-num-seqs           = 16
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 16384
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 06:16:22 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 06:16:23 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=278023) WARNING 01-26 06:16:32 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=278023) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=278023) WARNING 01-26 06:16:50 [backends.py:609] Failed to read file <frozen os>
(EngineCore_DP0 pid=278023) ERROR 01-26 06:17:10 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=278023) ERROR 01-26 06:17:10 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=278023) ERROR 01-26 06:17:10 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=278023) ERROR 01-26 06:17:10 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=278023) ERROR 01-26 06:17:10 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=278023) ERROR 01-26 06:17:10 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=278023) ERROR 01-26 06:17:10 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=278023) ERROR 01-26 06:17:10 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=278023) ERROR 01-26 06:17:10 [core.py:866]     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=278023) ERROR 01-26 06:17:10 [core.py:866]                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=278023) ERROR 01-26 06:17:10 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 248, in _initialize_kv_caches
(EngineCore_DP0 pid=278023) ERROR 01-26 06:17:10 [core.py:866]     kv_cache_configs = get_kv_cache_configs(
(EngineCore_DP0 pid=278023) ERROR 01-26 06:17:10 [core.py:866]                        ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=278023) ERROR 01-26 06:17:10 [core.py:866]   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 1340, in get_kv_cache_configs
(EngineCore_DP0 pid=278023) ERROR 01-26 06:17:10 [core.py:866]     check_enough_kv_cache_memory(
(EngineCore_DP0 pid=278023) ERROR 01-26 06:17:10 [core.py:866]   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 710, in check_enough_kv_cache_memory
(EngineCore_DP0 pid=278023) ERROR 01-26 06:17:10 [core.py:866]     raise ValueError(
(EngineCore_DP0 pid=278023) ERROR 01-26 06:17:10 [core.py:866] ValueError: To serve at least one request with the models's max seq len (1025), (0.19 GiB KV cache is needed, which is larger than the available KV cache memory (0.18 GiB). Based on the available memory, the estimated maximum model length is 960. Try increasing `gpu_memory_utilization` or decreasing `max_model_len` when initializing the engine. See https://docs.vllm.ai/en/latest/configuration/conserving_memory/ for more details.


─── STDERR ───
[2026-01-26 06:16:22] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 06:16:22] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:16:22] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 06:16:22] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:16:22] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:16:22] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:16:22] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:16:22] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:16:22] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:16:22] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 06:16:22] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 06:16:22] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 06:16:22] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 06:16:22] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 06:16:30] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 06:16:30] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:16:30] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 06:16:30] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:16:30] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:16:30] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:16:30] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:16:30] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:16:30] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:16:30] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 06:16:30] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 06:16:30] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 06:16:30] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 06:16:30] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=278023) [2026-01-26 06:16:32] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=278023) [2026-01-26 06:16:32] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=278023) [2026-01-26 06:16:32] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=278023) [2026-01-26 06:16:32] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=278023) [2026-01-26 06:16:32] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=278023) [2026-01-26 06:16:32] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=278023) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=278023) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:01<00:01,  1.53it/s]
(EngineCore_DP0 pid=278023) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:01<00:00,  1.82it/s]
(EngineCore_DP0 pid=278023) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.17it/s]
(EngineCore_DP0 pid=278023) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.30it/s]
(EngineCore_DP0 pid=278023) 
(EngineCore_DP0 pid=278023) [2026-01-26 06:16:36] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 7680] -> 1D uint8
(EngineCore_DP0 pid=278023) [2026-01-26 06:16:36] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 41287680 bytes
(EngineCore_DP0 pid=278023) [2026-01-26 06:16:36] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 7680] -> 1D uint8
(EngineCore_DP0 pid=278023) [2026-01-26 06:16:36] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 29491200 bytes
(EngineCore_DP0 pid=278023) [2026-01-26 06:16:36] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 7680] -> 1D uint8
(EngineCore_DP0 pid=278023) [2026-01-26 06:16:36] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 159252480 bytes
(EngineCore_DP0 pid=278023) [2026-01-26 06:16:36] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 20736] -> 1D uint8
(EngineCore_DP0 pid=278023) [2026-01-26 06:16:36] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 79626240 bytes
(EngineCore_DP0 pid=278023) [rank0]:W0126 06:17:04.346000 278023 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=278023) [rank0]:W0126 06:17:04.425000 278023 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=278023) [rank0]:W0126 06:17:04.363000 278023 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=278023) [rank0]:W0126 06:17:04.478000 278023 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=278023) Process EngineCore_DP0:
(EngineCore_DP0 pid=278023) Traceback (most recent call last):
(EngineCore_DP0 pid=278023)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=278023)     self.run()
(EngineCore_DP0 pid=278023)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=278023)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=278023)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=278023)     raise e
(EngineCore_DP0 pid=278023)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=278023)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=278023)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=278023)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=278023)     super().__init__(
(EngineCore_DP0 pid=278023)   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=278023)     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=278023)                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=278023)   File "/root/vllmbench/vllm/v1/engine/core.py", line 248, in _initialize_kv_caches
(EngineCore_DP0 pid=278023)     kv_cache_configs = get_kv_cache_configs(
(EngineCore_DP0 pid=278023)                        ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=278023)   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 1340, in get_kv_cache_configs
(EngineCore_DP0 pid=278023)     check_enough_kv_cache_memory(
(EngineCore_DP0 pid=278023)   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 710, in check_enough_kv_cache_memory
(EngineCore_DP0 pid=278023)     raise ValueError(
(EngineCore_DP0 pid=278023) ValueError: To serve at least one request with the models's max seq len (1025), (0.19 GiB KV cache is needed, which is larger than the available KV cache memory (0.18 GiB). Based on the available memory, the estimated maximum model length is 960. Try increasing `gpu_memory_utilization` or decreasing `max_model_len` when initializing the engine. See https://docs.vllm.ai/en/latest/configuration/conserving_memory/ for more details.
[rank0]:[W126 06:17:11.357440927 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

[ERROR] 测试失败: M=16384 (exit code: 1)

============================================================
[7/8] 测试 M=32768
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-14B-INT8                                │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 32768
│   M_prefill     = 32768 (= 32 x 1024)
│   M_decode      = 32
│   batched_tokens = 32768 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 4096
│   --max-num-seqs           = 32
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 32768
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 06:17:52 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 06:17:53 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=279554) WARNING 01-26 06:18:02 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=279554) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=279554) WARNING 01-26 06:18:21 [backends.py:609] Failed to read file <frozen os>
(EngineCore_DP0 pid=279554) ERROR 01-26 06:20:03 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=279554) ERROR 01-26 06:20:03 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=279554) ERROR 01-26 06:20:03 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=279554) ERROR 01-26 06:20:03 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=279554) ERROR 01-26 06:20:03 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=279554) ERROR 01-26 06:20:03 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=279554) ERROR 01-26 06:20:03 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=279554) ERROR 01-26 06:20:03 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=279554) ERROR 01-26 06:20:03 [core.py:866]     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=279554) ERROR 01-26 06:20:03 [core.py:866]                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=279554) ERROR 01-26 06:20:03 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 248, in _initialize_kv_caches
(EngineCore_DP0 pid=279554) ERROR 01-26 06:20:03 [core.py:866]     kv_cache_configs = get_kv_cache_configs(
(EngineCore_DP0 pid=279554) ERROR 01-26 06:20:03 [core.py:866]                        ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=279554) ERROR 01-26 06:20:03 [core.py:866]   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 1340, in get_kv_cache_configs
(EngineCore_DP0 pid=279554) ERROR 01-26 06:20:03 [core.py:866]     check_enough_kv_cache_memory(
(EngineCore_DP0 pid=279554) ERROR 01-26 06:20:03 [core.py:866]   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 687, in check_enough_kv_cache_memory
(EngineCore_DP0 pid=279554) ERROR 01-26 06:20:03 [core.py:866]     raise ValueError(
(EngineCore_DP0 pid=279554) ERROR 01-26 06:20:03 [core.py:866] ValueError: No available memory for the cache blocks. Try increasing `gpu_memory_utilization` when initializing the engine. See https://docs.vllm.ai/en/latest/configuration/conserving_memory/ for more details.


─── STDERR ───
[2026-01-26 06:17:52] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 06:17:52] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:17:52] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 06:17:52] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:17:52] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:17:52] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:17:52] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:17:52] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:17:52] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:17:52] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 06:17:52] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 06:17:52] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 06:17:52] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 06:17:52] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 06:18:00] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 06:18:00] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:18:00] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 06:18:00] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:18:00] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:18:00] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:18:00] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:18:00] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:18:00] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:18:00] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 06:18:00] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 06:18:00] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 06:18:00] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 06:18:00] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=279554) [2026-01-26 06:18:02] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=279554) [2026-01-26 06:18:02] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=279554) [2026-01-26 06:18:02] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=279554) [2026-01-26 06:18:02] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=279554) [2026-01-26 06:18:02] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=279554) [2026-01-26 06:18:02] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=279554) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=279554) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:01<00:04,  1.42s/it]
(EngineCore_DP0 pid=279554) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:02<00:02,  1.41s/it]
(EngineCore_DP0 pid=279554) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:03<00:00,  1.04it/s]
(EngineCore_DP0 pid=279554) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:03<00:00,  1.26it/s]
(EngineCore_DP0 pid=279554) 
(EngineCore_DP0 pid=279554) [2026-01-26 06:18:06] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 7680] -> 1D uint8
(EngineCore_DP0 pid=279554) [2026-01-26 06:18:06] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 41287680 bytes
(EngineCore_DP0 pid=279554) [2026-01-26 06:18:06] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 7680] -> 1D uint8
(EngineCore_DP0 pid=279554) [2026-01-26 06:18:06] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 29491200 bytes
(EngineCore_DP0 pid=279554) [2026-01-26 06:18:06] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 7680] -> 1D uint8
(EngineCore_DP0 pid=279554) [2026-01-26 06:18:06] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 159252480 bytes
(EngineCore_DP0 pid=279554) [2026-01-26 06:18:06] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 20736] -> 1D uint8
(EngineCore_DP0 pid=279554) [2026-01-26 06:18:06] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 79626240 bytes
(EngineCore_DP0 pid=279554) [rank0]:W0126 06:18:34.476000 279554 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=279554) [rank0]:W0126 06:18:34.558000 279554 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=279554) [rank0]:W0126 06:18:36.194000 279554 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=279554) [rank0]:W0126 06:18:36.312000 279554 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=279554) Process EngineCore_DP0:
(EngineCore_DP0 pid=279554) Traceback (most recent call last):
(EngineCore_DP0 pid=279554)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=279554)     self.run()
(EngineCore_DP0 pid=279554)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=279554)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=279554)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=279554)     raise e
(EngineCore_DP0 pid=279554)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=279554)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=279554)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=279554)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=279554)     super().__init__(
(EngineCore_DP0 pid=279554)   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=279554)     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=279554)                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=279554)   File "/root/vllmbench/vllm/v1/engine/core.py", line 248, in _initialize_kv_caches
(EngineCore_DP0 pid=279554)     kv_cache_configs = get_kv_cache_configs(
(EngineCore_DP0 pid=279554)                        ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=279554)   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 1340, in get_kv_cache_configs
(EngineCore_DP0 pid=279554)     check_enough_kv_cache_memory(
(EngineCore_DP0 pid=279554)   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 687, in check_enough_kv_cache_memory
(EngineCore_DP0 pid=279554)     raise ValueError(
(EngineCore_DP0 pid=279554) ValueError: No available memory for the cache blocks. Try increasing `gpu_memory_utilization` when initializing the engine. See https://docs.vllm.ai/en/latest/configuration/conserving_memory/ for more details.
[rank0]:[W126 06:20:04.055711415 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

[ERROR] 测试失败: M=32768 (exit code: 1)

============================================================
[8/8] 测试 M=65536
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-14B-INT8                                │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 65536
│   M_prefill     = 65536 (= 64 x 1024)
│   M_decode      = 64
│   batched_tokens = 65536 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 8192
│   --max-num-seqs           = 64
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 65536
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 06:21:14 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 06:21:15 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=282656) WARNING 01-26 06:21:23 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=282656) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=282656) WARNING 01-26 06:21:45 [backends.py:609] Failed to read file <frozen os>
(EngineCore_DP0 pid=282656) ERROR 01-26 06:26:47 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=282656) ERROR 01-26 06:26:47 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=282656) ERROR 01-26 06:26:47 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=282656) ERROR 01-26 06:26:47 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=282656) ERROR 01-26 06:26:47 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=282656) ERROR 01-26 06:26:47 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=282656) ERROR 01-26 06:26:47 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=282656) ERROR 01-26 06:26:47 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=282656) ERROR 01-26 06:26:47 [core.py:866]     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=282656) ERROR 01-26 06:26:47 [core.py:866]                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=282656) ERROR 01-26 06:26:47 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 248, in _initialize_kv_caches
(EngineCore_DP0 pid=282656) ERROR 01-26 06:26:47 [core.py:866]     kv_cache_configs = get_kv_cache_configs(
(EngineCore_DP0 pid=282656) ERROR 01-26 06:26:47 [core.py:866]                        ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=282656) ERROR 01-26 06:26:47 [core.py:866]   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 1340, in get_kv_cache_configs
(EngineCore_DP0 pid=282656) ERROR 01-26 06:26:47 [core.py:866]     check_enough_kv_cache_memory(
(EngineCore_DP0 pid=282656) ERROR 01-26 06:26:47 [core.py:866]   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 687, in check_enough_kv_cache_memory
(EngineCore_DP0 pid=282656) ERROR 01-26 06:26:47 [core.py:866]     raise ValueError(
(EngineCore_DP0 pid=282656) ERROR 01-26 06:26:47 [core.py:866] ValueError: No available memory for the cache blocks. Try increasing `gpu_memory_utilization` when initializing the engine. See https://docs.vllm.ai/en/latest/configuration/conserving_memory/ for more details.


─── STDERR ───
[2026-01-26 06:21:14] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 06:21:14] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:21:14] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 06:21:14] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:21:14] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:21:14] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:21:14] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:21:14] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:21:14] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:21:14] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 06:21:14] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 06:21:14] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 06:21:14] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 06:21:14] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 06:21:22] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 06:21:22] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:21:22] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 06:21:22] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:21:22] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:21:22] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:21:22] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:21:22] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:21:22] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:21:22] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 06:21:22] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 06:21:22] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 06:21:22] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 06:21:22] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=282656) [2026-01-26 06:21:24] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=282656) [2026-01-26 06:21:24] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=282656) [2026-01-26 06:21:24] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=282656) [2026-01-26 06:21:24] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=282656) [2026-01-26 06:21:24] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=282656) [2026-01-26 06:21:24] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=282656) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=282656) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:01<00:04,  1.41s/it]
(EngineCore_DP0 pid=282656) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:02<00:02,  1.44s/it]
(EngineCore_DP0 pid=282656) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:03<00:00,  1.02it/s]
(EngineCore_DP0 pid=282656) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.16s/it]
(EngineCore_DP0 pid=282656) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.18s/it]
(EngineCore_DP0 pid=282656) 
(EngineCore_DP0 pid=282656) [2026-01-26 06:21:30] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 7680] -> 1D uint8
(EngineCore_DP0 pid=282656) [2026-01-26 06:21:30] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 41287680 bytes
(EngineCore_DP0 pid=282656) [2026-01-26 06:21:30] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 7680] -> 1D uint8
(EngineCore_DP0 pid=282656) [2026-01-26 06:21:30] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 29491200 bytes
(EngineCore_DP0 pid=282656) [2026-01-26 06:21:30] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 7680] -> 1D uint8
(EngineCore_DP0 pid=282656) [2026-01-26 06:21:30] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 159252480 bytes
(EngineCore_DP0 pid=282656) [2026-01-26 06:21:30] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 20736] -> 1D uint8
(EngineCore_DP0 pid=282656) [2026-01-26 06:21:30] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 79626240 bytes
(EngineCore_DP0 pid=282656) [rank0]:W0126 06:21:57.032000 282656 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=282656) [rank0]:W0126 06:21:57.115000 282656 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=282656) [rank0]:W0126 06:21:59.568000 282656 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=282656) [rank0]:W0126 06:21:59.693000 282656 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=282656) Process EngineCore_DP0:
(EngineCore_DP0 pid=282656) Traceback (most recent call last):
(EngineCore_DP0 pid=282656)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=282656)     self.run()
(EngineCore_DP0 pid=282656)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=282656)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=282656)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=282656)     raise e
(EngineCore_DP0 pid=282656)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=282656)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=282656)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=282656)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=282656)     super().__init__(
(EngineCore_DP0 pid=282656)   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=282656)     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=282656)                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=282656)   File "/root/vllmbench/vllm/v1/engine/core.py", line 248, in _initialize_kv_caches
(EngineCore_DP0 pid=282656)     kv_cache_configs = get_kv_cache_configs(
(EngineCore_DP0 pid=282656)                        ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=282656)   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 1340, in get_kv_cache_configs
(EngineCore_DP0 pid=282656)     check_enough_kv_cache_memory(
(EngineCore_DP0 pid=282656)   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 687, in check_enough_kv_cache_memory
(EngineCore_DP0 pid=282656)     raise ValueError(
(EngineCore_DP0 pid=282656) ValueError: No available memory for the cache blocks. Try increasing `gpu_memory_utilization` when initializing the engine. See https://docs.vllm.ai/en/latest/configuration/conserving_memory/ for more details.
[rank0]:[W126 06:26:49.605091762 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

[ERROR] 测试失败: M=65536 (exit code: 1)


------------------------------------------------------------
  生成 CSV: Qwen2.5-14B-INT8
------------------------------------------------------------
[SUCCESS] CSV 保存到: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_8/Qwen2.5-14B-INT8_prefill.csv

预览:
------------------------------------------------------------
M_prefill,prompt_len,max_num_seqs,num_prompts,N_prefill,requests_per_s,tokens_per_s,elapsed_time_s
512,512,1,128,128,9.3746,4809.1797,13.6539
1024,1024,1,128,128,9.6316,9872.3900,13.2896
2048,1024,2,256,128,12.3010,12608.5711,20.8112
4096,1024,4,512,128,12.4469,12758.1054,41.1346
8192,1024,8,1024,128,12.4315,12742.2386,82.3717
16384,1024,16,2048,128,-1.0000,-1.0000,-1.0000
32768,1024,32,4096,128,-1.0000,-1.0000,-1.0000
65536,1024,64,8192,128,-1.0000,-1.0000,-1.0000

------------------------------------------------------------

[INFO] 完成: 5 成功, 3 失败

============================================================
  Qwen2.5-14B-INT8 | cuSPARSELt (2_10) | prefill
============================================================

[INFO] Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-14B-INT8-SlideSparse-2_10
[INFO] Output: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_10

============================================================
[1/8] 测试 M=512
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-14B-INT8                                │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 512
│   M_prefill     = 512 (= 1 x 512)
│   M_decode      = 1
│   batched_tokens = 513 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 512
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 513
│   --max-num-batched-tokens = 513
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 06:27:00 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 06:27:01 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=287741) WARNING 01-26 06:27:09 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=287741) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=287741) WARNING 01-26 06:27:42 [backends.py:609] Failed to read file <frozen os>
(EngineCore_DP0 pid=287741) ERROR 01-26 06:28:01 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=287741) ERROR 01-26 06:28:01 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=287741) ERROR 01-26 06:28:01 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=287741) ERROR 01-26 06:28:01 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=287741) ERROR 01-26 06:28:01 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=287741) ERROR 01-26 06:28:01 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=287741) ERROR 01-26 06:28:01 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=287741) ERROR 01-26 06:28:01 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=287741) ERROR 01-26 06:28:01 [core.py:866]     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=287741) ERROR 01-26 06:28:01 [core.py:866]                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=287741) ERROR 01-26 06:28:01 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 248, in _initialize_kv_caches
(EngineCore_DP0 pid=287741) ERROR 01-26 06:28:01 [core.py:866]     kv_cache_configs = get_kv_cache_configs(
(EngineCore_DP0 pid=287741) ERROR 01-26 06:28:01 [core.py:866]                        ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=287741) ERROR 01-26 06:28:01 [core.py:866]   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 1340, in get_kv_cache_configs
(EngineCore_DP0 pid=287741) ERROR 01-26 06:28:01 [core.py:866]     check_enough_kv_cache_memory(
(EngineCore_DP0 pid=287741) ERROR 01-26 06:28:01 [core.py:866]   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 710, in check_enough_kv_cache_memory
(EngineCore_DP0 pid=287741) ERROR 01-26 06:28:01 [core.py:866]     raise ValueError(
(EngineCore_DP0 pid=287741) ERROR 01-26 06:28:01 [core.py:866] ValueError: To serve at least one request with the models's max seq len (513), (0.10 GiB KV cache is needed, which is larger than the available KV cache memory (0.01 GiB). Based on the available memory, the estimated maximum model length is 48. Try increasing `gpu_memory_utilization` or decreasing `max_model_len` when initializing the engine. See https://docs.vllm.ai/en/latest/configuration/conserving_memory/ for more details.


─── STDERR ───
[2026-01-26 06:27:00] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 06:27:00] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:27:00] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 06:27:00] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:27:00] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:27:00] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:27:00] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:27:00] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:27:00] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:27:00] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 06:27:00] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 06:27:00] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 06:27:00] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 06:27:00] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 06:27:08] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 06:27:08] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:27:08] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 06:27:08] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:27:08] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:27:08] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:27:08] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:27:08] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:27:08] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:27:08] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 06:27:08] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 06:27:08] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 06:27:08] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 06:27:08] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=287741) [2026-01-26 06:27:10] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=287741) [2026-01-26 06:27:10] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=287741) [2026-01-26 06:27:10] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=287741) [2026-01-26 06:27:10] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=287741) [2026-01-26 06:27:10] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=287741) [2026-01-26 06:27:10] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=287741) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=287741) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:05<00:17,  5.82s/it]
(EngineCore_DP0 pid=287741) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:11<00:11,  5.59s/it]
(EngineCore_DP0 pid=287741) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:12<00:03,  3.59s/it]
(EngineCore_DP0 pid=287741) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:16<00:00,  3.77s/it]
(EngineCore_DP0 pid=287741) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:16<00:00,  4.13s/it]
(EngineCore_DP0 pid=287741) 
(EngineCore_DP0 pid=287741) [2026-01-26 06:27:27] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 8192] -> 1D uint8
(EngineCore_DP0 pid=287741) [2026-01-26 06:27:27] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 44040192 bytes
(EngineCore_DP0 pid=287741) [2026-01-26 06:27:27] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 8192] -> 1D uint8
(EngineCore_DP0 pid=287741) [2026-01-26 06:27:27] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 31457280 bytes
(EngineCore_DP0 pid=287741) [2026-01-26 06:27:27] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 8192] -> 1D uint8
(EngineCore_DP0 pid=287741) [2026-01-26 06:27:27] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 169869312 bytes
(EngineCore_DP0 pid=287741) [2026-01-26 06:27:27] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 22144] -> 1D uint8
(EngineCore_DP0 pid=287741) [2026-01-26 06:27:27] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 85032960 bytes
(EngineCore_DP0 pid=287741) Process EngineCore_DP0:
(EngineCore_DP0 pid=287741) Traceback (most recent call last):
(EngineCore_DP0 pid=287741)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=287741)     self.run()
(EngineCore_DP0 pid=287741)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=287741)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=287741)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=287741)     raise e
(EngineCore_DP0 pid=287741)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=287741)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=287741)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=287741)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=287741)     super().__init__(
(EngineCore_DP0 pid=287741)   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=287741)     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=287741)                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=287741)   File "/root/vllmbench/vllm/v1/engine/core.py", line 248, in _initialize_kv_caches
(EngineCore_DP0 pid=287741)     kv_cache_configs = get_kv_cache_configs(
(EngineCore_DP0 pid=287741)                        ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=287741)   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 1340, in get_kv_cache_configs
(EngineCore_DP0 pid=287741)     check_enough_kv_cache_memory(
(EngineCore_DP0 pid=287741)   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 710, in check_enough_kv_cache_memory
(EngineCore_DP0 pid=287741)     raise ValueError(
(EngineCore_DP0 pid=287741) ValueError: To serve at least one request with the models's max seq len (513), (0.10 GiB KV cache is needed, which is larger than the available KV cache memory (0.01 GiB). Based on the available memory, the estimated maximum model length is 48. Try increasing `gpu_memory_utilization` or decreasing `max_model_len` when initializing the engine. See https://docs.vllm.ai/en/latest/configuration/conserving_memory/ for more details.
[rank0]:[W126 06:28:02.038987693 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

[ERROR] 测试失败: M=512 (exit code: 1)

============================================================
[2/8] 测试 M=1024
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-14B-INT8                                │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 1024
│   M_prefill     = 1024 (= 1 x 1024)
│   M_decode      = 1
│   batched_tokens = 1025 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 1025
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 06:28:15 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 06:28:16 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=289008) WARNING 01-26 06:28:24 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=289008) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=289008) WARNING 01-26 06:28:59 [backends.py:609] Failed to read file <frozen os>
(EngineCore_DP0 pid=289008) ERROR 01-26 06:29:18 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=289008) ERROR 01-26 06:29:18 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=289008) ERROR 01-26 06:29:18 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=289008) ERROR 01-26 06:29:18 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=289008) ERROR 01-26 06:29:18 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=289008) ERROR 01-26 06:29:18 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=289008) ERROR 01-26 06:29:18 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=289008) ERROR 01-26 06:29:18 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=289008) ERROR 01-26 06:29:18 [core.py:866]     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=289008) ERROR 01-26 06:29:18 [core.py:866]                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=289008) ERROR 01-26 06:29:18 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 248, in _initialize_kv_caches
(EngineCore_DP0 pid=289008) ERROR 01-26 06:29:18 [core.py:866]     kv_cache_configs = get_kv_cache_configs(
(EngineCore_DP0 pid=289008) ERROR 01-26 06:29:18 [core.py:866]                        ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=289008) ERROR 01-26 06:29:18 [core.py:866]   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 1340, in get_kv_cache_configs
(EngineCore_DP0 pid=289008) ERROR 01-26 06:29:18 [core.py:866]     check_enough_kv_cache_memory(
(EngineCore_DP0 pid=289008) ERROR 01-26 06:29:18 [core.py:866]   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 710, in check_enough_kv_cache_memory
(EngineCore_DP0 pid=289008) ERROR 01-26 06:29:18 [core.py:866]     raise ValueError(
(EngineCore_DP0 pid=289008) ERROR 01-26 06:29:18 [core.py:866] ValueError: To serve at least one request with the models's max seq len (1025), (0.19 GiB KV cache is needed, which is larger than the available KV cache memory (0.00 GiB).  Try increasing `gpu_memory_utilization` or decreasing `max_model_len` when initializing the engine. See https://docs.vllm.ai/en/latest/configuration/conserving_memory/ for more details.


─── STDERR ───
[2026-01-26 06:28:15] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 06:28:15] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:28:15] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 06:28:15] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:28:15] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:28:15] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:28:15] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:28:15] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:28:15] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:28:15] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 06:28:15] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 06:28:15] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 06:28:15] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 06:28:15] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 06:28:23] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 06:28:23] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:28:23] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 06:28:23] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:28:23] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:28:23] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:28:23] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:28:23] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:28:23] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:28:23] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 06:28:23] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 06:28:23] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 06:28:23] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 06:28:23] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=289008) [2026-01-26 06:28:25] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=289008) [2026-01-26 06:28:25] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=289008) [2026-01-26 06:28:25] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=289008) [2026-01-26 06:28:25] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=289008) [2026-01-26 06:28:25] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=289008) [2026-01-26 06:28:25] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=289008) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=289008) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:04<00:14,  4.94s/it]
(EngineCore_DP0 pid=289008) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:10<00:10,  5.23s/it]
(EngineCore_DP0 pid=289008) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:11<00:03,  3.41s/it]
(EngineCore_DP0 pid=289008) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:17<00:00,  4.33s/it]
(EngineCore_DP0 pid=289008) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:17<00:00,  4.34s/it]
(EngineCore_DP0 pid=289008) 
(EngineCore_DP0 pid=289008) [2026-01-26 06:28:43] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 8192] -> 1D uint8
(EngineCore_DP0 pid=289008) [2026-01-26 06:28:43] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 44040192 bytes
(EngineCore_DP0 pid=289008) [2026-01-26 06:28:43] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 8192] -> 1D uint8
(EngineCore_DP0 pid=289008) [2026-01-26 06:28:43] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 31457280 bytes
(EngineCore_DP0 pid=289008) [2026-01-26 06:28:43] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 8192] -> 1D uint8
(EngineCore_DP0 pid=289008) [2026-01-26 06:28:43] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 169869312 bytes
(EngineCore_DP0 pid=289008) [2026-01-26 06:28:43] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 22144] -> 1D uint8
(EngineCore_DP0 pid=289008) [2026-01-26 06:28:43] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 85032960 bytes
(EngineCore_DP0 pid=289008) Process EngineCore_DP0:
(EngineCore_DP0 pid=289008) Traceback (most recent call last):
(EngineCore_DP0 pid=289008)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=289008)     self.run()
(EngineCore_DP0 pid=289008)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=289008)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=289008)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=289008)     raise e
(EngineCore_DP0 pid=289008)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=289008)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=289008)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=289008)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=289008)     super().__init__(
(EngineCore_DP0 pid=289008)   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=289008)     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=289008)                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=289008)   File "/root/vllmbench/vllm/v1/engine/core.py", line 248, in _initialize_kv_caches
(EngineCore_DP0 pid=289008)     kv_cache_configs = get_kv_cache_configs(
(EngineCore_DP0 pid=289008)                        ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=289008)   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 1340, in get_kv_cache_configs
(EngineCore_DP0 pid=289008)     check_enough_kv_cache_memory(
(EngineCore_DP0 pid=289008)   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 710, in check_enough_kv_cache_memory
(EngineCore_DP0 pid=289008)     raise ValueError(
(EngineCore_DP0 pid=289008) ValueError: To serve at least one request with the models's max seq len (1025), (0.19 GiB KV cache is needed, which is larger than the available KV cache memory (0.00 GiB).  Try increasing `gpu_memory_utilization` or decreasing `max_model_len` when initializing the engine. See https://docs.vllm.ai/en/latest/configuration/conserving_memory/ for more details.
[rank0]:[W126 06:29:19.115892385 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

[ERROR] 测试失败: M=1024 (exit code: 1)

============================================================
[3/8] 测试 M=2048
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-14B-INT8                                │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 2048
│   M_prefill     = 2048 (= 2 x 1024)
│   M_decode      = 2
│   batched_tokens = 2048 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 256
│   --max-num-seqs           = 2
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 2048
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 06:29:36 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 06:29:37 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=290348) WARNING 01-26 06:29:44 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=290348) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=290348) WARNING 01-26 06:30:05 [backends.py:609] Failed to read file <frozen os>
(EngineCore_DP0 pid=290348) ERROR 01-26 06:30:26 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=290348) ERROR 01-26 06:30:26 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=290348) ERROR 01-26 06:30:26 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=290348) ERROR 01-26 06:30:26 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=290348) ERROR 01-26 06:30:26 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=290348) ERROR 01-26 06:30:26 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=290348) ERROR 01-26 06:30:26 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=290348) ERROR 01-26 06:30:26 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=290348) ERROR 01-26 06:30:26 [core.py:866]     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=290348) ERROR 01-26 06:30:26 [core.py:866]                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=290348) ERROR 01-26 06:30:26 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 248, in _initialize_kv_caches
(EngineCore_DP0 pid=290348) ERROR 01-26 06:30:26 [core.py:866]     kv_cache_configs = get_kv_cache_configs(
(EngineCore_DP0 pid=290348) ERROR 01-26 06:30:26 [core.py:866]                        ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=290348) ERROR 01-26 06:30:26 [core.py:866]   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 1340, in get_kv_cache_configs
(EngineCore_DP0 pid=290348) ERROR 01-26 06:30:26 [core.py:866]     check_enough_kv_cache_memory(
(EngineCore_DP0 pid=290348) ERROR 01-26 06:30:26 [core.py:866]   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 687, in check_enough_kv_cache_memory
(EngineCore_DP0 pid=290348) ERROR 01-26 06:30:26 [core.py:866]     raise ValueError(
(EngineCore_DP0 pid=290348) ERROR 01-26 06:30:26 [core.py:866] ValueError: No available memory for the cache blocks. Try increasing `gpu_memory_utilization` when initializing the engine. See https://docs.vllm.ai/en/latest/configuration/conserving_memory/ for more details.


─── STDERR ───
[2026-01-26 06:29:35] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 06:29:36] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:29:36] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 06:29:36] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:29:36] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:29:36] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:29:36] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:29:36] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:29:36] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:29:36] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 06:29:36] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 06:29:36] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 06:29:36] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 06:29:36] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 06:29:44] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 06:29:44] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:29:44] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 06:29:44] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:29:44] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:29:44] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:29:44] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:29:44] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:29:44] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:29:44] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 06:29:44] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 06:29:44] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 06:29:44] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 06:29:44] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=290348) [2026-01-26 06:29:45] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=290348) [2026-01-26 06:29:46] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=290348) [2026-01-26 06:29:46] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=290348) [2026-01-26 06:29:46] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=290348) [2026-01-26 06:29:46] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=290348) [2026-01-26 06:29:46] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=290348) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=290348) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:01<00:04,  1.47s/it]
(EngineCore_DP0 pid=290348) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:02<00:02,  1.45s/it]
(EngineCore_DP0 pid=290348) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:03<00:00,  1.03it/s]
(EngineCore_DP0 pid=290348) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.16s/it]
(EngineCore_DP0 pid=290348) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.19s/it]
(EngineCore_DP0 pid=290348) 
(EngineCore_DP0 pid=290348) [2026-01-26 06:29:51] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 8192] -> 1D uint8
(EngineCore_DP0 pid=290348) [2026-01-26 06:29:51] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 44040192 bytes
(EngineCore_DP0 pid=290348) [2026-01-26 06:29:51] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 8192] -> 1D uint8
(EngineCore_DP0 pid=290348) [2026-01-26 06:29:51] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 31457280 bytes
(EngineCore_DP0 pid=290348) [2026-01-26 06:29:51] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 8192] -> 1D uint8
(EngineCore_DP0 pid=290348) [2026-01-26 06:29:51] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 169869312 bytes
(EngineCore_DP0 pid=290348) [2026-01-26 06:29:51] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 22144] -> 1D uint8
(EngineCore_DP0 pid=290348) [2026-01-26 06:29:51] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 85032960 bytes
(EngineCore_DP0 pid=290348) Process EngineCore_DP0:
(EngineCore_DP0 pid=290348) Traceback (most recent call last):
(EngineCore_DP0 pid=290348)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=290348)     self.run()
(EngineCore_DP0 pid=290348)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=290348)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=290348)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=290348)     raise e
(EngineCore_DP0 pid=290348)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=290348)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=290348)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=290348)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=290348)     super().__init__(
(EngineCore_DP0 pid=290348)   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=290348)     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=290348)                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=290348)   File "/root/vllmbench/vllm/v1/engine/core.py", line 248, in _initialize_kv_caches
(EngineCore_DP0 pid=290348)     kv_cache_configs = get_kv_cache_configs(
(EngineCore_DP0 pid=290348)                        ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=290348)   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 1340, in get_kv_cache_configs
(EngineCore_DP0 pid=290348)     check_enough_kv_cache_memory(
(EngineCore_DP0 pid=290348)   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 687, in check_enough_kv_cache_memory
(EngineCore_DP0 pid=290348)     raise ValueError(
(EngineCore_DP0 pid=290348) ValueError: No available memory for the cache blocks. Try increasing `gpu_memory_utilization` when initializing the engine. See https://docs.vllm.ai/en/latest/configuration/conserving_memory/ for more details.
[rank0]:[W126 06:30:27.726503867 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

[ERROR] 测试失败: M=2048 (exit code: 1)

============================================================
[4/8] 测试 M=4096
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-14B-INT8                                │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 4096
│   M_prefill     = 4096 (= 4 x 1024)
│   M_decode      = 4
│   batched_tokens = 4096 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 512
│   --max-num-seqs           = 4
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 4096
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 06:30:41 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 06:30:42 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=291483) WARNING 01-26 06:30:50 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=291483) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=291483) WARNING 01-26 06:31:11 [backends.py:609] Failed to read file <frozen os>
(EngineCore_DP0 pid=291483) ERROR 01-26 06:31:38 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=291483) ERROR 01-26 06:31:38 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=291483) ERROR 01-26 06:31:38 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=291483) ERROR 01-26 06:31:38 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=291483) ERROR 01-26 06:31:38 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=291483) ERROR 01-26 06:31:38 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=291483) ERROR 01-26 06:31:38 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=291483) ERROR 01-26 06:31:38 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=291483) ERROR 01-26 06:31:38 [core.py:866]     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=291483) ERROR 01-26 06:31:38 [core.py:866]                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=291483) ERROR 01-26 06:31:38 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 248, in _initialize_kv_caches
(EngineCore_DP0 pid=291483) ERROR 01-26 06:31:38 [core.py:866]     kv_cache_configs = get_kv_cache_configs(
(EngineCore_DP0 pid=291483) ERROR 01-26 06:31:38 [core.py:866]                        ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=291483) ERROR 01-26 06:31:38 [core.py:866]   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 1340, in get_kv_cache_configs
(EngineCore_DP0 pid=291483) ERROR 01-26 06:31:38 [core.py:866]     check_enough_kv_cache_memory(
(EngineCore_DP0 pid=291483) ERROR 01-26 06:31:38 [core.py:866]   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 687, in check_enough_kv_cache_memory
(EngineCore_DP0 pid=291483) ERROR 01-26 06:31:38 [core.py:866]     raise ValueError(
(EngineCore_DP0 pid=291483) ERROR 01-26 06:31:38 [core.py:866] ValueError: No available memory for the cache blocks. Try increasing `gpu_memory_utilization` when initializing the engine. See https://docs.vllm.ai/en/latest/configuration/conserving_memory/ for more details.


─── STDERR ───
[2026-01-26 06:30:41] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 06:30:41] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:30:41] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 06:30:41] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:30:41] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:30:41] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:30:41] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:30:41] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:30:41] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:30:41] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 06:30:41] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 06:30:41] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 06:30:41] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 06:30:41] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 06:30:49] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 06:30:49] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:30:49] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 06:30:49] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:30:49] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:30:49] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:30:49] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:30:49] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:30:49] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:30:49] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 06:30:49] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 06:30:49] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 06:30:49] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 06:30:49] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=291483) [2026-01-26 06:30:50] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=291483) [2026-01-26 06:30:50] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=291483) [2026-01-26 06:30:50] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=291483) [2026-01-26 06:30:50] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=291483) [2026-01-26 06:30:50] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=291483) [2026-01-26 06:30:50] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=291483) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=291483) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:01<00:04,  1.46s/it]
(EngineCore_DP0 pid=291483) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:02<00:02,  1.44s/it]
(EngineCore_DP0 pid=291483) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:03<00:00,  1.03it/s]
(EngineCore_DP0 pid=291483) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.15s/it]
(EngineCore_DP0 pid=291483) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.18s/it]
(EngineCore_DP0 pid=291483) 
(EngineCore_DP0 pid=291483) [2026-01-26 06:30:57] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 8192] -> 1D uint8
(EngineCore_DP0 pid=291483) [2026-01-26 06:30:57] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 44040192 bytes
(EngineCore_DP0 pid=291483) [2026-01-26 06:30:57] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 8192] -> 1D uint8
(EngineCore_DP0 pid=291483) [2026-01-26 06:30:57] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 31457280 bytes
(EngineCore_DP0 pid=291483) [2026-01-26 06:30:57] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 8192] -> 1D uint8
(EngineCore_DP0 pid=291483) [2026-01-26 06:30:57] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 169869312 bytes
(EngineCore_DP0 pid=291483) [2026-01-26 06:30:57] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 22144] -> 1D uint8
(EngineCore_DP0 pid=291483) [2026-01-26 06:30:57] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 85032960 bytes
(EngineCore_DP0 pid=291483) Process EngineCore_DP0:
(EngineCore_DP0 pid=291483) Traceback (most recent call last):
(EngineCore_DP0 pid=291483)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=291483)     self.run()
(EngineCore_DP0 pid=291483)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=291483)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=291483)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=291483)     raise e
(EngineCore_DP0 pid=291483)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=291483)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=291483)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=291483)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=291483)     super().__init__(
(EngineCore_DP0 pid=291483)   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=291483)     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=291483)                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=291483)   File "/root/vllmbench/vllm/v1/engine/core.py", line 248, in _initialize_kv_caches
(EngineCore_DP0 pid=291483)     kv_cache_configs = get_kv_cache_configs(
(EngineCore_DP0 pid=291483)                        ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=291483)   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 1340, in get_kv_cache_configs
(EngineCore_DP0 pid=291483)     check_enough_kv_cache_memory(
(EngineCore_DP0 pid=291483)   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 687, in check_enough_kv_cache_memory
(EngineCore_DP0 pid=291483)     raise ValueError(
(EngineCore_DP0 pid=291483) ValueError: No available memory for the cache blocks. Try increasing `gpu_memory_utilization` when initializing the engine. See https://docs.vllm.ai/en/latest/configuration/conserving_memory/ for more details.
[rank0]:[W126 06:31:39.091520753 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

[ERROR] 测试失败: M=4096 (exit code: 1)

============================================================
[5/8] 测试 M=8192
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-14B-INT8                                │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 8192
│   M_prefill     = 8192 (= 8 x 1024)
│   M_decode      = 8
│   batched_tokens = 8192 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 1024
│   --max-num-seqs           = 8
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 8192
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 06:31:59 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 06:32:00 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=292784) WARNING 01-26 06:32:06 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=292784) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=292784) WARNING 01-26 06:32:29 [backends.py:609] Failed to read file <frozen os>
(EngineCore_DP0 pid=292784) ERROR 01-26 06:33:10 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=292784) ERROR 01-26 06:33:10 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=292784) ERROR 01-26 06:33:10 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=292784) ERROR 01-26 06:33:10 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=292784) ERROR 01-26 06:33:10 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=292784) ERROR 01-26 06:33:10 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=292784) ERROR 01-26 06:33:10 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=292784) ERROR 01-26 06:33:10 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=292784) ERROR 01-26 06:33:10 [core.py:866]     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=292784) ERROR 01-26 06:33:10 [core.py:866]                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=292784) ERROR 01-26 06:33:10 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 248, in _initialize_kv_caches
(EngineCore_DP0 pid=292784) ERROR 01-26 06:33:10 [core.py:866]     kv_cache_configs = get_kv_cache_configs(
(EngineCore_DP0 pid=292784) ERROR 01-26 06:33:10 [core.py:866]                        ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=292784) ERROR 01-26 06:33:10 [core.py:866]   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 1340, in get_kv_cache_configs
(EngineCore_DP0 pid=292784) ERROR 01-26 06:33:10 [core.py:866]     check_enough_kv_cache_memory(
(EngineCore_DP0 pid=292784) ERROR 01-26 06:33:10 [core.py:866]   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 687, in check_enough_kv_cache_memory
(EngineCore_DP0 pid=292784) ERROR 01-26 06:33:10 [core.py:866]     raise ValueError(
(EngineCore_DP0 pid=292784) ERROR 01-26 06:33:10 [core.py:866] ValueError: No available memory for the cache blocks. Try increasing `gpu_memory_utilization` when initializing the engine. See https://docs.vllm.ai/en/latest/configuration/conserving_memory/ for more details.


─── STDERR ───
[2026-01-26 06:31:59] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 06:31:59] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:31:59] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 06:31:59] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:31:59] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:31:59] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:31:59] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:31:59] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:31:59] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:31:59] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 06:31:59] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 06:31:59] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 06:31:59] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 06:31:59] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 06:32:05] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 06:32:05] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:32:05] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 06:32:05] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:32:05] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:32:05] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:32:05] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:32:05] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:32:05] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:32:05] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 06:32:05] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 06:32:05] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 06:32:05] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 06:32:05] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=292784) [2026-01-26 06:32:07] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=292784) [2026-01-26 06:32:07] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=292784) [2026-01-26 06:32:07] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=292784) [2026-01-26 06:32:07] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=292784) [2026-01-26 06:32:07] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=292784) [2026-01-26 06:32:07] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=292784) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=292784) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:01<00:04,  1.47s/it]
(EngineCore_DP0 pid=292784) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:02<00:02,  1.45s/it]
(EngineCore_DP0 pid=292784) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:03<00:00,  1.02it/s]
(EngineCore_DP0 pid=292784) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.19s/it]
(EngineCore_DP0 pid=292784) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.21s/it]
(EngineCore_DP0 pid=292784) 
(EngineCore_DP0 pid=292784) [2026-01-26 06:32:13] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 8192] -> 1D uint8
(EngineCore_DP0 pid=292784) [2026-01-26 06:32:13] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 44040192 bytes
(EngineCore_DP0 pid=292784) [2026-01-26 06:32:13] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 8192] -> 1D uint8
(EngineCore_DP0 pid=292784) [2026-01-26 06:32:13] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 31457280 bytes
(EngineCore_DP0 pid=292784) [2026-01-26 06:32:13] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 8192] -> 1D uint8
(EngineCore_DP0 pid=292784) [2026-01-26 06:32:13] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 169869312 bytes
(EngineCore_DP0 pid=292784) [2026-01-26 06:32:13] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 22144] -> 1D uint8
(EngineCore_DP0 pid=292784) [2026-01-26 06:32:13] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 85032960 bytes
(EngineCore_DP0 pid=292784) Process EngineCore_DP0:
(EngineCore_DP0 pid=292784) Traceback (most recent call last):
(EngineCore_DP0 pid=292784)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=292784)     self.run()
(EngineCore_DP0 pid=292784)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=292784)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=292784)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=292784)     raise e
(EngineCore_DP0 pid=292784)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=292784)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=292784)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=292784)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=292784)     super().__init__(
(EngineCore_DP0 pid=292784)   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=292784)     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=292784)                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=292784)   File "/root/vllmbench/vllm/v1/engine/core.py", line 248, in _initialize_kv_caches
(EngineCore_DP0 pid=292784)     kv_cache_configs = get_kv_cache_configs(
(EngineCore_DP0 pid=292784)                        ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=292784)   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 1340, in get_kv_cache_configs
(EngineCore_DP0 pid=292784)     check_enough_kv_cache_memory(
(EngineCore_DP0 pid=292784)   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 687, in check_enough_kv_cache_memory
(EngineCore_DP0 pid=292784)     raise ValueError(
(EngineCore_DP0 pid=292784) ValueError: No available memory for the cache blocks. Try increasing `gpu_memory_utilization` when initializing the engine. See https://docs.vllm.ai/en/latest/configuration/conserving_memory/ for more details.
[rank0]:[W126 06:33:12.246742730 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

[ERROR] 测试失败: M=8192 (exit code: 1)

============================================================
[6/8] 测试 M=16384
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-14B-INT8                                │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 16384
│   M_prefill     = 16384 (= 16 x 1024)
│   M_decode      = 16
│   batched_tokens = 16384 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 2048
│   --max-num-seqs           = 16
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 16384
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 06:33:39 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 06:33:39 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=294387) WARNING 01-26 06:33:46 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=294387) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=294387) WARNING 01-26 06:34:09 [backends.py:609] Failed to read file <frozen os>
(EngineCore_DP0 pid=294387) ERROR 01-26 06:36:40 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=294387) ERROR 01-26 06:36:40 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=294387) ERROR 01-26 06:36:40 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=294387) ERROR 01-26 06:36:40 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=294387) ERROR 01-26 06:36:40 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=294387) ERROR 01-26 06:36:40 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=294387) ERROR 01-26 06:36:40 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=294387) ERROR 01-26 06:36:40 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=294387) ERROR 01-26 06:36:40 [core.py:866]     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=294387) ERROR 01-26 06:36:40 [core.py:866]                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=294387) ERROR 01-26 06:36:40 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 248, in _initialize_kv_caches
(EngineCore_DP0 pid=294387) ERROR 01-26 06:36:40 [core.py:866]     kv_cache_configs = get_kv_cache_configs(
(EngineCore_DP0 pid=294387) ERROR 01-26 06:36:40 [core.py:866]                        ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=294387) ERROR 01-26 06:36:40 [core.py:866]   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 1340, in get_kv_cache_configs
(EngineCore_DP0 pid=294387) ERROR 01-26 06:36:40 [core.py:866]     check_enough_kv_cache_memory(
(EngineCore_DP0 pid=294387) ERROR 01-26 06:36:40 [core.py:866]   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 687, in check_enough_kv_cache_memory
(EngineCore_DP0 pid=294387) ERROR 01-26 06:36:40 [core.py:866]     raise ValueError(
(EngineCore_DP0 pid=294387) ERROR 01-26 06:36:40 [core.py:866] ValueError: No available memory for the cache blocks. Try increasing `gpu_memory_utilization` when initializing the engine. See https://docs.vllm.ai/en/latest/configuration/conserving_memory/ for more details.


─── STDERR ───
[2026-01-26 06:33:39] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 06:33:39] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:33:39] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 06:33:39] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:33:39] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:33:39] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:33:39] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:33:39] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:33:39] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:33:39] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 06:33:39] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 06:33:39] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 06:33:39] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 06:33:39] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 06:33:46] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 06:33:46] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:33:46] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 06:33:46] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:33:46] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:33:46] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:33:46] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:33:46] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:33:46] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:33:46] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 06:33:46] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 06:33:46] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 06:33:46] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 06:33:46] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=294387) [2026-01-26 06:33:47] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=294387) [2026-01-26 06:33:47] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=294387) [2026-01-26 06:33:47] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=294387) [2026-01-26 06:33:47] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=294387) [2026-01-26 06:33:47] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=294387) [2026-01-26 06:33:47] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=294387) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=294387) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:01<00:04,  1.48s/it]
(EngineCore_DP0 pid=294387) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:02<00:02,  1.45s/it]
(EngineCore_DP0 pid=294387) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:03<00:00,  1.02it/s]
(EngineCore_DP0 pid=294387) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.16s/it]
(EngineCore_DP0 pid=294387) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.19s/it]
(EngineCore_DP0 pid=294387) 
(EngineCore_DP0 pid=294387) [2026-01-26 06:33:53] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 8192] -> 1D uint8
(EngineCore_DP0 pid=294387) [2026-01-26 06:33:53] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 44040192 bytes
(EngineCore_DP0 pid=294387) [2026-01-26 06:33:53] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 8192] -> 1D uint8
(EngineCore_DP0 pid=294387) [2026-01-26 06:33:53] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 31457280 bytes
(EngineCore_DP0 pid=294387) [2026-01-26 06:33:53] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 8192] -> 1D uint8
(EngineCore_DP0 pid=294387) [2026-01-26 06:33:53] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 169869312 bytes
(EngineCore_DP0 pid=294387) [2026-01-26 06:33:53] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 22144] -> 1D uint8
(EngineCore_DP0 pid=294387) [2026-01-26 06:33:53] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 85032960 bytes
(EngineCore_DP0 pid=294387) [rank0]:W0126 06:34:21.707000 294387 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=294387) [rank0]:W0126 06:34:21.790000 294387 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=294387) [rank0]:W0126 06:34:23.204000 294387 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=294387) [rank0]:W0126 06:34:23.321000 294387 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=294387) Process EngineCore_DP0:
(EngineCore_DP0 pid=294387) Traceback (most recent call last):
(EngineCore_DP0 pid=294387)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=294387)     self.run()
(EngineCore_DP0 pid=294387)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=294387)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=294387)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=294387)     raise e
(EngineCore_DP0 pid=294387)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=294387)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=294387)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=294387)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=294387)     super().__init__(
(EngineCore_DP0 pid=294387)   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=294387)     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=294387)                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=294387)   File "/root/vllmbench/vllm/v1/engine/core.py", line 248, in _initialize_kv_caches
(EngineCore_DP0 pid=294387)     kv_cache_configs = get_kv_cache_configs(
(EngineCore_DP0 pid=294387)                        ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=294387)   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 1340, in get_kv_cache_configs
(EngineCore_DP0 pid=294387)     check_enough_kv_cache_memory(
(EngineCore_DP0 pid=294387)   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 687, in check_enough_kv_cache_memory
(EngineCore_DP0 pid=294387)     raise ValueError(
(EngineCore_DP0 pid=294387) ValueError: No available memory for the cache blocks. Try increasing `gpu_memory_utilization` when initializing the engine. See https://docs.vllm.ai/en/latest/configuration/conserving_memory/ for more details.
[rank0]:[W126 06:36:42.658986350 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

[ERROR] 测试失败: M=16384 (exit code: 1)

============================================================
[7/8] 测试 M=32768
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-14B-INT8                                │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 32768
│   M_prefill     = 32768 (= 32 x 1024)
│   M_decode      = 32
│   batched_tokens = 32768 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 4096
│   --max-num-seqs           = 32
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 32768
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 06:37:22 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 06:37:23 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=297747) WARNING 01-26 06:37:31 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=297747) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=297747) WARNING 01-26 06:37:55 [backends.py:609] Failed to read file <frozen os>
(EngineCore_DP0 pid=297747) ERROR 01-26 06:42:31 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=297747) ERROR 01-26 06:42:31 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=297747) ERROR 01-26 06:42:31 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=297747) ERROR 01-26 06:42:31 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=297747) ERROR 01-26 06:42:31 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=297747) ERROR 01-26 06:42:31 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=297747) ERROR 01-26 06:42:31 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=297747) ERROR 01-26 06:42:31 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=297747) ERROR 01-26 06:42:31 [core.py:866]     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=297747) ERROR 01-26 06:42:31 [core.py:866]                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=297747) ERROR 01-26 06:42:31 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 248, in _initialize_kv_caches
(EngineCore_DP0 pid=297747) ERROR 01-26 06:42:31 [core.py:866]     kv_cache_configs = get_kv_cache_configs(
(EngineCore_DP0 pid=297747) ERROR 01-26 06:42:31 [core.py:866]                        ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=297747) ERROR 01-26 06:42:31 [core.py:866]   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 1340, in get_kv_cache_configs
(EngineCore_DP0 pid=297747) ERROR 01-26 06:42:31 [core.py:866]     check_enough_kv_cache_memory(
(EngineCore_DP0 pid=297747) ERROR 01-26 06:42:31 [core.py:866]   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 687, in check_enough_kv_cache_memory
(EngineCore_DP0 pid=297747) ERROR 01-26 06:42:31 [core.py:866]     raise ValueError(
(EngineCore_DP0 pid=297747) ERROR 01-26 06:42:31 [core.py:866] ValueError: No available memory for the cache blocks. Try increasing `gpu_memory_utilization` when initializing the engine. See https://docs.vllm.ai/en/latest/configuration/conserving_memory/ for more details.


─── STDERR ───
[2026-01-26 06:37:22] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 06:37:22] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:37:22] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 06:37:22] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:37:22] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:37:22] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:37:22] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:37:22] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:37:22] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:37:22] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 06:37:22] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 06:37:22] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 06:37:22] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 06:37:22] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 06:37:30] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 06:37:30] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:37:30] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 06:37:30] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:37:30] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:37:30] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:37:30] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:37:30] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:37:30] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:37:30] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 06:37:30] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 06:37:30] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 06:37:30] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 06:37:30] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=297747) [2026-01-26 06:37:32] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=297747) [2026-01-26 06:37:32] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=297747) [2026-01-26 06:37:32] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=297747) [2026-01-26 06:37:32] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=297747) [2026-01-26 06:37:32] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=297747) [2026-01-26 06:37:32] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=297747) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=297747) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:01<00:04,  1.54s/it]
(EngineCore_DP0 pid=297747) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:03<00:03,  1.50s/it]
(EngineCore_DP0 pid=297747) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:03<00:01,  1.01s/it]
(EngineCore_DP0 pid=297747) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.20s/it]
(EngineCore_DP0 pid=297747) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.24s/it]
(EngineCore_DP0 pid=297747) 
(EngineCore_DP0 pid=297747) [2026-01-26 06:37:37] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 8192] -> 1D uint8
(EngineCore_DP0 pid=297747) [2026-01-26 06:37:38] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 44040192 bytes
(EngineCore_DP0 pid=297747) [2026-01-26 06:37:38] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 8192] -> 1D uint8
(EngineCore_DP0 pid=297747) [2026-01-26 06:37:38] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 31457280 bytes
(EngineCore_DP0 pid=297747) [2026-01-26 06:37:38] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 8192] -> 1D uint8
(EngineCore_DP0 pid=297747) [2026-01-26 06:37:39] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 169869312 bytes
(EngineCore_DP0 pid=297747) [2026-01-26 06:37:39] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 22144] -> 1D uint8
(EngineCore_DP0 pid=297747) [2026-01-26 06:37:39] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 85032960 bytes
(EngineCore_DP0 pid=297747) [rank0]:W0126 06:38:08.556000 297747 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=297747) [rank0]:W0126 06:38:08.636000 297747 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=297747) [rank0]:W0126 06:38:10.323000 297747 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=297747) [rank0]:W0126 06:38:10.453000 297747 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=297747) Process EngineCore_DP0:
(EngineCore_DP0 pid=297747) Traceback (most recent call last):
(EngineCore_DP0 pid=297747)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=297747)     self.run()
(EngineCore_DP0 pid=297747)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=297747)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=297747)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=297747)     raise e
(EngineCore_DP0 pid=297747)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=297747)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=297747)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=297747)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=297747)     super().__init__(
(EngineCore_DP0 pid=297747)   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=297747)     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=297747)                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=297747)   File "/root/vllmbench/vllm/v1/engine/core.py", line 248, in _initialize_kv_caches
(EngineCore_DP0 pid=297747)     kv_cache_configs = get_kv_cache_configs(
(EngineCore_DP0 pid=297747)                        ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=297747)   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 1340, in get_kv_cache_configs
(EngineCore_DP0 pid=297747)     check_enough_kv_cache_memory(
(EngineCore_DP0 pid=297747)   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 687, in check_enough_kv_cache_memory
(EngineCore_DP0 pid=297747)     raise ValueError(
(EngineCore_DP0 pid=297747) ValueError: No available memory for the cache blocks. Try increasing `gpu_memory_utilization` when initializing the engine. See https://docs.vllm.ai/en/latest/configuration/conserving_memory/ for more details.
[rank0]:[W126 06:42:32.445153161 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

[ERROR] 测试失败: M=32768 (exit code: 1)

============================================================
[8/8] 测试 M=65536
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-14B-INT8                                │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 65536
│   M_prefill     = 65536 (= 64 x 1024)
│   M_decode      = 64
│   batched_tokens = 65536 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 8192
│   --max-num-seqs           = 64
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 65536
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 06:43:44 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 06:43:45 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=303769) WARNING 01-26 06:44:02 [interface.py:465] Using 'pin_memory=False' as WSL is detected. This may slow down the performance.
(EngineCore_DP0 pid=303769) [INFO] Loading compress extension: cusparselt_compress_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=303769) WARNING 01-26 06:44:29 [backends.py:609] Failed to read file <frozen os>
(EngineCore_DP0 pid=303769) ERROR 01-26 06:53:45 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=303769) ERROR 01-26 06:53:45 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=303769) ERROR 01-26 06:53:45 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=303769) ERROR 01-26 06:53:45 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=303769) ERROR 01-26 06:53:45 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=303769) ERROR 01-26 06:53:45 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=303769) ERROR 01-26 06:53:45 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=303769) ERROR 01-26 06:53:45 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=303769) ERROR 01-26 06:53:45 [core.py:866]     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=303769) ERROR 01-26 06:53:45 [core.py:866]                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=303769) ERROR 01-26 06:53:45 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 248, in _initialize_kv_caches
(EngineCore_DP0 pid=303769) ERROR 01-26 06:53:45 [core.py:866]     kv_cache_configs = get_kv_cache_configs(
(EngineCore_DP0 pid=303769) ERROR 01-26 06:53:45 [core.py:866]                        ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=303769) ERROR 01-26 06:53:45 [core.py:866]   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 1340, in get_kv_cache_configs
(EngineCore_DP0 pid=303769) ERROR 01-26 06:53:45 [core.py:866]     check_enough_kv_cache_memory(
(EngineCore_DP0 pid=303769) ERROR 01-26 06:53:45 [core.py:866]   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 687, in check_enough_kv_cache_memory
(EngineCore_DP0 pid=303769) ERROR 01-26 06:53:45 [core.py:866]     raise ValueError(
(EngineCore_DP0 pid=303769) ERROR 01-26 06:53:45 [core.py:866] ValueError: No available memory for the cache blocks. Try increasing `gpu_memory_utilization` when initializing the engine. See https://docs.vllm.ai/en/latest/configuration/conserving_memory/ for more details.


─── STDERR ───
[2026-01-26 06:43:44] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 06:43:44] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:43:44] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 06:43:44] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:43:44] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:43:44] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:43:44] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:43:44] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:43:44] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:43:44] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 06:43:44] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 06:43:44] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 06:43:44] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 06:43:44] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 06:43:52] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 06:43:52] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:43:52] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-14B-INT8
[2026-01-26 06:43:52] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:43:52] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:43:52] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:43:52] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:43:52] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-14B-INT8
[2026-01-26 06:43:52] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-14B-INT8'
[2026-01-26 06:43:52] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 06:43:52] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 06:43:52] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 06:43:52] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 06:43:52] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[W126 06:44:01.716345622 socket.cpp:209] [c10d] The hostname of the client socket cannot be retrieved. err=-3
(EngineCore_DP0 pid=303769) [2026-01-26 06:44:02] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=303769) [2026-01-26 06:44:02] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX4090_cc89_py312_cu129_x86_64.so
(EngineCore_DP0 pid=303769) [2026-01-26 06:44:02] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=303769) [2026-01-26 06:44:02] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=303769) [2026-01-26 06:44:02] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-14B-INT8
(EngineCore_DP0 pid=303769) [2026-01-26 06:44:02] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=303769) 
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
(EngineCore_DP0 pid=303769) 
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:02<00:06,  2.06s/it]
(EngineCore_DP0 pid=303769) 
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:03<00:03,  1.99s/it]
(EngineCore_DP0 pid=303769) 
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:04<00:01,  1.32s/it]
(EngineCore_DP0 pid=303769) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:06<00:00,  1.51s/it]
(EngineCore_DP0 pid=303769) 
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:06<00:00,  1.58s/it]
(EngineCore_DP0 pid=303769) 
(EngineCore_DP0 pid=303769) [2026-01-26 06:44:10] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [7168, 8192] -> 1D uint8
(EngineCore_DP0 pid=303769) [2026-01-26 06:44:11] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 44040192 bytes
(EngineCore_DP0 pid=303769) [2026-01-26 06:44:11] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 8192] -> 1D uint8
(EngineCore_DP0 pid=303769) [2026-01-26 06:44:11] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 31457280 bytes
(EngineCore_DP0 pid=303769) [2026-01-26 06:44:11] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [27648, 8192] -> 1D uint8
(EngineCore_DP0 pid=303769) [2026-01-26 06:44:13] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 169869312 bytes
(EngineCore_DP0 pid=303769) [2026-01-26 06:44:13] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [5120, 22144] -> 1D uint8
(EngineCore_DP0 pid=303769) [2026-01-26 06:44:13] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 85032960 bytes
(EngineCore_DP0 pid=303769) [rank0]:W0126 06:44:41.765000 303769 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=303769) [rank0]:W0126 06:44:41.847000 303769 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=303769) [rank0]:W0126 06:44:46.265000 303769 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=303769) [rank0]:W0126 06:44:46.381000 303769 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 2 large pointwise nodes are separated
(EngineCore_DP0 pid=303769) Process EngineCore_DP0:
(EngineCore_DP0 pid=303769) Traceback (most recent call last):
(EngineCore_DP0 pid=303769)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=303769)     self.run()
(EngineCore_DP0 pid=303769)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=303769)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=303769)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=303769)     raise e
(EngineCore_DP0 pid=303769)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=303769)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=303769)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=303769)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=303769)     super().__init__(
(EngineCore_DP0 pid=303769)   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=303769)     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=303769)                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=303769)   File "/root/vllmbench/vllm/v1/engine/core.py", line 248, in _initialize_kv_caches
(EngineCore_DP0 pid=303769)     kv_cache_configs = get_kv_cache_configs(
(EngineCore_DP0 pid=303769)                        ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=303769)   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 1340, in get_kv_cache_configs
(EngineCore_DP0 pid=303769)     check_enough_kv_cache_memory(
(EngineCore_DP0 pid=303769)   File "/root/vllmbench/vllm/v1/core/kv_cache_utils.py", line 687, in check_enough_kv_cache_memory
(EngineCore_DP0 pid=303769)     raise ValueError(
(EngineCore_DP0 pid=303769) ValueError: No available memory for the cache blocks. Try increasing `gpu_memory_utilization` when initializing the engine. See https://docs.vllm.ai/en/latest/configuration/conserving_memory/ for more details.
[rank0]:[W126 06:53:47.031009147 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

[ERROR] 测试失败: M=65536 (exit code: 1)


------------------------------------------------------------
  生成 CSV: Qwen2.5-14B-INT8
------------------------------------------------------------
[SUCCESS] CSV 保存到: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX4090_cc89_INT8_py312_cu129_x86_64/cusparselt/2_10/Qwen2.5-14B-INT8_prefill.csv

预览:
------------------------------------------------------------
M_prefill,prompt_len,max_num_seqs,num_prompts,N_prefill,requests_per_s,tokens_per_s,elapsed_time_s
512,512,1,128,128,-1.0000,-1.0000,-1.0000
1024,1024,1,128,128,-1.0000,-1.0000,-1.0000
2048,1024,2,256,128,-1.0000,-1.0000,-1.0000
4096,1024,4,512,128,-1.0000,-1.0000,-1.0000
8192,1024,8,1024,128,-1.0000,-1.0000,-1.0000
16384,1024,16,2048,128,-1.0000,-1.0000,-1.0000
32768,1024,32,4096,128,-1.0000,-1.0000,-1.0000
65536,1024,64,8192,128,-1.0000,-1.0000,-1.0000

------------------------------------------------------------

[INFO] 完成: 0 成功, 8 失败


============================================================
  Benchmark 完成!
============================================================


总计: 24 成功, 16 失败
============================================================
