======================================================================
SlideSparse vLLM Throughput Benchmark Log
Created: 2026-01-22 00:07:28
======================================================================

原始命令:
  throughput_benchmark.py --model qwen2.5-0.5b-fp8 --M 16 --stage prefill --backend cusparselt --sparsity 2_6

命令行参数:
  --model: qwen2.5-0.5b-fp8
  --backend: cusparselt
  --sparsity: 2_6
  --stage: prefill
  --M: 16
  --N: None
  --inner-32: False
  --eager: False
  --gpu-id: 0
  --gpu-mem: 0.9
  --dry-run: False
  --list-models: False

硬件信息:
  GPU: RTX5080
  Compute Capability: cc120
  VRAM: 15.5 GB
  CUDA: 12.9
  Python: py312

======================================================================


============================================================
  Qwen2.5-0.5B-FP8 | cuSPARSELt (2_6) | prefill
============================================================

[INFO] Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-0.5B-FP8-SlideSparse-2_6
[INFO] Output: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX5080_cc120_FP8E4M3_py312_cu129_x86_64/cusparselt/2_6

============================================================
[1/1] 测试 M=16
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-0.5B-FP8
│ Backend:  cuSPARSELt (2:6)
│ 阶段:     prefill
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度:
│   M_prefill = 16 (= 1 x 16)
│   M_decode  = 1
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len       = 16
│   --output-len      = 1
│   --num-prompts     = 128
│   --max-num-seqs    = 1
│   --max-model-len   = 145
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...
[ERROR] 测试失败: M=16 (exit code: 1)

─── 错误输出 (最后 10 行) ───
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}
─────────────────────────────────


------------------------------------------------------------
  生成 CSV: Qwen2.5-0.5B-FP8
------------------------------------------------------------
[SUCCESS] CSV 保存到: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX5080_cc120_FP8E4M3_py312_cu129_x86_64/cusparselt/2_6/Qwen2.5-0.5B-FP8_prefill.csv

预览:
------------------------------------------------------------
M_prefill,prompt_len,max_num_seqs,num_prompts,N_prefill,requests_per_s,tokens_per_s,elapsed_time_s

------------------------------------------------------------

[INFO] 完成: 0 成功, 1 失败


============================================================
  Benchmark 完成!
============================================================


总计: 0 成功, 1 失败
============================================================
