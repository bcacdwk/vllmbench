======================================================================
SlideSparse vLLM Throughput Benchmark Log
Created: 2026-01-26 02:38:54
======================================================================

原始命令:
  /root/vllmbench/slidesparse/tools/throughput_benchmark.py --model qwen2.5-7b-int8 --stage prefill --backend cusparselt --M 8192 --gpu-mem 0.7 --gpu-id 1 --sparsity 2_8

命令行参数:
  --model: qwen2.5-7b-int8
  --backend: cusparselt
  --sparsity: 2_8
  --stage: prefill
  --M: 8192
  --N: None
  --inner-32: False
  --eager: False
  --gpu-id: 1
  --gpu-mem: 0.7
  --dry-run: False
  --list-models: False

硬件信息:
  GPU: RTX5080
  Compute Capability: cc120
  VRAM: 15.5 GB
  CUDA: 12.9
  Python: py312

Backend 环境变量 (初始状态):
  DISABLE_SLIDESPARSE: 未设置
  USE_CUBLASLT: 未设置
  USE_CUSPARSELT: 未设置
  SPARSITY: 未设置
  INNER_DTYPE_32: 未设置

======================================================================


============================================================
  Qwen2.5-7B-INT8 | cuSPARSELt (2_8) | prefill
============================================================

[INFO] Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_8
[INFO] Output: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX5080_cc120_INT8_py312_cu129_x86_64/cusparselt/2_8

============================================================
[1/1] 测试 M=8192
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-INT8                                 │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 8192
│   M_prefill     = 8192 (= 8 x 1024)
│   M_decode      = 8
│   batched_tokens = 8192 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 1024
│   --max-num-seqs           = 8
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 8192
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 02:39:01 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=857104) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=857104) WARNING 01-26 02:39:14 [backends.py:609] Failed to read file <frozen os>
Throughput: 19.40 requests/s, 19880.98 total tokens/s, 19.40 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024


─── STDERR ───
[2026-01-26 02:39:01] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 02:39:01] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:39:01] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 02:39:01] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:39:01] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:39:01] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:39:01] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:39:01] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:39:01] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:39:01] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 02:39:01] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 02:39:01] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 02:39:01] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 02:39:01] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 02:39:05] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 02:39:05] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:39:05] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 02:39:05] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:39:05] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:39:05] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:39:05] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:39:05] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 02:39:05] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 02:39:05] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 02:39:05] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 02:39:05] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 02:39:05] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 02:39:05] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=857104) [2026-01-26 02:39:05] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=857104) [2026-01-26 02:39:05] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=857104) [2026-01-26 02:39:05] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=857104) [2026-01-26 02:39:05] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=857104) [2026-01-26 02:39:05] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=857104) [2026-01-26 02:39:05] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=857104) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=857104) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:01<00:01,  1.55s/it]
(EngineCore_DP0 pid=857104) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:03<00:00,  1.76s/it]
(EngineCore_DP0 pid=857104) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:03<00:00,  1.73s/it]
(EngineCore_DP0 pid=857104) 
(EngineCore_DP0 pid=857104) [2026-01-26 02:39:09] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=857104) [2026-01-26 02:39:09] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 18579456 bytes
(EngineCore_DP0 pid=857104) [2026-01-26 02:39:09] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=857104) [2026-01-26 02:39:09] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 14450688 bytes
(EngineCore_DP0 pid=857104) [2026-01-26 02:39:09] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=857104) [2026-01-26 02:39:09] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 152764416 bytes
(EngineCore_DP0 pid=857104) [2026-01-26 02:39:09] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=857104) [2026-01-26 02:39:09] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 76382208 bytes
(EngineCore_DP0 pid=857104) 2026-01-26 02:39:17,344 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=857104) 2026-01-26 02:39:17,358 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=857104) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:00,  4.35it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00, 15.40it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00, 13.36it/s]
(EngineCore_DP0 pid=857104) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:00,  5.99it/s]
Capturing CUDA graphs (decode, FULL):  75%|███████▌  | 3/4 [00:00<00:00, 12.30it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00, 12.25it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   5%|▍         | 50/1024 [00:00<00:01, 490.54it/s]
Adding requests:  10%|█         | 105/1024 [00:00<00:01, 524.98it/s]
Adding requests:  16%|█▌        | 162/1024 [00:00<00:01, 543.48it/s]
Adding requests:  22%|██▏       | 224/1024 [00:00<00:01, 568.26it/s]
Adding requests:  28%|██▊       | 282/1024 [00:00<00:01, 570.89it/s]
Adding requests:  33%|███▎      | 343/1024 [00:00<00:01, 583.40it/s]
Adding requests:  40%|███▉      | 405/1024 [00:00<00:01, 593.36it/s]
Adding requests:  45%|████▌     | 465/1024 [00:00<00:00, 585.25it/s]
Adding requests:  52%|█████▏    | 530/1024 [00:00<00:00, 602.89it/s]
Adding requests:  58%|█████▊    | 591/1024 [00:01<00:00, 593.64it/s]
Adding requests:  64%|██████▎   | 651/1024 [00:01<00:00, 587.94it/s]
Adding requests:  69%|██████▉   | 710/1024 [00:01<00:00, 588.54it/s]
Adding requests:  75%|███████▌  | 769/1024 [00:01<00:00, 582.42it/s]
Adding requests:  81%|████████  | 830/1024 [00:01<00:00, 589.29it/s]
Adding requests:  87%|████████▋ | 890/1024 [00:01<00:00, 591.18it/s]
Adding requests:  93%|█████████▎| 950/1024 [00:01<00:00, 575.32it/s]
Adding requests:  98%|█████████▊| 1008/1024 [00:01<00:00, 574.92it/s]
Adding requests: 100%|██████████| 1024/1024 [00:01<00:00, 578.41it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   3%|▎         | 34/1024 [00:00<00:11, 89.39it/s, est. speed input: 91540.33 toks/s, output: 89.39 toks/s]
Processed prompts:   4%|▍         | 43/1024 [00:00<00:20, 48.51it/s, est. speed input: 55717.39 toks/s, output: 54.41 toks/s]
Processed prompts:   5%|▍         | 50/1024 [00:01<00:28, 33.92it/s, est. speed input: 42664.13 toks/s, output: 41.66 toks/s]
Processed prompts:   6%|▌         | 58/1024 [00:01<00:34, 28.18it/s, est. speed input: 36893.02 toks/s, output: 36.03 toks/s]
Processed prompts:   6%|▋         | 66/1024 [00:02<00:38, 25.04it/s, est. speed input: 33459.13 toks/s, output: 32.67 toks/s]
Processed prompts:   7%|▋         | 74/1024 [00:02<00:41, 23.14it/s, est. speed input: 31181.46 toks/s, output: 30.45 toks/s]
Processed prompts:   8%|▊         | 82/1024 [00:02<00:42, 21.95it/s, est. speed input: 29563.97 toks/s, output: 28.87 toks/s]
Processed prompts:   9%|▉         | 90/1024 [00:03<00:44, 21.17it/s, est. speed input: 28351.78 toks/s, output: 27.69 toks/s]
Processed prompts:  10%|▉         | 98/1024 [00:03<00:44, 20.64it/s, est. speed input: 27410.59 toks/s, output: 26.77 toks/s]
Processed prompts:  10%|█         | 106/1024 [00:04<00:45, 20.29it/s, est. speed input: 26659.18 toks/s, output: 26.03 toks/s]
Processed prompts:  11%|█         | 114/1024 [00:04<00:45, 20.05it/s, est. speed input: 26046.97 toks/s, output: 25.44 toks/s]
Processed prompts:  12%|█▏        | 122/1024 [00:04<00:45, 19.87it/s, est. speed input: 25534.43 toks/s, output: 24.94 toks/s]
Processed prompts:  13%|█▎        | 130/1024 [00:05<00:45, 19.75it/s, est. speed input: 25100.17 toks/s, output: 24.51 toks/s]
Processed prompts:  13%|█▎        | 138/1024 [00:05<00:45, 19.66it/s, est. speed input: 24728.16 toks/s, output: 24.15 toks/s]
Processed prompts:  14%|█▍        | 146/1024 [00:06<00:44, 19.60it/s, est. speed input: 24406.55 toks/s, output: 23.83 toks/s]
Processed prompts:  15%|█▌        | 154/1024 [00:06<00:44, 19.56it/s, est. speed input: 24125.83 toks/s, output: 23.56 toks/s]
Processed prompts:  16%|█▌        | 162/1024 [00:06<00:44, 19.53it/s, est. speed input: 23876.70 toks/s, output: 23.32 toks/s]
Processed prompts:  17%|█▋        | 170/1024 [00:07<00:43, 19.51it/s, est. speed input: 23656.19 toks/s, output: 23.10 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [00:07<00:43, 19.49it/s, est. speed input: 23458.52 toks/s, output: 22.91 toks/s]
Processed prompts:  18%|█▊        | 186/1024 [00:08<00:43, 19.48it/s, est. speed input: 23281.04 toks/s, output: 22.74 toks/s]
Processed prompts:  19%|█▉        | 194/1024 [00:08<00:42, 19.47it/s, est. speed input: 23119.55 toks/s, output: 22.58 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [00:09<00:42, 19.47it/s, est. speed input: 22973.54 toks/s, output: 22.44 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:09<00:41, 19.46it/s, est. speed input: 22839.54 toks/s, output: 22.30 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [00:09<00:41, 19.46it/s, est. speed input: 22717.15 toks/s, output: 22.18 toks/s]
Processed prompts:  22%|██▏       | 226/1024 [00:10<00:41, 19.45it/s, est. speed input: 22604.22 toks/s, output: 22.07 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:10<00:40, 19.45it/s, est. speed input: 22500.23 toks/s, output: 21.97 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:11<00:40, 19.45it/s, est. speed input: 22404.17 toks/s, output: 21.88 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:11<00:39, 19.44it/s, est. speed input: 22314.10 toks/s, output: 21.79 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:11<00:39, 19.45it/s, est. speed input: 22231.36 toks/s, output: 21.71 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:12<00:38, 19.45it/s, est. speed input: 22153.64 toks/s, output: 21.63 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:12<00:38, 19.45it/s, est. speed input: 22081.03 toks/s, output: 21.56 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:13<00:38, 19.44it/s, est. speed input: 22012.15 toks/s, output: 21.50 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:13<00:37, 19.44it/s, est. speed input: 21947.80 toks/s, output: 21.43 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:13<00:37, 19.43it/s, est. speed input: 21887.11 toks/s, output: 21.37 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:14<00:36, 19.44it/s, est. speed input: 21830.65 toks/s, output: 21.32 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:14<00:36, 19.44it/s, est. speed input: 21776.97 toks/s, output: 21.27 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:15<00:36, 19.44it/s, est. speed input: 21726.12 toks/s, output: 21.22 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:15<00:35, 19.43it/s, est. speed input: 21677.66 toks/s, output: 21.17 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:16<00:35, 19.43it/s, est. speed input: 21631.74 toks/s, output: 21.12 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:16<00:34, 19.43it/s, est. speed input: 21588.27 toks/s, output: 21.08 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:16<00:34, 19.43it/s, est. speed input: 21547.05 toks/s, output: 21.04 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:17<00:34, 19.43it/s, est. speed input: 21507.53 toks/s, output: 21.00 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:17<00:33, 19.43it/s, est. speed input: 21469.66 toks/s, output: 20.97 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:18<00:33, 19.43it/s, est. speed input: 21433.84 toks/s, output: 20.93 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:18<00:32, 19.43it/s, est. speed input: 21399.53 toks/s, output: 20.90 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [00:18<00:32, 19.42it/s, est. speed input: 21366.40 toks/s, output: 20.87 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:19<00:32, 19.42it/s, est. speed input: 21334.79 toks/s, output: 20.83 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:19<00:31, 19.42it/s, est. speed input: 21304.58 toks/s, output: 20.81 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:20<00:31, 19.42it/s, est. speed input: 21275.36 toks/s, output: 20.78 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:20<00:30, 19.42it/s, est. speed input: 21247.41 toks/s, output: 20.75 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:20<00:30, 19.42it/s, est. speed input: 21220.43 toks/s, output: 20.72 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:21<00:29, 19.41it/s, est. speed input: 21194.17 toks/s, output: 20.70 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:21<00:29, 19.41it/s, est. speed input: 21169.15 toks/s, output: 20.67 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:22<00:29, 19.41it/s, est. speed input: 21145.22 toks/s, output: 20.65 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:22<00:28, 19.41it/s, est. speed input: 21122.23 toks/s, output: 20.63 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:23<00:28, 19.41it/s, est. speed input: 21100.07 toks/s, output: 20.61 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:23<00:27, 19.42it/s, est. speed input: 21078.67 toks/s, output: 20.58 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:23<00:27, 19.42it/s, est. speed input: 21057.99 toks/s, output: 20.56 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:24<00:27, 19.41it/s, est. speed input: 21037.73 toks/s, output: 20.54 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:24<00:26, 19.41it/s, est. speed input: 21018.38 toks/s, output: 20.53 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:25<00:26, 19.41it/s, est. speed input: 20999.53 toks/s, output: 20.51 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:25<00:25, 19.41it/s, est. speed input: 20981.57 toks/s, output: 20.49 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:25<00:25, 19.41it/s, est. speed input: 20963.84 toks/s, output: 20.47 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:26<00:25, 19.41it/s, est. speed input: 20946.67 toks/s, output: 20.46 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:26<00:24, 19.41it/s, est. speed input: 20930.15 toks/s, output: 20.44 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:27<00:24, 19.41it/s, est. speed input: 20914.07 toks/s, output: 20.42 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:27<00:23, 19.41it/s, est. speed input: 20898.46 toks/s, output: 20.41 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:27<00:23, 19.40it/s, est. speed input: 20883.06 toks/s, output: 20.39 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:28<00:22, 19.40it/s, est. speed input: 20868.07 toks/s, output: 20.38 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:28<00:22, 19.40it/s, est. speed input: 20853.80 toks/s, output: 20.37 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:29<00:22, 19.39it/s, est. speed input: 20839.57 toks/s, output: 20.35 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:29<00:21, 19.39it/s, est. speed input: 20825.75 toks/s, output: 20.34 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:30<00:21, 19.40it/s, est. speed input: 20812.66 toks/s, output: 20.32 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:30<00:20, 19.40it/s, est. speed input: 20800.03 toks/s, output: 20.31 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:30<00:20, 19.40it/s, est. speed input: 20787.25 toks/s, output: 20.30 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:31<00:20, 19.40it/s, est. speed input: 20775.13 toks/s, output: 20.29 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:31<00:19, 19.39it/s, est. speed input: 20763.10 toks/s, output: 20.28 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:32<00:19, 19.39it/s, est. speed input: 20751.32 toks/s, output: 20.26 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:32<00:18, 19.39it/s, est. speed input: 20740.10 toks/s, output: 20.25 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:32<00:18, 19.39it/s, est. speed input: 20728.76 toks/s, output: 20.24 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:33<00:18, 19.39it/s, est. speed input: 20718.10 toks/s, output: 20.23 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:33<00:17, 19.39it/s, est. speed input: 20707.66 toks/s, output: 20.22 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:34<00:17, 19.39it/s, est. speed input: 20697.27 toks/s, output: 20.21 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:34<00:16, 19.39it/s, est. speed input: 20687.13 toks/s, output: 20.20 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:34<00:16, 19.39it/s, est. speed input: 20677.33 toks/s, output: 20.19 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:35<00:15, 19.38it/s, est. speed input: 20667.37 toks/s, output: 20.18 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:35<00:15, 19.38it/s, est. speed input: 20657.88 toks/s, output: 20.17 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:36<00:15, 19.38it/s, est. speed input: 20648.70 toks/s, output: 20.16 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:36<00:14, 19.38it/s, est. speed input: 20639.53 toks/s, output: 20.16 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:37<00:14, 19.38it/s, est. speed input: 20630.75 toks/s, output: 20.15 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:37<00:13, 19.38it/s, est. speed input: 20621.97 toks/s, output: 20.14 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:37<00:13, 19.38it/s, est. speed input: 20613.42 toks/s, output: 20.13 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:38<00:13, 19.38it/s, est. speed input: 20605.08 toks/s, output: 20.12 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:38<00:12, 19.38it/s, est. speed input: 20597.04 toks/s, output: 20.11 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:39<00:12, 19.38it/s, est. speed input: 20589.07 toks/s, output: 20.11 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:39<00:11, 19.38it/s, est. speed input: 20581.38 toks/s, output: 20.10 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:39<00:11, 19.38it/s, est. speed input: 20573.61 toks/s, output: 20.09 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:40<00:11, 19.37it/s, est. speed input: 20566.04 toks/s, output: 20.08 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:40<00:10, 19.37it/s, est. speed input: 20558.69 toks/s, output: 20.08 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:41<00:10, 19.38it/s, est. speed input: 20551.61 toks/s, output: 20.07 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:41<00:09, 19.37it/s, est. speed input: 20544.41 toks/s, output: 20.06 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [00:41<00:09, 19.38it/s, est. speed input: 20537.57 toks/s, output: 20.06 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [00:42<00:08, 19.37it/s, est. speed input: 20530.73 toks/s, output: 20.05 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:42<00:08, 19.36it/s, est. speed input: 20523.72 toks/s, output: 20.04 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [00:43<00:08, 19.37it/s, est. speed input: 20517.23 toks/s, output: 20.04 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [00:43<00:07, 19.37it/s, est. speed input: 20510.72 toks/s, output: 20.03 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [00:44<00:07, 19.37it/s, est. speed input: 20504.44 toks/s, output: 20.02 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [00:44<00:06, 19.37it/s, est. speed input: 20498.22 toks/s, output: 20.02 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [00:44<00:06, 19.37it/s, est. speed input: 20492.13 toks/s, output: 20.01 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [00:45<00:06, 19.37it/s, est. speed input: 20486.15 toks/s, output: 20.01 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [00:45<00:05, 19.36it/s, est. speed input: 20480.00 toks/s, output: 20.00 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [00:46<00:05, 19.36it/s, est. speed input: 20474.17 toks/s, output: 19.99 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [00:46<00:04, 19.36it/s, est. speed input: 20468.32 toks/s, output: 19.99 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [00:46<00:04, 19.36it/s, est. speed input: 20462.71 toks/s, output: 19.98 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [00:47<00:04, 19.36it/s, est. speed input: 20457.21 toks/s, output: 19.98 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [00:47<00:03, 19.36it/s, est. speed input: 20451.77 toks/s, output: 19.97 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [00:48<00:03, 19.36it/s, est. speed input: 20446.35 toks/s, output: 19.97 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [00:48<00:02, 19.36it/s, est. speed input: 20441.16 toks/s, output: 19.96 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [00:49<00:02, 19.36it/s, est. speed input: 20435.93 toks/s, output: 19.96 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [00:49<00:01, 19.36it/s, est. speed input: 20430.69 toks/s, output: 19.95 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [00:49<00:01, 19.35it/s, est. speed input: 20425.55 toks/s, output: 19.95 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [00:50<00:01, 19.35it/s, est. speed input: 20420.57 toks/s, output: 19.94 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [00:50<00:00, 19.35it/s, est. speed input: 20415.59 toks/s, output: 19.94 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [00:51<00:00, 20.08it/s, est. speed input: 20430.68 toks/s, output: 19.95 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:51<00:00, 20.08it/s, est. speed input: 20551.05 toks/s, output: 20.07 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:51<00:00, 20.07it/s, est. speed input: 20551.05 toks/s, output: 20.07 toks/s]
[rank0]:[W126 02:40:11.698203560 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 79.0s

测试结果:
  Requests/s:   19.40
  Tokens/s:     19880.98
  Total Reqs:   1024
  Elapsed:      52.79s

  [Prefill 分析]
  Total Prefill Tokens: 1048576
  Prefill Tokens/s:     19861.58


------------------------------------------------------------
  生成 CSV: Qwen2.5-7B-INT8
------------------------------------------------------------
[SUCCESS] CSV 保存到: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX5080_cc120_INT8_py312_cu129_x86_64/cusparselt/2_8/Qwen2.5-7B-INT8_prefill.csv

预览:
------------------------------------------------------------
M_prefill,prompt_len,max_num_seqs,num_prompts,N_prefill,requests_per_s,tokens_per_s,elapsed_time_s
8192,1024,8,1024,128,19.3961,19880.9798,52.7942

------------------------------------------------------------

[INFO] 完成: 1 成功, 0 失败


============================================================
  Benchmark 完成!
============================================================


总计: 1 成功, 0 失败
============================================================
