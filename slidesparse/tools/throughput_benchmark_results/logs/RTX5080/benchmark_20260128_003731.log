======================================================================
SlideSparse vLLM Throughput Benchmark Log
Created: 2026-01-28 00:37:31
======================================================================

原始命令:
  /root/vllmbench/slidesparse/tools/throughput_benchmark.py --model bitnet1.58-2b-fp8 --backend cublaslt,cusparselt --stage prefill --sparsity 2_4,2_6,2_8,2_10 --M 512,1024,2048,4096,8192,16384,32768

命令行参数:
  --model: bitnet1.58-2b-fp8
  --backend: cublaslt,cusparselt
  --sparsity: 2_4,2_6,2_8,2_10
  --stage: prefill
  --M: 512,1024,2048,4096,8192,16384,32768
  --N: None
  --inner-32: False
  --eager: False
  --gpu-id: 0
  --gpu-mem: 0.8
  --dry-run: False
  --list-models: False

硬件信息:
  GPU: RTX5080
  Compute Capability: cc120
  VRAM: 15.5 GB
  CUDA: 12.9
  Python: py312

Backend 环境变量 (初始状态):
  DISABLE_SLIDESPARSE: 未设置
  USE_CUBLASLT: 未设置
  USE_CUSPARSELT: 未设置
  SPARSITY: 未设置
  INNER_DTYPE_32: 未设置

======================================================================


============================================================
  BitNet-2B-FP8 | cuBLASLt | prefill
============================================================

[INFO] Checkpoint: /root/vllmbench/checkpoints/BitNet-2B-FP8
[INFO] Output: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX5080_cc120_FP8E4M3_py312_cu129_x86_64/cublaslt

============================================================
[1/7] 测试 M=512
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuBLASLt                                        │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 512
│   M_prefill     = 512 (= 1 x 512)
│   M_decode      = 1
│   batched_tokens = 513 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 512
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 513
│   --max-num-batched-tokens = 513
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:37:35 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3492279) WARNING 01-28 00:37:44 [backends.py:609] Failed to read file <frozen os>
Throughput: 51.17 requests/s, 26249.32 total tokens/s, 51.17 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128


─── STDERR ───
[2026-01-28 00:37:35] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:37:35] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:37:35] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:37:35] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:37:35] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:37:35] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:37:35] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:37:35] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:37:35] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:37:35] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:37:35] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:37:35] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:37:35] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:37:35] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:37:39] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:37:39] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:37:39] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:37:39] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:37:39] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:37:39] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:37:39] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:37:39] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:37:39] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:37:39] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:37:39] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:37:39] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:37:39] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:37:39] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3492279) [2026-01-28 00:37:40] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=3492279) [2026-01-28 00:37:40] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3492279) [2026-01-28 00:37:40] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=3492279) [2026-01-28 00:37:40] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3492279) [2026-01-28 00:37:40] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuBLASLt
(EngineCore_DP0 pid=3492279) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3492279) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.03it/s]
(EngineCore_DP0 pid=3492279) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.03it/s]
(EngineCore_DP0 pid=3492279) 
(EngineCore_DP0 pid=3492279) 2026-01-28 00:37:51,110 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3492279) 2026-01-28 00:37:51,126 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3492279) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  5.92it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  5.86it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  5.87it/s]
(EngineCore_DP0 pid=3492279) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.11it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.11it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  85%|████████▌ | 109/128 [00:00<00:00, 1080.65it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 1106.00it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:04, 25.74it/s, est. speed input: 13177.87 toks/s, output: 25.74 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:00<00:02, 42.04it/s, est. speed input: 20244.74 toks/s, output: 39.54 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:00<00:02, 47.63it/s, est. speed input: 22737.88 toks/s, output: 44.41 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:00<00:02, 50.70it/s, est. speed input: 24121.38 toks/s, output: 47.11 toks/s]
Processed prompts:  21%|██        | 27/128 [00:00<00:01, 52.16it/s, est. speed input: 24894.48 toks/s, output: 48.62 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:00<00:01, 53.50it/s, est. speed input: 25518.17 toks/s, output: 49.84 toks/s]
Processed prompts:  30%|███       | 39/128 [00:00<00:01, 53.94it/s, est. speed input: 25881.79 toks/s, output: 50.55 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:00<00:01, 54.45it/s, est. speed input: 26195.82 toks/s, output: 51.16 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:00<00:01, 54.68it/s, est. speed input: 26421.99 toks/s, output: 51.61 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:01<00:01, 55.06it/s, est. speed input: 26638.99 toks/s, output: 52.03 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:01<00:01, 55.22it/s, est. speed input: 26802.24 toks/s, output: 52.35 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:01<00:01, 54.85it/s, est. speed input: 26874.34 toks/s, output: 52.49 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:01<00:00, 55.02it/s, est. speed input: 26989.02 toks/s, output: 52.71 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:01<00:00, 55.07it/s, est. speed input: 27078.62 toks/s, output: 52.89 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:01<00:00, 54.96it/s, est. speed input: 27141.21 toks/s, output: 53.01 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:01<00:00, 54.49it/s, est. speed input: 27154.46 toks/s, output: 53.04 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:01<00:00, 54.85it/s, est. speed input: 27234.00 toks/s, output: 53.19 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:01<00:00, 54.92it/s, est. speed input: 27286.98 toks/s, output: 53.29 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:02<00:00, 55.22it/s, est. speed input: 27356.81 toks/s, output: 53.43 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:02<00:00, 54.98it/s, est. speed input: 27382.40 toks/s, output: 53.48 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:02<00:00, 55.25it/s, est. speed input: 27439.97 toks/s, output: 53.59 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:02<00:00, 55.25it/s, est. speed input: 27490.11 toks/s, output: 53.69 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:02<00:00, 53.69it/s, est. speed input: 27490.11 toks/s, output: 53.69 toks/s]
[rank0]:[W128 00:37:55.004993257 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 24.7s

测试结果:
  Requests/s:   51.17
  Tokens/s:     26249.32
  Total Reqs:   128
  Elapsed:      2.50s

  [Prefill 分析]
  Total Prefill Tokens: 65536
  Prefill Tokens/s:     26198.16

============================================================
[2/7] 测试 M=1024
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuBLASLt                                        │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 1024
│   M_prefill     = 1024 (= 1 x 1024)
│   M_decode      = 1
│   batched_tokens = 1025 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 1025
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:38:00 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3492992) WARNING 01-28 00:38:09 [backends.py:609] Failed to read file <frozen os>
Throughput: 35.36 requests/s, 36240.56 total tokens/s, 35.36 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128


─── STDERR ───
[2026-01-28 00:38:00] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:38:00] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:38:00] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:38:00] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:38:00] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:38:00] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:38:00] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:38:00] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:38:00] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:38:00] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:38:00] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:38:00] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:38:00] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:38:00] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:38:04] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:38:04] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:38:04] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:38:04] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:38:04] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:38:04] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:38:04] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:38:04] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:38:04] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:38:04] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:38:04] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:38:04] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:38:04] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:38:04] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3492992) [2026-01-28 00:38:05] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=3492992) [2026-01-28 00:38:05] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3492992) [2026-01-28 00:38:05] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=3492992) [2026-01-28 00:38:05] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3492992) [2026-01-28 00:38:05] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuBLASLt
(EngineCore_DP0 pid=3492992) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3492992) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.63it/s]
(EngineCore_DP0 pid=3492992) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.63it/s]
(EngineCore_DP0 pid=3492992) 
(EngineCore_DP0 pid=3492992) 2026-01-28 00:38:15,493 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3492992) 2026-01-28 00:38:15,510 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3492992) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00, 23.16it/s]
(EngineCore_DP0 pid=3492992) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.25it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.24it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  49%|████▉     | 63/128 [00:00<00:00, 628.52it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 679.75it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:00<00:01, 74.92it/s, est. speed input: 76727.36 toks/s, output: 74.92 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:00<00:02, 46.74it/s, est. speed input: 50906.58 toks/s, output: 49.71 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:00<00:02, 42.01it/s, est. speed input: 46277.08 toks/s, output: 45.19 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:00<00:02, 39.95it/s, est. speed input: 44260.10 toks/s, output: 43.22 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:00<00:02, 38.69it/s, est. speed input: 42973.50 toks/s, output: 41.97 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:00<00:02, 37.88it/s, est. speed input: 42182.31 toks/s, output: 41.19 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:01<00:02, 37.33it/s, est. speed input: 41583.77 toks/s, output: 40.61 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:01<00:02, 36.91it/s, est. speed input: 41103.19 toks/s, output: 40.14 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:01<00:02, 36.67it/s, est. speed input: 40727.02 toks/s, output: 39.77 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:01<00:02, 36.48it/s, est. speed input: 40409.35 toks/s, output: 39.46 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:01<00:01, 36.38it/s, est. speed input: 40149.40 toks/s, output: 39.21 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:01<00:01, 36.19it/s, est. speed input: 39895.65 toks/s, output: 38.96 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:01<00:01, 36.10it/s, est. speed input: 39687.92 toks/s, output: 38.76 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:01<00:01, 36.06it/s, est. speed input: 39510.22 toks/s, output: 38.58 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:01<00:01, 36.05it/s, est. speed input: 39356.57 toks/s, output: 38.43 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:02<00:01, 36.00it/s, est. speed input: 39210.87 toks/s, output: 38.29 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:02<00:01, 35.99it/s, est. speed input: 39087.59 toks/s, output: 38.17 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:02<00:01, 35.99it/s, est. speed input: 38975.91 toks/s, output: 38.06 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:02<00:01, 35.99it/s, est. speed input: 38875.98 toks/s, output: 37.96 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:02<00:00, 35.99it/s, est. speed input: 38784.69 toks/s, output: 37.88 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:02<00:00, 35.93it/s, est. speed input: 38691.99 toks/s, output: 37.79 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:02<00:00, 35.93it/s, est. speed input: 38612.77 toks/s, output: 37.71 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:02<00:00, 35.96it/s, est. speed input: 38544.14 toks/s, output: 37.64 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:02<00:00, 35.96it/s, est. speed input: 38477.71 toks/s, output: 37.58 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:03<00:00, 35.89it/s, est. speed input: 38407.07 toks/s, output: 37.51 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:03<00:00, 35.88it/s, est. speed input: 38346.75 toks/s, output: 37.45 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:03<00:00, 35.90it/s, est. speed input: 38294.33 toks/s, output: 37.40 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:03<00:00, 35.92it/s, est. speed input: 38245.42 toks/s, output: 37.35 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:03<00:00, 35.92it/s, est. speed input: 38211.94 toks/s, output: 37.32 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:03<00:00, 37.32it/s, est. speed input: 38211.94 toks/s, output: 37.32 toks/s]
[rank0]:[W128 00:38:20.248995437 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 25.3s

测试结果:
  Requests/s:   35.36
  Tokens/s:     36240.56
  Total Reqs:   128
  Elapsed:      3.62s

  [Prefill 分析]
  Total Prefill Tokens: 131072
  Prefill Tokens/s:     36205.20

============================================================
[3/7] 测试 M=2048
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuBLASLt                                        │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 2048
│   M_prefill     = 2048 (= 2 x 1024)
│   M_decode      = 2
│   batched_tokens = 2048 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 256
│   --max-num-seqs           = 2
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 2048
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:38:26 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3493619) WARNING 01-28 00:38:35 [backends.py:609] Failed to read file <frozen os>
Throughput: 35.80 requests/s, 36690.99 total tokens/s, 35.80 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256


─── STDERR ───
[2026-01-28 00:38:26] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:38:26] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:38:26] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:38:26] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:38:26] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:38:26] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:38:26] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:38:26] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:38:26] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:38:26] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:38:26] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:38:26] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:38:26] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:38:26] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:38:29] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:38:30] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:38:30] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:38:30] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:38:30] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:38:30] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:38:30] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:38:30] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:38:30] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:38:30] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:38:30] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:38:30] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:38:30] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:38:30] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3493619) [2026-01-28 00:38:31] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=3493619) [2026-01-28 00:38:31] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3493619) [2026-01-28 00:38:31] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=3493619) [2026-01-28 00:38:31] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3493619) [2026-01-28 00:38:31] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuBLASLt
(EngineCore_DP0 pid=3493619) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3493619) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.63it/s]
(EngineCore_DP0 pid=3493619) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.63it/s]
(EngineCore_DP0 pid=3493619) 
(EngineCore_DP0 pid=3493619) 2026-01-28 00:38:41,734 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3493619) 2026-01-28 00:38:41,751 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3493619) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  67%|██████▋   | 2/3 [00:00<00:00, 16.52it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00, 16.82it/s]
(EngineCore_DP0 pid=3493619) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 1/2 [00:00<00:00,  7.18it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  9.95it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  25%|██▌       | 65/256 [00:00<00:00, 643.08it/s]
Adding requests:  55%|█████▌    | 141/256 [00:00<00:00, 708.52it/s]
Adding requests:  84%|████████▍ | 215/256 [00:00<00:00, 718.91it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 716.38it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▌         | 14/256 [00:00<00:02, 120.90it/s, est. speed input: 123817.86 toks/s, output: 120.91 toks/s]
Processed prompts:  11%|█         | 27/256 [00:00<00:04, 55.22it/s, est. speed input: 61765.80 toks/s, output: 60.32 toks/s]   
Processed prompts:  14%|█▎        | 35/256 [00:00<00:04, 46.95it/s, est. speed input: 53574.76 toks/s, output: 52.32 toks/s]
Processed prompts:  16%|█▌        | 41/256 [00:00<00:04, 43.52it/s, est. speed input: 50283.81 toks/s, output: 49.11 toks/s]
Processed prompts:  18%|█▊        | 46/256 [00:01<00:05, 39.33it/s, est. speed input: 47053.88 toks/s, output: 45.95 toks/s]
Processed prompts:  20%|█▉        | 51/256 [00:01<00:05, 40.66it/s, est. speed input: 46970.82 toks/s, output: 45.87 toks/s]
Processed prompts:  22%|██▏       | 56/256 [00:01<00:05, 37.21it/s, est. speed input: 44884.32 toks/s, output: 43.83 toks/s]
Processed prompts:  23%|██▎       | 60/256 [00:01<00:05, 36.99it/s, est. speed input: 44270.32 toks/s, output: 43.23 toks/s]
Processed prompts:  25%|██▌       | 64/256 [00:01<00:05, 36.76it/s, est. speed input: 43727.65 toks/s, output: 42.70 toks/s]
Processed prompts:  27%|██▋       | 68/256 [00:01<00:05, 36.57it/s, est. speed input: 43258.18 toks/s, output: 42.24 toks/s]
Processed prompts:  28%|██▊       | 72/256 [00:01<00:05, 36.46it/s, est. speed input: 42858.38 toks/s, output: 41.85 toks/s]
Processed prompts:  30%|██▉       | 76/256 [00:01<00:04, 36.35it/s, est. speed input: 42499.06 toks/s, output: 41.50 toks/s]
Processed prompts:  31%|███▏      | 80/256 [00:01<00:04, 36.24it/s, est. speed input: 42176.07 toks/s, output: 41.19 toks/s]
Processed prompts:  33%|███▎      | 84/256 [00:02<00:04, 36.15it/s, est. speed input: 41883.91 toks/s, output: 40.90 toks/s]
Processed prompts:  34%|███▍      | 88/256 [00:02<00:04, 36.07it/s, est. speed input: 41619.36 toks/s, output: 40.64 toks/s]
Processed prompts:  36%|███▌      | 92/256 [00:02<00:04, 36.08it/s, est. speed input: 41393.29 toks/s, output: 40.42 toks/s]
Processed prompts:  38%|███▊      | 96/256 [00:02<00:04, 36.10it/s, est. speed input: 41190.10 toks/s, output: 40.22 toks/s]
Processed prompts:  39%|███▉      | 100/256 [00:02<00:04, 36.16it/s, est. speed input: 41012.26 toks/s, output: 40.05 toks/s]
Processed prompts:  41%|████      | 104/256 [00:02<00:04, 36.15it/s, est. speed input: 40842.45 toks/s, output: 39.89 toks/s]
Processed prompts:  42%|████▏     | 108/256 [00:02<00:04, 36.14it/s, est. speed input: 40684.96 toks/s, output: 39.73 toks/s]
Processed prompts:  44%|████▍     | 112/256 [00:02<00:03, 36.10it/s, est. speed input: 40535.38 toks/s, output: 39.59 toks/s]
Processed prompts:  45%|████▌     | 116/256 [00:02<00:03, 36.10it/s, est. speed input: 40400.85 toks/s, output: 39.45 toks/s]
Processed prompts:  47%|████▋     | 120/256 [00:03<00:03, 36.10it/s, est. speed input: 40276.56 toks/s, output: 39.33 toks/s]
Processed prompts:  48%|████▊     | 124/256 [00:03<00:03, 36.13it/s, est. speed input: 40163.99 toks/s, output: 39.22 toks/s]
Processed prompts:  50%|█████     | 128/256 [00:03<00:03, 36.10it/s, est. speed input: 40053.26 toks/s, output: 39.11 toks/s]
Processed prompts:  52%|█████▏    | 132/256 [00:03<00:03, 36.13it/s, est. speed input: 39955.45 toks/s, output: 39.02 toks/s]
Processed prompts:  53%|█████▎    | 136/256 [00:03<00:03, 36.14it/s, est. speed input: 39863.02 toks/s, output: 38.93 toks/s]
Processed prompts:  55%|█████▍    | 140/256 [00:03<00:03, 36.16it/s, est. speed input: 39777.13 toks/s, output: 38.84 toks/s]
Processed prompts:  56%|█████▋    | 144/256 [00:03<00:03, 36.11it/s, est. speed input: 39690.43 toks/s, output: 38.76 toks/s]
Processed prompts:  58%|█████▊    | 148/256 [00:03<00:02, 36.09it/s, est. speed input: 39609.40 toks/s, output: 38.68 toks/s]
Processed prompts:  59%|█████▉    | 152/256 [00:03<00:02, 36.10it/s, est. speed input: 39535.43 toks/s, output: 38.61 toks/s]
Processed prompts:  61%|██████    | 156/256 [00:04<00:02, 36.09it/s, est. speed input: 39464.05 toks/s, output: 38.54 toks/s]
Processed prompts:  62%|██████▎   | 160/256 [00:04<00:02, 36.05it/s, est. speed input: 39393.72 toks/s, output: 38.47 toks/s]
Processed prompts:  64%|██████▍   | 164/256 [00:04<00:02, 36.03it/s, est. speed input: 39327.28 toks/s, output: 38.41 toks/s]
Processed prompts:  66%|██████▌   | 168/256 [00:04<00:02, 36.05it/s, est. speed input: 39267.14 toks/s, output: 38.35 toks/s]
Processed prompts:  67%|██████▋   | 172/256 [00:04<00:02, 36.03it/s, est. speed input: 39207.16 toks/s, output: 38.29 toks/s]
Processed prompts:  69%|██████▉   | 176/256 [00:04<00:02, 36.03it/s, est. speed input: 39151.31 toks/s, output: 38.23 toks/s]
Processed prompts:  70%|███████   | 180/256 [00:04<00:02, 36.07it/s, est. speed input: 39102.09 toks/s, output: 38.19 toks/s]
Processed prompts:  72%|███████▏  | 184/256 [00:04<00:01, 36.09it/s, est. speed input: 39054.04 toks/s, output: 38.14 toks/s]
Processed prompts:  73%|███████▎  | 188/256 [00:04<00:01, 36.05it/s, est. speed input: 39003.33 toks/s, output: 38.09 toks/s]
Processed prompts:  75%|███████▌  | 192/256 [00:05<00:01, 35.96it/s, est. speed input: 38950.51 toks/s, output: 38.04 toks/s]
Processed prompts:  77%|███████▋  | 196/256 [00:05<00:01, 35.98it/s, est. speed input: 38905.87 toks/s, output: 37.99 toks/s]
Processed prompts:  78%|███████▊  | 200/256 [00:05<00:01, 36.03it/s, est. speed input: 38866.22 toks/s, output: 37.96 toks/s]
Processed prompts:  80%|███████▉  | 204/256 [00:05<00:01, 36.05it/s, est. speed input: 38827.26 toks/s, output: 37.92 toks/s]
Processed prompts:  81%|████████▏ | 208/256 [00:05<00:01, 36.12it/s, est. speed input: 38793.30 toks/s, output: 37.88 toks/s]
Processed prompts:  83%|████████▎ | 212/256 [00:05<00:01, 36.12it/s, est. speed input: 38757.83 toks/s, output: 37.85 toks/s]
Processed prompts:  84%|████████▍ | 216/256 [00:05<00:01, 36.10it/s, est. speed input: 38722.26 toks/s, output: 37.81 toks/s]
Processed prompts:  86%|████████▌ | 220/256 [00:05<00:00, 36.13it/s, est. speed input: 38690.58 toks/s, output: 37.78 toks/s]
Processed prompts:  88%|████████▊ | 224/256 [00:05<00:00, 36.07it/s, est. speed input: 38655.14 toks/s, output: 37.75 toks/s]
Processed prompts:  89%|████████▉ | 228/256 [00:06<00:00, 36.05it/s, est. speed input: 38621.95 toks/s, output: 37.72 toks/s]
Processed prompts:  91%|█████████ | 232/256 [00:06<00:00, 36.10it/s, est. speed input: 38594.52 toks/s, output: 37.69 toks/s]
Processed prompts:  92%|█████████▏| 236/256 [00:06<00:00, 36.05it/s, est. speed input: 38562.65 toks/s, output: 37.66 toks/s]
Processed prompts:  94%|█████████▍| 240/256 [00:06<00:00, 36.06it/s, est. speed input: 38534.84 toks/s, output: 37.63 toks/s]
Processed prompts:  95%|█████████▌| 244/256 [00:06<00:00, 36.08it/s, est. speed input: 38508.41 toks/s, output: 37.61 toks/s]
Processed prompts:  97%|█████████▋| 248/256 [00:06<00:00, 36.11it/s, est. speed input: 38483.83 toks/s, output: 37.58 toks/s]
Processed prompts:  98%|█████████▊| 252/256 [00:06<00:00, 36.14it/s, est. speed input: 38460.98 toks/s, output: 37.56 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:06<00:00, 36.14it/s, est. speed input: 38593.85 toks/s, output: 37.69 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:06<00:00, 37.69it/s, est. speed input: 38593.85 toks/s, output: 37.69 toks/s]
[rank0]:[W128 00:38:50.175480723 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 30.0s

测试结果:
  Requests/s:   35.80
  Tokens/s:     36690.99
  Total Reqs:   256
  Elapsed:      7.15s

  [Prefill 分析]
  Total Prefill Tokens: 262144
  Prefill Tokens/s:     36655.20

============================================================
[4/7] 测试 M=4096
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuBLASLt                                        │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 4096
│   M_prefill     = 4096 (= 4 x 1024)
│   M_decode      = 4
│   batched_tokens = 4096 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 512
│   --max-num-seqs           = 4
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 4096
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:38:56 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3494328) WARNING 01-28 00:39:05 [backends.py:609] Failed to read file <frozen os>
Throughput: 35.76 requests/s, 36654.52 total tokens/s, 35.76 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512


─── STDERR ───
[2026-01-28 00:38:56] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:38:56] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:38:56] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:38:56] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:38:56] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:38:56] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:38:56] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:38:56] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:38:56] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:38:56] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:38:56] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:38:56] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:38:56] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:38:56] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:39:00] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:39:00] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:39:00] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:39:00] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:39:00] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:39:00] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:39:00] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:39:00] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:39:00] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:39:00] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:39:00] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:39:00] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:39:00] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:39:00] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3494328) [2026-01-28 00:39:01] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=3494328) [2026-01-28 00:39:01] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3494328) [2026-01-28 00:39:01] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=3494328) [2026-01-28 00:39:01] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3494328) [2026-01-28 00:39:01] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuBLASLt
(EngineCore_DP0 pid=3494328) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3494328) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.68it/s]
(EngineCore_DP0 pid=3494328) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.68it/s]
(EngineCore_DP0 pid=3494328) 
(EngineCore_DP0 pid=3494328) 2026-01-28 00:39:11,904 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3494328) 2026-01-28 00:39:11,921 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3494328) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 2/4 [00:00<00:00, 15.91it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00, 13.83it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00, 14.10it/s]
(EngineCore_DP0 pid=3494328) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  33%|███▎      | 1/3 [00:00<00:00,  7.05it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00, 14.03it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:  13%|█▎        | 68/512 [00:00<00:00, 675.21it/s]
Adding requests:  28%|██▊       | 144/512 [00:00<00:00, 722.97it/s]
Adding requests:  43%|████▎     | 218/512 [00:00<00:00, 728.85it/s]
Adding requests:  58%|█████▊    | 295/512 [00:00<00:00, 744.78it/s]
Adding requests:  72%|███████▏  | 371/512 [00:00<00:00, 749.30it/s]
Adding requests:  87%|████████▋ | 447/512 [00:00<00:00, 751.26it/s]
Adding requests: 100%|██████████| 512/512 [00:00<00:00, 741.49it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▌         | 26/512 [00:00<00:03, 152.03it/s, est. speed input: 155688.74 toks/s, output: 152.03 toks/s]
Processed prompts:   8%|▊         | 42/512 [00:00<00:07, 60.51it/s, est. speed input: 69768.80 toks/s, output: 68.13 toks/s]   
Processed prompts:  10%|▉         | 51/512 [00:00<00:08, 53.31it/s, est. speed input: 62261.33 toks/s, output: 60.80 toks/s]
Processed prompts:  11%|█▏        | 58/512 [00:01<00:09, 45.85it/s, est. speed input: 55933.27 toks/s, output: 54.62 toks/s]
Processed prompts:  12%|█▎        | 64/512 [00:01<00:09, 47.42it/s, est. speed input: 55862.27 toks/s, output: 54.55 toks/s]
Processed prompts:  14%|█▎        | 70/512 [00:01<00:11, 40.03it/s, est. speed input: 51322.09 toks/s, output: 50.12 toks/s]
Processed prompts:  15%|█▍        | 75/512 [00:01<00:10, 41.02it/s, est. speed input: 50924.16 toks/s, output: 49.73 toks/s]
Processed prompts:  16%|█▌        | 80/512 [00:01<00:10, 41.91it/s, est. speed input: 50591.40 toks/s, output: 49.41 toks/s]
Processed prompts:  17%|█▋        | 85/512 [00:01<00:10, 42.64it/s, est. speed input: 50296.11 toks/s, output: 49.12 toks/s]
Processed prompts:  18%|█▊        | 90/512 [00:01<00:12, 34.38it/s, est. speed input: 47189.60 toks/s, output: 46.08 toks/s]
Processed prompts:  18%|█▊        | 94/512 [00:02<00:12, 34.73it/s, est. speed input: 46627.87 toks/s, output: 45.53 toks/s]
Processed prompts:  19%|█▉        | 98/512 [00:02<00:11, 34.97it/s, est. speed input: 46110.21 toks/s, output: 45.03 toks/s]
Processed prompts:  20%|█▉        | 102/512 [00:02<00:11, 35.22it/s, est. speed input: 45656.67 toks/s, output: 44.59 toks/s]
Processed prompts:  21%|██        | 106/512 [00:02<00:11, 35.35it/s, est. speed input: 45231.36 toks/s, output: 44.17 toks/s]
Processed prompts:  21%|██▏       | 110/512 [00:02<00:11, 35.53it/s, est. speed input: 44861.75 toks/s, output: 43.81 toks/s]
Processed prompts:  22%|██▏       | 114/512 [00:02<00:11, 35.63it/s, est. speed input: 44517.21 toks/s, output: 43.47 toks/s]
Processed prompts:  23%|██▎       | 118/512 [00:02<00:11, 35.70it/s, est. speed input: 44200.04 toks/s, output: 43.16 toks/s]
Processed prompts:  24%|██▍       | 122/512 [00:02<00:10, 35.77it/s, est. speed input: 43910.86 toks/s, output: 42.88 toks/s]
Processed prompts:  25%|██▍       | 126/512 [00:02<00:10, 35.83it/s, est. speed input: 43643.86 toks/s, output: 42.62 toks/s]
Processed prompts:  25%|██▌       | 130/512 [00:03<00:10, 35.87it/s, est. speed input: 43397.09 toks/s, output: 42.38 toks/s]
Processed prompts:  26%|██▌       | 134/512 [00:03<00:10, 35.89it/s, est. speed input: 43166.12 toks/s, output: 42.15 toks/s]
Processed prompts:  27%|██▋       | 138/512 [00:03<00:10, 35.91it/s, est. speed input: 42952.14 toks/s, output: 41.95 toks/s]
Processed prompts:  28%|██▊       | 142/512 [00:03<00:10, 35.87it/s, est. speed input: 42744.21 toks/s, output: 41.74 toks/s]
Processed prompts:  29%|██▊       | 146/512 [00:03<00:10, 35.89it/s, est. speed input: 42556.11 toks/s, output: 41.56 toks/s]
Processed prompts:  29%|██▉       | 150/512 [00:03<00:10, 35.92it/s, est. speed input: 42381.19 toks/s, output: 41.39 toks/s]
Processed prompts:  30%|███       | 154/512 [00:03<00:09, 35.92it/s, est. speed input: 42214.04 toks/s, output: 41.22 toks/s]
Processed prompts:  31%|███       | 158/512 [00:03<00:09, 35.94it/s, est. speed input: 42059.21 toks/s, output: 41.07 toks/s]
Processed prompts:  32%|███▏      | 162/512 [00:03<00:09, 35.92it/s, est. speed input: 41909.08 toks/s, output: 40.93 toks/s]
Processed prompts:  32%|███▏      | 166/512 [00:04<00:09, 35.92it/s, est. speed input: 41768.78 toks/s, output: 40.79 toks/s]
Processed prompts:  33%|███▎      | 170/512 [00:04<00:09, 35.88it/s, est. speed input: 41632.16 toks/s, output: 40.66 toks/s]
Processed prompts:  34%|███▍      | 174/512 [00:04<00:09, 35.88it/s, est. speed input: 41505.01 toks/s, output: 40.53 toks/s]
Processed prompts:  35%|███▍      | 178/512 [00:04<00:09, 35.84it/s, est. speed input: 41380.18 toks/s, output: 40.41 toks/s]
Processed prompts:  36%|███▌      | 182/512 [00:04<00:09, 35.85it/s, est. speed input: 41265.38 toks/s, output: 40.30 toks/s]
Processed prompts:  36%|███▋      | 186/512 [00:04<00:09, 35.87it/s, est. speed input: 41157.87 toks/s, output: 40.19 toks/s]
Processed prompts:  37%|███▋      | 190/512 [00:04<00:08, 35.91it/s, est. speed input: 41057.00 toks/s, output: 40.09 toks/s]
Processed prompts:  38%|███▊      | 194/512 [00:04<00:08, 35.93it/s, est. speed input: 40960.68 toks/s, output: 40.00 toks/s]
Processed prompts:  39%|███▊      | 198/512 [00:04<00:08, 35.93it/s, est. speed input: 40867.28 toks/s, output: 39.91 toks/s]
Processed prompts:  39%|███▉      | 202/512 [00:05<00:08, 35.91it/s, est. speed input: 40776.35 toks/s, output: 39.82 toks/s]
Processed prompts:  40%|████      | 206/512 [00:05<00:08, 35.93it/s, est. speed input: 40691.77 toks/s, output: 39.74 toks/s]
Processed prompts:  41%|████      | 210/512 [00:05<00:08, 35.94it/s, est. speed input: 40610.38 toks/s, output: 39.66 toks/s]
Processed prompts:  42%|████▏     | 214/512 [00:05<00:08, 35.90it/s, est. speed input: 40528.92 toks/s, output: 39.58 toks/s]
Processed prompts:  43%|████▎     | 218/512 [00:05<00:08, 35.88it/s, est. speed input: 40451.14 toks/s, output: 39.50 toks/s]
Processed prompts:  43%|████▎     | 222/512 [00:05<00:08, 35.90it/s, est. speed input: 40379.23 toks/s, output: 39.43 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:05<00:07, 35.93it/s, est. speed input: 40311.07 toks/s, output: 39.37 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:05<00:07, 35.94it/s, est. speed input: 40244.87 toks/s, output: 39.30 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:05<00:07, 35.95it/s, est. speed input: 40181.20 toks/s, output: 39.24 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:06<00:07, 35.94it/s, est. speed input: 40118.60 toks/s, output: 39.18 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:06<00:07, 35.92it/s, est. speed input: 40058.18 toks/s, output: 39.12 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:06<00:07, 35.90it/s, est. speed input: 39998.61 toks/s, output: 39.06 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:06<00:07, 35.86it/s, est. speed input: 39939.86 toks/s, output: 39.00 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:06<00:07, 35.88it/s, est. speed input: 39886.22 toks/s, output: 38.95 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:06<00:07, 35.90it/s, est. speed input: 39834.21 toks/s, output: 38.90 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:06<00:06, 35.94it/s, est. speed input: 39786.05 toks/s, output: 38.85 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:06<00:06, 35.94it/s, est. speed input: 39737.42 toks/s, output: 38.81 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:06<00:06, 35.93it/s, est. speed input: 39689.77 toks/s, output: 38.76 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:07<00:06, 35.92it/s, est. speed input: 39644.02 toks/s, output: 38.71 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:07<00:06, 35.93it/s, est. speed input: 39600.36 toks/s, output: 38.67 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:07<00:06, 35.90it/s, est. speed input: 39555.67 toks/s, output: 38.63 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:07<00:06, 35.88it/s, est. speed input: 39512.64 toks/s, output: 38.59 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:07<00:06, 35.86it/s, est. speed input: 39470.45 toks/s, output: 38.55 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:07<00:06, 35.88it/s, est. speed input: 39431.26 toks/s, output: 38.51 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:07<00:05, 35.90it/s, est. speed input: 39393.52 toks/s, output: 38.47 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:07<00:05, 35.92it/s, est. speed input: 39357.14 toks/s, output: 38.43 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:07<00:05, 35.93it/s, est. speed input: 39321.60 toks/s, output: 38.40 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:08<00:05, 35.94it/s, est. speed input: 39287.26 toks/s, output: 38.37 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:08<00:05, 35.94it/s, est. speed input: 39253.52 toks/s, output: 38.33 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:08<00:05, 35.91it/s, est. speed input: 39219.24 toks/s, output: 38.30 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:08<00:05, 35.91it/s, est. speed input: 39186.73 toks/s, output: 38.27 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:08<00:05, 35.87it/s, est. speed input: 39153.53 toks/s, output: 38.24 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:08<00:05, 35.91it/s, est. speed input: 39124.23 toks/s, output: 38.21 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:08<00:04, 35.92it/s, est. speed input: 39094.76 toks/s, output: 38.18 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:08<00:04, 35.94it/s, est. speed input: 39066.44 toks/s, output: 38.15 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:08<00:04, 35.93it/s, est. speed input: 39038.07 toks/s, output: 38.12 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:09<00:04, 35.95it/s, est. speed input: 39011.35 toks/s, output: 38.10 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:09<00:04, 35.97it/s, est. speed input: 38985.74 toks/s, output: 38.07 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:09<00:04, 35.91it/s, est. speed input: 38957.39 toks/s, output: 38.04 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:09<00:04, 35.92it/s, est. speed input: 38931.95 toks/s, output: 38.02 toks/s]
Processed prompts:  71%|███████   | 362/512 [00:09<00:04, 35.91it/s, est. speed input: 38906.20 toks/s, output: 37.99 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:09<00:04, 35.86it/s, est. speed input: 38879.66 toks/s, output: 37.97 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [00:09<00:03, 35.88it/s, est. speed input: 38855.55 toks/s, output: 37.94 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [00:09<00:03, 35.90it/s, est. speed input: 38832.59 toks/s, output: 37.92 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [00:09<00:03, 35.91it/s, est. speed input: 38809.77 toks/s, output: 37.90 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [00:10<00:03, 35.92it/s, est. speed input: 38787.65 toks/s, output: 37.88 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [00:10<00:03, 35.94it/s, est. speed input: 38766.50 toks/s, output: 37.86 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [00:10<00:03, 35.91it/s, est. speed input: 38744.07 toks/s, output: 37.84 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [00:10<00:03, 35.89it/s, est. speed input: 38722.30 toks/s, output: 37.81 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [00:10<00:03, 35.85it/s, est. speed input: 38700.12 toks/s, output: 37.79 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [00:10<00:03, 35.88it/s, est. speed input: 38680.44 toks/s, output: 37.77 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [00:10<00:02, 35.90it/s, est. speed input: 38660.77 toks/s, output: 37.75 toks/s]
Processed prompts:  80%|████████  | 410/512 [00:10<00:02, 35.93it/s, est. speed input: 38642.52 toks/s, output: 37.74 toks/s]
Processed prompts:  81%|████████  | 414/512 [00:10<00:02, 35.89it/s, est. speed input: 38622.51 toks/s, output: 37.72 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [00:11<00:02, 35.89it/s, est. speed input: 38603.38 toks/s, output: 37.70 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [00:11<00:02, 35.92it/s, est. speed input: 38586.01 toks/s, output: 37.68 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [00:11<00:02, 35.90it/s, est. speed input: 38567.66 toks/s, output: 37.66 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [00:11<00:02, 35.88it/s, est. speed input: 38549.21 toks/s, output: 37.65 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [00:11<00:02, 35.93it/s, est. speed input: 38533.49 toks/s, output: 37.63 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [00:11<00:02, 35.91it/s, est. speed input: 38516.15 toks/s, output: 37.61 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [00:11<00:01, 35.88it/s, est. speed input: 38498.62 toks/s, output: 37.60 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [00:11<00:01, 35.92it/s, est. speed input: 38483.29 toks/s, output: 37.58 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [00:11<00:01, 35.95it/s, est. speed input: 38468.46 toks/s, output: 37.57 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [00:12<00:01, 35.97it/s, est. speed input: 38453.96 toks/s, output: 37.55 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [00:12<00:01, 35.97it/s, est. speed input: 38439.32 toks/s, output: 37.54 toks/s]
Processed prompts:  90%|█████████ | 462/512 [00:12<00:01, 35.94it/s, est. speed input: 38423.77 toks/s, output: 37.52 toks/s]
Processed prompts:  91%|█████████ | 466/512 [00:12<00:01, 35.90it/s, est. speed input: 38407.80 toks/s, output: 37.51 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [00:12<00:01, 35.87it/s, est. speed input: 38392.22 toks/s, output: 37.49 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [00:12<00:01, 35.83it/s, est. speed input: 38376.37 toks/s, output: 37.48 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [00:12<00:00, 35.82it/s, est. speed input: 38361.29 toks/s, output: 37.46 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [00:12<00:00, 35.82it/s, est. speed input: 38346.64 toks/s, output: 37.45 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [00:12<00:00, 35.80it/s, est. speed input: 38331.86 toks/s, output: 37.43 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [00:13<00:00, 35.79it/s, est. speed input: 38317.30 toks/s, output: 37.42 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [00:13<00:00, 35.79it/s, est. speed input: 38303.16 toks/s, output: 37.41 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [00:13<00:00, 35.76it/s, est. speed input: 38288.32 toks/s, output: 37.39 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [00:13<00:00, 35.74it/s, est. speed input: 38273.88 toks/s, output: 37.38 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [00:13<00:00, 35.74it/s, est. speed input: 38259.93 toks/s, output: 37.36 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:13<00:00, 35.74it/s, est. speed input: 38478.02 toks/s, output: 37.58 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:13<00:00, 37.58it/s, est. speed input: 38478.02 toks/s, output: 37.58 toks/s]
[rank0]:[W128 00:39:27.631814688 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 37.4s

测试结果:
  Requests/s:   35.76
  Tokens/s:     36654.52
  Total Reqs:   512
  Elapsed:      14.32s

  [Prefill 分析]
  Total Prefill Tokens: 524288
  Prefill Tokens/s:     36618.76

============================================================
[5/7] 测试 M=8192
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuBLASLt                                        │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 8192
│   M_prefill     = 8192 (= 8 x 1024)
│   M_decode      = 8
│   batched_tokens = 8192 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 1024
│   --max-num-seqs           = 8
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 8192
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:39:35 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3495210) WARNING 01-28 00:39:44 [backends.py:609] Failed to read file <frozen os>
Throughput: 34.46 requests/s, 35324.99 total tokens/s, 34.46 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024


─── STDERR ───
[2026-01-28 00:39:35] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:39:35] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:39:35] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:39:35] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:39:35] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:39:35] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:39:35] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:39:35] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:39:35] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:39:35] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:39:35] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:39:35] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:39:35] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:39:35] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:39:39] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:39:39] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:39:39] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:39:39] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:39:39] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:39:39] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:39:39] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:39:39] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:39:39] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:39:39] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:39:39] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:39:39] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:39:39] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:39:39] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3495210) [2026-01-28 00:39:40] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=3495210) [2026-01-28 00:39:40] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3495210) [2026-01-28 00:39:40] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=3495210) [2026-01-28 00:39:40] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3495210) [2026-01-28 00:39:40] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuBLASLt
(EngineCore_DP0 pid=3495210) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3495210) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.52it/s]
(EngineCore_DP0 pid=3495210) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.52it/s]
(EngineCore_DP0 pid=3495210) 
(EngineCore_DP0 pid=3495210) 2026-01-28 00:39:50,894 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3495210) 2026-01-28 00:39:50,912 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3495210) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:00,  6.38it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  60%|██████    | 3/5 [00:00<00:00, 12.02it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00, 12.65it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00, 11.85it/s]
(EngineCore_DP0 pid=3495210) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:00,  7.11it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00, 17.46it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00, 15.74it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   7%|▋         | 73/1024 [00:00<00:01, 722.85it/s]
Adding requests:  15%|█▍        | 149/1024 [00:00<00:01, 743.66it/s]
Adding requests:  22%|██▏       | 227/1024 [00:00<00:01, 757.19it/s]
Adding requests:  30%|██▉       | 303/1024 [00:00<00:00, 755.26it/s]
Adding requests:  37%|███▋      | 380/1024 [00:00<00:00, 756.94it/s]
Adding requests:  45%|████▍     | 457/1024 [00:00<00:00, 759.68it/s]
Adding requests:  52%|█████▏    | 533/1024 [00:00<00:00, 737.57it/s]
Adding requests:  59%|█████▉    | 607/1024 [00:00<00:00, 737.81it/s]
Adding requests:  67%|██████▋   | 686/1024 [00:00<00:00, 752.16it/s]
Adding requests:  75%|███████▍  | 763/1024 [00:01<00:00, 754.56it/s]
Adding requests:  82%|████████▏ | 839/1024 [00:01<00:00, 740.43it/s]
Adding requests:  90%|████████▉ | 917/1024 [00:01<00:00, 749.85it/s]
Adding requests:  97%|█████████▋| 994/1024 [00:01<00:00, 754.79it/s]
Adding requests: 100%|██████████| 1024/1024 [00:01<00:00, 750.19it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   4%|▍         | 42/1024 [00:00<00:02, 396.07it/s, est. speed input: 405616.54 toks/s, output: 396.08 toks/s]
Processed prompts:   8%|▊         | 82/1024 [00:01<00:16, 56.41it/s, est. speed input: 66528.56 toks/s, output: 64.97 toks/s]   
Processed prompts:  10%|▉         | 101/1024 [00:01<00:18, 51.03it/s, est. speed input: 59946.57 toks/s, output: 58.54 toks/s]
Processed prompts:  11%|█         | 113/1024 [00:01<00:17, 51.19it/s, est. speed input: 59135.15 toks/s, output: 57.75 toks/s]
Processed prompts:  12%|█▏        | 123/1024 [00:02<00:22, 40.46it/s, est. speed input: 52070.25 toks/s, output: 50.85 toks/s]
Processed prompts:  13%|█▎        | 130/1024 [00:02<00:23, 38.35it/s, est. speed input: 50224.30 toks/s, output: 49.05 toks/s]
Processed prompts:  13%|█▎        | 138/1024 [00:02<00:23, 37.50it/s, est. speed input: 49036.79 toks/s, output: 47.89 toks/s]
Processed prompts:  14%|█▍        | 146/1024 [00:03<00:23, 36.77it/s, est. speed input: 48020.62 toks/s, output: 46.89 toks/s]
Processed prompts:  15%|█▌        | 154/1024 [00:03<00:24, 36.20it/s, est. speed input: 47147.01 toks/s, output: 46.04 toks/s]
Processed prompts:  16%|█▌        | 162/1024 [00:03<00:24, 35.75it/s, est. speed input: 46385.10 toks/s, output: 45.30 toks/s]
Processed prompts:  17%|█▋        | 170/1024 [00:03<00:24, 35.42it/s, est. speed input: 45716.16 toks/s, output: 44.64 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [00:04<00:24, 35.16it/s, est. speed input: 45121.74 toks/s, output: 44.06 toks/s]
Processed prompts:  18%|█▊        | 186/1024 [00:04<00:23, 35.00it/s, est. speed input: 44596.55 toks/s, output: 43.55 toks/s]
Processed prompts:  19%|█▉        | 194/1024 [00:04<00:23, 34.87it/s, est. speed input: 44123.33 toks/s, output: 43.09 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [00:04<00:23, 34.78it/s, est. speed input: 43696.65 toks/s, output: 42.67 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:04<00:23, 34.73it/s, est. speed input: 43311.92 toks/s, output: 42.30 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [00:05<00:23, 34.68it/s, est. speed input: 42959.96 toks/s, output: 41.95 toks/s]
Processed prompts:  22%|██▏       | 226/1024 [00:05<00:23, 34.67it/s, est. speed input: 42640.31 toks/s, output: 41.64 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:05<00:22, 34.65it/s, est. speed input: 42345.72 toks/s, output: 41.35 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:05<00:22, 34.62it/s, est. speed input: 42072.36 toks/s, output: 41.09 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:06<00:22, 34.61it/s, est. speed input: 41821.37 toks/s, output: 40.84 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:06<00:22, 34.61it/s, est. speed input: 41588.84 toks/s, output: 40.61 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:06<00:21, 34.58it/s, est. speed input: 41368.75 toks/s, output: 40.40 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:06<00:21, 34.58it/s, est. speed input: 41166.49 toks/s, output: 40.20 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:07<00:21, 34.58it/s, est. speed input: 40977.43 toks/s, output: 40.02 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:07<00:21, 34.59it/s, est. speed input: 40801.35 toks/s, output: 39.84 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:07<00:21, 34.57it/s, est. speed input: 40633.44 toks/s, output: 39.68 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:07<00:20, 34.58it/s, est. speed input: 40478.01 toks/s, output: 39.53 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:07<00:20, 34.57it/s, est. speed input: 40329.81 toks/s, output: 39.38 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:08<00:20, 34.56it/s, est. speed input: 40189.90 toks/s, output: 39.25 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:08<00:20, 34.57it/s, est. speed input: 40058.98 toks/s, output: 39.12 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:08<00:19, 34.56it/s, est. speed input: 39934.12 toks/s, output: 39.00 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:08<00:19, 34.56it/s, est. speed input: 39815.95 toks/s, output: 38.88 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:09<00:19, 34.58it/s, est. speed input: 39705.04 toks/s, output: 38.77 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:09<00:19, 34.58it/s, est. speed input: 39599.05 toks/s, output: 38.67 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:09<00:18, 34.56it/s, est. speed input: 39496.69 toks/s, output: 38.57 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:09<00:18, 34.56it/s, est. speed input: 39399.98 toks/s, output: 38.48 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:10<00:18, 34.56it/s, est. speed input: 39307.41 toks/s, output: 38.39 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [00:10<00:18, 34.57it/s, est. speed input: 39220.18 toks/s, output: 38.30 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:10<00:17, 34.57it/s, est. speed input: 39136.34 toks/s, output: 38.22 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:10<00:17, 34.57it/s, est. speed input: 39055.92 toks/s, output: 38.14 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:10<00:17, 34.58it/s, est. speed input: 38979.44 toks/s, output: 38.07 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:11<00:17, 34.59it/s, est. speed input: 38906.83 toks/s, output: 37.99 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:11<00:17, 34.59it/s, est. speed input: 38835.88 toks/s, output: 37.93 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:11<00:16, 34.58it/s, est. speed input: 38768.00 toks/s, output: 37.86 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:11<00:16, 34.59it/s, est. speed input: 38703.02 toks/s, output: 37.80 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:12<00:16, 34.57it/s, est. speed input: 38639.51 toks/s, output: 37.73 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:12<00:16, 34.58it/s, est. speed input: 38579.62 toks/s, output: 37.68 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:12<00:15, 34.57it/s, est. speed input: 38520.75 toks/s, output: 37.62 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:12<00:15, 34.57it/s, est. speed input: 38464.58 toks/s, output: 37.56 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:13<00:15, 34.56it/s, est. speed input: 38409.58 toks/s, output: 37.51 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:13<00:15, 34.57it/s, est. speed input: 38357.88 toks/s, output: 37.46 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:13<00:14, 34.56it/s, est. speed input: 38306.31 toks/s, output: 37.41 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:13<00:14, 34.57it/s, est. speed input: 38258.05 toks/s, output: 37.36 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:13<00:14, 34.57it/s, est. speed input: 38210.87 toks/s, output: 37.32 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:14<00:14, 34.55it/s, est. speed input: 38163.84 toks/s, output: 37.27 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:14<00:14, 34.54it/s, est. speed input: 38118.62 toks/s, output: 37.23 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:14<00:13, 34.54it/s, est. speed input: 38075.21 toks/s, output: 37.18 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:14<00:13, 34.55it/s, est. speed input: 38033.98 toks/s, output: 37.14 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:15<00:13, 34.55it/s, est. speed input: 37993.47 toks/s, output: 37.10 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:15<00:13, 34.55it/s, est. speed input: 37954.18 toks/s, output: 37.06 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:15<00:12, 34.55it/s, est. speed input: 37915.59 toks/s, output: 37.03 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:15<00:12, 34.56it/s, est. speed input: 37878.97 toks/s, output: 36.99 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:16<00:12, 34.53it/s, est. speed input: 37841.79 toks/s, output: 36.95 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:16<00:12, 34.52it/s, est. speed input: 37805.76 toks/s, output: 36.92 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:16<00:12, 34.49it/s, est. speed input: 37770.06 toks/s, output: 36.88 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:16<00:11, 34.49it/s, est. speed input: 37735.93 toks/s, output: 36.85 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:17<00:11, 34.51it/s, est. speed input: 37703.86 toks/s, output: 36.82 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:17<00:11, 34.52it/s, est. speed input: 37672.43 toks/s, output: 36.79 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:17<00:11, 34.50it/s, est. speed input: 37640.93 toks/s, output: 36.76 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:17<00:10, 34.50it/s, est. speed input: 37610.50 toks/s, output: 36.73 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:17<00:10, 34.50it/s, est. speed input: 37580.84 toks/s, output: 36.70 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:18<00:10, 34.49it/s, est. speed input: 37551.69 toks/s, output: 36.67 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:18<00:10, 34.48it/s, est. speed input: 37522.88 toks/s, output: 36.64 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:18<00:09, 34.46it/s, est. speed input: 37494.40 toks/s, output: 36.62 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:18<00:09, 34.48it/s, est. speed input: 37468.01 toks/s, output: 36.59 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:19<00:09, 34.47it/s, est. speed input: 37441.64 toks/s, output: 36.56 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:19<00:09, 34.47it/s, est. speed input: 37415.77 toks/s, output: 36.54 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:19<00:09, 34.44it/s, est. speed input: 37389.50 toks/s, output: 36.51 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:19<00:08, 34.46it/s, est. speed input: 37365.19 toks/s, output: 36.49 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:20<00:08, 34.47it/s, est. speed input: 37341.71 toks/s, output: 36.47 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:20<00:08, 34.48it/s, est. speed input: 37318.60 toks/s, output: 36.44 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:20<00:08, 34.45it/s, est. speed input: 37294.48 toks/s, output: 36.42 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:20<00:07, 34.46it/s, est. speed input: 37272.22 toks/s, output: 36.40 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:20<00:07, 34.47it/s, est. speed input: 37250.51 toks/s, output: 36.38 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:21<00:07, 34.47it/s, est. speed input: 37229.08 toks/s, output: 36.36 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:21<00:07, 34.45it/s, est. speed input: 37207.52 toks/s, output: 36.34 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:21<00:06, 34.44it/s, est. speed input: 37186.38 toks/s, output: 36.31 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:21<00:06, 34.44it/s, est. speed input: 37166.08 toks/s, output: 36.29 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:22<00:06, 34.44it/s, est. speed input: 37146.24 toks/s, output: 36.28 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:22<00:06, 34.44it/s, est. speed input: 37126.73 toks/s, output: 36.26 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:22<00:05, 34.43it/s, est. speed input: 37107.08 toks/s, output: 36.24 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:22<00:05, 34.45it/s, est. speed input: 37089.11 toks/s, output: 36.22 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:23<00:05, 34.46it/s, est. speed input: 37071.13 toks/s, output: 36.20 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [00:23<00:05, 34.46it/s, est. speed input: 37053.33 toks/s, output: 36.18 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [00:23<00:05, 34.46it/s, est. speed input: 37035.86 toks/s, output: 36.17 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:23<00:04, 34.46it/s, est. speed input: 37018.64 toks/s, output: 36.15 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [00:23<00:04, 34.46it/s, est. speed input: 37001.81 toks/s, output: 36.13 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [00:24<00:04, 34.46it/s, est. speed input: 36985.29 toks/s, output: 36.12 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [00:24<00:04, 34.46it/s, est. speed input: 36969.37 toks/s, output: 36.10 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [00:24<00:03, 34.44it/s, est. speed input: 36952.81 toks/s, output: 36.09 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [00:24<00:03, 34.45it/s, est. speed input: 36937.26 toks/s, output: 36.07 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [00:25<00:03, 34.45it/s, est. speed input: 36922.13 toks/s, output: 36.06 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [00:25<00:03, 34.47it/s, est. speed input: 36907.71 toks/s, output: 36.04 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [00:25<00:02, 34.46it/s, est. speed input: 36892.78 toks/s, output: 36.03 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [00:25<00:02, 34.46it/s, est. speed input: 36878.16 toks/s, output: 36.01 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [00:26<00:02, 34.46it/s, est. speed input: 36864.07 toks/s, output: 36.00 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [00:26<00:02, 34.47it/s, est. speed input: 36850.52 toks/s, output: 35.99 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [00:26<00:02, 34.46it/s, est. speed input: 36836.56 toks/s, output: 35.97 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [00:26<00:01, 34.45it/s, est. speed input: 36822.75 toks/s, output: 35.96 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [00:26<00:01, 34.45it/s, est. speed input: 36809.64 toks/s, output: 35.95 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [00:27<00:01, 34.45it/s, est. speed input: 36796.49 toks/s, output: 35.93 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [00:27<00:01, 34.46it/s, est. speed input: 36783.78 toks/s, output: 35.92 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [00:27<00:00, 34.46it/s, est. speed input: 36771.20 toks/s, output: 35.91 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [00:27<00:00, 34.44it/s, est. speed input: 36758.48 toks/s, output: 35.90 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [00:28<00:00, 34.45it/s, est. speed input: 36746.37 toks/s, output: 35.89 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [00:28<00:00, 35.92it/s, est. speed input: 36775.38 toks/s, output: 35.91 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:28<00:00, 35.92it/s, est. speed input: 36991.85 toks/s, output: 36.12 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:28<00:00, 36.12it/s, est. speed input: 36991.85 toks/s, output: 36.12 toks/s]
[rank0]:[W128 00:40:22.208105505 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 54.6s

测试结果:
  Requests/s:   34.46
  Tokens/s:     35324.99
  Total Reqs:   1024
  Elapsed:      29.71s

  [Prefill 分析]
  Total Prefill Tokens: 1048576
  Prefill Tokens/s:     35290.52

============================================================
[6/7] 测试 M=16384
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuBLASLt                                        │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 16384
│   M_prefill     = 16384 (= 16 x 1024)
│   M_decode      = 16
│   batched_tokens = 16384 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 2048
│   --max-num-seqs           = 16
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 16384
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:40:33 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3496292) WARNING 01-28 00:40:42 [backends.py:609] Failed to read file <frozen os>
Throughput: 34.23 requests/s, 35088.09 total tokens/s, 34.23 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048


─── STDERR ───
[2026-01-28 00:40:33] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:40:33] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:40:33] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:40:33] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:40:33] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:40:33] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:40:33] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:40:33] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:40:33] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:40:33] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:40:33] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:40:33] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:40:33] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:40:33] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:40:37] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:40:37] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:40:37] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:40:37] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:40:37] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:40:37] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:40:37] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:40:37] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:40:37] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:40:37] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:40:37] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:40:37] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:40:37] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:40:37] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3496292) [2026-01-28 00:40:37] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=3496292) [2026-01-28 00:40:37] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3496292) [2026-01-28 00:40:37] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=3496292) [2026-01-28 00:40:37] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3496292) [2026-01-28 00:40:37] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuBLASLt
(EngineCore_DP0 pid=3496292) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3496292) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.64it/s]
(EngineCore_DP0 pid=3496292) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.64it/s]
(EngineCore_DP0 pid=3496292) 
(EngineCore_DP0 pid=3496292) 2026-01-28 00:40:48,458 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3496292) 2026-01-28 00:40:48,489 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3496292) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  14%|█▍        | 1/7 [00:00<00:01,  4.22it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  57%|█████▋    | 4/7 [00:00<00:00, 13.26it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00, 17.39it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00, 14.69it/s]
(EngineCore_DP0 pid=3496292) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  20%|██        | 1/5 [00:00<00:00,  7.19it/s]
Capturing CUDA graphs (decode, FULL):  80%|████████  | 4/5 [00:00<00:00, 18.15it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00, 17.76it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   3%|▎         | 68/2048 [00:00<00:02, 678.21it/s]
Adding requests:   7%|▋         | 143/2048 [00:00<00:02, 719.56it/s]
Adding requests:  11%|█         | 218/2048 [00:00<00:02, 731.71it/s]
Adding requests:  14%|█▍        | 296/2048 [00:00<00:02, 748.82it/s]
Adding requests:  18%|█▊        | 372/2048 [00:00<00:02, 751.29it/s]
Adding requests:  22%|██▏       | 449/2048 [00:00<00:02, 754.39it/s]
Adding requests:  26%|██▌       | 525/2048 [00:00<00:02, 736.64it/s]
Adding requests:  29%|██▉       | 600/2048 [00:00<00:01, 736.45it/s]
Adding requests:  33%|███▎      | 678/2048 [00:00<00:01, 747.98it/s]
Adding requests:  37%|███▋      | 753/2048 [00:01<00:01, 742.25it/s]
Adding requests:  40%|████      | 828/2048 [00:01<00:01, 727.65it/s]
Adding requests:  44%|████▍     | 905/2048 [00:01<00:01, 738.17it/s]
Adding requests:  48%|████▊     | 979/2048 [00:01<00:01, 735.49it/s]
Adding requests:  52%|█████▏    | 1055/2048 [00:01<00:01, 742.46it/s]
Adding requests:  55%|█████▌    | 1130/2048 [00:01<00:01, 744.03it/s]
Adding requests:  59%|█████▉    | 1209/2048 [00:01<00:01, 755.84it/s]
Adding requests:  63%|██████▎   | 1285/2048 [00:01<00:01, 746.29it/s]
Adding requests:  66%|██████▋   | 1361/2048 [00:01<00:00, 749.05it/s]
Adding requests:  70%|███████   | 1438/2048 [00:01<00:00, 753.25it/s]
Adding requests:  74%|███████▍  | 1517/2048 [00:02<00:00, 762.52it/s]
Adding requests:  78%|███████▊  | 1594/2048 [00:02<00:00, 758.78it/s]
Adding requests:  82%|████████▏ | 1670/2048 [00:02<00:00, 751.98it/s]
Adding requests:  85%|████████▌ | 1747/2048 [00:02<00:00, 757.03it/s]
Adding requests:  89%|████████▉ | 1825/2048 [00:02<00:00, 763.53it/s]
Adding requests:  93%|█████████▎| 1903/2048 [00:02<00:00, 766.09it/s]
Adding requests:  97%|█████████▋| 1980/2048 [00:02<00:00, 746.40it/s]
Adding requests: 100%|██████████| 2048/2048 [00:02<00:00, 747.48it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   4%|▍         | 82/2048 [00:00<00:03, 569.31it/s, est. speed input: 583024.98 toks/s, output: 569.33 toks/s]
Processed prompts:   7%|▋         | 139/2048 [00:01<00:25, 76.32it/s, est. speed input: 92302.11 toks/s, output: 90.14 toks/s]  
Processed prompts:   8%|▊         | 165/2048 [00:02<00:35, 53.55it/s, est. speed input: 68295.01 toks/s, output: 66.69 toks/s]
Processed prompts:   9%|▉         | 181/2048 [00:02<00:38, 48.72it/s, est. speed input: 63044.34 toks/s, output: 61.57 toks/s]
Processed prompts:   9%|▉         | 194/2048 [00:03<00:42, 43.22it/s, est. speed input: 58333.57 toks/s, output: 56.97 toks/s]
Processed prompts:  10%|█         | 210/2048 [00:03<00:45, 40.78it/s, est. speed input: 55540.53 toks/s, output: 54.24 toks/s]
Processed prompts:  11%|█         | 226/2048 [00:04<00:46, 38.98it/s, est. speed input: 53356.16 toks/s, output: 52.11 toks/s]
Processed prompts:  12%|█▏        | 242/2048 [00:04<00:47, 37.64it/s, est. speed input: 51586.23 toks/s, output: 50.38 toks/s]
Processed prompts:  13%|█▎        | 258/2048 [00:05<00:48, 36.67it/s, est. speed input: 50130.27 toks/s, output: 48.96 toks/s]
Processed prompts:  13%|█▎        | 274/2048 [00:05<00:49, 35.97it/s, est. speed input: 48910.61 toks/s, output: 47.76 toks/s]
Processed prompts:  14%|█▍        | 290/2048 [00:06<00:49, 35.48it/s, est. speed input: 47875.33 toks/s, output: 46.75 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [00:06<00:49, 35.14it/s, est. speed input: 46985.50 toks/s, output: 45.88 toks/s]
Processed prompts:  16%|█▌        | 322/2048 [00:07<00:49, 34.89it/s, est. speed input: 46211.53 toks/s, output: 45.13 toks/s]
Processed prompts:  17%|█▋        | 338/2048 [00:07<00:49, 34.71it/s, est. speed input: 45529.62 toks/s, output: 44.46 toks/s]
Processed prompts:  17%|█▋        | 354/2048 [00:08<00:48, 34.59it/s, est. speed input: 44929.40 toks/s, output: 43.88 toks/s]
Processed prompts:  18%|█▊        | 370/2048 [00:08<00:48, 34.50it/s, est. speed input: 44391.56 toks/s, output: 43.35 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [00:09<00:48, 34.44it/s, est. speed input: 43912.45 toks/s, output: 42.88 toks/s]
Processed prompts:  20%|█▉        | 402/2048 [00:09<00:47, 34.39it/s, est. speed input: 43477.83 toks/s, output: 42.46 toks/s]
Processed prompts:  20%|██        | 418/2048 [00:09<00:47, 34.36it/s, est. speed input: 43084.80 toks/s, output: 42.07 toks/s]
Processed prompts:  21%|██        | 434/2048 [00:10<00:47, 34.34it/s, est. speed input: 42726.94 toks/s, output: 41.73 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [00:10<00:46, 34.31it/s, est. speed input: 42398.01 toks/s, output: 41.40 toks/s]
Processed prompts:  23%|██▎       | 466/2048 [00:11<00:46, 34.29it/s, est. speed input: 42095.01 toks/s, output: 41.11 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [00:11<00:45, 34.28it/s, est. speed input: 41817.61 toks/s, output: 40.84 toks/s]
Processed prompts:  24%|██▍       | 498/2048 [00:12<00:45, 34.27it/s, est. speed input: 41561.02 toks/s, output: 40.59 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [00:12<00:44, 34.26it/s, est. speed input: 41321.61 toks/s, output: 40.35 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [00:13<00:44, 34.26it/s, est. speed input: 41101.58 toks/s, output: 40.14 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [00:13<00:43, 34.25it/s, est. speed input: 40894.62 toks/s, output: 39.94 toks/s]
Processed prompts:  27%|██▋       | 562/2048 [00:14<00:43, 34.25it/s, est. speed input: 40701.85 toks/s, output: 39.75 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [00:14<00:42, 34.25it/s, est. speed input: 40522.27 toks/s, output: 39.57 toks/s]
Processed prompts:  29%|██▉       | 594/2048 [00:15<00:42, 34.24it/s, est. speed input: 40351.74 toks/s, output: 39.41 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [00:15<00:41, 34.24it/s, est. speed input: 40192.58 toks/s, output: 39.25 toks/s]
Processed prompts:  31%|███       | 626/2048 [00:16<00:41, 34.24it/s, est. speed input: 40043.53 toks/s, output: 39.10 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [00:16<00:41, 34.24it/s, est. speed input: 39901.34 toks/s, output: 38.97 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [00:16<00:40, 34.24it/s, est. speed input: 39767.83 toks/s, output: 38.84 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [00:17<00:40, 34.23it/s, est. speed input: 39640.95 toks/s, output: 38.71 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [00:17<00:39, 34.23it/s, est. speed input: 39520.70 toks/s, output: 38.59 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [00:18<00:39, 34.23it/s, est. speed input: 39407.10 toks/s, output: 38.48 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [00:18<00:38, 34.22it/s, est. speed input: 39298.19 toks/s, output: 38.38 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [00:19<00:38, 34.22it/s, est. speed input: 39194.79 toks/s, output: 38.28 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [00:19<00:37, 34.21it/s, est. speed input: 39095.51 toks/s, output: 38.18 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [00:20<00:37, 34.22it/s, est. speed input: 39002.08 toks/s, output: 38.09 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [00:20<00:36, 34.21it/s, est. speed input: 38912.04 toks/s, output: 38.00 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [00:21<00:36, 34.21it/s, est. speed input: 38826.52 toks/s, output: 37.92 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [00:21<00:35, 34.21it/s, est. speed input: 38744.08 toks/s, output: 37.84 toks/s]
Processed prompts:  41%|████      | 834/2048 [00:22<00:35, 34.21it/s, est. speed input: 38665.81 toks/s, output: 37.76 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [00:22<00:35, 34.21it/s, est. speed input: 38589.97 toks/s, output: 37.69 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [00:23<00:34, 34.21it/s, est. speed input: 38517.91 toks/s, output: 37.62 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [00:23<00:34, 34.20it/s, est. speed input: 38447.72 toks/s, output: 37.55 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [00:23<00:33, 34.21it/s, est. speed input: 38381.57 toks/s, output: 37.48 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [00:24<00:33, 34.21it/s, est. speed input: 38317.17 toks/s, output: 37.42 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [00:24<00:32, 34.21it/s, est. speed input: 38255.68 toks/s, output: 37.36 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [00:25<00:32, 34.21it/s, est. speed input: 38196.34 toks/s, output: 37.30 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [00:25<00:31, 34.21it/s, est. speed input: 38138.80 toks/s, output: 37.24 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [00:26<00:31, 34.21it/s, est. speed input: 38083.29 toks/s, output: 37.19 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [00:26<00:30, 34.20it/s, est. speed input: 38029.45 toks/s, output: 37.14 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [00:27<00:30, 34.21it/s, est. speed input: 37978.32 toks/s, output: 37.09 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [00:27<00:29, 34.21it/s, est. speed input: 37928.34 toks/s, output: 37.04 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [00:28<00:29, 34.21it/s, est. speed input: 37880.20 toks/s, output: 36.99 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [00:28<00:28, 34.21it/s, est. speed input: 37833.93 toks/s, output: 36.95 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [00:29<00:28, 34.21it/s, est. speed input: 37788.95 toks/s, output: 36.90 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [00:29<00:28, 34.21it/s, est. speed input: 37745.25 toks/s, output: 36.86 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [00:30<00:27, 34.21it/s, est. speed input: 37703.09 toks/s, output: 36.82 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [00:30<00:27, 34.21it/s, est. speed input: 37661.86 toks/s, output: 36.78 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [00:30<00:26, 34.21it/s, est. speed input: 37622.46 toks/s, output: 36.74 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [00:31<00:25, 34.83it/s, est. speed input: 37617.10 toks/s, output: 36.74 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [00:31<00:25, 34.64it/s, est. speed input: 37579.16 toks/s, output: 36.70 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [00:32<00:24, 34.52it/s, est. speed input: 37542.67 toks/s, output: 36.66 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [00:32<00:24, 34.42it/s, est. speed input: 37506.82 toks/s, output: 36.63 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [00:33<00:24, 34.36it/s, est. speed input: 37472.10 toks/s, output: 36.59 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [00:33<00:23, 34.31it/s, est. speed input: 37438.14 toks/s, output: 36.56 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [00:34<00:23, 34.28it/s, est. speed input: 37405.19 toks/s, output: 36.53 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [00:34<00:22, 34.25it/s, est. speed input: 37372.82 toks/s, output: 36.50 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [00:35<00:22, 34.24it/s, est. speed input: 37341.72 toks/s, output: 36.47 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [00:35<00:21, 34.23it/s, est. speed input: 37311.47 toks/s, output: 36.44 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [00:36<00:21, 34.23it/s, est. speed input: 37281.91 toks/s, output: 36.41 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [00:36<00:20, 34.22it/s, est. speed input: 37252.85 toks/s, output: 36.38 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [00:37<00:20, 34.22it/s, est. speed input: 37224.94 toks/s, output: 36.35 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [00:37<00:20, 34.21it/s, est. speed input: 37197.33 toks/s, output: 36.33 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [00:37<00:19, 34.21it/s, est. speed input: 37170.66 toks/s, output: 36.30 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [00:38<00:19, 34.20it/s, est. speed input: 37144.30 toks/s, output: 36.27 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [00:38<00:18, 34.21it/s, est. speed input: 37119.12 toks/s, output: 36.25 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [00:39<00:18, 34.22it/s, est. speed input: 37094.52 toks/s, output: 36.23 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [00:39<00:17, 34.21it/s, est. speed input: 37070.17 toks/s, output: 36.20 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [00:40<00:17, 34.21it/s, est. speed input: 37046.58 toks/s, output: 36.18 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [00:40<00:16, 34.21it/s, est. speed input: 37023.31 toks/s, output: 36.16 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [00:41<00:16, 34.20it/s, est. speed input: 37000.37 toks/s, output: 36.13 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [00:41<00:15, 34.19it/s, est. speed input: 36977.73 toks/s, output: 36.11 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [00:42<00:15, 34.19it/s, est. speed input: 36956.00 toks/s, output: 36.09 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [00:42<00:14, 34.19it/s, est. speed input: 36934.59 toks/s, output: 36.07 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [00:43<00:14, 34.20it/s, est. speed input: 36913.91 toks/s, output: 36.05 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [00:43<00:13, 34.19it/s, est. speed input: 36893.31 toks/s, output: 36.03 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [00:44<00:13, 34.19it/s, est. speed input: 36873.36 toks/s, output: 36.01 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [00:44<00:13, 34.19it/s, est. speed input: 36853.65 toks/s, output: 35.99 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [00:44<00:12, 34.19it/s, est. speed input: 36834.62 toks/s, output: 35.97 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [00:45<00:12, 34.19it/s, est. speed input: 36815.79 toks/s, output: 35.95 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [00:45<00:11, 34.19it/s, est. speed input: 36797.43 toks/s, output: 35.93 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [00:46<00:11, 34.20it/s, est. speed input: 36779.80 toks/s, output: 35.92 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [00:46<00:10, 34.19it/s, est. speed input: 36761.97 toks/s, output: 35.90 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [00:47<00:10, 34.21it/s, est. speed input: 36745.18 toks/s, output: 35.88 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [00:47<00:09, 34.20it/s, est. speed input: 36728.03 toks/s, output: 35.87 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [00:48<00:09, 34.20it/s, est. speed input: 36711.51 toks/s, output: 35.85 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [00:48<00:08, 34.20it/s, est. speed input: 36695.29 toks/s, output: 35.84 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [00:49<00:08, 34.20it/s, est. speed input: 36679.48 toks/s, output: 35.82 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [00:49<00:07, 34.20it/s, est. speed input: 36663.79 toks/s, output: 35.80 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [00:50<00:07, 34.20it/s, est. speed input: 36648.50 toks/s, output: 35.79 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [00:50<00:06, 34.20it/s, est. speed input: 36633.27 toks/s, output: 35.77 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [00:51<00:06, 34.20it/s, est. speed input: 36618.61 toks/s, output: 35.76 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [00:51<00:06, 34.20it/s, est. speed input: 36603.95 toks/s, output: 35.75 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [00:51<00:05, 34.20it/s, est. speed input: 36589.76 toks/s, output: 35.73 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [00:52<00:04, 34.82it/s, est. speed input: 36595.10 toks/s, output: 35.74 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [00:52<00:04, 34.63it/s, est. speed input: 36581.23 toks/s, output: 35.72 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [00:53<00:04, 34.51it/s, est. speed input: 36567.79 toks/s, output: 35.71 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [00:53<00:03, 34.41it/s, est. speed input: 36554.21 toks/s, output: 35.70 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [00:54<00:03, 34.35it/s, est. speed input: 36541.12 toks/s, output: 35.68 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [00:54<00:02, 34.30it/s, est. speed input: 36528.04 toks/s, output: 35.67 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [00:55<00:02, 34.28it/s, est. speed input: 36515.42 toks/s, output: 35.66 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [00:55<00:01, 34.24it/s, est. speed input: 36502.57 toks/s, output: 35.65 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [00:56<00:01, 34.23it/s, est. speed input: 36490.26 toks/s, output: 35.64 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [00:56<00:00, 34.22it/s, est. speed input: 36478.17 toks/s, output: 35.62 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [00:57<00:00, 34.92it/s, est. speed input: 36486.17 toks/s, output: 35.63 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:57<00:00, 34.92it/s, est. speed input: 36737.09 toks/s, output: 35.88 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:57<00:00, 35.88it/s, est. speed input: 36737.09 toks/s, output: 35.88 toks/s]
[rank0]:[W128 00:41:50.995097494 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 87.8s

测试结果:
  Requests/s:   34.23
  Tokens/s:     35088.09
  Total Reqs:   2048
  Elapsed:      59.83s

  [Prefill 分析]
  Total Prefill Tokens: 2097152
  Prefill Tokens/s:     35053.86

============================================================
[7/7] 测试 M=32768
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuBLASLt                                        │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 32768
│   M_prefill     = 32768 (= 32 x 1024)
│   M_decode      = 32
│   batched_tokens = 32768 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 4096
│   --max-num-seqs           = 32
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 32768
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:42:06 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3497840) WARNING 01-28 00:42:15 [backends.py:609] Failed to read file <frozen os>
Throughput: 34.18 requests/s, 35038.21 total tokens/s, 34.18 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096


─── STDERR ───
[2026-01-28 00:42:06] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:42:06] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:42:06] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:42:06] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:42:06] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:42:06] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:42:06] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:42:06] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:42:06] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:42:06] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:42:06] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:42:06] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:42:06] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:42:06] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:42:10] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:42:10] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:42:10] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:42:10] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:42:10] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:42:10] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:42:10] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:42:10] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:42:10] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:42:10] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:42:10] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:42:10] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:42:10] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:42:10] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3497840) [2026-01-28 00:42:10] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=3497840) [2026-01-28 00:42:11] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3497840) [2026-01-28 00:42:11] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=3497840) [2026-01-28 00:42:11] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3497840) [2026-01-28 00:42:11] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuBLASLt
(EngineCore_DP0 pid=3497840) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3497840) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.64it/s]
(EngineCore_DP0 pid=3497840) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.64it/s]
(EngineCore_DP0 pid=3497840) 
(EngineCore_DP0 pid=3497840) [rank0]:W0128 00:42:18.296000 3497840 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=3497840) [rank0]:W0128 00:42:18.345000 3497840 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=3497840) [rank0]:W0128 00:42:18.963000 3497840 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=3497840) [rank0]:W0128 00:42:19.038000 3497840 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=3497840) 2026-01-28 00:42:21,802 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3497840) 2026-01-28 00:42:21,820 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3497840) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   9%|▉         | 1/11 [00:00<00:06,  1.48it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  36%|███▋      | 4/11 [00:00<00:01,  6.24it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  64%|██████▎   | 7/11 [00:00<00:00, 10.61it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  91%|█████████ | 10/11 [00:01<00:00, 14.09it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00, 10.16it/s]
(EngineCore_DP0 pid=3497840) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  14%|█▍        | 1/7 [00:00<00:00,  7.18it/s]
Capturing CUDA graphs (decode, FULL):  57%|█████▋    | 4/7 [00:00<00:00, 17.87it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00, 21.80it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00, 19.42it/s]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 72/4096 [00:00<00:05, 711.57it/s]
Adding requests:   4%|▎         | 144/4096 [00:00<00:05, 685.53it/s]
Adding requests:   5%|▌         | 213/4096 [00:00<00:05, 674.17it/s]
Adding requests:   7%|▋         | 288/4096 [00:00<00:05, 702.11it/s]
Adding requests:   9%|▉         | 361/4096 [00:00<00:05, 710.49it/s]
Adding requests:  11%|█         | 439/4096 [00:00<00:05, 731.21it/s]
Adding requests:  13%|█▎        | 516/4096 [00:00<00:04, 742.78it/s]
Adding requests:  14%|█▍        | 593/4096 [00:00<00:04, 750.23it/s]
Adding requests:  16%|█▋        | 670/4096 [00:00<00:04, 754.17it/s]
Adding requests:  18%|█▊        | 747/4096 [00:01<00:04, 758.68it/s]
Adding requests:  20%|██        | 823/4096 [00:01<00:04, 747.49it/s]
Adding requests:  22%|██▏       | 901/4096 [00:01<00:04, 754.97it/s]
Adding requests:  24%|██▍       | 979/4096 [00:01<00:04, 760.78it/s]
Adding requests:  26%|██▌       | 1056/4096 [00:01<00:04, 750.59it/s]
Adding requests:  28%|██▊       | 1132/4096 [00:01<00:03, 751.66it/s]
Adding requests:  30%|██▉       | 1211/4096 [00:01<00:03, 760.96it/s]
Adding requests:  31%|███▏      | 1288/4096 [00:01<00:03, 757.98it/s]
Adding requests:  33%|███▎      | 1367/4096 [00:01<00:03, 766.70it/s]
Adding requests:  35%|███▌      | 1444/4096 [00:01<00:03, 764.92it/s]
Adding requests:  37%|███▋      | 1523/4096 [00:02<00:03, 769.85it/s]
Adding requests:  39%|███▉      | 1603/4096 [00:02<00:03, 775.95it/s]
Adding requests:  41%|████      | 1681/4096 [00:02<00:03, 773.66it/s]
Adding requests:  43%|████▎     | 1760/4096 [00:02<00:03, 777.10it/s]
Adding requests:  45%|████▍     | 1839/4096 [00:02<00:02, 780.73it/s]
Adding requests:  47%|████▋     | 1918/4096 [00:02<00:02, 764.91it/s]
Adding requests:  49%|████▊     | 1995/4096 [00:02<00:02, 763.46it/s]
Adding requests:  51%|█████     | 2072/4096 [00:02<00:02, 763.23it/s]
Adding requests:  52%|█████▏    | 2149/4096 [00:02<00:02, 757.25it/s]
Adding requests:  54%|█████▍    | 2225/4096 [00:02<00:02, 741.50it/s]
Adding requests:  56%|█████▌    | 2302/4096 [00:03<00:02, 749.16it/s]
Adding requests:  58%|█████▊    | 2378/4096 [00:03<00:02, 751.65it/s]
Adding requests:  60%|█████▉    | 2454/4096 [00:03<00:02, 747.64it/s]
Adding requests:  62%|██████▏   | 2531/4096 [00:03<00:02, 752.70it/s]
Adding requests:  64%|██████▎   | 2610/4096 [00:03<00:01, 761.54it/s]
Adding requests:  66%|██████▌   | 2689/4096 [00:03<00:01, 768.17it/s]
Adding requests:  68%|██████▊   | 2768/4096 [00:03<00:01, 773.09it/s]
Adding requests:  69%|██████▉   | 2846/4096 [00:03<00:01, 771.60it/s]
Adding requests:  71%|███████▏  | 2924/4096 [00:03<00:01, 768.04it/s]
Adding requests:  73%|███████▎  | 3001/4096 [00:03<00:01, 764.83it/s]
Adding requests:  75%|███████▌  | 3078/4096 [00:04<00:01, 762.26it/s]
Adding requests:  77%|███████▋  | 3155/4096 [00:04<00:01, 761.22it/s]
Adding requests:  79%|███████▉  | 3233/4096 [00:04<00:01, 766.17it/s]
Adding requests:  81%|████████  | 3312/4096 [00:04<00:01, 770.79it/s]
Adding requests:  83%|████████▎ | 3390/4096 [00:04<00:00, 765.03it/s]
Adding requests:  85%|████████▍ | 3467/4096 [00:04<00:00, 757.19it/s]
Adding requests:  86%|████████▋ | 3543/4096 [00:04<00:00, 751.76it/s]
Adding requests:  88%|████████▊ | 3619/4096 [00:04<00:00, 736.44it/s]
Adding requests:  90%|█████████ | 3697/4096 [00:04<00:00, 746.72it/s]
Adding requests:  92%|█████████▏| 3775/4096 [00:04<00:00, 756.08it/s]
Adding requests:  94%|█████████▍| 3854/4096 [00:05<00:00, 764.12it/s]
Adding requests:  96%|█████████▌| 3931/4096 [00:05<00:00, 760.65it/s]
Adding requests:  98%|█████████▊| 4008/4096 [00:05<00:00, 756.71it/s]
Adding requests: 100%|█████████▉| 4085/4096 [00:05<00:00, 759.05it/s]
Adding requests: 100%|██████████| 4096/4096 [00:05<00:00, 755.72it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   4%|▍         | 162/4096 [00:00<00:07, 544.83it/s, est. speed input: 557936.01 toks/s, output: 544.84 toks/s]
Processed prompts:   5%|▌         | 217/4096 [00:01<00:26, 147.52it/s, est. speed input: 180551.36 toks/s, output: 176.32 toks/s]
Processed prompts:   6%|▌         | 243/4096 [00:02<00:46, 83.03it/s, est. speed input: 114960.09 toks/s, output: 112.27 toks/s] 
Processed prompts:   6%|▋         | 259/4096 [00:03<01:10, 54.36it/s, est. speed input: 85596.08 toks/s, output: 83.59 toks/s]  
Processed prompts:   7%|▋         | 290/4096 [00:04<01:22, 46.25it/s, est. speed input: 73646.96 toks/s, output: 71.92 toks/s]
Processed prompts:   8%|▊         | 322/4096 [00:04<01:29, 41.96it/s, est. speed input: 66353.02 toks/s, output: 64.80 toks/s]
Processed prompts:   9%|▊         | 354/4096 [00:05<01:35, 39.37it/s, est. speed input: 61400.71 toks/s, output: 59.96 toks/s]
Processed prompts:   9%|▉         | 386/4096 [00:06<01:38, 37.71it/s, est. speed input: 57799.58 toks/s, output: 56.44 toks/s]
Processed prompts:  10%|█         | 418/4096 [00:07<01:40, 36.61it/s, est. speed input: 55063.85 toks/s, output: 53.77 toks/s]
Processed prompts:  11%|█         | 450/4096 [00:08<01:41, 35.86it/s, est. speed input: 52912.86 toks/s, output: 51.67 toks/s]
Processed prompts:  12%|█▏        | 482/4096 [00:09<01:42, 35.35it/s, est. speed input: 51179.24 toks/s, output: 49.98 toks/s]
Processed prompts:  13%|█▎        | 514/4096 [00:10<01:42, 35.00it/s, est. speed input: 49751.14 toks/s, output: 48.59 toks/s]
Processed prompts:  13%|█▎        | 546/4096 [00:11<01:42, 34.76it/s, est. speed input: 48553.47 toks/s, output: 47.42 toks/s]
Processed prompts:  14%|█▍        | 578/4096 [00:12<01:41, 34.59it/s, est. speed input: 47536.93 toks/s, output: 46.42 toks/s]
Processed prompts:  15%|█▍        | 610/4096 [00:13<01:41, 34.47it/s, est. speed input: 46661.19 toks/s, output: 45.57 toks/s]
Processed prompts:  16%|█▌        | 642/4096 [00:14<01:40, 34.39it/s, est. speed input: 45900.97 toks/s, output: 44.83 toks/s]
Processed prompts:  16%|█▋        | 674/4096 [00:15<01:39, 34.33it/s, est. speed input: 45233.24 toks/s, output: 44.17 toks/s]
Processed prompts:  17%|█▋        | 706/4096 [00:16<01:38, 34.28it/s, est. speed input: 44641.19 toks/s, output: 43.59 toks/s]
Processed prompts:  18%|█▊        | 738/4096 [00:17<01:38, 34.25it/s, est. speed input: 44114.58 toks/s, output: 43.08 toks/s]
Processed prompts:  19%|█▉        | 770/4096 [00:18<01:37, 34.23it/s, est. speed input: 43642.36 toks/s, output: 42.62 toks/s]
Processed prompts:  20%|█▉        | 802/4096 [00:19<01:36, 34.22it/s, est. speed input: 43216.61 toks/s, output: 42.20 toks/s]
Processed prompts:  20%|██        | 834/4096 [00:19<01:35, 34.21it/s, est. speed input: 42830.81 toks/s, output: 41.83 toks/s]
Processed prompts:  21%|██        | 866/4096 [00:20<01:34, 34.20it/s, est. speed input: 42480.80 toks/s, output: 41.49 toks/s]
Processed prompts:  22%|██▏       | 898/4096 [00:21<01:33, 34.19it/s, est. speed input: 42159.34 toks/s, output: 41.17 toks/s]
Processed prompts:  23%|██▎       | 930/4096 [00:22<01:32, 34.19it/s, est. speed input: 41864.44 toks/s, output: 40.88 toks/s]
Processed prompts:  23%|██▎       | 962/4096 [00:23<01:31, 34.19it/s, est. speed input: 41593.23 toks/s, output: 40.62 toks/s]
Processed prompts:  24%|██▍       | 994/4096 [00:24<01:30, 34.19it/s, est. speed input: 41343.55 toks/s, output: 40.37 toks/s]
Processed prompts:  25%|██▌       | 1026/4096 [00:25<01:29, 34.18it/s, est. speed input: 41110.02 toks/s, output: 40.15 toks/s]
Processed prompts:  26%|██▌       | 1058/4096 [00:26<01:28, 34.18it/s, est. speed input: 40894.21 toks/s, output: 39.94 toks/s]
Processed prompts:  27%|██▋       | 1090/4096 [00:27<01:27, 34.18it/s, est. speed input: 40693.06 toks/s, output: 39.74 toks/s]
Processed prompts:  27%|██▋       | 1122/4096 [00:28<01:27, 34.18it/s, est. speed input: 40504.97 toks/s, output: 39.56 toks/s]
Processed prompts:  28%|██▊       | 1154/4096 [00:29<01:25, 34.45it/s, est. speed input: 40363.46 toks/s, output: 39.42 toks/s]
Processed prompts:  29%|██▉       | 1186/4096 [00:30<01:24, 34.37it/s, est. speed input: 40197.27 toks/s, output: 39.26 toks/s]
Processed prompts:  30%|██▉       | 1218/4096 [00:31<01:23, 34.31it/s, est. speed input: 40040.36 toks/s, output: 39.10 toks/s]
Processed prompts:  31%|███       | 1250/4096 [00:32<01:23, 34.27it/s, est. speed input: 39893.49 toks/s, output: 38.96 toks/s]
Processed prompts:  31%|███▏      | 1282/4096 [00:33<01:22, 34.24it/s, est. speed input: 39754.61 toks/s, output: 38.82 toks/s]
Processed prompts:  32%|███▏      | 1314/4096 [00:33<01:21, 34.22it/s, est. speed input: 39623.51 toks/s, output: 38.69 toks/s]
Processed prompts:  33%|███▎      | 1346/4096 [00:34<01:20, 34.21it/s, est. speed input: 39499.38 toks/s, output: 38.57 toks/s]
Processed prompts:  34%|███▎      | 1378/4096 [00:35<01:19, 34.20it/s, est. speed input: 39381.94 toks/s, output: 38.46 toks/s]
Processed prompts:  34%|███▍      | 1410/4096 [00:36<01:18, 34.20it/s, est. speed input: 39270.70 toks/s, output: 38.35 toks/s]
Processed prompts:  35%|███▌      | 1442/4096 [00:37<01:17, 34.19it/s, est. speed input: 39164.70 toks/s, output: 38.25 toks/s]
Processed prompts:  36%|███▌      | 1474/4096 [00:38<01:16, 34.19it/s, est. speed input: 39063.93 toks/s, output: 38.15 toks/s]
Processed prompts:  37%|███▋      | 1506/4096 [00:39<01:15, 34.19it/s, est. speed input: 38967.94 toks/s, output: 38.05 toks/s]
Processed prompts:  38%|███▊      | 1538/4096 [00:40<01:14, 34.19it/s, est. speed input: 38876.27 toks/s, output: 37.97 toks/s]
Processed prompts:  38%|███▊      | 1570/4096 [00:41<01:13, 34.18it/s, est. speed input: 38788.56 toks/s, output: 37.88 toks/s]
Processed prompts:  39%|███▉      | 1602/4096 [00:42<01:12, 34.18it/s, est. speed input: 38704.81 toks/s, output: 37.80 toks/s]
Processed prompts:  40%|███▉      | 1634/4096 [00:43<01:12, 34.18it/s, est. speed input: 38624.55 toks/s, output: 37.72 toks/s]
Processed prompts:  41%|████      | 1666/4096 [00:44<01:11, 34.18it/s, est. speed input: 38548.03 toks/s, output: 37.64 toks/s]
Processed prompts:  41%|████▏     | 1698/4096 [00:45<01:10, 34.18it/s, est. speed input: 38474.48 toks/s, output: 37.57 toks/s]
Processed prompts:  42%|████▏     | 1730/4096 [00:46<01:09, 34.18it/s, est. speed input: 38403.76 toks/s, output: 37.50 toks/s]
Processed prompts:  43%|████▎     | 1762/4096 [00:47<01:08, 34.18it/s, est. speed input: 38335.97 toks/s, output: 37.44 toks/s]
Processed prompts:  44%|████▍     | 1794/4096 [00:48<01:07, 34.18it/s, est. speed input: 38270.72 toks/s, output: 37.37 toks/s]
Processed prompts:  45%|████▍     | 1826/4096 [00:48<01:06, 34.18it/s, est. speed input: 38208.37 toks/s, output: 37.31 toks/s]
Processed prompts:  45%|████▌     | 1858/4096 [00:49<01:04, 34.45it/s, est. speed input: 38166.89 toks/s, output: 37.27 toks/s]
Processed prompts:  46%|████▌     | 1890/4096 [00:50<01:04, 34.36it/s, est. speed input: 38108.23 toks/s, output: 37.22 toks/s]
Processed prompts:  47%|████▋     | 1922/4096 [00:51<01:03, 34.31it/s, est. speed input: 38052.16 toks/s, output: 37.16 toks/s]
Processed prompts:  48%|████▊     | 1954/4096 [00:52<01:02, 34.27it/s, est. speed input: 37997.84 toks/s, output: 37.11 toks/s]
Processed prompts:  48%|████▊     | 1986/4096 [00:53<01:01, 34.24it/s, est. speed input: 37945.37 toks/s, output: 37.06 toks/s]
Processed prompts:  49%|████▉     | 2018/4096 [00:54<01:00, 34.22it/s, est. speed input: 37894.81 toks/s, output: 37.01 toks/s]
Processed prompts:  50%|█████     | 2050/4096 [00:55<00:59, 34.21it/s, est. speed input: 37845.70 toks/s, output: 36.96 toks/s]
Processed prompts:  51%|█████     | 2082/4096 [00:56<00:58, 34.20it/s, est. speed input: 37798.38 toks/s, output: 36.91 toks/s]
Processed prompts:  52%|█████▏    | 2114/4096 [00:57<00:57, 34.19it/s, est. speed input: 37752.74 toks/s, output: 36.87 toks/s]
Processed prompts:  52%|█████▏    | 2146/4096 [00:58<00:57, 34.18it/s, est. speed input: 37708.27 toks/s, output: 36.82 toks/s]
Processed prompts:  53%|█████▎    | 2178/4096 [00:59<00:56, 34.18it/s, est. speed input: 37665.21 toks/s, output: 36.78 toks/s]
Processed prompts:  54%|█████▍    | 2210/4096 [01:00<00:55, 34.18it/s, est. speed input: 37623.57 toks/s, output: 36.74 toks/s]
Processed prompts:  55%|█████▍    | 2242/4096 [01:01<00:54, 34.17it/s, est. speed input: 37583.14 toks/s, output: 36.70 toks/s]
Processed prompts:  56%|█████▌    | 2274/4096 [01:02<00:53, 34.17it/s, est. speed input: 37544.07 toks/s, output: 36.66 toks/s]
Processed prompts:  56%|█████▋    | 2306/4096 [01:02<00:52, 34.17it/s, est. speed input: 37506.19 toks/s, output: 36.63 toks/s]
Processed prompts:  57%|█████▋    | 2338/4096 [01:03<00:51, 34.17it/s, est. speed input: 37469.34 toks/s, output: 36.59 toks/s]
Processed prompts:  58%|█████▊    | 2370/4096 [01:04<00:50, 34.17it/s, est. speed input: 37433.46 toks/s, output: 36.56 toks/s]
Processed prompts:  59%|█████▊    | 2402/4096 [01:05<00:49, 34.17it/s, est. speed input: 37398.68 toks/s, output: 36.52 toks/s]
Processed prompts:  59%|█████▉    | 2434/4096 [01:06<00:48, 34.17it/s, est. speed input: 37365.04 toks/s, output: 36.49 toks/s]
Processed prompts:  60%|██████    | 2466/4096 [01:07<00:47, 34.18it/s, est. speed input: 37332.30 toks/s, output: 36.46 toks/s]
Processed prompts:  61%|██████    | 2498/4096 [01:08<00:46, 34.45it/s, est. speed input: 37313.98 toks/s, output: 36.44 toks/s]
Processed prompts:  62%|██████▏   | 2530/4096 [01:09<00:45, 34.37it/s, est. speed input: 37282.77 toks/s, output: 36.41 toks/s]
Processed prompts:  63%|██████▎   | 2562/4096 [01:10<00:44, 34.32it/s, est. speed input: 37252.66 toks/s, output: 36.38 toks/s]
Processed prompts:  63%|██████▎   | 2594/4096 [01:11<00:43, 34.27it/s, est. speed input: 37222.81 toks/s, output: 36.35 toks/s]
Processed prompts:  64%|██████▍   | 2626/4096 [01:12<00:42, 34.24it/s, est. speed input: 37193.85 toks/s, output: 36.32 toks/s]
Processed prompts:  65%|██████▍   | 2658/4096 [01:13<00:42, 34.22it/s, est. speed input: 37165.67 toks/s, output: 36.29 toks/s]
Processed prompts:  66%|██████▌   | 2690/4096 [01:14<00:41, 34.20it/s, est. speed input: 37138.11 toks/s, output: 36.27 toks/s]
Processed prompts:  66%|██████▋   | 2722/4096 [01:15<00:40, 34.20it/s, est. speed input: 37111.51 toks/s, output: 36.24 toks/s]
Processed prompts:  67%|██████▋   | 2754/4096 [01:16<00:39, 34.18it/s, est. speed input: 37085.00 toks/s, output: 36.22 toks/s]
Processed prompts:  68%|██████▊   | 2786/4096 [01:16<00:38, 34.18it/s, est. speed input: 37059.49 toks/s, output: 36.19 toks/s]
Processed prompts:  69%|██████▉   | 2818/4096 [01:17<00:37, 34.17it/s, est. speed input: 37034.54 toks/s, output: 36.17 toks/s]
Processed prompts:  70%|██████▉   | 2850/4096 [01:18<00:36, 34.17it/s, est. speed input: 37010.19 toks/s, output: 36.14 toks/s]
Processed prompts:  70%|███████   | 2882/4096 [01:19<00:35, 34.17it/s, est. speed input: 36986.48 toks/s, output: 36.12 toks/s]
Processed prompts:  71%|███████   | 2914/4096 [01:20<00:34, 34.17it/s, est. speed input: 36963.12 toks/s, output: 36.10 toks/s]
Processed prompts:  72%|███████▏  | 2946/4096 [01:21<00:33, 34.17it/s, est. speed input: 36940.51 toks/s, output: 36.07 toks/s]
Processed prompts:  73%|███████▎  | 2978/4096 [01:22<00:32, 34.17it/s, est. speed input: 36918.35 toks/s, output: 36.05 toks/s]
Processed prompts:  73%|███████▎  | 3010/4096 [01:23<00:31, 34.17it/s, est. speed input: 36896.64 toks/s, output: 36.03 toks/s]
Processed prompts:  74%|███████▍  | 3042/4096 [01:24<00:30, 34.16it/s, est. speed input: 36875.32 toks/s, output: 36.01 toks/s]
Processed prompts:  75%|███████▌  | 3074/4096 [01:25<00:29, 34.17it/s, est. speed input: 36854.67 toks/s, output: 35.99 toks/s]
Processed prompts:  76%|███████▌  | 3106/4096 [01:26<00:28, 34.17it/s, est. speed input: 36834.41 toks/s, output: 35.97 toks/s]
Processed prompts:  77%|███████▋  | 3138/4096 [01:27<00:28, 34.17it/s, est. speed input: 36814.55 toks/s, output: 35.95 toks/s]
Processed prompts:  77%|███████▋  | 3170/4096 [01:28<00:27, 34.16it/s, est. speed input: 36794.92 toks/s, output: 35.93 toks/s]
Processed prompts:  78%|███████▊  | 3202/4096 [01:29<00:26, 34.16it/s, est. speed input: 36775.84 toks/s, output: 35.91 toks/s]
Processed prompts:  79%|███████▉  | 3234/4096 [01:30<00:25, 34.16it/s, est. speed input: 36757.11 toks/s, output: 35.90 toks/s]
Processed prompts:  80%|███████▉  | 3266/4096 [01:31<00:24, 34.16it/s, est. speed input: 36739.02 toks/s, output: 35.88 toks/s]
Processed prompts:  81%|████████  | 3298/4096 [01:31<00:23, 34.15it/s, est. speed input: 36720.75 toks/s, output: 35.86 toks/s]
Processed prompts:  81%|████████▏ | 3330/4096 [01:32<00:22, 34.15it/s, est. speed input: 36703.17 toks/s, output: 35.84 toks/s]
Processed prompts:  82%|████████▏ | 3362/4096 [01:33<00:21, 34.16it/s, est. speed input: 36685.97 toks/s, output: 35.83 toks/s]
Processed prompts:  83%|████████▎ | 3394/4096 [01:34<00:20, 34.15it/s, est. speed input: 36668.99 toks/s, output: 35.81 toks/s]
Processed prompts:  84%|████████▎ | 3426/4096 [01:35<00:19, 34.16it/s, est. speed input: 36652.43 toks/s, output: 35.79 toks/s]
Processed prompts:  84%|████████▍ | 3458/4096 [01:36<00:18, 34.16it/s, est. speed input: 36636.34 toks/s, output: 35.78 toks/s]
Processed prompts:  85%|████████▌ | 3490/4096 [01:37<00:17, 34.16it/s, est. speed input: 36620.31 toks/s, output: 35.76 toks/s]
Processed prompts:  86%|████████▌ | 3522/4096 [01:38<00:16, 34.15it/s, est. speed input: 36604.61 toks/s, output: 35.75 toks/s]
Processed prompts:  87%|████████▋ | 3554/4096 [01:39<00:15, 34.16it/s, est. speed input: 36589.29 toks/s, output: 35.73 toks/s]
Processed prompts:  88%|████████▊ | 3586/4096 [01:40<00:14, 34.15it/s, est. speed input: 36574.18 toks/s, output: 35.72 toks/s]
Processed prompts:  88%|████████▊ | 3618/4096 [01:41<00:13, 34.16it/s, est. speed input: 36559.42 toks/s, output: 35.70 toks/s]
Processed prompts:  89%|████████▉ | 3650/4096 [01:42<00:13, 34.16it/s, est. speed input: 36545.12 toks/s, output: 35.69 toks/s]
Processed prompts:  90%|████████▉ | 3682/4096 [01:43<00:12, 34.15it/s, est. speed input: 36530.68 toks/s, output: 35.67 toks/s]
Processed prompts:  91%|█████████ | 3714/4096 [01:44<00:11, 34.15it/s, est. speed input: 36516.66 toks/s, output: 35.66 toks/s]
Processed prompts:  91%|█████████▏| 3746/4096 [01:45<00:10, 34.15it/s, est. speed input: 36502.86 toks/s, output: 35.65 toks/s]
Processed prompts:  92%|█████████▏| 3778/4096 [01:46<00:09, 34.15it/s, est. speed input: 36489.24 toks/s, output: 35.63 toks/s]
Processed prompts:  93%|█████████▎| 3810/4096 [01:46<00:08, 34.15it/s, est. speed input: 36475.91 toks/s, output: 35.62 toks/s]
Processed prompts:  94%|█████████▍| 3842/4096 [01:47<00:07, 34.15it/s, est. speed input: 36462.77 toks/s, output: 35.61 toks/s]
Processed prompts:  95%|█████████▍| 3874/4096 [01:48<00:06, 34.15it/s, est. speed input: 36450.02 toks/s, output: 35.60 toks/s]
Processed prompts:  95%|█████████▌| 3906/4096 [01:49<00:05, 34.14it/s, est. speed input: 36437.19 toks/s, output: 35.58 toks/s]
Processed prompts:  96%|█████████▌| 3938/4096 [01:50<00:04, 34.14it/s, est. speed input: 36424.63 toks/s, output: 35.57 toks/s]
Processed prompts:  97%|█████████▋| 3970/4096 [01:51<00:03, 34.15it/s, est. speed input: 36412.51 toks/s, output: 35.56 toks/s]
Processed prompts:  98%|█████████▊| 4002/4096 [01:52<00:02, 34.15it/s, est. speed input: 36400.43 toks/s, output: 35.55 toks/s]
Processed prompts:  98%|█████████▊| 4034/4096 [01:53<00:01, 34.42it/s, est. speed input: 36396.67 toks/s, output: 35.54 toks/s]
Processed prompts:  99%|█████████▉| 4066/4096 [01:54<00:00, 34.67it/s, est. speed input: 36394.34 toks/s, output: 35.54 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [01:54<00:00, 34.67it/s, est. speed input: 36662.76 toks/s, output: 35.80 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [01:54<00:00, 35.80it/s, est. speed input: 36662.76 toks/s, output: 35.80 toks/s]
[rank0]:[W128 00:44:24.069349996 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 154.1s

测试结果:
  Requests/s:   34.18
  Tokens/s:     35038.21
  Total Reqs:   4096
  Elapsed:      119.82s

  [Prefill 分析]
  Total Prefill Tokens: 4194304
  Prefill Tokens/s:     35004.02


------------------------------------------------------------
  生成 CSV: BitNet-2B-FP8
------------------------------------------------------------
[SUCCESS] CSV 保存到: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX5080_cc120_FP8E4M3_py312_cu129_x86_64/cublaslt/BitNet-2B-FP8_prefill.csv

预览:
------------------------------------------------------------
M_prefill,prompt_len,max_num_seqs,num_prompts,N_prefill,requests_per_s,tokens_per_s,elapsed_time_s
512,512,1,128,128,51.1683,26249.3234,2.5016
1024,1024,1,128,128,35.3566,36240.5557,3.6203
2048,1024,2,256,128,35.7961,36690.9931,7.1516
4096,1024,4,512,128,35.7605,36654.5207,14.3175
8192,1024,8,1024,128,34.4634,35324.9866,29.7127
16384,1024,16,2048,128,34.2323,35088.0903,59.8266
32768,1024,32,4096,128,34.1836,35038.2083,119.8235

------------------------------------------------------------

[INFO] 完成: 7 成功, 0 失败

============================================================
  BitNet-2B-FP8 | cuSPARSELt (2_4) | prefill
============================================================

[INFO] Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-FP8-SlideSparse-2_4
[INFO] Output: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX5080_cc120_FP8E4M3_py312_cu129_x86_64/cusparselt/2_4

============================================================
[1/7] 测试 M=512
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 512
│   M_prefill     = 512 (= 1 x 512)
│   M_decode      = 1
│   batched_tokens = 513 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 512
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 513
│   --max-num-batched-tokens = 513
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:44:29 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3500088) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3500088) WARNING 01-28 00:44:38 [backends.py:609] Failed to read file <frozen os>
Throughput: 56.42 requests/s, 28943.85 total tokens/s, 56.42 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128


─── STDERR ───
[2026-01-28 00:44:29] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:44:29] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:44:29] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:44:29] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:44:29] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:44:29] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:44:29] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:44:29] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:44:29] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:44:29] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:44:29] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:44:29] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:44:29] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:44:29] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:44:33] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:44:33] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:44:33] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:44:33] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:44:33] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:44:33] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:44:33] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:44:33] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:44:33] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:44:33] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:44:33] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:44:33] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:44:33] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:44:33] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3500088) [2026-01-28 00:44:34] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3500088) [2026-01-28 00:44:34] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3500088) [2026-01-28 00:44:34] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3500088) [2026-01-28 00:44:34] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=3500088) [2026-01-28 00:44:34] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3500088) [2026-01-28 00:44:34] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3500088) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3500088) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.96it/s]
(EngineCore_DP0 pid=3500088) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.96it/s]
(EngineCore_DP0 pid=3500088) 
(EngineCore_DP0 pid=3500088) [2026-01-28 00:44:34] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 2560] -> 1D uint8
(EngineCore_DP0 pid=3500088) [2026-01-28 00:44:34] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 6144000 bytes
(EngineCore_DP0 pid=3500088) [2026-01-28 00:44:34] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 2560] -> 1D uint8
(EngineCore_DP0 pid=3500088) [2026-01-28 00:44:34] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 4096000 bytes
(EngineCore_DP0 pid=3500088) [2026-01-28 00:44:34] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 2560] -> 1D uint8
(EngineCore_DP0 pid=3500088) [2026-01-28 00:44:34] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 22118400 bytes
(EngineCore_DP0 pid=3500088) [2026-01-28 00:44:34] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 6912] -> 1D uint8
(EngineCore_DP0 pid=3500088) [2026-01-28 00:44:34] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 11059200 bytes
(EngineCore_DP0 pid=3500088) 2026-01-28 00:44:45,603 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3500088) 2026-01-28 00:44:45,619 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3500088) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  4.52it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  4.70it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  4.67it/s]
(EngineCore_DP0 pid=3500088) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.16it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.16it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  88%|████████▊ | 113/128 [00:00<00:00, 1124.83it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 1128.41it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:14,  8.82it/s, est. speed input: 4514.14 toks/s, output: 8.82 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:00<00:03, 39.76it/s, est. speed input: 17990.30 toks/s, output: 35.14 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:00<00:02, 49.99it/s, est. speed input: 22589.79 toks/s, output: 44.12 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:00<00:01, 54.53it/s, est. speed input: 24814.52 toks/s, output: 48.47 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:00<00:01, 56.81it/s, est. speed input: 26093.00 toks/s, output: 50.96 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:00<00:01, 58.21it/s, est. speed input: 26947.46 toks/s, output: 52.63 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:00<00:01, 59.56it/s, est. speed input: 27654.30 toks/s, output: 54.01 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:00<00:01, 60.83it/s, est. speed input: 28251.21 toks/s, output: 55.18 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:01<00:01, 61.76it/s, est. speed input: 28730.19 toks/s, output: 56.11 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:01<00:01, 61.69it/s, est. speed input: 29009.75 toks/s, output: 56.66 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:01<00:00, 61.79it/s, est. speed input: 29259.02 toks/s, output: 57.15 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:01<00:00, 62.03it/s, est. speed input: 29489.25 toks/s, output: 57.60 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:01<00:00, 62.33it/s, est. speed input: 29700.29 toks/s, output: 58.01 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:01<00:00, 62.55it/s, est. speed input: 29882.44 toks/s, output: 58.36 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:01<00:00, 62.74it/s, est. speed input: 30044.51 toks/s, output: 58.68 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:01<00:00, 62.52it/s, est. speed input: 30151.68 toks/s, output: 58.89 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:01<00:00, 62.26it/s, est. speed input: 30235.90 toks/s, output: 59.05 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:02<00:00, 62.54it/s, est. speed input: 30352.01 toks/s, output: 59.28 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:02<00:00, 62.16it/s, est. speed input: 30406.99 toks/s, output: 59.39 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:02<00:00, 62.16it/s, est. speed input: 30417.62 toks/s, output: 59.41 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:02<00:00, 59.41it/s, est. speed input: 30417.62 toks/s, output: 59.41 toks/s]
[rank0]:[W128 00:44:49.396515666 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 25.4s

测试结果:
  Requests/s:   56.42
  Tokens/s:     28943.85
  Total Reqs:   128
  Elapsed:      2.27s

  [Prefill 分析]
  Total Prefill Tokens: 65536
  Prefill Tokens/s:     28887.43

============================================================
[2/7] 测试 M=1024
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 1024
│   M_prefill     = 1024 (= 1 x 1024)
│   M_decode      = 1
│   batched_tokens = 1025 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 1025
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:44:55 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3500806) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3500806) WARNING 01-28 00:45:04 [backends.py:609] Failed to read file <frozen os>
Throughput: 44.78 requests/s, 45903.30 total tokens/s, 44.78 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128


─── STDERR ───
[2026-01-28 00:44:55] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:44:55] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:44:55] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:44:55] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:44:55] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:44:55] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:44:55] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:44:55] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:44:55] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:44:55] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:44:55] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:44:55] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:44:55] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:44:55] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:44:58] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:44:58] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:44:58] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:44:58] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:44:58] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:44:58] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:44:58] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:44:58] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:44:58] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:44:58] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:44:58] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:44:58] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:44:58] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:44:58] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3500806) [2026-01-28 00:44:59] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3500806) [2026-01-28 00:44:59] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3500806) [2026-01-28 00:44:59] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3500806) [2026-01-28 00:44:59] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=3500806) [2026-01-28 00:44:59] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3500806) [2026-01-28 00:44:59] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3500806) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3500806) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.53it/s]
(EngineCore_DP0 pid=3500806) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.52it/s]
(EngineCore_DP0 pid=3500806) 
(EngineCore_DP0 pid=3500806) [2026-01-28 00:44:59] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 2560] -> 1D uint8
(EngineCore_DP0 pid=3500806) [2026-01-28 00:44:59] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 6144000 bytes
(EngineCore_DP0 pid=3500806) [2026-01-28 00:44:59] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 2560] -> 1D uint8
(EngineCore_DP0 pid=3500806) [2026-01-28 00:44:59] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 4096000 bytes
(EngineCore_DP0 pid=3500806) [2026-01-28 00:44:59] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 2560] -> 1D uint8
(EngineCore_DP0 pid=3500806) [2026-01-28 00:44:59] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 22118400 bytes
(EngineCore_DP0 pid=3500806) [2026-01-28 00:44:59] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 6912] -> 1D uint8
(EngineCore_DP0 pid=3500806) [2026-01-28 00:44:59] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 11059200 bytes
(EngineCore_DP0 pid=3500806) 2026-01-28 00:45:10,437 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3500806) 2026-01-28 00:45:10,453 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3500806) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00, 22.57it/s]
(EngineCore_DP0 pid=3500806) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.07it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.07it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  55%|█████▌    | 71/128 [00:00<00:00, 708.76it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 715.18it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:03, 38.27it/s, est. speed input: 39189.27 toks/s, output: 38.27 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:00<00:02, 44.08it/s, est. speed input: 44247.40 toks/s, output: 43.21 toks/s]
Processed prompts:  11%|█         | 14/128 [00:00<00:02, 45.97it/s, est. speed input: 45953.91 toks/s, output: 44.88 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:00<00:02, 46.82it/s, est. speed input: 46782.33 toks/s, output: 45.68 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:00<00:02, 47.40it/s, est. speed input: 47340.14 toks/s, output: 46.23 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:00<00:02, 47.66it/s, est. speed input: 47670.99 toks/s, output: 46.55 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:00<00:01, 47.76it/s, est. speed input: 47878.56 toks/s, output: 46.76 toks/s]
Processed prompts:  30%|███       | 39/128 [00:00<00:01, 47.86it/s, est. speed input: 48045.94 toks/s, output: 46.92 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:00<00:01, 47.93it/s, est. speed input: 48178.23 toks/s, output: 47.05 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:01<00:01, 47.98it/s, est. speed input: 48287.38 toks/s, output: 47.16 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:01<00:01, 47.98it/s, est. speed input: 48364.38 toks/s, output: 47.23 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:01<00:01, 48.14it/s, est. speed input: 48472.96 toks/s, output: 47.34 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:01<00:01, 48.18it/s, est. speed input: 48545.83 toks/s, output: 47.41 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:01<00:01, 48.23it/s, est. speed input: 48614.37 toks/s, output: 47.47 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:01<00:01, 48.22it/s, est. speed input: 48663.35 toks/s, output: 47.52 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:01<00:01, 48.19it/s, est. speed input: 48701.95 toks/s, output: 47.56 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:01<00:00, 48.22it/s, est. speed input: 48744.99 toks/s, output: 47.60 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:01<00:00, 48.19it/s, est. speed input: 48775.73 toks/s, output: 47.63 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:01<00:00, 48.21it/s, est. speed input: 48809.59 toks/s, output: 47.67 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:02<00:00, 48.23it/s, est. speed input: 48840.86 toks/s, output: 47.70 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:02<00:00, 48.18it/s, est. speed input: 48857.86 toks/s, output: 47.71 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:02<00:00, 48.18it/s, est. speed input: 48880.06 toks/s, output: 47.73 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:02<00:00, 48.21it/s, est. speed input: 48904.80 toks/s, output: 47.76 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:02<00:00, 48.21it/s, est. speed input: 48924.27 toks/s, output: 47.78 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:02<00:00, 48.16it/s, est. speed input: 48934.93 toks/s, output: 47.79 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:02<00:00, 48.16it/s, est. speed input: 48954.51 toks/s, output: 47.81 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:02<00:00, 47.81it/s, est. speed input: 48954.51 toks/s, output: 47.81 toks/s]
[rank0]:[W128 00:45:14.427371835 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 25.0s

测试结果:
  Requests/s:   44.78
  Tokens/s:     45903.30
  Total Reqs:   128
  Elapsed:      2.86s

  [Prefill 分析]
  Total Prefill Tokens: 131072
  Prefill Tokens/s:     45858.51

============================================================
[3/7] 测试 M=2048
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 2048
│   M_prefill     = 2048 (= 2 x 1024)
│   M_decode      = 2
│   batched_tokens = 2048 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 256
│   --max-num-seqs           = 2
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 2048
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:45:20 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3501442) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3501442) WARNING 01-28 00:45:29 [backends.py:609] Failed to read file <frozen os>
Throughput: 48.35 requests/s, 49555.67 total tokens/s, 48.35 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256


─── STDERR ───
[2026-01-28 00:45:20] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:45:20] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:45:20] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:45:20] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:45:20] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:45:20] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:45:20] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:45:20] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:45:20] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:45:20] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:45:20] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:45:20] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:45:20] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:45:20] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:45:24] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:45:24] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:45:24] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:45:24] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:45:24] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:45:24] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:45:24] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:45:24] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:45:24] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:45:24] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:45:24] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:45:24] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:45:24] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:45:24] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3501442) [2026-01-28 00:45:25] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3501442) [2026-01-28 00:45:25] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3501442) [2026-01-28 00:45:25] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3501442) [2026-01-28 00:45:25] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=3501442) [2026-01-28 00:45:25] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3501442) [2026-01-28 00:45:25] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3501442) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3501442) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.11it/s]
(EngineCore_DP0 pid=3501442) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.11it/s]
(EngineCore_DP0 pid=3501442) 
(EngineCore_DP0 pid=3501442) [2026-01-28 00:45:25] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 2560] -> 1D uint8
(EngineCore_DP0 pid=3501442) [2026-01-28 00:45:25] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 6144000 bytes
(EngineCore_DP0 pid=3501442) [2026-01-28 00:45:25] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 2560] -> 1D uint8
(EngineCore_DP0 pid=3501442) [2026-01-28 00:45:25] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 4096000 bytes
(EngineCore_DP0 pid=3501442) [2026-01-28 00:45:25] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 2560] -> 1D uint8
(EngineCore_DP0 pid=3501442) [2026-01-28 00:45:25] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 22118400 bytes
(EngineCore_DP0 pid=3501442) [2026-01-28 00:45:25] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 6912] -> 1D uint8
(EngineCore_DP0 pid=3501442) [2026-01-28 00:45:25] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 11059200 bytes
(EngineCore_DP0 pid=3501442) 2026-01-28 00:45:35,983 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3501442) 2026-01-28 00:45:35,998 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3501442) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  67%|██████▋   | 2/3 [00:00<00:00, 13.71it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00, 12.80it/s]
(EngineCore_DP0 pid=3501442) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 1/2 [00:00<00:00,  7.18it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00, 11.53it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:   0%|          | 1/256 [00:00<00:36,  6.93it/s]
Adding requests:  29%|██▉       | 74/256 [00:00<00:00, 366.53it/s]
Adding requests:  58%|█████▊    | 149/256 [00:00<00:00, 523.73it/s]
Adding requests:  88%|████████▊ | 225/256 [00:00<00:00, 609.19it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 526.42it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   8%|▊         | 20/256 [00:00<00:01, 148.25it/s, est. speed input: 151820.89 toks/s, output: 148.25 toks/s]
Processed prompts:  14%|█▎        | 35/256 [00:00<00:02, 77.60it/s, est. speed input: 86536.75 toks/s, output: 84.51 toks/s]   
Processed prompts:  18%|█▊        | 45/256 [00:00<00:03, 65.80it/s, est. speed input: 75163.44 toks/s, output: 73.40 toks/s]
Processed prompts:  21%|██        | 53/256 [00:00<00:03, 60.76it/s, est. speed input: 70347.74 toks/s, output: 68.70 toks/s]
Processed prompts:  23%|██▎       | 60/256 [00:00<00:03, 55.45it/s, est. speed input: 66072.95 toks/s, output: 64.52 toks/s]
Processed prompts:  26%|██▌       | 66/256 [00:01<00:03, 54.16it/s, est. speed input: 64429.93 toks/s, output: 62.92 toks/s]
Processed prompts:  28%|██▊       | 72/256 [00:01<00:03, 53.11it/s, est. speed input: 63104.86 toks/s, output: 61.63 toks/s]
Processed prompts:  30%|███       | 78/256 [00:01<00:03, 52.38it/s, est. speed input: 62051.13 toks/s, output: 60.59 toks/s]
Processed prompts:  33%|███▎      | 84/256 [00:01<00:03, 51.84it/s, est. speed input: 61173.76 toks/s, output: 59.74 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:01<00:03, 51.46it/s, est. speed input: 60438.24 toks/s, output: 59.02 toks/s]
Processed prompts:  38%|███▊      | 96/256 [00:01<00:03, 51.05it/s, est. speed input: 59769.10 toks/s, output: 58.37 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:01<00:03, 50.74it/s, est. speed input: 59185.60 toks/s, output: 57.80 toks/s]
Processed prompts:  42%|████▏     | 108/256 [00:01<00:02, 50.58it/s, est. speed input: 58691.36 toks/s, output: 57.32 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:02<00:02, 50.53it/s, est. speed input: 58272.16 toks/s, output: 56.91 toks/s]
Processed prompts:  47%|████▋     | 120/256 [00:02<00:02, 50.51it/s, est. speed input: 57901.97 toks/s, output: 56.54 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:02<00:02, 50.42it/s, est. speed input: 57555.47 toks/s, output: 56.21 toks/s]
Processed prompts:  52%|█████▏    | 132/256 [00:02<00:02, 50.29it/s, est. speed input: 57233.31 toks/s, output: 55.89 toks/s]
Processed prompts:  54%|█████▍    | 138/256 [00:02<00:02, 50.29it/s, est. speed input: 56957.27 toks/s, output: 55.62 toks/s]
Processed prompts:  56%|█████▋    | 144/256 [00:02<00:02, 50.25it/s, est. speed input: 56699.32 toks/s, output: 55.37 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:02<00:02, 50.31it/s, est. speed input: 56478.51 toks/s, output: 55.15 toks/s]
Processed prompts:  61%|██████    | 156/256 [00:02<00:01, 50.34it/s, est. speed input: 56275.02 toks/s, output: 54.96 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:02<00:01, 50.35it/s, est. speed input: 56086.50 toks/s, output: 54.77 toks/s]
Processed prompts:  66%|██████▌   | 168/256 [00:03<00:01, 50.37it/s, est. speed input: 55913.97 toks/s, output: 54.60 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:03<00:01, 50.41it/s, est. speed input: 55758.41 toks/s, output: 54.45 toks/s]
Processed prompts:  70%|███████   | 180/256 [00:03<00:01, 50.42it/s, est. speed input: 55610.17 toks/s, output: 54.31 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:03<00:01, 50.42it/s, est. speed input: 55472.13 toks/s, output: 54.17 toks/s]
Processed prompts:  75%|███████▌  | 192/256 [00:03<00:01, 50.32it/s, est. speed input: 55331.60 toks/s, output: 54.03 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:03<00:01, 50.35it/s, est. speed input: 55211.52 toks/s, output: 53.92 toks/s]
Processed prompts:  80%|███████▉  | 204/256 [00:03<00:01, 50.36it/s, est. speed input: 55098.27 toks/s, output: 53.81 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:03<00:00, 50.36it/s, est. speed input: 54990.10 toks/s, output: 53.70 toks/s]
Processed prompts:  84%|████████▍ | 216/256 [00:04<00:00, 50.29it/s, est. speed input: 54881.84 toks/s, output: 53.60 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:04<00:00, 50.27it/s, est. speed input: 54782.41 toks/s, output: 53.50 toks/s]
Processed prompts:  89%|████████▉ | 228/256 [00:04<00:00, 50.28it/s, est. speed input: 54690.71 toks/s, output: 53.41 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:04<00:00, 50.22it/s, est. speed input: 54598.05 toks/s, output: 53.32 toks/s]
Processed prompts:  94%|█████████▍| 240/256 [00:04<00:00, 50.25it/s, est. speed input: 54516.37 toks/s, output: 53.24 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:04<00:00, 50.10it/s, est. speed input: 54423.66 toks/s, output: 53.15 toks/s]
Processed prompts:  98%|█████████▊| 252/256 [00:04<00:00, 50.18it/s, est. speed input: 54352.54 toks/s, output: 53.08 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:04<00:00, 50.18it/s, est. speed input: 54524.23 toks/s, output: 53.25 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:04<00:00, 53.25it/s, est. speed input: 54524.23 toks/s, output: 53.25 toks/s]
[rank0]:[W128 00:45:42.603616496 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 28.1s

测试结果:
  Requests/s:   48.35
  Tokens/s:     49555.67
  Total Reqs:   256
  Elapsed:      5.30s

  [Prefill 分析]
  Total Prefill Tokens: 262144
  Prefill Tokens/s:     49507.32

============================================================
[4/7] 测试 M=4096
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 4096
│   M_prefill     = 4096 (= 4 x 1024)
│   M_decode      = 4
│   batched_tokens = 4096 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 512
│   --max-num-seqs           = 4
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 4096
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:45:49 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3502119) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3502119) WARNING 01-28 00:45:58 [backends.py:609] Failed to read file <frozen os>
Throughput: 49.38 requests/s, 50613.85 total tokens/s, 49.38 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512


─── STDERR ───
[2026-01-28 00:45:49] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:45:49] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:45:49] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:45:49] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:45:49] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:45:49] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:45:49] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:45:49] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:45:49] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:45:49] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:45:49] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:45:49] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:45:49] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:45:49] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:45:53] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:45:53] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:45:53] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:45:53] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:45:53] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:45:53] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:45:53] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:45:53] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:45:53] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:45:53] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:45:53] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:45:53] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:45:53] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:45:53] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3502119) [2026-01-28 00:45:53] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3502119) [2026-01-28 00:45:53] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3502119) [2026-01-28 00:45:53] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3502119) [2026-01-28 00:45:53] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=3502119) [2026-01-28 00:45:53] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3502119) [2026-01-28 00:45:53] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3502119) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3502119) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.90it/s]
(EngineCore_DP0 pid=3502119) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.89it/s]
(EngineCore_DP0 pid=3502119) 
(EngineCore_DP0 pid=3502119) [2026-01-28 00:45:54] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 2560] -> 1D uint8
(EngineCore_DP0 pid=3502119) [2026-01-28 00:45:54] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 6144000 bytes
(EngineCore_DP0 pid=3502119) [2026-01-28 00:45:54] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 2560] -> 1D uint8
(EngineCore_DP0 pid=3502119) [2026-01-28 00:45:54] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 4096000 bytes
(EngineCore_DP0 pid=3502119) [2026-01-28 00:45:54] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 2560] -> 1D uint8
(EngineCore_DP0 pid=3502119) [2026-01-28 00:45:54] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 22118400 bytes
(EngineCore_DP0 pid=3502119) [2026-01-28 00:45:54] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 6912] -> 1D uint8
(EngineCore_DP0 pid=3502119) [2026-01-28 00:45:54] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 11059200 bytes
(EngineCore_DP0 pid=3502119) 2026-01-28 00:46:04,794 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3502119) 2026-01-28 00:46:04,810 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3502119) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  75%|███████▌  | 3/4 [00:00<00:00, 24.58it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00, 23.01it/s]
(EngineCore_DP0 pid=3502119) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  33%|███▎      | 1/3 [00:00<00:00,  7.29it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00, 14.67it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:  14%|█▎        | 70/512 [00:00<00:00, 698.87it/s]
Adding requests:  28%|██▊       | 144/512 [00:00<00:00, 718.35it/s]
Adding requests:  42%|████▏     | 217/512 [00:00<00:00, 723.48it/s]
Adding requests:  57%|█████▋    | 293/512 [00:00<00:00, 736.20it/s]
Adding requests:  72%|███████▏  | 369/512 [00:00<00:00, 741.74it/s]
Adding requests:  87%|████████▋ | 444/512 [00:00<00:00, 741.99it/s]
Adding requests: 100%|██████████| 512/512 [00:00<00:00, 736.62it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   7%|▋         | 34/512 [00:00<00:02, 207.42it/s, est. speed input: 212418.94 toks/s, output: 207.42 toks/s]
Processed prompts:  11%|█         | 55/512 [00:00<00:05, 86.94it/s, est. speed input: 99776.31 toks/s, output: 97.44 toks/s]   
Processed prompts:  13%|█▎        | 67/512 [00:00<00:06, 72.23it/s, est. speed input: 85324.79 toks/s, output: 83.32 toks/s]
Processed prompts:  15%|█▍        | 76/512 [00:00<00:06, 67.81it/s, est. speed input: 80712.98 toks/s, output: 78.82 toks/s]
Processed prompts:  16%|█▋        | 84/512 [00:01<00:06, 62.72it/s, est. speed input: 76476.95 toks/s, output: 74.68 toks/s]
Processed prompts:  18%|█▊        | 91/512 [00:01<00:07, 57.29it/s, est. speed input: 72545.59 toks/s, output: 70.85 toks/s]
Processed prompts:  19%|█▉        | 98/512 [00:01<00:07, 53.32it/s, est. speed input: 69459.33 toks/s, output: 67.83 toks/s]
Processed prompts:  21%|██        | 106/512 [00:01<00:07, 52.40it/s, est. speed input: 67660.25 toks/s, output: 66.07 toks/s]
Processed prompts:  22%|██▏       | 114/512 [00:01<00:07, 51.71it/s, est. speed input: 66176.68 toks/s, output: 64.63 toks/s]
Processed prompts:  24%|██▍       | 122/512 [00:01<00:07, 51.22it/s, est. speed input: 64936.58 toks/s, output: 63.41 toks/s]
Processed prompts:  25%|██▌       | 130/512 [00:02<00:07, 50.88it/s, est. speed input: 63890.57 toks/s, output: 62.39 toks/s]
Processed prompts:  27%|██▋       | 138/512 [00:02<00:07, 50.63it/s, est. speed input: 62990.14 toks/s, output: 61.51 toks/s]
Processed prompts:  29%|██▊       | 146/512 [00:02<00:07, 50.41it/s, est. speed input: 62197.07 toks/s, output: 60.74 toks/s]
Processed prompts:  30%|███       | 154/512 [00:02<00:07, 50.25it/s, est. speed input: 61500.36 toks/s, output: 60.06 toks/s]
Processed prompts:  32%|███▏      | 162/512 [00:02<00:06, 50.14it/s, est. speed input: 60887.73 toks/s, output: 59.46 toks/s]
Processed prompts:  33%|███▎      | 170/512 [00:02<00:06, 50.07it/s, est. speed input: 60342.56 toks/s, output: 58.93 toks/s]
Processed prompts:  35%|███▍      | 178/512 [00:03<00:06, 50.03it/s, est. speed input: 59859.42 toks/s, output: 58.46 toks/s]
Processed prompts:  36%|███▋      | 186/512 [00:03<00:06, 50.00it/s, est. speed input: 59422.61 toks/s, output: 58.03 toks/s]
Processed prompts:  38%|███▊      | 194/512 [00:03<00:06, 49.99it/s, est. speed input: 59030.33 toks/s, output: 57.65 toks/s]
Processed prompts:  39%|███▉      | 202/512 [00:03<00:06, 49.98it/s, est. speed input: 58671.75 toks/s, output: 57.30 toks/s]
Processed prompts:  41%|████      | 210/512 [00:03<00:06, 50.01it/s, est. speed input: 58351.77 toks/s, output: 56.98 toks/s]
Processed prompts:  43%|████▎     | 218/512 [00:03<00:05, 50.07it/s, est. speed input: 58063.72 toks/s, output: 56.70 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:04<00:05, 50.06it/s, est. speed input: 57791.80 toks/s, output: 56.44 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:04<00:05, 50.07it/s, est. speed input: 57543.10 toks/s, output: 56.19 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:04<00:05, 50.02it/s, est. speed input: 57304.48 toks/s, output: 55.96 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:04<00:05, 49.99it/s, est. speed input: 57082.51 toks/s, output: 55.74 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:04<00:05, 50.02it/s, est. speed input: 56883.40 toks/s, output: 55.55 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:04<00:04, 49.99it/s, est. speed input: 56691.05 toks/s, output: 55.36 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:04<00:04, 50.01it/s, est. speed input: 56516.57 toks/s, output: 55.19 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:05<00:04, 49.97it/s, est. speed input: 56345.98 toks/s, output: 55.03 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:05<00:04, 49.96it/s, est. speed input: 56188.38 toks/s, output: 54.87 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:05<00:04, 49.94it/s, est. speed input: 56038.30 toks/s, output: 54.72 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:05<00:04, 49.92it/s, est. speed input: 55895.65 toks/s, output: 54.59 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:05<00:03, 50.01it/s, est. speed input: 55772.07 toks/s, output: 54.46 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:05<00:03, 50.03it/s, est. speed input: 55651.09 toks/s, output: 54.35 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:06<00:03, 50.00it/s, est. speed input: 55532.28 toks/s, output: 54.23 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:06<00:03, 50.03it/s, est. speed input: 55424.37 toks/s, output: 54.13 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:06<00:03, 49.96it/s, est. speed input: 55313.08 toks/s, output: 54.02 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:06<00:03, 49.97it/s, est. speed input: 55212.86 toks/s, output: 53.92 toks/s]
Processed prompts:  71%|███████   | 362/512 [00:06<00:02, 50.00it/s, est. speed input: 55119.22 toks/s, output: 53.83 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [00:06<00:02, 49.98it/s, est. speed input: 55025.95 toks/s, output: 53.74 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [00:07<00:02, 50.02it/s, est. speed input: 54941.77 toks/s, output: 53.65 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [00:07<00:02, 49.99it/s, est. speed input: 54857.30 toks/s, output: 53.57 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [00:07<00:02, 49.99it/s, est. speed input: 54777.14 toks/s, output: 53.49 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [00:07<00:02, 49.92it/s, est. speed input: 54695.41 toks/s, output: 53.41 toks/s]
Processed prompts:  80%|████████  | 410/512 [00:07<00:02, 50.00it/s, est. speed input: 54626.78 toks/s, output: 53.35 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [00:07<00:01, 50.05it/s, est. speed input: 54560.43 toks/s, output: 53.28 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [00:08<00:01, 50.02it/s, est. speed input: 54492.22 toks/s, output: 53.21 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [00:08<00:01, 50.04it/s, est. speed input: 54429.74 toks/s, output: 53.15 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [00:08<00:01, 50.04it/s, est. speed input: 54368.44 toks/s, output: 53.09 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [00:08<00:01, 49.98it/s, est. speed input: 54305.37 toks/s, output: 53.03 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [00:08<00:01, 49.94it/s, est. speed input: 54244.60 toks/s, output: 52.97 toks/s]
Processed prompts:  91%|█████████ | 466/512 [00:08<00:00, 49.99it/s, est. speed input: 54191.66 toks/s, output: 52.92 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [00:08<00:00, 49.97it/s, est. speed input: 54136.39 toks/s, output: 52.87 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [00:09<00:00, 50.01it/s, est. speed input: 54087.24 toks/s, output: 52.82 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [00:09<00:00, 49.98it/s, est. speed input: 54035.76 toks/s, output: 52.77 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [00:09<00:00, 49.91it/s, est. speed input: 53982.79 toks/s, output: 52.72 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [00:09<00:00, 49.94it/s, est. speed input: 53936.61 toks/s, output: 52.67 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:09<00:00, 49.94it/s, est. speed input: 54202.84 toks/s, output: 52.93 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:09<00:00, 52.93it/s, est. speed input: 54202.84 toks/s, output: 52.93 toks/s]
[rank0]:[W128 00:46:16.597041562 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 34.0s

测试结果:
  Requests/s:   49.38
  Tokens/s:     50613.85
  Total Reqs:   512
  Elapsed:      10.37s

  [Prefill 分析]
  Total Prefill Tokens: 524288
  Prefill Tokens/s:     50564.47

============================================================
[5/7] 测试 M=8192
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 8192
│   M_prefill     = 8192 (= 8 x 1024)
│   M_decode      = 8
│   batched_tokens = 8192 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 1024
│   --max-num-seqs           = 8
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 8192
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:46:24 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3502884) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3502884) WARNING 01-28 00:46:33 [backends.py:609] Failed to read file <frozen os>
Throughput: 46.99 requests/s, 48162.42 total tokens/s, 46.99 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024


─── STDERR ───
[2026-01-28 00:46:24] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:46:24] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:46:24] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:46:24] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:46:24] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:46:24] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:46:24] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:46:24] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:46:24] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:46:24] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:46:24] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:46:24] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:46:24] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:46:24] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:46:28] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:46:28] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:46:28] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:46:28] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:46:28] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:46:28] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:46:28] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:46:28] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:46:28] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:46:28] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:46:28] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:46:28] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:46:28] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:46:28] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3502884) [2026-01-28 00:46:29] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3502884) [2026-01-28 00:46:29] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3502884) [2026-01-28 00:46:29] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3502884) [2026-01-28 00:46:29] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=3502884) [2026-01-28 00:46:29] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3502884) [2026-01-28 00:46:29] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3502884) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3502884) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.68it/s]
(EngineCore_DP0 pid=3502884) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.67it/s]
(EngineCore_DP0 pid=3502884) 
(EngineCore_DP0 pid=3502884) [2026-01-28 00:46:29] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 2560] -> 1D uint8
(EngineCore_DP0 pid=3502884) [2026-01-28 00:46:29] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 6144000 bytes
(EngineCore_DP0 pid=3502884) [2026-01-28 00:46:29] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 2560] -> 1D uint8
(EngineCore_DP0 pid=3502884) [2026-01-28 00:46:29] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 4096000 bytes
(EngineCore_DP0 pid=3502884) [2026-01-28 00:46:29] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 2560] -> 1D uint8
(EngineCore_DP0 pid=3502884) [2026-01-28 00:46:29] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 22118400 bytes
(EngineCore_DP0 pid=3502884) [2026-01-28 00:46:29] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 6912] -> 1D uint8
(EngineCore_DP0 pid=3502884) [2026-01-28 00:46:29] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 11059200 bytes
(EngineCore_DP0 pid=3502884) 2026-01-28 00:46:39,816 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3502884) 2026-01-28 00:46:39,832 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3502884) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:00,  6.77it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  80%|████████  | 4/5 [00:00<00:00, 16.52it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00, 15.66it/s]
(EngineCore_DP0 pid=3502884) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:00,  7.28it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00, 18.43it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00, 16.52it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   7%|▋         | 71/1024 [00:00<00:01, 702.68it/s]
Adding requests:  14%|█▍        | 145/1024 [00:00<00:01, 722.88it/s]
Adding requests:  21%|██▏       | 220/1024 [00:00<00:01, 732.41it/s]
Adding requests:  29%|██▊       | 294/1024 [00:00<00:01, 717.60it/s]
Adding requests:  36%|███▌      | 366/1024 [00:00<00:00, 716.07it/s]
Adding requests:  43%|████▎     | 438/1024 [00:00<00:00, 715.64it/s]
Adding requests:  50%|█████     | 513/1024 [00:00<00:00, 725.72it/s]
Adding requests:  57%|█████▋    | 588/1024 [00:00<00:00, 730.66it/s]
Adding requests:  65%|██████▍   | 662/1024 [00:00<00:00, 727.77it/s]
Adding requests:  72%|███████▏  | 740/1024 [00:01<00:00, 739.43it/s]
Adding requests:  79%|███████▉  | 814/1024 [00:01<00:00, 728.14it/s]
Adding requests:  87%|████████▋ | 888/1024 [00:01<00:00, 730.08it/s]
Adding requests:  94%|█████████▍| 965/1024 [00:01<00:00, 740.82it/s]
Adding requests: 100%|██████████| 1024/1024 [00:01<00:00, 731.81it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▋         | 66/1024 [00:00<00:03, 305.98it/s, est. speed input: 313352.59 toks/s, output: 305.98 toks/s]
Processed prompts:   9%|▉         | 97/1024 [00:00<00:07, 117.01it/s, est. speed input: 137102.67 toks/s, output: 133.89 toks/s]
Processed prompts:  11%|█         | 114/1024 [00:01<00:12, 73.19it/s, est. speed input: 94659.48 toks/s, output: 92.44 toks/s]  
Processed prompts:  12%|█▏        | 125/1024 [00:01<00:12, 71.52it/s, est. speed input: 91234.63 toks/s, output: 89.10 toks/s]
Processed prompts:  13%|█▎        | 134/1024 [00:01<00:13, 67.40it/s, est. speed input: 87241.56 toks/s, output: 85.20 toks/s]
Processed prompts:  14%|█▍        | 142/1024 [00:01<00:14, 62.53it/s, est. speed input: 83450.82 toks/s, output: 81.49 toks/s]
Processed prompts:  15%|█▍        | 149/1024 [00:01<00:15, 57.07it/s, est. speed input: 79787.89 toks/s, output: 77.92 toks/s]
Processed prompts:  15%|█▌        | 155/1024 [00:02<00:16, 51.28it/s, est. speed input: 76244.19 toks/s, output: 74.46 toks/s]
Processed prompts:  16%|█▌        | 162/1024 [00:02<00:17, 48.50it/s, est. speed input: 73681.62 toks/s, output: 71.95 toks/s]
Processed prompts:  17%|█▋        | 170/1024 [00:02<00:17, 48.12it/s, est. speed input: 71903.28 toks/s, output: 70.22 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [00:02<00:17, 47.84it/s, est. speed input: 70355.78 toks/s, output: 68.71 toks/s]
Processed prompts:  18%|█▊        | 186/1024 [00:02<00:17, 47.61it/s, est. speed input: 68989.91 toks/s, output: 67.37 toks/s]
Processed prompts:  19%|█▉        | 194/1024 [00:02<00:17, 47.46it/s, est. speed input: 67785.56 toks/s, output: 66.20 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [00:03<00:17, 47.37it/s, est. speed input: 66718.54 toks/s, output: 65.15 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:03<00:17, 47.31it/s, est. speed input: 65763.85 toks/s, output: 64.22 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [00:03<00:17, 47.23it/s, est. speed input: 64893.90 toks/s, output: 63.37 toks/s]
Processed prompts:  22%|██▏       | 226/1024 [00:03<00:16, 47.20it/s, est. speed input: 64110.86 toks/s, output: 62.61 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:03<00:16, 47.19it/s, est. speed input: 63402.33 toks/s, output: 61.92 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:03<00:16, 47.16it/s, est. speed input: 62749.90 toks/s, output: 61.28 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:04<00:16, 47.18it/s, est. speed input: 62157.07 toks/s, output: 60.70 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:04<00:16, 47.19it/s, est. speed input: 61610.92 toks/s, output: 60.17 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:04<00:16, 47.20it/s, est. speed input: 61107.09 toks/s, output: 59.67 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:04<00:15, 47.14it/s, est. speed input: 60630.44 toks/s, output: 59.21 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:04<00:15, 47.18it/s, est. speed input: 60198.71 toks/s, output: 58.79 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:04<00:15, 47.18it/s, est. speed input: 59793.43 toks/s, output: 58.39 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:05<00:15, 47.15it/s, est. speed input: 59410.23 toks/s, output: 58.02 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:05<00:15, 47.17it/s, est. speed input: 59057.13 toks/s, output: 57.67 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:05<00:15, 47.16it/s, est. speed input: 58722.45 toks/s, output: 57.35 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:05<00:14, 47.13it/s, est. speed input: 58404.72 toks/s, output: 57.04 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:05<00:14, 47.13it/s, est. speed input: 58108.97 toks/s, output: 56.75 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:05<00:14, 47.13it/s, est. speed input: 57829.93 toks/s, output: 56.47 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:06<00:14, 47.15it/s, est. speed input: 57568.25 toks/s, output: 56.22 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:06<00:14, 47.17it/s, est. speed input: 57321.34 toks/s, output: 55.98 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:06<00:14, 47.19it/s, est. speed input: 57088.26 toks/s, output: 55.75 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:06<00:13, 47.14it/s, est. speed input: 56860.31 toks/s, output: 55.53 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:06<00:13, 47.16it/s, est. speed input: 56648.92 toks/s, output: 55.32 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:07<00:13, 47.18it/s, est. speed input: 56448.42 toks/s, output: 55.13 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [00:07<00:13, 47.17it/s, est. speed input: 56254.66 toks/s, output: 54.94 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:07<00:13, 47.17it/s, est. speed input: 56070.84 toks/s, output: 54.76 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:07<00:13, 47.18it/s, est. speed input: 55896.97 toks/s, output: 54.59 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:07<00:12, 47.13it/s, est. speed input: 55724.93 toks/s, output: 54.42 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:07<00:12, 47.16it/s, est. speed input: 55566.42 toks/s, output: 54.26 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:08<00:12, 47.16it/s, est. speed input: 55412.55 toks/s, output: 54.11 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:08<00:12, 47.15it/s, est. speed input: 55264.15 toks/s, output: 53.97 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:08<00:12, 47.14it/s, est. speed input: 55121.52 toks/s, output: 53.83 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:08<00:12, 47.15it/s, est. speed input: 54985.81 toks/s, output: 53.70 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:08<00:11, 47.13it/s, est. speed input: 54853.65 toks/s, output: 53.57 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:08<00:11, 47.12it/s, est. speed input: 54727.08 toks/s, output: 53.44 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:09<00:11, 47.14it/s, est. speed input: 54606.51 toks/s, output: 53.33 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:09<00:11, 47.15it/s, est. speed input: 54490.34 toks/s, output: 53.21 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:09<00:11, 47.14it/s, est. speed input: 54377.16 toks/s, output: 53.10 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:09<00:10, 47.14it/s, est. speed input: 54268.94 toks/s, output: 53.00 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:09<00:10, 47.11it/s, est. speed input: 54162.21 toks/s, output: 52.89 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:09<00:10, 47.13it/s, est. speed input: 54061.97 toks/s, output: 52.79 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:10<00:10, 47.14it/s, est. speed input: 53964.29 toks/s, output: 52.70 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:10<00:10, 47.14it/s, est. speed input: 53869.74 toks/s, output: 52.61 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:10<00:10, 47.14it/s, est. speed input: 53778.50 toks/s, output: 52.52 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:10<00:09, 47.15it/s, est. speed input: 53690.71 toks/s, output: 52.43 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:10<00:09, 47.13it/s, est. speed input: 53604.06 toks/s, output: 52.35 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:10<00:09, 47.13it/s, est. speed input: 53520.87 toks/s, output: 52.27 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:11<00:09, 47.15it/s, est. speed input: 53441.52 toks/s, output: 52.19 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:11<00:09, 47.16it/s, est. speed input: 53364.35 toks/s, output: 52.11 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:11<00:09, 47.14it/s, est. speed input: 53287.71 toks/s, output: 52.04 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:11<00:08, 47.14it/s, est. speed input: 53214.18 toks/s, output: 51.97 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:11<00:08, 47.10it/s, est. speed input: 53140.78 toks/s, output: 51.90 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:11<00:08, 47.11it/s, est. speed input: 53071.51 toks/s, output: 51.83 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:12<00:08, 47.12it/s, est. speed input: 53004.01 toks/s, output: 51.76 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:12<00:08, 47.15it/s, est. speed input: 52939.83 toks/s, output: 51.70 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:12<00:08, 47.17it/s, est. speed input: 52877.10 toks/s, output: 51.64 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:12<00:07, 47.18it/s, est. speed input: 52815.90 toks/s, output: 51.58 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:12<00:07, 47.17it/s, est. speed input: 52755.60 toks/s, output: 51.52 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:12<00:07, 47.18it/s, est. speed input: 52697.86 toks/s, output: 51.46 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:13<00:07, 47.20it/s, est. speed input: 52641.94 toks/s, output: 51.41 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:13<00:07, 47.22it/s, est. speed input: 52588.01 toks/s, output: 51.36 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:13<00:07, 47.19it/s, est. speed input: 52533.22 toks/s, output: 51.30 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:13<00:06, 47.16it/s, est. speed input: 52479.46 toks/s, output: 51.25 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:13<00:06, 47.12it/s, est. speed input: 52425.91 toks/s, output: 51.20 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:13<00:06, 47.11it/s, est. speed input: 52374.85 toks/s, output: 51.15 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:14<00:06, 47.13it/s, est. speed input: 52325.98 toks/s, output: 51.10 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:14<00:06, 47.13it/s, est. speed input: 52277.73 toks/s, output: 51.05 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:14<00:06, 47.13it/s, est. speed input: 52230.81 toks/s, output: 51.01 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:14<00:05, 47.11it/s, est. speed input: 52183.96 toks/s, output: 50.96 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:14<00:05, 47.10it/s, est. speed input: 52138.19 toks/s, output: 50.92 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:14<00:05, 47.12it/s, est. speed input: 52094.72 toks/s, output: 50.87 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:15<00:05, 47.13it/s, est. speed input: 52052.03 toks/s, output: 50.83 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:15<00:05, 47.15it/s, est. speed input: 52010.92 toks/s, output: 50.79 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:15<00:05, 47.16it/s, est. speed input: 51970.56 toks/s, output: 50.75 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:15<00:04, 47.14it/s, est. speed input: 51929.70 toks/s, output: 50.71 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:15<00:04, 47.15it/s, est. speed input: 51890.85 toks/s, output: 50.67 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:15<00:04, 47.14it/s, est. speed input: 51852.36 toks/s, output: 50.64 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:16<00:04, 47.14it/s, est. speed input: 51814.68 toks/s, output: 50.60 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:16<00:04, 47.15it/s, est. speed input: 51778.12 toks/s, output: 50.56 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:16<00:04, 47.17it/s, est. speed input: 51743.18 toks/s, output: 50.53 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [00:16<00:03, 47.16it/s, est. speed input: 51707.77 toks/s, output: 50.50 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [00:16<00:03, 47.15it/s, est. speed input: 51672.91 toks/s, output: 50.46 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:17<00:03, 47.16it/s, est. speed input: 51639.33 toks/s, output: 50.43 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [00:17<00:03, 47.16it/s, est. speed input: 51606.46 toks/s, output: 50.40 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [00:17<00:03, 47.16it/s, est. speed input: 51573.94 toks/s, output: 50.37 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [00:17<00:03, 47.17it/s, est. speed input: 51542.40 toks/s, output: 50.33 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [00:17<00:02, 47.13it/s, est. speed input: 51510.04 toks/s, output: 50.30 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [00:17<00:02, 47.11it/s, est. speed input: 51478.43 toks/s, output: 50.27 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [00:18<00:02, 47.12it/s, est. speed input: 51448.34 toks/s, output: 50.24 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [00:18<00:02, 47.10it/s, est. speed input: 51417.86 toks/s, output: 50.21 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [00:18<00:02, 47.11it/s, est. speed input: 51388.87 toks/s, output: 50.18 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [00:18<00:01, 47.14it/s, est. speed input: 51361.08 toks/s, output: 50.16 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [00:18<00:01, 47.11it/s, est. speed input: 51331.96 toks/s, output: 50.13 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [00:18<00:01, 47.12it/s, est. speed input: 51304.51 toks/s, output: 50.10 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [00:19<00:01, 47.13it/s, est. speed input: 51277.67 toks/s, output: 50.08 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [00:19<00:01, 47.13it/s, est. speed input: 51251.30 toks/s, output: 50.05 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [00:19<00:01, 47.15it/s, est. speed input: 51225.55 toks/s, output: 50.02 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [00:19<00:00, 47.17it/s, est. speed input: 51200.46 toks/s, output: 50.00 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [00:19<00:00, 47.14it/s, est. speed input: 51174.57 toks/s, output: 49.98 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [00:19<00:00, 47.13it/s, est. speed input: 51149.63 toks/s, output: 49.95 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [00:20<00:00, 47.15it/s, est. speed input: 51125.68 toks/s, output: 49.93 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [00:20<00:00, 47.10it/s, est. speed input: 51100.49 toks/s, output: 49.90 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [00:20<00:00, 48.51it/s, est. speed input: 51117.89 toks/s, output: 49.92 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:20<00:00, 48.51it/s, est. speed input: 51418.87 toks/s, output: 50.21 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:20<00:00, 50.21it/s, est. speed input: 51418.87 toks/s, output: 50.21 toks/s]
[rank0]:[W128 00:47:03.096323898 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 46.6s

测试结果:
  Requests/s:   46.99
  Tokens/s:     48162.42
  Total Reqs:   1024
  Elapsed:      21.79s

  [Prefill 分析]
  Total Prefill Tokens: 1048576
  Prefill Tokens/s:     48115.43

============================================================
[6/7] 测试 M=16384
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 16384
│   M_prefill     = 16384 (= 16 x 1024)
│   M_decode      = 16
│   batched_tokens = 16384 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 2048
│   --max-num-seqs           = 16
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 16384
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:47:13 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3503840) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3503840) WARNING 01-28 00:47:23 [backends.py:609] Failed to read file <frozen os>
Throughput: 46.16 requests/s, 47310.48 total tokens/s, 46.16 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048


─── STDERR ───
[2026-01-28 00:47:13] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:47:13] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:47:13] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:47:13] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:47:13] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:47:13] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:47:13] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:47:13] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:47:13] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:47:13] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:47:13] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:47:13] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:47:13] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:47:13] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:47:17] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:47:17] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:47:17] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:47:17] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:47:17] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:47:17] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:47:17] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:47:17] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:47:17] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:47:17] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:47:17] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:47:17] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:47:17] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:47:17] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3503840) [2026-01-28 00:47:18] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3503840) [2026-01-28 00:47:18] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3503840) [2026-01-28 00:47:18] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3503840) [2026-01-28 00:47:18] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=3503840) [2026-01-28 00:47:18] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3503840) [2026-01-28 00:47:18] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3503840) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3503840) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.68it/s]
(EngineCore_DP0 pid=3503840) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.67it/s]
(EngineCore_DP0 pid=3503840) 
(EngineCore_DP0 pid=3503840) [2026-01-28 00:47:19] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 2560] -> 1D uint8
(EngineCore_DP0 pid=3503840) [2026-01-28 00:47:19] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 6144000 bytes
(EngineCore_DP0 pid=3503840) [2026-01-28 00:47:19] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 2560] -> 1D uint8
(EngineCore_DP0 pid=3503840) [2026-01-28 00:47:19] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 4096000 bytes
(EngineCore_DP0 pid=3503840) [2026-01-28 00:47:19] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 2560] -> 1D uint8
(EngineCore_DP0 pid=3503840) [2026-01-28 00:47:19] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 22118400 bytes
(EngineCore_DP0 pid=3503840) [2026-01-28 00:47:19] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 6912] -> 1D uint8
(EngineCore_DP0 pid=3503840) [2026-01-28 00:47:19] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 11059200 bytes
(EngineCore_DP0 pid=3503840) 2026-01-28 00:47:29,568 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3503840) 2026-01-28 00:47:29,584 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3503840) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  14%|█▍        | 1/7 [00:00<00:00,  7.38it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  43%|████▎     | 3/7 [00:00<00:00, 13.71it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  71%|███████▏  | 5/7 [00:00<00:00, 14.41it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00, 15.81it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00, 14.59it/s]
(EngineCore_DP0 pid=3503840) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  20%|██        | 1/5 [00:00<00:00,  5.79it/s]
Capturing CUDA graphs (decode, FULL):  80%|████████  | 4/5 [00:00<00:00, 16.28it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00, 15.94it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   4%|▎         | 73/2048 [00:00<00:02, 722.66it/s]
Adding requests:   7%|▋         | 149/2048 [00:00<00:02, 741.89it/s]
Adding requests:  11%|█         | 227/2048 [00:00<00:02, 755.20it/s]
Adding requests:  15%|█▍        | 303/2048 [00:00<00:02, 756.18it/s]
Adding requests:  19%|█▊        | 380/2048 [00:00<00:02, 759.02it/s]
Adding requests:  22%|██▏       | 457/2048 [00:00<00:02, 760.12it/s]
Adding requests:  26%|██▌       | 534/2048 [00:00<00:02, 745.73it/s]
Adding requests:  30%|██▉       | 610/2048 [00:00<00:01, 749.26it/s]
Adding requests:  33%|███▎      | 686/2048 [00:00<00:01, 752.32it/s]
Adding requests:  37%|███▋      | 762/2048 [00:01<00:01, 747.31it/s]
Adding requests:  41%|████      | 837/2048 [00:01<00:01, 714.64it/s]
Adding requests:  45%|████▍     | 915/2048 [00:01<00:01, 731.82it/s]
Adding requests:  48%|████▊     | 993/2048 [00:01<00:01, 744.84it/s]
Adding requests:  52%|█████▏    | 1071/2048 [00:01<00:01, 753.36it/s]
Adding requests:  56%|█████▌    | 1148/2048 [00:01<00:01, 757.60it/s]
Adding requests:  60%|█████▉    | 1226/2048 [00:01<00:01, 763.01it/s]
Adding requests:  64%|██████▎   | 1303/2048 [00:01<00:00, 754.58it/s]
Adding requests:  67%|██████▋   | 1380/2048 [00:01<00:00, 756.74it/s]
Adding requests:  71%|███████   | 1458/2048 [00:01<00:00, 763.47it/s]
Adding requests:  75%|███████▍  | 1535/2048 [00:02<00:00, 763.43it/s]
Adding requests:  79%|███████▉  | 1614/2048 [00:02<00:00, 769.09it/s]
Adding requests:  83%|████████▎ | 1691/2048 [00:02<00:00, 760.21it/s]
Adding requests:  86%|████████▋ | 1768/2048 [00:02<00:00, 761.47it/s]
Adding requests:  90%|█████████ | 1845/2048 [00:02<00:00, 753.44it/s]
Adding requests:  94%|█████████▍| 1922/2048 [00:02<00:00, 755.48it/s]
Adding requests:  98%|█████████▊| 2001/2048 [00:02<00:00, 764.62it/s]
Adding requests: 100%|██████████| 2048/2048 [00:02<00:00, 754.81it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▌         | 114/2048 [00:00<00:02, 856.32it/s, est. speed input: 876983.94 toks/s, output: 856.37 toks/s]
Processed prompts:  10%|▉         | 200/2048 [00:01<00:20, 91.07it/s, est. speed input: 110074.22 toks/s, output: 107.49 toks/s] 
Processed prompts:  12%|█▏        | 239/2048 [00:02<00:22, 78.88it/s, est. speed input: 95906.44 toks/s, output: 93.66 toks/s]  
Processed prompts:  13%|█▎        | 263/2048 [00:03<00:27, 64.13it/s, est. speed input: 83050.30 toks/s, output: 81.10 toks/s]
Processed prompts:  14%|█▎        | 279/2048 [00:03<00:29, 60.68it/s, est. speed input: 79615.14 toks/s, output: 77.75 toks/s]
Processed prompts:  14%|█▍        | 291/2048 [00:03<00:31, 55.09it/s, est. speed input: 75751.03 toks/s, output: 73.98 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [00:04<00:33, 52.34it/s, est. speed input: 73223.76 toks/s, output: 71.51 toks/s]
Processed prompts:  16%|█▌        | 322/2048 [00:04<00:33, 50.83it/s, est. speed input: 71300.31 toks/s, output: 69.63 toks/s]
Processed prompts:  17%|█▋        | 338/2048 [00:04<00:34, 49.52it/s, est. speed input: 69600.10 toks/s, output: 67.97 toks/s]
Processed prompts:  17%|█▋        | 354/2048 [00:05<00:34, 48.63it/s, est. speed input: 68155.19 toks/s, output: 66.56 toks/s]
Processed prompts:  18%|█▊        | 370/2048 [00:05<00:34, 47.97it/s, est. speed input: 66888.22 toks/s, output: 65.32 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [00:06<00:34, 47.50it/s, est. speed input: 65769.32 toks/s, output: 64.23 toks/s]
Processed prompts:  20%|█▉        | 402/2048 [00:06<00:34, 47.14it/s, est. speed input: 64768.52 toks/s, output: 63.25 toks/s]
Processed prompts:  20%|██        | 418/2048 [00:06<00:34, 46.90it/s, est. speed input: 63874.95 toks/s, output: 62.38 toks/s]
Processed prompts:  21%|██        | 434/2048 [00:07<00:34, 46.72it/s, est. speed input: 63067.14 toks/s, output: 61.59 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [00:07<00:34, 46.59it/s, est. speed input: 62333.34 toks/s, output: 60.87 toks/s]
Processed prompts:  23%|██▎       | 466/2048 [00:07<00:34, 46.50it/s, est. speed input: 61666.74 toks/s, output: 60.22 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [00:08<00:33, 46.44it/s, est. speed input: 61057.54 toks/s, output: 59.63 toks/s]
Processed prompts:  24%|██▍       | 498/2048 [00:08<00:33, 46.39it/s, est. speed input: 60496.39 toks/s, output: 59.08 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [00:08<00:33, 46.37it/s, est. speed input: 59982.56 toks/s, output: 58.58 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [00:09<00:32, 46.35it/s, est. speed input: 59505.44 toks/s, output: 58.11 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [00:09<00:32, 46.32it/s, est. speed input: 59062.63 toks/s, output: 57.68 toks/s]
Processed prompts:  27%|██▋       | 562/2048 [00:09<00:32, 46.32it/s, est. speed input: 58653.23 toks/s, output: 57.28 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [00:10<00:31, 46.31it/s, est. speed input: 58269.60 toks/s, output: 56.90 toks/s]
Processed prompts:  29%|██▉       | 594/2048 [00:10<00:31, 46.30it/s, est. speed input: 57910.95 toks/s, output: 56.55 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [00:10<00:31, 46.30it/s, est. speed input: 57577.50 toks/s, output: 56.23 toks/s]
Processed prompts:  31%|███       | 626/2048 [00:11<00:30, 46.29it/s, est. speed input: 57262.01 toks/s, output: 55.92 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [00:11<00:30, 46.28it/s, est. speed input: 56965.08 toks/s, output: 55.63 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [00:11<00:30, 46.28it/s, est. speed input: 56687.14 toks/s, output: 55.36 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [00:12<00:29, 46.29it/s, est. speed input: 56425.36 toks/s, output: 55.10 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [00:12<00:29, 46.27it/s, est. speed input: 56175.43 toks/s, output: 54.86 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [00:12<00:29, 46.27it/s, est. speed input: 55940.27 toks/s, output: 54.63 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [00:13<00:28, 46.28it/s, est. speed input: 55717.58 toks/s, output: 54.41 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [00:13<00:28, 46.26it/s, est. speed input: 55504.46 toks/s, output: 54.20 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [00:13<00:27, 46.26it/s, est. speed input: 55303.11 toks/s, output: 54.01 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [00:14<00:27, 46.25it/s, est. speed input: 55109.76 toks/s, output: 53.82 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [00:14<00:27, 46.24it/s, est. speed input: 54926.57 toks/s, output: 53.64 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [00:14<00:26, 46.27it/s, est. speed input: 54753.92 toks/s, output: 53.47 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [00:15<00:26, 46.24it/s, est. speed input: 54585.16 toks/s, output: 53.31 toks/s]
Processed prompts:  41%|████      | 834/2048 [00:15<00:26, 46.24it/s, est. speed input: 54426.12 toks/s, output: 53.15 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [00:16<00:25, 46.25it/s, est. speed input: 54274.36 toks/s, output: 53.00 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [00:16<00:25, 46.26it/s, est. speed input: 54128.91 toks/s, output: 52.86 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [00:16<00:25, 46.26it/s, est. speed input: 53989.29 toks/s, output: 52.72 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [00:17<00:24, 46.27it/s, est. speed input: 53855.90 toks/s, output: 52.59 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [00:17<00:24, 46.25it/s, est. speed input: 53725.54 toks/s, output: 52.47 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [00:17<00:24, 46.24it/s, est. speed input: 53601.02 toks/s, output: 52.34 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [00:18<00:23, 46.22it/s, est. speed input: 53480.14 toks/s, output: 52.23 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [00:18<00:23, 46.21it/s, est. speed input: 53364.21 toks/s, output: 52.11 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [00:18<00:23, 46.21it/s, est. speed input: 53252.63 toks/s, output: 52.00 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [00:19<00:22, 46.21it/s, est. speed input: 53145.46 toks/s, output: 51.90 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [00:19<00:22, 46.19it/s, est. speed input: 53040.73 toks/s, output: 51.80 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [00:19<00:22, 46.20it/s, est. speed input: 52940.81 toks/s, output: 51.70 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [00:20<00:21, 46.19it/s, est. speed input: 52843.72 toks/s, output: 51.61 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [00:20<00:21, 46.18it/s, est. speed input: 52749.77 toks/s, output: 51.51 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [00:20<00:21, 46.18it/s, est. speed input: 52659.10 toks/s, output: 51.42 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [00:21<00:20, 46.19it/s, est. speed input: 52572.27 toks/s, output: 51.34 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [00:21<00:20, 46.17it/s, est. speed input: 52486.40 toks/s, output: 51.26 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [00:21<00:20, 46.19it/s, est. speed input: 52404.97 toks/s, output: 51.18 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [00:22<00:19, 46.19it/s, est. speed input: 52325.40 toks/s, output: 51.10 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [00:22<00:19, 46.81it/s, est. speed input: 52284.06 toks/s, output: 51.06 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [00:22<00:18, 46.63it/s, est. speed input: 52209.04 toks/s, output: 50.99 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [00:23<00:18, 46.48it/s, est. speed input: 52135.21 toks/s, output: 50.91 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [00:23<00:18, 46.38it/s, est. speed input: 52063.60 toks/s, output: 50.84 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [00:23<00:17, 46.32it/s, est. speed input: 51994.76 toks/s, output: 50.78 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [00:24<00:17, 46.27it/s, est. speed input: 51927.09 toks/s, output: 50.71 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [00:24<00:17, 46.24it/s, est. speed input: 51861.82 toks/s, output: 50.65 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [00:25<00:16, 46.22it/s, est. speed input: 51798.29 toks/s, output: 50.58 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [00:25<00:16, 46.20it/s, est. speed input: 51736.25 toks/s, output: 50.52 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [00:25<00:16, 46.18it/s, est. speed input: 51675.96 toks/s, output: 50.46 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [00:26<00:15, 46.18it/s, est. speed input: 51617.72 toks/s, output: 50.41 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [00:26<00:15, 46.17it/s, est. speed input: 51560.34 toks/s, output: 50.35 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [00:26<00:15, 46.17it/s, est. speed input: 51504.64 toks/s, output: 50.30 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [00:27<00:14, 46.16it/s, est. speed input: 51450.34 toks/s, output: 50.24 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [00:27<00:14, 46.16it/s, est. speed input: 51397.63 toks/s, output: 50.19 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [00:27<00:14, 46.17it/s, est. speed input: 51346.38 toks/s, output: 50.14 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [00:28<00:13, 46.18it/s, est. speed input: 51296.63 toks/s, output: 50.09 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [00:28<00:13, 46.17it/s, est. speed input: 51247.36 toks/s, output: 50.05 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [00:28<00:13, 46.16it/s, est. speed input: 51199.47 toks/s, output: 50.00 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [00:29<00:12, 46.16it/s, est. speed input: 51152.71 toks/s, output: 49.95 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [00:29<00:12, 46.15it/s, est. speed input: 51106.74 toks/s, output: 49.91 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [00:29<00:12, 46.16it/s, est. speed input: 51062.29 toks/s, output: 49.87 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [00:30<00:11, 46.16it/s, est. speed input: 51018.79 toks/s, output: 49.82 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [00:30<00:11, 46.16it/s, est. speed input: 50976.48 toks/s, output: 49.78 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [00:30<00:11, 46.17it/s, est. speed input: 50935.09 toks/s, output: 49.74 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [00:31<00:10, 46.16it/s, est. speed input: 50894.42 toks/s, output: 49.70 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [00:31<00:10, 46.16it/s, est. speed input: 50854.58 toks/s, output: 49.66 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [00:31<00:10, 46.16it/s, est. speed input: 50815.61 toks/s, output: 49.62 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [00:32<00:09, 46.15it/s, est. speed input: 50777.31 toks/s, output: 49.59 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [00:32<00:09, 46.16it/s, est. speed input: 50740.04 toks/s, output: 49.55 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [00:33<00:08, 46.15it/s, est. speed input: 50703.50 toks/s, output: 49.52 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [00:33<00:08, 46.15it/s, est. speed input: 50667.45 toks/s, output: 49.48 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [00:33<00:08, 46.15it/s, est. speed input: 50632.29 toks/s, output: 49.45 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [00:34<00:07, 46.15it/s, est. speed input: 50598.20 toks/s, output: 49.41 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [00:34<00:07, 46.14it/s, est. speed input: 50563.91 toks/s, output: 49.38 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [00:34<00:07, 46.15it/s, est. speed input: 50531.30 toks/s, output: 49.35 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [00:35<00:06, 46.16it/s, est. speed input: 50499.43 toks/s, output: 49.32 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [00:35<00:06, 46.16it/s, est. speed input: 50467.58 toks/s, output: 49.28 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [00:35<00:06, 46.14it/s, est. speed input: 50436.09 toks/s, output: 49.25 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [00:36<00:05, 46.15it/s, est. speed input: 50405.75 toks/s, output: 49.22 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [00:36<00:05, 46.14it/s, est. speed input: 50375.50 toks/s, output: 49.19 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [00:36<00:05, 46.16it/s, est. speed input: 50346.65 toks/s, output: 49.17 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [00:37<00:04, 46.14it/s, est. speed input: 50317.30 toks/s, output: 49.14 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [00:37<00:04, 46.14it/s, est. speed input: 50288.92 toks/s, output: 49.11 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [00:37<00:04, 46.15it/s, est. speed input: 50261.27 toks/s, output: 49.08 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [00:38<00:03, 46.97it/s, est. speed input: 50260.52 toks/s, output: 49.08 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [00:38<00:03, 46.71it/s, est. speed input: 50233.32 toks/s, output: 49.06 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [00:38<00:03, 46.55it/s, est. speed input: 50206.96 toks/s, output: 49.03 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [00:39<00:02, 46.43it/s, est. speed input: 50181.03 toks/s, output: 49.00 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [00:39<00:02, 46.34it/s, est. speed input: 50155.25 toks/s, output: 48.98 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [00:39<00:02, 46.29it/s, est. speed input: 50130.26 toks/s, output: 48.96 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [00:40<00:01, 46.27it/s, est. speed input: 50106.06 toks/s, output: 48.93 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [00:40<00:01, 46.21it/s, est. speed input: 50081.18 toks/s, output: 48.91 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [00:40<00:00, 46.19it/s, est. speed input: 50057.19 toks/s, output: 48.88 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [00:41<00:00, 46.17it/s, est. speed input: 50033.45 toks/s, output: 48.86 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [00:41<00:00, 45.83it/s, est. speed input: 50000.18 toks/s, output: 48.83 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:41<00:00, 45.83it/s, est. speed input: 50344.11 toks/s, output: 49.16 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:41<00:00, 49.16it/s, est. speed input: 50344.11 toks/s, output: 49.16 toks/s]
[rank0]:[W128 00:48:15.695479321 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 72.5s

测试结果:
  Requests/s:   46.16
  Tokens/s:     47310.48
  Total Reqs:   2048
  Elapsed:      44.37s

  [Prefill 分析]
  Total Prefill Tokens: 2097152
  Prefill Tokens/s:     47264.33

============================================================
[7/7] 测试 M=32768
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 32768
│   M_prefill     = 32768 (= 32 x 1024)
│   M_decode      = 32
│   batched_tokens = 32768 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 4096
│   --max-num-seqs           = 32
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 32768
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:48:32 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3505172) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3505172) WARNING 01-28 00:48:41 [backends.py:609] Failed to read file <frozen os>
Throughput: 45.93 requests/s, 47074.79 total tokens/s, 45.93 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096


─── STDERR ───
[2026-01-28 00:48:32] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:48:32] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:48:32] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:48:32] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:48:32] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:48:32] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:48:32] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:48:32] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:48:32] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:48:32] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:48:32] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:48:32] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:48:32] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:48:32] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:48:36] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:48:36] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:48:36] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:48:36] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:48:36] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:48:36] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:48:36] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:48:36] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:48:36] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:48:36] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:48:36] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:48:36] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:48:36] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:48:36] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3505172) [2026-01-28 00:48:37] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3505172) [2026-01-28 00:48:37] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3505172) [2026-01-28 00:48:37] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3505172) [2026-01-28 00:48:37] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=3505172) [2026-01-28 00:48:37] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3505172) [2026-01-28 00:48:37] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3505172) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3505172) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.66it/s]
(EngineCore_DP0 pid=3505172) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.66it/s]
(EngineCore_DP0 pid=3505172) 
(EngineCore_DP0 pid=3505172) [2026-01-28 00:48:37] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 2560] -> 1D uint8
(EngineCore_DP0 pid=3505172) [2026-01-28 00:48:37] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 6144000 bytes
(EngineCore_DP0 pid=3505172) [2026-01-28 00:48:37] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 2560] -> 1D uint8
(EngineCore_DP0 pid=3505172) [2026-01-28 00:48:37] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 4096000 bytes
(EngineCore_DP0 pid=3505172) [2026-01-28 00:48:37] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 2560] -> 1D uint8
(EngineCore_DP0 pid=3505172) [2026-01-28 00:48:37] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 22118400 bytes
(EngineCore_DP0 pid=3505172) [2026-01-28 00:48:37] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 6912] -> 1D uint8
(EngineCore_DP0 pid=3505172) [2026-01-28 00:48:37] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 11059200 bytes
(EngineCore_DP0 pid=3505172) [rank0]:W0128 00:48:44.796000 3505172 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=3505172) [rank0]:W0128 00:48:44.846000 3505172 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=3505172) [rank0]:W0128 00:48:45.585000 3505172 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=3505172) [rank0]:W0128 00:48:45.662000 3505172 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=3505172) 2026-01-28 00:48:48,447 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3505172) 2026-01-28 00:48:48,475 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3505172) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   9%|▉         | 1/11 [00:00<00:04,  2.36it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  36%|███▋      | 4/11 [00:00<00:00,  8.94it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  64%|██████▎   | 7/11 [00:00<00:00, 13.70it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  91%|█████████ | 10/11 [00:00<00:00, 17.74it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:00<00:00, 13.49it/s]
(EngineCore_DP0 pid=3505172) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  14%|█▍        | 1/7 [00:00<00:00,  7.35it/s]
Capturing CUDA graphs (decode, FULL):  57%|█████▋    | 4/7 [00:00<00:00, 18.12it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00, 22.94it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00, 20.25it/s]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 72/4096 [00:00<00:05, 719.48it/s]
Adding requests:   4%|▎         | 148/4096 [00:00<00:05, 738.87it/s]
Adding requests:   5%|▌         | 222/4096 [00:00<00:05, 737.41it/s]
Adding requests:   7%|▋         | 298/4096 [00:00<00:05, 743.26it/s]
Adding requests:   9%|▉         | 373/4096 [00:00<00:05, 740.59it/s]
Adding requests:  11%|█         | 448/4096 [00:00<00:04, 743.03it/s]
Adding requests:  13%|█▎        | 523/4096 [00:00<00:04, 734.94it/s]
Adding requests:  15%|█▍        | 600/4096 [00:00<00:04, 742.29it/s]
Adding requests:  16%|█▋        | 675/4096 [00:00<00:04, 729.84it/s]
Adding requests:  18%|█▊        | 751/4096 [00:01<00:04, 738.77it/s]
Adding requests:  20%|██        | 825/4096 [00:01<00:04, 729.62it/s]
Adding requests:  22%|██▏       | 903/4096 [00:01<00:04, 743.99it/s]
Adding requests:  24%|██▍       | 980/4096 [00:01<00:04, 749.51it/s]
Adding requests:  26%|██▌       | 1058/4096 [00:01<00:04, 758.29it/s]
Adding requests:  28%|██▊       | 1134/4096 [00:01<00:04, 734.02it/s]
Adding requests:  30%|██▉       | 1213/4096 [00:01<00:03, 748.30it/s]
Adding requests:  31%|███▏      | 1288/4096 [00:01<00:03, 740.77it/s]
Adding requests:  33%|███▎      | 1367/4096 [00:01<00:03, 752.48it/s]
Adding requests:  35%|███▌      | 1446/4096 [00:01<00:03, 761.92it/s]
Adding requests:  37%|███▋      | 1527/4096 [00:02<00:03, 774.74it/s]
Adding requests:  39%|███▉      | 1608/4096 [00:02<00:03, 783.91it/s]
Adding requests:  41%|████      | 1687/4096 [00:02<00:03, 772.15it/s]
Adding requests:  43%|████▎     | 1765/4096 [00:02<00:03, 771.08it/s]
Adding requests:  45%|████▌     | 1845/4096 [00:02<00:02, 778.03it/s]
Adding requests:  47%|████▋     | 1923/4096 [00:02<00:02, 774.73it/s]
Adding requests:  49%|████▉     | 2002/4096 [00:02<00:02, 778.75it/s]
Adding requests:  51%|█████     | 2082/4096 [00:02<00:02, 783.18it/s]
Adding requests:  53%|█████▎    | 2161/4096 [00:02<00:02, 769.17it/s]
Adding requests:  55%|█████▍    | 2239/4096 [00:02<00:02, 769.54it/s]
Adding requests:  57%|█████▋    | 2317/4096 [00:03<00:02, 754.74it/s]
Adding requests:  58%|█████▊    | 2393/4096 [00:03<00:02, 754.96it/s]
Adding requests:  60%|██████    | 2470/4096 [00:03<00:02, 757.86it/s]
Adding requests:  62%|██████▏   | 2546/4096 [00:03<00:02, 751.38it/s]
Adding requests:  64%|██████▍   | 2624/4096 [00:03<00:01, 757.70it/s]
Adding requests:  66%|██████▌   | 2700/4096 [00:03<00:01, 757.09it/s]
Adding requests:  68%|██████▊   | 2776/4096 [00:03<00:01, 754.43it/s]
Adding requests:  70%|██████▉   | 2852/4096 [00:03<00:01, 741.54it/s]
Adding requests:  71%|███████▏  | 2928/4096 [00:03<00:01, 744.41it/s]
Adding requests:  73%|███████▎  | 3003/4096 [00:03<00:01, 743.35it/s]
Adding requests:  75%|███████▌  | 3079/4096 [00:04<00:01, 747.77it/s]
Adding requests:  77%|███████▋  | 3157/4096 [00:04<00:01, 756.90it/s]
Adding requests:  79%|███████▉  | 3235/4096 [00:04<00:01, 762.93it/s]
Adding requests:  81%|████████  | 3312/4096 [00:04<00:01, 764.70it/s]
Adding requests:  83%|████████▎ | 3390/4096 [00:04<00:00, 765.08it/s]
Adding requests:  85%|████████▍ | 3467/4096 [00:04<00:00, 762.50it/s]
Adding requests:  87%|████████▋ | 3545/4096 [00:04<00:00, 767.30it/s]
Adding requests:  88%|████████▊ | 3622/4096 [00:04<00:00, 762.97it/s]
Adding requests:  90%|█████████ | 3699/4096 [00:04<00:00, 754.95it/s]
Adding requests:  92%|█████████▏| 3779/4096 [00:04<00:00, 764.81it/s]
Adding requests:  94%|█████████▍| 3858/4096 [00:05<00:00, 770.81it/s]
Adding requests:  96%|█████████▌| 3936/4096 [00:05<00:00, 770.72it/s]
Adding requests:  98%|█████████▊| 4016/4096 [00:05<00:00, 777.27it/s]
Adding requests: 100%|█████████▉| 4094/4096 [00:05<00:00, 772.20it/s]
Adding requests: 100%|██████████| 4096/4096 [00:05<00:00, 757.55it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▌         | 226/4096 [00:00<00:04, 897.09it/s, est. speed input: 918670.45 toks/s, output: 897.11 toks/s]
Processed prompts:   8%|▊         | 316/4096 [00:01<00:23, 158.46it/s, est. speed input: 197079.19 toks/s, output: 192.46 toks/s]
Processed prompts:   9%|▊         | 357/4096 [00:03<00:43, 86.38it/s, est. speed input: 120593.46 toks/s, output: 117.77 toks/s] 
Processed prompts:   9%|▉         | 386/4096 [00:03<00:50, 73.63it/s, est. speed input: 106061.06 toks/s, output: 103.57 toks/s]
Processed prompts:  10%|█         | 418/4096 [00:04<00:56, 65.64it/s, est. speed input: 96799.57 toks/s, output: 94.53 toks/s]  
Processed prompts:  11%|█         | 450/4096 [00:05<01:00, 59.89it/s, est. speed input: 90049.97 toks/s, output: 87.94 toks/s]
Processed prompts:  12%|█▏        | 482/4096 [00:05<01:04, 55.81it/s, est. speed input: 84917.83 toks/s, output: 82.93 toks/s]
Processed prompts:  13%|█▎        | 514/4096 [00:06<01:07, 52.91it/s, est. speed input: 80882.38 toks/s, output: 78.99 toks/s]
Processed prompts:  13%|█▎        | 546/4096 [00:07<01:09, 50.87it/s, est. speed input: 77625.86 toks/s, output: 75.81 toks/s]
Processed prompts:  14%|█▍        | 578/4096 [00:07<01:11, 49.41it/s, est. speed input: 74934.88 toks/s, output: 73.18 toks/s]
Processed prompts:  15%|█▍        | 610/4096 [00:08<01:12, 48.39it/s, est. speed input: 72682.35 toks/s, output: 70.98 toks/s]
Processed prompts:  16%|█▌        | 642/4096 [00:09<01:12, 47.69it/s, est. speed input: 70770.76 toks/s, output: 69.11 toks/s]
Processed prompts:  16%|█▋        | 674/4096 [00:09<01:12, 47.16it/s, est. speed input: 69115.58 toks/s, output: 67.50 toks/s]
Processed prompts:  17%|█▋        | 706/4096 [00:10<01:12, 46.80it/s, est. speed input: 67677.98 toks/s, output: 66.09 toks/s]
Processed prompts:  18%|█▊        | 738/4096 [00:11<01:12, 46.56it/s, est. speed input: 66420.79 toks/s, output: 64.86 toks/s]
Processed prompts:  19%|█▉        | 770/4096 [00:12<01:11, 46.38it/s, est. speed input: 65303.23 toks/s, output: 63.77 toks/s]
Processed prompts:  20%|█▉        | 802/4096 [00:12<01:11, 46.26it/s, est. speed input: 64309.47 toks/s, output: 62.80 toks/s]
Processed prompts:  20%|██        | 834/4096 [00:13<01:10, 46.16it/s, est. speed input: 63416.69 toks/s, output: 61.93 toks/s]
Processed prompts:  21%|██        | 866/4096 [00:14<01:10, 46.10it/s, est. speed input: 62612.39 toks/s, output: 61.14 toks/s]
Processed prompts:  22%|██▏       | 898/4096 [00:14<01:09, 46.06it/s, est. speed input: 61884.02 toks/s, output: 60.43 toks/s]
Processed prompts:  23%|██▎       | 930/4096 [00:15<01:08, 46.02it/s, est. speed input: 61218.41 toks/s, output: 59.78 toks/s]
Processed prompts:  23%|██▎       | 962/4096 [00:16<01:08, 45.99it/s, est. speed input: 60610.51 toks/s, output: 59.19 toks/s]
Processed prompts:  24%|██▍       | 994/4096 [00:16<01:07, 45.97it/s, est. speed input: 60052.00 toks/s, output: 58.64 toks/s]
Processed prompts:  25%|██▌       | 1026/4096 [00:17<01:06, 45.95it/s, est. speed input: 59536.50 toks/s, output: 58.14 toks/s]
Processed prompts:  26%|██▌       | 1058/4096 [00:18<01:06, 45.94it/s, est. speed input: 59060.71 toks/s, output: 57.68 toks/s]
Processed prompts:  27%|██▋       | 1090/4096 [00:19<01:05, 45.94it/s, est. speed input: 58621.44 toks/s, output: 57.25 toks/s]
Processed prompts:  27%|██▋       | 1122/4096 [00:19<01:04, 45.93it/s, est. speed input: 58211.36 toks/s, output: 56.85 toks/s]
Processed prompts:  28%|██▊       | 1154/4096 [00:20<01:03, 46.28it/s, est. speed input: 57880.13 toks/s, output: 56.52 toks/s]
Processed prompts:  29%|██▉       | 1186/4096 [00:21<01:03, 46.18it/s, est. speed input: 57522.23 toks/s, output: 56.17 toks/s]
Processed prompts:  30%|██▉       | 1218/4096 [00:21<01:02, 46.10it/s, est. speed input: 57186.22 toks/s, output: 55.85 toks/s]
Processed prompts:  31%|███       | 1250/4096 [00:22<01:01, 46.04it/s, est. speed input: 56870.96 toks/s, output: 55.54 toks/s]
Processed prompts:  31%|███▏      | 1282/4096 [00:23<01:01, 45.96it/s, est. speed input: 56570.38 toks/s, output: 55.24 toks/s]
Processed prompts:  32%|███▏      | 1314/4096 [00:23<01:00, 45.95it/s, est. speed input: 56291.82 toks/s, output: 54.97 toks/s]
Processed prompts:  33%|███▎      | 1346/4096 [00:24<00:59, 45.93it/s, est. speed input: 56028.25 toks/s, output: 54.72 toks/s]
Processed prompts:  34%|███▎      | 1378/4096 [00:25<00:59, 45.94it/s, est. speed input: 55781.31 toks/s, output: 54.47 toks/s]
Processed prompts:  34%|███▍      | 1410/4096 [00:25<00:58, 45.92it/s, est. speed input: 55545.59 toks/s, output: 54.24 toks/s]
Processed prompts:  35%|███▌      | 1442/4096 [00:26<00:57, 45.92it/s, est. speed input: 55323.09 toks/s, output: 54.03 toks/s]
Processed prompts:  36%|███▌      | 1474/4096 [00:27<00:57, 45.92it/s, est. speed input: 55111.72 toks/s, output: 53.82 toks/s]
Processed prompts:  37%|███▋      | 1506/4096 [00:28<00:56, 45.93it/s, est. speed input: 54911.46 toks/s, output: 53.62 toks/s]
Processed prompts:  38%|███▊      | 1538/4096 [00:28<00:55, 45.92it/s, est. speed input: 54720.07 toks/s, output: 53.44 toks/s]
Processed prompts:  38%|███▊      | 1570/4096 [00:29<00:55, 45.92it/s, est. speed input: 54537.72 toks/s, output: 53.26 toks/s]
Processed prompts:  39%|███▉      | 1602/4096 [00:30<00:54, 45.92it/s, est. speed input: 54364.02 toks/s, output: 53.09 toks/s]
Processed prompts:  40%|███▉      | 1634/4096 [00:30<00:53, 45.91it/s, est. speed input: 54197.81 toks/s, output: 52.93 toks/s]
Processed prompts:  41%|████      | 1666/4096 [00:31<00:52, 45.91it/s, est. speed input: 54038.66 toks/s, output: 52.77 toks/s]
Processed prompts:  41%|████▏     | 1698/4096 [00:32<00:52, 45.91it/s, est. speed input: 53887.29 toks/s, output: 52.62 toks/s]
Processed prompts:  42%|████▏     | 1730/4096 [00:32<00:51, 45.91it/s, est. speed input: 53741.65 toks/s, output: 52.48 toks/s]
Processed prompts:  43%|████▎     | 1762/4096 [00:33<00:50, 45.91it/s, est. speed input: 53602.52 toks/s, output: 52.35 toks/s]
Processed prompts:  44%|████▍     | 1794/4096 [00:34<00:50, 45.91it/s, est. speed input: 53468.79 toks/s, output: 52.22 toks/s]
Processed prompts:  45%|████▍     | 1826/4096 [00:35<00:49, 45.92it/s, est. speed input: 53341.00 toks/s, output: 52.09 toks/s]
Processed prompts:  45%|████▌     | 1858/4096 [00:35<00:48, 46.31it/s, est. speed input: 53246.89 toks/s, output: 52.00 toks/s]
Processed prompts:  46%|████▌     | 1890/4096 [00:36<00:47, 46.18it/s, est. speed input: 53127.32 toks/s, output: 51.88 toks/s]
Processed prompts:  47%|████▋     | 1922/4096 [00:37<00:47, 46.11it/s, est. speed input: 53013.01 toks/s, output: 51.77 toks/s]
Processed prompts:  48%|████▊     | 1954/4096 [00:37<00:46, 46.05it/s, est. speed input: 52902.49 toks/s, output: 51.66 toks/s]
Processed prompts:  48%|████▊     | 1986/4096 [00:38<00:45, 46.00it/s, est. speed input: 52795.65 toks/s, output: 51.56 toks/s]
Processed prompts:  49%|████▉     | 2018/4096 [00:39<00:45, 45.98it/s, est. speed input: 52692.98 toks/s, output: 51.46 toks/s]
Processed prompts:  50%|█████     | 2050/4096 [00:39<00:44, 45.96it/s, est. speed input: 52593.78 toks/s, output: 51.36 toks/s]
Processed prompts:  51%|█████     | 2082/4096 [00:40<00:43, 45.94it/s, est. speed input: 52497.54 toks/s, output: 51.27 toks/s]
Processed prompts:  52%|█████▏    | 2114/4096 [00:41<00:43, 45.93it/s, est. speed input: 52404.85 toks/s, output: 51.18 toks/s]
Processed prompts:  52%|█████▏    | 2146/4096 [00:42<00:42, 45.92it/s, est. speed input: 52315.11 toks/s, output: 51.09 toks/s]
Processed prompts:  53%|█████▎    | 2178/4096 [00:42<00:41, 45.92it/s, est. speed input: 52228.59 toks/s, output: 51.00 toks/s]
Processed prompts:  54%|█████▍    | 2210/4096 [00:43<00:41, 45.91it/s, est. speed input: 52144.56 toks/s, output: 50.92 toks/s]
Processed prompts:  55%|█████▍    | 2242/4096 [00:44<00:40, 45.91it/s, est. speed input: 52063.55 toks/s, output: 50.84 toks/s]
Processed prompts:  56%|█████▌    | 2274/4096 [00:44<00:39, 45.91it/s, est. speed input: 51984.73 toks/s, output: 50.77 toks/s]
Processed prompts:  56%|█████▋    | 2306/4096 [00:45<00:38, 45.90it/s, est. speed input: 51908.24 toks/s, output: 50.69 toks/s]
Processed prompts:  57%|█████▋    | 2338/4096 [00:46<00:38, 45.91it/s, est. speed input: 51834.65 toks/s, output: 50.62 toks/s]
Processed prompts:  58%|█████▊    | 2370/4096 [00:46<00:37, 45.90it/s, est. speed input: 51762.44 toks/s, output: 50.55 toks/s]
Processed prompts:  59%|█████▊    | 2402/4096 [00:47<00:36, 45.91it/s, est. speed input: 51693.41 toks/s, output: 50.48 toks/s]
Processed prompts:  59%|█████▉    | 2434/4096 [00:48<00:36, 45.90it/s, est. speed input: 51624.89 toks/s, output: 50.41 toks/s]
Processed prompts:  60%|██████    | 2466/4096 [00:48<00:35, 45.90it/s, est. speed input: 51559.23 toks/s, output: 50.35 toks/s]
Processed prompts:  61%|██████    | 2498/4096 [00:49<00:34, 46.29it/s, est. speed input: 51515.67 toks/s, output: 50.31 toks/s]
Processed prompts:  62%|██████▏   | 2530/4096 [00:50<00:33, 46.17it/s, est. speed input: 51453.24 toks/s, output: 50.25 toks/s]
Processed prompts:  63%|██████▎   | 2562/4096 [00:51<00:33, 46.10it/s, est. speed input: 51392.68 toks/s, output: 50.19 toks/s]
Processed prompts:  63%|██████▎   | 2594/4096 [00:51<00:32, 46.04it/s, est. speed input: 51333.53 toks/s, output: 50.13 toks/s]
Processed prompts:  64%|██████▍   | 2626/4096 [00:52<00:31, 46.00it/s, est. speed input: 51275.95 toks/s, output: 50.07 toks/s]
Processed prompts:  65%|██████▍   | 2658/4096 [00:53<00:31, 45.97it/s, est. speed input: 51219.83 toks/s, output: 50.02 toks/s]
Processed prompts:  66%|██████▌   | 2690/4096 [00:53<00:30, 45.94it/s, est. speed input: 51165.12 toks/s, output: 49.97 toks/s]
Processed prompts:  66%|██████▋   | 2722/4096 [00:54<00:29, 45.93it/s, est. speed input: 51111.93 toks/s, output: 49.91 toks/s]
Processed prompts:  67%|██████▋   | 2754/4096 [00:55<00:29, 45.92it/s, est. speed input: 51059.89 toks/s, output: 49.86 toks/s]
Processed prompts:  68%|██████▊   | 2786/4096 [00:55<00:28, 45.91it/s, est. speed input: 51009.13 toks/s, output: 49.81 toks/s]
Processed prompts:  69%|██████▉   | 2818/4096 [00:56<00:27, 45.90it/s, est. speed input: 50959.59 toks/s, output: 49.77 toks/s]
Processed prompts:  70%|██████▉   | 2850/4096 [00:57<00:27, 45.90it/s, est. speed input: 50911.45 toks/s, output: 49.72 toks/s]
Processed prompts:  70%|███████   | 2882/4096 [00:58<00:26, 45.91it/s, est. speed input: 50864.88 toks/s, output: 49.67 toks/s]
Processed prompts:  71%|███████   | 2914/4096 [00:58<00:25, 45.90it/s, est. speed input: 50818.64 toks/s, output: 49.63 toks/s]
Processed prompts:  72%|███████▏  | 2946/4096 [00:59<00:25, 45.89it/s, est. speed input: 50773.66 toks/s, output: 49.58 toks/s]
Processed prompts:  73%|███████▎  | 2978/4096 [01:00<00:24, 45.89it/s, est. speed input: 50729.78 toks/s, output: 49.54 toks/s]
Processed prompts:  73%|███████▎  | 3010/4096 [01:00<00:23, 45.89it/s, est. speed input: 50686.88 toks/s, output: 49.50 toks/s]
Processed prompts:  74%|███████▍  | 3042/4096 [01:01<00:22, 45.89it/s, est. speed input: 50644.94 toks/s, output: 49.46 toks/s]
Processed prompts:  75%|███████▌  | 3074/4096 [01:02<00:22, 45.89it/s, est. speed input: 50604.16 toks/s, output: 49.42 toks/s]
Processed prompts:  76%|███████▌  | 3106/4096 [01:02<00:21, 45.90it/s, est. speed input: 50564.23 toks/s, output: 49.38 toks/s]
Processed prompts:  77%|███████▋  | 3138/4096 [01:03<00:20, 45.89it/s, est. speed input: 50524.91 toks/s, output: 49.34 toks/s]
Processed prompts:  77%|███████▋  | 3170/4096 [01:04<00:20, 45.90it/s, est. speed input: 50487.06 toks/s, output: 49.30 toks/s]
Processed prompts:  78%|███████▊  | 3202/4096 [01:04<00:19, 45.90it/s, est. speed input: 50449.56 toks/s, output: 49.27 toks/s]
Processed prompts:  79%|███████▉  | 3234/4096 [01:05<00:18, 45.90it/s, est. speed input: 50413.09 toks/s, output: 49.23 toks/s]
Processed prompts:  80%|███████▉  | 3266/4096 [01:06<00:18, 45.90it/s, est. speed input: 50377.01 toks/s, output: 49.20 toks/s]
Processed prompts:  81%|████████  | 3298/4096 [01:07<00:17, 45.90it/s, est. speed input: 50342.19 toks/s, output: 49.16 toks/s]
Processed prompts:  81%|████████▏ | 3330/4096 [01:07<00:16, 45.90it/s, est. speed input: 50307.70 toks/s, output: 49.13 toks/s]
Processed prompts:  82%|████████▏ | 3362/4096 [01:08<00:15, 45.90it/s, est. speed input: 50273.97 toks/s, output: 49.10 toks/s]
Processed prompts:  83%|████████▎ | 3394/4096 [01:09<00:15, 45.90it/s, est. speed input: 50241.18 toks/s, output: 49.06 toks/s]
Processed prompts:  84%|████████▎ | 3426/4096 [01:09<00:14, 45.90it/s, est. speed input: 50208.76 toks/s, output: 49.03 toks/s]
Processed prompts:  84%|████████▍ | 3458/4096 [01:10<00:13, 45.90it/s, est. speed input: 50177.01 toks/s, output: 49.00 toks/s]
Processed prompts:  85%|████████▌ | 3490/4096 [01:11<00:13, 45.90it/s, est. speed input: 50145.97 toks/s, output: 48.97 toks/s]
Processed prompts:  86%|████████▌ | 3522/4096 [01:11<00:12, 45.90it/s, est. speed input: 50115.47 toks/s, output: 48.94 toks/s]
Processed prompts:  87%|████████▋ | 3554/4096 [01:12<00:11, 45.90it/s, est. speed input: 50085.63 toks/s, output: 48.91 toks/s]
Processed prompts:  88%|████████▊ | 3586/4096 [01:13<00:11, 45.90it/s, est. speed input: 50056.34 toks/s, output: 48.88 toks/s]
Processed prompts:  88%|████████▊ | 3618/4096 [01:14<00:10, 45.89it/s, est. speed input: 50027.37 toks/s, output: 48.85 toks/s]
Processed prompts:  89%|████████▉ | 3650/4096 [01:14<00:09, 45.89it/s, est. speed input: 49999.06 toks/s, output: 48.83 toks/s]
Processed prompts:  90%|████████▉ | 3682/4096 [01:15<00:09, 45.90it/s, est. speed input: 49971.46 toks/s, output: 48.80 toks/s]
Processed prompts:  91%|█████████ | 3714/4096 [01:16<00:08, 45.90it/s, est. speed input: 49944.46 toks/s, output: 48.77 toks/s]
Processed prompts:  91%|█████████▏| 3746/4096 [01:16<00:07, 45.90it/s, est. speed input: 49917.53 toks/s, output: 48.75 toks/s]
Processed prompts:  92%|█████████▏| 3778/4096 [01:17<00:06, 45.90it/s, est. speed input: 49891.29 toks/s, output: 48.72 toks/s]
Processed prompts:  93%|█████████▎| 3810/4096 [01:18<00:06, 45.90it/s, est. speed input: 49865.52 toks/s, output: 48.70 toks/s]
Processed prompts:  94%|█████████▍| 3842/4096 [01:18<00:05, 45.90it/s, est. speed input: 49840.34 toks/s, output: 48.67 toks/s]
Processed prompts:  95%|█████████▍| 3874/4096 [01:19<00:04, 45.89it/s, est. speed input: 49814.99 toks/s, output: 48.65 toks/s]
Processed prompts:  95%|█████████▌| 3906/4096 [01:20<00:04, 45.88it/s, est. speed input: 49790.35 toks/s, output: 48.62 toks/s]
Processed prompts:  96%|█████████▌| 3938/4096 [01:21<00:03, 45.89it/s, est. speed input: 49766.43 toks/s, output: 48.60 toks/s]
Processed prompts:  97%|█████████▋| 3970/4096 [01:21<00:02, 45.89it/s, est. speed input: 49742.67 toks/s, output: 48.58 toks/s]
Processed prompts:  98%|█████████▊| 4002/4096 [01:22<00:02, 45.89it/s, est. speed input: 49719.44 toks/s, output: 48.55 toks/s]
Processed prompts:  98%|█████████▊| 4034/4096 [01:23<00:01, 46.28it/s, est. speed input: 49708.42 toks/s, output: 48.54 toks/s]
Processed prompts:  99%|█████████▉| 4066/4096 [01:23<00:00, 46.59it/s, est. speed input: 49698.23 toks/s, output: 48.53 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [01:23<00:00, 46.59it/s, est. speed input: 50064.74 toks/s, output: 48.89 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [01:23<00:00, 48.89it/s, est. speed input: 50064.74 toks/s, output: 48.89 toks/s]
[rank0]:[W128 00:50:20.828987281 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 124.2s

测试结果:
  Requests/s:   45.93
  Tokens/s:     47074.79
  Total Reqs:   4096
  Elapsed:      89.19s

  [Prefill 分析]
  Total Prefill Tokens: 4194304
  Prefill Tokens/s:     47028.87


------------------------------------------------------------
  生成 CSV: BitNet-2B-FP8
------------------------------------------------------------
[SUCCESS] CSV 保存到: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX5080_cc120_FP8E4M3_py312_cu129_x86_64/cusparselt/2_4/BitNet-2B-FP8_prefill.csv

预览:
------------------------------------------------------------
M_prefill,prompt_len,max_num_seqs,num_prompts,N_prefill,requests_per_s,tokens_per_s,elapsed_time_s
512,512,1,128,128,56.4208,28943.8530,2.2687
1024,1024,1,128,128,44.7837,45903.2952,2.8582
2048,1024,2,256,128,48.3470,49555.6701,5.2951
4096,1024,4,512,128,49.3794,50613.8532,10.3687
8192,1024,8,1024,128,46.9877,48162.4188,21.7929
16384,1024,16,2048,128,46.1566,47310.4836,44.3707
32768,1024,32,4096,128,45.9266,47074.7920,89.1857

------------------------------------------------------------

[INFO] 完成: 7 成功, 0 失败

============================================================
  BitNet-2B-FP8 | cuSPARSELt (2_6) | prefill
============================================================

[INFO] Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-FP8-SlideSparse-2_6
[INFO] Output: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX5080_cc120_FP8E4M3_py312_cu129_x86_64/cusparselt/2_6

============================================================
[1/7] 测试 M=512
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 512
│   M_prefill     = 512 (= 1 x 512)
│   M_decode      = 1
│   batched_tokens = 513 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 512
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 513
│   --max-num-batched-tokens = 513
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:50:25 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3506994) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3506994) WARNING 01-28 00:50:34 [backends.py:609] Failed to read file <frozen os>
Throughput: 56.13 requests/s, 28792.58 total tokens/s, 56.13 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128


─── STDERR ───
[2026-01-28 00:50:25] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:50:25] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:50:25] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:50:25] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:50:25] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:50:25] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:50:25] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:50:25] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:50:25] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:50:25] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:50:25] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:50:25] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:50:25] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:50:25] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:50:29] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:50:29] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:50:29] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:50:29] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:50:29] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:50:29] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:50:29] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:50:29] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:50:29] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:50:29] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:50:29] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:50:29] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:50:29] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:50:29] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3506994) [2026-01-28 00:50:29] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3506994) [2026-01-28 00:50:29] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3506994) [2026-01-28 00:50:29] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3506994) [2026-01-28 00:50:29] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=3506994) [2026-01-28 00:50:29] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3506994) [2026-01-28 00:50:29] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3506994) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3506994) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.29it/s]
(EngineCore_DP0 pid=3506994) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.29it/s]
(EngineCore_DP0 pid=3506994) 
(EngineCore_DP0 pid=3506994) [2026-01-28 00:50:30] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 3424] -> 1D uint8
(EngineCore_DP0 pid=3506994) [2026-01-28 00:50:30] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 8232960 bytes
(EngineCore_DP0 pid=3506994) [2026-01-28 00:50:30] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 3424] -> 1D uint8
(EngineCore_DP0 pid=3506994) [2026-01-28 00:50:30] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 5488640 bytes
(EngineCore_DP0 pid=3506994) [2026-01-28 00:50:30] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 3424] -> 1D uint8
(EngineCore_DP0 pid=3506994) [2026-01-28 00:50:30] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 29638656 bytes
(EngineCore_DP0 pid=3506994) [2026-01-28 00:50:30] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 9216] -> 1D uint8
(EngineCore_DP0 pid=3506994) [2026-01-28 00:50:30] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 14745600 bytes
(EngineCore_DP0 pid=3506994) 2026-01-28 00:50:40,955 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3506994) 2026-01-28 00:50:40,971 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3506994) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  4.61it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  4.81it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  4.77it/s]
(EngineCore_DP0 pid=3506994) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.26it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.25it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  87%|████████▋ | 111/128 [00:00<00:00, 1105.14it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 1125.07it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:14,  8.65it/s, est. speed input: 4428.13 toks/s, output: 8.65 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:00<00:03, 39.50it/s, est. speed input: 17839.28 toks/s, output: 34.84 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:00<00:02, 49.62it/s, est. speed input: 22400.19 toks/s, output: 43.75 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:00<00:01, 54.57it/s, est. speed input: 24740.82 toks/s, output: 48.32 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:00<00:01, 57.29it/s, est. speed input: 26143.43 toks/s, output: 51.06 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:00<00:01, 58.74it/s, est. speed input: 27038.91 toks/s, output: 52.81 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:00<00:01, 59.41it/s, est. speed input: 27627.86 toks/s, output: 53.96 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:00<00:01, 60.03it/s, est. speed input: 28101.20 toks/s, output: 54.88 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:01<00:01, 60.44it/s, est. speed input: 28470.40 toks/s, output: 55.61 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:01<00:01, 61.07it/s, est. speed input: 28818.30 toks/s, output: 56.29 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:01<00:00, 61.47it/s, est. speed input: 29098.13 toks/s, output: 56.83 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:01<00:00, 61.72it/s, est. speed input: 29328.69 toks/s, output: 57.28 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:01<00:00, 62.10it/s, est. speed input: 29549.11 toks/s, output: 57.71 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:01<00:00, 62.24it/s, est. speed input: 29724.31 toks/s, output: 58.05 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:01<00:00, 62.21it/s, est. speed input: 29863.05 toks/s, output: 58.33 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:01<00:00, 62.00it/s, est. speed input: 29966.16 toks/s, output: 58.53 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:01<00:00, 62.04it/s, est. speed input: 30073.84 toks/s, output: 58.74 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:02<00:00, 62.04it/s, est. speed input: 30167.37 toks/s, output: 58.92 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:02<00:00, 62.08it/s, est. speed input: 30254.96 toks/s, output: 59.09 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:02<00:00, 62.08it/s, est. speed input: 30269.21 toks/s, output: 59.12 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:02<00:00, 59.12it/s, est. speed input: 30269.21 toks/s, output: 59.12 toks/s]
[rank0]:[W128 00:50:44.722011170 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 24.9s

测试结果:
  Requests/s:   56.13
  Tokens/s:     28792.58
  Total Reqs:   128
  Elapsed:      2.28s

  [Prefill 分析]
  Total Prefill Tokens: 65536
  Prefill Tokens/s:     28736.45

============================================================
[2/7] 测试 M=1024
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 1024
│   M_prefill     = 1024 (= 1 x 1024)
│   M_decode      = 1
│   batched_tokens = 1025 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 1025
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:50:50 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3507680) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3507680) WARNING 01-28 00:50:59 [backends.py:609] Failed to read file <frozen os>
Throughput: 38.21 requests/s, 39169.80 total tokens/s, 38.21 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128


─── STDERR ───
[2026-01-28 00:50:50] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:50:50] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:50:50] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:50:50] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:50:50] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:50:50] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:50:50] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:50:50] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:50:50] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:50:50] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:50:50] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:50:50] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:50:50] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:50:50] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:50:54] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:50:54] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:50:54] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:50:54] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:50:54] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:50:54] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:50:54] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:50:54] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:50:54] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:50:54] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:50:54] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:50:54] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:50:54] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:50:54] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3507680) [2026-01-28 00:50:55] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3507680) [2026-01-28 00:50:55] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3507680) [2026-01-28 00:50:55] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3507680) [2026-01-28 00:50:55] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=3507680) [2026-01-28 00:50:55] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3507680) [2026-01-28 00:50:55] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3507680) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3507680) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.10it/s]
(EngineCore_DP0 pid=3507680) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.10it/s]
(EngineCore_DP0 pid=3507680) 
(EngineCore_DP0 pid=3507680) [2026-01-28 00:50:55] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 3424] -> 1D uint8
(EngineCore_DP0 pid=3507680) [2026-01-28 00:50:55] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 8232960 bytes
(EngineCore_DP0 pid=3507680) [2026-01-28 00:50:55] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 3424] -> 1D uint8
(EngineCore_DP0 pid=3507680) [2026-01-28 00:50:55] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 5488640 bytes
(EngineCore_DP0 pid=3507680) [2026-01-28 00:50:55] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 3424] -> 1D uint8
(EngineCore_DP0 pid=3507680) [2026-01-28 00:50:55] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 29638656 bytes
(EngineCore_DP0 pid=3507680) [2026-01-28 00:50:55] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 9216] -> 1D uint8
(EngineCore_DP0 pid=3507680) [2026-01-28 00:50:55] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 14745600 bytes
(EngineCore_DP0 pid=3507680) 2026-01-28 00:51:06,097 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3507680) 2026-01-28 00:51:06,122 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3507680) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  8.89it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00, 12.44it/s]
(EngineCore_DP0 pid=3507680) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.06it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.06it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  49%|████▉     | 63/128 [00:00<00:00, 629.60it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 678.05it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:03, 35.37it/s, est. speed input: 36227.25 toks/s, output: 35.38 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:00<00:03, 38.66it/s, est. speed input: 39102.74 toks/s, output: 38.18 toks/s]
Processed prompts:  11%|█         | 14/128 [00:00<00:02, 39.63it/s, est. speed input: 40004.09 toks/s, output: 39.07 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:00<00:02, 40.05it/s, est. speed input: 40427.41 toks/s, output: 39.48 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:00<00:02, 40.34it/s, est. speed input: 40711.78 toks/s, output: 39.76 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:00<00:02, 40.50it/s, est. speed input: 40891.91 toks/s, output: 39.93 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:00<00:02, 40.52it/s, est. speed input: 40984.70 toks/s, output: 40.02 toks/s]
Processed prompts:  30%|███       | 39/128 [00:00<00:02, 40.60it/s, est. speed input: 41083.36 toks/s, output: 40.12 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:01<00:02, 40.62it/s, est. speed input: 41144.93 toks/s, output: 40.18 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:01<00:01, 40.67it/s, est. speed input: 41207.38 toks/s, output: 40.24 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:01<00:01, 40.66it/s, est. speed input: 41243.24 toks/s, output: 40.28 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:01<00:01, 40.68it/s, est. speed input: 41282.56 toks/s, output: 40.31 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:01<00:01, 40.71it/s, est. speed input: 41320.17 toks/s, output: 40.35 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:01<00:01, 40.73it/s, est. speed input: 41352.42 toks/s, output: 40.38 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:01<00:01, 40.70it/s, est. speed input: 41369.17 toks/s, output: 40.40 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:01<00:01, 40.54it/s, est. speed input: 41353.37 toks/s, output: 40.38 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:02<00:01, 40.60it/s, est. speed input: 41374.74 toks/s, output: 40.40 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:02<00:00, 40.58it/s, est. speed input: 41383.16 toks/s, output: 40.41 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:02<00:00, 40.66it/s, est. speed input: 41405.49 toks/s, output: 40.43 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:02<00:00, 40.75it/s, est. speed input: 41432.50 toks/s, output: 40.46 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:02<00:00, 40.71it/s, est. speed input: 41439.46 toks/s, output: 40.47 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:02<00:00, 40.73it/s, est. speed input: 41454.28 toks/s, output: 40.48 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:02<00:00, 40.71it/s, est. speed input: 41462.27 toks/s, output: 40.49 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:02<00:00, 40.73it/s, est. speed input: 41475.02 toks/s, output: 40.50 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:03<00:00, 40.73it/s, est. speed input: 41483.40 toks/s, output: 40.51 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:03<00:00, 40.73it/s, est. speed input: 41492.22 toks/s, output: 40.52 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:03<00:00, 40.52it/s, est. speed input: 41492.22 toks/s, output: 40.52 toks/s]
[rank0]:[W128 00:51:10.700656428 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 26.0s

测试结果:
  Requests/s:   38.21
  Tokens/s:     39169.80
  Total Reqs:   128
  Elapsed:      3.35s

  [Prefill 分析]
  Total Prefill Tokens: 131072
  Prefill Tokens/s:     39131.58

============================================================
[3/7] 测试 M=2048
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 2048
│   M_prefill     = 2048 (= 2 x 1024)
│   M_decode      = 2
│   batched_tokens = 2048 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 256
│   --max-num-seqs           = 2
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 2048
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:51:16 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3508341) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3508341) WARNING 01-28 00:51:26 [backends.py:609] Failed to read file <frozen os>
Throughput: 42.00 requests/s, 43046.68 total tokens/s, 42.00 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256


─── STDERR ───
[2026-01-28 00:51:16] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:51:16] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:51:16] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:51:16] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:51:16] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:51:16] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:51:16] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:51:16] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:51:16] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:51:16] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:51:16] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:51:16] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:51:16] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:51:16] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:51:20] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:51:20] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:51:20] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:51:20] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:51:20] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:51:20] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:51:20] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:51:20] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:51:20] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:51:20] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:51:20] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:51:20] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:51:20] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:51:20] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3508341) [2026-01-28 00:51:21] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3508341) [2026-01-28 00:51:21] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3508341) [2026-01-28 00:51:21] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3508341) [2026-01-28 00:51:21] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=3508341) [2026-01-28 00:51:21] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3508341) [2026-01-28 00:51:21] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3508341) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3508341) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.57it/s]
(EngineCore_DP0 pid=3508341) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.57it/s]
(EngineCore_DP0 pid=3508341) 
(EngineCore_DP0 pid=3508341) [2026-01-28 00:51:22] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 3424] -> 1D uint8
(EngineCore_DP0 pid=3508341) [2026-01-28 00:51:22] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 8232960 bytes
(EngineCore_DP0 pid=3508341) [2026-01-28 00:51:22] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 3424] -> 1D uint8
(EngineCore_DP0 pid=3508341) [2026-01-28 00:51:22] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 5488640 bytes
(EngineCore_DP0 pid=3508341) [2026-01-28 00:51:22] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 3424] -> 1D uint8
(EngineCore_DP0 pid=3508341) [2026-01-28 00:51:22] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 29638656 bytes
(EngineCore_DP0 pid=3508341) [2026-01-28 00:51:22] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 9216] -> 1D uint8
(EngineCore_DP0 pid=3508341) [2026-01-28 00:51:22] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 14745600 bytes
(EngineCore_DP0 pid=3508341) 2026-01-28 00:51:32,251 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3508341) 2026-01-28 00:51:32,266 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3508341) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00, 21.91it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00, 21.89it/s]
(EngineCore_DP0 pid=3508341) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 1/2 [00:00<00:00,  6.77it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00, 10.36it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  25%|██▌       | 64/256 [00:00<00:00, 633.64it/s]
Adding requests:  54%|█████▎    | 137/256 [00:00<00:00, 689.36it/s]
Adding requests:  82%|████████▏ | 211/256 [00:00<00:00, 708.65it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 711.93it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▋         | 16/256 [00:00<00:01, 150.93it/s, est. speed input: 154570.64 toks/s, output: 150.94 toks/s]
Processed prompts:  12%|█▎        | 32/256 [00:00<00:03, 60.39it/s, est. speed input: 67952.80 toks/s, output: 66.36 toks/s]   
Processed prompts:  16%|█▌        | 41/256 [00:00<00:03, 55.70it/s, est. speed input: 62635.24 toks/s, output: 61.17 toks/s]
Processed prompts:  19%|█▉        | 48/256 [00:00<00:04, 49.21it/s, est. speed input: 57220.99 toks/s, output: 55.88 toks/s]
Processed prompts:  21%|██        | 54/256 [00:01<00:04, 47.34it/s, est. speed input: 55256.35 toks/s, output: 53.96 toks/s]
Processed prompts:  23%|██▎       | 60/256 [00:01<00:04, 46.02it/s, est. speed input: 53823.12 toks/s, output: 52.56 toks/s]
Processed prompts:  26%|██▌       | 66/256 [00:01<00:04, 45.05it/s, est. speed input: 52701.75 toks/s, output: 51.47 toks/s]
Processed prompts:  28%|██▊       | 72/256 [00:01<00:04, 44.30it/s, est. speed input: 51786.00 toks/s, output: 50.57 toks/s]
Processed prompts:  30%|███       | 78/256 [00:01<00:04, 43.77it/s, est. speed input: 51040.18 toks/s, output: 49.84 toks/s]
Processed prompts:  33%|███▎      | 84/256 [00:01<00:03, 43.44it/s, est. speed input: 50431.63 toks/s, output: 49.25 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:01<00:03, 43.19it/s, est. speed input: 49911.73 toks/s, output: 48.74 toks/s]
Processed prompts:  38%|███▊      | 96/256 [00:01<00:03, 42.94it/s, est. speed input: 49446.87 toks/s, output: 48.29 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:02<00:03, 42.81it/s, est. speed input: 49053.45 toks/s, output: 47.90 toks/s]
Processed prompts:  42%|████▏     | 108/256 [00:02<00:03, 42.71it/s, est. speed input: 48707.59 toks/s, output: 47.57 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:02<00:03, 42.68it/s, est. speed input: 48410.66 toks/s, output: 47.28 toks/s]
Processed prompts:  47%|████▋     | 120/256 [00:02<00:03, 42.52it/s, est. speed input: 48118.93 toks/s, output: 46.99 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:02<00:03, 42.46it/s, est. speed input: 47866.65 toks/s, output: 46.74 toks/s]
Processed prompts:  52%|█████▏    | 132/256 [00:02<00:02, 42.51it/s, est. speed input: 47657.93 toks/s, output: 46.54 toks/s]
Processed prompts:  54%|█████▍    | 138/256 [00:02<00:02, 42.43it/s, est. speed input: 47447.20 toks/s, output: 46.34 toks/s]
Processed prompts:  56%|█████▋    | 144/256 [00:03<00:02, 42.38it/s, est. speed input: 47258.33 toks/s, output: 46.15 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:03<00:02, 42.43it/s, est. speed input: 47097.92 toks/s, output: 45.99 toks/s]
Processed prompts:  61%|██████    | 156/256 [00:03<00:02, 42.43it/s, est. speed input: 46946.55 toks/s, output: 45.85 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:03<00:02, 42.41it/s, est. speed input: 46804.17 toks/s, output: 45.71 toks/s]
Processed prompts:  66%|██████▌   | 168/256 [00:03<00:02, 42.47it/s, est. speed input: 46682.91 toks/s, output: 45.59 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:03<00:01, 42.51it/s, est. speed input: 46570.88 toks/s, output: 45.48 toks/s]
Processed prompts:  70%|███████   | 180/256 [00:03<00:01, 42.54it/s, est. speed input: 46465.95 toks/s, output: 45.38 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:04<00:01, 42.52it/s, est. speed input: 46364.30 toks/s, output: 45.28 toks/s]
Processed prompts:  75%|███████▌  | 192/256 [00:04<00:01, 42.55it/s, est. speed input: 46273.92 toks/s, output: 45.19 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:04<00:01, 42.60it/s, est. speed input: 46192.32 toks/s, output: 45.11 toks/s]
Processed prompts:  80%|███████▉  | 204/256 [00:04<00:01, 42.51it/s, est. speed input: 46102.35 toks/s, output: 45.02 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:04<00:01, 42.54it/s, est. speed input: 46027.81 toks/s, output: 44.95 toks/s]
Processed prompts:  84%|████████▍ | 216/256 [00:04<00:00, 42.49it/s, est. speed input: 45950.15 toks/s, output: 44.87 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:04<00:00, 42.46it/s, est. speed input: 45877.26 toks/s, output: 44.80 toks/s]
Processed prompts:  89%|████████▉ | 228/256 [00:05<00:00, 42.39it/s, est. speed input: 45804.01 toks/s, output: 44.73 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:05<00:00, 42.41it/s, est. speed input: 45740.79 toks/s, output: 44.67 toks/s]
Processed prompts:  94%|█████████▍| 240/256 [00:05<00:00, 42.43it/s, est. speed input: 45681.78 toks/s, output: 44.61 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:05<00:00, 42.39it/s, est. speed input: 45620.77 toks/s, output: 44.55 toks/s]
Processed prompts:  98%|█████████▊| 252/256 [00:05<00:00, 42.39it/s, est. speed input: 45565.26 toks/s, output: 44.50 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:05<00:00, 42.39it/s, est. speed input: 45715.44 toks/s, output: 44.64 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:05<00:00, 44.64it/s, est. speed input: 45715.44 toks/s, output: 44.64 toks/s]
[rank0]:[W128 00:51:39.602965162 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 28.9s

测试结果:
  Requests/s:   42.00
  Tokens/s:     43046.68
  Total Reqs:   256
  Elapsed:      6.10s

  [Prefill 分析]
  Total Prefill Tokens: 262144
  Prefill Tokens/s:     43004.68

============================================================
[4/7] 测试 M=4096
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 4096
│   M_prefill     = 4096 (= 4 x 1024)
│   M_decode      = 4
│   batched_tokens = 4096 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 512
│   --max-num-seqs           = 4
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 4096
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:51:46 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3509013) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3509013) WARNING 01-28 00:51:55 [backends.py:609] Failed to read file <frozen os>
Throughput: 41.67 requests/s, 42715.33 total tokens/s, 41.67 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512


─── STDERR ───
[2026-01-28 00:51:46] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:51:46] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:51:46] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:51:46] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:51:46] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:51:46] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:51:46] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:51:46] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:51:46] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:51:46] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:51:46] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:51:46] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:51:46] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:51:46] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:51:50] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:51:50] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:51:50] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:51:50] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:51:50] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:51:50] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:51:50] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:51:50] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:51:50] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:51:50] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:51:50] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:51:50] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:51:50] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:51:50] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3509013) [2026-01-28 00:51:50] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3509013) [2026-01-28 00:51:50] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3509013) [2026-01-28 00:51:50] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3509013) [2026-01-28 00:51:50] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=3509013) [2026-01-28 00:51:50] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3509013) [2026-01-28 00:51:50] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3509013) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3509013) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.10it/s]
(EngineCore_DP0 pid=3509013) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.10it/s]
(EngineCore_DP0 pid=3509013) 
(EngineCore_DP0 pid=3509013) [2026-01-28 00:51:51] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 3424] -> 1D uint8
(EngineCore_DP0 pid=3509013) [2026-01-28 00:51:51] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 8232960 bytes
(EngineCore_DP0 pid=3509013) [2026-01-28 00:51:51] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 3424] -> 1D uint8
(EngineCore_DP0 pid=3509013) [2026-01-28 00:51:51] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 5488640 bytes
(EngineCore_DP0 pid=3509013) [2026-01-28 00:51:51] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 3424] -> 1D uint8
(EngineCore_DP0 pid=3509013) [2026-01-28 00:51:51] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 29638656 bytes
(EngineCore_DP0 pid=3509013) [2026-01-28 00:51:51] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 9216] -> 1D uint8
(EngineCore_DP0 pid=3509013) [2026-01-28 00:51:51] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 14745600 bytes
(EngineCore_DP0 pid=3509013) 2026-01-28 00:52:01,594 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3509013) 2026-01-28 00:52:01,610 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3509013) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  75%|███████▌  | 3/4 [00:00<00:00, 22.93it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00, 21.65it/s]
(EngineCore_DP0 pid=3509013) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  33%|███▎      | 1/3 [00:00<00:00,  7.22it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00, 14.52it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:  14%|█▍        | 72/512 [00:00<00:00, 713.37it/s]
Adding requests:  29%|██▊       | 146/512 [00:00<00:00, 726.26it/s]
Adding requests:  43%|████▎     | 219/512 [00:00<00:00, 720.84it/s]
Adding requests:  57%|█████▋    | 294/512 [00:00<00:00, 729.55it/s]
Adding requests:  72%|███████▏  | 370/512 [00:00<00:00, 738.03it/s]
Adding requests:  87%|████████▋ | 445/512 [00:00<00:00, 739.34it/s]
Adding requests: 100%|██████████| 512/512 [00:00<00:00, 735.88it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▌         | 30/512 [00:00<00:02, 161.02it/s, est. speed input: 164898.04 toks/s, output: 161.02 toks/s]
Processed prompts:   9%|▉         | 47/512 [00:00<00:06, 74.37it/s, est. speed input: 84903.48 toks/s, output: 82.91 toks/s]   
Processed prompts:  11%|█         | 57/512 [00:00<00:06, 66.69it/s, est. speed input: 77007.83 toks/s, output: 75.20 toks/s]
Processed prompts:  13%|█▎        | 65/512 [00:00<00:07, 58.49it/s, est. speed input: 70163.58 toks/s, output: 68.52 toks/s]
Processed prompts:  14%|█▍        | 72/512 [00:01<00:08, 51.54it/s, est. speed input: 64745.76 toks/s, output: 63.23 toks/s]
Processed prompts:  15%|█▌        | 78/512 [00:01<00:09, 45.25it/s, est. speed input: 60105.20 toks/s, output: 58.70 toks/s]
Processed prompts:  17%|█▋        | 86/512 [00:01<00:09, 44.27it/s, est. speed input: 57974.65 toks/s, output: 56.62 toks/s]
Processed prompts:  18%|█▊        | 94/512 [00:01<00:09, 43.55it/s, est. speed input: 56298.57 toks/s, output: 54.98 toks/s]
Processed prompts:  20%|█▉        | 102/512 [00:01<00:09, 43.10it/s, est. speed input: 54975.06 toks/s, output: 53.69 toks/s]
Processed prompts:  21%|██▏       | 110/512 [00:02<00:09, 42.81it/s, est. speed input: 53902.34 toks/s, output: 52.64 toks/s]
Processed prompts:  23%|██▎       | 118/512 [00:02<00:09, 42.56it/s, est. speed input: 52988.20 toks/s, output: 51.75 toks/s]
Processed prompts:  25%|██▍       | 126/512 [00:02<00:09, 42.39it/s, est. speed input: 52220.31 toks/s, output: 51.00 toks/s]
Processed prompts:  26%|██▌       | 134/512 [00:02<00:08, 42.27it/s, est. speed input: 51560.98 toks/s, output: 50.35 toks/s]
Processed prompts:  28%|██▊       | 142/512 [00:02<00:08, 42.17it/s, est. speed input: 50983.15 toks/s, output: 49.79 toks/s]
Processed prompts:  29%|██▉       | 150/512 [00:03<00:08, 42.11it/s, est. speed input: 50482.04 toks/s, output: 49.30 toks/s]
Processed prompts:  31%|███       | 158/512 [00:03<00:08, 42.10it/s, est. speed input: 50046.34 toks/s, output: 48.87 toks/s]
Processed prompts:  32%|███▏      | 166/512 [00:03<00:08, 42.09it/s, est. speed input: 49659.90 toks/s, output: 48.50 toks/s]
Processed prompts:  34%|███▍      | 174/512 [00:03<00:08, 42.08it/s, est. speed input: 49312.35 toks/s, output: 48.16 toks/s]
Processed prompts:  36%|███▌      | 182/512 [00:03<00:07, 42.05it/s, est. speed input: 48995.81 toks/s, output: 47.85 toks/s]
Processed prompts:  37%|███▋      | 190/512 [00:03<00:07, 42.07it/s, est. speed input: 48716.29 toks/s, output: 47.57 toks/s]
Processed prompts:  39%|███▊      | 198/512 [00:04<00:07, 42.11it/s, est. speed input: 48466.44 toks/s, output: 47.33 toks/s]
Processed prompts:  40%|████      | 206/512 [00:04<00:07, 42.10it/s, est. speed input: 48233.45 toks/s, output: 47.10 toks/s]
Processed prompts:  42%|████▏     | 214/512 [00:04<00:07, 42.11it/s, est. speed input: 48022.17 toks/s, output: 46.90 toks/s]
Processed prompts:  43%|████▎     | 222/512 [00:04<00:06, 42.06it/s, est. speed input: 47817.76 toks/s, output: 46.70 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:04<00:06, 41.99it/s, est. speed input: 47625.39 toks/s, output: 46.51 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:05<00:06, 42.00it/s, est. speed input: 47454.35 toks/s, output: 46.34 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:05<00:06, 41.99it/s, est. speed input: 47294.31 toks/s, output: 46.19 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:05<00:06, 42.01it/s, est. speed input: 47149.15 toks/s, output: 46.04 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:05<00:05, 42.01it/s, est. speed input: 47011.00 toks/s, output: 45.91 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:05<00:05, 42.00it/s, est. speed input: 46880.28 toks/s, output: 45.78 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:06<00:05, 42.03it/s, est. speed input: 46762.38 toks/s, output: 45.67 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:06<00:05, 42.06it/s, est. speed input: 46653.36 toks/s, output: 45.56 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:06<00:05, 42.07it/s, est. speed input: 46548.83 toks/s, output: 45.46 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:06<00:04, 42.07it/s, est. speed input: 46449.83 toks/s, output: 45.36 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:06<00:04, 42.05it/s, est. speed input: 46353.72 toks/s, output: 45.27 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:07<00:04, 42.02it/s, est. speed input: 46262.03 toks/s, output: 45.18 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:07<00:04, 42.01it/s, est. speed input: 46175.88 toks/s, output: 45.09 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:07<00:04, 42.04it/s, est. speed input: 46097.69 toks/s, output: 45.02 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:07<00:04, 42.04it/s, est. speed input: 46021.87 toks/s, output: 44.94 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:07<00:03, 42.03it/s, est. speed input: 45947.69 toks/s, output: 44.87 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:07<00:03, 42.02it/s, est. speed input: 45877.59 toks/s, output: 44.80 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:08<00:03, 42.02it/s, est. speed input: 45811.83 toks/s, output: 44.74 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [00:08<00:03, 42.01it/s, est. speed input: 45747.32 toks/s, output: 44.68 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [00:08<00:03, 42.01it/s, est. speed input: 45686.89 toks/s, output: 44.62 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [00:08<00:02, 41.99it/s, est. speed input: 45627.48 toks/s, output: 44.56 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [00:08<00:02, 41.99it/s, est. speed input: 45571.37 toks/s, output: 44.50 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [00:09<00:02, 42.00it/s, est. speed input: 45518.28 toks/s, output: 44.45 toks/s]
Processed prompts:  81%|████████  | 414/512 [00:09<00:02, 42.01it/s, est. speed input: 45467.59 toks/s, output: 44.40 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [00:09<00:02, 42.02it/s, est. speed input: 45419.19 toks/s, output: 44.35 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [00:09<00:01, 42.01it/s, est. speed input: 45371.45 toks/s, output: 44.31 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [00:09<00:01, 42.03it/s, est. speed input: 45327.96 toks/s, output: 44.27 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [00:10<00:01, 42.02it/s, est. speed input: 45283.70 toks/s, output: 44.22 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [00:10<00:01, 42.03it/s, est. speed input: 45242.91 toks/s, output: 44.18 toks/s]
Processed prompts:  90%|█████████ | 462/512 [00:10<00:01, 42.05it/s, est. speed input: 45204.10 toks/s, output: 44.14 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [00:10<00:00, 42.04it/s, est. speed input: 45165.07 toks/s, output: 44.11 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [00:10<00:00, 42.05it/s, est. speed input: 45128.29 toks/s, output: 44.07 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [00:11<00:00, 42.03it/s, est. speed input: 45091.69 toks/s, output: 44.03 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [00:11<00:00, 42.01it/s, est. speed input: 45055.56 toks/s, output: 44.00 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [00:11<00:00, 42.00it/s, est. speed input: 45021.01 toks/s, output: 43.97 toks/s]
Processed prompts: 100%|█████████▉| 510/512 [00:11<00:00, 43.30it/s, est. speed input: 45061.90 toks/s, output: 44.01 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:11<00:00, 43.30it/s, est. speed input: 45238.31 toks/s, output: 44.18 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:11<00:00, 44.18it/s, est. speed input: 45238.31 toks/s, output: 44.18 toks/s]
[rank0]:[W128 00:52:15.248297029 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 35.6s

测试结果:
  Requests/s:   41.67
  Tokens/s:     42715.33
  Total Reqs:   512
  Elapsed:      12.29s

  [Prefill 分析]
  Total Prefill Tokens: 524288
  Prefill Tokens/s:     42673.66

============================================================
[5/7] 测试 M=8192
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 8192
│   M_prefill     = 8192 (= 8 x 1024)
│   M_decode      = 8
│   batched_tokens = 8192 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 1024
│   --max-num-seqs           = 8
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 8192
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:52:23 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3509814) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3509814) WARNING 01-28 00:52:32 [backends.py:609] Failed to read file <frozen os>
Throughput: 39.89 requests/s, 40885.40 total tokens/s, 39.89 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024


─── STDERR ───
[2026-01-28 00:52:23] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:52:23] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:52:23] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:52:23] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:52:23] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:52:23] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:52:23] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:52:23] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:52:23] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:52:23] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:52:23] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:52:23] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:52:23] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:52:23] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:52:26] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:52:26] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:52:26] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:52:26] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:52:26] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:52:26] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:52:26] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:52:26] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:52:26] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:52:26] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:52:26] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:52:26] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:52:26] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:52:26] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3509814) [2026-01-28 00:52:27] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3509814) [2026-01-28 00:52:27] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3509814) [2026-01-28 00:52:27] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3509814) [2026-01-28 00:52:27] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=3509814) [2026-01-28 00:52:27] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3509814) [2026-01-28 00:52:27] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3509814) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3509814) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.07it/s]
(EngineCore_DP0 pid=3509814) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.07it/s]
(EngineCore_DP0 pid=3509814) 
(EngineCore_DP0 pid=3509814) [2026-01-28 00:52:28] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 3424] -> 1D uint8
(EngineCore_DP0 pid=3509814) [2026-01-28 00:52:28] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 8232960 bytes
(EngineCore_DP0 pid=3509814) [2026-01-28 00:52:28] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 3424] -> 1D uint8
(EngineCore_DP0 pid=3509814) [2026-01-28 00:52:28] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 5488640 bytes
(EngineCore_DP0 pid=3509814) [2026-01-28 00:52:28] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 3424] -> 1D uint8
(EngineCore_DP0 pid=3509814) [2026-01-28 00:52:28] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 29638656 bytes
(EngineCore_DP0 pid=3509814) [2026-01-28 00:52:28] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 9216] -> 1D uint8
(EngineCore_DP0 pid=3509814) [2026-01-28 00:52:28] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 14745600 bytes
(EngineCore_DP0 pid=3509814) 2026-01-28 00:52:38,171 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3509814) 2026-01-28 00:52:38,187 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3509814) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:00,  4.43it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  80%|████████  | 4/5 [00:00<00:00, 13.46it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00, 12.70it/s]
(EngineCore_DP0 pid=3509814) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:00,  7.25it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00, 17.08it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00, 15.50it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   7%|▋         | 74/1024 [00:00<00:01, 731.47it/s]
Adding requests:  15%|█▍        | 151/1024 [00:00<00:01, 746.32it/s]
Adding requests:  22%|██▏       | 227/1024 [00:00<00:01, 751.08it/s]
Adding requests:  30%|██▉       | 303/1024 [00:00<00:00, 745.17it/s]
Adding requests:  37%|███▋      | 380/1024 [00:00<00:00, 750.51it/s]
Adding requests:  45%|████▍     | 456/1024 [00:00<00:00, 744.21it/s]
Adding requests:  52%|█████▏    | 531/1024 [00:00<00:00, 727.47it/s]
Adding requests:  59%|█████▉    | 609/1024 [00:00<00:00, 742.38it/s]
Adding requests:  67%|██████▋   | 689/1024 [00:00<00:00, 756.93it/s]
Adding requests:  75%|███████▍  | 767/1024 [00:01<00:00, 763.38it/s]
Adding requests:  82%|████████▏ | 844/1024 [00:01<00:00, 745.58it/s]
Adding requests:  90%|█████████ | 923/1024 [00:01<00:00, 757.63it/s]
Adding requests:  98%|█████████▊| 1000/1024 [00:01<00:00, 759.72it/s]
Adding requests: 100%|██████████| 1024/1024 [00:01<00:00, 751.35it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▍         | 50/1024 [00:00<00:02, 414.78it/s, est. speed input: 424790.06 toks/s, output: 414.80 toks/s]
Processed prompts:   9%|▉         | 92/1024 [00:01<00:13, 71.08it/s, est. speed input: 84155.62 toks/s, output: 82.18 toks/s]   
Processed prompts:  11%|█         | 112/1024 [00:01<00:14, 63.85it/s, est. speed input: 75525.14 toks/s, output: 73.75 toks/s]
Processed prompts:  12%|█▏        | 125/1024 [00:01<00:16, 53.54it/s, est. speed input: 66755.94 toks/s, output: 65.19 toks/s]
Processed prompts:  13%|█▎        | 135/1024 [00:02<00:16, 52.87it/s, est. speed input: 65294.86 toks/s, output: 63.76 toks/s]
Processed prompts:  14%|█▍        | 143/1024 [00:02<00:17, 50.11it/s, est. speed input: 63195.64 toks/s, output: 61.71 toks/s]
Processed prompts:  15%|█▍        | 150/1024 [00:02<00:18, 46.61it/s, est. speed input: 61039.90 toks/s, output: 59.61 toks/s]
Processed prompts:  15%|█▌        | 156/1024 [00:02<00:20, 42.44it/s, est. speed input: 58806.98 toks/s, output: 57.43 toks/s]
Processed prompts:  16%|█▌        | 162/1024 [00:02<00:21, 39.19it/s, est. speed input: 56893.95 toks/s, output: 55.56 toks/s]
Processed prompts:  17%|█▋        | 170/1024 [00:03<00:21, 39.41it/s, est. speed input: 55872.67 toks/s, output: 54.56 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [00:03<00:21, 39.59it/s, est. speed input: 54977.57 toks/s, output: 53.69 toks/s]
Processed prompts:  18%|█▊        | 186/1024 [00:03<00:21, 39.74it/s, est. speed input: 54186.95 toks/s, output: 52.92 toks/s]
Processed prompts:  19%|█▉        | 194/1024 [00:03<00:20, 39.82it/s, est. speed input: 53477.19 toks/s, output: 52.22 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [00:03<00:20, 39.87it/s, est. speed input: 52838.30 toks/s, output: 51.60 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:04<00:20, 39.92it/s, est. speed input: 52262.35 toks/s, output: 51.04 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [00:04<00:20, 39.93it/s, est. speed input: 51736.38 toks/s, output: 50.52 toks/s]
Processed prompts:  22%|██▏       | 226/1024 [00:04<00:19, 39.97it/s, est. speed input: 51262.19 toks/s, output: 50.06 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:04<00:19, 39.99it/s, est. speed input: 50827.80 toks/s, output: 49.64 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:04<00:19, 40.02it/s, est. speed input: 50430.44 toks/s, output: 49.25 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:05<00:19, 40.01it/s, est. speed input: 50059.18 toks/s, output: 48.89 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:05<00:19, 40.02it/s, est. speed input: 49719.39 toks/s, output: 48.55 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:05<00:18, 40.03it/s, est. speed input: 49403.90 toks/s, output: 48.25 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:05<00:18, 40.03it/s, est. speed input: 49109.33 toks/s, output: 47.96 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:05<00:18, 40.05it/s, est. speed input: 48837.82 toks/s, output: 47.69 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:06<00:18, 40.03it/s, est. speed input: 48579.35 toks/s, output: 47.44 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:06<00:18, 40.04it/s, est. speed input: 48339.76 toks/s, output: 47.21 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:06<00:17, 40.03it/s, est. speed input: 48114.07 toks/s, output: 46.99 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:06<00:17, 40.06it/s, est. speed input: 47904.81 toks/s, output: 46.78 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:06<00:17, 40.04it/s, est. speed input: 47704.21 toks/s, output: 46.59 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:07<00:17, 40.03it/s, est. speed input: 47515.03 toks/s, output: 46.40 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:07<00:17, 40.03it/s, est. speed input: 47336.71 toks/s, output: 46.23 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:07<00:16, 40.04it/s, est. speed input: 47168.96 toks/s, output: 46.06 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:07<00:16, 40.04it/s, est. speed input: 47008.91 toks/s, output: 45.91 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:07<00:16, 40.06it/s, est. speed input: 46858.90 toks/s, output: 45.76 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:08<00:16, 40.04it/s, est. speed input: 46713.35 toks/s, output: 45.62 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:08<00:16, 40.04it/s, est. speed input: 46576.45 toks/s, output: 45.48 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:08<00:15, 40.04it/s, est. speed input: 46445.19 toks/s, output: 45.36 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [00:08<00:15, 40.05it/s, est. speed input: 46321.32 toks/s, output: 45.24 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:08<00:15, 40.06it/s, est. speed input: 46203.08 toks/s, output: 45.12 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:09<00:15, 40.04it/s, est. speed input: 46087.59 toks/s, output: 45.01 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:09<00:15, 40.05it/s, est. speed input: 45979.12 toks/s, output: 44.90 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:09<00:14, 40.04it/s, est. speed input: 45874.02 toks/s, output: 44.80 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:09<00:14, 40.05it/s, est. speed input: 45774.30 toks/s, output: 44.70 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:09<00:14, 40.04it/s, est. speed input: 45677.70 toks/s, output: 44.61 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:10<00:14, 40.02it/s, est. speed input: 45583.64 toks/s, output: 44.52 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:10<00:14, 40.02it/s, est. speed input: 45494.42 toks/s, output: 44.43 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:10<00:13, 40.03it/s, est. speed input: 45409.51 toks/s, output: 44.35 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:10<00:13, 40.03it/s, est. speed input: 45326.89 toks/s, output: 44.26 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:10<00:13, 40.04it/s, est. speed input: 45248.24 toks/s, output: 44.19 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:11<00:13, 40.03it/s, est. speed input: 45171.07 toks/s, output: 44.11 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:11<00:13, 40.01it/s, est. speed input: 45096.04 toks/s, output: 44.04 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:11<00:12, 39.99it/s, est. speed input: 45023.05 toks/s, output: 43.97 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:11<00:12, 39.99it/s, est. speed input: 44953.47 toks/s, output: 43.90 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:11<00:12, 39.98it/s, est. speed input: 44885.65 toks/s, output: 43.83 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:12<00:12, 39.95it/s, est. speed input: 44818.23 toks/s, output: 43.77 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:12<00:12, 39.96it/s, est. speed input: 44755.52 toks/s, output: 43.71 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:12<00:11, 39.96it/s, est. speed input: 44694.23 toks/s, output: 43.65 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:12<00:11, 39.99it/s, est. speed input: 44636.29 toks/s, output: 43.59 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:12<00:11, 39.99it/s, est. speed input: 44579.09 toks/s, output: 43.53 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:13<00:11, 39.97it/s, est. speed input: 44522.78 toks/s, output: 43.48 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:13<00:11, 39.96it/s, est. speed input: 44467.95 toks/s, output: 43.43 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:13<00:10, 39.96it/s, est. speed input: 44415.71 toks/s, output: 43.37 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:13<00:10, 39.96it/s, est. speed input: 44364.42 toks/s, output: 43.32 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:13<00:10, 39.95it/s, est. speed input: 44314.43 toks/s, output: 43.28 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:14<00:10, 39.92it/s, est. speed input: 44264.53 toks/s, output: 43.23 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:14<00:10, 39.93it/s, est. speed input: 44217.71 toks/s, output: 43.18 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:14<00:09, 39.95it/s, est. speed input: 44172.70 toks/s, output: 43.14 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:14<00:09, 39.95it/s, est. speed input: 44128.37 toks/s, output: 43.09 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:14<00:09, 39.94it/s, est. speed input: 44084.67 toks/s, output: 43.05 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:15<00:09, 39.94it/s, est. speed input: 44042.30 toks/s, output: 43.01 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:15<00:09, 39.97it/s, est. speed input: 44002.47 toks/s, output: 42.97 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:15<00:08, 39.97it/s, est. speed input: 43963.05 toks/s, output: 42.93 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:15<00:08, 39.97it/s, est. speed input: 43924.28 toks/s, output: 42.89 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:15<00:08, 39.95it/s, est. speed input: 43885.71 toks/s, output: 42.86 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:16<00:08, 39.93it/s, est. speed input: 43847.93 toks/s, output: 42.82 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:16<00:08, 39.91it/s, est. speed input: 43810.72 toks/s, output: 42.78 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:16<00:07, 39.92it/s, est. speed input: 43775.32 toks/s, output: 42.75 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:16<00:07, 39.94it/s, est. speed input: 43741.48 toks/s, output: 42.72 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:16<00:07, 39.92it/s, est. speed input: 43707.15 toks/s, output: 42.68 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:17<00:07, 39.91it/s, est. speed input: 43673.54 toks/s, output: 42.65 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:17<00:07, 39.92it/s, est. speed input: 43641.26 toks/s, output: 42.62 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:17<00:06, 39.93it/s, est. speed input: 43609.99 toks/s, output: 42.59 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:17<00:06, 39.93it/s, est. speed input: 43579.19 toks/s, output: 42.56 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:17<00:06, 39.92it/s, est. speed input: 43548.76 toks/s, output: 42.53 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:18<00:06, 39.90it/s, est. speed input: 43518.60 toks/s, output: 42.50 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:18<00:06, 39.91it/s, est. speed input: 43489.88 toks/s, output: 42.47 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:18<00:05, 39.92it/s, est. speed input: 43461.94 toks/s, output: 42.44 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:18<00:05, 39.94it/s, est. speed input: 43434.93 toks/s, output: 42.42 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:18<00:05, 39.92it/s, est. speed input: 43407.45 toks/s, output: 42.39 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:19<00:05, 39.90it/s, est. speed input: 43380.08 toks/s, output: 42.36 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:19<00:05, 39.92it/s, est. speed input: 43354.56 toks/s, output: 42.34 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:19<00:04, 39.94it/s, est. speed input: 43329.83 toks/s, output: 42.31 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:19<00:04, 39.95it/s, est. speed input: 43305.64 toks/s, output: 42.29 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [00:19<00:04, 39.95it/s, est. speed input: 43281.38 toks/s, output: 42.27 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [00:20<00:04, 39.93it/s, est. speed input: 43257.30 toks/s, output: 42.24 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:20<00:04, 39.92it/s, est. speed input: 43233.33 toks/s, output: 42.22 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [00:20<00:03, 39.93it/s, est. speed input: 43210.74 toks/s, output: 42.20 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [00:20<00:03, 39.94it/s, est. speed input: 43188.75 toks/s, output: 42.18 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [00:20<00:03, 39.94it/s, est. speed input: 43166.68 toks/s, output: 42.15 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [00:21<00:03, 39.92it/s, est. speed input: 43144.52 toks/s, output: 42.13 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [00:21<00:03, 39.92it/s, est. speed input: 43123.20 toks/s, output: 42.11 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [00:21<00:02, 39.94it/s, est. speed input: 43103.01 toks/s, output: 42.09 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [00:21<00:02, 39.95it/s, est. speed input: 43082.94 toks/s, output: 42.07 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [00:21<00:02, 39.94it/s, est. speed input: 43062.68 toks/s, output: 42.05 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [00:22<00:02, 39.90it/s, est. speed input: 43042.03 toks/s, output: 42.03 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [00:22<00:02, 39.91it/s, est. speed input: 43022.59 toks/s, output: 42.01 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [00:22<00:01, 39.92it/s, est. speed input: 43003.87 toks/s, output: 42.00 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [00:22<00:01, 39.93it/s, est. speed input: 42985.51 toks/s, output: 41.98 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [00:22<00:01, 39.95it/s, est. speed input: 42967.76 toks/s, output: 41.96 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [00:23<00:01, 39.93it/s, est. speed input: 42949.28 toks/s, output: 41.94 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [00:23<00:01, 39.92it/s, est. speed input: 42931.39 toks/s, output: 41.93 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [00:23<00:00, 39.94it/s, est. speed input: 42914.38 toks/s, output: 41.91 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [00:23<00:00, 39.95it/s, est. speed input: 42897.58 toks/s, output: 41.89 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [00:23<00:00, 39.95it/s, est. speed input: 42880.99 toks/s, output: 41.88 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [00:24<00:00, 39.91it/s, est. speed input: 42863.32 toks/s, output: 41.86 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [00:24<00:00, 41.23it/s, est. speed input: 42884.67 toks/s, output: 41.88 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:24<00:00, 41.23it/s, est. speed input: 43137.20 toks/s, output: 42.13 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:24<00:00, 42.13it/s, est. speed input: 43137.20 toks/s, output: 42.13 toks/s]
[rank0]:[W128 00:53:05.611688338 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 50.4s

测试结果:
  Requests/s:   39.89
  Tokens/s:     40885.40
  Total Reqs:   1024
  Elapsed:      25.67s

  [Prefill 分析]
  Total Prefill Tokens: 1048576
  Prefill Tokens/s:     40845.52

============================================================
[6/7] 测试 M=16384
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 16384
│   M_prefill     = 16384 (= 16 x 1024)
│   M_decode      = 16
│   batched_tokens = 16384 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 2048
│   --max-num-seqs           = 16
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 16384
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:53:16 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3510822) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3510822) WARNING 01-28 00:53:25 [backends.py:609] Failed to read file <frozen os>
Throughput: 39.18 requests/s, 40158.33 total tokens/s, 39.18 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048


─── STDERR ───
[2026-01-28 00:53:16] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:53:16] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:53:16] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:53:16] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:53:16] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:53:16] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:53:16] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:53:16] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:53:16] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:53:16] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:53:16] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:53:16] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:53:16] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:53:16] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:53:20] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:53:20] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:53:20] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:53:20] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:53:20] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:53:20] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:53:20] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:53:20] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:53:20] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:53:20] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:53:20] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:53:20] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:53:20] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:53:20] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3510822) [2026-01-28 00:53:20] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3510822) [2026-01-28 00:53:20] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3510822) [2026-01-28 00:53:20] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3510822) [2026-01-28 00:53:20] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=3510822) [2026-01-28 00:53:20] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3510822) [2026-01-28 00:53:20] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3510822) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3510822) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.06it/s]
(EngineCore_DP0 pid=3510822) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.06it/s]
(EngineCore_DP0 pid=3510822) 
(EngineCore_DP0 pid=3510822) [2026-01-28 00:53:21] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 3424] -> 1D uint8
(EngineCore_DP0 pid=3510822) [2026-01-28 00:53:21] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 8232960 bytes
(EngineCore_DP0 pid=3510822) [2026-01-28 00:53:21] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 3424] -> 1D uint8
(EngineCore_DP0 pid=3510822) [2026-01-28 00:53:21] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 5488640 bytes
(EngineCore_DP0 pid=3510822) [2026-01-28 00:53:21] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 3424] -> 1D uint8
(EngineCore_DP0 pid=3510822) [2026-01-28 00:53:21] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 29638656 bytes
(EngineCore_DP0 pid=3510822) [2026-01-28 00:53:21] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 9216] -> 1D uint8
(EngineCore_DP0 pid=3510822) [2026-01-28 00:53:21] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 14745600 bytes
(EngineCore_DP0 pid=3510822) 2026-01-28 00:53:31,558 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3510822) 2026-01-28 00:53:31,573 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3510822) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  14%|█▍        | 1/7 [00:00<00:01,  4.98it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  57%|█████▋    | 4/7 [00:00<00:00, 14.36it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00, 18.54it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00, 15.94it/s]
(EngineCore_DP0 pid=3510822) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  20%|██        | 1/5 [00:00<00:00,  7.37it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00, 20.54it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00, 18.55it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   4%|▎         | 72/2048 [00:00<00:02, 715.93it/s]
Adding requests:   7%|▋         | 144/2048 [00:00<00:02, 693.10it/s]
Adding requests:  11%|█         | 217/2048 [00:00<00:02, 709.09it/s]
Adding requests:  14%|█▍        | 293/2048 [00:00<00:02, 726.97it/s]
Adding requests:  18%|█▊        | 368/2048 [00:00<00:02, 733.76it/s]
Adding requests:  22%|██▏       | 443/2048 [00:00<00:02, 737.69it/s]
Adding requests:  25%|██▌       | 519/2048 [00:00<00:02, 741.74it/s]
Adding requests:  29%|██▉       | 597/2048 [00:00<00:01, 751.48it/s]
Adding requests:  33%|███▎      | 673/2048 [00:00<00:01, 744.92it/s]
Adding requests:  37%|███▋      | 750/2048 [00:01<00:01, 752.32it/s]
Adding requests:  40%|████      | 826/2048 [00:01<00:01, 742.53it/s]
Adding requests:  44%|████▍     | 904/2048 [00:01<00:01, 753.16it/s]
Adding requests:  48%|████▊     | 982/2048 [00:01<00:01, 758.70it/s]
Adding requests:  52%|█████▏    | 1060/2048 [00:01<00:01, 764.18it/s]
Adding requests:  56%|█████▌    | 1137/2048 [00:01<00:01, 760.47it/s]
Adding requests:  60%|█████▉    | 1219/2048 [00:01<00:01, 777.13it/s]
Adding requests:  63%|██████▎   | 1297/2048 [00:01<00:00, 763.96it/s]
Adding requests:  67%|██████▋   | 1374/2048 [00:01<00:00, 765.72it/s]
Adding requests:  71%|███████   | 1451/2048 [00:01<00:00, 760.81it/s]
Adding requests:  75%|███████▍  | 1530/2048 [00:02<00:00, 769.14it/s]
Adding requests:  79%|███████▊  | 1608/2048 [00:02<00:00, 769.02it/s]
Adding requests:  82%|████████▏ | 1685/2048 [00:02<00:00, 759.18it/s]
Adding requests:  86%|████████▌ | 1761/2048 [00:02<00:00, 759.21it/s]
Adding requests:  90%|████████▉ | 1837/2048 [00:02<00:00, 743.91it/s]
Adding requests:  93%|█████████▎| 1912/2048 [00:02<00:00, 743.46it/s]
Adding requests:  97%|█████████▋| 1989/2048 [00:02<00:00, 749.16it/s]
Adding requests: 100%|██████████| 2048/2048 [00:02<00:00, 750.69it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▍         | 98/2048 [00:00<00:04, 420.50it/s, est. speed input: 430619.86 toks/s, output: 420.51 toks/s]
Processed prompts:   7%|▋         | 141/2048 [00:01<00:16, 114.25it/s, est. speed input: 137940.75 toks/s, output: 134.71 toks/s]
Processed prompts:   8%|▊         | 162/2048 [00:01<00:28, 66.20it/s, est. speed input: 89171.88 toks/s, output: 87.08 toks/s]   
Processed prompts:   9%|▊         | 178/2048 [00:02<00:31, 58.68it/s, est. speed input: 80393.89 toks/s, output: 78.51 toks/s]
Processed prompts:   9%|▉         | 194/2048 [00:02<00:34, 53.15it/s, est. speed input: 74286.04 toks/s, output: 72.54 toks/s]
Processed prompts:  10%|█         | 210/2048 [00:03<00:37, 49.15it/s, est. speed input: 69798.47 toks/s, output: 68.16 toks/s]
Processed prompts:  11%|█         | 226/2048 [00:03<00:39, 46.27it/s, est. speed input: 66351.90 toks/s, output: 64.80 toks/s]
Processed prompts:  12%|█▏        | 242/2048 [00:03<00:40, 44.22it/s, est. speed input: 63624.93 toks/s, output: 62.13 toks/s]
Processed prompts:  13%|█▎        | 258/2048 [00:04<00:41, 42.77it/s, est. speed input: 61414.64 toks/s, output: 59.98 toks/s]
Processed prompts:  13%|█▎        | 274/2048 [00:04<00:42, 41.65it/s, est. speed input: 59549.78 toks/s, output: 58.15 toks/s]
Processed prompts:  14%|█▍        | 290/2048 [00:05<00:42, 40.95it/s, est. speed input: 58014.99 toks/s, output: 56.66 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [00:05<00:43, 40.46it/s, est. speed input: 56704.00 toks/s, output: 55.37 toks/s]
Processed prompts:  16%|█▌        | 322/2048 [00:05<00:43, 40.12it/s, est. speed input: 55578.65 toks/s, output: 54.28 toks/s]
Processed prompts:  17%|█▋        | 338/2048 [00:06<00:42, 39.89it/s, est. speed input: 54596.52 toks/s, output: 53.32 toks/s]
Processed prompts:  17%|█▋        | 354/2048 [00:06<00:42, 39.70it/s, est. speed input: 53727.09 toks/s, output: 52.47 toks/s]
Processed prompts:  18%|█▊        | 370/2048 [00:07<00:42, 39.59it/s, est. speed input: 52963.01 toks/s, output: 51.72 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [00:07<00:42, 39.51it/s, est. speed input: 52279.38 toks/s, output: 51.05 toks/s]
Processed prompts:  20%|█▉        | 402/2048 [00:07<00:41, 39.45it/s, est. speed input: 51666.04 toks/s, output: 50.46 toks/s]
Processed prompts:  20%|██        | 418/2048 [00:08<00:41, 39.38it/s, est. speed input: 51105.51 toks/s, output: 49.91 toks/s]
Processed prompts:  21%|██        | 434/2048 [00:08<00:41, 39.36it/s, est. speed input: 50602.81 toks/s, output: 49.42 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [00:09<00:40, 39.32it/s, est. speed input: 50138.78 toks/s, output: 48.96 toks/s]
Processed prompts:  23%|██▎       | 466/2048 [00:09<00:40, 39.27it/s, est. speed input: 49712.31 toks/s, output: 48.55 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [00:10<00:39, 39.26it/s, est. speed input: 49323.78 toks/s, output: 48.17 toks/s]
Processed prompts:  24%|██▍       | 498/2048 [00:10<00:39, 39.24it/s, est. speed input: 48963.08 toks/s, output: 47.82 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [00:10<00:39, 39.24it/s, est. speed input: 48632.00 toks/s, output: 47.49 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [00:11<00:38, 39.23it/s, est. speed input: 48323.62 toks/s, output: 47.19 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [00:11<00:38, 39.22it/s, est. speed input: 48036.69 toks/s, output: 46.91 toks/s]
Processed prompts:  27%|██▋       | 562/2048 [00:12<00:37, 39.22it/s, est. speed input: 47770.13 toks/s, output: 46.65 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [00:12<00:37, 39.21it/s, est. speed input: 47519.15 toks/s, output: 46.41 toks/s]
Processed prompts:  29%|██▉       | 594/2048 [00:12<00:37, 39.21it/s, est. speed input: 47286.04 toks/s, output: 46.18 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [00:13<00:36, 39.21it/s, est. speed input: 47066.66 toks/s, output: 45.96 toks/s]
Processed prompts:  31%|███       | 626/2048 [00:13<00:36, 39.21it/s, est. speed input: 46860.07 toks/s, output: 45.76 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [00:14<00:35, 39.21it/s, est. speed input: 46665.62 toks/s, output: 45.57 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [00:14<00:35, 39.20it/s, est. speed input: 46481.65 toks/s, output: 45.39 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [00:14<00:35, 39.20it/s, est. speed input: 46307.93 toks/s, output: 45.22 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [00:15<00:34, 39.21it/s, est. speed input: 46144.06 toks/s, output: 45.06 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [00:15<00:34, 39.19it/s, est. speed input: 45987.03 toks/s, output: 44.91 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [00:16<00:33, 39.19it/s, est. speed input: 45838.53 toks/s, output: 44.76 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [00:16<00:33, 39.18it/s, est. speed input: 45696.80 toks/s, output: 44.63 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [00:16<00:33, 39.19it/s, est. speed input: 45563.14 toks/s, output: 44.50 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [00:17<00:32, 39.19it/s, est. speed input: 45435.79 toks/s, output: 44.37 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [00:17<00:32, 39.18it/s, est. speed input: 45313.07 toks/s, output: 44.25 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [00:18<00:31, 39.19it/s, est. speed input: 45197.37 toks/s, output: 44.14 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [00:18<00:31, 39.20it/s, est. speed input: 45086.45 toks/s, output: 44.03 toks/s]
Processed prompts:  41%|████      | 834/2048 [00:18<00:30, 39.20it/s, est. speed input: 44980.27 toks/s, output: 43.93 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [00:19<00:30, 39.19it/s, est. speed input: 44877.70 toks/s, output: 43.83 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [00:19<00:30, 39.19it/s, est. speed input: 44780.14 toks/s, output: 43.73 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [00:20<00:29, 39.19it/s, est. speed input: 44686.21 toks/s, output: 43.64 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [00:20<00:29, 39.19it/s, est. speed input: 44595.63 toks/s, output: 43.55 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [00:21<00:28, 39.19it/s, est. speed input: 44509.35 toks/s, output: 43.47 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [00:21<00:28, 39.18it/s, est. speed input: 44425.36 toks/s, output: 43.38 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [00:21<00:28, 39.18it/s, est. speed input: 44344.89 toks/s, output: 43.31 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [00:22<00:27, 39.19it/s, est. speed input: 44267.99 toks/s, output: 43.23 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [00:22<00:27, 39.18it/s, est. speed input: 44192.78 toks/s, output: 43.16 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [00:23<00:26, 39.20it/s, est. speed input: 44121.67 toks/s, output: 43.09 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [00:23<00:26, 39.19it/s, est. speed input: 44051.72 toks/s, output: 43.02 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [00:23<00:26, 39.19it/s, est. speed input: 43984.93 toks/s, output: 42.95 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [00:24<00:25, 39.20it/s, est. speed input: 43920.54 toks/s, output: 42.89 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [00:24<00:25, 39.19it/s, est. speed input: 43857.79 toks/s, output: 42.83 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [00:25<00:24, 39.20it/s, est. speed input: 43797.48 toks/s, output: 42.77 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [00:25<00:24, 39.19it/s, est. speed input: 43738.33 toks/s, output: 42.71 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [00:25<00:24, 39.19it/s, est. speed input: 43681.77 toks/s, output: 42.66 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [00:26<00:23, 39.20it/s, est. speed input: 43627.05 toks/s, output: 42.60 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [00:26<00:23, 39.18it/s, est. speed input: 43573.17 toks/s, output: 42.55 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [00:27<00:22, 39.78it/s, est. speed input: 43554.09 toks/s, output: 42.53 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [00:27<00:22, 39.60it/s, est. speed input: 43503.07 toks/s, output: 42.48 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [00:27<00:21, 39.47it/s, est. speed input: 43453.64 toks/s, output: 42.44 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [00:28<00:21, 39.39it/s, est. speed input: 43405.87 toks/s, output: 42.39 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [00:28<00:21, 39.32it/s, est. speed input: 43359.05 toks/s, output: 42.34 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [00:29<00:20, 39.29it/s, est. speed input: 43314.26 toks/s, output: 42.30 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [00:29<00:20, 39.25it/s, est. speed input: 43269.80 toks/s, output: 42.26 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [00:29<00:19, 39.25it/s, est. speed input: 43227.73 toks/s, output: 42.21 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [00:30<00:19, 39.22it/s, est. speed input: 43185.55 toks/s, output: 42.17 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [00:30<00:19, 39.20it/s, est. speed input: 43144.61 toks/s, output: 42.13 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [00:31<00:18, 39.20it/s, est. speed input: 43105.48 toks/s, output: 42.10 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [00:31<00:18, 39.19it/s, est. speed input: 43066.55 toks/s, output: 42.06 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [00:32<00:17, 39.19it/s, est. speed input: 43029.31 toks/s, output: 42.02 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [00:32<00:17, 39.19it/s, est. speed input: 42992.55 toks/s, output: 41.98 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [00:32<00:17, 39.19it/s, est. speed input: 42957.14 toks/s, output: 41.95 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [00:33<00:16, 39.19it/s, est. speed input: 42922.42 toks/s, output: 41.92 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [00:33<00:16, 39.19it/s, est. speed input: 42888.69 toks/s, output: 41.88 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [00:34<00:15, 39.19it/s, est. speed input: 42855.54 toks/s, output: 41.85 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [00:34<00:15, 39.19it/s, est. speed input: 42823.27 toks/s, output: 41.82 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [00:34<00:15, 39.19it/s, est. speed input: 42791.86 toks/s, output: 41.79 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [00:35<00:14, 39.20it/s, est. speed input: 42761.24 toks/s, output: 41.76 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [00:35<00:14, 39.20it/s, est. speed input: 42731.28 toks/s, output: 41.73 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [00:36<00:13, 39.20it/s, est. speed input: 42702.22 toks/s, output: 41.70 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [00:36<00:13, 39.19it/s, est. speed input: 42673.06 toks/s, output: 41.67 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [00:36<00:13, 39.19it/s, est. speed input: 42645.00 toks/s, output: 41.65 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [00:37<00:12, 39.18it/s, est. speed input: 42617.29 toks/s, output: 41.62 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [00:37<00:12, 39.18it/s, est. speed input: 42590.19 toks/s, output: 41.59 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [00:38<00:11, 39.18it/s, est. speed input: 42563.60 toks/s, output: 41.57 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [00:38<00:11, 39.18it/s, est. speed input: 42537.70 toks/s, output: 41.54 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [00:38<00:10, 39.18it/s, est. speed input: 42512.57 toks/s, output: 41.52 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [00:39<00:10, 39.18it/s, est. speed input: 42487.65 toks/s, output: 41.49 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [00:39<00:10, 39.17it/s, est. speed input: 42463.11 toks/s, output: 41.47 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [00:40<00:09, 39.18it/s, est. speed input: 42439.55 toks/s, output: 41.44 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [00:40<00:09, 39.18it/s, est. speed input: 42416.24 toks/s, output: 41.42 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [00:41<00:08, 39.18it/s, est. speed input: 42393.47 toks/s, output: 41.40 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [00:41<00:08, 39.18it/s, est. speed input: 42370.95 toks/s, output: 41.38 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [00:41<00:08, 39.19it/s, est. speed input: 42349.27 toks/s, output: 41.36 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [00:42<00:07, 39.19it/s, est. speed input: 42328.04 toks/s, output: 41.34 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [00:42<00:07, 39.19it/s, est. speed input: 42306.73 toks/s, output: 41.32 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [00:43<00:06, 39.18it/s, est. speed input: 42285.85 toks/s, output: 41.29 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [00:43<00:06, 39.17it/s, est. speed input: 42265.33 toks/s, output: 41.27 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [00:43<00:06, 39.18it/s, est. speed input: 42245.46 toks/s, output: 41.26 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [00:44<00:05, 39.18it/s, est. speed input: 42226.02 toks/s, output: 41.24 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [00:44<00:05, 39.18it/s, est. speed input: 42206.69 toks/s, output: 41.22 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [00:45<00:04, 39.18it/s, est. speed input: 42187.71 toks/s, output: 41.20 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [00:45<00:04, 39.89it/s, est. speed input: 42191.70 toks/s, output: 41.20 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [00:45<00:03, 39.67it/s, est. speed input: 42173.07 toks/s, output: 41.18 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [00:46<00:03, 39.52it/s, est. speed input: 42155.05 toks/s, output: 41.17 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [00:46<00:03, 39.41it/s, est. speed input: 42137.09 toks/s, output: 41.15 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [00:47<00:02, 39.34it/s, est. speed input: 42119.54 toks/s, output: 41.13 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [00:47<00:02, 39.29it/s, est. speed input: 42102.17 toks/s, output: 41.12 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [00:47<00:01, 39.26it/s, est. speed input: 42085.48 toks/s, output: 41.10 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [00:48<00:01, 39.24it/s, est. speed input: 42068.90 toks/s, output: 41.08 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [00:48<00:01, 39.21it/s, est. speed input: 42052.34 toks/s, output: 41.07 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [00:49<00:00, 39.20it/s, est. speed input: 42036.18 toks/s, output: 41.05 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [00:49<00:00, 39.88it/s, est. speed input: 42040.17 toks/s, output: 41.05 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:49<00:00, 39.88it/s, est. speed input: 42329.23 toks/s, output: 41.34 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:49<00:00, 41.34it/s, est. speed input: 42329.23 toks/s, output: 41.34 toks/s]
[rank0]:[W128 00:54:25.483542667 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 79.9s

测试结果:
  Requests/s:   39.18
  Tokens/s:     40158.33
  Total Reqs:   2048
  Elapsed:      52.27s

  [Prefill 分析]
  Total Prefill Tokens: 2097152
  Prefill Tokens/s:     40119.15

============================================================
[7/7] 测试 M=32768
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 32768
│   M_prefill     = 32768 (= 32 x 1024)
│   M_decode      = 32
│   batched_tokens = 32768 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 4096
│   --max-num-seqs           = 32
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 32768
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:54:41 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3512270) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3512270) WARNING 01-28 00:54:51 [backends.py:609] Failed to read file <frozen os>
Throughput: 39.16 requests/s, 40134.80 total tokens/s, 39.16 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096


─── STDERR ───
[2026-01-28 00:54:41] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:54:41] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:54:41] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:54:41] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:54:41] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:54:41] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:54:41] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:54:41] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:54:41] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:54:41] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:54:41] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:54:41] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:54:41] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:54:41] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:54:45] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:54:45] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:54:45] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:54:45] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:54:45] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:54:45] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:54:45] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:54:45] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:54:45] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:54:45] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:54:45] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:54:45] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:54:45] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:54:45] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3512270) [2026-01-28 00:54:46] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3512270) [2026-01-28 00:54:46] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3512270) [2026-01-28 00:54:46] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3512270) [2026-01-28 00:54:46] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=3512270) [2026-01-28 00:54:46] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3512270) [2026-01-28 00:54:46] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3512270) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3512270) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.01it/s]
(EngineCore_DP0 pid=3512270) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.00it/s]
(EngineCore_DP0 pid=3512270) 
(EngineCore_DP0 pid=3512270) [2026-01-28 00:54:47] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 3424] -> 1D uint8
(EngineCore_DP0 pid=3512270) [2026-01-28 00:54:47] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 8232960 bytes
(EngineCore_DP0 pid=3512270) [2026-01-28 00:54:47] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 3424] -> 1D uint8
(EngineCore_DP0 pid=3512270) [2026-01-28 00:54:47] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 5488640 bytes
(EngineCore_DP0 pid=3512270) [2026-01-28 00:54:47] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 3424] -> 1D uint8
(EngineCore_DP0 pid=3512270) [2026-01-28 00:54:47] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 29638656 bytes
(EngineCore_DP0 pid=3512270) [2026-01-28 00:54:47] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 9216] -> 1D uint8
(EngineCore_DP0 pid=3512270) [2026-01-28 00:54:47] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 14745600 bytes
(EngineCore_DP0 pid=3512270) [rank0]:W0128 00:54:53.985000 3512270 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=3512270) [rank0]:W0128 00:54:54.035000 3512270 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=3512270) [rank0]:W0128 00:54:54.772000 3512270 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=3512270) [rank0]:W0128 00:54:54.848000 3512270 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=3512270) 2026-01-28 00:54:57,271 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3512270) 2026-01-28 00:54:57,297 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3512270) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   9%|▉         | 1/11 [00:00<00:05,  1.81it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  36%|███▋      | 4/11 [00:00<00:00,  7.33it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  64%|██████▎   | 7/11 [00:00<00:00, 11.83it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  91%|█████████ | 10/11 [00:00<00:00, 15.92it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:00<00:00, 11.65it/s]
(EngineCore_DP0 pid=3512270) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  14%|█▍        | 1/7 [00:00<00:00,  7.06it/s]
Capturing CUDA graphs (decode, FULL):  57%|█████▋    | 4/7 [00:00<00:00, 17.76it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00, 22.61it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00, 19.87it/s]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 72/4096 [00:00<00:05, 716.12it/s]
Adding requests:   4%|▎         | 148/4096 [00:00<00:05, 736.69it/s]
Adding requests:   5%|▌         | 225/4096 [00:00<00:05, 747.79it/s]
Adding requests:   7%|▋         | 300/4096 [00:00<00:05, 735.90it/s]
Adding requests:   9%|▉         | 375/4096 [00:00<00:05, 738.32it/s]
Adding requests:  11%|█         | 451/4096 [00:00<00:04, 743.56it/s]
Adding requests:  13%|█▎        | 526/4096 [00:00<00:04, 735.55it/s]
Adding requests:  15%|█▍        | 602/4096 [00:00<00:04, 740.64it/s]
Adding requests:  17%|█▋        | 679/4096 [00:00<00:04, 747.97it/s]
Adding requests:  18%|█▊        | 754/4096 [00:01<00:04, 747.22it/s]
Adding requests:  20%|██        | 829/4096 [00:01<00:04, 736.87it/s]
Adding requests:  22%|██▏       | 907/4096 [00:01<00:04, 748.79it/s]
Adding requests:  24%|██▍       | 985/4096 [00:01<00:04, 757.24it/s]
Adding requests:  26%|██▌       | 1064/4096 [00:01<00:03, 765.86it/s]
Adding requests:  28%|██▊       | 1141/4096 [00:01<00:03, 741.91it/s]
Adding requests:  30%|██▉       | 1219/4096 [00:01<00:03, 752.92it/s]
Adding requests:  32%|███▏      | 1295/4096 [00:01<00:03, 747.70it/s]
Adding requests:  33%|███▎      | 1370/4096 [00:01<00:03, 747.00it/s]
Adding requests:  35%|███▌      | 1446/4096 [00:01<00:03, 750.11it/s]
Adding requests:  37%|███▋      | 1526/4096 [00:02<00:03, 763.78it/s]
Adding requests:  39%|███▉      | 1605/4096 [00:02<00:03, 771.19it/s]
Adding requests:  41%|████      | 1683/4096 [00:02<00:03, 762.90it/s]
Adding requests:  43%|████▎     | 1761/4096 [00:02<00:03, 766.63it/s]
Adding requests:  45%|████▍     | 1839/4096 [00:02<00:02, 768.22it/s]
Adding requests:  47%|████▋     | 1916/4096 [00:02<00:02, 761.04it/s]
Adding requests:  49%|████▊     | 1994/4096 [00:02<00:02, 764.36it/s]
Adding requests:  51%|█████     | 2075/4096 [00:02<00:02, 775.89it/s]
Adding requests:  53%|█████▎    | 2153/4096 [00:02<00:02, 761.17it/s]
Adding requests:  54%|█████▍    | 2230/4096 [00:02<00:02, 762.16it/s]
Adding requests:  56%|█████▋    | 2310/4096 [00:03<00:02, 770.52it/s]
Adding requests:  58%|█████▊    | 2388/4096 [00:03<00:02, 754.57it/s]
Adding requests:  60%|██████    | 2465/4096 [00:03<00:02, 757.08it/s]
Adding requests:  62%|██████▏   | 2541/4096 [00:03<00:02, 754.50it/s]
Adding requests:  64%|██████▍   | 2618/4096 [00:03<00:01, 758.42it/s]
Adding requests:  66%|██████▌   | 2695/4096 [00:03<00:01, 760.20it/s]
Adding requests:  68%|██████▊   | 2772/4096 [00:03<00:01, 756.40it/s]
Adding requests:  70%|██████▉   | 2848/4096 [00:03<00:01, 750.44it/s]
Adding requests:  71%|███████▏  | 2924/4096 [00:03<00:01, 744.11it/s]
Adding requests:  73%|███████▎  | 2999/4096 [00:03<00:01, 737.05it/s]
Adding requests:  75%|███████▌  | 3075/4096 [00:04<00:01, 742.54it/s]
Adding requests:  77%|███████▋  | 3152/4096 [00:04<00:01, 749.62it/s]
Adding requests:  79%|███████▉  | 3230/4096 [00:04<00:01, 757.18it/s]
Adding requests:  81%|████████  | 3308/4096 [00:04<00:01, 763.57it/s]
Adding requests:  83%|████████▎ | 3387/4096 [00:04<00:00, 768.33it/s]
Adding requests:  85%|████████▍ | 3464/4096 [00:04<00:00, 756.42it/s]
Adding requests:  86%|████████▋ | 3542/4096 [00:04<00:00, 761.40it/s]
Adding requests:  88%|████████▊ | 3619/4096 [00:04<00:00, 761.76it/s]
Adding requests:  90%|█████████ | 3696/4096 [00:04<00:00, 750.46it/s]
Adding requests:  92%|█████████▏| 3775/4096 [00:05<00:00, 761.02it/s]
Adding requests:  94%|█████████▍| 3854/4096 [00:05<00:00, 768.95it/s]
Adding requests:  96%|█████████▌| 3932/4096 [00:05<00:00, 771.12it/s]
Adding requests:  98%|█████████▊| 4012/4096 [00:05<00:00, 779.18it/s]
Adding requests: 100%|█████████▉| 4090/4096 [00:05<00:00, 772.49it/s]
Adding requests: 100%|██████████| 4096/4096 [00:05<00:00, 756.49it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▍         | 194/4096 [00:00<00:07, 518.97it/s, est. speed input: 531446.19 toks/s, output: 518.98 toks/s]
Processed prompts:   6%|▌         | 246/4096 [00:01<00:22, 174.34it/s, est. speed input: 211800.21 toks/s, output: 206.84 toks/s]
Processed prompts:   7%|▋         | 272/4096 [00:02<00:38, 100.33it/s, est. speed input: 138935.30 toks/s, output: 135.68 toks/s]
Processed prompts:   7%|▋         | 290/4096 [00:02<00:56, 66.99it/s, est. speed input: 105293.63 toks/s, output: 102.83 toks/s] 
Processed prompts:   8%|▊         | 322/4096 [00:03<01:06, 56.48it/s, est. speed input: 90682.42 toks/s, output: 88.56 toks/s]  
Processed prompts:   9%|▊         | 354/4096 [00:04<01:14, 50.42it/s, est. speed input: 81418.21 toks/s, output: 79.51 toks/s]
Processed prompts:   9%|▉         | 386/4096 [00:05<01:19, 46.68it/s, est. speed input: 75031.52 toks/s, output: 73.27 toks/s]
Processed prompts:  10%|█         | 418/4096 [00:06<01:23, 44.27it/s, est. speed input: 70353.04 toks/s, output: 68.70 toks/s]
Processed prompts:  11%|█         | 450/4096 [00:06<01:25, 42.67it/s, est. speed input: 66777.35 toks/s, output: 65.21 toks/s]
Processed prompts:  12%|█▏        | 482/4096 [00:07<01:26, 41.58it/s, est. speed input: 63957.82 toks/s, output: 62.46 toks/s]
Processed prompts:  13%|█▎        | 514/4096 [00:08<01:27, 40.85it/s, est. speed input: 61676.80 toks/s, output: 60.23 toks/s]
Processed prompts:  13%|█▎        | 546/4096 [00:09<01:28, 40.34it/s, est. speed input: 59795.19 toks/s, output: 58.39 toks/s]
Processed prompts:  14%|█▍        | 578/4096 [00:10<01:27, 39.99it/s, est. speed input: 58215.69 toks/s, output: 56.85 toks/s]
Processed prompts:  15%|█▍        | 610/4096 [00:10<01:27, 39.74it/s, est. speed input: 56870.05 toks/s, output: 55.54 toks/s]
Processed prompts:  16%|█▌        | 642/4096 [00:11<01:27, 39.58it/s, est. speed input: 55711.73 toks/s, output: 54.41 toks/s]
Processed prompts:  16%|█▋        | 674/4096 [00:12<01:26, 39.46it/s, est. speed input: 54702.45 toks/s, output: 53.42 toks/s]
Processed prompts:  17%|█▋        | 706/4096 [00:13<01:26, 39.37it/s, est. speed input: 53815.20 toks/s, output: 52.55 toks/s]
Processed prompts:  18%|█▊        | 738/4096 [00:14<01:25, 39.32it/s, est. speed input: 53030.96 toks/s, output: 51.79 toks/s]
Processed prompts:  19%|█▉        | 770/4096 [00:15<01:24, 39.28it/s, est. speed input: 52331.02 toks/s, output: 51.10 toks/s]
Processed prompts:  20%|█▉        | 802/4096 [00:15<01:23, 39.24it/s, est. speed input: 51702.45 toks/s, output: 50.49 toks/s]
Processed prompts:  20%|██        | 834/4096 [00:16<01:23, 39.22it/s, est. speed input: 51135.40 toks/s, output: 49.94 toks/s]
Processed prompts:  21%|██        | 866/4096 [00:17<01:22, 39.21it/s, est. speed input: 50622.09 toks/s, output: 49.44 toks/s]
Processed prompts:  22%|██▏       | 898/4096 [00:18<01:21, 39.20it/s, est. speed input: 50154.53 toks/s, output: 48.98 toks/s]
Processed prompts:  23%|██▎       | 930/4096 [00:19<01:20, 39.20it/s, est. speed input: 49726.61 toks/s, output: 48.56 toks/s]
Processed prompts:  23%|██▎       | 962/4096 [00:19<01:19, 39.19it/s, est. speed input: 49333.48 toks/s, output: 48.18 toks/s]
Processed prompts:  24%|██▍       | 994/4096 [00:20<01:19, 39.19it/s, est. speed input: 48971.29 toks/s, output: 47.82 toks/s]
Processed prompts:  25%|██▌       | 1026/4096 [00:21<01:18, 39.18it/s, est. speed input: 48636.55 toks/s, output: 47.50 toks/s]
Processed prompts:  26%|██▌       | 1058/4096 [00:22<01:17, 39.18it/s, est. speed input: 48326.19 toks/s, output: 47.19 toks/s]
Processed prompts:  27%|██▋       | 1090/4096 [00:23<01:16, 39.18it/s, est. speed input: 48037.86 toks/s, output: 46.91 toks/s]
Processed prompts:  27%|██▋       | 1122/4096 [00:24<01:15, 39.14it/s, est. speed input: 47763.53 toks/s, output: 46.64 toks/s]
Processed prompts:  28%|██▊       | 1154/4096 [00:24<01:14, 39.35it/s, est. speed input: 47538.66 toks/s, output: 46.42 toks/s]
Processed prompts:  29%|██▉       | 1186/4096 [00:25<01:14, 39.30it/s, est. speed input: 47303.23 toks/s, output: 46.19 toks/s]
Processed prompts:  30%|██▉       | 1218/4096 [00:26<01:13, 39.26it/s, est. speed input: 47080.43 toks/s, output: 45.98 toks/s]
Processed prompts:  31%|███       | 1250/4096 [00:27<01:12, 39.23it/s, est. speed input: 46872.17 toks/s, output: 45.77 toks/s]
Processed prompts:  31%|███▏      | 1282/4096 [00:28<01:11, 39.21it/s, est. speed input: 46674.93 toks/s, output: 45.58 toks/s]
Processed prompts:  32%|███▏      | 1314/4096 [00:28<01:10, 39.19it/s, est. speed input: 46489.50 toks/s, output: 45.40 toks/s]
Processed prompts:  33%|███▎      | 1346/4096 [00:29<01:10, 39.19it/s, est. speed input: 46314.56 toks/s, output: 45.23 toks/s]
Processed prompts:  34%|███▎      | 1378/4096 [00:30<01:09, 39.18it/s, est. speed input: 46148.42 toks/s, output: 45.07 toks/s]
Processed prompts:  34%|███▍      | 1410/4096 [00:31<01:08, 39.18it/s, est. speed input: 45991.54 toks/s, output: 44.91 toks/s]
Processed prompts:  35%|███▌      | 1442/4096 [00:32<01:07, 39.18it/s, est. speed input: 45842.50 toks/s, output: 44.77 toks/s]
Processed prompts:  36%|███▌      | 1474/4096 [00:33<01:06, 39.17it/s, est. speed input: 45700.55 toks/s, output: 44.63 toks/s]
Processed prompts:  37%|███▋      | 1506/4096 [00:33<01:06, 39.18it/s, est. speed input: 45566.23 toks/s, output: 44.50 toks/s]
Processed prompts:  38%|███▊      | 1538/4096 [00:34<01:05, 39.17it/s, est. speed input: 45437.23 toks/s, output: 44.37 toks/s]
Processed prompts:  38%|███▊      | 1570/4096 [00:35<01:04, 39.17it/s, est. speed input: 45314.18 toks/s, output: 44.25 toks/s]
Processed prompts:  39%|███▉      | 1602/4096 [00:36<01:03, 39.17it/s, est. speed input: 45197.31 toks/s, output: 44.14 toks/s]
Processed prompts:  40%|███▉      | 1634/4096 [00:37<01:02, 39.17it/s, est. speed input: 45085.23 toks/s, output: 44.03 toks/s]
Processed prompts:  41%|████      | 1666/4096 [00:37<01:02, 39.17it/s, est. speed input: 44978.15 toks/s, output: 43.92 toks/s]
Processed prompts:  41%|████▏     | 1698/4096 [00:38<01:01, 39.16it/s, est. speed input: 44875.05 toks/s, output: 43.82 toks/s]
Processed prompts:  42%|████▏     | 1730/4096 [00:39<01:00, 39.17it/s, est. speed input: 44776.87 toks/s, output: 43.73 toks/s]
Processed prompts:  43%|████▎     | 1762/4096 [00:40<00:59, 39.17it/s, est. speed input: 44682.49 toks/s, output: 43.64 toks/s]
Processed prompts:  44%|████▍     | 1794/4096 [00:41<00:58, 39.17it/s, est. speed input: 44591.55 toks/s, output: 43.55 toks/s]
Processed prompts:  45%|████▍     | 1826/4096 [00:42<00:57, 39.16it/s, est. speed input: 44503.98 toks/s, output: 43.46 toks/s]
Processed prompts:  45%|████▌     | 1858/4096 [00:42<00:56, 39.49it/s, est. speed input: 44443.26 toks/s, output: 43.40 toks/s]
Processed prompts:  46%|████▌     | 1890/4096 [00:43<00:56, 39.39it/s, est. speed input: 44361.81 toks/s, output: 43.32 toks/s]
Processed prompts:  47%|████▋     | 1922/4096 [00:44<00:55, 39.32it/s, est. speed input: 44283.55 toks/s, output: 43.25 toks/s]
Processed prompts:  48%|████▊     | 1954/4096 [00:45<00:54, 39.28it/s, est. speed input: 44208.41 toks/s, output: 43.17 toks/s]
Processed prompts:  48%|████▊     | 1986/4096 [00:46<00:53, 39.24it/s, est. speed input: 44135.16 toks/s, output: 43.10 toks/s]
Processed prompts:  49%|████▉     | 2018/4096 [00:46<00:53, 39.21it/s, est. speed input: 44064.33 toks/s, output: 43.03 toks/s]
Processed prompts:  50%|█████     | 2050/4096 [00:47<00:52, 39.20it/s, est. speed input: 43996.75 toks/s, output: 42.97 toks/s]
Processed prompts:  51%|█████     | 2082/4096 [00:48<00:51, 39.18it/s, est. speed input: 43930.54 toks/s, output: 42.90 toks/s]
Processed prompts:  52%|█████▏    | 2114/4096 [00:49<00:50, 39.17it/s, est. speed input: 43867.11 toks/s, output: 42.84 toks/s]
Processed prompts:  52%|█████▏    | 2146/4096 [00:50<00:49, 39.16it/s, est. speed input: 43805.46 toks/s, output: 42.78 toks/s]
Processed prompts:  53%|█████▎    | 2178/4096 [00:50<00:48, 39.16it/s, est. speed input: 43745.67 toks/s, output: 42.72 toks/s]
Processed prompts:  54%|█████▍    | 2210/4096 [00:51<00:48, 39.15it/s, est. speed input: 43688.00 toks/s, output: 42.66 toks/s]
Processed prompts:  55%|█████▍    | 2242/4096 [00:52<00:47, 39.15it/s, est. speed input: 43631.91 toks/s, output: 42.61 toks/s]
Processed prompts:  56%|█████▌    | 2274/4096 [00:53<00:46, 39.14it/s, est. speed input: 43577.34 toks/s, output: 42.56 toks/s]
Processed prompts:  56%|█████▋    | 2306/4096 [00:54<00:45, 39.15it/s, est. speed input: 43524.90 toks/s, output: 42.50 toks/s]
Processed prompts:  57%|█████▋    | 2338/4096 [00:55<00:44, 39.15it/s, est. speed input: 43473.81 toks/s, output: 42.45 toks/s]
Processed prompts:  58%|█████▊    | 2370/4096 [00:55<00:44, 39.14it/s, est. speed input: 43423.80 toks/s, output: 42.41 toks/s]
Processed prompts:  59%|█████▊    | 2402/4096 [00:56<00:43, 39.14it/s, est. speed input: 43375.59 toks/s, output: 42.36 toks/s]
Processed prompts:  59%|█████▉    | 2434/4096 [00:57<00:42, 39.13it/s, est. speed input: 43328.27 toks/s, output: 42.31 toks/s]
Processed prompts:  60%|██████    | 2466/4096 [00:58<00:41, 39.14it/s, est. speed input: 43282.84 toks/s, output: 42.27 toks/s]
Processed prompts:  61%|██████    | 2498/4096 [00:59<00:40, 39.46it/s, est. speed input: 43254.78 toks/s, output: 42.24 toks/s]
Processed prompts:  62%|██████▏   | 2530/4096 [00:59<00:39, 39.36it/s, est. speed input: 43211.28 toks/s, output: 42.20 toks/s]
Processed prompts:  63%|██████▎   | 2562/4096 [01:00<00:39, 39.28it/s, est. speed input: 43168.67 toks/s, output: 42.16 toks/s]
Processed prompts:  63%|██████▎   | 2594/4096 [01:01<00:38, 39.23it/s, est. speed input: 43127.31 toks/s, output: 42.12 toks/s]
Processed prompts:  64%|██████▍   | 2626/4096 [01:02<00:37, 39.20it/s, est. speed input: 43087.12 toks/s, output: 42.08 toks/s]
Processed prompts:  65%|██████▍   | 2658/4096 [01:03<00:36, 39.18it/s, est. speed input: 43048.08 toks/s, output: 42.04 toks/s]
Processed prompts:  66%|██████▌   | 2690/4096 [01:04<00:35, 39.16it/s, est. speed input: 43009.67 toks/s, output: 42.00 toks/s]
Processed prompts:  66%|██████▋   | 2722/4096 [01:04<00:35, 39.14it/s, est. speed input: 42972.19 toks/s, output: 41.97 toks/s]
Processed prompts:  67%|██████▋   | 2754/4096 [01:05<00:34, 39.14it/s, est. speed input: 42935.99 toks/s, output: 41.93 toks/s]
Processed prompts:  68%|██████▊   | 2786/4096 [01:06<00:33, 39.13it/s, est. speed input: 42900.71 toks/s, output: 41.90 toks/s]
Processed prompts:  69%|██████▉   | 2818/4096 [01:07<00:32, 39.13it/s, est. speed input: 42866.24 toks/s, output: 41.86 toks/s]
Processed prompts:  70%|██████▉   | 2850/4096 [01:08<00:31, 39.12it/s, est. speed input: 42832.28 toks/s, output: 41.83 toks/s]
Processed prompts:  70%|███████   | 2882/4096 [01:08<00:31, 39.12it/s, est. speed input: 42799.34 toks/s, output: 41.80 toks/s]
Processed prompts:  71%|███████   | 2914/4096 [01:09<00:30, 39.12it/s, est. speed input: 42767.07 toks/s, output: 41.76 toks/s]
Processed prompts:  72%|███████▏  | 2946/4096 [01:10<00:29, 39.12it/s, est. speed input: 42735.61 toks/s, output: 41.73 toks/s]
Processed prompts:  73%|███████▎  | 2978/4096 [01:11<00:28, 39.11it/s, est. speed input: 42704.60 toks/s, output: 41.70 toks/s]
Processed prompts:  73%|███████▎  | 3010/4096 [01:12<00:27, 39.11it/s, est. speed input: 42674.68 toks/s, output: 41.67 toks/s]
Processed prompts:  74%|███████▍  | 3042/4096 [01:13<00:26, 39.12it/s, est. speed input: 42645.41 toks/s, output: 41.65 toks/s]
Processed prompts:  75%|███████▌  | 3074/4096 [01:13<00:26, 39.11it/s, est. speed input: 42616.49 toks/s, output: 41.62 toks/s]
Processed prompts:  76%|███████▌  | 3106/4096 [01:14<00:25, 39.11it/s, est. speed input: 42588.28 toks/s, output: 41.59 toks/s]
Processed prompts:  77%|███████▋  | 3138/4096 [01:15<00:24, 39.11it/s, est. speed input: 42560.71 toks/s, output: 41.56 toks/s]
Processed prompts:  77%|███████▋  | 3170/4096 [01:16<00:23, 39.11it/s, est. speed input: 42533.79 toks/s, output: 41.54 toks/s]
Processed prompts:  78%|███████▊  | 3202/4096 [01:17<00:22, 39.11it/s, est. speed input: 42507.57 toks/s, output: 41.51 toks/s]
Processed prompts:  79%|███████▉  | 3234/4096 [01:17<00:22, 39.10it/s, est. speed input: 42481.20 toks/s, output: 41.49 toks/s]
Processed prompts:  80%|███████▉  | 3266/4096 [01:18<00:21, 39.10it/s, est. speed input: 42455.88 toks/s, output: 41.46 toks/s]
Processed prompts:  81%|████████  | 3298/4096 [01:19<00:20, 39.10it/s, est. speed input: 42430.99 toks/s, output: 41.44 toks/s]
Processed prompts:  81%|████████▏ | 3330/4096 [01:20<00:19, 39.10it/s, est. speed input: 42406.63 toks/s, output: 41.41 toks/s]
Processed prompts:  82%|████████▏ | 3362/4096 [01:21<00:18, 39.11it/s, est. speed input: 42382.99 toks/s, output: 41.39 toks/s]
Processed prompts:  83%|████████▎ | 3394/4096 [01:22<00:17, 39.10it/s, est. speed input: 42359.51 toks/s, output: 41.37 toks/s]
Processed prompts:  84%|████████▎ | 3426/4096 [01:22<00:17, 39.09it/s, est. speed input: 42336.18 toks/s, output: 41.34 toks/s]
Processed prompts:  84%|████████▍ | 3458/4096 [01:23<00:16, 39.09it/s, est. speed input: 42313.73 toks/s, output: 41.32 toks/s]
Processed prompts:  85%|████████▌ | 3490/4096 [01:24<00:15, 39.10it/s, est. speed input: 42291.69 toks/s, output: 41.30 toks/s]
Processed prompts:  86%|████████▌ | 3522/4096 [01:25<00:14, 39.10it/s, est. speed input: 42270.09 toks/s, output: 41.28 toks/s]
Processed prompts:  87%|████████▋ | 3554/4096 [01:26<00:13, 39.10it/s, est. speed input: 42248.79 toks/s, output: 41.26 toks/s]
Processed prompts:  88%|████████▊ | 3586/4096 [01:26<00:13, 39.10it/s, est. speed input: 42227.95 toks/s, output: 41.24 toks/s]
Processed prompts:  88%|████████▊ | 3618/4096 [01:27<00:12, 39.09it/s, est. speed input: 42207.30 toks/s, output: 41.22 toks/s]
Processed prompts:  89%|████████▉ | 3650/4096 [01:28<00:11, 39.09it/s, est. speed input: 42187.14 toks/s, output: 41.20 toks/s]
Processed prompts:  90%|████████▉ | 3682/4096 [01:29<00:10, 39.09it/s, est. speed input: 42167.28 toks/s, output: 41.18 toks/s]
Processed prompts:  91%|█████████ | 3714/4096 [01:30<00:09, 39.10it/s, est. speed input: 42148.18 toks/s, output: 41.16 toks/s]
Processed prompts:  91%|█████████▏| 3746/4096 [01:31<00:08, 39.09it/s, est. speed input: 42129.10 toks/s, output: 41.14 toks/s]
Processed prompts:  92%|█████████▏| 3778/4096 [01:31<00:08, 39.09it/s, est. speed input: 42110.36 toks/s, output: 41.12 toks/s]
Processed prompts:  93%|█████████▎| 3810/4096 [01:32<00:07, 39.09it/s, est. speed input: 42091.81 toks/s, output: 41.11 toks/s]
Processed prompts:  94%|█████████▍| 3842/4096 [01:33<00:06, 39.08it/s, est. speed input: 42073.55 toks/s, output: 41.09 toks/s]
Processed prompts:  95%|█████████▍| 3874/4096 [01:34<00:05, 39.09it/s, est. speed input: 42055.84 toks/s, output: 41.07 toks/s]
Processed prompts:  95%|█████████▌| 3906/4096 [01:35<00:04, 39.08it/s, est. speed input: 42038.11 toks/s, output: 41.05 toks/s]
Processed prompts:  96%|█████████▌| 3938/4096 [01:35<00:04, 39.08it/s, est. speed input: 42020.98 toks/s, output: 41.04 toks/s]
Processed prompts:  97%|█████████▋| 3970/4096 [01:36<00:03, 39.09it/s, est. speed input: 42004.17 toks/s, output: 41.02 toks/s]
Processed prompts:  98%|█████████▊| 4002/4096 [01:37<00:02, 39.08it/s, est. speed input: 41987.36 toks/s, output: 41.00 toks/s]
Processed prompts:  98%|█████████▊| 4034/4096 [01:38<00:01, 39.41it/s, est. speed input: 41980.76 toks/s, output: 41.00 toks/s]
Processed prompts:  99%|█████████▉| 4066/4096 [01:39<00:00, 39.68it/s, est. speed input: 41975.22 toks/s, output: 40.99 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [01:39<00:00, 39.68it/s, est. speed input: 42284.81 toks/s, output: 41.29 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [01:39<00:00, 41.29it/s, est. speed input: 42284.81 toks/s, output: 41.29 toks/s]
[rank0]:[W128 00:56:44.174415436 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 138.7s

测试结果:
  Requests/s:   39.16
  Tokens/s:     40134.80
  Total Reqs:   4096
  Elapsed:      104.61s

  [Prefill 分析]
  Total Prefill Tokens: 4194304
  Prefill Tokens/s:     40095.64


------------------------------------------------------------
  生成 CSV: BitNet-2B-FP8
------------------------------------------------------------
[SUCCESS] CSV 保存到: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX5080_cc120_FP8E4M3_py312_cu129_x86_64/cusparselt/2_6/BitNet-2B-FP8_prefill.csv

预览:
------------------------------------------------------------
M_prefill,prompt_len,max_num_seqs,num_prompts,N_prefill,requests_per_s,tokens_per_s,elapsed_time_s
512,512,1,128,128,56.1259,28792.5760,2.2806
1024,1024,1,128,128,38.2144,39169.7975,3.3495
2048,1024,2,256,128,41.9968,43046.6792,6.0957
4096,1024,4,512,128,41.6735,42715.3292,12.2860
8192,1024,8,1024,128,39.8882,40885.4049,25.6718
16384,1024,16,2048,128,39.1789,40158.3331,52.2731
32768,1024,32,4096,128,39.1559,40134.7954,104.6075

------------------------------------------------------------

[INFO] 完成: 7 成功, 0 失败

============================================================
  BitNet-2B-FP8 | cuSPARSELt (2_8) | prefill
============================================================

[INFO] Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-FP8-SlideSparse-2_8
[INFO] Output: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX5080_cc120_FP8E4M3_py312_cu129_x86_64/cusparselt/2_8

============================================================
[1/7] 测试 M=512
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 512
│   M_prefill     = 512 (= 1 x 512)
│   M_decode      = 1
│   batched_tokens = 513 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 512
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 513
│   --max-num-batched-tokens = 513
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:56:49 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3514304) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3514304) WARNING 01-28 00:56:59 [backends.py:609] Failed to read file <frozen os>
Throughput: 56.59 requests/s, 29032.48 total tokens/s, 56.59 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128


─── STDERR ───
[2026-01-28 00:56:49] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:56:49] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:56:49] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:56:49] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:56:49] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:56:49] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:56:49] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:56:49] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:56:49] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:56:49] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:56:49] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:56:49] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:56:49] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:56:49] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:56:53] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:56:53] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:56:53] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:56:53] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:56:53] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:56:53] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:56:53] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:56:53] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:56:53] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:56:53] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:56:53] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:56:53] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:56:53] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:56:53] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3514304) [2026-01-28 00:56:53] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3514304) [2026-01-28 00:56:53] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3514304) [2026-01-28 00:56:53] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3514304) [2026-01-28 00:56:53] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=3514304) [2026-01-28 00:56:53] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3514304) [2026-01-28 00:56:53] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3514304) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3514304) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.44it/s]
(EngineCore_DP0 pid=3514304) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.44it/s]
(EngineCore_DP0 pid=3514304) 
(EngineCore_DP0 pid=3514304) [2026-01-28 00:56:55] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 3840] -> 1D uint8
(EngineCore_DP0 pid=3514304) [2026-01-28 00:56:55] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 9216000 bytes
(EngineCore_DP0 pid=3514304) [2026-01-28 00:56:55] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 3840] -> 1D uint8
(EngineCore_DP0 pid=3514304) [2026-01-28 00:56:55] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 6144000 bytes
(EngineCore_DP0 pid=3514304) [2026-01-28 00:56:55] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 3840] -> 1D uint8
(EngineCore_DP0 pid=3514304) [2026-01-28 00:56:55] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 33177600 bytes
(EngineCore_DP0 pid=3514304) [2026-01-28 00:56:55] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 10368] -> 1D uint8
(EngineCore_DP0 pid=3514304) [2026-01-28 00:56:55] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 16588800 bytes
(EngineCore_DP0 pid=3514304) 2026-01-28 00:57:05,398 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3514304) 2026-01-28 00:57:05,413 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3514304) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  4.36it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  4.28it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  4.29it/s]
(EngineCore_DP0 pid=3514304) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  6.70it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  6.69it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  96%|█████████▌| 123/128 [00:00<00:00, 1226.03it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 1229.66it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:15,  8.45it/s, est. speed input: 4326.69 toks/s, output: 8.45 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:00<00:03, 39.26it/s, est. speed input: 17683.11 toks/s, output: 34.54 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:00<00:02, 49.54it/s, est. speed input: 22297.73 toks/s, output: 43.55 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:00<00:01, 54.38it/s, est. speed input: 24616.46 toks/s, output: 48.08 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:00<00:01, 57.27it/s, est. speed input: 26066.16 toks/s, output: 50.91 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:00<00:01, 59.32it/s, est. speed input: 27105.31 toks/s, output: 52.94 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:00<00:01, 60.52it/s, est. speed input: 27829.05 toks/s, output: 54.35 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:00<00:01, 61.05it/s, est. speed input: 28327.42 toks/s, output: 55.33 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:01<00:01, 61.58it/s, est. speed input: 28745.85 toks/s, output: 56.14 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:01<00:01, 61.97it/s, est. speed input: 29085.02 toks/s, output: 56.81 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:01<00:00, 62.35it/s, est. speed input: 29378.82 toks/s, output: 57.38 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:01<00:00, 62.45it/s, est. speed input: 29603.19 toks/s, output: 57.82 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:01<00:00, 62.69it/s, est. speed input: 29814.01 toks/s, output: 58.23 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:01<00:00, 62.77it/s, est. speed input: 29985.26 toks/s, output: 58.56 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:01<00:00, 63.01it/s, est. speed input: 30153.10 toks/s, output: 58.89 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:01<00:00, 63.09it/s, est. speed input: 30291.36 toks/s, output: 59.16 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:01<00:00, 62.65it/s, est. speed input: 30367.34 toks/s, output: 59.31 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:02<00:00, 61.01it/s, est. speed input: 30312.02 toks/s, output: 59.20 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:02<00:00, 61.17it/s, est. speed input: 30375.50 toks/s, output: 59.33 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:02<00:00, 61.17it/s, est. speed input: 30383.09 toks/s, output: 59.34 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:02<00:00, 59.34it/s, est. speed input: 30383.09 toks/s, output: 59.34 toks/s]
[rank0]:[W128 00:57:09.186880562 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 25.0s

测试结果:
  Requests/s:   56.59
  Tokens/s:     29032.48
  Total Reqs:   128
  Elapsed:      2.26s

  [Prefill 分析]
  Total Prefill Tokens: 65536
  Prefill Tokens/s:     28975.88

============================================================
[2/7] 测试 M=1024
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 1024
│   M_prefill     = 1024 (= 1 x 1024)
│   M_decode      = 1
│   batched_tokens = 1025 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 1025
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:57:14 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3514981) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3514981) WARNING 01-28 00:57:24 [backends.py:609] Failed to read file <frozen os>
Throughput: 35.97 requests/s, 36865.52 total tokens/s, 35.97 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128


─── STDERR ───
[2026-01-28 00:57:14] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:57:14] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:57:14] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:57:14] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:57:14] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:57:14] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:57:14] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:57:14] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:57:14] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:57:14] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:57:14] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:57:14] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:57:14] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:57:14] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:57:18] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:57:18] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:57:18] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:57:18] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:57:18] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:57:18] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:57:18] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:57:18] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:57:18] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:57:18] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:57:18] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:57:18] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:57:18] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:57:18] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3514981) [2026-01-28 00:57:19] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3514981) [2026-01-28 00:57:19] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3514981) [2026-01-28 00:57:19] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3514981) [2026-01-28 00:57:19] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=3514981) [2026-01-28 00:57:19] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3514981) [2026-01-28 00:57:19] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3514981) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3514981) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.37it/s]
(EngineCore_DP0 pid=3514981) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.37it/s]
(EngineCore_DP0 pid=3514981) 
(EngineCore_DP0 pid=3514981) [2026-01-28 00:57:20] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 3840] -> 1D uint8
(EngineCore_DP0 pid=3514981) [2026-01-28 00:57:20] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 9216000 bytes
(EngineCore_DP0 pid=3514981) [2026-01-28 00:57:20] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 3840] -> 1D uint8
(EngineCore_DP0 pid=3514981) [2026-01-28 00:57:20] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 6144000 bytes
(EngineCore_DP0 pid=3514981) [2026-01-28 00:57:20] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 3840] -> 1D uint8
(EngineCore_DP0 pid=3514981) [2026-01-28 00:57:20] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 33177600 bytes
(EngineCore_DP0 pid=3514981) [2026-01-28 00:57:20] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 10368] -> 1D uint8
(EngineCore_DP0 pid=3514981) [2026-01-28 00:57:20] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 16588800 bytes
(EngineCore_DP0 pid=3514981) 2026-01-28 00:57:30,093 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3514981) 2026-01-28 00:57:30,109 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3514981) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  7.75it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00, 11.55it/s]
(EngineCore_DP0 pid=3514981) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.26it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.25it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  52%|█████▏    | 66/128 [00:00<00:00, 653.64it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 697.29it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:04, 28.64it/s, est. speed input: 29329.66 toks/s, output: 28.64 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:03, 34.32it/s, est. speed input: 34272.31 toks/s, output: 33.47 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:00<00:03, 36.13it/s, est. speed input: 35913.94 toks/s, output: 35.07 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:00<00:03, 36.99it/s, est. speed input: 36742.66 toks/s, output: 35.88 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:00<00:02, 37.46it/s, est. speed input: 37234.53 toks/s, output: 36.36 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:00<00:02, 37.77it/s, est. speed input: 37580.20 toks/s, output: 36.70 toks/s]
Processed prompts:  21%|██        | 27/128 [00:00<00:02, 37.90it/s, est. speed input: 37794.40 toks/s, output: 36.91 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:00<00:02, 37.87it/s, est. speed input: 37910.97 toks/s, output: 37.02 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:00<00:02, 37.96it/s, est. speed input: 38040.54 toks/s, output: 37.15 toks/s]
Processed prompts:  30%|███       | 39/128 [00:01<00:02, 37.98it/s, est. speed input: 38130.97 toks/s, output: 37.24 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:01<00:02, 37.97it/s, est. speed input: 38196.44 toks/s, output: 37.30 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:01<00:02, 38.03it/s, est. speed input: 38271.67 toks/s, output: 37.37 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:01<00:02, 38.10it/s, est. speed input: 38340.16 toks/s, output: 37.44 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:01<00:01, 38.15it/s, est. speed input: 38400.60 toks/s, output: 37.50 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:01<00:01, 38.24it/s, est. speed input: 38465.03 toks/s, output: 37.56 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:01<00:01, 38.30it/s, est. speed input: 38520.65 toks/s, output: 37.62 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:01<00:01, 38.36it/s, est. speed input: 38572.97 toks/s, output: 37.67 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:01<00:01, 38.21it/s, est. speed input: 38585.23 toks/s, output: 37.68 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:01<00:01, 38.24it/s, est. speed input: 38617.92 toks/s, output: 37.71 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:02<00:01, 38.27it/s, est. speed input: 38650.23 toks/s, output: 37.74 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:02<00:01, 38.24it/s, est. speed input: 38671.90 toks/s, output: 37.77 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:02<00:01, 38.26it/s, est. speed input: 38696.64 toks/s, output: 37.79 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:02<00:00, 38.28it/s, est. speed input: 38719.93 toks/s, output: 37.81 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:02<00:00, 38.32it/s, est. speed input: 38745.22 toks/s, output: 37.84 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:02<00:00, 38.31it/s, est. speed input: 38764.12 toks/s, output: 37.86 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:02<00:00, 38.31it/s, est. speed input: 38782.49 toks/s, output: 37.87 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:02<00:00, 38.22it/s, est. speed input: 38786.80 toks/s, output: 37.88 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:02<00:00, 38.24it/s, est. speed input: 38802.70 toks/s, output: 37.89 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:03<00:00, 38.26it/s, est. speed input: 38816.88 toks/s, output: 37.91 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:03<00:00, 38.21it/s, est. speed input: 38823.67 toks/s, output: 37.91 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:03<00:00, 38.16it/s, est. speed input: 38828.18 toks/s, output: 37.92 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:03<00:00, 38.18it/s, est. speed input: 38838.06 toks/s, output: 37.93 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:03<00:00, 38.18it/s, est. speed input: 38841.65 toks/s, output: 37.93 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:03<00:00, 37.93it/s, est. speed input: 38841.65 toks/s, output: 37.93 toks/s]
[rank0]:[W128 00:57:35.863678040 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 25.7s

测试结果:
  Requests/s:   35.97
  Tokens/s:     36865.52
  Total Reqs:   128
  Elapsed:      3.56s

  [Prefill 分析]
  Total Prefill Tokens: 131072
  Prefill Tokens/s:     36829.56

============================================================
[3/7] 测试 M=2048
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 2048
│   M_prefill     = 2048 (= 2 x 1024)
│   M_decode      = 2
│   batched_tokens = 2048 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 256
│   --max-num-seqs           = 2
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 2048
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:57:40 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3515628) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3515628) WARNING 01-28 00:57:50 [backends.py:609] Failed to read file <frozen os>
Throughput: 39.52 requests/s, 40510.70 total tokens/s, 39.52 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256


─── STDERR ───
[2026-01-28 00:57:40] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:57:40] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:57:40] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:57:40] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:57:40] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:57:40] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:57:40] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:57:40] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:57:40] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:57:40] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:57:40] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:57:40] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:57:40] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:57:40] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:57:44] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:57:44] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:57:44] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:57:44] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:57:44] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:57:44] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:57:44] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:57:44] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:57:44] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:57:44] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:57:44] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:57:44] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:57:44] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:57:44] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3515628) [2026-01-28 00:57:45] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3515628) [2026-01-28 00:57:45] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3515628) [2026-01-28 00:57:45] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3515628) [2026-01-28 00:57:45] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=3515628) [2026-01-28 00:57:45] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3515628) [2026-01-28 00:57:45] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3515628) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3515628) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.88it/s]
(EngineCore_DP0 pid=3515628) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.88it/s]
(EngineCore_DP0 pid=3515628) 
(EngineCore_DP0 pid=3515628) [2026-01-28 00:57:45] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 3840] -> 1D uint8
(EngineCore_DP0 pid=3515628) [2026-01-28 00:57:45] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 9216000 bytes
(EngineCore_DP0 pid=3515628) [2026-01-28 00:57:45] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 3840] -> 1D uint8
(EngineCore_DP0 pid=3515628) [2026-01-28 00:57:45] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 6144000 bytes
(EngineCore_DP0 pid=3515628) [2026-01-28 00:57:45] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 3840] -> 1D uint8
(EngineCore_DP0 pid=3515628) [2026-01-28 00:57:45] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 33177600 bytes
(EngineCore_DP0 pid=3515628) [2026-01-28 00:57:45] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 10368] -> 1D uint8
(EngineCore_DP0 pid=3515628) [2026-01-28 00:57:45] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 16588800 bytes
(EngineCore_DP0 pid=3515628) 2026-01-28 00:57:55,991 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3515628) 2026-01-28 00:57:56,006 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3515628) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00, 21.63it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00, 21.61it/s]
(EngineCore_DP0 pid=3515628) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 1/2 [00:00<00:00,  7.24it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00, 11.49it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  25%|██▍       | 63/256 [00:00<00:00, 626.36it/s]
Adding requests:  53%|█████▎    | 136/256 [00:00<00:00, 682.12it/s]
Adding requests:  82%|████████▏ | 210/256 [00:00<00:00, 705.21it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 709.48it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▌         | 14/256 [00:00<00:01, 137.02it/s, est. speed input: 140326.31 toks/s, output: 137.03 toks/s]
Processed prompts:  11%|█         | 28/256 [00:00<00:04, 56.65it/s, est. speed input: 63605.22 toks/s, output: 62.11 toks/s]   
Processed prompts:  14%|█▍        | 37/256 [00:00<00:04, 51.87it/s, est. speed input: 58169.33 toks/s, output: 56.81 toks/s]
Processed prompts:  17%|█▋        | 44/256 [00:00<00:04, 45.74it/s, est. speed input: 52952.99 toks/s, output: 51.71 toks/s]
Processed prompts:  20%|█▉        | 50/256 [00:01<00:04, 44.16it/s, est. speed input: 51182.23 toks/s, output: 49.98 toks/s]
Processed prompts:  22%|██▏       | 56/256 [00:01<00:04, 43.01it/s, est. speed input: 49870.36 toks/s, output: 48.70 toks/s]
Processed prompts:  24%|██▍       | 62/256 [00:01<00:04, 42.19it/s, est. speed input: 48867.27 toks/s, output: 47.72 toks/s]
Processed prompts:  27%|██▋       | 68/256 [00:01<00:04, 41.61it/s, est. speed input: 48074.22 toks/s, output: 46.95 toks/s]
Processed prompts:  29%|██▉       | 74/256 [00:01<00:04, 41.18it/s, est. speed input: 47424.35 toks/s, output: 46.31 toks/s]
Processed prompts:  31%|███▏      | 80/256 [00:01<00:04, 40.84it/s, est. speed input: 46874.15 toks/s, output: 45.78 toks/s]
Processed prompts:  33%|███▎      | 85/256 [00:01<00:03, 42.86it/s, est. speed input: 47106.04 toks/s, output: 46.00 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:01<00:04, 39.85it/s, est. speed input: 46146.50 toks/s, output: 45.06 toks/s]
Processed prompts:  38%|███▊      | 96/256 [00:02<00:04, 39.93it/s, est. speed input: 45792.36 toks/s, output: 44.72 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:02<00:03, 39.98it/s, est. speed input: 45483.45 toks/s, output: 44.42 toks/s]
Processed prompts:  42%|████▏     | 108/256 [00:02<00:03, 40.04it/s, est. speed input: 45217.99 toks/s, output: 44.16 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:02<00:03, 40.08it/s, est. speed input: 44982.74 toks/s, output: 43.93 toks/s]
Processed prompts:  46%|████▋     | 119/256 [00:02<00:03, 42.27it/s, est. speed input: 45205.01 toks/s, output: 44.15 toks/s]
Processed prompts:  48%|████▊     | 124/256 [00:02<00:03, 39.31it/s, est. speed input: 44611.85 toks/s, output: 43.57 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:02<00:03, 39.58it/s, est. speed input: 44438.46 toks/s, output: 43.40 toks/s]
Processed prompts:  53%|█████▎    | 136/256 [00:03<00:03, 39.74it/s, est. speed input: 44277.47 toks/s, output: 43.24 toks/s]
Processed prompts:  55%|█████▌    | 141/256 [00:03<00:02, 42.06it/s, est. speed input: 44486.76 toks/s, output: 43.44 toks/s]
Processed prompts:  57%|█████▋    | 146/256 [00:03<00:02, 39.24it/s, est. speed input: 44036.53 toks/s, output: 43.00 toks/s]
Processed prompts:  59%|█████▉    | 152/256 [00:03<00:02, 39.54it/s, est. speed input: 43914.79 toks/s, output: 42.89 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:03<00:02, 39.75it/s, est. speed input: 43803.97 toks/s, output: 42.78 toks/s]
Processed prompts:  64%|██████▍   | 164/256 [00:03<00:02, 39.83it/s, est. speed input: 43694.17 toks/s, output: 42.67 toks/s]
Processed prompts:  66%|██████▋   | 170/256 [00:03<00:02, 39.90it/s, est. speed input: 43593.76 toks/s, output: 42.57 toks/s]
Processed prompts:  69%|██████▉   | 176/256 [00:04<00:02, 39.97it/s, est. speed input: 43502.89 toks/s, output: 42.48 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:04<00:01, 40.01it/s, est. speed input: 43418.70 toks/s, output: 42.40 toks/s]
Processed prompts:  73%|███████▎  | 188/256 [00:04<00:01, 40.07it/s, est. speed input: 43342.44 toks/s, output: 42.33 toks/s]
Processed prompts:  76%|███████▌  | 194/256 [00:04<00:01, 40.10it/s, est. speed input: 43270.99 toks/s, output: 42.26 toks/s]
Processed prompts:  78%|███████▊  | 200/256 [00:04<00:01, 40.07it/s, est. speed input: 43197.50 toks/s, output: 42.18 toks/s]
Processed prompts:  80%|████████  | 205/256 [00:04<00:01, 42.24it/s, est. speed input: 43358.05 toks/s, output: 42.34 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:04<00:01, 39.42it/s, est. speed input: 43087.15 toks/s, output: 42.08 toks/s]
Processed prompts:  84%|████████▍ | 216/256 [00:05<00:01, 39.66it/s, est. speed input: 43031.15 toks/s, output: 42.02 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:05<00:00, 39.80it/s, est. speed input: 42975.74 toks/s, output: 41.97 toks/s]
Processed prompts:  89%|████████▉ | 228/256 [00:05<00:00, 39.88it/s, est. speed input: 42922.18 toks/s, output: 41.92 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:05<00:00, 39.96it/s, est. speed input: 42873.83 toks/s, output: 41.87 toks/s]
Processed prompts:  94%|█████████▍| 240/256 [00:05<00:00, 39.99it/s, est. speed input: 42825.41 toks/s, output: 41.82 toks/s]
Processed prompts:  96%|█████████▌| 245/256 [00:05<00:00, 42.22it/s, est. speed input: 42967.40 toks/s, output: 41.96 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:05<00:00, 39.33it/s, est. speed input: 42745.92 toks/s, output: 41.74 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:06<00:00, 41.69it/s, est. speed input: 42872.05 toks/s, output: 41.87 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:06<00:00, 41.69it/s, est. speed input: 42872.05 toks/s, output: 41.87 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:06<00:00, 41.87it/s, est. speed input: 42872.05 toks/s, output: 41.87 toks/s]
[rank0]:[W128 00:58:03.699392890 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 28.8s

测试结果:
  Requests/s:   39.52
  Tokens/s:     40510.70
  Total Reqs:   256
  Elapsed:      6.48s

  [Prefill 分析]
  Total Prefill Tokens: 262144
  Prefill Tokens/s:     40471.18

============================================================
[4/7] 测试 M=4096
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 4096
│   M_prefill     = 4096 (= 4 x 1024)
│   M_decode      = 4
│   batched_tokens = 4096 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 512
│   --max-num-seqs           = 4
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 4096
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:58:10 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3516314) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3516314) WARNING 01-28 00:58:19 [backends.py:609] Failed to read file <frozen os>
Throughput: 39.30 requests/s, 40287.61 total tokens/s, 39.30 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512


─── STDERR ───
[2026-01-28 00:58:10] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:58:10] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:58:10] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:58:10] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:58:10] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:58:10] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:58:10] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:58:10] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:58:10] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:58:10] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:58:10] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:58:10] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:58:10] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:58:10] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:58:14] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:58:14] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:58:14] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:58:14] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:58:14] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:58:14] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:58:14] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:58:14] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:58:14] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:58:14] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:58:14] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:58:14] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:58:14] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:58:14] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3516314) [2026-01-28 00:58:14] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3516314) [2026-01-28 00:58:14] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3516314) [2026-01-28 00:58:14] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3516314) [2026-01-28 00:58:14] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=3516314) [2026-01-28 00:58:14] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3516314) [2026-01-28 00:58:14] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3516314) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3516314) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.82it/s]
(EngineCore_DP0 pid=3516314) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.82it/s]
(EngineCore_DP0 pid=3516314) 
(EngineCore_DP0 pid=3516314) [2026-01-28 00:58:15] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 3840] -> 1D uint8
(EngineCore_DP0 pid=3516314) [2026-01-28 00:58:15] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 9216000 bytes
(EngineCore_DP0 pid=3516314) [2026-01-28 00:58:15] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 3840] -> 1D uint8
(EngineCore_DP0 pid=3516314) [2026-01-28 00:58:15] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 6144000 bytes
(EngineCore_DP0 pid=3516314) [2026-01-28 00:58:15] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 3840] -> 1D uint8
(EngineCore_DP0 pid=3516314) [2026-01-28 00:58:15] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 33177600 bytes
(EngineCore_DP0 pid=3516314) [2026-01-28 00:58:15] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 10368] -> 1D uint8
(EngineCore_DP0 pid=3516314) [2026-01-28 00:58:15] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 16588800 bytes
(EngineCore_DP0 pid=3516314) 2026-01-28 00:58:25,472 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3516314) 2026-01-28 00:58:25,488 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3516314) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  75%|███████▌  | 3/4 [00:00<00:00, 23.83it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00, 22.53it/s]
(EngineCore_DP0 pid=3516314) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  33%|███▎      | 1/3 [00:00<00:00,  7.27it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00, 14.57it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:  13%|█▎        | 66/512 [00:00<00:00, 656.65it/s]
Adding requests:  28%|██▊       | 141/512 [00:00<00:00, 709.18it/s]
Adding requests:  42%|████▏     | 215/512 [00:00<00:00, 721.16it/s]
Adding requests:  56%|█████▋    | 288/512 [00:00<00:00, 719.87it/s]
Adding requests:  71%|███████   | 363/512 [00:00<00:00, 729.23it/s]
Adding requests:  85%|████████▌ | 437/512 [00:00<00:00, 729.89it/s]
Adding requests: 100%|██████████| 512/512 [00:00<00:00, 733.65it/s]
Adding requests: 100%|██████████| 512/512 [00:00<00:00, 724.83it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▌         | 26/512 [00:00<00:02, 223.92it/s, est. speed input: 229317.52 toks/s, output: 223.93 toks/s]
Processed prompts:  10%|▉         | 49/512 [00:00<00:06, 70.28it/s, est. speed input: 80795.51 toks/s, output: 78.90 toks/s]   
Processed prompts:  12%|█▏        | 61/512 [00:00<00:07, 57.26it/s, est. speed input: 67611.12 toks/s, output: 66.03 toks/s]
Processed prompts:  14%|█▎        | 70/512 [00:01<00:09, 46.87it/s, est. speed input: 58438.13 toks/s, output: 57.07 toks/s]
Processed prompts:  15%|█▌        | 77/512 [00:01<00:08, 50.32it/s, est. speed input: 59405.29 toks/s, output: 58.01 toks/s]
Processed prompts:  16%|█▋        | 84/512 [00:01<00:09, 45.58it/s, est. speed input: 56256.44 toks/s, output: 54.94 toks/s]
Processed prompts:  18%|█▊        | 90/512 [00:01<00:10, 40.81it/s, est. speed input: 53256.01 toks/s, output: 52.01 toks/s]
Processed prompts:  19%|█▊        | 95/512 [00:01<00:09, 42.34it/s, est. speed input: 53111.07 toks/s, output: 51.87 toks/s]
Processed prompts:  20%|█▉        | 100/512 [00:01<00:09, 43.79it/s, est. speed input: 52984.01 toks/s, output: 51.74 toks/s]
Processed prompts:  21%|██        | 105/512 [00:02<00:09, 45.10it/s, est. speed input: 52878.02 toks/s, output: 51.64 toks/s]
Processed prompts:  21%|██▏       | 110/512 [00:02<00:10, 37.19it/s, est. speed input: 50403.57 toks/s, output: 49.22 toks/s]
Processed prompts:  22%|██▏       | 115/512 [00:02<00:09, 39.88it/s, est. speed input: 50415.19 toks/s, output: 49.23 toks/s]
Processed prompts:  23%|██▎       | 120/512 [00:02<00:09, 42.15it/s, est. speed input: 50422.52 toks/s, output: 49.24 toks/s]
Processed prompts:  24%|██▍       | 125/512 [00:02<00:08, 44.00it/s, est. speed input: 50430.97 toks/s, output: 49.25 toks/s]
Processed prompts:  25%|██▌       | 130/512 [00:02<00:10, 35.91it/s, est. speed input: 48579.87 toks/s, output: 47.44 toks/s]
Processed prompts:  26%|██▋       | 135/512 [00:02<00:09, 39.00it/s, est. speed input: 48645.82 toks/s, output: 47.51 toks/s]
Processed prompts:  27%|██▋       | 140/512 [00:02<00:08, 41.56it/s, est. speed input: 48710.14 toks/s, output: 47.57 toks/s]
Processed prompts:  28%|██▊       | 145/512 [00:03<00:08, 43.65it/s, est. speed input: 48778.05 toks/s, output: 47.63 toks/s]
Processed prompts:  29%|██▉       | 150/512 [00:03<00:10, 35.59it/s, est. speed input: 47322.75 toks/s, output: 46.21 toks/s]
Processed prompts:  30%|███       | 154/512 [00:03<00:09, 36.54it/s, est. speed input: 47120.32 toks/s, output: 46.02 toks/s]
Processed prompts:  31%|███       | 158/512 [00:03<00:09, 37.33it/s, est. speed input: 46930.75 toks/s, output: 45.83 toks/s]
Processed prompts:  32%|███▏      | 162/512 [00:03<00:09, 37.90it/s, est. speed input: 46745.55 toks/s, output: 45.65 toks/s]
Processed prompts:  32%|███▏      | 166/512 [00:03<00:09, 38.38it/s, est. speed input: 46576.42 toks/s, output: 45.48 toks/s]
Processed prompts:  33%|███▎      | 170/512 [00:03<00:08, 38.76it/s, est. speed input: 46418.62 toks/s, output: 45.33 toks/s]
Processed prompts:  34%|███▍      | 174/512 [00:03<00:08, 38.98it/s, est. speed input: 46262.57 toks/s, output: 45.18 toks/s]
Processed prompts:  35%|███▍      | 178/512 [00:03<00:08, 39.17it/s, est. speed input: 46117.71 toks/s, output: 45.04 toks/s]
Processed prompts:  36%|███▌      | 182/512 [00:04<00:08, 39.33it/s, est. speed input: 45982.19 toks/s, output: 44.90 toks/s]
Processed prompts:  36%|███▋      | 186/512 [00:04<00:08, 39.44it/s, est. speed input: 45852.57 toks/s, output: 44.78 toks/s]
Processed prompts:  37%|███▋      | 190/512 [00:04<00:08, 39.53it/s, est. speed input: 45730.61 toks/s, output: 44.66 toks/s]
Processed prompts:  38%|███▊      | 194/512 [00:04<00:08, 39.54it/s, est. speed input: 45609.39 toks/s, output: 44.54 toks/s]
Processed prompts:  39%|███▊      | 198/512 [00:04<00:07, 39.53it/s, est. speed input: 45492.78 toks/s, output: 44.43 toks/s]
Processed prompts:  39%|███▉      | 202/512 [00:04<00:07, 39.55it/s, est. speed input: 45383.33 toks/s, output: 44.32 toks/s]
Processed prompts:  40%|████      | 206/512 [00:04<00:07, 39.52it/s, est. speed input: 45274.37 toks/s, output: 44.21 toks/s]
Processed prompts:  41%|████      | 210/512 [00:04<00:07, 39.52it/s, est. speed input: 45172.17 toks/s, output: 44.11 toks/s]
Processed prompts:  42%|████▏     | 214/512 [00:04<00:07, 39.52it/s, est. speed input: 45074.26 toks/s, output: 44.02 toks/s]
Processed prompts:  43%|████▎     | 218/512 [00:04<00:07, 39.55it/s, est. speed input: 44982.46 toks/s, output: 43.93 toks/s]
Processed prompts:  43%|████▎     | 222/512 [00:05<00:07, 39.59it/s, est. speed input: 44896.21 toks/s, output: 43.84 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:05<00:07, 39.62it/s, est. speed input: 44812.82 toks/s, output: 43.76 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:05<00:07, 39.60it/s, est. speed input: 44730.44 toks/s, output: 43.68 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:05<00:07, 39.59it/s, est. speed input: 44650.63 toks/s, output: 43.60 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:05<00:06, 39.59it/s, est. speed input: 44574.66 toks/s, output: 43.53 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:05<00:06, 39.62it/s, est. speed input: 44503.50 toks/s, output: 43.46 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:05<00:06, 39.61it/s, est. speed input: 44432.63 toks/s, output: 43.39 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:05<00:06, 39.63it/s, est. speed input: 44366.10 toks/s, output: 43.33 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:05<00:06, 39.60it/s, est. speed input: 44299.45 toks/s, output: 43.26 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:05<00:06, 39.57it/s, est. speed input: 44233.88 toks/s, output: 43.20 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:06<00:06, 39.58it/s, est. speed input: 44172.80 toks/s, output: 43.14 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:06<00:06, 39.58it/s, est. speed input: 44113.36 toks/s, output: 43.08 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:06<00:06, 39.62it/s, est. speed input: 44057.99 toks/s, output: 43.03 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:06<00:06, 39.63it/s, est. speed input: 44003.56 toks/s, output: 42.97 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:06<00:05, 39.61it/s, est. speed input: 43948.92 toks/s, output: 42.92 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:06<00:05, 39.64it/s, est. speed input: 43898.73 toks/s, output: 42.87 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:06<00:05, 39.65it/s, est. speed input: 43849.09 toks/s, output: 42.82 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:06<00:05, 39.59it/s, est. speed input: 43797.59 toks/s, output: 42.77 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:06<00:05, 39.57it/s, est. speed input: 43748.68 toks/s, output: 42.72 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:06<00:05, 39.60it/s, est. speed input: 43703.37 toks/s, output: 42.68 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:07<00:05, 39.63it/s, est. speed input: 43660.00 toks/s, output: 42.64 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:07<00:05, 39.60it/s, est. speed input: 43615.42 toks/s, output: 42.59 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:07<00:05, 39.60it/s, est. speed input: 43572.56 toks/s, output: 42.55 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:07<00:04, 39.62it/s, est. speed input: 43532.26 toks/s, output: 42.51 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:07<00:04, 39.65it/s, est. speed input: 43493.69 toks/s, output: 42.47 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:07<00:04, 39.67it/s, est. speed input: 43456.35 toks/s, output: 42.44 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:07<00:04, 39.67it/s, est. speed input: 43418.95 toks/s, output: 42.40 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:07<00:04, 39.65it/s, est. speed input: 43382.01 toks/s, output: 42.37 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:07<00:04, 39.60it/s, est. speed input: 43343.98 toks/s, output: 42.33 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:07<00:04, 39.61it/s, est. speed input: 43309.39 toks/s, output: 42.29 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:08<00:04, 39.64it/s, est. speed input: 43276.07 toks/s, output: 42.26 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:08<00:04, 39.65it/s, est. speed input: 43243.71 toks/s, output: 42.23 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:08<00:04, 39.65it/s, est. speed input: 43211.35 toks/s, output: 42.20 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:08<00:03, 39.65it/s, est. speed input: 43180.26 toks/s, output: 42.17 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:08<00:03, 39.64it/s, est. speed input: 43149.05 toks/s, output: 42.14 toks/s]
Processed prompts:  71%|███████   | 362/512 [00:08<00:03, 39.62it/s, est. speed input: 43118.33 toks/s, output: 42.11 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:08<00:03, 39.56it/s, est. speed input: 43086.14 toks/s, output: 42.08 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [00:08<00:03, 39.53it/s, est. speed input: 43055.31 toks/s, output: 42.05 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [00:08<00:03, 39.49it/s, est. speed input: 43024.52 toks/s, output: 42.02 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [00:09<00:03, 39.51it/s, est. speed input: 42995.98 toks/s, output: 41.99 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [00:09<00:03, 39.54it/s, est. speed input: 42969.00 toks/s, output: 41.96 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [00:09<00:03, 39.56it/s, est. speed input: 42942.51 toks/s, output: 41.94 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [00:09<00:03, 39.57it/s, est. speed input: 42916.43 toks/s, output: 41.91 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [00:09<00:02, 39.58it/s, est. speed input: 42891.15 toks/s, output: 41.89 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [00:09<00:02, 39.59it/s, est. speed input: 42866.56 toks/s, output: 41.86 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [00:09<00:02, 39.63it/s, est. speed input: 42843.32 toks/s, output: 41.84 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [00:09<00:02, 39.66it/s, est. speed input: 42820.87 toks/s, output: 41.82 toks/s]
Processed prompts:  80%|████████  | 410/512 [00:09<00:02, 39.61it/s, est. speed input: 42796.33 toks/s, output: 41.79 toks/s]
Processed prompts:  81%|████████  | 414/512 [00:09<00:02, 39.60it/s, est. speed input: 42773.14 toks/s, output: 41.77 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [00:10<00:02, 39.62it/s, est. speed input: 42751.52 toks/s, output: 41.75 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [00:10<00:02, 39.63it/s, est. speed input: 42729.97 toks/s, output: 41.73 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [00:10<00:02, 39.63it/s, est. speed input: 42708.75 toks/s, output: 41.71 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [00:10<00:02, 39.67it/s, est. speed input: 42689.23 toks/s, output: 41.69 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [00:10<00:01, 39.67it/s, est. speed input: 42669.44 toks/s, output: 41.67 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [00:10<00:01, 39.63it/s, est. speed input: 42648.32 toks/s, output: 41.65 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [00:10<00:01, 39.65it/s, est. speed input: 42629.22 toks/s, output: 41.63 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [00:10<00:01, 39.64it/s, est. speed input: 42609.99 toks/s, output: 41.61 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [00:10<00:01, 39.63it/s, est. speed input: 42590.71 toks/s, output: 41.59 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [00:10<00:01, 39.56it/s, est. speed input: 42569.88 toks/s, output: 41.57 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [00:11<00:01, 39.57it/s, est. speed input: 42551.32 toks/s, output: 41.55 toks/s]
Processed prompts:  90%|█████████ | 462/512 [00:11<00:01, 39.56it/s, est. speed input: 42532.57 toks/s, output: 41.54 toks/s]
Processed prompts:  91%|█████████ | 466/512 [00:11<00:01, 39.51it/s, est. speed input: 42512.60 toks/s, output: 41.52 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [00:11<00:01, 39.52it/s, est. speed input: 42494.71 toks/s, output: 41.50 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [00:11<00:00, 39.49it/s, est. speed input: 42475.80 toks/s, output: 41.48 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [00:11<00:00, 39.49it/s, est. speed input: 42457.94 toks/s, output: 41.46 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [00:11<00:00, 39.53it/s, est. speed input: 42441.48 toks/s, output: 41.45 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [00:11<00:00, 39.57it/s, est. speed input: 42425.81 toks/s, output: 41.43 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [00:11<00:00, 39.45it/s, est. speed input: 42405.98 toks/s, output: 41.41 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [00:11<00:00, 39.44it/s, est. speed input: 42388.40 toks/s, output: 41.39 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [00:12<00:00, 39.48it/s, est. speed input: 42372.69 toks/s, output: 41.38 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [00:12<00:00, 39.51it/s, est. speed input: 42357.38 toks/s, output: 41.36 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [00:12<00:00, 39.49it/s, est. speed input: 42341.17 toks/s, output: 41.35 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:12<00:00, 39.49it/s, est. speed input: 42562.44 toks/s, output: 41.56 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:12<00:00, 41.56it/s, est. speed input: 42562.44 toks/s, output: 41.56 toks/s]
[rank0]:[W128 00:58:40.821185998 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 36.2s

测试结果:
  Requests/s:   39.30
  Tokens/s:     40287.61
  Total Reqs:   512
  Elapsed:      13.03s

  [Prefill 分析]
  Total Prefill Tokens: 524288
  Prefill Tokens/s:     40248.31

============================================================
[5/7] 测试 M=8192
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 8192
│   M_prefill     = 8192 (= 8 x 1024)
│   M_decode      = 8
│   batched_tokens = 8192 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 1024
│   --max-num-seqs           = 8
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 8192
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:58:47 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3517107) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3517107) WARNING 01-28 00:58:56 [backends.py:609] Failed to read file <frozen os>
Throughput: 37.64 requests/s, 38585.45 total tokens/s, 37.64 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024


─── STDERR ───
[2026-01-28 00:58:47] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:58:47] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:58:47] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:58:47] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:58:47] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:58:47] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:58:47] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:58:47] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:58:47] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:58:47] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:58:47] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:58:47] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:58:47] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:58:47] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:58:51] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:58:51] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:58:51] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:58:51] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:58:51] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:58:51] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:58:51] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:58:51] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:58:51] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:58:51] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:58:51] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:58:51] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:58:51] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:58:51] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3517107) [2026-01-28 00:58:52] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3517107) [2026-01-28 00:58:52] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3517107) [2026-01-28 00:58:52] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3517107) [2026-01-28 00:58:52] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=3517107) [2026-01-28 00:58:52] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3517107) [2026-01-28 00:58:52] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3517107) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3517107) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.91it/s]
(EngineCore_DP0 pid=3517107) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.91it/s]
(EngineCore_DP0 pid=3517107) 
(EngineCore_DP0 pid=3517107) [2026-01-28 00:58:52] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 3840] -> 1D uint8
(EngineCore_DP0 pid=3517107) [2026-01-28 00:58:52] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 9216000 bytes
(EngineCore_DP0 pid=3517107) [2026-01-28 00:58:52] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 3840] -> 1D uint8
(EngineCore_DP0 pid=3517107) [2026-01-28 00:58:52] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 6144000 bytes
(EngineCore_DP0 pid=3517107) [2026-01-28 00:58:52] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 3840] -> 1D uint8
(EngineCore_DP0 pid=3517107) [2026-01-28 00:58:52] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 33177600 bytes
(EngineCore_DP0 pid=3517107) [2026-01-28 00:58:52] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 10368] -> 1D uint8
(EngineCore_DP0 pid=3517107) [2026-01-28 00:58:52] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 16588800 bytes
(EngineCore_DP0 pid=3517107) 2026-01-28 00:59:02,924 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3517107) 2026-01-28 00:59:02,940 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3517107) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:00,  6.07it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  60%|██████    | 3/5 [00:00<00:00, 10.21it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00, 12.21it/s]
(EngineCore_DP0 pid=3517107) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:00,  7.28it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00, 18.69it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00, 16.72it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   7%|▋         | 74/1024 [00:00<00:01, 731.39it/s]
Adding requests:  15%|█▍        | 150/1024 [00:00<00:01, 747.45it/s]
Adding requests:  22%|██▏       | 227/1024 [00:00<00:01, 755.35it/s]
Adding requests:  30%|██▉       | 303/1024 [00:00<00:00, 756.35it/s]
Adding requests:  37%|███▋      | 380/1024 [00:00<00:00, 760.88it/s]
Adding requests:  45%|████▍     | 457/1024 [00:00<00:00, 752.74it/s]
Adding requests:  52%|█████▏    | 533/1024 [00:00<00:00, 741.23it/s]
Adding requests:  60%|█████▉    | 611/1024 [00:00<00:00, 752.16it/s]
Adding requests:  67%|██████▋   | 691/1024 [00:00<00:00, 764.54it/s]
Adding requests:  75%|███████▌  | 768/1024 [00:01<00:00, 764.25it/s]
Adding requests:  83%|████████▎ | 845/1024 [00:01<00:00, 748.79it/s]
Adding requests:  90%|█████████ | 922/1024 [00:01<00:00, 752.67it/s]
Adding requests:  97%|█████████▋| 998/1024 [00:01<00:00, 746.79it/s]
Adding requests: 100%|██████████| 1024/1024 [00:01<00:00, 751.75it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▍         | 50/1024 [00:00<00:03, 249.99it/s, est. speed input: 256010.01 toks/s, output: 250.00 toks/s]
Processed prompts:   7%|▋         | 75/1024 [00:00<00:12, 77.42it/s, est. speed input: 91979.64 toks/s, output: 89.82 toks/s]   
Processed prompts:   9%|▊         | 88/1024 [00:01<00:12, 72.90it/s, est. speed input: 86073.74 toks/s, output: 84.06 toks/s]
Processed prompts:  10%|▉         | 98/1024 [00:01<00:18, 50.99it/s, est. speed input: 68263.78 toks/s, output: 66.66 toks/s]
Processed prompts:  10%|█         | 106/1024 [00:01<00:19, 47.79it/s, est. speed input: 64536.73 toks/s, output: 63.02 toks/s]
Processed prompts:  11%|█         | 114/1024 [00:01<00:20, 45.26it/s, est. speed input: 61662.23 toks/s, output: 60.22 toks/s]
Processed prompts:  12%|█▏        | 122/1024 [00:02<00:20, 43.26it/s, est. speed input: 59356.46 toks/s, output: 57.96 toks/s]
Processed prompts:  13%|█▎        | 130/1024 [00:02<00:21, 41.72it/s, est. speed input: 57457.99 toks/s, output: 56.11 toks/s]
Processed prompts:  13%|█▎        | 138/1024 [00:02<00:21, 40.61it/s, est. speed input: 55886.09 toks/s, output: 54.58 toks/s]
Processed prompts:  14%|█▍        | 146/1024 [00:02<00:22, 39.80it/s, est. speed input: 54561.84 toks/s, output: 53.28 toks/s]
Processed prompts:  15%|█▌        | 154/1024 [00:02<00:22, 39.23it/s, est. speed input: 53428.44 toks/s, output: 52.18 toks/s]
Processed prompts:  16%|█▌        | 162/1024 [00:03<00:22, 38.80it/s, est. speed input: 52440.37 toks/s, output: 51.21 toks/s]
Processed prompts:  17%|█▋        | 170/1024 [00:03<00:22, 38.50it/s, est. speed input: 51577.92 toks/s, output: 50.37 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [00:03<00:22, 38.28it/s, est. speed input: 50815.45 toks/s, output: 49.62 toks/s]
Processed prompts:  18%|█▊        | 186/1024 [00:03<00:21, 38.13it/s, est. speed input: 50139.18 toks/s, output: 48.96 toks/s]
Processed prompts:  19%|█▉        | 194/1024 [00:04<00:21, 38.05it/s, est. speed input: 49539.44 toks/s, output: 48.38 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [00:04<00:21, 37.98it/s, est. speed input: 48997.35 toks/s, output: 47.85 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:04<00:21, 37.90it/s, est. speed input: 48500.72 toks/s, output: 47.36 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [00:04<00:21, 37.88it/s, est. speed input: 48055.99 toks/s, output: 46.93 toks/s]
Processed prompts:  22%|██▏       | 226/1024 [00:04<00:21, 37.88it/s, est. speed input: 47652.53 toks/s, output: 46.54 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:05<00:20, 37.86it/s, est. speed input: 47280.71 toks/s, output: 46.17 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:05<00:20, 37.86it/s, est. speed input: 46940.47 toks/s, output: 45.84 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:05<00:20, 37.84it/s, est. speed input: 46622.10 toks/s, output: 45.53 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:05<00:20, 37.84it/s, est. speed input: 46330.55 toks/s, output: 45.24 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:05<00:20, 37.84it/s, est. speed input: 46059.75 toks/s, output: 44.98 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:06<00:19, 37.83it/s, est. speed input: 45805.11 toks/s, output: 44.73 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:06<00:19, 37.79it/s, est. speed input: 45564.55 toks/s, output: 44.50 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:06<00:19, 37.79it/s, est. speed input: 45342.79 toks/s, output: 44.28 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:06<00:19, 37.81it/s, est. speed input: 45136.39 toks/s, output: 44.08 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:06<00:18, 37.81it/s, est. speed input: 44942.18 toks/s, output: 43.89 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:07<00:18, 37.80it/s, est. speed input: 44757.97 toks/s, output: 43.71 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:07<00:18, 37.79it/s, est. speed input: 44583.15 toks/s, output: 43.54 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:07<00:18, 37.80it/s, est. speed input: 44420.68 toks/s, output: 43.38 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:07<00:18, 37.81it/s, est. speed input: 44266.60 toks/s, output: 43.23 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:08<00:17, 37.83it/s, est. speed input: 44122.70 toks/s, output: 43.09 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:08<00:17, 37.82it/s, est. speed input: 43983.76 toks/s, output: 42.95 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:08<00:17, 37.79it/s, est. speed input: 43849.03 toks/s, output: 42.82 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:08<00:17, 37.78it/s, est. speed input: 43722.59 toks/s, output: 42.70 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:08<00:17, 37.77it/s, est. speed input: 43601.22 toks/s, output: 42.58 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:09<00:16, 37.78it/s, est. speed input: 43487.74 toks/s, output: 42.47 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [00:09<00:16, 37.79it/s, est. speed input: 43378.73 toks/s, output: 42.36 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:09<00:16, 37.76it/s, est. speed input: 43272.66 toks/s, output: 42.26 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:09<00:16, 37.78it/s, est. speed input: 43173.74 toks/s, output: 42.16 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:09<00:16, 37.80it/s, est. speed input: 43079.66 toks/s, output: 42.07 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:10<00:15, 37.81it/s, est. speed input: 42988.89 toks/s, output: 41.98 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:10<00:15, 37.76it/s, est. speed input: 42898.03 toks/s, output: 41.89 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:10<00:15, 37.77it/s, est. speed input: 42814.19 toks/s, output: 41.81 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:10<00:15, 37.78it/s, est. speed input: 42733.16 toks/s, output: 41.73 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:10<00:14, 37.78it/s, est. speed input: 42655.78 toks/s, output: 41.66 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:11<00:14, 37.78it/s, est. speed input: 42580.65 toks/s, output: 41.58 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:11<00:14, 37.77it/s, est. speed input: 42507.39 toks/s, output: 41.51 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:11<00:14, 37.77it/s, est. speed input: 42437.99 toks/s, output: 41.44 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:11<00:14, 37.78it/s, est. speed input: 42371.06 toks/s, output: 41.38 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:12<00:13, 37.77it/s, est. speed input: 42306.03 toks/s, output: 41.31 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:12<00:13, 37.77it/s, est. speed input: 42243.54 toks/s, output: 41.25 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:12<00:13, 37.76it/s, est. speed input: 42181.96 toks/s, output: 41.19 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:12<00:13, 37.75it/s, est. speed input: 42122.60 toks/s, output: 41.14 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:12<00:13, 37.73it/s, est. speed input: 42064.39 toks/s, output: 41.08 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:13<00:12, 37.74it/s, est. speed input: 42009.51 toks/s, output: 41.02 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:13<00:12, 37.71it/s, est. speed input: 41954.42 toks/s, output: 40.97 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:13<00:12, 37.70it/s, est. speed input: 41901.52 toks/s, output: 40.92 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:13<00:12, 37.70it/s, est. speed input: 41850.55 toks/s, output: 40.87 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:13<00:12, 37.70it/s, est. speed input: 41801.02 toks/s, output: 40.82 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:14<00:11, 37.69it/s, est. speed input: 41752.95 toks/s, output: 40.77 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:14<00:11, 37.68it/s, est. speed input: 41705.78 toks/s, output: 40.73 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:14<00:11, 37.67it/s, est. speed input: 41660.02 toks/s, output: 40.68 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:14<00:11, 37.66it/s, est. speed input: 41615.20 toks/s, output: 40.64 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:15<00:10, 37.67it/s, est. speed input: 41572.41 toks/s, output: 40.60 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:15<00:10, 37.66it/s, est. speed input: 41530.25 toks/s, output: 40.56 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:15<00:10, 37.64it/s, est. speed input: 41488.40 toks/s, output: 40.52 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:15<00:10, 37.65it/s, est. speed input: 41448.99 toks/s, output: 40.48 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:15<00:10, 37.67it/s, est. speed input: 41411.17 toks/s, output: 40.44 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:16<00:09, 37.67it/s, est. speed input: 41373.71 toks/s, output: 40.40 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:16<00:09, 37.67it/s, est. speed input: 41337.30 toks/s, output: 40.37 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:16<00:09, 37.65it/s, est. speed input: 41300.96 toks/s, output: 40.33 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:16<00:09, 37.66it/s, est. speed input: 41266.28 toks/s, output: 40.30 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:16<00:09, 37.65it/s, est. speed input: 41231.81 toks/s, output: 40.27 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:17<00:08, 37.66it/s, est. speed input: 41199.07 toks/s, output: 40.23 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:17<00:08, 37.66it/s, est. speed input: 41166.72 toks/s, output: 40.20 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:17<00:08, 37.67it/s, est. speed input: 41136.02 toks/s, output: 40.17 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:17<00:08, 37.69it/s, est. speed input: 41106.11 toks/s, output: 40.14 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:17<00:08, 37.70it/s, est. speed input: 41076.90 toks/s, output: 40.11 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:18<00:07, 37.69it/s, est. speed input: 41047.60 toks/s, output: 40.09 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:18<00:07, 37.67it/s, est. speed input: 41018.65 toks/s, output: 40.06 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:18<00:07, 37.66it/s, est. speed input: 40990.27 toks/s, output: 40.03 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:18<00:07, 37.66it/s, est. speed input: 40963.08 toks/s, output: 40.00 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:19<00:06, 37.65it/s, est. speed input: 40935.67 toks/s, output: 39.98 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:19<00:06, 37.65it/s, est. speed input: 40909.61 toks/s, output: 39.95 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:19<00:06, 37.66it/s, est. speed input: 40884.09 toks/s, output: 39.93 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:19<00:06, 37.67it/s, est. speed input: 40859.60 toks/s, output: 39.90 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:19<00:06, 37.68it/s, est. speed input: 40835.59 toks/s, output: 39.88 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:20<00:05, 37.70it/s, est. speed input: 40812.44 toks/s, output: 39.86 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:20<00:05, 37.67it/s, est. speed input: 40788.52 toks/s, output: 39.83 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:20<00:05, 37.68it/s, est. speed input: 40765.77 toks/s, output: 39.81 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:20<00:05, 37.68it/s, est. speed input: 40743.62 toks/s, output: 39.79 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:20<00:05, 37.69it/s, est. speed input: 40722.21 toks/s, output: 39.77 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [00:21<00:04, 37.68it/s, est. speed input: 40700.27 toks/s, output: 39.75 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [00:21<00:04, 37.67it/s, est. speed input: 40679.03 toks/s, output: 39.73 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:21<00:04, 37.66it/s, est. speed input: 40658.09 toks/s, output: 39.71 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [00:21<00:04, 37.67it/s, est. speed input: 40638.03 toks/s, output: 39.69 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [00:22<00:03, 37.68it/s, est. speed input: 40618.53 toks/s, output: 39.67 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [00:22<00:03, 37.68it/s, est. speed input: 40599.12 toks/s, output: 39.65 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [00:22<00:03, 37.68it/s, est. speed input: 40580.13 toks/s, output: 39.63 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [00:22<00:03, 37.67it/s, est. speed input: 40561.03 toks/s, output: 39.61 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [00:22<00:03, 37.68it/s, est. speed input: 40543.05 toks/s, output: 39.59 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [00:23<00:02, 37.68it/s, est. speed input: 40525.10 toks/s, output: 39.58 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [00:23<00:02, 37.67it/s, est. speed input: 40506.93 toks/s, output: 39.56 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [00:23<00:02, 37.67it/s, est. speed input: 40489.45 toks/s, output: 39.54 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [00:23<00:02, 37.66it/s, est. speed input: 40472.02 toks/s, output: 39.52 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [00:23<00:02, 37.69it/s, est. speed input: 40455.95 toks/s, output: 39.51 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [00:24<00:01, 37.67it/s, est. speed input: 40438.92 toks/s, output: 39.49 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [00:24<00:01, 37.64it/s, est. speed input: 40421.87 toks/s, output: 39.47 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [00:24<00:01, 37.63it/s, est. speed input: 40405.64 toks/s, output: 39.46 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [00:24<00:01, 37.66it/s, est. speed input: 40390.15 toks/s, output: 39.44 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [00:25<00:01, 37.67it/s, est. speed input: 40375.00 toks/s, output: 39.43 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [00:25<00:00, 37.66it/s, est. speed input: 40359.52 toks/s, output: 39.41 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [00:25<00:00, 37.64it/s, est. speed input: 40343.83 toks/s, output: 39.40 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [00:25<00:00, 37.65it/s, est. speed input: 40329.38 toks/s, output: 39.38 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [00:25<00:00, 38.67it/s, est. speed input: 40343.79 toks/s, output: 39.40 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:25<00:00, 38.67it/s, est. speed input: 40581.38 toks/s, output: 39.63 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:25<00:00, 39.63it/s, est. speed input: 40581.38 toks/s, output: 39.63 toks/s]
[rank0]:[W128 00:59:32.841686794 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 52.1s

测试结果:
  Requests/s:   37.64
  Tokens/s:     38585.45
  Total Reqs:   1024
  Elapsed:      27.20s

  [Prefill 分析]
  Total Prefill Tokens: 1048576
  Prefill Tokens/s:     38547.80

============================================================
[6/7] 测试 M=16384
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 16384
│   M_prefill     = 16384 (= 16 x 1024)
│   M_decode      = 16
│   batched_tokens = 16384 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 2048
│   --max-num-seqs           = 16
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 16384
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:59:42 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3518133) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3518133) WARNING 01-28 00:59:51 [backends.py:609] Failed to read file <frozen os>
Throughput: 36.96 requests/s, 37888.59 total tokens/s, 36.96 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048


─── STDERR ───
[2026-01-28 00:59:42] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:59:42] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:59:42] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:59:42] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:59:42] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:59:42] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:59:42] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:59:42] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:59:42] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:59:42] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:59:42] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:59:42] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:59:42] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:59:42] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:59:46] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:59:46] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 00:59:46] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 00:59:46] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:59:46] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:59:46] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:59:46] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:59:46] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 00:59:46] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 00:59:46] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:59:46] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:59:46] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:59:46] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:59:46] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3518133) [2026-01-28 00:59:47] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3518133) [2026-01-28 00:59:47] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3518133) [2026-01-28 00:59:47] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3518133) [2026-01-28 00:59:47] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=3518133) [2026-01-28 00:59:47] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3518133) [2026-01-28 00:59:47] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3518133) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3518133) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.82it/s]
(EngineCore_DP0 pid=3518133) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.81it/s]
(EngineCore_DP0 pid=3518133) 
(EngineCore_DP0 pid=3518133) [2026-01-28 00:59:47] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 3840] -> 1D uint8
(EngineCore_DP0 pid=3518133) [2026-01-28 00:59:47] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 9216000 bytes
(EngineCore_DP0 pid=3518133) [2026-01-28 00:59:47] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 3840] -> 1D uint8
(EngineCore_DP0 pid=3518133) [2026-01-28 00:59:47] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 6144000 bytes
(EngineCore_DP0 pid=3518133) [2026-01-28 00:59:47] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 3840] -> 1D uint8
(EngineCore_DP0 pid=3518133) [2026-01-28 00:59:47] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 33177600 bytes
(EngineCore_DP0 pid=3518133) [2026-01-28 00:59:47] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 10368] -> 1D uint8
(EngineCore_DP0 pid=3518133) [2026-01-28 00:59:47] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 16588800 bytes
(EngineCore_DP0 pid=3518133) 2026-01-28 00:59:57,693 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3518133) 2026-01-28 00:59:57,709 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3518133) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  14%|█▍        | 1/7 [00:00<00:01,  4.67it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  57%|█████▋    | 4/7 [00:00<00:00, 13.81it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00, 18.11it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00, 15.44it/s]
(EngineCore_DP0 pid=3518133) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  20%|██        | 1/5 [00:00<00:00,  7.36it/s]
Capturing CUDA graphs (decode, FULL):  80%|████████  | 4/5 [00:00<00:00, 18.81it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00, 18.41it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   4%|▎         | 72/2048 [00:00<00:02, 717.46it/s]
Adding requests:   7%|▋         | 147/2048 [00:00<00:02, 735.21it/s]
Adding requests:  11%|█         | 222/2048 [00:00<00:02, 740.51it/s]
Adding requests:  15%|█▍        | 297/2048 [00:00<00:02, 743.88it/s]
Adding requests:  18%|█▊        | 372/2048 [00:00<00:02, 737.17it/s]
Adding requests:  22%|██▏       | 447/2048 [00:00<00:02, 739.11it/s]
Adding requests:  25%|██▌       | 521/2048 [00:00<00:02, 735.59it/s]
Adding requests:  29%|██▉       | 597/2048 [00:00<00:01, 741.54it/s]
Adding requests:  33%|███▎      | 675/2048 [00:00<00:01, 753.06it/s]
Adding requests:  37%|███▋      | 751/2048 [00:01<00:01, 750.19it/s]
Adding requests:  40%|████      | 827/2048 [00:01<00:01, 730.41it/s]
Adding requests:  44%|████▍     | 904/2048 [00:01<00:01, 741.37it/s]
Adding requests:  48%|████▊     | 979/2048 [00:01<00:01, 740.85it/s]
Adding requests:  52%|█████▏    | 1055/2048 [00:01<00:01, 743.24it/s]
Adding requests:  55%|█████▌    | 1130/2048 [00:01<00:01, 735.77it/s]
Adding requests:  59%|█████▉    | 1208/2048 [00:01<00:01, 746.49it/s]
Adding requests:  63%|██████▎   | 1283/2048 [00:01<00:01, 742.27it/s]
Adding requests:  66%|██████▋   | 1361/2048 [00:01<00:00, 752.05it/s]
Adding requests:  70%|███████   | 1440/2048 [00:01<00:00, 761.23it/s]
Adding requests:  74%|███████▍  | 1519/2048 [00:02<00:00, 768.06it/s]
Adding requests:  78%|███████▊  | 1600/2048 [00:02<00:00, 778.65it/s]
Adding requests:  82%|████████▏ | 1678/2048 [00:02<00:00, 775.80it/s]
Adding requests:  86%|████████▌ | 1756/2048 [00:02<00:00, 766.70it/s]
Adding requests:  90%|████████▉ | 1833/2048 [00:02<00:00, 758.71it/s]
Adding requests:  93%|█████████▎| 1909/2048 [00:02<00:00, 754.07it/s]
Adding requests:  97%|█████████▋| 1985/2048 [00:02<00:00, 740.56it/s]
Adding requests: 100%|██████████| 2048/2048 [00:02<00:00, 748.28it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▍         | 98/2048 [00:00<00:07, 269.68it/s, est. speed input: 276163.82 toks/s, output: 269.68 toks/s]
Processed prompts:   6%|▌         | 125/2048 [00:00<00:13, 139.53it/s, est. speed input: 161177.24 toks/s, output: 157.40 toks/s]
Processed prompts:   7%|▋         | 140/2048 [00:01<00:21, 89.94it/s, est. speed input: 116996.00 toks/s, output: 114.25 toks/s] 
Processed prompts:   7%|▋         | 150/2048 [00:01<00:30, 63.02it/s, est. speed input: 92729.72 toks/s, output: 90.56 toks/s]  
Processed prompts:   8%|▊         | 162/2048 [00:02<00:37, 50.16it/s, est. speed input: 79471.24 toks/s, output: 77.61 toks/s]
Processed prompts:   9%|▊         | 178/2048 [00:02<00:40, 45.69it/s, est. speed input: 72380.75 toks/s, output: 70.68 toks/s]
Processed prompts:   9%|▉         | 194/2048 [00:02<00:43, 42.87it/s, est. speed input: 67352.85 toks/s, output: 65.77 toks/s]
Processed prompts:  10%|█         | 210/2048 [00:03<00:44, 41.02it/s, est. speed input: 63607.66 toks/s, output: 62.12 toks/s]
Processed prompts:  11%|█         | 226/2048 [00:03<00:45, 39.80it/s, est. speed input: 60714.43 toks/s, output: 59.29 toks/s]
Processed prompts:  12%|█▏        | 242/2048 [00:04<00:46, 38.96it/s, est. speed input: 58404.12 toks/s, output: 57.04 toks/s]
Processed prompts:  13%|█▎        | 258/2048 [00:04<00:46, 38.31it/s, est. speed input: 56485.00 toks/s, output: 55.16 toks/s]
Processed prompts:  13%|█▎        | 274/2048 [00:05<00:46, 37.95it/s, est. speed input: 54924.39 toks/s, output: 53.64 toks/s]
Processed prompts:  14%|█▍        | 290/2048 [00:05<00:46, 37.68it/s, est. speed input: 53602.05 toks/s, output: 52.35 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [00:05<00:46, 37.50it/s, est. speed input: 52473.05 toks/s, output: 51.24 toks/s]
Processed prompts:  16%|█▌        | 322/2048 [00:06<00:46, 37.37it/s, est. speed input: 51494.28 toks/s, output: 50.29 toks/s]
Processed prompts:  17%|█▋        | 338/2048 [00:06<00:45, 37.28it/s, est. speed input: 50639.57 toks/s, output: 49.45 toks/s]
Processed prompts:  17%|█▋        | 354/2048 [00:07<00:45, 37.20it/s, est. speed input: 49882.39 toks/s, output: 48.71 toks/s]
Processed prompts:  18%|█▊        | 370/2048 [00:07<00:45, 37.15it/s, est. speed input: 49212.35 toks/s, output: 48.06 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [00:08<00:44, 37.13it/s, est. speed input: 48615.89 toks/s, output: 47.48 toks/s]
Processed prompts:  20%|█▉        | 402/2048 [00:08<00:44, 37.11it/s, est. speed input: 48076.92 toks/s, output: 46.95 toks/s]
Processed prompts:  20%|██        | 418/2048 [00:08<00:43, 37.09it/s, est. speed input: 47591.18 toks/s, output: 46.48 toks/s]
Processed prompts:  21%|██        | 434/2048 [00:09<00:43, 37.07it/s, est. speed input: 47146.80 toks/s, output: 46.04 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [00:09<00:43, 37.06it/s, est. speed input: 46741.97 toks/s, output: 45.65 toks/s]
Processed prompts:  23%|██▎       | 466/2048 [00:10<00:42, 37.04it/s, est. speed input: 46369.95 toks/s, output: 45.28 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [00:10<00:42, 37.03it/s, est. speed input: 46028.02 toks/s, output: 44.95 toks/s]
Processed prompts:  24%|██▍       | 498/2048 [00:11<00:41, 37.02it/s, est. speed input: 45713.16 toks/s, output: 44.64 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [00:11<00:41, 37.02it/s, est. speed input: 45421.71 toks/s, output: 44.36 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [00:12<00:41, 37.02it/s, est. speed input: 45151.53 toks/s, output: 44.09 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [00:12<00:40, 37.01it/s, est. speed input: 44898.94 toks/s, output: 43.85 toks/s]
Processed prompts:  27%|██▋       | 562/2048 [00:12<00:40, 37.00it/s, est. speed input: 44663.16 toks/s, output: 43.62 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [00:13<00:39, 37.00it/s, est. speed input: 44442.83 toks/s, output: 43.40 toks/s]
Processed prompts:  29%|██▉       | 594/2048 [00:13<00:39, 37.00it/s, est. speed input: 44236.31 toks/s, output: 43.20 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [00:14<00:38, 36.99it/s, est. speed input: 44041.81 toks/s, output: 43.01 toks/s]
Processed prompts:  31%|███       | 626/2048 [00:14<00:38, 36.99it/s, est. speed input: 43859.60 toks/s, output: 42.83 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [00:15<00:38, 37.00it/s, est. speed input: 43688.05 toks/s, output: 42.66 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [00:15<00:37, 36.99it/s, est. speed input: 43525.19 toks/s, output: 42.51 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [00:15<00:37, 37.00it/s, est. speed input: 43372.82 toks/s, output: 42.36 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [00:16<00:36, 37.00it/s, est. speed input: 43227.62 toks/s, output: 42.21 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [00:16<00:36, 37.00it/s, est. speed input: 43089.98 toks/s, output: 42.08 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [00:17<00:35, 37.01it/s, est. speed input: 42959.98 toks/s, output: 41.95 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [00:17<00:35, 37.00it/s, est. speed input: 42835.25 toks/s, output: 41.83 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [00:18<00:34, 37.01it/s, est. speed input: 42717.38 toks/s, output: 41.72 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [00:18<00:34, 37.00it/s, est. speed input: 42604.30 toks/s, output: 41.61 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [00:18<00:34, 37.01it/s, est. speed input: 42497.04 toks/s, output: 41.50 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [00:19<00:33, 36.99it/s, est. speed input: 42393.39 toks/s, output: 41.40 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [00:19<00:33, 36.99it/s, est. speed input: 42294.86 toks/s, output: 41.30 toks/s]
Processed prompts:  41%|████      | 834/2048 [00:20<00:32, 36.99it/s, est. speed input: 42200.46 toks/s, output: 41.21 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [00:20<00:32, 37.00it/s, est. speed input: 42110.59 toks/s, output: 41.12 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [00:21<00:31, 37.00it/s, est. speed input: 42024.42 toks/s, output: 41.04 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [00:21<00:31, 37.00it/s, est. speed input: 41941.11 toks/s, output: 40.96 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [00:21<00:31, 37.00it/s, est. speed input: 41861.55 toks/s, output: 40.88 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [00:22<00:30, 37.00it/s, est. speed input: 41784.33 toks/s, output: 40.80 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [00:22<00:30, 36.99it/s, est. speed input: 41710.39 toks/s, output: 40.73 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [00:23<00:29, 36.99it/s, est. speed input: 41638.97 toks/s, output: 40.66 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [00:23<00:29, 37.00it/s, est. speed input: 41570.64 toks/s, output: 40.60 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [00:24<00:28, 37.00it/s, est. speed input: 41504.55 toks/s, output: 40.53 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [00:24<00:28, 36.98it/s, est. speed input: 41440.01 toks/s, output: 40.47 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [00:24<00:28, 36.99it/s, est. speed input: 41378.53 toks/s, output: 40.41 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [00:25<00:27, 36.98it/s, est. speed input: 41318.46 toks/s, output: 40.35 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [00:25<00:27, 36.99it/s, est. speed input: 41261.07 toks/s, output: 40.29 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [00:26<00:26, 36.99it/s, est. speed input: 41205.60 toks/s, output: 40.24 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [00:26<00:26, 36.99it/s, est. speed input: 41151.65 toks/s, output: 40.19 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [00:27<00:25, 36.99it/s, est. speed input: 41099.46 toks/s, output: 40.14 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [00:27<00:25, 36.99it/s, est. speed input: 41048.73 toks/s, output: 40.09 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [00:28<00:25, 36.99it/s, est. speed input: 40999.97 toks/s, output: 40.04 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [00:28<00:24, 36.98it/s, est. speed input: 40952.22 toks/s, output: 39.99 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [00:28<00:23, 37.55it/s, est. speed input: 40936.93 toks/s, output: 39.98 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [00:29<00:23, 37.37it/s, est. speed input: 40891.34 toks/s, output: 39.93 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [00:29<00:23, 37.26it/s, est. speed input: 40847.71 toks/s, output: 39.89 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [00:30<00:22, 37.19it/s, est. speed input: 40805.64 toks/s, output: 39.85 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [00:30<00:22, 37.12it/s, est. speed input: 40763.94 toks/s, output: 39.81 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [00:31<00:21, 37.09it/s, est. speed input: 40723.81 toks/s, output: 39.77 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [00:31<00:21, 37.05it/s, est. speed input: 40684.27 toks/s, output: 39.73 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [00:31<00:21, 37.03it/s, est. speed input: 40646.05 toks/s, output: 39.69 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [00:32<00:20, 37.01it/s, est. speed input: 40608.79 toks/s, output: 39.66 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [00:32<00:20, 37.00it/s, est. speed input: 40572.38 toks/s, output: 39.62 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [00:33<00:19, 37.00it/s, est. speed input: 40537.62 toks/s, output: 39.59 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [00:33<00:19, 37.00it/s, est. speed input: 40503.45 toks/s, output: 39.55 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [00:34<00:18, 37.00it/s, est. speed input: 40470.35 toks/s, output: 39.52 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [00:34<00:18, 36.98it/s, est. speed input: 40437.14 toks/s, output: 39.49 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [00:34<00:18, 36.98it/s, est. speed input: 40405.34 toks/s, output: 39.46 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [00:35<00:17, 36.98it/s, est. speed input: 40374.18 toks/s, output: 39.43 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [00:35<00:17, 36.99it/s, est. speed input: 40344.24 toks/s, output: 39.40 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [00:36<00:16, 36.99it/s, est. speed input: 40314.77 toks/s, output: 39.37 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [00:36<00:16, 36.98it/s, est. speed input: 40285.73 toks/s, output: 39.34 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [00:37<00:15, 36.99it/s, est. speed input: 40258.00 toks/s, output: 39.31 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [00:37<00:15, 36.98it/s, est. speed input: 40230.06 toks/s, output: 39.29 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [00:37<00:15, 36.98it/s, est. speed input: 40203.26 toks/s, output: 39.26 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [00:38<00:14, 36.98it/s, est. speed input: 40176.86 toks/s, output: 39.24 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [00:38<00:14, 36.98it/s, est. speed input: 40151.02 toks/s, output: 39.21 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [00:39<00:13, 36.98it/s, est. speed input: 40125.97 toks/s, output: 39.19 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [00:39<00:13, 36.98it/s, est. speed input: 40101.40 toks/s, output: 39.16 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [00:40<00:12, 36.99it/s, est. speed input: 40077.54 toks/s, output: 39.14 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [00:40<00:12, 36.98it/s, est. speed input: 40053.87 toks/s, output: 39.12 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [00:40<00:12, 36.98it/s, est. speed input: 40030.86 toks/s, output: 39.09 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [00:41<00:11, 36.99it/s, est. speed input: 40008.46 toks/s, output: 39.07 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [00:41<00:11, 36.99it/s, est. speed input: 39986.41 toks/s, output: 39.05 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [00:42<00:10, 36.98it/s, est. speed input: 39964.68 toks/s, output: 39.03 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [00:42<00:10, 36.99it/s, est. speed input: 39943.67 toks/s, output: 39.01 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [00:43<00:09, 37.00it/s, est. speed input: 39923.20 toks/s, output: 38.99 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [00:43<00:09, 36.98it/s, est. speed input: 39902.54 toks/s, output: 38.97 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [00:44<00:09, 37.00it/s, est. speed input: 39882.99 toks/s, output: 38.95 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [00:44<00:08, 36.99it/s, est. speed input: 39863.20 toks/s, output: 38.93 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [00:44<00:08, 36.99it/s, est. speed input: 39844.06 toks/s, output: 38.91 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [00:45<00:07, 36.98it/s, est. speed input: 39824.98 toks/s, output: 38.89 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [00:45<00:07, 36.99it/s, est. speed input: 39806.68 toks/s, output: 38.87 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [00:46<00:06, 36.99it/s, est. speed input: 39788.62 toks/s, output: 38.86 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [00:46<00:06, 36.98it/s, est. speed input: 39770.66 toks/s, output: 38.84 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [00:47<00:06, 36.98it/s, est. speed input: 39753.17 toks/s, output: 38.82 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [00:47<00:05, 36.97it/s, est. speed input: 39735.78 toks/s, output: 38.80 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [00:47<00:05, 36.98it/s, est. speed input: 39719.11 toks/s, output: 38.79 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [00:48<00:04, 37.64it/s, est. speed input: 39723.31 toks/s, output: 38.79 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [00:48<00:04, 37.45it/s, est. speed input: 39707.14 toks/s, output: 38.78 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [00:49<00:03, 37.30it/s, est. speed input: 39690.76 toks/s, output: 38.76 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [00:49<00:03, 37.20it/s, est. speed input: 39674.73 toks/s, output: 38.74 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [00:50<00:02, 37.14it/s, est. speed input: 39659.25 toks/s, output: 38.73 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [00:50<00:02, 37.08it/s, est. speed input: 39643.69 toks/s, output: 38.71 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [00:50<00:02, 37.06it/s, est. speed input: 39628.68 toks/s, output: 38.70 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [00:51<00:01, 37.02it/s, est. speed input: 39613.59 toks/s, output: 38.69 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [00:51<00:01, 37.01it/s, est. speed input: 39599.01 toks/s, output: 38.67 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [00:52<00:00, 37.01it/s, est. speed input: 39584.97 toks/s, output: 38.66 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [00:52<00:00, 36.22it/s, est. speed input: 39547.46 toks/s, output: 38.62 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:52<00:00, 36.22it/s, est. speed input: 39819.53 toks/s, output: 38.89 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:52<00:00, 38.89it/s, est. speed input: 39819.53 toks/s, output: 38.89 toks/s]
[rank0]:[W128 01:00:54.778775867 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 82.9s

测试结果:
  Requests/s:   36.96
  Tokens/s:     37888.59
  Total Reqs:   2048
  Elapsed:      55.40s

  [Prefill 分析]
  Total Prefill Tokens: 2097152
  Prefill Tokens/s:     37851.63

============================================================
[7/7] 测试 M=32768
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 32768
│   M_prefill     = 32768 (= 32 x 1024)
│   M_decode      = 32
│   batched_tokens = 32768 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 4096
│   --max-num-seqs           = 32
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 32768
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 01:01:11 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3519614) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3519614) WARNING 01-28 01:01:20 [backends.py:609] Failed to read file <frozen os>
Throughput: 36.98 requests/s, 37903.58 total tokens/s, 36.98 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096


─── STDERR ───
[2026-01-28 01:01:11] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 01:01:11] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 01:01:11] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 01:01:11] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:01:11] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:01:11] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:01:11] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:01:11] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:01:11] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 01:01:11] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 01:01:11] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 01:01:11] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 01:01:11] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 01:01:11] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 01:01:15] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 01:01:15] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 01:01:15] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 01:01:15] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:01:15] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:01:15] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:01:15] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:01:15] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:01:15] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 01:01:15] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 01:01:15] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 01:01:15] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 01:01:15] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 01:01:15] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3519614) [2026-01-28 01:01:16] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3519614) [2026-01-28 01:01:16] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3519614) [2026-01-28 01:01:16] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3519614) [2026-01-28 01:01:16] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=3519614) [2026-01-28 01:01:16] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3519614) [2026-01-28 01:01:16] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3519614) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3519614) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.78it/s]
(EngineCore_DP0 pid=3519614) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.78it/s]
(EngineCore_DP0 pid=3519614) 
(EngineCore_DP0 pid=3519614) [2026-01-28 01:01:16] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 3840] -> 1D uint8
(EngineCore_DP0 pid=3519614) [2026-01-28 01:01:16] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 9216000 bytes
(EngineCore_DP0 pid=3519614) [2026-01-28 01:01:16] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 3840] -> 1D uint8
(EngineCore_DP0 pid=3519614) [2026-01-28 01:01:16] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 6144000 bytes
(EngineCore_DP0 pid=3519614) [2026-01-28 01:01:16] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 3840] -> 1D uint8
(EngineCore_DP0 pid=3519614) [2026-01-28 01:01:16] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 33177600 bytes
(EngineCore_DP0 pid=3519614) [2026-01-28 01:01:16] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 10368] -> 1D uint8
(EngineCore_DP0 pid=3519614) [2026-01-28 01:01:16] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 16588800 bytes
(EngineCore_DP0 pid=3519614) [rank0]:W0128 01:01:23.808000 3519614 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=3519614) [rank0]:W0128 01:01:23.857000 3519614 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=3519614) [rank0]:W0128 01:01:24.579000 3519614 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=3519614) [rank0]:W0128 01:01:24.656000 3519614 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=3519614) 2026-01-28 01:01:27,097 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3519614) 2026-01-28 01:01:27,120 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3519614) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   9%|▉         | 1/11 [00:00<00:06,  1.62it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  36%|███▋      | 4/11 [00:00<00:01,  6.54it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  64%|██████▎   | 7/11 [00:00<00:00, 10.83it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  91%|█████████ | 10/11 [00:00<00:00, 14.77it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00, 10.69it/s]
(EngineCore_DP0 pid=3519614) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  14%|█▍        | 1/7 [00:00<00:00,  7.26it/s]
Capturing CUDA graphs (decode, FULL):  57%|█████▋    | 4/7 [00:00<00:00, 18.52it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00, 23.12it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00, 20.40it/s]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 71/4096 [00:00<00:05, 709.65it/s]
Adding requests:   4%|▎         | 146/4096 [00:00<00:05, 732.12it/s]
Adding requests:   5%|▌         | 221/4096 [00:00<00:05, 737.11it/s]
Adding requests:   7%|▋         | 299/4096 [00:00<00:05, 752.29it/s]
Adding requests:   9%|▉         | 375/4096 [00:00<00:04, 747.32it/s]
Adding requests:  11%|█         | 451/4096 [00:00<00:04, 748.76it/s]
Adding requests:  13%|█▎        | 526/4096 [00:00<00:04, 738.40it/s]
Adding requests:  15%|█▍        | 602/4096 [00:00<00:04, 743.60it/s]
Adding requests:  17%|█▋        | 682/4096 [00:00<00:04, 759.35it/s]
Adding requests:  19%|█▊        | 758/4096 [00:01<00:04, 755.21it/s]
Adding requests:  20%|██        | 834/4096 [00:01<00:04, 737.22it/s]
Adding requests:  22%|██▏       | 914/4096 [00:01<00:04, 752.47it/s]
Adding requests:  24%|██▍       | 993/4096 [00:01<00:04, 761.40it/s]
Adding requests:  26%|██▌       | 1071/4096 [00:01<00:03, 763.65it/s]
Adding requests:  28%|██▊       | 1148/4096 [00:01<00:03, 745.30it/s]
Adding requests:  30%|██▉       | 1225/4096 [00:01<00:03, 750.56it/s]
Adding requests:  32%|███▏      | 1301/4096 [00:01<00:03, 749.76it/s]
Adding requests:  34%|███▎      | 1379/4096 [00:01<00:03, 757.55it/s]
Adding requests:  36%|███▌      | 1457/4096 [00:01<00:03, 761.90it/s]
Adding requests:  38%|███▊      | 1537/4096 [00:02<00:03, 770.73it/s]
Adding requests:  39%|███▉      | 1615/4096 [00:02<00:03, 769.66it/s]
Adding requests:  41%|████▏     | 1692/4096 [00:02<00:03, 766.26it/s]
Adding requests:  43%|████▎     | 1771/4096 [00:02<00:03, 771.02it/s]
Adding requests:  45%|████▌     | 1850/4096 [00:02<00:02, 776.50it/s]
Adding requests:  47%|████▋     | 1928/4096 [00:02<00:02, 775.54it/s]
Adding requests:  49%|████▉     | 2008/4096 [00:02<00:02, 781.72it/s]
Adding requests:  51%|█████     | 2087/4096 [00:02<00:02, 781.54it/s]
Adding requests:  53%|█████▎    | 2166/4096 [00:02<00:02, 768.17it/s]
Adding requests:  55%|█████▍    | 2243/4096 [00:02<00:02, 767.16it/s]
Adding requests:  57%|█████▋    | 2320/4096 [00:03<00:02, 756.50it/s]
Adding requests:  58%|█████▊    | 2396/4096 [00:03<00:02, 757.07it/s]
Adding requests:  60%|██████    | 2475/4096 [00:03<00:02, 764.95it/s]
Adding requests:  62%|██████▏   | 2553/4096 [00:03<00:02, 767.46it/s]
Adding requests:  64%|██████▍   | 2630/4096 [00:03<00:01, 765.89it/s]
Adding requests:  66%|██████▌   | 2707/4096 [00:03<00:01, 761.50it/s]
Adding requests:  68%|██████▊   | 2784/4096 [00:03<00:01, 753.29it/s]
Adding requests:  70%|██████▉   | 2860/4096 [00:03<00:01, 753.94it/s]
Adding requests:  72%|███████▏  | 2936/4096 [00:03<00:01, 754.26it/s]
Adding requests:  74%|███████▎  | 3012/4096 [00:03<00:01, 755.25it/s]
Adding requests:  75%|███████▌  | 3089/4096 [00:04<00:01, 757.52it/s]
Adding requests:  77%|███████▋  | 3165/4096 [00:04<00:01, 751.09it/s]
Adding requests:  79%|███████▉  | 3241/4096 [00:04<00:01, 752.57it/s]
Adding requests:  81%|████████  | 3320/4096 [00:04<00:01, 762.83it/s]
Adding requests:  83%|████████▎ | 3397/4096 [00:04<00:00, 764.40it/s]
Adding requests:  85%|████████▍ | 3474/4096 [00:04<00:00, 762.52it/s]
Adding requests:  87%|████████▋ | 3554/4096 [00:04<00:00, 773.28it/s]
Adding requests:  89%|████████▊ | 3632/4096 [00:04<00:00, 770.99it/s]
Adding requests:  91%|█████████ | 3710/4096 [00:04<00:00, 757.05it/s]
Adding requests:  93%|█████████▎| 3789/4096 [00:04<00:00, 765.87it/s]
Adding requests:  94%|█████████▍| 3869/4096 [00:05<00:00, 774.34it/s]
Adding requests:  96%|█████████▋| 3947/4096 [00:05<00:00, 774.31it/s]
Adding requests:  98%|█████████▊| 4026/4096 [00:05<00:00, 776.50it/s]
Adding requests: 100%|██████████| 4096/4096 [00:05<00:00, 761.19it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▍         | 194/4096 [00:00<00:15, 259.78it/s, est. speed input: 266023.25 toks/s, output: 259.79 toks/s]
Processed prompts:   6%|▌         | 226/4096 [00:01<00:31, 121.05it/s, est. speed input: 143718.81 toks/s, output: 140.35 toks/s]
Processed prompts:   6%|▋         | 258/4096 [00:02<00:47, 81.51it/s, est. speed input: 106805.41 toks/s, output: 104.30 toks/s] 
Processed prompts:   7%|▋         | 290/4096 [00:03<00:59, 63.62it/s, est. speed input: 88978.25 toks/s, output: 86.89 toks/s]  
Processed prompts:   8%|▊         | 322/4096 [00:04<01:09, 53.92it/s, est. speed input: 78484.83 toks/s, output: 76.65 toks/s]
Processed prompts:   9%|▊         | 354/4096 [00:05<01:17, 48.12it/s, est. speed input: 71556.31 toks/s, output: 69.88 toks/s]
Processed prompts:   9%|▉         | 386/4096 [00:05<01:23, 44.47it/s, est. speed input: 66653.09 toks/s, output: 65.09 toks/s]
Processed prompts:  10%|█         | 418/4096 [00:06<01:27, 42.09it/s, est. speed input: 62994.17 toks/s, output: 61.52 toks/s]
Processed prompts:  11%|█         | 450/4096 [00:07<01:30, 40.49it/s, est. speed input: 60158.82 toks/s, output: 58.75 toks/s]
Processed prompts:  12%|█▏        | 482/4096 [00:08<01:31, 39.42it/s, est. speed input: 57902.90 toks/s, output: 56.55 toks/s]
Processed prompts:  13%|█▎        | 514/4096 [00:09<01:32, 38.68it/s, est. speed input: 56059.90 toks/s, output: 54.75 toks/s]
Processed prompts:  13%|█▎        | 546/4096 [00:10<01:33, 38.17it/s, est. speed input: 54526.97 toks/s, output: 53.25 toks/s]
Processed prompts:  14%|█▍        | 578/4096 [00:11<01:33, 37.81it/s, est. speed input: 53231.18 toks/s, output: 51.98 toks/s]
Processed prompts:  15%|█▍        | 610/4096 [00:11<01:32, 37.56it/s, est. speed input: 52123.29 toks/s, output: 50.90 toks/s]
Processed prompts:  16%|█▌        | 642/4096 [00:12<01:32, 37.40it/s, est. speed input: 51165.93 toks/s, output: 49.97 toks/s]
Processed prompts:  16%|█▋        | 674/4096 [00:13<01:31, 37.27it/s, est. speed input: 50327.91 toks/s, output: 49.15 toks/s]
Processed prompts:  17%|█▋        | 706/4096 [00:14<01:31, 37.19it/s, est. speed input: 49589.68 toks/s, output: 48.43 toks/s]
Processed prompts:  18%|█▊        | 738/4096 [00:15<01:30, 37.13it/s, est. speed input: 48933.09 toks/s, output: 47.79 toks/s]
Processed prompts:  19%|█▉        | 770/4096 [00:16<01:29, 37.09it/s, est. speed input: 48346.88 toks/s, output: 47.21 toks/s]
Processed prompts:  20%|█▉        | 802/4096 [00:17<01:28, 37.07it/s, est. speed input: 47821.36 toks/s, output: 46.70 toks/s]
Processed prompts:  20%|██        | 834/4096 [00:18<01:28, 37.03it/s, est. speed input: 47342.51 toks/s, output: 46.23 toks/s]
Processed prompts:  21%|██        | 866/4096 [00:18<01:27, 37.02it/s, est. speed input: 46909.53 toks/s, output: 45.81 toks/s]
Processed prompts:  22%|██▏       | 898/4096 [00:19<01:26, 37.01it/s, est. speed input: 46514.49 toks/s, output: 45.42 toks/s]
Processed prompts:  23%|██▎       | 930/4096 [00:20<01:25, 37.01it/s, est. speed input: 46152.34 toks/s, output: 45.07 toks/s]
Processed prompts:  23%|██▎       | 962/4096 [00:21<01:24, 37.00it/s, est. speed input: 45819.91 toks/s, output: 44.75 toks/s]
Processed prompts:  24%|██▍       | 994/4096 [00:22<01:23, 37.00it/s, est. speed input: 45512.64 toks/s, output: 44.45 toks/s]
Processed prompts:  25%|██▌       | 1026/4096 [00:23<01:22, 37.00it/s, est. speed input: 45228.79 toks/s, output: 44.17 toks/s]
Processed prompts:  26%|██▌       | 1058/4096 [00:24<01:22, 37.00it/s, est. speed input: 44964.69 toks/s, output: 43.91 toks/s]
Processed prompts:  27%|██▋       | 1090/4096 [00:24<01:21, 36.99it/s, est. speed input: 44719.07 toks/s, output: 43.67 toks/s]
Processed prompts:  27%|██▋       | 1122/4096 [00:25<01:20, 36.99it/s, est. speed input: 44490.02 toks/s, output: 43.45 toks/s]
Processed prompts:  28%|██▊       | 1154/4096 [00:26<01:18, 37.26it/s, est. speed input: 44310.06 toks/s, output: 43.27 toks/s]
Processed prompts:  29%|██▉       | 1186/4096 [00:27<01:18, 37.19it/s, est. speed input: 44109.02 toks/s, output: 43.08 toks/s]
Processed prompts:  30%|██▉       | 1218/4096 [00:28<01:17, 37.12it/s, est. speed input: 43918.68 toks/s, output: 42.89 toks/s]
Processed prompts:  31%|███       | 1250/4096 [00:29<01:16, 37.08it/s, est. speed input: 43740.14 toks/s, output: 42.71 toks/s]
Processed prompts:  31%|███▏      | 1282/4096 [00:30<01:15, 37.06it/s, est. speed input: 43571.83 toks/s, output: 42.55 toks/s]
Processed prompts:  32%|███▏      | 1314/4096 [00:30<01:15, 37.03it/s, est. speed input: 43412.78 toks/s, output: 42.40 toks/s]
Processed prompts:  33%|███▎      | 1346/4096 [00:31<01:14, 37.02it/s, est. speed input: 43262.42 toks/s, output: 42.25 toks/s]
Processed prompts:  34%|███▎      | 1378/4096 [00:32<01:13, 37.01it/s, est. speed input: 43119.62 toks/s, output: 42.11 toks/s]
Processed prompts:  34%|███▍      | 1410/4096 [00:33<01:12, 37.00it/s, est. speed input: 42984.71 toks/s, output: 41.98 toks/s]
Processed prompts:  35%|███▌      | 1442/4096 [00:34<01:11, 37.00it/s, est. speed input: 42856.64 toks/s, output: 41.85 toks/s]
Processed prompts:  36%|███▌      | 1474/4096 [00:35<01:10, 37.00it/s, est. speed input: 42734.74 toks/s, output: 41.73 toks/s]
Processed prompts:  37%|███▋      | 1506/4096 [00:36<01:10, 36.99it/s, est. speed input: 42618.48 toks/s, output: 41.62 toks/s]
Processed prompts:  38%|███▊      | 1538/4096 [00:37<01:09, 36.99it/s, est. speed input: 42507.68 toks/s, output: 41.51 toks/s]
Processed prompts:  38%|███▊      | 1570/4096 [00:37<01:08, 36.99it/s, est. speed input: 42401.99 toks/s, output: 41.41 toks/s]
Processed prompts:  39%|███▉      | 1602/4096 [00:38<01:07, 36.99it/s, est. speed input: 42300.84 toks/s, output: 41.31 toks/s]
Processed prompts:  40%|███▉      | 1634/4096 [00:39<01:06, 36.98it/s, est. speed input: 42204.00 toks/s, output: 41.21 toks/s]
Processed prompts:  41%|████      | 1666/4096 [00:40<01:05, 36.99it/s, est. speed input: 42111.91 toks/s, output: 41.12 toks/s]
Processed prompts:  41%|████▏     | 1698/4096 [00:41<01:04, 36.99it/s, est. speed input: 42023.14 toks/s, output: 41.04 toks/s]
Processed prompts:  42%|████▏     | 1730/4096 [00:42<01:03, 36.99it/s, est. speed input: 41938.40 toks/s, output: 40.96 toks/s]
Processed prompts:  43%|████▎     | 1762/4096 [00:43<01:03, 36.99it/s, est. speed input: 41856.65 toks/s, output: 40.88 toks/s]
Processed prompts:  44%|████▍     | 1794/4096 [00:43<01:02, 36.98it/s, est. speed input: 41777.98 toks/s, output: 40.80 toks/s]
Processed prompts:  45%|████▍     | 1826/4096 [00:44<01:01, 36.98it/s, est. speed input: 41702.56 toks/s, output: 40.73 toks/s]
Processed prompts:  45%|████▌     | 1858/4096 [00:45<00:59, 37.30it/s, est. speed input: 41652.53 toks/s, output: 40.68 toks/s]
Processed prompts:  46%|████▌     | 1890/4096 [00:46<00:59, 37.19it/s, est. speed input: 41581.33 toks/s, output: 40.61 toks/s]
Processed prompts:  47%|████▋     | 1922/4096 [00:47<00:58, 37.13it/s, est. speed input: 41513.76 toks/s, output: 40.54 toks/s]
Processed prompts:  48%|████▊     | 1954/4096 [00:48<00:57, 37.09it/s, est. speed input: 41448.93 toks/s, output: 40.48 toks/s]
Processed prompts:  48%|████▊     | 1986/4096 [00:49<00:56, 37.05it/s, est. speed input: 41385.25 toks/s, output: 40.42 toks/s]
Processed prompts:  49%|████▉     | 2018/4096 [00:50<00:56, 37.03it/s, est. speed input: 41324.13 toks/s, output: 40.36 toks/s]
Processed prompts:  50%|█████     | 2050/4096 [00:50<00:55, 37.01it/s, est. speed input: 41265.06 toks/s, output: 40.30 toks/s]
Processed prompts:  51%|█████     | 2082/4096 [00:51<00:54, 37.00it/s, est. speed input: 41207.97 toks/s, output: 40.24 toks/s]
Processed prompts:  52%|█████▏    | 2114/4096 [00:52<00:53, 36.99it/s, est. speed input: 41152.79 toks/s, output: 40.19 toks/s]
Processed prompts:  52%|█████▏    | 2146/4096 [00:53<00:52, 36.98it/s, est. speed input: 41099.53 toks/s, output: 40.14 toks/s]
Processed prompts:  53%|█████▎    | 2178/4096 [00:54<00:51, 36.97it/s, est. speed input: 41047.61 toks/s, output: 40.09 toks/s]
Processed prompts:  54%|█████▍    | 2210/4096 [00:55<00:51, 36.97it/s, est. speed input: 40997.54 toks/s, output: 40.04 toks/s]
Processed prompts:  55%|█████▍    | 2242/4096 [00:56<00:50, 36.97it/s, est. speed input: 40948.95 toks/s, output: 39.99 toks/s]
Processed prompts:  56%|█████▌    | 2274/4096 [00:56<00:49, 36.98it/s, est. speed input: 40902.24 toks/s, output: 39.94 toks/s]
Processed prompts:  56%|█████▋    | 2306/4096 [00:57<00:48, 36.96it/s, est. speed input: 40856.01 toks/s, output: 39.90 toks/s]
Processed prompts:  57%|█████▋    | 2338/4096 [00:58<00:47, 36.97it/s, est. speed input: 40811.80 toks/s, output: 39.86 toks/s]
Processed prompts:  58%|█████▊    | 2370/4096 [00:59<00:46, 36.96it/s, est. speed input: 40768.42 toks/s, output: 39.81 toks/s]
Processed prompts:  59%|█████▊    | 2402/4096 [01:00<00:45, 36.96it/s, est. speed input: 40726.64 toks/s, output: 39.77 toks/s]
Processed prompts:  59%|█████▉    | 2434/4096 [01:01<00:44, 36.96it/s, est. speed input: 40685.81 toks/s, output: 39.73 toks/s]
Processed prompts:  60%|██████    | 2466/4096 [01:02<00:44, 36.95it/s, est. speed input: 40645.82 toks/s, output: 39.69 toks/s]
Processed prompts:  61%|██████    | 2498/4096 [01:02<00:42, 37.27it/s, est. speed input: 40623.23 toks/s, output: 39.67 toks/s]
Processed prompts:  62%|██████▏   | 2530/4096 [01:03<00:42, 37.17it/s, est. speed input: 40585.10 toks/s, output: 39.63 toks/s]
Processed prompts:  63%|██████▎   | 2562/4096 [01:04<00:41, 37.10it/s, est. speed input: 40548.32 toks/s, output: 39.60 toks/s]
Processed prompts:  63%|██████▎   | 2594/4096 [01:05<00:40, 37.06it/s, est. speed input: 40512.44 toks/s, output: 39.56 toks/s]
Processed prompts:  64%|██████▍   | 2626/4096 [01:06<00:39, 37.03it/s, est. speed input: 40477.83 toks/s, output: 39.53 toks/s]
Processed prompts:  65%|██████▍   | 2658/4096 [01:07<00:38, 37.01it/s, est. speed input: 40444.01 toks/s, output: 39.50 toks/s]
Processed prompts:  66%|██████▌   | 2690/4096 [01:08<00:38, 36.99it/s, est. speed input: 40410.80 toks/s, output: 39.46 toks/s]
Processed prompts:  66%|██████▋   | 2722/4096 [01:09<00:37, 36.98it/s, est. speed input: 40378.47 toks/s, output: 39.43 toks/s]
Processed prompts:  67%|██████▋   | 2754/4096 [01:09<00:36, 36.96it/s, est. speed input: 40346.50 toks/s, output: 39.40 toks/s]
Processed prompts:  68%|██████▊   | 2786/4096 [01:10<00:35, 36.95it/s, est. speed input: 40315.61 toks/s, output: 39.37 toks/s]
Processed prompts:  69%|██████▉   | 2818/4096 [01:11<00:34, 36.95it/s, est. speed input: 40285.41 toks/s, output: 39.34 toks/s]
Processed prompts:  70%|██████▉   | 2850/4096 [01:12<00:33, 36.95it/s, est. speed input: 40256.20 toks/s, output: 39.31 toks/s]
Processed prompts:  70%|███████   | 2882/4096 [01:13<00:32, 36.94it/s, est. speed input: 40227.46 toks/s, output: 39.28 toks/s]
Processed prompts:  71%|███████   | 2914/4096 [01:14<00:31, 36.94it/s, est. speed input: 40199.24 toks/s, output: 39.26 toks/s]
Processed prompts:  72%|███████▏  | 2946/4096 [01:15<00:31, 36.94it/s, est. speed input: 40171.76 toks/s, output: 39.23 toks/s]
Processed prompts:  73%|███████▎  | 2978/4096 [01:15<00:30, 36.93it/s, est. speed input: 40144.80 toks/s, output: 39.20 toks/s]
Processed prompts:  73%|███████▎  | 3010/4096 [01:16<00:29, 36.93it/s, est. speed input: 40118.66 toks/s, output: 39.18 toks/s]
Processed prompts:  74%|███████▍  | 3042/4096 [01:17<00:28, 36.93it/s, est. speed input: 40093.03 toks/s, output: 39.15 toks/s]
Processed prompts:  75%|███████▌  | 3074/4096 [01:18<00:27, 36.93it/s, est. speed input: 40067.95 toks/s, output: 39.13 toks/s]
Processed prompts:  76%|███████▌  | 3106/4096 [01:19<00:26, 36.94it/s, est. speed input: 40043.49 toks/s, output: 39.10 toks/s]
Processed prompts:  77%|███████▋  | 3138/4096 [01:20<00:25, 36.93it/s, est. speed input: 40019.45 toks/s, output: 39.08 toks/s]
Processed prompts:  77%|███████▋  | 3170/4096 [01:21<00:25, 36.94it/s, est. speed input: 39996.06 toks/s, output: 39.06 toks/s]
Processed prompts:  78%|███████▊  | 3202/4096 [01:22<00:24, 36.93it/s, est. speed input: 39972.79 toks/s, output: 39.04 toks/s]
Processed prompts:  79%|███████▉  | 3234/4096 [01:22<00:23, 36.93it/s, est. speed input: 39950.21 toks/s, output: 39.01 toks/s]
Processed prompts:  80%|███████▉  | 3266/4096 [01:23<00:22, 36.93it/s, est. speed input: 39928.05 toks/s, output: 38.99 toks/s]
Processed prompts:  81%|████████  | 3298/4096 [01:24<00:21, 36.92it/s, est. speed input: 39906.17 toks/s, output: 38.97 toks/s]
Processed prompts:  81%|████████▏ | 3330/4096 [01:25<00:20, 36.93it/s, est. speed input: 39885.11 toks/s, output: 38.95 toks/s]
Processed prompts:  82%|████████▏ | 3362/4096 [01:26<00:19, 36.93it/s, est. speed input: 39864.35 toks/s, output: 38.93 toks/s]
Processed prompts:  83%|████████▎ | 3394/4096 [01:27<00:19, 36.92it/s, est. speed input: 39843.84 toks/s, output: 38.91 toks/s]
Processed prompts:  84%|████████▎ | 3426/4096 [01:28<00:18, 36.93it/s, est. speed input: 39823.94 toks/s, output: 38.89 toks/s]
Processed prompts:  84%|████████▍ | 3458/4096 [01:28<00:17, 36.92it/s, est. speed input: 39804.27 toks/s, output: 38.87 toks/s]
Processed prompts:  85%|████████▌ | 3490/4096 [01:29<00:16, 36.92it/s, est. speed input: 39784.88 toks/s, output: 38.85 toks/s]
Processed prompts:  86%|████████▌ | 3522/4096 [01:30<00:15, 36.93it/s, est. speed input: 39766.14 toks/s, output: 38.83 toks/s]
Processed prompts:  87%|████████▋ | 3554/4096 [01:31<00:14, 36.93it/s, est. speed input: 39747.67 toks/s, output: 38.82 toks/s]
Processed prompts:  88%|████████▊ | 3586/4096 [01:32<00:13, 36.93it/s, est. speed input: 39729.54 toks/s, output: 38.80 toks/s]
Processed prompts:  88%|████████▊ | 3618/4096 [01:33<00:12, 36.92it/s, est. speed input: 39711.52 toks/s, output: 38.78 toks/s]
Processed prompts:  89%|████████▉ | 3650/4096 [01:34<00:12, 36.92it/s, est. speed input: 39693.95 toks/s, output: 38.76 toks/s]
Processed prompts:  90%|████████▉ | 3682/4096 [01:35<00:11, 36.91it/s, est. speed input: 39676.48 toks/s, output: 38.75 toks/s]
Processed prompts:  91%|█████████ | 3714/4096 [01:35<00:10, 36.91it/s, est. speed input: 39659.50 toks/s, output: 38.73 toks/s]
Processed prompts:  91%|█████████▏| 3746/4096 [01:36<00:09, 36.90it/s, est. speed input: 39642.53 toks/s, output: 38.71 toks/s]
Processed prompts:  92%|█████████▏| 3778/4096 [01:37<00:08, 36.90it/s, est. speed input: 39626.08 toks/s, output: 38.70 toks/s]
Processed prompts:  93%|█████████▎| 3810/4096 [01:38<00:07, 36.90it/s, est. speed input: 39609.95 toks/s, output: 38.68 toks/s]
Processed prompts:  94%|█████████▍| 3842/4096 [01:39<00:06, 36.91it/s, est. speed input: 39594.14 toks/s, output: 38.67 toks/s]
Processed prompts:  95%|█████████▍| 3874/4096 [01:40<00:06, 36.91it/s, est. speed input: 39578.76 toks/s, output: 38.65 toks/s]
Processed prompts:  95%|█████████▌| 3906/4096 [01:41<00:05, 36.90it/s, est. speed input: 39562.98 toks/s, output: 38.64 toks/s]
Processed prompts:  96%|█████████▌| 3938/4096 [01:41<00:04, 36.90it/s, est. speed input: 39547.90 toks/s, output: 38.62 toks/s]
Processed prompts:  97%|█████████▋| 3970/4096 [01:42<00:03, 36.90it/s, est. speed input: 39533.06 toks/s, output: 38.61 toks/s]
Processed prompts:  98%|█████████▊| 4002/4096 [01:43<00:02, 36.90it/s, est. speed input: 39518.37 toks/s, output: 38.59 toks/s]
Processed prompts:  98%|█████████▊| 4034/4096 [01:44<00:01, 37.21it/s, est. speed input: 39513.18 toks/s, output: 38.59 toks/s]
Processed prompts:  99%|█████████▉| 4066/4096 [01:45<00:00, 37.47it/s, est. speed input: 39509.19 toks/s, output: 38.58 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [01:45<00:00, 37.47it/s, est. speed input: 39800.59 toks/s, output: 38.87 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [01:45<00:00, 38.87it/s, est. speed input: 39800.59 toks/s, output: 38.87 toks/s]
[rank0]:[W128 01:03:20.228009839 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 145.5s

测试结果:
  Requests/s:   36.98
  Tokens/s:     37903.58
  Total Reqs:   4096
  Elapsed:      110.77s

  [Prefill 分析]
  Total Prefill Tokens: 4194304
  Prefill Tokens/s:     37866.60


------------------------------------------------------------
  生成 CSV: BitNet-2B-FP8
------------------------------------------------------------
[SUCCESS] CSV 保存到: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX5080_cc120_FP8E4M3_py312_cu129_x86_64/cusparselt/2_8/BitNet-2B-FP8_prefill.csv

预览:
------------------------------------------------------------
M_prefill,prompt_len,max_num_seqs,num_prompts,N_prefill,requests_per_s,tokens_per_s,elapsed_time_s
512,512,1,128,128,56.5935,29032.4758,2.2617
1024,1024,1,128,128,35.9664,36865.5225,3.5589
2048,1024,2,256,128,39.5226,40510.7021,6.4773
4096,1024,4,512,128,39.3050,40287.6105,13.0263
8192,1024,8,1024,128,37.6443,38585.4453,27.2020
16384,1024,16,2048,128,36.9645,37888.5918,55.4045
32768,1024,32,4096,128,36.9791,37903.5782,110.7653

------------------------------------------------------------

[INFO] 完成: 7 成功, 0 失败

============================================================
  BitNet-2B-FP8 | cuSPARSELt (2_10) | prefill
============================================================

[INFO] Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-FP8-SlideSparse-2_10
[INFO] Output: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX5080_cc120_FP8E4M3_py312_cu129_x86_64/cusparselt/2_10

============================================================
[1/7] 测试 M=512
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 512
│   M_prefill     = 512 (= 1 x 512)
│   M_decode      = 1
│   batched_tokens = 513 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 512
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 513
│   --max-num-batched-tokens = 513
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 01:03:25 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3521743) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3521743) WARNING 01-28 01:03:35 [backends.py:609] Failed to read file <frozen os>
Throughput: 55.28 requests/s, 28356.35 total tokens/s, 55.28 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128


─── STDERR ───
[2026-01-28 01:03:25] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 01:03:25] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 01:03:25] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 01:03:25] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:03:25] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:03:25] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:03:25] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:03:25] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:03:25] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 01:03:25] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 01:03:25] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 01:03:25] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 01:03:25] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 01:03:25] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 01:03:29] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 01:03:29] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 01:03:29] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 01:03:29] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:03:29] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:03:29] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:03:29] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:03:29] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:03:29] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 01:03:29] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 01:03:29] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 01:03:29] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 01:03:29] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 01:03:29] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3521743) [2026-01-28 01:03:29] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3521743) [2026-01-28 01:03:29] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3521743) [2026-01-28 01:03:29] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3521743) [2026-01-28 01:03:29] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=3521743) [2026-01-28 01:03:29] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3521743) [2026-01-28 01:03:29] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3521743) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3521743) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:01<00:00,  1.06s/it]
(EngineCore_DP0 pid=3521743) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:01<00:00,  1.06s/it]
(EngineCore_DP0 pid=3521743) 
(EngineCore_DP0 pid=3521743) [2026-01-28 01:03:31] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 4096] -> 1D uint8
(EngineCore_DP0 pid=3521743) [2026-01-28 01:03:31] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 9830400 bytes
(EngineCore_DP0 pid=3521743) [2026-01-28 01:03:31] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 4096] -> 1D uint8
(EngineCore_DP0 pid=3521743) [2026-01-28 01:03:31] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 6553600 bytes
(EngineCore_DP0 pid=3521743) [2026-01-28 01:03:31] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 4096] -> 1D uint8
(EngineCore_DP0 pid=3521743) [2026-01-28 01:03:31] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 35389440 bytes
(EngineCore_DP0 pid=3521743) [2026-01-28 01:03:31] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 11072] -> 1D uint8
(EngineCore_DP0 pid=3521743) [2026-01-28 01:03:31] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 17735680 bytes
(EngineCore_DP0 pid=3521743) 2026-01-28 01:03:41,608 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3521743) 2026-01-28 01:03:41,624 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3521743) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  3.91it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  4.22it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  4.17it/s]
(EngineCore_DP0 pid=3521743) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  6.20it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  6.20it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  97%|█████████▋| 124/128 [00:00<00:00, 1235.13it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 1237.49it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:16,  7.53it/s, est. speed input: 3853.90 toks/s, output: 7.53 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:00<00:03, 37.00it/s, est. speed input: 16517.68 toks/s, output: 32.26 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:00<00:02, 47.54it/s, est. speed input: 21163.51 toks/s, output: 41.33 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:00<00:02, 52.97it/s, est. speed input: 23647.33 toks/s, output: 46.19 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:00<00:01, 55.86it/s, est. speed input: 25125.93 toks/s, output: 49.07 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:00<00:01, 57.67it/s, est. speed input: 26134.46 toks/s, output: 51.04 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:00<00:01, 58.98it/s, est. speed input: 26893.24 toks/s, output: 52.53 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:00<00:01, 59.65it/s, est. speed input: 27430.97 toks/s, output: 53.58 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:01<00:01, 60.16it/s, est. speed input: 27862.04 toks/s, output: 54.42 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:01<00:01, 60.69it/s, est. speed input: 28234.98 toks/s, output: 55.14 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:01<00:00, 61.32it/s, est. speed input: 28576.72 toks/s, output: 55.81 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:01<00:00, 61.77it/s, est. speed input: 28865.68 toks/s, output: 56.38 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:01<00:00, 62.04it/s, est. speed input: 29106.25 toks/s, output: 56.85 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:01<00:00, 61.66it/s, est. speed input: 29250.63 toks/s, output: 57.13 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:01<00:00, 58.74it/s, est. speed input: 29087.88 toks/s, output: 56.81 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:01<00:00, 59.79it/s, est. speed input: 29259.88 toks/s, output: 57.15 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:01<00:00, 60.74it/s, est. speed input: 29431.57 toks/s, output: 57.48 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:02<00:00, 60.65it/s, est. speed input: 29515.89 toks/s, output: 57.65 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:02<00:00, 61.06it/s, est. speed input: 29631.45 toks/s, output: 57.87 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:02<00:00, 61.06it/s, est. speed input: 29649.04 toks/s, output: 57.91 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:02<00:00, 57.91it/s, est. speed input: 29649.04 toks/s, output: 57.91 toks/s]
[rank0]:[W128 01:03:45.515745386 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 25.4s

测试结果:
  Requests/s:   55.28
  Tokens/s:     28356.35
  Total Reqs:   128
  Elapsed:      2.32s

  [Prefill 分析]
  Total Prefill Tokens: 65536
  Prefill Tokens/s:     28301.07

============================================================
[2/7] 测试 M=1024
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 1024
│   M_prefill     = 1024 (= 1 x 1024)
│   M_decode      = 1
│   batched_tokens = 1025 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 1025
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 01:03:51 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3522424) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3522424) WARNING 01-28 01:04:01 [backends.py:609] Failed to read file <frozen os>
Throughput: 33.69 requests/s, 34532.99 total tokens/s, 33.69 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128


─── STDERR ───
[2026-01-28 01:03:51] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 01:03:51] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 01:03:51] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 01:03:51] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:03:51] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:03:51] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:03:51] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:03:51] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:03:51] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 01:03:51] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 01:03:51] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 01:03:51] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 01:03:51] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 01:03:51] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 01:03:55] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 01:03:55] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 01:03:55] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 01:03:55] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:03:55] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:03:55] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:03:55] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:03:55] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:03:55] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 01:03:55] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 01:03:55] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 01:03:55] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 01:03:55] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 01:03:55] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3522424) [2026-01-28 01:03:55] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3522424) [2026-01-28 01:03:55] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3522424) [2026-01-28 01:03:55] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3522424) [2026-01-28 01:03:55] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=3522424) [2026-01-28 01:03:55] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3522424) [2026-01-28 01:03:55] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3522424) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3522424) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:01<00:00,  1.17s/it]
(EngineCore_DP0 pid=3522424) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:01<00:00,  1.17s/it]
(EngineCore_DP0 pid=3522424) 
(EngineCore_DP0 pid=3522424) [2026-01-28 01:03:57] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 4096] -> 1D uint8
(EngineCore_DP0 pid=3522424) [2026-01-28 01:03:57] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 9830400 bytes
(EngineCore_DP0 pid=3522424) [2026-01-28 01:03:57] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 4096] -> 1D uint8
(EngineCore_DP0 pid=3522424) [2026-01-28 01:03:57] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 6553600 bytes
(EngineCore_DP0 pid=3522424) [2026-01-28 01:03:57] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 4096] -> 1D uint8
(EngineCore_DP0 pid=3522424) [2026-01-28 01:03:57] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 35389440 bytes
(EngineCore_DP0 pid=3522424) [2026-01-28 01:03:57] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 11072] -> 1D uint8
(EngineCore_DP0 pid=3522424) [2026-01-28 01:03:57] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 17735680 bytes
(EngineCore_DP0 pid=3522424) 2026-01-28 01:04:07,569 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3522424) 2026-01-28 01:04:07,585 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3522424) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00, 21.46it/s]
(EngineCore_DP0 pid=3522424) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.09it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.08it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  49%|████▉     | 63/128 [00:00<00:00, 625.22it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 674.62it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:15,  8.17it/s, est. speed input: 8369.16 toks/s, output: 8.17 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:05, 24.10it/s, est. speed input: 22098.34 toks/s, output: 21.58 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:00<00:04, 29.65it/s, est. speed input: 27020.85 toks/s, output: 26.39 toks/s]
Processed prompts:  10%|█         | 13/128 [00:00<00:03, 32.23it/s, est. speed input: 29490.10 toks/s, output: 28.80 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:00<00:03, 33.70it/s, est. speed input: 31005.00 toks/s, output: 30.28 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:00<00:03, 34.65it/s, est. speed input: 32045.67 toks/s, output: 31.29 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:00<00:02, 35.24it/s, est. speed input: 32789.05 toks/s, output: 32.02 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:00<00:02, 35.62it/s, est. speed input: 33345.99 toks/s, output: 32.56 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:01<00:02, 35.90it/s, est. speed input: 33789.91 toks/s, output: 33.00 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:01<00:02, 36.12it/s, est. speed input: 34154.76 toks/s, output: 33.35 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:01<00:02, 36.23it/s, est. speed input: 34443.05 toks/s, output: 33.64 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:01<00:02, 36.32it/s, est. speed input: 34687.19 toks/s, output: 33.87 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:01<00:02, 36.35it/s, est. speed input: 34885.48 toks/s, output: 34.07 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:01<00:02, 36.39it/s, est. speed input: 35060.76 toks/s, output: 34.24 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:01<00:01, 36.42it/s, est. speed input: 35212.95 toks/s, output: 34.39 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:01<00:01, 36.36it/s, est. speed input: 35331.11 toks/s, output: 34.50 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:01<00:01, 36.41it/s, est. speed input: 35451.32 toks/s, output: 34.62 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:01<00:01, 36.41it/s, est. speed input: 35552.32 toks/s, output: 34.72 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:02<00:01, 36.40it/s, est. speed input: 35642.10 toks/s, output: 34.81 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:02<00:01, 36.43it/s, est. speed input: 35728.51 toks/s, output: 34.89 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:02<00:01, 36.45it/s, est. speed input: 35805.69 toks/s, output: 34.97 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:02<00:01, 36.41it/s, est. speed input: 35868.12 toks/s, output: 35.03 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:02<00:01, 36.44it/s, est. speed input: 35933.36 toks/s, output: 35.09 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:02<00:00, 36.42it/s, est. speed input: 35988.78 toks/s, output: 35.15 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:02<00:00, 36.42it/s, est. speed input: 36041.05 toks/s, output: 35.20 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:02<00:00, 36.43it/s, est. speed input: 36089.73 toks/s, output: 35.24 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:02<00:00, 36.36it/s, est. speed input: 36126.73 toks/s, output: 35.28 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:03<00:00, 36.40it/s, est. speed input: 36171.12 toks/s, output: 35.32 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:03<00:00, 36.45it/s, est. speed input: 36214.16 toks/s, output: 35.37 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:03<00:00, 36.49it/s, est. speed input: 36255.40 toks/s, output: 35.41 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:03<00:00, 36.46it/s, est. speed input: 36287.55 toks/s, output: 35.44 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:03<00:00, 36.35it/s, est. speed input: 36309.02 toks/s, output: 35.46 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:03<00:00, 36.35it/s, est. speed input: 36330.62 toks/s, output: 35.48 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:03<00:00, 35.48it/s, est. speed input: 36330.62 toks/s, output: 35.48 toks/s]
[rank0]:[W128 01:04:12.522339147 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 26.9s

测试结果:
  Requests/s:   33.69
  Tokens/s:     34532.99
  Total Reqs:   128
  Elapsed:      3.80s

  [Prefill 分析]
  Total Prefill Tokens: 131072
  Prefill Tokens/s:     34499.30

============================================================
[3/7] 测试 M=2048
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 2048
│   M_prefill     = 2048 (= 2 x 1024)
│   M_decode      = 2
│   batched_tokens = 2048 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 256
│   --max-num-seqs           = 2
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 2048
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 01:04:18 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3523104) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3523104) WARNING 01-28 01:04:27 [backends.py:609] Failed to read file <frozen os>
Throughput: 37.28 requests/s, 38214.98 total tokens/s, 37.28 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256


─── STDERR ───
[2026-01-28 01:04:18] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 01:04:18] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 01:04:18] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 01:04:18] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:04:18] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:04:18] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:04:18] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:04:18] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:04:18] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 01:04:18] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 01:04:18] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 01:04:18] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 01:04:18] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 01:04:18] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 01:04:22] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 01:04:22] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 01:04:22] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 01:04:22] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:04:22] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:04:22] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:04:22] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:04:22] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:04:22] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 01:04:22] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 01:04:22] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 01:04:22] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 01:04:22] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 01:04:22] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3523104) [2026-01-28 01:04:22] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3523104) [2026-01-28 01:04:22] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3523104) [2026-01-28 01:04:22] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3523104) [2026-01-28 01:04:22] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=3523104) [2026-01-28 01:04:22] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3523104) [2026-01-28 01:04:22] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3523104) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3523104) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.73it/s]
(EngineCore_DP0 pid=3523104) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.73it/s]
(EngineCore_DP0 pid=3523104) 
(EngineCore_DP0 pid=3523104) [2026-01-28 01:04:23] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 4096] -> 1D uint8
(EngineCore_DP0 pid=3523104) [2026-01-28 01:04:23] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 9830400 bytes
(EngineCore_DP0 pid=3523104) [2026-01-28 01:04:23] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 4096] -> 1D uint8
(EngineCore_DP0 pid=3523104) [2026-01-28 01:04:23] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 6553600 bytes
(EngineCore_DP0 pid=3523104) [2026-01-28 01:04:23] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 4096] -> 1D uint8
(EngineCore_DP0 pid=3523104) [2026-01-28 01:04:23] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 35389440 bytes
(EngineCore_DP0 pid=3523104) [2026-01-28 01:04:23] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 11072] -> 1D uint8
(EngineCore_DP0 pid=3523104) [2026-01-28 01:04:23] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 17735680 bytes
(EngineCore_DP0 pid=3523104) 2026-01-28 01:04:33,658 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3523104) 2026-01-28 01:04:33,674 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3523104) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00, 21.57it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00, 21.55it/s]
(EngineCore_DP0 pid=3523104) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 1/2 [00:00<00:00,  7.29it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00, 11.66it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:   0%|          | 1/256 [00:00<00:35,  7.23it/s]
Adding requests:  29%|██▉       | 75/256 [00:00<00:00, 378.27it/s]
Adding requests:  58%|█████▊    | 148/256 [00:00<00:00, 525.46it/s]
Adding requests:  88%|████████▊ | 224/256 [00:00<00:00, 611.76it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 532.11it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▌         | 14/256 [00:00<00:01, 138.66it/s, est. speed input: 141999.83 toks/s, output: 138.66 toks/s]
Processed prompts:  11%|█         | 28/256 [00:00<00:04, 54.74it/s, est. speed input: 61650.24 toks/s, output: 60.20 toks/s]   
Processed prompts:  14%|█▍        | 36/256 [00:00<00:04, 48.04it/s, est. speed input: 54690.57 toks/s, output: 53.41 toks/s]
Processed prompts:  17%|█▋        | 43/256 [00:00<00:04, 47.01it/s, est. speed input: 53001.17 toks/s, output: 51.76 toks/s]
Processed prompts:  19%|█▉        | 49/256 [00:00<00:04, 44.28it/s, est. speed input: 50755.39 toks/s, output: 49.57 toks/s]
Processed prompts:  21%|██        | 54/256 [00:01<00:04, 40.56it/s, est. speed input: 48286.16 toks/s, output: 47.15 toks/s]
Processed prompts:  23%|██▎       | 59/256 [00:01<00:04, 42.21it/s, est. speed input: 48354.70 toks/s, output: 47.22 toks/s]
Processed prompts:  25%|██▌       | 64/256 [00:01<00:04, 38.93it/s, est. speed input: 46631.33 toks/s, output: 45.54 toks/s]
Processed prompts:  27%|██▋       | 69/256 [00:01<00:04, 41.08it/s, est. speed input: 46807.65 toks/s, output: 45.71 toks/s]
Processed prompts:  29%|██▉       | 74/256 [00:01<00:04, 38.04it/s, est. speed input: 45493.36 toks/s, output: 44.43 toks/s]
Processed prompts:  30%|███       | 78/256 [00:01<00:04, 38.14it/s, est. speed input: 45132.90 toks/s, output: 44.07 toks/s]
Processed prompts:  32%|███▏      | 82/256 [00:01<00:04, 38.21it/s, est. speed input: 44810.53 toks/s, output: 43.76 toks/s]
Processed prompts:  34%|███▎      | 86/256 [00:01<00:04, 38.17it/s, est. speed input: 44501.12 toks/s, output: 43.46 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:02<00:04, 38.25it/s, est. speed input: 44244.50 toks/s, output: 43.21 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:02<00:04, 38.31it/s, est. speed input: 44014.55 toks/s, output: 42.98 toks/s]
Processed prompts:  38%|███▊      | 98/256 [00:02<00:04, 38.36it/s, est. speed input: 43804.72 toks/s, output: 42.78 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:02<00:04, 38.40it/s, est. speed input: 43614.89 toks/s, output: 42.59 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:02<00:03, 38.44it/s, est. speed input: 43441.48 toks/s, output: 42.42 toks/s]
Processed prompts:  43%|████▎     | 110/256 [00:02<00:03, 38.38it/s, est. speed input: 43269.74 toks/s, output: 42.26 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:02<00:03, 38.39it/s, est. speed input: 43119.04 toks/s, output: 42.11 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:02<00:03, 38.41it/s, est. speed input: 42980.72 toks/s, output: 41.97 toks/s]
Processed prompts:  48%|████▊     | 122/256 [00:02<00:03, 38.36it/s, est. speed input: 42843.20 toks/s, output: 41.84 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:03<00:03, 38.27it/s, est. speed input: 42708.92 toks/s, output: 41.71 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:03<00:03, 38.27it/s, est. speed input: 42591.65 toks/s, output: 41.59 toks/s]
Processed prompts:  52%|█████▏    | 134/256 [00:03<00:03, 38.31it/s, est. speed input: 42486.21 toks/s, output: 41.49 toks/s]
Processed prompts:  54%|█████▍    | 138/256 [00:03<00:03, 38.31it/s, est. speed input: 42384.53 toks/s, output: 41.39 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:03<00:02, 38.37it/s, est. speed input: 42295.24 toks/s, output: 41.30 toks/s]
Processed prompts:  57%|█████▋    | 146/256 [00:03<00:02, 38.34it/s, est. speed input: 42203.36 toks/s, output: 41.21 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:03<00:02, 38.37it/s, est. speed input: 42122.53 toks/s, output: 41.14 toks/s]
Processed prompts:  60%|██████    | 154/256 [00:03<00:02, 38.40it/s, est. speed input: 42046.32 toks/s, output: 41.06 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:03<00:02, 38.39it/s, est. speed input: 41972.05 toks/s, output: 40.99 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:03<00:02, 38.38it/s, est. speed input: 41901.50 toks/s, output: 40.92 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:04<00:02, 38.33it/s, est. speed input: 41829.81 toks/s, output: 40.85 toks/s]
Processed prompts:  66%|██████▋   | 170/256 [00:04<00:02, 38.30it/s, est. speed input: 41762.54 toks/s, output: 40.78 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:04<00:02, 38.35it/s, est. speed input: 41704.79 toks/s, output: 40.73 toks/s]
Processed prompts:  70%|██████▉   | 178/256 [00:04<00:02, 38.37it/s, est. speed input: 41648.81 toks/s, output: 40.67 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:04<00:01, 38.40it/s, est. speed input: 41596.37 toks/s, output: 40.62 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:04<00:01, 38.41it/s, est. speed input: 41545.75 toks/s, output: 40.57 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:04<00:01, 38.36it/s, est. speed input: 41492.03 toks/s, output: 40.52 toks/s]
Processed prompts:  76%|███████▌  | 194/256 [00:04<00:01, 38.40it/s, est. speed input: 41447.45 toks/s, output: 40.48 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:04<00:01, 38.42it/s, est. speed input: 41403.50 toks/s, output: 40.43 toks/s]
Processed prompts:  79%|███████▉  | 202/256 [00:05<00:01, 38.32it/s, est. speed input: 41353.22 toks/s, output: 40.38 toks/s]
Processed prompts:  80%|████████  | 206/256 [00:05<00:01, 38.29it/s, est. speed input: 41307.72 toks/s, output: 40.34 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:05<00:01, 38.33it/s, est. speed input: 41268.45 toks/s, output: 40.30 toks/s]
Processed prompts:  84%|████████▎ | 214/256 [00:05<00:01, 38.36it/s, est. speed input: 41231.14 toks/s, output: 40.26 toks/s]
Processed prompts:  85%|████████▌ | 218/256 [00:05<00:00, 38.38it/s, est. speed input: 41194.87 toks/s, output: 40.23 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:05<00:00, 38.41it/s, est. speed input: 41160.88 toks/s, output: 40.20 toks/s]
Processed prompts:  88%|████████▊ | 226/256 [00:05<00:00, 38.43it/s, est. speed input: 41128.32 toks/s, output: 40.16 toks/s]
Processed prompts:  90%|████████▉ | 230/256 [00:05<00:00, 38.43it/s, est. speed input: 41096.44 toks/s, output: 40.13 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:05<00:00, 38.44it/s, est. speed input: 41065.85 toks/s, output: 40.10 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:05<00:00, 38.39it/s, est. speed input: 41032.68 toks/s, output: 40.07 toks/s]
Processed prompts:  95%|█████████▍| 242/256 [00:06<00:00, 38.37it/s, est. speed input: 41001.96 toks/s, output: 40.04 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:06<00:00, 38.32it/s, est. speed input: 40969.70 toks/s, output: 40.01 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:06<00:00, 38.32it/s, est. speed input: 40941.17 toks/s, output: 39.98 toks/s]
Processed prompts:  99%|█████████▉| 254/256 [00:06<00:00, 38.36it/s, est. speed input: 40915.16 toks/s, output: 39.96 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:06<00:00, 38.36it/s, est. speed input: 41059.01 toks/s, output: 40.10 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:06<00:00, 40.10it/s, est. speed input: 41059.01 toks/s, output: 40.10 toks/s]
[rank0]:[W128 01:04:41.751786095 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 29.3s

测试结果:
  Requests/s:   37.28
  Tokens/s:     38214.98
  Total Reqs:   256
  Elapsed:      6.87s

  [Prefill 分析]
  Total Prefill Tokens: 262144
  Prefill Tokens/s:     38177.70

============================================================
[4/7] 测试 M=4096
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 4096
│   M_prefill     = 4096 (= 4 x 1024)
│   M_decode      = 4
│   batched_tokens = 4096 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 512
│   --max-num-seqs           = 4
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 4096
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 01:04:48 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3523796) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3523796) WARNING 01-28 01:04:57 [backends.py:609] Failed to read file <frozen os>
Throughput: 37.83 requests/s, 38775.37 total tokens/s, 37.83 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512


─── STDERR ───
[2026-01-28 01:04:48] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 01:04:48] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 01:04:48] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 01:04:48] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:04:48] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:04:48] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:04:48] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:04:48] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:04:48] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 01:04:48] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 01:04:48] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 01:04:48] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 01:04:48] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 01:04:48] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 01:04:52] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 01:04:52] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 01:04:52] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 01:04:52] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:04:52] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:04:52] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:04:52] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:04:52] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:04:52] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 01:04:52] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 01:04:52] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 01:04:52] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 01:04:52] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 01:04:52] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3523796) [2026-01-28 01:04:52] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3523796) [2026-01-28 01:04:52] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3523796) [2026-01-28 01:04:52] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3523796) [2026-01-28 01:04:52] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=3523796) [2026-01-28 01:04:52] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3523796) [2026-01-28 01:04:52] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3523796) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3523796) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.64it/s]
(EngineCore_DP0 pid=3523796) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.64it/s]
(EngineCore_DP0 pid=3523796) 
(EngineCore_DP0 pid=3523796) [2026-01-28 01:04:53] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 4096] -> 1D uint8
(EngineCore_DP0 pid=3523796) [2026-01-28 01:04:53] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 9830400 bytes
(EngineCore_DP0 pid=3523796) [2026-01-28 01:04:53] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 4096] -> 1D uint8
(EngineCore_DP0 pid=3523796) [2026-01-28 01:04:53] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 6553600 bytes
(EngineCore_DP0 pid=3523796) [2026-01-28 01:04:53] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 4096] -> 1D uint8
(EngineCore_DP0 pid=3523796) [2026-01-28 01:04:53] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 35389440 bytes
(EngineCore_DP0 pid=3523796) [2026-01-28 01:04:53] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 11072] -> 1D uint8
(EngineCore_DP0 pid=3523796) [2026-01-28 01:04:53] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 17735680 bytes
(EngineCore_DP0 pid=3523796) 2026-01-28 01:05:03,742 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3523796) 2026-01-28 01:05:03,758 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3523796) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  75%|███████▌  | 3/4 [00:00<00:00, 24.05it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00, 22.26it/s]
(EngineCore_DP0 pid=3523796) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  33%|███▎      | 1/3 [00:00<00:00,  7.17it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00, 14.33it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:  14%|█▍        | 73/512 [00:00<00:00, 726.90it/s]
Adding requests:  29%|██▉       | 148/512 [00:00<00:00, 738.37it/s]
Adding requests:  44%|████▎     | 223/512 [00:00<00:00, 742.84it/s]
Adding requests:  58%|█████▊    | 299/512 [00:00<00:00, 745.66it/s]
Adding requests:  73%|███████▎  | 375/512 [00:00<00:00, 747.04it/s]
Adding requests:  88%|████████▊ | 451/512 [00:00<00:00, 749.24it/s]
Adding requests: 100%|██████████| 512/512 [00:00<00:00, 742.00it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▌         | 26/512 [00:00<00:02, 200.66it/s, est. speed input: 205496.67 toks/s, output: 200.67 toks/s]
Processed prompts:   9%|▉         | 47/512 [00:00<00:07, 63.49it/s, est. speed input: 73335.75 toks/s, output: 71.62 toks/s]   
Processed prompts:  11%|█▏        | 58/512 [00:00<00:08, 51.44it/s, est. speed input: 61146.01 toks/s, output: 59.71 toks/s]
Processed prompts:  13%|█▎        | 66/512 [00:01<00:09, 47.63it/s, est. speed input: 57216.90 toks/s, output: 55.88 toks/s]
Processed prompts:  14%|█▍        | 72/512 [00:01<00:08, 49.25it/s, est. speed input: 57325.20 toks/s, output: 55.98 toks/s]
Processed prompts:  15%|█▌        | 78/512 [00:01<00:10, 42.42it/s, est. speed input: 53349.31 toks/s, output: 52.10 toks/s]
Processed prompts:  16%|█▌        | 83/512 [00:01<00:09, 43.41it/s, est. speed input: 53049.25 toks/s, output: 51.81 toks/s]
Processed prompts:  17%|█▋        | 88/512 [00:01<00:09, 44.31it/s, est. speed input: 52788.93 toks/s, output: 51.55 toks/s]
Processed prompts:  18%|█▊        | 93/512 [00:01<00:09, 45.09it/s, est. speed input: 52556.88 toks/s, output: 51.32 toks/s]
Processed prompts:  19%|█▉        | 98/512 [00:02<00:11, 36.60it/s, est. speed input: 49637.65 toks/s, output: 48.47 toks/s]
Processed prompts:  20%|██        | 103/512 [00:02<00:10, 39.05it/s, est. speed input: 49594.84 toks/s, output: 48.43 toks/s]
Processed prompts:  21%|██        | 108/512 [00:02<00:09, 41.13it/s, est. speed input: 49559.80 toks/s, output: 48.40 toks/s]
Processed prompts:  22%|██▏       | 113/512 [00:02<00:09, 42.75it/s, est. speed input: 49514.18 toks/s, output: 48.35 toks/s]
Processed prompts:  23%|██▎       | 118/512 [00:02<00:11, 34.71it/s, est. speed input: 47432.72 toks/s, output: 46.32 toks/s]
Processed prompts:  24%|██▍       | 122/512 [00:02<00:10, 35.51it/s, est. speed input: 47102.56 toks/s, output: 46.00 toks/s]
Processed prompts:  25%|██▍       | 126/512 [00:02<00:10, 36.14it/s, est. speed input: 46792.25 toks/s, output: 45.70 toks/s]
Processed prompts:  25%|██▌       | 130/512 [00:02<00:10, 36.62it/s, est. speed input: 46500.76 toks/s, output: 45.41 toks/s]
Processed prompts:  26%|██▌       | 134/512 [00:02<00:10, 37.04it/s, est. speed input: 46238.99 toks/s, output: 45.16 toks/s]
Processed prompts:  27%|██▋       | 138/512 [00:03<00:10, 37.30it/s, est. speed input: 45986.75 toks/s, output: 44.91 toks/s]
Processed prompts:  28%|██▊       | 142/512 [00:03<00:09, 37.52it/s, est. speed input: 45755.03 toks/s, output: 44.68 toks/s]
Processed prompts:  29%|██▊       | 146/512 [00:03<00:09, 37.70it/s, est. speed input: 45540.33 toks/s, output: 44.47 toks/s]
Processed prompts:  29%|██▉       | 150/512 [00:03<00:09, 37.78it/s, est. speed input: 45334.15 toks/s, output: 44.27 toks/s]
Processed prompts:  30%|███       | 154/512 [00:03<00:09, 37.80it/s, est. speed input: 45134.99 toks/s, output: 44.08 toks/s]
Processed prompts:  31%|███       | 158/512 [00:03<00:09, 37.87it/s, est. speed input: 44953.63 toks/s, output: 43.90 toks/s]
Processed prompts:  32%|███▏      | 162/512 [00:03<00:09, 37.91it/s, est. speed input: 44781.93 toks/s, output: 43.73 toks/s]
Processed prompts:  32%|███▏      | 166/512 [00:03<00:09, 37.96it/s, est. speed input: 44622.44 toks/s, output: 43.58 toks/s]
Processed prompts:  33%|███▎      | 170/512 [00:03<00:09, 38.00it/s, est. speed input: 44471.68 toks/s, output: 43.43 toks/s]
Processed prompts:  34%|███▍      | 174/512 [00:04<00:08, 38.03it/s, est. speed input: 44329.76 toks/s, output: 43.29 toks/s]
Processed prompts:  35%|███▍      | 178/512 [00:04<00:08, 38.06it/s, est. speed input: 44195.11 toks/s, output: 43.16 toks/s]
Processed prompts:  36%|███▌      | 182/512 [00:04<00:08, 38.08it/s, est. speed input: 44066.95 toks/s, output: 43.03 toks/s]
Processed prompts:  36%|███▋      | 186/512 [00:04<00:08, 38.05it/s, est. speed input: 43941.56 toks/s, output: 42.91 toks/s]
Processed prompts:  37%|███▋      | 190/512 [00:04<00:08, 37.97it/s, est. speed input: 43815.85 toks/s, output: 42.79 toks/s]
Processed prompts:  38%|███▊      | 194/512 [00:04<00:08, 37.98it/s, est. speed input: 43703.04 toks/s, output: 42.68 toks/s]
Processed prompts:  39%|███▊      | 198/512 [00:04<00:08, 37.97it/s, est. speed input: 43592.70 toks/s, output: 42.57 toks/s]
Processed prompts:  39%|███▉      | 202/512 [00:04<00:08, 37.99it/s, est. speed input: 43489.83 toks/s, output: 42.47 toks/s]
Processed prompts:  40%|████      | 206/512 [00:04<00:08, 38.03it/s, est. speed input: 43393.68 toks/s, output: 42.38 toks/s]
Processed prompts:  41%|████      | 210/512 [00:04<00:07, 37.98it/s, est. speed input: 43296.01 toks/s, output: 42.28 toks/s]
Processed prompts:  42%|████▏     | 214/512 [00:05<00:07, 37.99it/s, est. speed input: 43205.32 toks/s, output: 42.19 toks/s]
Processed prompts:  43%|████▎     | 218/512 [00:05<00:07, 38.02it/s, est. speed input: 43119.98 toks/s, output: 42.11 toks/s]
Processed prompts:  43%|████▎     | 222/512 [00:05<00:07, 38.07it/s, est. speed input: 43040.01 toks/s, output: 42.03 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:05<00:07, 38.06it/s, est. speed input: 42960.59 toks/s, output: 41.95 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:05<00:07, 38.01it/s, est. speed input: 42880.79 toks/s, output: 41.88 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:05<00:07, 38.02it/s, est. speed input: 42807.13 toks/s, output: 41.80 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:05<00:07, 38.06it/s, est. speed input: 42737.95 toks/s, output: 41.74 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:05<00:07, 38.05it/s, est. speed input: 42669.42 toks/s, output: 41.67 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:05<00:06, 38.02it/s, est. speed input: 42601.78 toks/s, output: 41.60 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:06<00:06, 38.02it/s, est. speed input: 42537.28 toks/s, output: 41.54 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:06<00:06, 38.03it/s, est. speed input: 42475.89 toks/s, output: 41.48 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:06<00:06, 38.05it/s, est. speed input: 42417.55 toks/s, output: 41.42 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:06<00:06, 38.06it/s, est. speed input: 42360.66 toks/s, output: 41.37 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:06<00:06, 38.00it/s, est. speed input: 42301.87 toks/s, output: 41.31 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:06<00:06, 37.98it/s, est. speed input: 42246.32 toks/s, output: 41.26 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:06<00:06, 37.97it/s, est. speed input: 42192.67 toks/s, output: 41.20 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:06<00:06, 38.01it/s, est. speed input: 42143.02 toks/s, output: 41.16 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:06<00:06, 37.99it/s, est. speed input: 42092.34 toks/s, output: 41.11 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:06<00:05, 37.97it/s, est. speed input: 42043.19 toks/s, output: 41.06 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:07<00:05, 37.97it/s, est. speed input: 41995.81 toks/s, output: 41.01 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:07<00:05, 37.97it/s, est. speed input: 41950.52 toks/s, output: 40.97 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:07<00:05, 37.96it/s, est. speed input: 41905.58 toks/s, output: 40.92 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:07<00:05, 37.94it/s, est. speed input: 41861.33 toks/s, output: 40.88 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:07<00:05, 37.92it/s, est. speed input: 41817.91 toks/s, output: 40.84 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:07<00:05, 37.92it/s, est. speed input: 41776.10 toks/s, output: 40.80 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:07<00:05, 37.93it/s, est. speed input: 41736.19 toks/s, output: 40.76 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:07<00:05, 37.93it/s, est. speed input: 41697.48 toks/s, output: 40.72 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:07<00:05, 37.97it/s, est. speed input: 41661.25 toks/s, output: 40.68 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:08<00:04, 38.00it/s, est. speed input: 41625.96 toks/s, output: 40.65 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:08<00:04, 38.04it/s, est. speed input: 41592.67 toks/s, output: 40.62 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:08<00:04, 38.07it/s, est. speed input: 41560.51 toks/s, output: 40.59 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:08<00:04, 38.08it/s, est. speed input: 41528.39 toks/s, output: 40.56 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:08<00:04, 38.05it/s, est. speed input: 41495.71 toks/s, output: 40.52 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:08<00:04, 38.00it/s, est. speed input: 41462.37 toks/s, output: 40.49 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:08<00:04, 38.03it/s, est. speed input: 41432.57 toks/s, output: 40.46 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:08<00:04, 38.05it/s, est. speed input: 41403.56 toks/s, output: 40.43 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:08<00:04, 38.08it/s, est. speed input: 41375.72 toks/s, output: 40.41 toks/s]
Processed prompts:  71%|███████   | 362/512 [00:08<00:03, 38.06it/s, est. speed input: 41347.16 toks/s, output: 40.38 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:09<00:03, 38.03it/s, est. speed input: 41318.42 toks/s, output: 40.35 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [00:09<00:03, 38.06it/s, est. speed input: 41292.16 toks/s, output: 40.32 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [00:09<00:03, 38.07it/s, est. speed input: 41266.37 toks/s, output: 40.30 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [00:09<00:03, 38.10it/s, est. speed input: 41241.90 toks/s, output: 40.28 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [00:09<00:03, 38.04it/s, est. speed input: 41214.83 toks/s, output: 40.25 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [00:09<00:03, 38.00it/s, est. speed input: 41188.51 toks/s, output: 40.22 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [00:09<00:03, 38.00it/s, est. speed input: 41163.75 toks/s, output: 40.20 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [00:09<00:03, 38.00it/s, est. speed input: 41139.74 toks/s, output: 40.18 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [00:09<00:03, 37.98it/s, est. speed input: 41115.38 toks/s, output: 40.15 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [00:10<00:02, 37.99it/s, est. speed input: 41092.22 toks/s, output: 40.13 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [00:10<00:02, 38.00it/s, est. speed input: 41069.91 toks/s, output: 40.11 toks/s]
Processed prompts:  80%|████████  | 410/512 [00:10<00:02, 37.98it/s, est. speed input: 41046.95 toks/s, output: 40.08 toks/s]
Processed prompts:  81%|████████  | 414/512 [00:10<00:02, 38.03it/s, est. speed input: 41026.80 toks/s, output: 40.07 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [00:10<00:02, 38.01it/s, est. speed input: 41005.02 toks/s, output: 40.04 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [00:10<00:02, 38.05it/s, est. speed input: 40985.65 toks/s, output: 40.03 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [00:10<00:02, 37.99it/s, est. speed input: 40963.60 toks/s, output: 40.00 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [00:10<00:02, 38.00it/s, est. speed input: 40943.68 toks/s, output: 39.98 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [00:10<00:02, 37.98it/s, est. speed input: 40923.30 toks/s, output: 39.96 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [00:10<00:01, 37.96it/s, est. speed input: 40902.99 toks/s, output: 39.94 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [00:11<00:01, 37.93it/s, est. speed input: 40882.74 toks/s, output: 39.92 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [00:11<00:01, 37.92it/s, est. speed input: 40863.25 toks/s, output: 39.91 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [00:11<00:01, 37.95it/s, est. speed input: 40845.04 toks/s, output: 39.89 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [00:11<00:01, 37.97it/s, est. speed input: 40827.28 toks/s, output: 39.87 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [00:11<00:01, 37.96it/s, est. speed input: 40809.10 toks/s, output: 39.85 toks/s]
Processed prompts:  90%|█████████ | 462/512 [00:11<00:01, 37.98it/s, est. speed input: 40792.08 toks/s, output: 39.84 toks/s]
Processed prompts:  91%|█████████ | 466/512 [00:11<00:01, 38.00it/s, est. speed input: 40775.61 toks/s, output: 39.82 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [00:11<00:01, 38.01it/s, est. speed input: 40759.28 toks/s, output: 39.80 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [00:11<00:01, 37.96it/s, est. speed input: 40741.62 toks/s, output: 39.79 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [00:12<00:00, 37.94it/s, est. speed input: 40724.50 toks/s, output: 39.77 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [00:12<00:00, 37.92it/s, est. speed input: 40707.55 toks/s, output: 39.75 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [00:12<00:00, 37.92it/s, est. speed input: 40691.41 toks/s, output: 39.74 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [00:12<00:00, 37.92it/s, est. speed input: 40675.61 toks/s, output: 39.72 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [00:12<00:00, 37.88it/s, est. speed input: 40658.55 toks/s, output: 39.71 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [00:12<00:00, 37.85it/s, est. speed input: 40641.99 toks/s, output: 39.69 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [00:12<00:00, 37.84it/s, est. speed input: 40626.08 toks/s, output: 39.67 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [00:12<00:00, 37.85it/s, est. speed input: 40610.58 toks/s, output: 39.66 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:12<00:00, 37.85it/s, est. speed input: 40821.86 toks/s, output: 39.87 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:12<00:00, 39.86it/s, est. speed input: 40821.86 toks/s, output: 39.87 toks/s]
[rank0]:[W128 01:05:18.732596529 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 37.0s

测试结果:
  Requests/s:   37.83
  Tokens/s:     38775.37
  Total Reqs:   512
  Elapsed:      13.53s

  [Prefill 分析]
  Total Prefill Tokens: 524288
  Prefill Tokens/s:     38737.54

============================================================
[5/7] 测试 M=8192
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 8192
│   M_prefill     = 8192 (= 8 x 1024)
│   M_decode      = 8
│   batched_tokens = 8192 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 1024
│   --max-num-seqs           = 8
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 8192
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 01:05:26 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3524606) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3524606) WARNING 01-28 01:05:36 [backends.py:609] Failed to read file <frozen os>
Throughput: 36.16 requests/s, 37060.88 total tokens/s, 36.16 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024


─── STDERR ───
[2026-01-28 01:05:26] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 01:05:26] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 01:05:26] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 01:05:26] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:05:26] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:05:26] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:05:26] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:05:26] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:05:26] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 01:05:26] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 01:05:26] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 01:05:26] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 01:05:26] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 01:05:26] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 01:05:30] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 01:05:30] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 01:05:30] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 01:05:30] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:05:30] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:05:30] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:05:30] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:05:30] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:05:30] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 01:05:30] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 01:05:30] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 01:05:30] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 01:05:30] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 01:05:30] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3524606) [2026-01-28 01:05:31] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3524606) [2026-01-28 01:05:31] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3524606) [2026-01-28 01:05:31] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3524606) [2026-01-28 01:05:31] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=3524606) [2026-01-28 01:05:31] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3524606) [2026-01-28 01:05:31] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3524606) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3524606) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.71it/s]
(EngineCore_DP0 pid=3524606) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.71it/s]
(EngineCore_DP0 pid=3524606) 
(EngineCore_DP0 pid=3524606) [2026-01-28 01:05:31] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 4096] -> 1D uint8
(EngineCore_DP0 pid=3524606) [2026-01-28 01:05:31] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 9830400 bytes
(EngineCore_DP0 pid=3524606) [2026-01-28 01:05:31] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 4096] -> 1D uint8
(EngineCore_DP0 pid=3524606) [2026-01-28 01:05:31] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 6553600 bytes
(EngineCore_DP0 pid=3524606) [2026-01-28 01:05:31] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 4096] -> 1D uint8
(EngineCore_DP0 pid=3524606) [2026-01-28 01:05:31] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 35389440 bytes
(EngineCore_DP0 pid=3524606) [2026-01-28 01:05:31] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 11072] -> 1D uint8
(EngineCore_DP0 pid=3524606) [2026-01-28 01:05:31] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 17735680 bytes
(EngineCore_DP0 pid=3524606) 2026-01-28 01:05:41,943 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3524606) 2026-01-28 01:05:41,959 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3524606) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:01,  3.34it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  80%|████████  | 4/5 [00:00<00:00, 10.94it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00, 10.40it/s]
(EngineCore_DP0 pid=3524606) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:00,  7.11it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00, 17.73it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00, 15.94it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   7%|▋         | 70/1024 [00:00<00:01, 699.19it/s]
Adding requests:  14%|█▍        | 146/1024 [00:00<00:01, 734.90it/s]
Adding requests:  22%|██▏       | 223/1024 [00:00<00:01, 748.80it/s]
Adding requests:  29%|██▉       | 300/1024 [00:00<00:00, 751.41it/s]
Adding requests:  37%|███▋      | 378/1024 [00:00<00:00, 761.55it/s]
Adding requests:  44%|████▍     | 455/1024 [00:00<00:00, 753.35it/s]
Adding requests:  52%|█████▏    | 531/1024 [00:00<00:00, 736.32it/s]
Adding requests:  59%|█████▉    | 608/1024 [00:00<00:00, 743.77it/s]
Adding requests:  67%|██████▋   | 686/1024 [00:00<00:00, 753.57it/s]
Adding requests:  75%|███████▍  | 763/1024 [00:01<00:00, 756.88it/s]
Adding requests:  82%|████████▏ | 839/1024 [00:01<00:00, 741.09it/s]
Adding requests:  90%|████████▉ | 917/1024 [00:01<00:00, 750.68it/s]
Adding requests:  97%|█████████▋| 993/1024 [00:01<00:00, 744.16it/s]
Adding requests: 100%|██████████| 1024/1024 [00:01<00:00, 747.22it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▍         | 50/1024 [00:00<00:05, 193.54it/s, est. speed input: 198197.49 toks/s, output: 193.55 toks/s]
Processed prompts:   7%|▋         | 70/1024 [00:00<00:10, 88.46it/s, est. speed input: 102512.18 toks/s, output: 100.11 toks/s] 
Processed prompts:   8%|▊         | 81/1024 [00:00<00:12, 75.53it/s, est. speed input: 90214.82 toks/s, output: 88.10 toks/s]  
Processed prompts:   9%|▉         | 90/1024 [00:01<00:19, 48.54it/s, est. speed input: 67771.60 toks/s, output: 66.18 toks/s]
Processed prompts:  10%|▉         | 98/1024 [00:01<00:20, 45.38it/s, est. speed input: 63513.24 toks/s, output: 62.02 toks/s]
Processed prompts:  10%|█         | 106/1024 [00:01<00:21, 42.94it/s, est. speed input: 60296.01 toks/s, output: 58.88 toks/s]
Processed prompts:  11%|█         | 114/1024 [00:02<00:22, 41.09it/s, est. speed input: 57778.07 toks/s, output: 56.42 toks/s]
Processed prompts:  12%|█▏        | 122/1024 [00:02<00:22, 39.74it/s, est. speed input: 55755.79 toks/s, output: 54.45 toks/s]
Processed prompts:  13%|█▎        | 130/1024 [00:02<00:23, 38.73it/s, est. speed input: 54084.86 toks/s, output: 52.82 toks/s]
Processed prompts:  13%|█▎        | 138/1024 [00:02<00:23, 38.03it/s, est. speed input: 52698.92 toks/s, output: 51.46 toks/s]
Processed prompts:  14%|█▍        | 146/1024 [00:02<00:23, 37.53it/s, est. speed input: 51522.39 toks/s, output: 50.31 toks/s]
Processed prompts:  15%|█▌        | 154/1024 [00:03<00:23, 37.16it/s, est. speed input: 50509.65 toks/s, output: 49.33 toks/s]
Processed prompts:  16%|█▌        | 162/1024 [00:03<00:23, 36.90it/s, est. speed input: 49627.22 toks/s, output: 48.46 toks/s]
Processed prompts:  17%|█▋        | 170/1024 [00:03<00:23, 36.71it/s, est. speed input: 48853.52 toks/s, output: 47.71 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [00:03<00:23, 36.60it/s, est. speed input: 48176.99 toks/s, output: 47.05 toks/s]
Processed prompts:  18%|█▊        | 186/1024 [00:04<00:22, 36.52it/s, est. speed input: 47572.71 toks/s, output: 46.46 toks/s]
Processed prompts:  19%|█▉        | 194/1024 [00:04<00:22, 36.45it/s, est. speed input: 47029.04 toks/s, output: 45.93 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [00:04<00:22, 36.39it/s, est. speed input: 46536.97 toks/s, output: 45.45 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:04<00:22, 36.37it/s, est. speed input: 46097.02 toks/s, output: 45.02 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [00:04<00:22, 36.35it/s, est. speed input: 45694.18 toks/s, output: 44.62 toks/s]
Processed prompts:  22%|██▏       | 226/1024 [00:05<00:21, 36.35it/s, est. speed input: 45329.19 toks/s, output: 44.27 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:05<00:21, 36.35it/s, est. speed input: 44993.72 toks/s, output: 43.94 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:05<00:21, 36.33it/s, est. speed input: 44682.03 toks/s, output: 43.63 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:05<00:21, 36.32it/s, est. speed input: 44394.37 toks/s, output: 43.35 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:05<00:21, 36.32it/s, est. speed input: 44130.09 toks/s, output: 43.10 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:06<00:20, 36.31it/s, est. speed input: 43882.87 toks/s, output: 42.85 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:06<00:20, 36.30it/s, est. speed input: 43651.15 toks/s, output: 42.63 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:06<00:20, 36.29it/s, est. speed input: 43434.89 toks/s, output: 42.42 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:06<00:20, 36.30it/s, est. speed input: 43235.53 toks/s, output: 42.22 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:07<00:19, 36.31it/s, est. speed input: 43047.75 toks/s, output: 42.04 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:07<00:19, 36.32it/s, est. speed input: 42872.49 toks/s, output: 41.87 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:07<00:19, 36.31it/s, est. speed input: 42705.48 toks/s, output: 41.70 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:07<00:19, 36.31it/s, est. speed input: 42547.82 toks/s, output: 41.55 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:07<00:19, 36.31it/s, est. speed input: 42399.91 toks/s, output: 41.41 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:08<00:18, 36.32it/s, est. speed input: 42260.24 toks/s, output: 41.27 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:08<00:18, 36.29it/s, est. speed input: 42124.19 toks/s, output: 41.14 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:08<00:18, 36.30it/s, est. speed input: 41998.43 toks/s, output: 41.01 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:08<00:18, 36.27it/s, est. speed input: 41875.53 toks/s, output: 40.89 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:09<00:18, 36.27it/s, est. speed input: 41760.44 toks/s, output: 40.78 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:09<00:17, 36.27it/s, est. speed input: 41651.18 toks/s, output: 40.67 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:09<00:17, 36.27it/s, est. speed input: 41546.12 toks/s, output: 40.57 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [00:09<00:17, 36.26it/s, est. speed input: 41445.80 toks/s, output: 40.47 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:09<00:17, 36.28it/s, est. speed input: 41352.02 toks/s, output: 40.38 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:10<00:16, 36.30it/s, est. speed input: 41262.18 toks/s, output: 40.30 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:10<00:16, 36.30it/s, est. speed input: 41175.29 toks/s, output: 40.21 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:10<00:16, 36.29it/s, est. speed input: 41091.36 toks/s, output: 40.13 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:10<00:16, 36.29it/s, est. speed input: 41011.52 toks/s, output: 40.05 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:11<00:16, 36.29it/s, est. speed input: 40934.98 toks/s, output: 39.98 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:11<00:15, 36.27it/s, est. speed input: 40859.89 toks/s, output: 39.90 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:11<00:15, 36.27it/s, est. speed input: 40788.10 toks/s, output: 39.83 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:11<00:15, 36.26it/s, est. speed input: 40718.65 toks/s, output: 39.76 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:11<00:15, 36.23it/s, est. speed input: 40650.61 toks/s, output: 39.70 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:12<00:14, 36.22it/s, est. speed input: 40585.50 toks/s, output: 39.63 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:12<00:14, 36.20it/s, est. speed input: 40521.95 toks/s, output: 39.57 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:12<00:14, 36.20it/s, est. speed input: 40461.34 toks/s, output: 39.51 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:12<00:14, 36.22it/s, est. speed input: 40403.80 toks/s, output: 39.46 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:13<00:14, 36.21it/s, est. speed input: 40347.49 toks/s, output: 39.40 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:13<00:13, 36.21it/s, est. speed input: 40293.18 toks/s, output: 39.35 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:13<00:13, 36.19it/s, est. speed input: 40239.33 toks/s, output: 39.30 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:13<00:13, 36.20it/s, est. speed input: 40188.72 toks/s, output: 39.25 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:13<00:13, 36.21it/s, est. speed input: 40139.48 toks/s, output: 39.20 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:14<00:12, 36.21it/s, est. speed input: 40092.08 toks/s, output: 39.15 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:14<00:12, 36.18it/s, est. speed input: 40043.92 toks/s, output: 39.11 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:14<00:12, 36.18it/s, est. speed input: 39998.40 toks/s, output: 39.06 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:14<00:12, 36.19it/s, est. speed input: 39955.22 toks/s, output: 39.02 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:15<00:12, 36.19it/s, est. speed input: 39912.74 toks/s, output: 38.98 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:15<00:11, 36.18it/s, est. speed input: 39870.77 toks/s, output: 38.94 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:15<00:11, 36.16it/s, est. speed input: 39829.48 toks/s, output: 38.90 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:15<00:11, 36.17it/s, est. speed input: 39790.50 toks/s, output: 38.86 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:15<00:11, 36.18it/s, est. speed input: 39752.46 toks/s, output: 38.82 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:16<00:11, 36.18it/s, est. speed input: 39715.40 toks/s, output: 38.78 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:16<00:10, 36.17it/s, est. speed input: 39678.93 toks/s, output: 38.75 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:16<00:10, 36.19it/s, est. speed input: 39644.58 toks/s, output: 38.72 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:16<00:10, 36.20it/s, est. speed input: 39611.10 toks/s, output: 38.68 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:17<00:10, 36.22it/s, est. speed input: 39578.85 toks/s, output: 38.65 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:17<00:09, 36.19it/s, est. speed input: 39545.85 toks/s, output: 38.62 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:17<00:09, 36.17it/s, est. speed input: 39513.53 toks/s, output: 38.59 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:17<00:09, 36.19it/s, est. speed input: 39483.20 toks/s, output: 38.56 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:17<00:09, 36.19it/s, est. speed input: 39453.45 toks/s, output: 38.53 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:18<00:09, 36.19it/s, est. speed input: 39424.24 toks/s, output: 38.50 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:18<00:08, 36.17it/s, est. speed input: 39395.04 toks/s, output: 38.47 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:18<00:08, 36.17it/s, est. speed input: 39366.88 toks/s, output: 38.44 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:18<00:08, 36.17it/s, est. speed input: 39339.47 toks/s, output: 38.42 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:19<00:08, 36.20it/s, est. speed input: 39313.88 toks/s, output: 38.39 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:19<00:07, 36.21it/s, est. speed input: 39288.52 toks/s, output: 38.37 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:19<00:07, 36.18it/s, est. speed input: 39262.34 toks/s, output: 38.34 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:19<00:07, 36.18it/s, est. speed input: 39237.46 toks/s, output: 38.32 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:19<00:07, 36.20it/s, est. speed input: 39213.81 toks/s, output: 38.29 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:20<00:07, 36.19it/s, est. speed input: 39189.99 toks/s, output: 38.27 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:20<00:06, 36.17it/s, est. speed input: 39165.96 toks/s, output: 38.25 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:20<00:06, 36.17it/s, est. speed input: 39143.13 toks/s, output: 38.23 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:20<00:06, 36.19it/s, est. speed input: 39121.48 toks/s, output: 38.20 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:21<00:06, 36.19it/s, est. speed input: 39099.71 toks/s, output: 38.18 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:21<00:05, 36.18it/s, est. speed input: 39078.02 toks/s, output: 38.16 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:21<00:05, 36.16it/s, est. speed input: 39056.48 toks/s, output: 38.14 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:21<00:05, 36.17it/s, est. speed input: 39035.98 toks/s, output: 38.12 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:21<00:05, 36.18it/s, est. speed input: 39016.14 toks/s, output: 38.10 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [00:22<00:05, 36.19it/s, est. speed input: 38996.86 toks/s, output: 38.08 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [00:22<00:04, 36.17it/s, est. speed input: 38976.90 toks/s, output: 38.06 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:22<00:04, 36.18it/s, est. speed input: 38958.16 toks/s, output: 38.05 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [00:22<00:04, 36.19it/s, est. speed input: 38939.93 toks/s, output: 38.03 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [00:22<00:04, 36.19it/s, est. speed input: 38922.06 toks/s, output: 38.01 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [00:23<00:03, 36.22it/s, est. speed input: 38905.05 toks/s, output: 37.99 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [00:23<00:03, 36.20it/s, est. speed input: 38887.52 toks/s, output: 37.98 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [00:23<00:03, 36.19it/s, est. speed input: 38869.93 toks/s, output: 37.96 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [00:23<00:03, 36.18it/s, est. speed input: 38853.02 toks/s, output: 37.94 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [00:24<00:03, 36.17it/s, est. speed input: 38836.22 toks/s, output: 37.93 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [00:24<00:02, 36.18it/s, est. speed input: 38820.04 toks/s, output: 37.91 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [00:24<00:02, 36.16it/s, est. speed input: 38803.52 toks/s, output: 37.89 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [00:24<00:02, 36.16it/s, est. speed input: 38787.66 toks/s, output: 37.88 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [00:24<00:02, 36.17it/s, est. speed input: 38772.52 toks/s, output: 37.86 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [00:25<00:01, 36.19it/s, est. speed input: 38757.79 toks/s, output: 37.85 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [00:25<00:01, 36.17it/s, est. speed input: 38742.37 toks/s, output: 37.83 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [00:25<00:01, 36.18it/s, est. speed input: 38728.12 toks/s, output: 37.82 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [00:25<00:01, 36.18it/s, est. speed input: 38713.79 toks/s, output: 37.81 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [00:26<00:01, 36.19it/s, est. speed input: 38699.98 toks/s, output: 37.79 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [00:26<00:00, 36.19it/s, est. speed input: 38686.20 toks/s, output: 37.78 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [00:26<00:00, 36.18it/s, est. speed input: 38672.19 toks/s, output: 37.77 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [00:26<00:00, 36.19it/s, est. speed input: 38659.24 toks/s, output: 37.75 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [00:26<00:00, 37.42it/s, est. speed input: 38680.76 toks/s, output: 37.77 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:26<00:00, 37.42it/s, est. speed input: 38908.56 toks/s, output: 38.00 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:26<00:00, 38.00it/s, est. speed input: 38908.56 toks/s, output: 38.00 toks/s]
[rank0]:[W128 01:06:12.931113187 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 53.3s

测试结果:
  Requests/s:   36.16
  Tokens/s:     37060.88
  Total Reqs:   1024
  Elapsed:      28.32s

  [Prefill 分析]
  Total Prefill Tokens: 1048576
  Prefill Tokens/s:     37024.72

============================================================
[6/7] 测试 M=16384
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 16384
│   M_prefill     = 16384 (= 16 x 1024)
│   M_decode      = 16
│   batched_tokens = 16384 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 2048
│   --max-num-seqs           = 16
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 16384
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 01:06:22 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3525665) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3525665) WARNING 01-28 01:06:32 [backends.py:609] Failed to read file <frozen os>
Throughput: 35.64 requests/s, 36527.30 total tokens/s, 35.64 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048


─── STDERR ───
[2026-01-28 01:06:22] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 01:06:22] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 01:06:22] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 01:06:22] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:06:22] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:06:22] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:06:22] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:06:22] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:06:22] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 01:06:22] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 01:06:22] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 01:06:22] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 01:06:22] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 01:06:22] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 01:06:26] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 01:06:26] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 01:06:26] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 01:06:26] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:06:26] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:06:26] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:06:26] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:06:26] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:06:26] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 01:06:26] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 01:06:26] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 01:06:26] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 01:06:26] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 01:06:26] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3525665) [2026-01-28 01:06:27] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3525665) [2026-01-28 01:06:27] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3525665) [2026-01-28 01:06:27] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3525665) [2026-01-28 01:06:27] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=3525665) [2026-01-28 01:06:27] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3525665) [2026-01-28 01:06:27] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3525665) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3525665) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.52it/s]
(EngineCore_DP0 pid=3525665) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.52it/s]
(EngineCore_DP0 pid=3525665) 
(EngineCore_DP0 pid=3525665) [2026-01-28 01:06:28] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 4096] -> 1D uint8
(EngineCore_DP0 pid=3525665) [2026-01-28 01:06:28] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 9830400 bytes
(EngineCore_DP0 pid=3525665) [2026-01-28 01:06:28] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 4096] -> 1D uint8
(EngineCore_DP0 pid=3525665) [2026-01-28 01:06:28] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 6553600 bytes
(EngineCore_DP0 pid=3525665) [2026-01-28 01:06:28] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 4096] -> 1D uint8
(EngineCore_DP0 pid=3525665) [2026-01-28 01:06:28] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 35389440 bytes
(EngineCore_DP0 pid=3525665) [2026-01-28 01:06:28] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 11072] -> 1D uint8
(EngineCore_DP0 pid=3525665) [2026-01-28 01:06:28] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 17735680 bytes
(EngineCore_DP0 pid=3525665) 2026-01-28 01:06:38,287 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3525665) 2026-01-28 01:06:38,303 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3525665) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  14%|█▍        | 1/7 [00:00<00:01,  4.15it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  57%|█████▋    | 4/7 [00:00<00:00, 12.94it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00, 17.44it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00, 14.63it/s]
(EngineCore_DP0 pid=3525665) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  20%|██        | 1/5 [00:00<00:00,  7.01it/s]
Capturing CUDA graphs (decode, FULL):  80%|████████  | 4/5 [00:00<00:00, 14.32it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00, 13.83it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   4%|▎         | 73/2048 [00:00<00:02, 724.04it/s]
Adding requests:   7%|▋         | 146/2048 [00:00<00:02, 724.35it/s]
Adding requests:  11%|█         | 221/2048 [00:00<00:02, 732.91it/s]
Adding requests:  14%|█▍        | 296/2048 [00:00<00:02, 738.97it/s]
Adding requests:  18%|█▊        | 371/2048 [00:00<00:02, 741.56it/s]
Adding requests:  22%|██▏       | 448/2048 [00:00<00:02, 748.88it/s]
Adding requests:  26%|██▌       | 523/2048 [00:00<00:02, 745.14it/s]
Adding requests:  29%|██▉       | 602/2048 [00:00<00:01, 757.02it/s]
Adding requests:  33%|███▎      | 681/2048 [00:00<00:01, 766.94it/s]
Adding requests:  37%|███▋      | 758/2048 [00:01<00:01, 758.38it/s]
Adding requests:  41%|████      | 834/2048 [00:01<00:01, 742.14it/s]
Adding requests:  45%|████▍     | 912/2048 [00:01<00:01, 750.45it/s]
Adding requests:  48%|████▊     | 990/2048 [00:01<00:01, 757.05it/s]
Adding requests:  52%|█████▏    | 1068/2048 [00:01<00:01, 762.97it/s]
Adding requests:  56%|█████▌    | 1145/2048 [00:01<00:01, 756.68it/s]
Adding requests:  60%|█████▉    | 1221/2048 [00:01<00:01, 745.92it/s]
Adding requests:  63%|██████▎   | 1296/2048 [00:01<00:01, 737.79it/s]
Adding requests:  67%|██████▋   | 1372/2048 [00:01<00:00, 743.69it/s]
Adding requests:  71%|███████   | 1449/2048 [00:01<00:00, 749.25it/s]
Adding requests:  75%|███████▍  | 1528/2048 [00:02<00:00, 759.04it/s]
Adding requests:  79%|███████▊  | 1608/2048 [00:02<00:00, 769.49it/s]
Adding requests:  82%|████████▏ | 1685/2048 [00:02<00:00, 746.40it/s]
Adding requests:  86%|████████▌ | 1760/2048 [00:02<00:00, 734.32it/s]
Adding requests:  90%|████████▉ | 1834/2048 [00:02<00:00, 735.81it/s]
Adding requests:  93%|█████████▎| 1909/2048 [00:02<00:00, 739.65it/s]
Adding requests:  97%|█████████▋| 1984/2048 [00:02<00:00, 733.99it/s]
Adding requests: 100%|██████████| 2048/2048 [00:02<00:00, 747.42it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▍         | 98/2048 [00:00<00:09, 206.06it/s, est. speed input: 211011.63 toks/s, output: 206.06 toks/s]
Processed prompts:   6%|▌         | 119/2048 [00:00<00:16, 114.78it/s, est. speed input: 131982.45 toks/s, output: 128.89 toks/s]
Processed prompts:   6%|▋         | 131/2048 [00:01<00:25, 75.20it/s, est. speed input: 97885.49 toks/s, output: 95.59 toks/s]   
Processed prompts:   7%|▋         | 146/2048 [00:01<00:32, 58.89it/s, est. speed input: 82241.15 toks/s, output: 80.31 toks/s]
Processed prompts:   8%|▊         | 162/2048 [00:02<00:37, 50.60it/s, est. speed input: 73235.72 toks/s, output: 71.52 toks/s]
Processed prompts:   9%|▊         | 178/2048 [00:02<00:41, 45.56it/s, est. speed input: 67185.14 toks/s, output: 65.61 toks/s]
Processed prompts:   9%|▉         | 194/2048 [00:03<00:43, 42.36it/s, est. speed input: 62856.78 toks/s, output: 61.38 toks/s]
Processed prompts:  10%|█         | 210/2048 [00:03<00:45, 40.25it/s, est. speed input: 59595.79 toks/s, output: 58.20 toks/s]
Processed prompts:  11%|█         | 226/2048 [00:04<00:46, 38.85it/s, est. speed input: 57060.60 toks/s, output: 55.72 toks/s]
Processed prompts:  12%|█▏        | 242/2048 [00:04<00:47, 37.81it/s, est. speed input: 54990.25 toks/s, output: 53.70 toks/s]
Processed prompts:  13%|█▎        | 258/2048 [00:04<00:48, 37.19it/s, est. speed input: 53334.80 toks/s, output: 52.08 toks/s]
Processed prompts:  13%|█▎        | 274/2048 [00:05<00:48, 36.74it/s, est. speed input: 51944.29 toks/s, output: 50.73 toks/s]
Processed prompts:  14%|█▍        | 290/2048 [00:05<00:48, 36.42it/s, est. speed input: 50764.16 toks/s, output: 49.57 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [00:06<00:48, 36.21it/s, est. speed input: 49754.76 toks/s, output: 48.59 toks/s]
Processed prompts:  16%|█▌        | 322/2048 [00:06<00:47, 36.06it/s, est. speed input: 48879.02 toks/s, output: 47.73 toks/s]
Processed prompts:  17%|█▋        | 338/2048 [00:07<00:47, 35.94it/s, est. speed input: 48107.48 toks/s, output: 46.98 toks/s]
Processed prompts:  17%|█▋        | 354/2048 [00:07<00:47, 35.85it/s, est. speed input: 47425.89 toks/s, output: 46.31 toks/s]
Processed prompts:  18%|█▊        | 370/2048 [00:08<00:46, 35.79it/s, est. speed input: 46820.31 toks/s, output: 45.72 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [00:08<00:46, 35.75it/s, est. speed input: 46278.80 toks/s, output: 45.19 toks/s]
Processed prompts:  20%|█▉        | 402/2048 [00:08<00:46, 35.72it/s, est. speed input: 45790.56 toks/s, output: 44.72 toks/s]
Processed prompts:  20%|██        | 418/2048 [00:09<00:45, 35.70it/s, est. speed input: 45348.51 toks/s, output: 44.29 toks/s]
Processed prompts:  21%|██        | 434/2048 [00:09<00:45, 35.68it/s, est. speed input: 44946.17 toks/s, output: 43.89 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [00:10<00:44, 35.67it/s, est. speed input: 44579.20 toks/s, output: 43.53 toks/s]
Processed prompts:  23%|██▎       | 466/2048 [00:10<00:44, 35.65it/s, est. speed input: 44240.79 toks/s, output: 43.20 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [00:11<00:43, 35.64it/s, est. speed input: 43931.20 toks/s, output: 42.90 toks/s]
Processed prompts:  24%|██▍       | 498/2048 [00:11<00:43, 35.64it/s, est. speed input: 43644.80 toks/s, output: 42.62 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [00:12<00:43, 35.64it/s, est. speed input: 43380.59 toks/s, output: 42.36 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [00:12<00:42, 35.64it/s, est. speed input: 43134.46 toks/s, output: 42.12 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [00:13<00:42, 35.64it/s, est. speed input: 42905.87 toks/s, output: 41.90 toks/s]
Processed prompts:  27%|██▋       | 562/2048 [00:13<00:41, 35.63it/s, est. speed input: 42691.75 toks/s, output: 41.69 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [00:13<00:41, 35.64it/s, est. speed input: 42491.92 toks/s, output: 41.50 toks/s]
Processed prompts:  29%|██▉       | 594/2048 [00:14<00:40, 35.64it/s, est. speed input: 42304.81 toks/s, output: 41.31 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [00:14<00:40, 35.64it/s, est. speed input: 42129.30 toks/s, output: 41.14 toks/s]
Processed prompts:  31%|███       | 626/2048 [00:15<00:39, 35.64it/s, est. speed input: 41963.80 toks/s, output: 40.98 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [00:15<00:39, 35.64it/s, est. speed input: 41807.61 toks/s, output: 40.83 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [00:16<00:39, 35.64it/s, est. speed input: 41660.21 toks/s, output: 40.68 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [00:16<00:38, 35.63it/s, est. speed input: 41519.66 toks/s, output: 40.55 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [00:17<00:38, 35.64it/s, est. speed input: 41387.93 toks/s, output: 40.42 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [00:17<00:37, 35.63it/s, est. speed input: 41261.84 toks/s, output: 40.29 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [00:17<00:37, 35.61it/s, est. speed input: 41140.36 toks/s, output: 40.18 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [00:18<00:36, 35.61it/s, est. speed input: 41025.96 toks/s, output: 40.06 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [00:18<00:36, 35.61it/s, est. speed input: 40917.48 toks/s, output: 39.96 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [00:19<00:35, 35.62it/s, est. speed input: 40814.50 toks/s, output: 39.86 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [00:19<00:35, 35.62it/s, est. speed input: 40715.86 toks/s, output: 39.76 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [00:20<00:34, 35.63it/s, est. speed input: 40622.38 toks/s, output: 39.67 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [00:20<00:34, 35.62it/s, est. speed input: 40531.82 toks/s, output: 39.58 toks/s]
Processed prompts:  41%|████      | 834/2048 [00:21<00:34, 35.62it/s, est. speed input: 40445.92 toks/s, output: 39.50 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [00:21<00:33, 35.63it/s, est. speed input: 40363.52 toks/s, output: 39.42 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [00:22<00:33, 35.62it/s, est. speed input: 40283.87 toks/s, output: 39.34 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [00:22<00:32, 35.62it/s, est. speed input: 40207.42 toks/s, output: 39.27 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [00:22<00:32, 35.62it/s, est. speed input: 40134.57 toks/s, output: 39.19 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [00:23<00:31, 35.63it/s, est. speed input: 40064.57 toks/s, output: 39.13 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [00:23<00:31, 35.63it/s, est. speed input: 39996.97 toks/s, output: 39.06 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [00:24<00:30, 35.63it/s, est. speed input: 39932.09 toks/s, output: 39.00 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [00:24<00:30, 35.63it/s, est. speed input: 39869.34 toks/s, output: 38.93 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [00:25<00:30, 35.63it/s, est. speed input: 39808.81 toks/s, output: 38.88 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [00:25<00:29, 35.62it/s, est. speed input: 39750.20 toks/s, output: 38.82 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [00:26<00:29, 35.63it/s, est. speed input: 39694.10 toks/s, output: 38.76 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [00:26<00:28, 35.63it/s, est. speed input: 39639.66 toks/s, output: 38.71 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [00:26<00:28, 35.63it/s, est. speed input: 39587.00 toks/s, output: 38.66 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [00:27<00:27, 35.63it/s, est. speed input: 39536.24 toks/s, output: 38.61 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [00:27<00:27, 35.62it/s, est. speed input: 39486.78 toks/s, output: 38.56 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [00:28<00:26, 35.63it/s, est. speed input: 39439.12 toks/s, output: 38.51 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [00:28<00:26, 35.62it/s, est. speed input: 39392.80 toks/s, output: 38.47 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [00:29<00:25, 35.63it/s, est. speed input: 39348.31 toks/s, output: 38.43 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [00:29<00:25, 35.62it/s, est. speed input: 39304.42 toks/s, output: 38.38 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [00:30<00:24, 36.18it/s, est. speed input: 39292.23 toks/s, output: 38.37 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [00:30<00:24, 36.00it/s, est. speed input: 39250.57 toks/s, output: 38.33 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [00:30<00:24, 35.90it/s, est. speed input: 39210.82 toks/s, output: 38.29 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [00:31<00:23, 35.82it/s, est. speed input: 39171.97 toks/s, output: 38.25 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [00:31<00:23, 35.76it/s, est. speed input: 39134.08 toks/s, output: 38.22 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [00:32<00:22, 35.72it/s, est. speed input: 39097.31 toks/s, output: 38.18 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [00:32<00:22, 35.69it/s, est. speed input: 39061.14 toks/s, output: 38.15 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [00:33<00:21, 35.67it/s, est. speed input: 39026.48 toks/s, output: 38.11 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [00:33<00:21, 35.65it/s, est. speed input: 38992.17 toks/s, output: 38.08 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [00:34<00:21, 35.65it/s, est. speed input: 38959.25 toks/s, output: 38.05 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [00:34<00:20, 35.64it/s, est. speed input: 38926.88 toks/s, output: 38.01 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [00:35<00:20, 35.63it/s, est. speed input: 38895.43 toks/s, output: 37.98 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [00:35<00:19, 35.62it/s, est. speed input: 38864.59 toks/s, output: 37.95 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [00:35<00:19, 35.63it/s, est. speed input: 38835.00 toks/s, output: 37.92 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [00:36<00:18, 35.63it/s, est. speed input: 38805.91 toks/s, output: 37.90 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [00:36<00:18, 35.63it/s, est. speed input: 38777.57 toks/s, output: 37.87 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [00:37<00:17, 35.62it/s, est. speed input: 38749.77 toks/s, output: 37.84 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [00:37<00:17, 35.62it/s, est. speed input: 38722.45 toks/s, output: 37.81 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [00:38<00:17, 35.63it/s, est. speed input: 38696.30 toks/s, output: 37.79 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [00:38<00:16, 35.62it/s, est. speed input: 38670.23 toks/s, output: 37.76 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [00:39<00:16, 35.63it/s, est. speed input: 38645.35 toks/s, output: 37.74 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [00:39<00:15, 35.62it/s, est. speed input: 38620.34 toks/s, output: 37.72 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [00:39<00:15, 35.62it/s, est. speed input: 38596.14 toks/s, output: 37.69 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [00:40<00:14, 35.62it/s, est. speed input: 38572.66 toks/s, output: 37.67 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [00:40<00:14, 35.62it/s, est. speed input: 38549.44 toks/s, output: 37.65 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [00:41<00:13, 35.62it/s, est. speed input: 38527.12 toks/s, output: 37.62 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [00:41<00:13, 35.62it/s, est. speed input: 38504.96 toks/s, output: 37.60 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [00:42<00:12, 35.62it/s, est. speed input: 38483.43 toks/s, output: 37.58 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [00:42<00:12, 35.62it/s, est. speed input: 38462.12 toks/s, output: 37.56 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [00:43<00:12, 35.62it/s, est. speed input: 38441.47 toks/s, output: 37.54 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [00:43<00:11, 35.62it/s, est. speed input: 38421.03 toks/s, output: 37.52 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [00:43<00:11, 35.62it/s, est. speed input: 38401.17 toks/s, output: 37.50 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [00:44<00:10, 35.62it/s, est. speed input: 38381.69 toks/s, output: 37.48 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [00:44<00:10, 35.62it/s, est. speed input: 38362.74 toks/s, output: 37.46 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [00:45<00:09, 35.62it/s, est. speed input: 38344.16 toks/s, output: 37.45 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [00:45<00:09, 35.62it/s, est. speed input: 38325.58 toks/s, output: 37.43 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [00:46<00:08, 35.61it/s, est. speed input: 38307.33 toks/s, output: 37.41 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [00:46<00:08, 35.61it/s, est. speed input: 38289.47 toks/s, output: 37.39 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [00:47<00:08, 35.62it/s, est. speed input: 38272.44 toks/s, output: 37.38 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [00:47<00:07, 35.62it/s, est. speed input: 38255.39 toks/s, output: 37.36 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [00:48<00:07, 35.62it/s, est. speed input: 38238.84 toks/s, output: 37.34 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [00:48<00:06, 35.62it/s, est. speed input: 38222.37 toks/s, output: 37.33 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [00:48<00:06, 35.62it/s, est. speed input: 38206.55 toks/s, output: 37.31 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [00:49<00:05, 35.63it/s, est. speed input: 38190.97 toks/s, output: 37.30 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [00:49<00:05, 35.62it/s, est. speed input: 38175.32 toks/s, output: 37.28 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [00:50<00:04, 36.26it/s, est. speed input: 38180.34 toks/s, output: 37.29 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [00:50<00:04, 36.07it/s, est. speed input: 38165.16 toks/s, output: 37.27 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [00:51<00:03, 35.92it/s, est. speed input: 38150.12 toks/s, output: 37.26 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [00:51<00:03, 35.83it/s, est. speed input: 38135.46 toks/s, output: 37.24 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [00:52<00:03, 35.77it/s, est. speed input: 38121.22 toks/s, output: 37.23 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [00:52<00:02, 35.72it/s, est. speed input: 38107.00 toks/s, output: 37.21 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [00:52<00:02, 35.69it/s, est. speed input: 38093.11 toks/s, output: 37.20 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [00:53<00:01, 35.67it/s, est. speed input: 38079.70 toks/s, output: 37.19 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [00:53<00:01, 35.65it/s, est. speed input: 38066.17 toks/s, output: 37.17 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [00:54<00:00, 35.64it/s, est. speed input: 38052.95 toks/s, output: 37.16 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [00:54<00:00, 36.25it/s, est. speed input: 38057.59 toks/s, output: 37.17 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:54<00:00, 36.25it/s, est. speed input: 38319.41 toks/s, output: 37.42 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:54<00:00, 37.42it/s, est. speed input: 38319.41 toks/s, output: 37.42 toks/s]
[rank0]:[W128 01:07:37.610549671 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 85.6s

测试结果:
  Requests/s:   35.64
  Tokens/s:     36527.30
  Total Reqs:   2048
  Elapsed:      57.47s

  [Prefill 分析]
  Total Prefill Tokens: 2097152
  Prefill Tokens/s:     36491.66

============================================================
[7/7] 测试 M=32768
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 32768
│   M_prefill     = 32768 (= 32 x 1024)
│   M_decode      = 32
│   batched_tokens = 32768 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 4096
│   --max-num-seqs           = 32
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 32768
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 01:07:54 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3527190) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3527190) WARNING 01-28 01:08:03 [backends.py:609] Failed to read file <frozen os>
Throughput: 35.58 requests/s, 36471.88 total tokens/s, 35.58 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096


─── STDERR ───
[2026-01-28 01:07:54] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 01:07:54] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 01:07:54] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 01:07:54] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:07:54] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:07:54] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:07:54] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:07:54] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:07:54] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 01:07:54] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 01:07:54] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 01:07:54] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 01:07:54] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 01:07:54] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 01:07:58] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 01:07:58] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 01:07:58] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 01:07:58] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:07:58] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:07:58] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:07:58] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:07:58] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 01:07:58] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 01:07:58] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 01:07:58] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 01:07:58] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 01:07:58] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 01:07:58] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3527190) [2026-01-28 01:07:58] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3527190) [2026-01-28 01:07:58] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3527190) [2026-01-28 01:07:58] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3527190) [2026-01-28 01:07:58] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=3527190) [2026-01-28 01:07:58] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3527190) [2026-01-28 01:07:58] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3527190) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3527190) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.48it/s]
(EngineCore_DP0 pid=3527190) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.48it/s]
(EngineCore_DP0 pid=3527190) 
(EngineCore_DP0 pid=3527190) [2026-01-28 01:07:59] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 4096] -> 1D uint8
(EngineCore_DP0 pid=3527190) [2026-01-28 01:07:59] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 9830400 bytes
(EngineCore_DP0 pid=3527190) [2026-01-28 01:07:59] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 4096] -> 1D uint8
(EngineCore_DP0 pid=3527190) [2026-01-28 01:07:59] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 6553600 bytes
(EngineCore_DP0 pid=3527190) [2026-01-28 01:07:59] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 4096] -> 1D uint8
(EngineCore_DP0 pid=3527190) [2026-01-28 01:07:59] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 35389440 bytes
(EngineCore_DP0 pid=3527190) [2026-01-28 01:07:59] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 11072] -> 1D uint8
(EngineCore_DP0 pid=3527190) [2026-01-28 01:07:59] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 17735680 bytes
(EngineCore_DP0 pid=3527190) [rank0]:W0128 01:08:06.691000 3527190 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=3527190) [rank0]:W0128 01:08:06.742000 3527190 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=3527190) [rank0]:W0128 01:08:07.410000 3527190 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=3527190) [rank0]:W0128 01:08:07.487000 3527190 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=3527190) 2026-01-28 01:08:09,944 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3527190) 2026-01-28 01:08:09,961 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3527190) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   9%|▉         | 1/11 [00:00<00:06,  1.55it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  36%|███▋      | 4/11 [00:00<00:01,  6.43it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  64%|██████▎   | 7/11 [00:00<00:00, 10.64it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  91%|█████████ | 10/11 [00:01<00:00, 14.38it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00, 10.39it/s]
(EngineCore_DP0 pid=3527190) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  14%|█▍        | 1/7 [00:00<00:00,  7.27it/s]
Capturing CUDA graphs (decode, FULL):  57%|█████▋    | 4/7 [00:00<00:00, 17.91it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00, 22.50it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00, 19.90it/s]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 70/4096 [00:00<00:05, 698.81it/s]
Adding requests:   4%|▎         | 146/4096 [00:00<00:05, 729.64it/s]
Adding requests:   5%|▌         | 222/4096 [00:00<00:05, 741.69it/s]
Adding requests:   7%|▋         | 299/4096 [00:00<00:05, 751.40it/s]
Adding requests:   9%|▉         | 375/4096 [00:00<00:05, 743.09it/s]
Adding requests:  11%|█         | 450/4096 [00:00<00:04, 742.86it/s]
Adding requests:  13%|█▎        | 525/4096 [00:00<00:04, 736.15it/s]
Adding requests:  15%|█▍        | 601/4096 [00:00<00:04, 743.29it/s]
Adding requests:  17%|█▋        | 679/4096 [00:00<00:04, 753.57it/s]
Adding requests:  18%|█▊        | 755/4096 [00:01<00:04, 755.28it/s]
Adding requests:  20%|██        | 831/4096 [00:01<00:04, 738.31it/s]
Adding requests:  22%|██▏       | 909/4096 [00:01<00:04, 750.42it/s]
Adding requests:  24%|██▍       | 987/4096 [00:01<00:04, 756.65it/s]
Adding requests:  26%|██▌       | 1066/4096 [00:01<00:03, 764.11it/s]
Adding requests:  28%|██▊       | 1143/4096 [00:01<00:03, 742.90it/s]
Adding requests:  30%|██▉       | 1223/4096 [00:01<00:03, 758.03it/s]
Adding requests:  32%|███▏      | 1299/4096 [00:01<00:03, 755.91it/s]
Adding requests:  34%|███▎      | 1378/4096 [00:01<00:03, 765.12it/s]
Adding requests:  36%|███▌      | 1455/4096 [00:01<00:03, 766.18it/s]
Adding requests:  37%|███▋      | 1532/4096 [00:02<00:03, 767.24it/s]
Adding requests:  39%|███▉      | 1611/4096 [00:02<00:03, 770.08it/s]
Adding requests:  41%|████      | 1689/4096 [00:02<00:03, 763.34it/s]
Adding requests:  43%|████▎     | 1766/4096 [00:02<00:03, 762.37it/s]
Adding requests:  45%|████▍     | 1843/4096 [00:02<00:02, 753.65it/s]
Adding requests:  47%|████▋     | 1919/4096 [00:02<00:02, 736.17it/s]
Adding requests:  49%|████▊     | 1993/4096 [00:02<00:02, 727.79it/s]
Adding requests:  50%|█████     | 2066/4096 [00:02<00:02, 728.03it/s]
Adding requests:  52%|█████▏    | 2139/4096 [00:02<00:02, 718.40it/s]
Adding requests:  54%|█████▍    | 2211/4096 [00:02<00:02, 711.00it/s]
Adding requests:  56%|█████▌    | 2283/4096 [00:03<00:02, 692.96it/s]
Adding requests:  57%|█████▋    | 2353/4096 [00:03<00:02, 685.68it/s]
Adding requests:  59%|█████▉    | 2428/4096 [00:03<00:02, 703.40it/s]
Adding requests:  61%|██████    | 2503/4096 [00:03<00:02, 715.90it/s]
Adding requests:  63%|██████▎   | 2580/4096 [00:03<00:02, 730.84it/s]
Adding requests:  65%|██████▍   | 2658/4096 [00:03<00:01, 742.91it/s]
Adding requests:  67%|██████▋   | 2733/4096 [00:03<00:01, 742.77it/s]
Adding requests:  69%|██████▊   | 2808/4096 [00:03<00:01, 744.78it/s]
Adding requests:  70%|███████   | 2885/4096 [00:03<00:01, 751.04it/s]
Adding requests:  72%|███████▏  | 2961/4096 [00:03<00:01, 747.85it/s]
Adding requests:  74%|███████▍  | 3037/4096 [00:04<00:01, 749.72it/s]
Adding requests:  76%|███████▌  | 3114/4096 [00:04<00:01, 755.34it/s]
Adding requests:  78%|███████▊  | 3191/4096 [00:04<00:01, 757.62it/s]
Adding requests:  80%|███████▉  | 3268/4096 [00:04<00:01, 760.26it/s]
Adding requests:  82%|████████▏ | 3345/4096 [00:04<00:00, 762.63it/s]
Adding requests:  84%|████████▎ | 3422/4096 [00:04<00:00, 764.13it/s]
Adding requests:  85%|████████▌ | 3499/4096 [00:04<00:00, 748.78it/s]
Adding requests:  87%|████████▋ | 3576/4096 [00:04<00:00, 754.42it/s]
Adding requests:  89%|████████▉ | 3653/4096 [00:04<00:00, 755.44it/s]
Adding requests:  91%|█████████ | 3729/4096 [00:05<00:00, 744.40it/s]
Adding requests:  93%|█████████▎| 3808/4096 [00:05<00:00, 755.89it/s]
Adding requests:  95%|█████████▍| 3886/4096 [00:05<00:00, 762.08it/s]
Adding requests:  97%|█████████▋| 3963/4096 [00:05<00:00, 761.71it/s]
Adding requests:  99%|█████████▊| 4040/4096 [00:05<00:00, 755.93it/s]
Adding requests: 100%|██████████| 4096/4096 [00:05<00:00, 746.25it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   5%|▍         | 194/4096 [00:00<00:18, 215.04it/s, est. speed input: 220203.92 toks/s, output: 215.04 toks/s]
Processed prompts:   6%|▌         | 226/4096 [00:01<00:35, 109.79it/s, est. speed input: 128638.60 toks/s, output: 125.62 toks/s]
Processed prompts:   6%|▋         | 258/4096 [00:02<00:50, 75.98it/s, est. speed input: 97983.94 toks/s, output: 95.69 toks/s]   
Processed prompts:   7%|▋         | 290/4096 [00:03<01:03, 60.07it/s, est. speed input: 82630.60 toks/s, output: 80.69 toks/s]
Processed prompts:   8%|▊         | 322/4096 [00:04<01:13, 51.27it/s, est. speed input: 73414.02 toks/s, output: 71.69 toks/s]
Processed prompts:   9%|▊         | 354/4096 [00:05<01:21, 45.95it/s, est. speed input: 67261.92 toks/s, output: 65.69 toks/s]
Processed prompts:   9%|▉         | 386/4096 [00:06<01:27, 42.58it/s, est. speed input: 62868.48 toks/s, output: 61.39 toks/s]
Processed prompts:  10%|█         | 418/4096 [00:07<01:31, 40.37it/s, est. speed input: 59574.95 toks/s, output: 58.18 toks/s]
Processed prompts:  11%|█         | 450/4096 [00:08<01:33, 38.89it/s, est. speed input: 57010.45 toks/s, output: 55.67 toks/s]
Processed prompts:  12%|█▏        | 482/4096 [00:08<01:35, 37.88it/s, est. speed input: 54954.08 toks/s, output: 53.67 toks/s]
Processed prompts:  13%|█▎        | 514/4096 [00:09<01:36, 37.19it/s, est. speed input: 53275.10 toks/s, output: 52.03 toks/s]
Processed prompts:  13%|█▎        | 546/4096 [00:10<01:36, 36.72it/s, est. speed input: 51876.22 toks/s, output: 50.66 toks/s]
Processed prompts:  14%|█▍        | 578/4096 [00:11<01:36, 36.39it/s, est. speed input: 50692.03 toks/s, output: 49.50 toks/s]
Processed prompts:  15%|█▍        | 610/4096 [00:12<01:36, 36.15it/s, est. speed input: 49675.27 toks/s, output: 48.51 toks/s]
Processed prompts:  16%|█▌        | 642/4096 [00:13<01:35, 36.00it/s, est. speed input: 48796.64 toks/s, output: 47.65 toks/s]
Processed prompts:  16%|█▋        | 674/4096 [00:14<01:35, 35.89it/s, est. speed input: 48027.23 toks/s, output: 46.90 toks/s]
Processed prompts:  17%|█▋        | 706/4096 [00:15<01:34, 35.81it/s, est. speed input: 47347.41 toks/s, output: 46.24 toks/s]
Processed prompts:  18%|█▊        | 738/4096 [00:16<01:33, 35.75it/s, est. speed input: 46743.24 toks/s, output: 45.65 toks/s]
Processed prompts:  19%|█▉        | 770/4096 [00:17<01:33, 35.71it/s, est. speed input: 46203.03 toks/s, output: 45.12 toks/s]
Processed prompts:  20%|█▉        | 802/4096 [00:17<01:32, 35.69it/s, est. speed input: 45716.73 toks/s, output: 44.65 toks/s]
Processed prompts:  20%|██        | 834/4096 [00:18<01:31, 35.67it/s, est. speed input: 45276.55 toks/s, output: 44.22 toks/s]
Processed prompts:  21%|██        | 866/4096 [00:19<01:30, 35.65it/s, est. speed input: 44876.17 toks/s, output: 43.82 toks/s]
Processed prompts:  22%|██▏       | 898/4096 [00:20<01:29, 35.64it/s, est. speed input: 44511.10 toks/s, output: 43.47 toks/s]
Processed prompts:  23%|██▎       | 930/4096 [00:21<01:28, 35.64it/s, est. speed input: 44176.04 toks/s, output: 43.14 toks/s]
Processed prompts:  23%|██▎       | 962/4096 [00:22<01:27, 35.63it/s, est. speed input: 43868.32 toks/s, output: 42.84 toks/s]
Processed prompts:  24%|██▍       | 994/4096 [00:23<01:27, 35.63it/s, est. speed input: 43583.48 toks/s, output: 42.56 toks/s]
Processed prompts:  25%|██▌       | 1026/4096 [00:24<01:26, 35.62it/s, est. speed input: 43320.11 toks/s, output: 42.30 toks/s]
Processed prompts:  26%|██▌       | 1058/4096 [00:25<01:25, 35.62it/s, est. speed input: 43075.08 toks/s, output: 42.07 toks/s]
Processed prompts:  27%|██▋       | 1090/4096 [00:26<01:24, 35.59it/s, est. speed input: 42843.69 toks/s, output: 41.84 toks/s]
Processed prompts:  27%|██▋       | 1122/4096 [00:26<01:23, 35.60it/s, est. speed input: 42631.34 toks/s, output: 41.63 toks/s]
Processed prompts:  28%|██▊       | 1154/4096 [00:27<01:22, 35.84it/s, est. speed input: 42462.38 toks/s, output: 41.47 toks/s]
Processed prompts:  29%|██▉       | 1186/4096 [00:28<01:21, 35.77it/s, est. speed input: 42274.95 toks/s, output: 41.28 toks/s]
Processed prompts:  30%|██▉       | 1218/4096 [00:29<01:20, 35.73it/s, est. speed input: 42099.17 toks/s, output: 41.11 toks/s]
Processed prompts:  31%|███       | 1250/4096 [00:30<01:19, 35.69it/s, est. speed input: 41933.37 toks/s, output: 40.95 toks/s]
Processed prompts:  31%|███▏      | 1282/4096 [00:31<01:18, 35.67it/s, est. speed input: 41776.92 toks/s, output: 40.80 toks/s]
Processed prompts:  32%|███▏      | 1314/4096 [00:32<01:18, 35.65it/s, est. speed input: 41629.14 toks/s, output: 40.65 toks/s]
Processed prompts:  33%|███▎      | 1346/4096 [00:33<01:17, 35.64it/s, est. speed input: 41489.95 toks/s, output: 40.52 toks/s]
Processed prompts:  34%|███▎      | 1378/4096 [00:34<01:16, 35.63it/s, est. speed input: 41357.20 toks/s, output: 40.39 toks/s]
Processed prompts:  34%|███▍      | 1410/4096 [00:35<01:15, 35.63it/s, est. speed input: 41232.39 toks/s, output: 40.27 toks/s]
Processed prompts:  35%|███▌      | 1442/4096 [00:35<01:14, 35.62it/s, est. speed input: 41112.23 toks/s, output: 40.15 toks/s]
Processed prompts:  36%|███▌      | 1474/4096 [00:36<01:13, 35.61it/s, est. speed input: 40998.66 toks/s, output: 40.04 toks/s]
Processed prompts:  37%|███▋      | 1506/4096 [00:37<01:12, 35.61it/s, est. speed input: 40890.20 toks/s, output: 39.93 toks/s]
Processed prompts:  38%|███▊      | 1538/4096 [00:38<01:11, 35.61it/s, est. speed input: 40787.14 toks/s, output: 39.83 toks/s]
Processed prompts:  38%|███▊      | 1570/4096 [00:39<01:10, 35.62it/s, est. speed input: 40689.69 toks/s, output: 39.74 toks/s]
Processed prompts:  39%|███▉      | 1602/4096 [00:40<01:10, 35.60it/s, est. speed input: 40594.72 toks/s, output: 39.64 toks/s]
Processed prompts:  40%|███▉      | 1634/4096 [00:41<01:09, 35.60it/s, est. speed input: 40504.79 toks/s, output: 39.56 toks/s]
Processed prompts:  41%|████      | 1666/4096 [00:42<01:08, 35.61it/s, est. speed input: 40418.78 toks/s, output: 39.47 toks/s]
Processed prompts:  41%|████▏     | 1698/4096 [00:43<01:07, 35.60it/s, est. speed input: 40335.89 toks/s, output: 39.39 toks/s]
Processed prompts:  42%|████▏     | 1730/4096 [00:44<01:06, 35.60it/s, est. speed input: 40256.77 toks/s, output: 39.31 toks/s]
Processed prompts:  43%|████▎     | 1762/4096 [00:44<01:05, 35.59it/s, est. speed input: 40179.81 toks/s, output: 39.24 toks/s]
Processed prompts:  44%|████▍     | 1794/4096 [00:45<01:04, 35.59it/s, est. speed input: 40106.17 toks/s, output: 39.17 toks/s]
Processed prompts:  45%|████▍     | 1826/4096 [00:46<01:03, 35.59it/s, est. speed input: 40035.94 toks/s, output: 39.10 toks/s]
Processed prompts:  45%|████▌     | 1858/4096 [00:47<01:02, 35.87it/s, est. speed input: 39987.93 toks/s, output: 39.05 toks/s]
Processed prompts:  46%|████▌     | 1890/4096 [00:48<01:01, 35.79it/s, est. speed input: 39922.58 toks/s, output: 38.99 toks/s]
Processed prompts:  47%|████▋     | 1922/4096 [00:49<01:00, 35.73it/s, est. speed input: 39859.15 toks/s, output: 38.92 toks/s]
Processed prompts:  48%|████▊     | 1954/4096 [00:50<01:00, 35.69it/s, est. speed input: 39797.88 toks/s, output: 38.87 toks/s]
Processed prompts:  48%|████▊     | 1986/4096 [00:51<00:59, 35.65it/s, est. speed input: 39738.74 toks/s, output: 38.81 toks/s]
Processed prompts:  49%|████▉     | 2018/4096 [00:52<00:58, 35.62it/s, est. speed input: 39681.08 toks/s, output: 38.75 toks/s]
Processed prompts:  50%|█████     | 2050/4096 [00:52<00:57, 35.60it/s, est. speed input: 39625.49 toks/s, output: 38.70 toks/s]
Processed prompts:  51%|█████     | 2082/4096 [00:53<00:56, 35.59it/s, est. speed input: 39571.95 toks/s, output: 38.64 toks/s]
Processed prompts:  52%|█████▏    | 2114/4096 [00:54<00:55, 35.58it/s, est. speed input: 39519.89 toks/s, output: 38.59 toks/s]
Processed prompts:  52%|█████▏    | 2146/4096 [00:55<00:54, 35.58it/s, est. speed input: 39469.79 toks/s, output: 38.54 toks/s]
Processed prompts:  53%|█████▎    | 2178/4096 [00:56<00:53, 35.58it/s, est. speed input: 39421.43 toks/s, output: 38.50 toks/s]
Processed prompts:  54%|█████▍    | 2210/4096 [00:57<00:53, 35.57it/s, est. speed input: 39374.21 toks/s, output: 38.45 toks/s]
Processed prompts:  55%|█████▍    | 2242/4096 [00:58<00:52, 35.56it/s, est. speed input: 39328.38 toks/s, output: 38.41 toks/s]
Processed prompts:  56%|█████▌    | 2274/4096 [00:59<00:51, 35.56it/s, est. speed input: 39283.88 toks/s, output: 38.36 toks/s]
Processed prompts:  56%|█████▋    | 2306/4096 [01:00<00:50, 35.56it/s, est. speed input: 39241.01 toks/s, output: 38.32 toks/s]
Processed prompts:  57%|█████▋    | 2338/4096 [01:01<00:49, 35.56it/s, est. speed input: 39199.22 toks/s, output: 38.28 toks/s]
Processed prompts:  58%|█████▊    | 2370/4096 [01:01<00:48, 35.55it/s, est. speed input: 39158.55 toks/s, output: 38.24 toks/s]
Processed prompts:  59%|█████▊    | 2402/4096 [01:02<00:47, 35.55it/s, est. speed input: 39118.88 toks/s, output: 38.20 toks/s]
Processed prompts:  59%|█████▉    | 2434/4096 [01:03<00:46, 35.54it/s, est. speed input: 39080.20 toks/s, output: 38.16 toks/s]
Processed prompts:  60%|██████    | 2466/4096 [01:04<00:45, 35.54it/s, est. speed input: 39042.93 toks/s, output: 38.13 toks/s]
Processed prompts:  61%|██████    | 2498/4096 [01:05<00:44, 35.85it/s, est. speed input: 39021.78 toks/s, output: 38.11 toks/s]
Processed prompts:  62%|██████▏   | 2530/4096 [01:06<00:43, 35.75it/s, est. speed input: 38985.69 toks/s, output: 38.07 toks/s]
Processed prompts:  63%|██████▎   | 2562/4096 [01:07<00:42, 35.69it/s, est. speed input: 38951.17 toks/s, output: 38.04 toks/s]
Processed prompts:  63%|██████▎   | 2594/4096 [01:08<00:42, 35.65it/s, est. speed input: 38917.72 toks/s, output: 38.01 toks/s]
Processed prompts:  64%|██████▍   | 2626/4096 [01:09<00:41, 35.62it/s, est. speed input: 38885.22 toks/s, output: 37.97 toks/s]
Processed prompts:  65%|██████▍   | 2658/4096 [01:10<00:40, 35.60it/s, est. speed input: 38853.47 toks/s, output: 37.94 toks/s]
Processed prompts:  66%|██████▌   | 2690/4096 [01:10<00:39, 35.59it/s, est. speed input: 38822.51 toks/s, output: 37.91 toks/s]
Processed prompts:  66%|██████▋   | 2722/4096 [01:11<00:38, 35.59it/s, est. speed input: 38792.54 toks/s, output: 37.88 toks/s]
Processed prompts:  67%|██████▋   | 2754/4096 [01:12<00:37, 35.57it/s, est. speed input: 38762.93 toks/s, output: 37.85 toks/s]
Processed prompts:  68%|██████▊   | 2786/4096 [01:13<00:36, 35.57it/s, est. speed input: 38734.11 toks/s, output: 37.83 toks/s]
Processed prompts:  69%|██████▉   | 2818/4096 [01:14<00:35, 35.56it/s, est. speed input: 38705.99 toks/s, output: 37.80 toks/s]
Processed prompts:  70%|██████▉   | 2850/4096 [01:15<00:35, 35.57it/s, est. speed input: 38679.07 toks/s, output: 37.77 toks/s]
Processed prompts:  70%|███████   | 2882/4096 [01:16<00:34, 35.56it/s, est. speed input: 38651.85 toks/s, output: 37.75 toks/s]
Processed prompts:  71%|███████   | 2914/4096 [01:17<00:33, 35.55it/s, est. speed input: 38625.52 toks/s, output: 37.72 toks/s]
Processed prompts:  72%|███████▏  | 2946/4096 [01:18<00:32, 35.55it/s, est. speed input: 38600.08 toks/s, output: 37.70 toks/s]
Processed prompts:  73%|███████▎  | 2978/4096 [01:19<00:31, 35.55it/s, est. speed input: 38575.09 toks/s, output: 37.67 toks/s]
Processed prompts:  73%|███████▎  | 3010/4096 [01:19<00:30, 35.55it/s, est. speed input: 38550.53 toks/s, output: 37.65 toks/s]
Processed prompts:  74%|███████▍  | 3042/4096 [01:20<00:29, 35.55it/s, est. speed input: 38526.48 toks/s, output: 37.62 toks/s]
Processed prompts:  75%|███████▌  | 3074/4096 [01:21<00:28, 35.54it/s, est. speed input: 38502.95 toks/s, output: 37.60 toks/s]
Processed prompts:  76%|███████▌  | 3106/4096 [01:22<00:27, 35.54it/s, est. speed input: 38480.02 toks/s, output: 37.58 toks/s]
Processed prompts:  77%|███████▋  | 3138/4096 [01:23<00:26, 35.53it/s, est. speed input: 38457.22 toks/s, output: 37.56 toks/s]
Processed prompts:  77%|███████▋  | 3170/4096 [01:24<00:26, 35.53it/s, est. speed input: 38435.13 toks/s, output: 37.53 toks/s]
Processed prompts:  78%|███████▊  | 3202/4096 [01:25<00:25, 35.53it/s, est. speed input: 38413.21 toks/s, output: 37.51 toks/s]
Processed prompts:  79%|███████▉  | 3234/4096 [01:26<00:24, 35.53it/s, est. speed input: 38392.02 toks/s, output: 37.49 toks/s]
Processed prompts:  80%|███████▉  | 3266/4096 [01:27<00:23, 35.53it/s, est. speed input: 38371.46 toks/s, output: 37.47 toks/s]
Processed prompts:  81%|████████  | 3298/4096 [01:28<00:22, 35.53it/s, est. speed input: 38350.87 toks/s, output: 37.45 toks/s]
Processed prompts:  81%|████████▏ | 3330/4096 [01:28<00:21, 35.53it/s, est. speed input: 38330.99 toks/s, output: 37.43 toks/s]
Processed prompts:  82%|████████▏ | 3362/4096 [01:29<00:20, 35.53it/s, est. speed input: 38311.64 toks/s, output: 37.41 toks/s]
Processed prompts:  83%|████████▎ | 3394/4096 [01:30<00:19, 35.53it/s, est. speed input: 38292.58 toks/s, output: 37.40 toks/s]
Processed prompts:  84%|████████▎ | 3426/4096 [01:31<00:18, 35.54it/s, est. speed input: 38274.03 toks/s, output: 37.38 toks/s]
Processed prompts:  84%|████████▍ | 3458/4096 [01:32<00:17, 35.54it/s, est. speed input: 38255.89 toks/s, output: 37.36 toks/s]
Processed prompts:  85%|████████▌ | 3490/4096 [01:33<00:17, 35.55it/s, est. speed input: 38238.07 toks/s, output: 37.34 toks/s]
Processed prompts:  86%|████████▌ | 3522/4096 [01:34<00:16, 35.55it/s, est. speed input: 38220.54 toks/s, output: 37.32 toks/s]
Processed prompts:  87%|████████▋ | 3554/4096 [01:35<00:15, 35.55it/s, est. speed input: 38203.42 toks/s, output: 37.31 toks/s]
Processed prompts:  88%|████████▊ | 3586/4096 [01:36<00:14, 35.55it/s, est. speed input: 38186.49 toks/s, output: 37.29 toks/s]
Processed prompts:  88%|████████▊ | 3618/4096 [01:37<00:13, 35.54it/s, est. speed input: 38169.63 toks/s, output: 37.28 toks/s]
Processed prompts:  89%|████████▉ | 3650/4096 [01:37<00:12, 35.54it/s, est. speed input: 38153.29 toks/s, output: 37.26 toks/s]
Processed prompts:  90%|████████▉ | 3682/4096 [01:38<00:11, 35.53it/s, est. speed input: 38137.02 toks/s, output: 37.24 toks/s]
Processed prompts:  91%|█████████ | 3714/4096 [01:39<00:10, 35.52it/s, est. speed input: 38120.81 toks/s, output: 37.23 toks/s]
Processed prompts:  91%|█████████▏| 3746/4096 [01:40<00:09, 35.51it/s, est. speed input: 38104.78 toks/s, output: 37.21 toks/s]
Processed prompts:  92%|█████████▏| 3778/4096 [01:41<00:08, 35.51it/s, est. speed input: 38089.32 toks/s, output: 37.20 toks/s]
Processed prompts:  93%|█████████▎| 3810/4096 [01:42<00:08, 35.51it/s, est. speed input: 38074.28 toks/s, output: 37.18 toks/s]
Processed prompts:  94%|█████████▍| 3842/4096 [01:43<00:07, 35.52it/s, est. speed input: 38059.54 toks/s, output: 37.17 toks/s]
Processed prompts:  95%|█████████▍| 3874/4096 [01:44<00:06, 35.52it/s, est. speed input: 38045.10 toks/s, output: 37.15 toks/s]
Processed prompts:  95%|█████████▌| 3906/4096 [01:45<00:05, 35.53it/s, est. speed input: 38030.92 toks/s, output: 37.14 toks/s]
Processed prompts:  96%|█████████▌| 3938/4096 [01:46<00:04, 35.53it/s, est. speed input: 38016.90 toks/s, output: 37.13 toks/s]
Processed prompts:  97%|█████████▋| 3970/4096 [01:46<00:03, 35.52it/s, est. speed input: 38003.04 toks/s, output: 37.11 toks/s]
Processed prompts:  98%|█████████▊| 4002/4096 [01:47<00:02, 35.53it/s, est. speed input: 37989.48 toks/s, output: 37.10 toks/s]
Processed prompts:  98%|█████████▊| 4034/4096 [01:48<00:01, 35.82it/s, est. speed input: 37984.79 toks/s, output: 37.09 toks/s]
Processed prompts:  99%|█████████▉| 4066/4096 [01:49<00:00, 36.06it/s, est. speed input: 37980.96 toks/s, output: 37.09 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [01:49<00:00, 36.06it/s, est. speed input: 38261.09 toks/s, output: 37.36 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [01:49<00:00, 37.36it/s, est. speed input: 38261.09 toks/s, output: 37.36 toks/s]
[rank0]:[W128 01:10:07.463533415 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 149.9s

测试结果:
  Requests/s:   35.58
  Tokens/s:     36471.88
  Total Reqs:   4096
  Elapsed:      115.11s

  [Prefill 分析]
  Total Prefill Tokens: 4194304
  Prefill Tokens/s:     36436.30


------------------------------------------------------------
  生成 CSV: BitNet-2B-FP8
------------------------------------------------------------
[SUCCESS] CSV 保存到: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX5080_cc120_FP8E4M3_py312_cu129_x86_64/cusparselt/2_10/BitNet-2B-FP8_prefill.csv

预览:
------------------------------------------------------------
M_prefill,prompt_len,max_num_seqs,num_prompts,N_prefill,requests_per_s,tokens_per_s,elapsed_time_s
512,512,1,128,128,55.2755,28356.3460,2.3157
1024,1024,1,128,128,33.6907,34532.9890,3.7993
2048,1024,2,256,128,37.2829,38214.9781,6.8664
4096,1024,4,512,128,37.8296,38775.3694,13.5344
8192,1024,8,1024,128,36.1570,37060.8782,28.3210
16384,1024,16,2048,128,35.6364,36527.3002,57.4693
32768,1024,32,4096,128,35.5823,36471.8819,115.1133

------------------------------------------------------------

[INFO] 完成: 7 成功, 0 失败


============================================================
  Benchmark 完成!
============================================================


总计: 35 成功, 0 失败
============================================================
