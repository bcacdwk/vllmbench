======================================================================
SlideSparse vLLM Throughput Benchmark Log
Created: 2026-01-28 00:07:59
======================================================================

原始命令:
  /root/vllmbench/slidesparse/tools/throughput_benchmark.py --model bitnet1.58-2b-int8 --backend cublaslt,cusparselt --stage prefill --sparsity 2_4,2_6,2_8,2_10 --M 512,1024,2048,4096,8192,16384,32768

命令行参数:
  --model: bitnet1.58-2b-int8
  --backend: cublaslt,cusparselt
  --sparsity: 2_4,2_6,2_8,2_10
  --stage: prefill
  --M: 512,1024,2048,4096,8192,16384,32768
  --N: None
  --inner-32: False
  --eager: False
  --gpu-id: 0
  --gpu-mem: 0.8
  --dry-run: False
  --list-models: False

硬件信息:
  GPU: RTX5080
  Compute Capability: cc120
  VRAM: 15.5 GB
  CUDA: 12.9
  Python: py312

Backend 环境变量 (初始状态):
  DISABLE_SLIDESPARSE: 未设置
  USE_CUBLASLT: 未设置
  USE_CUSPARSELT: 未设置
  SPARSITY: 未设置
  INNER_DTYPE_32: 未设置

======================================================================


============================================================
  BitNet-2B-INT8 | cuBLASLt | prefill
============================================================

[INFO] Checkpoint: /root/vllmbench/checkpoints/BitNet-2B-INT8
[INFO] Output: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX5080_cc120_INT8_py312_cu129_x86_64/cublaslt

============================================================
[1/7] 测试 M=512
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-INT8                                  │
│ Backend:  cuBLASLt [INT32 output]                         │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 512
│   M_prefill     = 512 (= 1 x 512)
│   M_decode      = 1
│   batched_tokens = 513 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 512
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 513
│   --max-num-batched-tokens = 513
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:08:03 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3456227) WARNING 01-28 00:08:13 [backends.py:609] Failed to read file <frozen os>
Throughput: 52.29 requests/s, 26822.78 total tokens/s, 52.29 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128


─── STDERR ───
[2026-01-28 00:08:03] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:08:03] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:08:03] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:08:03] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:08:03] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:08:03] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:08:03] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:08:03] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:08:03] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:08:03] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:08:03] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:08:03] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:08:03] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:08:03] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:08:07] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:08:07] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:08:07] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:08:07] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:08:07] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:08:07] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:08:07] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:08:07] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:08:07] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:08:07] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:08:07] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:08:07] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:08:07] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:08:07] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3456227) [2026-01-28 00:08:08] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=3456227) [2026-01-28 00:08:08] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3456227) [2026-01-28 00:08:08] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=3456227) [2026-01-28 00:08:08] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=3456227) [2026-01-28 00:08:08] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuBLASLt, symmetric=True
(EngineCore_DP0 pid=3456227) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3456227) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.31it/s]
(EngineCore_DP0 pid=3456227) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.31it/s]
(EngineCore_DP0 pid=3456227) 
[cuBLASLt] INFO: INT8 GEMM only supports INT32 output. inner_dtype parameter is ignored, always using int32.
(EngineCore_DP0 pid=3456227) 2026-01-28 00:08:21,583 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3456227) 2026-01-28 00:08:21,606 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3456227) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  3.27it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  3.45it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  3.42it/s]
(EngineCore_DP0 pid=3456227) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  6.59it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  6.59it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 1282.63it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:16,  7.53it/s, est. speed input: 3853.79 toks/s, output: 7.53 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:03, 33.72it/s, est. speed input: 15023.30 toks/s, output: 29.34 toks/s]
Processed prompts:  10%|█         | 13/128 [00:00<00:02, 43.39it/s, est. speed input: 19246.63 toks/s, output: 37.59 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:00<00:02, 48.11it/s, est. speed input: 21444.31 toks/s, output: 41.88 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:00<00:02, 50.76it/s, est. speed input: 22793.49 toks/s, output: 44.52 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:00<00:01, 52.86it/s, est. speed input: 23809.39 toks/s, output: 46.50 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:00<00:01, 54.17it/s, est. speed input: 24538.52 toks/s, output: 47.93 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:00<00:01, 55.63it/s, est. speed input: 25193.78 toks/s, output: 49.21 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:00<00:01, 55.99it/s, est. speed input: 25613.23 toks/s, output: 50.03 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:01<00:01, 56.09it/s, est. speed input: 25928.53 toks/s, output: 50.64 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:01<00:01, 56.56it/s, est. speed input: 26242.06 toks/s, output: 51.25 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:01<00:01, 56.97it/s, est. speed input: 26515.68 toks/s, output: 51.79 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:01<00:00, 57.32it/s, est. speed input: 26755.15 toks/s, output: 52.26 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:01<00:00, 57.39it/s, est. speed input: 26944.22 toks/s, output: 52.63 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:01<00:00, 57.12it/s, est. speed input: 27075.47 toks/s, output: 52.88 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:01<00:00, 57.19it/s, est. speed input: 27214.73 toks/s, output: 53.15 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:01<00:00, 57.69it/s, est. speed input: 27379.51 toks/s, output: 53.48 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:01<00:00, 58.02it/s, est. speed input: 27525.30 toks/s, output: 53.76 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:02<00:00, 57.84it/s, est. speed input: 27622.10 toks/s, output: 53.95 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:02<00:00, 57.84it/s, est. speed input: 27719.57 toks/s, output: 54.14 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:02<00:00, 57.80it/s, est. speed input: 27804.89 toks/s, output: 54.31 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:02<00:00, 58.05it/s, est. speed input: 27902.16 toks/s, output: 54.50 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:02<00:00, 58.05it/s, est. speed input: 27916.52 toks/s, output: 54.52 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:02<00:00, 54.52it/s, est. speed input: 27916.52 toks/s, output: 54.52 toks/s]
[rank0]:[W128 00:08:25.711834821 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 27.4s

测试结果:
  Requests/s:   52.29
  Tokens/s:     26822.78
  Total Reqs:   128
  Elapsed:      2.45s

  [Prefill 分析]
  Total Prefill Tokens: 65536
  Prefill Tokens/s:     26770.50

============================================================
[2/7] 测试 M=1024
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-INT8                                  │
│ Backend:  cuBLASLt [INT32 output]                         │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 1024
│   M_prefill     = 1024 (= 1 x 1024)
│   M_decode      = 1
│   batched_tokens = 1025 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 1025
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:08:31 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3457167) WARNING 01-28 00:08:39 [backends.py:609] Failed to read file <frozen os>
Throughput: 42.32 requests/s, 43379.66 total tokens/s, 42.32 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128


─── STDERR ───
[2026-01-28 00:08:31] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:08:31] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:08:31] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:08:31] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:08:31] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:08:31] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:08:31] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:08:31] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:08:31] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:08:31] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:08:31] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:08:31] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:08:31] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:08:31] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:08:34] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:08:34] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:08:34] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:08:34] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:08:34] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:08:34] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:08:34] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:08:34] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:08:34] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:08:34] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:08:34] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:08:34] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:08:34] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:08:34] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3457167) [2026-01-28 00:08:35] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=3457167) [2026-01-28 00:08:35] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3457167) [2026-01-28 00:08:35] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=3457167) [2026-01-28 00:08:35] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=3457167) [2026-01-28 00:08:35] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuBLASLt, symmetric=True
(EngineCore_DP0 pid=3457167) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3457167) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.88it/s]
(EngineCore_DP0 pid=3457167) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.87it/s]
(EngineCore_DP0 pid=3457167) 
[cuBLASLt] INFO: INT8 GEMM only supports INT32 output. inner_dtype parameter is ignored, always using int32.
(EngineCore_DP0 pid=3457167) 2026-01-28 00:08:46,422 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3457167) 2026-01-28 00:08:46,440 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3457167) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00, 23.01it/s]
(EngineCore_DP0 pid=3457167) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.19it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.19it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  51%|█████     | 65/128 [00:00<00:00, 641.74it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 689.07it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:00<00:01, 89.57it/s, est. speed input: 91727.33 toks/s, output: 89.57 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:00<00:01, 55.95it/s, est. speed input: 60904.65 toks/s, output: 59.48 toks/s]
Processed prompts:  20%|██        | 26/128 [00:00<00:02, 50.34it/s, est. speed input: 55377.27 toks/s, output: 54.08 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:00<00:02, 47.80it/s, est. speed input: 52868.42 toks/s, output: 51.63 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:00<00:01, 46.43it/s, est. speed input: 51508.26 toks/s, output: 50.30 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:00<00:01, 45.49it/s, est. speed input: 50529.71 toks/s, output: 49.34 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:00<00:01, 44.85it/s, est. speed input: 49795.20 toks/s, output: 48.63 toks/s]
Processed prompts:  41%|████      | 52/128 [00:01<00:01, 44.40it/s, est. speed input: 49216.86 toks/s, output: 48.06 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:01<00:01, 44.09it/s, est. speed input: 48753.97 toks/s, output: 47.61 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:01<00:01, 43.90it/s, est. speed input: 48380.85 toks/s, output: 47.25 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:01<00:01, 43.74it/s, est. speed input: 48060.63 toks/s, output: 46.93 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:01<00:01, 43.64it/s, est. speed input: 47790.40 toks/s, output: 46.67 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:01<00:01, 43.50it/s, est. speed input: 47541.35 toks/s, output: 46.43 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:01<00:01, 43.46it/s, est. speed input: 47335.71 toks/s, output: 46.23 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:01<00:00, 43.38it/s, est. speed input: 47146.32 toks/s, output: 46.04 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:02<00:00, 43.35it/s, est. speed input: 46982.42 toks/s, output: 45.88 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:02<00:00, 43.35it/s, est. speed input: 46841.62 toks/s, output: 45.74 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:02<00:00, 43.31it/s, est. speed input: 46708.97 toks/s, output: 45.61 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:02<00:00, 43.32it/s, est. speed input: 46593.92 toks/s, output: 45.50 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:02<00:00, 43.30it/s, est. speed input: 46486.75 toks/s, output: 45.40 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:02<00:00, 43.26it/s, est. speed input: 46383.82 toks/s, output: 45.30 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:02<00:00, 43.26it/s, est. speed input: 46294.02 toks/s, output: 45.21 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:02<00:00, 43.21it/s, est. speed input: 46204.86 toks/s, output: 45.12 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:02<00:00, 43.21it/s, est. speed input: 46192.91 toks/s, output: 45.11 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:02<00:00, 45.11it/s, est. speed input: 46192.91 toks/s, output: 45.11 toks/s]
[rank0]:[W128 00:08:50.589140216 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 25.0s

测试结果:
  Requests/s:   42.32
  Tokens/s:     43379.66
  Total Reqs:   128
  Elapsed:      3.02s

  [Prefill 分析]
  Total Prefill Tokens: 131072
  Prefill Tokens/s:     43337.34

============================================================
[3/7] 测试 M=2048
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-INT8                                  │
│ Backend:  cuBLASLt [INT32 output]                         │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 2048
│   M_prefill     = 2048 (= 2 x 1024)
│   M_decode      = 2
│   batched_tokens = 2048 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 256
│   --max-num-seqs           = 2
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 2048
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:08:56 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3457838) WARNING 01-28 00:09:05 [backends.py:609] Failed to read file <frozen os>
Throughput: 44.95 requests/s, 46077.79 total tokens/s, 44.95 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256


─── STDERR ───
[2026-01-28 00:08:56] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:08:56] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:08:56] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:08:56] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:08:56] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:08:56] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:08:56] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:08:56] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:08:56] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:08:56] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:08:56] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:08:56] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:08:56] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:08:56] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:09:00] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:09:00] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:09:00] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:09:00] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:09:00] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:09:00] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:09:00] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:09:00] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:09:00] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:09:00] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:09:00] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:09:00] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:09:00] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:09:00] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3457838) [2026-01-28 00:09:01] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=3457838) [2026-01-28 00:09:01] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3457838) [2026-01-28 00:09:01] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=3457838) [2026-01-28 00:09:01] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=3457838) [2026-01-28 00:09:01] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuBLASLt, symmetric=True
(EngineCore_DP0 pid=3457838) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3457838) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.91it/s]
(EngineCore_DP0 pid=3457838) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.91it/s]
(EngineCore_DP0 pid=3457838) 
[cuBLASLt] INFO: INT8 GEMM only supports INT32 output. inner_dtype parameter is ignored, always using int32.
(EngineCore_DP0 pid=3457838) 2026-01-28 00:09:12,272 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3457838) 2026-01-28 00:09:12,292 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3457838) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00, 21.28it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00, 21.26it/s]
(EngineCore_DP0 pid=3457838) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 1/2 [00:00<00:00,  7.21it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00, 11.38it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  26%|██▌       | 66/256 [00:00<00:00, 656.18it/s]
Adding requests:  55%|█████▌    | 141/256 [00:00<00:00, 704.46it/s]
Adding requests:  84%|████████▎ | 214/256 [00:00<00:00, 715.19it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 713.20it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   7%|▋         | 18/256 [00:00<00:01, 151.50it/s, est. speed input: 155144.76 toks/s, output: 151.50 toks/s]
Processed prompts:  13%|█▎        | 34/256 [00:00<00:03, 65.51it/s, est. speed input: 73731.00 toks/s, output: 72.00 toks/s]   
Processed prompts:  17%|█▋        | 43/256 [00:00<00:03, 60.36it/s, est. speed input: 68011.75 toks/s, output: 66.42 toks/s]
Processed prompts:  20%|█▉        | 51/256 [00:00<00:03, 55.28it/s, est. speed input: 63453.91 toks/s, output: 61.97 toks/s]
Processed prompts:  23%|██▎       | 58/256 [00:00<00:03, 50.16it/s, est. speed input: 59442.50 toks/s, output: 58.05 toks/s]
Processed prompts:  25%|██▌       | 64/256 [00:01<00:03, 48.97it/s, est. speed input: 57957.52 toks/s, output: 56.60 toks/s]
Processed prompts:  27%|██▋       | 70/256 [00:01<00:03, 48.05it/s, est. speed input: 56779.39 toks/s, output: 55.45 toks/s]
Processed prompts:  30%|██▉       | 76/256 [00:01<00:03, 47.33it/s, est. speed input: 55814.99 toks/s, output: 54.51 toks/s]
Processed prompts:  32%|███▏      | 82/256 [00:01<00:03, 46.75it/s, est. speed input: 54994.84 toks/s, output: 53.71 toks/s]
Processed prompts:  34%|███▍      | 88/256 [00:01<00:03, 46.37it/s, est. speed input: 54321.94 toks/s, output: 53.05 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:01<00:03, 46.10it/s, est. speed input: 53748.87 toks/s, output: 52.49 toks/s]
Processed prompts:  39%|███▉      | 100/256 [00:01<00:03, 45.92it/s, est. speed input: 53255.88 toks/s, output: 52.01 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:02<00:03, 45.84it/s, est. speed input: 52840.31 toks/s, output: 51.60 toks/s]
Processed prompts:  44%|████▍     | 112/256 [00:02<00:03, 45.70it/s, est. speed input: 52453.05 toks/s, output: 51.22 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:02<00:03, 45.64it/s, est. speed input: 52119.87 toks/s, output: 50.90 toks/s]
Processed prompts:  48%|████▊     | 124/256 [00:02<00:02, 45.52it/s, est. speed input: 51806.43 toks/s, output: 50.59 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:02<00:02, 45.54it/s, est. speed input: 51544.37 toks/s, output: 50.34 toks/s]
Processed prompts:  53%|█████▎    | 136/256 [00:02<00:02, 45.54it/s, est. speed input: 51307.17 toks/s, output: 50.10 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:02<00:02, 45.54it/s, est. speed input: 51090.71 toks/s, output: 49.89 toks/s]
Processed prompts:  58%|█████▊    | 148/256 [00:02<00:02, 45.47it/s, est. speed input: 50882.50 toks/s, output: 49.69 toks/s]
Processed prompts:  60%|██████    | 154/256 [00:03<00:02, 45.43it/s, est. speed input: 50693.12 toks/s, output: 49.50 toks/s]
Processed prompts:  62%|██████▎   | 160/256 [00:03<00:02, 45.44it/s, est. speed input: 50523.53 toks/s, output: 49.34 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:03<00:01, 45.49it/s, est. speed input: 50374.97 toks/s, output: 49.19 toks/s]
Processed prompts:  67%|██████▋   | 172/256 [00:03<00:01, 45.45it/s, est. speed input: 50227.34 toks/s, output: 49.05 toks/s]
Processed prompts:  70%|██████▉   | 178/256 [00:03<00:01, 45.47it/s, est. speed input: 50095.25 toks/s, output: 48.92 toks/s]
Processed prompts:  72%|███████▏  | 184/256 [00:03<00:01, 45.49it/s, est. speed input: 49974.44 toks/s, output: 48.80 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:03<00:01, 45.46it/s, est. speed input: 49856.49 toks/s, output: 48.69 toks/s]
Processed prompts:  77%|███████▋  | 196/256 [00:04<00:01, 45.45it/s, est. speed input: 49746.48 toks/s, output: 48.58 toks/s]
Processed prompts:  79%|███████▉  | 202/256 [00:04<00:01, 45.46it/s, est. speed input: 49646.56 toks/s, output: 48.48 toks/s]
Processed prompts:  81%|████████▏ | 208/256 [00:04<00:01, 45.43it/s, est. speed input: 49548.07 toks/s, output: 48.39 toks/s]
Processed prompts:  84%|████████▎ | 214/256 [00:04<00:00, 45.43it/s, est. speed input: 49458.23 toks/s, output: 48.30 toks/s]
Processed prompts:  86%|████████▌ | 220/256 [00:04<00:00, 45.35it/s, est. speed input: 49364.89 toks/s, output: 48.21 toks/s]
Processed prompts:  88%|████████▊ | 226/256 [00:04<00:00, 45.38it/s, est. speed input: 49285.29 toks/s, output: 48.13 toks/s]
Processed prompts:  91%|█████████ | 232/256 [00:04<00:00, 45.42it/s, est. speed input: 49212.29 toks/s, output: 48.06 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:04<00:00, 45.45it/s, est. speed input: 49143.08 toks/s, output: 47.99 toks/s]
Processed prompts:  95%|█████████▌| 244/256 [00:05<00:00, 45.48it/s, est. speed input: 49078.39 toks/s, output: 47.93 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:05<00:00, 45.47it/s, est. speed input: 49014.16 toks/s, output: 47.87 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:05<00:00, 47.76it/s, est. speed input: 49147.20 toks/s, output: 48.00 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:05<00:00, 47.76it/s, est. speed input: 49147.20 toks/s, output: 48.00 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:05<00:00, 47.99it/s, est. speed input: 49147.20 toks/s, output: 48.00 toks/s]
[rank0]:[W128 00:09:19.243638553 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 28.6s

测试结果:
  Requests/s:   44.95
  Tokens/s:     46077.79
  Total Reqs:   256
  Elapsed:      5.69s

  [Prefill 分析]
  Total Prefill Tokens: 262144
  Prefill Tokens/s:     46032.84

============================================================
[4/7] 测试 M=4096
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-INT8                                  │
│ Backend:  cuBLASLt [INT32 output]                         │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 4096
│   M_prefill     = 4096 (= 4 x 1024)
│   M_decode      = 4
│   batched_tokens = 4096 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 512
│   --max-num-seqs           = 4
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 4096
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:09:25 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3458709) WARNING 01-28 00:09:35 [backends.py:609] Failed to read file <frozen os>
Throughput: 43.79 requests/s, 44882.06 total tokens/s, 43.79 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512


─── STDERR ───
[2026-01-28 00:09:25] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:09:25] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:09:25] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:09:25] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:09:25] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:09:25] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:09:25] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:09:25] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:09:25] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:09:25] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:09:25] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:09:25] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:09:25] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:09:25] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:09:29] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:09:29] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:09:29] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:09:29] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:09:29] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:09:29] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:09:29] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:09:29] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:09:29] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:09:29] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:09:29] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:09:29] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:09:29] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:09:29] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3458709) [2026-01-28 00:09:30] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=3458709) [2026-01-28 00:09:30] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3458709) [2026-01-28 00:09:30] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=3458709) [2026-01-28 00:09:30] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=3458709) [2026-01-28 00:09:30] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuBLASLt, symmetric=True
(EngineCore_DP0 pid=3458709) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3458709) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.95it/s]
(EngineCore_DP0 pid=3458709) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.95it/s]
(EngineCore_DP0 pid=3458709) 
[cuBLASLt] INFO: INT8 GEMM only supports INT32 output. inner_dtype parameter is ignored, always using int32.
(EngineCore_DP0 pid=3458709) 2026-01-28 00:09:41,726 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3458709) 2026-01-28 00:09:41,743 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3458709) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 2/4 [00:00<00:00, 17.15it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00, 16.42it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00, 16.52it/s]
(EngineCore_DP0 pid=3458709) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  33%|███▎      | 1/3 [00:00<00:00,  6.13it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00, 11.46it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:  13%|█▎        | 68/512 [00:00<00:00, 670.97it/s]
Adding requests:  28%|██▊       | 144/512 [00:00<00:00, 717.25it/s]
Adding requests:  43%|████▎     | 218/512 [00:00<00:00, 726.96it/s]
Adding requests:  58%|█████▊    | 295/512 [00:00<00:00, 740.90it/s]
Adding requests:  72%|███████▏  | 371/512 [00:00<00:00, 744.44it/s]
Adding requests:  87%|████████▋ | 447/512 [00:00<00:00, 746.51it/s]
Adding requests: 100%|██████████| 512/512 [00:00<00:00, 737.26it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▌         | 30/512 [00:00<00:01, 259.40it/s, est. speed input: 265658.22 toks/s, output: 259.41 toks/s]
Processed prompts:  11%|█         | 56/512 [00:00<00:06, 75.12it/s, est. speed input: 86835.34 toks/s, output: 84.80 toks/s]   
Processed prompts:  14%|█▎        | 70/512 [00:01<00:07, 58.52it/s, est. speed input: 70015.30 toks/s, output: 68.37 toks/s]
Processed prompts:  16%|█▌        | 80/512 [00:01<00:07, 57.64it/s, est. speed input: 67937.29 toks/s, output: 66.34 toks/s]
Processed prompts:  17%|█▋        | 88/512 [00:01<00:07, 54.16it/s, est. speed input: 64971.19 toks/s, output: 63.45 toks/s]
Processed prompts:  19%|█▊        | 95/512 [00:01<00:08, 49.91it/s, est. speed input: 61999.78 toks/s, output: 60.55 toks/s]
Processed prompts:  20%|█▉        | 102/512 [00:01<00:08, 46.75it/s, est. speed input: 59666.41 toks/s, output: 58.27 toks/s]
Processed prompts:  21%|██▏       | 110/512 [00:01<00:08, 46.02it/s, est. speed input: 58312.51 toks/s, output: 56.95 toks/s]
Processed prompts:  23%|██▎       | 118/512 [00:02<00:08, 45.43it/s, est. speed input: 57171.89 toks/s, output: 55.83 toks/s]
Processed prompts:  25%|██▍       | 126/512 [00:02<00:08, 45.00it/s, est. speed input: 56206.89 toks/s, output: 54.89 toks/s]
Processed prompts:  26%|██▌       | 134/512 [00:02<00:08, 44.70it/s, est. speed input: 55386.38 toks/s, output: 54.09 toks/s]
Processed prompts:  28%|██▊       | 142/512 [00:02<00:08, 44.52it/s, est. speed input: 54688.64 toks/s, output: 53.41 toks/s]
Processed prompts:  29%|██▉       | 150/512 [00:02<00:08, 44.41it/s, est. speed input: 54082.83 toks/s, output: 52.81 toks/s]
Processed prompts:  31%|███       | 158/512 [00:03<00:07, 44.27it/s, est. speed input: 53536.42 toks/s, output: 52.28 toks/s]
Processed prompts:  32%|███▏      | 166/512 [00:03<00:07, 44.20it/s, est. speed input: 53057.69 toks/s, output: 51.81 toks/s]
Processed prompts:  34%|███▍      | 174/512 [00:03<00:07, 44.16it/s, est. speed input: 52631.04 toks/s, output: 51.40 toks/s]
Processed prompts:  36%|███▌      | 182/512 [00:03<00:07, 44.11it/s, est. speed input: 52244.08 toks/s, output: 51.02 toks/s]
Processed prompts:  37%|███▋      | 190/512 [00:03<00:07, 44.13it/s, est. speed input: 51905.39 toks/s, output: 50.69 toks/s]
Processed prompts:  39%|███▊      | 198/512 [00:03<00:07, 44.14it/s, est. speed input: 51597.94 toks/s, output: 50.39 toks/s]
Processed prompts:  40%|████      | 206/512 [00:04<00:06, 44.08it/s, est. speed input: 51306.07 toks/s, output: 50.10 toks/s]
Processed prompts:  42%|████▏     | 214/512 [00:04<00:06, 44.05it/s, est. speed input: 51040.03 toks/s, output: 49.84 toks/s]
Processed prompts:  43%|████▎     | 222/512 [00:04<00:06, 44.00it/s, est. speed input: 50791.50 toks/s, output: 49.60 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:04<00:06, 43.98it/s, est. speed input: 50564.97 toks/s, output: 49.38 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:04<00:06, 44.00it/s, est. speed input: 50359.14 toks/s, output: 49.18 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:05<00:06, 44.01it/s, est. speed input: 50168.86 toks/s, output: 48.99 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:05<00:05, 43.99it/s, est. speed input: 49988.53 toks/s, output: 48.82 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:05<00:05, 44.03it/s, est. speed input: 49826.47 toks/s, output: 48.66 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:05<00:05, 44.00it/s, est. speed input: 49667.60 toks/s, output: 48.50 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:05<00:05, 44.04it/s, est. speed input: 49526.94 toks/s, output: 48.37 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:05<00:05, 44.07it/s, est. speed input: 49394.46 toks/s, output: 48.24 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:06<00:04, 44.09it/s, est. speed input: 49269.45 toks/s, output: 48.11 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:06<00:04, 44.05it/s, est. speed input: 49147.09 toks/s, output: 48.00 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:06<00:04, 44.01it/s, est. speed input: 49029.01 toks/s, output: 47.88 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:06<00:04, 43.98it/s, est. speed input: 48918.41 toks/s, output: 47.77 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:06<00:04, 44.00it/s, est. speed input: 48816.83 toks/s, output: 47.67 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:07<00:04, 44.02it/s, est. speed input: 48720.93 toks/s, output: 47.58 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:07<00:03, 44.00it/s, est. speed input: 48626.93 toks/s, output: 47.49 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:07<00:03, 44.01it/s, est. speed input: 48540.18 toks/s, output: 47.40 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:07<00:03, 43.98it/s, est. speed input: 48453.87 toks/s, output: 47.32 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:07<00:03, 43.97it/s, est. speed input: 48373.19 toks/s, output: 47.24 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [00:07<00:03, 44.01it/s, est. speed input: 48299.51 toks/s, output: 47.17 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [00:08<00:02, 44.03it/s, est. speed input: 48228.30 toks/s, output: 47.10 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [00:08<00:02, 44.01it/s, est. speed input: 48158.04 toks/s, output: 47.03 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [00:08<00:02, 43.98it/s, est. speed input: 48089.81 toks/s, output: 46.96 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [00:08<00:02, 44.00it/s, est. speed input: 48026.72 toks/s, output: 46.90 toks/s]
Processed prompts:  81%|████████  | 414/512 [00:08<00:02, 44.00it/s, est. speed input: 47965.89 toks/s, output: 46.84 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [00:09<00:02, 44.03it/s, est. speed input: 47909.38 toks/s, output: 46.79 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [00:09<00:01, 44.02it/s, est. speed input: 47853.04 toks/s, output: 46.73 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [00:09<00:01, 44.02it/s, est. speed input: 47798.89 toks/s, output: 46.68 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [00:09<00:01, 43.99it/s, est. speed input: 47745.01 toks/s, output: 46.63 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [00:09<00:01, 44.01it/s, est. speed input: 47696.26 toks/s, output: 46.58 toks/s]
Processed prompts:  90%|█████████ | 462/512 [00:09<00:01, 44.02it/s, est. speed input: 47648.48 toks/s, output: 46.53 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [00:10<00:00, 44.00it/s, est. speed input: 47601.39 toks/s, output: 46.49 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [00:10<00:00, 43.97it/s, est. speed input: 47554.53 toks/s, output: 46.44 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [00:10<00:00, 43.97it/s, est. speed input: 47510.70 toks/s, output: 46.40 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [00:10<00:00, 43.94it/s, est. speed input: 47466.30 toks/s, output: 46.35 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [00:10<00:00, 43.95it/s, est. speed input: 47425.62 toks/s, output: 46.31 toks/s]
Processed prompts: 100%|█████████▉| 510/512 [00:10<00:00, 45.82it/s, est. speed input: 47492.20 toks/s, output: 46.38 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:10<00:00, 45.82it/s, est. speed input: 47677.30 toks/s, output: 46.56 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:10<00:00, 46.56it/s, est. speed input: 47677.30 toks/s, output: 46.56 toks/s]
[rank0]:[W128 00:09:55.845952786 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 35.6s

测试结果:
  Requests/s:   43.79
  Tokens/s:     44882.06
  Total Reqs:   512
  Elapsed:      11.69s

  [Prefill 分析]
  Total Prefill Tokens: 524288
  Prefill Tokens/s:     44838.27

============================================================
[5/7] 测试 M=8192
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-INT8                                  │
│ Backend:  cuBLASLt [INT32 output]                         │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 8192
│   M_prefill     = 8192 (= 8 x 1024)
│   M_decode      = 8
│   batched_tokens = 8192 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 1024
│   --max-num-seqs           = 8
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 8192
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:10:02 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3459635) WARNING 01-28 00:10:11 [backends.py:609] Failed to read file <frozen os>
Throughput: 42.46 requests/s, 43522.98 total tokens/s, 42.46 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024


─── STDERR ───
[2026-01-28 00:10:02] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:10:02] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:10:02] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:10:02] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:10:02] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:10:02] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:10:02] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:10:02] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:10:02] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:10:02] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:10:02] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:10:02] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:10:02] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:10:02] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:10:06] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:10:06] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:10:06] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:10:06] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:10:06] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:10:06] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:10:06] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:10:06] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:10:06] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:10:06] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:10:06] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:10:06] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:10:06] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:10:06] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3459635) [2026-01-28 00:10:07] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=3459635) [2026-01-28 00:10:07] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3459635) [2026-01-28 00:10:07] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=3459635) [2026-01-28 00:10:07] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=3459635) [2026-01-28 00:10:07] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuBLASLt, symmetric=True
(EngineCore_DP0 pid=3459635) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3459635) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.02it/s]
(EngineCore_DP0 pid=3459635) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.02it/s]
(EngineCore_DP0 pid=3459635) 
[cuBLASLt] INFO: INT8 GEMM only supports INT32 output. inner_dtype parameter is ignored, always using int32.
(EngineCore_DP0 pid=3459635) 2026-01-28 00:10:18,699 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3459635) 2026-01-28 00:10:18,716 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3459635) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:00,  4.87it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  80%|████████  | 4/5 [00:00<00:00, 14.19it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00, 13.31it/s]
(EngineCore_DP0 pid=3459635) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:00,  7.14it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00, 17.47it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00, 15.76it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   7%|▋         | 72/1024 [00:00<00:01, 712.35it/s]
Adding requests:  15%|█▍        | 149/1024 [00:00<00:01, 745.55it/s]
Adding requests:  22%|██▏       | 226/1024 [00:00<00:01, 752.00it/s]
Adding requests:  29%|██▉       | 302/1024 [00:00<00:00, 741.42it/s]
Adding requests:  37%|███▋      | 377/1024 [00:00<00:00, 743.03it/s]
Adding requests:  44%|████▍     | 452/1024 [00:00<00:00, 743.45it/s]
Adding requests:  51%|█████▏    | 527/1024 [00:00<00:00, 733.57it/s]
Adding requests:  59%|█████▊    | 601/1024 [00:00<00:00, 730.71it/s]
Adding requests:  66%|██████▋   | 679/1024 [00:00<00:00, 744.67it/s]
Adding requests:  74%|███████▍  | 757/1024 [00:01<00:00, 753.38it/s]
Adding requests:  81%|████████▏ | 833/1024 [00:01<00:00, 733.77it/s]
Adding requests:  89%|████████▉ | 911/1024 [00:01<00:00, 747.37it/s]
Adding requests:  97%|█████████▋| 989/1024 [00:01<00:00, 755.97it/s]
Adding requests: 100%|██████████| 1024/1024 [00:01<00:00, 746.28it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▌         | 58/1024 [00:00<00:03, 274.82it/s, est. speed input: 281436.42 toks/s, output: 274.83 toks/s]
Processed prompts:   8%|▊         | 86/1024 [00:00<00:09, 96.59it/s, est. speed input: 113851.33 toks/s, output: 111.18 toks/s] 
Processed prompts:  10%|▉         | 101/1024 [00:01<00:12, 72.26it/s, est. speed input: 90055.67 toks/s, output: 87.94 toks/s] 
Processed prompts:  11%|█         | 111/1024 [00:01<00:13, 67.78it/s, est. speed input: 85056.87 toks/s, output: 83.06 toks/s]
Processed prompts:  12%|█▏        | 119/1024 [00:01<00:14, 61.48it/s, est. speed input: 79974.16 toks/s, output: 78.10 toks/s]
Processed prompts:  12%|█▏        | 126/1024 [00:01<00:16, 55.07it/s, est. speed input: 75382.57 toks/s, output: 73.62 toks/s]
Processed prompts:  13%|█▎        | 132/1024 [00:01<00:18, 48.66it/s, est. speed input: 71125.02 toks/s, output: 69.46 toks/s]
Processed prompts:  13%|█▎        | 138/1024 [00:02<00:20, 43.98it/s, est. speed input: 67680.97 toks/s, output: 66.09 toks/s]
Processed prompts:  14%|█▍        | 146/1024 [00:02<00:20, 43.59it/s, est. speed input: 65697.19 toks/s, output: 64.16 toks/s]
Processed prompts:  15%|█▌        | 154/1024 [00:02<00:20, 43.33it/s, est. speed input: 64025.81 toks/s, output: 62.52 toks/s]
Processed prompts:  16%|█▌        | 162/1024 [00:02<00:19, 43.12it/s, est. speed input: 62581.66 toks/s, output: 61.11 toks/s]
Processed prompts:  17%|█▋        | 170/1024 [00:02<00:19, 42.96it/s, est. speed input: 61326.19 toks/s, output: 59.89 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [00:03<00:19, 42.86it/s, est. speed input: 60229.49 toks/s, output: 58.82 toks/s]
Processed prompts:  18%|█▊        | 186/1024 [00:03<00:19, 42.79it/s, est. speed input: 59259.53 toks/s, output: 57.87 toks/s]
Processed prompts:  19%|█▉        | 194/1024 [00:03<00:19, 42.75it/s, est. speed input: 58401.77 toks/s, output: 57.03 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [00:03<00:19, 42.73it/s, est. speed input: 57633.17 toks/s, output: 56.28 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:03<00:19, 42.67it/s, est. speed input: 56933.31 toks/s, output: 55.60 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [00:03<00:18, 42.67it/s, est. speed input: 56307.22 toks/s, output: 54.99 toks/s]
Processed prompts:  22%|██▏       | 226/1024 [00:04<00:18, 42.67it/s, est. speed input: 55736.91 toks/s, output: 54.43 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:04<00:18, 42.67it/s, est. speed input: 55216.34 toks/s, output: 53.92 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:04<00:18, 42.64it/s, est. speed input: 54734.91 toks/s, output: 53.45 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:04<00:18, 42.63it/s, est. speed input: 54291.51 toks/s, output: 53.02 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:04<00:17, 42.62it/s, est. speed input: 53882.79 toks/s, output: 52.62 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:05<00:17, 42.61it/s, est. speed input: 53503.78 toks/s, output: 52.25 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:05<00:17, 42.63it/s, est. speed input: 53156.30 toks/s, output: 51.91 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:05<00:17, 42.62it/s, est. speed input: 52828.90 toks/s, output: 51.59 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:05<00:17, 42.63it/s, est. speed input: 52524.18 toks/s, output: 51.29 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:05<00:17, 42.60it/s, est. speed input: 52235.58 toks/s, output: 51.01 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:06<00:16, 42.58it/s, est. speed input: 51964.54 toks/s, output: 50.75 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:06<00:16, 42.59it/s, est. speed input: 51712.97 toks/s, output: 50.50 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:06<00:16, 42.60it/s, est. speed input: 51476.59 toks/s, output: 50.27 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:06<00:16, 42.59it/s, est. speed input: 51252.38 toks/s, output: 50.05 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:06<00:16, 42.57it/s, est. speed input: 51038.46 toks/s, output: 49.84 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:06<00:15, 42.58it/s, est. speed input: 50838.04 toks/s, output: 49.65 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:07<00:15, 42.58it/s, est. speed input: 50647.98 toks/s, output: 49.46 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:07<00:15, 42.57it/s, est. speed input: 50467.32 toks/s, output: 49.28 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:07<00:15, 42.56it/s, est. speed input: 50294.99 toks/s, output: 49.12 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:07<00:15, 42.54it/s, est. speed input: 50128.99 toks/s, output: 48.95 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:07<00:14, 42.55it/s, est. speed input: 49973.88 toks/s, output: 48.80 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [00:08<00:14, 42.56it/s, est. speed input: 49826.20 toks/s, output: 48.66 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:08<00:14, 42.58it/s, est. speed input: 49685.97 toks/s, output: 48.52 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:08<00:14, 42.58it/s, est. speed input: 49551.68 toks/s, output: 48.39 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:08<00:14, 42.57it/s, est. speed input: 49421.33 toks/s, output: 48.26 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:08<00:14, 42.56it/s, est. speed input: 49296.78 toks/s, output: 48.14 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:09<00:13, 42.56it/s, est. speed input: 49177.87 toks/s, output: 48.03 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:09<00:13, 42.56it/s, est. speed input: 49064.02 toks/s, output: 47.91 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:09<00:13, 42.58it/s, est. speed input: 48956.24 toks/s, output: 47.81 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:09<00:13, 42.58it/s, est. speed input: 48851.07 toks/s, output: 47.71 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:09<00:13, 42.58it/s, est. speed input: 48750.29 toks/s, output: 47.61 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:09<00:12, 42.58it/s, est. speed input: 48653.48 toks/s, output: 47.51 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:10<00:12, 42.59it/s, est. speed input: 48560.77 toks/s, output: 47.42 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:10<00:12, 42.60it/s, est. speed input: 48471.67 toks/s, output: 47.34 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:10<00:12, 42.61it/s, est. speed input: 48385.63 toks/s, output: 47.25 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:10<00:12, 42.58it/s, est. speed input: 48300.57 toks/s, output: 47.17 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:10<00:11, 42.59it/s, est. speed input: 48220.27 toks/s, output: 47.09 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:11<00:11, 42.58it/s, est. speed input: 48141.63 toks/s, output: 47.01 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:11<00:11, 42.58it/s, est. speed input: 48066.01 toks/s, output: 46.94 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:11<00:11, 42.57it/s, est. speed input: 47992.47 toks/s, output: 46.87 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:11<00:11, 42.57it/s, est. speed input: 47921.38 toks/s, output: 46.80 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:11<00:11, 42.55it/s, est. speed input: 47851.83 toks/s, output: 46.73 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:12<00:10, 42.56it/s, est. speed input: 47785.62 toks/s, output: 46.67 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:12<00:10, 42.58it/s, est. speed input: 47721.81 toks/s, output: 46.60 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:12<00:10, 42.57it/s, est. speed input: 47659.16 toks/s, output: 46.54 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:12<00:10, 42.58it/s, est. speed input: 47598.82 toks/s, output: 46.48 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:12<00:10, 42.55it/s, est. speed input: 47538.70 toks/s, output: 46.42 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:12<00:09, 42.55it/s, est. speed input: 47481.38 toks/s, output: 46.37 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:13<00:09, 42.54it/s, est. speed input: 47425.16 toks/s, output: 46.31 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:13<00:09, 42.56it/s, est. speed input: 47371.80 toks/s, output: 46.26 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:13<00:09, 42.56it/s, est. speed input: 47318.99 toks/s, output: 46.21 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:13<00:09, 42.55it/s, est. speed input: 47267.60 toks/s, output: 46.16 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:13<00:08, 42.54it/s, est. speed input: 47217.30 toks/s, output: 46.11 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:14<00:08, 42.57it/s, est. speed input: 47169.85 toks/s, output: 46.06 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:14<00:08, 42.58it/s, est. speed input: 47123.10 toks/s, output: 46.02 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:14<00:08, 42.57it/s, est. speed input: 47076.98 toks/s, output: 45.97 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:14<00:08, 42.54it/s, est. speed input: 47030.86 toks/s, output: 45.93 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:14<00:08, 42.53it/s, est. speed input: 46986.49 toks/s, output: 45.89 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:15<00:07, 42.52it/s, est. speed input: 46942.98 toks/s, output: 45.84 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:15<00:07, 42.53it/s, est. speed input: 46901.38 toks/s, output: 45.80 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:15<00:07, 42.53it/s, est. speed input: 46860.71 toks/s, output: 45.76 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:15<00:07, 42.54it/s, est. speed input: 46821.38 toks/s, output: 45.72 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:15<00:07, 42.51it/s, est. speed input: 46781.20 toks/s, output: 45.68 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:15<00:06, 42.53it/s, est. speed input: 46743.67 toks/s, output: 45.65 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:16<00:06, 42.57it/s, est. speed input: 46708.16 toks/s, output: 45.61 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:16<00:06, 42.58it/s, est. speed input: 46673.04 toks/s, output: 45.58 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:16<00:06, 42.58it/s, est. speed input: 46637.94 toks/s, output: 45.54 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:16<00:06, 42.55it/s, est. speed input: 46602.95 toks/s, output: 45.51 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:16<00:05, 42.55it/s, est. speed input: 46568.98 toks/s, output: 45.48 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:17<00:05, 42.52it/s, est. speed input: 46535.05 toks/s, output: 45.44 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:17<00:05, 42.53it/s, est. speed input: 46503.03 toks/s, output: 45.41 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:17<00:05, 42.49it/s, est. speed input: 46469.54 toks/s, output: 45.38 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:17<00:05, 42.51it/s, est. speed input: 46438.77 toks/s, output: 45.35 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:17<00:05, 42.52it/s, est. speed input: 46408.56 toks/s, output: 45.32 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:18<00:04, 42.50it/s, est. speed input: 46377.98 toks/s, output: 45.29 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:18<00:04, 42.53it/s, est. speed input: 46349.69 toks/s, output: 45.26 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:18<00:04, 42.54it/s, est. speed input: 46321.33 toks/s, output: 45.24 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [00:18<00:04, 42.55it/s, est. speed input: 46293.86 toks/s, output: 45.21 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [00:18<00:04, 42.52it/s, est. speed input: 46265.74 toks/s, output: 45.18 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:19<00:03, 42.52it/s, est. speed input: 46238.64 toks/s, output: 45.15 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [00:19<00:03, 42.51it/s, est. speed input: 46211.85 toks/s, output: 45.13 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [00:19<00:03, 42.52it/s, est. speed input: 46186.22 toks/s, output: 45.10 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [00:19<00:03, 42.53it/s, est. speed input: 46160.98 toks/s, output: 45.08 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [00:19<00:03, 42.50it/s, est. speed input: 46135.06 toks/s, output: 45.05 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [00:19<00:02, 42.49it/s, est. speed input: 46110.02 toks/s, output: 45.03 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [00:20<00:02, 42.49it/s, est. speed input: 46085.80 toks/s, output: 45.01 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [00:20<00:02, 42.49it/s, est. speed input: 46061.87 toks/s, output: 44.98 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [00:20<00:02, 42.48it/s, est. speed input: 46038.12 toks/s, output: 44.96 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [00:20<00:02, 42.46it/s, est. speed input: 46014.37 toks/s, output: 44.94 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [00:20<00:02, 42.46it/s, est. speed input: 45991.34 toks/s, output: 44.91 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [00:21<00:01, 42.46it/s, est. speed input: 45969.03 toks/s, output: 44.89 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [00:21<00:01, 42.45it/s, est. speed input: 45946.73 toks/s, output: 44.87 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [00:21<00:01, 42.48it/s, est. speed input: 45925.82 toks/s, output: 44.85 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [00:21<00:01, 42.48it/s, est. speed input: 45904.83 toks/s, output: 44.83 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [00:21<00:01, 42.46it/s, est. speed input: 45883.29 toks/s, output: 44.81 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [00:22<00:00, 42.47it/s, est. speed input: 45862.95 toks/s, output: 44.79 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [00:22<00:00, 42.46it/s, est. speed input: 45842.71 toks/s, output: 44.77 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [00:22<00:00, 42.48it/s, est. speed input: 45823.40 toks/s, output: 44.75 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [00:22<00:00, 42.49it/s, est. speed input: 45804.25 toks/s, output: 44.73 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [00:22<00:00, 44.26it/s, est. speed input: 45835.70 toks/s, output: 44.76 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:22<00:00, 44.26it/s, est. speed input: 46105.60 toks/s, output: 45.02 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:22<00:00, 45.02it/s, est. speed input: 46105.60 toks/s, output: 45.02 toks/s]
[rank0]:[W128 00:10:44.382514474 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 49.5s

测试结果:
  Requests/s:   42.46
  Tokens/s:     43522.98
  Total Reqs:   1024
  Elapsed:      24.12s

  [Prefill 分析]
  Total Prefill Tokens: 1048576
  Prefill Tokens/s:     43480.52

============================================================
[6/7] 测试 M=16384
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-INT8                                  │
│ Backend:  cuBLASLt [INT32 output]                         │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 16384
│   M_prefill     = 16384 (= 16 x 1024)
│   M_decode      = 16
│   batched_tokens = 16384 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 2048
│   --max-num-seqs           = 16
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 16384
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:10:55 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3460875) WARNING 01-28 00:11:04 [backends.py:609] Failed to read file <frozen os>
Throughput: 42.02 requests/s, 43069.22 total tokens/s, 42.02 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048


─── STDERR ───
[2026-01-28 00:10:55] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:10:55] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:10:55] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:10:55] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:10:55] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:10:55] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:10:55] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:10:55] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:10:55] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:10:55] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:10:55] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:10:55] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:10:55] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:10:55] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:10:59] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:10:59] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:10:59] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:10:59] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:10:59] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:10:59] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:10:59] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:10:59] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:10:59] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:10:59] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:10:59] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:10:59] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:10:59] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:10:59] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3460875) [2026-01-28 00:10:59] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=3460875) [2026-01-28 00:10:59] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3460875) [2026-01-28 00:10:59] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=3460875) [2026-01-28 00:10:59] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=3460875) [2026-01-28 00:10:59] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuBLASLt, symmetric=True
(EngineCore_DP0 pid=3460875) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3460875) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.94it/s]
(EngineCore_DP0 pid=3460875) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.94it/s]
(EngineCore_DP0 pid=3460875) 
[cuBLASLt] INFO: INT8 GEMM only supports INT32 output. inner_dtype parameter is ignored, always using int32.
(EngineCore_DP0 pid=3460875) 2026-01-28 00:11:11,053 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3460875) 2026-01-28 00:11:11,072 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3460875) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  14%|█▍        | 1/7 [00:00<00:00,  6.52it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  57%|█████▋    | 4/7 [00:00<00:00, 16.31it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00, 19.19it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00, 17.26it/s]
(EngineCore_DP0 pid=3460875) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  20%|██        | 1/5 [00:00<00:00,  6.70it/s]
Capturing CUDA graphs (decode, FULL):  80%|████████  | 4/5 [00:00<00:00, 17.06it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00, 16.75it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   4%|▎         | 72/2048 [00:00<00:02, 718.95it/s]
Adding requests:   7%|▋         | 148/2048 [00:00<00:02, 736.66it/s]
Adding requests:  11%|█         | 222/2048 [00:00<00:02, 737.89it/s]
Adding requests:  15%|█▍        | 299/2048 [00:00<00:02, 748.78it/s]
Adding requests:  18%|█▊        | 376/2048 [00:00<00:02, 753.35it/s]
Adding requests:  22%|██▏       | 453/2048 [00:00<00:02, 755.25it/s]
Adding requests:  26%|██▌       | 529/2048 [00:00<00:02, 746.65it/s]
Adding requests:  29%|██▉       | 604/2048 [00:00<00:01, 746.95it/s]
Adding requests:  33%|███▎      | 683/2048 [00:00<00:01, 758.69it/s]
Adding requests:  37%|███▋      | 759/2048 [00:01<00:01, 753.19it/s]
Adding requests:  41%|████      | 835/2048 [00:01<00:01, 739.22it/s]
Adding requests:  45%|████▍     | 914/2048 [00:01<00:01, 752.24it/s]
Adding requests:  48%|████▊     | 990/2048 [00:01<00:01, 753.50it/s]
Adding requests:  52%|█████▏    | 1068/2048 [00:01<00:01, 760.26it/s]
Adding requests:  56%|█████▌    | 1145/2048 [00:01<00:01, 757.09it/s]
Adding requests:  60%|█████▉    | 1225/2048 [00:01<00:01, 766.70it/s]
Adding requests:  64%|██████▎   | 1302/2048 [00:01<00:00, 761.06it/s]
Adding requests:  67%|██████▋   | 1380/2048 [00:01<00:00, 764.46it/s]
Adding requests:  71%|███████   | 1459/2048 [00:01<00:00, 771.90it/s]
Adding requests:  75%|███████▌  | 1537/2048 [00:02<00:00, 771.05it/s]
Adding requests:  79%|███████▉  | 1615/2048 [00:02<00:00, 771.76it/s]
Adding requests:  83%|████████▎ | 1693/2048 [00:02<00:00, 765.58it/s]
Adding requests:  86%|████████▋ | 1770/2048 [00:02<00:00, 760.59it/s]
Adding requests:  90%|█████████ | 1847/2048 [00:02<00:00, 759.81it/s]
Adding requests:  94%|█████████▍| 1923/2048 [00:02<00:00, 747.67it/s]
Adding requests:  98%|█████████▊| 1998/2048 [00:02<00:00, 747.49it/s]
Adding requests: 100%|██████████| 2048/2048 [00:02<00:00, 755.46it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▌         | 114/2048 [00:00<00:06, 286.13it/s, est. speed input: 293010.42 toks/s, output: 286.14 toks/s]
Processed prompts:   7%|▋         | 143/2048 [00:00<00:11, 165.33it/s, est. speed input: 188315.75 toks/s, output: 183.90 toks/s]
Processed prompts:   8%|▊         | 160/2048 [00:01<00:17, 110.91it/s, est. speed input: 141622.72 toks/s, output: 138.30 toks/s]
Processed prompts:   8%|▊         | 171/2048 [00:01<00:23, 78.77it/s, est. speed input: 113970.28 toks/s, output: 111.30 toks/s] 
Processed prompts:   9%|▊         | 179/2048 [00:01<00:32, 58.05it/s, est. speed input: 95665.10 toks/s, output: 93.42 toks/s]  
Processed prompts:   9%|▉         | 194/2048 [00:02<00:35, 51.78it/s, est. speed input: 86553.59 toks/s, output: 84.52 toks/s]
Processed prompts:  10%|█         | 210/2048 [00:02<00:37, 48.64it/s, est. speed input: 80396.33 toks/s, output: 78.51 toks/s]
Processed prompts:  11%|█         | 226/2048 [00:03<00:39, 46.57it/s, est. speed input: 75767.81 toks/s, output: 73.99 toks/s]
Processed prompts:  12%|█▏        | 242/2048 [00:03<00:39, 45.20it/s, est. speed input: 72167.15 toks/s, output: 70.48 toks/s]
Processed prompts:  13%|█▎        | 258/2048 [00:03<00:40, 44.26it/s, est. speed input: 69280.82 toks/s, output: 67.66 toks/s]
Processed prompts:  13%|█▎        | 274/2048 [00:04<00:40, 43.61it/s, est. speed input: 66914.69 toks/s, output: 65.35 toks/s]
Processed prompts:  14%|█▍        | 290/2048 [00:04<00:40, 43.17it/s, est. speed input: 64944.01 toks/s, output: 63.42 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [00:04<00:40, 42.86it/s, est. speed input: 63272.77 toks/s, output: 61.79 toks/s]
Processed prompts:  16%|█▌        | 322/2048 [00:05<00:40, 42.64it/s, est. speed input: 61841.19 toks/s, output: 60.39 toks/s]
Processed prompts:  17%|█▋        | 338/2048 [00:05<00:40, 42.50it/s, est. speed input: 60601.82 toks/s, output: 59.18 toks/s]
Processed prompts:  17%|█▋        | 354/2048 [00:06<00:39, 42.38it/s, est. speed input: 59509.21 toks/s, output: 58.11 toks/s]
Processed prompts:  18%|█▊        | 370/2048 [00:06<00:39, 42.30it/s, est. speed input: 58547.50 toks/s, output: 57.18 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [00:06<00:39, 42.26it/s, est. speed input: 57695.59 toks/s, output: 56.34 toks/s]
Processed prompts:  20%|█▉        | 402/2048 [00:07<00:38, 42.21it/s, est. speed input: 56929.63 toks/s, output: 55.60 toks/s]
Processed prompts:  20%|██        | 418/2048 [00:07<00:38, 42.19it/s, est. speed input: 56241.76 toks/s, output: 54.92 toks/s]
Processed prompts:  21%|██        | 434/2048 [00:07<00:38, 42.16it/s, est. speed input: 55616.27 toks/s, output: 54.31 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [00:08<00:37, 42.15it/s, est. speed input: 55050.20 toks/s, output: 53.76 toks/s]
Processed prompts:  23%|██▎       | 466/2048 [00:08<00:37, 42.14it/s, est. speed input: 54533.14 toks/s, output: 53.25 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [00:09<00:37, 42.13it/s, est. speed input: 54057.13 toks/s, output: 52.79 toks/s]
Processed prompts:  24%|██▍       | 498/2048 [00:09<00:36, 42.12it/s, est. speed input: 53620.51 toks/s, output: 52.36 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [00:09<00:36, 42.12it/s, est. speed input: 53216.91 toks/s, output: 51.97 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [00:10<00:36, 42.12it/s, est. speed input: 52843.59 toks/s, output: 51.61 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [00:10<00:35, 42.12it/s, est. speed input: 52496.93 toks/s, output: 51.27 toks/s]
Processed prompts:  27%|██▋       | 562/2048 [00:11<00:35, 42.10it/s, est. speed input: 52172.54 toks/s, output: 50.95 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [00:11<00:34, 42.11it/s, est. speed input: 51872.04 toks/s, output: 50.66 toks/s]
Processed prompts:  29%|██▉       | 594/2048 [00:11<00:34, 42.11it/s, est. speed input: 51589.25 toks/s, output: 50.38 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [00:12<00:34, 42.08it/s, est. speed input: 51321.49 toks/s, output: 50.12 toks/s]
Processed prompts:  31%|███       | 626/2048 [00:12<00:33, 42.09it/s, est. speed input: 51072.94 toks/s, output: 49.88 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [00:12<00:33, 42.08it/s, est. speed input: 50837.41 toks/s, output: 49.65 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [00:13<00:33, 42.09it/s, est. speed input: 50617.49 toks/s, output: 49.43 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [00:13<00:32, 42.09it/s, est. speed input: 50408.21 toks/s, output: 49.23 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [00:14<00:32, 42.07it/s, est. speed input: 50208.90 toks/s, output: 49.03 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [00:14<00:31, 42.07it/s, est. speed input: 50021.04 toks/s, output: 48.85 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [00:14<00:31, 42.07it/s, est. speed input: 49843.23 toks/s, output: 48.67 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [00:15<00:31, 42.05it/s, est. speed input: 49671.97 toks/s, output: 48.51 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [00:15<00:30, 42.04it/s, est. speed input: 49509.81 toks/s, output: 48.35 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [00:15<00:30, 42.03it/s, est. speed input: 49355.34 toks/s, output: 48.20 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [00:16<00:30, 42.04it/s, est. speed input: 49208.53 toks/s, output: 48.06 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [00:16<00:29, 42.03it/s, est. speed input: 49067.60 toks/s, output: 47.92 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [00:17<00:29, 42.03it/s, est. speed input: 48933.40 toks/s, output: 47.79 toks/s]
Processed prompts:  41%|████      | 834/2048 [00:17<00:28, 42.02it/s, est. speed input: 48804.94 toks/s, output: 47.66 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [00:17<00:28, 42.01it/s, est. speed input: 48681.17 toks/s, output: 47.54 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [00:18<00:28, 42.02it/s, est. speed input: 48563.73 toks/s, output: 47.43 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [00:18<00:27, 42.02it/s, est. speed input: 48450.63 toks/s, output: 47.32 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [00:19<00:27, 42.00it/s, est. speed input: 48340.72 toks/s, output: 47.21 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [00:19<00:27, 42.00it/s, est. speed input: 48235.55 toks/s, output: 47.11 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [00:19<00:26, 42.00it/s, est. speed input: 48135.48 toks/s, output: 47.01 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [00:20<00:26, 42.00it/s, est. speed input: 48038.24 toks/s, output: 46.91 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [00:20<00:25, 42.00it/s, est. speed input: 47944.95 toks/s, output: 46.82 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [00:20<00:25, 42.00it/s, est. speed input: 47854.84 toks/s, output: 46.73 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [00:21<00:25, 42.00it/s, est. speed input: 47768.11 toks/s, output: 46.65 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [00:21<00:24, 42.01it/s, est. speed input: 47685.52 toks/s, output: 46.57 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [00:22<00:24, 42.00it/s, est. speed input: 47604.02 toks/s, output: 46.49 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [00:22<00:23, 42.00it/s, est. speed input: 47526.31 toks/s, output: 46.41 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [00:22<00:23, 41.99it/s, est. speed input: 47450.25 toks/s, output: 46.34 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [00:23<00:23, 41.98it/s, est. speed input: 47376.40 toks/s, output: 46.27 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [00:23<00:22, 41.99it/s, est. speed input: 47306.22 toks/s, output: 46.20 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [00:23<00:22, 41.99it/s, est. speed input: 47237.54 toks/s, output: 46.13 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [00:24<00:22, 41.98it/s, est. speed input: 47170.98 toks/s, output: 46.07 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [00:24<00:21, 41.98it/s, est. speed input: 47106.48 toks/s, output: 46.00 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [00:25<00:20, 42.76it/s, est. speed input: 47087.45 toks/s, output: 45.98 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [00:25<00:20, 42.52it/s, est. speed input: 47026.07 toks/s, output: 45.92 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [00:25<00:20, 42.36it/s, est. speed input: 46966.81 toks/s, output: 45.87 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [00:26<00:20, 42.26it/s, est. speed input: 46909.38 toks/s, output: 45.81 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [00:26<00:19, 42.16it/s, est. speed input: 46852.77 toks/s, output: 45.75 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [00:27<00:19, 42.09it/s, est. speed input: 46797.38 toks/s, output: 45.70 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [00:27<00:18, 42.06it/s, est. speed input: 46744.22 toks/s, output: 45.65 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [00:27<00:18, 42.03it/s, est. speed input: 46692.62 toks/s, output: 45.60 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [00:28<00:18, 42.01it/s, est. speed input: 46641.93 toks/s, output: 45.55 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [00:28<00:17, 41.99it/s, est. speed input: 46592.82 toks/s, output: 45.50 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [00:28<00:17, 41.98it/s, est. speed input: 46544.85 toks/s, output: 45.45 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [00:29<00:17, 41.98it/s, est. speed input: 46498.78 toks/s, output: 45.41 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [00:29<00:16, 41.99it/s, est. speed input: 46454.14 toks/s, output: 45.37 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [00:30<00:16, 41.98it/s, est. speed input: 46409.54 toks/s, output: 45.32 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [00:30<00:15, 41.97it/s, est. speed input: 46366.45 toks/s, output: 45.28 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [00:30<00:15, 41.97it/s, est. speed input: 46324.56 toks/s, output: 45.24 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [00:31<00:15, 41.97it/s, est. speed input: 46283.64 toks/s, output: 45.20 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [00:31<00:14, 41.97it/s, est. speed input: 46243.57 toks/s, output: 45.16 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [00:31<00:14, 41.95it/s, est. speed input: 46203.91 toks/s, output: 45.12 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [00:32<00:14, 41.96it/s, est. speed input: 46165.79 toks/s, output: 45.08 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [00:32<00:13, 41.96it/s, est. speed input: 46128.71 toks/s, output: 45.05 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [00:33<00:13, 41.95it/s, est. speed input: 46091.78 toks/s, output: 45.01 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [00:33<00:12, 41.95it/s, est. speed input: 46056.19 toks/s, output: 44.98 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [00:33<00:12, 41.94it/s, est. speed input: 46020.63 toks/s, output: 44.94 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [00:34<00:12, 41.95it/s, est. speed input: 45986.81 toks/s, output: 44.91 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [00:34<00:11, 41.96it/s, est. speed input: 45953.72 toks/s, output: 44.88 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [00:35<00:11, 41.95it/s, est. speed input: 45921.06 toks/s, output: 44.84 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [00:35<00:11, 41.95it/s, est. speed input: 45889.12 toks/s, output: 44.81 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [00:35<00:10, 41.95it/s, est. speed input: 45857.78 toks/s, output: 44.78 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [00:36<00:10, 41.95it/s, est. speed input: 45827.01 toks/s, output: 44.75 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [00:36<00:09, 41.95it/s, est. speed input: 45797.01 toks/s, output: 44.72 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [00:36<00:09, 41.94it/s, est. speed input: 45767.24 toks/s, output: 44.69 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [00:37<00:09, 41.94it/s, est. speed input: 45738.55 toks/s, output: 44.67 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [00:37<00:08, 41.95it/s, est. speed input: 45710.46 toks/s, output: 44.64 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [00:38<00:08, 41.93it/s, est. speed input: 45682.29 toks/s, output: 44.61 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [00:38<00:07, 41.93it/s, est. speed input: 45655.10 toks/s, output: 44.59 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [00:38<00:07, 41.94it/s, est. speed input: 45628.54 toks/s, output: 44.56 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [00:39<00:07, 41.94it/s, est. speed input: 45602.51 toks/s, output: 44.53 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [00:39<00:06, 41.93it/s, est. speed input: 45576.65 toks/s, output: 44.51 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [00:39<00:06, 41.93it/s, est. speed input: 45551.43 toks/s, output: 44.48 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [00:40<00:06, 41.93it/s, est. speed input: 45526.74 toks/s, output: 44.46 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [00:40<00:05, 41.94it/s, est. speed input: 45502.80 toks/s, output: 44.44 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [00:41<00:05, 41.92it/s, est. speed input: 45478.44 toks/s, output: 44.41 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [00:41<00:04, 41.93it/s, est. speed input: 45455.18 toks/s, output: 44.39 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [00:41<00:04, 41.92it/s, est. speed input: 45432.04 toks/s, output: 44.37 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [00:42<00:04, 42.71it/s, est. speed input: 45434.61 toks/s, output: 44.37 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [00:42<00:03, 42.47it/s, est. speed input: 45412.32 toks/s, output: 44.35 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [00:42<00:03, 42.30it/s, est. speed input: 45390.11 toks/s, output: 44.33 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [00:43<00:02, 42.20it/s, est. speed input: 45368.74 toks/s, output: 44.31 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [00:43<00:02, 42.11it/s, est. speed input: 45347.29 toks/s, output: 44.28 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [00:44<00:02, 42.05it/s, est. speed input: 45326.28 toks/s, output: 44.26 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [00:44<00:01, 42.02it/s, est. speed input: 45305.89 toks/s, output: 44.24 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [00:44<00:01, 41.97it/s, est. speed input: 45285.15 toks/s, output: 44.22 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [00:45<00:01, 41.96it/s, est. speed input: 45265.25 toks/s, output: 44.20 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [00:45<00:00, 41.94it/s, est. speed input: 45245.70 toks/s, output: 44.19 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [00:46<00:00, 42.79it/s, est. speed input: 45251.44 toks/s, output: 44.19 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:46<00:00, 42.79it/s, est. speed input: 45562.55 toks/s, output: 44.49 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:46<00:00, 44.49it/s, est. speed input: 45562.55 toks/s, output: 44.49 toks/s]
[rank0]:[W128 00:12:01.495823778 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 77.1s

测试结果:
  Requests/s:   42.02
  Tokens/s:     43069.22
  Total Reqs:   2048
  Elapsed:      48.74s

  [Prefill 分析]
  Total Prefill Tokens: 2097152
  Prefill Tokens/s:     43027.20

============================================================
[7/7] 测试 M=32768
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-INT8                                  │
│ Backend:  cuBLASLt [INT32 output]                         │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 32768
│   M_prefill     = 32768 (= 32 x 1024)
│   M_decode      = 32
│   batched_tokens = 32768 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 4096
│   --max-num-seqs           = 32
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 32768
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:12:17 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3462524) WARNING 01-28 00:12:26 [backends.py:609] Failed to read file <frozen os>
Throughput: 41.96 requests/s, 43005.88 total tokens/s, 41.96 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096


─── STDERR ───
[2026-01-28 00:12:17] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:12:17] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:12:17] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:12:17] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:12:17] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:12:17] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:12:17] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:12:17] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:12:17] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:12:17] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:12:17] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:12:17] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:12:17] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:12:17] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:12:21] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:12:21] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:12:21] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:12:21] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:12:21] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:12:21] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:12:21] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:12:21] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:12:21] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:12:21] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:12:21] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:12:21] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:12:21] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:12:21] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3462524) [2026-01-28 00:12:22] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=3462524) [2026-01-28 00:12:22] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3462524) [2026-01-28 00:12:22] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=3462524) [2026-01-28 00:12:22] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=3462524) [2026-01-28 00:12:22] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuBLASLt, symmetric=True
(EngineCore_DP0 pid=3462524) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3462524) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.94it/s]
(EngineCore_DP0 pid=3462524) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.93it/s]
(EngineCore_DP0 pid=3462524) 
(EngineCore_DP0 pid=3462524) [rank0]:W0128 00:12:29.931000 3462524 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=3462524) [rank0]:W0128 00:12:30.608000 3462524 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
[cuBLASLt] INFO: INT8 GEMM only supports INT32 output. inner_dtype parameter is ignored, always using int32.
(EngineCore_DP0 pid=3462524) [rank0]:W0128 00:12:31.803000 3462524 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=3462524) [rank0]:W0128 00:12:31.879000 3462524 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=3462524) 2026-01-28 00:12:35,252 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3462524) 2026-01-28 00:12:35,293 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3462524) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   9%|▉         | 1/11 [00:00<00:04,  2.10it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  27%|██▋       | 3/11 [00:00<00:01,  5.81it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  45%|████▌     | 5/11 [00:00<00:00,  8.60it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  64%|██████▎   | 7/11 [00:00<00:00, 10.97it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  82%|████████▏ | 9/11 [00:00<00:00, 12.08it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:01<00:00, 10.16it/s]
(EngineCore_DP0 pid=3462524) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  14%|█▍        | 1/7 [00:00<00:00,  7.17it/s]
Capturing CUDA graphs (decode, FULL):  57%|█████▋    | 4/7 [00:00<00:00, 16.88it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00, 21.23it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00, 18.87it/s]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 72/4096 [00:00<00:05, 714.31it/s]
Adding requests:   4%|▎         | 148/4096 [00:00<00:05, 737.80it/s]
Adding requests:   5%|▌         | 225/4096 [00:00<00:05, 750.01it/s]
Adding requests:   7%|▋         | 301/4096 [00:00<00:05, 753.75it/s]
Adding requests:   9%|▉         | 379/4096 [00:00<00:04, 759.54it/s]
Adding requests:  11%|█         | 455/4096 [00:00<00:04, 759.65it/s]
Adding requests:  13%|█▎        | 531/4096 [00:00<00:04, 741.58it/s]
Adding requests:  15%|█▍        | 608/4096 [00:00<00:04, 747.64it/s]
Adding requests:  17%|█▋        | 688/4096 [00:00<00:04, 761.22it/s]
Adding requests:  19%|█▊        | 765/4096 [00:01<00:04, 760.96it/s]
Adding requests:  21%|██        | 842/4096 [00:01<00:04, 745.80it/s]
Adding requests:  22%|██▏       | 918/4096 [00:01<00:04, 749.43it/s]
Adding requests:  24%|██▍       | 995/4096 [00:01<00:04, 753.03it/s]
Adding requests:  26%|██▌       | 1071/4096 [00:01<00:04, 735.31it/s]
Adding requests:  28%|██▊       | 1145/4096 [00:01<00:04, 736.25it/s]
Adding requests:  30%|██▉       | 1223/4096 [00:01<00:03, 746.72it/s]
Adding requests:  32%|███▏      | 1298/4096 [00:01<00:03, 743.83it/s]
Adding requests:  34%|███▎      | 1374/4096 [00:01<00:03, 746.06it/s]
Adding requests:  35%|███▌      | 1450/4096 [00:01<00:03, 749.20it/s]
Adding requests:  37%|███▋      | 1529/4096 [00:02<00:03, 761.17it/s]
Adding requests:  39%|███▉      | 1608/4096 [00:02<00:03, 769.48it/s]
Adding requests:  41%|████      | 1685/4096 [00:02<00:03, 763.88it/s]
Adding requests:  43%|████▎     | 1764/4096 [00:02<00:03, 768.75it/s]
Adding requests:  45%|████▍     | 1841/4096 [00:02<00:02, 767.19it/s]
Adding requests:  47%|████▋     | 1918/4096 [00:02<00:02, 765.95it/s]
Adding requests:  49%|████▊     | 1995/4096 [00:02<00:02, 765.41it/s]
Adding requests:  51%|█████     | 2073/4096 [00:02<00:02, 769.74it/s]
Adding requests:  52%|█████▏    | 2150/4096 [00:02<00:02, 758.85it/s]
Adding requests:  54%|█████▍    | 2226/4096 [00:02<00:02, 742.83it/s]
Adding requests:  56%|█████▋    | 2304/4096 [00:03<00:02, 753.09it/s]
Adding requests:  58%|█████▊    | 2382/4096 [00:03<00:02, 759.00it/s]
Adding requests:  60%|██████    | 2459/4096 [00:03<00:02, 759.36it/s]
Adding requests:  62%|██████▏   | 2536/4096 [00:03<00:02, 760.93it/s]
Adding requests:  64%|██████▍   | 2614/4096 [00:03<00:01, 765.59it/s]
Adding requests:  66%|██████▌   | 2691/4096 [00:03<00:01, 759.33it/s]
Adding requests:  68%|██████▊   | 2767/4096 [00:03<00:01, 757.92it/s]
Adding requests:  69%|██████▉   | 2843/4096 [00:03<00:01, 756.85it/s]
Adding requests:  71%|███████▏  | 2920/4096 [00:03<00:01, 760.43it/s]
Adding requests:  73%|███████▎  | 2997/4096 [00:03<00:01, 755.29it/s]
Adding requests:  75%|███████▌  | 3073/4096 [00:04<00:01, 753.90it/s]
Adding requests:  77%|███████▋  | 3149/4096 [00:04<00:01, 755.43it/s]
Adding requests:  79%|███████▊  | 3225/4096 [00:04<00:01, 755.09it/s]
Adding requests:  81%|████████  | 3303/4096 [00:04<00:01, 759.73it/s]
Adding requests:  83%|████████▎ | 3380/4096 [00:04<00:00, 761.04it/s]
Adding requests:  84%|████████▍ | 3457/4096 [00:04<00:00, 758.39it/s]
Adding requests:  86%|████████▋ | 3533/4096 [00:04<00:00, 752.97it/s]
Adding requests:  88%|████████▊ | 3609/4096 [00:04<00:00, 739.49it/s]
Adding requests:  90%|████████▉ | 3684/4096 [00:04<00:00, 738.31it/s]
Adding requests:  92%|█████████▏| 3761/4096 [00:04<00:00, 746.61it/s]
Adding requests:  94%|█████████▎| 3839/4096 [00:05<00:00, 755.07it/s]
Adding requests:  96%|█████████▌| 3919/4096 [00:05<00:00, 767.85it/s]
Adding requests:  98%|█████████▊| 3997/4096 [00:05<00:00, 770.36it/s]
Adding requests:  99%|█████████▉| 4075/4096 [00:05<00:00, 772.26it/s]
Adding requests: 100%|██████████| 4096/4096 [00:05<00:00, 756.42it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▌         | 226/4096 [00:00<00:12, 302.54it/s, est. speed input: 309807.53 toks/s, output: 302.54 toks/s]
Processed prompts:   6%|▋         | 258/4096 [00:01<00:25, 148.36it/s, est. speed input: 175413.46 toks/s, output: 171.30 toks/s]
Processed prompts:   7%|▋         | 290/4096 [00:02<00:38, 99.67it/s, est. speed input: 131079.61 toks/s, output: 128.01 toks/s] 
Processed prompts:   8%|▊         | 322/4096 [00:03<00:49, 76.90it/s, est. speed input: 108998.52 toks/s, output: 106.44 toks/s]
Processed prompts:   9%|▊         | 354/4096 [00:03<00:58, 64.23it/s, est. speed input: 95690.28 toks/s, output: 93.45 toks/s]  
Processed prompts:   9%|▉         | 386/4096 [00:04<01:05, 56.71it/s, est. speed input: 86908.27 toks/s, output: 84.87 toks/s]
Processed prompts:  10%|█         | 418/4096 [00:05<01:10, 51.94it/s, est. speed input: 80639.94 toks/s, output: 78.75 toks/s]
Processed prompts:  11%|█         | 450/4096 [00:06<01:14, 48.81it/s, est. speed input: 75940.06 toks/s, output: 74.16 toks/s]
Processed prompts:  12%|█▏        | 482/4096 [00:06<01:17, 46.71it/s, est. speed input: 72284.03 toks/s, output: 70.59 toks/s]
Processed prompts:  13%|█▎        | 514/4096 [00:07<01:19, 45.28it/s, est. speed input: 69357.93 toks/s, output: 67.73 toks/s]
Processed prompts:  13%|█▎        | 546/4096 [00:08<01:20, 44.29it/s, est. speed input: 66963.76 toks/s, output: 65.39 toks/s]
Processed prompts:  14%|█▍        | 578/4096 [00:09<01:20, 43.61it/s, est. speed input: 64968.09 toks/s, output: 63.45 toks/s]
Processed prompts:  15%|█▍        | 610/4096 [00:09<01:20, 43.15it/s, est. speed input: 63281.06 toks/s, output: 61.80 toks/s]
Processed prompts:  16%|█▌        | 642/4096 [00:10<01:20, 42.81it/s, est. speed input: 61831.76 toks/s, output: 60.38 toks/s]
Processed prompts:  16%|█▋        | 674/4096 [00:11<01:20, 42.58it/s, est. speed input: 60577.05 toks/s, output: 59.16 toks/s]
Processed prompts:  17%|█▋        | 706/4096 [00:12<01:19, 42.41it/s, est. speed input: 59478.68 toks/s, output: 58.08 toks/s]
Processed prompts:  18%|█▊        | 738/4096 [00:12<01:19, 42.30it/s, est. speed input: 58509.05 toks/s, output: 57.14 toks/s]
Processed prompts:  19%|█▉        | 770/4096 [00:13<01:18, 42.21it/s, est. speed input: 57646.85 toks/s, output: 56.30 toks/s]
Processed prompts:  20%|█▉        | 802/4096 [00:14<01:18, 42.15it/s, est. speed input: 56875.24 toks/s, output: 55.54 toks/s]
Processed prompts:  20%|██        | 834/4096 [00:15<01:17, 42.11it/s, est. speed input: 56180.43 toks/s, output: 54.86 toks/s]
Processed prompts:  21%|██        | 866/4096 [00:15<01:16, 42.08it/s, est. speed input: 55551.81 toks/s, output: 54.25 toks/s]
Processed prompts:  22%|██▏       | 898/4096 [00:16<01:16, 42.06it/s, est. speed input: 54980.96 toks/s, output: 53.69 toks/s]
Processed prompts:  23%|██▎       | 930/4096 [00:17<01:15, 42.04it/s, est. speed input: 54459.45 toks/s, output: 53.18 toks/s]
Processed prompts:  23%|██▎       | 962/4096 [00:18<01:14, 42.02it/s, est. speed input: 53980.16 toks/s, output: 52.71 toks/s]
Processed prompts:  24%|██▍       | 994/4096 [00:19<01:13, 42.02it/s, est. speed input: 53540.82 toks/s, output: 52.29 toks/s]
Processed prompts:  25%|██▌       | 1026/4096 [00:19<01:13, 42.01it/s, est. speed input: 53135.32 toks/s, output: 51.89 toks/s]
Processed prompts:  26%|██▌       | 1058/4096 [00:20<01:12, 42.00it/s, est. speed input: 52758.44 toks/s, output: 51.52 toks/s]
Processed prompts:  27%|██▋       | 1090/4096 [00:21<01:11, 42.00it/s, est. speed input: 52409.33 toks/s, output: 51.18 toks/s]
Processed prompts:  27%|██▋       | 1122/4096 [00:22<01:10, 42.00it/s, est. speed input: 52084.65 toks/s, output: 50.86 toks/s]
Processed prompts:  28%|██▊       | 1154/4096 [00:22<01:10, 42.00it/s, est. speed input: 51781.01 toks/s, output: 50.57 toks/s]
Processed prompts:  29%|██▉       | 1186/4096 [00:23<01:09, 41.99it/s, est. speed input: 51496.48 toks/s, output: 50.29 toks/s]
Processed prompts:  30%|██▉       | 1218/4096 [00:24<01:08, 41.98it/s, est. speed input: 51229.68 toks/s, output: 50.03 toks/s]
Processed prompts:  31%|███       | 1250/4096 [00:25<01:07, 41.98it/s, est. speed input: 50979.16 toks/s, output: 49.78 toks/s]
Processed prompts:  31%|███▏      | 1282/4096 [00:25<01:07, 41.98it/s, est. speed input: 50744.02 toks/s, output: 49.55 toks/s]
Processed prompts:  32%|███▏      | 1314/4096 [00:26<01:06, 41.98it/s, est. speed input: 50521.31 toks/s, output: 49.34 toks/s]
Processed prompts:  33%|███▎      | 1346/4096 [00:27<01:05, 41.98it/s, est. speed input: 50311.47 toks/s, output: 49.13 toks/s]
Processed prompts:  34%|███▎      | 1378/4096 [00:28<01:04, 41.97it/s, est. speed input: 50112.97 toks/s, output: 48.94 toks/s]
Processed prompts:  34%|███▍      | 1410/4096 [00:28<01:03, 41.97it/s, est. speed input: 49924.56 toks/s, output: 48.75 toks/s]
Processed prompts:  35%|███▌      | 1442/4096 [00:29<01:03, 41.97it/s, est. speed input: 49745.83 toks/s, output: 48.58 toks/s]
Processed prompts:  36%|███▌      | 1474/4096 [00:30<01:02, 41.97it/s, est. speed input: 49576.80 toks/s, output: 48.41 toks/s]
Processed prompts:  37%|███▋      | 1506/4096 [00:31<01:01, 41.96it/s, est. speed input: 49414.64 toks/s, output: 48.26 toks/s]
Processed prompts:  38%|███▊      | 1538/4096 [00:31<01:00, 41.95it/s, est. speed input: 49259.63 toks/s, output: 48.11 toks/s]
Processed prompts:  38%|███▊      | 1570/4096 [00:32<01:00, 41.95it/s, est. speed input: 49112.57 toks/s, output: 47.96 toks/s]
Processed prompts:  39%|███▉      | 1602/4096 [00:33<00:59, 41.95it/s, est. speed input: 48972.15 toks/s, output: 47.82 toks/s]
Processed prompts:  40%|███▉      | 1634/4096 [00:34<00:58, 41.94it/s, est. speed input: 48837.91 toks/s, output: 47.69 toks/s]
Processed prompts:  41%|████      | 1666/4096 [00:35<00:57, 41.95it/s, est. speed input: 48710.19 toks/s, output: 47.57 toks/s]
Processed prompts:  41%|████▏     | 1698/4096 [00:35<00:57, 41.95it/s, est. speed input: 48587.62 toks/s, output: 47.45 toks/s]
Processed prompts:  42%|████▏     | 1730/4096 [00:36<00:56, 41.95it/s, est. speed input: 48469.76 toks/s, output: 47.33 toks/s]
Processed prompts:  43%|████▎     | 1762/4096 [00:37<00:55, 41.95it/s, est. speed input: 48356.90 toks/s, output: 47.22 toks/s]
Processed prompts:  44%|████▍     | 1794/4096 [00:38<00:54, 41.94it/s, est. speed input: 48248.56 toks/s, output: 47.12 toks/s]
Processed prompts:  45%|████▍     | 1826/4096 [00:38<00:54, 41.94it/s, est. speed input: 48144.38 toks/s, output: 47.02 toks/s]
Processed prompts:  45%|████▌     | 1858/4096 [00:39<00:52, 42.30it/s, est. speed input: 48070.25 toks/s, output: 46.94 toks/s]
Processed prompts:  46%|████▌     | 1890/4096 [00:40<00:52, 42.19it/s, est. speed input: 47973.25 toks/s, output: 46.85 toks/s]
Processed prompts:  47%|████▋     | 1922/4096 [00:41<00:51, 42.11it/s, est. speed input: 47879.86 toks/s, output: 46.76 toks/s]
Processed prompts:  48%|████▊     | 1954/4096 [00:41<00:50, 42.06it/s, est. speed input: 47790.17 toks/s, output: 46.67 toks/s]
Processed prompts:  48%|████▊     | 1986/4096 [00:42<00:50, 42.02it/s, est. speed input: 47703.27 toks/s, output: 46.59 toks/s]
Processed prompts:  49%|████▉     | 2018/4096 [00:43<00:49, 42.00it/s, est. speed input: 47619.54 toks/s, output: 46.50 toks/s]
Processed prompts:  50%|█████     | 2050/4096 [00:44<00:48, 41.97it/s, est. speed input: 47538.34 toks/s, output: 46.42 toks/s]
Processed prompts:  51%|█████     | 2082/4096 [00:44<00:47, 41.96it/s, est. speed input: 47460.12 toks/s, output: 46.35 toks/s]
Processed prompts:  52%|█████▏    | 2114/4096 [00:45<00:47, 41.95it/s, est. speed input: 47384.54 toks/s, output: 46.27 toks/s]
Processed prompts:  52%|█████▏    | 2146/4096 [00:46<00:46, 41.94it/s, est. speed input: 47311.24 toks/s, output: 46.20 toks/s]
Processed prompts:  53%|█████▎    | 2178/4096 [00:47<00:45, 41.94it/s, est. speed input: 47240.56 toks/s, output: 46.13 toks/s]
Processed prompts:  54%|█████▍    | 2210/4096 [00:47<00:44, 41.93it/s, est. speed input: 47171.98 toks/s, output: 46.07 toks/s]
Processed prompts:  55%|█████▍    | 2242/4096 [00:48<00:44, 41.93it/s, est. speed input: 47105.43 toks/s, output: 46.00 toks/s]
Processed prompts:  56%|█████▌    | 2274/4096 [00:49<00:43, 41.92it/s, est. speed input: 47040.69 toks/s, output: 45.94 toks/s]
Processed prompts:  56%|█████▋    | 2306/4096 [00:50<00:42, 41.92it/s, est. speed input: 46978.04 toks/s, output: 45.88 toks/s]
Processed prompts:  57%|█████▋    | 2338/4096 [00:51<00:41, 41.92it/s, est. speed input: 46917.36 toks/s, output: 45.82 toks/s]
Processed prompts:  58%|█████▊    | 2370/4096 [00:51<00:41, 41.91it/s, est. speed input: 46858.31 toks/s, output: 45.76 toks/s]
Processed prompts:  59%|█████▊    | 2402/4096 [00:52<00:40, 41.92it/s, est. speed input: 46801.15 toks/s, output: 45.70 toks/s]
Processed prompts:  59%|█████▉    | 2434/4096 [00:53<00:39, 41.91it/s, est. speed input: 46745.40 toks/s, output: 45.65 toks/s]
Processed prompts:  60%|██████    | 2466/4096 [00:54<00:38, 41.92it/s, est. speed input: 46691.55 toks/s, output: 45.60 toks/s]
Processed prompts:  61%|██████    | 2498/4096 [00:54<00:37, 42.28it/s, est. speed input: 46657.69 toks/s, output: 45.56 toks/s]
Processed prompts:  62%|██████▏   | 2530/4096 [00:55<00:37, 42.17it/s, est. speed input: 46606.32 toks/s, output: 45.51 toks/s]
Processed prompts:  63%|██████▎   | 2562/4096 [00:56<00:36, 42.09it/s, est. speed input: 46556.33 toks/s, output: 45.47 toks/s]
Processed prompts:  63%|██████▎   | 2594/4096 [00:57<00:35, 42.04it/s, est. speed input: 46507.73 toks/s, output: 45.42 toks/s]
Processed prompts:  64%|██████▍   | 2626/4096 [00:57<00:35, 42.00it/s, est. speed input: 46460.27 toks/s, output: 45.37 toks/s]
Processed prompts:  65%|██████▍   | 2658/4096 [00:58<00:34, 41.97it/s, est. speed input: 46414.05 toks/s, output: 45.33 toks/s]
Processed prompts:  66%|██████▌   | 2690/4096 [00:59<00:33, 41.95it/s, est. speed input: 46368.92 toks/s, output: 45.28 toks/s]
Processed prompts:  66%|██████▋   | 2722/4096 [01:00<00:32, 41.94it/s, est. speed input: 46325.10 toks/s, output: 45.24 toks/s]
Processed prompts:  67%|██████▋   | 2754/4096 [01:00<00:32, 41.93it/s, est. speed input: 46282.29 toks/s, output: 45.20 toks/s]
Processed prompts:  68%|██████▊   | 2786/4096 [01:01<00:31, 41.93it/s, est. speed input: 46241.00 toks/s, output: 45.16 toks/s]
Processed prompts:  69%|██████▉   | 2818/4096 [01:02<00:30, 41.91it/s, est. speed input: 46199.89 toks/s, output: 45.12 toks/s]
Processed prompts:  70%|██████▉   | 2850/4096 [01:03<00:29, 41.91it/s, est. speed input: 46160.20 toks/s, output: 45.08 toks/s]
Processed prompts:  70%|███████   | 2882/4096 [01:03<00:28, 41.91it/s, est. speed input: 46121.34 toks/s, output: 45.04 toks/s]
Processed prompts:  71%|███████   | 2914/4096 [01:04<00:28, 41.92it/s, est. speed input: 46083.88 toks/s, output: 45.00 toks/s]
Processed prompts:  72%|███████▏  | 2946/4096 [01:05<00:27, 41.90it/s, est. speed input: 46046.17 toks/s, output: 44.97 toks/s]
Processed prompts:  73%|███████▎  | 2978/4096 [01:06<00:26, 41.90it/s, est. speed input: 46009.90 toks/s, output: 44.93 toks/s]
Processed prompts:  73%|███████▎  | 3010/4096 [01:07<00:25, 41.90it/s, est. speed input: 45974.62 toks/s, output: 44.90 toks/s]
Processed prompts:  74%|███████▍  | 3042/4096 [01:07<00:25, 41.90it/s, est. speed input: 45940.11 toks/s, output: 44.86 toks/s]
Processed prompts:  75%|███████▌  | 3074/4096 [01:08<00:24, 41.89it/s, est. speed input: 45906.00 toks/s, output: 44.83 toks/s]
Processed prompts:  76%|███████▌  | 3106/4096 [01:09<00:23, 41.89it/s, est. speed input: 45872.76 toks/s, output: 44.80 toks/s]
Processed prompts:  77%|███████▋  | 3138/4096 [01:10<00:22, 41.89it/s, est. speed input: 45840.42 toks/s, output: 44.77 toks/s]
Processed prompts:  77%|███████▋  | 3170/4096 [01:10<00:22, 41.89it/s, est. speed input: 45808.72 toks/s, output: 44.74 toks/s]
Processed prompts:  78%|███████▊  | 3202/4096 [01:11<00:21, 41.89it/s, est. speed input: 45777.68 toks/s, output: 44.70 toks/s]
Processed prompts:  79%|███████▉  | 3234/4096 [01:12<00:20, 41.89it/s, est. speed input: 45747.37 toks/s, output: 44.68 toks/s]
Processed prompts:  80%|███████▉  | 3266/4096 [01:13<00:19, 41.90it/s, est. speed input: 45717.77 toks/s, output: 44.65 toks/s]
Processed prompts:  81%|████████  | 3298/4096 [01:13<00:19, 41.90it/s, est. speed input: 45688.61 toks/s, output: 44.62 toks/s]
Processed prompts:  81%|████████▏ | 3330/4096 [01:14<00:18, 41.89it/s, est. speed input: 45660.04 toks/s, output: 44.59 toks/s]
Processed prompts:  82%|████████▏ | 3362/4096 [01:15<00:17, 41.89it/s, est. speed input: 45631.94 toks/s, output: 44.56 toks/s]
Processed prompts:  83%|████████▎ | 3394/4096 [01:16<00:16, 41.89it/s, est. speed input: 45604.57 toks/s, output: 44.54 toks/s]
Processed prompts:  84%|████████▎ | 3426/4096 [01:16<00:15, 41.90it/s, est. speed input: 45577.83 toks/s, output: 44.51 toks/s]
Processed prompts:  84%|████████▍ | 3458/4096 [01:17<00:15, 41.89it/s, est. speed input: 45551.38 toks/s, output: 44.48 toks/s]
Processed prompts:  85%|████████▌ | 3490/4096 [01:18<00:14, 41.88it/s, est. speed input: 45525.29 toks/s, output: 44.46 toks/s]
Processed prompts:  86%|████████▌ | 3522/4096 [01:19<00:13, 41.88it/s, est. speed input: 45499.89 toks/s, output: 44.43 toks/s]
Processed prompts:  87%|████████▋ | 3554/4096 [01:20<00:12, 41.89it/s, est. speed input: 45475.19 toks/s, output: 44.41 toks/s]
Processed prompts:  88%|████████▊ | 3586/4096 [01:20<00:12, 41.90it/s, est. speed input: 45451.09 toks/s, output: 44.39 toks/s]
Processed prompts:  88%|████████▊ | 3618/4096 [01:21<00:11, 41.88it/s, est. speed input: 45426.63 toks/s, output: 44.36 toks/s]
Processed prompts:  89%|████████▉ | 3650/4096 [01:22<00:10, 41.88it/s, est. speed input: 45402.88 toks/s, output: 44.34 toks/s]
Processed prompts:  90%|████████▉ | 3682/4096 [01:23<00:09, 41.88it/s, est. speed input: 45379.92 toks/s, output: 44.32 toks/s]
Processed prompts:  91%|█████████ | 3714/4096 [01:23<00:09, 41.88it/s, est. speed input: 45357.23 toks/s, output: 44.29 toks/s]
Processed prompts:  91%|█████████▏| 3746/4096 [01:24<00:08, 41.88it/s, est. speed input: 45334.83 toks/s, output: 44.27 toks/s]
Processed prompts:  92%|█████████▏| 3778/4096 [01:25<00:07, 41.89it/s, est. speed input: 45313.08 toks/s, output: 44.25 toks/s]
Processed prompts:  93%|█████████▎| 3810/4096 [01:26<00:06, 41.88it/s, est. speed input: 45291.46 toks/s, output: 44.23 toks/s]
Processed prompts:  94%|█████████▍| 3842/4096 [01:26<00:06, 41.89it/s, est. speed input: 45270.54 toks/s, output: 44.21 toks/s]
Processed prompts:  95%|█████████▍| 3874/4096 [01:27<00:05, 41.88it/s, est. speed input: 45249.48 toks/s, output: 44.19 toks/s]
Processed prompts:  95%|█████████▌| 3906/4096 [01:28<00:04, 41.88it/s, est. speed input: 45229.02 toks/s, output: 44.17 toks/s]
Processed prompts:  96%|█████████▌| 3938/4096 [01:29<00:03, 41.88it/s, est. speed input: 45208.93 toks/s, output: 44.15 toks/s]
Processed prompts:  97%|█████████▋| 3970/4096 [01:29<00:03, 41.87it/s, est. speed input: 45188.89 toks/s, output: 44.13 toks/s]
Processed prompts:  98%|█████████▊| 4002/4096 [01:30<00:02, 41.87it/s, est. speed input: 45169.47 toks/s, output: 44.11 toks/s]
Processed prompts:  98%|█████████▊| 4034/4096 [01:31<00:01, 42.23it/s, est. speed input: 45161.03 toks/s, output: 44.10 toks/s]
Processed prompts:  99%|█████████▉| 4066/4096 [01:32<00:00, 42.55it/s, est. speed input: 45154.60 toks/s, output: 44.10 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [01:32<00:00, 42.55it/s, est. speed input: 45487.63 toks/s, output: 44.42 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [01:32<00:00, 44.42it/s, est. speed input: 45487.63 toks/s, output: 44.42 toks/s]
[rank0]:[W128 00:14:15.350825513 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 133.9s

测试结果:
  Requests/s:   41.96
  Tokens/s:     43005.88
  Total Reqs:   4096
  Elapsed:      97.62s

  [Prefill 分析]
  Total Prefill Tokens: 4194304
  Prefill Tokens/s:     42963.93


------------------------------------------------------------
  生成 CSV: BitNet-2B-INT8
------------------------------------------------------------
[SUCCESS] CSV 保存到: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX5080_cc120_INT8_py312_cu129_x86_64/cublaslt/BitNet-2B-INT8_prefill.csv

预览:
------------------------------------------------------------
M_prefill,prompt_len,max_num_seqs,num_prompts,N_prefill,requests_per_s,tokens_per_s,elapsed_time_s
512,512,1,128,128,52.2861,26822.7827,2.4481
1024,1024,1,128,128,42.3216,43379.6609,3.0245
2048,1024,2,256,128,44.9539,46077.7946,5.6947
4096,1024,4,512,128,43.7874,44882.0587,11.6929
8192,1024,8,1024,128,42.4614,43522.9772,24.1160
16384,1024,16,2048,128,42.0188,43069.2219,48.7401
32768,1024,32,4096,128,41.9570,43005.8837,97.6239

------------------------------------------------------------

[INFO] 完成: 7 成功, 0 失败

============================================================
  BitNet-2B-INT8 | cuSPARSELt (2_4) | prefill
============================================================

[INFO] Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_4
[INFO] Output: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX5080_cc120_INT8_py312_cu129_x86_64/cusparselt/2_4

============================================================
[1/7] 测试 M=512
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-INT8                                  │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 512
│   M_prefill     = 512 (= 1 x 512)
│   M_decode      = 1
│   batched_tokens = 513 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 512
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 513
│   --max-num-batched-tokens = 513
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:14:20 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3464671) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3464671) WARNING 01-28 00:14:30 [backends.py:609] Failed to read file <frozen os>
Throughput: 55.30 requests/s, 28371.25 total tokens/s, 55.30 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128


─── STDERR ───
[2026-01-28 00:14:20] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:14:20] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:14:20] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:14:20] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:14:20] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:14:20] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:14:20] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:14:20] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:14:20] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:14:20] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:14:20] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:14:20] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:14:20] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:14:20] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:14:24] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:14:24] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:14:24] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:14:24] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:14:24] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:14:24] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:14:24] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:14:24] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:14:24] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:14:24] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:14:24] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:14:24] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:14:24] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:14:24] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3464671) [2026-01-28 00:14:25] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3464671) [2026-01-28 00:14:25] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3464671) [2026-01-28 00:14:25] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3464671) [2026-01-28 00:14:25] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=3464671) [2026-01-28 00:14:25] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=3464671) [2026-01-28 00:14:25] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=3464671) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3464671) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.55it/s]
(EngineCore_DP0 pid=3464671) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.55it/s]
(EngineCore_DP0 pid=3464671) 
(EngineCore_DP0 pid=3464671) [2026-01-28 00:14:25] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 2560] -> 1D uint8
(EngineCore_DP0 pid=3464671) [2026-01-28 00:14:25] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7372800 bytes
(EngineCore_DP0 pid=3464671) [2026-01-28 00:14:25] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 2560] -> 1D uint8
(EngineCore_DP0 pid=3464671) [2026-01-28 00:14:25] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4915200 bytes
(EngineCore_DP0 pid=3464671) [2026-01-28 00:14:25] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 2560] -> 1D uint8
(EngineCore_DP0 pid=3464671) [2026-01-28 00:14:25] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 26542080 bytes
(EngineCore_DP0 pid=3464671) [2026-01-28 00:14:25] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 6912] -> 1D uint8
(EngineCore_DP0 pid=3464671) [2026-01-28 00:14:25] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 13271040 bytes
(EngineCore_DP0 pid=3464671) 2026-01-28 00:14:36,664 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3464671) 2026-01-28 00:14:36,680 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3464671) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  3.06it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  3.04it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  3.04it/s]
(EngineCore_DP0 pid=3464671) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.37it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.37it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  91%|█████████▏| 117/128 [00:00<00:00, 1165.80it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 1179.10it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:20,  6.22it/s, est. speed input: 3184.66 toks/s, output: 6.22 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:00<00:03, 34.02it/s, est. speed input: 14919.69 toks/s, output: 29.14 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:00<00:02, 45.19it/s, est. speed input: 19677.30 toks/s, output: 38.43 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:00<00:02, 51.66it/s, est. speed input: 22450.60 toks/s, output: 43.85 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:00<00:01, 55.51it/s, est. speed input: 24218.28 toks/s, output: 47.30 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:00<00:01, 58.17it/s, est. speed input: 25491.47 toks/s, output: 49.79 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:00<00:01, 59.12it/s, est. speed input: 26281.17 toks/s, output: 51.33 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:00<00:01, 59.98it/s, est. speed input: 26921.87 toks/s, output: 52.58 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:01<00:01, 60.74it/s, est. speed input: 27454.01 toks/s, output: 53.62 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:01<00:01, 61.25it/s, est. speed input: 27884.12 toks/s, output: 54.46 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:01<00:00, 61.72it/s, est. speed input: 28253.56 toks/s, output: 55.18 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:01<00:00, 61.46it/s, est. speed input: 28492.77 toks/s, output: 55.65 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:01<00:00, 61.77it/s, est. speed input: 28752.18 toks/s, output: 56.16 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:01<00:00, 61.97it/s, est. speed input: 28974.12 toks/s, output: 56.59 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:01<00:00, 61.99it/s, est. speed input: 29155.20 toks/s, output: 56.94 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:01<00:00, 62.09it/s, est. speed input: 29321.96 toks/s, output: 57.27 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:01<00:00, 62.28it/s, est. speed input: 29480.50 toks/s, output: 57.58 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:02<00:00, 62.51it/s, est. speed input: 29630.59 toks/s, output: 57.87 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:02<00:00, 62.40it/s, est. speed input: 29743.43 toks/s, output: 58.09 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:02<00:00, 62.40it/s, est. speed input: 29733.67 toks/s, output: 58.07 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:02<00:00, 58.07it/s, est. speed input: 29733.67 toks/s, output: 58.07 toks/s]
[rank0]:[W128 00:14:40.689756700 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 25.3s

测试结果:
  Requests/s:   55.30
  Tokens/s:     28371.25
  Total Reqs:   128
  Elapsed:      2.31s

  [Prefill 分析]
  Total Prefill Tokens: 65536
  Prefill Tokens/s:     28315.95

============================================================
[2/7] 测试 M=1024
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-INT8                                  │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 1024
│   M_prefill     = 1024 (= 1 x 1024)
│   M_decode      = 1
│   batched_tokens = 1025 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 1025
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:14:46 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3465408) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3465408) WARNING 01-28 00:14:55 [backends.py:609] Failed to read file <frozen os>
Throughput: 53.17 requests/s, 54494.70 total tokens/s, 53.17 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128


─── STDERR ───
[2026-01-28 00:14:46] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:14:46] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:14:46] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:14:46] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:14:46] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:14:46] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:14:46] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:14:46] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:14:46] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:14:46] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:14:46] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:14:46] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:14:46] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:14:46] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:14:49] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:14:50] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:14:50] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:14:50] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:14:50] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:14:50] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:14:50] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:14:50] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:14:50] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:14:50] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:14:50] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:14:50] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:14:50] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:14:50] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3465408) [2026-01-28 00:14:50] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3465408) [2026-01-28 00:14:50] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3465408) [2026-01-28 00:14:50] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3465408) [2026-01-28 00:14:50] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=3465408) [2026-01-28 00:14:50] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=3465408) [2026-01-28 00:14:50] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=3465408) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3465408) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.57it/s]
(EngineCore_DP0 pid=3465408) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.57it/s]
(EngineCore_DP0 pid=3465408) 
(EngineCore_DP0 pid=3465408) [2026-01-28 00:14:51] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 2560] -> 1D uint8
(EngineCore_DP0 pid=3465408) [2026-01-28 00:14:51] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7372800 bytes
(EngineCore_DP0 pid=3465408) [2026-01-28 00:14:51] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 2560] -> 1D uint8
(EngineCore_DP0 pid=3465408) [2026-01-28 00:14:51] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4915200 bytes
(EngineCore_DP0 pid=3465408) [2026-01-28 00:14:51] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 2560] -> 1D uint8
(EngineCore_DP0 pid=3465408) [2026-01-28 00:14:51] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 26542080 bytes
(EngineCore_DP0 pid=3465408) [2026-01-28 00:14:51] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 6912] -> 1D uint8
(EngineCore_DP0 pid=3465408) [2026-01-28 00:14:51] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 13271040 bytes
(EngineCore_DP0 pid=3465408) 2026-01-28 00:15:01,701 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3465408) 2026-01-28 00:15:01,717 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3465408) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00, 23.25it/s]
(EngineCore_DP0 pid=3465408) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.40it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.39it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  54%|█████▍    | 69/128 [00:00<00:00, 688.29it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 708.39it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 2/128 [00:00<00:07, 17.73it/s, est. speed input: 18155.05 toks/s, output: 17.73 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:00<00:02, 41.17it/s, est. speed input: 38362.05 toks/s, output: 37.46 toks/s]
Processed prompts:  11%|█         | 14/128 [00:00<00:02, 49.14it/s, est. speed input: 45477.71 toks/s, output: 44.41 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:00<00:02, 52.50it/s, est. speed input: 48838.00 toks/s, output: 47.69 toks/s]
Processed prompts:  20%|██        | 26/128 [00:00<00:01, 55.09it/s, est. speed input: 51242.06 toks/s, output: 50.04 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:00<00:01, 56.72it/s, est. speed input: 52880.74 toks/s, output: 51.64 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:00<00:01, 57.70it/s, est. speed input: 54037.91 toks/s, output: 52.77 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:00<00:01, 58.41it/s, est. speed input: 54933.12 toks/s, output: 53.65 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:00<00:01, 58.87it/s, est. speed input: 55631.18 toks/s, output: 54.33 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:01<00:01, 59.15it/s, est. speed input: 56180.03 toks/s, output: 54.86 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:01<00:01, 59.34it/s, est. speed input: 56628.46 toks/s, output: 55.30 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:01<00:01, 59.50it/s, est. speed input: 57012.69 toks/s, output: 55.68 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:01<00:00, 59.46it/s, est. speed input: 57301.37 toks/s, output: 55.96 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:01<00:00, 59.59it/s, est. speed input: 57585.43 toks/s, output: 56.24 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:01<00:00, 59.57it/s, est. speed input: 57809.17 toks/s, output: 56.45 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:01<00:00, 59.64it/s, est. speed input: 58019.46 toks/s, output: 56.66 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:01<00:00, 59.79it/s, est. speed input: 58255.40 toks/s, output: 56.89 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:01<00:00, 59.89it/s, est. speed input: 58461.20 toks/s, output: 57.09 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:01<00:00, 59.88it/s, est. speed input: 58606.49 toks/s, output: 57.23 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:02<00:00, 59.94it/s, est. speed input: 58769.49 toks/s, output: 57.39 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:02<00:00, 60.00it/s, est. speed input: 58918.41 toks/s, output: 57.54 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:02<00:00, 60.00it/s, est. speed input: 58910.76 toks/s, output: 57.53 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:02<00:00, 57.53it/s, est. speed input: 58910.76 toks/s, output: 57.53 toks/s]
[rank0]:[W128 00:15:05.237774466 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 24.7s

测试结果:
  Requests/s:   53.17
  Tokens/s:     54494.70
  Total Reqs:   128
  Elapsed:      2.41s

  [Prefill 分析]
  Total Prefill Tokens: 131072
  Prefill Tokens/s:     54441.54

============================================================
[3/7] 测试 M=2048
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-INT8                                  │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 2048
│   M_prefill     = 2048 (= 2 x 1024)
│   M_decode      = 2
│   batched_tokens = 2048 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 256
│   --max-num-seqs           = 2
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 2048
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:15:11 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3466048) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3466048) WARNING 01-28 00:15:20 [backends.py:609] Failed to read file <frozen os>
Throughput: 60.72 requests/s, 62239.24 total tokens/s, 60.72 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256


─── STDERR ───
[2026-01-28 00:15:11] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:15:11] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:15:11] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:15:11] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:15:11] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:15:11] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:15:11] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:15:11] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:15:11] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:15:11] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:15:11] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:15:11] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:15:11] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:15:11] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:15:15] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:15:15] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:15:15] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:15:15] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:15:15] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:15:15] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:15:15] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:15:15] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:15:15] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:15:15] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:15:15] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:15:15] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:15:15] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:15:15] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3466048) [2026-01-28 00:15:15] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3466048) [2026-01-28 00:15:15] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3466048) [2026-01-28 00:15:15] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3466048) [2026-01-28 00:15:15] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=3466048) [2026-01-28 00:15:15] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=3466048) [2026-01-28 00:15:15] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=3466048) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3466048) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.56it/s]
(EngineCore_DP0 pid=3466048) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.56it/s]
(EngineCore_DP0 pid=3466048) 
(EngineCore_DP0 pid=3466048) [2026-01-28 00:15:16] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 2560] -> 1D uint8
(EngineCore_DP0 pid=3466048) [2026-01-28 00:15:16] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7372800 bytes
(EngineCore_DP0 pid=3466048) [2026-01-28 00:15:16] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 2560] -> 1D uint8
(EngineCore_DP0 pid=3466048) [2026-01-28 00:15:16] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4915200 bytes
(EngineCore_DP0 pid=3466048) [2026-01-28 00:15:16] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 2560] -> 1D uint8
(EngineCore_DP0 pid=3466048) [2026-01-28 00:15:16] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 26542080 bytes
(EngineCore_DP0 pid=3466048) [2026-01-28 00:15:16] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 6912] -> 1D uint8
(EngineCore_DP0 pid=3466048) [2026-01-28 00:15:16] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 13271040 bytes
(EngineCore_DP0 pid=3466048) 2026-01-28 00:15:26,663 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3466048) 2026-01-28 00:15:26,679 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3466048) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00, 19.04it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00, 19.03it/s]
(EngineCore_DP0 pid=3466048) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 1/2 [00:00<00:00,  6.13it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00,  9.41it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  25%|██▌       | 64/256 [00:00<00:00, 637.66it/s]
Adding requests:  54%|█████▎    | 137/256 [00:00<00:00, 691.63it/s]
Adding requests:  82%|████████▏ | 209/256 [00:00<00:00, 700.38it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 703.48it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   9%|▉         | 24/256 [00:00<00:01, 213.29it/s, est. speed input: 218430.74 toks/s, output: 213.30 toks/s]
Processed prompts:  18%|█▊        | 46/256 [00:00<00:02, 89.39it/s, est. speed input: 100688.72 toks/s, output: 98.33 toks/s]  
Processed prompts:  23%|██▎       | 59/256 [00:00<00:02, 80.66it/s, est. speed input: 91277.38 toks/s, output: 89.14 toks/s] 
Processed prompts:  27%|██▋       | 69/256 [00:00<00:02, 74.63it/s, est. speed input: 85747.88 toks/s, output: 83.74 toks/s]
Processed prompts:  30%|███       | 78/256 [00:00<00:02, 68.73it/s, est. speed input: 81035.41 toks/s, output: 79.14 toks/s]
Processed prompts:  34%|███▎      | 86/256 [00:01<00:02, 66.92it/s, est. speed input: 78979.70 toks/s, output: 77.13 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:01<00:02, 65.50it/s, est. speed input: 77335.24 toks/s, output: 75.52 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:01<00:02, 64.52it/s, est. speed input: 76036.78 toks/s, output: 74.25 toks/s]
Processed prompts:  43%|████▎     | 110/256 [00:01<00:02, 63.65it/s, est. speed input: 74903.61 toks/s, output: 73.15 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:01<00:02, 63.11it/s, est. speed input: 73982.70 toks/s, output: 72.25 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:01<00:02, 62.77it/s, est. speed input: 73210.65 toks/s, output: 71.49 toks/s]
Processed prompts:  52%|█████▏    | 134/256 [00:01<00:01, 62.42it/s, est. speed input: 72512.99 toks/s, output: 70.81 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:02<00:01, 62.21it/s, est. speed input: 71916.82 toks/s, output: 70.23 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:02<00:01, 62.00it/s, est. speed input: 71375.79 toks/s, output: 69.70 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:02<00:01, 61.93it/s, est. speed input: 70913.48 toks/s, output: 69.25 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:02<00:01, 61.91it/s, est. speed input: 70507.57 toks/s, output: 68.85 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:02<00:01, 61.95it/s, est. speed input: 70154.68 toks/s, output: 68.51 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:02<00:01, 61.94it/s, est. speed input: 69826.79 toks/s, output: 68.19 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:02<00:01, 61.89it/s, est. speed input: 69523.34 toks/s, output: 67.89 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:02<00:00, 61.80it/s, est. speed input: 69237.21 toks/s, output: 67.61 toks/s]
Processed prompts:  80%|████████  | 206/256 [00:03<00:00, 61.77it/s, est. speed input: 68980.46 toks/s, output: 67.36 toks/s]
Processed prompts:  84%|████████▎ | 214/256 [00:03<00:00, 61.80it/s, est. speed input: 68751.51 toks/s, output: 67.14 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:03<00:00, 61.88it/s, est. speed input: 68550.00 toks/s, output: 66.94 toks/s]
Processed prompts:  90%|████████▉ | 230/256 [00:03<00:00, 61.84it/s, est. speed input: 68349.29 toks/s, output: 66.75 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:03<00:00, 61.78it/s, est. speed input: 68159.59 toks/s, output: 66.56 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:03<00:00, 61.85it/s, est. speed input: 67997.70 toks/s, output: 66.40 toks/s]
Processed prompts:  99%|█████████▉| 254/256 [00:03<00:00, 61.91it/s, est. speed input: 67847.62 toks/s, output: 66.26 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:03<00:00, 61.91it/s, est. speed input: 68088.02 toks/s, output: 66.49 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:03<00:00, 66.49it/s, est. speed input: 68088.02 toks/s, output: 66.49 toks/s]
[rank0]:[W128 00:15:32.169082103 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 26.8s

测试结果:
  Requests/s:   60.72
  Tokens/s:     62239.24
  Total Reqs:   256
  Elapsed:      4.22s

  [Prefill 分析]
  Total Prefill Tokens: 262144
  Prefill Tokens/s:     62178.52

============================================================
[4/7] 测试 M=4096
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-INT8                                  │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 4096
│   M_prefill     = 4096 (= 4 x 1024)
│   M_decode      = 4
│   batched_tokens = 4096 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 512
│   --max-num-seqs           = 4
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 4096
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:15:38 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3466709) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3466709) WARNING 01-28 00:15:47 [backends.py:609] Failed to read file <frozen os>
Throughput: 60.03 requests/s, 61532.88 total tokens/s, 60.03 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512


─── STDERR ───
[2026-01-28 00:15:38] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:15:38] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:15:38] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:15:38] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:15:38] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:15:38] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:15:38] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:15:38] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:15:38] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:15:38] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:15:38] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:15:38] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:15:38] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:15:38] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:15:42] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:15:42] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:15:42] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:15:42] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:15:42] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:15:42] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:15:42] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:15:42] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:15:42] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:15:42] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:15:42] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:15:42] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:15:42] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:15:42] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3466709) [2026-01-28 00:15:43] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3466709) [2026-01-28 00:15:43] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3466709) [2026-01-28 00:15:43] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3466709) [2026-01-28 00:15:43] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=3466709) [2026-01-28 00:15:43] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=3466709) [2026-01-28 00:15:43] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=3466709) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3466709) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.56it/s]
(EngineCore_DP0 pid=3466709) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.56it/s]
(EngineCore_DP0 pid=3466709) 
(EngineCore_DP0 pid=3466709) [2026-01-28 00:15:43] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 2560] -> 1D uint8
(EngineCore_DP0 pid=3466709) [2026-01-28 00:15:43] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7372800 bytes
(EngineCore_DP0 pid=3466709) [2026-01-28 00:15:43] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 2560] -> 1D uint8
(EngineCore_DP0 pid=3466709) [2026-01-28 00:15:43] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4915200 bytes
(EngineCore_DP0 pid=3466709) [2026-01-28 00:15:43] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 2560] -> 1D uint8
(EngineCore_DP0 pid=3466709) [2026-01-28 00:15:43] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 26542080 bytes
(EngineCore_DP0 pid=3466709) [2026-01-28 00:15:43] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 6912] -> 1D uint8
(EngineCore_DP0 pid=3466709) [2026-01-28 00:15:43] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 13271040 bytes
(EngineCore_DP0 pid=3466709) 2026-01-28 00:15:54,111 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3466709) 2026-01-28 00:15:54,127 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3466709) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  25%|██▌       | 1/4 [00:00<00:00,  8.49it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00, 16.64it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00, 15.52it/s]
(EngineCore_DP0 pid=3466709) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  33%|███▎      | 1/3 [00:00<00:00,  7.36it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00, 14.71it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:  13%|█▎        | 69/512 [00:00<00:00, 684.10it/s]
Adding requests:  28%|██▊       | 145/512 [00:00<00:00, 724.05it/s]
Adding requests:  43%|████▎     | 221/512 [00:00<00:00, 736.52it/s]
Adding requests:  58%|█████▊    | 295/512 [00:00<00:00, 734.52it/s]
Adding requests:  72%|███████▏  | 370/512 [00:00<00:00, 739.59it/s]
Adding requests:  87%|████████▋ | 446/512 [00:00<00:00, 744.86it/s]
Adding requests: 100%|██████████| 512/512 [00:00<00:00, 738.81it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   8%|▊         | 42/512 [00:00<00:01, 334.69it/s, est. speed input: 342757.14 toks/s, output: 334.70 toks/s]
Processed prompts:  15%|█▍        | 76/512 [00:00<00:04, 102.87it/s, est. speed input: 119001.92 toks/s, output: 116.21 toks/s]
Processed prompts:  18%|█▊        | 94/512 [00:00<00:05, 81.97it/s, est. speed input: 97867.59 toks/s, output: 95.57 toks/s]   
Processed prompts:  21%|██        | 107/512 [00:01<00:05, 77.56it/s, est. speed input: 92739.65 toks/s, output: 90.57 toks/s]
Processed prompts:  23%|██▎       | 117/512 [00:01<00:05, 77.13it/s, est. speed input: 91180.98 toks/s, output: 89.04 toks/s]
Processed prompts:  25%|██▍       | 127/512 [00:01<00:05, 69.07it/s, est. speed input: 86046.44 toks/s, output: 84.03 toks/s]
Processed prompts:  26%|██▋       | 135/512 [00:01<00:05, 67.20it/s, est. speed input: 84136.48 toks/s, output: 82.16 toks/s]
Processed prompts:  28%|██▊       | 143/512 [00:01<00:05, 65.60it/s, est. speed input: 82497.98 toks/s, output: 80.56 toks/s]
Processed prompts:  29%|██▉       | 150/512 [00:01<00:05, 62.36it/s, est. speed input: 80547.90 toks/s, output: 78.66 toks/s]
Processed prompts:  31%|███       | 158/512 [00:02<00:05, 61.94it/s, est. speed input: 79369.24 toks/s, output: 77.51 toks/s]
Processed prompts:  32%|███▏      | 166/512 [00:02<00:05, 61.55it/s, est. speed input: 78311.83 toks/s, output: 76.48 toks/s]
Processed prompts:  34%|███▍      | 174/512 [00:02<00:05, 61.37it/s, est. speed input: 77401.79 toks/s, output: 75.59 toks/s]
Processed prompts:  36%|███▌      | 182/512 [00:02<00:05, 61.17it/s, est. speed input: 76574.57 toks/s, output: 74.78 toks/s]
Processed prompts:  37%|███▋      | 190/512 [00:02<00:05, 60.98it/s, est. speed input: 75822.67 toks/s, output: 74.05 toks/s]
Processed prompts:  39%|███▊      | 198/512 [00:02<00:05, 60.86it/s, est. speed input: 75146.72 toks/s, output: 73.39 toks/s]
Processed prompts:  40%|████      | 206/512 [00:02<00:05, 60.70it/s, est. speed input: 74519.65 toks/s, output: 72.77 toks/s]
Processed prompts:  42%|████▏     | 214/512 [00:02<00:04, 60.74it/s, est. speed input: 73977.04 toks/s, output: 72.24 toks/s]
Processed prompts:  43%|████▎     | 222/512 [00:03<00:04, 60.75it/s, est. speed input: 73477.12 toks/s, output: 71.75 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:03<00:04, 60.65it/s, est. speed input: 73000.45 toks/s, output: 71.29 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:03<00:04, 60.66it/s, est. speed input: 72574.41 toks/s, output: 70.87 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:03<00:04, 60.67it/s, est. speed input: 72180.88 toks/s, output: 70.49 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:03<00:04, 60.73it/s, est. speed input: 71822.66 toks/s, output: 70.14 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:03<00:04, 60.66it/s, est. speed input: 71475.72 toks/s, output: 69.80 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:03<00:03, 60.62it/s, est. speed input: 71152.92 toks/s, output: 69.49 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:04<00:03, 60.61it/s, est. speed input: 70853.03 toks/s, output: 69.19 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:04<00:03, 60.58it/s, est. speed input: 70570.19 toks/s, output: 68.92 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:04<00:03, 60.60it/s, est. speed input: 70308.60 toks/s, output: 68.66 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:04<00:03, 60.57it/s, est. speed input: 70058.53 toks/s, output: 68.42 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:04<00:03, 60.61it/s, est. speed input: 69829.87 toks/s, output: 68.19 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:04<00:03, 60.56it/s, est. speed input: 69605.57 toks/s, output: 67.97 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:04<00:03, 60.54it/s, est. speed input: 69395.34 toks/s, output: 67.77 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:04<00:02, 60.57it/s, est. speed input: 69199.74 toks/s, output: 67.58 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:05<00:02, 60.62it/s, est. speed input: 69017.66 toks/s, output: 67.40 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:05<00:02, 60.55it/s, est. speed input: 68835.03 toks/s, output: 67.22 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:05<00:02, 60.61it/s, est. speed input: 68671.46 toks/s, output: 67.06 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:05<00:02, 60.68it/s, est. speed input: 68518.79 toks/s, output: 66.91 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [00:05<00:02, 60.71it/s, est. speed input: 68370.67 toks/s, output: 66.77 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [00:05<00:02, 60.69it/s, est. speed input: 68226.84 toks/s, output: 66.63 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [00:05<00:02, 60.68it/s, est. speed input: 68089.29 toks/s, output: 66.49 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [00:05<00:01, 60.60it/s, est. speed input: 67951.88 toks/s, output: 66.36 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [00:06<00:01, 60.56it/s, est. speed input: 67821.60 toks/s, output: 66.23 toks/s]
Processed prompts:  81%|████████  | 414/512 [00:06<00:01, 60.56it/s, est. speed input: 67699.31 toks/s, output: 66.11 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [00:06<00:01, 60.61it/s, est. speed input: 67585.32 toks/s, output: 66.00 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [00:06<00:01, 60.67it/s, est. speed input: 67478.45 toks/s, output: 65.90 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [00:06<00:01, 60.63it/s, est. speed input: 67369.21 toks/s, output: 65.79 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [00:06<00:01, 60.52it/s, est. speed input: 67258.46 toks/s, output: 65.68 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [00:06<00:00, 60.48it/s, est. speed input: 67154.66 toks/s, output: 65.58 toks/s]
Processed prompts:  90%|█████████ | 462/512 [00:07<00:00, 60.50it/s, est. speed input: 67057.98 toks/s, output: 65.49 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [00:07<00:00, 60.46it/s, est. speed input: 66961.99 toks/s, output: 65.39 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [00:07<00:00, 60.47it/s, est. speed input: 66870.75 toks/s, output: 65.30 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [00:07<00:00, 60.53it/s, est. speed input: 66786.81 toks/s, output: 65.22 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [00:07<00:00, 60.59it/s, est. speed input: 66707.04 toks/s, output: 65.14 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [00:07<00:00, 60.63it/s, est. speed input: 66629.79 toks/s, output: 65.07 toks/s]
Processed prompts: 100%|█████████▉| 510/512 [00:07<00:00, 62.52it/s, est. speed input: 66666.42 toks/s, output: 65.10 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:07<00:00, 62.52it/s, est. speed input: 66927.07 toks/s, output: 65.36 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:07<00:00, 65.36it/s, est. speed input: 66927.07 toks/s, output: 65.36 toks/s]
[rank0]:[W128 00:16:04.016773484 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 31.9s

测试结果:
  Requests/s:   60.03
  Tokens/s:     61532.88
  Total Reqs:   512
  Elapsed:      8.53s

  [Prefill 分析]
  Total Prefill Tokens: 524288
  Prefill Tokens/s:     61472.85

============================================================
[5/7] 测试 M=8192
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-INT8                                  │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 8192
│   M_prefill     = 8192 (= 8 x 1024)
│   M_decode      = 8
│   batched_tokens = 8192 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 1024
│   --max-num-seqs           = 8
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 8192
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:16:12 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3467439) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3467439) WARNING 01-28 00:16:21 [backends.py:609] Failed to read file <frozen os>
Throughput: 56.34 requests/s, 57745.47 total tokens/s, 56.34 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024


─── STDERR ───
[2026-01-28 00:16:11] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:16:12] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:16:12] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:16:12] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:16:12] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:16:12] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:16:12] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:16:12] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:16:12] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:16:12] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:16:12] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:16:12] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:16:12] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:16:12] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:16:15] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:16:15] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:16:15] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:16:15] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:16:15] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:16:15] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:16:15] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:16:15] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:16:15] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:16:15] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:16:15] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:16:15] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:16:15] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:16:15] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3467439) [2026-01-28 00:16:16] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3467439) [2026-01-28 00:16:16] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3467439) [2026-01-28 00:16:16] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3467439) [2026-01-28 00:16:16] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=3467439) [2026-01-28 00:16:16] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=3467439) [2026-01-28 00:16:16] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=3467439) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3467439) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.59it/s]
(EngineCore_DP0 pid=3467439) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.59it/s]
(EngineCore_DP0 pid=3467439) 
(EngineCore_DP0 pid=3467439) [2026-01-28 00:16:17] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 2560] -> 1D uint8
(EngineCore_DP0 pid=3467439) [2026-01-28 00:16:17] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7372800 bytes
(EngineCore_DP0 pid=3467439) [2026-01-28 00:16:17] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 2560] -> 1D uint8
(EngineCore_DP0 pid=3467439) [2026-01-28 00:16:17] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4915200 bytes
(EngineCore_DP0 pid=3467439) [2026-01-28 00:16:17] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 2560] -> 1D uint8
(EngineCore_DP0 pid=3467439) [2026-01-28 00:16:17] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 26542080 bytes
(EngineCore_DP0 pid=3467439) [2026-01-28 00:16:17] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 6912] -> 1D uint8
(EngineCore_DP0 pid=3467439) [2026-01-28 00:16:17] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 13271040 bytes
(EngineCore_DP0 pid=3467439) 2026-01-28 00:16:27,416 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3467439) 2026-01-28 00:16:27,432 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3467439) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:00,  4.37it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  80%|████████  | 4/5 [00:00<00:00, 13.76it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00, 12.82it/s]
(EngineCore_DP0 pid=3467439) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:00,  7.04it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00, 18.27it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00, 16.31it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   7%|▋         | 72/1024 [00:00<00:01, 718.61it/s]
Adding requests:  15%|█▍        | 149/1024 [00:00<00:01, 746.11it/s]
Adding requests:  22%|██▏       | 225/1024 [00:00<00:01, 750.69it/s]
Adding requests:  29%|██▉       | 301/1024 [00:00<00:00, 750.58it/s]
Adding requests:  37%|███▋      | 378/1024 [00:00<00:00, 755.45it/s]
Adding requests:  44%|████▍     | 454/1024 [00:00<00:00, 754.32it/s]
Adding requests:  52%|█████▏    | 530/1024 [00:00<00:00, 737.07it/s]
Adding requests:  59%|█████▉    | 607/1024 [00:00<00:00, 744.93it/s]
Adding requests:  67%|██████▋   | 683/1024 [00:00<00:00, 747.18it/s]
Adding requests:  74%|███████▍  | 759/1024 [00:01<00:00, 750.56it/s]
Adding requests:  82%|████████▏ | 835/1024 [00:01<00:00, 735.40it/s]
Adding requests:  89%|████████▉ | 912/1024 [00:01<00:00, 745.05it/s]
Adding requests:  96%|█████████▋| 988/1024 [00:01<00:00, 748.22it/s]
Adding requests: 100%|██████████| 1024/1024 [00:01<00:00, 747.36it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   7%|▋         | 74/1024 [00:00<00:01, 557.36it/s, est. speed input: 570803.85 toks/s, output: 557.39 toks/s]
Processed prompts:  13%|█▎        | 130/1024 [00:01<00:08, 99.66it/s, est. speed input: 118702.31 toks/s, output: 115.92 toks/s]
Processed prompts:  15%|█▌        | 157/1024 [00:01<00:09, 86.80it/s, est. speed input: 104077.30 toks/s, output: 101.64 toks/s]
Processed prompts:  17%|█▋        | 175/1024 [00:01<00:10, 80.90it/s, est. speed input: 98057.28 toks/s, output: 95.76 toks/s]  
Processed prompts:  18%|█▊        | 188/1024 [00:02<00:11, 71.59it/s, est. speed input: 91239.20 toks/s, output: 89.10 toks/s]
Processed prompts:  19%|█▉        | 198/1024 [00:02<00:11, 71.49it/s, est. speed input: 90074.21 toks/s, output: 87.96 toks/s]
Processed prompts:  20%|██        | 207/1024 [00:02<00:11, 70.03it/s, est. speed input: 88604.11 toks/s, output: 86.53 toks/s]
Processed prompts:  21%|██        | 216/1024 [00:02<00:11, 68.67it/s, est. speed input: 87290.57 toks/s, output: 85.24 toks/s]
Processed prompts:  22%|██▏       | 224/1024 [00:02<00:12, 65.86it/s, est. speed input: 85732.11 toks/s, output: 83.72 toks/s]
Processed prompts:  23%|██▎       | 231/1024 [00:02<00:12, 61.80it/s, est. speed input: 83972.11 toks/s, output: 82.00 toks/s]
Processed prompts:  23%|██▎       | 238/1024 [00:02<00:13, 58.57it/s, est. speed input: 82379.44 toks/s, output: 80.45 toks/s]
Processed prompts:  24%|██▍       | 244/1024 [00:03<00:14, 54.17it/s, est. speed input: 80599.72 toks/s, output: 78.71 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:03<00:15, 50.90it/s, est. speed input: 78983.40 toks/s, output: 77.13 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:03<00:14, 52.54it/s, est. speed input: 78106.95 toks/s, output: 76.28 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:03<00:14, 53.72it/s, est. speed input: 77299.84 toks/s, output: 75.49 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:03<00:13, 54.58it/s, est. speed input: 76556.23 toks/s, output: 74.76 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:03<00:13, 55.17it/s, est. speed input: 75865.85 toks/s, output: 74.09 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:03<00:13, 55.58it/s, est. speed input: 75222.23 toks/s, output: 73.46 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:04<00:12, 55.87it/s, est. speed input: 74623.35 toks/s, output: 72.87 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:04<00:12, 56.11it/s, est. speed input: 74069.42 toks/s, output: 72.33 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:04<00:12, 56.29it/s, est. speed input: 73552.76 toks/s, output: 71.83 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:04<00:12, 56.35it/s, est. speed input: 73060.86 toks/s, output: 71.35 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:04<00:12, 56.41it/s, est. speed input: 72599.38 toks/s, output: 70.90 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:04<00:12, 56.47it/s, est. speed input: 72169.20 toks/s, output: 70.48 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:04<00:12, 56.50it/s, est. speed input: 71760.59 toks/s, output: 70.08 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:05<00:11, 56.54it/s, est. speed input: 71377.45 toks/s, output: 69.70 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:05<00:11, 56.58it/s, est. speed input: 71016.39 toks/s, output: 69.35 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:05<00:11, 56.60it/s, est. speed input: 70673.75 toks/s, output: 69.02 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:05<00:11, 56.58it/s, est. speed input: 70345.40 toks/s, output: 68.70 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:05<00:11, 56.57it/s, est. speed input: 70033.06 toks/s, output: 68.39 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [00:05<00:11, 56.57it/s, est. speed input: 69737.84 toks/s, output: 68.10 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:05<00:11, 56.52it/s, est. speed input: 69450.87 toks/s, output: 67.82 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:06<00:10, 56.53it/s, est. speed input: 69181.50 toks/s, output: 67.56 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:06<00:10, 56.53it/s, est. speed input: 68924.05 toks/s, output: 67.31 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:06<00:10, 56.54it/s, est. speed input: 68679.36 toks/s, output: 67.07 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:06<00:10, 56.56it/s, est. speed input: 68445.89 toks/s, output: 66.84 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:06<00:10, 56.54it/s, est. speed input: 68219.49 toks/s, output: 66.62 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:06<00:10, 56.55it/s, est. speed input: 68004.84 toks/s, output: 66.41 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:06<00:10, 56.53it/s, est. speed input: 67797.05 toks/s, output: 66.21 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:07<00:09, 56.56it/s, est. speed input: 67600.53 toks/s, output: 66.02 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:07<00:09, 56.60it/s, est. speed input: 67413.65 toks/s, output: 65.83 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:07<00:09, 56.62it/s, est. speed input: 67233.26 toks/s, output: 65.66 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:07<00:09, 56.61it/s, est. speed input: 67058.79 toks/s, output: 65.49 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:07<00:09, 56.63it/s, est. speed input: 66890.25 toks/s, output: 65.32 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:07<00:09, 56.65it/s, est. speed input: 66730.05 toks/s, output: 65.17 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:07<00:09, 56.63it/s, est. speed input: 66572.46 toks/s, output: 65.01 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:08<00:08, 56.58it/s, est. speed input: 66418.39 toks/s, output: 64.86 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:08<00:08, 56.55it/s, est. speed input: 66270.40 toks/s, output: 64.72 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:08<00:08, 56.58it/s, est. speed input: 66129.88 toks/s, output: 64.58 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:08<00:08, 56.56it/s, est. speed input: 65992.02 toks/s, output: 64.45 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:08<00:08, 56.55it/s, est. speed input: 65858.58 toks/s, output: 64.31 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:08<00:08, 56.51it/s, est. speed input: 65727.81 toks/s, output: 64.19 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:08<00:08, 56.53it/s, est. speed input: 65603.84 toks/s, output: 64.07 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:09<00:07, 56.50it/s, est. speed input: 65481.24 toks/s, output: 63.95 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:09<00:07, 56.49it/s, est. speed input: 65363.27 toks/s, output: 63.83 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:09<00:07, 56.52it/s, est. speed input: 65250.56 toks/s, output: 63.72 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:09<00:07, 56.56it/s, est. speed input: 65142.81 toks/s, output: 63.62 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:09<00:07, 56.58it/s, est. speed input: 65037.25 toks/s, output: 63.51 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:09<00:07, 56.59it/s, est. speed input: 64934.65 toks/s, output: 63.41 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:09<00:07, 56.63it/s, est. speed input: 64836.92 toks/s, output: 63.32 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:10<00:06, 56.58it/s, est. speed input: 64738.06 toks/s, output: 63.22 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:10<00:06, 56.57it/s, est. speed input: 64643.00 toks/s, output: 63.13 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:10<00:06, 56.58it/s, est. speed input: 64551.19 toks/s, output: 63.04 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:10<00:06, 56.60it/s, est. speed input: 64462.94 toks/s, output: 62.95 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:10<00:06, 56.62it/s, est. speed input: 64377.15 toks/s, output: 62.87 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:10<00:06, 56.58it/s, est. speed input: 64290.95 toks/s, output: 62.78 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:10<00:06, 56.57it/s, est. speed input: 64208.05 toks/s, output: 62.70 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:11<00:05, 56.53it/s, est. speed input: 64125.37 toks/s, output: 62.62 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:11<00:05, 56.52it/s, est. speed input: 64045.71 toks/s, output: 62.54 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:11<00:05, 56.53it/s, est. speed input: 63969.18 toks/s, output: 62.47 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:11<00:05, 56.51it/s, est. speed input: 63892.80 toks/s, output: 62.40 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:11<00:05, 56.52it/s, est. speed input: 63819.47 toks/s, output: 62.32 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:11<00:05, 56.52it/s, est. speed input: 63747.69 toks/s, output: 62.25 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:11<00:05, 56.54it/s, est. speed input: 63678.75 toks/s, output: 62.19 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:12<00:04, 56.51it/s, est. speed input: 63609.38 toks/s, output: 62.12 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:12<00:04, 56.48it/s, est. speed input: 63541.01 toks/s, output: 62.05 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:12<00:04, 56.50it/s, est. speed input: 63476.29 toks/s, output: 61.99 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:12<00:04, 56.55it/s, est. speed input: 63414.21 toks/s, output: 61.93 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:12<00:04, 56.57it/s, est. speed input: 63353.06 toks/s, output: 61.87 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:12<00:04, 56.57it/s, est. speed input: 63292.64 toks/s, output: 61.81 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:12<00:04, 56.52it/s, est. speed input: 63231.80 toks/s, output: 61.75 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:13<00:03, 56.47it/s, est. speed input: 63171.48 toks/s, output: 61.69 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:13<00:03, 56.49it/s, est. speed input: 63114.38 toks/s, output: 61.64 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:13<00:03, 56.52it/s, est. speed input: 63059.57 toks/s, output: 61.58 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:13<00:03, 56.55it/s, est. speed input: 63005.97 toks/s, output: 61.53 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:13<00:03, 56.57it/s, est. speed input: 62953.65 toks/s, output: 61.48 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [00:13<00:03, 56.59it/s, est. speed input: 62902.62 toks/s, output: 61.43 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [00:13<00:03, 56.60it/s, est. speed input: 62852.31 toks/s, output: 61.38 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:13<00:02, 56.56it/s, est. speed input: 62801.54 toks/s, output: 61.33 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [00:14<00:02, 56.57it/s, est. speed input: 62752.82 toks/s, output: 61.28 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [00:14<00:02, 56.55it/s, est. speed input: 62704.40 toks/s, output: 61.23 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [00:14<00:02, 56.56it/s, est. speed input: 62657.56 toks/s, output: 61.19 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [00:14<00:02, 56.54it/s, est. speed input: 62611.01 toks/s, output: 61.14 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [00:14<00:02, 56.53it/s, est. speed input: 62565.33 toks/s, output: 61.10 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [00:14<00:02, 56.53it/s, est. speed input: 62520.77 toks/s, output: 61.06 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [00:14<00:01, 56.50it/s, est. speed input: 62475.88 toks/s, output: 61.01 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [00:15<00:01, 56.48it/s, est. speed input: 62431.91 toks/s, output: 60.97 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [00:15<00:01, 56.52it/s, est. speed input: 62390.44 toks/s, output: 60.93 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [00:15<00:01, 56.56it/s, est. speed input: 62350.26 toks/s, output: 60.89 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [00:15<00:01, 56.57it/s, est. speed input: 62310.23 toks/s, output: 60.85 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [00:15<00:01, 56.58it/s, est. speed input: 62270.94 toks/s, output: 60.81 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [00:15<00:01, 56.60it/s, est. speed input: 62232.98 toks/s, output: 60.77 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [00:15<00:00, 56.55it/s, est. speed input: 62193.67 toks/s, output: 60.74 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [00:16<00:00, 56.53it/s, est. speed input: 62155.26 toks/s, output: 60.70 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [00:16<00:00, 56.52it/s, est. speed input: 62117.84 toks/s, output: 60.66 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [00:16<00:00, 56.51it/s, est. speed input: 62080.78 toks/s, output: 60.63 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [00:16<00:00, 56.54it/s, est. speed input: 62045.70 toks/s, output: 60.59 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [00:16<00:00, 56.54it/s, est. speed input: 62010.46 toks/s, output: 60.56 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [00:16<00:00, 58.43it/s, est. speed input: 62032.09 toks/s, output: 60.58 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:16<00:00, 58.43it/s, est. speed input: 62397.23 toks/s, output: 60.93 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:16<00:00, 60.93it/s, est. speed input: 62397.23 toks/s, output: 60.93 toks/s]
[rank0]:[W128 00:16:47.210827977 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 43.2s

测试结果:
  Requests/s:   56.34
  Tokens/s:     57745.47
  Total Reqs:   1024
  Elapsed:      18.18s

  [Prefill 分析]
  Total Prefill Tokens: 1048576
  Prefill Tokens/s:     57689.13

============================================================
[6/7] 测试 M=16384
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-INT8                                  │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 16384
│   M_prefill     = 16384 (= 16 x 1024)
│   M_decode      = 16
│   batched_tokens = 16384 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 2048
│   --max-num-seqs           = 16
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 16384
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:16:58 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3468353) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3468353) WARNING 01-28 00:17:07 [backends.py:609] Failed to read file <frozen os>
Throughput: 55.06 requests/s, 56438.76 total tokens/s, 55.06 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048


─── STDERR ───
[2026-01-28 00:16:58] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:16:58] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:16:58] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:16:58] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:16:58] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:16:58] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:16:58] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:16:58] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:16:58] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:16:58] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:16:58] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:16:58] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:16:58] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:16:58] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:17:01] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:17:02] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:17:02] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:17:02] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:17:02] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:17:02] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:17:02] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:17:02] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:17:02] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:17:02] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:17:02] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:17:02] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:17:02] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:17:02] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3468353) [2026-01-28 00:17:02] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3468353) [2026-01-28 00:17:02] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3468353) [2026-01-28 00:17:02] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3468353) [2026-01-28 00:17:02] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=3468353) [2026-01-28 00:17:02] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=3468353) [2026-01-28 00:17:02] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=3468353) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3468353) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.60it/s]
(EngineCore_DP0 pid=3468353) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.60it/s]
(EngineCore_DP0 pid=3468353) 
(EngineCore_DP0 pid=3468353) [2026-01-28 00:17:03] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 2560] -> 1D uint8
(EngineCore_DP0 pid=3468353) [2026-01-28 00:17:03] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7372800 bytes
(EngineCore_DP0 pid=3468353) [2026-01-28 00:17:03] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 2560] -> 1D uint8
(EngineCore_DP0 pid=3468353) [2026-01-28 00:17:03] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4915200 bytes
(EngineCore_DP0 pid=3468353) [2026-01-28 00:17:03] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 2560] -> 1D uint8
(EngineCore_DP0 pid=3468353) [2026-01-28 00:17:03] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 26542080 bytes
(EngineCore_DP0 pid=3468353) [2026-01-28 00:17:03] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 6912] -> 1D uint8
(EngineCore_DP0 pid=3468353) [2026-01-28 00:17:03] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 13271040 bytes
(EngineCore_DP0 pid=3468353) 2026-01-28 00:17:13,755 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3468353) 2026-01-28 00:17:13,772 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3468353) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  29%|██▊       | 2/7 [00:00<00:00, 18.86it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  71%|███████▏  | 5/7 [00:00<00:00, 24.13it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00, 23.30it/s]
(EngineCore_DP0 pid=3468353) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  20%|██        | 1/5 [00:00<00:00,  7.45it/s]
Capturing CUDA graphs (decode, FULL):  80%|████████  | 4/5 [00:00<00:00, 18.98it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00, 18.64it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   3%|▎         | 71/2048 [00:00<00:02, 703.04it/s]
Adding requests:   7%|▋         | 148/2048 [00:00<00:02, 736.46it/s]
Adding requests:  11%|█         | 226/2048 [00:00<00:02, 752.29it/s]
Adding requests:  15%|█▍        | 303/2048 [00:00<00:02, 755.87it/s]
Adding requests:  19%|█▊        | 379/2048 [00:00<00:02, 755.41it/s]
Adding requests:  22%|██▏       | 457/2048 [00:00<00:02, 762.80it/s]
Adding requests:  26%|██▌       | 534/2048 [00:00<00:02, 751.97it/s]
Adding requests:  30%|██▉       | 613/2048 [00:00<00:01, 761.74it/s]
Adding requests:  34%|███▎      | 690/2048 [00:00<00:01, 758.13it/s]
Adding requests:  37%|███▋      | 767/2048 [00:01<00:01, 760.04it/s]
Adding requests:  41%|████      | 844/2048 [00:01<00:01, 745.61it/s]
Adding requests:  45%|████▌     | 925/2048 [00:01<00:01, 761.62it/s]
Adding requests:  49%|████▉     | 1002/2048 [00:01<00:01, 760.82it/s]
Adding requests:  53%|█████▎    | 1080/2048 [00:01<00:01, 764.26it/s]
Adding requests:  56%|█████▋    | 1157/2048 [00:01<00:01, 762.55it/s]
Adding requests:  60%|██████    | 1236/2048 [00:01<00:01, 768.57it/s]
Adding requests:  64%|██████▍   | 1313/2048 [00:01<00:00, 764.18it/s]
Adding requests:  68%|██████▊   | 1393/2048 [00:01<00:00, 772.68it/s]
Adding requests:  72%|███████▏  | 1471/2048 [00:01<00:00, 768.94it/s]
Adding requests:  76%|███████▌  | 1549/2048 [00:02<00:00, 771.71it/s]
Adding requests:  80%|███████▉  | 1629/2048 [00:02<00:00, 777.65it/s]
Adding requests:  83%|████████▎ | 1707/2048 [00:02<00:00, 772.73it/s]
Adding requests:  87%|████████▋ | 1785/2048 [00:02<00:00, 773.10it/s]
Adding requests:  91%|█████████ | 1863/2048 [00:02<00:00, 759.60it/s]
Adding requests:  95%|█████████▍| 1941/2048 [00:02<00:00, 763.18it/s]
Adding requests:  99%|█████████▊| 2018/2048 [00:02<00:00, 759.85it/s]
Adding requests: 100%|██████████| 2048/2048 [00:02<00:00, 761.80it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   7%|▋         | 146/2048 [00:00<00:03, 503.38it/s, est. speed input: 515496.77 toks/s, output: 503.39 toks/s]
Processed prompts:  10%|▉         | 197/2048 [00:01<00:12, 142.83it/s, est. speed input: 173961.32 toks/s, output: 169.88 toks/s]
Processed prompts:  11%|█         | 222/2048 [00:01<00:14, 127.04it/s, est. speed input: 156809.12 toks/s, output: 153.13 toks/s]
Processed prompts:  12%|█▏        | 240/2048 [00:01<00:16, 108.58it/s, est. speed input: 141291.75 toks/s, output: 137.98 toks/s]
Processed prompts:  12%|█▏        | 253/2048 [00:02<00:19, 90.18it/s, est. speed input: 127683.73 toks/s, output: 124.69 toks/s] 
Processed prompts:  13%|█▎        | 263/2048 [00:02<00:24, 73.92it/s, est. speed input: 116149.31 toks/s, output: 113.43 toks/s]
Processed prompts:  13%|█▎        | 274/2048 [00:02<00:28, 63.32it/s, est. speed input: 107559.28 toks/s, output: 105.04 toks/s]
Processed prompts:  14%|█▍        | 290/2048 [00:02<00:28, 60.91it/s, est. speed input: 102457.12 toks/s, output: 100.06 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [00:03<00:29, 59.23it/s, est. speed input: 98287.55 toks/s, output: 95.98 toks/s]  
Processed prompts:  16%|█▌        | 322/2048 [00:03<00:29, 58.02it/s, est. speed input: 94802.94 toks/s, output: 92.58 toks/s]
Processed prompts:  17%|█▋        | 338/2048 [00:03<00:29, 57.18it/s, est. speed input: 91857.77 toks/s, output: 89.70 toks/s]
Processed prompts:  17%|█▋        | 354/2048 [00:04<00:30, 56.42it/s, est. speed input: 89269.98 toks/s, output: 87.18 toks/s]
Processed prompts:  18%|█▊        | 370/2048 [00:04<00:29, 56.06it/s, est. speed input: 87091.43 toks/s, output: 85.05 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [00:04<00:29, 55.79it/s, est. speed input: 85178.29 toks/s, output: 83.18 toks/s]
Processed prompts:  20%|█▉        | 402/2048 [00:04<00:29, 55.61it/s, est. speed input: 83492.71 toks/s, output: 81.54 toks/s]
Processed prompts:  20%|██        | 418/2048 [00:05<00:29, 55.50it/s, est. speed input: 81998.02 toks/s, output: 80.08 toks/s]
Processed prompts:  21%|██        | 434/2048 [00:05<00:29, 55.40it/s, est. speed input: 80655.35 toks/s, output: 78.76 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [00:05<00:28, 55.32it/s, est. speed input: 79445.57 toks/s, output: 77.58 toks/s]
Processed prompts:  23%|██▎       | 466/2048 [00:06<00:28, 55.28it/s, est. speed input: 78352.94 toks/s, output: 76.52 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [00:06<00:28, 55.24it/s, est. speed input: 77357.61 toks/s, output: 75.54 toks/s]
Processed prompts:  24%|██▍       | 498/2048 [00:06<00:28, 55.22it/s, est. speed input: 76450.46 toks/s, output: 74.66 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [00:06<00:27, 55.20it/s, est. speed input: 75618.00 toks/s, output: 73.85 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [00:07<00:27, 55.20it/s, est. speed input: 74855.55 toks/s, output: 73.10 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [00:07<00:27, 55.18it/s, est. speed input: 74146.65 toks/s, output: 72.41 toks/s]
Processed prompts:  27%|██▋       | 562/2048 [00:07<00:26, 55.18it/s, est. speed input: 73493.33 toks/s, output: 71.77 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [00:08<00:26, 55.16it/s, est. speed input: 72884.25 toks/s, output: 71.18 toks/s]
Processed prompts:  29%|██▉       | 594/2048 [00:08<00:26, 55.15it/s, est. speed input: 72317.03 toks/s, output: 70.62 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [00:08<00:26, 55.15it/s, est. speed input: 71788.18 toks/s, output: 70.11 toks/s]
Processed prompts:  31%|███       | 626/2048 [00:08<00:25, 55.16it/s, est. speed input: 71295.91 toks/s, output: 69.62 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [00:09<00:25, 55.15it/s, est. speed input: 70831.81 toks/s, output: 69.17 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [00:09<00:25, 55.14it/s, est. speed input: 70395.54 toks/s, output: 68.75 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [00:09<00:24, 55.15it/s, est. speed input: 69986.05 toks/s, output: 68.35 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [00:10<00:24, 55.14it/s, est. speed input: 69599.17 toks/s, output: 67.97 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [00:10<00:24, 55.12it/s, est. speed input: 69232.21 toks/s, output: 67.61 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [00:10<00:24, 55.14it/s, est. speed input: 68888.41 toks/s, output: 67.27 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [00:11<00:23, 55.16it/s, est. speed input: 68563.79 toks/s, output: 66.96 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [00:11<00:23, 55.15it/s, est. speed input: 68252.88 toks/s, output: 66.65 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [00:11<00:23, 55.13it/s, est. speed input: 67956.59 toks/s, output: 66.36 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [00:11<00:22, 55.14it/s, est. speed input: 67676.79 toks/s, output: 66.09 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [00:12<00:22, 55.15it/s, est. speed input: 67410.21 toks/s, output: 65.83 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [00:12<00:22, 55.13it/s, est. speed input: 67154.52 toks/s, output: 65.58 toks/s]
Processed prompts:  41%|████      | 834/2048 [00:12<00:22, 55.13it/s, est. speed input: 66910.98 toks/s, output: 65.34 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [00:13<00:21, 55.15it/s, est. speed input: 66680.10 toks/s, output: 65.12 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [00:13<00:21, 55.15it/s, est. speed input: 66458.40 toks/s, output: 64.90 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [00:13<00:21, 55.13it/s, est. speed input: 66244.49 toks/s, output: 64.69 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [00:13<00:20, 55.14it/s, est. speed input: 66041.06 toks/s, output: 64.49 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [00:14<00:20, 55.15it/s, est. speed input: 65846.52 toks/s, output: 64.30 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [00:14<00:20, 55.13it/s, est. speed input: 65657.42 toks/s, output: 64.12 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [00:14<00:19, 55.15it/s, est. speed input: 65478.63 toks/s, output: 63.94 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [00:15<00:19, 55.15it/s, est. speed input: 65305.19 toks/s, output: 63.77 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [00:15<00:19, 55.13it/s, est. speed input: 65137.36 toks/s, output: 63.61 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [00:15<00:19, 55.12it/s, est. speed input: 64975.92 toks/s, output: 63.45 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [00:15<00:18, 55.12it/s, est. speed input: 64820.11 toks/s, output: 63.30 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [00:16<00:18, 55.12it/s, est. speed input: 64670.52 toks/s, output: 63.15 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [00:16<00:18, 55.10it/s, est. speed input: 64524.88 toks/s, output: 63.01 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [00:16<00:17, 55.12it/s, est. speed input: 64386.09 toks/s, output: 62.88 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [00:17<00:17, 55.12it/s, est. speed input: 64251.56 toks/s, output: 62.75 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [00:17<00:17, 55.11it/s, est. speed input: 64120.42 toks/s, output: 62.62 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [00:17<00:17, 55.10it/s, est. speed input: 63993.79 toks/s, output: 62.49 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [00:17<00:16, 55.11it/s, est. speed input: 63872.20 toks/s, output: 62.38 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [00:18<00:16, 55.10it/s, est. speed input: 63753.14 toks/s, output: 62.26 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [00:18<00:15, 55.95it/s, est. speed input: 63688.95 toks/s, output: 62.20 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [00:18<00:15, 55.70it/s, est. speed input: 63577.78 toks/s, output: 62.09 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [00:19<00:15, 55.53it/s, est. speed input: 63469.66 toks/s, output: 61.98 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [00:19<00:15, 55.39it/s, est. speed input: 63363.94 toks/s, output: 61.88 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [00:19<00:15, 55.31it/s, est. speed input: 63261.85 toks/s, output: 61.78 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [00:20<00:14, 55.25it/s, est. speed input: 63162.68 toks/s, output: 61.68 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [00:20<00:14, 55.22it/s, est. speed input: 63066.98 toks/s, output: 61.59 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [00:20<00:14, 55.17it/s, est. speed input: 62972.40 toks/s, output: 61.50 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [00:20<00:13, 55.15it/s, est. speed input: 62881.44 toks/s, output: 61.41 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [00:21<00:13, 55.14it/s, est. speed input: 62793.25 toks/s, output: 61.32 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [00:21<00:13, 55.11it/s, est. speed input: 62706.06 toks/s, output: 61.24 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [00:21<00:13, 55.10it/s, est. speed input: 62621.68 toks/s, output: 61.15 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [00:22<00:12, 55.10it/s, est. speed input: 62540.28 toks/s, output: 61.07 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [00:22<00:12, 55.10it/s, est. speed input: 62460.40 toks/s, output: 61.00 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [00:22<00:12, 55.05it/s, est. speed input: 62380.76 toks/s, output: 60.92 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [00:22<00:11, 55.07it/s, est. speed input: 62305.36 toks/s, output: 60.85 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [00:23<00:11, 55.08it/s, est. speed input: 62231.69 toks/s, output: 60.77 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [00:23<00:11, 55.09it/s, est. speed input: 62160.17 toks/s, output: 60.70 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [00:23<00:11, 55.08it/s, est. speed input: 62089.48 toks/s, output: 60.63 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [00:24<00:10, 55.06it/s, est. speed input: 62019.72 toks/s, output: 60.57 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [00:24<00:10, 55.04it/s, est. speed input: 61951.76 toks/s, output: 60.50 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [00:24<00:10, 55.05it/s, est. speed input: 61886.10 toks/s, output: 60.44 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [00:24<00:09, 55.06it/s, est. speed input: 61822.17 toks/s, output: 60.37 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [00:25<00:09, 55.08it/s, est. speed input: 61760.47 toks/s, output: 60.31 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [00:25<00:09, 55.06it/s, est. speed input: 61698.74 toks/s, output: 60.25 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [00:25<00:08, 55.05it/s, est. speed input: 61638.59 toks/s, output: 60.19 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [00:26<00:08, 55.06it/s, est. speed input: 61580.13 toks/s, output: 60.14 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [00:26<00:08, 55.05it/s, est. speed input: 61522.47 toks/s, output: 60.08 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [00:26<00:08, 55.05it/s, est. speed input: 61466.56 toks/s, output: 60.03 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [00:26<00:07, 55.05it/s, est. speed input: 61411.44 toks/s, output: 59.97 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [00:27<00:07, 55.05it/s, est. speed input: 61357.91 toks/s, output: 59.92 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [00:27<00:07, 55.03it/s, est. speed input: 61304.34 toks/s, output: 59.87 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [00:27<00:06, 55.03it/s, est. speed input: 61252.69 toks/s, output: 59.82 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [00:28<00:06, 55.02it/s, est. speed input: 61201.83 toks/s, output: 59.77 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [00:28<00:06, 55.02it/s, est. speed input: 61152.14 toks/s, output: 59.72 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [00:28<00:06, 55.04it/s, est. speed input: 61104.14 toks/s, output: 59.67 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [00:29<00:05, 55.05it/s, est. speed input: 61056.81 toks/s, output: 59.63 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [00:29<00:05, 55.06it/s, est. speed input: 61010.77 toks/s, output: 59.58 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [00:29<00:05, 55.02it/s, est. speed input: 60963.76 toks/s, output: 59.53 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [00:29<00:04, 55.03it/s, est. speed input: 60919.22 toks/s, output: 59.49 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [00:30<00:04, 55.04it/s, est. speed input: 60875.55 toks/s, output: 59.45 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [00:30<00:04, 55.03it/s, est. speed input: 60832.21 toks/s, output: 59.41 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [00:30<00:04, 55.03it/s, est. speed input: 60789.93 toks/s, output: 59.37 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [00:31<00:03, 55.05it/s, est. speed input: 60748.89 toks/s, output: 59.33 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [00:31<00:03, 55.07it/s, est. speed input: 60709.01 toks/s, output: 59.29 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [00:31<00:03, 56.05it/s, est. speed input: 60701.91 toks/s, output: 59.28 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [00:31<00:02, 55.73it/s, est. speed input: 60661.99 toks/s, output: 59.24 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [00:32<00:02, 55.53it/s, est. speed input: 60623.47 toks/s, output: 59.20 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [00:32<00:02, 55.38it/s, est. speed input: 60585.10 toks/s, output: 59.17 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [00:32<00:01, 55.27it/s, est. speed input: 60547.42 toks/s, output: 59.13 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [00:33<00:01, 55.20it/s, est. speed input: 60510.72 toks/s, output: 59.09 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [00:33<00:01, 55.13it/s, est. speed input: 60473.81 toks/s, output: 59.06 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [00:33<00:01, 55.10it/s, est. speed input: 60438.07 toks/s, output: 59.02 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [00:33<00:00, 55.08it/s, est. speed input: 60403.18 toks/s, output: 58.99 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [00:34<00:00, 55.07it/s, est. speed input: 60368.84 toks/s, output: 58.95 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [00:34<00:00, 56.00it/s, est. speed input: 60363.57 toks/s, output: 58.95 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:34<00:00, 56.00it/s, est. speed input: 60778.73 toks/s, output: 59.35 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:34<00:00, 59.35it/s, est. speed input: 60778.73 toks/s, output: 59.35 toks/s]
[rank0]:[W128 00:17:52.481882590 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 65.3s

测试结果:
  Requests/s:   55.06
  Tokens/s:     56438.76
  Total Reqs:   2048
  Elapsed:      37.19s

  [Prefill 分析]
  Total Prefill Tokens: 2097152
  Prefill Tokens/s:     56383.70

============================================================
[7/7] 测试 M=32768
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-INT8                                  │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 32768
│   M_prefill     = 32768 (= 32 x 1024)
│   M_decode      = 32
│   batched_tokens = 32768 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 4096
│   --max-num-seqs           = 32
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 32768
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:18:08 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3469613) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3469613) WARNING 01-28 00:18:18 [backends.py:609] Failed to read file <frozen os>
Throughput: 54.86 requests/s, 56227.92 total tokens/s, 54.86 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096


─── STDERR ───
[2026-01-28 00:18:08] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:18:08] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:18:08] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:18:08] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:18:08] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:18:08] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:18:08] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:18:08] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:18:08] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:18:08] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:18:08] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:18:08] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:18:08] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:18:08] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:18:12] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:18:12] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:18:12] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:18:12] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:18:12] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:18:12] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:18:12] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:18:12] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:18:12] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:18:12] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:18:12] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:18:12] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:18:12] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:18:12] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3469613) [2026-01-28 00:18:13] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3469613) [2026-01-28 00:18:13] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3469613) [2026-01-28 00:18:13] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3469613) [2026-01-28 00:18:13] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=3469613) [2026-01-28 00:18:13] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=3469613) [2026-01-28 00:18:13] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=3469613) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3469613) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.58it/s]
(EngineCore_DP0 pid=3469613) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  3.58it/s]
(EngineCore_DP0 pid=3469613) 
(EngineCore_DP0 pid=3469613) [2026-01-28 00:18:13] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 2560] -> 1D uint8
(EngineCore_DP0 pid=3469613) [2026-01-28 00:18:14] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7372800 bytes
(EngineCore_DP0 pid=3469613) [2026-01-28 00:18:14] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 2560] -> 1D uint8
(EngineCore_DP0 pid=3469613) [2026-01-28 00:18:14] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4915200 bytes
(EngineCore_DP0 pid=3469613) [2026-01-28 00:18:14] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 2560] -> 1D uint8
(EngineCore_DP0 pid=3469613) [2026-01-28 00:18:14] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 26542080 bytes
(EngineCore_DP0 pid=3469613) [2026-01-28 00:18:14] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 6912] -> 1D uint8
(EngineCore_DP0 pid=3469613) [2026-01-28 00:18:14] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 13271040 bytes
(EngineCore_DP0 pid=3469613) [rank0]:W0128 00:18:21.052000 3469613 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=3469613) [rank0]:W0128 00:18:21.100000 3469613 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=3469613) [rank0]:W0128 00:18:21.777000 3469613 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=3469613) [rank0]:W0128 00:18:21.853000 3469613 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=3469613) 2026-01-28 00:18:24,510 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3469613) 2026-01-28 00:18:24,528 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3469613) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   9%|▉         | 1/11 [00:00<00:03,  3.13it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  36%|███▋      | 4/11 [00:00<00:00, 10.89it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  64%|██████▎   | 7/11 [00:00<00:00, 15.76it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  91%|█████████ | 10/11 [00:00<00:00, 19.08it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:00<00:00, 15.32it/s]
(EngineCore_DP0 pid=3469613) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  14%|█▍        | 1/7 [00:00<00:00,  7.29it/s]
Capturing CUDA graphs (decode, FULL):  57%|█████▋    | 4/7 [00:00<00:00, 18.48it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00, 23.06it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00, 20.37it/s]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 72/4096 [00:00<00:05, 716.18it/s]
Adding requests:   4%|▎         | 148/4096 [00:00<00:05, 739.87it/s]
Adding requests:   5%|▌         | 224/4096 [00:00<00:05, 748.30it/s]
Adding requests:   7%|▋         | 299/4096 [00:00<00:05, 737.14it/s]
Adding requests:   9%|▉         | 375/4096 [00:00<00:05, 743.18it/s]
Adding requests:  11%|█         | 452/4096 [00:00<00:04, 749.86it/s]
Adding requests:  13%|█▎        | 528/4096 [00:00<00:04, 737.79it/s]
Adding requests:  15%|█▍        | 605/4096 [00:00<00:04, 746.40it/s]
Adding requests:  17%|█▋        | 685/4096 [00:00<00:04, 760.96it/s]
Adding requests:  19%|█▊        | 762/4096 [00:01<00:04, 755.43it/s]
Adding requests:  20%|██        | 838/4096 [00:01<00:04, 742.69it/s]
Adding requests:  22%|██▏       | 917/4096 [00:01<00:04, 755.51it/s]
Adding requests:  24%|██▍       | 993/4096 [00:01<00:04, 753.46it/s]
Adding requests:  26%|██▌       | 1069/4096 [00:01<00:04, 754.31it/s]
Adding requests:  28%|██▊       | 1145/4096 [00:01<00:04, 730.90it/s]
Adding requests:  30%|██▉       | 1225/4096 [00:01<00:03, 748.38it/s]
Adding requests:  32%|███▏      | 1300/4096 [00:01<00:03, 747.99it/s]
Adding requests:  34%|███▎      | 1378/4096 [00:01<00:03, 756.79it/s]
Adding requests:  36%|███▌      | 1456/4096 [00:01<00:03, 762.62it/s]
Adding requests:  37%|███▋      | 1534/4096 [00:02<00:03, 767.77it/s]
Adding requests:  39%|███▉      | 1611/4096 [00:02<00:03, 766.46it/s]
Adding requests:  41%|████      | 1688/4096 [00:02<00:03, 764.18it/s]
Adding requests:  43%|████▎     | 1766/4096 [00:02<00:03, 767.13it/s]
Adding requests:  45%|████▌     | 1845/4096 [00:02<00:02, 773.85it/s]
Adding requests:  47%|████▋     | 1923/4096 [00:02<00:02, 772.67it/s]
Adding requests:  49%|████▉     | 2002/4096 [00:02<00:02, 777.64it/s]
Adding requests:  51%|█████     | 2082/4096 [00:02<00:02, 783.48it/s]
Adding requests:  53%|█████▎    | 2161/4096 [00:02<00:02, 767.37it/s]
Adding requests:  55%|█████▍    | 2239/4096 [00:02<00:02, 770.50it/s]
Adding requests:  57%|█████▋    | 2317/4096 [00:03<00:02, 757.99it/s]
Adding requests:  58%|█████▊    | 2393/4096 [00:03<00:02, 756.95it/s]
Adding requests:  60%|██████    | 2470/4096 [00:03<00:02, 758.94it/s]
Adding requests:  62%|██████▏   | 2546/4096 [00:03<00:02, 752.25it/s]
Adding requests:  64%|██████▍   | 2623/4096 [00:03<00:01, 755.36it/s]
Adding requests:  66%|██████▌   | 2699/4096 [00:03<00:01, 750.06it/s]
Adding requests:  68%|██████▊   | 2775/4096 [00:03<00:01, 748.88it/s]
Adding requests:  70%|██████▉   | 2851/4096 [00:03<00:01, 752.11it/s]
Adding requests:  71%|███████▏  | 2927/4096 [00:03<00:01, 751.77it/s]
Adding requests:  73%|███████▎  | 3003/4096 [00:03<00:01, 747.52it/s]
Adding requests:  75%|███████▌  | 3079/4096 [00:04<00:01, 750.34it/s]
Adding requests:  77%|███████▋  | 3155/4096 [00:04<00:01, 752.84it/s]
Adding requests:  79%|███████▉  | 3231/4096 [00:04<00:01, 752.42it/s]
Adding requests:  81%|████████  | 3310/4096 [00:04<00:01, 762.10it/s]
Adding requests:  83%|████████▎ | 3388/4096 [00:04<00:00, 767.40it/s]
Adding requests:  85%|████████▍ | 3465/4096 [00:04<00:00, 760.07it/s]
Adding requests:  86%|████████▋ | 3543/4096 [00:04<00:00, 764.60it/s]
Adding requests:  88%|████████▊ | 3620/4096 [00:04<00:00, 762.97it/s]
Adding requests:  90%|█████████ | 3697/4096 [00:04<00:00, 748.89it/s]
Adding requests:  92%|█████████▏| 3776/4096 [00:04<00:00, 760.44it/s]
Adding requests:  94%|█████████▍| 3855/4096 [00:05<00:00, 769.15it/s]
Adding requests:  96%|█████████▌| 3932/4096 [00:05<00:00, 769.35it/s]
Adding requests:  98%|█████████▊| 4010/4096 [00:05<00:00, 769.81it/s]
Adding requests: 100%|█████████▉| 4088/4096 [00:05<00:00, 760.70it/s]
Adding requests: 100%|██████████| 4096/4096 [00:05<00:00, 757.34it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   7%|▋         | 290/4096 [00:00<00:06, 586.23it/s, est. speed input: 600313.43 toks/s, output: 586.23 toks/s]
Processed prompts:   9%|▊         | 349/4096 [00:01<00:13, 282.32it/s, est. speed input: 332006.86 toks/s, output: 324.22 toks/s]
Processed prompts:   9%|▉         | 380/4096 [00:01<00:21, 174.07it/s, est. speed input: 234625.36 toks/s, output: 229.13 toks/s]
Processed prompts:  10%|▉         | 399/4096 [00:02<00:31, 117.14it/s, est. speed input: 182427.34 toks/s, output: 178.15 toks/s]
Processed prompts:  10%|█         | 418/4096 [00:02<00:42, 86.27it/s, est. speed input: 151705.99 toks/s, output: 148.15 toks/s] 
Processed prompts:  11%|█         | 450/4096 [00:03<00:48, 75.53it/s, est. speed input: 135386.51 toks/s, output: 132.21 toks/s]
Processed prompts:  12%|█▏        | 482/4096 [00:03<00:52, 68.77it/s, est. speed input: 123838.51 toks/s, output: 120.94 toks/s]
Processed prompts:  13%|█▎        | 514/4096 [00:04<00:55, 64.37it/s, est. speed input: 115234.29 toks/s, output: 112.53 toks/s]
Processed prompts:  13%|█▎        | 546/4096 [00:05<00:57, 61.43it/s, est. speed input: 108576.01 toks/s, output: 106.03 toks/s]
Processed prompts:  14%|█▍        | 578/4096 [00:05<00:59, 59.43it/s, est. speed input: 103267.19 toks/s, output: 100.85 toks/s]
Processed prompts:  15%|█▍        | 610/4096 [00:06<01:00, 58.07it/s, est. speed input: 98939.25 toks/s, output: 96.62 toks/s]  
Processed prompts:  16%|█▌        | 642/4096 [00:06<01:00, 57.12it/s, est. speed input: 95337.34 toks/s, output: 93.10 toks/s]
Processed prompts:  16%|█▋        | 674/4096 [00:07<01:00, 56.46it/s, est. speed input: 92293.33 toks/s, output: 90.13 toks/s]
Processed prompts:  17%|█▋        | 706/4096 [00:08<01:00, 56.03it/s, est. speed input: 89699.18 toks/s, output: 87.60 toks/s]
Processed prompts:  18%|█▊        | 738/4096 [00:08<01:00, 55.70it/s, est. speed input: 87445.91 toks/s, output: 85.40 toks/s]
Processed prompts:  19%|█▉        | 770/4096 [00:09<00:59, 55.49it/s, est. speed input: 85482.68 toks/s, output: 83.48 toks/s]
Processed prompts:  20%|█▉        | 802/4096 [00:09<00:59, 55.33it/s, est. speed input: 83747.73 toks/s, output: 81.78 toks/s]
Processed prompts:  20%|██        | 834/4096 [00:10<00:59, 55.21it/s, est. speed input: 82205.83 toks/s, output: 80.28 toks/s]
Processed prompts:  21%|██        | 866/4096 [00:10<00:58, 55.14it/s, est. speed input: 80832.29 toks/s, output: 78.94 toks/s]
Processed prompts:  22%|██▏       | 898/4096 [00:11<00:58, 55.08it/s, est. speed input: 79592.72 toks/s, output: 77.73 toks/s]
Processed prompts:  23%|██▎       | 930/4096 [00:12<00:57, 55.05it/s, est. speed input: 78474.61 toks/s, output: 76.64 toks/s]
Processed prompts:  23%|██▎       | 962/4096 [00:12<00:56, 55.00it/s, est. speed input: 77454.54 toks/s, output: 75.64 toks/s]
Processed prompts:  24%|██▍       | 994/4096 [00:13<00:56, 54.99it/s, est. speed input: 76527.09 toks/s, output: 74.73 toks/s]
Processed prompts:  25%|██▌       | 1026/4096 [00:13<00:55, 54.96it/s, est. speed input: 75675.04 toks/s, output: 73.90 toks/s]
Processed prompts:  26%|██▌       | 1058/4096 [00:14<00:55, 54.97it/s, est. speed input: 74894.80 toks/s, output: 73.14 toks/s]
Processed prompts:  27%|██▋       | 1090/4096 [00:15<00:54, 54.94it/s, est. speed input: 74170.05 toks/s, output: 72.43 toks/s]
Processed prompts:  27%|██▋       | 1122/4096 [00:15<00:54, 54.93it/s, est. speed input: 73500.39 toks/s, output: 71.78 toks/s]
Processed prompts:  28%|██▊       | 1154/4096 [00:16<00:53, 55.37it/s, est. speed input: 72951.25 toks/s, output: 71.24 toks/s]
Processed prompts:  29%|██▉       | 1186/4096 [00:16<00:52, 55.23it/s, est. speed input: 72369.49 toks/s, output: 70.67 toks/s]
Processed prompts:  30%|██▉       | 1218/4096 [00:17<00:52, 55.12it/s, est. speed input: 71826.23 toks/s, output: 70.14 toks/s]
Processed prompts:  31%|███       | 1250/4096 [00:17<00:51, 55.05it/s, est. speed input: 71318.29 toks/s, output: 69.65 toks/s]
Processed prompts:  31%|███▏      | 1282/4096 [00:18<00:51, 55.00it/s, est. speed input: 70842.72 toks/s, output: 69.18 toks/s]
Processed prompts:  32%|███▏      | 1314/4096 [00:19<00:50, 54.97it/s, est. speed input: 70396.83 toks/s, output: 68.75 toks/s]
Processed prompts:  33%|███▎      | 1346/4096 [00:19<00:50, 54.93it/s, est. speed input: 69975.12 toks/s, output: 68.34 toks/s]
Processed prompts:  34%|███▎      | 1378/4096 [00:20<00:49, 54.87it/s, est. speed input: 69572.90 toks/s, output: 67.94 toks/s]
Processed prompts:  34%|███▍      | 1410/4096 [00:20<00:48, 54.87it/s, est. speed input: 69199.35 toks/s, output: 67.58 toks/s]
Processed prompts:  35%|███▌      | 1442/4096 [00:21<00:48, 54.86it/s, est. speed input: 68844.38 toks/s, output: 67.23 toks/s]
Processed prompts:  36%|███▌      | 1474/4096 [00:22<00:47, 54.87it/s, est. speed input: 68510.45 toks/s, output: 66.90 toks/s]
Processed prompts:  37%|███▋      | 1506/4096 [00:22<00:47, 54.86it/s, est. speed input: 68190.96 toks/s, output: 66.59 toks/s]
Processed prompts:  38%|███▊      | 1538/4096 [00:23<00:46, 54.86it/s, est. speed input: 67889.13 toks/s, output: 66.30 toks/s]
Processed prompts:  38%|███▊      | 1570/4096 [00:23<00:46, 54.87it/s, est. speed input: 67602.64 toks/s, output: 66.02 toks/s]
Processed prompts:  39%|███▉      | 1602/4096 [00:24<00:45, 54.87it/s, est. speed input: 67329.18 toks/s, output: 65.75 toks/s]
Processed prompts:  40%|███▉      | 1634/4096 [00:24<00:44, 54.86it/s, est. speed input: 67068.32 toks/s, output: 65.50 toks/s]
Processed prompts:  41%|████      | 1666/4096 [00:25<00:44, 54.86it/s, est. speed input: 66818.95 toks/s, output: 65.25 toks/s]
Processed prompts:  41%|████▏     | 1698/4096 [00:26<00:43, 54.86it/s, est. speed input: 66581.86 toks/s, output: 65.02 toks/s]
Processed prompts:  42%|████▏     | 1730/4096 [00:26<00:43, 54.85it/s, est. speed input: 66353.23 toks/s, output: 64.80 toks/s]
Processed prompts:  43%|████▎     | 1762/4096 [00:27<00:42, 54.85it/s, est. speed input: 66135.45 toks/s, output: 64.59 toks/s]
Processed prompts:  44%|████▍     | 1794/4096 [00:27<00:41, 54.85it/s, est. speed input: 65926.62 toks/s, output: 64.38 toks/s]
Processed prompts:  45%|████▍     | 1826/4096 [00:28<00:41, 54.84it/s, est. speed input: 65725.87 toks/s, output: 64.19 toks/s]
Processed prompts:  45%|████▌     | 1858/4096 [00:29<00:40, 55.33it/s, est. speed input: 65572.38 toks/s, output: 64.04 toks/s]
Processed prompts:  46%|████▌     | 1890/4096 [00:29<00:39, 55.18it/s, est. speed input: 65386.16 toks/s, output: 63.85 toks/s]
Processed prompts:  47%|████▋     | 1922/4096 [00:30<00:39, 55.08it/s, est. speed input: 65208.46 toks/s, output: 63.68 toks/s]
Processed prompts:  48%|████▊     | 1954/4096 [00:30<00:38, 55.01it/s, est. speed input: 65036.75 toks/s, output: 63.51 toks/s]
Processed prompts:  48%|████▊     | 1986/4096 [00:31<00:38, 54.97it/s, est. speed input: 64871.93 toks/s, output: 63.35 toks/s]
Processed prompts:  49%|████▉     | 2018/4096 [00:31<00:37, 54.92it/s, est. speed input: 64712.36 toks/s, output: 63.20 toks/s]
Processed prompts:  50%|█████     | 2050/4096 [00:32<00:37, 54.90it/s, est. speed input: 64559.15 toks/s, output: 63.05 toks/s]
Processed prompts:  51%|█████     | 2082/4096 [00:33<00:36, 54.87it/s, est. speed input: 64410.21 toks/s, output: 62.90 toks/s]
Processed prompts:  52%|█████▏    | 2114/4096 [00:33<00:36, 54.86it/s, est. speed input: 64266.85 toks/s, output: 62.76 toks/s]
Processed prompts:  52%|█████▏    | 2146/4096 [00:34<00:35, 54.87it/s, est. speed input: 64129.79 toks/s, output: 62.63 toks/s]
Processed prompts:  53%|█████▎    | 2178/4096 [00:34<00:34, 54.84it/s, est. speed input: 63995.15 toks/s, output: 62.50 toks/s]
Processed prompts:  54%|█████▍    | 2210/4096 [00:35<00:34, 54.84it/s, est. speed input: 63866.01 toks/s, output: 62.37 toks/s]
Processed prompts:  55%|█████▍    | 2242/4096 [00:36<00:33, 54.84it/s, est. speed input: 63741.19 toks/s, output: 62.25 toks/s]
Processed prompts:  56%|█████▌    | 2274/4096 [00:36<00:33, 54.83it/s, est. speed input: 63619.60 toks/s, output: 62.13 toks/s]
Processed prompts:  56%|█████▋    | 2306/4096 [00:37<00:32, 54.84it/s, est. speed input: 63502.66 toks/s, output: 62.01 toks/s]
Processed prompts:  57%|█████▋    | 2338/4096 [00:37<00:32, 54.83it/s, est. speed input: 63388.49 toks/s, output: 61.90 toks/s]
Processed prompts:  58%|█████▊    | 2370/4096 [00:38<00:31, 54.82it/s, est. speed input: 63278.08 toks/s, output: 61.79 toks/s]
Processed prompts:  59%|█████▊    | 2402/4096 [00:38<00:30, 54.82it/s, est. speed input: 63170.81 toks/s, output: 61.69 toks/s]
Processed prompts:  59%|█████▉    | 2434/4096 [00:39<00:30, 54.82it/s, est. speed input: 63066.95 toks/s, output: 61.59 toks/s]
Processed prompts:  60%|██████    | 2466/4096 [00:40<00:29, 54.82it/s, est. speed input: 62965.91 toks/s, output: 61.49 toks/s]
Processed prompts:  61%|██████    | 2498/4096 [00:40<00:28, 55.29it/s, est. speed input: 62893.63 toks/s, output: 61.42 toks/s]
Processed prompts:  62%|██████▏   | 2530/4096 [00:41<00:28, 55.15it/s, est. speed input: 62798.00 toks/s, output: 61.33 toks/s]
Processed prompts:  63%|██████▎   | 2562/4096 [00:41<00:27, 55.04it/s, est. speed input: 62704.56 toks/s, output: 61.23 toks/s]
Processed prompts:  63%|██████▎   | 2594/4096 [00:42<00:27, 54.97it/s, est. speed input: 62613.94 toks/s, output: 61.15 toks/s]
Processed prompts:  64%|██████▍   | 2626/4096 [00:43<00:26, 54.92it/s, est. speed input: 62525.88 toks/s, output: 61.06 toks/s]
Processed prompts:  65%|██████▍   | 2658/4096 [00:43<00:26, 54.88it/s, est. speed input: 62439.56 toks/s, output: 60.98 toks/s]
Processed prompts:  66%|██████▌   | 2690/4096 [00:44<00:25, 54.86it/s, est. speed input: 62356.16 toks/s, output: 60.89 toks/s]
Processed prompts:  66%|██████▋   | 2722/4096 [00:44<00:25, 54.84it/s, est. speed input: 62274.61 toks/s, output: 60.82 toks/s]
Processed prompts:  67%|██████▋   | 2754/4096 [00:45<00:24, 54.84it/s, est. speed input: 62195.79 toks/s, output: 60.74 toks/s]
Processed prompts:  68%|██████▊   | 2786/4096 [00:45<00:23, 54.81it/s, est. speed input: 62117.74 toks/s, output: 60.66 toks/s]
Processed prompts:  69%|██████▉   | 2818/4096 [00:46<00:23, 54.80it/s, est. speed input: 62042.03 toks/s, output: 60.59 toks/s]
Processed prompts:  70%|██████▉   | 2850/4096 [00:47<00:22, 54.80it/s, est. speed input: 61968.73 toks/s, output: 60.52 toks/s]
Processed prompts:  70%|███████   | 2882/4096 [00:47<00:22, 54.80it/s, est. speed input: 61896.72 toks/s, output: 60.45 toks/s]
Processed prompts:  71%|███████   | 2914/4096 [00:48<00:21, 54.80it/s, est. speed input: 61826.93 toks/s, output: 60.38 toks/s]
Processed prompts:  72%|███████▏  | 2946/4096 [00:48<00:20, 54.79it/s, est. speed input: 61758.38 toks/s, output: 60.31 toks/s]
Processed prompts:  73%|███████▎  | 2978/4096 [00:49<00:20, 54.79it/s, est. speed input: 61691.37 toks/s, output: 60.25 toks/s]
Processed prompts:  73%|███████▎  | 3010/4096 [00:50<00:19, 54.80it/s, est. speed input: 61626.50 toks/s, output: 60.18 toks/s]
Processed prompts:  74%|███████▍  | 3042/4096 [00:50<00:19, 54.80it/s, est. speed input: 61563.05 toks/s, output: 60.12 toks/s]
Processed prompts:  75%|███████▌  | 3074/4096 [00:51<00:18, 54.80it/s, est. speed input: 61500.70 toks/s, output: 60.06 toks/s]
Processed prompts:  76%|███████▌  | 3106/4096 [00:51<00:18, 54.78it/s, est. speed input: 61439.40 toks/s, output: 60.00 toks/s]
Processed prompts:  77%|███████▋  | 3138/4096 [00:52<00:17, 54.79it/s, est. speed input: 61380.00 toks/s, output: 59.94 toks/s]
Processed prompts:  77%|███████▋  | 3170/4096 [00:52<00:16, 54.78it/s, est. speed input: 61321.43 toks/s, output: 59.88 toks/s]
Processed prompts:  78%|███████▊  | 3202/4096 [00:53<00:16, 54.79it/s, est. speed input: 61264.59 toks/s, output: 59.83 toks/s]
Processed prompts:  79%|███████▉  | 3234/4096 [00:54<00:15, 54.81it/s, est. speed input: 61209.75 toks/s, output: 59.78 toks/s]
Processed prompts:  80%|███████▉  | 3266/4096 [00:54<00:15, 54.79it/s, est. speed input: 61154.61 toks/s, output: 59.72 toks/s]
Processed prompts:  81%|████████  | 3298/4096 [00:55<00:14, 54.80it/s, est. speed input: 61101.56 toks/s, output: 59.67 toks/s]
Processed prompts:  81%|████████▏ | 3330/4096 [00:55<00:13, 54.79it/s, est. speed input: 61049.15 toks/s, output: 59.62 toks/s]
Processed prompts:  82%|████████▏ | 3362/4096 [00:56<00:13, 54.78it/s, est. speed input: 60997.74 toks/s, output: 59.57 toks/s]
Processed prompts:  83%|████████▎ | 3394/4096 [00:57<00:12, 54.78it/s, est. speed input: 60947.35 toks/s, output: 59.52 toks/s]
Processed prompts:  84%|████████▎ | 3426/4096 [00:57<00:12, 54.79it/s, est. speed input: 60898.48 toks/s, output: 59.47 toks/s]
Processed prompts:  84%|████████▍ | 3458/4096 [00:58<00:11, 54.79it/s, est. speed input: 60850.52 toks/s, output: 59.42 toks/s]
Processed prompts:  85%|████████▌ | 3490/4096 [00:58<00:11, 54.78it/s, est. speed input: 60802.93 toks/s, output: 59.38 toks/s]
Processed prompts:  86%|████████▌ | 3522/4096 [00:59<00:10, 54.79it/s, est. speed input: 60756.83 toks/s, output: 59.33 toks/s]
Processed prompts:  87%|████████▋ | 3554/4096 [00:59<00:09, 54.79it/s, est. speed input: 60711.50 toks/s, output: 59.29 toks/s]
Processed prompts:  88%|████████▊ | 3586/4096 [01:00<00:09, 54.78it/s, est. speed input: 60666.82 toks/s, output: 59.24 toks/s]
Processed prompts:  88%|████████▊ | 3618/4096 [01:01<00:08, 54.79it/s, est. speed input: 60623.27 toks/s, output: 59.20 toks/s]
Processed prompts:  89%|████████▉ | 3650/4096 [01:01<00:08, 54.77it/s, est. speed input: 60579.75 toks/s, output: 59.16 toks/s]
Processed prompts:  90%|████████▉ | 3682/4096 [01:02<00:07, 54.78it/s, est. speed input: 60537.98 toks/s, output: 59.12 toks/s]
Processed prompts:  91%|█████████ | 3714/4096 [01:02<00:06, 54.79it/s, est. speed input: 60497.10 toks/s, output: 59.08 toks/s]
Processed prompts:  91%|█████████▏| 3746/4096 [01:03<00:06, 54.77it/s, est. speed input: 60455.94 toks/s, output: 59.04 toks/s]
Processed prompts:  92%|█████████▏| 3778/4096 [01:04<00:05, 54.78it/s, est. speed input: 60416.41 toks/s, output: 59.00 toks/s]
Processed prompts:  93%|█████████▎| 3810/4096 [01:04<00:05, 54.77it/s, est. speed input: 60376.92 toks/s, output: 58.96 toks/s]
Processed prompts:  94%|█████████▍| 3842/4096 [01:05<00:04, 54.77it/s, est. speed input: 60338.57 toks/s, output: 58.92 toks/s]
Processed prompts:  95%|█████████▍| 3874/4096 [01:05<00:04, 54.77it/s, est. speed input: 60300.73 toks/s, output: 58.89 toks/s]
Processed prompts:  95%|█████████▌| 3906/4096 [01:06<00:03, 54.78it/s, est. speed input: 60263.98 toks/s, output: 58.85 toks/s]
Processed prompts:  96%|█████████▌| 3938/4096 [01:06<00:02, 54.77it/s, est. speed input: 60227.42 toks/s, output: 58.82 toks/s]
Processed prompts:  97%|█████████▋| 3970/4096 [01:07<00:02, 54.77it/s, est. speed input: 60191.39 toks/s, output: 58.78 toks/s]
Processed prompts:  98%|█████████▊| 4002/4096 [01:08<00:01, 54.77it/s, est. speed input: 60156.08 toks/s, output: 58.75 toks/s]
Processed prompts:  98%|█████████▊| 4034/4096 [01:08<00:01, 55.24it/s, est. speed input: 60136.14 toks/s, output: 58.73 toks/s]
Processed prompts:  99%|█████████▉| 4066/4096 [01:09<00:00, 55.62it/s, est. speed input: 60117.53 toks/s, output: 58.71 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [01:09<00:00, 55.62it/s, est. speed input: 60560.84 toks/s, output: 59.14 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [01:09<00:00, 59.14it/s, est. speed input: 60560.84 toks/s, output: 59.14 toks/s]
[rank0]:[W128 00:19:41.236033306 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 108.7s

测试结果:
  Requests/s:   54.86
  Tokens/s:     56227.92
  Total Reqs:   4096
  Elapsed:      74.67s

  [Prefill 分析]
  Total Prefill Tokens: 4194304
  Prefill Tokens/s:     56173.06


------------------------------------------------------------
  生成 CSV: BitNet-2B-INT8
------------------------------------------------------------
[SUCCESS] CSV 保存到: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX5080_cc120_INT8_py312_cu129_x86_64/cusparselt/2_4/BitNet-2B-INT8_prefill.csv

预览:
------------------------------------------------------------
M_prefill,prompt_len,max_num_seqs,num_prompts,N_prefill,requests_per_s,tokens_per_s,elapsed_time_s
512,512,1,128,128,55.3046,28371.2531,2.3145
1024,1024,1,128,128,53.1656,54494.7047,2.4076
2048,1024,2,256,128,60.7212,62239.2434,4.2160
4096,1024,4,512,128,60.0321,61532.8791,8.5288
8192,1024,8,1024,128,56.3370,57745.4650,18.1763
16384,1024,16,2048,128,55.0622,56438.7611,37.1943
32768,1024,32,4096,128,54.8565,56227.9180,74.6675

------------------------------------------------------------

[INFO] 完成: 7 成功, 0 失败

============================================================
  BitNet-2B-INT8 | cuSPARSELt (2_6) | prefill
============================================================

[INFO] Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_6
[INFO] Output: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX5080_cc120_INT8_py312_cu129_x86_64/cusparselt/2_6

============================================================
[1/7] 测试 M=512
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-INT8                                  │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 512
│   M_prefill     = 512 (= 1 x 512)
│   M_decode      = 1
│   batched_tokens = 513 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 512
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 513
│   --max-num-batched-tokens = 513
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:19:46 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3471216) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3471216) WARNING 01-28 00:19:55 [backends.py:609] Failed to read file <frozen os>
Throughput: 54.95 requests/s, 28188.79 total tokens/s, 54.95 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128


─── STDERR ───
[2026-01-28 00:19:46] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:19:46] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:19:46] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:19:46] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:19:46] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:19:46] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:19:46] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:19:46] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:19:46] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:19:46] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:19:46] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:19:46] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:19:46] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:19:46] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:19:50] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:19:50] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:19:50] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:19:50] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:19:50] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:19:50] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:19:50] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:19:50] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:19:50] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:19:50] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:19:50] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:19:50] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:19:50] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:19:50] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3471216) [2026-01-28 00:19:50] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3471216) [2026-01-28 00:19:50] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3471216) [2026-01-28 00:19:50] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3471216) [2026-01-28 00:19:50] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=3471216) [2026-01-28 00:19:50] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=3471216) [2026-01-28 00:19:50] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=3471216) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3471216) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.90it/s]
(EngineCore_DP0 pid=3471216) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.90it/s]
(EngineCore_DP0 pid=3471216) 
(EngineCore_DP0 pid=3471216) [2026-01-28 00:19:51] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 3424] -> 1D uint8
(EngineCore_DP0 pid=3471216) [2026-01-28 00:19:51] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9891840 bytes
(EngineCore_DP0 pid=3471216) [2026-01-28 00:19:51] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 3424] -> 1D uint8
(EngineCore_DP0 pid=3471216) [2026-01-28 00:19:51] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 6594560 bytes
(EngineCore_DP0 pid=3471216) [2026-01-28 00:19:51] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 3424] -> 1D uint8
(EngineCore_DP0 pid=3471216) [2026-01-28 00:19:51] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 35610624 bytes
(EngineCore_DP0 pid=3471216) [2026-01-28 00:19:51] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 9216] -> 1D uint8
(EngineCore_DP0 pid=3471216) [2026-01-28 00:19:51] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 17694720 bytes
(EngineCore_DP0 pid=3471216) 2026-01-28 00:20:01,838 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3471216) 2026-01-28 00:20:01,853 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3471216) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  3.75it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  3.88it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  3.86it/s]
(EngineCore_DP0 pid=3471216) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.39it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.38it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  88%|████████▊ | 112/128 [00:00<00:00, 1112.80it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 1132.65it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:22,  5.57it/s, est. speed input: 2850.30 toks/s, output: 5.57 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:00<00:03, 32.17it/s, est. speed input: 13966.49 toks/s, output: 27.28 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:00<00:02, 44.36it/s, est. speed input: 18963.77 toks/s, output: 37.04 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:00<00:02, 51.17it/s, est. speed input: 21839.63 toks/s, output: 42.65 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:00<00:01, 55.06it/s, est. speed input: 23652.60 toks/s, output: 46.20 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:00<00:01, 57.43it/s, est. speed input: 24900.49 toks/s, output: 48.63 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:00<00:01, 58.17it/s, est. speed input: 25590.36 toks/s, output: 49.98 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:00<00:01, 59.62it/s, est. speed input: 26354.26 toks/s, output: 51.47 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:01<00:01, 60.50it/s, est. speed input: 26944.79 toks/s, output: 52.63 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:01<00:01, 60.94it/s, est. speed input: 27401.15 toks/s, output: 53.52 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:01<00:00, 61.53it/s, est. speed input: 27814.74 toks/s, output: 54.33 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:01<00:00, 61.90it/s, est. speed input: 28158.71 toks/s, output: 55.00 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:01<00:00, 62.12it/s, est. speed input: 28446.79 toks/s, output: 55.56 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:01<00:00, 62.24it/s, est. speed input: 28693.21 toks/s, output: 56.04 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:01<00:00, 62.43it/s, est. speed input: 28917.65 toks/s, output: 56.48 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:01<00:00, 62.39it/s, est. speed input: 29098.56 toks/s, output: 56.83 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:01<00:00, 62.22it/s, est. speed input: 29246.12 toks/s, output: 57.12 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:02<00:00, 62.46it/s, est. speed input: 29408.20 toks/s, output: 57.44 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:02<00:00, 62.69it/s, est. speed input: 29558.42 toks/s, output: 57.73 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:02<00:00, 62.69it/s, est. speed input: 29592.81 toks/s, output: 57.80 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:02<00:00, 57.80it/s, est. speed input: 29592.81 toks/s, output: 57.80 toks/s]
[rank0]:[W128 00:20:05.727060062 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 24.6s

测试结果:
  Requests/s:   54.95
  Tokens/s:     28188.79
  Total Reqs:   128
  Elapsed:      2.33s

  [Prefill 分析]
  Total Prefill Tokens: 65536
  Prefill Tokens/s:     28133.84

============================================================
[2/7] 测试 M=1024
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-INT8                                  │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 1024
│   M_prefill     = 1024 (= 1 x 1024)
│   M_decode      = 1
│   batched_tokens = 1025 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 1025
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:20:11 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3471892) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3471892) WARNING 01-28 00:20:20 [backends.py:609] Failed to read file <frozen os>
Throughput: 45.50 requests/s, 46634.28 total tokens/s, 45.50 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128


─── STDERR ───
[2026-01-28 00:20:11] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:20:11] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:20:11] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:20:11] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:20:11] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:20:11] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:20:11] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:20:11] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:20:11] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:20:11] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:20:11] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:20:11] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:20:11] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:20:11] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:20:15] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:20:15] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:20:15] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:20:15] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:20:15] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:20:15] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:20:15] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:20:15] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:20:15] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:20:15] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:20:15] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:20:15] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:20:15] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:20:15] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3471892) [2026-01-28 00:20:16] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3471892) [2026-01-28 00:20:16] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3471892) [2026-01-28 00:20:16] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3471892) [2026-01-28 00:20:16] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=3471892) [2026-01-28 00:20:16] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=3471892) [2026-01-28 00:20:16] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=3471892) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3471892) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.83it/s]
(EngineCore_DP0 pid=3471892) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.83it/s]
(EngineCore_DP0 pid=3471892) 
(EngineCore_DP0 pid=3471892) [2026-01-28 00:20:16] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 3424] -> 1D uint8
(EngineCore_DP0 pid=3471892) [2026-01-28 00:20:16] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9891840 bytes
(EngineCore_DP0 pid=3471892) [2026-01-28 00:20:16] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 3424] -> 1D uint8
(EngineCore_DP0 pid=3471892) [2026-01-28 00:20:16] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 6594560 bytes
(EngineCore_DP0 pid=3471892) [2026-01-28 00:20:16] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 3424] -> 1D uint8
(EngineCore_DP0 pid=3471892) [2026-01-28 00:20:16] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 35610624 bytes
(EngineCore_DP0 pid=3471892) [2026-01-28 00:20:16] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 9216] -> 1D uint8
(EngineCore_DP0 pid=3471892) [2026-01-28 00:20:16] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 17694720 bytes
(EngineCore_DP0 pid=3471892) 2026-01-28 00:20:26,958 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3471892) 2026-01-28 00:20:26,974 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3471892) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00, 12.70it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00, 12.69it/s]
(EngineCore_DP0 pid=3471892) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  6.57it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  6.57it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  50%|█████     | 64/128 [00:00<00:00, 633.15it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 679.85it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:04, 26.67it/s, est. speed input: 27311.95 toks/s, output: 26.67 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:00<00:03, 39.58it/s, est. speed input: 38442.70 toks/s, output: 37.54 toks/s]
Processed prompts:  10%|█         | 13/128 [00:00<00:02, 44.14it/s, est. speed input: 42474.06 toks/s, output: 41.48 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:00<00:02, 46.28it/s, est. speed input: 44507.41 toks/s, output: 43.46 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:00<00:02, 47.51it/s, est. speed input: 45758.11 toks/s, output: 44.68 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:00<00:02, 48.31it/s, est. speed input: 46625.82 toks/s, output: 45.53 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:00<00:01, 48.80it/s, est. speed input: 47241.66 toks/s, output: 46.13 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:00<00:01, 49.11it/s, est. speed input: 47700.30 toks/s, output: 46.58 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:00<00:01, 49.35it/s, est. speed input: 48069.12 toks/s, output: 46.94 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:01<00:01, 49.38it/s, est. speed input: 48324.86 toks/s, output: 47.19 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:01<00:01, 49.51it/s, est. speed input: 48566.13 toks/s, output: 47.43 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:01<00:01, 49.59it/s, est. speed input: 48763.96 toks/s, output: 47.62 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:01<00:01, 49.66it/s, est. speed input: 48934.55 toks/s, output: 47.79 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:01<00:01, 49.68it/s, est. speed input: 49076.39 toks/s, output: 47.93 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:01<00:01, 49.62it/s, est. speed input: 49182.13 toks/s, output: 48.03 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:01<00:01, 49.68it/s, est. speed input: 49295.50 toks/s, output: 48.14 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:01<00:00, 49.82it/s, est. speed input: 49433.08 toks/s, output: 48.27 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:01<00:00, 49.87it/s, est. speed input: 49546.46 toks/s, output: 48.38 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:01<00:00, 49.80it/s, est. speed input: 49611.62 toks/s, output: 48.45 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:02<00:00, 49.79it/s, est. speed input: 49675.86 toks/s, output: 48.51 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:02<00:00, 49.78it/s, est. speed input: 49735.33 toks/s, output: 48.57 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:02<00:00, 49.83it/s, est. speed input: 49808.91 toks/s, output: 48.64 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:02<00:00, 49.81it/s, est. speed input: 49857.46 toks/s, output: 48.69 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:02<00:00, 49.79it/s, est. speed input: 49900.52 toks/s, output: 48.73 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:02<00:00, 49.80it/s, est. speed input: 49943.75 toks/s, output: 48.77 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:02<00:00, 49.80it/s, est. speed input: 49965.50 toks/s, output: 48.79 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:02<00:00, 48.79it/s, est. speed input: 49965.50 toks/s, output: 48.79 toks/s]
[rank0]:[W128 00:20:31.992028323 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 25.1s

测试结果:
  Requests/s:   45.50
  Tokens/s:     46634.28
  Total Reqs:   128
  Elapsed:      2.81s

  [Prefill 分析]
  Total Prefill Tokens: 131072
  Prefill Tokens/s:     46588.78

============================================================
[3/7] 测试 M=2048
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-INT8                                  │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 2048
│   M_prefill     = 2048 (= 2 x 1024)
│   M_decode      = 2
│   batched_tokens = 2048 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 256
│   --max-num-seqs           = 2
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 2048
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:20:36 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3472542) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3472542) WARNING 01-28 00:20:46 [backends.py:609] Failed to read file <frozen os>
Throughput: 49.24 requests/s, 50468.17 total tokens/s, 49.24 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256


─── STDERR ───
[2026-01-28 00:20:36] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:20:36] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:20:36] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:20:36] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:20:36] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:20:36] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:20:36] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:20:36] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:20:36] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:20:36] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:20:36] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:20:36] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:20:36] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:20:36] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:20:40] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:20:40] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:20:40] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:20:40] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:20:40] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:20:40] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:20:40] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:20:40] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:20:40] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:20:40] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:20:40] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:20:40] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:20:40] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:20:40] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3472542) [2026-01-28 00:20:41] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3472542) [2026-01-28 00:20:41] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3472542) [2026-01-28 00:20:41] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3472542) [2026-01-28 00:20:41] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=3472542) [2026-01-28 00:20:41] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=3472542) [2026-01-28 00:20:41] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=3472542) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3472542) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.91it/s]
(EngineCore_DP0 pid=3472542) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.91it/s]
(EngineCore_DP0 pid=3472542) 
(EngineCore_DP0 pid=3472542) [2026-01-28 00:20:41] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 3424] -> 1D uint8
(EngineCore_DP0 pid=3472542) [2026-01-28 00:20:41] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9891840 bytes
(EngineCore_DP0 pid=3472542) [2026-01-28 00:20:41] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 3424] -> 1D uint8
(EngineCore_DP0 pid=3472542) [2026-01-28 00:20:41] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 6594560 bytes
(EngineCore_DP0 pid=3472542) [2026-01-28 00:20:41] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 3424] -> 1D uint8
(EngineCore_DP0 pid=3472542) [2026-01-28 00:20:41] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 35610624 bytes
(EngineCore_DP0 pid=3472542) [2026-01-28 00:20:41] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 9216] -> 1D uint8
(EngineCore_DP0 pid=3472542) [2026-01-28 00:20:41] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 17694720 bytes
(EngineCore_DP0 pid=3472542) 2026-01-28 00:20:52,153 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3472542) 2026-01-28 00:20:52,168 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3472542) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00, 22.89it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00, 22.88it/s]
(EngineCore_DP0 pid=3472542) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 1/2 [00:00<00:00,  7.49it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00, 11.96it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:   0%|          | 1/256 [00:00<00:38,  6.63it/s]
Adding requests:  29%|██▉       | 74/256 [00:00<00:00, 358.06it/s]
Adding requests:  58%|█████▊    | 149/256 [00:00<00:00, 516.11it/s]
Adding requests:  87%|████████▋ | 223/256 [00:00<00:00, 597.03it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 513.09it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   8%|▊         | 20/256 [00:00<00:01, 171.73it/s, est. speed input: 175867.20 toks/s, output: 171.73 toks/s]
Processed prompts:  15%|█▍        | 38/256 [00:00<00:02, 74.07it/s, est. speed input: 83329.30 toks/s, output: 81.38 toks/s]   
Processed prompts:  19%|█▉        | 49/256 [00:00<00:03, 67.09it/s, est. speed input: 75751.76 toks/s, output: 73.98 toks/s]
Processed prompts:  23%|██▎       | 58/256 [00:00<00:03, 59.54it/s, est. speed input: 69244.01 toks/s, output: 67.62 toks/s]
Processed prompts:  25%|██▌       | 65/256 [00:00<00:03, 59.64it/s, est. speed input: 68302.20 toks/s, output: 66.70 toks/s]
Processed prompts:  28%|██▊       | 72/256 [00:01<00:03, 55.10it/s, est. speed input: 65234.75 toks/s, output: 63.71 toks/s]
Processed prompts:  30%|███       | 78/256 [00:01<00:03, 54.20it/s, est. speed input: 64061.86 toks/s, output: 62.56 toks/s]
Processed prompts:  33%|███▎      | 84/256 [00:01<00:03, 53.47it/s, est. speed input: 63087.81 toks/s, output: 61.61 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:01<00:03, 52.83it/s, est. speed input: 62236.83 toks/s, output: 60.78 toks/s]
Processed prompts:  38%|███▊      | 96/256 [00:01<00:03, 52.33it/s, est. speed input: 61503.01 toks/s, output: 60.06 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:01<00:02, 52.02it/s, est. speed input: 60886.45 toks/s, output: 59.46 toks/s]
Processed prompts:  42%|████▏     | 108/256 [00:01<00:02, 51.82it/s, est. speed input: 60356.82 toks/s, output: 58.94 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:01<00:02, 51.71it/s, est. speed input: 59895.79 toks/s, output: 58.49 toks/s]
Processed prompts:  47%|████▋     | 120/256 [00:02<00:02, 51.60it/s, est. speed input: 59482.61 toks/s, output: 58.09 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:02<00:02, 51.55it/s, est. speed input: 59118.53 toks/s, output: 57.73 toks/s]
Processed prompts:  52%|█████▏    | 132/256 [00:02<00:02, 51.51it/s, est. speed input: 58788.80 toks/s, output: 57.41 toks/s]
Processed prompts:  54%|█████▍    | 138/256 [00:02<00:02, 51.51it/s, est. speed input: 58497.92 toks/s, output: 57.13 toks/s]
Processed prompts:  56%|█████▋    | 144/256 [00:02<00:02, 51.37it/s, est. speed input: 58208.45 toks/s, output: 56.84 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:02<00:02, 51.36it/s, est. speed input: 57960.18 toks/s, output: 56.60 toks/s]
Processed prompts:  61%|██████    | 156/256 [00:02<00:01, 51.32it/s, est. speed input: 57727.18 toks/s, output: 56.37 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:02<00:01, 51.27it/s, est. speed input: 57509.91 toks/s, output: 56.16 toks/s]
Processed prompts:  66%|██████▌   | 168/256 [00:03<00:01, 51.17it/s, est. speed input: 57300.47 toks/s, output: 55.96 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:03<00:01, 51.24it/s, est. speed input: 57126.15 toks/s, output: 55.79 toks/s]
Processed prompts:  70%|███████   | 180/256 [00:03<00:01, 51.30it/s, est. speed input: 56965.58 toks/s, output: 55.63 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:03<00:01, 51.34it/s, est. speed input: 56816.32 toks/s, output: 55.48 toks/s]
Processed prompts:  75%|███████▌  | 192/256 [00:03<00:01, 51.30it/s, est. speed input: 56668.63 toks/s, output: 55.34 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:03<00:01, 51.21it/s, est. speed input: 56522.88 toks/s, output: 55.20 toks/s]
Processed prompts:  80%|███████▉  | 204/256 [00:03<00:01, 51.28it/s, est. speed input: 56401.53 toks/s, output: 55.08 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:03<00:00, 51.24it/s, est. speed input: 56277.51 toks/s, output: 54.96 toks/s]
Processed prompts:  84%|████████▍ | 216/256 [00:03<00:00, 51.21it/s, est. speed input: 56161.70 toks/s, output: 54.85 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:04<00:00, 51.28it/s, est. speed input: 56060.74 toks/s, output: 54.75 toks/s]
Processed prompts:  89%|████████▉ | 228/256 [00:04<00:00, 51.32it/s, est. speed input: 55965.50 toks/s, output: 54.65 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:04<00:00, 51.37it/s, est. speed input: 55877.02 toks/s, output: 54.57 toks/s]
Processed prompts:  94%|█████████▍| 240/256 [00:04<00:00, 51.40it/s, est. speed input: 55793.74 toks/s, output: 54.49 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:04<00:00, 51.29it/s, est. speed input: 55701.61 toks/s, output: 54.40 toks/s]
Processed prompts:  98%|█████████▊| 252/256 [00:04<00:00, 51.27it/s, est. speed input: 55619.47 toks/s, output: 54.32 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:04<00:00, 51.27it/s, est. speed input: 55793.25 toks/s, output: 54.49 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:04<00:00, 54.48it/s, est. speed input: 55793.25 toks/s, output: 54.49 toks/s]
[rank0]:[W128 00:20:58.569137193 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 27.5s

测试结果:
  Requests/s:   49.24
  Tokens/s:     50468.17
  Total Reqs:   256
  Elapsed:      5.20s

  [Prefill 分析]
  Total Prefill Tokens: 262144
  Prefill Tokens/s:     50418.93

============================================================
[4/7] 测试 M=4096
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-INT8                                  │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 4096
│   M_prefill     = 4096 (= 4 x 1024)
│   M_decode      = 4
│   batched_tokens = 4096 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 512
│   --max-num-seqs           = 4
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 4096
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:21:05 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3473210) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3473210) WARNING 01-28 00:21:14 [backends.py:609] Failed to read file <frozen os>
Throughput: 50.12 requests/s, 51369.33 total tokens/s, 50.12 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512


─── STDERR ───
[2026-01-28 00:21:05] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:21:05] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:21:05] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:21:05] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:21:05] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:21:05] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:21:05] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:21:05] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:21:05] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:21:05] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:21:05] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:21:05] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:21:05] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:21:05] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:21:09] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:21:09] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:21:09] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:21:09] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:21:09] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:21:09] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:21:09] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:21:09] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:21:09] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:21:09] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:21:09] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:21:09] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:21:09] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:21:09] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3473210) [2026-01-28 00:21:10] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3473210) [2026-01-28 00:21:10] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3473210) [2026-01-28 00:21:10] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3473210) [2026-01-28 00:21:10] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=3473210) [2026-01-28 00:21:10] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=3473210) [2026-01-28 00:21:10] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=3473210) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3473210) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.90it/s]
(EngineCore_DP0 pid=3473210) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.90it/s]
(EngineCore_DP0 pid=3473210) 
(EngineCore_DP0 pid=3473210) [2026-01-28 00:21:10] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 3424] -> 1D uint8
(EngineCore_DP0 pid=3473210) [2026-01-28 00:21:10] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9891840 bytes
(EngineCore_DP0 pid=3473210) [2026-01-28 00:21:10] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 3424] -> 1D uint8
(EngineCore_DP0 pid=3473210) [2026-01-28 00:21:10] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 6594560 bytes
(EngineCore_DP0 pid=3473210) [2026-01-28 00:21:10] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 3424] -> 1D uint8
(EngineCore_DP0 pid=3473210) [2026-01-28 00:21:10] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 35610624 bytes
(EngineCore_DP0 pid=3473210) [2026-01-28 00:21:10] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 9216] -> 1D uint8
(EngineCore_DP0 pid=3473210) [2026-01-28 00:21:10] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 17694720 bytes
(EngineCore_DP0 pid=3473210) 2026-01-28 00:21:20,996 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3473210) 2026-01-28 00:21:21,013 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3473210) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 2/4 [00:00<00:00, 15.37it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00, 15.61it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00, 15.57it/s]
(EngineCore_DP0 pid=3473210) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  33%|███▎      | 1/3 [00:00<00:00,  7.40it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00, 14.33it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:  13%|█▎        | 69/512 [00:00<00:00, 683.39it/s]
Adding requests:  28%|██▊       | 143/512 [00:00<00:00, 713.43it/s]
Adding requests:  42%|████▏     | 216/512 [00:00<00:00, 720.80it/s]
Adding requests:  57%|█████▋    | 292/512 [00:00<00:00, 733.10it/s]
Adding requests:  72%|███████▏  | 367/512 [00:00<00:00, 736.08it/s]
Adding requests:  86%|████████▌ | 441/512 [00:00<00:00, 736.63it/s]
Adding requests: 100%|██████████| 512/512 [00:00<00:00, 731.18it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   7%|▋         | 38/512 [00:00<00:02, 219.04it/s, est. speed input: 224308.63 toks/s, output: 219.04 toks/s]
Processed prompts:  12%|█▏        | 60/512 [00:00<00:04, 93.78it/s, est. speed input: 107737.30 toks/s, output: 105.21 toks/s] 
Processed prompts:  14%|█▍        | 73/512 [00:00<00:05, 78.28it/s, est. speed input: 92491.34 toks/s, output: 90.32 toks/s]  
Processed prompts:  16%|█▌        | 83/512 [00:01<00:06, 65.07it/s, est. speed input: 81156.35 toks/s, output: 79.25 toks/s]
Processed prompts:  18%|█▊        | 91/512 [00:01<00:06, 61.37it/s, est. speed input: 77306.45 toks/s, output: 75.49 toks/s]
Processed prompts:  19%|█▉        | 98/512 [00:01<00:07, 56.70it/s, est. speed input: 73542.38 toks/s, output: 71.82 toks/s]
Processed prompts:  21%|██        | 106/512 [00:01<00:07, 54.98it/s, est. speed input: 71266.37 toks/s, output: 69.60 toks/s]
Processed prompts:  22%|██▏       | 114/512 [00:01<00:07, 53.71it/s, est. speed input: 69424.14 toks/s, output: 67.80 toks/s]
Processed prompts:  24%|██▍       | 122/512 [00:01<00:07, 52.81it/s, est. speed input: 67907.41 toks/s, output: 66.32 toks/s]
Processed prompts:  25%|██▌       | 130/512 [00:01<00:07, 52.16it/s, est. speed input: 66632.69 toks/s, output: 65.07 toks/s]
Processed prompts:  27%|██▋       | 138/512 [00:02<00:07, 51.70it/s, est. speed input: 65545.27 toks/s, output: 64.01 toks/s]
Processed prompts:  29%|██▊       | 146/512 [00:02<00:07, 51.32it/s, est. speed input: 64591.02 toks/s, output: 63.08 toks/s]
Processed prompts:  30%|███       | 154/512 [00:02<00:07, 51.04it/s, est. speed input: 63755.17 toks/s, output: 62.26 toks/s]
Processed prompts:  32%|███▏      | 162/512 [00:02<00:06, 50.87it/s, est. speed input: 63028.38 toks/s, output: 61.55 toks/s]
Processed prompts:  33%|███▎      | 170/512 [00:02<00:06, 50.73it/s, est. speed input: 62378.79 toks/s, output: 60.92 toks/s]
Processed prompts:  35%|███▍      | 178/512 [00:02<00:06, 50.68it/s, est. speed input: 61809.26 toks/s, output: 60.36 toks/s]
Processed prompts:  36%|███▋      | 186/512 [00:03<00:06, 50.57it/s, est. speed input: 61284.06 toks/s, output: 59.85 toks/s]
Processed prompts:  38%|███▊      | 194/512 [00:03<00:06, 50.54it/s, est. speed input: 60817.40 toks/s, output: 59.39 toks/s]
Processed prompts:  39%|███▉      | 202/512 [00:03<00:06, 50.53it/s, est. speed input: 60396.77 toks/s, output: 58.98 toks/s]
Processed prompts:  41%|████      | 210/512 [00:03<00:05, 50.51it/s, est. speed input: 60011.42 toks/s, output: 58.60 toks/s]
Processed prompts:  43%|████▎     | 218/512 [00:03<00:05, 50.48it/s, est. speed input: 59654.90 toks/s, output: 58.26 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:03<00:05, 50.47it/s, est. speed input: 59330.02 toks/s, output: 57.94 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:04<00:05, 50.45it/s, est. speed input: 59029.37 toks/s, output: 57.65 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:04<00:05, 50.45it/s, est. speed input: 58752.01 toks/s, output: 57.37 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:04<00:05, 50.39it/s, est. speed input: 58486.12 toks/s, output: 57.12 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:04<00:05, 50.40it/s, est. speed input: 58245.84 toks/s, output: 56.88 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:04<00:04, 50.41it/s, est. speed input: 58023.82 toks/s, output: 56.66 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:04<00:04, 50.41it/s, est. speed input: 57814.45 toks/s, output: 56.46 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:05<00:04, 50.47it/s, est. speed input: 57624.88 toks/s, output: 56.27 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:05<00:04, 50.44it/s, est. speed input: 57439.12 toks/s, output: 56.09 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:05<00:04, 50.41it/s, est. speed input: 57263.93 toks/s, output: 55.92 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:05<00:04, 50.43it/s, est. speed input: 57102.99 toks/s, output: 55.76 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:05<00:03, 50.45it/s, est. speed input: 56950.95 toks/s, output: 55.62 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:05<00:03, 50.46it/s, est. speed input: 56807.41 toks/s, output: 55.48 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:05<00:03, 50.48it/s, est. speed input: 56673.14 toks/s, output: 55.34 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:06<00:03, 50.50it/s, est. speed input: 56545.57 toks/s, output: 55.22 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:06<00:03, 50.46it/s, est. speed input: 56420.39 toks/s, output: 55.10 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:06<00:03, 50.48it/s, est. speed input: 56304.96 toks/s, output: 54.99 toks/s]
Processed prompts:  71%|███████   | 362/512 [00:06<00:02, 50.47it/s, est. speed input: 56193.67 toks/s, output: 54.88 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [00:06<00:02, 50.43it/s, est. speed input: 56083.98 toks/s, output: 54.77 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [00:06<00:02, 50.43it/s, est. speed input: 55982.37 toks/s, output: 54.67 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [00:07<00:02, 50.44it/s, est. speed input: 55885.89 toks/s, output: 54.58 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [00:07<00:02, 50.40it/s, est. speed input: 55789.54 toks/s, output: 54.48 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [00:07<00:02, 50.36it/s, est. speed input: 55696.92 toks/s, output: 54.39 toks/s]
Processed prompts:  80%|████████  | 410/512 [00:07<00:02, 50.40it/s, est. speed input: 55613.02 toks/s, output: 54.31 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [00:07<00:01, 50.43it/s, est. speed input: 55532.81 toks/s, output: 54.23 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [00:07<00:01, 50.44it/s, est. speed input: 55455.08 toks/s, output: 54.16 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [00:08<00:01, 50.46it/s, est. speed input: 55381.31 toks/s, output: 54.08 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [00:08<00:01, 50.45it/s, est. speed input: 55308.97 toks/s, output: 54.01 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [00:08<00:01, 50.43it/s, est. speed input: 55238.14 toks/s, output: 53.94 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [00:08<00:01, 50.46it/s, est. speed input: 55172.70 toks/s, output: 53.88 toks/s]
Processed prompts:  91%|█████████ | 466/512 [00:08<00:00, 50.47it/s, est. speed input: 55109.57 toks/s, output: 53.82 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [00:08<00:00, 50.43it/s, est. speed input: 55045.10 toks/s, output: 53.75 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [00:08<00:00, 50.46it/s, est. speed input: 54986.63 toks/s, output: 53.70 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [00:09<00:00, 50.47it/s, est. speed input: 54930.08 toks/s, output: 53.64 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [00:09<00:00, 50.43it/s, est. speed input: 54872.29 toks/s, output: 53.59 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [00:09<00:00, 50.42it/s, est. speed input: 54817.53 toks/s, output: 53.53 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:09<00:00, 50.42it/s, est. speed input: 55100.81 toks/s, output: 53.81 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:09<00:00, 53.81it/s, est. speed input: 55100.81 toks/s, output: 53.81 toks/s]
[rank0]:[W128 00:21:32.597433692 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 34.0s

测试结果:
  Requests/s:   50.12
  Tokens/s:     51369.33
  Total Reqs:   512
  Elapsed:      10.22s

  [Prefill 分析]
  Total Prefill Tokens: 524288
  Prefill Tokens/s:     51319.21

============================================================
[5/7] 测试 M=8192
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-INT8                                  │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 8192
│   M_prefill     = 8192 (= 8 x 1024)
│   M_decode      = 8
│   batched_tokens = 8192 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 1024
│   --max-num-seqs           = 8
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 8192
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:21:40 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3473980) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3473980) WARNING 01-28 00:21:49 [backends.py:609] Failed to read file <frozen os>
Throughput: 47.70 requests/s, 48890.71 total tokens/s, 47.70 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024


─── STDERR ───
[2026-01-28 00:21:40] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:21:40] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:21:40] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:21:40] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:21:40] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:21:40] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:21:40] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:21:40] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:21:40] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:21:40] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:21:40] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:21:40] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:21:40] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:21:40] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:21:44] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:21:44] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:21:44] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:21:44] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:21:44] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:21:44] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:21:44] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:21:44] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:21:44] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:21:44] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:21:44] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:21:44] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:21:44] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:21:44] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3473980) [2026-01-28 00:21:45] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3473980) [2026-01-28 00:21:45] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3473980) [2026-01-28 00:21:45] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3473980) [2026-01-28 00:21:45] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=3473980) [2026-01-28 00:21:45] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=3473980) [2026-01-28 00:21:45] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=3473980) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3473980) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.87it/s]
(EngineCore_DP0 pid=3473980) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.87it/s]
(EngineCore_DP0 pid=3473980) 
(EngineCore_DP0 pid=3473980) [2026-01-28 00:21:45] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 3424] -> 1D uint8
(EngineCore_DP0 pid=3473980) [2026-01-28 00:21:45] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9891840 bytes
(EngineCore_DP0 pid=3473980) [2026-01-28 00:21:45] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 3424] -> 1D uint8
(EngineCore_DP0 pid=3473980) [2026-01-28 00:21:45] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 6594560 bytes
(EngineCore_DP0 pid=3473980) [2026-01-28 00:21:45] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 3424] -> 1D uint8
(EngineCore_DP0 pid=3473980) [2026-01-28 00:21:45] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 35610624 bytes
(EngineCore_DP0 pid=3473980) [2026-01-28 00:21:45] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 9216] -> 1D uint8
(EngineCore_DP0 pid=3473980) [2026-01-28 00:21:45] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 17694720 bytes
(EngineCore_DP0 pid=3473980) 2026-01-28 00:21:55,891 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3473980) 2026-01-28 00:21:55,907 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3473980) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:01,  3.84it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  80%|████████  | 4/5 [00:00<00:00, 12.72it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00, 11.88it/s]
(EngineCore_DP0 pid=3473980) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:00,  7.39it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00, 18.99it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00, 16.98it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   7%|▋         | 72/1024 [00:00<00:01, 713.50it/s]
Adding requests:  15%|█▍        | 149/1024 [00:00<00:01, 741.36it/s]
Adding requests:  22%|██▏       | 226/1024 [00:00<00:01, 750.07it/s]
Adding requests:  29%|██▉       | 302/1024 [00:00<00:00, 751.40it/s]
Adding requests:  37%|███▋      | 378/1024 [00:00<00:00, 749.40it/s]
Adding requests:  44%|████▍     | 454/1024 [00:00<00:00, 750.48it/s]
Adding requests:  52%|█████▏    | 530/1024 [00:00<00:00, 738.64it/s]
Adding requests:  59%|█████▉    | 607/1024 [00:00<00:00, 747.49it/s]
Adding requests:  67%|██████▋   | 685/1024 [00:00<00:00, 755.89it/s]
Adding requests:  74%|███████▍  | 761/1024 [00:01<00:00, 754.69it/s]
Adding requests:  82%|████████▏ | 837/1024 [00:01<00:00, 738.13it/s]
Adding requests:  89%|████████▉ | 916/1024 [00:01<00:00, 753.09it/s]
Adding requests:  97%|█████████▋| 993/1024 [00:01<00:00, 757.71it/s]
Adding requests: 100%|██████████| 1024/1024 [00:01<00:00, 751.28it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▋         | 66/1024 [00:00<00:03, 294.85it/s, est. speed input: 301950.86 toks/s, output: 294.86 toks/s]
Processed prompts:   9%|▉         | 96/1024 [00:00<00:08, 115.90it/s, est. speed input: 135661.65 toks/s, output: 132.48 toks/s]
Processed prompts:  11%|█         | 112/1024 [00:01<00:10, 87.33it/s, est. speed input: 108358.11 toks/s, output: 105.82 toks/s]
Processed prompts:  12%|█▏        | 123/1024 [00:01<00:13, 66.91it/s, est. speed input: 90452.23 toks/s, output: 88.33 toks/s]  
Processed prompts:  13%|█▎        | 131/1024 [00:01<00:14, 62.88it/s, est. speed input: 86015.78 toks/s, output: 84.00 toks/s]
Processed prompts:  13%|█▎        | 138/1024 [00:01<00:15, 58.03it/s, est. speed input: 81854.77 toks/s, output: 79.94 toks/s]
Processed prompts:  14%|█▍        | 146/1024 [00:01<00:15, 55.51it/s, est. speed input: 78959.86 toks/s, output: 77.11 toks/s]
Processed prompts:  15%|█▌        | 154/1024 [00:02<00:16, 53.54it/s, est. speed input: 76547.31 toks/s, output: 74.75 toks/s]
Processed prompts:  16%|█▌        | 162/1024 [00:02<00:16, 52.00it/s, est. speed input: 74484.12 toks/s, output: 72.74 toks/s]
Processed prompts:  17%|█▋        | 170/1024 [00:02<00:16, 50.86it/s, est. speed input: 72713.42 toks/s, output: 71.01 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [00:02<00:16, 50.00it/s, est. speed input: 71167.34 toks/s, output: 69.50 toks/s]
Processed prompts:  18%|█▊        | 186/1024 [00:02<00:16, 49.40it/s, est. speed input: 69814.55 toks/s, output: 68.18 toks/s]
Processed prompts:  19%|█▉        | 194/1024 [00:02<00:16, 48.93it/s, est. speed input: 68607.97 toks/s, output: 67.00 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [00:03<00:16, 48.64it/s, est. speed input: 67544.21 toks/s, output: 65.96 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:03<00:16, 48.44it/s, est. speed input: 66592.92 toks/s, output: 65.03 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [00:03<00:16, 48.27it/s, est. speed input: 65727.51 toks/s, output: 64.19 toks/s]
Processed prompts:  22%|██▏       | 226/1024 [00:03<00:16, 48.14it/s, est. speed input: 64942.30 toks/s, output: 63.42 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:03<00:16, 48.08it/s, est. speed input: 64233.78 toks/s, output: 62.73 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:03<00:16, 48.01it/s, est. speed input: 63580.07 toks/s, output: 62.09 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:04<00:16, 47.97it/s, est. speed input: 62981.99 toks/s, output: 61.51 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:04<00:15, 47.95it/s, est. speed input: 62432.39 toks/s, output: 60.97 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:04<00:15, 47.92it/s, est. speed input: 61921.72 toks/s, output: 60.47 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:04<00:15, 47.90it/s, est. speed input: 61448.35 toks/s, output: 60.01 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:04<00:15, 47.87it/s, est. speed input: 61006.52 toks/s, output: 59.58 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:04<00:15, 47.88it/s, est. speed input: 60598.96 toks/s, output: 59.18 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:05<00:15, 47.88it/s, est. speed input: 60217.70 toks/s, output: 58.81 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:05<00:14, 47.89it/s, est. speed input: 59861.73 toks/s, output: 58.46 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:05<00:14, 47.89it/s, est. speed input: 59526.81 toks/s, output: 58.13 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:05<00:14, 47.85it/s, est. speed input: 59207.48 toks/s, output: 57.82 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:05<00:14, 47.85it/s, est. speed input: 58910.38 toks/s, output: 57.53 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:05<00:14, 47.88it/s, est. speed input: 58632.57 toks/s, output: 57.26 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:06<00:14, 47.87it/s, est. speed input: 58367.63 toks/s, output: 57.00 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:06<00:13, 47.88it/s, est. speed input: 58117.81 toks/s, output: 56.76 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:06<00:13, 47.88it/s, est. speed input: 57880.51 toks/s, output: 56.52 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:06<00:13, 47.87it/s, est. speed input: 57654.77 toks/s, output: 56.30 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:06<00:13, 47.84it/s, est. speed input: 57437.65 toks/s, output: 56.09 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:06<00:13, 47.87it/s, est. speed input: 57236.11 toks/s, output: 55.89 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [00:07<00:13, 47.86it/s, est. speed input: 57040.50 toks/s, output: 55.70 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:07<00:12, 47.86it/s, est. speed input: 56855.49 toks/s, output: 55.52 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:07<00:12, 47.86it/s, est. speed input: 56678.67 toks/s, output: 55.35 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:07<00:12, 47.83it/s, est. speed input: 56506.19 toks/s, output: 55.18 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:07<00:12, 47.82it/s, est. speed input: 56343.29 toks/s, output: 55.02 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:07<00:12, 47.85it/s, est. speed input: 56189.28 toks/s, output: 54.87 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:08<00:12, 47.85it/s, est. speed input: 56040.87 toks/s, output: 54.73 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:08<00:11, 47.84it/s, est. speed input: 55897.35 toks/s, output: 54.59 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:08<00:11, 47.84it/s, est. speed input: 55759.61 toks/s, output: 54.45 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:08<00:11, 47.84it/s, est. speed input: 55627.54 toks/s, output: 54.32 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:08<00:11, 47.84it/s, est. speed input: 55501.03 toks/s, output: 54.20 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:08<00:11, 47.87it/s, est. speed input: 55380.39 toks/s, output: 54.08 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:09<00:11, 47.87it/s, est. speed input: 55263.47 toks/s, output: 53.97 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:09<00:10, 47.86it/s, est. speed input: 55149.96 toks/s, output: 53.86 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:09<00:10, 47.82it/s, est. speed input: 55038.34 toks/s, output: 53.75 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:09<00:10, 47.83it/s, est. speed input: 54933.07 toks/s, output: 53.65 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:09<00:10, 47.84it/s, est. speed input: 54831.23 toks/s, output: 53.55 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:09<00:10, 47.85it/s, est. speed input: 54733.43 toks/s, output: 53.45 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:10<00:10, 47.84it/s, est. speed input: 54637.82 toks/s, output: 53.36 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:10<00:09, 47.84it/s, est. speed input: 54545.31 toks/s, output: 53.27 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:10<00:09, 47.84it/s, est. speed input: 54456.52 toks/s, output: 53.18 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:10<00:09, 47.81it/s, est. speed input: 54368.00 toks/s, output: 53.09 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:10<00:09, 47.82it/s, est. speed input: 54284.33 toks/s, output: 53.01 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:10<00:09, 47.85it/s, est. speed input: 54204.69 toks/s, output: 52.93 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:11<00:09, 47.86it/s, est. speed input: 54126.85 toks/s, output: 52.86 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:11<00:08, 47.85it/s, est. speed input: 54050.21 toks/s, output: 52.78 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:11<00:08, 47.86it/s, est. speed input: 53976.80 toks/s, output: 52.71 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:11<00:08, 47.84it/s, est. speed input: 53904.27 toks/s, output: 52.64 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:11<00:08, 47.84it/s, est. speed input: 53834.25 toks/s, output: 52.57 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:11<00:08, 47.86it/s, est. speed input: 53767.06 toks/s, output: 52.51 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:12<00:08, 47.87it/s, est. speed input: 53701.92 toks/s, output: 52.44 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:12<00:07, 47.87it/s, est. speed input: 53638.28 toks/s, output: 52.38 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:12<00:07, 47.86it/s, est. speed input: 53575.56 toks/s, output: 52.32 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:12<00:07, 47.80it/s, est. speed input: 53511.96 toks/s, output: 52.26 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:12<00:07, 47.81it/s, est. speed input: 53452.75 toks/s, output: 52.20 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:12<00:07, 47.84it/s, est. speed input: 53395.63 toks/s, output: 52.14 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:13<00:07, 47.81it/s, est. speed input: 53338.03 toks/s, output: 52.09 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:13<00:06, 47.82it/s, est. speed input: 53283.29 toks/s, output: 52.03 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:13<00:06, 47.84it/s, est. speed input: 53230.63 toks/s, output: 51.98 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:13<00:06, 47.81it/s, est. speed input: 53176.75 toks/s, output: 51.93 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:13<00:06, 47.81it/s, est. speed input: 53125.51 toks/s, output: 51.88 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:13<00:06, 47.83it/s, est. speed input: 53076.15 toks/s, output: 51.83 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:14<00:06, 47.82it/s, est. speed input: 53027.35 toks/s, output: 51.78 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:14<00:05, 47.84it/s, est. speed input: 52980.66 toks/s, output: 51.74 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:14<00:05, 47.84it/s, est. speed input: 52934.23 toks/s, output: 51.69 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:14<00:05, 47.82it/s, est. speed input: 52888.18 toks/s, output: 51.65 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:14<00:05, 47.82it/s, est. speed input: 52843.89 toks/s, output: 51.61 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:14<00:05, 47.82it/s, est. speed input: 52800.47 toks/s, output: 51.56 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:15<00:05, 47.84it/s, est. speed input: 52758.86 toks/s, output: 51.52 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:15<00:04, 47.85it/s, est. speed input: 52717.78 toks/s, output: 51.48 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:15<00:04, 47.86it/s, est. speed input: 52677.79 toks/s, output: 51.44 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:15<00:04, 47.84it/s, est. speed input: 52637.64 toks/s, output: 51.40 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:15<00:04, 47.83it/s, est. speed input: 52598.79 toks/s, output: 51.37 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:15<00:04, 47.81it/s, est. speed input: 52560.02 toks/s, output: 51.33 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:16<00:04, 47.83it/s, est. speed input: 52523.19 toks/s, output: 51.29 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:16<00:03, 47.82it/s, est. speed input: 52486.50 toks/s, output: 51.26 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [00:16<00:03, 47.80it/s, est. speed input: 52450.06 toks/s, output: 51.22 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [00:16<00:03, 47.77it/s, est. speed input: 52413.71 toks/s, output: 51.19 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:16<00:03, 47.77it/s, est. speed input: 52378.70 toks/s, output: 51.15 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [00:16<00:03, 47.77it/s, est. speed input: 52344.38 toks/s, output: 51.12 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [00:17<00:03, 47.80it/s, est. speed input: 52312.02 toks/s, output: 51.09 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [00:17<00:02, 47.81it/s, est. speed input: 52279.65 toks/s, output: 51.05 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [00:17<00:02, 47.78it/s, est. speed input: 52246.77 toks/s, output: 51.02 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [00:17<00:02, 47.79it/s, est. speed input: 52215.41 toks/s, output: 50.99 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [00:17<00:02, 47.81it/s, est. speed input: 52185.35 toks/s, output: 50.96 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [00:17<00:02, 47.80it/s, est. speed input: 52154.88 toks/s, output: 50.93 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [00:18<00:02, 47.79it/s, est. speed input: 52124.90 toks/s, output: 50.90 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [00:18<00:01, 47.80it/s, est. speed input: 52095.94 toks/s, output: 50.87 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [00:18<00:01, 47.77it/s, est. speed input: 52066.31 toks/s, output: 50.85 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [00:18<00:01, 47.75it/s, est. speed input: 52037.27 toks/s, output: 50.82 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [00:18<00:01, 47.75it/s, est. speed input: 52009.32 toks/s, output: 50.79 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [00:18<00:01, 47.76it/s, est. speed input: 51982.28 toks/s, output: 50.76 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [00:19<00:01, 47.79it/s, est. speed input: 51956.05 toks/s, output: 50.74 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [00:19<00:00, 47.78it/s, est. speed input: 51929.66 toks/s, output: 50.71 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [00:19<00:00, 47.77it/s, est. speed input: 51903.52 toks/s, output: 50.69 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [00:19<00:00, 47.73it/s, est. speed input: 51876.80 toks/s, output: 50.66 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [00:19<00:00, 47.75it/s, est. speed input: 51851.87 toks/s, output: 50.64 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [00:19<00:00, 47.76it/s, est. speed input: 51827.54 toks/s, output: 50.61 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [00:20<00:00, 49.45it/s, est. speed input: 51852.42 toks/s, output: 50.64 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:20<00:00, 49.45it/s, est. speed input: 52157.73 toks/s, output: 50.94 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:20<00:00, 50.94it/s, est. speed input: 52157.73 toks/s, output: 50.94 toks/s]
[rank0]:[W128 00:22:19.950428348 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 46.3s

测试结果:
  Requests/s:   47.70
  Tokens/s:     48890.71
  Total Reqs:   1024
  Elapsed:      21.47s

  [Prefill 分析]
  Total Prefill Tokens: 1048576
  Prefill Tokens/s:     48843.01

============================================================
[6/7] 测试 M=16384
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-INT8                                  │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 16384
│   M_prefill     = 16384 (= 16 x 1024)
│   M_decode      = 16
│   batched_tokens = 16384 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 2048
│   --max-num-seqs           = 16
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 16384
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:22:29 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3475003) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3475003) WARNING 01-28 00:22:39 [backends.py:609] Failed to read file <frozen os>
Throughput: 46.59 requests/s, 47756.89 total tokens/s, 46.59 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048


─── STDERR ───
[2026-01-28 00:22:29] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:22:29] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:22:29] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:22:29] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:22:29] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:22:29] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:22:29] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:22:29] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:22:29] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:22:29] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:22:29] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:22:29] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:22:29] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:22:29] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:22:33] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:22:33] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:22:33] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:22:33] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:22:33] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:22:33] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:22:33] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:22:33] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:22:33] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:22:33] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:22:33] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:22:33] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:22:33] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:22:33] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3475003) [2026-01-28 00:22:34] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3475003) [2026-01-28 00:22:34] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3475003) [2026-01-28 00:22:34] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3475003) [2026-01-28 00:22:34] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=3475003) [2026-01-28 00:22:34] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=3475003) [2026-01-28 00:22:34] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=3475003) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3475003) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.89it/s]
(EngineCore_DP0 pid=3475003) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.89it/s]
(EngineCore_DP0 pid=3475003) 
(EngineCore_DP0 pid=3475003) [2026-01-28 00:22:34] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 3424] -> 1D uint8
(EngineCore_DP0 pid=3475003) [2026-01-28 00:22:35] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9891840 bytes
(EngineCore_DP0 pid=3475003) [2026-01-28 00:22:35] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 3424] -> 1D uint8
(EngineCore_DP0 pid=3475003) [2026-01-28 00:22:35] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 6594560 bytes
(EngineCore_DP0 pid=3475003) [2026-01-28 00:22:35] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 3424] -> 1D uint8
(EngineCore_DP0 pid=3475003) [2026-01-28 00:22:35] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 35610624 bytes
(EngineCore_DP0 pid=3475003) [2026-01-28 00:22:35] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 9216] -> 1D uint8
(EngineCore_DP0 pid=3475003) [2026-01-28 00:22:35] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 17694720 bytes
(EngineCore_DP0 pid=3475003) 2026-01-28 00:22:45,151 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3475003) 2026-01-28 00:22:45,195 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3475003) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  14%|█▍        | 1/7 [00:00<00:01,  4.91it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  43%|████▎     | 3/7 [00:00<00:00, 10.53it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  86%|████████▌ | 6/7 [00:00<00:00, 17.30it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00, 14.84it/s]
(EngineCore_DP0 pid=3475003) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  20%|██        | 1/5 [00:00<00:00,  7.43it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00, 20.66it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00, 18.66it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   3%|▎         | 68/2048 [00:00<00:02, 679.29it/s]
Adding requests:   7%|▋         | 141/2048 [00:00<00:02, 708.45it/s]
Adding requests:  11%|█         | 216/2048 [00:00<00:02, 724.31it/s]
Adding requests:  14%|█▍        | 294/2048 [00:00<00:02, 745.39it/s]
Adding requests:  18%|█▊        | 369/2048 [00:00<00:02, 746.44it/s]
Adding requests:  22%|██▏       | 445/2048 [00:00<00:02, 748.04it/s]
Adding requests:  25%|██▌       | 520/2048 [00:00<00:02, 741.89it/s]
Adding requests:  29%|██▉       | 597/2048 [00:00<00:01, 749.02it/s]
Adding requests:  33%|███▎      | 673/2048 [00:00<00:01, 749.99it/s]
Adding requests:  37%|███▋      | 749/2048 [00:01<00:01, 750.67it/s]
Adding requests:  40%|████      | 825/2048 [00:01<00:01, 739.57it/s]
Adding requests:  44%|████▍     | 902/2048 [00:01<00:01, 747.26it/s]
Adding requests:  48%|████▊     | 977/2048 [00:01<00:01, 721.98it/s]
Adding requests:  51%|█████▏    | 1054/2048 [00:01<00:01, 735.83it/s]
Adding requests:  55%|█████▌    | 1128/2048 [00:01<00:01, 735.44it/s]
Adding requests:  59%|█████▉    | 1206/2048 [00:01<00:01, 747.68it/s]
Adding requests:  63%|██████▎   | 1281/2048 [00:01<00:01, 739.96it/s]
Adding requests:  66%|██████▋   | 1358/2048 [00:01<00:00, 746.21it/s]
Adding requests:  70%|███████   | 1436/2048 [00:01<00:00, 753.88it/s]
Adding requests:  74%|███████▍  | 1517/2048 [00:02<00:00, 767.53it/s]
Adding requests:  78%|███████▊  | 1598/2048 [00:02<00:00, 777.50it/s]
Adding requests:  82%|████████▏ | 1676/2048 [00:02<00:00, 775.02it/s]
Adding requests:  86%|████████▌ | 1754/2048 [00:02<00:00, 769.00it/s]
Adding requests:  89%|████████▉ | 1831/2048 [00:02<00:00, 755.56it/s]
Adding requests:  93%|█████████▎| 1907/2048 [00:02<00:00, 753.20it/s]
Adding requests:  97%|█████████▋| 1984/2048 [00:02<00:00, 756.47it/s]
Adding requests: 100%|██████████| 2048/2048 [00:02<00:00, 749.05it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▋         | 130/2048 [00:00<00:06, 303.63it/s, est. speed input: 310930.37 toks/s, output: 303.64 toks/s]
Processed prompts:   8%|▊         | 161/2048 [00:00<00:09, 189.91it/s, est. speed input: 213868.65 toks/s, output: 208.86 toks/s]
Processed prompts:   9%|▊         | 179/2048 [00:01<00:20, 91.18it/s, est. speed input: 125962.07 toks/s, output: 123.01 toks/s] 
Processed prompts:   9%|▉         | 194/2048 [00:01<00:24, 76.90it/s, est. speed input: 110508.86 toks/s, output: 107.92 toks/s]
Processed prompts:  10%|█         | 210/2048 [00:02<00:27, 67.84it/s, est. speed input: 100498.87 toks/s, output: 98.14 toks/s] 
Processed prompts:  11%|█         | 226/2048 [00:02<00:29, 61.49it/s, est. speed input: 93238.15 toks/s, output: 91.05 toks/s] 
Processed prompts:  12%|█▏        | 242/2048 [00:02<00:31, 57.04it/s, est. speed input: 87727.46 toks/s, output: 85.67 toks/s]
Processed prompts:  13%|█▎        | 258/2048 [00:03<00:33, 53.95it/s, est. speed input: 83420.91 toks/s, output: 81.47 toks/s]
Processed prompts:  13%|█▎        | 274/2048 [00:03<00:34, 51.80it/s, est. speed input: 79956.40 toks/s, output: 78.08 toks/s]
Processed prompts:  14%|█▍        | 290/2048 [00:03<00:34, 50.25it/s, est. speed input: 77091.44 toks/s, output: 75.28 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [00:04<00:35, 49.19it/s, est. speed input: 74703.16 toks/s, output: 72.95 toks/s]
Processed prompts:  16%|█▌        | 322/2048 [00:04<00:35, 48.34it/s, est. speed input: 72634.42 toks/s, output: 70.93 toks/s]
Processed prompts:  17%|█▋        | 338/2048 [00:04<00:35, 47.84it/s, est. speed input: 70888.75 toks/s, output: 69.23 toks/s]
Processed prompts:  17%|█▋        | 354/2048 [00:05<00:35, 47.50it/s, est. speed input: 69378.47 toks/s, output: 67.75 toks/s]
Processed prompts:  18%|█▊        | 370/2048 [00:05<00:35, 47.27it/s, est. speed input: 68052.87 toks/s, output: 66.46 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [00:05<00:35, 47.09it/s, est. speed input: 66877.51 toks/s, output: 65.31 toks/s]
Processed prompts:  20%|█▉        | 402/2048 [00:06<00:35, 46.98it/s, est. speed input: 65834.43 toks/s, output: 64.29 toks/s]
Processed prompts:  20%|██        | 418/2048 [00:06<00:34, 46.89it/s, est. speed input: 64897.95 toks/s, output: 63.38 toks/s]
Processed prompts:  21%|██        | 434/2048 [00:06<00:34, 46.82it/s, est. speed input: 64051.32 toks/s, output: 62.55 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [00:07<00:34, 46.80it/s, est. speed input: 63291.55 toks/s, output: 61.81 toks/s]
Processed prompts:  23%|██▎       | 466/2048 [00:07<00:33, 46.77it/s, est. speed input: 62596.31 toks/s, output: 61.13 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [00:07<00:33, 46.74it/s, est. speed input: 61959.18 toks/s, output: 60.51 toks/s]
Processed prompts:  24%|██▍       | 498/2048 [00:08<00:33, 46.73it/s, est. speed input: 61375.46 toks/s, output: 59.94 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [00:08<00:32, 46.72it/s, est. speed input: 60839.44 toks/s, output: 59.41 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [00:08<00:32, 46.71it/s, est. speed input: 60341.94 toks/s, output: 58.93 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [00:09<00:32, 46.70it/s, est. speed input: 59881.76 toks/s, output: 58.48 toks/s]
Processed prompts:  27%|██▋       | 562/2048 [00:09<00:31, 46.70it/s, est. speed input: 59455.13 toks/s, output: 58.06 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [00:10<00:31, 46.68it/s, est. speed input: 59054.72 toks/s, output: 57.67 toks/s]
Processed prompts:  29%|██▉       | 594/2048 [00:10<00:31, 46.68it/s, est. speed input: 58681.76 toks/s, output: 57.31 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [00:10<00:30, 46.68it/s, est. speed input: 58333.97 toks/s, output: 56.97 toks/s]
Processed prompts:  31%|███       | 626/2048 [00:11<00:30, 46.67it/s, est. speed input: 58005.76 toks/s, output: 56.65 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [00:11<00:30, 46.67it/s, est. speed input: 57698.99 toks/s, output: 56.35 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [00:11<00:29, 46.66it/s, est. speed input: 57408.23 toks/s, output: 56.06 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [00:12<00:29, 46.66it/s, est. speed input: 57135.17 toks/s, output: 55.80 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [00:12<00:29, 46.67it/s, est. speed input: 56877.72 toks/s, output: 55.54 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [00:12<00:28, 46.65it/s, est. speed input: 56631.03 toks/s, output: 55.30 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [00:13<00:28, 46.65it/s, est. speed input: 56399.96 toks/s, output: 55.08 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [00:13<00:28, 46.65it/s, est. speed input: 56179.83 toks/s, output: 54.86 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [00:13<00:27, 46.63it/s, est. speed input: 55969.10 toks/s, output: 54.66 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [00:14<00:27, 46.64it/s, est. speed input: 55769.97 toks/s, output: 54.46 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [00:14<00:27, 46.64it/s, est. speed input: 55580.66 toks/s, output: 54.28 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [00:14<00:26, 46.63it/s, est. speed input: 55398.64 toks/s, output: 54.10 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [00:15<00:26, 46.64it/s, est. speed input: 55226.05 toks/s, output: 53.93 toks/s]
Processed prompts:  41%|████      | 834/2048 [00:15<00:26, 46.64it/s, est. speed input: 55061.41 toks/s, output: 53.77 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [00:15<00:25, 46.62it/s, est. speed input: 54901.76 toks/s, output: 53.61 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [00:16<00:25, 46.63it/s, est. speed input: 54750.68 toks/s, output: 53.47 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [00:16<00:25, 46.63it/s, est. speed input: 54605.31 toks/s, output: 53.33 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [00:16<00:24, 46.62it/s, est. speed input: 54465.02 toks/s, output: 53.19 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [00:17<00:24, 46.62it/s, est. speed input: 54331.04 toks/s, output: 53.06 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [00:17<00:23, 46.62it/s, est. speed input: 54202.30 toks/s, output: 52.93 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [00:17<00:23, 46.61it/s, est. speed input: 54077.73 toks/s, output: 52.81 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [00:18<00:23, 46.62it/s, est. speed input: 53958.91 toks/s, output: 52.69 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [00:18<00:22, 46.62it/s, est. speed input: 53844.00 toks/s, output: 52.58 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [00:18<00:22, 46.61it/s, est. speed input: 53732.77 toks/s, output: 52.47 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [00:19<00:22, 46.62it/s, est. speed input: 53626.31 toks/s, output: 52.37 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [00:19<00:21, 46.61it/s, est. speed input: 53522.77 toks/s, output: 52.27 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [00:19<00:21, 46.59it/s, est. speed input: 53421.84 toks/s, output: 52.17 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [00:20<00:21, 46.60it/s, est. speed input: 53325.99 toks/s, output: 52.08 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [00:20<00:20, 46.59it/s, est. speed input: 53232.29 toks/s, output: 51.98 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [00:21<00:20, 46.59it/s, est. speed input: 53142.03 toks/s, output: 51.90 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [00:21<00:20, 46.59it/s, est. speed input: 53054.60 toks/s, output: 51.81 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [00:21<00:19, 46.60it/s, est. speed input: 52970.50 toks/s, output: 51.73 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [00:22<00:19, 46.59it/s, est. speed input: 52887.80 toks/s, output: 51.65 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [00:22<00:18, 47.34it/s, est. speed input: 52851.55 toks/s, output: 51.61 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [00:22<00:18, 47.11it/s, est. speed input: 52773.69 toks/s, output: 51.54 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [00:23<00:18, 46.95it/s, est. speed input: 52698.11 toks/s, output: 51.46 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [00:23<00:18, 46.84it/s, est. speed input: 52624.81 toks/s, output: 51.39 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [00:23<00:17, 46.77it/s, est. speed input: 52553.70 toks/s, output: 51.32 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [00:24<00:17, 46.72it/s, est. speed input: 52484.70 toks/s, output: 51.25 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [00:24<00:17, 46.69it/s, est. speed input: 52417.95 toks/s, output: 51.19 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [00:24<00:16, 46.64it/s, est. speed input: 52351.93 toks/s, output: 51.12 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [00:25<00:16, 46.63it/s, est. speed input: 52288.72 toks/s, output: 51.06 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [00:25<00:16, 46.63it/s, est. speed input: 52227.23 toks/s, output: 51.00 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [00:25<00:15, 46.60it/s, est. speed input: 52166.08 toks/s, output: 50.94 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [00:26<00:15, 46.60it/s, est. speed input: 52107.55 toks/s, output: 50.89 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [00:26<00:15, 46.60it/s, est. speed input: 52050.64 toks/s, output: 50.83 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [00:26<00:14, 46.59it/s, est. speed input: 51994.59 toks/s, output: 50.78 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [00:27<00:14, 46.59it/s, est. speed input: 51940.64 toks/s, output: 50.72 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [00:27<00:14, 46.60it/s, est. speed input: 51888.25 toks/s, output: 50.67 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [00:27<00:13, 46.58it/s, est. speed input: 51835.94 toks/s, output: 50.62 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [00:28<00:13, 46.59it/s, est. speed input: 51785.84 toks/s, output: 50.57 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [00:28<00:13, 46.57it/s, est. speed input: 51736.07 toks/s, output: 50.52 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [00:28<00:12, 46.57it/s, est. speed input: 51687.80 toks/s, output: 50.48 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [00:29<00:12, 46.57it/s, est. speed input: 51640.80 toks/s, output: 50.43 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [00:29<00:11, 46.58it/s, est. speed input: 51595.50 toks/s, output: 50.39 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [00:29<00:11, 46.58it/s, est. speed input: 51550.65 toks/s, output: 50.34 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [00:30<00:11, 46.58it/s, est. speed input: 51507.02 toks/s, output: 50.30 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [00:30<00:10, 46.59it/s, est. speed input: 51464.41 toks/s, output: 50.26 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [00:30<00:10, 46.57it/s, est. speed input: 51421.95 toks/s, output: 50.22 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [00:31<00:10, 46.58it/s, est. speed input: 51381.33 toks/s, output: 50.18 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [00:31<00:09, 46.57it/s, est. speed input: 51341.16 toks/s, output: 50.14 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [00:31<00:09, 46.56it/s, est. speed input: 51301.51 toks/s, output: 50.10 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [00:32<00:09, 46.56it/s, est. speed input: 51262.91 toks/s, output: 50.06 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [00:32<00:08, 46.56it/s, est. speed input: 51225.33 toks/s, output: 50.02 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [00:33<00:08, 46.56it/s, est. speed input: 51188.16 toks/s, output: 49.99 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [00:33<00:08, 46.56it/s, est. speed input: 51152.05 toks/s, output: 49.95 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [00:33<00:07, 46.57it/s, est. speed input: 51117.14 toks/s, output: 49.92 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [00:34<00:07, 46.56it/s, est. speed input: 51082.07 toks/s, output: 49.88 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [00:34<00:07, 46.57it/s, est. speed input: 51048.22 toks/s, output: 49.85 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [00:34<00:06, 46.55it/s, est. speed input: 51014.40 toks/s, output: 49.82 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [00:35<00:06, 46.55it/s, est. speed input: 50981.71 toks/s, output: 49.79 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [00:35<00:06, 46.55it/s, est. speed input: 50949.53 toks/s, output: 49.76 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [00:35<00:05, 46.55it/s, est. speed input: 50917.89 toks/s, output: 49.72 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [00:36<00:05, 46.56it/s, est. speed input: 50887.16 toks/s, output: 49.69 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [00:36<00:05, 46.55it/s, est. speed input: 50856.67 toks/s, output: 49.66 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [00:36<00:04, 46.55it/s, est. speed input: 50826.74 toks/s, output: 49.64 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [00:37<00:04, 46.55it/s, est. speed input: 50797.48 toks/s, output: 49.61 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [00:37<00:04, 46.55it/s, est. speed input: 50768.84 toks/s, output: 49.58 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [00:37<00:03, 47.40it/s, est. speed input: 50768.11 toks/s, output: 49.58 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [00:38<00:03, 47.15it/s, est. speed input: 50740.37 toks/s, output: 49.55 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [00:38<00:03, 46.97it/s, est. speed input: 50713.10 toks/s, output: 49.52 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [00:38<00:02, 46.84it/s, est. speed input: 50685.95 toks/s, output: 49.50 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [00:39<00:02, 46.76it/s, est. speed input: 50659.67 toks/s, output: 49.47 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [00:39<00:02, 46.71it/s, est. speed input: 50634.06 toks/s, output: 49.45 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [00:39<00:01, 46.65it/s, est. speed input: 50608.11 toks/s, output: 49.42 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [00:40<00:01, 46.62it/s, est. speed input: 50583.02 toks/s, output: 49.40 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [00:40<00:00, 46.58it/s, est. speed input: 50557.83 toks/s, output: 49.37 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [00:40<00:00, 46.56it/s, est. speed input: 50533.16 toks/s, output: 49.35 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [00:41<00:00, 47.21it/s, est. speed input: 50528.52 toks/s, output: 49.34 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:41<00:00, 47.21it/s, est. speed input: 50876.08 toks/s, output: 49.68 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:41<00:00, 49.68it/s, est. speed input: 50876.08 toks/s, output: 49.68 toks/s]
[rank0]:[W128 00:23:31.833944993 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 71.9s

测试结果:
  Requests/s:   46.59
  Tokens/s:     47756.89
  Total Reqs:   2048
  Elapsed:      43.96s

  [Prefill 分析]
  Total Prefill Tokens: 2097152
  Prefill Tokens/s:     47710.30

============================================================
[7/7] 测试 M=32768
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-INT8                                  │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 32768
│   M_prefill     = 32768 (= 32 x 1024)
│   M_decode      = 32
│   batched_tokens = 32768 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 4096
│   --max-num-seqs           = 32
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 32768
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:23:47 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3476461) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3476461) WARNING 01-28 00:23:56 [backends.py:609] Failed to read file <frozen os>
Throughput: 46.51 requests/s, 47671.14 total tokens/s, 46.51 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096


─── STDERR ───
[2026-01-28 00:23:47] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:23:47] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:23:47] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:23:47] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:23:47] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:23:47] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:23:47] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:23:47] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:23:47] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:23:47] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:23:47] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:23:47] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:23:47] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:23:47] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:23:51] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:23:51] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:23:51] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:23:51] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:23:51] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:23:51] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:23:51] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:23:51] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:23:51] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:23:51] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:23:51] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:23:51] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:23:51] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:23:51] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3476461) [2026-01-28 00:23:52] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3476461) [2026-01-28 00:23:52] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3476461) [2026-01-28 00:23:52] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3476461) [2026-01-28 00:23:52] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=3476461) [2026-01-28 00:23:52] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=3476461) [2026-01-28 00:23:52] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=3476461) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3476461) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.90it/s]
(EngineCore_DP0 pid=3476461) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.90it/s]
(EngineCore_DP0 pid=3476461) 
(EngineCore_DP0 pid=3476461) [2026-01-28 00:23:52] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 3424] -> 1D uint8
(EngineCore_DP0 pid=3476461) [2026-01-28 00:23:52] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9891840 bytes
(EngineCore_DP0 pid=3476461) [2026-01-28 00:23:52] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 3424] -> 1D uint8
(EngineCore_DP0 pid=3476461) [2026-01-28 00:23:52] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 6594560 bytes
(EngineCore_DP0 pid=3476461) [2026-01-28 00:23:52] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 3424] -> 1D uint8
(EngineCore_DP0 pid=3476461) [2026-01-28 00:23:52] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 35610624 bytes
(EngineCore_DP0 pid=3476461) [2026-01-28 00:23:52] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 9216] -> 1D uint8
(EngineCore_DP0 pid=3476461) [2026-01-28 00:23:52] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 17694720 bytes
(EngineCore_DP0 pid=3476461) [rank0]:W0128 00:23:59.859000 3476461 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=3476461) [rank0]:W0128 00:23:59.908000 3476461 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=3476461) [rank0]:W0128 00:24:00.589000 3476461 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=3476461) [rank0]:W0128 00:24:00.665000 3476461 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=3476461) 2026-01-28 00:24:02,951 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3476461) 2026-01-28 00:24:02,968 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3476461) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   9%|▉         | 1/11 [00:00<00:04,  2.01it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  36%|███▋      | 4/11 [00:00<00:00,  7.95it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  64%|██████▎   | 7/11 [00:00<00:00, 12.54it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  91%|█████████ | 10/11 [00:00<00:00, 16.62it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:00<00:00, 12.36it/s]
(EngineCore_DP0 pid=3476461) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  14%|█▍        | 1/7 [00:00<00:00,  7.38it/s]
Capturing CUDA graphs (decode, FULL):  57%|█████▋    | 4/7 [00:00<00:00, 18.61it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00, 22.83it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00, 20.27it/s]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 71/4096 [00:00<00:05, 708.81it/s]
Adding requests:   3%|▎         | 142/4096 [00:00<00:05, 698.62it/s]
Adding requests:   5%|▌         | 212/4096 [00:00<00:05, 697.51it/s]
Adding requests:   7%|▋         | 289/4096 [00:00<00:05, 724.08it/s]
Adding requests:   9%|▉         | 365/4096 [00:00<00:05, 736.42it/s]
Adding requests:  11%|█         | 441/4096 [00:00<00:04, 743.65it/s]
Adding requests:  13%|█▎        | 516/4096 [00:00<00:04, 736.75it/s]
Adding requests:  14%|█▍        | 590/4096 [00:00<00:04, 733.79it/s]
Adding requests:  16%|█▋        | 666/4096 [00:00<00:04, 740.05it/s]
Adding requests:  18%|█▊        | 743/4096 [00:01<00:04, 749.16it/s]
Adding requests:  20%|█▉        | 818/4096 [00:01<00:04, 739.68it/s]
Adding requests:  22%|██▏       | 895/4096 [00:01<00:04, 746.07it/s]
Adding requests:  24%|██▎       | 970/4096 [00:01<00:04, 744.01it/s]
Adding requests:  26%|██▌       | 1045/4096 [00:01<00:04, 732.17it/s]
Adding requests:  27%|██▋       | 1119/4096 [00:01<00:04, 734.27it/s]
Adding requests:  29%|██▉       | 1197/4096 [00:01<00:03, 746.92it/s]
Adding requests:  31%|███       | 1272/4096 [00:01<00:03, 745.11it/s]
Adding requests:  33%|███▎      | 1350/4096 [00:01<00:03, 754.16it/s]
Adding requests:  35%|███▍      | 1429/4096 [00:01<00:03, 762.70it/s]
Adding requests:  37%|███▋      | 1509/4096 [00:02<00:03, 773.57it/s]
Adding requests:  39%|███▉      | 1589/4096 [00:02<00:03, 779.22it/s]
Adding requests:  41%|████      | 1667/4096 [00:02<00:03, 773.27it/s]
Adding requests:  43%|████▎     | 1745/4096 [00:02<00:03, 773.73it/s]
Adding requests:  45%|████▍     | 1823/4096 [00:02<00:02, 769.60it/s]
Adding requests:  46%|████▋     | 1901/4096 [00:02<00:02, 771.85it/s]
Adding requests:  48%|████▊     | 1979/4096 [00:02<00:02, 772.02it/s]
Adding requests:  50%|█████     | 2057/4096 [00:02<00:02, 768.71it/s]
Adding requests:  52%|█████▏    | 2134/4096 [00:02<00:02, 743.20it/s]
Adding requests:  54%|█████▍    | 2209/4096 [00:02<00:02, 730.59it/s]
Adding requests:  56%|█████▌    | 2288/4096 [00:03<00:02, 745.13it/s]
Adding requests:  58%|█████▊    | 2365/4096 [00:03<00:02, 750.24it/s]
Adding requests:  60%|█████▉    | 2442/4096 [00:03<00:02, 754.05it/s]
Adding requests:  61%|██████▏   | 2518/4096 [00:03<00:02, 754.80it/s]
Adding requests:  63%|██████▎   | 2595/4096 [00:03<00:01, 758.45it/s]
Adding requests:  65%|██████▌   | 2673/4096 [00:03<00:01, 763.92it/s]
Adding requests:  67%|██████▋   | 2750/4096 [00:03<00:01, 765.18it/s]
Adding requests:  69%|██████▉   | 2827/4096 [00:03<00:01, 755.60it/s]
Adding requests:  71%|███████   | 2905/4096 [00:03<00:01, 762.73it/s]
Adding requests:  73%|███████▎  | 2982/4096 [00:03<00:01, 759.16it/s]
Adding requests:  75%|███████▍  | 3059/4096 [00:04<00:01, 759.46it/s]
Adding requests:  77%|███████▋  | 3136/4096 [00:04<00:01, 758.71it/s]
Adding requests:  78%|███████▊  | 3212/4096 [00:04<00:01, 757.92it/s]
Adding requests:  80%|████████  | 3288/4096 [00:04<00:01, 757.90it/s]
Adding requests:  82%|████████▏ | 3365/4096 [00:04<00:00, 761.22it/s]
Adding requests:  84%|████████▍ | 3442/4096 [00:04<00:00, 760.64it/s]
Adding requests:  86%|████████▌ | 3519/4096 [00:04<00:00, 756.38it/s]
Adding requests:  88%|████████▊ | 3595/4096 [00:04<00:00, 747.09it/s]
Adding requests:  90%|████████▉ | 3671/4096 [00:04<00:00, 749.77it/s]
Adding requests:  91%|█████████▏| 3747/4096 [00:04<00:00, 752.78it/s]
Adding requests:  93%|█████████▎| 3828/4096 [00:05<00:00, 767.97it/s]
Adding requests:  95%|█████████▌| 3907/4096 [00:05<00:00, 773.09it/s]
Adding requests:  97%|█████████▋| 3985/4096 [00:05<00:00, 767.65it/s]
Adding requests:  99%|█████████▉| 4062/4096 [00:05<00:00, 766.73it/s]
Adding requests: 100%|██████████| 4096/4096 [00:05<00:00, 754.35it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▌         | 226/4096 [00:00<00:02, 1694.23it/s, est. speed input: 1735092.16 toks/s, output: 1694.29 toks/s]
Processed prompts:  10%|▉         | 396/4096 [00:03<00:39, 93.21it/s, est. speed input: 113870.18 toks/s, output: 111.20 toks/s]    
Processed prompts:  11%|█▏        | 469/4096 [00:04<00:45, 78.91it/s, est. speed input: 97355.17 toks/s, output: 95.07 toks/s]  
Processed prompts:  12%|█▏        | 511/4096 [00:05<00:47, 75.31it/s, est. speed input: 93123.21 toks/s, output: 90.94 toks/s]
Processed prompts:  13%|█▎        | 539/4096 [00:06<00:52, 67.54it/s, est. speed input: 87539.22 toks/s, output: 85.49 toks/s]
Processed prompts:  14%|█▎        | 559/4096 [00:06<01:00, 58.20it/s, est. speed input: 81878.05 toks/s, output: 79.96 toks/s]
Processed prompts:  14%|█▍        | 578/4096 [00:07<01:09, 50.33it/s, est. speed input: 77096.65 toks/s, output: 75.29 toks/s]
Processed prompts:  15%|█▍        | 610/4096 [00:08<01:10, 49.33it/s, est. speed input: 74686.23 toks/s, output: 72.94 toks/s]
Processed prompts:  16%|█▌        | 642/4096 [00:09<01:11, 48.57it/s, est. speed input: 72642.44 toks/s, output: 70.94 toks/s]
Processed prompts:  16%|█▋        | 674/4096 [00:09<01:11, 48.02it/s, est. speed input: 70886.20 toks/s, output: 69.22 toks/s]
Processed prompts:  17%|█▋        | 706/4096 [00:10<01:11, 47.62it/s, est. speed input: 69363.23 toks/s, output: 67.74 toks/s]
Processed prompts:  18%|█▊        | 738/4096 [00:11<01:10, 47.32it/s, est. speed input: 68025.66 toks/s, output: 66.43 toks/s]
Processed prompts:  19%|█▉        | 770/4096 [00:11<01:10, 47.11it/s, est. speed input: 66843.49 toks/s, output: 65.28 toks/s]
Processed prompts:  20%|█▉        | 802/4096 [00:12<01:10, 46.96it/s, est. speed input: 65792.72 toks/s, output: 64.25 toks/s]
Processed prompts:  20%|██        | 834/4096 [00:13<01:09, 46.85it/s, est. speed input: 64849.58 toks/s, output: 63.33 toks/s]
Processed prompts:  21%|██        | 866/4096 [00:13<01:09, 46.78it/s, est. speed input: 64000.56 toks/s, output: 62.50 toks/s]
Processed prompts:  22%|██▏       | 898/4096 [00:14<01:08, 46.72it/s, est. speed input: 63231.64 toks/s, output: 61.75 toks/s]
Processed prompts:  23%|██▎       | 930/4096 [00:15<01:07, 46.69it/s, est. speed input: 62532.32 toks/s, output: 61.07 toks/s]
Processed prompts:  23%|██▎       | 962/4096 [00:15<01:07, 46.65it/s, est. speed input: 61891.59 toks/s, output: 60.44 toks/s]
Processed prompts:  24%|██▍       | 994/4096 [00:16<01:06, 46.63it/s, est. speed input: 61304.92 toks/s, output: 59.87 toks/s]
Processed prompts:  25%|██▌       | 1026/4096 [00:17<01:05, 46.61it/s, est. speed input: 60762.54 toks/s, output: 59.34 toks/s]
Processed prompts:  26%|██▌       | 1058/4096 [00:17<01:05, 46.59it/s, est. speed input: 60262.38 toks/s, output: 58.85 toks/s]
Processed prompts:  27%|██▋       | 1090/4096 [00:18<01:04, 46.58it/s, est. speed input: 59799.03 toks/s, output: 58.40 toks/s]
Processed prompts:  27%|██▋       | 1122/4096 [00:19<01:03, 46.58it/s, est. speed input: 59368.79 toks/s, output: 57.98 toks/s]
Processed prompts:  28%|██▊       | 1154/4096 [00:20<01:03, 46.65it/s, est. speed input: 58979.38 toks/s, output: 57.60 toks/s]
Processed prompts:  29%|██▉       | 1186/4096 [00:20<01:02, 46.63it/s, est. speed input: 58605.12 toks/s, output: 57.23 toks/s]
Processed prompts:  30%|██▉       | 1218/4096 [00:21<01:01, 46.61it/s, est. speed input: 58254.16 toks/s, output: 56.89 toks/s]
Processed prompts:  31%|███       | 1250/4096 [00:22<01:01, 46.59it/s, est. speed input: 57924.87 toks/s, output: 56.57 toks/s]
Processed prompts:  31%|███▏      | 1282/4096 [00:22<01:00, 46.53it/s, est. speed input: 57609.31 toks/s, output: 56.26 toks/s]
Processed prompts:  32%|███▏      | 1314/4096 [00:23<00:59, 46.55it/s, est. speed input: 57319.26 toks/s, output: 55.98 toks/s]
Processed prompts:  33%|███▎      | 1346/4096 [00:24<00:59, 46.55it/s, est. speed input: 57044.53 toks/s, output: 55.71 toks/s]
Processed prompts:  34%|███▎      | 1378/4096 [00:24<00:58, 46.55it/s, est. speed input: 56785.52 toks/s, output: 55.45 toks/s]
Processed prompts:  34%|███▍      | 1410/4096 [00:25<00:57, 46.56it/s, est. speed input: 56540.70 toks/s, output: 55.22 toks/s]
Processed prompts:  35%|███▌      | 1442/4096 [00:26<00:57, 46.55it/s, est. speed input: 56308.01 toks/s, output: 54.99 toks/s]
Processed prompts:  36%|███▌      | 1474/4096 [00:26<00:56, 46.55it/s, est. speed input: 56086.73 toks/s, output: 54.77 toks/s]
Processed prompts:  37%|███▋      | 1506/4096 [00:27<00:55, 46.55it/s, est. speed input: 55877.58 toks/s, output: 54.57 toks/s]
Processed prompts:  38%|███▊      | 1538/4096 [00:28<00:54, 46.55it/s, est. speed input: 55677.88 toks/s, output: 54.37 toks/s]
Processed prompts:  38%|███▊      | 1570/4096 [00:28<00:54, 46.54it/s, est. speed input: 55486.95 toks/s, output: 54.19 toks/s]
Processed prompts:  39%|███▉      | 1602/4096 [00:29<00:53, 46.54it/s, est. speed input: 55305.68 toks/s, output: 54.01 toks/s]
Processed prompts:  40%|███▉      | 1634/4096 [00:30<00:52, 46.54it/s, est. speed input: 55132.35 toks/s, output: 53.84 toks/s]
Processed prompts:  41%|████      | 1666/4096 [00:31<00:52, 46.53it/s, est. speed input: 54966.04 toks/s, output: 53.68 toks/s]
Processed prompts:  41%|████▏     | 1698/4096 [00:31<00:51, 46.54it/s, est. speed input: 54807.78 toks/s, output: 53.52 toks/s]
Processed prompts:  42%|████▏     | 1730/4096 [00:32<00:50, 46.54it/s, est. speed input: 54656.04 toks/s, output: 53.38 toks/s]
Processed prompts:  43%|████▎     | 1762/4096 [00:33<00:50, 46.53it/s, est. speed input: 54509.68 toks/s, output: 53.23 toks/s]
Processed prompts:  44%|████▍     | 1794/4096 [00:33<00:49, 46.52it/s, est. speed input: 54369.66 toks/s, output: 53.10 toks/s]
Processed prompts:  45%|████▍     | 1826/4096 [00:34<00:48, 46.52it/s, est. speed input: 54235.36 toks/s, output: 52.96 toks/s]
Processed prompts:  45%|████▌     | 1858/4096 [00:35<00:48, 46.08it/s, est. speed input: 54072.57 toks/s, output: 52.81 toks/s]
Processed prompts:  46%|████▌     | 1890/4096 [00:35<00:47, 46.21it/s, est. speed input: 53948.96 toks/s, output: 52.68 toks/s]
Processed prompts:  47%|████▋     | 1922/4096 [00:36<00:46, 46.31it/s, est. speed input: 53830.87 toks/s, output: 52.57 toks/s]
Processed prompts:  48%|████▊     | 1954/4096 [00:37<00:46, 46.37it/s, est. speed input: 53716.18 toks/s, output: 52.46 toks/s]
Processed prompts:  48%|████▊     | 1986/4096 [00:37<00:45, 46.41it/s, est. speed input: 53605.38 toks/s, output: 52.35 toks/s]
Processed prompts:  49%|████▉     | 2018/4096 [00:38<00:44, 46.44it/s, est. speed input: 53498.96 toks/s, output: 52.25 toks/s]
Processed prompts:  50%|█████     | 2050/4096 [00:39<00:44, 46.46it/s, est. speed input: 53396.01 toks/s, output: 52.14 toks/s]
Processed prompts:  51%|█████     | 2082/4096 [00:40<00:43, 46.47it/s, est. speed input: 53296.86 toks/s, output: 52.05 toks/s]
Processed prompts:  52%|█████▏    | 2114/4096 [00:40<00:42, 46.48it/s, est. speed input: 53200.69 toks/s, output: 51.95 toks/s]
Processed prompts:  52%|█████▏    | 2146/4096 [00:41<00:41, 46.49it/s, est. speed input: 53108.17 toks/s, output: 51.86 toks/s]
Processed prompts:  53%|█████▎    | 2178/4096 [00:42<00:41, 46.49it/s, est. speed input: 53018.18 toks/s, output: 51.78 toks/s]
Processed prompts:  54%|█████▍    | 2210/4096 [00:42<00:40, 46.49it/s, est. speed input: 52931.19 toks/s, output: 51.69 toks/s]
Processed prompts:  55%|█████▍    | 2242/4096 [00:43<00:39, 46.50it/s, est. speed input: 52847.27 toks/s, output: 51.61 toks/s]
Processed prompts:  56%|█████▌    | 2274/4096 [00:44<00:39, 46.49it/s, est. speed input: 52765.23 toks/s, output: 51.53 toks/s]
Processed prompts:  56%|█████▋    | 2306/4096 [00:44<00:38, 46.51it/s, est. speed input: 52686.91 toks/s, output: 51.45 toks/s]
Processed prompts:  57%|█████▋    | 2338/4096 [00:45<00:37, 46.50it/s, est. speed input: 52609.99 toks/s, output: 51.38 toks/s]
Processed prompts:  58%|█████▊    | 2370/4096 [00:46<00:37, 46.50it/s, est. speed input: 52535.76 toks/s, output: 51.30 toks/s]
Processed prompts:  59%|█████▊    | 2402/4096 [00:46<00:36, 46.50it/s, est. speed input: 52463.25 toks/s, output: 51.23 toks/s]
Processed prompts:  59%|█████▉    | 2434/4096 [00:47<00:35, 46.49it/s, est. speed input: 52392.54 toks/s, output: 51.16 toks/s]
Processed prompts:  60%|██████    | 2466/4096 [00:48<00:35, 46.49it/s, est. speed input: 52324.15 toks/s, output: 51.10 toks/s]
Processed prompts:  61%|██████    | 2498/4096 [00:48<00:34, 46.89it/s, est. speed input: 52278.94 toks/s, output: 51.05 toks/s]
Processed prompts:  62%|██████▏   | 2530/4096 [00:49<00:33, 46.77it/s, est. speed input: 52213.94 toks/s, output: 50.99 toks/s]
Processed prompts:  63%|██████▎   | 2562/4096 [00:50<00:32, 46.69it/s, est. speed input: 52150.98 toks/s, output: 50.93 toks/s]
Processed prompts:  63%|██████▎   | 2594/4096 [00:50<00:32, 46.62it/s, est. speed input: 52089.22 toks/s, output: 50.87 toks/s]
Processed prompts:  64%|██████▍   | 2626/4096 [00:51<00:31, 46.58it/s, est. speed input: 52029.69 toks/s, output: 50.81 toks/s]
Processed prompts:  65%|██████▍   | 2658/4096 [00:52<00:30, 46.55it/s, est. speed input: 51971.34 toks/s, output: 50.75 toks/s]
Processed prompts:  66%|██████▌   | 2690/4096 [00:53<00:30, 46.52it/s, est. speed input: 51914.32 toks/s, output: 50.70 toks/s]
Processed prompts:  66%|██████▋   | 2722/4096 [00:53<00:29, 46.51it/s, est. speed input: 51858.96 toks/s, output: 50.64 toks/s]
Processed prompts:  67%|██████▋   | 2754/4096 [00:54<00:28, 46.49it/s, est. speed input: 51804.70 toks/s, output: 50.59 toks/s]
Processed prompts:  68%|██████▊   | 2786/4096 [00:55<00:28, 46.50it/s, est. speed input: 51752.62 toks/s, output: 50.54 toks/s]
Processed prompts:  69%|██████▉   | 2818/4096 [00:55<00:27, 46.48it/s, est. speed input: 51700.67 toks/s, output: 50.49 toks/s]
Processed prompts:  70%|██████▉   | 2850/4096 [00:56<00:26, 46.49it/s, est. speed input: 51651.12 toks/s, output: 50.44 toks/s]
Processed prompts:  70%|███████   | 2882/4096 [00:57<00:26, 46.47it/s, est. speed input: 51601.42 toks/s, output: 50.39 toks/s]
Processed prompts:  71%|███████   | 2914/4096 [00:57<00:25, 46.46it/s, est. speed input: 51553.30 toks/s, output: 50.35 toks/s]
Processed prompts:  72%|███████▏  | 2946/4096 [00:58<00:24, 46.46it/s, est. speed input: 51506.69 toks/s, output: 50.30 toks/s]
Processed prompts:  73%|███████▎  | 2978/4096 [00:59<00:24, 46.46it/s, est. speed input: 51460.81 toks/s, output: 50.25 toks/s]
Processed prompts:  73%|███████▎  | 3010/4096 [00:59<00:23, 46.46it/s, est. speed input: 51416.01 toks/s, output: 50.21 toks/s]
Processed prompts:  74%|███████▍  | 3042/4096 [01:00<00:22, 46.46it/s, est. speed input: 51372.67 toks/s, output: 50.17 toks/s]
Processed prompts:  75%|███████▌  | 3074/4096 [01:01<00:21, 46.46it/s, est. speed input: 51330.06 toks/s, output: 50.13 toks/s]
Processed prompts:  76%|███████▌  | 3106/4096 [01:02<00:21, 46.45it/s, est. speed input: 51287.86 toks/s, output: 50.09 toks/s]
Processed prompts:  77%|███████▋  | 3138/4096 [01:02<00:20, 46.46it/s, est. speed input: 51247.15 toks/s, output: 50.05 toks/s]
Processed prompts:  77%|███████▋  | 3170/4096 [01:03<00:19, 46.46it/s, est. speed input: 51207.19 toks/s, output: 50.01 toks/s]
Processed prompts:  78%|███████▊  | 3202/4096 [01:04<00:19, 46.46it/s, est. speed input: 51168.18 toks/s, output: 49.97 toks/s]
Processed prompts:  79%|███████▉  | 3234/4096 [01:04<00:18, 46.46it/s, est. speed input: 51129.94 toks/s, output: 49.93 toks/s]
Processed prompts:  80%|███████▉  | 3266/4096 [01:05<00:17, 46.46it/s, est. speed input: 51092.70 toks/s, output: 49.90 toks/s]
Processed prompts:  81%|████████  | 3298/4096 [01:06<00:17, 46.46it/s, est. speed input: 51056.08 toks/s, output: 49.86 toks/s]
Processed prompts:  81%|████████▏ | 3330/4096 [01:06<00:16, 46.46it/s, est. speed input: 51020.18 toks/s, output: 49.82 toks/s]
Processed prompts:  82%|████████▏ | 3362/4096 [01:07<00:15, 46.46it/s, est. speed input: 50985.08 toks/s, output: 49.79 toks/s]
Processed prompts:  83%|████████▎ | 3394/4096 [01:08<00:15, 46.46it/s, est. speed input: 50950.44 toks/s, output: 49.76 toks/s]
Processed prompts:  84%|████████▎ | 3426/4096 [01:08<00:14, 46.44it/s, est. speed input: 50916.24 toks/s, output: 49.72 toks/s]
Processed prompts:  84%|████████▍ | 3458/4096 [01:09<00:13, 46.45it/s, est. speed input: 50883.32 toks/s, output: 49.69 toks/s]
Processed prompts:  85%|████████▌ | 3490/4096 [01:10<00:13, 46.45it/s, est. speed input: 50850.85 toks/s, output: 49.66 toks/s]
Processed prompts:  86%|████████▌ | 3522/4096 [01:10<00:12, 46.45it/s, est. speed input: 50818.86 toks/s, output: 49.63 toks/s]
Processed prompts:  87%|████████▋ | 3554/4096 [01:11<00:11, 46.46it/s, est. speed input: 50787.82 toks/s, output: 49.60 toks/s]
Processed prompts:  88%|████████▊ | 3586/4096 [01:12<00:10, 46.45it/s, est. speed input: 50757.07 toks/s, output: 49.57 toks/s]
Processed prompts:  88%|████████▊ | 3618/4096 [01:13<00:10, 46.45it/s, est. speed input: 50726.89 toks/s, output: 49.54 toks/s]
Processed prompts:  89%|████████▉ | 3650/4096 [01:13<00:09, 46.45it/s, est. speed input: 50697.35 toks/s, output: 49.51 toks/s]
Processed prompts:  90%|████████▉ | 3682/4096 [01:14<00:08, 46.45it/s, est. speed input: 50668.43 toks/s, output: 49.48 toks/s]
Processed prompts:  91%|█████████ | 3714/4096 [01:15<00:08, 46.45it/s, est. speed input: 50639.81 toks/s, output: 49.45 toks/s]
Processed prompts:  91%|█████████▏| 3746/4096 [01:15<00:07, 46.45it/s, est. speed input: 50611.76 toks/s, output: 49.43 toks/s]
Processed prompts:  92%|█████████▏| 3778/4096 [01:16<00:06, 46.45it/s, est. speed input: 50584.36 toks/s, output: 49.40 toks/s]
Processed prompts:  93%|█████████▎| 3810/4096 [01:17<00:06, 46.45it/s, est. speed input: 50557.30 toks/s, output: 49.37 toks/s]
Processed prompts:  94%|█████████▍| 3842/4096 [01:17<00:05, 46.45it/s, est. speed input: 50530.92 toks/s, output: 49.35 toks/s]
Processed prompts:  95%|█████████▍| 3874/4096 [01:18<00:04, 46.45it/s, est. speed input: 50504.81 toks/s, output: 49.32 toks/s]
Processed prompts:  95%|█████████▌| 3906/4096 [01:19<00:04, 46.44it/s, est. speed input: 50479.01 toks/s, output: 49.30 toks/s]
Processed prompts:  96%|█████████▌| 3938/4096 [01:19<00:03, 46.44it/s, est. speed input: 50453.67 toks/s, output: 49.27 toks/s]
Processed prompts:  97%|█████████▋| 3970/4096 [01:20<00:02, 46.44it/s, est. speed input: 50428.83 toks/s, output: 49.25 toks/s]
Processed prompts:  98%|█████████▊| 4002/4096 [01:21<00:02, 46.44it/s, est. speed input: 50404.45 toks/s, output: 49.22 toks/s]
Processed prompts:  98%|█████████▊| 4034/4096 [01:21<00:01, 46.85it/s, est. speed input: 50392.97 toks/s, output: 49.21 toks/s]
Processed prompts:  99%|█████████▉| 4066/4096 [01:22<00:00, 47.19it/s, est. speed input: 50382.90 toks/s, output: 49.20 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [01:22<00:00, 47.19it/s, est. speed input: 50754.47 toks/s, output: 49.56 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [01:22<00:00, 49.56it/s, est. speed input: 50754.47 toks/s, output: 49.56 toks/s]
[rank0]:[W128 00:25:33.274863278 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 122.4s

测试结果:
  Requests/s:   46.51
  Tokens/s:     47671.14
  Total Reqs:   4096
  Elapsed:      88.07s

  [Prefill 分析]
  Total Prefill Tokens: 4194304
  Prefill Tokens/s:     47624.63


------------------------------------------------------------
  生成 CSV: BitNet-2B-INT8
------------------------------------------------------------
[SUCCESS] CSV 保存到: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX5080_cc120_INT8_py312_cu129_x86_64/cusparselt/2_6/BitNet-2B-INT8_prefill.csv

预览:
------------------------------------------------------------
M_prefill,prompt_len,max_num_seqs,num_prompts,N_prefill,requests_per_s,tokens_per_s,elapsed_time_s
512,512,1,128,128,54.9489,28188.7923,2.3294
1024,1024,1,128,128,45.4969,46634.2806,2.8134
2048,1024,2,256,128,49.2372,50468.1719,5.1993
4096,1024,4,512,128,50.1164,51369.3295,10.2162
8192,1024,8,1024,128,47.6983,48890.7076,21.4683
16384,1024,16,2048,128,46.5921,47756.8899,43.9560
32768,1024,32,4096,128,46.5084,47671.1365,88.0701

------------------------------------------------------------

[INFO] 完成: 7 成功, 0 失败

============================================================
  BitNet-2B-INT8 | cuSPARSELt (2_8) | prefill
============================================================

[INFO] Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_8
[INFO] Output: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX5080_cc120_INT8_py312_cu129_x86_64/cusparselt/2_8

============================================================
[1/7] 测试 M=512
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-INT8                                  │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 512
│   M_prefill     = 512 (= 1 x 512)
│   M_decode      = 1
│   batched_tokens = 513 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 512
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 513
│   --max-num-batched-tokens = 513
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:25:38 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3478272) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3478272) WARNING 01-28 00:25:47 [backends.py:609] Failed to read file <frozen os>
Throughput: 55.61 requests/s, 28528.51 total tokens/s, 55.61 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128


─── STDERR ───
[2026-01-28 00:25:38] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:25:38] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:25:38] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:25:38] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:25:38] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:25:38] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:25:38] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:25:38] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:25:38] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:25:38] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:25:38] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:25:38] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:25:38] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:25:38] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:25:42] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:25:42] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:25:42] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:25:42] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:25:42] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:25:42] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:25:42] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:25:42] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:25:42] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:25:42] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:25:42] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:25:42] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:25:42] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:25:42] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3478272) [2026-01-28 00:25:43] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3478272) [2026-01-28 00:25:43] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3478272) [2026-01-28 00:25:43] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3478272) [2026-01-28 00:25:43] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=3478272) [2026-01-28 00:25:43] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=3478272) [2026-01-28 00:25:43] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=3478272) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3478272) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.67it/s]
(EngineCore_DP0 pid=3478272) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.67it/s]
(EngineCore_DP0 pid=3478272) 
(EngineCore_DP0 pid=3478272) [2026-01-28 00:25:43] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 3840] -> 1D uint8
(EngineCore_DP0 pid=3478272) [2026-01-28 00:25:43] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 11059200 bytes
(EngineCore_DP0 pid=3478272) [2026-01-28 00:25:43] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 3840] -> 1D uint8
(EngineCore_DP0 pid=3478272) [2026-01-28 00:25:43] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7372800 bytes
(EngineCore_DP0 pid=3478272) [2026-01-28 00:25:43] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 3840] -> 1D uint8
(EngineCore_DP0 pid=3478272) [2026-01-28 00:25:43] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 39813120 bytes
(EngineCore_DP0 pid=3478272) [2026-01-28 00:25:43] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 10368] -> 1D uint8
(EngineCore_DP0 pid=3478272) [2026-01-28 00:25:43] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 19906560 bytes
(EngineCore_DP0 pid=3478272) 2026-01-28 00:25:53,999 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3478272) 2026-01-28 00:25:54,016 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3478272) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  3.83it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  4.12it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  4.07it/s]
(EngineCore_DP0 pid=3478272) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.29it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.28it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  92%|█████████▏| 118/128 [00:00<00:00, 1174.94it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 1188.36it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:20,  6.12it/s, est. speed input: 3133.93 toks/s, output: 6.12 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:00<00:03, 33.96it/s, est. speed input: 14855.39 toks/s, output: 29.01 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:00<00:02, 45.91it/s, est. speed input: 19850.86 toks/s, output: 38.77 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:00<00:02, 52.31it/s, est. speed input: 22637.02 toks/s, output: 44.21 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:00<00:01, 56.07it/s, est. speed input: 24405.80 toks/s, output: 47.67 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:00<00:01, 58.34it/s, est. speed input: 25612.59 toks/s, output: 50.02 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:00<00:01, 60.03it/s, est. speed input: 26537.82 toks/s, output: 51.83 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:00<00:01, 60.80it/s, est. speed input: 27185.55 toks/s, output: 53.10 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:01<00:01, 61.25it/s, est. speed input: 27684.62 toks/s, output: 54.07 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:01<00:01, 61.59it/s, est. speed input: 28092.29 toks/s, output: 54.87 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:01<00:00, 61.65it/s, est. speed input: 28405.39 toks/s, output: 55.48 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:01<00:00, 62.17it/s, est. speed input: 28728.26 toks/s, output: 56.11 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:01<00:00, 62.53it/s, est. speed input: 29000.57 toks/s, output: 56.64 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:01<00:00, 62.44it/s, est. speed input: 29200.42 toks/s, output: 57.03 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:01<00:00, 61.85it/s, est. speed input: 29319.80 toks/s, output: 57.27 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:01<00:00, 62.30it/s, est. speed input: 29508.24 toks/s, output: 57.63 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:01<00:00, 62.50it/s, est. speed input: 29663.38 toks/s, output: 57.94 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:02<00:00, 62.12it/s, est. speed input: 29757.83 toks/s, output: 58.12 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:02<00:00, 62.18it/s, est. speed input: 29868.45 toks/s, output: 58.34 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:02<00:00, 62.18it/s, est. speed input: 29884.56 toks/s, output: 58.37 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:02<00:00, 58.37it/s, est. speed input: 29884.56 toks/s, output: 58.37 toks/s]
[rank0]:[W128 00:25:58.864529107 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 24.6s

测试结果:
  Requests/s:   55.61
  Tokens/s:     28528.51
  Total Reqs:   128
  Elapsed:      2.30s

  [Prefill 分析]
  Total Prefill Tokens: 65536
  Prefill Tokens/s:     28472.90

============================================================
[2/7] 测试 M=1024
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-INT8                                  │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 1024
│   M_prefill     = 1024 (= 1 x 1024)
│   M_decode      = 1
│   batched_tokens = 1025 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 1025
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:26:03 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3478948) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3478948) WARNING 01-28 00:26:12 [backends.py:609] Failed to read file <frozen os>
Throughput: 44.32 requests/s, 45430.53 total tokens/s, 44.32 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128


─── STDERR ───
[2026-01-28 00:26:03] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:26:03] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:26:03] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:26:03] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:26:03] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:26:03] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:26:03] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:26:03] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:26:03] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:26:03] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:26:03] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:26:03] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:26:03] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:26:03] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:26:07] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:26:07] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:26:07] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:26:07] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:26:07] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:26:07] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:26:07] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:26:07] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:26:07] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:26:07] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:26:07] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:26:07] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:26:07] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:26:07] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3478948) [2026-01-28 00:26:08] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3478948) [2026-01-28 00:26:08] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3478948) [2026-01-28 00:26:08] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3478948) [2026-01-28 00:26:08] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=3478948) [2026-01-28 00:26:08] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=3478948) [2026-01-28 00:26:08] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=3478948) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3478948) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.63it/s]
(EngineCore_DP0 pid=3478948) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.63it/s]
(EngineCore_DP0 pid=3478948) 
(EngineCore_DP0 pid=3478948) [2026-01-28 00:26:08] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 3840] -> 1D uint8
(EngineCore_DP0 pid=3478948) [2026-01-28 00:26:08] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 11059200 bytes
(EngineCore_DP0 pid=3478948) [2026-01-28 00:26:08] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 3840] -> 1D uint8
(EngineCore_DP0 pid=3478948) [2026-01-28 00:26:08] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7372800 bytes
(EngineCore_DP0 pid=3478948) [2026-01-28 00:26:08] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 3840] -> 1D uint8
(EngineCore_DP0 pid=3478948) [2026-01-28 00:26:08] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 39813120 bytes
(EngineCore_DP0 pid=3478948) [2026-01-28 00:26:08] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 10368] -> 1D uint8
(EngineCore_DP0 pid=3478948) [2026-01-28 00:26:08] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 19906560 bytes
(EngineCore_DP0 pid=3478948) 2026-01-28 00:26:18,815 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3478948) 2026-01-28 00:26:18,831 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3478948) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00, 23.69it/s]
(EngineCore_DP0 pid=3478948) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.40it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.40it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  50%|█████     | 64/128 [00:00<00:00, 634.32it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 679.61it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 2/128 [00:00<00:06, 19.34it/s, est. speed input: 19809.59 toks/s, output: 19.34 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:03, 36.41it/s, est. speed input: 34666.83 toks/s, output: 33.85 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:00<00:02, 41.95it/s, est. speed input: 39672.00 toks/s, output: 38.74 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:00<00:02, 44.57it/s, est. speed input: 42192.08 toks/s, output: 41.20 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:00<00:02, 46.10it/s, est. speed input: 43746.43 toks/s, output: 42.72 toks/s]
Processed prompts:  21%|██        | 27/128 [00:00<00:02, 47.01it/s, est. speed input: 44774.29 toks/s, output: 43.72 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:00<00:02, 47.46it/s, est. speed input: 45460.30 toks/s, output: 44.39 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:00<00:01, 47.81it/s, est. speed input: 45991.43 toks/s, output: 44.91 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:00<00:01, 48.15it/s, est. speed input: 46443.29 toks/s, output: 45.35 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:01<00:01, 48.37it/s, est. speed input: 46801.84 toks/s, output: 45.70 toks/s]
Processed prompts:  41%|████      | 52/128 [00:01<00:01, 48.41it/s, est. speed input: 47060.90 toks/s, output: 45.96 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:01<00:01, 48.26it/s, est. speed input: 47232.56 toks/s, output: 46.12 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:01<00:01, 48.37it/s, est. speed input: 47427.58 toks/s, output: 46.32 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:01<00:01, 48.42it/s, est. speed input: 47589.71 toks/s, output: 46.47 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:01<00:01, 48.51it/s, est. speed input: 47743.43 toks/s, output: 46.62 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:01<00:01, 48.61it/s, est. speed input: 47883.54 toks/s, output: 46.76 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:01<00:00, 48.62it/s, est. speed input: 47998.05 toks/s, output: 46.87 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:01<00:00, 48.65it/s, est. speed input: 48101.75 toks/s, output: 46.97 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:01<00:00, 48.65it/s, est. speed input: 48192.71 toks/s, output: 47.06 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:02<00:00, 48.68it/s, est. speed input: 48278.47 toks/s, output: 47.15 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:02<00:00, 48.65it/s, est. speed input: 48348.45 toks/s, output: 47.21 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:02<00:00, 48.56it/s, est. speed input: 48402.29 toks/s, output: 47.27 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:02<00:00, 48.50it/s, est. speed input: 48451.14 toks/s, output: 47.32 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:02<00:00, 48.47it/s, est. speed input: 48500.48 toks/s, output: 47.36 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:02<00:00, 48.30it/s, est. speed input: 48519.28 toks/s, output: 47.38 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:02<00:00, 48.45it/s, est. speed input: 48576.08 toks/s, output: 47.44 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:02<00:00, 48.45it/s, est. speed input: 48584.80 toks/s, output: 47.45 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:02<00:00, 47.44it/s, est. speed input: 48584.80 toks/s, output: 47.45 toks/s]
[rank0]:[W128 00:26:23.841813717 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 25.0s

测试结果:
  Requests/s:   44.32
  Tokens/s:     45430.53
  Total Reqs:   128
  Elapsed:      2.89s

  [Prefill 分析]
  Total Prefill Tokens: 131072
  Prefill Tokens/s:     45386.21

============================================================
[3/7] 测试 M=2048
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-INT8                                  │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 2048
│   M_prefill     = 2048 (= 2 x 1024)
│   M_decode      = 2
│   batched_tokens = 2048 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 256
│   --max-num-seqs           = 2
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 2048
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:26:28 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3479584) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3479584) WARNING 01-28 00:26:38 [backends.py:609] Failed to read file <frozen os>
Throughput: 49.46 requests/s, 50694.47 total tokens/s, 49.46 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256


─── STDERR ───
[2026-01-28 00:26:28] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:26:28] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:26:28] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:26:28] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:26:28] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:26:28] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:26:28] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:26:28] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:26:28] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:26:28] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:26:28] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:26:28] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:26:28] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:26:28] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:26:32] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:26:32] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:26:32] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:26:32] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:26:32] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:26:32] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:26:32] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:26:32] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:26:32] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:26:32] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:26:32] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:26:32] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:26:32] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:26:32] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3479584) [2026-01-28 00:26:33] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3479584) [2026-01-28 00:26:33] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3479584) [2026-01-28 00:26:33] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3479584) [2026-01-28 00:26:33] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=3479584) [2026-01-28 00:26:33] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=3479584) [2026-01-28 00:26:33] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=3479584) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3479584) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.61it/s]
(EngineCore_DP0 pid=3479584) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.61it/s]
(EngineCore_DP0 pid=3479584) 
(EngineCore_DP0 pid=3479584) [2026-01-28 00:26:33] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 3840] -> 1D uint8
(EngineCore_DP0 pid=3479584) [2026-01-28 00:26:33] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 11059200 bytes
(EngineCore_DP0 pid=3479584) [2026-01-28 00:26:33] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 3840] -> 1D uint8
(EngineCore_DP0 pid=3479584) [2026-01-28 00:26:33] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7372800 bytes
(EngineCore_DP0 pid=3479584) [2026-01-28 00:26:33] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 3840] -> 1D uint8
(EngineCore_DP0 pid=3479584) [2026-01-28 00:26:33] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 39813120 bytes
(EngineCore_DP0 pid=3479584) [2026-01-28 00:26:33] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 10368] -> 1D uint8
(EngineCore_DP0 pid=3479584) [2026-01-28 00:26:33] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 19906560 bytes
(EngineCore_DP0 pid=3479584) 2026-01-28 00:26:44,073 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3479584) 2026-01-28 00:26:44,088 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3479584) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00, 22.47it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00, 22.46it/s]
(EngineCore_DP0 pid=3479584) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 1/2 [00:00<00:00,  7.26it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00, 11.61it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  27%|██▋       | 69/256 [00:00<00:00, 689.92it/s]
Adding requests:  57%|█████▋    | 145/256 [00:00<00:00, 726.68it/s]
Adding requests:  86%|████████▌ | 219/256 [00:00<00:00, 732.54it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 734.69it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   8%|▊         | 20/256 [00:00<00:01, 151.56it/s, est. speed input: 155205.66 toks/s, output: 151.56 toks/s]
Processed prompts:  14%|█▍        | 36/256 [00:00<00:03, 72.84it/s, est. speed input: 81663.51 toks/s, output: 79.75 toks/s]   
Processed prompts:  18%|█▊        | 46/256 [00:00<00:03, 63.49it/s, est. speed input: 72312.65 toks/s, output: 70.62 toks/s]
Processed prompts:  21%|██        | 54/256 [00:00<00:03, 59.22it/s, est. speed input: 68174.34 toks/s, output: 66.58 toks/s]
Processed prompts:  24%|██▍       | 61/256 [00:00<00:03, 59.02it/s, est. speed input: 67100.13 toks/s, output: 65.53 toks/s]
Processed prompts:  27%|██▋       | 68/256 [00:01<00:03, 54.10it/s, est. speed input: 63864.87 toks/s, output: 62.37 toks/s]
Processed prompts:  29%|██▉       | 74/256 [00:01<00:03, 53.03it/s, est. speed input: 62608.68 toks/s, output: 61.14 toks/s]
Processed prompts:  31%|███▏      | 80/256 [00:01<00:03, 52.28it/s, est. speed input: 61604.51 toks/s, output: 60.16 toks/s]
Processed prompts:  34%|███▎      | 86/256 [00:01<00:03, 51.65it/s, est. speed input: 60745.20 toks/s, output: 59.32 toks/s]
Processed prompts:  36%|███▌      | 92/256 [00:01<00:03, 51.26it/s, est. speed input: 60040.27 toks/s, output: 58.63 toks/s]
Processed prompts:  38%|███▊      | 98/256 [00:01<00:03, 50.86it/s, est. speed input: 59403.13 toks/s, output: 58.01 toks/s]
Processed prompts:  41%|████      | 104/256 [00:01<00:02, 50.68it/s, est. speed input: 58878.98 toks/s, output: 57.50 toks/s]
Processed prompts:  43%|████▎     | 110/256 [00:01<00:02, 50.54it/s, est. speed input: 58415.79 toks/s, output: 57.05 toks/s]
Processed prompts:  45%|████▌     | 116/256 [00:02<00:02, 50.41it/s, est. speed input: 58000.38 toks/s, output: 56.64 toks/s]
Processed prompts:  48%|████▊     | 122/256 [00:02<00:02, 50.35it/s, est. speed input: 57636.12 toks/s, output: 56.28 toks/s]
Processed prompts:  50%|█████     | 128/256 [00:02<00:02, 50.23it/s, est. speed input: 57295.65 toks/s, output: 55.95 toks/s]
Processed prompts:  52%|█████▏    | 134/256 [00:02<00:02, 50.20it/s, est. speed input: 56999.47 toks/s, output: 55.66 toks/s]
Processed prompts:  55%|█████▍    | 140/256 [00:02<00:02, 50.15it/s, est. speed input: 56725.01 toks/s, output: 55.40 toks/s]
Processed prompts:  57%|█████▋    | 146/256 [00:02<00:02, 50.12it/s, est. speed input: 56478.24 toks/s, output: 55.15 toks/s]
Processed prompts:  59%|█████▉    | 152/256 [00:02<00:02, 49.99it/s, est. speed input: 56233.83 toks/s, output: 54.92 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:02<00:01, 49.97it/s, est. speed input: 56020.79 toks/s, output: 54.71 toks/s]
Processed prompts:  64%|██████▍   | 164/256 [00:03<00:01, 49.96it/s, est. speed input: 55826.42 toks/s, output: 54.52 toks/s]
Processed prompts:  66%|██████▋   | 170/256 [00:03<00:01, 50.01it/s, est. speed input: 55653.57 toks/s, output: 54.35 toks/s]
Processed prompts:  69%|██████▉   | 176/256 [00:03<00:01, 50.06it/s, est. speed input: 55495.96 toks/s, output: 54.20 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:03<00:01, 50.07it/s, est. speed input: 55347.01 toks/s, output: 54.05 toks/s]
Processed prompts:  73%|███████▎  | 188/256 [00:03<00:01, 50.08it/s, est. speed input: 55208.33 toks/s, output: 53.91 toks/s]
Processed prompts:  76%|███████▌  | 194/256 [00:03<00:01, 50.07it/s, est. speed input: 55077.18 toks/s, output: 53.79 toks/s]
Processed prompts:  78%|███████▊  | 200/256 [00:03<00:01, 50.07it/s, est. speed input: 54954.14 toks/s, output: 53.67 toks/s]
Processed prompts:  80%|████████  | 206/256 [00:03<00:00, 50.07it/s, est. speed input: 54839.03 toks/s, output: 53.55 toks/s]
Processed prompts:  83%|████████▎ | 212/256 [00:03<00:00, 50.05it/s, est. speed input: 54729.19 toks/s, output: 53.45 toks/s]
Processed prompts:  85%|████████▌ | 218/256 [00:04<00:00, 50.08it/s, est. speed input: 54630.73 toks/s, output: 53.35 toks/s]
Processed prompts:  88%|████████▊ | 224/256 [00:04<00:00, 50.08it/s, est. speed input: 54534.82 toks/s, output: 53.26 toks/s]
Processed prompts:  90%|████████▉ | 230/256 [00:04<00:00, 50.08it/s, est. speed input: 54444.99 toks/s, output: 53.17 toks/s]
Processed prompts:  92%|█████████▏| 236/256 [00:04<00:00, 50.10it/s, est. speed input: 54361.33 toks/s, output: 53.09 toks/s]
Processed prompts:  95%|█████████▍| 242/256 [00:04<00:00, 50.09it/s, est. speed input: 54280.59 toks/s, output: 53.01 toks/s]
Processed prompts:  97%|█████████▋| 248/256 [00:04<00:00, 50.05it/s, est. speed input: 54200.53 toks/s, output: 52.93 toks/s]
Processed prompts:  99%|█████████▉| 254/256 [00:04<00:00, 50.04it/s, est. speed input: 54125.79 toks/s, output: 52.86 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:04<00:00, 50.04it/s, est. speed input: 54318.51 toks/s, output: 53.05 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:04<00:00, 53.04it/s, est. speed input: 54318.51 toks/s, output: 53.05 toks/s]
[rank0]:[W128 00:26:50.518337144 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 27.7s

测试结果:
  Requests/s:   49.46
  Tokens/s:     50694.47
  Total Reqs:   256
  Elapsed:      5.18s

  [Prefill 分析]
  Total Prefill Tokens: 262144
  Prefill Tokens/s:     50645.01

============================================================
[4/7] 测试 M=4096
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-INT8                                  │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 4096
│   M_prefill     = 4096 (= 4 x 1024)
│   M_decode      = 4
│   batched_tokens = 4096 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 512
│   --max-num-seqs           = 4
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 4096
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:26:57 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3480250) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3480250) WARNING 01-28 00:27:06 [backends.py:609] Failed to read file <frozen os>
Throughput: 49.14 requests/s, 50368.63 total tokens/s, 49.14 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512


─── STDERR ───
[2026-01-28 00:26:56] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:26:57] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:26:57] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:26:57] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:26:57] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:26:57] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:26:57] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:26:57] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:26:57] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:26:57] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:26:57] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:26:57] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:26:57] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:26:57] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:27:00] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:27:00] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:27:00] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:27:00] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:27:00] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:27:00] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:27:00] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:27:00] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:27:00] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:27:00] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:27:00] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:27:00] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:27:00] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:27:00] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3480250) [2026-01-28 00:27:01] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3480250) [2026-01-28 00:27:01] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3480250) [2026-01-28 00:27:01] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3480250) [2026-01-28 00:27:01] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=3480250) [2026-01-28 00:27:01] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=3480250) [2026-01-28 00:27:01] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=3480250) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3480250) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.65it/s]
(EngineCore_DP0 pid=3480250) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.65it/s]
(EngineCore_DP0 pid=3480250) 
(EngineCore_DP0 pid=3480250) [2026-01-28 00:27:02] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 3840] -> 1D uint8
(EngineCore_DP0 pid=3480250) [2026-01-28 00:27:02] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 11059200 bytes
(EngineCore_DP0 pid=3480250) [2026-01-28 00:27:02] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 3840] -> 1D uint8
(EngineCore_DP0 pid=3480250) [2026-01-28 00:27:02] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7372800 bytes
(EngineCore_DP0 pid=3480250) [2026-01-28 00:27:02] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 3840] -> 1D uint8
(EngineCore_DP0 pid=3480250) [2026-01-28 00:27:02] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 39813120 bytes
(EngineCore_DP0 pid=3480250) [2026-01-28 00:27:02] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 10368] -> 1D uint8
(EngineCore_DP0 pid=3480250) [2026-01-28 00:27:02] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 19906560 bytes
(EngineCore_DP0 pid=3480250) 2026-01-28 00:27:12,224 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3480250) 2026-01-28 00:27:12,240 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3480250) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  75%|███████▌  | 3/4 [00:00<00:00, 25.54it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00, 23.77it/s]
(EngineCore_DP0 pid=3480250) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  33%|███▎      | 1/3 [00:00<00:00,  7.38it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00, 14.81it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:  14%|█▍        | 73/512 [00:00<00:00, 724.06it/s]
Adding requests:  29%|██▊       | 147/512 [00:00<00:00, 729.11it/s]
Adding requests:  43%|████▎     | 221/512 [00:00<00:00, 729.69it/s]
Adding requests:  58%|█████▊    | 298/512 [00:00<00:00, 741.94it/s]
Adding requests:  73%|███████▎  | 373/512 [00:00<00:00, 741.78it/s]
Adding requests:  88%|████████▊ | 448/512 [00:00<00:00, 743.62it/s]
Adding requests: 100%|██████████| 512/512 [00:00<00:00, 739.57it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   7%|▋         | 34/512 [00:00<00:01, 300.38it/s, est. speed input: 307616.40 toks/s, output: 300.39 toks/s]
Processed prompts:  13%|█▎        | 65/512 [00:00<00:05, 85.19it/s, est. speed input: 98286.15 toks/s, output: 95.98 toks/s]   
Processed prompts:  16%|█▌        | 81/512 [00:01<00:06, 70.32it/s, est. speed input: 82943.66 toks/s, output: 81.00 toks/s]
Processed prompts:  18%|█▊        | 92/512 [00:01<00:06, 62.60it/s, est. speed input: 75826.75 toks/s, output: 74.05 toks/s]
Processed prompts:  20%|█▉        | 101/512 [00:01<00:06, 61.09it/s, est. speed input: 73698.88 toks/s, output: 71.97 toks/s]
Processed prompts:  21%|██▏       | 109/512 [00:01<00:06, 58.25it/s, est. speed input: 71325.35 toks/s, output: 69.65 toks/s]
Processed prompts:  23%|██▎       | 116/512 [00:01<00:07, 54.34it/s, est. speed input: 68789.16 toks/s, output: 67.18 toks/s]
Processed prompts:  24%|██▍       | 122/512 [00:01<00:07, 49.71it/s, est. speed input: 66166.83 toks/s, output: 64.62 toks/s]
Processed prompts:  25%|██▌       | 130/512 [00:02<00:07, 49.62it/s, est. speed input: 64933.22 toks/s, output: 63.41 toks/s]
Processed prompts:  27%|██▋       | 138/512 [00:02<00:07, 49.63it/s, est. speed input: 63906.70 toks/s, output: 62.41 toks/s]
Processed prompts:  29%|██▊       | 146/512 [00:02<00:07, 49.65it/s, est. speed input: 63022.61 toks/s, output: 61.55 toks/s]
Processed prompts:  30%|███       | 154/512 [00:02<00:07, 49.66it/s, est. speed input: 62250.81 toks/s, output: 60.79 toks/s]
Processed prompts:  32%|███▏      | 162/512 [00:02<00:07, 49.64it/s, est. speed input: 61565.58 toks/s, output: 60.12 toks/s]
Processed prompts:  33%|███▎      | 170/512 [00:02<00:06, 49.62it/s, est. speed input: 60953.42 toks/s, output: 59.52 toks/s]
Processed prompts:  35%|███▍      | 178/512 [00:03<00:06, 49.58it/s, est. speed input: 60404.31 toks/s, output: 58.99 toks/s]
Processed prompts:  36%|███▋      | 186/512 [00:03<00:06, 49.55it/s, est. speed input: 59909.43 toks/s, output: 58.51 toks/s]
Processed prompts:  38%|███▊      | 194/512 [00:03<00:06, 49.56it/s, est. speed input: 59467.07 toks/s, output: 58.07 toks/s]
Processed prompts:  39%|███▉      | 202/512 [00:03<00:06, 49.54it/s, est. speed input: 59062.36 toks/s, output: 57.68 toks/s]
Processed prompts:  41%|████      | 210/512 [00:03<00:06, 49.56it/s, est. speed input: 58698.79 toks/s, output: 57.32 toks/s]
Processed prompts:  43%|████▎     | 218/512 [00:03<00:05, 49.49it/s, est. speed input: 58351.94 toks/s, output: 56.98 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:03<00:05, 49.46it/s, est. speed input: 58035.97 toks/s, output: 56.68 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:04<00:05, 49.41it/s, est. speed input: 57739.37 toks/s, output: 56.39 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:04<00:05, 49.45it/s, est. speed input: 57477.11 toks/s, output: 56.13 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:04<00:05, 49.48it/s, est. speed input: 57233.91 toks/s, output: 55.89 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:04<00:05, 49.51it/s, est. speed input: 57009.10 toks/s, output: 55.67 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:04<00:04, 49.52it/s, est. speed input: 56797.61 toks/s, output: 55.47 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:04<00:04, 49.52it/s, est. speed input: 56598.79 toks/s, output: 55.27 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:05<00:04, 49.52it/s, est. speed input: 56412.80 toks/s, output: 55.09 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:05<00:04, 49.56it/s, est. speed input: 56242.73 toks/s, output: 54.92 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:05<00:04, 49.56it/s, est. speed input: 56080.91 toks/s, output: 54.77 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:05<00:04, 49.56it/s, est. speed input: 55926.86 toks/s, output: 54.62 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:05<00:03, 49.54it/s, est. speed input: 55779.47 toks/s, output: 54.47 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:05<00:03, 49.50it/s, est. speed input: 55637.40 toks/s, output: 54.33 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:06<00:03, 49.45it/s, est. speed input: 55501.66 toks/s, output: 54.20 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:06<00:03, 49.48it/s, est. speed input: 55378.08 toks/s, output: 54.08 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:06<00:03, 49.53it/s, est. speed input: 55264.09 toks/s, output: 53.97 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:06<00:03, 49.53it/s, est. speed input: 55152.49 toks/s, output: 53.86 toks/s]
Processed prompts:  71%|███████   | 362/512 [00:06<00:03, 49.51it/s, est. speed input: 55044.73 toks/s, output: 53.75 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [00:06<00:02, 49.50it/s, est. speed input: 54941.81 toks/s, output: 53.65 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [00:07<00:02, 49.46it/s, est. speed input: 54840.99 toks/s, output: 53.56 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [00:07<00:02, 49.44it/s, est. speed input: 54745.48 toks/s, output: 53.46 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [00:07<00:02, 49.48it/s, est. speed input: 54658.58 toks/s, output: 53.38 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [00:07<00:02, 49.50it/s, est. speed input: 54574.61 toks/s, output: 53.30 toks/s]
Processed prompts:  80%|████████  | 410/512 [00:07<00:02, 49.52it/s, est. speed input: 54494.25 toks/s, output: 53.22 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [00:07<00:01, 49.49it/s, est. speed input: 54414.45 toks/s, output: 53.14 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [00:08<00:01, 49.43it/s, est. speed input: 54334.71 toks/s, output: 53.06 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [00:08<00:01, 49.44it/s, est. speed input: 54262.03 toks/s, output: 52.99 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [00:08<00:01, 49.45it/s, est. speed input: 54192.46 toks/s, output: 52.92 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [00:08<00:01, 49.52it/s, est. speed input: 54129.46 toks/s, output: 52.86 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [00:08<00:01, 49.56it/s, est. speed input: 54068.21 toks/s, output: 52.80 toks/s]
Processed prompts:  91%|█████████ | 466/512 [00:08<00:00, 49.53it/s, est. speed input: 54005.97 toks/s, output: 52.74 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [00:08<00:00, 49.43it/s, est. speed input: 53940.58 toks/s, output: 52.68 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [00:09<00:00, 49.46it/s, est. speed input: 53883.90 toks/s, output: 52.62 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [00:09<00:00, 49.48it/s, est. speed input: 53828.50 toks/s, output: 52.57 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [00:09<00:00, 49.45it/s, est. speed input: 53772.88 toks/s, output: 52.51 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [00:09<00:00, 49.45it/s, est. speed input: 53720.38 toks/s, output: 52.46 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:09<00:00, 49.45it/s, est. speed input: 53905.99 toks/s, output: 52.64 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:09<00:00, 52.64it/s, est. speed input: 53905.99 toks/s, output: 52.64 toks/s]
[rank0]:[W128 00:27:24.063735838 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 33.7s

测试结果:
  Requests/s:   49.14
  Tokens/s:     50368.63
  Total Reqs:   512
  Elapsed:      10.42s

  [Prefill 分析]
  Total Prefill Tokens: 524288
  Prefill Tokens/s:     50319.49

============================================================
[5/7] 测试 M=8192
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-INT8                                  │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 8192
│   M_prefill     = 8192 (= 8 x 1024)
│   M_decode      = 8
│   batched_tokens = 8192 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 1024
│   --max-num-seqs           = 8
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 8192
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:27:32 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3481095) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3481095) WARNING 01-28 00:27:42 [backends.py:609] Failed to read file <frozen os>
Throughput: 46.80 requests/s, 47969.10 total tokens/s, 46.80 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024


─── STDERR ───
[2026-01-28 00:27:32] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:27:32] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:27:32] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:27:32] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:27:32] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:27:32] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:27:32] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:27:32] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:27:32] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:27:32] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:27:32] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:27:32] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:27:32] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:27:32] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:27:36] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:27:36] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:27:36] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:27:36] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:27:36] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:27:36] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:27:36] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:27:36] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:27:36] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:27:36] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:27:36] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:27:36] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:27:36] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:27:36] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3481095) [2026-01-28 00:27:37] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3481095) [2026-01-28 00:27:37] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3481095) [2026-01-28 00:27:37] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3481095) [2026-01-28 00:27:37] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=3481095) [2026-01-28 00:27:37] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=3481095) [2026-01-28 00:27:37] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=3481095) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3481095) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.64it/s]
(EngineCore_DP0 pid=3481095) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.64it/s]
(EngineCore_DP0 pid=3481095) 
(EngineCore_DP0 pid=3481095) [2026-01-28 00:27:37] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 3840] -> 1D uint8
(EngineCore_DP0 pid=3481095) [2026-01-28 00:27:37] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 11059200 bytes
(EngineCore_DP0 pid=3481095) [2026-01-28 00:27:37] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 3840] -> 1D uint8
(EngineCore_DP0 pid=3481095) [2026-01-28 00:27:37] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7372800 bytes
(EngineCore_DP0 pid=3481095) [2026-01-28 00:27:37] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 3840] -> 1D uint8
(EngineCore_DP0 pid=3481095) [2026-01-28 00:27:37] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 39813120 bytes
(EngineCore_DP0 pid=3481095) [2026-01-28 00:27:37] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 10368] -> 1D uint8
(EngineCore_DP0 pid=3481095) [2026-01-28 00:27:37] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 19906560 bytes
(EngineCore_DP0 pid=3481095) 2026-01-28 00:27:47,896 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3481095) 2026-01-28 00:27:47,913 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3481095) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:00,  5.41it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  60%|██████    | 3/5 [00:00<00:00, 10.83it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00, 12.75it/s]
(EngineCore_DP0 pid=3481095) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:00,  7.37it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00, 18.97it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00, 16.96it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   7%|▋         | 69/1024 [00:00<00:01, 687.55it/s]
Adding requests:  14%|█▍        | 147/1024 [00:00<00:01, 739.73it/s]
Adding requests:  22%|██▏       | 224/1024 [00:00<00:01, 752.90it/s]
Adding requests:  29%|██▉       | 300/1024 [00:00<00:00, 745.41it/s]
Adding requests:  37%|███▋      | 377/1024 [00:00<00:00, 751.53it/s]
Adding requests:  44%|████▍     | 453/1024 [00:00<00:00, 747.26it/s]
Adding requests:  52%|█████▏    | 528/1024 [00:00<00:00, 740.45it/s]
Adding requests:  59%|█████▉    | 603/1024 [00:00<00:00, 738.99it/s]
Adding requests:  67%|██████▋   | 682/1024 [00:00<00:00, 753.59it/s]
Adding requests:  74%|███████▍  | 760/1024 [00:01<00:00, 758.57it/s]
Adding requests:  82%|████████▏ | 836/1024 [00:01<00:00, 748.14it/s]
Adding requests:  89%|████████▉ | 916/1024 [00:01<00:00, 763.37it/s]
Adding requests:  97%|█████████▋| 995/1024 [00:01<00:00, 768.60it/s]
Adding requests: 100%|██████████| 1024/1024 [00:01<00:00, 754.18it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▋         | 66/1024 [00:00<00:03, 257.67it/s, est. speed input: 263864.80 toks/s, output: 257.67 toks/s]
Processed prompts:   9%|▉         | 92/1024 [00:00<00:08, 104.55it/s, est. speed input: 122762.07 toks/s, output: 119.88 toks/s]
Processed prompts:  10%|█         | 106/1024 [00:01<00:11, 78.34it/s, est. speed input: 97977.70 toks/s, output: 95.68 toks/s]  
Processed prompts:  11%|█▏        | 116/1024 [00:01<00:12, 73.87it/s, est. speed input: 92937.09 toks/s, output: 90.76 toks/s]
Processed prompts:  12%|█▏        | 124/1024 [00:01<00:13, 67.25it/s, est. speed input: 87657.18 toks/s, output: 85.60 toks/s]
Processed prompts:  13%|█▎        | 131/1024 [00:01<00:14, 60.43it/s, est. speed input: 82845.69 toks/s, output: 80.90 toks/s]
Processed prompts:  13%|█▎        | 138/1024 [00:01<00:16, 55.21it/s, est. speed input: 78972.69 toks/s, output: 77.12 toks/s]
Processed prompts:  14%|█▍        | 146/1024 [00:01<00:16, 52.95it/s, est. speed input: 76307.22 toks/s, output: 74.52 toks/s]
Processed prompts:  15%|█▌        | 154/1024 [00:02<00:16, 51.28it/s, est. speed input: 74063.86 toks/s, output: 72.33 toks/s]
Processed prompts:  16%|█▌        | 162/1024 [00:02<00:17, 50.05it/s, est. speed input: 72147.98 toks/s, output: 70.46 toks/s]
Processed prompts:  17%|█▋        | 170/1024 [00:02<00:17, 49.17it/s, est. speed input: 70497.28 toks/s, output: 68.84 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [00:02<00:17, 48.52it/s, est. speed input: 69050.24 toks/s, output: 67.43 toks/s]
Processed prompts:  18%|█▊        | 186/1024 [00:02<00:17, 48.10it/s, est. speed input: 67792.19 toks/s, output: 66.20 toks/s]
Processed prompts:  19%|█▉        | 194/1024 [00:02<00:17, 47.78it/s, est. speed input: 66669.51 toks/s, output: 65.11 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [00:03<00:17, 47.58it/s, est. speed input: 65675.91 toks/s, output: 64.14 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:03<00:17, 47.38it/s, est. speed input: 64769.86 toks/s, output: 63.25 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [00:03<00:17, 47.24it/s, est. speed input: 63953.62 toks/s, output: 62.45 toks/s]
Processed prompts:  22%|██▏       | 226/1024 [00:03<00:16, 47.15it/s, est. speed input: 63212.44 toks/s, output: 61.73 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:03<00:16, 47.09it/s, est. speed input: 62538.89 toks/s, output: 61.07 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:04<00:16, 47.05it/s, est. speed input: 61924.64 toks/s, output: 60.47 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:04<00:16, 47.07it/s, est. speed input: 61368.00 toks/s, output: 59.93 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:04<00:16, 47.06it/s, est. speed input: 60850.08 toks/s, output: 59.42 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:04<00:16, 47.02it/s, est. speed input: 60367.23 toks/s, output: 58.95 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:04<00:15, 47.02it/s, est. speed input: 59923.21 toks/s, output: 58.52 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:04<00:15, 47.03it/s, est. speed input: 59510.96 toks/s, output: 58.12 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:05<00:15, 47.04it/s, est. speed input: 59128.00 toks/s, output: 57.74 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:05<00:15, 47.03it/s, est. speed input: 58768.56 toks/s, output: 57.39 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:05<00:15, 47.01it/s, est. speed input: 58429.04 toks/s, output: 57.06 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:05<00:15, 46.96it/s, est. speed input: 58106.84 toks/s, output: 56.74 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:05<00:14, 46.98it/s, est. speed input: 57809.08 toks/s, output: 56.45 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:05<00:14, 46.94it/s, est. speed input: 57522.92 toks/s, output: 56.17 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:06<00:14, 46.95it/s, est. speed input: 57257.32 toks/s, output: 55.92 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:06<00:14, 46.96it/s, est. speed input: 57007.21 toks/s, output: 55.67 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:06<00:14, 46.95it/s, est. speed input: 56768.26 toks/s, output: 55.44 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:06<00:14, 46.94it/s, est. speed input: 56541.68 toks/s, output: 55.22 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:06<00:13, 46.92it/s, est. speed input: 56324.61 toks/s, output: 55.00 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:06<00:13, 46.93it/s, est. speed input: 56120.80 toks/s, output: 54.81 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:07<00:13, 46.94it/s, est. speed input: 55927.11 toks/s, output: 54.62 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [00:07<00:13, 46.96it/s, est. speed input: 55744.24 toks/s, output: 54.44 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:07<00:13, 46.96it/s, est. speed input: 55568.05 toks/s, output: 54.27 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:07<00:13, 46.93it/s, est. speed input: 55396.94 toks/s, output: 54.10 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:07<00:12, 46.96it/s, est. speed input: 55237.81 toks/s, output: 53.94 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:07<00:12, 46.92it/s, est. speed input: 55081.18 toks/s, output: 53.79 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:08<00:12, 46.94it/s, est. speed input: 54933.97 toks/s, output: 53.65 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:08<00:12, 46.95it/s, est. speed input: 54793.54 toks/s, output: 53.51 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:08<00:12, 46.99it/s, est. speed input: 54660.39 toks/s, output: 53.38 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:08<00:12, 46.95it/s, est. speed input: 54528.22 toks/s, output: 53.25 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:08<00:11, 46.96it/s, est. speed input: 54403.43 toks/s, output: 53.13 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:08<00:11, 47.00it/s, est. speed input: 54285.78 toks/s, output: 53.01 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:09<00:11, 46.99it/s, est. speed input: 54170.44 toks/s, output: 52.90 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:09<00:11, 46.99it/s, est. speed input: 54059.38 toks/s, output: 52.79 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:09<00:11, 46.97it/s, est. speed input: 53951.08 toks/s, output: 52.69 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:09<00:11, 46.94it/s, est. speed input: 53845.00 toks/s, output: 52.58 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:09<00:10, 46.93it/s, est. speed input: 53744.03 toks/s, output: 52.48 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:09<00:10, 46.95it/s, est. speed input: 53647.76 toks/s, output: 52.39 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:10<00:10, 46.92it/s, est. speed input: 53552.17 toks/s, output: 52.30 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:10<00:10, 46.94it/s, est. speed input: 53462.43 toks/s, output: 52.21 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:10<00:10, 46.98it/s, est. speed input: 53377.19 toks/s, output: 52.13 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:10<00:10, 46.96it/s, est. speed input: 53291.49 toks/s, output: 52.04 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:10<00:09, 46.97it/s, est. speed input: 53210.38 toks/s, output: 51.96 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:10<00:09, 46.97it/s, est. speed input: 53130.87 toks/s, output: 51.89 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:11<00:09, 46.96it/s, est. speed input: 53053.60 toks/s, output: 51.81 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:11<00:09, 46.94it/s, est. speed input: 52977.74 toks/s, output: 51.74 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:11<00:09, 46.93it/s, est. speed input: 52904.31 toks/s, output: 51.66 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:11<00:08, 46.91it/s, est. speed input: 52832.18 toks/s, output: 51.59 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:11<00:08, 46.92it/s, est. speed input: 52763.81 toks/s, output: 51.53 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:12<00:08, 46.91it/s, est. speed input: 52696.30 toks/s, output: 51.46 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:12<00:08, 46.93it/s, est. speed input: 52631.83 toks/s, output: 51.40 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:12<00:08, 46.94it/s, est. speed input: 52569.18 toks/s, output: 51.34 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:12<00:08, 46.91it/s, est. speed input: 52506.40 toks/s, output: 51.28 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:12<00:07, 46.91it/s, est. speed input: 52446.31 toks/s, output: 51.22 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:12<00:07, 46.89it/s, est. speed input: 52387.12 toks/s, output: 51.16 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:13<00:07, 46.93it/s, est. speed input: 52331.52 toks/s, output: 51.10 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:13<00:07, 46.92it/s, est. speed input: 52275.95 toks/s, output: 51.05 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:13<00:07, 46.92it/s, est. speed input: 52222.03 toks/s, output: 51.00 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:13<00:07, 46.89it/s, est. speed input: 52168.13 toks/s, output: 50.95 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:13<00:06, 46.90it/s, est. speed input: 52116.87 toks/s, output: 50.90 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:13<00:06, 46.91it/s, est. speed input: 52067.05 toks/s, output: 50.85 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:14<00:06, 46.92it/s, est. speed input: 52018.68 toks/s, output: 50.80 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:14<00:06, 46.90it/s, est. speed input: 51970.31 toks/s, output: 50.75 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:14<00:06, 46.93it/s, est. speed input: 51924.71 toks/s, output: 50.71 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:14<00:06, 46.93it/s, est. speed input: 51879.26 toks/s, output: 50.66 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:14<00:05, 46.92it/s, est. speed input: 51834.95 toks/s, output: 50.62 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:14<00:05, 46.94it/s, est. speed input: 51792.28 toks/s, output: 50.58 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:15<00:05, 46.96it/s, est. speed input: 51751.09 toks/s, output: 50.54 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:15<00:05, 46.96it/s, est. speed input: 51710.25 toks/s, output: 50.50 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:15<00:05, 46.95it/s, est. speed input: 51669.54 toks/s, output: 50.46 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:15<00:05, 46.91it/s, est. speed input: 51628.89 toks/s, output: 50.42 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:15<00:04, 46.89it/s, est. speed input: 51589.11 toks/s, output: 50.38 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:15<00:04, 46.89it/s, est. speed input: 51550.79 toks/s, output: 50.34 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:16<00:04, 46.88it/s, est. speed input: 51512.98 toks/s, output: 50.31 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:16<00:04, 46.86it/s, est. speed input: 51475.48 toks/s, output: 50.27 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:16<00:04, 46.87it/s, est. speed input: 51439.60 toks/s, output: 50.23 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:16<00:04, 46.85it/s, est. speed input: 51403.62 toks/s, output: 50.20 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [00:16<00:03, 46.86it/s, est. speed input: 51369.13 toks/s, output: 50.17 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [00:16<00:03, 46.88it/s, est. speed input: 51335.71 toks/s, output: 50.13 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:17<00:03, 46.86it/s, est. speed input: 51301.90 toks/s, output: 50.10 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [00:17<00:03, 46.89it/s, est. speed input: 51270.21 toks/s, output: 50.07 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [00:17<00:03, 46.89it/s, est. speed input: 51238.42 toks/s, output: 50.04 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [00:17<00:03, 46.87it/s, est. speed input: 51206.42 toks/s, output: 50.01 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [00:17<00:02, 46.87it/s, est. speed input: 51175.55 toks/s, output: 49.98 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [00:17<00:02, 46.86it/s, est. speed input: 51145.19 toks/s, output: 49.95 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [00:18<00:02, 46.86it/s, est. speed input: 51115.35 toks/s, output: 49.92 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [00:18<00:02, 46.85it/s, est. speed input: 51085.84 toks/s, output: 49.89 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [00:18<00:02, 46.82it/s, est. speed input: 51056.26 toks/s, output: 49.86 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [00:18<00:02, 46.79it/s, est. speed input: 51026.76 toks/s, output: 49.83 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [00:18<00:01, 46.84it/s, est. speed input: 51000.15 toks/s, output: 49.80 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [00:19<00:01, 46.85it/s, est. speed input: 50973.23 toks/s, output: 49.78 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [00:19<00:01, 46.87it/s, est. speed input: 50947.01 toks/s, output: 49.75 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [00:19<00:01, 46.89it/s, est. speed input: 50921.60 toks/s, output: 49.73 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [00:19<00:01, 46.87it/s, est. speed input: 50895.46 toks/s, output: 49.70 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [00:19<00:00, 46.87it/s, est. speed input: 50870.44 toks/s, output: 49.68 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [00:19<00:00, 46.88it/s, est. speed input: 50846.04 toks/s, output: 49.65 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [00:20<00:00, 46.87it/s, est. speed input: 50821.40 toks/s, output: 49.63 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [00:20<00:00, 46.86it/s, est. speed input: 50797.17 toks/s, output: 49.61 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [00:20<00:00, 46.84it/s, est. speed input: 50773.01 toks/s, output: 49.58 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [00:20<00:00, 48.43it/s, est. speed input: 50796.03 toks/s, output: 49.61 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:20<00:00, 48.43it/s, est. speed input: 51095.09 toks/s, output: 49.90 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:20<00:00, 49.90it/s, est. speed input: 51095.09 toks/s, output: 49.90 toks/s]
[rank0]:[W128 00:28:11.344654030 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 47.1s

测试结果:
  Requests/s:   46.80
  Tokens/s:     47969.10
  Total Reqs:   1024
  Elapsed:      21.88s

  [Prefill 分析]
  Total Prefill Tokens: 1048576
  Prefill Tokens/s:     47922.30

============================================================
[6/7] 测试 M=16384
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-INT8                                  │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 16384
│   M_prefill     = 16384 (= 16 x 1024)
│   M_decode      = 16
│   batched_tokens = 16384 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 2048
│   --max-num-seqs           = 16
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 16384
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:28:22 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3482057) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3482057) WARNING 01-28 00:28:31 [backends.py:609] Failed to read file <frozen os>
Throughput: 45.71 requests/s, 46852.80 total tokens/s, 45.71 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048


─── STDERR ───
[2026-01-28 00:28:22] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:28:22] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:28:22] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:28:22] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:28:22] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:28:22] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:28:22] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:28:22] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:28:22] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:28:22] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:28:22] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:28:22] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:28:22] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:28:22] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:28:25] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:28:26] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:28:26] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:28:26] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:28:26] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:28:26] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:28:26] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:28:26] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:28:26] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:28:26] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:28:26] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:28:26] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:28:26] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:28:26] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3482057) [2026-01-28 00:28:26] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3482057) [2026-01-28 00:28:26] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3482057) [2026-01-28 00:28:26] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3482057) [2026-01-28 00:28:26] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=3482057) [2026-01-28 00:28:26] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=3482057) [2026-01-28 00:28:26] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=3482057) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3482057) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.63it/s]
(EngineCore_DP0 pid=3482057) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.63it/s]
(EngineCore_DP0 pid=3482057) 
(EngineCore_DP0 pid=3482057) [2026-01-28 00:28:27] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 3840] -> 1D uint8
(EngineCore_DP0 pid=3482057) [2026-01-28 00:28:27] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 11059200 bytes
(EngineCore_DP0 pid=3482057) [2026-01-28 00:28:27] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 3840] -> 1D uint8
(EngineCore_DP0 pid=3482057) [2026-01-28 00:28:27] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7372800 bytes
(EngineCore_DP0 pid=3482057) [2026-01-28 00:28:27] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 3840] -> 1D uint8
(EngineCore_DP0 pid=3482057) [2026-01-28 00:28:27] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 39813120 bytes
(EngineCore_DP0 pid=3482057) [2026-01-28 00:28:27] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 10368] -> 1D uint8
(EngineCore_DP0 pid=3482057) [2026-01-28 00:28:27] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 19906560 bytes
(EngineCore_DP0 pid=3482057) 2026-01-28 00:28:37,403 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3482057) 2026-01-28 00:28:37,419 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3482057) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  14%|█▍        | 1/7 [00:00<00:00,  7.89it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  57%|█████▋    | 4/7 [00:00<00:00, 18.54it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00, 21.36it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00, 19.46it/s]
(EngineCore_DP0 pid=3482057) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  20%|██        | 1/5 [00:00<00:00,  7.44it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00, 20.59it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00, 18.60it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   4%|▎         | 74/2048 [00:00<00:02, 731.13it/s]
Adding requests:   7%|▋         | 148/2048 [00:00<00:02, 730.05it/s]
Adding requests:  11%|█         | 223/2048 [00:00<00:02, 738.39it/s]
Adding requests:  15%|█▍        | 299/2048 [00:00<00:02, 744.12it/s]
Adding requests:  18%|█▊        | 374/2048 [00:00<00:02, 740.97it/s]
Adding requests:  22%|██▏       | 450/2048 [00:00<00:02, 744.28it/s]
Adding requests:  26%|██▌       | 525/2048 [00:00<00:02, 742.05it/s]
Adding requests:  29%|██▉       | 603/2048 [00:00<00:01, 751.66it/s]
Adding requests:  33%|███▎      | 682/2048 [00:00<00:01, 763.26it/s]
Adding requests:  37%|███▋      | 759/2048 [00:01<00:01, 755.86it/s]
Adding requests:  41%|████      | 835/2048 [00:01<00:01, 736.93it/s]
Adding requests:  45%|████▍     | 912/2048 [00:01<00:01, 743.69it/s]
Adding requests:  48%|████▊     | 989/2048 [00:01<00:01, 751.14it/s]
Adding requests:  52%|█████▏    | 1066/2048 [00:01<00:01, 756.48it/s]
Adding requests:  56%|█████▌    | 1142/2048 [00:01<00:01, 749.00it/s]
Adding requests:  60%|█████▉    | 1223/2048 [00:01<00:01, 765.82it/s]
Adding requests:  63%|██████▎   | 1300/2048 [00:01<00:00, 752.19it/s]
Adding requests:  67%|██████▋   | 1376/2048 [00:01<00:00, 748.41it/s]
Adding requests:  71%|███████   | 1451/2048 [00:01<00:00, 746.68it/s]
Adding requests:  75%|███████▍  | 1529/2048 [00:02<00:00, 756.50it/s]
Adding requests:  79%|███████▊  | 1608/2048 [00:02<00:00, 765.25it/s]
Adding requests:  82%|████████▏ | 1685/2048 [00:02<00:00, 761.00it/s]
Adding requests:  86%|████████▌ | 1762/2048 [00:02<00:00, 760.19it/s]
Adding requests:  90%|████████▉ | 1839/2048 [00:02<00:00, 756.83it/s]
Adding requests:  94%|█████████▎| 1916/2048 [00:02<00:00, 760.40it/s]
Adding requests:  97%|█████████▋| 1993/2048 [00:02<00:00, 746.45it/s]
Adding requests: 100%|██████████| 2048/2048 [00:02<00:00, 751.77it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▌         | 114/2048 [00:00<00:03, 596.17it/s, est. speed input: 610546.16 toks/s, output: 596.21 toks/s]
Processed prompts:   8%|▊         | 174/2048 [00:01<00:15, 118.49it/s, est. speed input: 144016.60 toks/s, output: 140.64 toks/s]
Processed prompts:  10%|▉         | 202/2048 [00:01<00:22, 82.63it/s, est. speed input: 106924.86 toks/s, output: 104.42 toks/s] 
Processed prompts:  11%|█         | 220/2048 [00:02<00:24, 75.02it/s, est. speed input: 98692.17 toks/s, output: 96.38 toks/s]  
Processed prompts:  11%|█▏        | 233/2048 [00:02<00:27, 65.19it/s, est. speed input: 90675.06 toks/s, output: 88.55 toks/s]
Processed prompts:  12%|█▏        | 243/2048 [00:02<00:32, 55.29it/s, est. speed input: 83502.13 toks/s, output: 81.54 toks/s]
Processed prompts:  13%|█▎        | 258/2048 [00:03<00:34, 51.87it/s, est. speed input: 79373.97 toks/s, output: 77.51 toks/s]
Processed prompts:  13%|█▎        | 274/2048 [00:03<00:35, 50.15it/s, est. speed input: 76295.38 toks/s, output: 74.51 toks/s]
Processed prompts:  14%|█▍        | 290/2048 [00:04<00:35, 48.91it/s, est. speed input: 73755.14 toks/s, output: 72.03 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [00:04<00:36, 48.04it/s, est. speed input: 71627.43 toks/s, output: 69.95 toks/s]
Processed prompts:  16%|█▌        | 322/2048 [00:04<00:36, 47.27it/s, est. speed input: 69760.08 toks/s, output: 68.12 toks/s]
Processed prompts:  17%|█▋        | 338/2048 [00:05<00:36, 46.88it/s, est. speed input: 68200.19 toks/s, output: 66.60 toks/s]
Processed prompts:  17%|█▋        | 354/2048 [00:05<00:36, 46.58it/s, est. speed input: 66834.91 toks/s, output: 65.27 toks/s]
Processed prompts:  18%|█▊        | 370/2048 [00:05<00:36, 46.34it/s, est. speed input: 65628.12 toks/s, output: 64.09 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [00:06<00:35, 46.21it/s, est. speed input: 64567.82 toks/s, output: 63.05 toks/s]
Processed prompts:  20%|█▉        | 402/2048 [00:06<00:35, 46.12it/s, est. speed input: 63622.07 toks/s, output: 62.13 toks/s]
Processed prompts:  20%|██        | 418/2048 [00:06<00:35, 46.04it/s, est. speed input: 62768.22 toks/s, output: 61.30 toks/s]
Processed prompts:  21%|██        | 434/2048 [00:07<00:35, 45.98it/s, est. speed input: 61996.82 toks/s, output: 60.54 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [00:07<00:34, 45.95it/s, est. speed input: 61299.87 toks/s, output: 59.86 toks/s]
Processed prompts:  23%|██▎       | 466/2048 [00:07<00:34, 45.91it/s, est. speed input: 60661.64 toks/s, output: 59.24 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [00:08<00:34, 45.90it/s, est. speed input: 60081.58 toks/s, output: 58.67 toks/s]
Processed prompts:  24%|██▍       | 498/2048 [00:08<00:33, 45.90it/s, est. speed input: 59548.29 toks/s, output: 58.15 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [00:08<00:33, 45.88it/s, est. speed input: 59054.53 toks/s, output: 57.67 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [00:09<00:33, 45.87it/s, est. speed input: 58598.36 toks/s, output: 57.22 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [00:09<00:32, 45.87it/s, est. speed input: 58175.68 toks/s, output: 56.81 toks/s]
Processed prompts:  27%|██▋       | 562/2048 [00:09<00:32, 45.84it/s, est. speed input: 57779.69 toks/s, output: 56.43 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [00:10<00:32, 45.85it/s, est. speed input: 57413.95 toks/s, output: 56.07 toks/s]
Processed prompts:  29%|██▉       | 594/2048 [00:10<00:31, 45.83it/s, est. speed input: 57068.93 toks/s, output: 55.73 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [00:11<00:31, 45.83it/s, est. speed input: 56747.49 toks/s, output: 55.42 toks/s]
Processed prompts:  31%|███       | 626/2048 [00:11<00:31, 45.84it/s, est. speed input: 56446.75 toks/s, output: 55.12 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [00:11<00:30, 45.83it/s, est. speed input: 56162.20 toks/s, output: 54.85 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [00:12<00:30, 45.83it/s, est. speed input: 55894.56 toks/s, output: 54.58 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [00:12<00:29, 45.84it/s, est. speed input: 55643.00 toks/s, output: 54.34 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [00:12<00:29, 45.81it/s, est. speed input: 55401.82 toks/s, output: 54.10 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [00:13<00:29, 45.81it/s, est. speed input: 55174.98 toks/s, output: 53.88 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [00:13<00:28, 45.81it/s, est. speed input: 54960.65 toks/s, output: 53.67 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [00:13<00:28, 45.82it/s, est. speed input: 54757.57 toks/s, output: 53.47 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [00:14<00:28, 45.81it/s, est. speed input: 54563.81 toks/s, output: 53.28 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [00:14<00:27, 45.82it/s, est. speed input: 54380.16 toks/s, output: 53.11 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [00:14<00:27, 45.80it/s, est. speed input: 54203.24 toks/s, output: 52.93 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [00:15<00:27, 45.80it/s, est. speed input: 54034.74 toks/s, output: 52.77 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [00:15<00:26, 45.80it/s, est. speed input: 53874.87 toks/s, output: 52.61 toks/s]
Processed prompts:  41%|████      | 834/2048 [00:15<00:26, 45.79it/s, est. speed input: 53720.41 toks/s, output: 52.46 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [00:16<00:26, 45.79it/s, est. speed input: 53573.48 toks/s, output: 52.32 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [00:16<00:25, 45.80it/s, est. speed input: 53433.28 toks/s, output: 52.18 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [00:16<00:25, 45.78it/s, est. speed input: 53296.99 toks/s, output: 52.05 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [00:17<00:25, 45.79it/s, est. speed input: 53167.94 toks/s, output: 51.92 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [00:17<00:24, 45.78it/s, est. speed input: 53043.36 toks/s, output: 51.80 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [00:17<00:24, 45.79it/s, est. speed input: 52924.11 toks/s, output: 51.68 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [00:18<00:24, 45.79it/s, est. speed input: 52809.09 toks/s, output: 51.57 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [00:18<00:23, 45.78it/s, est. speed input: 52697.86 toks/s, output: 51.46 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [00:19<00:23, 45.78it/s, est. speed input: 52591.07 toks/s, output: 51.36 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [00:19<00:23, 45.79it/s, est. speed input: 52488.58 toks/s, output: 51.26 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [00:19<00:22, 45.76it/s, est. speed input: 52387.75 toks/s, output: 51.16 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [00:20<00:22, 45.76it/s, est. speed input: 52291.63 toks/s, output: 51.07 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [00:20<00:21, 45.76it/s, est. speed input: 52198.49 toks/s, output: 50.98 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [00:20<00:21, 45.76it/s, est. speed input: 52109.03 toks/s, output: 50.89 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [00:21<00:21, 45.77it/s, est. speed input: 52022.28 toks/s, output: 50.80 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [00:21<00:20, 45.77it/s, est. speed input: 51938.52 toks/s, output: 50.72 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [00:21<00:20, 45.77it/s, est. speed input: 51857.27 toks/s, output: 50.64 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [00:22<00:20, 45.76it/s, est. speed input: 51778.33 toks/s, output: 50.56 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [00:22<00:19, 45.76it/s, est. speed input: 51701.75 toks/s, output: 50.49 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [00:22<00:19, 46.44it/s, est. speed input: 51666.65 toks/s, output: 50.46 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [00:23<00:18, 46.24it/s, est. speed input: 51594.33 toks/s, output: 50.39 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [00:23<00:18, 46.09it/s, est. speed input: 51524.14 toks/s, output: 50.32 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [00:23<00:18, 45.99it/s, est. speed input: 51455.58 toks/s, output: 50.25 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [00:24<00:18, 45.92it/s, est. speed input: 51389.57 toks/s, output: 50.19 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [00:24<00:17, 45.87it/s, est. speed input: 51325.15 toks/s, output: 50.12 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [00:24<00:17, 45.82it/s, est. speed input: 51261.50 toks/s, output: 50.06 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [00:25<00:17, 45.80it/s, est. speed input: 51200.60 toks/s, output: 50.00 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [00:25<00:16, 45.78it/s, est. speed input: 51141.01 toks/s, output: 49.94 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [00:26<00:16, 45.77it/s, est. speed input: 51083.54 toks/s, output: 49.89 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [00:26<00:16, 45.76it/s, est. speed input: 51027.25 toks/s, output: 49.83 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [00:26<00:15, 45.74it/s, est. speed input: 50971.54 toks/s, output: 49.78 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [00:27<00:15, 45.74it/s, est. speed input: 50917.97 toks/s, output: 49.72 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [00:27<00:15, 45.73it/s, est. speed input: 50865.70 toks/s, output: 49.67 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [00:27<00:14, 45.72it/s, est. speed input: 50814.37 toks/s, output: 49.62 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [00:28<00:14, 45.74it/s, est. speed input: 50765.38 toks/s, output: 49.58 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [00:28<00:13, 45.74it/s, est. speed input: 50717.17 toks/s, output: 49.53 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [00:28<00:13, 45.73it/s, est. speed input: 50669.77 toks/s, output: 49.48 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [00:29<00:13, 45.73it/s, est. speed input: 50623.62 toks/s, output: 49.44 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [00:29<00:12, 45.74it/s, est. speed input: 50579.08 toks/s, output: 49.39 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [00:29<00:12, 45.73it/s, est. speed input: 50534.65 toks/s, output: 49.35 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [00:30<00:12, 45.74it/s, est. speed input: 50492.13 toks/s, output: 49.31 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [00:30<00:11, 45.73it/s, est. speed input: 50450.08 toks/s, output: 49.27 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [00:30<00:11, 45.72it/s, est. speed input: 50408.53 toks/s, output: 49.23 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [00:31<00:11, 45.73it/s, est. speed input: 50368.69 toks/s, output: 49.19 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [00:31<00:10, 45.72it/s, est. speed input: 50329.22 toks/s, output: 49.15 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [00:31<00:10, 45.72it/s, est. speed input: 50290.93 toks/s, output: 49.11 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [00:32<00:10, 45.72it/s, est. speed input: 50253.31 toks/s, output: 49.08 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [00:32<00:09, 45.72it/s, est. speed input: 50216.52 toks/s, output: 49.04 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [00:33<00:09, 45.73it/s, est. speed input: 50180.69 toks/s, output: 49.00 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [00:33<00:09, 45.73it/s, est. speed input: 50145.53 toks/s, output: 48.97 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [00:33<00:08, 45.72it/s, est. speed input: 50110.72 toks/s, output: 48.94 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [00:34<00:08, 45.71it/s, est. speed input: 50076.45 toks/s, output: 48.90 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [00:34<00:08, 45.72it/s, est. speed input: 50043.56 toks/s, output: 48.87 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [00:34<00:07, 45.70it/s, est. speed input: 50010.42 toks/s, output: 48.84 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [00:35<00:07, 45.72it/s, est. speed input: 49979.01 toks/s, output: 48.81 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [00:35<00:06, 45.71it/s, est. speed input: 49947.64 toks/s, output: 48.78 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [00:35<00:06, 45.69it/s, est. speed input: 49916.32 toks/s, output: 48.75 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [00:36<00:06, 45.71it/s, est. speed input: 49886.70 toks/s, output: 48.72 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [00:36<00:05, 45.72it/s, est. speed input: 49857.51 toks/s, output: 48.69 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [00:36<00:05, 45.70it/s, est. speed input: 49828.11 toks/s, output: 48.66 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [00:37<00:05, 45.71it/s, est. speed input: 49799.64 toks/s, output: 48.63 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [00:37<00:04, 45.71it/s, est. speed input: 49771.76 toks/s, output: 48.61 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [00:37<00:04, 45.70it/s, est. speed input: 49744.24 toks/s, output: 48.58 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [00:38<00:04, 45.71it/s, est. speed input: 49717.65 toks/s, output: 48.55 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [00:38<00:03, 46.54it/s, est. speed input: 49717.81 toks/s, output: 48.55 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [00:38<00:03, 46.28it/s, est. speed input: 49691.38 toks/s, output: 48.53 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [00:39<00:03, 46.12it/s, est. speed input: 49666.05 toks/s, output: 48.50 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [00:39<00:02, 45.98it/s, est. speed input: 49640.29 toks/s, output: 48.48 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [00:39<00:02, 45.89it/s, est. speed input: 49615.44 toks/s, output: 48.45 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [00:40<00:02, 45.84it/s, est. speed input: 49591.24 toks/s, output: 48.43 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [00:40<00:01, 45.79it/s, est. speed input: 49566.89 toks/s, output: 48.41 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [00:41<00:01, 45.77it/s, est. speed input: 49543.33 toks/s, output: 48.38 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [00:41<00:01, 45.74it/s, est. speed input: 49519.79 toks/s, output: 48.36 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [00:41<00:00, 45.72it/s, est. speed input: 49496.80 toks/s, output: 48.34 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [00:42<00:00, 46.53it/s, est. speed input: 49498.32 toks/s, output: 48.34 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:42<00:00, 46.53it/s, est. speed input: 49838.60 toks/s, output: 48.67 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:42<00:00, 48.67it/s, est. speed input: 49838.60 toks/s, output: 48.67 toks/s]
[rank0]:[W128 00:29:23.765900163 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 72.5s

测试结果:
  Requests/s:   45.71
  Tokens/s:     46852.80
  Total Reqs:   2048
  Elapsed:      44.80s

  [Prefill 分析]
  Total Prefill Tokens: 2097152
  Prefill Tokens/s:     46807.09

============================================================
[7/7] 测试 M=32768
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-INT8                                  │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 32768
│   M_prefill     = 32768 (= 32 x 1024)
│   M_decode      = 32
│   batched_tokens = 32768 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 4096
│   --max-num-seqs           = 32
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 32768
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:29:40 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3483406) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3483406) WARNING 01-28 00:29:49 [backends.py:609] Failed to read file <frozen os>
Throughput: 45.79 requests/s, 46939.63 total tokens/s, 45.79 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096


─── STDERR ───
[2026-01-28 00:29:40] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:29:40] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:29:40] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:29:40] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:29:40] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:29:40] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:29:40] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:29:40] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:29:40] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:29:40] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:29:40] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:29:40] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:29:40] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:29:40] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:29:44] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:29:44] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:29:44] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:29:44] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:29:44] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:29:44] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:29:44] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:29:44] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:29:44] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:29:44] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:29:44] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:29:44] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:29:44] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:29:44] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3483406) [2026-01-28 00:29:44] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3483406) [2026-01-28 00:29:44] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3483406) [2026-01-28 00:29:44] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3483406) [2026-01-28 00:29:44] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=3483406) [2026-01-28 00:29:44] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=3483406) [2026-01-28 00:29:44] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=3483406) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3483406) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.65it/s]
(EngineCore_DP0 pid=3483406) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.65it/s]
(EngineCore_DP0 pid=3483406) 
(EngineCore_DP0 pid=3483406) [2026-01-28 00:29:45] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 3840] -> 1D uint8
(EngineCore_DP0 pid=3483406) [2026-01-28 00:29:45] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 11059200 bytes
(EngineCore_DP0 pid=3483406) [2026-01-28 00:29:45] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 3840] -> 1D uint8
(EngineCore_DP0 pid=3483406) [2026-01-28 00:29:45] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7372800 bytes
(EngineCore_DP0 pid=3483406) [2026-01-28 00:29:45] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 3840] -> 1D uint8
(EngineCore_DP0 pid=3483406) [2026-01-28 00:29:45] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 39813120 bytes
(EngineCore_DP0 pid=3483406) [2026-01-28 00:29:45] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 10368] -> 1D uint8
(EngineCore_DP0 pid=3483406) [2026-01-28 00:29:45] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 19906560 bytes
(EngineCore_DP0 pid=3483406) [rank0]:W0128 00:29:52.550000 3483406 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=3483406) [rank0]:W0128 00:29:52.598000 3483406 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=3483406) [rank0]:W0128 00:29:53.292000 3483406 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=3483406) [rank0]:W0128 00:29:53.368000 3483406 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=3483406) 2026-01-28 00:29:55,621 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3483406) 2026-01-28 00:29:55,638 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3483406) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   9%|▉         | 1/11 [00:00<00:04,  2.29it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  27%|██▋       | 3/11 [00:00<00:01,  6.58it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  55%|█████▍    | 6/11 [00:00<00:00, 12.26it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  82%|████████▏ | 9/11 [00:00<00:00, 16.41it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:00<00:00, 12.90it/s]
(EngineCore_DP0 pid=3483406) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  14%|█▍        | 1/7 [00:00<00:00,  7.38it/s]
Capturing CUDA graphs (decode, FULL):  57%|█████▋    | 4/7 [00:00<00:00, 18.95it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00, 22.13it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00, 19.89it/s]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 72/4096 [00:00<00:05, 719.08it/s]
Adding requests:   4%|▎         | 148/4096 [00:00<00:05, 741.01it/s]
Adding requests:   5%|▌         | 225/4096 [00:00<00:05, 750.08it/s]
Adding requests:   7%|▋         | 301/4096 [00:00<00:05, 753.71it/s]
Adding requests:   9%|▉         | 377/4096 [00:00<00:04, 755.13it/s]
Adding requests:  11%|█         | 453/4096 [00:00<00:04, 749.47it/s]
Adding requests:  13%|█▎        | 528/4096 [00:00<00:04, 726.83it/s]
Adding requests:  15%|█▍        | 601/4096 [00:00<00:04, 724.85it/s]
Adding requests:  17%|█▋        | 680/4096 [00:00<00:04, 743.60it/s]
Adding requests:  19%|█▊        | 758/4096 [00:01<00:04, 752.06it/s]
Adding requests:  20%|██        | 834/4096 [00:01<00:04, 732.33it/s]
Adding requests:  22%|██▏       | 912/4096 [00:01<00:04, 744.16it/s]
Adding requests:  24%|██▍       | 989/4096 [00:01<00:04, 749.95it/s]
Adding requests:  26%|██▌       | 1067/4096 [00:01<00:04, 756.05it/s]
Adding requests:  28%|██▊       | 1143/4096 [00:01<00:04, 733.05it/s]
Adding requests:  30%|██▉       | 1222/4096 [00:01<00:03, 745.80it/s]
Adding requests:  32%|███▏      | 1297/4096 [00:01<00:03, 746.49it/s]
Adding requests:  34%|███▎      | 1376/4096 [00:01<00:03, 758.60it/s]
Adding requests:  35%|███▌      | 1454/4096 [00:01<00:03, 764.88it/s]
Adding requests:  37%|███▋      | 1534/4096 [00:02<00:03, 774.91it/s]
Adding requests:  39%|███▉      | 1612/4096 [00:02<00:03, 760.22it/s]
Adding requests:  41%|████      | 1689/4096 [00:02<00:03, 749.49it/s]
Adding requests:  43%|████▎     | 1765/4096 [00:02<00:03, 751.75it/s]
Adding requests:  45%|████▍     | 1842/4096 [00:02<00:02, 756.75it/s]
Adding requests:  47%|████▋     | 1918/4096 [00:02<00:02, 754.03it/s]
Adding requests:  49%|████▊     | 1994/4096 [00:02<00:02, 749.82it/s]
Adding requests:  51%|█████     | 2070/4096 [00:02<00:02, 751.59it/s]
Adding requests:  52%|█████▏    | 2146/4096 [00:02<00:02, 741.04it/s]
Adding requests:  54%|█████▍    | 2221/4096 [00:02<00:02, 743.64it/s]
Adding requests:  56%|█████▌    | 2300/4096 [00:03<00:02, 754.14it/s]
Adding requests:  58%|█████▊    | 2376/4096 [00:03<00:02, 741.78it/s]
Adding requests:  60%|█████▉    | 2452/4096 [00:03<00:02, 746.34it/s]
Adding requests:  62%|██████▏   | 2530/4096 [00:03<00:02, 754.86it/s]
Adding requests:  64%|██████▎   | 2608/4096 [00:03<00:01, 760.80it/s]
Adding requests:  66%|██████▌   | 2686/4096 [00:03<00:01, 764.84it/s]
Adding requests:  67%|██████▋   | 2763/4096 [00:03<00:01, 765.56it/s]
Adding requests:  69%|██████▉   | 2840/4096 [00:03<00:01, 764.48it/s]
Adding requests:  71%|███████   | 2918/4096 [00:03<00:01, 766.48it/s]
Adding requests:  73%|███████▎  | 2995/4096 [00:03<00:01, 766.27it/s]
Adding requests:  75%|███████▌  | 3072/4096 [00:04<00:01, 762.44it/s]
Adding requests:  77%|███████▋  | 3149/4096 [00:04<00:01, 764.49it/s]
Adding requests:  79%|███████▉  | 3227/4096 [00:04<00:01, 766.93it/s]
Adding requests:  81%|████████  | 3305/4096 [00:04<00:01, 770.74it/s]
Adding requests:  83%|████████▎ | 3383/4096 [00:04<00:00, 772.31it/s]
Adding requests:  84%|████████▍ | 3461/4096 [00:04<00:00, 758.62it/s]
Adding requests:  86%|████████▋ | 3537/4096 [00:04<00:00, 757.06it/s]
Adding requests:  88%|████████▊ | 3613/4096 [00:04<00:00, 757.39it/s]
Adding requests:  90%|█████████ | 3689/4096 [00:04<00:00, 732.29it/s]
Adding requests:  92%|█████████▏| 3765/4096 [00:05<00:00, 738.15it/s]
Adding requests:  94%|█████████▍| 3841/4096 [00:05<00:00, 744.24it/s]
Adding requests:  96%|█████████▌| 3918/4096 [00:05<00:00, 750.67it/s]
Adding requests:  98%|█████████▊| 3994/4096 [00:05<00:00, 748.56it/s]
Adding requests:  99%|█████████▉| 4070/4096 [00:05<00:00, 750.01it/s]
Adding requests: 100%|██████████| 4096/4096 [00:05<00:00, 752.28it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▌         | 226/4096 [00:00<00:03, 1063.36it/s, est. speed input: 1088963.22 toks/s, output: 1063.39 toks/s]
Processed prompts:   8%|▊         | 333/4096 [00:02<00:31, 118.52it/s, est. speed input: 148166.76 toks/s, output: 144.69 toks/s]   
Processed prompts:   9%|▉         | 380/4096 [00:02<00:36, 102.80it/s, est. speed input: 129786.71 toks/s, output: 126.74 toks/s]
Processed prompts:  10%|▉         | 409/4096 [00:03<00:43, 84.11it/s, est. speed input: 113352.58 toks/s, output: 110.70 toks/s] 
Processed prompts:  10%|█         | 428/4096 [00:04<00:54, 66.85it/s, est. speed input: 99805.18 toks/s, output: 97.47 toks/s]  
Processed prompts:  11%|█         | 450/4096 [00:05<01:04, 56.18it/s, est. speed input: 90568.08 toks/s, output: 88.45 toks/s]
Processed prompts:  12%|█▏        | 482/4096 [00:05<01:08, 53.09it/s, est. speed input: 85326.23 toks/s, output: 83.33 toks/s]
Processed prompts:  13%|█▎        | 514/4096 [00:06<01:10, 50.92it/s, est. speed input: 81203.55 toks/s, output: 79.30 toks/s]
Processed prompts:  13%|█▎        | 546/4096 [00:07<01:11, 49.41it/s, est. speed input: 77881.05 toks/s, output: 76.06 toks/s]
Processed prompts:  14%|█▍        | 578/4096 [00:07<01:12, 48.36it/s, est. speed input: 75150.37 toks/s, output: 73.39 toks/s]
Processed prompts:  15%|█▍        | 610/4096 [00:08<01:13, 47.61it/s, est. speed input: 72858.68 toks/s, output: 71.15 toks/s]
Processed prompts:  16%|█▌        | 642/4096 [00:09<01:13, 47.09it/s, est. speed input: 70912.16 toks/s, output: 69.25 toks/s]
Processed prompts:  16%|█▋        | 674/4096 [00:09<01:13, 46.73it/s, est. speed input: 69238.73 toks/s, output: 67.62 toks/s]
Processed prompts:  17%|█▋        | 706/4096 [00:10<01:12, 46.48it/s, est. speed input: 67783.75 toks/s, output: 66.19 toks/s]
Processed prompts:  18%|█▊        | 738/4096 [00:11<01:12, 46.29it/s, est. speed input: 66504.27 toks/s, output: 64.95 toks/s]
Processed prompts:  19%|█▉        | 770/4096 [00:12<01:12, 46.17it/s, est. speed input: 65376.75 toks/s, output: 63.84 toks/s]
Processed prompts:  20%|█▉        | 802/4096 [00:12<01:11, 46.08it/s, est. speed input: 64370.94 toks/s, output: 62.86 toks/s]
Processed prompts:  20%|██        | 834/4096 [00:13<01:10, 46.02it/s, est. speed input: 63468.02 toks/s, output: 61.98 toks/s]
Processed prompts:  21%|██        | 866/4096 [00:14<01:10, 45.97it/s, est. speed input: 62653.50 toks/s, output: 61.19 toks/s]
Processed prompts:  22%|██▏       | 898/4096 [00:14<01:09, 45.94it/s, est. speed input: 61916.96 toks/s, output: 60.47 toks/s]
Processed prompts:  23%|██▎       | 930/4096 [00:15<01:08, 45.92it/s, est. speed input: 61246.01 toks/s, output: 59.81 toks/s]
Processed prompts:  23%|██▎       | 962/4096 [00:16<01:08, 45.90it/s, est. speed input: 60632.02 toks/s, output: 59.21 toks/s]
Processed prompts:  24%|██▍       | 994/4096 [00:16<01:07, 45.87it/s, est. speed input: 60066.90 toks/s, output: 58.66 toks/s]
Processed prompts:  25%|██▌       | 1026/4096 [00:17<01:06, 45.87it/s, est. speed input: 59547.76 toks/s, output: 58.15 toks/s]
Processed prompts:  26%|██▌       | 1058/4096 [00:18<01:06, 45.85it/s, est. speed input: 59066.69 toks/s, output: 57.68 toks/s]
Processed prompts:  27%|██▋       | 1090/4096 [00:19<01:05, 45.85it/s, est. speed input: 58622.77 toks/s, output: 57.25 toks/s]
Processed prompts:  27%|██▋       | 1122/4096 [00:19<01:04, 45.84it/s, est. speed input: 58209.05 toks/s, output: 56.84 toks/s]
Processed prompts:  28%|██▊       | 1154/4096 [00:20<01:04, 45.84it/s, est. speed input: 57823.82 toks/s, output: 56.47 toks/s]
Processed prompts:  29%|██▉       | 1186/4096 [00:21<01:03, 45.83it/s, est. speed input: 57463.35 toks/s, output: 56.12 toks/s]
Processed prompts:  30%|██▉       | 1218/4096 [00:21<01:02, 45.83it/s, est. speed input: 57126.50 toks/s, output: 55.79 toks/s]
Processed prompts:  31%|███       | 1250/4096 [00:22<01:02, 45.83it/s, est. speed input: 56810.71 toks/s, output: 55.48 toks/s]
Processed prompts:  31%|███▏      | 1282/4096 [00:23<01:01, 45.79it/s, est. speed input: 56508.61 toks/s, output: 55.18 toks/s]
Processed prompts:  32%|███▏      | 1314/4096 [00:23<01:00, 45.80it/s, est. speed input: 56229.35 toks/s, output: 54.91 toks/s]
Processed prompts:  33%|███▎      | 1346/4096 [00:24<01:00, 45.81it/s, est. speed input: 55965.15 toks/s, output: 54.65 toks/s]
Processed prompts:  34%|███▎      | 1378/4096 [00:25<00:59, 45.81it/s, est. speed input: 55716.08 toks/s, output: 54.41 toks/s]
Processed prompts:  34%|███▍      | 1410/4096 [00:26<00:58, 45.82it/s, est. speed input: 55480.20 toks/s, output: 54.18 toks/s]
Processed prompts:  35%|███▌      | 1442/4096 [00:26<00:57, 45.83it/s, est. speed input: 55257.23 toks/s, output: 53.96 toks/s]
Processed prompts:  36%|███▌      | 1474/4096 [00:27<00:57, 45.81it/s, est. speed input: 55043.58 toks/s, output: 53.75 toks/s]
Processed prompts:  37%|███▋      | 1506/4096 [00:28<00:56, 45.81it/s, est. speed input: 54841.52 toks/s, output: 53.56 toks/s]
Processed prompts:  38%|███▊      | 1538/4096 [00:28<00:55, 45.82it/s, est. speed input: 54650.44 toks/s, output: 53.37 toks/s]
Processed prompts:  38%|███▊      | 1570/4096 [00:29<00:55, 45.80it/s, est. speed input: 54465.70 toks/s, output: 53.19 toks/s]
Processed prompts:  39%|███▉      | 1602/4096 [00:30<00:54, 45.80it/s, est. speed input: 54290.41 toks/s, output: 53.02 toks/s]
Processed prompts:  40%|███▉      | 1634/4096 [00:30<00:53, 45.80it/s, est. speed input: 54123.36 toks/s, output: 52.85 toks/s]
Processed prompts:  41%|████      | 1666/4096 [00:31<00:53, 45.80it/s, est. speed input: 53963.91 toks/s, output: 52.70 toks/s]
Processed prompts:  41%|████▏     | 1698/4096 [00:32<00:52, 45.79it/s, est. speed input: 53810.38 toks/s, output: 52.55 toks/s]
Processed prompts:  42%|████▏     | 1730/4096 [00:33<00:51, 45.80it/s, est. speed input: 53664.61 toks/s, output: 52.41 toks/s]
Processed prompts:  43%|████▎     | 1762/4096 [00:33<00:50, 45.80it/s, est. speed input: 53524.04 toks/s, output: 52.27 toks/s]
Processed prompts:  44%|████▍     | 1794/4096 [00:34<00:50, 45.80it/s, est. speed input: 53389.37 toks/s, output: 52.14 toks/s]
Processed prompts:  45%|████▍     | 1826/4096 [00:35<00:49, 45.79it/s, est. speed input: 53259.74 toks/s, output: 52.01 toks/s]
Processed prompts:  45%|████▌     | 1858/4096 [00:35<00:48, 46.18it/s, est. speed input: 53164.86 toks/s, output: 51.92 toks/s]
Processed prompts:  46%|████▌     | 1890/4096 [00:36<00:47, 46.06it/s, est. speed input: 53044.54 toks/s, output: 51.80 toks/s]
Processed prompts:  47%|████▋     | 1922/4096 [00:37<00:47, 45.97it/s, est. speed input: 52928.16 toks/s, output: 51.69 toks/s]
Processed prompts:  48%|████▊     | 1954/4096 [00:37<00:46, 45.93it/s, est. speed input: 52817.60 toks/s, output: 51.58 toks/s]
Processed prompts:  48%|████▊     | 1986/4096 [00:38<00:45, 45.87it/s, est. speed input: 52709.07 toks/s, output: 51.47 toks/s]
Processed prompts:  49%|████▉     | 2018/4096 [00:39<00:45, 45.84it/s, est. speed input: 52604.83 toks/s, output: 51.37 toks/s]
Processed prompts:  50%|█████     | 2050/4096 [00:39<00:44, 45.82it/s, est. speed input: 52504.80 toks/s, output: 51.27 toks/s]
Processed prompts:  51%|█████     | 2082/4096 [00:40<00:43, 45.81it/s, est. speed input: 52408.01 toks/s, output: 51.18 toks/s]
Processed prompts:  52%|█████▏    | 2114/4096 [00:41<00:43, 45.79it/s, est. speed input: 52314.28 toks/s, output: 51.09 toks/s]
Processed prompts:  52%|█████▏    | 2146/4096 [00:42<00:42, 45.79it/s, est. speed input: 52223.87 toks/s, output: 51.00 toks/s]
Processed prompts:  53%|█████▎    | 2178/4096 [00:42<00:41, 45.79it/s, est. speed input: 52136.58 toks/s, output: 50.91 toks/s]
Processed prompts:  54%|█████▍    | 2210/4096 [00:43<00:41, 45.78it/s, est. speed input: 52051.97 toks/s, output: 50.83 toks/s]
Processed prompts:  55%|█████▍    | 2242/4096 [00:44<00:40, 45.79it/s, est. speed input: 51970.57 toks/s, output: 50.75 toks/s]
Processed prompts:  56%|█████▌    | 2274/4096 [00:44<00:39, 45.77it/s, est. speed input: 51890.39 toks/s, output: 50.67 toks/s]
Processed prompts:  56%|█████▋    | 2306/4096 [00:45<00:39, 45.76it/s, est. speed input: 51812.84 toks/s, output: 50.60 toks/s]
Processed prompts:  57%|█████▋    | 2338/4096 [00:46<00:38, 45.77it/s, est. speed input: 51738.32 toks/s, output: 50.53 toks/s]
Processed prompts:  58%|█████▊    | 2370/4096 [00:46<00:37, 45.77it/s, est. speed input: 51665.85 toks/s, output: 50.45 toks/s]
Processed prompts:  59%|█████▊    | 2402/4096 [00:47<00:37, 45.77it/s, est. speed input: 51595.66 toks/s, output: 50.39 toks/s]
Processed prompts:  59%|█████▉    | 2434/4096 [00:48<00:36, 45.76it/s, est. speed input: 51526.61 toks/s, output: 50.32 toks/s]
Processed prompts:  60%|██████    | 2466/4096 [00:49<00:35, 45.77it/s, est. speed input: 51460.93 toks/s, output: 50.25 toks/s]
Processed prompts:  61%|██████    | 2498/4096 [00:49<00:34, 46.17it/s, est. speed input: 51416.85 toks/s, output: 50.21 toks/s]
Processed prompts:  62%|██████▏   | 2530/4096 [00:50<00:34, 46.04it/s, est. speed input: 51353.61 toks/s, output: 50.15 toks/s]
Processed prompts:  63%|██████▎   | 2562/4096 [00:51<00:33, 45.95it/s, est. speed input: 51291.96 toks/s, output: 50.09 toks/s]
Processed prompts:  63%|██████▎   | 2594/4096 [00:51<00:32, 45.90it/s, est. speed input: 51232.20 toks/s, output: 50.03 toks/s]
Processed prompts:  64%|██████▍   | 2626/4096 [00:52<00:32, 45.85it/s, est. speed input: 51173.84 toks/s, output: 49.97 toks/s]
Processed prompts:  65%|██████▍   | 2658/4096 [00:53<00:31, 45.81it/s, est. speed input: 51116.57 toks/s, output: 49.92 toks/s]
Processed prompts:  66%|██████▌   | 2690/4096 [00:53<00:30, 45.80it/s, est. speed input: 51061.35 toks/s, output: 49.86 toks/s]
Processed prompts:  66%|██████▋   | 2722/4096 [00:54<00:30, 45.78it/s, est. speed input: 51007.32 toks/s, output: 49.81 toks/s]
Processed prompts:  67%|██████▋   | 2754/4096 [00:55<00:29, 45.77it/s, est. speed input: 50954.68 toks/s, output: 49.76 toks/s]
Processed prompts:  68%|██████▊   | 2786/4096 [00:56<00:28, 45.77it/s, est. speed input: 50903.61 toks/s, output: 49.71 toks/s]
Processed prompts:  69%|██████▉   | 2818/4096 [00:56<00:27, 45.77it/s, est. speed input: 50853.77 toks/s, output: 49.66 toks/s]
Processed prompts:  70%|██████▉   | 2850/4096 [00:57<00:27, 45.75it/s, est. speed input: 50804.48 toks/s, output: 49.61 toks/s]
Processed prompts:  70%|███████   | 2882/4096 [00:58<00:26, 45.75it/s, est. speed input: 50756.83 toks/s, output: 49.57 toks/s]
Processed prompts:  71%|███████   | 2914/4096 [00:58<00:25, 45.75it/s, est. speed input: 50710.43 toks/s, output: 49.52 toks/s]
Processed prompts:  72%|███████▏  | 2946/4096 [00:59<00:25, 45.75it/s, est. speed input: 50664.96 toks/s, output: 49.48 toks/s]
Processed prompts:  73%|███████▎  | 2978/4096 [01:00<00:24, 45.74it/s, est. speed input: 50620.08 toks/s, output: 49.43 toks/s]
Processed prompts:  73%|███████▎  | 3010/4096 [01:00<00:23, 45.74it/s, est. speed input: 50576.96 toks/s, output: 49.39 toks/s]
Processed prompts:  74%|███████▍  | 3042/4096 [01:01<00:23, 45.74it/s, est. speed input: 50534.55 toks/s, output: 49.35 toks/s]
Processed prompts:  75%|███████▌  | 3074/4096 [01:02<00:22, 45.74it/s, est. speed input: 50492.98 toks/s, output: 49.31 toks/s]
Processed prompts:  76%|███████▌  | 3106/4096 [01:03<00:21, 45.74it/s, est. speed input: 50452.31 toks/s, output: 49.27 toks/s]
Processed prompts:  77%|███████▋  | 3138/4096 [01:03<00:20, 45.74it/s, est. speed input: 50412.57 toks/s, output: 49.23 toks/s]
Processed prompts:  77%|███████▋  | 3170/4096 [01:04<00:20, 45.74it/s, est. speed input: 50373.68 toks/s, output: 49.19 toks/s]
Processed prompts:  78%|███████▊  | 3202/4096 [01:05<00:19, 45.73it/s, est. speed input: 50335.55 toks/s, output: 49.16 toks/s]
Processed prompts:  79%|███████▉  | 3234/4096 [01:05<00:18, 45.74it/s, est. speed input: 50298.41 toks/s, output: 49.12 toks/s]
Processed prompts:  80%|███████▉  | 3266/4096 [01:06<00:18, 45.73it/s, est. speed input: 50261.68 toks/s, output: 49.08 toks/s]
Processed prompts:  81%|████████  | 3298/4096 [01:07<00:17, 45.72it/s, est. speed input: 50225.60 toks/s, output: 49.05 toks/s]
Processed prompts:  81%|████████▏ | 3330/4096 [01:07<00:16, 45.75it/s, est. speed input: 50191.52 toks/s, output: 49.02 toks/s]
Processed prompts:  82%|████████▏ | 3362/4096 [01:08<00:16, 45.73it/s, est. speed input: 50156.65 toks/s, output: 48.98 toks/s]
Processed prompts:  83%|████████▎ | 3394/4096 [01:09<00:15, 45.72it/s, est. speed input: 50122.77 toks/s, output: 48.95 toks/s]
Processed prompts:  84%|████████▎ | 3426/4096 [01:10<00:14, 45.73it/s, est. speed input: 50090.00 toks/s, output: 48.92 toks/s]
Processed prompts:  84%|████████▍ | 3458/4096 [01:10<00:13, 45.73it/s, est. speed input: 50057.75 toks/s, output: 48.88 toks/s]
Processed prompts:  85%|████████▌ | 3490/4096 [01:11<00:13, 45.73it/s, est. speed input: 50026.09 toks/s, output: 48.85 toks/s]
Processed prompts:  86%|████████▌ | 3522/4096 [01:12<00:12, 45.72it/s, est. speed input: 49994.73 toks/s, output: 48.82 toks/s]
Processed prompts:  87%|████████▋ | 3554/4096 [01:12<00:11, 45.72it/s, est. speed input: 49964.34 toks/s, output: 48.79 toks/s]
Processed prompts:  88%|████████▊ | 3586/4096 [01:13<00:11, 45.73it/s, est. speed input: 49934.47 toks/s, output: 48.76 toks/s]
Processed prompts:  88%|████████▊ | 3618/4096 [01:14<00:10, 45.73it/s, est. speed input: 49905.13 toks/s, output: 48.74 toks/s]
Processed prompts:  89%|████████▉ | 3650/4096 [01:14<00:09, 45.72it/s, est. speed input: 49876.20 toks/s, output: 48.71 toks/s]
Processed prompts:  90%|████████▉ | 3682/4096 [01:15<00:09, 45.72it/s, est. speed input: 49847.98 toks/s, output: 48.68 toks/s]
Processed prompts:  91%|█████████ | 3714/4096 [01:16<00:08, 45.72it/s, est. speed input: 49820.01 toks/s, output: 48.65 toks/s]
Processed prompts:  91%|█████████▏| 3746/4096 [01:17<00:07, 45.72it/s, est. speed input: 49792.77 toks/s, output: 48.63 toks/s]
Processed prompts:  92%|█████████▏| 3778/4096 [01:17<00:06, 45.72it/s, est. speed input: 49766.01 toks/s, output: 48.60 toks/s]
Processed prompts:  93%|█████████▎| 3810/4096 [01:18<00:06, 45.72it/s, est. speed input: 49739.60 toks/s, output: 48.57 toks/s]
Processed prompts:  94%|█████████▍| 3842/4096 [01:19<00:05, 45.72it/s, est. speed input: 49713.66 toks/s, output: 48.55 toks/s]
Processed prompts:  95%|█████████▍| 3874/4096 [01:19<00:04, 45.72it/s, est. speed input: 49688.29 toks/s, output: 48.52 toks/s]
Processed prompts:  95%|█████████▌| 3906/4096 [01:20<00:04, 45.71it/s, est. speed input: 49663.23 toks/s, output: 48.50 toks/s]
Processed prompts:  96%|█████████▌| 3938/4096 [01:21<00:03, 45.71it/s, est. speed input: 49638.41 toks/s, output: 48.47 toks/s]
Processed prompts:  97%|█████████▋| 3970/4096 [01:21<00:02, 45.70it/s, est. speed input: 49614.01 toks/s, output: 48.45 toks/s]
Processed prompts:  98%|█████████▊| 4002/4096 [01:22<00:02, 45.70it/s, est. speed input: 49590.17 toks/s, output: 48.43 toks/s]
Processed prompts:  98%|█████████▊| 4034/4096 [01:23<00:01, 46.10it/s, est. speed input: 49578.78 toks/s, output: 48.42 toks/s]
Processed prompts:  99%|█████████▉| 4066/4096 [01:23<00:00, 46.43it/s, est. speed input: 49568.98 toks/s, output: 48.41 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [01:23<00:00, 46.43it/s, est. speed input: 49934.35 toks/s, output: 48.76 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [01:23<00:00, 48.76it/s, est. speed input: 49934.35 toks/s, output: 48.76 toks/s]
[rank0]:[W128 00:31:27.296873324 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 123.6s

测试结果:
  Requests/s:   45.79
  Tokens/s:     46939.63
  Total Reqs:   4096
  Elapsed:      89.44s

  [Prefill 分析]
  Total Prefill Tokens: 4194304
  Prefill Tokens/s:     46893.84


------------------------------------------------------------
  生成 CSV: BitNet-2B-INT8
------------------------------------------------------------
[SUCCESS] CSV 保存到: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX5080_cc120_INT8_py312_cu129_x86_64/cusparselt/2_8/BitNet-2B-INT8_prefill.csv

预览:
------------------------------------------------------------
M_prefill,prompt_len,max_num_seqs,num_prompts,N_prefill,requests_per_s,tokens_per_s,elapsed_time_s
512,512,1,128,128,55.6111,28528.5073,2.3017
1024,1024,1,128,128,44.3225,45430.5288,2.8879
2048,1024,2,256,128,49.4580,50694.4654,5.1761
4096,1024,4,512,128,49.1401,50368.6305,10.4192
8192,1024,8,1024,128,46.7991,47969.1016,21.8808
16384,1024,16,2048,128,45.7100,46852.7952,44.8042
32768,1024,32,4096,128,45.7948,46939.6325,89.4425

------------------------------------------------------------

[INFO] 完成: 7 成功, 0 失败

============================================================
  BitNet-2B-INT8 | cuSPARSELt (2_10) | prefill
============================================================

[INFO] Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-INT8-SlideSparse-2_10
[INFO] Output: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX5080_cc120_INT8_py312_cu129_x86_64/cusparselt/2_10

============================================================
[1/7] 测试 M=512
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-INT8                                  │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 512
│   M_prefill     = 512 (= 1 x 512)
│   M_decode      = 1
│   batched_tokens = 513 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 512
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 513
│   --max-num-batched-tokens = 513
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:31:32 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3485217) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3485217) WARNING 01-28 00:31:42 [backends.py:609] Failed to read file <frozen os>
Throughput: 54.10 requests/s, 27751.36 total tokens/s, 54.10 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128


─── STDERR ───
[2026-01-28 00:31:32] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:31:32] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:31:32] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:31:32] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:31:32] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:31:32] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:31:32] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:31:32] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:31:32] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:31:32] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:31:32] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:31:32] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:31:32] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:31:32] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:31:36] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:31:36] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:31:36] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:31:36] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:31:36] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:31:36] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:31:36] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:31:36] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:31:36] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:31:36] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:31:36] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:31:36] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:31:36] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:31:36] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3485217) [2026-01-28 00:31:37] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3485217) [2026-01-28 00:31:37] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3485217) [2026-01-28 00:31:37] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3485217) [2026-01-28 00:31:37] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=3485217) [2026-01-28 00:31:37] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=3485217) [2026-01-28 00:31:37] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=3485217) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3485217) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.30it/s]
(EngineCore_DP0 pid=3485217) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.30it/s]
(EngineCore_DP0 pid=3485217) 
(EngineCore_DP0 pid=3485217) [2026-01-28 00:31:37] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 4096] -> 1D uint8
(EngineCore_DP0 pid=3485217) [2026-01-28 00:31:37] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 11796480 bytes
(EngineCore_DP0 pid=3485217) [2026-01-28 00:31:37] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 4096] -> 1D uint8
(EngineCore_DP0 pid=3485217) [2026-01-28 00:31:37] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7864320 bytes
(EngineCore_DP0 pid=3485217) [2026-01-28 00:31:37] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 4096] -> 1D uint8
(EngineCore_DP0 pid=3485217) [2026-01-28 00:31:37] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 42467328 bytes
(EngineCore_DP0 pid=3485217) [2026-01-28 00:31:37] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 11072] -> 1D uint8
(EngineCore_DP0 pid=3485217) [2026-01-28 00:31:37] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 21299200 bytes
(EngineCore_DP0 pid=3485217) 2026-01-28 00:31:48,262 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3485217) 2026-01-28 00:31:48,277 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3485217) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  50%|█████     | 1/2 [00:00<00:00,  3.98it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  4.15it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00,  4.12it/s]
(EngineCore_DP0 pid=3485217) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.36it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.35it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  95%|█████████▍| 121/128 [00:00<00:00, 1208.57it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 1213.96it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:21,  5.91it/s, est. speed input: 3026.45 toks/s, output: 5.91 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:03, 30.41it/s, est. speed input: 13223.20 toks/s, output: 25.83 toks/s]
Processed prompts:  11%|█         | 14/128 [00:00<00:02, 43.67it/s, est. speed input: 18642.53 toks/s, output: 36.41 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:00<00:02, 50.33it/s, est. speed input: 21555.11 toks/s, output: 42.10 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:00<00:01, 54.11it/s, est. speed input: 23370.32 toks/s, output: 45.64 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:00<00:01, 56.43it/s, est. speed input: 24612.32 toks/s, output: 48.07 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:00<00:01, 58.21it/s, est. speed input: 25568.87 toks/s, output: 49.94 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:00<00:01, 58.92it/s, est. speed input: 26219.24 toks/s, output: 51.21 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:01<00:01, 59.69it/s, est. speed input: 26774.29 toks/s, output: 52.29 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:01<00:01, 60.54it/s, est. speed input: 27269.50 toks/s, output: 53.26 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:01<00:00, 60.72it/s, est. speed input: 27625.17 toks/s, output: 53.96 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:01<00:00, 60.37it/s, est. speed input: 27864.37 toks/s, output: 54.42 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:01<00:00, 60.67it/s, est. speed input: 28130.24 toks/s, output: 54.94 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:01<00:00, 61.06it/s, est. speed input: 28377.60 toks/s, output: 55.42 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:01<00:00, 60.86it/s, est. speed input: 28545.73 toks/s, output: 55.75 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:01<00:00, 59.54it/s, est. speed input: 28577.30 toks/s, output: 55.81 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:01<00:00, 59.70it/s, est. speed input: 28704.69 toks/s, output: 56.06 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:02<00:00, 60.06it/s, est. speed input: 28839.34 toks/s, output: 56.33 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:02<00:00, 60.47it/s, est. speed input: 28973.68 toks/s, output: 56.59 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:02<00:00, 60.47it/s, est. speed input: 29011.79 toks/s, output: 56.66 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:02<00:00, 56.66it/s, est. speed input: 29011.79 toks/s, output: 56.66 toks/s]
[rank0]:[W128 00:31:52.162190349 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 25.0s

测试结果:
  Requests/s:   54.10
  Tokens/s:     27751.36
  Total Reqs:   128
  Elapsed:      2.37s

  [Prefill 分析]
  Total Prefill Tokens: 65536
  Prefill Tokens/s:     27697.26

============================================================
[2/7] 测试 M=1024
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-INT8                                  │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 1024
│   M_prefill     = 1024 (= 1 x 1024)
│   M_decode      = 1
│   batched_tokens = 1025 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 1025
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:31:57 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3485898) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3485898) WARNING 01-28 00:32:07 [backends.py:609] Failed to read file <frozen os>
Throughput: 44.07 requests/s, 45174.60 total tokens/s, 44.07 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128


─── STDERR ───
[2026-01-28 00:31:57] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:31:57] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:31:57] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:31:57] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:31:57] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:31:57] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:31:57] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:31:57] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:31:57] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:31:57] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:31:57] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:31:57] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:31:57] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:31:57] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:32:01] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:32:01] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:32:01] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:32:01] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:32:01] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:32:01] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:32:01] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:32:01] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:32:01] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:32:01] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:32:01] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:32:01] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:32:01] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:32:01] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3485898) [2026-01-28 00:32:02] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3485898) [2026-01-28 00:32:02] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3485898) [2026-01-28 00:32:02] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3485898) [2026-01-28 00:32:02] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=3485898) [2026-01-28 00:32:02] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=3485898) [2026-01-28 00:32:02] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=3485898) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3485898) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.51it/s]
(EngineCore_DP0 pid=3485898) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.51it/s]
(EngineCore_DP0 pid=3485898) 
(EngineCore_DP0 pid=3485898) [2026-01-28 00:32:02] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 4096] -> 1D uint8
(EngineCore_DP0 pid=3485898) [2026-01-28 00:32:02] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 11796480 bytes
(EngineCore_DP0 pid=3485898) [2026-01-28 00:32:02] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 4096] -> 1D uint8
(EngineCore_DP0 pid=3485898) [2026-01-28 00:32:02] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7864320 bytes
(EngineCore_DP0 pid=3485898) [2026-01-28 00:32:02] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 4096] -> 1D uint8
(EngineCore_DP0 pid=3485898) [2026-01-28 00:32:02] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 42467328 bytes
(EngineCore_DP0 pid=3485898) [2026-01-28 00:32:02] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 11072] -> 1D uint8
(EngineCore_DP0 pid=3485898) [2026-01-28 00:32:02] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 21299200 bytes
(EngineCore_DP0 pid=3485898) 2026-01-28 00:32:13,274 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3485898) 2026-01-28 00:32:13,290 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3485898) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 2/2 [00:00<00:00, 20.76it/s]
(EngineCore_DP0 pid=3485898) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.31it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 1/1 [00:00<00:00,  7.31it/s]

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  50%|█████     | 64/128 [00:00<00:00, 632.77it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 679.08it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:04, 26.42it/s, est. speed input: 27052.70 toks/s, output: 26.42 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:00<00:03, 38.62it/s, est. speed input: 37593.62 toks/s, output: 36.71 toks/s]
Processed prompts:  10%|█         | 13/128 [00:00<00:02, 42.91it/s, est. speed input: 41394.82 toks/s, output: 40.42 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:00<00:02, 44.96it/s, est. speed input: 43332.27 toks/s, output: 42.32 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:00<00:02, 46.03it/s, est. speed input: 44468.08 toks/s, output: 43.43 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:00<00:02, 46.66it/s, est. speed input: 45222.00 toks/s, output: 44.16 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:00<00:02, 46.97it/s, est. speed input: 45721.50 toks/s, output: 44.65 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:00<00:01, 47.33it/s, est. speed input: 46159.55 toks/s, output: 45.08 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:00<00:01, 47.52it/s, est. speed input: 46481.41 toks/s, output: 45.39 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:01<00:01, 47.71it/s, est. speed input: 46759.45 toks/s, output: 45.66 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:01<00:01, 47.85it/s, est. speed input: 46990.52 toks/s, output: 45.89 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:01<00:01, 47.95it/s, est. speed input: 47182.08 toks/s, output: 46.08 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:01<00:01, 47.99it/s, est. speed input: 47340.45 toks/s, output: 46.23 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:01<00:01, 48.01it/s, est. speed input: 47471.28 toks/s, output: 46.36 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:01<00:01, 48.02it/s, est. speed input: 47585.79 toks/s, output: 46.47 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:01<00:01, 48.01it/s, est. speed input: 47682.40 toks/s, output: 46.56 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:01<00:00, 48.08it/s, est. speed input: 47783.14 toks/s, output: 46.66 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:01<00:00, 48.13it/s, est. speed input: 47873.06 toks/s, output: 46.75 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:01<00:00, 48.17it/s, est. speed input: 47953.77 toks/s, output: 46.83 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:02<00:00, 48.14it/s, est. speed input: 48016.28 toks/s, output: 46.89 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:02<00:00, 48.13it/s, est. speed input: 48075.77 toks/s, output: 46.95 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:02<00:00, 48.14it/s, est. speed input: 48132.24 toks/s, output: 47.00 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:02<00:00, 48.15it/s, est. speed input: 48183.46 toks/s, output: 47.05 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:02<00:00, 48.17it/s, est. speed input: 48232.78 toks/s, output: 47.10 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:02<00:00, 48.12it/s, est. speed input: 48270.39 toks/s, output: 47.14 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:02<00:00, 48.02it/s, est. speed input: 48295.55 toks/s, output: 47.16 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:02<00:00, 48.02it/s, est. speed input: 48295.55 toks/s, output: 47.16 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:02<00:00, 47.16it/s, est. speed input: 48295.55 toks/s, output: 47.16 toks/s]
[rank0]:[W128 00:32:17.367515802 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 25.0s

测试结果:
  Requests/s:   44.07
  Tokens/s:     45174.60
  Total Reqs:   128
  Elapsed:      2.90s

  [Prefill 分析]
  Total Prefill Tokens: 131072
  Prefill Tokens/s:     45130.53

============================================================
[3/7] 测试 M=2048
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-INT8                                  │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 2048
│   M_prefill     = 2048 (= 2 x 1024)
│   M_decode      = 2
│   batched_tokens = 2048 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 256
│   --max-num-seqs           = 2
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 2048
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:32:23 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3486539) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3486539) WARNING 01-28 00:32:32 [backends.py:609] Failed to read file <frozen os>
Throughput: 48.69 requests/s, 49902.92 total tokens/s, 48.69 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256


─── STDERR ───
[2026-01-28 00:32:23] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:32:23] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:32:23] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:32:23] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:32:23] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:32:23] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:32:23] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:32:23] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:32:23] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:32:23] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:32:23] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:32:23] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:32:23] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:32:23] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:32:27] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:32:27] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:32:27] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:32:27] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:32:27] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:32:27] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:32:27] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:32:27] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:32:27] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:32:27] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:32:27] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:32:27] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:32:27] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:32:27] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3486539) [2026-01-28 00:32:27] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3486539) [2026-01-28 00:32:27] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3486539) [2026-01-28 00:32:27] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3486539) [2026-01-28 00:32:27] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=3486539) [2026-01-28 00:32:27] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=3486539) [2026-01-28 00:32:27] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=3486539) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3486539) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.52it/s]
(EngineCore_DP0 pid=3486539) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.52it/s]
(EngineCore_DP0 pid=3486539) 
(EngineCore_DP0 pid=3486539) [2026-01-28 00:32:28] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 4096] -> 1D uint8
(EngineCore_DP0 pid=3486539) [2026-01-28 00:32:28] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 11796480 bytes
(EngineCore_DP0 pid=3486539) [2026-01-28 00:32:28] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 4096] -> 1D uint8
(EngineCore_DP0 pid=3486539) [2026-01-28 00:32:28] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7864320 bytes
(EngineCore_DP0 pid=3486539) [2026-01-28 00:32:28] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 4096] -> 1D uint8
(EngineCore_DP0 pid=3486539) [2026-01-28 00:32:28] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 42467328 bytes
(EngineCore_DP0 pid=3486539) [2026-01-28 00:32:28] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 11072] -> 1D uint8
(EngineCore_DP0 pid=3486539) [2026-01-28 00:32:28] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 21299200 bytes
(EngineCore_DP0 pid=3486539) 2026-01-28 00:32:38,654 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3486539) 2026-01-28 00:32:38,669 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3486539) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00, 21.89it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 3/3 [00:00<00:00, 21.87it/s]
(EngineCore_DP0 pid=3486539) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/2 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  50%|█████     | 1/2 [00:00<00:00,  6.89it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 2/2 [00:00<00:00, 10.28it/s]

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  25%|██▌       | 65/256 [00:00<00:00, 647.96it/s]
Adding requests:  55%|█████▍    | 140/256 [00:00<00:00, 702.61it/s]
Adding requests:  83%|████████▎ | 213/256 [00:00<00:00, 711.88it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 714.88it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   8%|▊         | 20/256 [00:00<00:01, 148.79it/s, est. speed input: 152375.67 toks/s, output: 148.80 toks/s]
Processed prompts:  14%|█▎        | 35/256 [00:00<00:02, 76.88it/s, est. speed input: 85835.68 toks/s, output: 83.82 toks/s]   
Processed prompts:  18%|█▊        | 45/256 [00:00<00:03, 64.86it/s, est. speed input: 74241.71 toks/s, output: 72.50 toks/s]
Processed prompts:  21%|██        | 53/256 [00:00<00:03, 59.71it/s, est. speed input: 69326.98 toks/s, output: 67.70 toks/s]
Processed prompts:  23%|██▎       | 60/256 [00:00<00:03, 54.46it/s, est. speed input: 65056.42 toks/s, output: 63.53 toks/s]
Processed prompts:  26%|██▌       | 66/256 [00:01<00:03, 53.11it/s, est. speed input: 63380.73 toks/s, output: 61.89 toks/s]
Processed prompts:  28%|██▊       | 72/256 [00:01<00:03, 52.13it/s, est. speed input: 62079.94 toks/s, output: 60.62 toks/s]
Processed prompts:  30%|███       | 78/256 [00:01<00:03, 51.39it/s, est. speed input: 61019.95 toks/s, output: 59.59 toks/s]
Processed prompts:  33%|███▎      | 84/256 [00:01<00:03, 50.83it/s, est. speed input: 60134.04 toks/s, output: 58.72 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:01<00:03, 50.43it/s, est. speed input: 59390.85 toks/s, output: 58.00 toks/s]
Processed prompts:  38%|███▊      | 96/256 [00:01<00:03, 50.10it/s, est. speed input: 58742.78 toks/s, output: 57.37 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:01<00:03, 49.91it/s, est. speed input: 58195.53 toks/s, output: 56.83 toks/s]
Processed prompts:  42%|████▏     | 108/256 [00:01<00:02, 49.80it/s, est. speed input: 57722.45 toks/s, output: 56.37 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:02<00:02, 49.59it/s, est. speed input: 57275.88 toks/s, output: 55.93 toks/s]
Processed prompts:  47%|████▋     | 120/256 [00:02<00:02, 49.51it/s, est. speed input: 56894.02 toks/s, output: 55.56 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:02<00:02, 49.39it/s, est. speed input: 56541.36 toks/s, output: 55.22 toks/s]
Processed prompts:  52%|█████▏    | 132/256 [00:02<00:02, 49.37it/s, est. speed input: 56234.70 toks/s, output: 54.92 toks/s]
Processed prompts:  54%|█████▍    | 138/256 [00:02<00:02, 49.35it/s, est. speed input: 55958.17 toks/s, output: 54.65 toks/s]
Processed prompts:  56%|█████▋    | 144/256 [00:02<00:02, 49.29it/s, est. speed input: 55698.57 toks/s, output: 54.39 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:02<00:02, 49.29it/s, est. speed input: 55469.78 toks/s, output: 54.17 toks/s]
Processed prompts:  61%|██████    | 156/256 [00:02<00:02, 49.31it/s, est. speed input: 55262.36 toks/s, output: 53.97 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:03<00:01, 49.35it/s, est. speed input: 55074.86 toks/s, output: 53.78 toks/s]
Processed prompts:  66%|██████▌   | 168/256 [00:03<00:01, 49.29it/s, est. speed input: 54891.05 toks/s, output: 53.60 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:03<00:01, 49.25it/s, est. speed input: 54720.16 toks/s, output: 53.44 toks/s]
Processed prompts:  70%|███████   | 180/256 [00:03<00:01, 49.31it/s, est. speed input: 54572.68 toks/s, output: 53.29 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:03<00:01, 49.34it/s, est. speed input: 54435.26 toks/s, output: 53.16 toks/s]
Processed prompts:  75%|███████▌  | 192/256 [00:03<00:01, 49.38it/s, est. speed input: 54308.56 toks/s, output: 53.04 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:03<00:01, 49.43it/s, est. speed input: 54192.61 toks/s, output: 52.92 toks/s]
Processed prompts:  80%|███████▉  | 204/256 [00:03<00:01, 49.41it/s, est. speed input: 54078.44 toks/s, output: 52.81 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:03<00:00, 49.36it/s, est. speed input: 53967.11 toks/s, output: 52.70 toks/s]
Processed prompts:  84%|████████▍ | 216/256 [00:04<00:00, 49.30it/s, est. speed input: 53858.92 toks/s, output: 52.60 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:04<00:00, 49.36it/s, est. speed input: 53768.36 toks/s, output: 52.51 toks/s]
Processed prompts:  89%|████████▉ | 228/256 [00:04<00:00, 49.37it/s, est. speed input: 53679.08 toks/s, output: 52.42 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:04<00:00, 49.40it/s, est. speed input: 53597.52 toks/s, output: 52.34 toks/s]
Processed prompts:  94%|█████████▍| 240/256 [00:04<00:00, 49.34it/s, est. speed input: 53512.03 toks/s, output: 52.26 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:04<00:00, 49.26it/s, est. speed input: 53427.45 toks/s, output: 52.18 toks/s]
Processed prompts:  98%|█████████▊| 252/256 [00:04<00:00, 49.23it/s, est. speed input: 53349.67 toks/s, output: 52.10 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:04<00:00, 49.23it/s, est. speed input: 53516.67 toks/s, output: 52.26 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:04<00:00, 52.26it/s, est. speed input: 53516.67 toks/s, output: 52.26 toks/s]
[rank0]:[W128 00:32:45.179903421 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 27.8s

测试结果:
  Requests/s:   48.69
  Tokens/s:     49902.92
  Total Reqs:   256
  Elapsed:      5.26s

  [Prefill 分析]
  Total Prefill Tokens: 262144
  Prefill Tokens/s:     49854.23

============================================================
[4/7] 测试 M=4096
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-INT8                                  │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 4096
│   M_prefill     = 4096 (= 4 x 1024)
│   M_decode      = 4
│   batched_tokens = 4096 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 512
│   --max-num-seqs           = 4
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 4096
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:32:51 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3487211) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3487211) WARNING 01-28 00:33:01 [backends.py:609] Failed to read file <frozen os>
Throughput: 47.93 requests/s, 49133.34 total tokens/s, 47.93 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512


─── STDERR ───
[2026-01-28 00:32:51] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:32:51] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:32:51] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:32:51] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:32:51] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:32:51] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:32:51] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:32:51] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:32:51] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:32:51] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:32:51] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:32:51] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:32:51] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:32:51] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:32:55] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:32:55] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:32:55] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:32:55] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:32:55] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:32:55] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:32:55] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:32:55] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:32:55] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:32:55] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:32:55] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:32:55] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:32:55] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:32:55] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3487211) [2026-01-28 00:32:56] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3487211) [2026-01-28 00:32:56] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3487211) [2026-01-28 00:32:56] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3487211) [2026-01-28 00:32:56] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=3487211) [2026-01-28 00:32:56] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=3487211) [2026-01-28 00:32:56] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=3487211) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3487211) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.58it/s]
(EngineCore_DP0 pid=3487211) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.58it/s]
(EngineCore_DP0 pid=3487211) 
(EngineCore_DP0 pid=3487211) [2026-01-28 00:32:56] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 4096] -> 1D uint8
(EngineCore_DP0 pid=3487211) [2026-01-28 00:32:56] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 11796480 bytes
(EngineCore_DP0 pid=3487211) [2026-01-28 00:32:56] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 4096] -> 1D uint8
(EngineCore_DP0 pid=3487211) [2026-01-28 00:32:56] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7864320 bytes
(EngineCore_DP0 pid=3487211) [2026-01-28 00:32:56] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 4096] -> 1D uint8
(EngineCore_DP0 pid=3487211) [2026-01-28 00:32:56] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 42467328 bytes
(EngineCore_DP0 pid=3487211) [2026-01-28 00:32:56] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 11072] -> 1D uint8
(EngineCore_DP0 pid=3487211) [2026-01-28 00:32:56] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 21299200 bytes
(EngineCore_DP0 pid=3487211) 2026-01-28 00:33:07,070 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3487211) 2026-01-28 00:33:07,087 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3487211) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  75%|███████▌  | 3/4 [00:00<00:00, 25.76it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 4/4 [00:00<00:00, 23.86it/s]
(EngineCore_DP0 pid=3487211) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/3 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  33%|███▎      | 1/3 [00:00<00:00,  7.39it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 3/3 [00:00<00:00, 14.33it/s]

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:  13%|█▎        | 69/512 [00:00<00:00, 688.49it/s]
Adding requests:  28%|██▊       | 143/512 [00:00<00:00, 714.19it/s]
Adding requests:  42%|████▏     | 216/512 [00:00<00:00, 720.40it/s]
Adding requests:  57%|█████▋    | 293/512 [00:00<00:00, 738.20it/s]
Adding requests:  72%|███████▏  | 367/512 [00:00<00:00, 738.61it/s]
Adding requests:  86%|████████▋ | 442/512 [00:00<00:00, 740.15it/s]
Adding requests: 100%|██████████| 512/512 [00:00<00:00, 734.79it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   7%|▋         | 34/512 [00:00<00:01, 262.04it/s, est. speed input: 268359.49 toks/s, output: 262.05 toks/s]
Processed prompts:  12%|█▏        | 61/512 [00:00<00:05, 86.38it/s, est. speed input: 99625.37 toks/s, output: 97.29 toks/s]   
Processed prompts:  15%|█▍        | 75/512 [00:00<00:06, 66.76it/s, est. speed input: 80190.67 toks/s, output: 78.31 toks/s]
Processed prompts:  17%|█▋        | 85/512 [00:01<00:06, 65.22it/s, est. speed input: 77483.84 toks/s, output: 75.67 toks/s]
Processed prompts:  18%|█▊        | 94/512 [00:01<00:07, 55.31it/s, est. speed input: 70156.29 toks/s, output: 68.51 toks/s]
Processed prompts:  20%|█▉        | 102/512 [00:01<00:07, 53.53it/s, est. speed input: 67896.37 toks/s, output: 66.30 toks/s]
Processed prompts:  21%|██▏       | 110/512 [00:01<00:07, 52.14it/s, est. speed input: 66085.98 toks/s, output: 64.54 toks/s]
Processed prompts:  23%|██▎       | 118/512 [00:01<00:07, 51.12it/s, est. speed input: 64620.27 toks/s, output: 63.11 toks/s]
Processed prompts:  25%|██▍       | 126/512 [00:02<00:07, 50.36it/s, est. speed input: 63394.86 toks/s, output: 61.91 toks/s]
Processed prompts:  26%|██▌       | 134/512 [00:02<00:07, 49.79it/s, est. speed input: 62353.96 toks/s, output: 60.89 toks/s]
Processed prompts:  28%|██▊       | 142/512 [00:02<00:07, 49.33it/s, est. speed input: 61441.24 toks/s, output: 60.00 toks/s]
Processed prompts:  29%|██▉       | 150/512 [00:02<00:07, 49.04it/s, est. speed input: 60661.72 toks/s, output: 59.24 toks/s]
Processed prompts:  31%|███       | 158/512 [00:02<00:07, 48.83it/s, est. speed input: 59975.25 toks/s, output: 58.57 toks/s]
Processed prompts:  32%|███▏      | 166/512 [00:02<00:07, 48.60it/s, est. speed input: 59349.47 toks/s, output: 57.96 toks/s]
Processed prompts:  34%|███▍      | 174/512 [00:03<00:06, 48.52it/s, est. speed input: 58810.36 toks/s, output: 57.43 toks/s]
Processed prompts:  36%|███▌      | 182/512 [00:03<00:06, 48.44it/s, est. speed input: 58322.58 toks/s, output: 56.96 toks/s]
Processed prompts:  37%|███▋      | 190/512 [00:03<00:06, 48.32it/s, est. speed input: 57870.20 toks/s, output: 56.51 toks/s]
Processed prompts:  39%|███▊      | 198/512 [00:03<00:06, 48.26it/s, est. speed input: 57464.77 toks/s, output: 56.12 toks/s]
Processed prompts:  40%|████      | 206/512 [00:03<00:06, 48.21it/s, est. speed input: 57095.72 toks/s, output: 55.76 toks/s]
Processed prompts:  42%|████▏     | 214/512 [00:03<00:06, 48.21it/s, est. speed input: 56763.86 toks/s, output: 55.43 toks/s]
Processed prompts:  43%|████▎     | 222/512 [00:04<00:06, 48.25it/s, est. speed input: 56464.61 toks/s, output: 55.14 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:04<00:05, 48.27it/s, est. speed input: 56188.21 toks/s, output: 54.87 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:04<00:05, 48.22it/s, est. speed input: 55924.81 toks/s, output: 54.61 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:04<00:05, 48.24it/s, est. speed input: 55686.77 toks/s, output: 54.38 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:04<00:05, 48.28it/s, est. speed input: 55470.29 toks/s, output: 54.17 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:04<00:05, 48.28it/s, est. speed input: 55263.86 toks/s, output: 53.97 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:05<00:05, 48.32it/s, est. speed input: 55076.33 toks/s, output: 53.79 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:05<00:04, 48.31it/s, est. speed input: 54897.23 toks/s, output: 53.61 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:05<00:04, 48.25it/s, est. speed input: 54722.01 toks/s, output: 53.44 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:05<00:04, 48.24it/s, est. speed input: 54561.33 toks/s, output: 53.28 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:05<00:04, 48.19it/s, est. speed input: 54405.47 toks/s, output: 53.13 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:05<00:04, 48.19it/s, est. speed input: 54261.34 toks/s, output: 52.99 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:06<00:04, 48.19it/s, est. speed input: 54125.70 toks/s, output: 52.86 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:06<00:03, 48.18it/s, est. speed input: 53996.62 toks/s, output: 52.73 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:06<00:03, 48.13it/s, est. speed input: 53869.54 toks/s, output: 52.61 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:06<00:03, 48.12it/s, est. speed input: 53751.47 toks/s, output: 52.49 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:06<00:03, 48.18it/s, est. speed input: 53645.41 toks/s, output: 52.39 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:06<00:03, 48.23it/s, est. speed input: 53545.46 toks/s, output: 52.29 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:07<00:03, 48.26it/s, est. speed input: 53450.07 toks/s, output: 52.20 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [00:07<00:02, 48.25it/s, est. speed input: 53356.39 toks/s, output: 52.11 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [00:07<00:02, 48.21it/s, est. speed input: 53263.47 toks/s, output: 52.02 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [00:07<00:02, 48.20it/s, est. speed input: 53176.51 toks/s, output: 51.93 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [00:07<00:02, 48.17it/s, est. speed input: 53091.34 toks/s, output: 51.85 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [00:07<00:02, 48.15it/s, est. speed input: 53010.39 toks/s, output: 51.77 toks/s]
Processed prompts:  81%|████████  | 414/512 [00:08<00:02, 48.19it/s, est. speed input: 52936.54 toks/s, output: 51.70 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [00:08<00:01, 48.24it/s, est. speed input: 52867.18 toks/s, output: 51.63 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [00:08<00:01, 48.19it/s, est. speed input: 52794.28 toks/s, output: 51.56 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [00:08<00:01, 48.24it/s, est. speed input: 52730.90 toks/s, output: 51.49 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [00:08<00:01, 48.26it/s, est. speed input: 52668.21 toks/s, output: 51.43 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [00:08<00:01, 48.26it/s, est. speed input: 52607.26 toks/s, output: 51.37 toks/s]
Processed prompts:  90%|█████████ | 462/512 [00:09<00:01, 48.23it/s, est. speed input: 52546.51 toks/s, output: 51.31 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [00:09<00:00, 48.25it/s, est. speed input: 52490.76 toks/s, output: 51.26 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [00:09<00:00, 48.20it/s, est. speed input: 52432.90 toks/s, output: 51.20 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [00:09<00:00, 48.15it/s, est. speed input: 52376.18 toks/s, output: 51.15 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [00:09<00:00, 48.18it/s, est. speed input: 52325.25 toks/s, output: 51.10 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [00:09<00:00, 48.15it/s, est. speed input: 52272.64 toks/s, output: 51.05 toks/s]
Processed prompts: 100%|█████████▉| 510/512 [00:09<00:00, 49.64it/s, est. speed input: 52310.55 toks/s, output: 51.08 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:09<00:00, 49.64it/s, est. speed input: 52515.16 toks/s, output: 51.28 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:09<00:00, 51.28it/s, est. speed input: 52515.16 toks/s, output: 51.28 toks/s]
[rank0]:[W128 00:33:19.043729385 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 33.9s

测试结果:
  Requests/s:   47.93
  Tokens/s:     49133.34
  Total Reqs:   512
  Elapsed:      10.68s

  [Prefill 分析]
  Total Prefill Tokens: 524288
  Prefill Tokens/s:     49085.40

============================================================
[5/7] 测试 M=8192
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-INT8                                  │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 8192
│   M_prefill     = 8192 (= 8 x 1024)
│   M_decode      = 8
│   batched_tokens = 8192 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 1024
│   --max-num-seqs           = 8
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 8192
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:33:27 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3487976) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3487976) WARNING 01-28 00:33:36 [backends.py:609] Failed to read file <frozen os>
Throughput: 45.46 requests/s, 46600.67 total tokens/s, 45.46 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024


─── STDERR ───
[2026-01-28 00:33:26] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:33:27] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:33:27] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:33:27] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:33:27] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:33:27] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:33:27] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:33:27] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:33:27] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:33:27] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:33:27] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:33:27] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:33:27] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:33:27] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:33:30] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:33:30] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:33:30] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:33:30] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:33:30] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:33:30] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:33:30] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:33:30] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:33:30] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:33:30] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:33:30] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:33:30] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:33:30] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:33:30] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3487976) [2026-01-28 00:33:31] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3487976) [2026-01-28 00:33:31] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3487976) [2026-01-28 00:33:31] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3487976) [2026-01-28 00:33:31] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=3487976) [2026-01-28 00:33:31] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=3487976) [2026-01-28 00:33:31] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=3487976) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3487976) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.51it/s]
(EngineCore_DP0 pid=3487976) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.51it/s]
(EngineCore_DP0 pid=3487976) 
(EngineCore_DP0 pid=3487976) [2026-01-28 00:33:31] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 4096] -> 1D uint8
(EngineCore_DP0 pid=3487976) [2026-01-28 00:33:31] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 11796480 bytes
(EngineCore_DP0 pid=3487976) [2026-01-28 00:33:31] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 4096] -> 1D uint8
(EngineCore_DP0 pid=3487976) [2026-01-28 00:33:31] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7864320 bytes
(EngineCore_DP0 pid=3487976) [2026-01-28 00:33:31] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 4096] -> 1D uint8
(EngineCore_DP0 pid=3487976) [2026-01-28 00:33:31] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 42467328 bytes
(EngineCore_DP0 pid=3487976) [2026-01-28 00:33:31] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 11072] -> 1D uint8
(EngineCore_DP0 pid=3487976) [2026-01-28 00:33:31] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 21299200 bytes
(EngineCore_DP0 pid=3487976) 2026-01-28 00:33:42,112 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3487976) 2026-01-28 00:33:42,137 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3487976) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  20%|██        | 1/5 [00:00<00:01,  3.53it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  80%|████████  | 4/5 [00:00<00:00, 12.01it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 5/5 [00:00<00:00, 11.25it/s]
(EngineCore_DP0 pid=3487976) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/4 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  25%|██▌       | 1/4 [00:00<00:00,  7.36it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00, 18.75it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 4/4 [00:00<00:00, 16.79it/s]

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   7%|▋         | 73/1024 [00:00<00:01, 724.25it/s]
Adding requests:  15%|█▍        | 149/1024 [00:00<00:01, 743.35it/s]
Adding requests:  22%|██▏       | 226/1024 [00:00<00:01, 751.57it/s]
Adding requests:  29%|██▉       | 302/1024 [00:00<00:00, 754.46it/s]
Adding requests:  37%|███▋      | 378/1024 [00:00<00:00, 752.46it/s]
Adding requests:  44%|████▍     | 454/1024 [00:00<00:00, 738.99it/s]
Adding requests:  52%|█████▏    | 528/1024 [00:00<00:00, 724.12it/s]
Adding requests:  59%|█████▉    | 604/1024 [00:00<00:00, 733.16it/s]
Adding requests:  67%|██████▋   | 683/1024 [00:00<00:00, 748.10it/s]
Adding requests:  74%|███████▍  | 758/1024 [00:01<00:00, 747.28it/s]
Adding requests:  81%|████████▏ | 833/1024 [00:01<00:00, 735.06it/s]
Adding requests:  89%|████████▉ | 910/1024 [00:01<00:00, 744.20it/s]
Adding requests:  96%|█████████▋| 986/1024 [00:01<00:00, 747.53it/s]
Adding requests: 100%|██████████| 1024/1024 [00:01<00:00, 744.31it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▌         | 58/1024 [00:00<00:01, 567.29it/s, est. speed input: 580991.18 toks/s, output: 567.32 toks/s]
Processed prompts:  11%|█         | 115/1024 [00:01<00:12, 75.31it/s, est. speed input: 88761.93 toks/s, output: 86.68 toks/s]  
Processed prompts:  14%|█▍        | 142/1024 [00:01<00:13, 66.54it/s, est. speed input: 78518.07 toks/s, output: 76.68 toks/s]
Processed prompts:  16%|█▌        | 159/1024 [00:02<00:13, 61.88it/s, est. speed input: 73934.41 toks/s, output: 72.20 toks/s]
Processed prompts:  17%|█▋        | 171/1024 [00:02<00:15, 54.44it/s, est. speed input: 68611.81 toks/s, output: 67.00 toks/s]
Processed prompts:  18%|█▊        | 180/1024 [00:02<00:15, 53.96it/s, est. speed input: 67594.49 toks/s, output: 66.01 toks/s]
Processed prompts:  18%|█▊        | 188/1024 [00:02<00:15, 52.40it/s, est. speed input: 66335.59 toks/s, output: 64.78 toks/s]
Processed prompts:  19%|█▉        | 195/1024 [00:03<00:16, 49.79it/s, est. speed input: 64896.39 toks/s, output: 63.38 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [00:03<00:17, 47.52it/s, est. speed input: 63606.94 toks/s, output: 62.12 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:03<00:17, 47.06it/s, est. speed input: 62745.90 toks/s, output: 61.28 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [00:03<00:17, 46.69it/s, est. speed input: 61967.99 toks/s, output: 60.52 toks/s]
Processed prompts:  22%|██▏       | 226/1024 [00:03<00:17, 46.42it/s, est. speed input: 61264.88 toks/s, output: 59.83 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:03<00:17, 46.23it/s, est. speed input: 60627.21 toks/s, output: 59.21 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:04<00:16, 46.06it/s, est. speed input: 60037.36 toks/s, output: 58.63 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:04<00:16, 45.94it/s, est. speed input: 59494.99 toks/s, output: 58.10 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:04<00:16, 45.87it/s, est. speed input: 58999.20 toks/s, output: 57.62 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:04<00:16, 45.82it/s, est. speed input: 58540.41 toks/s, output: 57.17 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:04<00:16, 45.79it/s, est. speed input: 58115.54 toks/s, output: 56.75 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:05<00:16, 45.77it/s, est. speed input: 57720.93 toks/s, output: 56.37 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:05<00:16, 45.75it/s, est. speed input: 57350.65 toks/s, output: 56.01 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:05<00:15, 45.74it/s, est. speed input: 57006.67 toks/s, output: 55.67 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:05<00:15, 45.74it/s, est. speed input: 56684.84 toks/s, output: 55.36 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:05<00:15, 45.70it/s, est. speed input: 56377.47 toks/s, output: 55.06 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:05<00:15, 45.68it/s, est. speed input: 56090.41 toks/s, output: 54.78 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:06<00:15, 45.68it/s, est. speed input: 55820.20 toks/s, output: 54.51 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:06<00:15, 45.66it/s, est. speed input: 55563.99 toks/s, output: 54.26 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:06<00:14, 45.66it/s, est. speed input: 55323.16 toks/s, output: 54.03 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:06<00:14, 45.69it/s, est. speed input: 55097.75 toks/s, output: 53.81 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:06<00:14, 45.67it/s, est. speed input: 54880.24 toks/s, output: 53.59 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:06<00:14, 45.67it/s, est. speed input: 54674.84 toks/s, output: 53.39 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:07<00:14, 45.65it/s, est. speed input: 54477.80 toks/s, output: 53.20 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:07<00:13, 45.67it/s, est. speed input: 54294.29 toks/s, output: 53.02 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [00:07<00:13, 45.70it/s, est. speed input: 54120.26 toks/s, output: 52.85 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:07<00:13, 45.67it/s, est. speed input: 53949.10 toks/s, output: 52.68 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:07<00:13, 45.68it/s, est. speed input: 53788.80 toks/s, output: 52.53 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:07<00:13, 45.68it/s, est. speed input: 53635.24 toks/s, output: 52.38 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:08<00:13, 45.65it/s, est. speed input: 53485.29 toks/s, output: 52.23 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:08<00:12, 45.68it/s, est. speed input: 53345.61 toks/s, output: 52.10 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:08<00:12, 45.68it/s, est. speed input: 53210.80 toks/s, output: 51.96 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:08<00:12, 45.67it/s, est. speed input: 53080.31 toks/s, output: 51.84 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:08<00:12, 45.67it/s, est. speed input: 52955.03 toks/s, output: 51.71 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:09<00:12, 45.65it/s, est. speed input: 52833.83 toks/s, output: 51.60 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:09<00:12, 45.64it/s, est. speed input: 52717.01 toks/s, output: 51.48 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:09<00:11, 45.63it/s, est. speed input: 52604.43 toks/s, output: 51.37 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:09<00:11, 45.64it/s, est. speed input: 52497.70 toks/s, output: 51.27 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:09<00:11, 45.66it/s, est. speed input: 52395.37 toks/s, output: 51.17 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:09<00:11, 45.64it/s, est. speed input: 52293.84 toks/s, output: 51.07 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:10<00:11, 45.62it/s, est. speed input: 52196.07 toks/s, output: 50.97 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:10<00:11, 45.62it/s, est. speed input: 52102.62 toks/s, output: 50.88 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:10<00:10, 45.67it/s, est. speed input: 52014.96 toks/s, output: 50.80 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:10<00:10, 45.68it/s, est. speed input: 51929.27 toks/s, output: 50.71 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:10<00:10, 45.70it/s, est. speed input: 51846.73 toks/s, output: 50.63 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:10<00:10, 45.69it/s, est. speed input: 51765.32 toks/s, output: 50.55 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:11<00:10, 45.64it/s, est. speed input: 51684.02 toks/s, output: 50.47 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:11<00:09, 45.64it/s, est. speed input: 51607.55 toks/s, output: 50.40 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:11<00:09, 45.66it/s, est. speed input: 51534.36 toks/s, output: 50.33 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:11<00:09, 45.68it/s, est. speed input: 51463.61 toks/s, output: 50.26 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:11<00:09, 45.66it/s, est. speed input: 51392.96 toks/s, output: 50.19 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:12<00:09, 45.65it/s, est. speed input: 51325.15 toks/s, output: 50.12 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:12<00:09, 45.63it/s, est. speed input: 51258.04 toks/s, output: 50.06 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:12<00:08, 45.62it/s, est. speed input: 51193.21 toks/s, output: 49.99 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:12<00:08, 45.63it/s, est. speed input: 51131.16 toks/s, output: 49.93 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:12<00:08, 45.65it/s, est. speed input: 51071.19 toks/s, output: 49.87 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:12<00:08, 45.66it/s, est. speed input: 51013.23 toks/s, output: 49.82 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:13<00:08, 45.65it/s, est. speed input: 50955.65 toks/s, output: 49.76 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:13<00:08, 45.64it/s, est. speed input: 50899.21 toks/s, output: 49.71 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:13<00:07, 45.62it/s, est. speed input: 50843.87 toks/s, output: 49.65 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:13<00:07, 45.63it/s, est. speed input: 50790.87 toks/s, output: 49.60 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:13<00:07, 45.62it/s, est. speed input: 50738.99 toks/s, output: 49.55 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:13<00:07, 45.61it/s, est. speed input: 50687.89 toks/s, output: 49.50 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:14<00:07, 45.58it/s, est. speed input: 50636.75 toks/s, output: 49.45 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:14<00:06, 45.60it/s, est. speed input: 50589.25 toks/s, output: 49.40 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:14<00:06, 45.59it/s, est. speed input: 50541.35 toks/s, output: 49.36 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:14<00:06, 45.60it/s, est. speed input: 50495.67 toks/s, output: 49.31 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:14<00:06, 45.62it/s, est. speed input: 50451.35 toks/s, output: 49.27 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:14<00:06, 45.61it/s, est. speed input: 50407.48 toks/s, output: 49.23 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:15<00:06, 45.59it/s, est. speed input: 50363.79 toks/s, output: 49.18 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:15<00:05, 45.60it/s, est. speed input: 50322.08 toks/s, output: 49.14 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:15<00:05, 45.61it/s, est. speed input: 50281.46 toks/s, output: 49.10 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:15<00:05, 45.60it/s, est. speed input: 50241.07 toks/s, output: 49.06 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:15<00:05, 45.62it/s, est. speed input: 50202.58 toks/s, output: 49.03 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:16<00:05, 45.60it/s, est. speed input: 50163.66 toks/s, output: 48.99 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:16<00:05, 45.56it/s, est. speed input: 50124.50 toks/s, output: 48.95 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:16<00:04, 45.58it/s, est. speed input: 50088.25 toks/s, output: 48.91 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:16<00:04, 45.58it/s, est. speed input: 50052.00 toks/s, output: 48.88 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:16<00:04, 45.58it/s, est. speed input: 50016.58 toks/s, output: 48.84 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:16<00:04, 45.61it/s, est. speed input: 49983.21 toks/s, output: 48.81 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:17<00:04, 45.58it/s, est. speed input: 49948.22 toks/s, output: 48.78 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [00:17<00:03, 45.57it/s, est. speed input: 49914.81 toks/s, output: 48.74 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [00:17<00:03, 45.59it/s, est. speed input: 49882.86 toks/s, output: 48.71 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:17<00:03, 45.63it/s, est. speed input: 49852.25 toks/s, output: 48.68 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [00:17<00:03, 45.60it/s, est. speed input: 49820.43 toks/s, output: 48.65 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [00:17<00:03, 45.60it/s, est. speed input: 49790.06 toks/s, output: 48.62 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [00:18<00:03, 45.56it/s, est. speed input: 49758.77 toks/s, output: 48.59 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [00:18<00:02, 45.56it/s, est. speed input: 49728.82 toks/s, output: 48.56 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [00:18<00:02, 45.57it/s, est. speed input: 49700.00 toks/s, output: 48.54 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [00:18<00:02, 45.59it/s, est. speed input: 49672.10 toks/s, output: 48.51 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [00:18<00:02, 45.61it/s, est. speed input: 49644.96 toks/s, output: 48.48 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [00:19<00:02, 45.60it/s, est. speed input: 49617.66 toks/s, output: 48.45 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [00:19<00:02, 45.55it/s, est. speed input: 49589.25 toks/s, output: 48.43 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [00:19<00:01, 45.60it/s, est. speed input: 49564.25 toks/s, output: 48.40 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [00:19<00:01, 45.60it/s, est. speed input: 49538.33 toks/s, output: 48.38 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [00:19<00:01, 45.60it/s, est. speed input: 49513.12 toks/s, output: 48.35 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [00:19<00:01, 45.61it/s, est. speed input: 49488.54 toks/s, output: 48.33 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [00:20<00:01, 45.58it/s, est. speed input: 49463.18 toks/s, output: 48.30 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [00:20<00:01, 45.54it/s, est. speed input: 49438.01 toks/s, output: 48.28 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [00:20<00:00, 45.57it/s, est. speed input: 49414.74 toks/s, output: 48.26 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [00:20<00:00, 45.61it/s, est. speed input: 49392.55 toks/s, output: 48.23 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [00:20<00:00, 45.61it/s, est. speed input: 49369.93 toks/s, output: 48.21 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [00:20<00:00, 45.61it/s, est. speed input: 49347.47 toks/s, output: 48.19 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [00:21<00:00, 44.63it/s, est. speed input: 49295.79 toks/s, output: 48.14 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:21<00:00, 44.63it/s, est. speed input: 49586.05 toks/s, output: 48.42 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:21<00:00, 48.42it/s, est. speed input: 49586.05 toks/s, output: 48.42 toks/s]
[rank0]:[W128 00:34:06.385366272 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 47.4s

测试结果:
  Requests/s:   45.46
  Tokens/s:     46600.67
  Total Reqs:   1024
  Elapsed:      22.52s

  [Prefill 分析]
  Total Prefill Tokens: 1048576
  Prefill Tokens/s:     46555.20

============================================================
[6/7] 测试 M=16384
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-INT8                                  │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 16384
│   M_prefill     = 16384 (= 16 x 1024)
│   M_decode      = 16
│   batched_tokens = 16384 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 2048
│   --max-num-seqs           = 16
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 16384
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:34:17 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3488953) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3488953) WARNING 01-28 00:34:26 [backends.py:609] Failed to read file <frozen os>
Throughput: 44.61 requests/s, 45725.09 total tokens/s, 44.61 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048


─── STDERR ───
[2026-01-28 00:34:17] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:34:17] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:34:17] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:34:17] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:34:17] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:34:17] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:34:17] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:34:17] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:34:17] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:34:17] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:34:17] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:34:17] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:34:17] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:34:17] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:34:21] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:34:21] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:34:21] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:34:21] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:34:21] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:34:21] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:34:21] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:34:21] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:34:21] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:34:21] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:34:21] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:34:21] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:34:21] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:34:21] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3488953) [2026-01-28 00:34:22] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3488953) [2026-01-28 00:34:22] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3488953) [2026-01-28 00:34:22] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3488953) [2026-01-28 00:34:22] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=3488953) [2026-01-28 00:34:22] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=3488953) [2026-01-28 00:34:22] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=3488953) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3488953) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.54it/s]
(EngineCore_DP0 pid=3488953) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.54it/s]
(EngineCore_DP0 pid=3488953) 
(EngineCore_DP0 pid=3488953) [2026-01-28 00:34:22] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 4096] -> 1D uint8
(EngineCore_DP0 pid=3488953) [2026-01-28 00:34:22] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 11796480 bytes
(EngineCore_DP0 pid=3488953) [2026-01-28 00:34:22] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 4096] -> 1D uint8
(EngineCore_DP0 pid=3488953) [2026-01-28 00:34:22] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7864320 bytes
(EngineCore_DP0 pid=3488953) [2026-01-28 00:34:22] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 4096] -> 1D uint8
(EngineCore_DP0 pid=3488953) [2026-01-28 00:34:22] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 42467328 bytes
(EngineCore_DP0 pid=3488953) [2026-01-28 00:34:22] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 11072] -> 1D uint8
(EngineCore_DP0 pid=3488953) [2026-01-28 00:34:22] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 21299200 bytes
(EngineCore_DP0 pid=3488953) 2026-01-28 00:34:32,763 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3488953) 2026-01-28 00:34:32,780 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3488953) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  14%|█▍        | 1/7 [00:00<00:00,  6.19it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  43%|████▎     | 3/7 [00:00<00:00, 11.02it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  71%|███████▏  | 5/7 [00:00<00:00, 13.05it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00, 14.62it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 7/7 [00:00<00:00, 13.09it/s]
(EngineCore_DP0 pid=3488953) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/5 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  20%|██        | 1/5 [00:00<00:00,  7.09it/s]
Capturing CUDA graphs (decode, FULL):  80%|████████  | 4/5 [00:00<00:00, 18.54it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 5/5 [00:00<00:00, 18.16it/s]

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   4%|▎         | 73/2048 [00:00<00:02, 727.68it/s]
Adding requests:   7%|▋         | 149/2048 [00:00<00:02, 744.29it/s]
Adding requests:  11%|█         | 226/2048 [00:00<00:02, 753.98it/s]
Adding requests:  15%|█▍        | 303/2048 [00:00<00:02, 756.78it/s]
Adding requests:  19%|█▊        | 379/2048 [00:00<00:02, 750.56it/s]
Adding requests:  22%|██▏       | 455/2048 [00:00<00:02, 749.22it/s]
Adding requests:  26%|██▌       | 530/2048 [00:00<00:02, 727.86it/s]
Adding requests:  30%|██▉       | 607/2048 [00:00<00:01, 739.87it/s]
Adding requests:  33%|███▎      | 686/2048 [00:00<00:01, 754.25it/s]
Adding requests:  37%|███▋      | 762/2048 [00:01<00:01, 750.88it/s]
Adding requests:  41%|████      | 838/2048 [00:01<00:01, 737.09it/s]
Adding requests:  45%|████▍     | 917/2048 [00:01<00:01, 750.57it/s]
Adding requests:  49%|████▊     | 995/2048 [00:01<00:01, 756.79it/s]
Adding requests:  52%|█████▏    | 1071/2048 [00:01<00:01, 749.95it/s]
Adding requests:  56%|█████▌    | 1147/2048 [00:01<00:01, 750.70it/s]
Adding requests:  60%|█████▉    | 1227/2048 [00:01<00:01, 763.83it/s]
Adding requests:  64%|██████▎   | 1304/2048 [00:01<00:00, 755.14it/s]
Adding requests:  67%|██████▋   | 1381/2048 [00:01<00:00, 758.59it/s]
Adding requests:  71%|███████   | 1457/2048 [00:01<00:00, 754.00it/s]
Adding requests:  75%|███████▌  | 1536/2048 [00:02<00:00, 761.77it/s]
Adding requests:  79%|███████▉  | 1615/2048 [00:02<00:00, 767.54it/s]
Adding requests:  83%|████████▎ | 1692/2048 [00:02<00:00, 764.60it/s]
Adding requests:  86%|████████▋ | 1769/2048 [00:02<00:00, 762.58it/s]
Adding requests:  90%|█████████ | 1847/2048 [00:02<00:00, 766.71it/s]
Adding requests:  94%|█████████▍| 1924/2048 [00:02<00:00, 750.24it/s]
Adding requests:  98%|█████████▊| 2000/2048 [00:02<00:00, 745.92it/s]
Adding requests: 100%|██████████| 2048/2048 [00:02<00:00, 752.37it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▌         | 114/2048 [00:00<00:03, 518.39it/s, est. speed input: 530873.55 toks/s, output: 518.41 toks/s]
Processed prompts:   8%|▊         | 166/2048 [00:01<00:17, 107.46it/s, est. speed input: 131522.31 toks/s, output: 128.44 toks/s]
Processed prompts:   9%|▉         | 191/2048 [00:01<00:19, 96.41it/s, est. speed input: 118526.62 toks/s, output: 115.75 toks/s] 
Processed prompts:  10%|█         | 208/2048 [00:02<00:22, 81.96it/s, est. speed input: 106084.93 toks/s, output: 103.60 toks/s]
Processed prompts:  11%|█         | 220/2048 [00:02<00:27, 67.57it/s, est. speed input: 95237.59 toks/s, output: 93.01 toks/s]  
Processed prompts:  11%|█         | 229/2048 [00:02<00:33, 54.94it/s, est. speed input: 86114.72 toks/s, output: 84.10 toks/s]
Processed prompts:  12%|█▏        | 242/2048 [00:03<00:36, 49.41it/s, est. speed input: 80453.12 toks/s, output: 78.57 toks/s]
Processed prompts:  13%|█▎        | 258/2048 [00:03<00:37, 48.01it/s, est. speed input: 76844.78 toks/s, output: 75.04 toks/s]
Processed prompts:  13%|█▎        | 274/2048 [00:03<00:37, 47.05it/s, est. speed input: 73929.71 toks/s, output: 72.20 toks/s]
Processed prompts:  14%|█▍        | 290/2048 [00:04<00:37, 46.35it/s, est. speed input: 71504.02 toks/s, output: 69.83 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [00:04<00:37, 45.86it/s, est. speed input: 69464.66 toks/s, output: 67.84 toks/s]
Processed prompts:  16%|█▌        | 322/2048 [00:04<00:38, 45.41it/s, est. speed input: 67687.78 toks/s, output: 66.10 toks/s]
Processed prompts:  17%|█▋        | 338/2048 [00:05<00:37, 45.20it/s, est. speed input: 66187.09 toks/s, output: 64.64 toks/s]
Processed prompts:  17%|█▋        | 354/2048 [00:05<00:37, 45.06it/s, est. speed input: 64883.28 toks/s, output: 63.36 toks/s]
Processed prompts:  18%|█▊        | 370/2048 [00:05<00:37, 44.95it/s, est. speed input: 63732.10 toks/s, output: 62.24 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [00:06<00:37, 44.88it/s, est. speed input: 62713.48 toks/s, output: 61.24 toks/s]
Processed prompts:  20%|█▉        | 402/2048 [00:06<00:36, 44.83it/s, est. speed input: 61803.38 toks/s, output: 60.35 toks/s]
Processed prompts:  20%|██        | 418/2048 [00:07<00:36, 44.80it/s, est. speed input: 60987.71 toks/s, output: 59.56 toks/s]
Processed prompts:  21%|██        | 434/2048 [00:07<00:36, 44.76it/s, est. speed input: 60247.02 toks/s, output: 58.83 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [00:07<00:35, 44.74it/s, est. speed input: 59577.35 toks/s, output: 58.18 toks/s]
Processed prompts:  23%|██▎       | 466/2048 [00:08<00:35, 44.73it/s, est. speed input: 58966.20 toks/s, output: 57.58 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [00:08<00:35, 44.70it/s, est. speed input: 58404.40 toks/s, output: 57.04 toks/s]
Processed prompts:  24%|██▍       | 498/2048 [00:08<00:34, 44.69it/s, est. speed input: 57889.83 toks/s, output: 56.53 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [00:09<00:34, 44.69it/s, est. speed input: 57416.19 toks/s, output: 56.07 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [00:09<00:33, 44.70it/s, est. speed input: 56979.58 toks/s, output: 55.64 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [00:09<00:33, 44.71it/s, est. speed input: 56575.02 toks/s, output: 55.25 toks/s]
Processed prompts:  27%|██▋       | 562/2048 [00:10<00:33, 44.71it/s, est. speed input: 56197.31 toks/s, output: 54.88 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [00:10<00:32, 44.70it/s, est. speed input: 55844.43 toks/s, output: 54.54 toks/s]
Processed prompts:  29%|██▉       | 594/2048 [00:10<00:32, 44.69it/s, est. speed input: 55513.64 toks/s, output: 54.21 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [00:11<00:32, 44.67it/s, est. speed input: 55202.37 toks/s, output: 53.91 toks/s]
Processed prompts:  31%|███       | 626/2048 [00:11<00:31, 44.68it/s, est. speed input: 54913.19 toks/s, output: 53.63 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [00:12<00:31, 44.68it/s, est. speed input: 54640.93 toks/s, output: 53.36 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [00:12<00:31, 44.67it/s, est. speed input: 54382.97 toks/s, output: 53.11 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [00:12<00:30, 44.67it/s, est. speed input: 54139.57 toks/s, output: 52.87 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [00:13<00:30, 44.66it/s, est. speed input: 53909.51 toks/s, output: 52.65 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [00:13<00:30, 44.67it/s, est. speed input: 53692.53 toks/s, output: 52.43 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [00:13<00:29, 44.67it/s, est. speed input: 53487.13 toks/s, output: 52.23 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [00:14<00:29, 44.66it/s, est. speed input: 53290.01 toks/s, output: 52.04 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [00:14<00:28, 44.66it/s, est. speed input: 53103.72 toks/s, output: 51.86 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [00:14<00:28, 44.64it/s, est. speed input: 52925.08 toks/s, output: 51.68 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [00:15<00:28, 44.64it/s, est. speed input: 52755.59 toks/s, output: 51.52 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [00:15<00:27, 44.64it/s, est. speed input: 52594.03 toks/s, output: 51.36 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [00:15<00:27, 44.65it/s, est. speed input: 52440.50 toks/s, output: 51.21 toks/s]
Processed prompts:  41%|████      | 834/2048 [00:16<00:27, 44.64it/s, est. speed input: 52291.92 toks/s, output: 51.07 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [00:16<00:26, 44.64it/s, est. speed input: 52150.93 toks/s, output: 50.93 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [00:17<00:26, 44.64it/s, est. speed input: 52015.22 toks/s, output: 50.80 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [00:17<00:26, 44.62it/s, est. speed input: 51884.20 toks/s, output: 50.67 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [00:17<00:25, 44.64it/s, est. speed input: 51760.56 toks/s, output: 50.55 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [00:18<00:25, 44.63it/s, est. speed input: 51639.91 toks/s, output: 50.43 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [00:18<00:25, 44.63it/s, est. speed input: 51524.78 toks/s, output: 50.32 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [00:18<00:24, 44.64it/s, est. speed input: 51414.45 toks/s, output: 50.21 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [00:19<00:24, 44.61it/s, est. speed input: 51306.39 toks/s, output: 50.10 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [00:19<00:23, 44.63it/s, est. speed input: 51204.47 toks/s, output: 50.00 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [00:19<00:23, 44.63it/s, est. speed input: 51105.32 toks/s, output: 49.91 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [00:20<00:23, 44.62it/s, est. speed input: 51009.10 toks/s, output: 49.81 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [00:20<00:22, 44.62it/s, est. speed input: 50917.00 toks/s, output: 49.72 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [00:20<00:22, 44.62it/s, est. speed input: 50827.41 toks/s, output: 49.64 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [00:21<00:22, 44.61it/s, est. speed input: 50740.68 toks/s, output: 49.55 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [00:21<00:21, 44.62it/s, est. speed input: 50657.39 toks/s, output: 49.47 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [00:22<00:21, 44.62it/s, est. speed input: 50577.15 toks/s, output: 49.39 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [00:22<00:21, 44.60it/s, est. speed input: 50497.69 toks/s, output: 49.31 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [00:22<00:20, 44.60it/s, est. speed input: 50421.69 toks/s, output: 49.24 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [00:23<00:20, 44.56it/s, est. speed input: 50345.86 toks/s, output: 49.17 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [00:23<00:19, 45.31it/s, est. speed input: 50316.09 toks/s, output: 49.14 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [00:23<00:19, 45.11it/s, est. speed input: 50246.80 toks/s, output: 49.07 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [00:24<00:19, 44.95it/s, est. speed input: 50178.71 toks/s, output: 49.00 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [00:24<00:18, 44.85it/s, est. speed input: 50113.35 toks/s, output: 48.94 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [00:24<00:18, 44.77it/s, est. speed input: 50049.29 toks/s, output: 48.88 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [00:25<00:18, 44.71it/s, est. speed input: 49986.45 toks/s, output: 48.81 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [00:25<00:17, 44.69it/s, est. speed input: 49926.72 toks/s, output: 48.76 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [00:25<00:17, 44.65it/s, est. speed input: 49867.27 toks/s, output: 48.70 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [00:26<00:17, 44.63it/s, est. speed input: 49809.75 toks/s, output: 48.64 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [00:26<00:16, 44.62it/s, est. speed input: 49754.11 toks/s, output: 48.59 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [00:27<00:16, 44.61it/s, est. speed input: 49699.96 toks/s, output: 48.54 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [00:27<00:16, 44.59it/s, est. speed input: 49646.52 toks/s, output: 48.48 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [00:27<00:15, 44.61it/s, est. speed input: 49595.70 toks/s, output: 48.43 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [00:28<00:15, 44.60it/s, est. speed input: 49545.66 toks/s, output: 48.38 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [00:28<00:15, 44.60it/s, est. speed input: 49496.86 toks/s, output: 48.34 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [00:28<00:14, 44.61it/s, est. speed input: 49449.63 toks/s, output: 48.29 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [00:29<00:14, 44.60it/s, est. speed input: 49403.02 toks/s, output: 48.25 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [00:29<00:13, 44.60it/s, est. speed input: 49357.84 toks/s, output: 48.20 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [00:29<00:13, 44.60it/s, est. speed input: 49313.45 toks/s, output: 48.16 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [00:30<00:13, 44.58it/s, est. speed input: 49269.58 toks/s, output: 48.11 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [00:30<00:12, 44.58it/s, est. speed input: 49227.38 toks/s, output: 48.07 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [00:31<00:12, 44.59it/s, est. speed input: 49186.20 toks/s, output: 48.03 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [00:31<00:12, 44.58it/s, est. speed input: 49145.42 toks/s, output: 47.99 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [00:31<00:11, 44.58it/s, est. speed input: 49105.75 toks/s, output: 47.95 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [00:32<00:11, 44.57it/s, est. speed input: 49066.88 toks/s, output: 47.92 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [00:32<00:11, 44.58it/s, est. speed input: 49029.19 toks/s, output: 47.88 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [00:32<00:10, 44.58it/s, est. speed input: 48992.48 toks/s, output: 47.84 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [00:33<00:10, 44.58it/s, est. speed input: 48956.32 toks/s, output: 47.81 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [00:33<00:10, 44.58it/s, est. speed input: 48920.82 toks/s, output: 47.77 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [00:33<00:09, 44.59it/s, est. speed input: 48886.41 toks/s, output: 47.74 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [00:34<00:09, 44.58it/s, est. speed input: 48852.33 toks/s, output: 47.71 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [00:34<00:08, 44.58it/s, est. speed input: 48819.11 toks/s, output: 47.67 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [00:34<00:08, 44.57it/s, est. speed input: 48786.34 toks/s, output: 47.64 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [00:35<00:08, 44.55it/s, est. speed input: 48753.41 toks/s, output: 47.61 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [00:35<00:07, 44.55it/s, est. speed input: 48722.00 toks/s, output: 47.58 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [00:36<00:07, 44.57it/s, est. speed input: 48691.72 toks/s, output: 47.55 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [00:36<00:07, 44.57it/s, est. speed input: 48661.78 toks/s, output: 47.52 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [00:36<00:06, 44.58it/s, est. speed input: 48632.44 toks/s, output: 47.49 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [00:37<00:06, 44.56it/s, est. speed input: 48602.85 toks/s, output: 47.46 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [00:37<00:06, 44.55it/s, est. speed input: 48574.23 toks/s, output: 47.44 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [00:37<00:05, 44.56it/s, est. speed input: 48546.57 toks/s, output: 47.41 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [00:38<00:05, 44.55it/s, est. speed input: 48518.73 toks/s, output: 47.38 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [00:38<00:04, 44.57it/s, est. speed input: 48492.31 toks/s, output: 47.36 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [00:38<00:04, 44.57it/s, est. speed input: 48466.02 toks/s, output: 47.33 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [00:39<00:04, 44.56it/s, est. speed input: 48439.95 toks/s, output: 47.30 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [00:39<00:03, 45.37it/s, est. speed input: 48440.45 toks/s, output: 47.31 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [00:39<00:03, 45.11it/s, est. speed input: 48414.88 toks/s, output: 47.28 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [00:40<00:03, 44.94it/s, est. speed input: 48389.83 toks/s, output: 47.26 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [00:40<00:02, 44.83it/s, est. speed input: 48365.57 toks/s, output: 47.23 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [00:41<00:02, 44.74it/s, est. speed input: 48341.54 toks/s, output: 47.21 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [00:41<00:02, 44.68it/s, est. speed input: 48317.72 toks/s, output: 47.19 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [00:41<00:01, 44.64it/s, est. speed input: 48294.66 toks/s, output: 47.16 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [00:42<00:01, 44.60it/s, est. speed input: 48271.29 toks/s, output: 47.14 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [00:42<00:01, 44.59it/s, est. speed input: 48249.06 toks/s, output: 47.12 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [00:42<00:00, 44.58it/s, est. speed input: 48227.20 toks/s, output: 47.10 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [00:43<00:00, 45.37it/s, est. speed input: 48229.04 toks/s, output: 47.10 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:43<00:00, 45.37it/s, est. speed input: 48560.79 toks/s, output: 47.42 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [00:43<00:00, 47.42it/s, est. speed input: 48560.79 toks/s, output: 47.42 toks/s]
[rank0]:[W128 00:35:20.412242238 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 74.0s

测试结果:
  Requests/s:   44.61
  Tokens/s:     45725.09
  Total Reqs:   2048
  Elapsed:      45.91s

  [Prefill 分析]
  Total Prefill Tokens: 2097152
  Prefill Tokens/s:     45680.48

============================================================
[7/7] 测试 M=32768
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-INT8                                  │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 32768
│   M_prefill     = 32768 (= 32 x 1024)
│   M_decode      = 32
│   batched_tokens = 32768 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 4096
│   --max-num-seqs           = 32
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 32768
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 00:35:37 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=3490316) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3490316) WARNING 01-28 00:35:46 [backends.py:609] Failed to read file <frozen os>
Throughput: 44.60 requests/s, 45717.12 total tokens/s, 44.60 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096


─── STDERR ───
[2026-01-28 00:35:37] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:35:37] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:35:37] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:35:37] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:35:37] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:35:37] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:35:37] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:35:37] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:35:37] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:35:37] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:35:37] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:35:37] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:35:37] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:35:37] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 00:35:41] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-28 00:35:41] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-INT8'
[2026-01-28 00:35:41] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-INT8
[2026-01-28 00:35:41] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:35:41] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:35:41] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:35:41] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:35:41] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-INT8
[2026-01-28 00:35:41] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-INT8'
[2026-01-28 00:35:41] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 00:35:41] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 00:35:41] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 00:35:41] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 00:35:41] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3490316) [2026-01-28 00:35:41] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3490316) [2026-01-28 00:35:41] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=3490316) [2026-01-28 00:35:41] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3490316) [2026-01-28 00:35:41] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=3490316) [2026-01-28 00:35:41] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: BitNet-2B-INT8
(EngineCore_DP0 pid=3490316) [2026-01-28 00:35:41] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=3490316) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3490316) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.51it/s]
(EngineCore_DP0 pid=3490316) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  2.51it/s]
(EngineCore_DP0 pid=3490316) 
(EngineCore_DP0 pid=3490316) [2026-01-28 00:35:42] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3840, 4096] -> 1D uint8
(EngineCore_DP0 pid=3490316) [2026-01-28 00:35:42] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 11796480 bytes
(EngineCore_DP0 pid=3490316) [2026-01-28 00:35:42] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 4096] -> 1D uint8
(EngineCore_DP0 pid=3490316) [2026-01-28 00:35:42] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 7864320 bytes
(EngineCore_DP0 pid=3490316) [2026-01-28 00:35:42] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [13824, 4096] -> 1D uint8
(EngineCore_DP0 pid=3490316) [2026-01-28 00:35:42] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 42467328 bytes
(EngineCore_DP0 pid=3490316) [2026-01-28 00:35:42] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2560, 11072] -> 1D uint8
(EngineCore_DP0 pid=3490316) [2026-01-28 00:35:42] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 21299200 bytes
(EngineCore_DP0 pid=3490316) [rank0]:W0128 00:35:49.740000 3490316 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=3490316) [rank0]:W0128 00:35:49.788000 3490316 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=3490316) [rank0]:W0128 00:35:50.441000 3490316 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=3490316) [rank0]:W0128 00:35:50.516000 3490316 torch/_inductor/codegen/triton_combo_kernel.py:110] ComboKernels: 1 large pointwise nodes are separated
(EngineCore_DP0 pid=3490316) 2026-01-28 00:35:52,801 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3490316) 2026-01-28 00:35:52,818 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=3490316) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   9%|▉         | 1/11 [00:00<00:04,  2.21it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  36%|███▋      | 4/11 [00:00<00:00,  8.53it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  64%|██████▎   | 7/11 [00:00<00:00, 13.12it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  91%|█████████ | 10/11 [00:00<00:00, 16.03it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 11/11 [00:00<00:00, 12.54it/s]
(EngineCore_DP0 pid=3490316) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/7 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):  14%|█▍        | 1/7 [00:00<00:00,  6.46it/s]
Capturing CUDA graphs (decode, FULL):  57%|█████▋    | 4/7 [00:00<00:00, 15.75it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00, 18.54it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 7/7 [00:00<00:00, 16.73it/s]

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 71/4096 [00:00<00:05, 707.38it/s]
Adding requests:   4%|▎         | 147/4096 [00:00<00:05, 735.02it/s]
Adding requests:   5%|▌         | 222/4096 [00:00<00:05, 741.56it/s]
Adding requests:   7%|▋         | 299/4096 [00:00<00:05, 748.93it/s]
Adding requests:   9%|▉         | 375/4096 [00:00<00:04, 752.22it/s]
Adding requests:  11%|█         | 451/4096 [00:00<00:04, 754.44it/s]
Adding requests:  13%|█▎        | 527/4096 [00:00<00:04, 737.10it/s]
Adding requests:  15%|█▍        | 603/4096 [00:00<00:04, 742.74it/s]
Adding requests:  17%|█▋        | 683/4096 [00:00<00:04, 758.65it/s]
Adding requests:  19%|█▊        | 760/4096 [00:01<00:04, 761.56it/s]
Adding requests:  20%|██        | 837/4096 [00:01<00:04, 745.38it/s]
Adding requests:  22%|██▏       | 916/4096 [00:01<00:04, 758.10it/s]
Adding requests:  24%|██▍       | 992/4096 [00:01<00:04, 758.34it/s]
Adding requests:  26%|██▌       | 1068/4096 [00:01<00:04, 746.23it/s]
Adding requests:  28%|██▊       | 1143/4096 [00:01<00:03, 740.96it/s]
Adding requests:  30%|██▉       | 1222/4096 [00:01<00:03, 753.25it/s]
Adding requests:  32%|███▏      | 1298/4096 [00:01<00:03, 750.35it/s]
Adding requests:  34%|███▎      | 1374/4096 [00:01<00:03, 743.97it/s]
Adding requests:  35%|███▌      | 1449/4096 [00:01<00:03, 739.36it/s]
Adding requests:  37%|███▋      | 1526/4096 [00:02<00:03, 747.71it/s]
Adding requests:  39%|███▉      | 1603/4096 [00:02<00:03, 751.61it/s]
Adding requests:  41%|████      | 1679/4096 [00:02<00:03, 743.46it/s]
Adding requests:  43%|████▎     | 1754/4096 [00:02<00:03, 743.54it/s]
Adding requests:  45%|████▍     | 1829/4096 [00:02<00:03, 739.02it/s]
Adding requests:  46%|████▋     | 1904/4096 [00:02<00:02, 741.30it/s]
Adding requests:  48%|████▊     | 1980/4096 [00:02<00:02, 746.18it/s]
Adding requests:  50%|█████     | 2056/4096 [00:02<00:02, 748.84it/s]
Adding requests:  52%|█████▏    | 2131/4096 [00:02<00:02, 745.75it/s]
Adding requests:  54%|█████▍    | 2206/4096 [00:02<00:02, 723.96it/s]
Adding requests:  56%|█████▌    | 2283/4096 [00:03<00:02, 736.37it/s]
Adding requests:  58%|█████▊    | 2360/4096 [00:03<00:02, 745.10it/s]
Adding requests:  59%|█████▉    | 2437/4096 [00:03<00:02, 751.01it/s]
Adding requests:  61%|██████▏   | 2513/4096 [00:03<00:02, 752.01it/s]
Adding requests:  63%|██████▎   | 2589/4096 [00:03<00:02, 752.51it/s]
Adding requests:  65%|██████▌   | 2666/4096 [00:03<00:01, 757.22it/s]
Adding requests:  67%|██████▋   | 2742/4096 [00:03<00:01, 755.82it/s]
Adding requests:  69%|██████▉   | 2818/4096 [00:03<00:01, 755.49it/s]
Adding requests:  71%|███████   | 2895/4096 [00:03<00:01, 759.01it/s]
Adding requests:  73%|███████▎  | 2971/4096 [00:03<00:01, 744.70it/s]
Adding requests:  74%|███████▍  | 3046/4096 [00:04<00:01, 744.00it/s]
Adding requests:  76%|███████▌  | 3123/4096 [00:04<00:01, 748.41it/s]
Adding requests:  78%|███████▊  | 3198/4096 [00:04<00:01, 742.79it/s]
Adding requests:  80%|███████▉  | 3275/4096 [00:04<00:01, 747.95it/s]
Adding requests:  82%|████████▏ | 3352/4096 [00:04<00:00, 752.47it/s]
Adding requests:  84%|████████▎ | 3429/4096 [00:04<00:00, 756.86it/s]
Adding requests:  86%|████████▌ | 3505/4096 [00:04<00:00, 747.27it/s]
Adding requests:  87%|████████▋ | 3580/4096 [00:04<00:00, 732.81it/s]
Adding requests:  89%|████████▉ | 3654/4096 [00:04<00:00, 731.81it/s]
Adding requests:  91%|█████████ | 3730/4096 [00:04<00:00, 737.79it/s]
Adding requests:  93%|█████████▎| 3807/4096 [00:05<00:00, 747.13it/s]
Adding requests:  95%|█████████▍| 3883/4096 [00:05<00:00, 749.05it/s]
Adding requests:  97%|█████████▋| 3959/4096 [00:05<00:00, 751.43it/s]
Adding requests:  99%|█████████▊| 4035/4096 [00:05<00:00, 745.11it/s]
Adding requests: 100%|██████████| 4096/4096 [00:05<00:00, 746.73it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   6%|▌         | 226/4096 [00:00<00:05, 719.52it/s, est. speed input: 736821.31 toks/s, output: 719.53 toks/s]
Processed prompts:   7%|▋         | 298/4096 [00:01<00:27, 139.54it/s, est. speed input: 174976.50 toks/s, output: 170.88 toks/s]
Processed prompts:   8%|▊         | 331/4096 [00:02<00:36, 103.83it/s, est. speed input: 137845.40 toks/s, output: 134.61 toks/s]
Processed prompts:   9%|▊         | 354/4096 [00:03<00:47, 78.50it/s, est. speed input: 114200.78 toks/s, output: 111.52 toks/s] 
Processed prompts:   9%|▉         | 386/4096 [00:03<00:55, 67.17it/s, est. speed input: 101623.46 toks/s, output: 99.24 toks/s] 
Processed prompts:  10%|█         | 418/4096 [00:04<01:01, 59.93it/s, est. speed input: 92971.74 toks/s, output: 90.79 toks/s] 
Processed prompts:  11%|█         | 450/4096 [00:05<01:06, 55.10it/s, est. speed input: 86618.60 toks/s, output: 84.59 toks/s]
Processed prompts:  12%|█▏        | 482/4096 [00:06<01:09, 51.86it/s, est. speed input: 81774.40 toks/s, output: 79.86 toks/s]
Processed prompts:  13%|█▎        | 514/4096 [00:06<01:12, 49.67it/s, est. speed input: 77963.88 toks/s, output: 76.14 toks/s]
Processed prompts:  13%|█▎        | 546/4096 [00:07<01:13, 48.16it/s, est. speed input: 74880.55 toks/s, output: 73.13 toks/s]
Processed prompts:  14%|█▍        | 578/4096 [00:08<01:14, 47.11it/s, est. speed input: 72334.08 toks/s, output: 70.64 toks/s]
Processed prompts:  15%|█▍        | 610/4096 [00:08<01:15, 46.37it/s, est. speed input: 70195.30 toks/s, output: 68.55 toks/s]
Processed prompts:  16%|█▌        | 642/4096 [00:09<01:15, 45.88it/s, est. speed input: 68381.05 toks/s, output: 66.78 toks/s]
Processed prompts:  16%|█▋        | 674/4096 [00:10<01:15, 45.51it/s, est. speed input: 66807.79 toks/s, output: 65.24 toks/s]
Processed prompts:  17%|█▋        | 706/4096 [00:11<01:14, 45.26it/s, est. speed input: 65442.99 toks/s, output: 63.91 toks/s]
Processed prompts:  18%|█▊        | 738/4096 [00:11<01:14, 45.09it/s, est. speed input: 64245.34 toks/s, output: 62.74 toks/s]
Processed prompts:  19%|█▉        | 770/4096 [00:12<01:13, 44.96it/s, est. speed input: 63183.32 toks/s, output: 61.70 toks/s]
Processed prompts:  20%|█▉        | 802/4096 [00:13<01:13, 44.88it/s, est. speed input: 62237.80 toks/s, output: 60.78 toks/s]
Processed prompts:  20%|██        | 834/4096 [00:13<01:12, 44.81it/s, est. speed input: 61387.77 toks/s, output: 59.95 toks/s]
Processed prompts:  21%|██        | 866/4096 [00:14<01:12, 44.78it/s, est. speed input: 60622.74 toks/s, output: 59.20 toks/s]
Processed prompts:  22%|██▏       | 898/4096 [00:15<01:11, 44.74it/s, est. speed input: 59927.93 toks/s, output: 58.52 toks/s]
Processed prompts:  23%|██▎       | 930/4096 [00:16<01:10, 44.72it/s, est. speed input: 59294.53 toks/s, output: 57.90 toks/s]
Processed prompts:  23%|██▎       | 962/4096 [00:16<01:10, 44.70it/s, est. speed input: 58715.83 toks/s, output: 57.34 toks/s]
Processed prompts:  24%|██▍       | 994/4096 [00:17<01:09, 44.69it/s, est. speed input: 58183.40 toks/s, output: 56.82 toks/s]
Processed prompts:  25%|██▌       | 1026/4096 [00:18<01:08, 44.67it/s, est. speed input: 57691.79 toks/s, output: 56.34 toks/s]
Processed prompts:  26%|██▌       | 1058/4096 [00:18<01:08, 44.66it/s, est. speed input: 57238.06 toks/s, output: 55.90 toks/s]
Processed prompts:  27%|██▋       | 1090/4096 [00:19<01:07, 44.66it/s, est. speed input: 56818.13 toks/s, output: 55.49 toks/s]
Processed prompts:  27%|██▋       | 1122/4096 [00:20<01:06, 44.65it/s, est. speed input: 56426.63 toks/s, output: 55.10 toks/s]
Processed prompts:  28%|██▊       | 1154/4096 [00:21<01:05, 44.64it/s, est. speed input: 56061.61 toks/s, output: 54.75 toks/s]
Processed prompts:  29%|██▉       | 1186/4096 [00:21<01:05, 44.64it/s, est. speed input: 55721.21 toks/s, output: 54.42 toks/s]
Processed prompts:  30%|██▉       | 1218/4096 [00:22<01:04, 44.64it/s, est. speed input: 55402.46 toks/s, output: 54.10 toks/s]
Processed prompts:  31%|███       | 1250/4096 [00:23<01:03, 44.64it/s, est. speed input: 55103.21 toks/s, output: 53.81 toks/s]
Processed prompts:  31%|███▏      | 1282/4096 [00:23<01:03, 44.60it/s, est. speed input: 54816.77 toks/s, output: 53.53 toks/s]
Processed prompts:  32%|███▏      | 1314/4096 [00:24<01:02, 44.61it/s, est. speed input: 54552.49 toks/s, output: 53.27 toks/s]
Processed prompts:  33%|███▎      | 1346/4096 [00:25<01:01, 44.62it/s, est. speed input: 54302.14 toks/s, output: 53.03 toks/s]
Processed prompts:  34%|███▎      | 1378/4096 [00:26<01:00, 44.62it/s, est. speed input: 54065.71 toks/s, output: 52.80 toks/s]
Processed prompts:  34%|███▍      | 1410/4096 [00:26<01:00, 44.61it/s, est. speed input: 53841.06 toks/s, output: 52.58 toks/s]
Processed prompts:  35%|███▌      | 1442/4096 [00:27<00:59, 44.63it/s, est. speed input: 53629.88 toks/s, output: 52.37 toks/s]
Processed prompts:  36%|███▌      | 1474/4096 [00:28<00:58, 44.63it/s, est. speed input: 53428.68 toks/s, output: 52.18 toks/s]
Processed prompts:  37%|███▋      | 1506/4096 [00:28<00:58, 44.62it/s, est. speed input: 53236.97 toks/s, output: 51.99 toks/s]
Processed prompts:  38%|███▊      | 1538/4096 [00:29<00:57, 44.63it/s, est. speed input: 53054.95 toks/s, output: 51.81 toks/s]
Processed prompts:  38%|███▊      | 1570/4096 [00:30<00:56, 44.62it/s, est. speed input: 52880.99 toks/s, output: 51.64 toks/s]
Processed prompts:  39%|███▉      | 1602/4096 [00:31<00:55, 44.62it/s, est. speed input: 52714.97 toks/s, output: 51.48 toks/s]
Processed prompts:  40%|███▉      | 1634/4096 [00:31<00:55, 44.62it/s, est. speed input: 52556.61 toks/s, output: 51.32 toks/s]
Processed prompts:  41%|████      | 1666/4096 [00:32<00:54, 44.61it/s, est. speed input: 52404.90 toks/s, output: 51.18 toks/s]
Processed prompts:  41%|████▏     | 1698/4096 [00:33<00:53, 44.60it/s, est. speed input: 52259.16 toks/s, output: 51.03 toks/s]
Processed prompts:  42%|████▏     | 1730/4096 [00:33<00:53, 44.61it/s, est. speed input: 52120.57 toks/s, output: 50.90 toks/s]
Processed prompts:  43%|████▎     | 1762/4096 [00:34<00:52, 44.60it/s, est. speed input: 51987.04 toks/s, output: 50.77 toks/s]
Processed prompts:  44%|████▍     | 1794/4096 [00:35<00:51, 44.61it/s, est. speed input: 51859.68 toks/s, output: 50.64 toks/s]
Processed prompts:  45%|████▍     | 1826/4096 [00:36<00:50, 44.60it/s, est. speed input: 51736.31 toks/s, output: 50.52 toks/s]
Processed prompts:  45%|████▌     | 1858/4096 [00:36<00:49, 44.95it/s, est. speed input: 51644.38 toks/s, output: 50.43 toks/s]
Processed prompts:  46%|████▌     | 1890/4096 [00:37<00:49, 44.85it/s, est. speed input: 51530.43 toks/s, output: 50.32 toks/s]
Processed prompts:  47%|████▋     | 1922/4096 [00:38<00:48, 44.77it/s, est. speed input: 51420.38 toks/s, output: 50.22 toks/s]
Processed prompts:  48%|████▊     | 1954/4096 [00:38<00:47, 44.71it/s, est. speed input: 51313.99 toks/s, output: 50.11 toks/s]
Processed prompts:  48%|████▊     | 1986/4096 [00:39<00:47, 44.67it/s, est. speed input: 51211.74 toks/s, output: 50.01 toks/s]
Processed prompts:  49%|████▉     | 2018/4096 [00:40<00:46, 44.64it/s, est. speed input: 51112.83 toks/s, output: 49.91 toks/s]
Processed prompts:  50%|█████     | 2050/4096 [00:41<00:45, 44.63it/s, est. speed input: 51018.08 toks/s, output: 49.82 toks/s]
Processed prompts:  51%|█████     | 2082/4096 [00:41<00:45, 44.60it/s, est. speed input: 50925.22 toks/s, output: 49.73 toks/s]
Processed prompts:  52%|█████▏    | 2114/4096 [00:42<00:44, 44.60it/s, est. speed input: 50836.56 toks/s, output: 49.65 toks/s]
Processed prompts:  52%|█████▏    | 2146/4096 [00:43<00:43, 44.60it/s, est. speed input: 50750.67 toks/s, output: 49.56 toks/s]
Processed prompts:  53%|█████▎    | 2178/4096 [00:44<00:43, 44.59it/s, est. speed input: 50667.47 toks/s, output: 49.48 toks/s]
Processed prompts:  54%|█████▍    | 2210/4096 [00:44<00:42, 44.59it/s, est. speed input: 50586.99 toks/s, output: 49.40 toks/s]
Processed prompts:  55%|█████▍    | 2242/4096 [00:45<00:41, 44.58it/s, est. speed input: 50508.93 toks/s, output: 49.33 toks/s]
Processed prompts:  56%|█████▌    | 2274/4096 [00:46<00:40, 44.58it/s, est. speed input: 50433.36 toks/s, output: 49.25 toks/s]
Processed prompts:  56%|█████▋    | 2306/4096 [00:46<00:40, 44.58it/s, est. speed input: 50359.79 toks/s, output: 49.18 toks/s]
Processed prompts:  57%|█████▋    | 2338/4096 [00:47<00:39, 44.57it/s, est. speed input: 50288.46 toks/s, output: 49.11 toks/s]
Processed prompts:  58%|█████▊    | 2370/4096 [00:48<00:38, 44.57it/s, est. speed input: 50219.34 toks/s, output: 49.04 toks/s]
Processed prompts:  59%|█████▊    | 2402/4096 [00:49<00:38, 44.57it/s, est. speed input: 50152.17 toks/s, output: 48.98 toks/s]
Processed prompts:  59%|█████▉    | 2434/4096 [00:49<00:37, 44.57it/s, est. speed input: 50087.18 toks/s, output: 48.91 toks/s]
Processed prompts:  60%|██████    | 2466/4096 [00:50<00:36, 44.58it/s, est. speed input: 50024.18 toks/s, output: 48.85 toks/s]
Processed prompts:  61%|██████    | 2498/4096 [00:51<00:35, 44.95it/s, est. speed input: 49982.24 toks/s, output: 48.81 toks/s]
Processed prompts:  62%|██████▏   | 2530/4096 [00:51<00:34, 44.83it/s, est. speed input: 49921.91 toks/s, output: 48.75 toks/s]
Processed prompts:  63%|██████▎   | 2562/4096 [00:52<00:34, 44.75it/s, est. speed input: 49863.32 toks/s, output: 48.69 toks/s]
Processed prompts:  63%|██████▎   | 2594/4096 [00:53<00:33, 44.69it/s, est. speed input: 49806.24 toks/s, output: 48.64 toks/s]
Processed prompts:  64%|██████▍   | 2626/4096 [00:54<00:32, 44.65it/s, est. speed input: 49750.63 toks/s, output: 48.58 toks/s]
Processed prompts:  65%|██████▍   | 2658/4096 [00:54<00:32, 44.62it/s, est. speed input: 49696.72 toks/s, output: 48.53 toks/s]
Processed prompts:  66%|██████▌   | 2690/4096 [00:55<00:31, 44.60it/s, est. speed input: 49643.88 toks/s, output: 48.48 toks/s]
Processed prompts:  66%|██████▋   | 2722/4096 [00:56<00:30, 44.59it/s, est. speed input: 49592.67 toks/s, output: 48.43 toks/s]
Processed prompts:  67%|██████▋   | 2754/4096 [00:56<00:30, 44.58it/s, est. speed input: 49542.53 toks/s, output: 48.38 toks/s]
Processed prompts:  68%|██████▊   | 2786/4096 [00:57<00:29, 44.57it/s, est. speed input: 49493.71 toks/s, output: 48.33 toks/s]
Processed prompts:  69%|██████▉   | 2818/4096 [00:58<00:28, 44.57it/s, est. speed input: 49446.18 toks/s, output: 48.29 toks/s]
Processed prompts:  70%|██████▉   | 2850/4096 [00:59<00:27, 44.56it/s, est. speed input: 49399.54 toks/s, output: 48.24 toks/s]
Processed prompts:  70%|███████   | 2882/4096 [00:59<00:27, 44.56it/s, est. speed input: 49354.05 toks/s, output: 48.20 toks/s]
Processed prompts:  71%|███████   | 2914/4096 [01:00<00:26, 44.56it/s, est. speed input: 49309.79 toks/s, output: 48.15 toks/s]
Processed prompts:  72%|███████▏  | 2946/4096 [01:01<00:25, 44.55it/s, est. speed input: 49266.33 toks/s, output: 48.11 toks/s]
Processed prompts:  73%|███████▎  | 2978/4096 [01:01<00:25, 44.55it/s, est. speed input: 49223.86 toks/s, output: 48.07 toks/s]
Processed prompts:  73%|███████▎  | 3010/4096 [01:02<00:24, 44.55it/s, est. speed input: 49182.50 toks/s, output: 48.03 toks/s]
Processed prompts:  74%|███████▍  | 3042/4096 [01:03<00:23, 44.55it/s, est. speed input: 49142.12 toks/s, output: 47.99 toks/s]
Processed prompts:  75%|███████▌  | 3074/4096 [01:04<00:22, 44.53it/s, est. speed input: 49102.10 toks/s, output: 47.95 toks/s]
Processed prompts:  76%|███████▌  | 3106/4096 [01:04<00:22, 44.53it/s, est. speed input: 49063.33 toks/s, output: 47.91 toks/s]
Processed prompts:  77%|███████▋  | 3138/4096 [01:05<00:21, 44.54it/s, est. speed input: 49025.58 toks/s, output: 47.88 toks/s]
Processed prompts:  77%|███████▋  | 3170/4096 [01:06<00:20, 44.54it/s, est. speed input: 48988.36 toks/s, output: 47.84 toks/s]
Processed prompts:  78%|███████▊  | 3202/4096 [01:06<00:20, 44.53it/s, est. speed input: 48951.97 toks/s, output: 47.80 toks/s]
Processed prompts:  79%|███████▉  | 3234/4096 [01:07<00:19, 44.53it/s, est. speed input: 48916.44 toks/s, output: 47.77 toks/s]
Processed prompts:  80%|███████▉  | 3266/4096 [01:08<00:18, 44.53it/s, est. speed input: 48881.51 toks/s, output: 47.74 toks/s]
Processed prompts:  81%|████████  | 3298/4096 [01:09<00:17, 44.52it/s, est. speed input: 48847.15 toks/s, output: 47.70 toks/s]
Processed prompts:  81%|████████▏ | 3330/4096 [01:09<00:17, 44.52it/s, est. speed input: 48813.37 toks/s, output: 47.67 toks/s]
Processed prompts:  82%|████████▏ | 3362/4096 [01:10<00:16, 44.52it/s, est. speed input: 48780.65 toks/s, output: 47.64 toks/s]
Processed prompts:  83%|████████▎ | 3394/4096 [01:11<00:15, 44.52it/s, est. speed input: 48748.36 toks/s, output: 47.61 toks/s]
Processed prompts:  84%|████████▎ | 3426/4096 [01:12<00:15, 44.51it/s, est. speed input: 48716.65 toks/s, output: 47.57 toks/s]
Processed prompts:  84%|████████▍ | 3458/4096 [01:12<00:14, 44.52it/s, est. speed input: 48685.96 toks/s, output: 47.54 toks/s]
Processed prompts:  85%|████████▌ | 3490/4096 [01:13<00:13, 44.52it/s, est. speed input: 48655.58 toks/s, output: 47.52 toks/s]
Processed prompts:  86%|████████▌ | 3522/4096 [01:14<00:12, 44.52it/s, est. speed input: 48625.97 toks/s, output: 47.49 toks/s]
Processed prompts:  87%|████████▋ | 3554/4096 [01:14<00:12, 44.52it/s, est. speed input: 48596.64 toks/s, output: 47.46 toks/s]
Processed prompts:  88%|████████▊ | 3586/4096 [01:15<00:11, 44.52it/s, est. speed input: 48568.09 toks/s, output: 47.43 toks/s]
Processed prompts:  88%|████████▊ | 3618/4096 [01:16<00:10, 44.52it/s, est. speed input: 48540.01 toks/s, output: 47.40 toks/s]
Processed prompts:  89%|████████▉ | 3650/4096 [01:17<00:10, 44.52it/s, est. speed input: 48512.33 toks/s, output: 47.38 toks/s]
Processed prompts:  90%|████████▉ | 3682/4096 [01:17<00:09, 44.52it/s, est. speed input: 48485.40 toks/s, output: 47.35 toks/s]
Processed prompts:  91%|█████████ | 3714/4096 [01:18<00:08, 44.52it/s, est. speed input: 48458.76 toks/s, output: 47.32 toks/s]
Processed prompts:  91%|█████████▏| 3746/4096 [01:19<00:07, 44.52it/s, est. speed input: 48432.69 toks/s, output: 47.30 toks/s]
Processed prompts:  92%|█████████▏| 3778/4096 [01:19<00:07, 44.51it/s, est. speed input: 48406.85 toks/s, output: 47.27 toks/s]
Processed prompts:  93%|█████████▎| 3810/4096 [01:20<00:06, 44.51it/s, est. speed input: 48381.72 toks/s, output: 47.25 toks/s]
Processed prompts:  94%|█████████▍| 3842/4096 [01:21<00:05, 44.51it/s, est. speed input: 48356.74 toks/s, output: 47.22 toks/s]
Processed prompts:  95%|█████████▍| 3874/4096 [01:22<00:04, 44.51it/s, est. speed input: 48332.37 toks/s, output: 47.20 toks/s]
Processed prompts:  95%|█████████▌| 3906/4096 [01:22<00:04, 44.50it/s, est. speed input: 48308.16 toks/s, output: 47.18 toks/s]
Processed prompts:  96%|█████████▌| 3938/4096 [01:23<00:03, 44.51it/s, est. speed input: 48285.07 toks/s, output: 47.15 toks/s]
Processed prompts:  97%|█████████▋| 3970/4096 [01:24<00:02, 44.50it/s, est. speed input: 48261.66 toks/s, output: 47.13 toks/s]
Processed prompts:  98%|█████████▊| 4002/4096 [01:24<00:02, 44.51it/s, est. speed input: 48238.95 toks/s, output: 47.11 toks/s]
Processed prompts:  98%|█████████▊| 4034/4096 [01:25<00:01, 44.89it/s, est. speed input: 48228.20 toks/s, output: 47.10 toks/s]
Processed prompts:  99%|█████████▉| 4066/4096 [01:26<00:00, 45.21it/s, est. speed input: 48218.98 toks/s, output: 47.09 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [01:26<00:00, 45.21it/s, est. speed input: 48574.61 toks/s, output: 47.44 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [01:26<00:00, 47.44it/s, est. speed input: 48574.61 toks/s, output: 47.44 toks/s]
[rank0]:[W128 00:37:27.928595905 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 126.6s

测试结果:
  Requests/s:   44.60
  Tokens/s:     45717.12
  Total Reqs:   4096
  Elapsed:      91.83s

  [Prefill 分析]
  Total Prefill Tokens: 4194304
  Prefill Tokens/s:     45672.52


------------------------------------------------------------
  生成 CSV: BitNet-2B-INT8
------------------------------------------------------------
[SUCCESS] CSV 保存到: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX5080_cc120_INT8_py312_cu129_x86_64/cusparselt/2_10/BitNet-2B-INT8_prefill.csv

预览:
------------------------------------------------------------
M_prefill,prompt_len,max_num_seqs,num_prompts,N_prefill,requests_per_s,tokens_per_s,elapsed_time_s
512,512,1,128,128,54.0962,27751.3599,2.3662
1024,1024,1,128,128,44.0728,45174.6047,2.9043
2048,1024,2,256,128,48.6858,49902.9182,5.2582
4096,1024,4,512,128,47.9350,49133.3385,10.6811
8192,1024,8,1024,128,45.4641,46600.6651,22.5233
16384,1024,16,2048,128,44.6098,45725.0896,45.9092
32768,1024,32,4096,128,44.6021,45717.1240,91.8343

------------------------------------------------------------

[INFO] 完成: 7 成功, 0 失败


============================================================
  Benchmark 完成!
============================================================


总计: 35 成功, 0 失败
============================================================
