======================================================================
SlideSparse vLLM Throughput Benchmark Log
Created: 2026-01-26 01:10:13
======================================================================

原始命令:
  /root/vllmbench/slidesparse/tools/throughput_benchmark.py --model llama3.2-1b-int8 --stage prefill --backend cusparselt --M 65536 --gpu-mem 0.65 --gpu-id 1 --sparsity 2_4

命令行参数:
  --model: llama3.2-1b-int8
  --backend: cusparselt
  --sparsity: 2_4
  --stage: prefill
  --M: 65536
  --N: None
  --inner-32: False
  --eager: False
  --gpu-id: 1
  --gpu-mem: 0.65
  --dry-run: False
  --list-models: False

硬件信息:
  GPU: RTX5080
  Compute Capability: cc120
  VRAM: 15.5 GB
  CUDA: 12.9
  Python: py312

Backend 环境变量 (初始状态):
  DISABLE_SLIDESPARSE: 未设置
  USE_CUBLASLT: 未设置
  USE_CUSPARSELT: 未设置
  SPARSITY: 未设置
  INNER_DTYPE_32: 未设置

======================================================================


============================================================
  Llama3.2-1B-INT8 | cuSPARSELt (2_4) | prefill
============================================================

[INFO] Checkpoint: /root/vllmbench/checkpoints_slidesparse/Llama3.2-1B-INT8-SlideSparse-2_4
[INFO] Output: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX5080_cc120_INT8_py312_cu129_x86_64/cusparselt/2_4

============================================================
[1/1] 测试 M=65536
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Llama3.2-1B-INT8                                │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 65536
│   M_prefill     = 65536 (= 64 x 1024)
│   M_decode      = 64
│   batched_tokens = 65536 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 8192
│   --max-num-seqs           = 64
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 65536
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 01:10:39 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
(EngineCore_DP0 pid=765692) [INFO] Loading compress extension: cusparselt_compress_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=765692) WARNING 01-26 01:10:47 [backends.py:609] Failed to read file <frozen os>
Throughput: 107.51 requests/s, 110195.38 total tokens/s, 107.51 output tokens/s
Total num prompt tokens:  8388608
Total num output tokens:  8192


─── STDERR ───
[2026-01-26 01:10:39] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 01:10:39] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-26 01:10:39] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-26 01:10:39] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 01:10:39] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 01:10:39] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 01:10:39] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 01:10:39] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 01:10:39] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-26 01:10:39] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 01:10:39] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 01:10:39] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 01:10:39] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 01:10:39] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 01:10:43] INFO kernels.py:578: Triton kernel custom ops registered
[2026-01-26 01:10:43] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Llama3.2-1B-INT8'
[2026-01-26 01:10:43] INFO kernels.py:109: Loaded tuned kernel for model: Llama3.2-1B-INT8
[2026-01-26 01:10:43] INFO kernels.py:155: Dequant+bias kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 01:10:43] INFO kernels.py:224: FP8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 01:10:43] INFO kernels.py:348: INT8 quant kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 01:10:43] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 01:10:43] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Llama3.2-1B-INT8
[2026-01-26 01:10:43] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Llama3.2-1B-INT8'
[2026-01-26 01:10:43] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 01:10:43] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 01:10:43] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 01:10:43] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 01:10:43] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=765692) [2026-01-26 01:10:44] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=765692) [2026-01-26 01:10:44] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_RTX5080_cc120_py312_cu129_x86_64.so
(EngineCore_DP0 pid=765692) [2026-01-26 01:10:44] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=765692) [2026-01-26 01:10:44] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=765692) [2026-01-26 01:10:44] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Llama3.2-1B-INT8
(EngineCore_DP0 pid=765692) [2026-01-26 01:10:44] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=765692) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=765692) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.25it/s]
(EngineCore_DP0 pid=765692) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  4.25it/s]
(EngineCore_DP0 pid=765692) 
(EngineCore_DP0 pid=765692) [2026-01-26 01:10:44] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3072, 2048] -> 1D uint8
(EngineCore_DP0 pid=765692) [2026-01-26 01:10:44] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 4718592 bytes
(EngineCore_DP0 pid=765692) [2026-01-26 01:10:44] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 2048] -> 1D uint8
(EngineCore_DP0 pid=765692) [2026-01-26 01:10:44] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 3145728 bytes
(EngineCore_DP0 pid=765692) [2026-01-26 01:10:44] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [16384, 2048] -> 1D uint8
(EngineCore_DP0 pid=765692) [2026-01-26 01:10:44] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 25165824 bytes
(EngineCore_DP0 pid=765692) [2026-01-26 01:10:44] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [2048, 8192] -> 1D uint8
(EngineCore_DP0 pid=765692) [2026-01-26 01:10:44] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12582912 bytes
(EngineCore_DP0 pid=765692) 2026-01-26 01:10:49,754 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=765692) 2026-01-26 01:10:49,769 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
(EngineCore_DP0 pid=765692) 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/19 [00:00<?, ?it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   5%|▌         | 1/19 [00:00<00:06,  2.68it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  26%|██▋       | 5/19 [00:00<00:01, 12.52it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  47%|████▋     | 9/19 [00:00<00:00, 19.39it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  68%|██████▊   | 13/19 [00:00<00:00, 24.63it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  95%|█████████▍| 18/19 [00:00<00:00, 29.94it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 19/19 [00:00<00:00, 21.68it/s]
(EngineCore_DP0 pid=765692) 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/11 [00:00<?, ?it/s]
Capturing CUDA graphs (decode, FULL):   9%|▉         | 1/11 [00:00<00:01,  6.27it/s]
Capturing CUDA graphs (decode, FULL):  45%|████▌     | 5/11 [00:00<00:00, 19.30it/s]
Capturing CUDA graphs (decode, FULL):  73%|███████▎  | 8/11 [00:00<00:00, 23.18it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 11/11 [00:00<00:00, 24.48it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 11/11 [00:00<00:00, 21.79it/s]

Adding requests:   0%|          | 0/8192 [00:00<?, ?it/s]
Adding requests:   1%|          | 71/8192 [00:00<00:11, 705.83it/s]
Adding requests:   2%|▏         | 144/8192 [00:00<00:11, 719.57it/s]
Adding requests:   3%|▎         | 217/8192 [00:00<00:11, 722.90it/s]
Adding requests:   4%|▎         | 294/8192 [00:00<00:10, 739.65it/s]
Adding requests:   5%|▍         | 369/8192 [00:00<00:10, 741.78it/s]
Adding requests:   5%|▌         | 444/8192 [00:00<00:10, 743.78it/s]
Adding requests:   6%|▋         | 519/8192 [00:00<00:10, 729.84it/s]
Adding requests:   7%|▋         | 595/8192 [00:00<00:10, 737.74it/s]
Adding requests:   8%|▊         | 670/8192 [00:00<00:10, 739.23it/s]
Adding requests:   9%|▉         | 744/8192 [00:01<00:10, 737.07it/s]
Adding requests:  10%|▉         | 818/8192 [00:01<00:10, 722.39it/s]
Adding requests:  11%|█         | 893/8192 [00:01<00:09, 730.26it/s]
Adding requests:  12%|█▏        | 969/8192 [00:01<00:09, 735.04it/s]
Adding requests:  13%|█▎        | 1046/8192 [00:01<00:09, 743.37it/s]
Adding requests:  14%|█▎        | 1121/8192 [00:01<00:09, 741.52it/s]
Adding requests:  15%|█▍        | 1201/8192 [00:01<00:09, 756.55it/s]
Adding requests:  16%|█▌        | 1277/8192 [00:01<00:09, 751.39it/s]
Adding requests:  17%|█▋        | 1354/8192 [00:01<00:09, 755.39it/s]
Adding requests:  17%|█▋        | 1430/8192 [00:01<00:09, 749.76it/s]
Adding requests:  18%|█▊        | 1506/8192 [00:02<00:08, 749.75it/s]
Adding requests:  19%|█▉        | 1583/8192 [00:02<00:08, 753.83it/s]
Adding requests:  20%|██        | 1659/8192 [00:02<00:08, 755.30it/s]
Adding requests:  21%|██        | 1735/8192 [00:02<00:08, 739.48it/s]
Adding requests:  22%|██▏       | 1810/8192 [00:02<00:08, 721.97it/s]
Adding requests:  23%|██▎       | 1883/8192 [00:02<00:08, 724.25it/s]
Adding requests:  24%|██▍       | 1959/8192 [00:02<00:08, 734.25it/s]
Adding requests:  25%|██▍       | 2037/8192 [00:02<00:08, 747.56it/s]
Adding requests:  26%|██▌       | 2113/8192 [00:02<00:08, 751.11it/s]
Adding requests:  27%|██▋       | 2189/8192 [00:02<00:08, 739.16it/s]
Adding requests:  28%|██▊       | 2265/8192 [00:03<00:07, 744.19it/s]
Adding requests:  29%|██▊       | 2340/8192 [00:03<00:07, 737.62it/s]
Adding requests:  29%|██▉       | 2415/8192 [00:03<00:07, 740.79it/s]
Adding requests:  30%|███       | 2493/8192 [00:03<00:07, 749.46it/s]
Adding requests:  31%|███▏      | 2568/8192 [00:03<00:07, 749.59it/s]
Adding requests:  32%|███▏      | 2644/8192 [00:03<00:07, 751.87it/s]
Adding requests:  33%|███▎      | 2720/8192 [00:03<00:07, 751.80it/s]
Adding requests:  34%|███▍      | 2796/8192 [00:03<00:07, 750.78it/s]
Adding requests:  35%|███▌      | 2873/8192 [00:03<00:07, 755.51it/s]
Adding requests:  36%|███▌      | 2949/8192 [00:03<00:06, 751.73it/s]
Adding requests:  37%|███▋      | 3025/8192 [00:04<00:06, 738.97it/s]
Adding requests:  38%|███▊      | 3101/8192 [00:04<00:06, 744.46it/s]
Adding requests:  39%|███▉      | 3177/8192 [00:04<00:06, 748.73it/s]
Adding requests:  40%|███▉      | 3255/8192 [00:04<00:06, 755.55it/s]
Adding requests:  41%|████      | 3331/8192 [00:04<00:06, 754.50it/s]
Adding requests:  42%|████▏     | 3407/8192 [00:04<00:06, 755.12it/s]
Adding requests:  43%|████▎     | 3483/8192 [00:04<00:06, 751.54it/s]
Adding requests:  43%|████▎     | 3560/8192 [00:04<00:06, 756.57it/s]
Adding requests:  44%|████▍     | 3636/8192 [00:04<00:06, 751.22it/s]
Adding requests:  45%|████▌     | 3712/8192 [00:04<00:05, 749.71it/s]
Adding requests:  46%|████▌     | 3787/8192 [00:05<00:05, 746.75it/s]
Adding requests:  47%|████▋     | 3862/8192 [00:05<00:05, 743.90it/s]
Adding requests:  48%|████▊     | 3937/8192 [00:05<00:05, 740.28it/s]
Adding requests:  49%|████▉     | 4012/8192 [00:05<00:05, 737.58it/s]
Adding requests:  50%|████▉     | 4086/8192 [00:05<00:05, 734.79it/s]
Adding requests:  51%|█████     | 4163/8192 [00:05<00:05, 744.94it/s]
Adding requests:  52%|█████▏    | 4239/8192 [00:05<00:05, 747.31it/s]
Adding requests:  53%|█████▎    | 4314/8192 [00:05<00:05, 732.72it/s]
Adding requests:  54%|█████▎    | 4394/8192 [00:05<00:05, 751.66it/s]
Adding requests:  55%|█████▍    | 4471/8192 [00:06<00:04, 756.74it/s]
Adding requests:  56%|█████▌    | 4547/8192 [00:06<00:04, 751.55it/s]
Adding requests:  56%|█████▋    | 4626/8192 [00:06<00:04, 761.22it/s]
Adding requests:  57%|█████▋    | 4703/8192 [00:06<00:04, 762.76it/s]
Adding requests:  58%|█████▊    | 4781/8192 [00:06<00:04, 765.70it/s]
Adding requests:  59%|█████▉    | 4858/8192 [00:06<00:04, 764.85it/s]
Adding requests:  60%|██████    | 4935/8192 [00:06<00:04, 760.97it/s]
Adding requests:  61%|██████    | 5012/8192 [00:06<00:04, 760.04it/s]
Adding requests:  62%|██████▏   | 5092/8192 [00:06<00:04, 769.84it/s]
Adding requests:  63%|██████▎   | 5170/8192 [00:06<00:03, 770.06it/s]
Adding requests:  64%|██████▍   | 5248/8192 [00:07<00:03, 754.81it/s]
Adding requests:  65%|██████▍   | 5324/8192 [00:07<00:03, 735.48it/s]
Adding requests:  66%|██████▌   | 5401/8192 [00:07<00:03, 744.08it/s]
Adding requests:  67%|██████▋   | 5476/8192 [00:07<00:03, 740.65it/s]
Adding requests:  68%|██████▊   | 5552/8192 [00:07<00:03, 743.39it/s]
Adding requests:  69%|██████▊   | 5628/8192 [00:07<00:03, 748.03it/s]
Adding requests:  70%|██████▉   | 5703/8192 [00:07<00:03, 737.39it/s]
Adding requests:  71%|███████   | 5781/8192 [00:07<00:03, 747.47it/s]
Adding requests:  71%|███████▏  | 5857/8192 [00:07<00:03, 748.77it/s]
Adding requests:  72%|███████▏  | 5934/8192 [00:07<00:03, 752.33it/s]
Adding requests:  73%|███████▎  | 6011/8192 [00:08<00:02, 757.07it/s]
Adding requests:  74%|███████▍  | 6088/8192 [00:08<00:02, 758.71it/s]
Adding requests:  75%|███████▌  | 6165/8192 [00:08<00:02, 761.83it/s]
Adding requests:  76%|███████▌  | 6246/8192 [00:08<00:02, 775.46it/s]
Adding requests:  77%|███████▋  | 6324/8192 [00:08<00:02, 775.09it/s]
Adding requests:  78%|███████▊  | 6403/8192 [00:08<00:02, 777.87it/s]
Adding requests:  79%|███████▉  | 6483/8192 [00:08<00:02, 783.29it/s]
Adding requests:  80%|████████  | 6563/8192 [00:08<00:02, 786.14it/s]
Adding requests:  81%|████████  | 6642/8192 [00:08<00:01, 779.57it/s]
Adding requests:  82%|████████▏ | 6721/8192 [00:08<00:01, 780.78it/s]
Adding requests:  83%|████████▎ | 6800/8192 [00:09<00:01, 779.60it/s]
Adding requests:  84%|████████▍ | 6880/8192 [00:09<00:01, 783.51it/s]
Adding requests:  85%|████████▍ | 6961/8192 [00:09<00:01, 788.53it/s]
Adding requests:  86%|████████▌ | 7040/8192 [00:09<00:01, 762.62it/s]
Adding requests:  87%|████████▋ | 7119/8192 [00:09<00:01, 768.61it/s]
Adding requests:  88%|████████▊ | 7197/8192 [00:09<00:01, 770.30it/s]
Adding requests:  89%|████████▉ | 7276/8192 [00:09<00:01, 775.04it/s]
Adding requests:  90%|████████▉ | 7354/8192 [00:09<00:01, 775.51it/s]
Adding requests:  91%|█████████ | 7436/8192 [00:09<00:00, 786.43it/s]
Adding requests:  92%|█████████▏| 7515/8192 [00:09<00:00, 785.71it/s]
Adding requests:  93%|█████████▎| 7594/8192 [00:10<00:00, 785.78it/s]
Adding requests:  94%|█████████▎| 7674/8192 [00:10<00:00, 787.76it/s]
Adding requests:  95%|█████████▍| 7753/8192 [00:10<00:00, 785.19it/s]
Adding requests:  96%|█████████▌| 7832/8192 [00:10<00:00, 778.79it/s]
Adding requests:  97%|█████████▋| 7910/8192 [00:10<00:00, 778.03it/s]
Adding requests:  98%|█████████▊| 7988/8192 [00:10<00:00, 773.29it/s]
Adding requests:  98%|█████████▊| 8066/8192 [00:10<00:00, 773.02it/s]
Adding requests:  99%|█████████▉| 8145/8192 [00:10<00:00, 776.39it/s]
Adding requests: 100%|██████████| 8192/8192 [00:10<00:00, 755.23it/s]

Processed prompts:   0%|          | 0/8192 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  14%|█▍        | 1149/8192 [00:00<00:03, 2329.11it/s, est. speed input: 2385113.85 toks/s, output: 2329.15 toks/s]
Processed prompts:  17%|█▋        | 1382/8192 [00:02<00:13, 487.76it/s, est. speed input: 622149.38 toks/s, output: 607.57 toks/s]   
Processed prompts:  18%|█▊        | 1486/8192 [00:03<00:21, 310.21it/s, est. speed input: 439544.28 toks/s, output: 429.24 toks/s]
Processed prompts:  19%|█▉        | 1547/8192 [00:04<00:25, 260.25it/s, est. speed input: 390575.22 toks/s, output: 381.42 toks/s]
Processed prompts:  19%|█▉        | 1597/8192 [00:04<00:30, 215.21it/s, est. speed input: 351706.12 toks/s, output: 343.46 toks/s]
Processed prompts:  20%|██        | 1661/8192 [00:05<00:35, 186.55it/s, est. speed input: 324445.64 toks/s, output: 316.84 toks/s]
Processed prompts:  21%|██        | 1725/8192 [00:05<00:39, 164.66it/s, est. speed input: 302605.26 toks/s, output: 295.51 toks/s]
Processed prompts:  22%|██▏       | 1789/8192 [00:06<00:43, 148.54it/s, est. speed input: 284844.28 toks/s, output: 278.17 toks/s]
Processed prompts:  23%|██▎       | 1853/8192 [00:07<00:46, 137.36it/s, est. speed input: 270423.50 toks/s, output: 264.08 toks/s]
Processed prompts:  23%|██▎       | 1917/8192 [00:07<00:48, 128.69it/s, est. speed input: 257923.46 toks/s, output: 251.88 toks/s]
Processed prompts:  24%|██▍       | 1981/8192 [00:08<00:50, 122.52it/s, est. speed input: 247239.38 toks/s, output: 241.44 toks/s]
Processed prompts:  25%|██▍       | 2045/8192 [00:08<00:52, 118.14it/s, est. speed input: 237995.45 toks/s, output: 232.42 toks/s]
Processed prompts:  26%|██▌       | 2109/8192 [00:09<00:52, 115.06it/s, est. speed input: 229925.54 toks/s, output: 224.54 toks/s]
Processed prompts:  27%|██▋       | 2173/8192 [00:09<00:53, 112.86it/s, est. speed input: 222804.08 toks/s, output: 217.58 toks/s]
Processed prompts:  27%|██▋       | 2237/8192 [00:10<00:53, 111.32it/s, est. speed input: 216487.84 toks/s, output: 211.41 toks/s]
Processed prompts:  28%|██▊       | 2301/8192 [00:11<00:53, 110.25it/s, est. speed input: 210845.27 toks/s, output: 205.90 toks/s]
Processed prompts:  29%|██▉       | 2365/8192 [00:11<00:53, 109.49it/s, est. speed input: 205767.14 toks/s, output: 200.94 toks/s]
Processed prompts:  30%|██▉       | 2429/8192 [00:12<00:52, 108.94it/s, est. speed input: 201173.30 toks/s, output: 196.46 toks/s]
Processed prompts:  30%|███       | 2493/8192 [00:12<00:52, 109.03it/s, est. speed input: 197132.87 toks/s, output: 192.51 toks/s]
Processed prompts:  31%|███       | 2557/8192 [00:13<00:51, 108.60it/s, est. speed input: 193316.51 toks/s, output: 188.79 toks/s]
Processed prompts:  32%|███▏      | 2621/8192 [00:14<00:51, 108.32it/s, est. speed input: 189823.58 toks/s, output: 185.37 toks/s]
Processed prompts:  33%|███▎      | 2685/8192 [00:14<00:50, 108.12it/s, est. speed input: 186612.12 toks/s, output: 182.24 toks/s]
Processed prompts:  34%|███▎      | 2749/8192 [00:15<00:50, 107.99it/s, est. speed input: 183652.15 toks/s, output: 179.35 toks/s]
Processed prompts:  34%|███▍      | 2813/8192 [00:15<00:49, 107.87it/s, est. speed input: 180906.91 toks/s, output: 176.67 toks/s]
Processed prompts:  35%|███▌      | 2877/8192 [00:16<00:49, 107.80it/s, est. speed input: 178363.00 toks/s, output: 174.18 toks/s]
Processed prompts:  36%|███▌      | 2941/8192 [00:17<00:48, 107.74it/s, est. speed input: 175991.79 toks/s, output: 171.87 toks/s]
Processed prompts:  37%|███▋      | 3005/8192 [00:17<00:48, 107.70it/s, est. speed input: 173781.87 toks/s, output: 169.71 toks/s]
Processed prompts:  37%|███▋      | 3069/8192 [00:18<00:47, 107.68it/s, est. speed input: 171716.99 toks/s, output: 167.69 toks/s]
Processed prompts:  38%|███▊      | 3133/8192 [00:18<00:47, 107.63it/s, est. speed input: 169776.11 toks/s, output: 165.80 toks/s]
Processed prompts:  39%|███▉      | 3197/8192 [00:19<00:46, 107.62it/s, est. speed input: 167957.19 toks/s, output: 164.02 toks/s]
Processed prompts:  40%|███▉      | 3261/8192 [00:20<00:45, 107.63it/s, est. speed input: 166249.00 toks/s, output: 162.35 toks/s]
Processed prompts:  41%|████      | 3325/8192 [00:20<00:45, 107.61it/s, est. speed input: 164635.06 toks/s, output: 160.78 toks/s]
Processed prompts:  41%|████▏     | 3389/8192 [00:21<00:44, 107.60it/s, est. speed input: 163112.04 toks/s, output: 159.29 toks/s]
Processed prompts:  42%|████▏     | 3453/8192 [00:21<00:44, 107.57it/s, est. speed input: 161667.51 toks/s, output: 157.88 toks/s]
Processed prompts:  43%|████▎     | 3517/8192 [00:22<00:43, 107.58it/s, est. speed input: 160304.34 toks/s, output: 156.55 toks/s]
Processed prompts:  44%|████▎     | 3581/8192 [00:23<00:42, 107.57it/s, est. speed input: 159009.34 toks/s, output: 155.28 toks/s]
Processed prompts:  44%|████▍     | 3645/8192 [00:23<00:42, 107.57it/s, est. speed input: 157780.86 toks/s, output: 154.08 toks/s]
Processed prompts:  45%|████▌     | 3709/8192 [00:24<00:41, 107.52it/s, est. speed input: 156606.91 toks/s, output: 152.94 toks/s]
Processed prompts:  46%|████▌     | 3773/8192 [00:24<00:41, 107.53it/s, est. speed input: 155493.23 toks/s, output: 151.85 toks/s]
Processed prompts:  47%|████▋     | 3837/8192 [00:25<00:40, 107.52it/s, est. speed input: 154431.29 toks/s, output: 150.81 toks/s]
Processed prompts:  48%|████▊     | 3901/8192 [00:26<00:39, 107.49it/s, est. speed input: 153414.68 toks/s, output: 149.82 toks/s]
Processed prompts:  48%|████▊     | 3965/8192 [00:26<00:39, 107.50it/s, est. speed input: 152446.71 toks/s, output: 148.87 toks/s]
Processed prompts:  49%|████▉     | 4029/8192 [00:27<00:38, 107.97it/s, est. speed input: 151568.02 toks/s, output: 148.02 toks/s]
Processed prompts:  50%|████▉     | 4093/8192 [00:27<00:38, 107.82it/s, est. speed input: 150678.91 toks/s, output: 147.15 toks/s]
Processed prompts:  51%|█████     | 4157/8192 [00:28<00:37, 107.72it/s, est. speed input: 149828.51 toks/s, output: 146.32 toks/s]
Processed prompts:  52%|█████▏    | 4221/8192 [00:28<00:36, 108.12it/s, est. speed input: 149056.14 toks/s, output: 145.56 toks/s]
Processed prompts:  52%|█████▏    | 4285/8192 [00:29<00:36, 107.91it/s, est. speed input: 148269.81 toks/s, output: 144.79 toks/s]
Processed prompts:  53%|█████▎    | 4349/8192 [00:30<00:35, 107.76it/s, est. speed input: 147514.21 toks/s, output: 144.06 toks/s]
Processed prompts:  54%|█████▍    | 4413/8192 [00:30<00:35, 107.68it/s, est. speed input: 146789.90 toks/s, output: 143.35 toks/s]
Processed prompts:  55%|█████▍    | 4477/8192 [00:31<00:34, 107.61it/s, est. speed input: 146092.27 toks/s, output: 142.67 toks/s]
Processed prompts:  55%|█████▌    | 4541/8192 [00:31<00:33, 107.56it/s, est. speed input: 145420.44 toks/s, output: 142.01 toks/s]
Processed prompts:  56%|█████▌    | 4605/8192 [00:32<00:33, 107.54it/s, est. speed input: 144774.33 toks/s, output: 141.38 toks/s]
Processed prompts:  57%|█████▋    | 4669/8192 [00:33<00:32, 107.52it/s, est. speed input: 144150.50 toks/s, output: 140.77 toks/s]
Processed prompts:  58%|█████▊    | 4733/8192 [00:33<00:32, 107.49it/s, est. speed input: 143547.72 toks/s, output: 140.18 toks/s]
Processed prompts:  59%|█████▊    | 4797/8192 [00:34<00:31, 107.85it/s, est. speed input: 142995.58 toks/s, output: 139.64 toks/s]
Processed prompts:  59%|█████▉    | 4861/8192 [00:34<00:30, 107.74it/s, est. speed input: 142434.45 toks/s, output: 139.10 toks/s]
Processed prompts:  60%|██████    | 4925/8192 [00:35<00:30, 107.67it/s, est. speed input: 141892.51 toks/s, output: 138.57 toks/s]
Processed prompts:  61%|██████    | 4989/8192 [00:36<00:29, 108.06it/s, est. speed input: 141399.97 toks/s, output: 138.09 toks/s]
Processed prompts:  62%|██████▏   | 5053/8192 [00:36<00:29, 107.91it/s, est. speed input: 140893.93 toks/s, output: 137.59 toks/s]
Processed prompts:  62%|██████▏   | 5117/8192 [00:37<00:28, 107.73it/s, est. speed input: 140398.29 toks/s, output: 137.11 toks/s]
Processed prompts:  63%|██████▎   | 5181/8192 [00:37<00:27, 107.65it/s, est. speed input: 139921.20 toks/s, output: 136.64 toks/s]
Processed prompts:  64%|██████▍   | 5245/8192 [00:38<00:27, 107.58it/s, est. speed input: 139458.22 toks/s, output: 136.19 toks/s]
Processed prompts:  65%|██████▍   | 5309/8192 [00:39<00:26, 107.55it/s, est. speed input: 139010.41 toks/s, output: 135.75 toks/s]
Processed prompts:  66%|██████▌   | 5373/8192 [00:39<00:26, 107.55it/s, est. speed input: 138577.51 toks/s, output: 135.33 toks/s]
Processed prompts:  66%|██████▋   | 5437/8192 [00:40<00:25, 107.46it/s, est. speed input: 138152.08 toks/s, output: 134.91 toks/s]
Processed prompts:  67%|██████▋   | 5501/8192 [00:40<00:25, 107.46it/s, est. speed input: 137742.84 toks/s, output: 134.51 toks/s]
Processed prompts:  68%|██████▊   | 5565/8192 [00:41<00:24, 107.45it/s, est. speed input: 137344.10 toks/s, output: 134.13 toks/s]
Processed prompts:  69%|██████▊   | 5629/8192 [00:42<00:23, 107.45it/s, est. speed input: 136957.95 toks/s, output: 133.75 toks/s]
Processed prompts:  69%|██████▉   | 5693/8192 [00:42<00:23, 107.44it/s, est. speed input: 136581.35 toks/s, output: 133.38 toks/s]
Processed prompts:  70%|███████   | 5757/8192 [00:43<00:22, 107.42it/s, est. speed input: 136214.49 toks/s, output: 133.02 toks/s]
Processed prompts:  71%|███████   | 5821/8192 [00:43<00:22, 107.43it/s, est. speed input: 135859.38 toks/s, output: 132.68 toks/s]
Processed prompts:  72%|███████▏  | 5885/8192 [00:44<00:21, 107.43it/s, est. speed input: 135513.08 toks/s, output: 132.34 toks/s]
Processed prompts:  73%|███████▎  | 5949/8192 [00:45<00:20, 107.43it/s, est. speed input: 135175.83 toks/s, output: 132.01 toks/s]
Processed prompts:  73%|███████▎  | 6013/8192 [00:45<00:20, 107.41it/s, est. speed input: 134846.42 toks/s, output: 131.69 toks/s]
Processed prompts:  74%|███████▍  | 6077/8192 [00:46<00:19, 107.43it/s, est. speed input: 134527.04 toks/s, output: 131.37 toks/s]
Processed prompts:  75%|███████▍  | 6141/8192 [00:46<00:19, 107.43it/s, est. speed input: 134215.63 toks/s, output: 131.07 toks/s]
Processed prompts:  76%|███████▌  | 6205/8192 [00:47<00:18, 107.45it/s, est. speed input: 133912.50 toks/s, output: 130.77 toks/s]
Processed prompts:  77%|███████▋  | 6269/8192 [00:48<00:17, 107.44it/s, est. speed input: 133615.73 toks/s, output: 130.48 toks/s]
Processed prompts:  77%|███████▋  | 6333/8192 [00:48<00:17, 107.40it/s, est. speed input: 133324.73 toks/s, output: 130.20 toks/s]
Processed prompts:  78%|███████▊  | 6397/8192 [00:49<00:16, 107.40it/s, est. speed input: 133042.30 toks/s, output: 129.92 toks/s]
Processed prompts:  79%|███████▉  | 6461/8192 [00:49<00:16, 107.40it/s, est. speed input: 132766.47 toks/s, output: 129.65 toks/s]
Processed prompts:  80%|███████▉  | 6525/8192 [00:50<00:15, 107.38it/s, est. speed input: 132496.29 toks/s, output: 129.39 toks/s]
Processed prompts:  80%|████████  | 6589/8192 [00:51<00:14, 107.86it/s, est. speed input: 132255.84 toks/s, output: 129.16 toks/s]
Processed prompts:  81%|████████  | 6653/8192 [00:51<00:14, 108.20it/s, est. speed input: 132020.93 toks/s, output: 128.93 toks/s]
Processed prompts:  82%|████████▏ | 6717/8192 [00:52<00:13, 107.96it/s, est. speed input: 131769.44 toks/s, output: 128.68 toks/s]
Processed prompts:  83%|████████▎ | 6781/8192 [00:52<00:13, 107.78it/s, est. speed input: 131522.84 toks/s, output: 128.44 toks/s]
Processed prompts:  84%|████████▎ | 6845/8192 [00:53<00:12, 107.66it/s, est. speed input: 131282.07 toks/s, output: 128.21 toks/s]
Processed prompts:  84%|████████▍ | 6909/8192 [00:53<00:11, 107.56it/s, est. speed input: 131046.14 toks/s, output: 127.97 toks/s]
Processed prompts:  85%|████████▌ | 6973/8192 [00:54<00:11, 107.50it/s, est. speed input: 130815.60 toks/s, output: 127.75 toks/s]
Processed prompts:  86%|████████▌ | 7037/8192 [00:55<00:10, 107.47it/s, est. speed input: 130590.44 toks/s, output: 127.53 toks/s]
Processed prompts:  87%|████████▋ | 7101/8192 [00:55<00:10, 107.45it/s, est. speed input: 130370.21 toks/s, output: 127.31 toks/s]
Processed prompts:  87%|████████▋ | 7165/8192 [00:56<00:09, 107.43it/s, est. speed input: 130154.33 toks/s, output: 127.10 toks/s]
Processed prompts:  88%|████████▊ | 7229/8192 [00:56<00:08, 107.42it/s, est. speed input: 129943.43 toks/s, output: 126.90 toks/s]
Processed prompts:  89%|████████▉ | 7293/8192 [00:57<00:08, 107.41it/s, est. speed input: 129736.53 toks/s, output: 126.70 toks/s]
Processed prompts:  90%|████████▉ | 7357/8192 [00:58<00:07, 107.39it/s, est. speed input: 129533.16 toks/s, output: 126.50 toks/s]
Processed prompts:  91%|█████████ | 7421/8192 [00:58<00:07, 107.39it/s, est. speed input: 129334.70 toks/s, output: 126.30 toks/s]
Processed prompts:  91%|█████████▏| 7485/8192 [00:59<00:06, 107.38it/s, est. speed input: 129139.80 toks/s, output: 126.11 toks/s]
Processed prompts:  92%|█████████▏| 7549/8192 [00:59<00:05, 107.38it/s, est. speed input: 128949.24 toks/s, output: 125.93 toks/s]
Processed prompts:  93%|█████████▎| 7613/8192 [01:00<00:05, 107.39it/s, est. speed input: 128762.42 toks/s, output: 125.74 toks/s]
Processed prompts:  94%|█████████▎| 7677/8192 [01:01<00:04, 107.37it/s, est. speed input: 128578.53 toks/s, output: 125.56 toks/s]
Processed prompts:  94%|█████████▍| 7741/8192 [01:01<00:04, 107.37it/s, est. speed input: 128398.47 toks/s, output: 125.39 toks/s]
Processed prompts:  95%|█████████▌| 7805/8192 [01:02<00:03, 107.37it/s, est. speed input: 128222.13 toks/s, output: 125.22 toks/s]
Processed prompts:  96%|█████████▌| 7869/8192 [01:02<00:03, 107.36it/s, est. speed input: 128048.72 toks/s, output: 125.05 toks/s]
Processed prompts:  97%|█████████▋| 7933/8192 [01:03<00:02, 107.37it/s, est. speed input: 127879.20 toks/s, output: 124.88 toks/s]
Processed prompts:  98%|█████████▊| 7997/8192 [01:04<00:01, 107.35it/s, est. speed input: 127711.78 toks/s, output: 124.72 toks/s]
Processed prompts:  98%|█████████▊| 8061/8192 [01:04<00:01, 107.88it/s, est. speed input: 127567.16 toks/s, output: 124.58 toks/s]
Processed prompts:  99%|█████████▉| 8125/8192 [01:05<00:00, 107.85it/s, est. speed input: 127410.71 toks/s, output: 124.42 toks/s]
Processed prompts: 100%|██████████| 8192/8192 [01:05<00:00, 107.85it/s, est. speed input: 128363.86 toks/s, output: 125.36 toks/s]
Processed prompts: 100%|██████████| 8192/8192 [01:05<00:00, 125.36it/s, est. speed input: 128363.86 toks/s, output: 125.36 toks/s]
[rank0]:[W126 01:12:08.283205596 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 116.5s

测试结果:
  Requests/s:   107.51
  Tokens/s:     110195.38
  Total Reqs:   8192
  Elapsed:      76.20s

  [Prefill 分析]
  Total Prefill Tokens: 8388608
  Prefill Tokens/s:     110087.87


------------------------------------------------------------
  生成 CSV: Llama3.2-1B-INT8
------------------------------------------------------------
[SUCCESS] CSV 保存到: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/RTX5080_cc120_INT8_py312_cu129_x86_64/cusparselt/2_4/Llama3.2-1B-INT8_prefill.csv

预览:
------------------------------------------------------------
M_prefill,prompt_len,max_num_seqs,num_prompts,N_prefill,requests_per_s,tokens_per_s,elapsed_time_s
65536,1024,64,8192,128,107.5077,110195.3786,76.1992

------------------------------------------------------------

[INFO] 完成: 1 成功, 0 失败


============================================================
  Benchmark 完成!
============================================================


总计: 1 成功, 0 失败
============================================================
